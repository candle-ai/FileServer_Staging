const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index.DS5eee3c.js","assets/modulepreload-polyfill.B5Qt9EMX.js"])))=>i.map(i=>d[i]);
var LO=Object.defineProperty;var MO=(r,e,t)=>e in r?LO(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var z=(r,e,t)=>MO(r,typeof e!="symbol"?e+"":e,t);import"./modulepreload-polyfill.B5Qt9EMX.js";function $O(r,e){for(var t=0;t<e.length;t++){const n=e[t];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in r)){const i=Object.getOwnPropertyDescriptor(n,s);i&&Object.defineProperty(r,s,i.get?i:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}))}var _v=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function bb(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var ox={exports:{}},$p={},ix={exports:{}},ur={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oE;function UO(){if(oE)return ur;oE=1;var r=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),c=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),x=Symbol.iterator;function b(F){return F===null||typeof F!="object"?null:(F=x&&F[x]||F["@@iterator"],typeof F=="function"?F:null)}var S={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},N=Object.assign,E={};function T(F,H,te){this.props=F,this.context=H,this.refs=E,this.updater=te||S}T.prototype.isReactComponent={},T.prototype.setState=function(F,H){if(typeof F!="object"&&typeof F!="function"&&F!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,F,H,"setState")},T.prototype.forceUpdate=function(F){this.updater.enqueueForceUpdate(this,F,"forceUpdate")};function A(){}A.prototype=T.prototype;function I(F,H,te){this.props=F,this.context=H,this.refs=E,this.updater=te||S}var D=I.prototype=new A;D.constructor=I,N(D,T.prototype),D.isPureReactComponent=!0;var j=Array.isArray,O=Object.prototype.hasOwnProperty,B={current:null},G={key:!0,ref:!0,__self:!0,__source:!0};function K(F,H,te){var Se,ue={},ke=null,X=null;if(H!=null)for(Se in H.ref!==void 0&&(X=H.ref),H.key!==void 0&&(ke=""+H.key),H)O.call(H,Se)&&!G.hasOwnProperty(Se)&&(ue[Se]=H[Se]);var we=arguments.length-2;if(we===1)ue.children=te;else if(1<we){for(var Ne=Array(we),Me=0;Me<we;Me++)Ne[Me]=arguments[Me+2];ue.children=Ne}if(F&&F.defaultProps)for(Se in we=F.defaultProps,we)ue[Se]===void 0&&(ue[Se]=we[Se]);return{$$typeof:r,type:F,key:ke,ref:X,props:ue,_owner:B.current}}function re(F,H){return{$$typeof:r,type:F.type,key:H,ref:F.ref,props:F.props,_owner:F._owner}}function se(F){return typeof F=="object"&&F!==null&&F.$$typeof===r}function he(F){var H={"=":"=0",":":"=2"};return"$"+F.replace(/[=:]/g,function(te){return H[te]})}var U=/\/+/g;function ge(F,H){return typeof F=="object"&&F!==null&&F.key!=null?he(""+F.key):H.toString(36)}function ie(F,H,te,Se,ue){var ke=typeof F;(ke==="undefined"||ke==="boolean")&&(F=null);var X=!1;if(F===null)X=!0;else switch(ke){case"string":case"number":X=!0;break;case"object":switch(F.$$typeof){case r:case e:X=!0}}if(X)return X=F,ue=ue(X),F=Se===""?"."+ge(X,0):Se,j(ue)?(te="",F!=null&&(te=F.replace(U,"$&/")+"/"),ie(ue,H,te,"",function(Me){return Me})):ue!=null&&(se(ue)&&(ue=re(ue,te+(!ue.key||X&&X.key===ue.key?"":(""+ue.key).replace(U,"$&/")+"/")+F)),H.push(ue)),1;if(X=0,Se=Se===""?".":Se+":",j(F))for(var we=0;we<F.length;we++){ke=F[we];var Ne=Se+ge(ke,we);X+=ie(ke,H,te,Ne,ue)}else if(Ne=b(F),typeof Ne=="function")for(F=Ne.call(F),we=0;!(ke=F.next()).done;)ke=ke.value,Ne=Se+ge(ke,we++),X+=ie(ke,H,te,Ne,ue);else if(ke==="object")throw H=String(F),Error("Objects are not valid as a React child (found: "+(H==="[object Object]"?"object with keys {"+Object.keys(F).join(", ")+"}":H)+"). If you meant to render a collection of children, use an array instead.");return X}function ae(F,H,te){if(F==null)return F;var Se=[],ue=0;return ie(F,Se,"","",function(ke){return H.call(te,ke,ue++)}),Se}function de(F){if(F._status===-1){var H=F._result;H=H(),H.then(function(te){(F._status===0||F._status===-1)&&(F._status=1,F._result=te)},function(te){(F._status===0||F._status===-1)&&(F._status=2,F._result=te)}),F._status===-1&&(F._status=0,F._result=H)}if(F._status===1)return F._result.default;throw F._result}var J={current:null},Y={transition:null},$={ReactCurrentDispatcher:J,ReactCurrentBatchConfig:Y,ReactCurrentOwner:B};function Q(){throw Error("act(...) is not supported in production builds of React.")}return ur.Children={map:ae,forEach:function(F,H,te){ae(F,function(){H.apply(this,arguments)},te)},count:function(F){var H=0;return ae(F,function(){H++}),H},toArray:function(F){return ae(F,function(H){return H})||[]},only:function(F){if(!se(F))throw Error("React.Children.only expected to receive a single React element child.");return F}},ur.Component=T,ur.Fragment=t,ur.Profiler=s,ur.PureComponent=I,ur.StrictMode=n,ur.Suspense=m,ur.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=$,ur.act=Q,ur.cloneElement=function(F,H,te){if(F==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+F+".");var Se=N({},F.props),ue=F.key,ke=F.ref,X=F._owner;if(H!=null){if(H.ref!==void 0&&(ke=H.ref,X=B.current),H.key!==void 0&&(ue=""+H.key),F.type&&F.type.defaultProps)var we=F.type.defaultProps;for(Ne in H)O.call(H,Ne)&&!G.hasOwnProperty(Ne)&&(Se[Ne]=H[Ne]===void 0&&we!==void 0?we[Ne]:H[Ne])}var Ne=arguments.length-2;if(Ne===1)Se.children=te;else if(1<Ne){we=Array(Ne);for(var Me=0;Me<Ne;Me++)we[Me]=arguments[Me+2];Se.children=we}return{$$typeof:r,type:F.type,key:ue,ref:ke,props:Se,_owner:X}},ur.createContext=function(F){return F={$$typeof:c,_currentValue:F,_currentValue2:F,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},F.Provider={$$typeof:i,_context:F},F.Consumer=F},ur.createElement=K,ur.createFactory=function(F){var H=K.bind(null,F);return H.type=F,H},ur.createRef=function(){return{current:null}},ur.forwardRef=function(F){return{$$typeof:d,render:F}},ur.isValidElement=se,ur.lazy=function(F){return{$$typeof:v,_payload:{_status:-1,_result:F},_init:de}},ur.memo=function(F,H){return{$$typeof:p,type:F,compare:H===void 0?null:H}},ur.startTransition=function(F){var H=Y.transition;Y.transition={};try{F()}finally{Y.transition=H}},ur.unstable_act=Q,ur.useCallback=function(F,H){return J.current.useCallback(F,H)},ur.useContext=function(F){return J.current.useContext(F)},ur.useDebugValue=function(){},ur.useDeferredValue=function(F){return J.current.useDeferredValue(F)},ur.useEffect=function(F,H){return J.current.useEffect(F,H)},ur.useId=function(){return J.current.useId()},ur.useImperativeHandle=function(F,H,te){return J.current.useImperativeHandle(F,H,te)},ur.useInsertionEffect=function(F,H){return J.current.useInsertionEffect(F,H)},ur.useLayoutEffect=function(F,H){return J.current.useLayoutEffect(F,H)},ur.useMemo=function(F,H){return J.current.useMemo(F,H)},ur.useReducer=function(F,H,te){return J.current.useReducer(F,H,te)},ur.useRef=function(F){return J.current.useRef(F)},ur.useState=function(F){return J.current.useState(F)},ur.useSyncExternalStore=function(F,H,te){return J.current.useSyncExternalStore(F,H,te)},ur.useTransition=function(){return J.current.useTransition()},ur.version="18.3.1",ur}var iE;function _b(){return iE||(iE=1,ix.exports=UO()),ix.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aE;function zO(){if(aE)return $p;aE=1;var r=_b(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function c(d,m,p){var v,x={},b=null,S=null;p!==void 0&&(b=""+p),m.key!==void 0&&(b=""+m.key),m.ref!==void 0&&(S=m.ref);for(v in m)n.call(m,v)&&!i.hasOwnProperty(v)&&(x[v]=m[v]);if(d&&d.defaultProps)for(v in m=d.defaultProps,m)x[v]===void 0&&(x[v]=m[v]);return{$$typeof:e,type:d,key:b,ref:S,props:x,_owner:s.current}}return $p.Fragment=t,$p.jsx=c,$p.jsxs=c,$p}var lE;function HO(){return lE||(lE=1,ox.exports=zO()),ox.exports}var u=HO(),w=_b();const br=bb(w),Sb=$O({__proto__:null,default:br},[w]);var Sv={},ax={exports:{}},Io={},lx={exports:{}},cx={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cE;function BO(){return cE||(cE=1,(function(r){function e(Y,$){var Q=Y.length;Y.push($);e:for(;0<Q;){var F=Q-1>>>1,H=Y[F];if(0<s(H,$))Y[F]=$,Y[Q]=H,Q=F;else break e}}function t(Y){return Y.length===0?null:Y[0]}function n(Y){if(Y.length===0)return null;var $=Y[0],Q=Y.pop();if(Q!==$){Y[0]=Q;e:for(var F=0,H=Y.length,te=H>>>1;F<te;){var Se=2*(F+1)-1,ue=Y[Se],ke=Se+1,X=Y[ke];if(0>s(ue,Q))ke<H&&0>s(X,ue)?(Y[F]=X,Y[ke]=Q,F=ke):(Y[F]=ue,Y[Se]=Q,F=Se);else if(ke<H&&0>s(X,Q))Y[F]=X,Y[ke]=Q,F=ke;else break e}}return $}function s(Y,$){var Q=Y.sortIndex-$.sortIndex;return Q!==0?Q:Y.id-$.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;r.unstable_now=function(){return i.now()}}else{var c=Date,d=c.now();r.unstable_now=function(){return c.now()-d}}var m=[],p=[],v=1,x=null,b=3,S=!1,N=!1,E=!1,T=typeof setTimeout=="function"?setTimeout:null,A=typeof clearTimeout=="function"?clearTimeout:null,I=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function D(Y){for(var $=t(p);$!==null;){if($.callback===null)n(p);else if($.startTime<=Y)n(p),$.sortIndex=$.expirationTime,e(m,$);else break;$=t(p)}}function j(Y){if(E=!1,D(Y),!N)if(t(m)!==null)N=!0,de(O);else{var $=t(p);$!==null&&J(j,$.startTime-Y)}}function O(Y,$){N=!1,E&&(E=!1,A(K),K=-1),S=!0;var Q=b;try{for(D($),x=t(m);x!==null&&(!(x.expirationTime>$)||Y&&!he());){var F=x.callback;if(typeof F=="function"){x.callback=null,b=x.priorityLevel;var H=F(x.expirationTime<=$);$=r.unstable_now(),typeof H=="function"?x.callback=H:x===t(m)&&n(m),D($)}else n(m);x=t(m)}if(x!==null)var te=!0;else{var Se=t(p);Se!==null&&J(j,Se.startTime-$),te=!1}return te}finally{x=null,b=Q,S=!1}}var B=!1,G=null,K=-1,re=5,se=-1;function he(){return!(r.unstable_now()-se<re)}function U(){if(G!==null){var Y=r.unstable_now();se=Y;var $=!0;try{$=G(!0,Y)}finally{$?ge():(B=!1,G=null)}}else B=!1}var ge;if(typeof I=="function")ge=function(){I(U)};else if(typeof MessageChannel<"u"){var ie=new MessageChannel,ae=ie.port2;ie.port1.onmessage=U,ge=function(){ae.postMessage(null)}}else ge=function(){T(U,0)};function de(Y){G=Y,B||(B=!0,ge())}function J(Y,$){K=T(function(){Y(r.unstable_now())},$)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(Y){Y.callback=null},r.unstable_continueExecution=function(){N||S||(N=!0,de(O))},r.unstable_forceFrameRate=function(Y){0>Y||125<Y?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):re=0<Y?Math.floor(1e3/Y):5},r.unstable_getCurrentPriorityLevel=function(){return b},r.unstable_getFirstCallbackNode=function(){return t(m)},r.unstable_next=function(Y){switch(b){case 1:case 2:case 3:var $=3;break;default:$=b}var Q=b;b=$;try{return Y()}finally{b=Q}},r.unstable_pauseExecution=function(){},r.unstable_requestPaint=function(){},r.unstable_runWithPriority=function(Y,$){switch(Y){case 1:case 2:case 3:case 4:case 5:break;default:Y=3}var Q=b;b=Y;try{return $()}finally{b=Q}},r.unstable_scheduleCallback=function(Y,$,Q){var F=r.unstable_now();switch(typeof Q=="object"&&Q!==null?(Q=Q.delay,Q=typeof Q=="number"&&0<Q?F+Q:F):Q=F,Y){case 1:var H=-1;break;case 2:H=250;break;case 5:H=1073741823;break;case 4:H=1e4;break;default:H=5e3}return H=Q+H,Y={id:v++,callback:$,priorityLevel:Y,startTime:Q,expirationTime:H,sortIndex:-1},Q>F?(Y.sortIndex=Q,e(p,Y),t(m)===null&&Y===t(p)&&(E?(A(K),K=-1):E=!0,J(j,Q-F))):(Y.sortIndex=H,e(m,Y),N||S||(N=!0,de(O))),Y},r.unstable_shouldYield=he,r.unstable_wrapCallback=function(Y){var $=b;return function(){var Q=b;b=$;try{return Y.apply(this,arguments)}finally{b=Q}}}})(cx)),cx}var uE;function GO(){return uE||(uE=1,lx.exports=BO()),lx.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dE;function WO(){if(dE)return Io;dE=1;var r=_b(),e=GO();function t(o){for(var a="https://reactjs.org/docs/error-decoder.html?invariant="+o,h=1;h<arguments.length;h++)a+="&args[]="+encodeURIComponent(arguments[h]);return"Minified React error #"+o+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,s={};function i(o,a){c(o,a),c(o+"Capture",a)}function c(o,a){for(s[o]=a,o=0;o<a.length;o++)n.add(a[o])}var d=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),m=Object.prototype.hasOwnProperty,p=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,v={},x={};function b(o){return m.call(x,o)?!0:m.call(v,o)?!1:p.test(o)?x[o]=!0:(v[o]=!0,!1)}function S(o,a,h,g){if(h!==null&&h.type===0)return!1;switch(typeof a){case"function":case"symbol":return!0;case"boolean":return g?!1:h!==null?!h.acceptsBooleans:(o=o.toLowerCase().slice(0,5),o!=="data-"&&o!=="aria-");default:return!1}}function N(o,a,h,g){if(a===null||typeof a>"u"||S(o,a,h,g))return!0;if(g)return!1;if(h!==null)switch(h.type){case 3:return!a;case 4:return a===!1;case 5:return isNaN(a);case 6:return isNaN(a)||1>a}return!1}function E(o,a,h,g,_,C,P){this.acceptsBooleans=a===2||a===3||a===4,this.attributeName=g,this.attributeNamespace=_,this.mustUseProperty=h,this.propertyName=o,this.type=a,this.sanitizeURL=C,this.removeEmptyString=P}var T={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(o){T[o]=new E(o,0,!1,o,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(o){var a=o[0];T[a]=new E(a,1,!1,o[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(o){T[o]=new E(o,2,!1,o.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(o){T[o]=new E(o,2,!1,o,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(o){T[o]=new E(o,3,!1,o.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(o){T[o]=new E(o,3,!0,o,null,!1,!1)}),["capture","download"].forEach(function(o){T[o]=new E(o,4,!1,o,null,!1,!1)}),["cols","rows","size","span"].forEach(function(o){T[o]=new E(o,6,!1,o,null,!1,!1)}),["rowSpan","start"].forEach(function(o){T[o]=new E(o,5,!1,o.toLowerCase(),null,!1,!1)});var A=/[\-:]([a-z])/g;function I(o){return o[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(o){var a=o.replace(A,I);T[a]=new E(a,1,!1,o,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(o){var a=o.replace(A,I);T[a]=new E(a,1,!1,o,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(o){var a=o.replace(A,I);T[a]=new E(a,1,!1,o,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(o){T[o]=new E(o,1,!1,o.toLowerCase(),null,!1,!1)}),T.xlinkHref=new E("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(o){T[o]=new E(o,1,!1,o.toLowerCase(),null,!0,!0)});function D(o,a,h,g){var _=T.hasOwnProperty(a)?T[a]:null;(_!==null?_.type!==0:g||!(2<a.length)||a[0]!=="o"&&a[0]!=="O"||a[1]!=="n"&&a[1]!=="N")&&(N(a,h,_,g)&&(h=null),g||_===null?b(a)&&(h===null?o.removeAttribute(a):o.setAttribute(a,""+h)):_.mustUseProperty?o[_.propertyName]=h===null?_.type===3?!1:"":h:(a=_.attributeName,g=_.attributeNamespace,h===null?o.removeAttribute(a):(_=_.type,h=_===3||_===4&&h===!0?"":""+h,g?o.setAttributeNS(g,a,h):o.setAttribute(a,h))))}var j=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,O=Symbol.for("react.element"),B=Symbol.for("react.portal"),G=Symbol.for("react.fragment"),K=Symbol.for("react.strict_mode"),re=Symbol.for("react.profiler"),se=Symbol.for("react.provider"),he=Symbol.for("react.context"),U=Symbol.for("react.forward_ref"),ge=Symbol.for("react.suspense"),ie=Symbol.for("react.suspense_list"),ae=Symbol.for("react.memo"),de=Symbol.for("react.lazy"),J=Symbol.for("react.offscreen"),Y=Symbol.iterator;function $(o){return o===null||typeof o!="object"?null:(o=Y&&o[Y]||o["@@iterator"],typeof o=="function"?o:null)}var Q=Object.assign,F;function H(o){if(F===void 0)try{throw Error()}catch(h){var a=h.stack.trim().match(/\n( *(at )?)/);F=a&&a[1]||""}return`
`+F+o}var te=!1;function Se(o,a){if(!o||te)return"";te=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(a)if(a=function(){throw Error()},Object.defineProperty(a.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(a,[])}catch(xe){var g=xe}Reflect.construct(o,[],a)}else{try{a.call()}catch(xe){g=xe}o.call(a.prototype)}else{try{throw Error()}catch(xe){g=xe}o()}}catch(xe){if(xe&&g&&typeof xe.stack=="string"){for(var _=xe.stack.split(`
`),C=g.stack.split(`
`),P=_.length-1,W=C.length-1;1<=P&&0<=W&&_[P]!==C[W];)W--;for(;1<=P&&0<=W;P--,W--)if(_[P]!==C[W]){if(P!==1||W!==1)do if(P--,W--,0>W||_[P]!==C[W]){var Z=`
`+_[P].replace(" at new "," at ");return o.displayName&&Z.includes("<anonymous>")&&(Z=Z.replace("<anonymous>",o.displayName)),Z}while(1<=P&&0<=W);break}}}finally{te=!1,Error.prepareStackTrace=h}return(o=o?o.displayName||o.name:"")?H(o):""}function ue(o){switch(o.tag){case 5:return H(o.type);case 16:return H("Lazy");case 13:return H("Suspense");case 19:return H("SuspenseList");case 0:case 2:case 15:return o=Se(o.type,!1),o;case 11:return o=Se(o.type.render,!1),o;case 1:return o=Se(o.type,!0),o;default:return""}}function ke(o){if(o==null)return null;if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o;switch(o){case G:return"Fragment";case B:return"Portal";case re:return"Profiler";case K:return"StrictMode";case ge:return"Suspense";case ie:return"SuspenseList"}if(typeof o=="object")switch(o.$$typeof){case he:return(o.displayName||"Context")+".Consumer";case se:return(o._context.displayName||"Context")+".Provider";case U:var a=o.render;return o=o.displayName,o||(o=a.displayName||a.name||"",o=o!==""?"ForwardRef("+o+")":"ForwardRef"),o;case ae:return a=o.displayName||null,a!==null?a:ke(o.type)||"Memo";case de:a=o._payload,o=o._init;try{return ke(o(a))}catch{}}return null}function X(o){var a=o.type;switch(o.tag){case 24:return"Cache";case 9:return(a.displayName||"Context")+".Consumer";case 10:return(a._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return o=a.render,o=o.displayName||o.name||"",a.displayName||(o!==""?"ForwardRef("+o+")":"ForwardRef");case 7:return"Fragment";case 5:return a;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ke(a);case 8:return a===K?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a}return null}function we(o){switch(typeof o){case"boolean":case"number":case"string":case"undefined":return o;case"object":return o;default:return""}}function Ne(o){var a=o.type;return(o=o.nodeName)&&o.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function Me(o){var a=Ne(o)?"checked":"value",h=Object.getOwnPropertyDescriptor(o.constructor.prototype,a),g=""+o[a];if(!o.hasOwnProperty(a)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var _=h.get,C=h.set;return Object.defineProperty(o,a,{configurable:!0,get:function(){return _.call(this)},set:function(P){g=""+P,C.call(this,P)}}),Object.defineProperty(o,a,{enumerable:h.enumerable}),{getValue:function(){return g},setValue:function(P){g=""+P},stopTracking:function(){o._valueTracker=null,delete o[a]}}}}function St(o){o._valueTracker||(o._valueTracker=Me(o))}function Te(o){if(!o)return!1;var a=o._valueTracker;if(!a)return!0;var h=a.getValue(),g="";return o&&(g=Ne(o)?o.checked?"true":"false":o.value),o=g,o!==h?(a.setValue(o),!0):!1}function Ge(o){if(o=o||(typeof document<"u"?document:void 0),typeof o>"u")return null;try{return o.activeElement||o.body}catch{return o.body}}function Ee(o,a){var h=a.checked;return Q({},a,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:h??o._wrapperState.initialChecked})}function ye(o,a){var h=a.defaultValue==null?"":a.defaultValue,g=a.checked!=null?a.checked:a.defaultChecked;h=we(a.value!=null?a.value:h),o._wrapperState={initialChecked:g,initialValue:h,controlled:a.type==="checkbox"||a.type==="radio"?a.checked!=null:a.value!=null}}function Ke(o,a){a=a.checked,a!=null&&D(o,"checked",a,!1)}function qe(o,a){Ke(o,a);var h=we(a.value),g=a.type;if(h!=null)g==="number"?(h===0&&o.value===""||o.value!=h)&&(o.value=""+h):o.value!==""+h&&(o.value=""+h);else if(g==="submit"||g==="reset"){o.removeAttribute("value");return}a.hasOwnProperty("value")?mt(o,a.type,h):a.hasOwnProperty("defaultValue")&&mt(o,a.type,we(a.defaultValue)),a.checked==null&&a.defaultChecked!=null&&(o.defaultChecked=!!a.defaultChecked)}function ft(o,a,h){if(a.hasOwnProperty("value")||a.hasOwnProperty("defaultValue")){var g=a.type;if(!(g!=="submit"&&g!=="reset"||a.value!==void 0&&a.value!==null))return;a=""+o._wrapperState.initialValue,h||a===o.value||(o.value=a),o.defaultValue=a}h=o.name,h!==""&&(o.name=""),o.defaultChecked=!!o._wrapperState.initialChecked,h!==""&&(o.name=h)}function mt(o,a,h){(a!=="number"||Ge(o.ownerDocument)!==o)&&(h==null?o.defaultValue=""+o._wrapperState.initialValue:o.defaultValue!==""+h&&(o.defaultValue=""+h))}var jt=Array.isArray;function ut(o,a,h,g){if(o=o.options,a){a={};for(var _=0;_<h.length;_++)a["$"+h[_]]=!0;for(h=0;h<o.length;h++)_=a.hasOwnProperty("$"+o[h].value),o[h].selected!==_&&(o[h].selected=_),_&&g&&(o[h].defaultSelected=!0)}else{for(h=""+we(h),a=null,_=0;_<o.length;_++){if(o[_].value===h){o[_].selected=!0,g&&(o[_].defaultSelected=!0);return}a!==null||o[_].disabled||(a=o[_])}a!==null&&(a.selected=!0)}}function Jt(o,a){if(a.dangerouslySetInnerHTML!=null)throw Error(t(91));return Q({},a,{value:void 0,defaultValue:void 0,children:""+o._wrapperState.initialValue})}function Or(o,a){var h=a.value;if(h==null){if(h=a.children,a=a.defaultValue,h!=null){if(a!=null)throw Error(t(92));if(jt(h)){if(1<h.length)throw Error(t(93));h=h[0]}a=h}a==null&&(a=""),h=a}o._wrapperState={initialValue:we(h)}}function jr(o,a){var h=we(a.value),g=we(a.defaultValue);h!=null&&(h=""+h,h!==o.value&&(o.value=h),a.defaultValue==null&&o.defaultValue!==h&&(o.defaultValue=h)),g!=null&&(o.defaultValue=""+g)}function Nr(o){var a=o.textContent;a===o._wrapperState.initialValue&&a!==""&&a!==null&&(o.value=a)}function me(o){switch(o){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function je(o,a){return o==null||o==="http://www.w3.org/1999/xhtml"?me(a):o==="http://www.w3.org/2000/svg"&&a==="foreignObject"?"http://www.w3.org/1999/xhtml":o}var ht,wt=(function(o){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(a,h,g,_){MSApp.execUnsafeLocalFunction(function(){return o(a,h,g,_)})}:o})(function(o,a){if(o.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in o)o.innerHTML=a;else{for(ht=ht||document.createElement("div"),ht.innerHTML="<svg>"+a.valueOf().toString()+"</svg>",a=ht.firstChild;o.firstChild;)o.removeChild(o.firstChild);for(;a.firstChild;)o.appendChild(a.firstChild)}});function We(o,a){if(a){var h=o.firstChild;if(h&&h===o.lastChild&&h.nodeType===3){h.nodeValue=a;return}}o.textContent=a}var Ve={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},lt=["Webkit","ms","Moz","O"];Object.keys(Ve).forEach(function(o){lt.forEach(function(a){a=a+o.charAt(0).toUpperCase()+o.substring(1),Ve[a]=Ve[o]})});function Pe(o,a,h){return a==null||typeof a=="boolean"||a===""?"":h||typeof a!="number"||a===0||Ve.hasOwnProperty(o)&&Ve[o]?(""+a).trim():a+"px"}function kt(o,a){o=o.style;for(var h in a)if(a.hasOwnProperty(h)){var g=h.indexOf("--")===0,_=Pe(h,a[h],g);h==="float"&&(h="cssFloat"),g?o.setProperty(h,_):o[h]=_}}var Ft=Q({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function $e(o,a){if(a){if(Ft[o]&&(a.children!=null||a.dangerouslySetInnerHTML!=null))throw Error(t(137,o));if(a.dangerouslySetInnerHTML!=null){if(a.children!=null)throw Error(t(60));if(typeof a.dangerouslySetInnerHTML!="object"||!("__html"in a.dangerouslySetInnerHTML))throw Error(t(61))}if(a.style!=null&&typeof a.style!="object")throw Error(t(62))}}function cr(o,a){if(o.indexOf("-")===-1)return typeof a.is=="string";switch(o){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ut=null;function lr(o){return o=o.target||o.srcElement||window,o.correspondingUseElement&&(o=o.correspondingUseElement),o.nodeType===3?o.parentNode:o}var Wt=null,Zt=null,_n=null;function Un(o){if(o=ts(o)){if(typeof Wt!="function")throw Error(t(280));var a=o.stateNode;a&&(a=zd(a),Wt(o.stateNode,o.type,a))}}function Oo(o){Zt?_n?_n.push(o):_n=[o]:Zt=o}function Jn(){if(Zt){var o=Zt,a=_n;if(_n=Zt=null,Un(o),a)for(o=0;o<a.length;o++)Un(a[o])}}function _r(o,a){return o(a)}function gn(){}var po=!1;function Do(o,a,h){if(po)return o(a,h);po=!0;try{return _r(o,a,h)}finally{po=!1,(Zt!==null||_n!==null)&&(gn(),Jn())}}function Sn(o,a){var h=o.stateNode;if(h===null)return null;var g=zd(h);if(g===null)return null;h=g[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(g=!g.disabled)||(o=o.type,g=!(o==="button"||o==="input"||o==="select"||o==="textarea")),o=!g;break e;default:o=!1}if(o)return null;if(h&&typeof h!="function")throw Error(t(231,a,typeof h));return h}var Gs=!1;if(d)try{var Ws={};Object.defineProperty(Ws,"passive",{get:function(){Gs=!0}}),window.addEventListener("test",Ws,Ws),window.removeEventListener("test",Ws,Ws)}catch{Gs=!1}function Li(o,a,h,g,_,C,P,W,Z){var xe=Array.prototype.slice.call(arguments,3);try{a.apply(h,xe)}catch(Oe){this.onError(Oe)}}var ln=!1,zn=null,Pn=!1,le=null,tt={onError:function(o){ln=!0,zn=o}};function Tt(o,a,h,g,_,C,P,W,Z){ln=!1,zn=null,Li.apply(tt,arguments)}function dt(o,a,h,g,_,C,P,W,Z){if(Tt.apply(this,arguments),ln){if(ln){var xe=zn;ln=!1,zn=null}else throw Error(t(198));Pn||(Pn=!0,le=xe)}}function ot(o){var a=o,h=o;if(o.alternate)for(;a.return;)a=a.return;else{o=a;do a=o,(a.flags&4098)!==0&&(h=a.return),o=a.return;while(o)}return a.tag===3?h:null}function Vt(o){if(o.tag===13){var a=o.memoizedState;if(a===null&&(o=o.alternate,o!==null&&(a=o.memoizedState)),a!==null)return a.dehydrated}return null}function _t(o){if(ot(o)!==o)throw Error(t(188))}function Qt(o){var a=o.alternate;if(!a){if(a=ot(o),a===null)throw Error(t(188));return a!==o?null:o}for(var h=o,g=a;;){var _=h.return;if(_===null)break;var C=_.alternate;if(C===null){if(g=_.return,g!==null){h=g;continue}break}if(_.child===C.child){for(C=_.child;C;){if(C===h)return _t(_),o;if(C===g)return _t(_),a;C=C.sibling}throw Error(t(188))}if(h.return!==g.return)h=_,g=C;else{for(var P=!1,W=_.child;W;){if(W===h){P=!0,h=_,g=C;break}if(W===g){P=!0,g=_,h=C;break}W=W.sibling}if(!P){for(W=C.child;W;){if(W===h){P=!0,h=C,g=_;break}if(W===g){P=!0,g=C,h=_;break}W=W.sibling}if(!P)throw Error(t(189))}}if(h.alternate!==g)throw Error(t(190))}if(h.tag!==3)throw Error(t(188));return h.stateNode.current===h?o:a}function En(o){return o=Qt(o),o!==null?Be(o):null}function Be(o){if(o.tag===5||o.tag===6)return o;for(o=o.child;o!==null;){var a=Be(o);if(a!==null)return a;o=o.sibling}return null}var q=e.unstable_scheduleCallback,De=e.unstable_cancelCallback,Qe=e.unstable_shouldYield,Tr=e.unstable_requestPaint,Xt=e.unstable_now,Br=e.unstable_getCurrentPriorityLevel,cn=e.unstable_ImmediatePriority,ds=e.unstable_UserBlockingPriority,Cs=e.unstable_NormalPriority,Mi=e.unstable_LowPriority,Gr=e.unstable_IdlePriority,Lo=null,Xn=null;function ou(o){if(Xn&&typeof Xn.onCommitFiberRoot=="function")try{Xn.onCommitFiberRoot(Lo,o,void 0,(o.current.flags&128)===128)}catch{}}var Ns=Math.clz32?Math.clz32:au,pa=Math.log,iu=Math.LN2;function au(o){return o>>>=0,o===0?32:31-(pa(o)/iu|0)|0}var li=64,ci=4194304;function Vs(o){switch(o&-o){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return o&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return o}}function qs(o,a){var h=o.pendingLanes;if(h===0)return 0;var g=0,_=o.suspendedLanes,C=o.pingedLanes,P=h&268435455;if(P!==0){var W=P&~_;W!==0?g=Vs(W):(C&=P,C!==0&&(g=Vs(C)))}else P=h&~_,P!==0?g=Vs(P):C!==0&&(g=Vs(C));if(g===0)return 0;if(a!==0&&a!==g&&(a&_)===0&&(_=g&-g,C=a&-a,_>=C||_===16&&(C&4194240)!==0))return a;if((g&4)!==0&&(g|=h&16),a=o.entangledLanes,a!==0)for(o=o.entanglements,a&=g;0<a;)h=31-Ns(a),_=1<<h,g|=o[h],a&=~_;return g}function lu(o,a){switch(o){case 1:case 2:case 4:return a+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function kh(o,a){for(var h=o.suspendedLanes,g=o.pingedLanes,_=o.expirationTimes,C=o.pendingLanes;0<C;){var P=31-Ns(C),W=1<<P,Z=_[P];Z===-1?((W&h)===0||(W&g)!==0)&&(_[P]=lu(W,a)):Z<=a&&(o.expiredLanes|=W),C&=~W}}function ec(o){return o=o.pendingLanes&-1073741825,o!==0?o:o&1073741824?1073741824:0}function cu(){var o=li;return li<<=1,(li&4194240)===0&&(li=64),o}function tl(o){for(var a=[],h=0;31>h;h++)a.push(o);return a}function rl(o,a,h){o.pendingLanes|=a,a!==536870912&&(o.suspendedLanes=0,o.pingedLanes=0),o=o.eventTimes,a=31-Ns(a),o[a]=h}function yd(o,a){var h=o.pendingLanes&~a;o.pendingLanes=a,o.suspendedLanes=0,o.pingedLanes=0,o.expiredLanes&=a,o.mutableReadLanes&=a,o.entangledLanes&=a,a=o.entanglements;var g=o.eventTimes;for(o=o.expirationTimes;0<h;){var _=31-Ns(h),C=1<<_;a[_]=0,g[_]=-1,o[_]=-1,h&=~C}}function nl(o,a){var h=o.entangledLanes|=a;for(o=o.entanglements;h;){var g=31-Ns(h),_=1<<g;_&a|o[g]&a&&(o[g]|=a),h&=~_}}var vr=0;function Ks(o){return o&=-o,1<o?4<o?(o&268435455)!==0?16:536870912:4:1}var sl,tc,uu,du,fu,rc=!1,ol=[],ui=null,di=null,Mo=null,$i=new Map,be=new Map,ze=[],Je="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function At(o,a){switch(o){case"focusin":case"focusout":ui=null;break;case"dragenter":case"dragleave":di=null;break;case"mouseover":case"mouseout":Mo=null;break;case"pointerover":case"pointerout":$i.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":be.delete(a.pointerId)}}function Ct(o,a,h,g,_,C){return o===null||o.nativeEvent!==C?(o={blockedOn:a,domEventName:h,eventSystemFlags:g,nativeEvent:C,targetContainers:[_]},a!==null&&(a=ts(a),a!==null&&tc(a)),o):(o.eventSystemFlags|=g,a=o.targetContainers,_!==null&&a.indexOf(_)===-1&&a.push(_),o)}function zt(o,a,h,g,_){switch(a){case"focusin":return ui=Ct(ui,o,a,h,g,_),!0;case"dragenter":return di=Ct(di,o,a,h,g,_),!0;case"mouseover":return Mo=Ct(Mo,o,a,h,g,_),!0;case"pointerover":var C=_.pointerId;return $i.set(C,Ct($i.get(C)||null,o,a,h,g,_)),!0;case"gotpointercapture":return C=_.pointerId,be.set(C,Ct(be.get(C)||null,o,a,h,g,_)),!0}return!1}function at(o){var a=mi(o.target);if(a!==null){var h=ot(a);if(h!==null){if(a=h.tag,a===13){if(a=Vt(h),a!==null){o.blockedOn=a,fu(o.priority,function(){uu(h)});return}}else if(a===3&&h.stateNode.current.memoizedState.isDehydrated){o.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}o.blockedOn=null}function pt(o){if(o.blockedOn!==null)return!1;for(var a=o.targetContainers;0<a.length;){var h=_d(o.domEventName,o.eventSystemFlags,a[0],o.nativeEvent);if(h===null){h=o.nativeEvent;var g=new h.constructor(h.type,h);Ut=g,h.target.dispatchEvent(g),Ut=null}else return a=ts(h),a!==null&&tc(a),o.blockedOn=h,!1;a.shift()}return!0}function Qn(o,a,h){pt(o)&&h.delete(a)}function Ys(){rc=!1,ui!==null&&pt(ui)&&(ui=null),di!==null&&pt(di)&&(di=null),Mo!==null&&pt(Mo)&&(Mo=null),$i.forEach(Qn),be.forEach(Qn)}function Sr(o,a){o.blockedOn===a&&(o.blockedOn=null,rc||(rc=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Ys)))}function er(o){function a(_){return Sr(_,o)}if(0<ol.length){Sr(ol[0],o);for(var h=1;h<ol.length;h++){var g=ol[h];g.blockedOn===o&&(g.blockedOn=null)}}for(ui!==null&&Sr(ui,o),di!==null&&Sr(di,o),Mo!==null&&Sr(Mo,o),$i.forEach(a),be.forEach(a),h=0;h<ze.length;h++)g=ze[h],g.blockedOn===o&&(g.blockedOn=null);for(;0<ze.length&&(h=ze[0],h.blockedOn===null);)at(h),h.blockedOn===null&&ze.shift()}var ma=j.ReactCurrentBatchConfig,Ui=!0;function xd(o,a,h,g){var _=vr,C=ma.transition;ma.transition=null;try{vr=1,il(o,a,h,g)}finally{vr=_,ma.transition=C}}function wd(o,a,h,g){var _=vr,C=ma.transition;ma.transition=null;try{vr=4,il(o,a,h,g)}finally{vr=_,ma.transition=C}}function il(o,a,h,g){if(Ui){var _=_d(o,a,h,g);if(_===null)Hh(o,a,g,bd,h),At(o,g);else if(zt(_,o,a,h,g))g.stopPropagation();else if(At(o,g),a&4&&-1<Je.indexOf(o)){for(;_!==null;){var C=ts(_);if(C!==null&&sl(C),C=_d(o,a,h,g),C===null&&Hh(o,a,g,bd,h),C===_)break;_=C}_!==null&&g.stopPropagation()}else Hh(o,a,g,null,h)}}var bd=null;function _d(o,a,h,g){if(bd=null,o=lr(g),o=mi(o),o!==null)if(a=ot(o),a===null)o=null;else if(h=a.tag,h===13){if(o=Vt(a),o!==null)return o;o=null}else if(h===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;o=null}else a!==o&&(o=null);return bd=o,null}function ug(o){switch(o){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Br()){case cn:return 1;case ds:return 4;case Cs:case Mi:return 16;case Gr:return 536870912;default:return 16}default:return 16}}var Xr=null,hu=null,fi=null;function Ch(){if(fi)return fi;var o,a=hu,h=a.length,g,_="value"in Xr?Xr.value:Xr.textContent,C=_.length;for(o=0;o<h&&a[o]===_[o];o++);var P=h-o;for(g=1;g<=P&&a[h-g]===_[C-g];g++);return fi=_.slice(o,1<g?1-g:void 0)}function nc(o){var a=o.keyCode;return"charCode"in o?(o=o.charCode,o===0&&a===13&&(o=13)):o=a,o===10&&(o=13),32<=o||o===13?o:0}function fs(){return!0}function Nh(){return!1}function Ts(o){function a(h,g,_,C,P){this._reactName=h,this._targetInst=_,this.type=g,this.nativeEvent=C,this.target=P,this.currentTarget=null;for(var W in o)o.hasOwnProperty(W)&&(h=o[W],this[W]=h?h(C):C[W]);return this.isDefaultPrevented=(C.defaultPrevented!=null?C.defaultPrevented:C.returnValue===!1)?fs:Nh,this.isPropagationStopped=Nh,this}return Q(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=fs)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=fs)},persist:function(){},isPersistent:fs}),a}var al={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(o){return o.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Sd=Ts(al),sc=Q({},al,{view:0,detail:0}),dg=Ts(sc),hs,Th,Zn,Ed=Q({},sc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:jh,button:0,buttons:0,relatedTarget:function(o){return o.relatedTarget===void 0?o.fromElement===o.srcElement?o.toElement:o.fromElement:o.relatedTarget},movementX:function(o){return"movementX"in o?o.movementX:(o!==Zn&&(Zn&&o.type==="mousemove"?(hs=o.screenX-Zn.screenX,Th=o.screenY-Zn.screenY):Th=hs=0,Zn=o),hs)},movementY:function(o){return"movementY"in o?o.movementY:Th}}),Ah=Ts(Ed),ga=Q({},Ed,{dataTransfer:0}),kd=Ts(ga),Ih=Q({},sc,{relatedTarget:0}),zr=Ts(Ih),va=Q({},al,{animationName:0,elapsedTime:0,pseudoElement:0}),Rh=Ts(va),p0=Q({},al,{clipboardData:function(o){return"clipboardData"in o?o.clipboardData:window.clipboardData}}),Ph=Ts(p0),m0=Q({},al,{data:0}),fg=Ts(m0),g0={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},hg={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Cd={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function oc(o){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(o):(o=Cd[o])?!!a[o]:!1}function jh(){return oc}var pg=Q({},sc,{key:function(o){if(o.key){var a=g0[o.key]||o.key;if(a!=="Unidentified")return a}return o.type==="keypress"?(o=nc(o),o===13?"Enter":String.fromCharCode(o)):o.type==="keydown"||o.type==="keyup"?hg[o.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:jh,charCode:function(o){return o.type==="keypress"?nc(o):0},keyCode:function(o){return o.type==="keydown"||o.type==="keyup"?o.keyCode:0},which:function(o){return o.type==="keypress"?nc(o):o.type==="keydown"||o.type==="keyup"?o.keyCode:0}}),mg=Ts(pg),Fh=Q({},Ed,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Nd=Ts(Fh),gg=Q({},sc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:jh}),v0=Ts(gg),Oh=Q({},al,{propertyName:0,elapsedTime:0,pseudoElement:0}),Dh=Ts(Oh),y0=Q({},Ed,{deltaX:function(o){return"deltaX"in o?o.deltaX:"wheelDeltaX"in o?-o.wheelDeltaX:0},deltaY:function(o){return"deltaY"in o?o.deltaY:"wheelDeltaY"in o?-o.wheelDeltaY:"wheelDelta"in o?-o.wheelDelta:0},deltaZ:0,deltaMode:0}),vg=Ts(y0),Js=[9,13,27,32],pu=d&&"CompositionEvent"in window,zi=null;d&&"documentMode"in document&&(zi=document.documentMode);var yg=d&&"TextEvent"in window&&!zi,Lh=d&&(!pu||zi&&8<zi&&11>=zi),xg=" ",wg=!1;function bg(o,a){switch(o){case"keyup":return Js.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function _g(o){return o=o.detail,typeof o=="object"&&"data"in o?o.data:null}var ic=!1;function ac(o,a){switch(o){case"compositionend":return _g(a);case"keypress":return a.which!==32?null:(wg=!0,xg);case"textInput":return o=a.data,o===xg&&wg?null:o;default:return null}}function x0(o,a){if(ic)return o==="compositionend"||!pu&&bg(o,a)?(o=Ch(),fi=hu=Xr=null,ic=!1,o):null;switch(o){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return Lh&&a.locale!=="ko"?null:a.data;default:return null}}var w0={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Td(o){var a=o&&o.nodeName&&o.nodeName.toLowerCase();return a==="input"?!!w0[o.type]:a==="textarea"}function Mh(o,a,h,g){Oo(g),a=Ld(a,"onChange"),0<a.length&&(h=new Sd("onChange","change",null,h,g),o.push({event:h,listeners:a}))}var mo=null,ya=null;function b0(o){Ag(o,0)}function Ad(o){var a=tr(o);if(Te(a))return o}function _0(o,a){if(o==="change")return a}var ll=!1;if(d){var Xs;if(d){var Id="oninput"in document;if(!Id){var Sg=document.createElement("div");Sg.setAttribute("oninput","return;"),Id=typeof Sg.oninput=="function"}Xs=Id}else Xs=!1;ll=Xs&&(!document.documentMode||9<document.documentMode)}function Eg(){mo&&(mo.detachEvent("onpropertychange",kg),ya=mo=null)}function kg(o){if(o.propertyName==="value"&&Ad(ya)){var a=[];Mh(a,ya,o,lr(o)),Do(b0,a)}}function S0(o,a,h){o==="focusin"?(Eg(),mo=a,ya=h,mo.attachEvent("onpropertychange",kg)):o==="focusout"&&Eg()}function E0(o){if(o==="selectionchange"||o==="keyup"||o==="keydown")return Ad(ya)}function lc(o,a){if(o==="click")return Ad(a)}function oe(o,a){if(o==="input"||o==="change")return Ad(a)}function Ce(o,a){return o===a&&(o!==0||1/o===1/a)||o!==o&&a!==a}var ve=typeof Object.is=="function"?Object.is:Ce;function rt(o,a){if(ve(o,a))return!0;if(typeof o!="object"||o===null||typeof a!="object"||a===null)return!1;var h=Object.keys(o),g=Object.keys(a);if(h.length!==g.length)return!1;for(g=0;g<h.length;g++){var _=h[g];if(!m.call(a,_)||!ve(o[_],a[_]))return!1}return!0}function qt(o){for(;o&&o.firstChild;)o=o.firstChild;return o}function Er(o,a){var h=qt(o);o=0;for(var g;h;){if(h.nodeType===3){if(g=o+h.textContent.length,o<=a&&g>=a)return{node:h,offset:a-o};o=g}e:{for(;h;){if(h.nextSibling){h=h.nextSibling;break e}h=h.parentNode}h=void 0}h=qt(h)}}function vn(o,a){return o&&a?o===a?!0:o&&o.nodeType===3?!1:a&&a.nodeType===3?vn(o,a.parentNode):"contains"in o?o.contains(a):o.compareDocumentPosition?!!(o.compareDocumentPosition(a)&16):!1:!1}function Dr(){for(var o=window,a=Ge();a instanceof o.HTMLIFrameElement;){try{var h=typeof a.contentWindow.location.href=="string"}catch{h=!1}if(h)o=a.contentWindow;else break;a=Ge(o.document)}return a}function mu(o){var a=o&&o.nodeName&&o.nodeName.toLowerCase();return a&&(a==="input"&&(o.type==="text"||o.type==="search"||o.type==="tel"||o.type==="url"||o.type==="password")||a==="textarea"||o.contentEditable==="true")}function k0(o){var a=Dr(),h=o.focusedElem,g=o.selectionRange;if(a!==h&&h&&h.ownerDocument&&vn(h.ownerDocument.documentElement,h)){if(g!==null&&mu(h)){if(a=g.start,o=g.end,o===void 0&&(o=a),"selectionStart"in h)h.selectionStart=a,h.selectionEnd=Math.min(o,h.value.length);else if(o=(a=h.ownerDocument||document)&&a.defaultView||window,o.getSelection){o=o.getSelection();var _=h.textContent.length,C=Math.min(g.start,_);g=g.end===void 0?C:Math.min(g.end,_),!o.extend&&C>g&&(_=g,g=C,C=_),_=Er(h,C);var P=Er(h,g);_&&P&&(o.rangeCount!==1||o.anchorNode!==_.node||o.anchorOffset!==_.offset||o.focusNode!==P.node||o.focusOffset!==P.offset)&&(a=a.createRange(),a.setStart(_.node,_.offset),o.removeAllRanges(),C>g?(o.addRange(a),o.extend(P.node,P.offset)):(a.setEnd(P.node,P.offset),o.addRange(a)))}}for(a=[],o=h;o=o.parentNode;)o.nodeType===1&&a.push({element:o,left:o.scrollLeft,top:o.scrollTop});for(typeof h.focus=="function"&&h.focus(),h=0;h<a.length;h++)o=a[h],o.element.scrollLeft=o.left,o.element.scrollTop=o.top}}var go=d&&"documentMode"in document&&11>=document.documentMode,Hi=null,$h=null,hi=null,cc=!1;function gu(o,a,h){var g=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;cc||Hi==null||Hi!==Ge(g)||(g=Hi,"selectionStart"in g&&mu(g)?g={start:g.selectionStart,end:g.selectionEnd}:(g=(g.ownerDocument&&g.ownerDocument.defaultView||window).getSelection(),g={anchorNode:g.anchorNode,anchorOffset:g.anchorOffset,focusNode:g.focusNode,focusOffset:g.focusOffset}),hi&&rt(hi,g)||(hi=g,g=Ld($h,"onSelect"),0<g.length&&(a=new Sd("onSelect","select",null,a,h),o.push({event:a,listeners:g}),a.target=Hi)))}function yr(o,a){var h={};return h[o.toLowerCase()]=a.toLowerCase(),h["Webkit"+o]="webkit"+a,h["Moz"+o]="moz"+a,h}var uc={animationend:yr("Animation","AnimationEnd"),animationiteration:yr("Animation","AnimationIteration"),animationstart:yr("Animation","AnimationStart"),transitionend:yr("Transition","TransitionEnd")},Rd={},vu={};d&&(vu=document.createElement("div").style,"AnimationEvent"in window||(delete uc.animationend.animation,delete uc.animationiteration.animation,delete uc.animationstart.animation),"TransitionEvent"in window||delete uc.transitionend.transition);function Pd(o){if(Rd[o])return Rd[o];if(!uc[o])return o;var a=uc[o],h;for(h in a)if(a.hasOwnProperty(h)&&h in vu)return Rd[o]=a[h];return o}var Cg=Pd("animationend"),Ng=Pd("animationiteration"),yu=Pd("animationstart"),Bi=Pd("transitionend"),xu=new Map,Uh="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function $o(o,a){xu.set(o,a),i(a,[o])}for(var jd=0;jd<Uh.length;jd++){var Fd=Uh[jd],Od=Fd.toLowerCase(),Tg=Fd[0].toUpperCase()+Fd.slice(1);$o(Od,"on"+Tg)}$o(Cg,"onAnimationEnd"),$o(Ng,"onAnimationIteration"),$o(yu,"onAnimationStart"),$o("dblclick","onDoubleClick"),$o("focusin","onFocus"),$o("focusout","onBlur"),$o(Bi,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),i("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),i("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),i("onBeforeInput",["compositionend","keypress","textInput","paste"]),i("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Gi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),cl=new Set("cancel close invalid load scroll toggle".split(" ").concat(Gi));function wu(o,a,h){var g=o.type||"unknown-event";o.currentTarget=h,dt(g,a,void 0,o),o.currentTarget=null}function Ag(o,a){a=(a&4)!==0;for(var h=0;h<o.length;h++){var g=o[h],_=g.event;g=g.listeners;e:{var C=void 0;if(a)for(var P=g.length-1;0<=P;P--){var W=g[P],Z=W.instance,xe=W.currentTarget;if(W=W.listener,Z!==C&&_.isPropagationStopped())break e;wu(_,W,xe),C=Z}else for(P=0;P<g.length;P++){if(W=g[P],Z=W.instance,xe=W.currentTarget,W=W.listener,Z!==C&&_.isPropagationStopped())break e;wu(_,W,xe),C=Z}}}if(Pn)throw o=le,Pn=!1,le=null,o}function Wr(o,a){var h=a[Ud];h===void 0&&(h=a[Ud]=new Set);var g=o+"__bubble";h.has(g)||(Dd(a,o,2,!1),h.add(g))}function zh(o,a,h){var g=0;a&&(g|=4),Dd(h,o,g,a)}var ul="_reactListening"+Math.random().toString(36).slice(2);function xa(o){if(!o[ul]){o[ul]=!0,n.forEach(function(h){h!=="selectionchange"&&(cl.has(h)||zh(h,!1,o),zh(h,!0,o))});var a=o.nodeType===9?o:o.ownerDocument;a===null||a[ul]||(a[ul]=!0,zh("selectionchange",!1,a))}}function Dd(o,a,h,g){switch(ug(a)){case 1:var _=xd;break;case 4:_=wd;break;default:_=il}h=_.bind(null,a,h,o),_=void 0,!Gs||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(_=!0),g?_!==void 0?o.addEventListener(a,h,{capture:!0,passive:_}):o.addEventListener(a,h,!0):_!==void 0?o.addEventListener(a,h,{passive:_}):o.addEventListener(a,h,!1)}function Hh(o,a,h,g,_){var C=g;if((a&1)===0&&(a&2)===0&&g!==null)e:for(;;){if(g===null)return;var P=g.tag;if(P===3||P===4){var W=g.stateNode.containerInfo;if(W===_||W.nodeType===8&&W.parentNode===_)break;if(P===4)for(P=g.return;P!==null;){var Z=P.tag;if((Z===3||Z===4)&&(Z=P.stateNode.containerInfo,Z===_||Z.nodeType===8&&Z.parentNode===_))return;P=P.return}for(;W!==null;){if(P=mi(W),P===null)return;if(Z=P.tag,Z===5||Z===6){g=C=P;continue e}W=W.parentNode}}g=g.return}Do(function(){var xe=C,Oe=lr(h),Ue=[];e:{var Fe=xu.get(o);if(Fe!==void 0){var nt=Sd,gt=o;switch(o){case"keypress":if(nc(h)===0)break e;case"keydown":case"keyup":nt=mg;break;case"focusin":gt="focus",nt=zr;break;case"focusout":gt="blur",nt=zr;break;case"beforeblur":case"afterblur":nt=zr;break;case"click":if(h.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":nt=Ah;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":nt=kd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":nt=v0;break;case Cg:case Ng:case yu:nt=Rh;break;case Bi:nt=Dh;break;case"scroll":nt=dg;break;case"wheel":nt=vg;break;case"copy":case"cut":case"paste":nt=Ph;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":nt=Nd}var vt=(a&4)!==0,dn=!vt&&o==="scroll",fe=vt?Fe!==null?Fe+"Capture":null:Fe;vt=[];for(var ne=xe,pe;ne!==null;){pe=ne;var He=pe.stateNode;if(pe.tag===5&&He!==null&&(pe=He,fe!==null&&(He=Sn(ne,fe),He!=null&&vt.push(dc(ne,He,pe)))),dn)break;ne=ne.return}0<vt.length&&(Fe=new nt(Fe,gt,null,h,Oe),Ue.push({event:Fe,listeners:vt}))}}if((a&7)===0){e:{if(Fe=o==="mouseover"||o==="pointerover",nt=o==="mouseout"||o==="pointerout",Fe&&h!==Ut&&(gt=h.relatedTarget||h.fromElement)&&(mi(gt)||gt[Qs]))break e;if((nt||Fe)&&(Fe=Oe.window===Oe?Oe:(Fe=Oe.ownerDocument)?Fe.defaultView||Fe.parentWindow:window,nt?(gt=h.relatedTarget||h.toElement,nt=xe,gt=gt?mi(gt):null,gt!==null&&(dn=ot(gt),gt!==dn||gt.tag!==5&&gt.tag!==6)&&(gt=null)):(nt=null,gt=xe),nt!==gt)){if(vt=Ah,He="onMouseLeave",fe="onMouseEnter",ne="mouse",(o==="pointerout"||o==="pointerover")&&(vt=Nd,He="onPointerLeave",fe="onPointerEnter",ne="pointer"),dn=nt==null?Fe:tr(nt),pe=gt==null?Fe:tr(gt),Fe=new vt(He,ne+"leave",nt,h,Oe),Fe.target=dn,Fe.relatedTarget=pe,He=null,mi(Oe)===xe&&(vt=new vt(fe,ne+"enter",gt,h,Oe),vt.target=pe,vt.relatedTarget=dn,He=vt),dn=He,nt&&gt)t:{for(vt=nt,fe=gt,ne=0,pe=vt;pe;pe=fc(pe))ne++;for(pe=0,He=fe;He;He=fc(He))pe++;for(;0<ne-pe;)vt=fc(vt),ne--;for(;0<pe-ne;)fe=fc(fe),pe--;for(;ne--;){if(vt===fe||fe!==null&&vt===fe.alternate)break t;vt=fc(vt),fe=fc(fe)}vt=null}else vt=null;nt!==null&&yn(Ue,Fe,nt,vt,!1),gt!==null&&dn!==null&&yn(Ue,dn,gt,vt,!0)}}e:{if(Fe=xe?tr(xe):window,nt=Fe.nodeName&&Fe.nodeName.toLowerCase(),nt==="select"||nt==="input"&&Fe.type==="file")var yt=_0;else if(Td(Fe))if(ll)yt=oe;else{yt=E0;var Ot=S0}else(nt=Fe.nodeName)&&nt.toLowerCase()==="input"&&(Fe.type==="checkbox"||Fe.type==="radio")&&(yt=lc);if(yt&&(yt=yt(o,xe))){Mh(Ue,yt,h,Oe);break e}Ot&&Ot(o,Fe,xe),o==="focusout"&&(Ot=Fe._wrapperState)&&Ot.controlled&&Fe.type==="number"&&mt(Fe,"number",Fe.value)}switch(Ot=xe?tr(xe):window,o){case"focusin":(Td(Ot)||Ot.contentEditable==="true")&&(Hi=Ot,$h=xe,hi=null);break;case"focusout":hi=$h=Hi=null;break;case"mousedown":cc=!0;break;case"contextmenu":case"mouseup":case"dragend":cc=!1,gu(Ue,h,Oe);break;case"selectionchange":if(go)break;case"keydown":case"keyup":gu(Ue,h,Oe)}var Nt;if(pu)e:{switch(o){case"compositionstart":var Ht="onCompositionStart";break e;case"compositionend":Ht="onCompositionEnd";break e;case"compositionupdate":Ht="onCompositionUpdate";break e}Ht=void 0}else ic?bg(o,h)&&(Ht="onCompositionEnd"):o==="keydown"&&h.keyCode===229&&(Ht="onCompositionStart");Ht&&(Lh&&h.locale!=="ko"&&(ic||Ht!=="onCompositionStart"?Ht==="onCompositionEnd"&&ic&&(Nt=Ch()):(Xr=Oe,hu="value"in Xr?Xr.value:Xr.textContent,ic=!0)),Ot=Ld(xe,Ht),0<Ot.length&&(Ht=new fg(Ht,o,null,h,Oe),Ue.push({event:Ht,listeners:Ot}),Nt?Ht.data=Nt:(Nt=_g(h),Nt!==null&&(Ht.data=Nt)))),(Nt=yg?ac(o,h):x0(o,h))&&(xe=Ld(xe,"onBeforeInput"),0<xe.length&&(Oe=new fg("onBeforeInput","beforeinput",null,h,Oe),Ue.push({event:Oe,listeners:xe}),Oe.data=Nt))}Ag(Ue,a)})}function dc(o,a,h){return{instance:o,listener:a,currentTarget:h}}function Ld(o,a){for(var h=a+"Capture",g=[];o!==null;){var _=o,C=_.stateNode;_.tag===5&&C!==null&&(_=C,C=Sn(o,h),C!=null&&g.unshift(dc(o,C,_)),C=Sn(o,a),C!=null&&g.push(dc(o,C,_))),o=o.return}return g}function fc(o){if(o===null)return null;do o=o.return;while(o&&o.tag!==5);return o||null}function yn(o,a,h,g,_){for(var C=a._reactName,P=[];h!==null&&h!==g;){var W=h,Z=W.alternate,xe=W.stateNode;if(Z!==null&&Z===g)break;W.tag===5&&xe!==null&&(W=xe,_?(Z=Sn(h,C),Z!=null&&P.unshift(dc(h,Z,W))):_||(Z=Sn(h,C),Z!=null&&P.push(dc(h,Z,W)))),h=h.return}P.length!==0&&o.push({event:a,listeners:P})}var es=/\r\n?/g,C0=/\u0000|\uFFFD/g;function Ig(o){return(typeof o=="string"?o:""+o).replace(es,`
`).replace(C0,"")}function bu(o,a,h){if(a=Ig(a),Ig(o)!==a&&h)throw Error(t(425))}function Md(){}var _u=null,dl=null;function Su(o,a){return o==="textarea"||o==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var wa=typeof setTimeout=="function"?setTimeout:void 0,Eu=typeof clearTimeout=="function"?clearTimeout:void 0,hc=typeof Promise=="function"?Promise:void 0,$d=typeof queueMicrotask=="function"?queueMicrotask:typeof hc<"u"?function(o){return hc.resolve(null).then(o).catch(pc)}:wa;function pc(o){setTimeout(function(){throw o})}function Bh(o,a){var h=a,g=0;do{var _=h.nextSibling;if(o.removeChild(h),_&&_.nodeType===8)if(h=_.data,h==="/$"){if(g===0){o.removeChild(_),er(a);return}g--}else h!=="$"&&h!=="$?"&&h!=="$!"||g++;h=_}while(h);er(a)}function ba(o){for(;o!=null;o=o.nextSibling){var a=o.nodeType;if(a===1||a===3)break;if(a===8){if(a=o.data,a==="$"||a==="$!"||a==="$?")break;if(a==="/$")return null}}return o}function Rg(o){o=o.previousSibling;for(var a=0;o;){if(o.nodeType===8){var h=o.data;if(h==="$"||h==="$!"||h==="$?"){if(a===0)return o;a--}else h==="/$"&&a++}o=o.previousSibling}return null}var mc=Math.random().toString(36).slice(2),pi="__reactFiber$"+mc,_a="__reactProps$"+mc,Qs="__reactContainer$"+mc,Ud="__reactEvents$"+mc,L="__reactListeners$"+mc,gc="__reactHandles$"+mc;function mi(o){var a=o[pi];if(a)return a;for(var h=o.parentNode;h;){if(a=h[Qs]||h[pi]){if(h=a.alternate,a.child!==null||h!==null&&h.child!==null)for(o=Rg(o);o!==null;){if(h=o[pi])return h;o=Rg(o)}return a}o=h,h=o.parentNode}return null}function ts(o){return o=o[pi]||o[Qs],!o||o.tag!==5&&o.tag!==6&&o.tag!==13&&o.tag!==3?null:o}function tr(o){if(o.tag===5||o.tag===6)return o.stateNode;throw Error(t(33))}function zd(o){return o[_a]||null}var Gh=[],vc=-1;function As(o){return{current:o}}function Vr(o){0>vc||(o.current=Gh[vc],Gh[vc]=null,vc--)}function Hr(o,a){vc++,Gh[vc]=o.current,o.current=a}var Sa={},rs=As(Sa),Is=As(!1),ps=Sa;function yc(o,a){var h=o.type.contextTypes;if(!h)return Sa;var g=o.stateNode;if(g&&g.__reactInternalMemoizedUnmaskedChildContext===a)return g.__reactInternalMemoizedMaskedChildContext;var _={},C;for(C in h)_[C]=a[C];return g&&(o=o.stateNode,o.__reactInternalMemoizedUnmaskedChildContext=a,o.__reactInternalMemoizedMaskedChildContext=_),_}function Rs(o){return o=o.childContextTypes,o!=null}function Hd(){Vr(Is),Vr(rs)}function Pg(o,a,h){if(rs.current!==Sa)throw Error(t(168));Hr(rs,a),Hr(Is,h)}function jg(o,a,h){var g=o.stateNode;if(a=a.childContextTypes,typeof g.getChildContext!="function")return h;g=g.getChildContext();for(var _ in g)if(!(_ in a))throw Error(t(108,X(o)||"Unknown",_));return Q({},h,g)}function vo(o){return o=(o=o.stateNode)&&o.__reactInternalMemoizedMergedChildContext||Sa,ps=rs.current,Hr(rs,o),Hr(Is,Is.current),!0}function Fg(o,a,h){var g=o.stateNode;if(!g)throw Error(t(169));h?(o=jg(o,a,ps),g.__reactInternalMemoizedMergedChildContext=o,Vr(Is),Vr(rs),Hr(rs,o)):Vr(Is),Hr(Is,h)}var Wi=null,Bd=!1,Wh=!1;function Og(o){Wi===null?Wi=[o]:Wi.push(o)}function fl(o){Bd=!0,Og(o)}function Ea(){if(!Wh&&Wi!==null){Wh=!0;var o=0,a=vr;try{var h=Wi;for(vr=1;o<h.length;o++){var g=h[o];do g=g(!0);while(g!==null)}Wi=null,Bd=!1}catch(_){throw Wi!==null&&(Wi=Wi.slice(o+1)),q(cn,Ea),_}finally{vr=a,Wh=!1}}return null}var xc=[],ns=0,Gd=null,Wd=0,yo=[],xo=0,hl=null,gi=1,vi="";function pl(o,a){xc[ns++]=Wd,xc[ns++]=Gd,Gd=o,Wd=a}function Dg(o,a,h){yo[xo++]=gi,yo[xo++]=vi,yo[xo++]=hl,hl=o;var g=gi;o=vi;var _=32-Ns(g)-1;g&=~(1<<_),h+=1;var C=32-Ns(a)+_;if(30<C){var P=_-_%5;C=(g&(1<<P)-1).toString(32),g>>=P,_-=P,gi=1<<32-Ns(a)+_|h<<_|g,vi=C+o}else gi=1<<C|h<<_|g,vi=o}function ku(o){o.return!==null&&(pl(o,1),Dg(o,1,0))}function ml(o){for(;o===Gd;)Gd=xc[--ns],xc[ns]=null,Wd=xc[--ns],xc[ns]=null;for(;o===hl;)hl=yo[--xo],yo[xo]=null,vi=yo[--xo],yo[xo]=null,gi=yo[--xo],yo[xo]=null}var ss=null,Zs=null,qr=!1,Uo=null;function yi(o,a){var h=Co(5,null,null,0);h.elementType="DELETED",h.stateNode=a,h.return=o,a=o.deletions,a===null?(o.deletions=[h],o.flags|=16):a.push(h)}function Vd(o,a){switch(o.tag){case 5:var h=o.type;return a=a.nodeType!==1||h.toLowerCase()!==a.nodeName.toLowerCase()?null:a,a!==null?(o.stateNode=a,ss=o,Zs=ba(a.firstChild),!0):!1;case 6:return a=o.pendingProps===""||a.nodeType!==3?null:a,a!==null?(o.stateNode=a,ss=o,Zs=null,!0):!1;case 13:return a=a.nodeType!==8?null:a,a!==null?(h=hl!==null?{id:gi,overflow:vi}:null,o.memoizedState={dehydrated:a,treeContext:h,retryLane:1073741824},h=Co(18,null,null,0),h.stateNode=a,h.return=o,o.child=h,ss=o,Zs=null,!0):!1;default:return!1}}function Vi(o){return(o.mode&1)!==0&&(o.flags&128)===0}function Ps(o){if(qr){var a=Zs;if(a){var h=a;if(!Vd(o,a)){if(Vi(o))throw Error(t(418));a=ba(h.nextSibling);var g=ss;a&&Vd(o,a)?yi(g,h):(o.flags=o.flags&-4097|2,qr=!1,ss=o)}}else{if(Vi(o))throw Error(t(418));o.flags=o.flags&-4097|2,qr=!1,ss=o}}}function Lg(o){for(o=o.return;o!==null&&o.tag!==5&&o.tag!==3&&o.tag!==13;)o=o.return;ss=o}function Cu(o){if(o!==ss)return!1;if(!qr)return Lg(o),qr=!0,!1;var a;if((a=o.tag!==3)&&!(a=o.tag!==5)&&(a=o.type,a=a!=="head"&&a!=="body"&&!Su(o.type,o.memoizedProps)),a&&(a=Zs)){if(Vi(o))throw Vh(),Error(t(418));for(;a;)yi(o,a),a=ba(a.nextSibling)}if(Lg(o),o.tag===13){if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(t(317));e:{for(o=o.nextSibling,a=0;o;){if(o.nodeType===8){var h=o.data;if(h==="/$"){if(a===0){Zs=ba(o.nextSibling);break e}a--}else h!=="$"&&h!=="$!"&&h!=="$?"||a++}o=o.nextSibling}Zs=null}}else Zs=ss?ba(o.stateNode.nextSibling):null;return!0}function Vh(){for(var o=Zs;o;)o=ba(o.nextSibling)}function xi(){Zs=ss=null,qr=!1}function wi(o){Uo===null?Uo=[o]:Uo.push(o)}var Mg=j.ReactCurrentBatchConfig;function Nu(o,a,h){if(o=h.ref,o!==null&&typeof o!="function"&&typeof o!="object"){if(h._owner){if(h=h._owner,h){if(h.tag!==1)throw Error(t(309));var g=h.stateNode}if(!g)throw Error(t(147,o));var _=g,C=""+o;return a!==null&&a.ref!==null&&typeof a.ref=="function"&&a.ref._stringRef===C?a.ref:(a=function(P){var W=_.refs;P===null?delete W[C]:W[C]=P},a._stringRef=C,a)}if(typeof o!="string")throw Error(t(284));if(!h._owner)throw Error(t(290,o))}return o}function gl(o,a){throw o=Object.prototype.toString.call(a),Error(t(31,o==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":o))}function $g(o){var a=o._init;return a(o._payload)}function qh(o){function a(fe,ne){if(o){var pe=fe.deletions;pe===null?(fe.deletions=[ne],fe.flags|=16):pe.push(ne)}}function h(fe,ne){if(!o)return null;for(;ne!==null;)a(fe,ne),ne=ne.sibling;return null}function g(fe,ne){for(fe=new Map;ne!==null;)ne.key!==null?fe.set(ne.key,ne):fe.set(ne.index,ne),ne=ne.sibling;return fe}function _(fe,ne){return fe=qo(fe,ne),fe.index=0,fe.sibling=null,fe}function C(fe,ne,pe){return fe.index=pe,o?(pe=fe.alternate,pe!==null?(pe=pe.index,pe<ne?(fe.flags|=2,ne):pe):(fe.flags|=2,ne)):(fe.flags|=1048576,ne)}function P(fe){return o&&fe.alternate===null&&(fe.flags|=2),fe}function W(fe,ne,pe,He){return ne===null||ne.tag!==6?(ne=jp(pe,fe.mode,He),ne.return=fe,ne):(ne=_(ne,pe),ne.return=fe,ne)}function Z(fe,ne,pe,He){var yt=pe.type;return yt===G?Oe(fe,ne,pe.props.children,He,pe.key):ne!==null&&(ne.elementType===yt||typeof yt=="object"&&yt!==null&&yt.$$typeof===de&&$g(yt)===ne.type)?(He=_(ne,pe.props),He.ref=Nu(fe,ne,pe),He.return=fe,He):(He=Tf(pe.type,pe.key,pe.props,null,fe.mode,He),He.ref=Nu(fe,ne,pe),He.return=fe,He)}function xe(fe,ne,pe,He){return ne===null||ne.tag!==4||ne.stateNode.containerInfo!==pe.containerInfo||ne.stateNode.implementation!==pe.implementation?(ne=Fp(pe,fe.mode,He),ne.return=fe,ne):(ne=_(ne,pe.children||[]),ne.return=fe,ne)}function Oe(fe,ne,pe,He,yt){return ne===null||ne.tag!==7?(ne=Nl(pe,fe.mode,He,yt),ne.return=fe,ne):(ne=_(ne,pe),ne.return=fe,ne)}function Ue(fe,ne,pe){if(typeof ne=="string"&&ne!==""||typeof ne=="number")return ne=jp(""+ne,fe.mode,pe),ne.return=fe,ne;if(typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case O:return pe=Tf(ne.type,ne.key,ne.props,null,fe.mode,pe),pe.ref=Nu(fe,null,ne),pe.return=fe,pe;case B:return ne=Fp(ne,fe.mode,pe),ne.return=fe,ne;case de:var He=ne._init;return Ue(fe,He(ne._payload),pe)}if(jt(ne)||$(ne))return ne=Nl(ne,fe.mode,pe,null),ne.return=fe,ne;gl(fe,ne)}return null}function Fe(fe,ne,pe,He){var yt=ne!==null?ne.key:null;if(typeof pe=="string"&&pe!==""||typeof pe=="number")return yt!==null?null:W(fe,ne,""+pe,He);if(typeof pe=="object"&&pe!==null){switch(pe.$$typeof){case O:return pe.key===yt?Z(fe,ne,pe,He):null;case B:return pe.key===yt?xe(fe,ne,pe,He):null;case de:return yt=pe._init,Fe(fe,ne,yt(pe._payload),He)}if(jt(pe)||$(pe))return yt!==null?null:Oe(fe,ne,pe,He,null);gl(fe,pe)}return null}function nt(fe,ne,pe,He,yt){if(typeof He=="string"&&He!==""||typeof He=="number")return fe=fe.get(pe)||null,W(ne,fe,""+He,yt);if(typeof He=="object"&&He!==null){switch(He.$$typeof){case O:return fe=fe.get(He.key===null?pe:He.key)||null,Z(ne,fe,He,yt);case B:return fe=fe.get(He.key===null?pe:He.key)||null,xe(ne,fe,He,yt);case de:var Ot=He._init;return nt(fe,ne,pe,Ot(He._payload),yt)}if(jt(He)||$(He))return fe=fe.get(pe)||null,Oe(ne,fe,He,yt,null);gl(ne,He)}return null}function gt(fe,ne,pe,He){for(var yt=null,Ot=null,Nt=ne,Ht=ne=0,On=null;Nt!==null&&Ht<pe.length;Ht++){Nt.index>Ht?(On=Nt,Nt=null):On=Nt.sibling;var kr=Fe(fe,Nt,pe[Ht],He);if(kr===null){Nt===null&&(Nt=On);break}o&&Nt&&kr.alternate===null&&a(fe,Nt),ne=C(kr,ne,Ht),Ot===null?yt=kr:Ot.sibling=kr,Ot=kr,Nt=On}if(Ht===pe.length)return h(fe,Nt),qr&&pl(fe,Ht),yt;if(Nt===null){for(;Ht<pe.length;Ht++)Nt=Ue(fe,pe[Ht],He),Nt!==null&&(ne=C(Nt,ne,Ht),Ot===null?yt=Nt:Ot.sibling=Nt,Ot=Nt);return qr&&pl(fe,Ht),yt}for(Nt=g(fe,Nt);Ht<pe.length;Ht++)On=nt(Nt,fe,Ht,pe[Ht],He),On!==null&&(o&&On.alternate!==null&&Nt.delete(On.key===null?Ht:On.key),ne=C(On,ne,Ht),Ot===null?yt=On:Ot.sibling=On,Ot=On);return o&&Nt.forEach(function(Da){return a(fe,Da)}),qr&&pl(fe,Ht),yt}function vt(fe,ne,pe,He){var yt=$(pe);if(typeof yt!="function")throw Error(t(150));if(pe=yt.call(pe),pe==null)throw Error(t(151));for(var Ot=yt=null,Nt=ne,Ht=ne=0,On=null,kr=pe.next();Nt!==null&&!kr.done;Ht++,kr=pe.next()){Nt.index>Ht?(On=Nt,Nt=null):On=Nt.sibling;var Da=Fe(fe,Nt,kr.value,He);if(Da===null){Nt===null&&(Nt=On);break}o&&Nt&&Da.alternate===null&&a(fe,Nt),ne=C(Da,ne,Ht),Ot===null?yt=Da:Ot.sibling=Da,Ot=Da,Nt=On}if(kr.done)return h(fe,Nt),qr&&pl(fe,Ht),yt;if(Nt===null){for(;!kr.done;Ht++,kr=pe.next())kr=Ue(fe,kr.value,He),kr!==null&&(ne=C(kr,ne,Ht),Ot===null?yt=kr:Ot.sibling=kr,Ot=kr);return qr&&pl(fe,Ht),yt}for(Nt=g(fe,Nt);!kr.done;Ht++,kr=pe.next())kr=nt(Nt,fe,Ht,kr.value,He),kr!==null&&(o&&kr.alternate!==null&&Nt.delete(kr.key===null?Ht:kr.key),ne=C(kr,ne,Ht),Ot===null?yt=kr:Ot.sibling=kr,Ot=kr);return o&&Nt.forEach(function(q0){return a(fe,q0)}),qr&&pl(fe,Ht),yt}function dn(fe,ne,pe,He){if(typeof pe=="object"&&pe!==null&&pe.type===G&&pe.key===null&&(pe=pe.props.children),typeof pe=="object"&&pe!==null){switch(pe.$$typeof){case O:e:{for(var yt=pe.key,Ot=ne;Ot!==null;){if(Ot.key===yt){if(yt=pe.type,yt===G){if(Ot.tag===7){h(fe,Ot.sibling),ne=_(Ot,pe.props.children),ne.return=fe,fe=ne;break e}}else if(Ot.elementType===yt||typeof yt=="object"&&yt!==null&&yt.$$typeof===de&&$g(yt)===Ot.type){h(fe,Ot.sibling),ne=_(Ot,pe.props),ne.ref=Nu(fe,Ot,pe),ne.return=fe,fe=ne;break e}h(fe,Ot);break}else a(fe,Ot);Ot=Ot.sibling}pe.type===G?(ne=Nl(pe.props.children,fe.mode,He,pe.key),ne.return=fe,fe=ne):(He=Tf(pe.type,pe.key,pe.props,null,fe.mode,He),He.ref=Nu(fe,ne,pe),He.return=fe,fe=He)}return P(fe);case B:e:{for(Ot=pe.key;ne!==null;){if(ne.key===Ot)if(ne.tag===4&&ne.stateNode.containerInfo===pe.containerInfo&&ne.stateNode.implementation===pe.implementation){h(fe,ne.sibling),ne=_(ne,pe.children||[]),ne.return=fe,fe=ne;break e}else{h(fe,ne);break}else a(fe,ne);ne=ne.sibling}ne=Fp(pe,fe.mode,He),ne.return=fe,fe=ne}return P(fe);case de:return Ot=pe._init,dn(fe,ne,Ot(pe._payload),He)}if(jt(pe))return gt(fe,ne,pe,He);if($(pe))return vt(fe,ne,pe,He);gl(fe,pe)}return typeof pe=="string"&&pe!==""||typeof pe=="number"?(pe=""+pe,ne!==null&&ne.tag===6?(h(fe,ne.sibling),ne=_(ne,pe),ne.return=fe,fe=ne):(h(fe,ne),ne=jp(pe,fe.mode,He),ne.return=fe,fe=ne),P(fe)):h(fe,ne)}return dn}var an=qh(!0),qd=qh(!1),Tu=As(null),eo=null,ka=null,wc=null;function qi(){wc=ka=eo=null}function Kd(o){var a=Tu.current;Vr(Tu),o._currentValue=a}function Hn(o,a,h){for(;o!==null;){var g=o.alternate;if((o.childLanes&a)!==a?(o.childLanes|=a,g!==null&&(g.childLanes|=a)):g!==null&&(g.childLanes&a)!==a&&(g.childLanes|=a),o===h)break;o=o.return}}function Ca(o,a){eo=o,wc=ka=null,o=o.dependencies,o!==null&&o.firstContext!==null&&((o.lanes&a)!==0&&(gs=!0),o.firstContext=null)}function wo(o){var a=o._currentValue;if(wc!==o)if(o={context:o,memoizedValue:a,next:null},ka===null){if(eo===null)throw Error(t(308));ka=o,eo.dependencies={lanes:0,firstContext:o}}else ka=ka.next=o;return a}var vl=null;function Kh(o){vl===null?vl=[o]:vl.push(o)}function Yd(o,a,h,g){var _=a.interleaved;return _===null?(h.next=h,Kh(a)):(h.next=_.next,_.next=h),a.interleaved=h,Ki(o,g)}function Ki(o,a){o.lanes|=a;var h=o.alternate;for(h!==null&&(h.lanes|=a),h=o,o=o.return;o!==null;)o.childLanes|=a,h=o.alternate,h!==null&&(h.childLanes|=a),h=o,o=o.return;return h.tag===3?h.stateNode:null}var bo=!1;function Jd(o){o.updateQueue={baseState:o.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ug(o,a){o=o.updateQueue,a.updateQueue===o&&(a.updateQueue={baseState:o.baseState,firstBaseUpdate:o.firstBaseUpdate,lastBaseUpdate:o.lastBaseUpdate,shared:o.shared,effects:o.effects})}function Yi(o,a){return{eventTime:o,lane:a,tag:0,payload:null,callback:null,next:null}}function _o(o,a,h){var g=o.updateQueue;if(g===null)return null;if(g=g.shared,(xr&2)!==0){var _=g.pending;return _===null?a.next=a:(a.next=_.next,_.next=a),g.pending=a,Ki(o,h)}return _=g.interleaved,_===null?(a.next=a,Kh(g)):(a.next=_.next,_.next=a),g.interleaved=a,Ki(o,h)}function Xd(o,a,h){if(a=a.updateQueue,a!==null&&(a=a.shared,(h&4194240)!==0)){var g=a.lanes;g&=o.pendingLanes,h|=g,a.lanes=h,nl(o,h)}}function zg(o,a){var h=o.updateQueue,g=o.alternate;if(g!==null&&(g=g.updateQueue,h===g)){var _=null,C=null;if(h=h.firstBaseUpdate,h!==null){do{var P={eventTime:h.eventTime,lane:h.lane,tag:h.tag,payload:h.payload,callback:h.callback,next:null};C===null?_=C=P:C=C.next=P,h=h.next}while(h!==null);C===null?_=C=a:C=C.next=a}else _=C=a;h={baseState:g.baseState,firstBaseUpdate:_,lastBaseUpdate:C,shared:g.shared,effects:g.effects},o.updateQueue=h;return}o=h.lastBaseUpdate,o===null?h.firstBaseUpdate=a:o.next=a,h.lastBaseUpdate=a}function bc(o,a,h,g){var _=o.updateQueue;bo=!1;var C=_.firstBaseUpdate,P=_.lastBaseUpdate,W=_.shared.pending;if(W!==null){_.shared.pending=null;var Z=W,xe=Z.next;Z.next=null,P===null?C=xe:P.next=xe,P=Z;var Oe=o.alternate;Oe!==null&&(Oe=Oe.updateQueue,W=Oe.lastBaseUpdate,W!==P&&(W===null?Oe.firstBaseUpdate=xe:W.next=xe,Oe.lastBaseUpdate=Z))}if(C!==null){var Ue=_.baseState;P=0,Oe=xe=Z=null,W=C;do{var Fe=W.lane,nt=W.eventTime;if((g&Fe)===Fe){Oe!==null&&(Oe=Oe.next={eventTime:nt,lane:0,tag:W.tag,payload:W.payload,callback:W.callback,next:null});e:{var gt=o,vt=W;switch(Fe=a,nt=h,vt.tag){case 1:if(gt=vt.payload,typeof gt=="function"){Ue=gt.call(nt,Ue,Fe);break e}Ue=gt;break e;case 3:gt.flags=gt.flags&-65537|128;case 0:if(gt=vt.payload,Fe=typeof gt=="function"?gt.call(nt,Ue,Fe):gt,Fe==null)break e;Ue=Q({},Ue,Fe);break e;case 2:bo=!0}}W.callback!==null&&W.lane!==0&&(o.flags|=64,Fe=_.effects,Fe===null?_.effects=[W]:Fe.push(W))}else nt={eventTime:nt,lane:Fe,tag:W.tag,payload:W.payload,callback:W.callback,next:null},Oe===null?(xe=Oe=nt,Z=Ue):Oe=Oe.next=nt,P|=Fe;if(W=W.next,W===null){if(W=_.shared.pending,W===null)break;Fe=W,W=Fe.next,Fe.next=null,_.lastBaseUpdate=Fe,_.shared.pending=null}}while(!0);if(Oe===null&&(Z=Ue),_.baseState=Z,_.firstBaseUpdate=xe,_.lastBaseUpdate=Oe,a=_.shared.interleaved,a!==null){_=a;do P|=_.lane,_=_.next;while(_!==a)}else C===null&&(_.shared.lanes=0);Ra|=P,o.lanes=P,o.memoizedState=Ue}}function Yh(o,a,h){if(o=a.effects,a.effects=null,o!==null)for(a=0;a<o.length;a++){var g=o[a],_=g.callback;if(_!==null){if(g.callback=null,g=h,typeof _!="function")throw Error(t(191,_));_.call(g)}}}var Au={},bi=As(Au),Iu=As(Au),_c=As(Au);function Ji(o){if(o===Au)throw Error(t(174));return o}function Jh(o,a){switch(Hr(_c,a),Hr(Iu,o),Hr(bi,Au),o=a.nodeType,o){case 9:case 11:a=(a=a.documentElement)?a.namespaceURI:je(null,"");break;default:o=o===8?a.parentNode:a,a=o.namespaceURI||null,o=o.tagName,a=je(a,o)}Vr(bi),Hr(bi,a)}function Na(){Vr(bi),Vr(Iu),Vr(_c)}function Xh(o){Ji(_c.current);var a=Ji(bi.current),h=je(a,o.type);a!==h&&(Hr(Iu,o),Hr(bi,h))}function Qd(o){Iu.current===o&&(Vr(bi),Vr(Iu))}var Qr=As(0);function yl(o){for(var a=o;a!==null;){if(a.tag===13){var h=a.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||h.data==="$?"||h.data==="$!"))return a}else if(a.tag===19&&a.memoizedProps.revealOrder!==void 0){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===o)break;for(;a.sibling===null;){if(a.return===null||a.return===o)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var Qh=[];function Zd(){for(var o=0;o<Qh.length;o++)Qh[o]._workInProgressVersionPrimary=null;Qh.length=0}var Ru=j.ReactCurrentDispatcher,Zh=j.ReactCurrentBatchConfig,Ta=0,tn=null,un=null,kn=null,Sc=!1,Pu=!1,xl=0,nr=0;function os(){throw Error(t(321))}function ep(o,a){if(a===null)return!1;for(var h=0;h<a.length&&h<o.length;h++)if(!ve(o[h],a[h]))return!1;return!0}function wl(o,a,h,g,_,C){if(Ta=C,tn=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,Ru.current=o===null||o.memoizedState===null?T0:af,o=h(g,_),Pu){C=0;do{if(Pu=!1,xl=0,25<=C)throw Error(t(301));C+=1,kn=un=null,a.updateQueue=null,Ru.current=Nc,o=h(g,_)}while(Pu)}if(Ru.current=of,a=un!==null&&un.next!==null,Ta=0,kn=un=tn=null,Sc=!1,a)throw Error(t(300));return o}function ef(){var o=xl!==0;return xl=0,o}function _i(){var o={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return kn===null?tn.memoizedState=kn=o:kn=kn.next=o,kn}function So(){if(un===null){var o=tn.alternate;o=o!==null?o.memoizedState:null}else o=un.next;var a=kn===null?tn.memoizedState:kn.next;if(a!==null)kn=a,un=o;else{if(o===null)throw Error(t(310));un=o,o={memoizedState:un.memoizedState,baseState:un.baseState,baseQueue:un.baseQueue,queue:un.queue,next:null},kn===null?tn.memoizedState=kn=o:kn=kn.next=o}return kn}function is(o,a){return typeof a=="function"?a(o):a}function tp(o){var a=So(),h=a.queue;if(h===null)throw Error(t(311));h.lastRenderedReducer=o;var g=un,_=g.baseQueue,C=h.pending;if(C!==null){if(_!==null){var P=_.next;_.next=C.next,C.next=P}g.baseQueue=_=C,h.pending=null}if(_!==null){C=_.next,g=g.baseState;var W=P=null,Z=null,xe=C;do{var Oe=xe.lane;if((Ta&Oe)===Oe)Z!==null&&(Z=Z.next={lane:0,action:xe.action,hasEagerState:xe.hasEagerState,eagerState:xe.eagerState,next:null}),g=xe.hasEagerState?xe.eagerState:o(g,xe.action);else{var Ue={lane:Oe,action:xe.action,hasEagerState:xe.hasEagerState,eagerState:xe.eagerState,next:null};Z===null?(W=Z=Ue,P=g):Z=Z.next=Ue,tn.lanes|=Oe,Ra|=Oe}xe=xe.next}while(xe!==null&&xe!==C);Z===null?P=g:Z.next=W,ve(g,a.memoizedState)||(gs=!0),a.memoizedState=g,a.baseState=P,a.baseQueue=Z,h.lastRenderedState=g}if(o=h.interleaved,o!==null){_=o;do C=_.lane,tn.lanes|=C,Ra|=C,_=_.next;while(_!==o)}else _===null&&(h.lanes=0);return[a.memoizedState,h.dispatch]}function Ec(o){var a=So(),h=a.queue;if(h===null)throw Error(t(311));h.lastRenderedReducer=o;var g=h.dispatch,_=h.pending,C=a.memoizedState;if(_!==null){h.pending=null;var P=_=_.next;do C=o(C,P.action),P=P.next;while(P!==_);ve(C,a.memoizedState)||(gs=!0),a.memoizedState=C,a.baseQueue===null&&(a.baseState=C),h.lastRenderedState=C}return[C,g]}function tf(){}function rp(o,a){var h=tn,g=So(),_=a(),C=!ve(g.memoizedState,_);if(C&&(g.memoizedState=_,gs=!0),g=g.queue,Si(Xi.bind(null,h,g,o),[o]),g.getSnapshot!==a||C||kn!==null&&kn.memoizedState.tag&1){if(h.flags|=2048,kc(9,js.bind(null,h,g,_,a),void 0,null),Fn===null)throw Error(t(349));(Ta&30)!==0||np(h,a,_)}return _}function np(o,a,h){o.flags|=16384,o={getSnapshot:a,value:h},a=tn.updateQueue,a===null?(a={lastEffect:null,stores:null},tn.updateQueue=a,a.stores=[o]):(h=a.stores,h===null?a.stores=[o]:h.push(o))}function js(o,a,h,g){a.value=h,a.getSnapshot=g,rf(a)&&sp(o)}function Xi(o,a,h){return h(function(){rf(a)&&sp(o)})}function rf(o){var a=o.getSnapshot;o=o.value;try{var h=a();return!ve(o,h)}catch{return!0}}function sp(o){var a=Ki(o,1);a!==null&&Vo(a,o,1,-1)}function ju(o){var a=_i();return typeof o=="function"&&(o=o()),a.memoizedState=a.baseState=o,o={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:is,lastRenderedState:o},a.queue=o,o=o.dispatch=qg.bind(null,tn,o),[a.memoizedState,o]}function kc(o,a,h,g){return o={tag:o,create:a,destroy:h,deps:g,next:null},a=tn.updateQueue,a===null?(a={lastEffect:null,stores:null},tn.updateQueue=a,a.lastEffect=o.next=o):(h=a.lastEffect,h===null?a.lastEffect=o.next=o:(g=h.next,h.next=o,o.next=g,a.lastEffect=o)),o}function nf(){return So().memoizedState}function Fu(o,a,h,g){var _=_i();tn.flags|=o,_.memoizedState=kc(1|a,h,void 0,g===void 0?null:g)}function Cc(o,a,h,g){var _=So();g=g===void 0?null:g;var C=void 0;if(un!==null){var P=un.memoizedState;if(C=P.destroy,g!==null&&ep(g,P.deps)){_.memoizedState=kc(a,h,C,g);return}}tn.flags|=o,_.memoizedState=kc(1|a,h,C,g)}function sf(o,a){return Fu(8390656,8,o,a)}function Si(o,a){return Cc(2048,8,o,a)}function Hg(o,a){return Cc(4,2,o,a)}function Qi(o,a){return Cc(4,4,o,a)}function op(o,a){if(typeof a=="function")return o=o(),a(o),function(){a(null)};if(a!=null)return o=o(),a.current=o,function(){a.current=null}}function ip(o,a,h){return h=h!=null?h.concat([o]):null,Cc(4,4,op.bind(null,a,o),h)}function Ou(){}function Bg(o,a){var h=So();a=a===void 0?null:a;var g=h.memoizedState;return g!==null&&a!==null&&ep(a,g[1])?g[0]:(h.memoizedState=[o,a],o)}function Gg(o,a){var h=So();a=a===void 0?null:a;var g=h.memoizedState;return g!==null&&a!==null&&ep(a,g[1])?g[0]:(o=o(),h.memoizedState=[o,a],o)}function Wg(o,a,h){return(Ta&21)===0?(o.baseState&&(o.baseState=!1,gs=!0),o.memoizedState=h):(ve(h,a)||(h=cu(),tn.lanes|=h,Ra|=h,o.baseState=!0),a)}function Vg(o,a){var h=vr;vr=h!==0&&4>h?h:4,o(!0);var g=Zh.transition;Zh.transition={};try{o(!1),a()}finally{vr=h,Zh.transition=g}}function ap(){return So().memoizedState}function N0(o,a,h){var g=Fa(o);if(h={lane:g,action:h,hasEagerState:!1,eagerState:null,next:null},lp(o))ms(a,h);else if(h=Yd(o,a,h,g),h!==null){var _=xs();Vo(h,o,g,_),zo(h,a,g)}}function qg(o,a,h){var g=Fa(o),_={lane:g,action:h,hasEagerState:!1,eagerState:null,next:null};if(lp(o))ms(a,_);else{var C=o.alternate;if(o.lanes===0&&(C===null||C.lanes===0)&&(C=a.lastRenderedReducer,C!==null))try{var P=a.lastRenderedState,W=C(P,h);if(_.hasEagerState=!0,_.eagerState=W,ve(W,P)){var Z=a.interleaved;Z===null?(_.next=_,Kh(a)):(_.next=Z.next,Z.next=_),a.interleaved=_;return}}catch{}finally{}h=Yd(o,a,_,g),h!==null&&(_=xs(),Vo(h,o,g,_),zo(h,a,g))}}function lp(o){var a=o.alternate;return o===tn||a!==null&&a===tn}function ms(o,a){Pu=Sc=!0;var h=o.pending;h===null?a.next=a:(a.next=h.next,h.next=a),o.pending=a}function zo(o,a,h){if((h&4194240)!==0){var g=a.lanes;g&=o.pendingLanes,h|=g,a.lanes=h,nl(o,h)}}var of={readContext:wo,useCallback:os,useContext:os,useEffect:os,useImperativeHandle:os,useInsertionEffect:os,useLayoutEffect:os,useMemo:os,useReducer:os,useRef:os,useState:os,useDebugValue:os,useDeferredValue:os,useTransition:os,useMutableSource:os,useSyncExternalStore:os,useId:os,unstable_isNewReconciler:!1},T0={readContext:wo,useCallback:function(o,a){return _i().memoizedState=[o,a===void 0?null:a],o},useContext:wo,useEffect:sf,useImperativeHandle:function(o,a,h){return h=h!=null?h.concat([o]):null,Fu(4194308,4,op.bind(null,a,o),h)},useLayoutEffect:function(o,a){return Fu(4194308,4,o,a)},useInsertionEffect:function(o,a){return Fu(4,2,o,a)},useMemo:function(o,a){var h=_i();return a=a===void 0?null:a,o=o(),h.memoizedState=[o,a],o},useReducer:function(o,a,h){var g=_i();return a=h!==void 0?h(a):a,g.memoizedState=g.baseState=a,o={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:o,lastRenderedState:a},g.queue=o,o=o.dispatch=N0.bind(null,tn,o),[g.memoizedState,o]},useRef:function(o){var a=_i();return o={current:o},a.memoizedState=o},useState:ju,useDebugValue:Ou,useDeferredValue:function(o){return _i().memoizedState=o},useTransition:function(){var o=ju(!1),a=o[0];return o=Vg.bind(null,o[1]),_i().memoizedState=o,[a,o]},useMutableSource:function(){},useSyncExternalStore:function(o,a,h){var g=tn,_=_i();if(qr){if(h===void 0)throw Error(t(407));h=h()}else{if(h=a(),Fn===null)throw Error(t(349));(Ta&30)!==0||np(g,a,h)}_.memoizedState=h;var C={value:h,getSnapshot:a};return _.queue=C,sf(Xi.bind(null,g,C,o),[o]),g.flags|=2048,kc(9,js.bind(null,g,C,h,a),void 0,null),h},useId:function(){var o=_i(),a=Fn.identifierPrefix;if(qr){var h=vi,g=gi;h=(g&~(1<<32-Ns(g)-1)).toString(32)+h,a=":"+a+"R"+h,h=xl++,0<h&&(a+="H"+h.toString(32)),a+=":"}else h=nr++,a=":"+a+"r"+h.toString(32)+":";return o.memoizedState=a},unstable_isNewReconciler:!1},af={readContext:wo,useCallback:Bg,useContext:wo,useEffect:Si,useImperativeHandle:ip,useInsertionEffect:Hg,useLayoutEffect:Qi,useMemo:Gg,useReducer:tp,useRef:nf,useState:function(){return tp(is)},useDebugValue:Ou,useDeferredValue:function(o){var a=So();return Wg(a,un.memoizedState,o)},useTransition:function(){var o=tp(is)[0],a=So().memoizedState;return[o,a]},useMutableSource:tf,useSyncExternalStore:rp,useId:ap,unstable_isNewReconciler:!1},Nc={readContext:wo,useCallback:Bg,useContext:wo,useEffect:Si,useImperativeHandle:ip,useInsertionEffect:Hg,useLayoutEffect:Qi,useMemo:Gg,useReducer:Ec,useRef:nf,useState:function(){return Ec(is)},useDebugValue:Ou,useDeferredValue:function(o){var a=So();return un===null?a.memoizedState=o:Wg(a,un.memoizedState,o)},useTransition:function(){var o=Ec(is)[0],a=So().memoizedState;return[o,a]},useMutableSource:tf,useSyncExternalStore:rp,useId:ap,unstable_isNewReconciler:!1};function Eo(o,a){if(o&&o.defaultProps){a=Q({},a),o=o.defaultProps;for(var h in o)a[h]===void 0&&(a[h]=o[h]);return a}return a}function lf(o,a,h,g){a=o.memoizedState,h=h(g,a),h=h==null?a:Q({},a,h),o.memoizedState=h,o.lanes===0&&(o.updateQueue.baseState=h)}var cf={isMounted:function(o){return(o=o._reactInternals)?ot(o)===o:!1},enqueueSetState:function(o,a,h){o=o._reactInternals;var g=xs(),_=Fa(o),C=Yi(g,_);C.payload=a,h!=null&&(C.callback=h),a=_o(o,C,_),a!==null&&(Vo(a,o,_,g),Xd(a,o,_))},enqueueReplaceState:function(o,a,h){o=o._reactInternals;var g=xs(),_=Fa(o),C=Yi(g,_);C.tag=1,C.payload=a,h!=null&&(C.callback=h),a=_o(o,C,_),a!==null&&(Vo(a,o,_,g),Xd(a,o,_))},enqueueForceUpdate:function(o,a){o=o._reactInternals;var h=xs(),g=Fa(o),_=Yi(h,g);_.tag=2,a!=null&&(_.callback=a),a=_o(o,_,g),a!==null&&(Vo(a,o,g,h),Xd(a,o,g))}};function cp(o,a,h,g,_,C,P){return o=o.stateNode,typeof o.shouldComponentUpdate=="function"?o.shouldComponentUpdate(g,C,P):a.prototype&&a.prototype.isPureReactComponent?!rt(h,g)||!rt(_,C):!0}function bl(o,a,h){var g=!1,_=Sa,C=a.contextType;return typeof C=="object"&&C!==null?C=wo(C):(_=Rs(a)?ps:rs.current,g=a.contextTypes,C=(g=g!=null)?yc(o,_):Sa),a=new a(h,C),o.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,a.updater=cf,o.stateNode=a,a._reactInternals=o,g&&(o=o.stateNode,o.__reactInternalMemoizedUnmaskedChildContext=_,o.__reactInternalMemoizedMaskedChildContext=C),a}function Tc(o,a,h,g){o=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(h,g),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(h,g),a.state!==o&&cf.enqueueReplaceState(a,a.state,null)}function up(o,a,h,g){var _=o.stateNode;_.props=h,_.state=o.memoizedState,_.refs={},Jd(o);var C=a.contextType;typeof C=="object"&&C!==null?_.context=wo(C):(C=Rs(a)?ps:rs.current,_.context=yc(o,C)),_.state=o.memoizedState,C=a.getDerivedStateFromProps,typeof C=="function"&&(lf(o,a,C,h),_.state=o.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof _.getSnapshotBeforeUpdate=="function"||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(a=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),a!==_.state&&cf.enqueueReplaceState(_,_.state,null),bc(o,h,_,g),_.state=o.memoizedState),typeof _.componentDidMount=="function"&&(o.flags|=4194308)}function _l(o,a){try{var h="",g=a;do h+=ue(g),g=g.return;while(g);var _=h}catch(C){_=`
Error generating stack: `+C.message+`
`+C.stack}return{value:o,source:a,stack:_,digest:null}}function uf(o,a,h){return{value:o,source:null,stack:h??null,digest:a??null}}function Ac(o,a){try{console.error(a.value)}catch(h){setTimeout(function(){throw h})}}var Kg=typeof WeakMap=="function"?WeakMap:Map;function Du(o,a,h){h=Yi(-1,h),h.tag=3,h.payload={element:null};var g=a.value;return h.callback=function(){bf||(bf=!0,Cp=g),Ac(o,a)},h}function df(o,a,h){h=Yi(-1,h),h.tag=3;var g=o.type.getDerivedStateFromError;if(typeof g=="function"){var _=a.value;h.payload=function(){return g(_)},h.callback=function(){Ac(o,a)}}var C=o.stateNode;return C!==null&&typeof C.componentDidCatch=="function"&&(h.callback=function(){Ac(o,a),typeof g!="function"&&(Pa===null?Pa=new Set([this]):Pa.add(this));var P=a.stack;this.componentDidCatch(a.value,{componentStack:P!==null?P:""})}),h}function Lu(o,a,h){var g=o.pingCache;if(g===null){g=o.pingCache=new Kg;var _=new Set;g.set(a,_)}else _=g.get(a),_===void 0&&(_=new Set,g.set(a,_));_.has(h)||(_.add(h),o=D0.bind(null,o,a,h),a.then(o,o))}function Yg(o){do{var a;if((a=o.tag===13)&&(a=o.memoizedState,a=a!==null?a.dehydrated!==null:!0),a)return o;o=o.return}while(o!==null);return null}function dp(o,a,h,g,_){return(o.mode&1)===0?(o===a?o.flags|=65536:(o.flags|=128,h.flags|=131072,h.flags&=-52805,h.tag===1&&(h.alternate===null?h.tag=17:(a=Yi(-1,1),a.tag=2,_o(h,a,1))),h.lanes|=1),o):(o.flags|=65536,o.lanes=_,o)}var ff=j.ReactCurrentOwner,gs=!1;function Bn(o,a,h,g){a.child=o===null?qd(a,null,h,g):an(a,o.child,h,g)}function Jg(o,a,h,g,_){h=h.render;var C=a.ref;return Ca(a,_),g=wl(o,a,h,g,C,_),h=ef(),o!==null&&!gs?(a.updateQueue=o.updateQueue,a.flags&=-2053,o.lanes&=~_,Ho(o,a,_)):(qr&&h&&ku(a),a.flags|=1,Bn(o,a,g,_),a.child)}function fp(o,a,h,g,_){if(o===null){var C=h.type;return typeof C=="function"&&!Nf(C)&&C.defaultProps===void 0&&h.compare===null&&h.defaultProps===void 0?(a.tag=15,a.type=C,Ei(o,a,C,g,_)):(o=Tf(h.type,null,g,a,a.mode,_),o.ref=a.ref,o.return=a,a.child=o)}if(C=o.child,(o.lanes&_)===0){var P=C.memoizedProps;if(h=h.compare,h=h!==null?h:rt,h(P,g)&&o.ref===a.ref)return Ho(o,a,_)}return a.flags|=1,o=qo(C,g),o.ref=a.ref,o.return=a,a.child=o}function Ei(o,a,h,g,_){if(o!==null){var C=o.memoizedProps;if(rt(C,g)&&o.ref===a.ref)if(gs=!1,a.pendingProps=g=C,(o.lanes&_)!==0)(o.flags&131072)!==0&&(gs=!0);else return a.lanes=o.lanes,Ho(o,a,_)}return mp(o,a,h,g,_)}function hp(o,a,h){var g=a.pendingProps,_=g.children,C=o!==null?o.memoizedState:null;if(g.mode==="hidden")if((a.mode&1)===0)a.memoizedState={baseLanes:0,cachePool:null,transitions:null},Hr(jc,ro),ro|=h;else{if((h&1073741824)===0)return o=C!==null?C.baseLanes|h:h,a.lanes=a.childLanes=1073741824,a.memoizedState={baseLanes:o,cachePool:null,transitions:null},a.updateQueue=null,Hr(jc,ro),ro|=o,null;a.memoizedState={baseLanes:0,cachePool:null,transitions:null},g=C!==null?C.baseLanes:h,Hr(jc,ro),ro|=g}else C!==null?(g=C.baseLanes|h,a.memoizedState=null):g=h,Hr(jc,ro),ro|=g;return Bn(o,a,_,h),a.child}function pp(o,a){var h=a.ref;(o===null&&h!==null||o!==null&&o.ref!==h)&&(a.flags|=512,a.flags|=2097152)}function mp(o,a,h,g,_){var C=Rs(h)?ps:rs.current;return C=yc(a,C),Ca(a,_),h=wl(o,a,h,g,C,_),g=ef(),o!==null&&!gs?(a.updateQueue=o.updateQueue,a.flags&=-2053,o.lanes&=~_,Ho(o,a,_)):(qr&&g&&ku(a),a.flags|=1,Bn(o,a,h,_),a.child)}function gp(o,a,h,g,_){if(Rs(h)){var C=!0;vo(a)}else C=!1;if(Ca(a,_),a.stateNode===null)pf(o,a),bl(a,h,g),up(a,h,g,_),g=!0;else if(o===null){var P=a.stateNode,W=a.memoizedProps;P.props=W;var Z=P.context,xe=h.contextType;typeof xe=="object"&&xe!==null?xe=wo(xe):(xe=Rs(h)?ps:rs.current,xe=yc(a,xe));var Oe=h.getDerivedStateFromProps,Ue=typeof Oe=="function"||typeof P.getSnapshotBeforeUpdate=="function";Ue||typeof P.UNSAFE_componentWillReceiveProps!="function"&&typeof P.componentWillReceiveProps!="function"||(W!==g||Z!==xe)&&Tc(a,P,g,xe),bo=!1;var Fe=a.memoizedState;P.state=Fe,bc(a,g,P,_),Z=a.memoizedState,W!==g||Fe!==Z||Is.current||bo?(typeof Oe=="function"&&(lf(a,h,Oe,g),Z=a.memoizedState),(W=bo||cp(a,h,W,g,Fe,Z,xe))?(Ue||typeof P.UNSAFE_componentWillMount!="function"&&typeof P.componentWillMount!="function"||(typeof P.componentWillMount=="function"&&P.componentWillMount(),typeof P.UNSAFE_componentWillMount=="function"&&P.UNSAFE_componentWillMount()),typeof P.componentDidMount=="function"&&(a.flags|=4194308)):(typeof P.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=g,a.memoizedState=Z),P.props=g,P.state=Z,P.context=xe,g=W):(typeof P.componentDidMount=="function"&&(a.flags|=4194308),g=!1)}else{P=a.stateNode,Ug(o,a),W=a.memoizedProps,xe=a.type===a.elementType?W:Eo(a.type,W),P.props=xe,Ue=a.pendingProps,Fe=P.context,Z=h.contextType,typeof Z=="object"&&Z!==null?Z=wo(Z):(Z=Rs(h)?ps:rs.current,Z=yc(a,Z));var nt=h.getDerivedStateFromProps;(Oe=typeof nt=="function"||typeof P.getSnapshotBeforeUpdate=="function")||typeof P.UNSAFE_componentWillReceiveProps!="function"&&typeof P.componentWillReceiveProps!="function"||(W!==Ue||Fe!==Z)&&Tc(a,P,g,Z),bo=!1,Fe=a.memoizedState,P.state=Fe,bc(a,g,P,_);var gt=a.memoizedState;W!==Ue||Fe!==gt||Is.current||bo?(typeof nt=="function"&&(lf(a,h,nt,g),gt=a.memoizedState),(xe=bo||cp(a,h,xe,g,Fe,gt,Z)||!1)?(Oe||typeof P.UNSAFE_componentWillUpdate!="function"&&typeof P.componentWillUpdate!="function"||(typeof P.componentWillUpdate=="function"&&P.componentWillUpdate(g,gt,Z),typeof P.UNSAFE_componentWillUpdate=="function"&&P.UNSAFE_componentWillUpdate(g,gt,Z)),typeof P.componentDidUpdate=="function"&&(a.flags|=4),typeof P.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof P.componentDidUpdate!="function"||W===o.memoizedProps&&Fe===o.memoizedState||(a.flags|=4),typeof P.getSnapshotBeforeUpdate!="function"||W===o.memoizedProps&&Fe===o.memoizedState||(a.flags|=1024),a.memoizedProps=g,a.memoizedState=gt),P.props=g,P.state=gt,P.context=Z,g=xe):(typeof P.componentDidUpdate!="function"||W===o.memoizedProps&&Fe===o.memoizedState||(a.flags|=4),typeof P.getSnapshotBeforeUpdate!="function"||W===o.memoizedProps&&Fe===o.memoizedState||(a.flags|=1024),g=!1)}return vp(o,a,h,g,C,_)}function vp(o,a,h,g,_,C){pp(o,a);var P=(a.flags&128)!==0;if(!g&&!P)return _&&Fg(a,h,!1),Ho(o,a,C);g=a.stateNode,ff.current=a;var W=P&&typeof h.getDerivedStateFromError!="function"?null:g.render();return a.flags|=1,o!==null&&P?(a.child=an(a,o.child,null,C),a.child=an(a,null,W,C)):Bn(o,a,W,C),a.memoizedState=g.state,_&&Fg(a,h,!0),a.child}function Xg(o){var a=o.stateNode;a.pendingContext?Pg(o,a.pendingContext,a.pendingContext!==a.context):a.context&&Pg(o,a.context,!1),Jh(o,a.containerInfo)}function ki(o,a,h,g,_){return xi(),wi(_),a.flags|=256,Bn(o,a,h,g),a.child}var Mu={dehydrated:null,treeContext:null,retryLane:0};function $u(o){return{baseLanes:o,cachePool:null,transitions:null}}function hf(o,a,h){var g=a.pendingProps,_=Qr.current,C=!1,P=(a.flags&128)!==0,W;if((W=P)||(W=o!==null&&o.memoizedState===null?!1:(_&2)!==0),W?(C=!0,a.flags&=-129):(o===null||o.memoizedState!==null)&&(_|=1),Hr(Qr,_&1),o===null)return Ps(a),o=a.memoizedState,o!==null&&(o=o.dehydrated,o!==null)?((a.mode&1)===0?a.lanes=1:o.data==="$!"?a.lanes=8:a.lanes=1073741824,null):(P=g.children,o=g.fallback,C?(g=a.mode,C=a.child,P={mode:"hidden",children:P},(g&1)===0&&C!==null?(C.childLanes=0,C.pendingProps=P):C=Af(P,g,0,null),o=Nl(o,g,h,null),C.return=a,o.return=a,C.sibling=o,a.child=C,a.child.memoizedState=$u(h),a.memoizedState=Mu,o):Ic(a,P));if(_=o.memoizedState,_!==null&&(W=_.dehydrated,W!==null))return Mt(o,a,P,g,W,_,h);if(C){C=g.fallback,P=a.mode,_=o.child,W=_.sibling;var Z={mode:"hidden",children:g.children};return(P&1)===0&&a.child!==_?(g=a.child,g.childLanes=0,g.pendingProps=Z,a.deletions=null):(g=qo(_,Z),g.subtreeFlags=_.subtreeFlags&14680064),W!==null?C=qo(W,C):(C=Nl(C,P,h,null),C.flags|=2),C.return=a,g.return=a,g.sibling=C,a.child=g,g=C,C=a.child,P=o.child.memoizedState,P=P===null?$u(h):{baseLanes:P.baseLanes|h,cachePool:null,transitions:P.transitions},C.memoizedState=P,C.childLanes=o.childLanes&~h,a.memoizedState=Mu,g}return C=o.child,o=C.sibling,g=qo(C,{mode:"visible",children:g.children}),(a.mode&1)===0&&(g.lanes=h),g.return=a,g.sibling=null,o!==null&&(h=a.deletions,h===null?(a.deletions=[o],a.flags|=16):h.push(o)),a.child=g,a.memoizedState=null,g}function Ic(o,a){return a=Af({mode:"visible",children:a},o.mode,0,null),a.return=o,o.child=a}function Zi(o,a,h,g){return g!==null&&wi(g),an(a,o.child,null,h),o=Ic(a,a.pendingProps.children),o.flags|=2,a.memoizedState=null,o}function Mt(o,a,h,g,_,C,P){if(h)return a.flags&256?(a.flags&=-257,g=uf(Error(t(422))),Zi(o,a,P,g)):a.memoizedState!==null?(a.child=o.child,a.flags|=128,null):(C=g.fallback,_=a.mode,g=Af({mode:"visible",children:g.children},_,0,null),C=Nl(C,_,P,null),C.flags|=2,g.return=a,C.return=a,g.sibling=C,a.child=g,(a.mode&1)!==0&&an(a,o.child,null,P),a.child.memoizedState=$u(P),a.memoizedState=Mu,C);if((a.mode&1)===0)return Zi(o,a,P,null);if(_.data==="$!"){if(g=_.nextSibling&&_.nextSibling.dataset,g)var W=g.dgst;return g=W,C=Error(t(419)),g=uf(C,g,void 0),Zi(o,a,P,g)}if(W=(P&o.childLanes)!==0,gs||W){if(g=Fn,g!==null){switch(P&-P){case 4:_=2;break;case 16:_=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:_=32;break;case 536870912:_=268435456;break;default:_=0}_=(_&(g.suspendedLanes|P))!==0?0:_,_!==0&&_!==C.retryLane&&(C.retryLane=_,Ki(o,_),Vo(g,o,_,-1))}return Pp(),g=uf(Error(t(421))),Zi(o,a,P,g)}return _.data==="$?"?(a.flags|=128,a.child=o.child,a=L0.bind(null,o),_._reactRetry=a,null):(o=C.treeContext,Zs=ba(_.nextSibling),ss=a,qr=!0,Uo=null,o!==null&&(yo[xo++]=gi,yo[xo++]=vi,yo[xo++]=hl,gi=o.id,vi=o.overflow,hl=a),a=Ic(a,g.children),a.flags|=4096,a)}function Uu(o,a,h){o.lanes|=a;var g=o.alternate;g!==null&&(g.lanes|=a),Hn(o.return,a,h)}function zu(o,a,h,g,_){var C=o.memoizedState;C===null?o.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:g,tail:h,tailMode:_}:(C.isBackwards=a,C.rendering=null,C.renderingStartTime=0,C.last=g,C.tail=h,C.tailMode=_)}function Aa(o,a,h){var g=a.pendingProps,_=g.revealOrder,C=g.tail;if(Bn(o,a,g.children,h),g=Qr.current,(g&2)!==0)g=g&1|2,a.flags|=128;else{if(o!==null&&(o.flags&128)!==0)e:for(o=a.child;o!==null;){if(o.tag===13)o.memoizedState!==null&&Uu(o,h,a);else if(o.tag===19)Uu(o,h,a);else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===a)break e;for(;o.sibling===null;){if(o.return===null||o.return===a)break e;o=o.return}o.sibling.return=o.return,o=o.sibling}g&=1}if(Hr(Qr,g),(a.mode&1)===0)a.memoizedState=null;else switch(_){case"forwards":for(h=a.child,_=null;h!==null;)o=h.alternate,o!==null&&yl(o)===null&&(_=h),h=h.sibling;h=_,h===null?(_=a.child,a.child=null):(_=h.sibling,h.sibling=null),zu(a,!1,_,h,C);break;case"backwards":for(h=null,_=a.child,a.child=null;_!==null;){if(o=_.alternate,o!==null&&yl(o)===null){a.child=_;break}o=_.sibling,_.sibling=h,h=_,_=o}zu(a,!0,h,null,C);break;case"together":zu(a,!1,null,null,void 0);break;default:a.memoizedState=null}return a.child}function pf(o,a){(a.mode&1)===0&&o!==null&&(o.alternate=null,a.alternate=null,a.flags|=2)}function Ho(o,a,h){if(o!==null&&(a.dependencies=o.dependencies),Ra|=a.lanes,(h&a.childLanes)===0)return null;if(o!==null&&a.child!==o.child)throw Error(t(153));if(a.child!==null){for(o=a.child,h=qo(o,o.pendingProps),a.child=h,h.return=a;o.sibling!==null;)o=o.sibling,h=h.sibling=qo(o,o.pendingProps),h.return=a;h.sibling=null}return a.child}function Qg(o,a,h){switch(a.tag){case 3:Xg(a),xi();break;case 5:Xh(a);break;case 1:Rs(a.type)&&vo(a);break;case 4:Jh(a,a.stateNode.containerInfo);break;case 10:var g=a.type._context,_=a.memoizedProps.value;Hr(Tu,g._currentValue),g._currentValue=_;break;case 13:if(g=a.memoizedState,g!==null)return g.dehydrated!==null?(Hr(Qr,Qr.current&1),a.flags|=128,null):(h&a.child.childLanes)!==0?hf(o,a,h):(Hr(Qr,Qr.current&1),o=Ho(o,a,h),o!==null?o.sibling:null);Hr(Qr,Qr.current&1);break;case 19:if(g=(h&a.childLanes)!==0,(o.flags&128)!==0){if(g)return Aa(o,a,h);a.flags|=128}if(_=a.memoizedState,_!==null&&(_.rendering=null,_.tail=null,_.lastEffect=null),Hr(Qr,Qr.current),g)break;return null;case 22:case 23:return a.lanes=0,hp(o,a,h)}return Ho(o,a,h)}var Gn,yp,Zg,xp;Gn=function(o,a){for(var h=a.child;h!==null;){if(h.tag===5||h.tag===6)o.appendChild(h.stateNode);else if(h.tag!==4&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===a)break;for(;h.sibling===null;){if(h.return===null||h.return===a)return;h=h.return}h.sibling.return=h.return,h=h.sibling}},yp=function(){},Zg=function(o,a,h,g){var _=o.memoizedProps;if(_!==g){o=a.stateNode,Ji(bi.current);var C=null;switch(h){case"input":_=Ee(o,_),g=Ee(o,g),C=[];break;case"select":_=Q({},_,{value:void 0}),g=Q({},g,{value:void 0}),C=[];break;case"textarea":_=Jt(o,_),g=Jt(o,g),C=[];break;default:typeof _.onClick!="function"&&typeof g.onClick=="function"&&(o.onclick=Md)}$e(h,g);var P;h=null;for(xe in _)if(!g.hasOwnProperty(xe)&&_.hasOwnProperty(xe)&&_[xe]!=null)if(xe==="style"){var W=_[xe];for(P in W)W.hasOwnProperty(P)&&(h||(h={}),h[P]="")}else xe!=="dangerouslySetInnerHTML"&&xe!=="children"&&xe!=="suppressContentEditableWarning"&&xe!=="suppressHydrationWarning"&&xe!=="autoFocus"&&(s.hasOwnProperty(xe)?C||(C=[]):(C=C||[]).push(xe,null));for(xe in g){var Z=g[xe];if(W=_!=null?_[xe]:void 0,g.hasOwnProperty(xe)&&Z!==W&&(Z!=null||W!=null))if(xe==="style")if(W){for(P in W)!W.hasOwnProperty(P)||Z&&Z.hasOwnProperty(P)||(h||(h={}),h[P]="");for(P in Z)Z.hasOwnProperty(P)&&W[P]!==Z[P]&&(h||(h={}),h[P]=Z[P])}else h||(C||(C=[]),C.push(xe,h)),h=Z;else xe==="dangerouslySetInnerHTML"?(Z=Z?Z.__html:void 0,W=W?W.__html:void 0,Z!=null&&W!==Z&&(C=C||[]).push(xe,Z)):xe==="children"?typeof Z!="string"&&typeof Z!="number"||(C=C||[]).push(xe,""+Z):xe!=="suppressContentEditableWarning"&&xe!=="suppressHydrationWarning"&&(s.hasOwnProperty(xe)?(Z!=null&&xe==="onScroll"&&Wr("scroll",o),C||W===Z||(C=[])):(C=C||[]).push(xe,Z))}h&&(C=C||[]).push("style",h);var xe=C;(a.updateQueue=xe)&&(a.flags|=4)}},xp=function(o,a,h,g){h!==g&&(a.flags|=4)};function Hu(o,a){if(!qr)switch(o.tailMode){case"hidden":a=o.tail;for(var h=null;a!==null;)a.alternate!==null&&(h=a),a=a.sibling;h===null?o.tail=null:h.sibling=null;break;case"collapsed":h=o.tail;for(var g=null;h!==null;)h.alternate!==null&&(g=h),h=h.sibling;g===null?a||o.tail===null?o.tail=null:o.tail.sibling=null:g.sibling=null}}function Wn(o){var a=o.alternate!==null&&o.alternate.child===o.child,h=0,g=0;if(a)for(var _=o.child;_!==null;)h|=_.lanes|_.childLanes,g|=_.subtreeFlags&14680064,g|=_.flags&14680064,_.return=o,_=_.sibling;else for(_=o.child;_!==null;)h|=_.lanes|_.childLanes,g|=_.subtreeFlags,g|=_.flags,_.return=o,_=_.sibling;return o.subtreeFlags|=g,o.childLanes=h,a}function A0(o,a,h){var g=a.pendingProps;switch(ml(a),a.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Wn(a),null;case 1:return Rs(a.type)&&Hd(),Wn(a),null;case 3:return g=a.stateNode,Na(),Vr(Is),Vr(rs),Zd(),g.pendingContext&&(g.context=g.pendingContext,g.pendingContext=null),(o===null||o.child===null)&&(Cu(a)?a.flags|=4:o===null||o.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,Uo!==null&&(Ap(Uo),Uo=null))),yp(o,a),Wn(a),null;case 5:Qd(a);var _=Ji(_c.current);if(h=a.type,o!==null&&a.stateNode!=null)Zg(o,a,h,g,_),o.ref!==a.ref&&(a.flags|=512,a.flags|=2097152);else{if(!g){if(a.stateNode===null)throw Error(t(166));return Wn(a),null}if(o=Ji(bi.current),Cu(a)){g=a.stateNode,h=a.type;var C=a.memoizedProps;switch(g[pi]=a,g[_a]=C,o=(a.mode&1)!==0,h){case"dialog":Wr("cancel",g),Wr("close",g);break;case"iframe":case"object":case"embed":Wr("load",g);break;case"video":case"audio":for(_=0;_<Gi.length;_++)Wr(Gi[_],g);break;case"source":Wr("error",g);break;case"img":case"image":case"link":Wr("error",g),Wr("load",g);break;case"details":Wr("toggle",g);break;case"input":ye(g,C),Wr("invalid",g);break;case"select":g._wrapperState={wasMultiple:!!C.multiple},Wr("invalid",g);break;case"textarea":Or(g,C),Wr("invalid",g)}$e(h,C),_=null;for(var P in C)if(C.hasOwnProperty(P)){var W=C[P];P==="children"?typeof W=="string"?g.textContent!==W&&(C.suppressHydrationWarning!==!0&&bu(g.textContent,W,o),_=["children",W]):typeof W=="number"&&g.textContent!==""+W&&(C.suppressHydrationWarning!==!0&&bu(g.textContent,W,o),_=["children",""+W]):s.hasOwnProperty(P)&&W!=null&&P==="onScroll"&&Wr("scroll",g)}switch(h){case"input":St(g),ft(g,C,!0);break;case"textarea":St(g),Nr(g);break;case"select":case"option":break;default:typeof C.onClick=="function"&&(g.onclick=Md)}g=_,a.updateQueue=g,g!==null&&(a.flags|=4)}else{P=_.nodeType===9?_:_.ownerDocument,o==="http://www.w3.org/1999/xhtml"&&(o=me(h)),o==="http://www.w3.org/1999/xhtml"?h==="script"?(o=P.createElement("div"),o.innerHTML="<script><\/script>",o=o.removeChild(o.firstChild)):typeof g.is=="string"?o=P.createElement(h,{is:g.is}):(o=P.createElement(h),h==="select"&&(P=o,g.multiple?P.multiple=!0:g.size&&(P.size=g.size))):o=P.createElementNS(o,h),o[pi]=a,o[_a]=g,Gn(o,a,!1,!1),a.stateNode=o;e:{switch(P=cr(h,g),h){case"dialog":Wr("cancel",o),Wr("close",o),_=g;break;case"iframe":case"object":case"embed":Wr("load",o),_=g;break;case"video":case"audio":for(_=0;_<Gi.length;_++)Wr(Gi[_],o);_=g;break;case"source":Wr("error",o),_=g;break;case"img":case"image":case"link":Wr("error",o),Wr("load",o),_=g;break;case"details":Wr("toggle",o),_=g;break;case"input":ye(o,g),_=Ee(o,g),Wr("invalid",o);break;case"option":_=g;break;case"select":o._wrapperState={wasMultiple:!!g.multiple},_=Q({},g,{value:void 0}),Wr("invalid",o);break;case"textarea":Or(o,g),_=Jt(o,g),Wr("invalid",o);break;default:_=g}$e(h,_),W=_;for(C in W)if(W.hasOwnProperty(C)){var Z=W[C];C==="style"?kt(o,Z):C==="dangerouslySetInnerHTML"?(Z=Z?Z.__html:void 0,Z!=null&&wt(o,Z)):C==="children"?typeof Z=="string"?(h!=="textarea"||Z!=="")&&We(o,Z):typeof Z=="number"&&We(o,""+Z):C!=="suppressContentEditableWarning"&&C!=="suppressHydrationWarning"&&C!=="autoFocus"&&(s.hasOwnProperty(C)?Z!=null&&C==="onScroll"&&Wr("scroll",o):Z!=null&&D(o,C,Z,P))}switch(h){case"input":St(o),ft(o,g,!1);break;case"textarea":St(o),Nr(o);break;case"option":g.value!=null&&o.setAttribute("value",""+we(g.value));break;case"select":o.multiple=!!g.multiple,C=g.value,C!=null?ut(o,!!g.multiple,C,!1):g.defaultValue!=null&&ut(o,!!g.multiple,g.defaultValue,!0);break;default:typeof _.onClick=="function"&&(o.onclick=Md)}switch(h){case"button":case"input":case"select":case"textarea":g=!!g.autoFocus;break e;case"img":g=!0;break e;default:g=!1}}g&&(a.flags|=4)}a.ref!==null&&(a.flags|=512,a.flags|=2097152)}return Wn(a),null;case 6:if(o&&a.stateNode!=null)xp(o,a,o.memoizedProps,g);else{if(typeof g!="string"&&a.stateNode===null)throw Error(t(166));if(h=Ji(_c.current),Ji(bi.current),Cu(a)){if(g=a.stateNode,h=a.memoizedProps,g[pi]=a,(C=g.nodeValue!==h)&&(o=ss,o!==null))switch(o.tag){case 3:bu(g.nodeValue,h,(o.mode&1)!==0);break;case 5:o.memoizedProps.suppressHydrationWarning!==!0&&bu(g.nodeValue,h,(o.mode&1)!==0)}C&&(a.flags|=4)}else g=(h.nodeType===9?h:h.ownerDocument).createTextNode(g),g[pi]=a,a.stateNode=g}return Wn(a),null;case 13:if(Vr(Qr),g=a.memoizedState,o===null||o.memoizedState!==null&&o.memoizedState.dehydrated!==null){if(qr&&Zs!==null&&(a.mode&1)!==0&&(a.flags&128)===0)Vh(),xi(),a.flags|=98560,C=!1;else if(C=Cu(a),g!==null&&g.dehydrated!==null){if(o===null){if(!C)throw Error(t(318));if(C=a.memoizedState,C=C!==null?C.dehydrated:null,!C)throw Error(t(317));C[pi]=a}else xi(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;Wn(a),C=!1}else Uo!==null&&(Ap(Uo),Uo=null),C=!0;if(!C)return a.flags&65536?a:null}return(a.flags&128)!==0?(a.lanes=h,a):(g=g!==null,g!==(o!==null&&o.memoizedState!==null)&&g&&(a.child.flags|=8192,(a.mode&1)!==0&&(o===null||(Qr.current&1)!==0?Cn===0&&(Cn=3):Pp())),a.updateQueue!==null&&(a.flags|=4),Wn(a),null);case 4:return Na(),yp(o,a),o===null&&xa(a.stateNode.containerInfo),Wn(a),null;case 10:return Kd(a.type._context),Wn(a),null;case 17:return Rs(a.type)&&Hd(),Wn(a),null;case 19:if(Vr(Qr),C=a.memoizedState,C===null)return Wn(a),null;if(g=(a.flags&128)!==0,P=C.rendering,P===null)if(g)Hu(C,!1);else{if(Cn!==0||o!==null&&(o.flags&128)!==0)for(o=a.child;o!==null;){if(P=yl(o),P!==null){for(a.flags|=128,Hu(C,!1),g=P.updateQueue,g!==null&&(a.updateQueue=g,a.flags|=4),a.subtreeFlags=0,g=h,h=a.child;h!==null;)C=h,o=g,C.flags&=14680066,P=C.alternate,P===null?(C.childLanes=0,C.lanes=o,C.child=null,C.subtreeFlags=0,C.memoizedProps=null,C.memoizedState=null,C.updateQueue=null,C.dependencies=null,C.stateNode=null):(C.childLanes=P.childLanes,C.lanes=P.lanes,C.child=P.child,C.subtreeFlags=0,C.deletions=null,C.memoizedProps=P.memoizedProps,C.memoizedState=P.memoizedState,C.updateQueue=P.updateQueue,C.type=P.type,o=P.dependencies,C.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),h=h.sibling;return Hr(Qr,Qr.current&1|2),a.child}o=o.sibling}C.tail!==null&&Xt()>Sl&&(a.flags|=128,g=!0,Hu(C,!1),a.lanes=4194304)}else{if(!g)if(o=yl(P),o!==null){if(a.flags|=128,g=!0,h=o.updateQueue,h!==null&&(a.updateQueue=h,a.flags|=4),Hu(C,!0),C.tail===null&&C.tailMode==="hidden"&&!P.alternate&&!qr)return Wn(a),null}else 2*Xt()-C.renderingStartTime>Sl&&h!==1073741824&&(a.flags|=128,g=!0,Hu(C,!1),a.lanes=4194304);C.isBackwards?(P.sibling=a.child,a.child=P):(h=C.last,h!==null?h.sibling=P:a.child=P,C.last=P)}return C.tail!==null?(a=C.tail,C.rendering=a,C.tail=a.sibling,C.renderingStartTime=Xt(),a.sibling=null,h=Qr.current,Hr(Qr,g?h&1|2:h&1),a):(Wn(a),null);case 22:case 23:return Rp(),g=a.memoizedState!==null,o!==null&&o.memoizedState!==null!==g&&(a.flags|=8192),g&&(a.mode&1)!==0?(ro&1073741824)!==0&&(Wn(a),a.subtreeFlags&6&&(a.flags|=8192)):Wn(a),null;case 24:return null;case 25:return null}throw Error(t(156,a.tag))}function I0(o,a){switch(ml(a),a.tag){case 1:return Rs(a.type)&&Hd(),o=a.flags,o&65536?(a.flags=o&-65537|128,a):null;case 3:return Na(),Vr(Is),Vr(rs),Zd(),o=a.flags,(o&65536)!==0&&(o&128)===0?(a.flags=o&-65537|128,a):null;case 5:return Qd(a),null;case 13:if(Vr(Qr),o=a.memoizedState,o!==null&&o.dehydrated!==null){if(a.alternate===null)throw Error(t(340));xi()}return o=a.flags,o&65536?(a.flags=o&-65537|128,a):null;case 19:return Vr(Qr),null;case 4:return Na(),null;case 10:return Kd(a.type._context),null;case 22:case 23:return Rp(),null;case 24:return null;default:return null}}var mf=!1,Zr=!1,vs=typeof WeakSet=="function"?WeakSet:Set,ct=null;function Rc(o,a){var h=o.ref;if(h!==null)if(typeof h=="function")try{h(null)}catch(g){rn(o,a,g)}else h.current=null}function Bu(o,a,h){try{h()}catch(g){rn(o,a,g)}}var ev=!1;function R0(o,a){if(_u=Ui,o=Dr(),mu(o)){if("selectionStart"in o)var h={start:o.selectionStart,end:o.selectionEnd};else e:{h=(h=o.ownerDocument)&&h.defaultView||window;var g=h.getSelection&&h.getSelection();if(g&&g.rangeCount!==0){h=g.anchorNode;var _=g.anchorOffset,C=g.focusNode;g=g.focusOffset;try{h.nodeType,C.nodeType}catch{h=null;break e}var P=0,W=-1,Z=-1,xe=0,Oe=0,Ue=o,Fe=null;t:for(;;){for(var nt;Ue!==h||_!==0&&Ue.nodeType!==3||(W=P+_),Ue!==C||g!==0&&Ue.nodeType!==3||(Z=P+g),Ue.nodeType===3&&(P+=Ue.nodeValue.length),(nt=Ue.firstChild)!==null;)Fe=Ue,Ue=nt;for(;;){if(Ue===o)break t;if(Fe===h&&++xe===_&&(W=P),Fe===C&&++Oe===g&&(Z=P),(nt=Ue.nextSibling)!==null)break;Ue=Fe,Fe=Ue.parentNode}Ue=nt}h=W===-1||Z===-1?null:{start:W,end:Z}}else h=null}h=h||{start:0,end:0}}else h=null;for(dl={focusedElem:o,selectionRange:h},Ui=!1,ct=a;ct!==null;)if(a=ct,o=a.child,(a.subtreeFlags&1028)!==0&&o!==null)o.return=a,ct=o;else for(;ct!==null;){a=ct;try{var gt=a.alternate;if((a.flags&1024)!==0)switch(a.tag){case 0:case 11:case 15:break;case 1:if(gt!==null){var vt=gt.memoizedProps,dn=gt.memoizedState,fe=a.stateNode,ne=fe.getSnapshotBeforeUpdate(a.elementType===a.type?vt:Eo(a.type,vt),dn);fe.__reactInternalSnapshotBeforeUpdate=ne}break;case 3:var pe=a.stateNode.containerInfo;pe.nodeType===1?pe.textContent="":pe.nodeType===9&&pe.documentElement&&pe.removeChild(pe.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(He){rn(a,a.return,He)}if(o=a.sibling,o!==null){o.return=a.return,ct=o;break}ct=a.return}return gt=ev,ev=!1,gt}function ea(o,a,h){var g=a.updateQueue;if(g=g!==null?g.lastEffect:null,g!==null){var _=g=g.next;do{if((_.tag&o)===o){var C=_.destroy;_.destroy=void 0,C!==void 0&&Bu(a,h,C)}_=_.next}while(_!==g)}}function Gu(o,a){if(a=a.updateQueue,a=a!==null?a.lastEffect:null,a!==null){var h=a=a.next;do{if((h.tag&o)===o){var g=h.create;h.destroy=g()}h=h.next}while(h!==a)}}function gf(o){var a=o.ref;if(a!==null){var h=o.stateNode;switch(o.tag){case 5:o=h;break;default:o=h}typeof a=="function"?a(o):a.current=o}}function tv(o){var a=o.alternate;a!==null&&(o.alternate=null,tv(a)),o.child=null,o.deletions=null,o.sibling=null,o.tag===5&&(a=o.stateNode,a!==null&&(delete a[pi],delete a[_a],delete a[Ud],delete a[L],delete a[gc])),o.stateNode=null,o.return=null,o.dependencies=null,o.memoizedProps=null,o.memoizedState=null,o.pendingProps=null,o.stateNode=null,o.updateQueue=null}function rv(o){return o.tag===5||o.tag===3||o.tag===4}function nv(o){e:for(;;){for(;o.sibling===null;){if(o.return===null||rv(o.return))return null;o=o.return}for(o.sibling.return=o.return,o=o.sibling;o.tag!==5&&o.tag!==6&&o.tag!==18;){if(o.flags&2||o.child===null||o.tag===4)continue e;o.child.return=o,o=o.child}if(!(o.flags&2))return o.stateNode}}function wp(o,a,h){var g=o.tag;if(g===5||g===6)o=o.stateNode,a?h.nodeType===8?h.parentNode.insertBefore(o,a):h.insertBefore(o,a):(h.nodeType===8?(a=h.parentNode,a.insertBefore(o,h)):(a=h,a.appendChild(o)),h=h._reactRootContainer,h!=null||a.onclick!==null||(a.onclick=Md));else if(g!==4&&(o=o.child,o!==null))for(wp(o,a,h),o=o.sibling;o!==null;)wp(o,a,h),o=o.sibling}function vf(o,a,h){var g=o.tag;if(g===5||g===6)o=o.stateNode,a?h.insertBefore(o,a):h.appendChild(o);else if(g!==4&&(o=o.child,o!==null))for(vf(o,a,h),o=o.sibling;o!==null;)vf(o,a,h),o=o.sibling}var jn=null,Bo=!1;function Ci(o,a,h){for(h=h.child;h!==null;)bp(o,a,h),h=h.sibling}function bp(o,a,h){if(Xn&&typeof Xn.onCommitFiberUnmount=="function")try{Xn.onCommitFiberUnmount(Lo,h)}catch{}switch(h.tag){case 5:Zr||Rc(h,a);case 6:var g=jn,_=Bo;jn=null,Ci(o,a,h),jn=g,Bo=_,jn!==null&&(Bo?(o=jn,h=h.stateNode,o.nodeType===8?o.parentNode.removeChild(h):o.removeChild(h)):jn.removeChild(h.stateNode));break;case 18:jn!==null&&(Bo?(o=jn,h=h.stateNode,o.nodeType===8?Bh(o.parentNode,h):o.nodeType===1&&Bh(o,h),er(o)):Bh(jn,h.stateNode));break;case 4:g=jn,_=Bo,jn=h.stateNode.containerInfo,Bo=!0,Ci(o,a,h),jn=g,Bo=_;break;case 0:case 11:case 14:case 15:if(!Zr&&(g=h.updateQueue,g!==null&&(g=g.lastEffect,g!==null))){_=g=g.next;do{var C=_,P=C.destroy;C=C.tag,P!==void 0&&((C&2)!==0||(C&4)!==0)&&Bu(h,a,P),_=_.next}while(_!==g)}Ci(o,a,h);break;case 1:if(!Zr&&(Rc(h,a),g=h.stateNode,typeof g.componentWillUnmount=="function"))try{g.props=h.memoizedProps,g.state=h.memoizedState,g.componentWillUnmount()}catch(W){rn(h,a,W)}Ci(o,a,h);break;case 21:Ci(o,a,h);break;case 22:h.mode&1?(Zr=(g=Zr)||h.memoizedState!==null,Ci(o,a,h),Zr=g):Ci(o,a,h);break;default:Ci(o,a,h)}}function Pc(o){var a=o.updateQueue;if(a!==null){o.updateQueue=null;var h=o.stateNode;h===null&&(h=o.stateNode=new vs),a.forEach(function(g){var _=M0.bind(null,o,g);h.has(g)||(h.add(g),g.then(_,_))})}}function to(o,a){var h=a.deletions;if(h!==null)for(var g=0;g<h.length;g++){var _=h[g];try{var C=o,P=a,W=P;e:for(;W!==null;){switch(W.tag){case 5:jn=W.stateNode,Bo=!1;break e;case 3:jn=W.stateNode.containerInfo,Bo=!0;break e;case 4:jn=W.stateNode.containerInfo,Bo=!0;break e}W=W.return}if(jn===null)throw Error(t(160));bp(C,P,_),jn=null,Bo=!1;var Z=_.alternate;Z!==null&&(Z.return=null),_.return=null}catch(xe){rn(_,a,xe)}}if(a.subtreeFlags&12854)for(a=a.child;a!==null;)_p(a,o),a=a.sibling}function _p(o,a){var h=o.alternate,g=o.flags;switch(o.tag){case 0:case 11:case 14:case 15:if(to(a,o),Go(o),g&4){try{ea(3,o,o.return),Gu(3,o)}catch(vt){rn(o,o.return,vt)}try{ea(5,o,o.return)}catch(vt){rn(o,o.return,vt)}}break;case 1:to(a,o),Go(o),g&512&&h!==null&&Rc(h,h.return);break;case 5:if(to(a,o),Go(o),g&512&&h!==null&&Rc(h,h.return),o.flags&32){var _=o.stateNode;try{We(_,"")}catch(vt){rn(o,o.return,vt)}}if(g&4&&(_=o.stateNode,_!=null)){var C=o.memoizedProps,P=h!==null?h.memoizedProps:C,W=o.type,Z=o.updateQueue;if(o.updateQueue=null,Z!==null)try{W==="input"&&C.type==="radio"&&C.name!=null&&Ke(_,C),cr(W,P);var xe=cr(W,C);for(P=0;P<Z.length;P+=2){var Oe=Z[P],Ue=Z[P+1];Oe==="style"?kt(_,Ue):Oe==="dangerouslySetInnerHTML"?wt(_,Ue):Oe==="children"?We(_,Ue):D(_,Oe,Ue,xe)}switch(W){case"input":qe(_,C);break;case"textarea":jr(_,C);break;case"select":var Fe=_._wrapperState.wasMultiple;_._wrapperState.wasMultiple=!!C.multiple;var nt=C.value;nt!=null?ut(_,!!C.multiple,nt,!1):Fe!==!!C.multiple&&(C.defaultValue!=null?ut(_,!!C.multiple,C.defaultValue,!0):ut(_,!!C.multiple,C.multiple?[]:"",!1))}_[_a]=C}catch(vt){rn(o,o.return,vt)}}break;case 6:if(to(a,o),Go(o),g&4){if(o.stateNode===null)throw Error(t(162));_=o.stateNode,C=o.memoizedProps;try{_.nodeValue=C}catch(vt){rn(o,o.return,vt)}}break;case 3:if(to(a,o),Go(o),g&4&&h!==null&&h.memoizedState.isDehydrated)try{er(a.containerInfo)}catch(vt){rn(o,o.return,vt)}break;case 4:to(a,o),Go(o);break;case 13:to(a,o),Go(o),_=o.child,_.flags&8192&&(C=_.memoizedState!==null,_.stateNode.isHidden=C,!C||_.alternate!==null&&_.alternate.memoizedState!==null||(kp=Xt())),g&4&&Pc(o);break;case 22:if(Oe=h!==null&&h.memoizedState!==null,o.mode&1?(Zr=(xe=Zr)||Oe,to(a,o),Zr=xe):to(a,o),Go(o),g&8192){if(xe=o.memoizedState!==null,(o.stateNode.isHidden=xe)&&!Oe&&(o.mode&1)!==0)for(ct=o,Oe=o.child;Oe!==null;){for(Ue=ct=Oe;ct!==null;){switch(Fe=ct,nt=Fe.child,Fe.tag){case 0:case 11:case 14:case 15:ea(4,Fe,Fe.return);break;case 1:Rc(Fe,Fe.return);var gt=Fe.stateNode;if(typeof gt.componentWillUnmount=="function"){g=Fe,h=Fe.return;try{a=g,gt.props=a.memoizedProps,gt.state=a.memoizedState,gt.componentWillUnmount()}catch(vt){rn(g,h,vt)}}break;case 5:Rc(Fe,Fe.return);break;case 22:if(Fe.memoizedState!==null){Ia(Ue);continue}}nt!==null?(nt.return=Fe,ct=nt):Ia(Ue)}Oe=Oe.sibling}e:for(Oe=null,Ue=o;;){if(Ue.tag===5){if(Oe===null){Oe=Ue;try{_=Ue.stateNode,xe?(C=_.style,typeof C.setProperty=="function"?C.setProperty("display","none","important"):C.display="none"):(W=Ue.stateNode,Z=Ue.memoizedProps.style,P=Z!=null&&Z.hasOwnProperty("display")?Z.display:null,W.style.display=Pe("display",P))}catch(vt){rn(o,o.return,vt)}}}else if(Ue.tag===6){if(Oe===null)try{Ue.stateNode.nodeValue=xe?"":Ue.memoizedProps}catch(vt){rn(o,o.return,vt)}}else if((Ue.tag!==22&&Ue.tag!==23||Ue.memoizedState===null||Ue===o)&&Ue.child!==null){Ue.child.return=Ue,Ue=Ue.child;continue}if(Ue===o)break e;for(;Ue.sibling===null;){if(Ue.return===null||Ue.return===o)break e;Oe===Ue&&(Oe=null),Ue=Ue.return}Oe===Ue&&(Oe=null),Ue.sibling.return=Ue.return,Ue=Ue.sibling}}break;case 19:to(a,o),Go(o),g&4&&Pc(o);break;case 21:break;default:to(a,o),Go(o)}}function Go(o){var a=o.flags;if(a&2){try{e:{for(var h=o.return;h!==null;){if(rv(h)){var g=h;break e}h=h.return}throw Error(t(160))}switch(g.tag){case 5:var _=g.stateNode;g.flags&32&&(We(_,""),g.flags&=-33);var C=nv(o);vf(o,C,_);break;case 3:case 4:var P=g.stateNode.containerInfo,W=nv(o);wp(o,W,P);break;default:throw Error(t(161))}}catch(Z){rn(o,o.return,Z)}o.flags&=-3}a&4096&&(o.flags&=-4097)}function yf(o,a,h){ct=o,Sp(o)}function Sp(o,a,h){for(var g=(o.mode&1)!==0;ct!==null;){var _=ct,C=_.child;if(_.tag===22&&g){var P=_.memoizedState!==null||mf;if(!P){var W=_.alternate,Z=W!==null&&W.memoizedState!==null||Zr;W=mf;var xe=Zr;if(mf=P,(Zr=Z)&&!xe)for(ct=_;ct!==null;)P=ct,Z=P.child,P.tag===22&&P.memoizedState!==null?sv(_):Z!==null?(Z.return=P,ct=Z):sv(_);for(;C!==null;)ct=C,Sp(C),C=C.sibling;ct=_,mf=W,Zr=xe}Wo(o)}else(_.subtreeFlags&8772)!==0&&C!==null?(C.return=_,ct=C):Wo(o)}}function Wo(o){for(;ct!==null;){var a=ct;if((a.flags&8772)!==0){var h=a.alternate;try{if((a.flags&8772)!==0)switch(a.tag){case 0:case 11:case 15:Zr||Gu(5,a);break;case 1:var g=a.stateNode;if(a.flags&4&&!Zr)if(h===null)g.componentDidMount();else{var _=a.elementType===a.type?h.memoizedProps:Eo(a.type,h.memoizedProps);g.componentDidUpdate(_,h.memoizedState,g.__reactInternalSnapshotBeforeUpdate)}var C=a.updateQueue;C!==null&&Yh(a,C,g);break;case 3:var P=a.updateQueue;if(P!==null){if(h=null,a.child!==null)switch(a.child.tag){case 5:h=a.child.stateNode;break;case 1:h=a.child.stateNode}Yh(a,P,h)}break;case 5:var W=a.stateNode;if(h===null&&a.flags&4){h=W;var Z=a.memoizedProps;switch(a.type){case"button":case"input":case"select":case"textarea":Z.autoFocus&&h.focus();break;case"img":Z.src&&(h.src=Z.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(a.memoizedState===null){var xe=a.alternate;if(xe!==null){var Oe=xe.memoizedState;if(Oe!==null){var Ue=Oe.dehydrated;Ue!==null&&er(Ue)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Zr||a.flags&512&&gf(a)}catch(Fe){rn(a,a.return,Fe)}}if(a===o){ct=null;break}if(h=a.sibling,h!==null){h.return=a.return,ct=h;break}ct=a.return}}function Ia(o){for(;ct!==null;){var a=ct;if(a===o){ct=null;break}var h=a.sibling;if(h!==null){h.return=a.return,ct=h;break}ct=a.return}}function sv(o){for(;ct!==null;){var a=ct;try{switch(a.tag){case 0:case 11:case 15:var h=a.return;try{Gu(4,a)}catch(Z){rn(a,h,Z)}break;case 1:var g=a.stateNode;if(typeof g.componentDidMount=="function"){var _=a.return;try{g.componentDidMount()}catch(Z){rn(a,_,Z)}}var C=a.return;try{gf(a)}catch(Z){rn(a,C,Z)}break;case 5:var P=a.return;try{gf(a)}catch(Z){rn(a,P,Z)}}}catch(Z){rn(a,a.return,Z)}if(a===o){ct=null;break}var W=a.sibling;if(W!==null){W.return=a.return,ct=W;break}ct=a.return}}var ov=Math.ceil,xf=j.ReactCurrentDispatcher,Ep=j.ReactCurrentOwner,ko=j.ReactCurrentBatchConfig,xr=0,Fn=null,xn=null,Vn=0,ro=0,jc=As(0),Cn=0,Wu=null,Ra=0,Vu=0,wf=0,qu=null,Fs=null,kp=0,Sl=1/0,ta=null,bf=!1,Cp=null,Pa=null,_f=!1,ja=null,ys=0,Ku=0,Np=null,Sf=-1,Yu=0;function xs(){return(xr&6)!==0?Xt():Sf!==-1?Sf:Sf=Xt()}function Fa(o){return(o.mode&1)===0?1:(xr&2)!==0&&Vn!==0?Vn&-Vn:Mg.transition!==null?(Yu===0&&(Yu=cu()),Yu):(o=vr,o!==0||(o=window.event,o=o===void 0?16:ug(o.type)),o)}function Vo(o,a,h,g){if(50<Ku)throw Ku=0,Np=null,Error(t(185));rl(o,h,g),((xr&2)===0||o!==Fn)&&(o===Fn&&((xr&2)===0&&(Vu|=h),Cn===4&&Oa(o,Vn)),Os(o,g),h===1&&xr===0&&(a.mode&1)===0&&(Sl=Xt()+500,Bd&&Ea()))}function Os(o,a){var h=o.callbackNode;kh(o,a);var g=qs(o,o===Fn?Vn:0);if(g===0)h!==null&&De(h),o.callbackNode=null,o.callbackPriority=0;else if(a=g&-g,o.callbackPriority!==a){if(h!=null&&De(h),a===1)o.tag===0?fl(iv.bind(null,o)):Og(iv.bind(null,o)),$d(function(){(xr&6)===0&&Ea()}),h=null;else{switch(Ks(g)){case 1:h=cn;break;case 4:h=ds;break;case 16:h=Cs;break;case 536870912:h=Gr;break;default:h=Cs}h=hv(h,Ef.bind(null,o))}o.callbackPriority=a,o.callbackNode=h}}function Ef(o,a){if(Sf=-1,Yu=0,(xr&6)!==0)throw Error(t(327));var h=o.callbackNode;if(Fc()&&o.callbackNode!==h)return null;var g=qs(o,o===Fn?Vn:0);if(g===0)return null;if((g&30)!==0||(g&o.expiredLanes)!==0||a)a=kf(o,g);else{a=g;var _=xr;xr|=2;var C=lv();(Fn!==o||Vn!==a)&&(ta=null,Sl=Xt()+500,kl(o,a));do try{F0();break}catch(W){av(o,W)}while(!0);qi(),xf.current=C,xr=_,xn!==null?a=0:(Fn=null,Vn=0,a=Cn)}if(a!==0){if(a===2&&(_=ec(o),_!==0&&(g=_,a=Tp(o,_))),a===1)throw h=Wu,kl(o,0),Oa(o,g),Os(o,Xt()),h;if(a===6)Oa(o,g);else{if(_=o.current.alternate,(g&30)===0&&!P0(_)&&(a=kf(o,g),a===2&&(C=ec(o),C!==0&&(g=C,a=Tp(o,C))),a===1))throw h=Wu,kl(o,0),Oa(o,g),Os(o,Xt()),h;switch(o.finishedWork=_,o.finishedLanes=g,a){case 0:case 1:throw Error(t(345));case 2:Cl(o,Fs,ta);break;case 3:if(Oa(o,g),(g&130023424)===g&&(a=kp+500-Xt(),10<a)){if(qs(o,0)!==0)break;if(_=o.suspendedLanes,(_&g)!==g){xs(),o.pingedLanes|=o.suspendedLanes&_;break}o.timeoutHandle=wa(Cl.bind(null,o,Fs,ta),a);break}Cl(o,Fs,ta);break;case 4:if(Oa(o,g),(g&4194240)===g)break;for(a=o.eventTimes,_=-1;0<g;){var P=31-Ns(g);C=1<<P,P=a[P],P>_&&(_=P),g&=~C}if(g=_,g=Xt()-g,g=(120>g?120:480>g?480:1080>g?1080:1920>g?1920:3e3>g?3e3:4320>g?4320:1960*ov(g/1960))-g,10<g){o.timeoutHandle=wa(Cl.bind(null,o,Fs,ta),g);break}Cl(o,Fs,ta);break;case 5:Cl(o,Fs,ta);break;default:throw Error(t(329))}}}return Os(o,Xt()),o.callbackNode===h?Ef.bind(null,o):null}function Tp(o,a){var h=qu;return o.current.memoizedState.isDehydrated&&(kl(o,a).flags|=256),o=kf(o,a),o!==2&&(a=Fs,Fs=h,a!==null&&Ap(a)),o}function Ap(o){Fs===null?Fs=o:Fs.push.apply(Fs,o)}function P0(o){for(var a=o;;){if(a.flags&16384){var h=a.updateQueue;if(h!==null&&(h=h.stores,h!==null))for(var g=0;g<h.length;g++){var _=h[g],C=_.getSnapshot;_=_.value;try{if(!ve(C(),_))return!1}catch{return!1}}}if(h=a.child,a.subtreeFlags&16384&&h!==null)h.return=a,a=h;else{if(a===o)break;for(;a.sibling===null;){if(a.return===null||a.return===o)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function Oa(o,a){for(a&=~wf,a&=~Vu,o.suspendedLanes|=a,o.pingedLanes&=~a,o=o.expirationTimes;0<a;){var h=31-Ns(a),g=1<<h;o[h]=-1,a&=~g}}function iv(o){if((xr&6)!==0)throw Error(t(327));Fc();var a=qs(o,0);if((a&1)===0)return Os(o,Xt()),null;var h=kf(o,a);if(o.tag!==0&&h===2){var g=ec(o);g!==0&&(a=g,h=Tp(o,g))}if(h===1)throw h=Wu,kl(o,0),Oa(o,a),Os(o,Xt()),h;if(h===6)throw Error(t(345));return o.finishedWork=o.current.alternate,o.finishedLanes=a,Cl(o,Fs,ta),Os(o,Xt()),null}function Ip(o,a){var h=xr;xr|=1;try{return o(a)}finally{xr=h,xr===0&&(Sl=Xt()+500,Bd&&Ea())}}function El(o){ja!==null&&ja.tag===0&&(xr&6)===0&&Fc();var a=xr;xr|=1;var h=ko.transition,g=vr;try{if(ko.transition=null,vr=1,o)return o()}finally{vr=g,ko.transition=h,xr=a,(xr&6)===0&&Ea()}}function Rp(){ro=jc.current,Vr(jc)}function kl(o,a){o.finishedWork=null,o.finishedLanes=0;var h=o.timeoutHandle;if(h!==-1&&(o.timeoutHandle=-1,Eu(h)),xn!==null)for(h=xn.return;h!==null;){var g=h;switch(ml(g),g.tag){case 1:g=g.type.childContextTypes,g!=null&&Hd();break;case 3:Na(),Vr(Is),Vr(rs),Zd();break;case 5:Qd(g);break;case 4:Na();break;case 13:Vr(Qr);break;case 19:Vr(Qr);break;case 10:Kd(g.type._context);break;case 22:case 23:Rp()}h=h.return}if(Fn=o,xn=o=qo(o.current,null),Vn=ro=a,Cn=0,Wu=null,wf=Vu=Ra=0,Fs=qu=null,vl!==null){for(a=0;a<vl.length;a++)if(h=vl[a],g=h.interleaved,g!==null){h.interleaved=null;var _=g.next,C=h.pending;if(C!==null){var P=C.next;C.next=_,g.next=P}h.pending=g}vl=null}return o}function av(o,a){do{var h=xn;try{if(qi(),Ru.current=of,Sc){for(var g=tn.memoizedState;g!==null;){var _=g.queue;_!==null&&(_.pending=null),g=g.next}Sc=!1}if(Ta=0,kn=un=tn=null,Pu=!1,xl=0,Ep.current=null,h===null||h.return===null){Cn=1,Wu=a,xn=null;break}e:{var C=o,P=h.return,W=h,Z=a;if(a=Vn,W.flags|=32768,Z!==null&&typeof Z=="object"&&typeof Z.then=="function"){var xe=Z,Oe=W,Ue=Oe.tag;if((Oe.mode&1)===0&&(Ue===0||Ue===11||Ue===15)){var Fe=Oe.alternate;Fe?(Oe.updateQueue=Fe.updateQueue,Oe.memoizedState=Fe.memoizedState,Oe.lanes=Fe.lanes):(Oe.updateQueue=null,Oe.memoizedState=null)}var nt=Yg(P);if(nt!==null){nt.flags&=-257,dp(nt,P,W,C,a),nt.mode&1&&Lu(C,xe,a),a=nt,Z=xe;var gt=a.updateQueue;if(gt===null){var vt=new Set;vt.add(Z),a.updateQueue=vt}else gt.add(Z);break e}else{if((a&1)===0){Lu(C,xe,a),Pp();break e}Z=Error(t(426))}}else if(qr&&W.mode&1){var dn=Yg(P);if(dn!==null){(dn.flags&65536)===0&&(dn.flags|=256),dp(dn,P,W,C,a),wi(_l(Z,W));break e}}C=Z=_l(Z,W),Cn!==4&&(Cn=2),qu===null?qu=[C]:qu.push(C),C=P;do{switch(C.tag){case 3:C.flags|=65536,a&=-a,C.lanes|=a;var fe=Du(C,Z,a);zg(C,fe);break e;case 1:W=Z;var ne=C.type,pe=C.stateNode;if((C.flags&128)===0&&(typeof ne.getDerivedStateFromError=="function"||pe!==null&&typeof pe.componentDidCatch=="function"&&(Pa===null||!Pa.has(pe)))){C.flags|=65536,a&=-a,C.lanes|=a;var He=df(C,W,a);zg(C,He);break e}}C=C.return}while(C!==null)}uv(h)}catch(yt){a=yt,xn===h&&h!==null&&(xn=h=h.return);continue}break}while(!0)}function lv(){var o=xf.current;return xf.current=of,o===null?of:o}function Pp(){(Cn===0||Cn===3||Cn===2)&&(Cn=4),Fn===null||(Ra&268435455)===0&&(Vu&268435455)===0||Oa(Fn,Vn)}function kf(o,a){var h=xr;xr|=2;var g=lv();(Fn!==o||Vn!==a)&&(ta=null,kl(o,a));do try{j0();break}catch(_){av(o,_)}while(!0);if(qi(),xr=h,xf.current=g,xn!==null)throw Error(t(261));return Fn=null,Vn=0,Cn}function j0(){for(;xn!==null;)cv(xn)}function F0(){for(;xn!==null&&!Qe();)cv(xn)}function cv(o){var a=fv(o.alternate,o,ro);o.memoizedProps=o.pendingProps,a===null?uv(o):xn=a,Ep.current=null}function uv(o){var a=o;do{var h=a.alternate;if(o=a.return,(a.flags&32768)===0){if(h=A0(h,a,ro),h!==null){xn=h;return}}else{if(h=I0(h,a),h!==null){h.flags&=32767,xn=h;return}if(o!==null)o.flags|=32768,o.subtreeFlags=0,o.deletions=null;else{Cn=6,xn=null;return}}if(a=a.sibling,a!==null){xn=a;return}xn=a=o}while(a!==null);Cn===0&&(Cn=5)}function Cl(o,a,h){var g=vr,_=ko.transition;try{ko.transition=null,vr=1,O0(o,a,h,g)}finally{ko.transition=_,vr=g}return null}function O0(o,a,h,g){do Fc();while(ja!==null);if((xr&6)!==0)throw Error(t(327));h=o.finishedWork;var _=o.finishedLanes;if(h===null)return null;if(o.finishedWork=null,o.finishedLanes=0,h===o.current)throw Error(t(177));o.callbackNode=null,o.callbackPriority=0;var C=h.lanes|h.childLanes;if(yd(o,C),o===Fn&&(xn=Fn=null,Vn=0),(h.subtreeFlags&2064)===0&&(h.flags&2064)===0||_f||(_f=!0,hv(Cs,function(){return Fc(),null})),C=(h.flags&15990)!==0,(h.subtreeFlags&15990)!==0||C){C=ko.transition,ko.transition=null;var P=vr;vr=1;var W=xr;xr|=4,Ep.current=null,R0(o,h),_p(h,o),k0(dl),Ui=!!_u,dl=_u=null,o.current=h,yf(h),Tr(),xr=W,vr=P,ko.transition=C}else o.current=h;if(_f&&(_f=!1,ja=o,ys=_),C=o.pendingLanes,C===0&&(Pa=null),ou(h.stateNode),Os(o,Xt()),a!==null)for(g=o.onRecoverableError,h=0;h<a.length;h++)_=a[h],g(_.value,{componentStack:_.stack,digest:_.digest});if(bf)throw bf=!1,o=Cp,Cp=null,o;return(ys&1)!==0&&o.tag!==0&&Fc(),C=o.pendingLanes,(C&1)!==0?o===Np?Ku++:(Ku=0,Np=o):Ku=0,Ea(),null}function Fc(){if(ja!==null){var o=Ks(ys),a=ko.transition,h=vr;try{if(ko.transition=null,vr=16>o?16:o,ja===null)var g=!1;else{if(o=ja,ja=null,ys=0,(xr&6)!==0)throw Error(t(331));var _=xr;for(xr|=4,ct=o.current;ct!==null;){var C=ct,P=C.child;if((ct.flags&16)!==0){var W=C.deletions;if(W!==null){for(var Z=0;Z<W.length;Z++){var xe=W[Z];for(ct=xe;ct!==null;){var Oe=ct;switch(Oe.tag){case 0:case 11:case 15:ea(8,Oe,C)}var Ue=Oe.child;if(Ue!==null)Ue.return=Oe,ct=Ue;else for(;ct!==null;){Oe=ct;var Fe=Oe.sibling,nt=Oe.return;if(tv(Oe),Oe===xe){ct=null;break}if(Fe!==null){Fe.return=nt,ct=Fe;break}ct=nt}}}var gt=C.alternate;if(gt!==null){var vt=gt.child;if(vt!==null){gt.child=null;do{var dn=vt.sibling;vt.sibling=null,vt=dn}while(vt!==null)}}ct=C}}if((C.subtreeFlags&2064)!==0&&P!==null)P.return=C,ct=P;else e:for(;ct!==null;){if(C=ct,(C.flags&2048)!==0)switch(C.tag){case 0:case 11:case 15:ea(9,C,C.return)}var fe=C.sibling;if(fe!==null){fe.return=C.return,ct=fe;break e}ct=C.return}}var ne=o.current;for(ct=ne;ct!==null;){P=ct;var pe=P.child;if((P.subtreeFlags&2064)!==0&&pe!==null)pe.return=P,ct=pe;else e:for(P=ne;ct!==null;){if(W=ct,(W.flags&2048)!==0)try{switch(W.tag){case 0:case 11:case 15:Gu(9,W)}}catch(yt){rn(W,W.return,yt)}if(W===P){ct=null;break e}var He=W.sibling;if(He!==null){He.return=W.return,ct=He;break e}ct=W.return}}if(xr=_,Ea(),Xn&&typeof Xn.onPostCommitFiberRoot=="function")try{Xn.onPostCommitFiberRoot(Lo,o)}catch{}g=!0}return g}finally{vr=h,ko.transition=a}}return!1}function Cf(o,a,h){a=_l(h,a),a=Du(o,a,1),o=_o(o,a,1),a=xs(),o!==null&&(rl(o,1,a),Os(o,a))}function rn(o,a,h){if(o.tag===3)Cf(o,o,h);else for(;a!==null;){if(a.tag===3){Cf(a,o,h);break}else if(a.tag===1){var g=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(Pa===null||!Pa.has(g))){o=_l(h,o),o=df(a,o,1),a=_o(a,o,1),o=xs(),a!==null&&(rl(a,1,o),Os(a,o));break}}a=a.return}}function D0(o,a,h){var g=o.pingCache;g!==null&&g.delete(a),a=xs(),o.pingedLanes|=o.suspendedLanes&h,Fn===o&&(Vn&h)===h&&(Cn===4||Cn===3&&(Vn&130023424)===Vn&&500>Xt()-kp?kl(o,0):wf|=h),Os(o,a)}function dv(o,a){a===0&&((o.mode&1)===0?a=1:(a=ci,ci<<=1,(ci&130023424)===0&&(ci=4194304)));var h=xs();o=Ki(o,a),o!==null&&(rl(o,a,h),Os(o,h))}function L0(o){var a=o.memoizedState,h=0;a!==null&&(h=a.retryLane),dv(o,h)}function M0(o,a){var h=0;switch(o.tag){case 13:var g=o.stateNode,_=o.memoizedState;_!==null&&(h=_.retryLane);break;case 19:g=o.stateNode;break;default:throw Error(t(314))}g!==null&&g.delete(a),dv(o,h)}var fv;fv=function(o,a,h){if(o!==null)if(o.memoizedProps!==a.pendingProps||Is.current)gs=!0;else{if((o.lanes&h)===0&&(a.flags&128)===0)return gs=!1,Qg(o,a,h);gs=(o.flags&131072)!==0}else gs=!1,qr&&(a.flags&1048576)!==0&&Dg(a,Wd,a.index);switch(a.lanes=0,a.tag){case 2:var g=a.type;pf(o,a),o=a.pendingProps;var _=yc(a,rs.current);Ca(a,h),_=wl(null,a,g,o,_,h);var C=ef();return a.flags|=1,typeof _=="object"&&_!==null&&typeof _.render=="function"&&_.$$typeof===void 0?(a.tag=1,a.memoizedState=null,a.updateQueue=null,Rs(g)?(C=!0,vo(a)):C=!1,a.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,Jd(a),_.updater=cf,a.stateNode=_,_._reactInternals=a,up(a,g,o,h),a=vp(null,a,g,!0,C,h)):(a.tag=0,qr&&C&&ku(a),Bn(null,a,_,h),a=a.child),a;case 16:g=a.elementType;e:{switch(pf(o,a),o=a.pendingProps,_=g._init,g=_(g._payload),a.type=g,_=a.tag=U0(g),o=Eo(g,o),_){case 0:a=mp(null,a,g,o,h);break e;case 1:a=gp(null,a,g,o,h);break e;case 11:a=Jg(null,a,g,o,h);break e;case 14:a=fp(null,a,g,Eo(g.type,o),h);break e}throw Error(t(306,g,""))}return a;case 0:return g=a.type,_=a.pendingProps,_=a.elementType===g?_:Eo(g,_),mp(o,a,g,_,h);case 1:return g=a.type,_=a.pendingProps,_=a.elementType===g?_:Eo(g,_),gp(o,a,g,_,h);case 3:e:{if(Xg(a),o===null)throw Error(t(387));g=a.pendingProps,C=a.memoizedState,_=C.element,Ug(o,a),bc(a,g,null,h);var P=a.memoizedState;if(g=P.element,C.isDehydrated)if(C={element:g,isDehydrated:!1,cache:P.cache,pendingSuspenseBoundaries:P.pendingSuspenseBoundaries,transitions:P.transitions},a.updateQueue.baseState=C,a.memoizedState=C,a.flags&256){_=_l(Error(t(423)),a),a=ki(o,a,g,h,_);break e}else if(g!==_){_=_l(Error(t(424)),a),a=ki(o,a,g,h,_);break e}else for(Zs=ba(a.stateNode.containerInfo.firstChild),ss=a,qr=!0,Uo=null,h=qd(a,null,g,h),a.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling;else{if(xi(),g===_){a=Ho(o,a,h);break e}Bn(o,a,g,h)}a=a.child}return a;case 5:return Xh(a),o===null&&Ps(a),g=a.type,_=a.pendingProps,C=o!==null?o.memoizedProps:null,P=_.children,Su(g,_)?P=null:C!==null&&Su(g,C)&&(a.flags|=32),pp(o,a),Bn(o,a,P,h),a.child;case 6:return o===null&&Ps(a),null;case 13:return hf(o,a,h);case 4:return Jh(a,a.stateNode.containerInfo),g=a.pendingProps,o===null?a.child=an(a,null,g,h):Bn(o,a,g,h),a.child;case 11:return g=a.type,_=a.pendingProps,_=a.elementType===g?_:Eo(g,_),Jg(o,a,g,_,h);case 7:return Bn(o,a,a.pendingProps,h),a.child;case 8:return Bn(o,a,a.pendingProps.children,h),a.child;case 12:return Bn(o,a,a.pendingProps.children,h),a.child;case 10:e:{if(g=a.type._context,_=a.pendingProps,C=a.memoizedProps,P=_.value,Hr(Tu,g._currentValue),g._currentValue=P,C!==null)if(ve(C.value,P)){if(C.children===_.children&&!Is.current){a=Ho(o,a,h);break e}}else for(C=a.child,C!==null&&(C.return=a);C!==null;){var W=C.dependencies;if(W!==null){P=C.child;for(var Z=W.firstContext;Z!==null;){if(Z.context===g){if(C.tag===1){Z=Yi(-1,h&-h),Z.tag=2;var xe=C.updateQueue;if(xe!==null){xe=xe.shared;var Oe=xe.pending;Oe===null?Z.next=Z:(Z.next=Oe.next,Oe.next=Z),xe.pending=Z}}C.lanes|=h,Z=C.alternate,Z!==null&&(Z.lanes|=h),Hn(C.return,h,a),W.lanes|=h;break}Z=Z.next}}else if(C.tag===10)P=C.type===a.type?null:C.child;else if(C.tag===18){if(P=C.return,P===null)throw Error(t(341));P.lanes|=h,W=P.alternate,W!==null&&(W.lanes|=h),Hn(P,h,a),P=C.sibling}else P=C.child;if(P!==null)P.return=C;else for(P=C;P!==null;){if(P===a){P=null;break}if(C=P.sibling,C!==null){C.return=P.return,P=C;break}P=P.return}C=P}Bn(o,a,_.children,h),a=a.child}return a;case 9:return _=a.type,g=a.pendingProps.children,Ca(a,h),_=wo(_),g=g(_),a.flags|=1,Bn(o,a,g,h),a.child;case 14:return g=a.type,_=Eo(g,a.pendingProps),_=Eo(g.type,_),fp(o,a,g,_,h);case 15:return Ei(o,a,a.type,a.pendingProps,h);case 17:return g=a.type,_=a.pendingProps,_=a.elementType===g?_:Eo(g,_),pf(o,a),a.tag=1,Rs(g)?(o=!0,vo(a)):o=!1,Ca(a,h),bl(a,g,_),up(a,g,_,h),vp(null,a,g,!0,o,h);case 19:return Aa(o,a,h);case 22:return hp(o,a,h)}throw Error(t(156,a.tag))};function hv(o,a){return q(o,a)}function $0(o,a,h,g){this.tag=o,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Co(o,a,h,g){return new $0(o,a,h,g)}function Nf(o){return o=o.prototype,!(!o||!o.isReactComponent)}function U0(o){if(typeof o=="function")return Nf(o)?1:0;if(o!=null){if(o=o.$$typeof,o===U)return 11;if(o===ae)return 14}return 2}function qo(o,a){var h=o.alternate;return h===null?(h=Co(o.tag,a,o.key,o.mode),h.elementType=o.elementType,h.type=o.type,h.stateNode=o.stateNode,h.alternate=o,o.alternate=h):(h.pendingProps=a,h.type=o.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=o.flags&14680064,h.childLanes=o.childLanes,h.lanes=o.lanes,h.child=o.child,h.memoizedProps=o.memoizedProps,h.memoizedState=o.memoizedState,h.updateQueue=o.updateQueue,a=o.dependencies,h.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},h.sibling=o.sibling,h.index=o.index,h.ref=o.ref,h}function Tf(o,a,h,g,_,C){var P=2;if(g=o,typeof o=="function")Nf(o)&&(P=1);else if(typeof o=="string")P=5;else e:switch(o){case G:return Nl(h.children,_,C,a);case K:P=8,_|=8;break;case re:return o=Co(12,h,a,_|2),o.elementType=re,o.lanes=C,o;case ge:return o=Co(13,h,a,_),o.elementType=ge,o.lanes=C,o;case ie:return o=Co(19,h,a,_),o.elementType=ie,o.lanes=C,o;case J:return Af(h,_,C,a);default:if(typeof o=="object"&&o!==null)switch(o.$$typeof){case se:P=10;break e;case he:P=9;break e;case U:P=11;break e;case ae:P=14;break e;case de:P=16,g=null;break e}throw Error(t(130,o==null?o:typeof o,""))}return a=Co(P,h,a,_),a.elementType=o,a.type=g,a.lanes=C,a}function Nl(o,a,h,g){return o=Co(7,o,g,a),o.lanes=h,o}function Af(o,a,h,g){return o=Co(22,o,g,a),o.elementType=J,o.lanes=h,o.stateNode={isHidden:!1},o}function jp(o,a,h){return o=Co(6,o,null,a),o.lanes=h,o}function Fp(o,a,h){return a=Co(4,o.children!==null?o.children:[],o.key,a),a.lanes=h,a.stateNode={containerInfo:o.containerInfo,pendingChildren:null,implementation:o.implementation},a}function z0(o,a,h,g,_){this.tag=a,this.containerInfo=o,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=tl(0),this.expirationTimes=tl(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=tl(0),this.identifierPrefix=g,this.onRecoverableError=_,this.mutableSourceEagerHydrationData=null}function Op(o,a,h,g,_,C,P,W,Z){return o=new z0(o,a,h,W,Z),a===1?(a=1,C===!0&&(a|=8)):a=0,C=Co(3,null,null,a),o.current=C,C.stateNode=o,C.memoizedState={element:g,isDehydrated:h,cache:null,transitions:null,pendingSuspenseBoundaries:null},Jd(C),o}function H0(o,a,h){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:B,key:g==null?null:""+g,children:o,containerInfo:a,implementation:h}}function pv(o){if(!o)return Sa;o=o._reactInternals;e:{if(ot(o)!==o||o.tag!==1)throw Error(t(170));var a=o;do{switch(a.tag){case 3:a=a.stateNode.context;break e;case 1:if(Rs(a.type)){a=a.stateNode.__reactInternalMemoizedMergedChildContext;break e}}a=a.return}while(a!==null);throw Error(t(171))}if(o.tag===1){var h=o.type;if(Rs(h))return jg(o,h,a)}return a}function mv(o,a,h,g,_,C,P,W,Z){return o=Op(h,g,!0,o,_,C,P,W,Z),o.context=pv(null),h=o.current,g=xs(),_=Fa(h),C=Yi(g,_),C.callback=a??null,_o(h,C,_),o.current.lanes=_,rl(o,_,g),Os(o,g),o}function If(o,a,h,g){var _=a.current,C=xs(),P=Fa(_);return h=pv(h),a.context===null?a.context=h:a.pendingContext=h,a=Yi(C,P),a.payload={element:o},g=g===void 0?null:g,g!==null&&(a.callback=g),o=_o(_,a,P),o!==null&&(Vo(o,_,P,C),Xd(o,_,P)),P}function Rf(o){if(o=o.current,!o.child)return null;switch(o.child.tag){case 5:return o.child.stateNode;default:return o.child.stateNode}}function gv(o,a){if(o=o.memoizedState,o!==null&&o.dehydrated!==null){var h=o.retryLane;o.retryLane=h!==0&&h<a?h:a}}function Dp(o,a){gv(o,a),(o=o.alternate)&&gv(o,a)}function B0(){return null}var vv=typeof reportError=="function"?reportError:function(o){console.error(o)};function Pf(o){this._internalRoot=o}Ju.prototype.render=Pf.prototype.render=function(o){var a=this._internalRoot;if(a===null)throw Error(t(409));If(o,a,null,null)},Ju.prototype.unmount=Pf.prototype.unmount=function(){var o=this._internalRoot;if(o!==null){this._internalRoot=null;var a=o.containerInfo;El(function(){If(null,o,null,null)}),a[Qs]=null}};function Ju(o){this._internalRoot=o}Ju.prototype.unstable_scheduleHydration=function(o){if(o){var a=du();o={blockedOn:null,target:o,priority:a};for(var h=0;h<ze.length&&a!==0&&a<ze[h].priority;h++);ze.splice(h,0,o),h===0&&at(o)}};function Lp(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11)}function jf(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11&&(o.nodeType!==8||o.nodeValue!==" react-mount-point-unstable "))}function yv(){}function G0(o,a,h,g,_){if(_){if(typeof g=="function"){var C=g;g=function(){var xe=Rf(P);C.call(xe)}}var P=mv(a,g,o,0,null,!1,!1,"",yv);return o._reactRootContainer=P,o[Qs]=P.current,xa(o.nodeType===8?o.parentNode:o),El(),P}for(;_=o.lastChild;)o.removeChild(_);if(typeof g=="function"){var W=g;g=function(){var xe=Rf(Z);W.call(xe)}}var Z=Op(o,0,!1,null,null,!1,!1,"",yv);return o._reactRootContainer=Z,o[Qs]=Z.current,xa(o.nodeType===8?o.parentNode:o),El(function(){If(a,Z,h,g)}),Z}function Tl(o,a,h,g,_){var C=h._reactRootContainer;if(C){var P=C;if(typeof _=="function"){var W=_;_=function(){var Z=Rf(P);W.call(Z)}}If(a,P,o,_)}else P=G0(h,a,o,_,g);return Rf(P)}sl=function(o){switch(o.tag){case 3:var a=o.stateNode;if(a.current.memoizedState.isDehydrated){var h=Vs(a.pendingLanes);h!==0&&(nl(a,h|1),Os(a,Xt()),(xr&6)===0&&(Sl=Xt()+500,Ea()))}break;case 13:El(function(){var g=Ki(o,1);if(g!==null){var _=xs();Vo(g,o,1,_)}}),Dp(o,1)}},tc=function(o){if(o.tag===13){var a=Ki(o,134217728);if(a!==null){var h=xs();Vo(a,o,134217728,h)}Dp(o,134217728)}},uu=function(o){if(o.tag===13){var a=Fa(o),h=Ki(o,a);if(h!==null){var g=xs();Vo(h,o,a,g)}Dp(o,a)}},du=function(){return vr},fu=function(o,a){var h=vr;try{return vr=o,a()}finally{vr=h}},Wt=function(o,a,h){switch(a){case"input":if(qe(o,h),a=h.name,h.type==="radio"&&a!=null){for(h=o;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll("input[name="+JSON.stringify(""+a)+'][type="radio"]'),a=0;a<h.length;a++){var g=h[a];if(g!==o&&g.form===o.form){var _=zd(g);if(!_)throw Error(t(90));Te(g),qe(g,_)}}}break;case"textarea":jr(o,h);break;case"select":a=h.value,a!=null&&ut(o,!!h.multiple,a,!1)}},_r=Ip,gn=El;var W0={usingClientEntryPoint:!1,Events:[ts,tr,zd,Oo,Jn,Ip]},Xu={findFiberByHostInstance:mi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},V0={bundleType:Xu.bundleType,version:Xu.version,rendererPackageName:Xu.rendererPackageName,rendererConfig:Xu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:j.ReactCurrentDispatcher,findHostInstanceByFiber:function(o){return o=En(o),o===null?null:o.stateNode},findFiberByHostInstance:Xu.findFiberByHostInstance||B0,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ff=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ff.isDisabled&&Ff.supportsFiber)try{Lo=Ff.inject(V0),Xn=Ff}catch{}}return Io.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W0,Io.createPortal=function(o,a){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Lp(a))throw Error(t(200));return H0(o,a,null,h)},Io.createRoot=function(o,a){if(!Lp(o))throw Error(t(299));var h=!1,g="",_=vv;return a!=null&&(a.unstable_strictMode===!0&&(h=!0),a.identifierPrefix!==void 0&&(g=a.identifierPrefix),a.onRecoverableError!==void 0&&(_=a.onRecoverableError)),a=Op(o,1,!1,null,null,h,!1,g,_),o[Qs]=a.current,xa(o.nodeType===8?o.parentNode:o),new Pf(a)},Io.findDOMNode=function(o){if(o==null)return null;if(o.nodeType===1)return o;var a=o._reactInternals;if(a===void 0)throw typeof o.render=="function"?Error(t(188)):(o=Object.keys(o).join(","),Error(t(268,o)));return o=En(a),o=o===null?null:o.stateNode,o},Io.flushSync=function(o){return El(o)},Io.hydrate=function(o,a,h){if(!jf(a))throw Error(t(200));return Tl(null,o,a,!0,h)},Io.hydrateRoot=function(o,a,h){if(!Lp(o))throw Error(t(405));var g=h!=null&&h.hydratedSources||null,_=!1,C="",P=vv;if(h!=null&&(h.unstable_strictMode===!0&&(_=!0),h.identifierPrefix!==void 0&&(C=h.identifierPrefix),h.onRecoverableError!==void 0&&(P=h.onRecoverableError)),a=mv(a,null,o,1,h??null,_,!1,C,P),o[Qs]=a.current,xa(o),g)for(o=0;o<g.length;o++)h=g[o],_=h._getVersion,_=_(h._source),a.mutableSourceEagerHydrationData==null?a.mutableSourceEagerHydrationData=[h,_]:a.mutableSourceEagerHydrationData.push(h,_);return new Ju(a)},Io.render=function(o,a,h){if(!jf(a))throw Error(t(200));return Tl(null,o,a,!1,h)},Io.unmountComponentAtNode=function(o){if(!jf(o))throw Error(t(40));return o._reactRootContainer?(El(function(){Tl(null,null,o,!1,function(){o._reactRootContainer=null,o[Qs]=null})}),!0):!1},Io.unstable_batchedUpdates=Ip,Io.unstable_renderSubtreeIntoContainer=function(o,a,h,g){if(!jf(h))throw Error(t(200));if(o==null||o._reactInternals===void 0)throw Error(t(38));return Tl(o,a,h,!1,g)},Io.version="18.3.1-next-f1338f8080-20240426",Io}var fE;function vN(){if(fE)return ax.exports;fE=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),ax.exports=WO(),ax.exports}var hE;function VO(){if(hE)return Sv;hE=1;var r=vN();return Sv.createRoot=r.createRoot,Sv.hydrateRoot=r.hydrateRoot,Sv}var qO=VO();const KO=bb(qO);class YO{constructor(e){z(this,"logger");z(this,"changeListeners",new Set);var t;this.logger=e,(t=chrome==null?void 0:chrome.storage)!=null&&t.onChanged&&chrome.storage.onChanged.addListener(this.handleStorageChange.bind(this))}async getLocalItem(e){try{const t=await new Promise((n,s)=>{chrome.storage.local.get(e,i=>{chrome.runtime.lastError?s(new Error(chrome.runtime.lastError.message)):n(i)})});try{if(t[e]!==void 0){const n=JSON.parse(t[e]);return this.logger.debug(`Retrieved local item with key: ${e}`,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"getLocalItem"}),n}return null}catch{return this.logger.debug(`Local item with key: ${e} is not JSON, returning as is`,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"getLocalItem"}),t[e]}}catch(t){return this.logger.error(`Error retrieving local item with key: ${e}`,t,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"getLocalItem"}),null}}async setLocalItem(e,t){try{const n={[e]:JSON.stringify(t)};await new Promise((s,i)=>{chrome.storage.local.set(n,()=>{chrome.runtime.lastError?i(new Error(chrome.runtime.lastError.message)):s()})}),this.logger.debug(`Stored local item with key: ${e}`,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"setLocalItem"})}catch(n){throw this.logger.error(`Error storing local item with key: ${e}`,n,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"setLocalItem"}),n}}async removeLocalItem(e){try{await new Promise((t,n)=>{chrome.storage.local.remove(e,()=>{chrome.runtime.lastError?n(new Error(chrome.runtime.lastError.message)):t()})}),this.logger.debug(`Removed local item with key: ${e}`,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"removeLocalItem"})}catch(t){throw this.logger.error(`Error removing local item with key: ${e}`,t,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"removeLocalItem"}),t}}async clearLocal(){try{await new Promise((e,t)=>{chrome.storage.local.clear(()=>{chrome.runtime.lastError?t(new Error(chrome.runtime.lastError.message)):e()})}),this.logger.info("Cleared local storage",{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"clearLocal"})}catch(e){throw this.logger.error("Error clearing local storage",e,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"clearLocal"}),e}}async getAllKeys(){try{const e=await new Promise((n,s)=>{chrome.storage.local.get(null,i=>{chrome.runtime.lastError?s(new Error(chrome.runtime.lastError.message)):n(i)})}),t=Object.keys(e);return this.logger.debug(`Retrieved ${t.length} keys from storage`,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"getAllKeys"}),t}catch(e){return this.logger.error("Error getting all keys",e,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"getAllKeys"}),[]}}onChanged(e){this.changeListeners.add(e)}removeChangeListener(e){this.changeListeners.delete(e)}handleStorageChange(e,t){if((t==="local"||t==="session"||t==="sync")&&this.changeListeners.size>0){const n={};for(const[s,i]of Object.entries(e))try{n[s]={oldValue:i.oldValue?JSON.parse(i.oldValue):void 0,newValue:i.newValue?JSON.parse(i.newValue):void 0}}catch(c){this.logger.debug("Storage change value not JSON",{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"handleStorageChange",key:s,areaName:t,error:c}),n[s]={oldValue:i.oldValue,newValue:i.newValue}}this.changeListeners.forEach(s=>{try{s(n)}catch(i){this.logger.error("Error in storage change callback",i,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"handleStorageChange"})}})}}}class JO{constructor(e){z(this,"logger");z(this,"threadListeners",new Set);z(this,"currentThread",null);this.logger=e,this.initializeStorageListeners()}initializeStorageListeners(){var e,t,n;(t=(e=chrome==null?void 0:chrome.storage)==null?void 0:e.local)!=null&&t.onChanged&&chrome.storage.local.onChanged.addListener(s=>{Object.keys(s).some(c=>c.includes("threadId_window_")&&c.includes("_tab_")||c.includes("threadData_window_")&&c.includes("_tab_"))&&(this.logger.debug("Tab-specific thread data changed, triggering update",{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"initializeStorageListeners",changedKeys:Object.keys(s)}),this.handleThreadDataChange())}),(n=chrome==null?void 0:chrome.tabs)!=null&&n.onActivated&&chrome.tabs.onActivated.addListener(s=>{this.logger.debug("Tab activated, updating thread data",{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"initializeStorageListeners",tabId:s.tabId,windowId:s.windowId}),setTimeout(()=>{this.handleThreadDataChange()},100)})}async getCurrentTabInfo(){try{const[e]=await chrome.tabs.query({active:!0,currentWindow:!0});return!(e!=null&&e.id)||!(e!=null&&e.windowId)?(this.logger.warn("No active tab found",{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentTabInfo"}),null):{tabId:e.id,windowId:e.windowId}}catch(e){return this.logger.error("Error getting current tab info",e,{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentTabInfo"}),null}}async handleThreadDataChange(){var e;try{const t=await this.getCurrentTabInfo(),n=await this.getCurrentThread(),s=(n==null?void 0:n.threadId)||null,i=((e=this.currentThread)==null?void 0:e.threadId)||null;s!==i&&(this.logger.info("Notifying thread listeners for tab",{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"handleThreadDataChange",tabId:t==null?void 0:t.tabId,windowId:t==null?void 0:t.windowId,newThreadId:s,currentThreadId:i}),this.currentThread=n,this.notifyThreadListeners(n))}catch(t){this.logger.error("Error handling thread data change",t,{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"handleThreadDataChange"})}}async getCurrentThread(){const e=await this.getCurrentTabInfo();if(!e)return this.logger.warn("No tab info available for getting current thread",{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentThread"}),null;const{tabId:t,windowId:n}=e,s=`threadId_window_${n}_tab_${t}`,i=`messageId_window_${n}_tab_${t}`,c=`threadData_window_${n}_tab_${t}`;return new Promise(d=>{chrome.storage.local.get([s,i,c],m=>{if(chrome.runtime.lastError){this.logger.error("Error getting thread data",chrome.runtime.lastError,{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentThread",tabId:t,windowId:n}),d(null);return}const p=m[s],v=m[i],x=m[c];if(!p||!x){this.logger.debug(`No thread data found for tab ${t} in window ${n}`,{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentThread",tabId:t,windowId:n,hasThreadId:!!p,hasThreadData:!!x}),d(null);return}try{const b=this.transformToEmailThread(p,x,v);this.logger.debug(`Retrieved thread data for tab ${t} in window ${n}`,{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentThread",tabId:t,windowId:n,threadId:p,messageId:v}),d(b)}catch(b){this.logger.error("Error transforming thread data",b,{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentThread",tabId:t,windowId:n}),d(null)}})})}async getCurrentThreadId(){const e=await this.getCurrentTabInfo();if(!e)return this.logger.warn("No tab info available for getting current thread ID",{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentThreadId"}),null;const{tabId:t,windowId:n}=e,s=`threadId_window_${n}_tab_${t}`;return new Promise(i=>{chrome.storage.local.get([s],c=>{if(chrome.runtime.lastError){this.logger.error("Error getting thread ID",chrome.runtime.lastError,{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentThreadId",tabId:t,windowId:n}),i(null);return}const d=c[s]||null;this.logger.debug(`Retrieved thread ID for tab ${t} in window ${n}`,{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentThreadId",tabId:t,windowId:n,threadId:d}),i(d)})})}getCurrentUserEmail(){return this.logger.debug("getCurrentUserEmail called for Chrome - not needed, backend handles filtering",{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentUserEmail"}),null}onThreadChanged(e){this.threadListeners.add(e)}removeThreadListener(e){this.threadListeners.delete(e)}notifyThreadListeners(e){this.threadListeners.forEach(t=>{try{t(e)}catch(n){this.logger.error("Error in thread change callback",n,{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"notifyThreadListeners"})}})}transformToEmailThread(e,t,n){var s;if(!t||!Array.isArray(t))return this.logger.warn("Invalid thread data format",{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"transformToEmailThread",threadId:e,threadData:t}),null;try{const i=t.map(d=>({from:d.from||"Unknown",timestamp:d.timestamp||new Date().toISOString(),subject:d.subject||"No Subject",body:d.body||"",html:d.html||d.body||""})),c=new Set;return t.forEach(d=>{d.from&&typeof d.from=="string"&&c.add(d.from),d.to&&Array.isArray(d.to)&&d.to.forEach(m=>{typeof m=="string"&&c.add(m)}),d.cc&&Array.isArray(d.cc)&&d.cc.forEach(m=>{typeof m=="string"&&c.add(m)}),d.bcc&&Array.isArray(d.bcc)&&d.bcc.forEach(m=>{typeof m=="string"&&c.add(m)})}),{threadId:e,messageId:n,messages:i,subject:((s=i[0])==null?void 0:s.subject)||"No Subject",participants:Array.from(c)}}catch(i){return this.logger.error("Error transforming email messages",i,{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"transformToEmailThread",threadId:e,threadData:t}),null}}}const XO="CandleLogsDB",QO=1,ux="logs";let Up=null;function ZO(){return Up||(Up=new Promise((r,e)=>{console.log("[Logger] Initializing IndexedDB...");const t=indexedDB.open(XO,QO);t.onupgradeneeded=n=>{console.log("[Logger] IndexedDB upgrade needed.");const s=n.target.result;if(!s.objectStoreNames.contains(ux)){console.log(`[Logger] Creating object store: ${ux}`);const i=s.createObjectStore(ux,{keyPath:"id",autoIncrement:!0});console.log("[Logger] Creating indexes: timestamp, level, chromeContext"),i.createIndex("timestamp","timestamp",{unique:!1}),i.createIndex("level","level",{unique:!1}),i.createIndex("chromeContext","chromeContext",{unique:!1})}},t.onsuccess=n=>{console.log("[Logger] IndexedDB initialized successfully."),r(n.target.result)},t.onerror=n=>{console.error("[Logger] IndexedDB initialization failed:",n.target.error),Up=null,e(n.target.error)},t.onblocked=()=>{console.warn("[Logger] IndexedDB initialization blocked. Close other tabs using the database.")}}),Up)}ZO().catch(r=>console.error("[Logger] Initial DB connection failed:",r));const e2=r=>r!==null&&typeof r=="object"&&!Array.isArray(r),t2=r=>e2(r)?["id_token","access_token","refresh_token","expires_in","token_type"].every(t=>{switch(t){case"expires_in":return typeof r[t]=="number";default:return typeof r[t]=="string"}}):!1,yN=r=>({setHttpHandler(e){r.httpHandler=e},httpHandler(){return r.httpHandler},updateHttpClientConfig(e,t){var n;(n=r.httpHandler)==null||n.updateHttpClientConfig(e,t)},httpHandlerConfigs(){return r.httpHandler.httpHandlerConfigs()}}),xN=r=>({httpHandler:r.httpHandler()});var Am;(function(r){r.HTTP="http",r.HTTPS="https"})(Am||(Am={}));var sy;(function(r){r.MD5="md5",r.CRC32="crc32",r.CRC32C="crc32c",r.SHA1="sha1",r.SHA256="sha256"})(sy||(sy={}));const vw="__smithy_context";class ii{constructor(e){z(this,"method");z(this,"protocol");z(this,"hostname");z(this,"port");z(this,"path");z(this,"query");z(this,"headers");z(this,"username");z(this,"password");z(this,"fragment");z(this,"body");this.method=e.method||"GET",this.hostname=e.hostname||"localhost",this.port=e.port,this.query=e.query||{},this.headers=e.headers||{},this.body=e.body,this.protocol=e.protocol?e.protocol.slice(-1)!==":"?`${e.protocol}:`:e.protocol:"https:",this.path=e.path?e.path.charAt(0)!=="/"?`/${e.path}`:e.path:"/",this.username=e.username,this.password=e.password,this.fragment=e.fragment}static clone(e){const t=new ii({...e,headers:{...e.headers}});return t.query&&(t.query=r2(t.query)),t}static isInstance(e){if(!e)return!1;const t=e;return"method"in t&&"protocol"in t&&"hostname"in t&&"path"in t&&typeof t.query=="object"&&typeof t.headers=="object"}clone(){return ii.clone(this)}}function r2(r){return Object.keys(r).reduce((e,t)=>{const n=r[t];return{...e,[t]:Array.isArray(n)?[...n]:n}},{})}class uh{constructor(e){z(this,"statusCode");z(this,"reason");z(this,"headers");z(this,"body");this.statusCode=e.statusCode,this.reason=e.reason,this.headers=e.headers||{},this.body=e.body}static isInstance(e){if(!e)return!1;const t=e;return typeof t.statusCode=="number"&&typeof t.headers=="object"}}const n2=r=>e=>async t=>{if(!ii.isInstance(t.request))return e(t);const{request:n}=t,{handlerProtocol:s=""}=r.requestHandler.metadata||{};if(s.indexOf("h2")>=0&&!n.headers[":authority"])delete n.headers.host,n.headers[":authority"]=n.hostname+(n.port?":"+n.port:"");else if(!n.headers.host){let i=n.hostname;n.port!=null&&(i+=`:${n.port}`),n.headers.host=i}return e(t)},s2={name:"hostHeaderMiddleware",step:"build",priority:"low",tags:["HOST"],override:!0},wN=r=>({applyToStack:e=>{e.add(n2(r),s2)}}),o2=()=>(r,e)=>async t=>{var n,s;try{const i=await r(t),{clientName:c,commandName:d,logger:m,dynamoDbDocumentClientOptions:p={}}=e,{overrideInputFilterSensitiveLog:v,overrideOutputFilterSensitiveLog:x}=p,b=v??e.inputFilterSensitiveLog,S=x??e.outputFilterSensitiveLog,{$metadata:N,...E}=i.output;return(n=m==null?void 0:m.info)==null||n.call(m,{clientName:c,commandName:d,input:b(t.input),output:S(E),metadata:N}),i}catch(i){const{clientName:c,commandName:d,logger:m,dynamoDbDocumentClientOptions:p={}}=e,{overrideInputFilterSensitiveLog:v}=p,x=v??e.inputFilterSensitiveLog;throw(s=m==null?void 0:m.error)==null||s.call(m,{clientName:c,commandName:d,input:x(t.input),error:i,metadata:i.$metadata}),i}},i2={name:"loggerMiddleware",tags:["LOGGER"],step:"initialize",override:!0},bN=r=>({applyToStack:e=>{e.add(o2(),i2)}}),a2={step:"build",tags:["RECURSION_DETECTION"],name:"recursionDetectionMiddleware",override:!0,priority:"low"},l2=()=>r=>async e=>r(e),_N=r=>({applyToStack:e=>{e.add(l2(),a2)}}),pd=r=>r[vw]||(r[vw]={}),oa=r=>{if(typeof r=="function")return r;const e=Promise.resolve(r);return()=>e},c2=(r,e)=>{if(!e||e.length===0)return r;const t=[];for(const n of e)for(const s of r)s.schemeId.split("#")[1]===n&&t.push(s);for(const n of r)t.find(({schemeId:s})=>s===n.schemeId)||t.push(n);return t};function u2(r){const e=new Map;for(const t of r)e.set(t.schemeId,t);return e}const d2=(r,e)=>(t,n)=>async s=>{var x;const i=r.httpAuthSchemeProvider(await e.httpAuthSchemeParametersProvider(r,n,s.input)),c=r.authSchemePreference?await r.authSchemePreference():[],d=c2(i,c),m=u2(r.httpAuthSchemes),p=pd(n),v=[];for(const b of d){const S=m.get(b.schemeId);if(!S){v.push(`HttpAuthScheme \`${b.schemeId}\` was not enabled for this service.`);continue}const N=S.identityProvider(await e.identityProviderConfigProvider(r));if(!N){v.push(`HttpAuthScheme \`${b.schemeId}\` did not have an IdentityProvider configured.`);continue}const{identityProperties:E={},signingProperties:T={}}=((x=b.propertiesExtractor)==null?void 0:x.call(b,r,n))||{};b.identityProperties=Object.assign(b.identityProperties||{},E),b.signingProperties=Object.assign(b.signingProperties||{},T),p.selectedHttpAuthScheme={httpAuthOption:b,identity:await N(b.identityProperties),signer:S.signer};break}if(!p.selectedHttpAuthScheme)throw new Error(v.join(`
`));return t(s)},f2={step:"serialize",tags:["HTTP_AUTH_SCHEME"],name:"httpAuthSchemeMiddleware",override:!0,relation:"before",toMiddleware:"endpointV2Middleware"},SN=(r,{httpAuthSchemeParametersProvider:e,identityProviderConfigProvider:t})=>({applyToStack:n=>{n.addRelativeTo(d2(r,{httpAuthSchemeParametersProvider:e,identityProviderConfigProvider:t}),f2)}}),h2={name:"serializerMiddleware"},p2=r=>e=>{throw e},m2=(r,e)=>{},g2=r=>(e,t)=>async n=>{if(!ii.isInstance(n.request))return e(n);const i=pd(t).selectedHttpAuthScheme;if(!i)throw new Error("No HttpAuthScheme was selected: unable to sign request");const{httpAuthOption:{signingProperties:c={}},identity:d,signer:m}=i,p=await e({...n,request:await m.sign(n.request,d,c)}).catch((m.errorHandler||p2)(c));return(m.successHandler||m2)(p.response,c),p},v2={step:"finalizeRequest",tags:["HTTP_SIGNING"],name:"httpSigningMiddleware",aliases:["apiKeyMiddleware","tokenMiddleware","awsAuthMiddleware"],override:!0,relation:"after",toMiddleware:"retryMiddleware"},EN=r=>({applyToStack:e=>{e.addRelativeTo(g2(),v2)}}),Sm=r=>{if(typeof r=="function")return r;const e=Promise.resolve(r);return()=>e},kN="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",pE=Object.entries(kN).reduce((r,[e,t])=>(r[t]=Number(e),r),{}),y2=kN.split(""),Zf=6,Em=8,x2=63,Jm=r=>{let e=r.length/4*3;r.slice(-2)==="=="?e-=2:r.slice(-1)==="="&&e--;const t=new ArrayBuffer(e),n=new DataView(t);for(let s=0;s<r.length;s+=4){let i=0,c=0;for(let p=s,v=s+3;p<=v;p++)if(r[p]!=="="){if(!(r[p]in pE))throw new TypeError(`Invalid character ${r[p]} in base64 string.`);i|=pE[r[p]]<<(v-p)*Zf,c+=Zf}else i>>=Zf;const d=s/4*3;i>>=c%Em;const m=Math.floor(c/Em);for(let p=0;p<m;p++){const v=(m-p-1)*Em;n.setUint8(d+p,(i&255<<v)>>v)}}return new Uint8Array(t)},cd=r=>new TextEncoder().encode(r),Im=r=>typeof r=="string"?cd(r):ArrayBuffer.isView(r)?new Uint8Array(r.buffer,r.byteOffset,r.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(r),Ly=r=>{if(typeof r=="string")return r;if(typeof r!="object"||typeof r.byteOffset!="number"||typeof r.byteLength!="number")throw new Error("@smithy/util-utf8: toUtf8 encoder function only accepts string | Uint8Array.");return new TextDecoder("utf-8").decode(r)};function Rm(r){let e;typeof r=="string"?e=cd(r):e=r;const t=typeof e=="object"&&typeof e.length=="number",n=typeof e=="object"&&typeof e.byteOffset=="number"&&typeof e.byteLength=="number";if(!t&&!n)throw new Error("@smithy/util-base64: toBase64 encoder function only accepts string | Uint8Array.");let s="";for(let i=0;i<e.length;i+=3){let c=0,d=0;for(let p=i,v=Math.min(i+3,e.length);p<v;p++)c|=e[p]<<(v-p-1)*Em,d+=Em;const m=Math.ceil(d/Zf);c<<=m*Zf-d;for(let p=1;p<=m;p++){const v=(m-p)*Zf;s+=y2[(c&x2<<v)>>v]}s+="==".slice(0,4-m)}return s}class id extends Uint8Array{static fromString(e,t="utf-8"){if(typeof e=="string")return t==="base64"?id.mutate(Jm(e)):id.mutate(cd(e));throw new Error(`Unsupported conversion from ${typeof e} to Uint8ArrayBlobAdapter.`)}static mutate(e){return Object.setPrototypeOf(e,id.prototype),e}transformToString(e="utf-8"){return e==="base64"?Rm(this):Ly(this)}}const ad=r=>encodeURIComponent(r).replace(/[!'()*]/g,w2),w2=r=>`%${r.charCodeAt(0).toString(16).toUpperCase()}`;function b2(r){const e=[];for(let t of Object.keys(r).sort()){const n=r[t];if(t=ad(t),Array.isArray(n))for(let s=0,i=n.length;s<i;s++)e.push(`${t}=${ad(n[s])}`);else{let s=t;(n||typeof n=="string")&&(s+=`=${ad(n)}`),e.push(s)}}return e.join("&")}function mE(r,e){return new Request(r,e)}function _2(r=0){return new Promise((e,t)=>{r&&setTimeout(()=>{const n=new Error(`Request did not complete within ${r} ms`);n.name="TimeoutError",t(n)},r)})}const dx={supported:void 0};class My{constructor(e){z(this,"config");z(this,"configProvider");typeof e=="function"?this.configProvider=e().then(t=>t||{}):(this.config=e??{},this.configProvider=Promise.resolve(this.config)),dx.supported===void 0&&(dx.supported=typeof Request<"u"&&"keepalive"in mE("https://[::1]"))}static create(e){return typeof(e==null?void 0:e.handle)=="function"?e:new My(e)}destroy(){}async handle(e,{abortSignal:t,requestTimeout:n}={}){var I;this.config||(this.config=await this.configProvider);const s=n??this.config.requestTimeout,i=this.config.keepAlive===!0,c=this.config.credentials;if(t!=null&&t.aborted){const D=new Error("Request aborted");return D.name="AbortError",Promise.reject(D)}let d=e.path;const m=b2(e.query||{});m&&(d+=`?${m}`),e.fragment&&(d+=`#${e.fragment}`);let p="";if(e.username!=null||e.password!=null){const D=e.username??"",j=e.password??"";p=`${D}:${j}@`}const{port:v,method:x}=e,b=`${e.protocol}//${p}${e.hostname}${v?`:${v}`:""}${d}`,S=x==="GET"||x==="HEAD"?void 0:e.body,N={body:S,headers:new Headers(e.headers),method:x,credentials:c};(I=this.config)!=null&&I.cache&&(N.cache=this.config.cache),S&&(N.duplex="half"),typeof AbortController<"u"&&(N.signal=t),dx.supported&&(N.keepalive=i),typeof this.config.requestInit=="function"&&Object.assign(N,this.config.requestInit(e));let E=()=>{};const T=mE(b,N),A=[fetch(T).then(D=>{const j=D.headers,O={};for(const G of j.entries())O[G[0]]=G[1];return D.body!=null?{response:new uh({headers:O,reason:D.statusText,statusCode:D.status,body:D.body})}:D.blob().then(G=>({response:new uh({headers:O,reason:D.statusText,statusCode:D.status,body:G})}))}),_2(s)];return t&&A.push(new Promise((D,j)=>{const O=()=>{const B=new Error("Request aborted");B.name="AbortError",j(B)};if(typeof t.addEventListener=="function"){const B=t;B.addEventListener("abort",O,{once:!0}),E=()=>B.removeEventListener("abort",O)}else t.onabort=O})),Promise.race(A).finally(E)}updateHttpClientConfig(e,t){this.config=void 0,this.configProvider=this.configProvider.then(n=>(n[e]=t,n))}httpHandlerConfigs(){return this.config??{}}}const CN=async r=>{var e;return typeof Blob=="function"&&r instanceof Blob||((e=r.constructor)==null?void 0:e.name)==="Blob"?Blob.prototype.arrayBuffer!==void 0?new Uint8Array(await r.arrayBuffer()):S2(r):E2(r)};async function S2(r){const e=await k2(r),t=Jm(e);return new Uint8Array(t)}async function E2(r){const e=[],t=r.getReader();let n=!1,s=0;for(;!n;){const{done:d,value:m}=await t.read();m&&(e.push(m),s+=m.length),n=d}const i=new Uint8Array(s);let c=0;for(const d of e)i.set(d,c),c+=d.length;return i}function k2(r){return new Promise((e,t)=>{const n=new FileReader;n.onloadend=()=>{if(n.readyState!==2)return t(new Error("Reader aborted too early"));const s=n.result??"",i=s.indexOf(","),c=i>-1?i+1:s.length;e(s.substring(c))},n.onabort=()=>t(new Error("Read aborted")),n.onerror=()=>t(n.error),n.readAsDataURL(r)})}const NN={},yw={};for(let r=0;r<256;r++){let e=r.toString(16).toLowerCase();e.length===1&&(e=`0${e}`),NN[r]=e,yw[e]=r}function C2(r){if(r.length%2!==0)throw new Error("Hex encoded strings must have an even number length");const e=new Uint8Array(r.length/2);for(let t=0;t<r.length;t+=2){const n=r.slice(t,t+2).toLowerCase();if(n in yw)e[t/2]=yw[n];else throw new Error(`Cannot decode unrecognized sequence ${n} as hexadecimal`)}return e}function ld(r){let e="";for(let t=0;t<r.byteLength;t++)e+=NN[r[t]];return e}const xw=async(r=new Uint8Array,e)=>{if(r instanceof Uint8Array)return id.mutate(r);if(!r)return id.mutate(new Uint8Array);const t=e.streamCollector(r);return id.mutate(await t)},Bv=r=>typeof r=="function"?r():r,TN=(r,e,t,n,s)=>({name:e,namespace:r,traits:t,input:n,output:s}),N2=r=>(e,t)=>async n=>{var x,b,S,N;const{response:s}=await e(n),{operationSchema:i}=pd(t),[,c,d,m,p,v]=i??[];try{const E=await r.protocol.deserializeResponse(TN(c,d,m,p,v),{...r,...t},s);return{response:s,output:E}}catch(E){if(Object.defineProperty(E,"$response",{value:s,enumerable:!1,writable:!1,configurable:!1}),!("$metadata"in E)){const T="Deserialization error: to see the raw response, inspect the hidden field {error}.$response on this object.";try{E.message+=`
  `+T}catch{!t.logger||((b=(x=t.logger)==null?void 0:x.constructor)==null?void 0:b.name)==="NoOpLogger"?console.warn(T):(N=(S=t.logger)==null?void 0:S.warn)==null||N.call(S,T)}typeof E.$responseBodyText<"u"&&E.$response&&(E.$response.body=E.$responseBodyText);try{if(uh.isInstance(s)){const{headers:A={}}=s,I=Object.entries(A);E.$metadata={httpStatusCode:s.statusCode,requestId:fx(/^x-[\w-]+-request-?id$/,I),extendedRequestId:fx(/^x-[\w-]+-id-2$/,I),cfId:fx(/^x-[\w-]+-cf-id$/,I)}}}catch{}}throw E}},fx=(r,e)=>(e.find(([t])=>t.match(r))||[void 0,void 0])[1],T2=r=>(e,t)=>async n=>{var b;const{operationSchema:s}=pd(t),[,i,c,d,m,p]=s??[],v=(b=t.endpointV2)!=null&&b.url&&r.urlParser?async()=>r.urlParser(t.endpointV2.url):r.endpoint,x=await r.protocol.serializeRequest(TN(i,c,d,m,p),n.input,{...r,...t,endpoint:v});return e({...n,request:x})},A2={name:"deserializerMiddleware",step:"deserialize",tags:["DESERIALIZER"],override:!0},I2={name:"serializerMiddleware",step:"serialize",tags:["SERIALIZER"],override:!0};function AN(r){return{applyToStack:e=>{e.add(T2(r),I2),e.add(N2(r),A2),r.protocol.setSerdeContext(r)}}}function um(r){if(typeof r=="object")return r;r=r|0;const e={};let t=0;for(const n of["httpLabel","idempotent","idempotencyToken","sensitive","httpPayload","httpResponseCode","httpQueryParams"])(r>>t++&1)===1&&(e[n]=1);return e}const gE={it:Symbol.for("@smithy/nor-struct-it")},Bc=class Bc{constructor(e,t){z(this,"ref");z(this,"memberName");z(this,"symbol",Bc.symbol);z(this,"name");z(this,"schema");z(this,"_isMemberSchema");z(this,"traits");z(this,"memberTraits");z(this,"normalizedTraits");this.ref=e,this.memberName=t;const n=[];let s=e,i=e;for(this._isMemberSchema=!1;hx(s);)n.push(s[1]),s=s[0],i=Bv(s),this._isMemberSchema=!0;if(n.length>0){this.memberTraits={};for(let c=n.length-1;c>=0;--c){const d=n[c];Object.assign(this.memberTraits,um(d))}}else this.memberTraits=0;if(i instanceof Bc){const c=this.memberTraits;Object.assign(this,i),this.memberTraits=Object.assign({},c,i.getMemberTraits(),this.getMemberTraits()),this.normalizedTraits=void 0,this.memberName=t??i.memberName;return}if(this.schema=Bv(i),R2(this.schema)?(this.name=`${this.schema[1]}#${this.schema[2]}`,this.traits=this.schema[3]):(this.name=this.memberName??String(i),this.traits=0),this._isMemberSchema&&!t)throw new Error(`@smithy/core/schema - NormalizedSchema member init ${this.getName(!0)} missing member name.`)}static[Symbol.hasInstance](e){const t=this.prototype.isPrototypeOf(e);return!t&&typeof e=="object"&&e!==null?e.symbol===this.symbol:t}static of(e){const t=Bv(e);if(t instanceof Bc)return t;if(hx(t)){const[n,s]=t;if(n instanceof Bc)return Object.assign(n.getMergedTraits(),um(s)),n;throw new Error(`@smithy/core/schema - may not init unwrapped member schema=${JSON.stringify(e,null,2)}.`)}return new Bc(t)}getSchema(){const e=this.schema;return Array.isArray(e)&&e[0]===0?e[4]:e}getName(e=!1){const{name:t}=this;return!e&&t&&t.includes("#")?t.split("#")[1]:t||void 0}getMemberName(){return this.memberName}isMemberSchema(){return this._isMemberSchema}isListSchema(){const e=this.getSchema();return typeof e=="number"?e>=64&&e<128:e[0]===1}isMapSchema(){const e=this.getSchema();return typeof e=="number"?e>=128&&e<=255:e[0]===2}isStructSchema(){const e=this.getSchema();if(typeof e!="object")return!1;const t=e[0];return t===3||t===-3||t===4}isUnionSchema(){const e=this.getSchema();return typeof e!="object"?!1:e[0]===4}isBlobSchema(){const e=this.getSchema();return e===21||e===42}isTimestampSchema(){const e=this.getSchema();return typeof e=="number"&&e>=4&&e<=7}isUnitSchema(){return this.getSchema()==="unit"}isDocumentSchema(){return this.getSchema()===15}isStringSchema(){return this.getSchema()===0}isBooleanSchema(){return this.getSchema()===2}isNumericSchema(){return this.getSchema()===1}isBigIntegerSchema(){return this.getSchema()===17}isBigDecimalSchema(){return this.getSchema()===19}isStreaming(){const{streaming:e}=this.getMergedTraits();return!!e||this.getSchema()===42}isIdempotencyToken(){return!!this.getMergedTraits().idempotencyToken}getMergedTraits(){return this.normalizedTraits??(this.normalizedTraits={...this.getOwnTraits(),...this.getMemberTraits()})}getMemberTraits(){return um(this.memberTraits)}getOwnTraits(){return um(this.traits)}getKeySchema(){const[e,t]=[this.isDocumentSchema(),this.isMapSchema()];if(!e&&!t)throw new Error(`@smithy/core/schema - cannot get key for non-map: ${this.getName(!0)}`);const n=this.getSchema(),s=e?15:n[4]??0;return zp([s,0],"key")}getValueSchema(){const e=this.getSchema(),[t,n,s]=[this.isDocumentSchema(),this.isMapSchema(),this.isListSchema()],i=typeof e=="number"?63&e:e&&typeof e=="object"&&(n||s)?e[3+e[0]]:t?15:void 0;if(i!=null)return zp([i,0],n?"value":"member");throw new Error(`@smithy/core/schema - ${this.getName(!0)} has no value member.`)}getMemberSchema(e){const t=this.getSchema();if(this.isStructSchema()&&t[4].includes(e)){const n=t[4].indexOf(e),s=t[5][n];return zp(hx(s)?s:[s,0],e)}if(this.isDocumentSchema())return zp([15,0],e);throw new Error(`@smithy/core/schema - ${this.getName(!0)} has no no member=${e}.`)}getMemberSchemas(){const e={};try{for(const[t,n]of this.structIterator())e[t]=n}catch{}return e}getEventStreamMember(){if(this.isStructSchema()){for(const[e,t]of this.structIterator())if(t.isStreaming()&&t.isStructSchema())return e}return""}*structIterator(){if(this.isUnitSchema())return;if(!this.isStructSchema())throw new Error("@smithy/core/schema - cannot iterate non-struct schema.");const e=this.getSchema(),t=e[4].length;let n=e[gE.it];if(n&&t===n.length){yield*n;return}n=Array(t);for(let s=0;s<t;++s){const i=e[4][s],c=zp([e[5][s],0],i);yield n[s]=[i,c]}e[gE.it]=n}};z(Bc,"symbol",Symbol.for("@smithy/nor"));let Fo=Bc;function zp(r,e){if(r instanceof Fo)return Object.assign(r,{memberName:e,_isMemberSchema:!0});const t=Fo;return new t(r,e)}const hx=r=>Array.isArray(r)&&r.length===2,R2=r=>Array.isArray(r)&&r.length>=5,za=class za{constructor(e,t=new Map,n=new Map){z(this,"namespace");z(this,"schemas");z(this,"exceptions");this.namespace=e,this.schemas=t,this.exceptions=n}static for(e){return za.registries.has(e)||za.registries.set(e,new za(e)),za.registries.get(e)}register(e,t){const n=this.normalizeShapeId(e);za.for(n.split("#")[0]).schemas.set(n,t)}getSchema(e){const t=this.normalizeShapeId(e);if(!this.schemas.has(t))throw new Error(`@smithy/core/schema - schema not found for ${t}`);return this.schemas.get(t)}registerError(e,t){const n=e,s=za.for(n[1]);s.schemas.set(n[1]+"#"+n[2],n),s.exceptions.set(n,t)}getErrorCtor(e){const t=e;return za.for(t[1]).exceptions.get(t)}getBaseException(){for(const e of this.exceptions.keys())if(Array.isArray(e)){const[,t,n]=e,s=t+"#"+n;if(s.startsWith("smithy.ts.sdk.synthetic.")&&s.endsWith("ServiceException"))return e}}find(e){return[...this.schemas.values()].find(e)}clear(){this.schemas.clear(),this.exceptions.clear()}normalizeShapeId(e){return e.includes("#")?e:this.namespace+"#"+e}};z(za,"registries",new Map);let xt=za;const ww=r=>{if(r!=null){if(typeof r=="string"){const e=parseFloat(r);if(!Number.isNaN(e))return String(e)!==String(r)&&U2.warn($2(`Expected number but observed string: ${r}`)),e}if(typeof r=="number")return r;throw new TypeError(`Expected number, got ${typeof r}: ${r}`)}},P2=Math.ceil(2**127*(2-2**-23)),vE=r=>{const e=ww(r);if(e!==void 0&&!Number.isNaN(e)&&e!==1/0&&e!==-1/0&&Math.abs(e)>P2)throw new TypeError(`Expected 32-bit float, got ${r}`);return e},j2=r=>{if(r!=null){if(Number.isInteger(r)&&!Number.isNaN(r))return r;throw new TypeError(`Expected integer, got ${typeof r}: ${r}`)}},yE=r=>IN(r,16),xE=r=>IN(r,8),IN=(r,e)=>{const t=j2(r);if(t!==void 0&&F2(t,e)!==t)throw new TypeError(`Expected ${e}-bit integer, got ${r}`);return t},F2=(r,e)=>{switch(e){case 32:return Int32Array.of(r)[0];case 16:return Int16Array.of(r)[0];case 8:return Int8Array.of(r)[0]}},O2=r=>ww(typeof r=="string"?$y(r):r),D2=r=>vE(typeof r=="string"?$y(r):r),L2=/(-?(?:0|[1-9]\d*)(?:\.\d+)?(?:[eE][+-]?\d+)?)|(-?Infinity)|(NaN)/g,$y=r=>{const e=r.match(L2);if(e===null||e[0].length!==r.length)throw new TypeError("Expected real number, got implicit NaN");return parseFloat(r)},oy=r=>yE(typeof r=="string"?$y(r):r),M2=r=>xE(typeof r=="string"?$y(r):r),$2=r=>String(new TypeError(r).stack||r).split(`
`).slice(0,5).filter(e=>!e.includes("stackTraceWarning")).join(`
`),U2={warn:console.warn},z2=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],Eb=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function H2(r){const e=r.getUTCFullYear(),t=r.getUTCMonth(),n=r.getUTCDay(),s=r.getUTCDate(),i=r.getUTCHours(),c=r.getUTCMinutes(),d=r.getUTCSeconds(),m=s<10?`0${s}`:`${s}`,p=i<10?`0${i}`:`${i}`,v=c<10?`0${c}`:`${c}`,x=d<10?`0${d}`:`${d}`;return`${z2[n]}, ${m} ${Eb[t]} ${e} ${p}:${v}:${x} GMT`}const B2=new RegExp(/^(\d{4})-(\d{2})-(\d{2})[tT](\d{2}):(\d{2}):(\d{2})(?:\.(\d+))?(([-+]\d{2}\:\d{2})|[zZ])$/),G2=r=>{if(r==null)return;if(typeof r!="string")throw new TypeError("RFC-3339 date-times must be expressed as strings");const e=B2.exec(r);if(!e)throw new TypeError("Invalid RFC-3339 date-time value");const[t,n,s,i,c,d,m,p,v]=e,x=oy(Pm(n)),b=Vc(s,"month",1,12),S=Vc(i,"day",1,31),N=Gv(x,b,S,{hours:c,minutes:d,seconds:m,fractionalMilliseconds:p});return v.toUpperCase()!="Z"&&N.setTime(N.getTime()-nD(v)),N},W2=new RegExp(/^(?:Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d{2}) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d{1,2}):(\d{2}):(\d{2})(?:\.(\d+))? GMT$/),V2=new RegExp(/^(?:Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d{2})-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d{2}) (\d{1,2}):(\d{2}):(\d{2})(?:\.(\d+))? GMT$/),q2=new RegExp(/^(?:Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( [1-9]|\d{2}) (\d{1,2}):(\d{2}):(\d{2})(?:\.(\d+))? (\d{4})$/),K2=r=>{if(r==null)return;if(typeof r!="string")throw new TypeError("RFC-7231 date-times must be expressed as strings");let e=W2.exec(r);if(e){const[t,n,s,i,c,d,m,p]=e;return Gv(oy(Pm(i)),px(s),Vc(n,"day",1,31),{hours:c,minutes:d,seconds:m,fractionalMilliseconds:p})}if(e=V2.exec(r),e){const[t,n,s,i,c,d,m,p]=e;return Q2(Gv(J2(i),px(s),Vc(n,"day",1,31),{hours:c,minutes:d,seconds:m,fractionalMilliseconds:p}))}if(e=q2.exec(r),e){const[t,n,s,i,c,d,m,p]=e;return Gv(oy(Pm(p)),px(n),Vc(s.trimLeft(),"day",1,31),{hours:i,minutes:c,seconds:d,fractionalMilliseconds:m})}throw new TypeError("Invalid RFC-7231 date-time value")},Y2=r=>{if(r==null)return;let e;if(typeof r=="number")e=r;else if(typeof r=="string")e=O2(r);else if(typeof r=="object"&&r.tag===1)e=r.value;else throw new TypeError("Epoch timestamps must be expressed as floating point numbers or their string representation");if(Number.isNaN(e)||e===1/0||e===-1/0)throw new TypeError("Epoch timestamps must be valid, non-Infinite, non-NaN numerics");return new Date(Math.round(e*1e3))},Gv=(r,e,t,n)=>{const s=e-1;return eD(r,s,t),new Date(Date.UTC(r,s,t,Vc(n.hours,"hour",0,23),Vc(n.minutes,"minute",0,59),Vc(n.seconds,"seconds",0,60),rD(n.fractionalMilliseconds)))},J2=r=>{const e=new Date().getUTCFullYear(),t=Math.floor(e/100)*100+oy(Pm(r));return t<e?t+100:t},X2=50*365*24*60*60*1e3,Q2=r=>r.getTime()-new Date().getTime()>X2?new Date(Date.UTC(r.getUTCFullYear()-100,r.getUTCMonth(),r.getUTCDate(),r.getUTCHours(),r.getUTCMinutes(),r.getUTCSeconds(),r.getUTCMilliseconds())):r,px=r=>{const e=Eb.indexOf(r);if(e<0)throw new TypeError(`Invalid month: ${r}`);return e+1},Z2=[31,28,31,30,31,30,31,31,30,31,30,31],eD=(r,e,t)=>{let n=Z2[e];if(e===1&&tD(r)&&(n=29),t>n)throw new TypeError(`Invalid day for ${Eb[e]} in ${r}: ${t}`)},tD=r=>r%4===0&&(r%100!==0||r%400===0),Vc=(r,e,t,n)=>{const s=M2(Pm(r));if(s<t||s>n)throw new TypeError(`${e} must be between ${t} and ${n}, inclusive`);return s},rD=r=>r==null?0:D2("0."+r)*1e3,nD=r=>{const e=r[0];let t=1;if(e=="+")t=1;else if(e=="-")t=-1;else throw new TypeError(`Offset direction, ${e}, must be "+" or "-"`);const n=Number(r.substring(1,3)),s=Number(r.substring(4,6));return t*(n*60+s)*60*1e3},Pm=r=>{let e=0;for(;e<r.length-1&&r.charAt(e)==="0";)e++;return e===0?r:r.slice(e)},wE=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Ds=Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0")),RN=()=>{if(wE)return wE();const r=new Uint8Array(16);return crypto.getRandomValues(r),r[6]=r[6]&15|64,r[8]=r[8]&63|128,Ds[r[0]]+Ds[r[1]]+Ds[r[2]]+Ds[r[3]]+"-"+Ds[r[4]]+Ds[r[5]]+"-"+Ds[r[6]]+Ds[r[7]]+"-"+Ds[r[8]]+Ds[r[9]]+"-"+Ds[r[10]]+Ds[r[11]]+Ds[r[12]]+Ds[r[13]]+Ds[r[14]]+Ds[r[15]]},Gc=function(e){return Object.assign(new String(e),{deserializeJSON(){return JSON.parse(String(e))},toString(){return String(e)},toJSON(){return String(e)}})};Gc.from=r=>r&&typeof r=="object"&&(r instanceof Gc||"deserializeJSON"in r)?r:typeof r=="string"||Object.getPrototypeOf(r)===String.prototype?Gc(String(r)):Gc(JSON.stringify(r));Gc.fromObject=Gc.from;const bE=/^-?\d*(\.\d+)?$/;class Va{constructor(e,t){z(this,"string");z(this,"type");if(this.string=e,this.type=t,!bE.test(e))throw new Error('@smithy/core/serde - NumericValue must only contain [0-9], at most one decimal point ".", and an optional negation prefix "-".')}toString(){return this.string}static[Symbol.hasInstance](e){if(!e||typeof e!="object")return!1;const t=e;return Va.prototype.isPrototypeOf(e)||t.type==="bigDecimal"&&bE.test(t.string)}}const sD="modulepreload",oD=function(r){return"/FileServer_Staging/dist-outlook-addin/"+r},_E={},bw=function(e,t,n){let s=Promise.resolve();if(t&&t.length>0){let c=function(p){return Promise.all(p.map(v=>Promise.resolve(v).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),m=(d==null?void 0:d.nonce)||(d==null?void 0:d.getAttribute("nonce"));s=c(t.map(p=>{if(p=oD(p),p in _E)return;_E[p]=!0;const v=p.endsWith(".css"),x=v?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${x}`))return;const b=document.createElement("link");if(b.rel=v?"stylesheet":sD,v||(b.as="script"),b.crossOrigin="",b.href=p,m&&b.setAttribute("nonce",m),document.head.appendChild(b),v)return new Promise((S,N)=>{b.addEventListener("load",S),b.addEventListener("error",()=>N(new Error(`Unable to preload CSS for ${p}`)))})}))}function i(c){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=c,window.dispatchEvent(d),!d.defaultPrevented)throw c}return s.then(c=>{for(const d of c||[])d.status==="rejected"&&i(d.reason);return e().catch(i)})};class iD{constructor(){z(this,"serdeContext")}setSerdeContext(e){this.serdeContext=e}}class aD extends iD{constructor(t){super();z(this,"options");this.options=t}getRequestType(){return ii}getResponseType(){return uh}setSerdeContext(t){this.serdeContext=t,this.serializer.setSerdeContext(t),this.deserializer.setSerdeContext(t),this.getPayloadCodec()&&this.getPayloadCodec().setSerdeContext(t)}updateServiceEndpoint(t,n){if("url"in n){t.protocol=n.url.protocol,t.hostname=n.url.hostname,t.port=n.url.port?Number(n.url.port):void 0,t.path=n.url.pathname,t.fragment=n.url.hash||void 0,t.username=n.url.username||void 0,t.password=n.url.password||void 0,t.query||(t.query={});for(const[s,i]of n.url.searchParams.entries())t.query[s]=i;return t}else return t.protocol=n.protocol,t.hostname=n.hostname,t.port=n.port?Number(n.port):void 0,t.path=n.path,t.query={...n.query},t}setHostPrefix(t,n,s){var d,m;if((d=this.serdeContext)!=null&&d.disableHostPrefix)return;const i=Fo.of(n.input),c=um(n.traits??{});if(c.endpoint){let p=(m=c.endpoint)==null?void 0:m[0];if(typeof p=="string"){const v=[...i.structIterator()].filter(([,x])=>x.getMergedTraits().hostLabel);for(const[x]of v){const b=s[x];if(typeof b!="string")throw new Error(`@smithy/core/schema - ${x} in input must be a string as hostLabel.`);p=p.replace(`{${x}}`,b)}t.hostname=p+t.hostname}}}deserializeMetadata(t){return{httpStatusCode:t.statusCode,requestId:t.headers["x-amzn-requestid"]??t.headers["x-amzn-request-id"]??t.headers["x-amz-request-id"],extendedRequestId:t.headers["x-amz-id-2"],cfId:t.headers["x-amz-cf-id"]}}async serializeEventStream({eventStream:t,requestSchema:n,initialRequest:s}){return(await this.loadEventStreamCapability()).serializeEventStream({eventStream:t,requestSchema:n,initialRequest:s})}async deserializeEventStream({response:t,responseSchema:n,initialResponseContainer:s}){return(await this.loadEventStreamCapability()).deserializeEventStream({response:t,responseSchema:n,initialResponseContainer:s})}async loadEventStreamCapability(){const{EventStreamSerde:t}=await bw(async()=>{const{EventStreamSerde:n}=await import("./index.DS5eee3c.js");return{EventStreamSerde:n}},__vite__mapDeps([0,1]));return new t({marshaller:this.getEventStreamMarshaller(),serializer:this.serializer,deserializer:this.deserializer,serdeContext:this.serdeContext,defaultContentType:this.getDefaultContentType()})}getDefaultContentType(){throw new Error(`@smithy/core/protocols - ${this.constructor.name} getDefaultContentType() implementation missing.`)}async deserializeHttpMessage(t,n,s,i,c){return[]}getEventStreamMarshaller(){const t=this.serdeContext;if(!t.eventStreamMarshaller)throw new Error("@smithy/core - HttpProtocol: eventStreamMarshaller missing in serdeContext.");return t.eventStreamMarshaller}}class lD extends aD{async serializeRequest(e,t,n){const s=this.serializer,i={},c={},d=await n.endpoint(),m=Fo.of(e==null?void 0:e.input),p=m.getSchema();let v;const x=new ii({protocol:"",hostname:"",port:void 0,path:"/",fragment:void 0,query:i,headers:c,body:void 0});d&&(this.updateServiceEndpoint(x,d),this.setHostPrefix(x,e,t));const b={...t};if(t){const S=m.getEventStreamMember();if(S){if(b[S]){const N={};for(const[E,T]of m.structIterator())E!==S&&b[E]&&(s.write(T,b[E]),N[E]=s.flush());v=await this.serializeEventStream({eventStream:b[S],requestSchema:m,initialRequest:N})}}else s.write(p,b),v=s.flush()}return x.headers=c,x.query=i,x.body=v,x.method="POST",x}async deserializeResponse(e,t,n){const s=this.deserializer,i=Fo.of(e.output),c={};if(n.statusCode>=300){const m=await xw(n.body,t);throw m.byteLength>0&&Object.assign(c,await s.read(15,m)),await this.handleError(e,t,n,c,this.deserializeMetadata(n)),new Error("@smithy/core/protocols - RPC Protocol error handler failed to throw.")}for(const m in n.headers){const p=n.headers[m];delete n.headers[m],n.headers[m.toLowerCase()]=p}const d=i.getEventStreamMember();if(d)c[d]=await this.deserializeEventStream({response:n,responseSchema:i,initialResponseContainer:c});else{const m=await xw(n.body,t);m.byteLength>0&&Object.assign(c,await s.read(i,m))}return c.$metadata=this.deserializeMetadata(n),c}}function PN(r,e){if(e.timestampFormat.useTrait&&r.isTimestampSchema()&&(r.getSchema()===5||r.getSchema()===6||r.getSchema()===7))return r.getSchema();const{httpLabel:t,httpPrefixHeaders:n,httpHeader:s,httpQuery:i}=r.getMergedTraits();return(e.httpBindings?typeof n=="string"||s?6:i||t?5:void 0:void 0)??e.timestampFormat.default}function cD(r,e,t){r.__smithy_context?r.__smithy_context.features||(r.__smithy_context.features={}):r.__smithy_context={features:{}},r.__smithy_context.features[e]=t}class jN{constructor(e){z(this,"authSchemes",new Map);for(const[t,n]of Object.entries(e))n!==void 0&&this.authSchemes.set(t,n)}getIdentityProvider(e){return this.authSchemes.get(e)}}class FN{async sign(e,t,n){return e}}const uD=r=>function(t){return ON(t)&&t.expiration.getTime()-Date.now()<r},dD=3e5,fD=uD(dD),ON=r=>r.expiration!==void 0,hD=(r,e,t)=>{if(r===void 0)return;const n=typeof r!="function"?async()=>Promise.resolve(r):r;let s,i,c,d=!1;const m=async p=>{i||(i=n(p));try{s=await i,c=!0,d=!1}finally{i=void 0}return s};return e===void 0?async p=>((!c||p!=null&&p.forceRefresh)&&(s=await m(p)),s):async p=>((!c||p!=null&&p.forceRefresh)&&(s=await m(p)),d?s:t(s)?(e(s)&&await m(p),s):(d=!0,s))},pD=void 0;function mD(r){return r===void 0?!0:typeof r=="string"&&r.length<=50}function DN(r){const e=Sm(r.userAgentAppId??pD),{customUserAgent:t}=r;return Object.assign(r,{customUserAgent:typeof t=="string"?[[t]]:t,userAgentAppId:async()=>{var s,i;const n=await e();if(!mD(n)){const c=((i=(s=r.logger)==null?void 0:s.constructor)==null?void 0:i.name)==="NoOpLogger"||!r.logger?console:r.logger;typeof n!="string"?c==null||c.warn("userAgentAppId must be a string or undefined."):n.length>50&&(c==null||c.warn("The provided userAgentAppId exceeds the maximum length of 50 characters."))}return n}})}class LN{constructor({size:e,params:t}){z(this,"capacity");z(this,"data",new Map);z(this,"parameters",[]);this.capacity=e??50,t&&(this.parameters=t)}get(e,t){const n=this.hash(e);if(n===!1)return t();if(!this.data.has(n)){if(this.data.size>this.capacity+10){const s=this.data.keys();let i=0;for(;;){const{value:c,done:d}=s.next();if(this.data.delete(c),d||++i>10)break}}this.data.set(n,t())}return this.data.get(n)}size(){return this.data.size}hash(e){let t="";const{parameters:n}=this;if(n.length===0)return!1;for(const s of n){const i=String(e[s]??"");if(i.includes("|;"))return!1;t+=i+"|;"}return t}}const gD=new RegExp("^(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}$"),kb=r=>gD.test(r)||r.startsWith("[")&&r.endsWith("]"),vD=new RegExp("^(?!.*-$)(?!-)[a-zA-Z0-9-]{1,63}$"),Xm=(r,e=!1)=>{if(!e)return vD.test(r);const t=r.split(".");for(const n of t)if(!Xm(n))return!1;return!0},dh={},jm="endpoints";function Qc(r){return typeof r!="object"||r==null?r:"ref"in r?`$${Qc(r.ref)}`:"fn"in r?`${r.fn}(${(r.argv||[]).map(Qc).join(", ")})`:JSON.stringify(r,null,2)}class ai extends Error{constructor(e){super(e),this.name="EndpointError"}}const yD=(r,e)=>r===e,xD=r=>{const e=r.split("."),t=[];for(const n of e){const s=n.indexOf("[");if(s!==-1){if(n.indexOf("]")!==n.length-1)throw new ai(`Path: '${r}' does not end with ']'`);const i=n.slice(s+1,-1);if(Number.isNaN(parseInt(i)))throw new ai(`Invalid array index: '${i}' in path: '${r}'`);s!==0&&t.push(n.slice(0,s)),t.push(i)}else t.push(n)}return t},MN=(r,e)=>xD(e).reduce((t,n)=>{if(typeof t!="object")throw new ai(`Index '${n}' in '${e}' not found in '${JSON.stringify(r)}'`);return Array.isArray(t)?t[parseInt(n)]:t[n]},r),wD=r=>r!=null,bD=r=>!r,mx={[Am.HTTP]:80,[Am.HTTPS]:443},_D=r=>{const e=(()=>{try{if(r instanceof URL)return r;if(typeof r=="object"&&"hostname"in r){const{hostname:b,port:S,protocol:N="",path:E="",query:T={}}=r,A=new URL(`${N}//${b}${S?`:${S}`:""}${E}`);return A.search=Object.entries(T).map(([I,D])=>`${I}=${D}`).join("&"),A}return new URL(r)}catch{return null}})();if(!e)return console.error(`Unable to parse ${JSON.stringify(r)} as a whatwg URL.`),null;const t=e.href,{host:n,hostname:s,pathname:i,protocol:c,search:d}=e;if(d)return null;const m=c.slice(0,-1);if(!Object.values(Am).includes(m))return null;const p=kb(s),v=t.includes(`${n}:${mx[m]}`)||typeof r=="string"&&r.includes(`${n}:${mx[m]}`),x=`${n}${v?`:${mx[m]}`:""}`;return{scheme:m,authority:x,path:i,normalizedPath:i.endsWith("/")?i:`${i}/`,isIp:p}},SD=(r,e)=>r===e,ED=(r,e,t,n)=>e>=t||r.length<t?null:n?r.substring(r.length-t,r.length-e):r.substring(e,t),kD=r=>encodeURIComponent(r).replace(/[!*'()]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),CD={booleanEquals:yD,getAttr:MN,isSet:wD,isValidHostLabel:Xm,not:bD,parseURL:_D,stringEquals:SD,substring:ED,uriEncode:kD},$N=(r,e)=>{const t=[],n={...e.endpointParams,...e.referenceRecord};let s=0;for(;s<r.length;){const i=r.indexOf("{",s);if(i===-1){t.push(r.slice(s));break}t.push(r.slice(s,i));const c=r.indexOf("}",i);if(c===-1){t.push(r.slice(i));break}r[i+1]==="{"&&r[c+1]==="}"&&(t.push(r.slice(i+1,c)),s=c+2);const d=r.substring(i+1,c);if(d.includes("#")){const[m,p]=d.split("#");t.push(MN(n[m],p))}else t.push(n[d]);s=c+1}return t.join("")},ND=({ref:r},e)=>({...e.endpointParams,...e.referenceRecord})[r],Uy=(r,e,t)=>{if(typeof r=="string")return $N(r,t);if(r.fn)return zN.callFunction(r,t);if(r.ref)return ND(r,t);throw new ai(`'${e}': ${String(r)} is not a string, function or reference.`)},UN=({fn:r,argv:e},t)=>{const n=e.map(i=>["boolean","number"].includes(typeof i)?i:zN.evaluateExpression(i,"arg",t)),s=r.split(".");return s[0]in dh&&s[1]!=null?dh[s[0]][s[1]](...n):CD[r](...n)},zN={evaluateExpression:Uy,callFunction:UN},TD=({assign:r,...e},t)=>{var s,i;if(r&&r in t.referenceRecord)throw new ai(`'${r}' is already defined in Reference Record.`);const n=UN(e,t);return(i=(s=t.logger)==null?void 0:s.debug)==null||i.call(s,`${jm} evaluateCondition: ${Qc(e)} = ${Qc(n)}`),{result:n===""?!0:!!n,...r!=null&&{toAssign:{name:r,value:n}}}},Cb=(r=[],e)=>{var n,s;const t={};for(const i of r){const{result:c,toAssign:d}=TD(i,{...e,referenceRecord:{...e.referenceRecord,...t}});if(!c)return{result:c};d&&(t[d.name]=d.value,(s=(n=e.logger)==null?void 0:n.debug)==null||s.call(n,`${jm} assign: ${d.name} := ${Qc(d.value)}`))}return{result:!0,referenceRecord:t}},AD=(r,e)=>Object.entries(r).reduce((t,[n,s])=>({...t,[n]:s.map(i=>{const c=Uy(i,"Header value entry",e);if(typeof c!="string")throw new ai(`Header '${n}' value '${c}' is not a string`);return c})}),{}),HN=(r,e)=>Object.entries(r).reduce((t,[n,s])=>({...t,[n]:GN.getEndpointProperty(s,e)}),{}),BN=(r,e)=>{if(Array.isArray(r))return r.map(t=>BN(t,e));switch(typeof r){case"string":return $N(r,e);case"object":if(r===null)throw new ai(`Unexpected endpoint property: ${r}`);return GN.getEndpointProperties(r,e);case"boolean":return r;default:throw new ai(`Unexpected endpoint property type: ${typeof r}`)}},GN={getEndpointProperty:BN,getEndpointProperties:HN},ID=(r,e)=>{const t=Uy(r,"Endpoint URL",e);if(typeof t=="string")try{return new URL(t)}catch(n){throw console.error(`Failed to construct URL with ${t}`,n),n}throw new ai(`Endpoint URL must be a string, got ${typeof t}`)},RD=(r,e)=>{var v,x;const{conditions:t,endpoint:n}=r,{result:s,referenceRecord:i}=Cb(t,e);if(!s)return;const c={...e,referenceRecord:{...e.referenceRecord,...i}},{url:d,properties:m,headers:p}=n;return(x=(v=e.logger)==null?void 0:v.debug)==null||x.call(v,`${jm} Resolving endpoint from template: ${Qc(n)}`),{...p!=null&&{headers:AD(p,c)},...m!=null&&{properties:HN(m,c)},url:ID(d,c)}},PD=(r,e)=>{const{conditions:t,error:n}=r,{result:s,referenceRecord:i}=Cb(t,e);if(s)throw new ai(Uy(n,"Error",{...e,referenceRecord:{...e.referenceRecord,...i}}))},WN=(r,e)=>{for(const t of r)if(t.type==="endpoint"){const n=RD(t,e);if(n)return n}else if(t.type==="error")PD(t,e);else if(t.type==="tree"){const n=VN.evaluateTreeRule(t,e);if(n)return n}else throw new ai(`Unknown endpoint rule: ${t}`);throw new ai("Rules evaluation failed")},jD=(r,e)=>{const{conditions:t,rules:n}=r,{result:s,referenceRecord:i}=Cb(t,e);if(s)return VN.evaluateRules(n,{...e,referenceRecord:{...e.referenceRecord,...i}})},VN={evaluateRules:WN,evaluateTreeRule:jD},qN=(r,e)=>{var p,v,x,b;const{endpointParams:t,logger:n}=e,{parameters:s,rules:i}=r;(v=(p=e.logger)==null?void 0:p.debug)==null||v.call(p,`${jm} Initial EndpointParams: ${Qc(t)}`);const c=Object.entries(s).filter(([,S])=>S.default!=null).map(([S,N])=>[S,N.default]);if(c.length>0)for(const[S,N]of c)t[S]=t[S]??N;const d=Object.entries(s).filter(([,S])=>S.required).map(([S])=>S);for(const S of d)if(t[S]==null)throw new ai(`Missing required parameter: '${S}'`);const m=WN(i,{endpointParams:t,logger:n,referenceRecord:{}});return(b=(x=e.logger)==null?void 0:x.debug)==null||b.call(x,`${jm} Resolved endpoint: ${Qc(m)}`),m},KN=(r,e=!1)=>{if(e){for(const t of r.split("."))if(!KN(t))return!1;return!0}return!(!Xm(r)||r.length<3||r.length>63||r!==r.toLowerCase()||kb(r))},SE=":",FD="/",OD=r=>{const e=r.split(SE);if(e.length<6)return null;const[t,n,s,i,c,...d]=e;if(t!=="arn"||n===""||s===""||d.join(SE)==="")return null;const m=d.map(p=>p.split(FD)).flat();return{partition:n,service:s,region:i,accountId:c,resourceId:m}},DD=[{id:"aws",outputs:{dnsSuffix:"amazonaws.com",dualStackDnsSuffix:"api.aws",implicitGlobalRegion:"us-east-1",name:"aws",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^(us|eu|ap|sa|ca|me|af|il|mx)\\-\\w+\\-\\d+$",regions:{"af-south-1":{description:"Africa (Cape Town)"},"ap-east-1":{description:"Asia Pacific (Hong Kong)"},"ap-east-2":{description:"Asia Pacific (Taipei)"},"ap-northeast-1":{description:"Asia Pacific (Tokyo)"},"ap-northeast-2":{description:"Asia Pacific (Seoul)"},"ap-northeast-3":{description:"Asia Pacific (Osaka)"},"ap-south-1":{description:"Asia Pacific (Mumbai)"},"ap-south-2":{description:"Asia Pacific (Hyderabad)"},"ap-southeast-1":{description:"Asia Pacific (Singapore)"},"ap-southeast-2":{description:"Asia Pacific (Sydney)"},"ap-southeast-3":{description:"Asia Pacific (Jakarta)"},"ap-southeast-4":{description:"Asia Pacific (Melbourne)"},"ap-southeast-5":{description:"Asia Pacific (Malaysia)"},"ap-southeast-6":{description:"Asia Pacific (New Zealand)"},"ap-southeast-7":{description:"Asia Pacific (Thailand)"},"aws-global":{description:"aws global region"},"ca-central-1":{description:"Canada (Central)"},"ca-west-1":{description:"Canada West (Calgary)"},"eu-central-1":{description:"Europe (Frankfurt)"},"eu-central-2":{description:"Europe (Zurich)"},"eu-north-1":{description:"Europe (Stockholm)"},"eu-south-1":{description:"Europe (Milan)"},"eu-south-2":{description:"Europe (Spain)"},"eu-west-1":{description:"Europe (Ireland)"},"eu-west-2":{description:"Europe (London)"},"eu-west-3":{description:"Europe (Paris)"},"il-central-1":{description:"Israel (Tel Aviv)"},"me-central-1":{description:"Middle East (UAE)"},"me-south-1":{description:"Middle East (Bahrain)"},"mx-central-1":{description:"Mexico (Central)"},"sa-east-1":{description:"South America (Sao Paulo)"},"us-east-1":{description:"US East (N. Virginia)"},"us-east-2":{description:"US East (Ohio)"},"us-west-1":{description:"US West (N. California)"},"us-west-2":{description:"US West (Oregon)"}}},{id:"aws-cn",outputs:{dnsSuffix:"amazonaws.com.cn",dualStackDnsSuffix:"api.amazonwebservices.com.cn",implicitGlobalRegion:"cn-northwest-1",name:"aws-cn",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^cn\\-\\w+\\-\\d+$",regions:{"aws-cn-global":{description:"aws-cn global region"},"cn-north-1":{description:"China (Beijing)"},"cn-northwest-1":{description:"China (Ningxia)"}}},{id:"aws-eusc",outputs:{dnsSuffix:"amazonaws.eu",dualStackDnsSuffix:"api.amazonwebservices.eu",implicitGlobalRegion:"eusc-de-east-1",name:"aws-eusc",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^eusc\\-(de)\\-\\w+\\-\\d+$",regions:{"eusc-de-east-1":{description:"AWS European Sovereign Cloud (Germany)"}}},{id:"aws-iso",outputs:{dnsSuffix:"c2s.ic.gov",dualStackDnsSuffix:"api.aws.ic.gov",implicitGlobalRegion:"us-iso-east-1",name:"aws-iso",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-iso\\-\\w+\\-\\d+$",regions:{"aws-iso-global":{description:"aws-iso global region"},"us-iso-east-1":{description:"US ISO East"},"us-iso-west-1":{description:"US ISO WEST"}}},{id:"aws-iso-b",outputs:{dnsSuffix:"sc2s.sgov.gov",dualStackDnsSuffix:"api.aws.scloud",implicitGlobalRegion:"us-isob-east-1",name:"aws-iso-b",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-isob\\-\\w+\\-\\d+$",regions:{"aws-iso-b-global":{description:"aws-iso-b global region"},"us-isob-east-1":{description:"US ISOB East (Ohio)"},"us-isob-west-1":{description:"US ISOB West"}}},{id:"aws-iso-e",outputs:{dnsSuffix:"cloud.adc-e.uk",dualStackDnsSuffix:"api.cloud-aws.adc-e.uk",implicitGlobalRegion:"eu-isoe-west-1",name:"aws-iso-e",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^eu\\-isoe\\-\\w+\\-\\d+$",regions:{"aws-iso-e-global":{description:"aws-iso-e global region"},"eu-isoe-west-1":{description:"EU ISOE West"}}},{id:"aws-iso-f",outputs:{dnsSuffix:"csp.hci.ic.gov",dualStackDnsSuffix:"api.aws.hci.ic.gov",implicitGlobalRegion:"us-isof-south-1",name:"aws-iso-f",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-isof\\-\\w+\\-\\d+$",regions:{"aws-iso-f-global":{description:"aws-iso-f global region"},"us-isof-east-1":{description:"US ISOF EAST"},"us-isof-south-1":{description:"US ISOF SOUTH"}}},{id:"aws-us-gov",outputs:{dnsSuffix:"amazonaws.com",dualStackDnsSuffix:"api.aws",implicitGlobalRegion:"us-gov-west-1",name:"aws-us-gov",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-gov\\-\\w+\\-\\d+$",regions:{"aws-us-gov-global":{description:"aws-us-gov global region"},"us-gov-east-1":{description:"AWS GovCloud (US-East)"},"us-gov-west-1":{description:"AWS GovCloud (US-West)"}}}],LD={partitions:DD};let MD=LD;const $D=r=>{const{partitions:e}=MD;for(const n of e){const{regions:s,outputs:i}=n;for(const[c,d]of Object.entries(s))if(c===r)return{...i,...d}}for(const n of e){const{regionRegex:s,outputs:i}=n;if(new RegExp(s).test(r))return{...i}}const t=e.find(n=>n.id==="aws");if(!t)throw new Error("Provided region was not found in the partition array or regex, and default partition with id 'aws' doesn't exist.");return{...t.outputs}},UD={isVirtualHostableS3Bucket:KN,parseArn:OD,partition:$D};dh.aws=UD;function zD(r){const e={};if(r=r.replace(/^\?/,""),r)for(const t of r.split("&")){let[n,s=null]=t.split("=");n=decodeURIComponent(n),s&&(s=decodeURIComponent(s)),n in e?Array.isArray(e[n])?e[n].push(s):e[n]=[e[n],s]:e[n]=s}return e}const Fm=r=>{if(typeof r=="string")return Fm(new URL(r));const{hostname:e,pathname:t,port:n,protocol:s,search:i}=r;let c;return i&&(c=zD(i)),{hostname:e,port:n?parseInt(n):void 0,protocol:s,path:t,query:c}};function HD(r,e,t){return r.$source||(r.$source={}),r.$source[e]=t,r}function La(r,e,t){r.__aws_sdk_context?r.__aws_sdk_context.features||(r.__aws_sdk_context.features={}):r.__aws_sdk_context={features:{}},r.__aws_sdk_context.features[e]=t}const EE=r=>{var e,t;return uh.isInstance(r)?((e=r.headers)==null?void 0:e.date)??((t=r.headers)==null?void 0:t.Date):void 0},YN=r=>new Date(Date.now()+r),BD=(r,e)=>Math.abs(YN(e).getTime()-r)>=3e5,kE=(r,e)=>{const t=Date.parse(r);return BD(t,e)?t-Date.now():e},km=(r,e)=>{if(!e)throw new Error(`Property \`${r}\` is not resolved for AWS SDK SigV4Auth`);return e},GD=async r=>{var p,v,x;const e=km("context",r.context),t=km("config",r.config),n=(x=(v=(p=e.endpointV2)==null?void 0:p.properties)==null?void 0:v.authSchemes)==null?void 0:x[0],i=await km("signer",t.signer)(n),c=r==null?void 0:r.signingRegion,d=r==null?void 0:r.signingRegionSet,m=r==null?void 0:r.signingName;return{config:t,signer:i,signingRegion:c,signingRegionSet:d,signingName:m}};class JN{async sign(e,t,n){var x;if(!ii.isInstance(e))throw new Error("The request is not an instance of `HttpRequest` and cannot be signed");const s=await GD(n),{config:i,signer:c}=s;let{signingRegion:d,signingName:m}=s;const p=n.context;if(((x=p==null?void 0:p.authSchemes)==null?void 0:x.length)??!1){const[b,S]=p.authSchemes;(b==null?void 0:b.name)==="sigv4a"&&(S==null?void 0:S.name)==="sigv4"&&(d=(S==null?void 0:S.signingRegion)??d,m=(S==null?void 0:S.signingName)??m)}return await c.sign(e,{signingDate:YN(i.systemClockOffset),signingRegion:d,signingService:m})}errorHandler(e){return t=>{const n=t.ServerTime??EE(t.$response);if(n){const s=km("config",e.config),i=s.systemClockOffset;s.systemClockOffset=kE(n,s.systemClockOffset),s.systemClockOffset!==i&&t.$metadata&&(t.$metadata.clockSkewCorrected=!0)}throw t}}successHandler(e,t){const n=EE(e);if(n){const s=km("config",t.config);s.systemClockOffset=kE(n,s.systemClockOffset)}}}const WD=(r,e,t)=>{let n,s,i,c=!1;const d=async()=>{s||(s=r());try{n=await s,i=!0,c=!1}finally{s=void 0}return n};return async m=>((!i||m!=null&&m.forceRefresh)&&(n=await d()),n)},VD="X-Amz-Algorithm",qD="X-Amz-Credential",XN="X-Amz-Date",KD="X-Amz-SignedHeaders",YD="X-Amz-Expires",QN="X-Amz-Signature",ZN="X-Amz-Security-Token",e1="authorization",t1=XN.toLowerCase(),JD="date",XD=[e1,t1,JD],QD=QN.toLowerCase(),_w="x-amz-content-sha256",ZD=ZN.toLowerCase(),eL={authorization:!0,"cache-control":!0,connection:!0,expect:!0,from:!0,"keep-alive":!0,"max-forwards":!0,pragma:!0,referer:!0,te:!0,trailer:!0,"transfer-encoding":!0,upgrade:!0,"user-agent":!0,"x-amzn-trace-id":!0},tL=/^proxy-/,rL=/^sec-/,gx="AWS4-HMAC-SHA256",nL="AWS4-HMAC-SHA256-PAYLOAD",sL="UNSIGNED-PAYLOAD",oL=50,r1="aws4_request",iL=3600*24*7,Ev={},vx=[],yx=(r,e,t)=>`${r}/${e}/${t}/${r1}`,aL=async(r,e,t,n,s)=>{const i=await CE(r,e.secretAccessKey,e.accessKeyId),c=`${t}:${n}:${s}:${ld(i)}:${e.sessionToken}`;if(c in Ev)return Ev[c];for(vx.push(c);vx.length>oL;)delete Ev[vx.shift()];let d=`AWS4${e.secretAccessKey}`;for(const m of[t,n,s,r1])d=await CE(r,d,m);return Ev[c]=d},CE=(r,e,t)=>{const n=new r(e);return n.update(Im(t)),n.digest()},NE=({headers:r},e,t)=>{const n={};for(const s of Object.keys(r).sort()){if(r[s]==null)continue;const i=s.toLowerCase();(i in eL||e!=null&&e.has(i)||tL.test(i)||rL.test(i))&&(!t||t&&!t.has(i))||(n[i]=r[s].trim().replace(/\s+/g," "))}return n},lL=r=>typeof ArrayBuffer=="function"&&r instanceof ArrayBuffer||Object.prototype.toString.call(r)==="[object ArrayBuffer]",xx=async({headers:r,body:e},t)=>{for(const n of Object.keys(r))if(n.toLowerCase()===_w)return r[n];if(e==null)return"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855";if(typeof e=="string"||ArrayBuffer.isView(e)||lL(e)){const n=new t;return n.update(Im(e)),ld(await n.digest())}return sL};class cL{format(e){const t=[];for(const i of Object.keys(e)){const c=cd(i);t.push(Uint8Array.from([c.byteLength]),c,this.formatHeaderValue(e[i]))}const n=new Uint8Array(t.reduce((i,c)=>i+c.byteLength,0));let s=0;for(const i of t)n.set(i,s),s+=i.byteLength;return n}formatHeaderValue(e){switch(e.type){case"boolean":return Uint8Array.from([e.value?0:1]);case"byte":return Uint8Array.from([2,e.value]);case"short":const t=new DataView(new ArrayBuffer(3));return t.setUint8(0,3),t.setInt16(1,e.value,!1),new Uint8Array(t.buffer);case"integer":const n=new DataView(new ArrayBuffer(5));return n.setUint8(0,4),n.setInt32(1,e.value,!1),new Uint8Array(n.buffer);case"long":const s=new Uint8Array(9);return s[0]=5,s.set(e.value.bytes,1),s;case"binary":const i=new DataView(new ArrayBuffer(3+e.value.byteLength));i.setUint8(0,6),i.setUint16(1,e.value.byteLength,!1);const c=new Uint8Array(i.buffer);return c.set(e.value,3),c;case"string":const d=cd(e.value),m=new DataView(new ArrayBuffer(3+d.byteLength));m.setUint8(0,7),m.setUint16(1,d.byteLength,!1);const p=new Uint8Array(m.buffer);return p.set(d,3),p;case"timestamp":const v=new Uint8Array(9);return v[0]=8,v.set(Nb.fromNumber(e.value.valueOf()).bytes,1),v;case"uuid":if(!uL.test(e.value))throw new Error(`Invalid UUID received: ${e.value}`);const x=new Uint8Array(17);return x[0]=9,x.set(C2(e.value.replace(/\-/g,"")),1),x}}}var TE;(function(r){r[r.boolTrue=0]="boolTrue",r[r.boolFalse=1]="boolFalse",r[r.byte=2]="byte",r[r.short=3]="short",r[r.integer=4]="integer",r[r.long=5]="long",r[r.byteArray=6]="byteArray",r[r.string=7]="string",r[r.timestamp=8]="timestamp",r[r.uuid=9]="uuid"})(TE||(TE={}));const uL=/^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$/;class Nb{constructor(e){z(this,"bytes");if(this.bytes=e,e.byteLength!==8)throw new Error("Int64 buffers must be exactly 8 bytes")}static fromNumber(e){if(e>9223372036854776e3||e<-9223372036854776e3)throw new Error(`${e} is too large (or, if negative, too small) to represent as an Int64`);const t=new Uint8Array(8);for(let n=7,s=Math.abs(Math.round(e));n>-1&&s>0;n--,s/=256)t[n]=s;return e<0&&AE(t),new Nb(t)}valueOf(){const e=this.bytes.slice(0),t=e[0]&128;return t&&AE(e),parseInt(ld(e),16)*(t?-1:1)}toString(){return String(this.valueOf())}}function AE(r){for(let e=0;e<8;e++)r[e]^=255;for(let e=7;e>-1&&(r[e]++,r[e]===0);e--);}const dL=(r,e)=>{r=r.toLowerCase();for(const t of Object.keys(e))if(r===t.toLowerCase())return!0;return!1},fL=(r,e={})=>{var s,i;const{headers:t,query:n={}}=ii.clone(r);for(const c of Object.keys(t)){const d=c.toLowerCase();(d.slice(0,6)==="x-amz-"&&!((s=e.unhoistableHeaders)!=null&&s.has(d))||(i=e.hoistableHeaders)!=null&&i.has(d))&&(n[c]=t[c],delete t[c])}return{...r,headers:t,query:n}},IE=r=>{r=ii.clone(r);for(const e of Object.keys(r.headers))XD.indexOf(e.toLowerCase())>-1&&delete r.headers[e];return r},hL=({query:r={}})=>{const e=[],t={};for(const n of Object.keys(r)){if(n.toLowerCase()===QD)continue;const s=ad(n);e.push(s);const i=r[n];typeof i=="string"?t[s]=`${s}=${ad(i)}`:Array.isArray(i)&&(t[s]=i.slice(0).reduce((c,d)=>c.concat([`${s}=${ad(d)}`]),[]).sort().join("&"))}return e.sort().map(n=>t[n]).filter(n=>n).join("&")},pL=r=>mL(r).toISOString().replace(/\.\d{3}Z$/,"Z"),mL=r=>typeof r=="number"?new Date(r*1e3):typeof r=="string"?Number(r)?new Date(Number(r)*1e3):new Date(r):r;class gL{constructor({applyChecksum:e,credentials:t,region:n,service:s,sha256:i,uriEscapePath:c=!0}){z(this,"service");z(this,"regionProvider");z(this,"credentialProvider");z(this,"sha256");z(this,"uriEscapePath");z(this,"applyChecksum");this.service=s,this.sha256=i,this.uriEscapePath=c,this.applyChecksum=typeof e=="boolean"?e:!0,this.regionProvider=oa(n),this.credentialProvider=oa(t)}createCanonicalRequest(e,t,n){const s=Object.keys(t).sort();return`${e.method}
${this.getCanonicalPath(e)}
${hL(e)}
${s.map(i=>`${i}:${t[i]}`).join(`
`)}

${s.join(";")}
${n}`}async createStringToSign(e,t,n,s){const i=new this.sha256;i.update(Im(n));const c=await i.digest();return`${s}
${e}
${t}
${ld(c)}`}getCanonicalPath({path:e}){if(this.uriEscapePath){const t=[];for(const i of e.split("/"))(i==null?void 0:i.length)!==0&&i!=="."&&(i===".."?t.pop():t.push(i));const n=`${e!=null&&e.startsWith("/")?"/":""}${t.join("/")}${t.length>0&&(e!=null&&e.endsWith("/"))?"/":""}`;return ad(n).replace(/%2F/g,"/")}return e}validateResolvedCredentials(e){if(typeof e!="object"||typeof e.accessKeyId!="string"||typeof e.secretAccessKey!="string")throw new Error("Resolved credential object is not valid")}formatDate(e){const t=pL(e).replace(/[\-:]/g,"");return{longDate:t,shortDate:t.slice(0,8)}}getCanonicalHeaderList(e){return Object.keys(e).sort().join(";")}}class RE extends gL{constructor({applyChecksum:t,credentials:n,region:s,service:i,sha256:c,uriEscapePath:d=!0}){super({applyChecksum:t,credentials:n,region:s,service:i,sha256:c,uriEscapePath:d});z(this,"headerFormatter",new cL)}async presign(t,n={}){const{signingDate:s=new Date,expiresIn:i=3600,unsignableHeaders:c,unhoistableHeaders:d,signableHeaders:m,hoistableHeaders:p,signingRegion:v,signingService:x}=n,b=await this.credentialProvider();this.validateResolvedCredentials(b);const S=v??await this.regionProvider(),{longDate:N,shortDate:E}=this.formatDate(s);if(i>iL)return Promise.reject("Signature version 4 presigned URLs must have an expiration date less than one week in the future");const T=yx(E,S,x??this.service),A=fL(IE(t),{unhoistableHeaders:d,hoistableHeaders:p});b.sessionToken&&(A.query[ZN]=b.sessionToken),A.query[VD]=gx,A.query[qD]=`${b.accessKeyId}/${T}`,A.query[XN]=N,A.query[YD]=i.toString(10);const I=NE(A,c,m);return A.query[KD]=this.getCanonicalHeaderList(I),A.query[QN]=await this.getSignature(N,T,this.getSigningKey(b,S,E,x),this.createCanonicalRequest(A,I,await xx(t,this.sha256))),A}async sign(t,n){return typeof t=="string"?this.signString(t,n):t.headers&&t.payload?this.signEvent(t,n):t.message?this.signMessage(t,n):this.signRequest(t,n)}async signEvent({headers:t,payload:n},{signingDate:s=new Date,priorSignature:i,signingRegion:c,signingService:d}){const m=c??await this.regionProvider(),{shortDate:p,longDate:v}=this.formatDate(s),x=yx(p,m,d??this.service),b=await xx({headers:{},body:n},this.sha256),S=new this.sha256;S.update(t);const N=ld(await S.digest()),E=[nL,v,x,i,N,b].join(`
`);return this.signString(E,{signingDate:s,signingRegion:m,signingService:d})}async signMessage(t,{signingDate:n=new Date,signingRegion:s,signingService:i}){return this.signEvent({headers:this.headerFormatter.format(t.message.headers),payload:t.message.body},{signingDate:n,signingRegion:s,signingService:i,priorSignature:t.priorSignature}).then(d=>({message:t.message,signature:d}))}async signString(t,{signingDate:n=new Date,signingRegion:s,signingService:i}={}){const c=await this.credentialProvider();this.validateResolvedCredentials(c);const d=s??await this.regionProvider(),{shortDate:m}=this.formatDate(n),p=new this.sha256(await this.getSigningKey(c,d,m,i));return p.update(Im(t)),ld(await p.digest())}async signRequest(t,{signingDate:n=new Date,signableHeaders:s,unsignableHeaders:i,signingRegion:c,signingService:d}={}){const m=await this.credentialProvider();this.validateResolvedCredentials(m);const p=c??await this.regionProvider(),v=IE(t),{longDate:x,shortDate:b}=this.formatDate(n),S=yx(b,p,d??this.service);v.headers[t1]=x,m.sessionToken&&(v.headers[ZD]=m.sessionToken);const N=await xx(v,this.sha256);!dL(_w,v.headers)&&this.applyChecksum&&(v.headers[_w]=N);const E=NE(v,i,s),T=await this.getSignature(x,S,this.getSigningKey(m,p,b,d),this.createCanonicalRequest(v,E,N));return v.headers[e1]=`${gx} Credential=${m.accessKeyId}/${S}, SignedHeaders=${this.getCanonicalHeaderList(E)}, Signature=${T}`,v}async getSignature(t,n,s,i){const c=await this.createStringToSign(t,n,i,gx),d=new this.sha256(await s);return d.update(Im(c)),ld(await d.digest())}getSigningKey(t,n,s,i){return aL(this.sha256,t,s,n,i||this.service)}}const n1=r=>{let e=r.credentials,t=!!r.credentials,n;Object.defineProperty(r,"credentials",{set(p){p&&p!==e&&p!==n&&(t=!0),e=p;const v=vL(r,{credentials:e,credentialDefaultProvider:r.credentialDefaultProvider}),x=yL(r,v);if(t&&!x.attributed){const b=typeof e=="object"&&e!==null;n=async S=>{const E=await x(S);return b&&(!E.$source||Object.keys(E.$source).length===0)?HD(E,"CREDENTIALS_CODE","e"):E},n.memoized=x.memoized,n.configBound=x.configBound,n.attributed=!0}else n=x},get(){return n},enumerable:!0,configurable:!0}),r.credentials=e;const{signingEscapePath:s=!0,systemClockOffset:i=r.systemClockOffset||0,sha256:c}=r;let d;return r.signer?d=Sm(r.signer):r.regionInfoProvider?d=()=>Sm(r.region)().then(async p=>[await r.regionInfoProvider(p,{useFipsEndpoint:await r.useFipsEndpoint(),useDualstackEndpoint:await r.useDualstackEndpoint()})||{},p]).then(([p,v])=>{const{signingRegion:x,signingService:b}=p;r.signingRegion=r.signingRegion||x||v,r.signingName=r.signingName||b||r.serviceId;const S={...r,credentials:r.credentials,region:r.signingRegion,service:r.signingName,sha256:c,uriEscapePath:s},N=r.signerConstructor||RE;return new N(S)}):d=async p=>{p=Object.assign({},{name:"sigv4",signingName:r.signingName||r.defaultSigningName,signingRegion:await Sm(r.region)(),properties:{}},p);const v=p.signingRegion,x=p.signingName;r.signingRegion=r.signingRegion||v,r.signingName=r.signingName||x||r.serviceId;const b={...r,credentials:r.credentials,region:r.signingRegion,service:r.signingName,sha256:c,uriEscapePath:s},S=r.signerConstructor||RE;return new S(b)},Object.assign(r,{systemClockOffset:i,signingEscapePath:s,signer:d})};function vL(r,{credentials:e,credentialDefaultProvider:t}){let n;return e?e!=null&&e.memoized?n=e:n=hD(e,fD,ON):t?n=Sm(t(Object.assign({},r,{parentClientConfig:r}))):n=async()=>{throw new Error("@aws-sdk/core::resolveAwsSdkSigV4Config - `credentials` not provided and no credentialDefaultProvider was configured.")},n.memoized=!0,n}function yL(r,e){if(e.configBound)return e;const t=async n=>e({...n,callerClientConfig:r});return t.memoized=e.memoized,t.configBound=!0,t}const PE=typeof TextEncoder=="function"?new TextEncoder:null,s1=r=>{if(typeof r=="string"){if(PE)return PE.encode(r).byteLength;let e=r.length;for(let t=e-1;t>=0;t--){const n=r.charCodeAt(t);n>127&&n<=2047?e++:n>2047&&n<=65535&&(e+=2),n>=56320&&n<=57343&&t--}return e}else{if(typeof r.byteLength=="number")return r.byteLength;if(typeof r.size=="number")return r.size}throw new Error(`Body Length computation failed for ${r}`)},Zu=(r,e)=>{const t=[];if(r&&t.push(r),e)for(const n of e)t.push(n);return t},Dc=(r,e)=>`${r||"anonymous"}${e&&e.length>0?` (a.k.a. ${e.join(",")})`:""}`,iy=()=>{let r=[],e=[],t=!1;const n=new Set,s=x=>x.sort((b,S)=>jE[S.step]-jE[b.step]||FE[S.priority||"normal"]-FE[b.priority||"normal"]),i=x=>{let b=!1;const S=N=>{const E=Zu(N.name,N.aliases);if(E.includes(x)){b=!0;for(const T of E)n.delete(T);return!1}return!0};return r=r.filter(S),e=e.filter(S),b},c=x=>{let b=!1;const S=N=>{if(N.middleware===x){b=!0;for(const E of Zu(N.name,N.aliases))n.delete(E);return!1}return!0};return r=r.filter(S),e=e.filter(S),b},d=x=>{var b;return r.forEach(S=>{x.add(S.middleware,{...S})}),e.forEach(S=>{x.addRelativeTo(S.middleware,{...S})}),(b=x.identifyOnResolve)==null||b.call(x,v.identifyOnResolve()),x},m=x=>{const b=[];return x.before.forEach(S=>{S.before.length===0&&S.after.length===0?b.push(S):b.push(...m(S))}),b.push(x),x.after.reverse().forEach(S=>{S.before.length===0&&S.after.length===0?b.push(S):b.push(...m(S))}),b},p=(x=!1)=>{const b=[],S=[],N={};return r.forEach(T=>{const A={...T,before:[],after:[]};for(const I of Zu(A.name,A.aliases))N[I]=A;b.push(A)}),e.forEach(T=>{const A={...T,before:[],after:[]};for(const I of Zu(A.name,A.aliases))N[I]=A;S.push(A)}),S.forEach(T=>{if(T.toMiddleware){const A=N[T.toMiddleware];if(A===void 0){if(x)return;throw new Error(`${T.toMiddleware} is not found when adding ${Dc(T.name,T.aliases)} middleware ${T.relation} ${T.toMiddleware}`)}T.relation==="after"&&A.after.push(T),T.relation==="before"&&A.before.push(T)}}),s(b).map(m).reduce((T,A)=>(T.push(...A),T),[])},v={add:(x,b={})=>{const{name:S,override:N,aliases:E}=b,T={step:"initialize",priority:"normal",middleware:x,...b},A=Zu(S,E);if(A.length>0){if(A.some(I=>n.has(I))){if(!N)throw new Error(`Duplicate middleware name '${Dc(S,E)}'`);for(const I of A){const D=r.findIndex(O=>{var B;return O.name===I||((B=O.aliases)==null?void 0:B.some(G=>G===I))});if(D===-1)continue;const j=r[D];if(j.step!==T.step||T.priority!==j.priority)throw new Error(`"${Dc(j.name,j.aliases)}" middleware with ${j.priority} priority in ${j.step} step cannot be overridden by "${Dc(S,E)}" middleware with ${T.priority} priority in ${T.step} step.`);r.splice(D,1)}}for(const I of A)n.add(I)}r.push(T)},addRelativeTo:(x,b)=>{const{name:S,override:N,aliases:E}=b,T={middleware:x,...b},A=Zu(S,E);if(A.length>0){if(A.some(I=>n.has(I))){if(!N)throw new Error(`Duplicate middleware name '${Dc(S,E)}'`);for(const I of A){const D=e.findIndex(O=>{var B;return O.name===I||((B=O.aliases)==null?void 0:B.some(G=>G===I))});if(D===-1)continue;const j=e[D];if(j.toMiddleware!==T.toMiddleware||j.relation!==T.relation)throw new Error(`"${Dc(j.name,j.aliases)}" middleware ${j.relation} "${j.toMiddleware}" middleware cannot be overridden by "${Dc(S,E)}" middleware ${T.relation} "${T.toMiddleware}" middleware.`);e.splice(D,1)}}for(const I of A)n.add(I)}e.push(T)},clone:()=>d(iy()),use:x=>{x.applyToStack(v)},remove:x=>typeof x=="string"?i(x):c(x),removeByTag:x=>{let b=!1;const S=N=>{const{tags:E,name:T,aliases:A}=N;if(E&&E.includes(x)){const I=Zu(T,A);for(const D of I)n.delete(D);return b=!0,!1}return!0};return r=r.filter(S),e=e.filter(S),b},concat:x=>{var S;const b=d(iy());return b.use(x),b.identifyOnResolve(t||b.identifyOnResolve()||(((S=x.identifyOnResolve)==null?void 0:S.call(x))??!1)),b},applyToStack:d,identify:()=>p(!0).map(x=>{const b=x.step??x.relation+" "+x.toMiddleware;return Dc(x.name,x.aliases)+" - "+b}),identifyOnResolve(x){return typeof x=="boolean"&&(t=x),t},resolve:(x,b)=>{for(const S of p().map(N=>N.middleware).reverse())x=S(x,b);return t&&console.log(v.identify()),x}};return v},jE={initialize:5,serialize:4,build:3,finalizeRequest:2,deserialize:1},FE={high:3,normal:2,low:1};class o1{constructor(e){z(this,"config");z(this,"middlewareStack",iy());z(this,"initConfig");z(this,"handlers");this.config=e;const{protocol:t,protocolSettings:n}=e;n&&typeof t=="function"&&(e.protocol=new t(n))}send(e,t,n){const s=typeof t!="function"?t:void 0,i=typeof t=="function"?t:n,c=s===void 0&&this.config.cacheMiddleware===!0;let d;if(c){this.handlers||(this.handlers=new WeakMap);const m=this.handlers;m.has(e.constructor)?d=m.get(e.constructor):(d=e.resolveMiddleware(this.middlewareStack,this.config,s),m.set(e.constructor,d))}else delete this.handlers,d=e.resolveMiddleware(this.middlewareStack,this.config,s);if(i)d(e).then(m=>i(null,m.output),m=>i(m)).catch(()=>{});else return d(e).then(m=>m.output)}destroy(){var e,t,n;(n=(t=(e=this.config)==null?void 0:e.requestHandler)==null?void 0:t.destroy)==null||n.call(t),delete this.handlers}}const wx="***SensitiveInformation***";function Sw(r,e){if(e==null)return e;const t=Fo.of(r);if(t.getMergedTraits().sensitive)return wx;if(t.isListSchema()){if(!!t.getValueSchema().getMergedTraits().sensitive)return wx}else if(t.isMapSchema()){if(!!t.getKeySchema().getMergedTraits().sensitive||!!t.getValueSchema().getMergedTraits().sensitive)return wx}else if(t.isStructSchema()&&typeof e=="object"){const n=e,s={};for(const[i,c]of t.structIterator())n[i]!=null&&(s[i]=Sw(c,n[i]));return s}return e}class i1{constructor(){z(this,"middlewareStack",iy());z(this,"schema")}static classBuilder(){return new xL}resolveMiddlewareWithContext(e,t,n,{middlewareFn:s,clientName:i,commandName:c,inputFilterSensitiveLog:d,outputFilterSensitiveLog:m,smithyContext:p,additionalContext:v,CommandCtor:x}){for(const T of s.bind(this)(x,e,t,n))this.middlewareStack.use(T);const b=e.concat(this.middlewareStack),{logger:S}=t,N={logger:S,clientName:i,commandName:c,inputFilterSensitiveLog:d,outputFilterSensitiveLog:m,[vw]:{commandInstance:this,...p},...v},{requestHandler:E}=t;return b.resolve(T=>E.handle(T.request,n||{}),N)}}class xL{constructor(){z(this,"_init",()=>{});z(this,"_ep",{});z(this,"_middlewareFn",()=>[]);z(this,"_commandName","");z(this,"_clientName","");z(this,"_additionalContext",{});z(this,"_smithyContext",{});z(this,"_inputFilterSensitiveLog");z(this,"_outputFilterSensitiveLog");z(this,"_serializer",null);z(this,"_deserializer",null);z(this,"_operationSchema")}init(e){this._init=e}ep(e){return this._ep=e,this}m(e){return this._middlewareFn=e,this}s(e,t,n={}){return this._smithyContext={service:e,operation:t,...n},this}c(e={}){return this._additionalContext=e,this}n(e,t){return this._clientName=e,this._commandName=t,this}f(e=n=>n,t=n=>n){return this._inputFilterSensitiveLog=e,this._outputFilterSensitiveLog=t,this}ser(e){return this._serializer=e,this}de(e){return this._deserializer=e,this}sc(e){return this._operationSchema=e,this._smithyContext.operationSchema=e,this}build(){const e=this;let t;return t=class extends i1{constructor(...[s]){super();z(this,"input");z(this,"serialize",e._serializer);z(this,"deserialize",e._deserializer);this.input=s??{},e._init(this),this.schema=e._operationSchema}static getEndpointParameterInstructions(){return e._ep}resolveMiddleware(s,i,c){const d=e._operationSchema,m=(d==null?void 0:d[4])??(d==null?void 0:d.input),p=(d==null?void 0:d[5])??(d==null?void 0:d.output);return this.resolveMiddlewareWithContext(s,i,c,{CommandCtor:t,middlewareFn:e._middlewareFn,clientName:e._clientName,commandName:e._commandName,inputFilterSensitiveLog:e._inputFilterSensitiveLog??(d?Sw.bind(null,m):v=>v),outputFilterSensitiveLog:e._outputFilterSensitiveLog??(d?Sw.bind(null,p):v=>v),smithyContext:e._smithyContext,additionalContext:e._additionalContext})}}}}class Kf extends Error{constructor(t){super(t.message);z(this,"$fault");z(this,"$response");z(this,"$retryable");z(this,"$metadata");Object.setPrototypeOf(this,Object.getPrototypeOf(this).constructor.prototype),this.name=t.name,this.$fault=t.$fault,this.$metadata=t.$metadata}static isInstance(t){if(!t)return!1;const n=t;return Kf.prototype.isPrototypeOf(n)||!!n.$fault&&!!n.$metadata&&(n.$fault==="client"||n.$fault==="server")}static[Symbol.hasInstance](t){if(!t)return!1;const n=t;return this===Kf?Kf.isInstance(t):Kf.isInstance(t)?n.name&&this.name?this.prototype.isPrototypeOf(t)||n.name===this.name:this.prototype.isPrototypeOf(t):!1}}const OE=(r,e={})=>{Object.entries(e).filter(([,n])=>n!==void 0).forEach(([n,s])=>{(r[n]==null||r[n]==="")&&(r[n]=s)});const t=r.message||r.Message||"UnknownError";return r.message=t,delete r.Message,r},a1=r=>{switch(r){case"standard":return{retryMode:"standard",connectionTimeout:3100};case"in-region":return{retryMode:"standard",connectionTimeout:1100};case"cross-region":return{retryMode:"standard",connectionTimeout:3100};case"mobile":return{retryMode:"standard",connectionTimeout:3e4};default:return{}}},wL=r=>{const e=[];for(const t in sy){const n=sy[t];r[n]!==void 0&&e.push({algorithmId:()=>n,checksumConstructor:()=>r[n]})}return{addChecksumAlgorithm(t){e.push(t)},checksumAlgorithms(){return e}}},bL=r=>{const e={};return r.checksumAlgorithms().forEach(t=>{e[t.algorithmId()]=t.checksumConstructor()}),e},_L=r=>({setRetryStrategy(e){r.retryStrategy=e},retryStrategy(){return r.retryStrategy}}),SL=r=>{const e={};return e.retryStrategy=r.retryStrategy(),e},l1=r=>Object.assign(wL(r),_L(r)),c1=r=>Object.assign(bL(r),SL(r));class Tb{trace(){}debug(){}info(){}warn(){}error(){}}class EL{constructor(e=!1){z(this,"queryCompat");this.queryCompat=e}resolveRestContentType(e,t){const n=t.getMemberSchemas(),s=Object.values(n).find(i=>!!i.getMergedTraits().httpPayload);if(s){const i=s.getMergedTraits().mediaType;return i||(s.isStringSchema()?"text/plain":s.isBlobSchema()?"application/octet-stream":e)}else if(!t.isUnitSchema()&&Object.values(n).find(c=>{const{httpQuery:d,httpQueryParams:m,httpHeader:p,httpLabel:v,httpPrefixHeaders:x}=c.getMergedTraits();return!d&&!m&&!p&&!v&&x===void 0}))return e}async getErrorSchemaOrThrowBaseException(e,t,n,s,i,c){let d=t,m=e;e.includes("#")&&([d,m]=e.split("#"));const p={$metadata:i,$fault:n.statusCode<500?"client":"server"},v=xt.for(d);try{return{errorSchema:(c==null?void 0:c(v,m))??v.getSchema(e),errorMetadata:p}}catch{s.message=s.message??s.Message??"UnknownError";const b=xt.for("smithy.ts.sdk.synthetic."+d),S=b.getBaseException();if(S){const N=b.getErrorCtor(S)??Error;throw this.decorateServiceException(Object.assign(new N({name:m}),p),s)}throw this.decorateServiceException(Object.assign(new Error(m),p),s)}}decorateServiceException(e,t={}){if(this.queryCompat){const n=e.Message??t.Message,s=OE(e,t);n&&(s.message=n),s.Error={...s.Error,Type:s.Error.Type,Code:s.Error.Code,Message:s.Error.message??s.Error.Message??n};const i=s.$metadata.requestId;return i&&(s.RequestId=i),s}return OE(e,t)}setQueryCompatError(e,t){var s;const n=(s=t.headers)==null?void 0:s["x-amzn-query-error"];if(e!==void 0&&n!=null){const[i,c]=n.split(";"),d=Object.entries(e),m={Code:i,Type:c};Object.assign(e,m);for(const[p,v]of d)m[p==="message"?"Message":p]=v;delete m.__type,e.Error=m}}queryCompatOutput(e,t){e.Error&&(t.Error=e.Error),e.Type&&(t.Type=e.Type),e.Code&&(t.Code=e.Code)}findQueryCompatibleError(e,t){try{return e.getSchema(t)}catch{return e.find(s=>{var i;return((i=Fo.of(s).getMergedTraits().awsQueryError)==null?void 0:i[0])===t})}}}class Ab{constructor(){z(this,"serdeContext")}setSerdeContext(e){this.serdeContext=e}}class kL{constructor(e,t){z(this,"from");z(this,"to");z(this,"keys");this.from=e,this.to=t,this.keys=new Set(Object.keys(this.from).filter(n=>n!=="__type"))}mark(e){this.keys.delete(e)}hasUnknown(){return this.keys.size===1&&Object.keys(this.to).length===0}writeUnknown(){if(this.hasUnknown()){const e=this.keys.values().next().value,t=this.from[e];this.to.$unknown=[e,t]}}}function CL(r,e,t){if(t!=null&&t.source){const n=t.source;if(typeof e=="number"&&(e>Number.MAX_SAFE_INTEGER||e<Number.MIN_SAFE_INTEGER||n!==String(e)))return n.includes(".")?new Va(n,"bigDecimal"):BigInt(n)}return e}const NL=(r,e)=>xw(r,e).then(t=>((e==null?void 0:e.utf8Encoder)??Ly)(t)),TL=(r,e)=>NL(r,e).then(t=>{if(t.length)try{return JSON.parse(t)}catch(n){throw(n==null?void 0:n.name)==="SyntaxError"&&Object.defineProperty(n,"$responseBodyText",{value:t}),n}return{}}),AL=(r,e)=>{const t=(i,c)=>Object.keys(i).find(d=>d.toLowerCase()===c.toLowerCase()),n=i=>{let c=i;return typeof c=="number"&&(c=c.toString()),c.indexOf(",")>=0&&(c=c.split(",")[0]),c.indexOf(":")>=0&&(c=c.split(":")[0]),c.indexOf("#")>=0&&(c=c.split("#")[1]),c},s=t(r.headers,"x-amzn-errortype");if(s!==void 0)return n(r.headers[s]);if(e&&typeof e=="object"){const i=t(e,"code");if(i&&e[i]!==void 0)return n(e[i]);if(e.__type!==void 0)return n(e.__type)}};class IL extends Ab{constructor(t){super();z(this,"settings");this.settings=t}async read(t,n){return this._read(t,typeof n=="string"?JSON.parse(n,CL):await TL(n,this.serdeContext))}readObject(t,n){return this._read(t,n)}_read(t,n){const s=n!==null&&typeof n=="object",i=Fo.of(t);if(s){if(i.isStructSchema()){const d=n,m=i.isUnionSchema(),p={};let v;const{jsonName:x}=this.settings;x&&(v={});let b;m&&(b=new kL(d,p));for(const[S,N]of i.structIterator()){let E=S;x&&(E=N.getMergedTraits().jsonName??E,v[E]=S),m&&b.mark(E),d[E]!=null&&(p[S]=this._read(N,d[E]))}if(m)b.writeUnknown();else if(typeof d.__type=="string")for(const[S,N]of Object.entries(d)){const E=x?v[S]??S:S;E in p||(p[E]=N)}return p}if(Array.isArray(n)&&i.isListSchema()){const d=i.getValueSchema(),m=[],p=!!i.getMergedTraits().sparse;for(const v of n)(p||v!=null)&&m.push(this._read(d,v));return m}if(i.isMapSchema()){const d=i.getValueSchema(),m={},p=!!i.getMergedTraits().sparse;for(const[v,x]of Object.entries(n))(p||x!=null)&&(m[v]=this._read(d,x));return m}}if(i.isBlobSchema()&&typeof n=="string")return Jm(n);const c=i.getMergedTraits().mediaType;if(i.isStringSchema()&&typeof n=="string"&&c)return c==="application/json"||c.endsWith("+json")?Gc.from(n):n;if(i.isTimestampSchema()&&n!=null)switch(PN(i,this.settings)){case 5:return G2(n);case 6:return K2(n);case 7:return Y2(n);default:return console.warn("Missing timestamp format, parsing value with Date constructor:",n),new Date(n)}if(i.isBigIntegerSchema()&&(typeof n=="number"||typeof n=="string"))return BigInt(n);if(i.isBigDecimalSchema()&&n!=null){if(n instanceof Va)return n;const d=n;return d.type==="bigDecimal"&&"string"in d?new Va(d.string,d.type):new Va(String(n),"bigDecimal")}if(i.isNumericSchema()&&typeof n=="string"){switch(n){case"Infinity":return 1/0;case"-Infinity":return-1/0;case"NaN":return NaN}return n}if(i.isDocumentSchema())if(s){const d=Array.isArray(n)?[]:{};for(const[m,p]of Object.entries(n))p instanceof Va?d[m]=p:d[m]=this._read(i,p);return d}else return structuredClone(n);return n}}const DE="";class RL{constructor(){z(this,"values",new Map);z(this,"counter",0);z(this,"stage",0)}createReplacer(){if(this.stage===1)throw new Error("@aws-sdk/core/protocols - JsonReplacer already created.");if(this.stage===2)throw new Error("@aws-sdk/core/protocols - JsonReplacer exhausted.");return this.stage=1,(e,t)=>{if(t instanceof Va){const n=`${DE+"nv"+this.counter++}_`+t.string;return this.values.set(`"${n}"`,t.string),n}if(typeof t=="bigint"){const n=t.toString(),s=`${DE+"b"+this.counter++}_`+n;return this.values.set(`"${s}"`,n),s}return t}}replaceInJson(e){if(this.stage===0)throw new Error("@aws-sdk/core/protocols - JsonReplacer not created yet.");if(this.stage===2)throw new Error("@aws-sdk/core/protocols - JsonReplacer exhausted.");if(this.stage=2,this.counter===0)return e;for(const[t,n]of this.values)e=e.replace(t,n);return e}}class PL extends Ab{constructor(t){super();z(this,"settings");z(this,"buffer");z(this,"useReplacer",!1);z(this,"rootSchema");this.settings=t}write(t,n){this.rootSchema=Fo.of(t),this.buffer=this._write(this.rootSchema,n)}writeDiscriminatedDocument(t,n){this.write(t,n),typeof this.buffer=="object"&&(this.buffer.__type=Fo.of(t).getName(!0))}flush(){const{rootSchema:t,useReplacer:n}=this;if(this.rootSchema=void 0,this.useReplacer=!1,t!=null&&t.isStructSchema()||t!=null&&t.isDocumentSchema()){if(!n)return JSON.stringify(this.buffer);const s=new RL;return s.replaceInJson(JSON.stringify(this.buffer,s.createReplacer(),0))}return this.buffer}_write(t,n,s){var d,m;const i=n!==null&&typeof n=="object",c=Fo.of(t);if(i){if(c.isStructSchema()){const p=n,v={},{jsonName:x}=this.settings;let b;x&&(b={});for(const[S,N]of c.structIterator()){const E=this._write(N,p[S],c);if(E!==void 0){let T=S;x&&(T=N.getMergedTraits().jsonName??S,b[S]=T),v[T]=E}}if(c.isUnionSchema()&&Object.keys(v).length===0){const{$unknown:S}=p;if(Array.isArray(S)){const[N,E]=S;v[N]=this._write(15,E)}}else if(typeof p.__type=="string")for(const[S,N]of Object.entries(p)){const E=x?b[S]??S:S;E in v||(v[E]=this._write(15,N))}return v}if(Array.isArray(n)&&c.isListSchema()){const p=c.getValueSchema(),v=[],x=!!c.getMergedTraits().sparse;for(const b of n)(x||b!=null)&&v.push(this._write(p,b));return v}if(c.isMapSchema()){const p=c.getValueSchema(),v={},x=!!c.getMergedTraits().sparse;for(const[b,S]of Object.entries(n))(x||S!=null)&&(v[b]=this._write(p,S));return v}if(n instanceof Uint8Array&&(c.isBlobSchema()||c.isDocumentSchema()))return c===this.rootSchema?n:(((d=this.serdeContext)==null?void 0:d.base64Encoder)??Rm)(n);if(n instanceof Date&&(c.isTimestampSchema()||c.isDocumentSchema()))switch(PN(c,this.settings)){case 5:return n.toISOString().replace(".000Z","Z");case 6:return H2(n);case 7:return n.getTime()/1e3;default:return console.warn("Missing timestamp format, using epoch seconds",n),n.getTime()/1e3}n instanceof Va&&(this.useReplacer=!0)}if(!(n===null&&(s!=null&&s.isStructSchema()))){if(c.isStringSchema()){if(typeof n>"u"&&c.isIdempotencyToken())return RN();const p=c.getMergedTraits().mediaType;return n!=null&&p&&(p==="application/json"||p.endsWith("+json"))?Gc.from(n):n}if(typeof n=="number"&&c.isNumericSchema())return Math.abs(n)===1/0||isNaN(n)?String(n):n;if(typeof n=="string"&&c.isBlobSchema())return c===this.rootSchema?n:(((m=this.serdeContext)==null?void 0:m.base64Encoder)??Rm)(n);if(typeof n=="bigint"&&(this.useReplacer=!0),c.isDocumentSchema())if(i){const p=Array.isArray(n)?[]:{};for(const[v,x]of Object.entries(n))x instanceof Va?(this.useReplacer=!0,p[v]=x):p[v]=this._write(c,x);return p}else return structuredClone(n);return n}}}class jL extends Ab{constructor(t){super();z(this,"settings");this.settings=t}createSerializer(){const t=new PL(this.settings);return t.setSerdeContext(this.serdeContext),t}createDeserializer(){const t=new IL(this.settings);return t.setSerdeContext(this.serdeContext),t}}class FL extends lD{constructor({defaultNamespace:t,serviceTarget:n,awsQueryCompatible:s,jsonCodec:i}){super({defaultNamespace:t});z(this,"serializer");z(this,"deserializer");z(this,"serviceTarget");z(this,"codec");z(this,"mixin");z(this,"awsQueryCompatible");this.serviceTarget=n,this.codec=i??new jL({timestampFormat:{useTrait:!0,default:7},jsonName:!1}),this.serializer=this.codec.createSerializer(),this.deserializer=this.codec.createDeserializer(),this.awsQueryCompatible=!!s,this.mixin=new EL(this.awsQueryCompatible)}async serializeRequest(t,n,s){const i=await super.serializeRequest(t,n,s);return i.path.endsWith("/")||(i.path+="/"),Object.assign(i.headers,{"content-type":`application/x-amz-json-${this.getJsonRpcVersion()}`,"x-amz-target":`${this.serviceTarget}.${t.name}`}),this.awsQueryCompatible&&(i.headers["x-amzn-query-mode"]="true"),(Bv(t.input)==="unit"||!i.body)&&(i.body="{}"),i}getPayloadCodec(){return this.codec}async handleError(t,n,s,i,c){this.awsQueryCompatible&&this.mixin.setQueryCompatError(i,s);const d=AL(s,i)??"Unknown",{errorSchema:m,errorMetadata:p}=await this.mixin.getErrorSchemaOrThrowBaseException(d,this.options.defaultNamespace,s,i,c,this.awsQueryCompatible?this.mixin.findQueryCompatibleError:void 0),v=Fo.of(m),x=i.message??i.Message??"Unknown",b=xt.for(m[1]).getErrorCtor(m)??Error,S=new b(x),N={};for(const[E,T]of v.structIterator())i[E]!=null&&(N[E]=this.codec.createDeserializer().readObject(T,i[E]));throw this.awsQueryCompatible&&this.mixin.queryCompatOutput(i,N),this.mixin.decorateServiceException(Object.assign(S,p,{$fault:v.getMergedTraits().error,message:x},N),i)}}class u1 extends FL{constructor({defaultNamespace:e,serviceTarget:t,awsQueryCompatible:n,jsonCodec:s}){super({defaultNamespace:e,serviceTarget:t,awsQueryCompatible:n,jsonCodec:s})}getShapeId(){return"aws.protocols#awsJson1_1"}getJsonRpcVersion(){return"1.1"}getDefaultContentType(){return"application/x-amz-json-1.1"}}const OL=/\d{12}\.ddb/;async function DL(r,e,t){var i,c,d,m,p,v,x;const n=t.request;if(((i=n==null?void 0:n.headers)==null?void 0:i["smithy-protocol"])==="rpc-v2-cbor"&&La(r,"PROTOCOL_RPC_V2_CBOR","M"),typeof e.retryStrategy=="function"){const b=await e.retryStrategy();typeof b.acquireInitialRetryToken=="function"?(d=(c=b.constructor)==null?void 0:c.name)!=null&&d.includes("Adaptive")?La(r,"RETRY_MODE_ADAPTIVE","F"):La(r,"RETRY_MODE_STANDARD","E"):La(r,"RETRY_MODE_LEGACY","D")}if(typeof e.accountIdEndpointMode=="function"){const b=r.endpointV2;switch(String((m=b==null?void 0:b.url)==null?void 0:m.hostname).match(OL)&&La(r,"ACCOUNT_ID_ENDPOINT","O"),await((p=e.accountIdEndpointMode)==null?void 0:p.call(e))){case"disabled":La(r,"ACCOUNT_ID_MODE_DISABLED","Q");break;case"preferred":La(r,"ACCOUNT_ID_MODE_PREFERRED","P");break;case"required":La(r,"ACCOUNT_ID_MODE_REQUIRED","R");break}}const s=(x=(v=r.__smithy_context)==null?void 0:v.selectedHttpAuthScheme)==null?void 0:x.identity;if(s!=null&&s.$source){const b=s;b.accountId&&La(r,"RESOLVED_ACCOUNT_ID","T");for(const[S,N]of Object.entries(b.$source??{}))La(r,S,N)}}const LE="user-agent",bx="x-amz-user-agent",ME=" ",_x="/",LL=/[^!$%&'*+\-.^_`|~\w]/g,ML=/[^!$%&'*+\-.^_`|~\w#]/g,$E="-",$L=1024;function UL(r){let e="";for(const t in r){const n=r[t];if(e.length+n.length+1<=$L){e.length?e+=","+n:e+=n;continue}break}return e}const zL=r=>(e,t)=>async n=>{var S,N,E,T;const{request:s}=n;if(!ii.isInstance(s))return e(n);const{headers:i}=s,c=((S=t==null?void 0:t.userAgent)==null?void 0:S.map(kv))||[],d=(await r.defaultUserAgentProvider()).map(kv);await DL(t,r,n);const m=t;d.push(`m/${UL(Object.assign({},(N=t.__smithy_context)==null?void 0:N.features,(E=m.__aws_sdk_context)==null?void 0:E.features))}`);const p=((T=r==null?void 0:r.customUserAgent)==null?void 0:T.map(kv))||[],v=await r.userAgentAppId();v&&d.push(kv(["app",`${v}`]));const x=[].concat([...d,...c,...p]).join(ME),b=[...d.filter(A=>A.startsWith("aws-sdk-")),...p].join(ME);return r.runtime!=="browser"?(b&&(i[bx]=i[bx]?`${i[LE]} ${b}`:b),i[LE]=x):i[bx]=x,e({...n,request:s})},kv=r=>{var c;const e=r[0].split(_x).map(d=>d.replace(LL,$E)).join(_x),t=(c=r[1])==null?void 0:c.replace(ML,$E),n=e.indexOf(_x),s=e.substring(0,n);let i=e.substring(n+1);return s==="api"&&(i=i.toLowerCase()),[s,i,t].filter(d=>d&&d.length>0).reduce((d,m,p)=>{switch(p){case 0:return m;case 1:return`${d}/${m}`;default:return`${d}#${m}`}},"")},HL={name:"getUserAgentMiddleware",step:"build",priority:"low",tags:["SET_USER_AGENT","USER_AGENT"],override:!0},d1=r=>({applyToStack:e=>{e.add(zL(r),HL)}}),f1=!1,h1=!1,UE=new Set,BL=(r,e=Xm)=>{if(!UE.has(r)&&!e(r))if(r==="*")console.warn('@smithy/config-resolver WARN - Please use the caller region instead of "*". See "sigv4a" in https://github.com/aws/aws-sdk-js-v3/blob/main/supplemental-docs/CLIENTS.md.');else throw new Error(`Region not accepted: region="${r}" is not a valid hostname component.`);else UE.add(r)},p1=r=>typeof r=="string"&&(r.startsWith("fips-")||r.endsWith("-fips")),GL=r=>p1(r)?["fips-aws-global","aws-fips"].includes(r)?"us-east-1":r.replace(/fips-(dkr-|prod-)?|-fips/,""):r,m1=r=>{const{region:e,useFipsEndpoint:t}=r;if(!e)throw new Error("Region is missing");return Object.assign(r,{region:async()=>{const n=typeof e=="function"?await e():e,s=GL(n);return BL(s),s},useFipsEndpoint:async()=>{const n=typeof e=="string"?e:await e();return p1(n)?!0:typeof t!="function"?Promise.resolve(!!t):t()}})},zE="content-length";function WL(r){return e=>async t=>{const n=t.request;if(ii.isInstance(n)){const{body:s,headers:i}=n;if(s&&Object.keys(i).map(c=>c.toLowerCase()).indexOf(zE)===-1)try{const c=r(s);n.headers={...n.headers,[zE]:String(c)}}catch{}}return e({...t,request:n})}}const VL={step:"build",tags:["SET_CONTENT_LENGTH","CONTENT_LENGTH"],name:"contentLengthMiddleware",override:!0},g1=r=>({applyToStack:e=>{e.add(WL(r.bodyLengthChecker),VL)}}),qL=async r=>{const e=(r==null?void 0:r.Bucket)||"";if(typeof r.Bucket=="string"&&(r.Bucket=e.replace(/#/g,encodeURIComponent("#")).replace(/\?/g,encodeURIComponent("?"))),QL(e)){if(r.ForcePathStyle===!0)throw new Error("Path-style addressing cannot be used with ARN buckets")}else(!XL(e)||e.indexOf(".")!==-1&&!String(r.Endpoint).startsWith("http:")||e.toLowerCase()!==e||e.length<3)&&(r.ForcePathStyle=!0);return r.DisableMultiRegionAccessPoints&&(r.disableMultiRegionAccessPoints=!0,r.DisableMRAP=!0),r},KL=/^[a-z0-9][a-z0-9\.\-]{1,61}[a-z0-9]$/,YL=/(\d+\.){3}\d+/,JL=/\.\./,XL=r=>KL.test(r)&&!YL.test(r)&&!JL.test(r),QL=r=>{const[e,t,n,,,s]=r.split(":"),i=e==="arn"&&r.split(":").length>=6,c=!!(i&&t&&n&&s);if(i&&!c)throw new Error(`Invalid ARN: ${r} was an invalid ARN.`);return c},ZL=(r,e,t,n=!1)=>{const s=async()=>{let i;if(n){const c=t.clientContextParams;i=(c==null?void 0:c[r])??t[r]??t[e]}else i=t[r]??t[e];return typeof i=="function"?i():i};return r==="credentialScope"||e==="CredentialScope"?async()=>{const i=typeof t.credentials=="function"?await t.credentials():t.credentials;return(i==null?void 0:i.credentialScope)??(i==null?void 0:i.CredentialScope)}:r==="accountId"||e==="AccountId"?async()=>{const i=typeof t.credentials=="function"?await t.credentials():t.credentials;return(i==null?void 0:i.accountId)??(i==null?void 0:i.AccountId)}:r==="endpoint"||e==="endpoint"?async()=>{if(t.isCustomEndpoint===!1)return;const i=await s();if(i&&typeof i=="object"){if("url"in i)return i.url.href;if("hostname"in i){const{protocol:c,hostname:d,port:m,path:p}=i;return`${c}//${d}${m?":"+m:""}${p}`}}return i}:s},v1=async r=>{},y1=r=>typeof r=="object"?"url"in r?Fm(r.url):r:Fm(r),eM=async(r,e,t,n)=>{if(!t.isCustomEndpoint){let c;t.serviceConfiguredEndpoint?c=await t.serviceConfiguredEndpoint():c=await v1(t.serviceId),c&&(t.endpoint=()=>Promise.resolve(y1(c)),t.isCustomEndpoint=!0)}const s=await tM(r,e,t);if(typeof t.endpointProvider!="function")throw new Error("config.endpointProvider is not set.");return t.endpointProvider(s,n)},tM=async(r,e,t)=>{var i;const n={},s=((i=e==null?void 0:e.getEndpointParameterInstructions)==null?void 0:i.call(e))||{};for(const[c,d]of Object.entries(s))switch(d.type){case"staticContextParams":n[c]=d.value;break;case"contextParams":n[c]=r[d.name];break;case"clientContextParams":case"builtInParams":n[c]=await ZL(d.name,c,t,d.type!=="builtInParams")();break;case"operationContextParams":n[c]=d.get(r);break;default:throw new Error("Unrecognized endpoint parameter instruction: "+JSON.stringify(d))}return Object.keys(s).length===0&&Object.assign(n,t),String(t.serviceId).toLowerCase()==="s3"&&await qL(n),n},rM=({config:r,instructions:e})=>(t,n)=>async s=>{var d,m,p;r.isCustomEndpoint&&cD(n,"ENDPOINT_OVERRIDE","N");const i=await eM(s.input,{getEndpointParameterInstructions(){return e}},{...r},n);n.endpointV2=i,n.authSchemes=(d=i.properties)==null?void 0:d.authSchemes;const c=(m=n.authSchemes)==null?void 0:m[0];if(c){n.signing_region=c.signingRegion,n.signing_service=c.signingName;const v=pd(n),x=(p=v==null?void 0:v.selectedHttpAuthScheme)==null?void 0:p.httpAuthOption;x&&(x.signingProperties=Object.assign(x.signingProperties||{},{signing_region:c.signingRegion,signingRegion:c.signingRegion,signing_service:c.signingName,signingName:c.signingName,signingRegionSet:c.signingRegionSet},c.properties))}return t({...s})},nM={step:"serialize",tags:["ENDPOINT_PARAMETERS","ENDPOINT_V2","ENDPOINT"],name:"endpointV2Middleware",override:!0,relation:"before",toMiddleware:h2.name},sM=(r,e)=>({applyToStack:t=>{t.addRelativeTo(rM({config:r,instructions:e}),nM)}}),x1=r=>{const e=r.tls??!0,{endpoint:t,useDualstackEndpoint:n,useFipsEndpoint:s}=r,i=t!=null?async()=>y1(await oa(t)()):void 0,d=Object.assign(r,{endpoint:i,tls:e,isCustomEndpoint:!!t,useDualstackEndpoint:oa(n??!1),useFipsEndpoint:oa(s??!1)});let m;return d.serviceConfiguredEndpoint=async()=>(r.serviceId&&!m&&(m=v1(r.serviceId)),m),d};var fh;(function(r){r.STANDARD="standard",r.ADAPTIVE="adaptive"})(fh||(fh={}));const Om=3,w1=fh.STANDARD,oM=["BandwidthLimitExceeded","EC2ThrottledException","LimitExceededException","PriorRequestNotComplete","ProvisionedThroughputExceededException","RequestLimitExceeded","RequestThrottled","RequestThrottledException","SlowDown","ThrottledException","Throttling","ThrottlingException","TooManyRequestsException","TransactionInProgressException"],iM=["TimeoutError","RequestTimeout","RequestTimeoutException"],aM=[500,502,503,504],lM=["ECONNRESET","ECONNREFUSED","EPIPE","ETIMEDOUT"],cM=["EHOSTUNREACH","ENETUNREACH","ENOTFOUND"],uM=r=>(r==null?void 0:r.$retryable)!==void 0,dM=r=>{var e;return(e=r.$metadata)==null?void 0:e.clockSkewCorrected},fM=r=>{const e=new Set(["Failed to fetch","NetworkError when attempting to fetch resource","The Internet connection appears to be offline","Load failed","Network request failed"]);return r&&r instanceof TypeError?e.has(r.message):!1},b1=r=>{var e,t;return((e=r.$metadata)==null?void 0:e.httpStatusCode)===429||oM.includes(r.name)||((t=r.$retryable)==null?void 0:t.throttling)==!0},Ib=(r,e=0)=>{var t;return uM(r)||dM(r)||iM.includes(r.name)||lM.includes((r==null?void 0:r.code)||"")||cM.includes((r==null?void 0:r.code)||"")||aM.includes(((t=r.$metadata)==null?void 0:t.httpStatusCode)||0)||fM(r)||r.cause!==void 0&&e<=10&&Ib(r.cause,e+1)},hM=r=>{var e;if(((e=r.$metadata)==null?void 0:e.httpStatusCode)!==void 0){const t=r.$metadata.httpStatusCode;return 500<=t&&t<=599&&!Ib(r)}return!1},Dy=class Dy{constructor(e){z(this,"beta");z(this,"minCapacity");z(this,"minFillRate");z(this,"scaleConstant");z(this,"smooth");z(this,"currentCapacity",0);z(this,"enabled",!1);z(this,"lastMaxRate",0);z(this,"measuredTxRate",0);z(this,"requestCount",0);z(this,"fillRate");z(this,"lastThrottleTime");z(this,"lastTimestamp",0);z(this,"lastTxRateBucket");z(this,"maxCapacity");z(this,"timeWindow",0);this.beta=(e==null?void 0:e.beta)??.7,this.minCapacity=(e==null?void 0:e.minCapacity)??1,this.minFillRate=(e==null?void 0:e.minFillRate)??.5,this.scaleConstant=(e==null?void 0:e.scaleConstant)??.4,this.smooth=(e==null?void 0:e.smooth)??.8;const t=this.getCurrentTimeInSeconds();this.lastThrottleTime=t,this.lastTxRateBucket=Math.floor(this.getCurrentTimeInSeconds()),this.fillRate=this.minFillRate,this.maxCapacity=this.minCapacity}getCurrentTimeInSeconds(){return Date.now()/1e3}async getSendToken(){return this.acquireTokenBucket(1)}async acquireTokenBucket(e){if(this.enabled){if(this.refillTokenBucket(),e>this.currentCapacity){const t=(e-this.currentCapacity)/this.fillRate*1e3;await new Promise(n=>Dy.setTimeoutFn(n,t))}this.currentCapacity=this.currentCapacity-e}}refillTokenBucket(){const e=this.getCurrentTimeInSeconds();if(!this.lastTimestamp){this.lastTimestamp=e;return}const t=(e-this.lastTimestamp)*this.fillRate;this.currentCapacity=Math.min(this.maxCapacity,this.currentCapacity+t),this.lastTimestamp=e}updateClientSendingRate(e){let t;if(this.updateMeasuredRate(),b1(e)){const s=this.enabled?Math.min(this.measuredTxRate,this.fillRate):this.measuredTxRate;this.lastMaxRate=s,this.calculateTimeWindow(),this.lastThrottleTime=this.getCurrentTimeInSeconds(),t=this.cubicThrottle(s),this.enableTokenBucket()}else this.calculateTimeWindow(),t=this.cubicSuccess(this.getCurrentTimeInSeconds());const n=Math.min(t,2*this.measuredTxRate);this.updateTokenBucketRate(n)}calculateTimeWindow(){this.timeWindow=this.getPrecise(Math.pow(this.lastMaxRate*(1-this.beta)/this.scaleConstant,1/3))}cubicThrottle(e){return this.getPrecise(e*this.beta)}cubicSuccess(e){return this.getPrecise(this.scaleConstant*Math.pow(e-this.lastThrottleTime-this.timeWindow,3)+this.lastMaxRate)}enableTokenBucket(){this.enabled=!0}updateTokenBucketRate(e){this.refillTokenBucket(),this.fillRate=Math.max(e,this.minFillRate),this.maxCapacity=Math.max(e,this.minCapacity),this.currentCapacity=Math.min(this.currentCapacity,this.maxCapacity)}updateMeasuredRate(){const e=this.getCurrentTimeInSeconds(),t=Math.floor(e*2)/2;if(this.requestCount++,t>this.lastTxRateBucket){const n=this.requestCount/(t-this.lastTxRateBucket);this.measuredTxRate=this.getPrecise(n*this.smooth+this.measuredTxRate*(1-this.smooth)),this.requestCount=0,this.lastTxRateBucket=t}}getPrecise(e){return parseFloat(e.toFixed(8))}};z(Dy,"setTimeoutFn",setTimeout);let Ew=Dy;const kw=100,_1=20*1e3,pM=500,HE=500,mM=5,gM=10,vM=1,yM="amz-sdk-invocation-id",xM="amz-sdk-request",wM=()=>{let r=kw;return{computeNextBackoffDelay:n=>Math.floor(Math.min(_1,Math.random()*2**n*r)),setDelayBase:n=>{r=n}}},BE=({retryDelay:r,retryCount:e,retryCost:t})=>({getRetryCount:()=>e,getRetryDelay:()=>Math.min(_1,r),getRetryCost:()=>t});class S1{constructor(e){z(this,"maxAttempts");z(this,"mode",fh.STANDARD);z(this,"capacity",HE);z(this,"retryBackoffStrategy",wM());z(this,"maxAttemptsProvider");this.maxAttempts=e,this.maxAttemptsProvider=typeof e=="function"?e:async()=>e}async acquireInitialRetryToken(e){return BE({retryDelay:kw,retryCount:0})}async refreshRetryTokenForRetry(e,t){const n=await this.getMaxAttempts();if(this.shouldRetry(e,t,n)){const s=t.errorType;this.retryBackoffStrategy.setDelayBase(s==="THROTTLING"?pM:kw);const i=this.retryBackoffStrategy.computeNextBackoffDelay(e.getRetryCount()),c=t.retryAfterHint?Math.max(t.retryAfterHint.getTime()-Date.now()||0,i):i,d=this.getCapacityCost(s);return this.capacity-=d,BE({retryDelay:c,retryCount:e.getRetryCount()+1,retryCost:d})}throw new Error("No retry token available")}recordSuccess(e){this.capacity=Math.max(HE,this.capacity+(e.getRetryCost()??vM))}getCapacity(){return this.capacity}async getMaxAttempts(){try{return await this.maxAttemptsProvider()}catch{return console.warn(`Max attempts provider could not resolve. Using default of ${Om}`),Om}}shouldRetry(e,t,n){return e.getRetryCount()+1<n&&this.capacity>=this.getCapacityCost(t.errorType)&&this.isRetryableError(t.errorType)}getCapacityCost(e){return e==="TRANSIENT"?gM:mM}isRetryableError(e){return e==="THROTTLING"||e==="TRANSIENT"}}class bM{constructor(e,t){z(this,"maxAttemptsProvider");z(this,"rateLimiter");z(this,"standardRetryStrategy");z(this,"mode",fh.ADAPTIVE);this.maxAttemptsProvider=e;const{rateLimiter:n}=t??{};this.rateLimiter=n??new Ew,this.standardRetryStrategy=new S1(e)}async acquireInitialRetryToken(e){return await this.rateLimiter.getSendToken(),this.standardRetryStrategy.acquireInitialRetryToken(e)}async refreshRetryTokenForRetry(e,t){return this.rateLimiter.updateClientSendingRate(t),this.standardRetryStrategy.refreshRetryTokenForRetry(e,t)}recordSuccess(e){this.rateLimiter.updateClientSendingRate({}),this.standardRetryStrategy.recordSuccess(e)}}const _M=r=>r instanceof Error?r:r instanceof Object?Object.assign(new Error,r):typeof r=="string"?new Error(r):new Error(`AWS SDK error wrapper for ${r}`),E1=r=>{const{retryStrategy:e,retryMode:t,maxAttempts:n}=r,s=oa(n??Om);return Object.assign(r,{maxAttempts:s,retryStrategy:async()=>e||(await oa(t)()===fh.ADAPTIVE?new bM(s):new S1(s))})},SM=r=>(r==null?void 0:r.body)instanceof ReadableStream,EM=r=>(e,t)=>async n=>{var c;let s=await r.retryStrategy();const i=await r.maxAttempts();if(kM(s)){s=s;let d=await s.acquireInitialRetryToken(t.partition_id),m=new Error,p=0,v=0;const{request:x}=n,b=ii.isInstance(x);for(b&&(x.headers[yM]=RN());;)try{b&&(x.headers[xM]=`attempt=${p+1}; max=${i}`);const{response:S,output:N}=await e(n);return s.recordSuccess(d),N.$metadata.attempts=p+1,N.$metadata.totalRetryDelay=v,{response:S,output:N}}catch(S){const N=CM(S);if(m=_M(S),b&&SM(x))throw(c=t.logger instanceof Tb?console:t.logger)==null||c.warn("An error was encountered in a non-retryable streaming request."),m;try{d=await s.refreshRetryTokenForRetry(d,N)}catch{throw m.$metadata||(m.$metadata={}),m.$metadata.attempts=p+1,m.$metadata.totalRetryDelay=v,m}p=d.getRetryCount();const E=d.getRetryDelay();v+=E,await new Promise(T=>setTimeout(T,E))}}else return s=s,s!=null&&s.mode&&(t.userAgent=[...t.userAgent||[],["cfg/retry-mode",s.mode]]),s.retry(e,n)},kM=r=>typeof r.acquireInitialRetryToken<"u"&&typeof r.refreshRetryTokenForRetry<"u"&&typeof r.recordSuccess<"u",CM=r=>{const e={error:r,errorType:NM(r)},t=AM(r.$response);return t&&(e.retryAfterHint=t),e},NM=r=>b1(r)?"THROTTLING":Ib(r)?"TRANSIENT":hM(r)?"SERVER_ERROR":"CLIENT_ERROR",TM={name:"retryMiddleware",tags:["RETRY"],step:"finalizeRequest",priority:"high",override:!0},k1=r=>({applyToStack:e=>{e.add(EM(r),TM)}}),AM=r=>{if(!uh.isInstance(r))return;const e=Object.keys(r.headers).find(i=>i.toLowerCase()==="retry-after");if(!e)return;const t=r.headers[e],n=Number(t);return Number.isNaN(n)?new Date(t):new Date(n*1e3)},IM=async(r,e,t)=>({operation:pd(e).operation,region:await oa(r.region)()||(()=>{throw new Error("expected `region` to be configured for `aws.auth#sigv4`")})()});function RM(r){return{schemeId:"aws.auth#sigv4",signingProperties:{name:"cognito-idp",region:r.region},propertiesExtractor:(e,t)=>({signingProperties:{config:e,context:t}})}}function Ir(r){return{schemeId:"smithy.api#noAuth"}}const PM=r=>{const e=[];switch(r.operation){case"AssociateSoftwareToken":{e.push(Ir());break}case"ChangePassword":{e.push(Ir());break}case"CompleteWebAuthnRegistration":{e.push(Ir());break}case"ConfirmDevice":{e.push(Ir());break}case"ConfirmForgotPassword":{e.push(Ir());break}case"ConfirmSignUp":{e.push(Ir());break}case"DeleteUser":{e.push(Ir());break}case"DeleteUserAttributes":{e.push(Ir());break}case"DeleteWebAuthnCredential":{e.push(Ir());break}case"ForgetDevice":{e.push(Ir());break}case"ForgotPassword":{e.push(Ir());break}case"GetDevice":{e.push(Ir());break}case"GetTokensFromRefreshToken":{e.push(Ir());break}case"GetUser":{e.push(Ir());break}case"GetUserAttributeVerificationCode":{e.push(Ir());break}case"GetUserAuthFactors":{e.push(Ir());break}case"GlobalSignOut":{e.push(Ir());break}case"InitiateAuth":{e.push(Ir());break}case"ListDevices":{e.push(Ir());break}case"ListWebAuthnCredentials":{e.push(Ir());break}case"ResendConfirmationCode":{e.push(Ir());break}case"RespondToAuthChallenge":{e.push(Ir());break}case"RevokeToken":{e.push(Ir());break}case"SetUserMFAPreference":{e.push(Ir());break}case"SetUserSettings":{e.push(Ir());break}case"SignUp":{e.push(Ir());break}case"StartWebAuthnRegistration":{e.push(Ir());break}case"UpdateAuthEventFeedback":{e.push(Ir());break}case"UpdateDeviceStatus":{e.push(Ir());break}case"UpdateUserAttributes":{e.push(Ir());break}case"VerifySoftwareToken":{e.push(Ir());break}case"VerifyUserAttribute":{e.push(Ir());break}default:e.push(RM(r))}return e},jM=r=>{const e=n1(r);return Object.assign(e,{authSchemePreference:oa(r.authSchemePreference??[])})},FM=r=>Object.assign(r,{useDualstackEndpoint:r.useDualstackEndpoint??!1,useFipsEndpoint:r.useFipsEndpoint??!1,defaultSigningName:"cognito-idp"}),OM={UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}},DM="3.981.0",LM={version:DM},MM=r=>new TextEncoder().encode(r);var $M=typeof Buffer<"u"&&Buffer.from?function(r){return Buffer.from(r,"utf8")}:MM;function Dm(r){return r instanceof Uint8Array?r:typeof r=="string"?$M(r):ArrayBuffer.isView(r)?new Uint8Array(r.buffer,r.byteOffset,r.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(r)}function Cw(r){return typeof r=="string"?r.length===0:r.byteLength===0}var C1={name:"SHA-256"},GE={name:"HMAC",hash:C1},UM=new Uint8Array([227,176,196,66,152,252,28,20,154,251,244,200,153,111,185,36,39,174,65,228,100,155,147,76,164,149,153,27,120,82,184,85]);const zM={};function Wv(){return typeof window<"u"?window:typeof self<"u"?self:zM}var HM=(function(){function r(e){this.toHash=new Uint8Array(0),this.secret=e,this.reset()}return r.prototype.update=function(e){if(!Cw(e)){var t=Dm(e),n=new Uint8Array(this.toHash.byteLength+t.byteLength);n.set(this.toHash,0),n.set(t,this.toHash.byteLength),this.toHash=n}},r.prototype.digest=function(){var e=this;return this.key?this.key.then(function(t){return Wv().crypto.subtle.sign(GE,t,e.toHash).then(function(n){return new Uint8Array(n)})}):Cw(this.toHash)?Promise.resolve(UM):Promise.resolve().then(function(){return Wv().crypto.subtle.digest(C1,e.toHash)}).then(function(t){return Promise.resolve(new Uint8Array(t))})},r.prototype.reset=function(){var e=this;this.toHash=new Uint8Array(0),this.secret&&this.secret!==void 0&&(this.key=new Promise(function(t,n){Wv().crypto.subtle.importKey("raw",Dm(e.secret),GE,!1,["sign"]).then(t,n)}),this.key.catch(function(){}))},r})(),Ha=function(){return Ha=Object.assign||function(e){for(var t,n=1,s=arguments.length;n<s;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},Ha.apply(this,arguments)};function N1(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(r);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(r,n[s])&&(t[n[s]]=r[n[s]]);return t}function BM(r,e,t,n){function s(i){return i instanceof t?i:new t(function(c){c(i)})}return new(t||(t=Promise))(function(i,c){function d(v){try{p(n.next(v))}catch(x){c(x)}}function m(v){try{p(n.throw(v))}catch(x){c(x)}}function p(v){v.done?i(v.value):s(v.value).then(d,m)}p((n=n.apply(r,e||[])).next())})}function GM(r,e){var t={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,c=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return c.next=d(0),c.throw=d(1),c.return=d(2),typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function d(p){return function(v){return m([p,v])}}function m(p){if(n)throw new TypeError("Generator is already executing.");for(;c&&(c=0,p[0]&&(t=0)),t;)try{if(n=1,s&&(i=p[0]&2?s.return:p[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,p[1])).done)return i;switch(s=0,i&&(p=[p[0]&2,i.value]),p[0]){case 0:case 1:i=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,s=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(i=t.trys,!(i=i.length>0&&i[i.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!i||p[1]>i[0]&&p[1]<i[3])){t.label=p[1];break}if(p[0]===6&&t.label<i[1]){t.label=i[1],i=p;break}if(i&&t.label<i[2]){t.label=i[2],t.ops.push(p);break}i[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(r,t)}catch(v){p=[6,v],s=0}finally{n=i=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function WM(r,e,t){if(t||arguments.length===2)for(var n=0,s=e.length,i;n<s;n++)(i||!(n in e))&&(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return r.concat(i||Array.prototype.slice.call(e))}var Ti=64,VM=32,qM=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),KM=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],YM=Math.pow(2,53)-1,Vv=(function(){function r(){this.state=Int32Array.from(KM),this.temp=new Int32Array(64),this.buffer=new Uint8Array(64),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}return r.prototype.update=function(e){if(this.finished)throw new Error("Attempted to update an already finished hash.");var t=0,n=e.byteLength;if(this.bytesHashed+=n,this.bytesHashed*8>YM)throw new Error("Cannot hash more than 2^53 - 1 bits");for(;n>0;)this.buffer[this.bufferLength++]=e[t++],n--,this.bufferLength===Ti&&(this.hashBuffer(),this.bufferLength=0)},r.prototype.digest=function(){if(!this.finished){var e=this.bytesHashed*8,t=new DataView(this.buffer.buffer,this.buffer.byteOffset,this.buffer.byteLength),n=this.bufferLength;if(t.setUint8(this.bufferLength++,128),n%Ti>=Ti-8){for(var s=this.bufferLength;s<Ti;s++)t.setUint8(s,0);this.hashBuffer(),this.bufferLength=0}for(var s=this.bufferLength;s<Ti-8;s++)t.setUint8(s,0);t.setUint32(Ti-8,Math.floor(e/4294967296),!0),t.setUint32(Ti-4,e),this.hashBuffer(),this.finished=!0}for(var i=new Uint8Array(VM),s=0;s<8;s++)i[s*4]=this.state[s]>>>24&255,i[s*4+1]=this.state[s]>>>16&255,i[s*4+2]=this.state[s]>>>8&255,i[s*4+3]=this.state[s]>>>0&255;return i},r.prototype.hashBuffer=function(){for(var e=this,t=e.buffer,n=e.state,s=n[0],i=n[1],c=n[2],d=n[3],m=n[4],p=n[5],v=n[6],x=n[7],b=0;b<Ti;b++){if(b<16)this.temp[b]=(t[b*4]&255)<<24|(t[b*4+1]&255)<<16|(t[b*4+2]&255)<<8|t[b*4+3]&255;else{var S=this.temp[b-2],N=(S>>>17|S<<15)^(S>>>19|S<<13)^S>>>10;S=this.temp[b-15];var E=(S>>>7|S<<25)^(S>>>18|S<<14)^S>>>3;this.temp[b]=(N+this.temp[b-7]|0)+(E+this.temp[b-16]|0)}var T=(((m>>>6|m<<26)^(m>>>11|m<<21)^(m>>>25|m<<7))+(m&p^~m&v)|0)+(x+(qM[b]+this.temp[b]|0)|0)|0,A=((s>>>2|s<<30)^(s>>>13|s<<19)^(s>>>22|s<<10))+(s&i^s&c^i&c)|0;x=v,v=p,p=m,m=d+T|0,d=c,c=i,i=s,s=T+A|0}n[0]+=s,n[1]+=i,n[2]+=c,n[3]+=d,n[4]+=m,n[5]+=p,n[6]+=v,n[7]+=x},r})(),JM=(function(){function r(e){this.secret=e,this.hash=new Vv,this.reset()}return r.prototype.update=function(e){if(!(Cw(e)||this.error))try{this.hash.update(Dm(e))}catch(t){this.error=t}},r.prototype.digestSync=function(){if(this.error)throw this.error;return this.outer?(this.outer.finished||this.outer.update(this.hash.digest()),this.outer.digest()):this.hash.digest()},r.prototype.digest=function(){return BM(this,void 0,void 0,function(){return GM(this,function(e){return[2,this.digestSync()]})})},r.prototype.reset=function(){if(this.hash=new Vv,this.secret){this.outer=new Vv;var e=XM(this.secret),t=new Uint8Array(Ti);t.set(e);for(var n=0;n<Ti;n++)e[n]^=54,t[n]^=92;this.hash.update(e),this.outer.update(t);for(var n=0;n<e.byteLength;n++)e[n]=0}},r})();function XM(r){var e=Dm(r);if(e.byteLength>Ti){var t=new Vv;t.update(e),e=t.digest()}var n=new Uint8Array(Ti);return n.set(e),n}var QM=["decrypt","digest","encrypt","exportKey","generateKey","importKey","sign","verify"];function ZM(r){if(e$(r)&&typeof r.crypto.subtle=="object"){var e=r.crypto.subtle;return t$(e)}return!1}function e$(r){if(typeof r=="object"&&typeof r.crypto=="object"){var e=r.crypto.getRandomValues;return typeof e=="function"}return!1}function t$(r){return r&&QM.every(function(e){return typeof r[e]=="function"})}var T1=(function(){function r(e){ZM(Wv())?this.hash=new HM(e):this.hash=new JM(e)}return r.prototype.update=function(e,t){this.hash.update(Dm(e))},r.prototype.digest=function(){return this.hash.digest()},r.prototype.reset=function(){this.hash.reset()},r})();const A1=({serviceId:r,clientVersion:e})=>async t=>{var S,N,E;const n=typeof window<"u"?window.navigator:void 0,s=(n==null?void 0:n.userAgent)??"",i=((S=n==null?void 0:n.userAgentData)==null?void 0:S.platform)??WE.os(s)??"other",c=void 0,d=((N=n==null?void 0:n.userAgentData)==null?void 0:N.brands)??[],m=d[d.length-1],p=(m==null?void 0:m.brand)??WE.browser(s)??"unknown",v=(m==null?void 0:m.version)??"unknown",x=[["aws-sdk-js",e],["ua","2.1"],[`os/${i}`,c],["lang/js"],["md/browser",`${p}_${v}`]];r&&x.push([`api/${r}`,e]);const b=await((E=t==null?void 0:t.userAgentAppId)==null?void 0:E.call(t));return b&&x.push([`app/${b}`]),x},WE={os(r){if(/iPhone|iPad|iPod/.test(r))return"iOS";if(/Macintosh|Mac OS X/.test(r))return"macOS";if(/Windows NT/.test(r))return"Windows";if(/Android/.test(r))return"Android";if(/Linux/.test(r))return"Linux"},browser(r){if(/EdgiOS|EdgA|Edg\//.test(r))return"Microsoft Edge";if(/Firefox\//.test(r))return"Firefox";if(/Chrome\//.test(r))return"Chrome";if(/Safari\//.test(r))return"Safari"}},I1=r=>()=>Promise.reject(r),r$=["in-region","cross-region","mobile","standard","legacy"],R1=({defaultsMode:r}={})=>WD(async()=>{const e=typeof r=="function"?await r():r;switch(e==null?void 0:e.toLowerCase()){case"auto":return Promise.resolve(n$()?"mobile":"standard");case"mobile":case"in-region":case"cross-region":case"standard":case"legacy":return Promise.resolve(e==null?void 0:e.toLocaleLowerCase());case void 0:return Promise.resolve("legacy");default:throw new Error(`Invalid parameter for "defaultsMode", expect ${r$.join(", ")}, got ${e}`)}}),n$=()=>{var e;const r=window==null?void 0:window.navigator;if(r!=null&&r.connection){const{effectiveType:t,rtt:n,downlink:s}=r==null?void 0:r.connection;if(typeof t=="string"&&t!=="4g"||Number(n)>100||Number(s)<10)return!0}return((e=r==null?void 0:r.userAgentData)==null?void 0:e.mobile)||typeof(r==null?void 0:r.maxTouchPoints)=="number"&&(r==null?void 0:r.maxTouchPoints)>1},P1=(r,e=!1)=>{if(e){for(const t of r.split("."))if(!P1(t))return!1;return!0}return!(!Xm(r)||r.length<3||r.length>63||r!==r.toLowerCase()||kb(r))},VE=":",s$="/",o$=r=>{const e=r.split(VE);if(e.length<6)return null;const[t,n,s,i,c,...d]=e;if(t!=="arn"||n===""||s===""||d.join(VE)==="")return null;const m=d.map(p=>p.split(s$)).flat();return{partition:n,service:s,region:i,accountId:c,resourceId:m}},i$=[{id:"aws",outputs:{dnsSuffix:"amazonaws.com",dualStackDnsSuffix:"api.aws",implicitGlobalRegion:"us-east-1",name:"aws",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^(us|eu|ap|sa|ca|me|af|il|mx)\\-\\w+\\-\\d+$",regions:{"af-south-1":{description:"Africa (Cape Town)"},"ap-east-1":{description:"Asia Pacific (Hong Kong)"},"ap-east-2":{description:"Asia Pacific (Taipei)"},"ap-northeast-1":{description:"Asia Pacific (Tokyo)"},"ap-northeast-2":{description:"Asia Pacific (Seoul)"},"ap-northeast-3":{description:"Asia Pacific (Osaka)"},"ap-south-1":{description:"Asia Pacific (Mumbai)"},"ap-south-2":{description:"Asia Pacific (Hyderabad)"},"ap-southeast-1":{description:"Asia Pacific (Singapore)"},"ap-southeast-2":{description:"Asia Pacific (Sydney)"},"ap-southeast-3":{description:"Asia Pacific (Jakarta)"},"ap-southeast-4":{description:"Asia Pacific (Melbourne)"},"ap-southeast-5":{description:"Asia Pacific (Malaysia)"},"ap-southeast-6":{description:"Asia Pacific (New Zealand)"},"ap-southeast-7":{description:"Asia Pacific (Thailand)"},"aws-global":{description:"aws global region"},"ca-central-1":{description:"Canada (Central)"},"ca-west-1":{description:"Canada West (Calgary)"},"eu-central-1":{description:"Europe (Frankfurt)"},"eu-central-2":{description:"Europe (Zurich)"},"eu-north-1":{description:"Europe (Stockholm)"},"eu-south-1":{description:"Europe (Milan)"},"eu-south-2":{description:"Europe (Spain)"},"eu-west-1":{description:"Europe (Ireland)"},"eu-west-2":{description:"Europe (London)"},"eu-west-3":{description:"Europe (Paris)"},"il-central-1":{description:"Israel (Tel Aviv)"},"me-central-1":{description:"Middle East (UAE)"},"me-south-1":{description:"Middle East (Bahrain)"},"mx-central-1":{description:"Mexico (Central)"},"sa-east-1":{description:"South America (Sao Paulo)"},"us-east-1":{description:"US East (N. Virginia)"},"us-east-2":{description:"US East (Ohio)"},"us-west-1":{description:"US West (N. California)"},"us-west-2":{description:"US West (Oregon)"}}},{id:"aws-cn",outputs:{dnsSuffix:"amazonaws.com.cn",dualStackDnsSuffix:"api.amazonwebservices.com.cn",implicitGlobalRegion:"cn-northwest-1",name:"aws-cn",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^cn\\-\\w+\\-\\d+$",regions:{"aws-cn-global":{description:"aws-cn global region"},"cn-north-1":{description:"China (Beijing)"},"cn-northwest-1":{description:"China (Ningxia)"}}},{id:"aws-eusc",outputs:{dnsSuffix:"amazonaws.eu",dualStackDnsSuffix:"api.amazonwebservices.eu",implicitGlobalRegion:"eusc-de-east-1",name:"aws-eusc",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^eusc\\-(de)\\-\\w+\\-\\d+$",regions:{"eusc-de-east-1":{description:"AWS European Sovereign Cloud (Germany)"}}},{id:"aws-iso",outputs:{dnsSuffix:"c2s.ic.gov",dualStackDnsSuffix:"api.aws.ic.gov",implicitGlobalRegion:"us-iso-east-1",name:"aws-iso",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-iso\\-\\w+\\-\\d+$",regions:{"aws-iso-global":{description:"aws-iso global region"},"us-iso-east-1":{description:"US ISO East"},"us-iso-west-1":{description:"US ISO WEST"}}},{id:"aws-iso-b",outputs:{dnsSuffix:"sc2s.sgov.gov",dualStackDnsSuffix:"api.aws.scloud",implicitGlobalRegion:"us-isob-east-1",name:"aws-iso-b",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-isob\\-\\w+\\-\\d+$",regions:{"aws-iso-b-global":{description:"aws-iso-b global region"},"us-isob-east-1":{description:"US ISOB East (Ohio)"},"us-isob-west-1":{description:"US ISOB West"}}},{id:"aws-iso-e",outputs:{dnsSuffix:"cloud.adc-e.uk",dualStackDnsSuffix:"api.cloud-aws.adc-e.uk",implicitGlobalRegion:"eu-isoe-west-1",name:"aws-iso-e",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^eu\\-isoe\\-\\w+\\-\\d+$",regions:{"aws-iso-e-global":{description:"aws-iso-e global region"},"eu-isoe-west-1":{description:"EU ISOE West"}}},{id:"aws-iso-f",outputs:{dnsSuffix:"csp.hci.ic.gov",dualStackDnsSuffix:"api.aws.hci.ic.gov",implicitGlobalRegion:"us-isof-south-1",name:"aws-iso-f",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-isof\\-\\w+\\-\\d+$",regions:{"aws-iso-f-global":{description:"aws-iso-f global region"},"us-isof-east-1":{description:"US ISOF EAST"},"us-isof-south-1":{description:"US ISOF SOUTH"}}},{id:"aws-us-gov",outputs:{dnsSuffix:"amazonaws.com",dualStackDnsSuffix:"api.aws",implicitGlobalRegion:"us-gov-west-1",name:"aws-us-gov",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-gov\\-\\w+\\-\\d+$",regions:{"aws-us-gov-global":{description:"aws-us-gov global region"},"us-gov-east-1":{description:"AWS GovCloud (US-East)"},"us-gov-west-1":{description:"AWS GovCloud (US-West)"}}}],a$={partitions:i$};let l$=a$;const c$=r=>{const{partitions:e}=l$;for(const n of e){const{regions:s,outputs:i}=n;for(const[c,d]of Object.entries(s))if(c===r)return{...i,...d}}for(const n of e){const{regionRegex:s,outputs:i}=n;if(new RegExp(s).test(r))return{...i}}const t=e.find(n=>n.id==="aws");if(!t)throw new Error("Provided region was not found in the partition array or regex, and default partition with id 'aws' doesn't exist.");return{...t.outputs}},Rb={isVirtualHostableS3Bucket:P1,parseArn:o$,partition:c$};dh.aws=Rb;const j1="required",$s="fn",Us="argv",vh="ref",qE=!0,KE="isSet",Lm="booleanEquals",Lf="error",Ma="endpoint",Pl="tree",Pb="PartitionResult",jb="getAttr",Hp="stringEquals",YE={[j1]:!1,type:"string"},JE={[j1]:!0,default:!1,type:"boolean"},XE={[vh]:"Endpoint"},F1={[$s]:Lm,[Us]:[{[vh]:"UseFIPS"},!0]},O1={[$s]:Lm,[Us]:[{[vh]:"UseDualStack"},!0]},Dn={},dm={[vh]:"Region"},QE={[$s]:jb,[Us]:[{[vh]:Pb},"supportsFIPS"]},D1={[vh]:Pb},ZE={[$s]:Lm,[Us]:[!0,{[$s]:jb,[Us]:[D1,"supportsDualStack"]}]},ek=[F1],tk=[O1],rk=[dm],u$={parameters:{Region:YE,UseDualStack:JE,UseFIPS:JE,Endpoint:YE},rules:[{conditions:[{[$s]:KE,[Us]:[XE]}],rules:[{conditions:ek,error:"Invalid Configuration: FIPS and custom endpoint are not supported",type:Lf},{conditions:tk,error:"Invalid Configuration: Dualstack and custom endpoint are not supported",type:Lf},{endpoint:{url:XE,properties:Dn,headers:Dn},type:Ma}],type:Pl},{conditions:[{[$s]:KE,[Us]:rk}],rules:[{conditions:[{[$s]:"aws.partition",[Us]:rk,assign:Pb}],rules:[{conditions:[F1,O1],rules:[{conditions:[{[$s]:Lm,[Us]:[qE,QE]},ZE],rules:[{conditions:[{[$s]:Hp,[Us]:[dm,"us-east-1"]}],endpoint:{url:"https://cognito-idp-fips.us-east-1.amazonaws.com",properties:Dn,headers:Dn},type:Ma},{conditions:[{[$s]:Hp,[Us]:[dm,"us-east-2"]}],endpoint:{url:"https://cognito-idp-fips.us-east-2.amazonaws.com",properties:Dn,headers:Dn},type:Ma},{conditions:[{[$s]:Hp,[Us]:[dm,"us-west-1"]}],endpoint:{url:"https://cognito-idp-fips.us-west-1.amazonaws.com",properties:Dn,headers:Dn},type:Ma},{conditions:[{[$s]:Hp,[Us]:[dm,"us-west-2"]}],endpoint:{url:"https://cognito-idp-fips.us-west-2.amazonaws.com",properties:Dn,headers:Dn},type:Ma},{endpoint:{url:"https://cognito-idp-fips.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:Dn,headers:Dn},type:Ma}],type:Pl},{error:"FIPS and DualStack are enabled, but this partition does not support one or both",type:Lf}],type:Pl},{conditions:ek,rules:[{conditions:[{[$s]:Lm,[Us]:[QE,qE]}],rules:[{endpoint:{url:"https://cognito-idp-fips.{Region}.{PartitionResult#dnsSuffix}",properties:Dn,headers:Dn},type:Ma}],type:Pl},{error:"FIPS is enabled but this partition does not support FIPS",type:Lf}],type:Pl},{conditions:tk,rules:[{conditions:[ZE],rules:[{conditions:[{[$s]:Hp,[Us]:["aws",{[$s]:jb,[Us]:[D1,"name"]}]}],endpoint:{url:"https://cognito-idp.{Region}.amazonaws.com",properties:Dn,headers:Dn},type:Ma},{endpoint:{url:"https://cognito-idp.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:Dn,headers:Dn},type:Ma}],type:Pl},{error:"DualStack is enabled but this partition does not support DualStack",type:Lf}],type:Pl},{endpoint:{url:"https://cognito-idp.{Region}.{PartitionResult#dnsSuffix}",properties:Dn,headers:Dn},type:Ma}],type:Pl}],type:Pl},{error:"Invalid Configuration: Missing Region",type:Lf}]},d$=u$,f$=new LN({size:50,params:["Endpoint","Region","UseDualStack","UseFIPS"]}),h$=(r,e={})=>f$.get(r,()=>qN(d$,{endpointParams:r,logger:e.logger}));dh.aws=Rb;const p$=r=>({apiVersion:"2016-04-18",base64Decoder:(r==null?void 0:r.base64Decoder)??Jm,base64Encoder:(r==null?void 0:r.base64Encoder)??Rm,disableHostPrefix:(r==null?void 0:r.disableHostPrefix)??!1,endpointProvider:(r==null?void 0:r.endpointProvider)??h$,extensions:(r==null?void 0:r.extensions)??[],httpAuthSchemeProvider:(r==null?void 0:r.httpAuthSchemeProvider)??PM,httpAuthSchemes:(r==null?void 0:r.httpAuthSchemes)??[{schemeId:"aws.auth#sigv4",identityProvider:e=>e.getIdentityProvider("aws.auth#sigv4"),signer:new JN},{schemeId:"smithy.api#noAuth",identityProvider:e=>e.getIdentityProvider("smithy.api#noAuth")||(async()=>({})),signer:new FN}],logger:(r==null?void 0:r.logger)??new Tb,protocol:(r==null?void 0:r.protocol)??u1,protocolSettings:(r==null?void 0:r.protocolSettings)??{defaultNamespace:"com.amazonaws.cognitoidentityprovider",xmlNamespace:"http://cognito-idp.amazonaws.com/doc/2016-04-18/",version:"2016-04-18",serviceTarget:"AWSCognitoIdentityProviderService"},serviceId:(r==null?void 0:r.serviceId)??"Cognito Identity Provider",urlParser:(r==null?void 0:r.urlParser)??Fm,utf8Decoder:(r==null?void 0:r.utf8Decoder)??cd,utf8Encoder:(r==null?void 0:r.utf8Encoder)??Ly}),m$=r=>{const e=R1(r),t=()=>e().then(a1),n=p$(r);return{...n,...r,runtime:"browser",defaultsMode:e,bodyLengthChecker:(r==null?void 0:r.bodyLengthChecker)??s1,credentialDefaultProvider:(r==null?void 0:r.credentialDefaultProvider)??(s=>()=>Promise.reject(new Error("Credential is missing"))),defaultUserAgentProvider:(r==null?void 0:r.defaultUserAgentProvider)??A1({serviceId:n.serviceId,clientVersion:LM.version}),maxAttempts:(r==null?void 0:r.maxAttempts)??Om,region:(r==null?void 0:r.region)??I1("Region is missing"),requestHandler:My.create((r==null?void 0:r.requestHandler)??t),retryMode:(r==null?void 0:r.retryMode)??(async()=>(await t()).retryMode||w1),sha256:(r==null?void 0:r.sha256)??T1,streamCollector:(r==null?void 0:r.streamCollector)??CN,useDualstackEndpoint:(r==null?void 0:r.useDualstackEndpoint)??(()=>Promise.resolve(f1)),useFipsEndpoint:(r==null?void 0:r.useFipsEndpoint)??(()=>Promise.resolve(h1))}},L1=r=>({setRegion(e){r.region=e},region(){return r.region}}),M1=r=>({region:r.region()}),g$=r=>{const e=r.httpAuthSchemes;let t=r.httpAuthSchemeProvider,n=r.credentials;return{setHttpAuthScheme(s){const i=e.findIndex(c=>c.schemeId===s.schemeId);i===-1?e.push(s):e.splice(i,1,s)},httpAuthSchemes(){return e},setHttpAuthSchemeProvider(s){t=s},httpAuthSchemeProvider(){return t},setCredentials(s){n=s},credentials(){return n}}},v$=r=>({httpAuthSchemes:r.httpAuthSchemes(),httpAuthSchemeProvider:r.httpAuthSchemeProvider(),credentials:r.credentials()}),y$=(r,e)=>{const t=Object.assign(L1(r),l1(r),yN(r),g$(r));return e.forEach(n=>n.configure(t)),Object.assign(r,M1(t),c1(t),xN(t),v$(t))};class Fb extends o1{constructor(...[t]){const n=m$(t||{});super(n);z(this,"config");this.initConfig=n;const s=FM(n),i=DN(s),c=E1(i),d=m1(c),m=d,p=x1(m),v=jM(p),x=y$(v,(t==null?void 0:t.extensions)||[]);this.config=x,this.middlewareStack.use(AN(this.config)),this.middlewareStack.use(d1(this.config)),this.middlewareStack.use(k1(this.config)),this.middlewareStack.use(g1(this.config)),this.middlewareStack.use(wN(this.config)),this.middlewareStack.use(bN(this.config)),this.middlewareStack.use(_N(this.config)),this.middlewareStack.use(SN(this.config,{httpAuthSchemeParametersProvider:IM,identityProviderConfigProvider:async b=>new jN({"aws.auth#sigv4":b.credentials})})),this.middlewareStack.use(EN(this.config))}destroy(){super.destroy()}}class Et extends Kf{constructor(e){super(e),Object.setPrototypeOf(this,Et.prototype)}}class Ob extends Et{constructor(t){super({name:"InternalErrorException",$fault:"server",...t});z(this,"name","InternalErrorException");z(this,"$fault","server");Object.setPrototypeOf(this,Ob.prototype)}}class Db extends Et{constructor(t){super({name:"InvalidParameterException",$fault:"client",...t});z(this,"name","InvalidParameterException");z(this,"$fault","client");z(this,"reasonCode");Object.setPrototypeOf(this,Db.prototype),this.reasonCode=t.reasonCode}}class Lb extends Et{constructor(t){super({name:"NotAuthorizedException",$fault:"client",...t});z(this,"name","NotAuthorizedException");z(this,"$fault","client");Object.setPrototypeOf(this,Lb.prototype)}}class Mb extends Et{constructor(t){super({name:"ResourceNotFoundException",$fault:"client",...t});z(this,"name","ResourceNotFoundException");z(this,"$fault","client");Object.setPrototypeOf(this,Mb.prototype)}}class $b extends Et{constructor(t){super({name:"TooManyRequestsException",$fault:"client",...t});z(this,"name","TooManyRequestsException");z(this,"$fault","client");Object.setPrototypeOf(this,$b.prototype)}}class Ub extends Et{constructor(t){super({name:"UserImportInProgressException",$fault:"client",...t});z(this,"name","UserImportInProgressException");z(this,"$fault","client");Object.setPrototypeOf(this,Ub.prototype)}}class zb extends Et{constructor(t){super({name:"UserNotFoundException",$fault:"client",...t});z(this,"name","UserNotFoundException");z(this,"$fault","client");Object.setPrototypeOf(this,zb.prototype)}}class Hb extends Et{constructor(t){super({name:"InvalidLambdaResponseException",$fault:"client",...t});z(this,"name","InvalidLambdaResponseException");z(this,"$fault","client");Object.setPrototypeOf(this,Hb.prototype)}}class Bb extends Et{constructor(t){super({name:"LimitExceededException",$fault:"client",...t});z(this,"name","LimitExceededException");z(this,"$fault","client");Object.setPrototypeOf(this,Bb.prototype)}}class Gb extends Et{constructor(t){super({name:"TooManyFailedAttemptsException",$fault:"client",...t});z(this,"name","TooManyFailedAttemptsException");z(this,"$fault","client");Object.setPrototypeOf(this,Gb.prototype)}}class Wb extends Et{constructor(t){super({name:"UnexpectedLambdaException",$fault:"client",...t});z(this,"name","UnexpectedLambdaException");z(this,"$fault","client");Object.setPrototypeOf(this,Wb.prototype)}}class Vb extends Et{constructor(t){super({name:"UserLambdaValidationException",$fault:"client",...t});z(this,"name","UserLambdaValidationException");z(this,"$fault","client");Object.setPrototypeOf(this,Vb.prototype)}}class qb extends Et{constructor(t){super({name:"CodeDeliveryFailureException",$fault:"client",...t});z(this,"name","CodeDeliveryFailureException");z(this,"$fault","client");Object.setPrototypeOf(this,qb.prototype)}}class Kb extends Et{constructor(t){super({name:"InvalidPasswordException",$fault:"client",...t});z(this,"name","InvalidPasswordException");z(this,"$fault","client");Object.setPrototypeOf(this,Kb.prototype)}}class Yb extends Et{constructor(t){super({name:"InvalidSmsRoleAccessPolicyException",$fault:"client",...t});z(this,"name","InvalidSmsRoleAccessPolicyException");z(this,"$fault","client");Object.setPrototypeOf(this,Yb.prototype)}}class Jb extends Et{constructor(t){super({name:"InvalidSmsRoleTrustRelationshipException",$fault:"client",...t});z(this,"name","InvalidSmsRoleTrustRelationshipException");z(this,"$fault","client");Object.setPrototypeOf(this,Jb.prototype)}}class Xb extends Et{constructor(t){super({name:"PreconditionNotMetException",$fault:"client",...t});z(this,"name","PreconditionNotMetException");z(this,"$fault","client");Object.setPrototypeOf(this,Xb.prototype)}}class Qb extends Et{constructor(t){super({name:"UnsupportedUserStateException",$fault:"client",...t});z(this,"name","UnsupportedUserStateException");z(this,"$fault","client");Object.setPrototypeOf(this,Qb.prototype)}}class Zb extends Et{constructor(t){super({name:"UsernameExistsException",$fault:"client",...t});z(this,"name","UsernameExistsException");z(this,"$fault","client");Object.setPrototypeOf(this,Zb.prototype)}}class e_ extends Et{constructor(t){super({name:"AliasExistsException",$fault:"client",...t});z(this,"name","AliasExistsException");z(this,"$fault","client");Object.setPrototypeOf(this,e_.prototype)}}class t_ extends Et{constructor(t){super({name:"InvalidUserPoolConfigurationException",$fault:"client",...t});z(this,"name","InvalidUserPoolConfigurationException");z(this,"$fault","client");Object.setPrototypeOf(this,t_.prototype)}}class r_ extends Et{constructor(t){super({name:"InvalidEmailRoleAccessPolicyException",$fault:"client",...t});z(this,"name","InvalidEmailRoleAccessPolicyException");z(this,"$fault","client");Object.setPrototypeOf(this,r_.prototype)}}class n_ extends Et{constructor(t){super({name:"MFAMethodNotFoundException",$fault:"client",...t});z(this,"name","MFAMethodNotFoundException");z(this,"$fault","client");Object.setPrototypeOf(this,n_.prototype)}}class s_ extends Et{constructor(t){super({name:"PasswordResetRequiredException",$fault:"client",...t});z(this,"name","PasswordResetRequiredException");z(this,"$fault","client");Object.setPrototypeOf(this,s_.prototype)}}class o_ extends Et{constructor(t){super({name:"UnsupportedOperationException",$fault:"client",...t});z(this,"name","UnsupportedOperationException");z(this,"$fault","client");Object.setPrototypeOf(this,o_.prototype)}}class i_ extends Et{constructor(t){super({name:"UserNotConfirmedException",$fault:"client",...t});z(this,"name","UserNotConfirmedException");z(this,"$fault","client");Object.setPrototypeOf(this,i_.prototype)}}class a_ extends Et{constructor(t){super({name:"UserPoolAddOnNotEnabledException",$fault:"client",...t});z(this,"name","UserPoolAddOnNotEnabledException");z(this,"$fault","client");Object.setPrototypeOf(this,a_.prototype)}}class l_ extends Et{constructor(t){super({name:"CodeMismatchException",$fault:"client",...t});z(this,"name","CodeMismatchException");z(this,"$fault","client");Object.setPrototypeOf(this,l_.prototype)}}class c_ extends Et{constructor(t){super({name:"ExpiredCodeException",$fault:"client",...t});z(this,"name","ExpiredCodeException");z(this,"$fault","client");Object.setPrototypeOf(this,c_.prototype)}}class u_ extends Et{constructor(t){super({name:"PasswordHistoryPolicyViolationException",$fault:"client",...t});z(this,"name","PasswordHistoryPolicyViolationException");z(this,"$fault","client");Object.setPrototypeOf(this,u_.prototype)}}class d_ extends Et{constructor(t){super({name:"SoftwareTokenMFANotFoundException",$fault:"client",...t});z(this,"name","SoftwareTokenMFANotFoundException");z(this,"$fault","client");Object.setPrototypeOf(this,d_.prototype)}}class f_ extends Et{constructor(t){super({name:"ConcurrentModificationException",$fault:"client",...t});z(this,"name","ConcurrentModificationException");z(this,"$fault","client");Object.setPrototypeOf(this,f_.prototype)}}class h_ extends Et{constructor(t){super({name:"ForbiddenException",$fault:"client",...t});z(this,"name","ForbiddenException");z(this,"$fault","client");Object.setPrototypeOf(this,h_.prototype)}}class p_ extends Et{constructor(t){super({name:"WebAuthnChallengeNotFoundException",$fault:"client",...t});z(this,"name","WebAuthnChallengeNotFoundException");z(this,"$fault","client");Object.setPrototypeOf(this,p_.prototype)}}class m_ extends Et{constructor(t){super({name:"WebAuthnClientMismatchException",$fault:"client",...t});z(this,"name","WebAuthnClientMismatchException");z(this,"$fault","client");Object.setPrototypeOf(this,m_.prototype)}}class g_ extends Et{constructor(t){super({name:"WebAuthnCredentialNotSupportedException",$fault:"client",...t});z(this,"name","WebAuthnCredentialNotSupportedException");z(this,"$fault","client");Object.setPrototypeOf(this,g_.prototype)}}class v_ extends Et{constructor(t){super({name:"WebAuthnNotEnabledException",$fault:"client",...t});z(this,"name","WebAuthnNotEnabledException");z(this,"$fault","client");Object.setPrototypeOf(this,v_.prototype)}}class y_ extends Et{constructor(t){super({name:"WebAuthnOriginNotAllowedException",$fault:"client",...t});z(this,"name","WebAuthnOriginNotAllowedException");z(this,"$fault","client");Object.setPrototypeOf(this,y_.prototype)}}class x_ extends Et{constructor(t){super({name:"WebAuthnRelyingPartyMismatchException",$fault:"client",...t});z(this,"name","WebAuthnRelyingPartyMismatchException");z(this,"$fault","client");Object.setPrototypeOf(this,x_.prototype)}}class w_ extends Et{constructor(t){super({name:"DeviceKeyExistsException",$fault:"client",...t});z(this,"name","DeviceKeyExistsException");z(this,"$fault","client");Object.setPrototypeOf(this,w_.prototype)}}class b_ extends Et{constructor(t){super({name:"GroupExistsException",$fault:"client",...t});z(this,"name","GroupExistsException");z(this,"$fault","client");Object.setPrototypeOf(this,b_.prototype)}}class __ extends Et{constructor(t){super({name:"DuplicateProviderException",$fault:"client",...t});z(this,"name","DuplicateProviderException");z(this,"$fault","client");Object.setPrototypeOf(this,__.prototype)}}class S_ extends Et{constructor(t){super({name:"ManagedLoginBrandingExistsException",$fault:"client",...t});z(this,"name","ManagedLoginBrandingExistsException");z(this,"$fault","client");Object.setPrototypeOf(this,S_.prototype)}}class E_ extends Et{constructor(t){super({name:"TermsExistsException",$fault:"client",...t});z(this,"name","TermsExistsException");z(this,"$fault","client");Object.setPrototypeOf(this,E_.prototype)}}class k_ extends Et{constructor(t){super({name:"FeatureUnavailableInTierException",$fault:"client",...t});z(this,"name","FeatureUnavailableInTierException");z(this,"$fault","client");Object.setPrototypeOf(this,k_.prototype)}}class C_ extends Et{constructor(t){super({name:"TierChangeNotAllowedException",$fault:"client",...t});z(this,"name","TierChangeNotAllowedException");z(this,"$fault","client");Object.setPrototypeOf(this,C_.prototype)}}class N_ extends Et{constructor(t){super({name:"UserPoolTaggingException",$fault:"client",...t});z(this,"name","UserPoolTaggingException");z(this,"$fault","client");Object.setPrototypeOf(this,N_.prototype)}}class T_ extends Et{constructor(t){super({name:"InvalidOAuthFlowException",$fault:"client",...t});z(this,"name","InvalidOAuthFlowException");z(this,"$fault","client");Object.setPrototypeOf(this,T_.prototype)}}class A_ extends Et{constructor(t){super({name:"ScopeDoesNotExistException",$fault:"client",...t});z(this,"name","ScopeDoesNotExistException");z(this,"$fault","client");Object.setPrototypeOf(this,A_.prototype)}}class I_ extends Et{constructor(t){super({name:"UnsupportedIdentityProviderException",$fault:"client",...t});z(this,"name","UnsupportedIdentityProviderException");z(this,"$fault","client");Object.setPrototypeOf(this,I_.prototype)}}class R_ extends Et{constructor(t){super({name:"RefreshTokenReuseException",$fault:"client",...t});z(this,"name","RefreshTokenReuseException");z(this,"$fault","client");Object.setPrototypeOf(this,R_.prototype)}}class P_ extends Et{constructor(t){super({name:"UnauthorizedException",$fault:"client",...t});z(this,"name","UnauthorizedException");z(this,"$fault","client");Object.setPrototypeOf(this,P_.prototype)}}class j_ extends Et{constructor(t){super({name:"UnsupportedTokenTypeException",$fault:"client",...t});z(this,"name","UnsupportedTokenTypeException");z(this,"$fault","client");Object.setPrototypeOf(this,j_.prototype)}}class F_ extends Et{constructor(t){super({name:"WebAuthnConfigurationMissingException",$fault:"client",...t});z(this,"name","WebAuthnConfigurationMissingException");z(this,"$fault","client");Object.setPrototypeOf(this,F_.prototype)}}class O_ extends Et{constructor(t){super({name:"EnableSoftwareTokenMFAException",$fault:"client",...t});z(this,"name","EnableSoftwareTokenMFAException");z(this,"$fault","client");Object.setPrototypeOf(this,O_.prototype)}}const x$="AvailableChallenges",w$="AliasExistsException",b$="AnalyticsEndpointId",_$="AuthFlow",S$="AnalyticsMetadata",E$="AnalyticsMetadataType",k$="AuthParameters",C$="AuthParametersType",N$="AuthenticationResult",T$="AuthenticationResultType",A$="AccessToken",I$="CodeDeliveryFailureException",R$="ClientId",P$="ClientIdType",j$="ClientMetadata",F$="CodeMismatchException",O$="ConcurrentModificationException",D$="ChallengeName",L$="ChallengeParameters",M$="DeviceGroupKey",$$="DeviceKey",U$="DeviceKeyExistsException",z$="DuplicateProviderException",H$="ExpiredCodeException",B$="EncodedData",G$="ExpiresIn",W$="EnableSoftwareTokenMFAException",V$="ForbiddenException",q$="FeatureUnavailableInTierException",K$="GroupExistsException",Y$="IpAddress",J$="InitiateAuthRequest",X$="InitiateAuthResponse",Q$="InitiateAuth",Z$="InternalErrorException",e4="InvalidEmailRoleAccessPolicyException",t4="InvalidLambdaResponseException",r4="InvalidOAuthFlowException",n4="InvalidParameterException",s4="InvalidPasswordException",o4="InvalidSmsRoleAccessPolicyException",i4="InvalidSmsRoleTrustRelationshipException",a4="IdToken",l4="InvalidUserPoolConfigurationException",c4="LimitExceededException",u4="MFAMethodNotFoundException",d4="ManagedLoginBrandingExistsException",f4="NotAuthorizedException",h4="NewDeviceMetadata",p4="NewDeviceMetadataType",m4="PasswordHistoryPolicyViolationException",g4="PreconditionNotMetException",v4="PasswordResetRequiredException",y4="ResourceNotFoundException",x4="RefreshToken",w4="RefreshTokenReuseException",$1="Session",b4="ScopeDoesNotExistException",_4="SessionType",S4="SoftwareTokenMFANotFoundException",E4="TierChangeNotAllowedException",k4="TermsExistsException",C4="TooManyFailedAttemptsException",N4="TooManyRequestsException",T4="TokenModelType",A4="TokenType",I4="UserContextDataType",R4="UserContextData",P4="UnauthorizedException",j4="UsernameExistsException",F4="UserImportInProgressException",O4="UnsupportedIdentityProviderException",D4="UnexpectedLambdaException",L4="UserLambdaValidationException",M4="UserNotConfirmedException",$4="UserNotFoundException",U4="UnsupportedOperationException",z4="UserPoolAddOnNotEnabledException",H4="UserPoolTaggingException",B4="UnsupportedTokenTypeException",G4="UnsupportedUserStateException",W4="WebAuthnClientMismatchException",V4="WebAuthnConfigurationMissingException",q4="WebAuthnChallengeNotFoundException",K4="WebAuthnCredentialNotSupportedException",Y4="WebAuthnNotEnabledException",J4="WebAuthnOriginNotAllowedException",X4="WebAuthnRelyingPartyMismatchException",Dt="client",Rt="error",Lt="httpError",Pt="message",Q4="reasonCode",Z4="server",U1="smithy.ts.sdk.synthetic.com.amazonaws.cognitoidentityprovider",Ae="com.amazonaws.cognitoidentityprovider";var e3=[0,Ae,P$,8,0],z1=[0,Ae,_4,8,0],Sx=[0,Ae,T4,8,0],t3=[-3,Ae,w$,{[Rt]:Dt,[Lt]:400},[Pt],[0]];xt.for(Ae).registerError(t3,e_);var r3=[3,Ae,E$,0,[b$],[0]],n3=[3,Ae,T$,0,[A$,G$,A4,x4,a4,h4],[[()=>Sx,0],1,0,[()=>Sx,0],[()=>Sx,0],()=>T3]],s3=[-3,Ae,I$,{[Rt]:Dt,[Lt]:400},[Pt],[0]];xt.for(Ae).registerError(s3,qb);var o3=[-3,Ae,F$,{[Rt]:Dt,[Lt]:400},[Pt],[0]];xt.for(Ae).registerError(o3,l_);var i3=[-3,Ae,O$,{[Rt]:Dt,[Lt]:400},[Pt],[0]];xt.for(Ae).registerError(i3,f_);var a3=[-3,Ae,U$,{[Rt]:Dt,[Lt]:400},[Pt],[0]];xt.for(Ae).registerError(a3,w_);var l3=[-3,Ae,z$,{[Rt]:Dt,[Lt]:400},[Pt],[0]];xt.for(Ae).registerError(l3,__);var c3=[-3,Ae,W$,{[Rt]:Dt,[Lt]:400},[Pt],[0]];xt.for(Ae).registerError(c3,O_);var u3=[-3,Ae,H$,{[Rt]:Dt,[Lt]:400},[Pt],[0]];xt.for(Ae).registerError(u3,c_);var d3=[-3,Ae,q$,{[Rt]:Dt,[Lt]:403},[Pt],[0]];xt.for(Ae).registerError(d3,k_);var f3=[-3,Ae,V$,{[Rt]:Dt,[Lt]:403},[Pt],[0]];xt.for(Ae).registerError(f3,h_);var h3=[-3,Ae,K$,{[Rt]:Dt,[Lt]:400},[Pt],[0]];xt.for(Ae).registerError(h3,b_);var p3=[3,Ae,J$,0,[_$,R$,k$,j$,S$,R4,$1],[0,[()=>e3,0],[()=>cU,0],128,()=>r3,[()=>q3,0],[()=>z1,0]],2],m3=[3,Ae,X$,0,[D$,$1,L$,N$,x$],[0,[()=>z1,0],128,[()=>n3,0],64]],g3=[-3,Ae,Z$,{[Rt]:Z4},[Pt],[0]];xt.for(Ae).registerError(g3,Ob);var v3=[-3,Ae,e4,{[Rt]:Dt,[Lt]:400},[Pt],[0]];xt.for(Ae).registerError(v3,r_);var y3=[-3,Ae,t4,{[Rt]:Dt,[Lt]:400},[Pt],[0]];xt.for(Ae).registerError(y3,Hb);var x3=[-3,Ae,r4,{[Rt]:Dt,[Lt]:400},[Pt],[0]];xt.for(Ae).registerError(x3,T_);var w3=[-3,Ae,n4,{[Rt]:Dt,[Lt]:400},[Pt,Q4],[0,0]];xt.for(Ae).registerError(w3,Db);var b3=[-3,Ae,s4,{[Rt]:Dt,[Lt]:400},[Pt],[0]];xt.for(Ae).registerError(b3,Kb);var _3=[-3,Ae,o4,{[Rt]:Dt,[Lt]:400},[Pt],[0]];xt.for(Ae).registerError(_3,Yb);var S3=[-3,Ae,i4,{[Rt]:Dt,[Lt]:400},[Pt],[0]];xt.for(Ae).registerError(S3,Jb);var E3=[-3,Ae,l4,{[Rt]:Dt,[Lt]:400},[Pt],[0]];xt.for(Ae).registerError(E3,t_);var k3=[-3,Ae,c4,{[Rt]:Dt,[Lt]:400},[Pt],[0]];xt.for(Ae).registerError(k3,Bb);var C3=[-3,Ae,d4,{[Rt]:Dt,[Lt]:400},[Pt],[0]];xt.for(Ae).registerError(C3,S_);var N3=[-3,Ae,u4,{[Rt]:Dt,[Lt]:400},[Pt],[0]];xt.for(Ae).registerError(N3,n_);var T3=[3,Ae,p4,0,[$$,M$],[0,0]],A3=[-3,Ae,f4,{[Rt]:Dt,[Lt]:403},[Pt],[0]];xt.for(Ae).registerError(A3,Lb);var I3=[-3,Ae,m4,{[Rt]:Dt,[Lt]:400},[Pt],[0]];xt.for(Ae).registerError(I3,u_);var R3=[-3,Ae,v4,{[Rt]:Dt,[Lt]:400},[Pt],[0]];xt.for(Ae).registerError(R3,s_);var P3=[-3,Ae,g4,{[Rt]:Dt,[Lt]:400},[Pt],[0]];xt.for(Ae).registerError(P3,Xb);var j3=[-3,Ae,w4,{[Rt]:Dt,[Lt]:400},[Pt],[0]];xt.for(Ae).registerError(j3,R_);var F3=[-3,Ae,y4,{[Rt]:Dt,[Lt]:404},[Pt],[0]];xt.for(Ae).registerError(F3,Mb);var O3=[-3,Ae,b4,{[Rt]:Dt,[Lt]:400},[Pt],[0]];xt.for(Ae).registerError(O3,A_);var D3=[-3,Ae,S4,{[Rt]:Dt,[Lt]:400},[Pt],[0]];xt.for(Ae).registerError(D3,d_);var L3=[-3,Ae,k4,{[Rt]:Dt,[Lt]:400},[Pt],[0]];xt.for(Ae).registerError(L3,E_);var M3=[-3,Ae,E4,{[Rt]:Dt,[Lt]:403},[Pt],[0]];xt.for(Ae).registerError(M3,C_);var $3=[-3,Ae,C4,{[Rt]:Dt,[Lt]:400},[Pt],[0]];xt.for(Ae).registerError($3,Gb);var U3=[-3,Ae,N4,{[Rt]:Dt,[Lt]:429},[Pt],[0]];xt.for(Ae).registerError(U3,$b);var z3=[-3,Ae,P4,{[Rt]:Dt,[Lt]:401},[Pt],[0]];xt.for(Ae).registerError(z3,P_);var H3=[-3,Ae,D4,{[Rt]:Dt,[Lt]:400},[Pt],[0]];xt.for(Ae).registerError(H3,Wb);var B3=[-3,Ae,O4,{[Rt]:Dt,[Lt]:400},[Pt],[0]];xt.for(Ae).registerError(B3,I_);var G3=[-3,Ae,U4,{[Rt]:Dt,[Lt]:400},[Pt],[0]];xt.for(Ae).registerError(G3,o_);var W3=[-3,Ae,B4,{[Rt]:Dt,[Lt]:400},[Pt],[0]];xt.for(Ae).registerError(W3,j_);var V3=[-3,Ae,G4,{[Rt]:Dt,[Lt]:400},[Pt],[0]];xt.for(Ae).registerError(V3,Qb);var q3=[3,Ae,I4,8,[Y$,B$],[0,0]],K3=[-3,Ae,F4,{[Rt]:Dt,[Lt]:400},[Pt],[0]];xt.for(Ae).registerError(K3,Ub);var Y3=[-3,Ae,L4,{[Rt]:Dt,[Lt]:400},[Pt],[0]];xt.for(Ae).registerError(Y3,Vb);var J3=[-3,Ae,j4,{[Rt]:Dt,[Lt]:400},[Pt],[0]];xt.for(Ae).registerError(J3,Zb);var X3=[-3,Ae,M4,{[Rt]:Dt,[Lt]:400},[Pt],[0]];xt.for(Ae).registerError(X3,i_);var Q3=[-3,Ae,$4,{[Rt]:Dt,[Lt]:404},[Pt],[0]];xt.for(Ae).registerError(Q3,zb);var Z3=[-3,Ae,z4,{[Rt]:Dt,[Lt]:400},[Pt],[0]];xt.for(Ae).registerError(Z3,a_);var eU=[-3,Ae,H4,{[Rt]:Dt,[Lt]:400},[Pt],[0]];xt.for(Ae).registerError(eU,N_);var tU=[-3,Ae,q4,{[Rt]:Dt,[Lt]:400},[Pt],[0]];xt.for(Ae).registerError(tU,p_);var rU=[-3,Ae,W4,{[Rt]:Dt,[Lt]:400},[Pt],[0]];xt.for(Ae).registerError(rU,m_);var nU=[-3,Ae,V4,{[Rt]:Dt,[Lt]:400},[Pt],[0]];xt.for(Ae).registerError(nU,F_);var sU=[-3,Ae,K4,{[Rt]:Dt,[Lt]:400},[Pt],[0]];xt.for(Ae).registerError(sU,g_);var oU=[-3,Ae,Y4,{[Rt]:Dt,[Lt]:400},[Pt],[0]];xt.for(Ae).registerError(oU,v_);var iU=[-3,Ae,J4,{[Rt]:Dt,[Lt]:400},[Pt],[0]];xt.for(Ae).registerError(iU,y_);var aU=[-3,Ae,X4,{[Rt]:Dt,[Lt]:400},[Pt],[0]];xt.for(Ae).registerError(aU,x_);var lU=[-3,U1,"CognitoIdentityProviderServiceException",0,[],[]];xt.for(U1).registerError(lU,Et);var cU=[2,Ae,C$,8,0,0],uU=[9,Ae,Q$,0,()=>p3,()=>m3];class D_ extends i1.classBuilder().ep(OM).m(function(e,t,n,s){return[sM(n,e.getEndpointParameterInstructions())]}).s("AWSCognitoIdentityProviderService","InitiateAuth",{}).n("CognitoIdentityProviderClient","InitiateAuthCommand").sc(uU).build(){}const dU="0.0.0",H1="staging",fU="outlook-addin",hU="staging-outlook-app-id",pU="https://candle-ai.github.io/FileServer_Staging/dist-outlook-addin/manifest.xml",mU="https://appsforoffice.microsoft.com/lib/1/hosted/office.js",gU="https://candle-ai.github.io/FileServer_Staging/dist-outlook-addin/src/apps/outlook-addin/auth-dialog-pkce.html",vU=!0,Nw="https://candle-ai.github.io/FileServer_Staging/dist-outlook-addin/src/apps/outlook-addin/auth-dialog-pkce.html?callback=true",yU="https://candle-ai.github.io/FileServer_Staging/dist-outlook-addin/options",L_="https://candle-ai.github.io/FileServer_Staging/dist-outlook-addin/auth/gmail/callback",Ar="https://vixpby8nfc.execute-api.us-east-1.amazonaws.com/prod",xU="https://vixpby8nfc.execute-api.us-east-1.amazonaws.com/prod",B1="https://candle-ai.github.io/FileServer_Staging/dist-outlook-addin",G1="https://candle-565393026129-us-east-1.auth.us-east-1.amazoncognito.com",yh="22pj09tqppmia7sh207a3ufaq9",W1=r=>`${G1}/login?client_id=${yh}&response_type=code&scope=email+openid+profile&redirect_uri=${r}`,V1="https://candle-565393026129-us-east-1.auth.us-east-1.amazoncognito.com/oauth2/token",wU="https://candle-565393026129-us-east-1.auth.us-east-1.amazoncognito.com/oauth2/userInfo",eh="https://app.staging.trycandle.ai",q1="https://forms.gle/QFFz1rbFVmwJ96At6",bU="00db376f-0fb4-48b3-8844-c2cb1ba88920",K1="https://accounts.google.com/o/oauth2",Y1="74023389454-6cal15ik3pu0p55rm5mr3go8kgro0gv8.apps.googleusercontent.com",M_=r=>`${K1}/auth?client_id=${Y1}&redirect_uri=${r}&response_type=code&scope=https://www.googleapis.com/auth/gmail.modify&access_type=offline&prompt=consent`,$_="https://vixpby8nfc.execute-api.us-east-1.amazonaws.com/prod/oauth/login/",Tw="phc_RZCAfsv2zW9fB7Pdb8b50InaGRQJl7f8DPbD1lkxmZP",J1="https://us.i.posthog.com",_U="outlook",X1="staging",Q1={buildTime:"2026-03-01T22:23:48.375Z",environment:"staging",configSource:"outlook_config.tsx",authMethod:"PKCE"},SU=Object.freeze(Object.defineProperty({__proto__:null,API_BASE_URL:xU,API_SERVER:Ar,AUTH_DIALOG_URL:gU,AWS_CLIENT_ID:yh,AWS_COGNITO_DOMAIN:G1,AWS_LOGIN_PAGE_URI:W1,AWS_OAUTH_TOKEN_URI:V1,AWS_USERINFO_URI:wU,BASE_DOMAIN:B1,BUILD_ENV:X1,CONFIG_VERIFICATION:Q1,FEEDBACK_FORM:q1,GMAIL_INTEGRATION_CLIENT_ID:Y1,GMAIL_INTEGRATION_DOMAIN:K1,GMAIL_INTEGRATION_PAGE_URI:M_,GMAIL_INTEGRATION_REDIRECT_URI:L_,INTEGRATION_AUTH_URL_PREFIX:$_,LOGIN_REDIRECT_URI:Nw,MANIFEST_URL:pU,MODE:H1,OFFICE_JS_CDN:mU,OUTLOOK_APP_ID:hU,OUTLOOK_CLIENT_ID:bU,PLATFORM:_U,POSTHOG_HOST:J1,POSTHOG_KEY:Tw,POST_LOGIN_REDIRECT_URI:yU,SETTINGS_PAGE_URL:eh,TYPE:fU,USE_PKCE_AUTH:vU,VERSION:dU},Symbol.toStringTag,{value:"Module"})),sd="src/platforms/helpers/chromeAuthUtils.ts",U_=r=>new Promise(e=>{chrome.storage.local.set({token:JSON.stringify(r)},()=>{e()})}),EU=()=>new Promise(r=>{chrome.storage.local.get("token",e=>{const t=e.token?JSON.parse(e.token):null;r(t)})}),kU=()=>new Promise(r=>{chrome.storage.local.set({token:null},()=>{r()})});async function CU(r,e,t){const n="refreshAuthToken",s=new Fb({region:"us-east-1"});try{t.info("Preparing for REFRESH_TOKEN_AUTH",{sourceFile:sd,functionName:n}),t.debug("AuthFlow: REFRESH_TOKEN_AUTH",{sourceFile:sd,functionName:n}),t.info("Refreshing auth token...",{sourceFile:sd,functionName:n});const i=new D_({ClientId:yh,AuthFlow:"REFRESH_TOKEN_AUTH",AuthParameters:{REFRESH_TOKEN:r.refresh_token}}),d=(await s.send(i)).AuthenticationResult;if(!d)throw new Error("AuthenticationResult is missing in the response.");const{IdToken:m,AccessToken:p,RefreshToken:v,ExpiresIn:x,TokenType:b}=d;if(!m||!p||!x||!b)throw new Error("Missing required fields in AuthenticationResult.");const S={id_token:m,access_token:p,refresh_token:v||r.refresh_token,expires_in:x,token_type:b,fetched_at:e};return await U_(S),S}catch(i){throw t.error("Error refreshing auth token",i,{sourceFile:sd,functionName:n}),new Error("Failed to refresh authentication token.")}}async function NU(r){const e="handleLoginFlow";try{r.info("Starting OAuth flow in popup...",{sourceFile:sd,functionName:e});const t=W1(Nw);r.info("Auth URL",{sourceFile:sd,functionName:e,authUrl:t});const n=await chrome.identity.launchWebAuthFlow({url:t,interactive:!0});if(!n)throw new Error("Authentication was cancelled or failed");const i=new URL(n).searchParams.get("code");if(!i)throw new Error("No authorization code received");const c={grant_type:"authorization_code",code:i,redirect_uri:Nw,client_id:yh},d=await fetch(V1,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(c).toString()});if(!d.ok)throw new Error(`Token exchange failed: ${d.statusText}`);const m=await d.json();if(!t2(m))throw new Error("Invalid token response format");const p={...m,fetched_at:Math.floor(Date.now())};return await U_(p),{success:!0}}catch(t){return r.error("Authentication failed",t,{sourceFile:sd,functionName:e}),{success:!1,error:t instanceof Error?t.message:"Unknown error occurred"}}}class TU{constructor(e){z(this,"logger");z(this,"authListeners",new Set);this.logger=e}async login(){try{const e=await NU(this.logger);if(!e.success)throw new Error(e.error||"Login failed");const t=await this.getToken();if(!t)throw new Error("Token not found after login");return this.notifyAuthListeners(!0),t}catch(e){throw this.logger.error("Login failed",e,{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"login"}),e}}async logout(){var e;try{if(await this.deleteToken(),this.notifyAuthListeners(!1),(e=chrome==null?void 0:chrome.runtime)!=null&&e.sendMessage)try{await chrome.runtime.sendMessage({type:"USER_LOGGED_OUT"})}catch(t){this.logger.warn("Could not send logout message",{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"logout",error:t})}}catch(t){throw this.logger.error("Logout failed",t,{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"logout"}),t}}async getToken(){try{return await EU()}catch(e){return this.logger.error("Error getting auth token",e,{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"getToken"}),null}}async saveToken(e){try{const t={...e,fetched_at:Math.floor(Date.now())};await U_(t)}catch(t){throw this.logger.error("Error saving auth token",t,{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"saveToken"}),t}}async deleteToken(){try{await kU()}catch(e){throw this.logger.error("Error deleting auth token",e,{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"deleteToken"}),e}}isTokenValid(e){if(!e||!e.expires_in)return!1;const t=e;return t.fetched_at?Math.floor(Date.now())+6e4-t.fetched_at<t.expires_in*1e3:!1}async refreshToken(e){try{const t=e,n=Math.floor(Date.now())+6e4;return await CU(t,n,this.logger)}catch(t){throw this.logger.error("Error refreshing auth token",t,{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"refreshToken"}),t}}async isAuthenticated(){try{const e=await this.getToken();if(this.logger.debug("Checking authentication status",{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"isAuthenticated",token:e}),!e)return this.logger.debug("No token found - user is not authenticated",{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"isAuthenticated"}),!1;const t=this.isTokenValid(e);if(this.logger.debug("Authentication status checked",{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"isAuthenticated",isValid:t,token:e}),!t){this.logger.debug("Token is not valid - user is not authenticated",{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"isAuthenticated"});const n=await this.refreshToken(e);return this.logger.debug("Refreshed token",{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"isAuthenticated",refreshedToken:n}),this.isTokenValid(n)}return this.logger.debug("Token is valid - user is authenticated",{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"isAuthenticated"}),!0}catch(e){return this.logger.error("Error checking authentication status",e,{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"isAuthenticated"}),!1}}onAuthStateChanged(e){this.authListeners.add(e)}removeAuthStateListener(e){this.authListeners.delete(e)}notifyAuthListeners(e){this.logger.info("Notifying auth listeners",{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"notifyAuthListeners",isAuthenticated:e}),this.authListeners.forEach(t=>{try{t(e)}catch(n){this.logger.error("Error in auth state callback",n,{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"notifyAuthListeners"})}})}}class AU{constructor(e){z(this,"logger");z(this,"messageListeners",new Set);this.logger=e,this.setupMessageListeners()}setupMessageListeners(){var e;(e=chrome==null?void 0:chrome.runtime)!=null&&e.onMessage&&chrome.runtime.onMessage.addListener((t,n,s)=>{this.messageListeners.forEach(i=>{try{i(t)}catch(c){this.logger.error("Error in message callback",c,{sourceFile:"src/platforms/chrome/ChromeMessagingProvider.ts",sourceFunction:"setupMessageListeners"})}})})}async sendMessage(e){return new Promise((t,n)=>{var s;if(!((s=chrome==null?void 0:chrome.runtime)!=null&&s.sendMessage)){n(new Error("Chrome runtime not available"));return}chrome.runtime.sendMessage(e,i=>{var c;chrome.runtime.lastError?(this.logger.error("Error sending message",chrome.runtime.lastError,{sourceFile:"src/platforms/chrome/ChromeMessagingProvider.ts",sourceFunction:"sendMessage",message:e}),n(new Error(((c=chrome.runtime.lastError)==null?void 0:c.message)||"Unknown error"))):t(i)})})}onMessage(e){var n;const t=s=>{e(s)};this.messageListeners.add(t),(n=chrome==null?void 0:chrome.runtime)!=null&&n.onMessage&&chrome.runtime.onMessage.addListener(t)}removeMessageListener(e){this.messageListeners.forEach(t=>{var n;(n=chrome==null?void 0:chrome.runtime)!=null&&n.onMessage&&chrome.runtime.onMessage.removeListener(t)}),this.messageListeners.clear()}async sendTabMessage(e,t){return new Promise((n,s)=>{var i;if(!((i=chrome==null?void 0:chrome.tabs)!=null&&i.sendMessage)){s(new Error("Chrome tabs API not available"));return}chrome.tabs.sendMessage(e,t,c=>{var d;chrome.runtime.lastError?(this.logger.error("Error sending tab message",chrome.runtime.lastError,{sourceFile:"src/platforms/chrome/ChromeMessagingProvider.ts",sourceFunction:"sendTabMessage",message:t}),s(new Error(((d=chrome.runtime.lastError)==null?void 0:d.message)||"Unknown error"))):n(c)})})}}class IU{constructor(e){z(this,"logger");z(this,"eventListeners",new Map);z(this,"isInitialized",!1);this.logger=e}async initialize(){if(this.isInitialized){this.logger.info("Chrome platform already initialized",{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"initialize"});return}try{this.logger.info("Initializing Chrome platform...",{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"initialize"}),this.setupChromeEventListeners(),this.isInitialized=!0,this.logger.info("Chrome platform initialized successfully",{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"initialize"})}catch(e){throw this.logger.error("Failed to initialize Chrome platform",e,{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"initialize"}),e}}async cleanup(){try{this.logger.info("Cleaning up Chrome platform...",{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"cleanup"}),this.eventListeners.clear(),this.isInitialized=!1,this.logger.info("Chrome platform cleanup completed",{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"cleanup"})}catch(e){throw this.logger.error("Failed to cleanup Chrome platform",e,{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"cleanup"}),e}}async closeWindow(){try{typeof chrome<"u"&&chrome.sidePanel&&window.close(),this.logger.debug("Window close requested",{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"closeWindow"})}catch(e){throw this.logger.error("Failed to close window",e,{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"closeWindow"}),e}}onPlatformEvent(e,t){var n,s;switch(e){case"runtime.onInstalled":(n=chrome==null?void 0:chrome.runtime)!=null&&n.onInstalled&&chrome.runtime.onInstalled.addListener(t);break;case"runtime.onStartup":(s=chrome==null?void 0:chrome.runtime)!=null&&s.onStartup&&chrome.runtime.onStartup.addListener(t);break;default:this.logger.warn("Unknown platform event",{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"onPlatformEvent",event:e})}}setupChromeEventListeners(){var e,t,n;(e=chrome==null?void 0:chrome.runtime)!=null&&e.onStartup&&chrome.runtime.onStartup.addListener(()=>{this.emitPlatformEvent("startup")}),(t=chrome==null?void 0:chrome.runtime)!=null&&t.onSuspend&&chrome.runtime.onSuspend.addListener(()=>{this.emitPlatformEvent("suspend")}),(n=chrome==null?void 0:chrome.runtime)!=null&&n.onInstalled&&chrome.runtime.onInstalled.addListener(s=>{this.emitPlatformEvent("installed",s)})}emitPlatformEvent(e,...t){const n=this.eventListeners.get(e);n&&n.forEach(s=>{try{s(...t)}catch(i){this.logger.error(`Error in platform event callback for ${e}`,i,{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"emitPlatformEvent",event:e})}})}handleExtensionMessage(e,t,n){return this.logger.debug("Extension message received",{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"handleExtensionMessage",message:e,sender:t}),!0}handleContextMenuClick(e,t){this.logger.debug("Context menu clicked",{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"handleContextMenuClick",info:e,tab:t})}}const Oi=async r=>{try{return(await Yn.createServices()).storage}catch(e){return r.warn("Platform detection failed, falling back to Chrome storage",{sourceFile:"src/shared/lib/utils/storageUtils.tsx",error:e}),null}},RU=async r=>{const e=await Oi(r);e&&await e.clearLocal()},PU=async(r,e)=>{try{const t=await Yn.createServices();if(Yn.getCurrentPlatform()==="outlook"){r.debug("Token saving handled by OutlookAuthProvider",{sourceFile:"src/shared/lib/utils/storageUtils.tsx",sourceFunction:"saveAuthTokenPlatform"});return}const n=t.storage;n&&await n.setLocalItem("token",e)}catch(t){throw r.error("Failed to save auth token",t,{sourceFile:"src/shared/lib/utils/storageUtils.tsx",sourceFunction:"saveAuthTokenPlatform"}),t}},Mm=async r=>{try{const e=await Yn.createServices();if(Yn.getCurrentPlatform()==="outlook"){const n=await e.auth.getToken();return n?(r.info("Auth token retrieved from auth provider",{sourceFile:"src/shared/lib/utils/storageUtils.tsx",sourceFunction:"getAuthTokenPlatform",authToken:n}),n):null}const t=e.storage;return t?await t.getLocalItem("token"):null}catch(e){return r.error("Failed to get auth token",e,{sourceFile:"src/shared/lib/utils/storageUtils.tsx",sourceFunction:"getAuthTokenPlatform"}),null}},zy=async r=>{try{const e=await Yn.createServices();if(Yn.getCurrentPlatform()==="outlook"){await e.auth.logout();return}const t=e.storage;t&&await t.removeLocalItem("token")}catch(e){r.error("Failed to delete auth token",e,{sourceFile:"src/shared/lib/utils/storageUtils.tsx",sourceFunction:"deleteAuthTokenPlatform"})}},Z1=async(r,e)=>{const t=await Oi(r);if(t){const n={...e};(!n.id||n.id==="")&&(n.id=String(Date.now())),await t.setLocalItem("configuration",n)}},ay=async r=>{const e=await Oi(r);return e?await e.getLocalItem("configuration")||{id:"",preferences:{theme:"",notificationsEnabled:!1,language:""},profile:{name:"",organization:"",role:""},templateConfiguration:{tags:[],fieldSubstitutions:{}},integrations:[]}:{id:"",preferences:{theme:"",notificationsEnabled:!1,language:""},profile:{name:"",organization:"",role:""},templateConfiguration:{tags:[],fieldSubstitutions:{}},integrations:[]}},jU=async(r,e)=>{const t=await Oi(r);t&&await t.setLocalItem("emailTemplates",e)},eT=async r=>{const e=await Oi(r);return e?await e.getLocalItem("emailTemplates")||[]:[]},Qm=async(r,e)=>{const t=await Oi(r);t&&await t.setLocalItem("integrations",e)},Zm=async r=>{const e=await Oi(r);return e?await e.getLocalItem("integrations")||[]:[]},FU=async(r,e)=>{const t=await Oi(r);t&&await t.setLocalItem("orgTemplates",e)},tT=async r=>{const e=await Oi(r);return e?await e.getLocalItem("orgTemplates")||[]:[]},OU=async(r,e)=>{const t=await Oi(r);if(t){const n=new Date().toISOString();await t.setLocalItem("gmailConnectionStatus",e),await t.setLocalItem("gmailConnectionStatusTimestamp",n),r.debug("Saved Gmail connection status to storage",{sourceFile:"src/shared/lib/utils/storageUtils.tsx",isConnected:e,timestamp:n})}},DU=async r=>{const e=await Oi(r);if(e){const t=await e.getLocalItem("gmailConnectionStatus"),n=await e.getLocalItem("gmailConnectionStatusTimestamp");return r.debug("Retrieved Gmail connection status from storage",{sourceFile:"src/shared/lib/utils/storageUtils.tsx",isConnected:t,timestamp:n}),{isConnected:t,timestamp:n}}return{isConnected:null,timestamp:null}},rT=async r=>{const e=await Oi(r);e&&(await e.removeLocalItem("clients"),await e.removeLocalItem("integrations"))},ao="src/lib/utils/authUtils.tsx";async function nT(r,e,t,n){const s="withLock";if(r.current)return n.info(`${t} already in progress, waiting for completion...`,{sourceFile:ao,functionName:s}),await r.current;r.current=e();try{return await r.current}finally{r.current=null}}const LU={current:null};async function Aw(r){return nT(LU,()=>MU(r),"Token validation",r)}async function MU(r){const e="performTokenValidation";let t=await Mm(r);if(!t)throw new Error("No authentication token found.");const n=Math.floor(Date.now()),s=t.expires_in*1e3+(t.fetched_at||0);if(r.info("Token expiry check",{sourceFile:ao,functionName:e,tokenExpiry:new Date(s).toISOString(),currentTime:new Date(n).toISOString(),timeUntilExpiry:s-n}),s-n<3e5)try{r.info("Token expired. Refreshing...",{sourceFile:ao,functionName:e}),t=await sT(t,n,r),r.info("New token received",{sourceFile:ao,functionName:e})}catch(i){throw r.error("Token refresh failed",i,{sourceFile:ao,functionName:e}),await zy(r),new Error("Unauthorized: Failed to refresh token.")}return t}const Ex=20,$U=500;function UU(r){return new Promise(e=>setTimeout(e,r))}function zU(r){var s;const e=r,t=(s=e==null?void 0:e.$metadata)==null?void 0:s.httpStatusCode;if(typeof t=="number")return t>=500||t===429||t===408;const n=["TimeoutError","NetworkError"];return typeof(e==null?void 0:e.name)=="string"&&n.includes(e.name),!0}async function sT(r,e,t){const n="refreshAuthToken",s=new Fb({region:"us-east-1"});for(let i=1;i<=Ex;i++)try{t.info(`Refreshing auth token (attempt ${i})...`,{sourceFile:ao,functionName:n});const c=new D_({ClientId:yh,AuthFlow:"REFRESH_TOKEN_AUTH",AuthParameters:{REFRESH_TOKEN:r.refresh_token}}),m=(await s.send(c)).AuthenticationResult;if(!m)throw new Error("AuthenticationResult is missing in the response.");const{IdToken:p,AccessToken:v,RefreshToken:x,ExpiresIn:b,TokenType:S}=m;if(!p||!v||!b||!S)throw new Error("Missing required fields in AuthenticationResult.");const N={id_token:p,access_token:v,refresh_token:x||r.refresh_token,expires_in:b,token_type:S,fetched_at:e};return await PU(t,N),N}catch(c){const d=zU(c);if(t.error(`Error refreshing auth token (attempt ${i}/${Ex})`,c,{sourceFile:ao,functionName:n,isTransient:d}),!d||i===Ex)throw await zy(t),new Error("Failed to refresh authentication token.");const m=$U*2**(i-1);t.warn(`Transient error refreshing token  retrying in ${m}ms`,{sourceFile:ao,functionName:n,attempt:i}),await UU(m)}throw new Error("Failed to refresh authentication token.")}const HU={current:null};async function BU(r){return nT(HU,()=>GU(r),"Force token refresh",r)}async function GU(r){const e="performForceTokenRefresh",t=await Mm(r);if(!t)throw new Error("No authentication token found.");const n=Math.floor(Date.now());r.info("Force refreshing token before opening options page",{sourceFile:ao,functionName:e,currentTime:new Date(n).toISOString()});const s=await sT(t,n,r);return r.info("Token force refresh successful",{sourceFile:ao,functionName:e}),s}async function Yr(r,e={},t){const n="fetchWithAuth",s=Date.now(),i=Date.now();let c=await Aw(t);const d=Date.now()-i;e.headers={...e.headers,Authorization:`${c.id_token}`};const m=Date.now(),p=await fetch(r,e),v=Date.now()-m;if(t.info("fetchWithAuth completed",{sourceFile:ao,functionName:n,url:r.pathname,status:p.status,tokenValidationMs:d,networkFetchMs:v,totalMs:Date.now()-s}),p.status===401)try{t.info("Received 401, getting fresh token...",{sourceFile:ao,functionName:n});const x=Date.now();c=await Aw(t);const b=Date.now()-x;t.info("New token received for retry",{sourceFile:ao,functionName:n,retryTokenMs:b}),e.headers&&typeof e.headers=="object"&&!Array.isArray(e.headers)&&(e.headers.Authorization=`${c.id_token}`);const S=Date.now(),N=await fetch(r,e),E=Date.now()-S;return t.info("fetchWithAuth retry completed",{sourceFile:ao,functionName:n,url:r.pathname,status:N.status,retryTokenMs:b,retryFetchMs:E,totalMs:Date.now()-s}),N}catch(x){throw t.error("Token refresh failed",x,{sourceFile:ao,functionName:n}),await zy(t),new Error("Unauthorized: Failed to refresh token.")}return p}class WU{constructor(e){z(this,"logger");this.logger=e}getResourceURL(e){return chrome.runtime.getURL(e)}async queryTabs(e={}){return new Promise(t=>{chrome.tabs.query(e,n=>{t(n.map(s=>({id:s.id,url:s.url,active:s.active})))})})}async updateTab(e,t){return new Promise(n=>{chrome.tabs.update(e,t,()=>{n()})})}async reloadTab(e){return new Promise(t=>{chrome.tabs.reload(e,void 0,()=>{t()})})}async openOptionsPage(){return new Promise(async e=>{try{const t=await BU(this.logger);let n=eh;t!=null&&t.id_token&&(n+=`?token=${encodeURIComponent(t.id_token)}`),this.logger.info("Opening external options page",{sourceFile:"src/platforms/chrome/ChromeTabsProvider.ts",functionName:"openOptionsPage",url:eh,hasToken:!!(t!=null&&t.id_token)}),chrome.tabs.create({url:n},()=>{e()})}catch(t){this.logger.error("Failed to open options page",t,{sourceFile:"src/platforms/chrome/ChromeTabsProvider.ts",functionName:"openOptionsPage"}),chrome.tabs.create({url:eh},()=>{e()})}})}async openURL(e,t="_blank"){return new Promise(n=>{t==="_blank"?chrome.tabs.create({url:e},()=>{n()}):(window.open(e,t),n())})}}function qv(r){const t=new DOMParser().parseFromString(r,"text/html"),n={white:"#ffffff",black:"#000000",red:"#e60000",orange:"#f90",yellow:"#ff0",green:"#008a00",blue:"#06c",purple:"#93f"};t.querySelectorAll("[class]").forEach(p=>{const v=p.classList,x={},b=[],S=p.getAttribute("style");S&&S.split(";").forEach(E=>{const[T,A]=E.split(":").map(I=>I.trim());T&&A&&(x[T]=A)});for(const E of["left","center","right","justify"]){const T=`ql-align-${E}`;if(v.contains(T)){const A=p.tagName.toLowerCase();A==="li"?E==="center"?(x["text-align"]="center",x["list-style-position"]="inside"):E==="right"?(x["text-align"]="right",x["list-style-position"]="inside"):E==="left"?x["text-align"]="left":E==="justify"&&(x["text-align"]="justify"):A==="ol"||A==="ul"?E==="center"?(x["margin-left"]="auto",x["margin-right"]="auto",x["padding-left"]="40px",x.width="fit-content"):E==="right"?(x["margin-left"]="auto",x["margin-right"]="0",x["padding-left"]="40px",x.width="fit-content"):E==="left"&&(x["margin-left"]="0",x["margin-right"]="auto"):x["text-align"]=E,b.push(T)}}v.contains("ql-font-serif")&&(x["font-family"]="Georgia, Times New Roman, serif",b.push("ql-font-serif")),v.contains("ql-font-monospace")&&(x["font-family"]="Monaco, Courier New, monospace",b.push("ql-font-monospace"));const N={"ql-size-small":"0.75em","ql-size-large":"1.5em","ql-size-huge":"2.5em"};for(const[E,T]of Object.entries(N))v.contains(E)&&(x["font-size"]=T,b.push(E));for(const[E,T]of Object.entries(n)){const A=`ql-color-${E}`;v.contains(A)&&(x.color=T,b.push(A))}for(const[E,T]of Object.entries(n)){const A=`ql-bg-${E}`;v.contains(A)&&(x["background-color"]=T,b.push(A))}if(Object.keys(x).length>0){const E=Object.entries(x).map(([T,A])=>`${T}: ${A}`).join("; ");p.setAttribute("style",E)}b.forEach(E=>{v.remove(E)}),v.length===0&&p.removeAttribute("class")});const i=t.createTreeWalker(t.body,NodeFilter.SHOW_TEXT,null),c=[];let d;for(;d=i.nextNode();)if(d.nodeValue&&d.nodeValue.includes("	")){const p=d.nodeValue.replace(/\t/g,"");c.push({node:d,newValue:p})}return c.forEach(({node:p,newValue:v})=>{p.nodeValue=v}),t.querySelectorAll("ul, ol").forEach(p=>{var S,N;const v=Array.from(p.children);if(v.length===0)return;const x=v.some(E=>E.getAttribute("data-list")==="bullet"),b=v.some(E=>E.getAttribute("data-list")==="ordered");if(x&&b){const E=t.createDocumentFragment();let T=null,A=null;v.forEach(I=>{const D=I.getAttribute("data-list")||"bullet";if(A!==D||!T){T=t.createElement(D==="ordered"?"ol":"ul");const j=p.getAttribute("style");j&&T.setAttribute("style",j);const O=p.getAttribute("class");O&&T.setAttribute("class",O),E.appendChild(T),A=D}T.appendChild(I.cloneNode(!0))}),(S=p.parentNode)==null||S.replaceChild(E,p)}else if(b&&p.tagName.toLowerCase()==="ul"){const E=t.createElement("ol");for(Array.from(p.attributes).forEach(T=>{E.setAttribute(T.name,T.value)});p.firstChild;)E.appendChild(p.firstChild);(N=p.parentNode)==null||N.replaceChild(E,p)}}),t.body.innerHTML}class VU{constructor(e){z(this,"logger");this.logger=e}async executeScript(e){var t;try{return(t=(await chrome.scripting.executeScript({target:e.target,func:e.func,args:e.args}))[0])==null?void 0:t.result}catch(n){throw this.logger.error("Error executing script",n,{sourceFile:"src/platforms/chrome/ChromeContentScriptProvider.ts",sourceFunction:"executeScript"}),n}}async insertContentIntoComposeBox(e){try{const t=qv(e),s=(await chrome.tabs.query({active:!0,currentWindow:!0}))[0];if(!(s!=null&&s.id))throw new Error("No active tab found or tab ID is undefined");await chrome.scripting.executeScript({target:{tabId:s.id},func:i=>{function c(){return document.querySelector('div[role="textbox"][aria-label="Message Body"]')||document.querySelector('div[aria-label="Message body, press Alt+F10 to exit"]')}function d(x){var E;const b=window.getSelection();let S=null,N=0;if(b&&b.rangeCount>0&&(S=b.getRangeAt(0).cloneRange(),x.contains(S.startContainer)||x===S.startContainer)){const T=document.createTreeWalker(x,NodeFilter.SHOW_TEXT,null,!1);let A=0,I;for(;I=T.nextNode();)if(I===S.startContainer){A+=S.startOffset;break}else A+=((E=I.textContent)==null?void 0:E.length)||0;N=A}return{selection:b,range:S,offset:N}}function m(x,b){var S;try{const{selection:N,range:E,offset:T}=b;if(!N)return;if(E&&x.contains(E.startContainer)){N.removeAllRanges(),N.addRange(E);return}if(T>0){const I=document.createTreeWalker(x,NodeFilter.SHOW_TEXT,null,!1);let D=0,j;for(;j=I.nextNode();){const O=((S=j.textContent)==null?void 0:S.length)||0;if(D+O>=T){const B=document.createRange();B.setStart(j,T-D),B.collapse(!0),N.removeAllRanges(),N.addRange(B);return}D+=O}}const A=document.createRange();A.selectNodeContents(x),A.collapse(!1),N.removeAllRanges(),N.addRange(A)}catch(N){console.warn("Could not restore cursor position:",N)}}function p(x,b){document.execCommand("insertHTML",!1,b)}const v=c();if(!v)throw new Error("Compose box not found");try{const x=d(v);v.focus(),m(v,x),navigator.clipboard&&navigator.clipboard.writeText?navigator.clipboard.writeText(i).then(()=>{document.execCommand("paste")}).catch(()=>{p(v,i)}):p(v,i)}catch(x){throw new Error("Error during paste operation: "+x)}},args:[t]})}catch(t){throw this.logger.error("Error inserting content into compose box",t,{sourceFile:"src/platforms/chrome/ChromeContentScriptProvider.ts",sourceFunction:"insertContentIntoComposeBox"}),t}}}class qU{constructor(e){z(this,"logger");this.logger=e}async launchWebAuthFlow(e){try{const t=await chrome.identity.launchWebAuthFlow(e);if(!t)throw new Error("Authentication was cancelled or failed");return t}catch(t){throw this.logger.error("Error launching web auth flow",t,{sourceFile:"src/platforms/chrome/ChromeIdentityProvider.ts",sourceFunction:"launchWebAuthFlow"}),t}}async initiateOAuth(e,t){return this.launchWebAuthFlow({url:e,interactive:!0})}}const KU="CandleLogsDB",YU=1,od="logs",JU=5e3,XU=500,nk={ERROR:1,WARN:2,INFO:3,DEBUG:4};let Bp=null;function Iw(){return Bp||(Bp=new Promise((r,e)=>{console.log("[Logger] Initializing IndexedDB...");const t=indexedDB.open(KU,YU);t.onupgradeneeded=n=>{console.log("[Logger] IndexedDB upgrade needed.");const s=n.target.result;if(!s.objectStoreNames.contains(od)){console.log(`[Logger] Creating object store: ${od}`);const i=s.createObjectStore(od,{keyPath:"id",autoIncrement:!0});console.log("[Logger] Creating indexes: timestamp, level, chromeContext"),i.createIndex("timestamp","timestamp",{unique:!1}),i.createIndex("level","level",{unique:!1}),i.createIndex("chromeContext","chromeContext",{unique:!1})}},t.onsuccess=n=>{console.log("[Logger] IndexedDB initialized successfully."),r(n.target.result)},t.onerror=n=>{console.error("[Logger] IndexedDB initialization failed:",n.target.error),Bp=null,e(n.target.error)},t.onblocked=()=>{console.warn("[Logger] IndexedDB initialization blocked. Close other tabs using the database.")}}),Bp)}Iw().catch(r=>console.error("[Logger] Initial DB connection failed:",r));const Zo=class Zo{constructor(e){z(this,"context");z(this,"minLevel","INFO");this.context=e||"unknown"}async writeLog(e,t,n,s){if(nk[e]>nk[this.minLevel])return;const i=(n==null?void 0:n.sourceFile)||"unknown",c=n==null?void 0:n.sourceFunction;let d;s&&(s instanceof Error?d={name:s.name,message:s.message,stack:s.stack}:d=s);const{sourceFile:m,sourceFunction:p,...v}=n||{},x={...d?{error:d}:{},...v};{const N=[`[${e}] [${this.context}] [${i}${c?` (${c})`:""}]: ${t}`];switch(s&&N.push(s),Object.keys(v).length>0&&N.push(v),e){case"DEBUG":console.debug(...N);break;case"INFO":console.info(...N);break;case"WARN":console.warn(...N);break;case"ERROR":console.error(...N);break}}const b={timestamp:new Date().toISOString(),level:e,message:t,chromeContext:this.context,sourceFile:i,...c&&{sourceFunction:c},details:Object.keys(x).length>0?x:void 0};try{const N=(await Iw()).transaction(od,"readwrite"),T=N.objectStore(od).add(b);return new Promise((A,I)=>{T.onsuccess=()=>{A()},T.onerror=D=>{console.error("[Logger] Failed to write log to IndexedDB:",D.target.error,b),I(D.target.error)},N.onerror=D=>{console.error("[Logger] Transaction error writing log:",D.target.error,b),I(D.target.error)},N.onabort=D=>{console.warn("[Logger] Transaction aborted writing log:",D.target.error,b),I(new Error("Transaction aborted"))}})}catch(S){throw console.error("[Logger] Error obtaining DB or starting transaction:",S,b),S}}static async _cleanupOldLogs(){if(this._isCleaning){console.info("[Logger] Cleanup already in progress, skipping.");return}console.info("[Logger] Starting log cleanup check..."),this._isCleaning=!0;try{const t=(await Iw()).transaction(od,"readwrite"),n=t.objectStore(od),s=n.count(),i=await new Promise((p,v)=>{s.onsuccess=()=>p(s.result),s.onerror=x=>{console.error("[Logger] Failed to count logs for cleanup:",x.target.error),v(x.target.error)}});if(i<=this.MAX_LOG_ENTRIES){console.info(`[Logger] Log count (${i}) within limit (${this.MAX_LOG_ENTRIES}). No cleanup needed.`);return}let c=i-this.MAX_LOG_ENTRIES;console.warn(`[Logger] Log count (${i}) exceeds limit (${this.MAX_LOG_ENTRIES}). Deleting ${c} oldest logs.`);const d=n.openCursor();let m=0;await new Promise((p,v)=>{d.onsuccess=x=>{const b=x.target.result;if(b&&c>0){const S=b.delete();S.onsuccess=()=>{m++,c--,c>0?b.continue():p()},S.onerror=N=>{console.error("[Logger] Error deleting log entry during cleanup:",N.target.error,"Key:",b.primaryKey),b.continue()}}else p()},d.onerror=x=>{console.error("[Logger] Error opening cursor for cleanup:",x.target.error),v(x.target.error)}}),await new Promise((p,v)=>{t.oncomplete=()=>{console.info(`[Logger] Log cleanup finished. Deleted ${m} entries.`),p()},t.onerror=x=>{console.error("[Logger] Transaction error during cleanup:",x.target.error),v(x.target.error)},t.onabort=x=>{console.warn("[Logger] Transaction aborted during cleanup:",x.target.error),v(new Error("Cleanup transaction aborted"))}})}catch(e){console.error("[Logger] Error during log cleanup process:",e)}finally{this._isCleaning=!1,console.info("[Logger] Log cleanup check finished.")}}_triggerCleanupCheck(){if(Zo._writeCount++,Zo._writeCount>=Zo.CLEANUP_TRIGGER_COUNT&&!Zo._isCleaning){const e=Zo._writeCount;Zo._writeCount=0,console.info(`[Logger] Write count reached ${e}. Triggering background cleanup.`),Zo._cleanupOldLogs().catch(t=>{console.error("[Logger] Background cleanup process failed:",t)})}}async debug(e,t){try{await this.writeLog("DEBUG",e,t),this._triggerCleanupCheck()}catch{}}async info(e,t){try{await this.writeLog("INFO",e,t),this._triggerCleanupCheck()}catch{}}async warn(e,t){try{await this.writeLog("WARN",e,t),this._triggerCleanupCheck()}catch{}}async error(e,t,n){try{await this.writeLog("ERROR",e,n,t),this._triggerCleanupCheck()}catch{}}};z(Zo,"_writeCount",0),z(Zo,"_isCleaning",!1),z(Zo,"MAX_LOG_ENTRIES",JU),z(Zo,"CLEANUP_TRIGGER_COUNT",XU);let Rw=Zo;class QU{constructor(e){z(this,"logger");this.logger=new Rw(e)}async debug(e,t){return this.logger.debug(e,t)}async info(e,t){return this.logger.info(e,t)}async warn(e,t){return this.logger.warn(e,t)}async error(e,t,n){return this.logger.error(e,t,n)}setMinLevel(e){console.warn("[ChromeLoggingProvider] setMinLevel not yet implemented - using hardcoded INFO level")}getMinLevel(){return"INFO"}}function ZU(r="unknown"){const e=new QU(r==="background"?"background":"options");return{storage:new YO(e),data:new JO(e),auth:new TU(e),messaging:new AU(e),lifecycle:new IU(e),tabs:new WU(e),contentScript:new VU(e),identity:new qU(e),logging:e}}class e5{constructor(e){z(this,"logger");z(this,"_changeListeners",[]);z(this,"onChanged",e=>{this.logger.warn("onChanged listener not fully supported with Office roaming settings. Callbacks will be stored but not automatically invoked.",{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"onChanged"}),this._changeListeners.push(e)});z(this,"removeChangeListener",e=>{this.logger.warn("removeChangeListener not fully supported with Office roaming settings.",{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"removeChangeListener"}),this._changeListeners=this._changeListeners.filter(t=>t!==e)});this.logger=e}async getLocalItem(e){var t;try{if(typeof localStorage<"u"){const n=localStorage.getItem(e);if(n){const s=JSON.parse(n);return this.logger.debug(`Retrieved local item with key: ${e}`,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"getLocalItem"}),s}}else if((t=Office==null?void 0:Office.context)!=null&&t.roamingSettings){const n=Office.context.roamingSettings.get(e);if(n){const s=JSON.parse(n);return this.logger.debug(`Retrieved item from roaming settings with key: ${e}`,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"getLocalItem"}),s}}return null}catch(n){return this.logger.error(`Error retrieving local item with key: ${e}`,n,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"getLocalItem"}),null}}async setLocalItem(e,t){var n;try{if(typeof localStorage<"u")localStorage.setItem(e,JSON.stringify(t)),this.logger.debug(`Stored local item with key: ${e}`,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"setLocalItem"}),this._notifyChangeListeners({[e]:{newValue:t}});else if((n=Office==null?void 0:Office.context)!=null&&n.roamingSettings)Office.context.roamingSettings.set(e,JSON.stringify(t)),await new Promise((s,i)=>{Office.context.roamingSettings.saveAsync(c=>{var d;c.status===Office.AsyncResultStatus.Succeeded?(this.logger.debug(`Stored item in roaming settings with key: ${e}`,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"setLocalItem"}),s()):i(new Error(((d=c.error)==null?void 0:d.message)||"Failed to save roaming settings"))})}),this._notifyChangeListeners({[e]:{newValue:t}});else throw new Error("No storage mechanism available")}catch(s){throw this.logger.error(`Error storing local item with key: ${e}`,s,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"setLocalItem"}),s}}async removeLocalItem(e){var t;try{const n=await this.getLocalItem(e);if(typeof localStorage<"u")localStorage.removeItem(e),this.logger.debug(`Removed local item with key: ${e}`,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"removeLocalItem"}),this._notifyChangeListeners({[e]:{oldValue:n,newValue:void 0}});else if((t=Office==null?void 0:Office.context)!=null&&t.roamingSettings)Office.context.roamingSettings.remove(e),await new Promise((s,i)=>{Office.context.roamingSettings.saveAsync(c=>{var d;c.status===Office.AsyncResultStatus.Succeeded?(this.logger.debug(`Removed item from roaming settings with key: ${e}`,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"removeLocalItem"}),s()):i(new Error(((d=c.error)==null?void 0:d.message)||"Failed to save roaming settings"))})}),this._notifyChangeListeners({[e]:{oldValue:n,newValue:void 0}});else throw new Error("No storage mechanism available")}catch(n){throw this.logger.error(`Error removing local item with key: ${e}`,n,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"removeLocalItem"}),n}}async clearLocal(){var e;try{if(typeof localStorage<"u")localStorage.clear(),this.logger.info("Cleared local storage",{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"clearLocal"}),this._notifyChangeListeners({});else if((e=Office==null?void 0:Office.context)!=null&&e.roamingSettings){const t=await this.getAllKeys(),n={};for(const s of t){const i=await this.getLocalItem(s);Office.context.roamingSettings.remove(s),n[s]={oldValue:i,newValue:void 0}}await new Promise((s,i)=>{Office.context.roamingSettings.saveAsync(c=>{var d;c.status===Office.AsyncResultStatus.Succeeded?(this.logger.info("Cleared all roaming settings",{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"clearLocal"}),s()):i(new Error(((d=c.error)==null?void 0:d.message)||"Failed to save roaming settings"))})}),this._notifyChangeListeners(n)}else throw new Error("No storage mechanism available")}catch(t){throw this.logger.error("Error clearing local storage",t,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"clearLocal"}),t}}async getAllKeys(){var e;try{if(typeof localStorage<"u"){const t=Object.keys(localStorage);return this.logger.debug(`Retrieved ${t.length} keys from storage`,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"getAllKeys"}),t}else if((e=Office==null?void 0:Office.context)!=null&&e.roamingSettings)return this.logger.warn("getAllKeys not fully supported with Office roaming settings",{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"getAllKeys"}),[];return[]}catch(t){return this.logger.error("Error getting all keys",t,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"getAllKeys"}),[]}}_notifyChangeListeners(e){this._changeListeners.forEach(t=>{try{t(e)}catch(n){this.logger.error("Error in storage change callback",n,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"_notifyChangeListeners"})}})}}class t5{constructor(e){z(this,"logger");z(this,"threadListeners",new Set);z(this,"currentThread",null);z(this,"lastKnownThreadId");z(this,"debounceTimer",null);this.logger=e,this.initializeOutlookListeners()}initializeOutlookListeners(){var e,t,n,s;(t=(e=Office==null?void 0:Office.context)==null?void 0:e.mailbox)!=null&&t.addHandlerAsync&&Office.context.mailbox.addHandlerAsync(Office.EventType.ItemChanged,this.debouncedHandleItemChanged.bind(this)),(s=(n=Office==null?void 0:Office.context)==null?void 0:n.mailbox)!=null&&s.item&&setTimeout(()=>this.handleItemChanged(),100)}debouncedHandleItemChanged(){this.debounceTimer&&clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout(()=>{this.handleItemChanged(),this.debounceTimer=null},50)}async handleItemChanged(){var e,t;try{const n=await this.getCurrentThread(),s=n==null?void 0:n.threadId,i=s!==((e=this.currentThread)==null?void 0:e.threadId);if(n&&this.currentThread&&!i){const c=JSON.stringify(this.currentThread.participants.sort()),d=JSON.stringify(n.participants.sort());if(c===d)return}i||!this.currentThread&&n?(this.logger.info("Thread changed or initialized",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"handleItemChanged",oldThreadId:(t=this.currentThread)==null?void 0:t.threadId,newThreadId:s}),this.currentThread=n,this.lastKnownThreadId=s,this.notifyThreadListeners(n)):n&&this.currentThread?this.hasThreadContentChanged(this.currentThread,n)?(this.logger.info("Thread content updated",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"handleItemChanged",threadId:s}),this.currentThread=n,this.notifyThreadListeners(n)):this.currentThread=n:this.logger.info("No meaningful thread change detected",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"handleItemChanged",hasNewThread:!!n,hasCurrentThread:!!this.currentThread})}catch(n){this.logger.error("Error handling item change",n,{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"handleItemChanged"})}}hasThreadContentChanged(e,t){var i,c;if(e.subject!==t.subject)return!0;if(e.messages.length!==t.messages.length)return t.messages.length>e.messages.length;const n=new Set(e.participants),s=new Set(t.participants);if(n.size!==s.size)return!0;for(const d of n)if(!s.has(d))return!0;for(let d=0;d<Math.min(e.messages.length,t.messages.length);d++){const m=e.messages[d],p=t.messages[d],v=((i=m.body)==null?void 0:i.trim())||"",x=((c=p.body)==null?void 0:c.trim())||"";if(v!==x&&v.length>0&&x.length>0||m.from!==p.from)return!0}return!1}shouldPreserveThreadHistory(e){var t,n,s;return!!(this.currentThread&&this.currentThread.threadId===e&&this.currentThread.messages.length>0&&((n=(t=Office==null?void 0:Office.context)==null?void 0:t.mailbox)!=null&&n.item)&&(Office.context.mailbox.item.itemType==="message"||(s=Office.context.mailbox.item.itemClass)!=null&&s.includes("IPM.Note")))}async getCurrentThread(){return new Promise(e=>{var t,n;if(!((n=(t=Office==null?void 0:Office.context)==null?void 0:t.mailbox)!=null&&n.item)){this.logger.info("No Office context or mailbox item available",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getCurrentThread"}),e(null);return}try{const s=Office.context.mailbox.item;this.logger.info("Getting current thread",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getCurrentThread",itemType:s.itemType,itemClass:s.itemClass,subject:s.subject,hasConversationId:!!s.conversationId,hasGetConversationIndexAsync:!!s.getConversationIndexAsync,hasCurrentThread:!!this.currentThread,lastKnownThreadId:this.lastKnownThreadId}),this.getThreadId(s).then(i=>{if(i)return this.getItemDetails(s,i);this.logger.warn("Could not determine thread ID",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getCurrentThread"}),e(null)}).then(i=>e(i||null)).catch(i=>{this.logger.error("Error getting current thread",i,{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getCurrentThread"}),e(null)})}catch(s){this.logger.error("Error in getCurrentThread",s,{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getCurrentThread"}),e(null)}})}normalizeSubject(e){return e?e.replace(/^((re|fw|fwd):\s*)+/i,"").trim():""}async getThreadId(e){return new Promise(t=>{if(e.conversationId){const n=e.conversationId;this.logger.info("Using conversationId as thread ID",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getThreadId",conversationId:n}),this.lastKnownThreadId=n,t(n);return}if(e.getConversationIndexAsync)e.getConversationIndexAsync(n=>{if(n.status===Office.AsyncResultStatus.Succeeded&&n.value)this.logger.info("Using conversation index as thread ID",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getThreadId",conversationIndex:n.value}),this.lastKnownThreadId=n.value,t(n.value);else{this.logger.info("getConversationIndexAsync failed, trying other methods",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getThreadId",error:n.error});const s=e.subject,i=this.currentThread?this.normalizeSubject(this.currentThread.subject):"",c=this.normalizeSubject(s);if(s&&this.currentThread&&i===c&&this.lastKnownThreadId){this.logger.info("Using cached thread ID based on normalized subject match (async failed)",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getThreadId",subject:s,cachedThreadId:this.lastKnownThreadId}),t(this.lastKnownThreadId);return}const d=e.itemId||this.lastKnownThreadId||"unknown";t(d)}});else{const n=e.subject,s=this.currentThread?this.normalizeSubject(this.currentThread.subject):"",i=this.normalizeSubject(n);if(n&&this.currentThread&&s===i&&this.lastKnownThreadId)this.logger.info("Using cached thread ID based on normalized subject match (no async method)",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getThreadId",subject:n,cachedThreadId:this.lastKnownThreadId}),t(this.lastKnownThreadId||null);else{const c=e.itemId||this.lastKnownThreadId||"unknown";this.logger.info("Using final fallback ID as thread ID",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getThreadId",fallbackId:c}),t(c)}}})}async getCurrentThreadId(){return new Promise(e=>{var n,s;if(!((s=(n=Office==null?void 0:Office.context)==null?void 0:n.mailbox)!=null&&s.item)){e(this.lastKnownThreadId||null);return}const t=Office.context.mailbox.item;this.getThreadId(t).then(e).catch(()=>e(this.lastKnownThreadId||null))})}onThreadChanged(e){this.threadListeners.add(e)}removeThreadListener(e){this.threadListeners.delete(e)}destroy(){this.debounceTimer&&(clearTimeout(this.debounceTimer),this.debounceTimer=null),this.threadListeners.clear()}notifyThreadListeners(e){this.threadListeners.forEach(t=>{try{t(e)}catch(n){this.logger.error("Error in thread change callback",n,{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"notifyThreadListeners"})}})}async getItemDetails(e,t){return new Promise(async n=>{var s;try{const i=e;let c="No Subject";if(typeof i.subject=="string")c=i.subject||"No Subject";else if(i.subject&&typeof i.subject.getAsync=="function")try{c=await new Promise((x,b)=>{i.subject.getAsync(S=>{S.status===Office.AsyncResultStatus.Succeeded?x(S.value):b(S.error)})})||"No Subject"}catch{}let d=this.extractParticipants(i);try{const v=await this.extractAsyncParticipants(i),x=new Set([...d,...v]);d=Array.from(x)}catch(v){this.logger.warn("Could not extract async participants",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getItemDetails",error:v})}const m={from:this.getFromAddress(i),timestamp:this.getTimestamp(i),subject:c,body:"",html:""},p=i.itemId||void 0;if(i.body&&i.body.getAsync)i.body.getAsync(Office.CoercionType.Html,v=>{var b;v.status===Office.AsyncResultStatus.Succeeded&&(m.html=v.value,m.body=this.stripHtml(v.value));const x=this.shouldPreserveThreadHistory(t)?[...((b=this.currentThread)==null?void 0:b.messages)||[],m]:[m];n({threadId:t,messageId:p,messages:x,subject:c,participants:d})});else{const v=this.shouldPreserveThreadHistory(t)?[...((s=this.currentThread)==null?void 0:s.messages)||[],m]:[m];n({threadId:t,messageId:p,messages:v,subject:c,participants:d})}}catch(i){this.logger.error("Error getting item details",i,{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getItemDetails",threadId:t}),n(null)}})}extractParticipants(e){const t=new Set;try{const n=this.getFromAddress(e);n&&n!=="Unknown"&&t.add(n),e.sender&&e.sender.emailAddress&&t.add(e.sender.emailAddress),e.to&&Array.isArray(e.to)&&e.to.forEach(s=>{s.emailAddress&&t.add(s.emailAddress)}),e.cc&&Array.isArray(e.cc)&&e.cc.forEach(s=>{s.emailAddress&&t.add(s.emailAddress)}),e.bcc&&Array.isArray(e.bcc)&&e.bcc.forEach(s=>{s.emailAddress&&t.add(s.emailAddress)})}catch(n){this.logger.warn("Error extracting participants",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"extractParticipants",error:n})}return Array.from(t)}async extractAsyncParticipants(e){const t=new Set;try{const n=[];e.to&&typeof e.to.getAsync=="function"&&n.push(this.getRecipientsAsync(e.to,"to")),e.cc&&typeof e.cc.getAsync=="function"&&n.push(this.getRecipientsAsync(e.cc,"cc")),e.bcc&&typeof e.bcc.getAsync=="function"&&n.push(this.getRecipientsAsync(e.bcc,"bcc")),(await Promise.allSettled(n)).forEach(i=>{i.status==="fulfilled"&&i.value.forEach(c=>t.add(c))})}catch(n){this.logger.warn("Error extracting async participants",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"extractAsyncParticipants",error:n})}return Array.from(t)}getRecipientsAsync(e,t){return new Promise(n=>{e.getAsync(s=>{if(s.status===Office.AsyncResultStatus.Succeeded){const i=s.value.map(c=>c.emailAddress).filter(c=>c);n(i)}else this.logger.warn(`Error getting ${t} recipients`,{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getRecipientsAsync",error:s.error}),n([])})})}getFromAddress(e){try{return e.from&&e.from.emailAddress?e.from.emailAddress:e.sender&&e.sender.emailAddress?e.sender.emailAddress:"Unknown"}catch(t){return this.logger.warn("Error getting from address",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getFromAddress",error:t}),"Unknown"}}getCurrentUserEmail(){var e,t,n;try{if((n=(t=(e=Office==null?void 0:Office.context)==null?void 0:e.mailbox)==null?void 0:t.userProfile)!=null&&n.emailAddress){const s=Office.context.mailbox.userProfile.emailAddress;return this.logger.info("Retrieved current user email from Outlook API",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getCurrentUserEmail",userEmail:s}),s}return this.logger.warn("userProfile.emailAddress not available",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getCurrentUserEmail"}),null}catch(s){return this.logger.error("Error getting current user email",s,{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getCurrentUserEmail"}),null}}getTimestamp(e){try{return e.dateTimeCreated?e.dateTimeCreated.toISOString():e.dateTimeModified?e.dateTimeModified.toISOString():new Date().toISOString()}catch(t){return this.logger.warn("Error getting timestamp",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getTimestamp",error:t}),new Date().toISOString()}}stripHtml(e){try{return e.replace(/<[^>]*>/g,"").trim()}catch(t){return this.logger.warn("Error stripping HTML",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"stripHtml",error:t}),e}}}const r5=async(r,e,t)=>({operation:pd(e).operation,region:await oa(r.region)()||(()=>{throw new Error("expected `region` to be configured for `aws.auth#sigv4`")})()});function n5(r){return{schemeId:"aws.auth#sigv4",signingProperties:{name:"cognito-identity",region:r.region},propertiesExtractor:(e,t)=>({signingProperties:{config:e,context:t}})}}function Cv(r){return{schemeId:"smithy.api#noAuth"}}const s5=r=>{const e=[];switch(r.operation){case"GetCredentialsForIdentity":{e.push(Cv());break}case"GetId":{e.push(Cv());break}case"GetOpenIdToken":{e.push(Cv());break}case"UnlinkIdentity":{e.push(Cv());break}default:e.push(n5(r))}return e},o5=r=>{const e=n1(r);return Object.assign(e,{authSchemePreference:oa(r.authSchemePreference??[])})},i5=r=>Object.assign(r,{useDualstackEndpoint:r.useDualstackEndpoint??!1,useFipsEndpoint:r.useFipsEndpoint??!1,defaultSigningName:"cognito-identity"}),a5="3.981.0",l5={version:a5},oT="required",zs="fn",Hs="argv",xh="ref",sk=!0,ok="isSet",$m="booleanEquals",Mf="error",$a="endpoint",jl="tree",z_="PartitionResult",H_="getAttr",Gp="stringEquals",ik={[oT]:!1,type:"string"},ak={[oT]:!0,default:!1,type:"boolean"},lk={[xh]:"Endpoint"},iT={[zs]:$m,[Hs]:[{[xh]:"UseFIPS"},!0]},aT={[zs]:$m,[Hs]:[{[xh]:"UseDualStack"},!0]},Ln={},fm={[xh]:"Region"},ck={[zs]:H_,[Hs]:[{[xh]:z_},"supportsFIPS"]},lT={[xh]:z_},uk={[zs]:$m,[Hs]:[!0,{[zs]:H_,[Hs]:[lT,"supportsDualStack"]}]},dk=[iT],fk=[aT],hk=[fm],c5={parameters:{Region:ik,UseDualStack:ak,UseFIPS:ak,Endpoint:ik},rules:[{conditions:[{[zs]:ok,[Hs]:[lk]}],rules:[{conditions:dk,error:"Invalid Configuration: FIPS and custom endpoint are not supported",type:Mf},{conditions:fk,error:"Invalid Configuration: Dualstack and custom endpoint are not supported",type:Mf},{endpoint:{url:lk,properties:Ln,headers:Ln},type:$a}],type:jl},{conditions:[{[zs]:ok,[Hs]:hk}],rules:[{conditions:[{[zs]:"aws.partition",[Hs]:hk,assign:z_}],rules:[{conditions:[iT,aT],rules:[{conditions:[{[zs]:$m,[Hs]:[sk,ck]},uk],rules:[{conditions:[{[zs]:Gp,[Hs]:[fm,"us-east-1"]}],endpoint:{url:"https://cognito-identity-fips.us-east-1.amazonaws.com",properties:Ln,headers:Ln},type:$a},{conditions:[{[zs]:Gp,[Hs]:[fm,"us-east-2"]}],endpoint:{url:"https://cognito-identity-fips.us-east-2.amazonaws.com",properties:Ln,headers:Ln},type:$a},{conditions:[{[zs]:Gp,[Hs]:[fm,"us-west-1"]}],endpoint:{url:"https://cognito-identity-fips.us-west-1.amazonaws.com",properties:Ln,headers:Ln},type:$a},{conditions:[{[zs]:Gp,[Hs]:[fm,"us-west-2"]}],endpoint:{url:"https://cognito-identity-fips.us-west-2.amazonaws.com",properties:Ln,headers:Ln},type:$a},{endpoint:{url:"https://cognito-identity-fips.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:Ln,headers:Ln},type:$a}],type:jl},{error:"FIPS and DualStack are enabled, but this partition does not support one or both",type:Mf}],type:jl},{conditions:dk,rules:[{conditions:[{[zs]:$m,[Hs]:[ck,sk]}],rules:[{endpoint:{url:"https://cognito-identity-fips.{Region}.{PartitionResult#dnsSuffix}",properties:Ln,headers:Ln},type:$a}],type:jl},{error:"FIPS is enabled but this partition does not support FIPS",type:Mf}],type:jl},{conditions:fk,rules:[{conditions:[uk],rules:[{conditions:[{[zs]:Gp,[Hs]:["aws",{[zs]:H_,[Hs]:[lT,"name"]}]}],endpoint:{url:"https://cognito-identity.{Region}.amazonaws.com",properties:Ln,headers:Ln},type:$a},{endpoint:{url:"https://cognito-identity.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:Ln,headers:Ln},type:$a}],type:jl},{error:"DualStack is enabled but this partition does not support DualStack",type:Mf}],type:jl},{endpoint:{url:"https://cognito-identity.{Region}.{PartitionResult#dnsSuffix}",properties:Ln,headers:Ln},type:$a}],type:jl}],type:jl},{error:"Invalid Configuration: Missing Region",type:Mf}]},u5=c5,d5=new LN({size:50,params:["Endpoint","Region","UseDualStack","UseFIPS"]}),f5=(r,e={})=>d5.get(r,()=>qN(u5,{endpointParams:r,logger:e.logger}));dh.aws=Rb;const h5=r=>({apiVersion:"2014-06-30",base64Decoder:(r==null?void 0:r.base64Decoder)??Jm,base64Encoder:(r==null?void 0:r.base64Encoder)??Rm,disableHostPrefix:(r==null?void 0:r.disableHostPrefix)??!1,endpointProvider:(r==null?void 0:r.endpointProvider)??f5,extensions:(r==null?void 0:r.extensions)??[],httpAuthSchemeProvider:(r==null?void 0:r.httpAuthSchemeProvider)??s5,httpAuthSchemes:(r==null?void 0:r.httpAuthSchemes)??[{schemeId:"aws.auth#sigv4",identityProvider:e=>e.getIdentityProvider("aws.auth#sigv4"),signer:new JN},{schemeId:"smithy.api#noAuth",identityProvider:e=>e.getIdentityProvider("smithy.api#noAuth")||(async()=>({})),signer:new FN}],logger:(r==null?void 0:r.logger)??new Tb,protocol:(r==null?void 0:r.protocol)??u1,protocolSettings:(r==null?void 0:r.protocolSettings)??{defaultNamespace:"com.amazonaws.cognitoidentity",xmlNamespace:"http://cognito-identity.amazonaws.com/doc/2014-06-30/",version:"2014-06-30",serviceTarget:"AWSCognitoIdentityService"},serviceId:(r==null?void 0:r.serviceId)??"Cognito Identity",urlParser:(r==null?void 0:r.urlParser)??Fm,utf8Decoder:(r==null?void 0:r.utf8Decoder)??cd,utf8Encoder:(r==null?void 0:r.utf8Encoder)??Ly}),p5=r=>{const e=R1(r),t=()=>e().then(a1),n=h5(r);return{...n,...r,runtime:"browser",defaultsMode:e,bodyLengthChecker:(r==null?void 0:r.bodyLengthChecker)??s1,credentialDefaultProvider:(r==null?void 0:r.credentialDefaultProvider)??(s=>()=>Promise.reject(new Error("Credential is missing"))),defaultUserAgentProvider:(r==null?void 0:r.defaultUserAgentProvider)??A1({serviceId:n.serviceId,clientVersion:l5.version}),maxAttempts:(r==null?void 0:r.maxAttempts)??Om,region:(r==null?void 0:r.region)??I1("Region is missing"),requestHandler:My.create((r==null?void 0:r.requestHandler)??t),retryMode:(r==null?void 0:r.retryMode)??(async()=>(await t()).retryMode||w1),sha256:(r==null?void 0:r.sha256)??T1,streamCollector:(r==null?void 0:r.streamCollector)??CN,useDualstackEndpoint:(r==null?void 0:r.useDualstackEndpoint)??(()=>Promise.resolve(f1)),useFipsEndpoint:(r==null?void 0:r.useFipsEndpoint)??(()=>Promise.resolve(h1))}},m5=r=>{const e=r.httpAuthSchemes;let t=r.httpAuthSchemeProvider,n=r.credentials;return{setHttpAuthScheme(s){const i=e.findIndex(c=>c.schemeId===s.schemeId);i===-1?e.push(s):e.splice(i,1,s)},httpAuthSchemes(){return e},setHttpAuthSchemeProvider(s){t=s},httpAuthSchemeProvider(){return t},setCredentials(s){n=s},credentials(){return n}}},g5=r=>({httpAuthSchemes:r.httpAuthSchemes(),httpAuthSchemeProvider:r.httpAuthSchemeProvider(),credentials:r.credentials()}),v5=(r,e)=>{const t=Object.assign(L1(r),l1(r),yN(r),m5(r));return e.forEach(n=>n.configure(t)),Object.assign(r,M1(t),c1(t),xN(t),g5(t))};class y5 extends o1{constructor(...[t]){const n=p5(t||{});super(n);z(this,"config");this.initConfig=n;const s=i5(n),i=DN(s),c=E1(i),d=m1(c),m=d,p=x1(m),v=o5(p),x=v5(v,(t==null?void 0:t.extensions)||[]);this.config=x,this.middlewareStack.use(AN(this.config)),this.middlewareStack.use(d1(this.config)),this.middlewareStack.use(k1(this.config)),this.middlewareStack.use(g1(this.config)),this.middlewareStack.use(wN(this.config)),this.middlewareStack.use(bN(this.config)),this.middlewareStack.use(_N(this.config)),this.middlewareStack.use(SN(this.config,{httpAuthSchemeParametersProvider:r5,identityProviderConfigProvider:async b=>new jN({"aws.auth#sigv4":b.credentials})})),this.middlewareStack.use(EN(this.config))}destroy(){super.destroy()}}var cT=(r=>(r.Succeeded="succeeded",r.Failed="failed",r))(cT||{}),Pw=(r=>(r.DialogMessageReceived="dialogMessageReceived",r.DialogEventReceived="dialogEventReceived",r))(Pw||{});class uT{constructor(e){z(this,"logger");this.logger=e}async launchWebAuthFlow(e){return this.logger.warn("launchWebAuthFlow using basic window.open approach in Outlook context",{sourceFile:"src/platforms/outlook/OutlookIdentityProvider.ts",sourceFunction:"launchWebAuthFlow"}),this.initiateOAuth(e.url,"")}async initiateOAuth(e,t){var n;try{const s=window.Office;return(n=s==null?void 0:s.ui)!=null&&n.displayDialogAsync?(this.logger.info("Using Office.ui.displayDialogAsync for OAuth",{sourceFile:"src/platforms/outlook/OutlookIdentityProvider.ts",sourceFunction:"initiateOAuth"}),new Promise((i,c)=>{s.ui.displayDialogAsync(e,{height:60,width:60},d=>{var m;if(d.status===cT.Succeeded){const p=d.value;p.addEventHandler(Pw.DialogMessageReceived,v=>{p.close(),i(v.message||"")}),p.addEventHandler(Pw.DialogEventReceived,v=>{p.close(),v.error===12006?c(new Error("Authentication was cancelled by user")):c(new Error(`Authentication dialog failed with error: ${v.error}`))})}else c(new Error(`Failed to open authentication dialog: ${((m=d.error)==null?void 0:m.message)||"Unknown error"}`))})})):(this.logger.warn("Office.ui not available, using window.open fallback",{sourceFile:"src/platforms/outlook/OutlookIdentityProvider.ts",sourceFunction:"initiateOAuth"}),new Promise((i,c)=>{const d=window.open(e,"_blank","width=500,height=600,scrollbars=yes,resizable=yes");if(!d){c(new Error("Failed to open authentication window. Please check popup blockers."));return}const m=setInterval(()=>{try{if(d.closed){clearInterval(m),c(new Error("Authentication was cancelled by user"));return}try{const p=d.location.href;if(p&&p.includes("access_token=")){clearInterval(m),d.close(),i(p);return}}catch{}}catch{clearInterval(m),d==null||d.close(),c(new Error("Error during authentication process"))}},1e3);setTimeout(()=>{clearInterval(m),d.closed||d.close(),c(new Error("Authentication timeout - please try again"))},3e5)}))}catch(s){throw this.logger.error("Error initiating OAuth",s,{sourceFile:"src/platforms/outlook/OutlookIdentityProvider.ts",sourceFunction:"initiateOAuth"}),s}}}const x5=()=>{const r=window.location.hostname,e=window.location.pathname;if(r==="localhost"){const n=X1.match(/^(dev2|demo)/),s=n?`?env=${n[1]}`:"";return{environment:n?`${n[1]}-local`:"local",DIALOG_URL:`https://localhost:5174/auth-dialog-pkce.html${s}`}}else return e.includes("FileServer_Staging")?{environment:"staging",DIALOG_URL:"https://candle-ai.github.io/FileServer_Staging/dist-outlook-addin/src/apps/outlook-addin/auth-dialog-pkce.html"}:e.includes("FileServer_Prod")?{environment:"prod",DIALOG_URL:"https://candle-ai.github.io/FileServer_Prod/dist-outlook-addin/src/apps/outlook-addin/auth-dialog-pkce.html"}:e.includes("FileServer_Dev2")?{environment:"dev2",DIALOG_URL:"https://candle-ai.github.io/FileServer_Dev2/dist-outlook-addin/src/apps/outlook-addin/auth-dialog-pkce.html"}:e.includes("FileServer_Demo")?{environment:"demo",DIALOG_URL:"https://candle-ai.github.io/FileServer_Demo/dist-outlook-addin/src/apps/outlook-addin/auth-dialog-pkce.html"}:{environment:"dev",DIALOG_URL:"https://candle-ai.github.io/FileServer/dist-outlook-addin/src/apps/outlook-addin/auth-dialog-pkce.html"}};async function w5(){const r=x5();return new Promise((e,t)=>{let n=!1;console.log(`Starting PKCE authentication in ${r.environment} environment with dialog:`,r.DIALOG_URL),Office.context.ui.displayDialogAsync(r.DIALOG_URL,{height:70,width:50,promptBeforeOpen:!1},s=>{if(s.status!==Office.AsyncResultStatus.Succeeded)return console.error("Failed to open auth dialog:",s.error),t(new Error(`Failed to open authentication dialog: ${s.error.message}`));const i=s.value;console.log("Auth dialog opened successfully"),i.addEventHandler(Office.EventType.DialogMessageReceived,c=>{try{if(!n&&"message"in c){let d;if(typeof c.message=="string")d=JSON.parse(c.message);else if(typeof c.message=="object")d=c.message;else{console.log("Unknown message type:",typeof c.message,c.message);return}if(console.log(`Received message from auth dialog (${r.environment}):`,d.type),d.type==="AUTH_SUCCESS"){if(console.log(`Authentication successful in ${r.environment} environment`),n=!0,i.close(),!d.tokens||!d.tokens.access_token){t(new Error("Invalid token response from authentication dialog"));return}const m={access_token:d.tokens.access_token,refresh_token:d.tokens.refresh_token,id_token:d.tokens.id_token,expires_in:d.tokens.expires_in,token_type:d.tokens.token_type,fetched_at:d.tokens.fetched_at};console.log(`Tokens received successfully in ${r.environment} environment`),e(m)}else d.type==="AUTH_ERROR"&&(console.log(`Authentication error in ${r.environment}:`,d.error),n=!0,i.close(),t(new Error(`Authentication failed: ${d.error}`)))}}catch(d){console.error("Error handling dialog message:",d),n||(n=!0,i.close(),t(new Error("Error processing authentication response")))}}),i.addEventHandler(Office.EventType.DialogEventReceived,c=>{if(console.log("Dialog event received:",c),!n&&"error"in c){const d=c.error;d===12006?(console.log("User cancelled authentication"),n=!0,t(new Error("Authentication cancelled by user"))):d===12005?console.log("Dialog navigation occurred (normal during OAuth)"):(console.error("Dialog error:",d),n=!0,t(new Error(`Authentication dialog error: ${d}`)))}}),setTimeout(()=>{n||(console.log(`Authentication timeout in ${r.environment} environment`),n=!0,i.close(),t(new Error("Authentication timeout - please try again")))},300*1e3)})})}const pk="us-east-1";class b5{constructor(e,t){z(this,"logger");z(this,"authListeners",new Set);z(this,"cachedToken",null);z(this,"cognitoClient");z(this,"identityProvider");z(this,"storageProvider");this.logger=e,this.storageProvider=t,this.cognitoClient=new y5({region:pk}),this.identityProvider=new uT(e)}async login(){try{const e=await w5();return this.logger.info("Token received",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"login",token:e}),this.cachedToken=e,await this.saveToken(e),this.notifyAuthListeners(!0),e}catch(e){throw this.logger.error("Login failed",e,{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"login"}),e}}async logout(){this.cachedToken=null,await this.deleteToken(),this.notifyAuthListeners(!1)}async getToken(){if(this.logger.debug("Getting token",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"getToken",hasCachedToken:!!this.cachedToken}),this.cachedToken)return this.logger.debug("Returning cached token",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"getToken"}),this.cachedToken;const e=await this.loadTokenFromStorage();return e?(this.logger.debug("Token loaded from storage, caching it",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"getToken"}),this.cachedToken=e,e):(this.logger.debug("No token found in cache or storage",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"getToken"}),null)}onAuthStateChanged(e){this.authListeners.add(e)}removeAuthStateListener(e){this.authListeners.delete(e)}notifyAuthListeners(e){this.authListeners.forEach(t=>{try{t(e)}catch(n){this.logger.error("Error in auth state callback",n,{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"notifyAuthListeners"})}})}async isAuthenticated(){console.log(" [OutlookAuthProvider] Checking authentication status"),this.logger.info("Checking authentication status",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"isAuthenticated"});const e=await this.getToken();if(!e)return console.log(" [OutlookAuthProvider] No token found"),this.logger.info("No token found - user is not authenticated",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"isAuthenticated"}),!1;const t=this.isTokenValid(e);if(console.log(" [OutlookAuthProvider] Token valid?",t),!t){console.log(" [OutlookAuthProvider] Token is expired or expiring soon, attempting refresh"),this.logger.info("Token is expired or expiring soon, attempting refresh",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"isAuthenticated",tokenExpiry:e.expires_in,fetchedAt:e.fetched_at});try{return console.log(" [OutlookAuthProvider] Calling refreshToken()..."),await this.refreshToken(e),console.log(" [OutlookAuthProvider] Token refreshed successfully!"),this.logger.info("Token refreshed successfully during authentication check",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"isAuthenticated"}),!0}catch(n){return console.error(" [OutlookAuthProvider] Token refresh failed:",n),this.logger.error("Token refresh failed during authentication check",n,{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"isAuthenticated"}),!1}}return this.logger.info("Authentication status checked - token is valid",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"isAuthenticated",hasToken:!!e,isValid:t,tokenExpiry:e.expires_in,fetchedAt:e.fetched_at}),!0}async validateToken(e){const t=await this.getToken();return t?this.isTokenValid(t):!1}isTokenValid(e){if(!e||!e.expires_in)return!1;const t=Math.floor(Date.now()),n=e.fetched_at||0,s=n+e.expires_in*1e3,i=s-t<3e5;return this.logger.debug("Token validation",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"isTokenValid",currentTime:t,fetchedAt:n,expiresIn:e.expires_in,tokenExpiry:s,isExpired:i,timeUntilExpiry:s-t}),!i}async refreshToken(e){console.log(" [OutlookAuthProvider.refreshToken] Starting token refresh using REFRESH_TOKEN_AUTH"),this.logger.info("Refreshing token using refresh_token",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"refreshToken"});try{const t=new Fb({region:pk}),n=new D_({ClientId:yh,AuthFlow:"REFRESH_TOKEN_AUTH",AuthParameters:{REFRESH_TOKEN:e.refresh_token}});console.log(" [OutlookAuthProvider.refreshToken] Sending refresh request to AWS Cognito"),this.logger.debug("Sending refresh token request to Cognito",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"refreshToken"});const s=await t.send(n);console.log(" [OutlookAuthProvider.refreshToken] Received response from Cognito");const i=s.AuthenticationResult;if(!i)throw new Error("AuthenticationResult is missing in the response.");const{IdToken:c,AccessToken:d,RefreshToken:m,ExpiresIn:p,TokenType:v}=i;if(!c||!d||!p||!v)throw new Error("Missing required fields in AuthenticationResult.");const x={id_token:c,access_token:d,refresh_token:m||e.refresh_token,expires_in:p,token_type:v,fetched_at:Math.floor(Date.now())};return this.logger.info("Token refreshed successfully",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"refreshToken",newExpiresIn:p}),this.cachedToken=x,await this.saveToken(x),this.notifyAuthListeners(!0),x}catch(t){return this.logger.error("Token refresh failed, falling back to full re-login",t,{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"refreshToken"}),this.login()}}async saveToken(e){await this.storageProvider.setLocalItem("token",e)}async loadTokenFromStorage(){this.logger.debug("Loading token from storage",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"loadTokenFromStorage"});try{const e=await this.storageProvider.getLocalItem("token");if(!e)return this.logger.debug("No token found in storage",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"loadTokenFromStorage"}),null;const t=e;return this.logger.debug("Token successfully loaded from storage",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"loadTokenFromStorage",hasToken:!!t,fetchedAt:t==null?void 0:t.fetched_at,expiresIn:t==null?void 0:t.expires_in}),t}catch(e){return this.logger.warn("Failed to load token from storage",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"loadTokenFromStorage",error:e}),null}}async deleteToken(){await this.storageProvider.removeLocalItem("token")}parseAccessTokenFromOAuthResponse(e){try{let t=e;e.includes("#")&&(t=e.split("#")[1]);const n=new URLSearchParams(t),s=n.get("access_token");if(!s)return this.logger.error("No access_token found in OAuth response",new Error("Missing access token"),{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"parseAccessTokenFromOAuthResponse",responseUrl:e,fragment:t}),null;const i=n.get("error");if(i){const c=n.get("error_description")||"Unknown OAuth error";throw new Error(`OAuth error: ${i} - ${c}`)}return s}catch(t){return this.logger.error("Failed to parse OAuth response",t,{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"parseAccessTokenFromOAuthResponse",responseUrl:e}),null}}}class _5{constructor(e){z(this,"logger");this.logger=e}async sendMessage(e){return this.logger.debug("Sending message in Outlook context",{sourceFile:"src/platforms/outlook/OutlookMessagingProvider.ts",sourceFunction:"sendMessage",message:e}),Promise.resolve(e)}onMessage(e){this.logger.debug("Registering message callback in Outlook context",{sourceFile:"src/platforms/outlook/OutlookMessagingProvider.ts",sourceFunction:"onMessage"})}removeMessageListener(e){this.logger.debug("Removing message listener in Outlook context",{sourceFile:"src/platforms/outlook/OutlookMessagingProvider.ts",sourceFunction:"removeMessageListener"})}async sendOfficeNotification(e){try{typeof Office<"u"&&Office.context&&Office.context.ui&&Office.context.ui.displayDialogAsync(`data:text/html,<html><body><p>${e}</p></body></html>`,{height:20,width:40},t=>{t.status===Office.AsyncResultStatus.Succeeded&&setTimeout(()=>t.value.close(),3e3)})}catch(t){this.logger.error("Error showing Office notification",t,{sourceFile:"src/platforms/outlook/OutlookMessagingProvider.ts",sourceFunction:"sendOfficeNotification"})}}}class S5{constructor(e){z(this,"logger");z(this,"eventListeners",new Map);z(this,"isInitialized",!1);this.logger=e}async initialize(){if(this.isInitialized){this.logger.info("Outlook platform already initialized",{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"initialize"});return}try{this.logger.info("Initializing Outlook platform...",{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"initialize"}),await this.waitForOfficeReady(),this.setupOutlookEventListeners();try{const e=JSON.stringify(Q1);localStorage.setItem("CONFIG_VERIFICATION",e),this.logger.info(`[Debug] Saved CONFIG_VERIFICATION='${e}' to localStorage.`,{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"initialize"})}catch(e){this.logger.warn("[Debug] Could not save CONFIG_VERIFICATION to localStorage.",e,{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"initialize"})}this.isInitialized=!0,this.logger.info("Outlook platform initialized successfully",{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"initialize"})}catch(e){throw this.logger.error("Failed to initialize Outlook platform",e,{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"initialize"}),e}}async cleanup(){try{this.logger.info("Cleaning up Outlook platform...",{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"cleanup"}),this.eventListeners.clear(),this.isInitialized=!1,this.logger.info("Outlook platform cleanup completed",{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"cleanup"})}catch(e){throw this.logger.error("Failed to cleanup Outlook platform",e,{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"cleanup"}),e}}async closeWindow(){this.logger.debug("Window close requested (no-op for Outlook)",{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"closeWindow"})}onPlatformEvent(e,t){this.eventListeners.has(e)||this.eventListeners.set(e,new Set),this.eventListeners.get(e).add(t)}async waitForOfficeReady(){return new Promise(e=>{typeof Office<"u"&&Office.onReady?Office.onReady(()=>{e()}):e()})}setupOutlookEventListeners(){var e;typeof Office<"u"&&Office.context&&(e=Office.context.mailbox)!=null&&e.addHandlerAsync&&Office.context.mailbox.addHandlerAsync(Office.EventType.ItemChanged,this.handleItemChanged.bind(this),t=>{t.status===Office.AsyncResultStatus.Failed&&this.logger.error("Failed to add item changed handler",t.error,{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"setupOutlookEventListeners"})})}handleItemChanged(){this.emitPlatformEvent("itemChanged")}emitPlatformEvent(e,...t){const n=this.eventListeners.get(e);n&&n.forEach(s=>{try{s(...t)}catch(i){this.logger.error(`Error in platform event callback for ${e}`,i,{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"emitPlatformEvent",event:e})}})}}class E5{constructor(e){z(this,"logger");this.logger=e}getResourceURL(e){return this.logger.debug("getResourceURL called in Outlook context",{sourceFile:"src/platforms/outlook/OutlookTabsProvider.ts",sourceFunction:"getResourceURL",path:e}),e.includes("options.html")?eh:""}async getCurrentTab(){return this.logger.debug("getCurrentTab called in Outlook context",{sourceFile:"src/platforms/outlook/OutlookTabsProvider.ts",sourceFunction:"getCurrentTab"}),{id:1,windowId:1,index:0,url:window.location.href,title:document.title||"Outlook Add-in",active:!0,highlighted:!0,pinned:!1,incognito:!1}}async createTab(e,t){return this.logger.debug("createTab called in Outlook context",{sourceFile:"src/platforms/outlook/OutlookTabsProvider.ts",sourceFunction:"createTab",url:e}),window.open(e,"_blank"),{id:Date.now(),windowId:1,index:0,url:e,title:"New Tab",active:!0,highlighted:!0,pinned:!1,incognito:!1}}async updateTab(e,t){this.logger.debug("updateTab called in Outlook context - this is a no-op",{sourceFile:"src/platforms/outlook/OutlookTabsProvider.ts",sourceFunction:"updateTab"})}async closeTab(e){this.logger.debug("closeTab called in Outlook context - this is a no-op",{sourceFile:"src/platforms/outlook/OutlookTabsProvider.ts",sourceFunction:"closeTab"})}onTabUpdated(e){this.logger.debug("onTabUpdated called in Outlook context - this is a no-op",{sourceFile:"src/platforms/outlook/OutlookTabsProvider.ts",sourceFunction:"onTabUpdated"})}removeTabUpdateListener(e){this.logger.debug("removeTabUpdateListener called in Outlook context - this is a no-op",{sourceFile:"src/platforms/outlook/OutlookTabsProvider.ts",sourceFunction:"removeTabUpdateListener"})}async openURL(e,t="_blank"){this.logger.debug("openURL called in Outlook context",{sourceFile:"src/platforms/outlook/OutlookTabsProvider.ts",sourceFunction:"openURL",url:e,target:t}),window.open(e,t)}async openOptionsPage(){this.logger.debug("openOptionsPage called in Outlook context",{sourceFile:"src/platforms/outlook/OutlookTabsProvider.ts",sourceFunction:"openOptionsPage"});const e=await Aw(this.logger);let t=eh;e!=null&&e.id_token&&(t+=`?token=${e.id_token}`),window.open(t,"_blank")}}const kx=32*1024;class k5{constructor(e){z(this,"logger");this.logger=e}truncateHtmlForReplyForm(e){const n=new TextEncoder().encode(e);if(n.length<=kx)return e;this.logger.warn("HTML content exceeds 32 KB limit for reply form, truncating",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"truncateHtmlForReplyForm",originalSize:n.length,maxSize:kx});let i=new TextDecoder().decode(n.slice(0,kx-100));const c=Math.max(i.lastIndexOf("</p>"),i.lastIndexOf("</div>"),i.lastIndexOf("</li>"),i.lastIndexOf("<br>"));return c>i.length/2&&(i=i.substring(0,c+(i.includes("</p>")?4:i.includes("</div>")?6:i.includes("</li>")?5:4))),i+='<p style="color: gray; font-style: italic;">[Content truncated due to size limit]</p>',i}detectItemMode(){var e,t;try{if(!((t=(e=Office==null?void 0:Office.context)==null?void 0:e.mailbox)!=null&&t.item))return"unknown";const n=Office.context.mailbox.item;if(!n.itemId)return this.logger.debug("Detected compose mode (no itemId)",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"detectItemMode"}),"compose";const s=n.to;return s&&typeof s.setAsync=="function"?(this.logger.debug("Detected compose mode (to.setAsync exists)",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"detectItemMode"}),"compose"):(this.logger.debug("Detected read mode",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"detectItemMode"}),"read")}catch(n){return this.logger.warn("Error detecting item mode",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"detectItemMode",error:n}),"unknown"}}async executeScript(e){throw this.logger.warn("Script execution not implemented for Outlook context",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"executeScript"}),new Error("Script execution not available in Outlook context")}async injectScript(e){this.logger.warn("Script injection not applicable in Outlook context",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"injectScript"})}async insertContentIntoComposeBox(e){var t;try{const n=qv(e);if(typeof Office<"u"&&Office.context&&Office.context.mailbox){const s=this.detectItemMode();this.logger.debug("Inserting content into compose box",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"insertContentIntoComposeBox",mode:s}),s==="compose"?(t=Office.context.mailbox.item)==null||t.body.setSelectedDataAsync(n,{coercionType:Office.CoercionType.Html},i=>{i.status===Office.AsyncResultStatus.Failed?(this.logger.error("Failed to insert content using setSelectedDataAsync, falling back to reply-all",i.error,{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"insertContentIntoComposeBox"}),this.replyAllWithContent(e)):this.logger.info("Successfully inserted content at cursor position",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"insertContentIntoComposeBox"})}):(this.logger.info("In read mode - creating reply-all with content",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"insertContentIntoComposeBox"}),await this.replyAllWithContent(e))}else this.logger.warn("Office.js context not available",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"insertContentIntoComposeBox"})}catch(n){throw this.logger.error("Error inserting content into compose box",n,{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"insertContentIntoComposeBox"}),n}}async replyWithContent(e){try{const t=qv(e),n=this.truncateHtmlForReplyForm(t);if(typeof Office<"u"&&Office.context&&Office.context.mailbox&&Office.context.mailbox.item){const s=Office.context.mailbox.item;if(typeof s.displayReplyFormAsync=="function")return new Promise((i,c)=>{s.displayReplyFormAsync(n,d=>{d.status===Office.AsyncResultStatus.Succeeded?(this.logger.info("Successfully displayed reply form with content (async)",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyWithContent"}),i()):(this.logger.error("Failed to display reply form (async)",d.error,{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyWithContent"}),c(d.error))})});s.displayReplyForm(n),this.logger.info("Successfully displayed reply form with content",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyWithContent"})}else this.logger.warn("Office.js context not available",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyWithContent"})}catch(t){throw this.logger.error("Error displaying reply form with content",t,{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyWithContent"}),t}}async replyAllWithContent(e){try{const t=qv(e),n=this.truncateHtmlForReplyForm(t);if(this.logger.debug("Attempting to display reply all form",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyAllWithContent",contentLength:n.length,contentPreview:n.substring(0,200)}),typeof Office<"u"&&Office.context&&Office.context.mailbox&&Office.context.mailbox.item){const s=Office.context.mailbox.item;if(typeof s.displayReplyAllFormAsync=="function")return new Promise((i,c)=>{s.displayReplyAllFormAsync(n,d=>{d.status===Office.AsyncResultStatus.Succeeded?(this.logger.info("Successfully displayed reply all form with content (async)",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyAllWithContent"}),i()):(this.logger.error("Failed to display reply all form (async)",d.error,{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyAllWithContent"}),c(d.error))})});s.displayReplyAllForm(n),this.logger.info("Successfully displayed reply all form with content",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyAllWithContent"})}else this.logger.warn("Office.js context not available",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyAllWithContent"})}catch(t){throw this.logger.error("Error displaying reply all form with content",t,{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyAllWithContent"}),t}}}const mk={ERROR:1,WARN:2,INFO:3,DEBUG:4};class C5{constructor(e){z(this,"context");z(this,"minLevel");this.context=e||"unknown",this.minLevel="INFO"}shouldLog(e){return mk[e]<=mk[this.minLevel]}formatMessage(e,t,n){const s=(n==null?void 0:n.sourceFile)||"unknown",i=n==null?void 0:n.sourceFunction;return`[${e}] [Outlook:${this.context}] [${s}${i?` (${i})`:""}]: ${t}`}async debug(e,t){if(!this.shouldLog("DEBUG"))return;const n=this.formatMessage("DEBUG",e,t),{sourceFile:s,sourceFunction:i,...c}=t||{},d=[n];Object.keys(c).length>0&&d.push(c),console.debug(...d)}async info(e,t){if(!this.shouldLog("INFO"))return;const n=this.formatMessage("INFO",e,t),{sourceFile:s,sourceFunction:i,...c}=t||{},d=[n];Object.keys(c).length>0&&d.push(c),console.info(...d)}async warn(e,t){if(!this.shouldLog("WARN"))return;const n=this.formatMessage("WARN",e,t),{sourceFile:s,sourceFunction:i,...c}=t||{},d=[n];Object.keys(c).length>0&&d.push(c),console.warn(...d)}async error(e,t,n){if(!this.shouldLog("ERROR"))return;const s=this.formatMessage("ERROR",e,n),{sourceFile:i,sourceFunction:c,...d}=n||{},m=[s];t&&m.push(t),Object.keys(d).length>0&&m.push(d),console.error(...m)}setMinLevel(e){this.minLevel=e}getMinLevel(){return this.minLevel}getUnderlyingLogger(){return{context:this.context,minLevel:this.minLevel,writeLog:async(e,t,n,s)=>{switch(e){case"DEBUG":return this.debug(t,n);case"INFO":return this.info(t,n);case"WARN":return this.warn(t,n);case"ERROR":return this.error(t,s,n)}},_triggerCleanupCheck:()=>{},debug:(e,t)=>this.debug(e,t),info:(e,t)=>this.info(e,t),warn:(e,t)=>this.warn(e,t),error:(e,t,n)=>this.error(e,t,n)}}}function N5(){const r=new C5("background"),e=new e5(r);return{storage:e,data:new t5(r),auth:new b5(r,e),messaging:new _5(r),lifecycle:new S5(r),tabs:new E5(r),contentScript:new k5(r),identity:new uT(r),logging:r}}const Ms=class Ms{static async createServices(e){const t=e||Ms.detectPlatform();if(Ms.instance&&Ms.currentPlatform===t)return Ms.instance;let n;if(t==="chrome"){const s=Ms.detectExecutionContext();n=ZU(s)}else if(t==="outlook")n=N5();else throw new Error(`Unsupported platform: ${t}`);return await n.lifecycle.initialize(),Ms.instance=n,Ms.currentPlatform=t,n}static detectPlatform(){if(typeof chrome<"u"&&chrome.runtime&&chrome.runtime.id)return"chrome";if(typeof Office<"u"&&Office.context)return"outlook";throw new Error("Unable to detect platform. Neither Chrome nor Office APIs available.")}static detectExecutionContext(){if(typeof chrome<"u"&&chrome.runtime&&chrome.runtime.id){if(typeof document>"u")return"background";try{if(typeof window<"u"&&window.location){const e=window.location.href;return e.includes("options.html")?"options":e.includes("popup.html")?"popup":"content"}}catch{return"content"}return"content"}return"unknown"}static getCurrentPlatform(){return Ms.currentPlatform}static async resetInstance(){Ms.instance&&(await Ms.instance.lifecycle.cleanup(),Ms.instance=null,Ms.currentPlatform=null)}};z(Ms,"instance",null),z(Ms,"currentPlatform",null);let Yn=Ms;const B_=w.createContext({platform:"unassigned",services:null,isLoading:!0,error:null});function T5({children:r}){const[e,t]=w.useState("unassigned"),[n,s]=w.useState(null),[i,c]=w.useState(!0),[d,m]=w.useState(null),p=w.useCallback(async v=>{if(v!=null&&v.lifecycle)try{await v.lifecycle.cleanup()}catch(x){console.error("Error during platform cleanup",x,{sourceFile:"src/platforms/PlatformContext.tsx",sourceFunction:"cleanup"})}},[]);return w.useEffect(()=>{let v=null;async function x(){try{console.info("Initializing platform services...",{sourceFile:"src/platforms/PlatformContext.tsx",sourceFunction:"initializePlatform"});const b=await Yn.createServices();if(v=b,t(Yn.getCurrentPlatform()||"unassigned"),Yn.getCurrentPlatform()==="unassigned")throw new Error("Platform not supported");await b.lifecycle.initialize(),s(b),m(null),console.info("Platform services initialized successfully",{sourceFile:"src/platforms/PlatformContext.tsx",sourceFunction:"initializePlatform"})}catch(b){const S=b instanceof Error?b.message:"Unknown error occurred";console.error("Failed to initialize platform services",b,{sourceFile:"src/platforms/PlatformContext.tsx",sourceFunction:"initializePlatform"}),m(S)}finally{c(!1)}}return x(),()=>{v&&p(v)}},[p]),u.jsx(B_.Provider,{value:{platform:e,services:n,isLoading:i,error:d},children:i?u.jsx("div",{className:"flex items-center justify-center h-full",children:u.jsx("div",{className:"text-sm text-gray-600",children:"Initializing platform..."})}):d?u.jsx("div",{className:"flex items-center justify-center h-full",children:u.jsxs("div",{className:"text-sm text-red-600",children:["Error: ",d]})}):r})}const dT=w.createContext(void 0),Di=()=>{const r=w.useContext(dT);if(r===void 0)throw console.error("useGmailConnection hook called outside of GmailConnectionProvider"),console.error("Component stack:",new Error().stack),new Error("useGmailConnection must be used within a GmailConnectionProvider. Check that the component using this hook is properly wrapped in the provider hierarchy.");return r},gr="src/lib/utils/cacheUtils.ts",A5=100,I5=1440*60*1e3,R5=100,P5=3600*1e3,j5=100,F5=1440*60*1e3,O5=100,D5=3600*1e3,L5=50,M5=1800*1e3,$5=3600*1e3*24,Yt={EMAIL_SUMMARY:"cache_email_summary_",EMAIL_SUMMARY_INDEX:"cache_email_summary_index",DOCUMENTS:"cache_documents_",DOCUMENTS_INDEX:"cache_documents_index",PROJECT_DOCUMENTS:"cache_project_documents_",PROJECT_DOCUMENTS_INDEX:"cache_project_documents_index",NON_EXISTENT_CLIENT:"cache_non_existent_client_",NON_EXISTENT_CLIENT_INDEX:"cache_non_existent_client_index",CLIENT:"cache_client_",CLIENT_INDEX:"cache_client_index",GENERATED_RESPONSE:"cache_generated_response_",GENERATED_RESPONSE_INDEX:"cache_generated_response_index",FIRM_USERS:"firm_users"},U5=30*1e3,Um=new Map;function z5(r){const e=r.toLowerCase(),t=Um.get(e);return t?Date.now()-t.timestamp>U5?(Um.delete(e),{inCache:!1}):{inCache:!0,errorType:t.errorType}:{inCache:!1}}function gk(r,e){const t=r.toLowerCase();Um.set(t,{timestamp:Date.now(),errorType:e})}function fT(r){const e=r.toLowerCase();Um.delete(e)}function H5(){Um.clear()}async function us(r){try{return(await Yn.createServices()).storage}catch(e){return r.warn("Platform detection failed, storage unavailable",{sourceFile:gr,error:e}),null}}async function eg(r,e,t,n,s){try{const i=await r.getLocalItem(e)||[];if(i.length>=n){i.sort((d,m)=>d.timestamp-m.timestamp);const c=i.splice(0,i.length-n+1);for(const d of c)await r.removeLocalItem(d.key);await r.setLocalItem(e,i)}}catch(i){s.warn("Error managing cache size",{sourceFile:gr,error:i})}}async function tg(r,e,t,n,s){try{const i=await r.getLocalItem(e)||[],c=i.findIndex(d=>d.key===t);c!==-1&&i.splice(c,1),i.push({key:t,timestamp:n}),await r.setLocalItem(e,i)}catch(i){s.warn("Error updating cache index",{sourceFile:gr,error:i})}}async function hT(r){await Promise.all([W5(r),V5(r),Y5(r),vT(r),X5(r)])}async function B5(r,e,t,n){try{const s=await us(n);if(!s)return;const i=`${Yt.EMAIL_SUMMARY}${r}`,c=Date.now();await eg(s,Yt.EMAIL_SUMMARY_INDEX,Yt.EMAIL_SUMMARY,A5,n);const d={summary:e,importantDetails:t,timestamp:c};await s.setLocalItem(i,d),await tg(s,Yt.EMAIL_SUMMARY_INDEX,i,c,n),n.debug("Added to summary cache",{sourceFile:gr,functionName:"addToSummaryCache",threadId:r})}catch(s){n.warn("Error adding to summary cache",{sourceFile:gr,functionName:"addToSummaryCache",threadId:r,error:s})}}async function G5(r,e){try{const t=await us(e);if(!t)return null;const n=`${Yt.EMAIL_SUMMARY}${r}`,s=await t.getLocalItem(n);return s?Date.now()-s.timestamp>I5?(await t.removeLocalItem(n),null):s:null}catch(t){return e.warn("Error getting from summary cache",{sourceFile:gr,functionName:"getFromSummaryCache",threadId:r,error:t}),null}}async function W5(r){try{const e=await us(r);if(!e)return;const t=await e.getLocalItem(Yt.EMAIL_SUMMARY_INDEX)||[];for(const n of t)await e.removeLocalItem(n.key);await e.removeLocalItem(Yt.EMAIL_SUMMARY_INDEX),r.debug("Summary cache cleared",{sourceFile:gr,functionName:"clearSummaryCache"})}catch(e){r.warn("Error clearing summary cache",{sourceFile:gr,functionName:"clearSummaryCache",error:e})}}async function pT(r,e,t){try{const n=await us(t);if(!n)return;const s=`${Yt.PROJECT_DOCUMENTS}${r}`,i=Date.now();await eg(n,Yt.PROJECT_DOCUMENTS_INDEX,Yt.PROJECT_DOCUMENTS,R5,t);const c={documents:e,timestamp:i};await n.setLocalItem(s,c),await tg(n,Yt.PROJECT_DOCUMENTS_INDEX,s,i,t),t.debug("Added to project document cache",{sourceFile:gr,functionName:"addToProjectDocumentCache",projectId:r})}catch(n){t.warn("Error adding to project document cache",{sourceFile:gr,functionName:"addToProjectDocumentCache",projectId:r,error:n})}}async function mT(r,e){try{const t=await us(e);if(!t)return null;e.debug("Getting documents from project document cache",{sourceFile:gr,functionName:"getFromProjectDocumentCache",projectId:r});const n=`${Yt.PROJECT_DOCUMENTS}${r}`,s=await t.getLocalItem(n);return s?Date.now()-s.timestamp>P5?(await t.removeLocalItem(n),null):s.documents:null}catch(t){return e.warn("Error getting from project document cache",{sourceFile:gr,functionName:"getFromProjectDocumentCache",projectId:r,error:t}),null}}async function V5(r){try{const e=await us(r);if(!e)return;const t=await e.getLocalItem(Yt.DOCUMENTS_INDEX)||[];for(const n of t)await e.removeLocalItem(n.key);await e.removeLocalItem(Yt.DOCUMENTS_INDEX),r.debug("Document cache cleared",{sourceFile:gr,functionName:"clearDocumentCache"})}catch(e){r.warn("Error clearing document cache",{sourceFile:gr,functionName:"clearDocumentCache",error:e})}}async function q5(r,e){try{const t=await us(e);if(!t)return;const n=r.toLowerCase(),s=`${Yt.NON_EXISTENT_CLIENT}${n}`,i=Date.now();await eg(t,Yt.NON_EXISTENT_CLIENT_INDEX,Yt.NON_EXISTENT_CLIENT,j5,e),await t.setLocalItem(s,i),await tg(t,Yt.NON_EXISTENT_CLIENT_INDEX,s,i,e),e.debug("Added to non-existent client cache",{sourceFile:gr,functionName:"addToNonExistentClientCache",email:n})}catch(t){e.warn("Error adding to non-existent client cache",{sourceFile:gr,functionName:"addToNonExistentClientCache",email:r,error:t})}}async function K5(r,e){try{const t=await us(e);if(!t)return!1;const n=r.toLowerCase(),s=`${Yt.NON_EXISTENT_CLIENT}${n}`,i=await t.getLocalItem(s);return i?Date.now()-i>F5?(await t.removeLocalItem(s),!1):!0:!1}catch(t){return e.warn("Error checking non-existent client cache",{sourceFile:gr,functionName:"isInNonExistentClientCache",email:r,error:t}),!1}}async function Y5(r){try{const e=await us(r);if(!e)return;const t=await e.getLocalItem(Yt.NON_EXISTENT_CLIENT_INDEX)||[];for(const n of t)await e.removeLocalItem(n.key);await e.removeLocalItem(Yt.NON_EXISTENT_CLIENT_INDEX),r.debug("Non-existent client cache cleared",{sourceFile:gr,functionName:"clearNonExistentClientCache"})}catch(e){r.warn("Error clearing non-existent client cache",{sourceFile:gr,functionName:"clearNonExistentClientCache",error:e})}}async function gT(r,e,t){try{const n=await us(t);if(!n)return;const s=r.toLowerCase(),i=`${Yt.CLIENT}${s}`,c=Date.now();await eg(n,Yt.CLIENT_INDEX,Yt.CLIENT,O5,t);const d={data:e,timestamp:c};await n.setLocalItem(i,d),await tg(n,Yt.CLIENT_INDEX,i,c,t),t.debug("Added to client cache",{sourceFile:gr,functionName:"addToClientCache",clientEmail:s})}catch(n){t.warn("Error adding to client cache",{sourceFile:gr,functionName:"addToClientCache",clientEmail:r,error:n})}}async function zm(r,e){try{const t=await us(e);if(!t)return null;const n=r.toLowerCase();e.debug("Getting client info from client cache",{sourceFile:gr,functionName:"getFromClientCache",clientEmail:n});const s=`${Yt.CLIENT}${n}`,i=await t.getLocalItem(s);return i?Date.now()-i.timestamp>D5?(await t.removeLocalItem(s),null):i.data:null}catch(t){return e.warn("Error getting from client cache",{sourceFile:gr,functionName:"getFromClientCache",clientEmail:r,error:t}),null}}async function vT(r){try{const e=await us(r);if(!e)return;const t=await e.getLocalItem(Yt.CLIENT_INDEX)||[];for(const n of t)await e.removeLocalItem(n.key);await e.removeLocalItem(Yt.CLIENT_INDEX),r.debug("Client cache cleared",{sourceFile:gr,functionName:"clearClientCache"})}catch(e){r.warn("Error clearing client cache",{sourceFile:gr,functionName:"clearClientCache",error:e})}}async function jw(r,e){try{const t=await us(e);if(!t)return;const n=r.toLowerCase();fT(n);const s=`${Yt.CLIENT}${n}`;await t.removeLocalItem(s);const i=await t.getLocalItem(Yt.CLIENT_INDEX)||[],c=i.filter(S=>S.key!==s);c.length!==i.length&&await t.setLocalItem(Yt.CLIENT_INDEX,c);const d=`${Yt.NON_EXISTENT_CLIENT}${n}`;await t.removeLocalItem(d);const m=await t.getLocalItem(Yt.NON_EXISTENT_CLIENT_INDEX)||[],p=m.filter(S=>S.key!==d);p.length!==m.length&&await t.setLocalItem(Yt.NON_EXISTENT_CLIENT_INDEX,p);const v=`${Yt.DOCUMENTS}${n}`;await t.removeLocalItem(v);const x=await t.getLocalItem(Yt.DOCUMENTS_INDEX)||[],b=x.filter(S=>S.key!==v);b.length!==x.length&&await t.setLocalItem(Yt.DOCUMENTS_INDEX,b),e.debug("Cleared all cached data for client email",{sourceFile:gr,functionName:"clearClientDataForEmail",clientEmail:n})}catch(t){e.warn("Error clearing client data for email",{sourceFile:gr,functionName:"clearClientDataForEmail",clientEmail:r,error:t})}}async function vk(r,e,t,n,s,i,c){try{const d=await us(s);if(!d)return;const m=`${Yt.GENERATED_RESPONSE}${r}`,p=Date.now();await eg(d,Yt.GENERATED_RESPONSE_INDEX,Yt.GENERATED_RESPONSE,L5,s);const v={response:e,references:t,cmsData:n,rawCmsData:i,refreshed:c,timestamp:p};await d.setLocalItem(m,v),await tg(d,Yt.GENERATED_RESPONSE_INDEX,m,p,s),s.debug("Added to generated response cache",{sourceFile:gr,functionName:"addToGeneratedResponseCache",cacheKey:r})}catch(d){s.warn("Error adding to generated response cache",{sourceFile:gr,functionName:"addToGeneratedResponseCache",cacheKey:r,error:d})}}async function J5(r,e){try{const t=await us(e);if(!t)return null;e.debug("Getting generated response from cache",{sourceFile:gr,functionName:"getFromGeneratedResponseCache",cacheKey:r});const n=`${Yt.GENERATED_RESPONSE}${r}`,s=await t.getLocalItem(n);return s?Date.now()-s.timestamp>M5?(await t.removeLocalItem(n),null):s:null}catch(t){return e.warn("Error getting from generated response cache",{sourceFile:gr,functionName:"getFromGeneratedResponseCache",cacheKey:r,error:t}),null}}async function yT(r,e){try{const t=await us(e);if(!t)return;const n={users:r,timestamp:Date.now()};await t.setLocalItem(Yt.FIRM_USERS,n),e.debug("Added to firm users cache",{sourceFile:gr,functionName:"addToFirmUsersCache",count:r.length})}catch(t){e.warn("Error adding to firm users cache",{sourceFile:gr,functionName:"addToFirmUsersCache",error:t})}}async function xT(r){try{const e=await us(r);if(!e)return null;const t=await e.getLocalItem(Yt.FIRM_USERS);return t?Date.now()-t.timestamp>$5?(await e.removeLocalItem(Yt.FIRM_USERS),null):t.users:null}catch(e){return r.warn("Error getting from firm users cache",{sourceFile:gr,functionName:"getFromFirmUsersCache",error:e}),null}}async function X5(r){try{const e=await us(r);if(!e)return;const t=await e.getLocalItem(Yt.GENERATED_RESPONSE_INDEX)||[];for(const n of t)await e.removeLocalItem(n.key);await e.removeLocalItem(Yt.GENERATED_RESPONSE_INDEX),r.debug("Generated response cache cleared",{sourceFile:gr,functionName:"clearGeneratedResponseCache"})}catch(e){r.warn("Error clearing generated response cache",{sourceFile:gr,functionName:"clearGeneratedResponseCache",error:e})}}function wT(r){var e,t,n="";if(typeof r=="string"||typeof r=="number")n+=r;else if(typeof r=="object")if(Array.isArray(r)){var s=r.length;for(e=0;e<s;e++)r[e]&&(t=wT(r[e]))&&(n&&(n+=" "),n+=t)}else for(t in r)r[t]&&(n&&(n+=" "),n+=t);return n}function bT(){for(var r,e,t=0,n="",s=arguments.length;t<s;t++)(r=arguments[t])&&(e=wT(r))&&(n&&(n+=" "),n+=e);return n}const G_="-",Q5=r=>{const e=e6(r),{conflictingClassGroups:t,conflictingClassGroupModifiers:n}=r;return{getClassGroupId:c=>{const d=c.split(G_);return d[0]===""&&d.length!==1&&d.shift(),_T(d,e)||Z5(c)},getConflictingClassGroupIds:(c,d)=>{const m=t[c]||[];return d&&n[c]?[...m,...n[c]]:m}}},_T=(r,e)=>{var c;if(r.length===0)return e.classGroupId;const t=r[0],n=e.nextPart.get(t),s=n?_T(r.slice(1),n):void 0;if(s)return s;if(e.validators.length===0)return;const i=r.join(G_);return(c=e.validators.find(({validator:d})=>d(i)))==null?void 0:c.classGroupId},yk=/^\[(.+)\]$/,Z5=r=>{if(yk.test(r)){const e=yk.exec(r)[1],t=e==null?void 0:e.substring(0,e.indexOf(":"));if(t)return"arbitrary.."+t}},e6=r=>{const{theme:e,prefix:t}=r,n={nextPart:new Map,validators:[]};return r6(Object.entries(r.classGroups),t).forEach(([i,c])=>{Fw(c,n,i,e)}),n},Fw=(r,e,t,n)=>{r.forEach(s=>{if(typeof s=="string"){const i=s===""?e:xk(e,s);i.classGroupId=t;return}if(typeof s=="function"){if(t6(s)){Fw(s(n),e,t,n);return}e.validators.push({validator:s,classGroupId:t});return}Object.entries(s).forEach(([i,c])=>{Fw(c,xk(e,i),t,n)})})},xk=(r,e)=>{let t=r;return e.split(G_).forEach(n=>{t.nextPart.has(n)||t.nextPart.set(n,{nextPart:new Map,validators:[]}),t=t.nextPart.get(n)}),t},t6=r=>r.isThemeGetter,r6=(r,e)=>e?r.map(([t,n])=>{const s=n.map(i=>typeof i=="string"?e+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([c,d])=>[e+c,d])):i);return[t,s]}):r,n6=r=>{if(r<1)return{get:()=>{},set:()=>{}};let e=0,t=new Map,n=new Map;const s=(i,c)=>{t.set(i,c),e++,e>r&&(e=0,n=t,t=new Map)};return{get(i){let c=t.get(i);if(c!==void 0)return c;if((c=n.get(i))!==void 0)return s(i,c),c},set(i,c){t.has(i)?t.set(i,c):s(i,c)}}},ST="!",s6=r=>{const{separator:e,experimentalParseClassName:t}=r,n=e.length===1,s=e[0],i=e.length,c=d=>{const m=[];let p=0,v=0,x;for(let T=0;T<d.length;T++){let A=d[T];if(p===0){if(A===s&&(n||d.slice(T,T+i)===e)){m.push(d.slice(v,T)),v=T+i;continue}if(A==="/"){x=T;continue}}A==="["?p++:A==="]"&&p--}const b=m.length===0?d:d.substring(v),S=b.startsWith(ST),N=S?b.substring(1):b,E=x&&x>v?x-v:void 0;return{modifiers:m,hasImportantModifier:S,baseClassName:N,maybePostfixModifierPosition:E}};return t?d=>t({className:d,parseClassName:c}):c},o6=r=>{if(r.length<=1)return r;const e=[];let t=[];return r.forEach(n=>{n[0]==="["?(e.push(...t.sort(),n),t=[]):t.push(n)}),e.push(...t.sort()),e},i6=r=>({cache:n6(r.cacheSize),parseClassName:s6(r),...Q5(r)}),a6=/\s+/,l6=(r,e)=>{const{parseClassName:t,getClassGroupId:n,getConflictingClassGroupIds:s}=e,i=[],c=r.trim().split(a6);let d="";for(let m=c.length-1;m>=0;m-=1){const p=c[m],{modifiers:v,hasImportantModifier:x,baseClassName:b,maybePostfixModifierPosition:S}=t(p);let N=!!S,E=n(N?b.substring(0,S):b);if(!E){if(!N){d=p+(d.length>0?" "+d:d);continue}if(E=n(b),!E){d=p+(d.length>0?" "+d:d);continue}N=!1}const T=o6(v).join(":"),A=x?T+ST:T,I=A+E;if(i.includes(I))continue;i.push(I);const D=s(E,N);for(let j=0;j<D.length;++j){const O=D[j];i.push(A+O)}d=p+(d.length>0?" "+d:d)}return d};function c6(){let r=0,e,t,n="";for(;r<arguments.length;)(e=arguments[r++])&&(t=ET(e))&&(n&&(n+=" "),n+=t);return n}const ET=r=>{if(typeof r=="string")return r;let e,t="";for(let n=0;n<r.length;n++)r[n]&&(e=ET(r[n]))&&(t&&(t+=" "),t+=e);return t};function u6(r,...e){let t,n,s,i=c;function c(m){const p=e.reduce((v,x)=>x(v),r());return t=i6(p),n=t.cache.get,s=t.cache.set,i=d,d(m)}function d(m){const p=n(m);if(p)return p;const v=l6(m,t);return s(m,v),v}return function(){return i(c6.apply(null,arguments))}}const nn=r=>{const e=t=>t[r]||[];return e.isThemeGetter=!0,e},kT=/^\[(?:([a-z-]+):)?(.+)\]$/i,d6=/^\d+\/\d+$/,f6=new Set(["px","full","screen"]),h6=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,p6=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,m6=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,g6=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,v6=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Fl=r=>th(r)||f6.has(r)||d6.test(r),Lc=r=>wh(r,"length",k6),th=r=>!!r&&!Number.isNaN(Number(r)),Cx=r=>wh(r,"number",th),Wp=r=>!!r&&Number.isInteger(Number(r)),y6=r=>r.endsWith("%")&&th(r.slice(0,-1)),or=r=>kT.test(r),Mc=r=>h6.test(r),x6=new Set(["length","size","percentage"]),w6=r=>wh(r,x6,CT),b6=r=>wh(r,"position",CT),_6=new Set(["image","url"]),S6=r=>wh(r,_6,N6),E6=r=>wh(r,"",C6),Vp=()=>!0,wh=(r,e,t)=>{const n=kT.exec(r);return n?n[1]?typeof e=="string"?n[1]===e:e.has(n[1]):t(n[2]):!1},k6=r=>p6.test(r)&&!m6.test(r),CT=()=>!1,C6=r=>g6.test(r),N6=r=>v6.test(r),T6=()=>{const r=nn("colors"),e=nn("spacing"),t=nn("blur"),n=nn("brightness"),s=nn("borderColor"),i=nn("borderRadius"),c=nn("borderSpacing"),d=nn("borderWidth"),m=nn("contrast"),p=nn("grayscale"),v=nn("hueRotate"),x=nn("invert"),b=nn("gap"),S=nn("gradientColorStops"),N=nn("gradientColorStopPositions"),E=nn("inset"),T=nn("margin"),A=nn("opacity"),I=nn("padding"),D=nn("saturate"),j=nn("scale"),O=nn("sepia"),B=nn("skew"),G=nn("space"),K=nn("translate"),re=()=>["auto","contain","none"],se=()=>["auto","hidden","clip","visible","scroll"],he=()=>["auto",or,e],U=()=>[or,e],ge=()=>["",Fl,Lc],ie=()=>["auto",th,or],ae=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],de=()=>["solid","dashed","dotted","double","none"],J=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],Y=()=>["start","end","center","between","around","evenly","stretch"],$=()=>["","0",or],Q=()=>["auto","avoid","all","avoid-page","page","left","right","column"],F=()=>[th,or];return{cacheSize:500,separator:":",theme:{colors:[Vp],spacing:[Fl,Lc],blur:["none","",Mc,or],brightness:F(),borderColor:[r],borderRadius:["none","","full",Mc,or],borderSpacing:U(),borderWidth:ge(),contrast:F(),grayscale:$(),hueRotate:F(),invert:$(),gap:U(),gradientColorStops:[r],gradientColorStopPositions:[y6,Lc],inset:he(),margin:he(),opacity:F(),padding:U(),saturate:F(),scale:F(),sepia:$(),skew:F(),space:U(),translate:U()},classGroups:{aspect:[{aspect:["auto","square","video",or]}],container:["container"],columns:[{columns:[Mc]}],"break-after":[{"break-after":Q()}],"break-before":[{"break-before":Q()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...ae(),or]}],overflow:[{overflow:se()}],"overflow-x":[{"overflow-x":se()}],"overflow-y":[{"overflow-y":se()}],overscroll:[{overscroll:re()}],"overscroll-x":[{"overscroll-x":re()}],"overscroll-y":[{"overscroll-y":re()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[E]}],"inset-x":[{"inset-x":[E]}],"inset-y":[{"inset-y":[E]}],start:[{start:[E]}],end:[{end:[E]}],top:[{top:[E]}],right:[{right:[E]}],bottom:[{bottom:[E]}],left:[{left:[E]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Wp,or]}],basis:[{basis:he()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",or]}],grow:[{grow:$()}],shrink:[{shrink:$()}],order:[{order:["first","last","none",Wp,or]}],"grid-cols":[{"grid-cols":[Vp]}],"col-start-end":[{col:["auto",{span:["full",Wp,or]},or]}],"col-start":[{"col-start":ie()}],"col-end":[{"col-end":ie()}],"grid-rows":[{"grid-rows":[Vp]}],"row-start-end":[{row:["auto",{span:[Wp,or]},or]}],"row-start":[{"row-start":ie()}],"row-end":[{"row-end":ie()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",or]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",or]}],gap:[{gap:[b]}],"gap-x":[{"gap-x":[b]}],"gap-y":[{"gap-y":[b]}],"justify-content":[{justify:["normal",...Y()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...Y(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...Y(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[I]}],px:[{px:[I]}],py:[{py:[I]}],ps:[{ps:[I]}],pe:[{pe:[I]}],pt:[{pt:[I]}],pr:[{pr:[I]}],pb:[{pb:[I]}],pl:[{pl:[I]}],m:[{m:[T]}],mx:[{mx:[T]}],my:[{my:[T]}],ms:[{ms:[T]}],me:[{me:[T]}],mt:[{mt:[T]}],mr:[{mr:[T]}],mb:[{mb:[T]}],ml:[{ml:[T]}],"space-x":[{"space-x":[G]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[G]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",or,e]}],"min-w":[{"min-w":[or,e,"min","max","fit"]}],"max-w":[{"max-w":[or,e,"none","full","min","max","fit","prose",{screen:[Mc]},Mc]}],h:[{h:[or,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[or,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[or,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[or,e,"auto","min","max","fit"]}],"font-size":[{text:["base",Mc,Lc]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Cx]}],"font-family":[{font:[Vp]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",or]}],"line-clamp":[{"line-clamp":["none",th,Cx]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Fl,or]}],"list-image":[{"list-image":["none",or]}],"list-style-type":[{list:["none","disc","decimal",or]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[r]}],"placeholder-opacity":[{"placeholder-opacity":[A]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[r]}],"text-opacity":[{"text-opacity":[A]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...de(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Fl,Lc]}],"underline-offset":[{"underline-offset":["auto",Fl,or]}],"text-decoration-color":[{decoration:[r]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:U()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",or]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",or]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[A]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...ae(),b6]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",w6]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},S6]}],"bg-color":[{bg:[r]}],"gradient-from-pos":[{from:[N]}],"gradient-via-pos":[{via:[N]}],"gradient-to-pos":[{to:[N]}],"gradient-from":[{from:[S]}],"gradient-via":[{via:[S]}],"gradient-to":[{to:[S]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[d]}],"border-w-x":[{"border-x":[d]}],"border-w-y":[{"border-y":[d]}],"border-w-s":[{"border-s":[d]}],"border-w-e":[{"border-e":[d]}],"border-w-t":[{"border-t":[d]}],"border-w-r":[{"border-r":[d]}],"border-w-b":[{"border-b":[d]}],"border-w-l":[{"border-l":[d]}],"border-opacity":[{"border-opacity":[A]}],"border-style":[{border:[...de(),"hidden"]}],"divide-x":[{"divide-x":[d]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[d]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[A]}],"divide-style":[{divide:de()}],"border-color":[{border:[s]}],"border-color-x":[{"border-x":[s]}],"border-color-y":[{"border-y":[s]}],"border-color-s":[{"border-s":[s]}],"border-color-e":[{"border-e":[s]}],"border-color-t":[{"border-t":[s]}],"border-color-r":[{"border-r":[s]}],"border-color-b":[{"border-b":[s]}],"border-color-l":[{"border-l":[s]}],"divide-color":[{divide:[s]}],"outline-style":[{outline:["",...de()]}],"outline-offset":[{"outline-offset":[Fl,or]}],"outline-w":[{outline:[Fl,Lc]}],"outline-color":[{outline:[r]}],"ring-w":[{ring:ge()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[r]}],"ring-opacity":[{"ring-opacity":[A]}],"ring-offset-w":[{"ring-offset":[Fl,Lc]}],"ring-offset-color":[{"ring-offset":[r]}],shadow:[{shadow:["","inner","none",Mc,E6]}],"shadow-color":[{shadow:[Vp]}],opacity:[{opacity:[A]}],"mix-blend":[{"mix-blend":[...J(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":J()}],filter:[{filter:["","none"]}],blur:[{blur:[t]}],brightness:[{brightness:[n]}],contrast:[{contrast:[m]}],"drop-shadow":[{"drop-shadow":["","none",Mc,or]}],grayscale:[{grayscale:[p]}],"hue-rotate":[{"hue-rotate":[v]}],invert:[{invert:[x]}],saturate:[{saturate:[D]}],sepia:[{sepia:[O]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[t]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[m]}],"backdrop-grayscale":[{"backdrop-grayscale":[p]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[v]}],"backdrop-invert":[{"backdrop-invert":[x]}],"backdrop-opacity":[{"backdrop-opacity":[A]}],"backdrop-saturate":[{"backdrop-saturate":[D]}],"backdrop-sepia":[{"backdrop-sepia":[O]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[c]}],"border-spacing-x":[{"border-spacing-x":[c]}],"border-spacing-y":[{"border-spacing-y":[c]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",or]}],duration:[{duration:F()}],ease:[{ease:["linear","in","out","in-out",or]}],delay:[{delay:F()}],animate:[{animate:["none","spin","ping","pulse","bounce",or]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[j]}],"scale-x":[{"scale-x":[j]}],"scale-y":[{"scale-y":[j]}],rotate:[{rotate:[Wp,or]}],"translate-x":[{"translate-x":[K]}],"translate-y":[{"translate-y":[K]}],"skew-x":[{"skew-x":[B]}],"skew-y":[{"skew-y":[B]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",or]}],accent:[{accent:["auto",r]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",or]}],"caret-color":[{caret:[r]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":U()}],"scroll-mx":[{"scroll-mx":U()}],"scroll-my":[{"scroll-my":U()}],"scroll-ms":[{"scroll-ms":U()}],"scroll-me":[{"scroll-me":U()}],"scroll-mt":[{"scroll-mt":U()}],"scroll-mr":[{"scroll-mr":U()}],"scroll-mb":[{"scroll-mb":U()}],"scroll-ml":[{"scroll-ml":U()}],"scroll-p":[{"scroll-p":U()}],"scroll-px":[{"scroll-px":U()}],"scroll-py":[{"scroll-py":U()}],"scroll-ps":[{"scroll-ps":U()}],"scroll-pe":[{"scroll-pe":U()}],"scroll-pt":[{"scroll-pt":U()}],"scroll-pr":[{"scroll-pr":U()}],"scroll-pb":[{"scroll-pb":U()}],"scroll-pl":[{"scroll-pl":U()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",or]}],fill:[{fill:[r,"none"]}],"stroke-w":[{stroke:[Fl,Lc,Cx]}],stroke:[{stroke:[r,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},A6=u6(T6);function Fr(...r){return A6(bT(r))}async function Nx(r){let e;if(r instanceof File)e=await r.arrayBuffer();else if(r instanceof ArrayBuffer)e=r;else if(r instanceof Uint8Array)e=r.buffer;else throw new Error("Unsupported data type for checksum calculation");const t=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(t)).map(i=>i.toString(16).padStart(2,"0")).join("")}const Cr="src/lib/utils/serverUtils.tsx",Tx=new Map,$f=3,wk=1e3;function bk(r){if(r instanceof Error){const e=r.message.toLowerCase();return e.includes("timeout")||e.includes("network")||e.includes("failed to fetch")||e.includes("504")||e.includes("503")}return!1}function Hy(r){const e=["x-trace-id","x-request-id","x-correlation-id","x-amzn-request-id","x-amzn-requestid","x-amzn-trace-id","request-id","trace-id","correlation-id"];for(const t of e){const n=r.headers.get(t);if(n)return n}return null}new URL(Ar+"/email-template");const I6=new URL(Ar+"/email-templates"),R6=new URL(Ar+"/email/generate"),P6=new URL(Ar+"/email/generate_for_outlook"),j6=new URL(Ar+"/email/reformat"),F6=new URL(Ar+"/email/participants");new URL(Ar+"/email/participants_with_category");new URL(Ar+"/email/register");new URL(Ar+"/email/unregister");const O6=new URL(Ar+"/email/get_registration"),D6=new URL(Ar+"/email/summarization"),L6=new URL(Ar+"/email/description_summarization"),M6=new URL(Ar+"/email/summarization_for_outlook"),$6=new URL(Ar+"/email/archive");new URL(Ar+"/integration");const U6=new URL(Ar+"/integrations"),z6=new URL(Ar+"/integrations/client"),H6=new URL(Ar+"/integrations/document");new URL(Ar+"/integrations/clients");const B6=new URL(Ar+"/integrations/project_documents"),G6=new URL(Ar+"/integrations/case_summary");new URL(Ar+"/integrations/uscis/case");const W6=new URL(Ar+"/integrations/user"),NT=new URL(Ar+"/integrations/users"),rg=new URL(Ar+"/integrations/write"),V6=new URL(Ar+"/integrations/projects"),q6=new URL(Ar+"/integrations/project");new URL(Ar+"/integrations/contacts");const K6=new URL(Ar+"/integrations/settings"),Y6=new URL(Ar+"/email/generate_task_description");new URL(Ar+"/admin/users");new URL(Ar+"/admin/user");const J6="CANDLE_ERROR_TOKEN_NOT_FOUND",X6="CANDLE_ERROR_TOKEN_REFRESH_FAILED";function md(r,e){const t={sourceFile:Cr};e.status===404?e.json().then(n=>{(n.error_code===J6||n.error_code===X6)&&(r.warn("404 error, Gmail might be disconnected from server, checking...",{...t,data:n}),By(r).then(s=>{s||r.error("Gmail has been disconnected from server unexpectedly!",new Error("Gmail has been disconnected from server, syncing..."),{...t,data:n})}))}):r.warn("HTTP error! status: "+e.status,{...t,data:e})}async function Q6(r){const e={sourceFile:Cr};r.debug("Starting to fetch response...",e);const t=await Yr(I6,{method:"GET",headers:{"Content-Type":"application/json"}},r);if(r.debug("Response received:",{...e,data:t}),!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const n=t.headers.get("content-type");if(r.debug("Content-Type:",{...e,data:n}),n&&n.includes("application/json")){r.debug("Content-Type is JSON, parsing...",e);const s=await t.json();r.debug("Parsed JSON response:",{...e,data:s}),s.user_templates&&s.user_templates.length>0&&r.debug("First user template tags:",{...e,data:s.user_templates[0].tags}),s.org_templates&&s.org_templates.length>0&&r.debug("First org template tags:",{...e,data:s.org_templates[0].tags});const i=s.user_templates.map(d=>({...d,source:"SCOPE_USER"})),c=s.org_templates.map(d=>({...d,source:"SCOPE_TENANT"}));return r.debug("Enhanced user templates with source:",{...e,data:i}),r.debug("Enhanced org templates with source:",{...e,data:c}),{user_templates:i,org_templates:c}}else{r.debug("Content-Type is not JSON, handling as text...",e);const s=await t.text();throw r.error("Received non-JSON response:",s,e),new Error("Received non-JSON response from server")}}async function TT(r,e,t,n,s,i=[],c,d=!1){const m={sourceFile:Cr};c.debug("Starting to fetch response...",m),d?c.info("Force refresh flag is TRUE - will bypass backend cache",{...m,forceRefresh:!0}):c.debug("Force refresh flag is FALSE - will use cache-first",{...m,forceRefresh:!1});const p=[{role:"user",content:"Here's some additional relevant context to help with your response:"+t},{role:"user",content:"This is the specific email in the thread to respond to:"+e}],v={WEB_SOURCES:{PUBLIC:i}};try{const x=await Yr(R6,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email_thread_id:r,datasources:v,format_instruction:s+" "+n,additional_context:p,force_refresh:d})},c);if(c.debug("Response received:",{...m,data:x}),!x.ok)throw md(c,x),new Error(`HTTP error! status: ${x.status}`);const b=x.headers.get("content-type");c.debug("Content-Type:",{...m,data:b});let S;if(b&&b.includes("application/json"))c.debug("Content-Type is JSON, parsing...",m),S=await x.json();else{c.debug("Content-Type is not JSON, handling as text...",m);const B=await x.text();throw c.error("Received non-JSON response:",B,m),new Error("Received non-JSON response from server")}c.info("Parsed JSON response:",{...m,data:S});const N=S.response,E=S.references,T=S.cms_fields_used,A=S.cms_data,I=S.raw_cms_data;c.info("Result response:",{...m,data:N}),c.info("Result references:",{...m,data:E});const O=new DOMParser().parseFromString(N,"text/html").body.innerHTML;return c.debug("Extracted HTML body content:",{...m,data:O}),{response:O,references:E,cms_fields_used:T,cms_data:A,raw_cms_data:I,refreshed:S.refreshed??!1}}catch(x){return c.error("Error caught:",x,m),{response:"error",references:[],cms_fields_used:[],cms_data:[]}}}async function AT(r,e,t,n,s,i,c,d=!1){const m={sourceFile:Cr};c.debug("Starting to fetch response for Outlook...",m),d?c.info("Force refresh flag is TRUE - will bypass backend cache",{...m,forceRefresh:!0}):c.debug("Force refresh flag is FALSE - will use cache-first",{...m,forceRefresh:!1});const p=[{role:"user",content:"Here's some additional relevant context to help with your response:"+t}];try{const v=await Yr(P6,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({thread_id:r,full_thread:e,email_participants:i,format_instruction:s+" "+n,additional_context:p,force_refresh:d})},c);if(c.debug("Response received:",{...m,data:v}),!v.ok)throw new Error(`HTTP error! status: ${v.status}`);const x=v.headers.get("content-type");c.debug("Content-Type:",{...m,data:x});let b;if(x&&x.includes("application/json"))c.debug("Content-Type is JSON, parsing...",m),b=await v.json();else{c.debug("Content-Type is not JSON, handling as text...",m);const O=await v.text();throw c.error("Received non-JSON response:",O,m),new Error("Received non-JSON response from server")}c.info("Parsed JSON response:",{...m,data:b});const S=b.response,N=b.references,E=b.cms_fields_used,T=b.cms_data,A=b.raw_cms_data;c.debug("Result response:",{...m,data:S}),c.debug("Result references:",{...m,data:N});const j=new DOMParser().parseFromString(S,"text/html").body.innerHTML;return c.debug("Extracted HTML body content:",{...m,data:j}),{response:j,references:N,cms_fields_used:E,cms_data:T,raw_cms_data:A,refreshed:b.refreshed??!1}}catch(v){return c.error("Error caught:",v,m),{response:"error",references:[],cms_fields_used:[],cms_data:[]}}}async function Z6(r,e){const t=r==null?void 0:r.case_management_systems_data;if(!t||typeof t!="object")return;const n=Object.entries(t);if(n.length>100){e.warn("Skipping cache prefill: raw_cms_data exceeds 100 entries",{sourceFile:Cr,count:n.length});return}for(const[s,i]of n)if(!(!s||typeof s!="string"||!i||typeof i!="object"||await zm(s,e)))for(const[,d]of Object.entries(i))!d||typeof d!="object"||await gT(s,{client_data:Array.isArray(d.client_data)?d.client_data:[],case_data:d.case_data||[],pagination:d.pagination},e)}async function IT(r,e,t,n){const s={sourceFile:Cr};t.debug("Starting to fetch response...",s);const i=await Yr(j6,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({reformat_instruction:e,chat_history:[{content:"Here's the HTML Content. Respond with only the HTML content for the revised email response:"+r}],...n&&{thread_id:n}})},t);if(t.debug("Response received:",{...s,data:i}),!i.ok)throw new Error(`HTTP error! status: ${i.status}`);const c=i.headers.get("content-type");if(t.debug("Content-Type:",{...s,data:c}),c&&c.includes("application/json")){t.debug("Content-Type is JSON, parsing...",s);const d=await i.json();t.debug("Parsed JSON response:",{...s,data:d});const m=d.replace(/^```html\s*/,"");t.debug("Cleaned data:",{...s,data:m});const x=new DOMParser().parseFromString(m,"text/html").body.innerHTML;return t.debug("Extracted HTML body content:",{...s,data:x}),x}else{t.debug("Content-Type is not JSON, handling as text...",s);const d=await i.text();throw t.error("Received non-JSON response:",d,s),new Error("Received non-JSON response from server")}}async function Zc(r,e){const t={sourceFile:Cr};e.debug("Starting to list integrations...",t);const n=new URL(U6);n.searchParams.append("integration_scope",r);try{const s=await Yr(n,{method:"GET",headers:{"Content-Type":"application/json"}},e);if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const i=s.headers.get("content-type");if(i&&i.includes("application/json")){const c=await s.json();e.debug("Integrations:",{...t,data:c.integrations});const d=c.integrations.map(m=>({integration_type:m.integration_type,tenantId_userId:m.tenantId_userId,scope:r}));return await Qm(e,d),d||[]}else throw new Error("Received non-JSON response from server")}catch(s){throw e.error("Error listing integrations:",s,t),s}}async function By(r){const e={sourceFile:Cr};r.debug("Starting to check if Gmail integration is connected...",e);try{const t=await Yr(O6,{method:"GET",headers:{"Content-Type":"application/json"}},r);r.debug("Response received:",{...e,data:t});let n=!1;if(t.ok){const s=await t.json();r.debug("Parsed JSON response:",{...e,data:s}),n=s.is_registered===!0}return await OU(r,n),n}catch(t){r.error("Error checking Gmail connection status:",t,e);try{const n=await DU(r);if(n.isConnected!==null)return r.debug("Returning cached Gmail connection status due to error",{...e,cachedStatus:n.isConnected,cachedTimestamp:n.timestamp}),n.isConnected}catch(n){r.error("Error retrieving cached Gmail connection status:",n,e)}return!1}}async function e8(r,e){const t={sourceFile:Cr};try{const n=await Yr(D6,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email_thread_id:r})},e);if(e.debug("Response received:",{...t,data:n}),!n.ok)throw md(e,n),new Error(`HTTP error! status: ${n.status}`);const s=n.headers.get("content-type");if(s&&s.includes("application/json")){const i=await n.json();if(!i||!i.message)throw new Error("Summary not found in response");let c=null;if(i.message.important_details)try{typeof i.message.important_details=="object"?(e.debug("Important details is already an object, using it directly...",t),c=i.message.important_details):typeof i.message.important_details=="string"&&(e.debug("Important details is a JSON string, parsing...",t),c=JSON.parse(i.message.important_details)),e.debug("Parsed important details:",{...t,data:c})}catch(d){e.error("Error parsing important details:",d,t),c=null}return{summary:i.message.summary,importantDetails:c,topicsDiscussed:i.message.topics_discussed,actionItems:i.message.action_items}}else throw new Error("Received non-JSON response from server")}catch(n){return e.error("Error caught:",n,t),{summary:"Error fetching email summary: "+n,importantDetails:null,topicsDiscussed:"",actionItems:""}}}async function _k(r,e,t){const n={sourceFile:Cr};try{const s=await Yr(L6,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email_thread_id:r,email_thread_content:e})},t);if(t.debug("Response received:",{...n,data:s}),!s.ok)throw md(t,s),new Error(`HTTP error! status: ${s.status}`);const i=s.headers.get("content-type");if(i&&i.includes("application/json")){const c=await s.json();if(!c||!c.message)throw new Error("Summary not found in response");return{description:c.message}}else throw new Error("Received non-JSON response from server")}catch(s){return t.error("Error caught:",s,n),{description:""}}}async function t8(r,e){const t={sourceFile:Cr};try{const n=await Yr(M6,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({full_thread:r})},e);if(e.debug("Response received:",{...t,data:n}),!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const s=n.headers.get("content-type");if(s&&s.includes("application/json")){const i=await n.json();if(!i||!i.message)throw new Error("Summary not found in response");let c=null;if(i.message.important_details)try{typeof i.message.important_details=="object"?(e.debug("Important details is already an object, using it directly...",t),c=i.message.important_details):typeof i.message.important_details=="string"&&(e.debug("Important details is a JSON string, parsing...",t),c=JSON.parse(i.message.important_details)),e.debug("Parsed important details:",{...t,data:c})}catch(d){e.error("Error parsing important details:",d,t),c=null}return{summary:i.message.summary,importantDetails:c,topicsDiscussed:i.message.topics_discussed,actionItems:i.message.action_items}}else throw new Error("Received non-JSON response from server")}catch(n){return e.error("Error caught:",n,t),{summary:"Error fetching email summary: "+n,importantDetails:null,topicsDiscussed:"",actionItems:""}}}async function W_(r,e,t,n=!1,s,i){const c={sourceFile:Cr,functionName:"getClientDataFromServer"},d=e.toLowerCase(),m=s!=null&&s.cursor?`:cursor_${s.cursor}`:"",p=`${r}:${d}${m}`,v=Tx.get(p);if(v)return t.debug("Returning existing in-flight request",{...c,clientEmail:e}),console.log(` [${r.toUpperCase()}] Deduplicating request for ${e} - returning in-flight promise`),v;const x=Ow(r,e,t,n,s,i);return Tx.set(p,x),x.finally(()=>{Tx.delete(p)})}async function Ow(r,e,t,n=!1,s,i,c=0){const d={sourceFile:Cr,functionName:"fetchClientDataInternal"},m=Date.now();if(console.group(` [${r.toUpperCase()}] getClientDataFromServer - ${e}${c>0?` (retry ${c})`:""}`),console.time("getClientDataFromServer:total"),console.log("Integration:",r),console.log("Client Email:",e),t.info("Starting client data fetch",{...d,clientEmail:e,integrationType:r,retryCount:c}),c===0){const T=z5(e);if(T.inCache)throw console.log(` Timeout cache hit: Email recently failed with ${T.errorType}`),console.timeEnd("getClientDataFromServer:total"),console.groupEnd(),t.info("Email in timeout cache, skipping API call to prevent retry storm",{...d,clientEmail:e,errorType:T.errorType,totalMs:Date.now()-m}),new Error(`Request recently failed (${T.errorType}) - try again later`)}console.time("getClientDataFromServer:nonExistentCacheCheck");const p=Date.now(),v=await K5(e,t),x=Date.now()-p;if(console.timeEnd("getClientDataFromServer:nonExistentCacheCheck"),v)throw console.log(" Non-existent cache hit: Email known to have no client data"),console.timeEnd("getClientDataFromServer:total"),console.groupEnd(),t.info("Email in non-existent cache, skipping API call",{...d,clientEmail:e,nonExistentCacheCheckMs:x,totalMs:Date.now()-m}),new Error("Client not found (cached)");console.time("getClientDataFromServer:clientCacheCheck");const b=Date.now(),S=s!=null&&s.cursor?null:await zm(e,t),N=Date.now()-b;if(console.timeEnd("getClientDataFromServer:clientCacheCheck"),S)return console.log(" Cache hit: Client data found in cache"),console.timeEnd("getClientDataFromServer:total"),console.groupEnd(),t.info("Client data found in cache",{...d,clientEmail:e,nonExistentCacheCheckMs:x,clientCacheCheckMs:N,totalMs:Date.now()-m}),S;const E=new URL(z6);E.searchParams.append("integration_type",r),E.searchParams.append("client_email",e),E.searchParams.append("data_type","client_data"),s&&(E.searchParams.append("limit",String(s.limit||10)),s.cursor&&E.searchParams.append("cursor",s.cursor)),i&&E.searchParams.append("thread_id",i),n&&E.searchParams.append("force_refresh","true");try{console.time("getClientDataFromServer:apiCall"),console.log(" Making API request to:",E.toString());const T=Date.now(),A=await Yr(E,{method:"GET",headers:{"Content-Type":"application/json"}},t),I=Date.now()-T,D=Hy(A);if(console.timeEnd("getClientDataFromServer:apiCall"),console.log(" Response status:",A.status,`(${I}ms)`),console.log(" Trace ID:",D||"N/A"),A.status===504||A.status===503)if(console.error(` ${A.status} Gateway Timeout - API call took too long`),console.log("Request URL:",E.toString()),console.log("Time elapsed before timeout:",I,"ms"),console.log(" Trace ID for debugging:",D||"N/A"),c<$f){const O=wk*Math.pow(2,c);return console.log(` Retrying in ${O}ms (attempt ${c+1}/${$f})`),console.timeEnd("getClientDataFromServer:total"),console.groupEnd(),t.info("Retrying after timeout",{...d,clientEmail:e,status:A.status,retryCount:c+1,delayMs:O,traceId:D}),await new Promise(B=>setTimeout(B,O)),Ow(r,e,t,n,s,i,c+1)}else gk(e,`${A.status}`),console.log(` Max retries (${$f}) exhausted, added to timeout cache`),t.warn("Max retries exhausted for timeout error, added to timeout cache",{...d,clientEmail:e,status:A.status,retryCount:c,traceId:D});if(t.info("API response received",{...d,clientEmail:e,status:A.status,apiMs:I,nonExistentCacheCheckMs:x,clientCacheCheckMs:N,traceId:D,retryCount:c}),!A.ok){if(A.status===404&&(await q5(e,t),md(t,A)),A.status===429)try{const O=await A.json(),B=Array.isArray(O==null?void 0:O.client_data)?O.client_data.length>0:(O==null?void 0:O.client_data)&&Object.keys(O.client_data).length>0,G=Array.isArray(O==null?void 0:O.case_data)?O.case_data.length>0:(O==null?void 0:O.case_data)&&Object.keys(O.case_data).length>0;return t.info("Rate limited response received",{sourceFile:Cr,hasCachedData:B||G,source:O==null?void 0:O.source,retryAfter:O==null?void 0:O.retry_after}),console.timeEnd("getClientDataFromServer:total"),console.groupEnd(),{client_data:Array.isArray(O==null?void 0:O.client_data)?O.client_data:[],case_data:Array.isArray(O==null?void 0:O.case_data)?O.case_data:[],pagination:O==null?void 0:O.pagination,_rate_limited:!0,_retry_after:O==null?void 0:O.retry_after}}catch{}if(console.error(" API error:",A.status),console.timeEnd("getClientDataFromServer:total"),console.groupEnd(),A.status===400)try{const O=await A.json();if(O!=null&&O.error)throw new Error(`HTTP error! status: 400 - ${O.error}`)}catch(O){if(O instanceof Error&&O.message.startsWith("HTTP error!"))throw O}throw new Error(`HTTP error! status: ${A.status}`)}const j=A.headers.get("content-type");if(j&&j.includes("application/json")){console.time("getClientDataFromServer:parseJson");const O=Date.now(),B=await A.json(),G=Date.now()-O;console.timeEnd("getClientDataFromServer:parseJson");const K=B.requestId,re=B.traceId,se=K||D;K&&console.log(" Request ID (from body):",K),re&&console.log(" Trace ID (from body):",re);const he={client_data:B.client_data||{},case_data:B.case_data||[],pagination:B.pagination||void 0};console.time("getClientDataFromServer:cacheWrite");const U=Date.now();s!=null&&s.cursor||await gT(e,he,t);const ge=Date.now()-U;console.timeEnd("getClientDataFromServer:cacheWrite"),fT(e);const ie=Date.now()-m;return console.log(" Client data fetch completed"),console.log(" Timing breakdown:",{nonExistentCacheCheck:`${x}ms`,clientCacheCheck:`${N}ms`,apiCall:`${I}ms`,parseJson:`${G}ms`,cacheWrite:`${ge}ms`,total:`${ie}ms`}),console.timeEnd("getClientDataFromServer:total"),console.groupEnd(),t.info("Client data fetch completed",{...d,clientEmail:e,nonExistentCacheCheckMs:x,clientCacheCheckMs:N,apiMs:I,parseMs:G,cacheWriteMs:ge,totalMs:ie,retryCount:c,requestId:se,traceId:re||D}),he}else throw console.error(" Received non-JSON response"),console.timeEnd("getClientDataFromServer:total"),console.groupEnd(),new Error("Received non-JSON response from server")}catch(T){const A=Date.now()-m;if(c<$f&&bk(T)){const I=wk*Math.pow(2,c);return console.log(` Retrying after error in ${I}ms (attempt ${c+1}/${$f})`),console.timeEnd("getClientDataFromServer:total"),console.groupEnd(),t.info("Retrying after network error",{...d,clientEmail:e,error:T instanceof Error?T.message:String(T),retryCount:c+1,delayMs:I}),await new Promise(D=>setTimeout(D,I)),Ow(r,e,t,n,s,i,c+1)}if(bk(T)){const I=T instanceof Error?T.message.includes("timeout")?"timeout":"network":"unknown";gk(e,I),console.log(` Max retries (${$f}) exhausted for ${I} error, added to timeout cache`),t.warn("Max retries exhausted for network error, added to timeout cache",{...d,clientEmail:e,errorType:I,retryCount:c})}throw console.error(" Client data fetch failed:",T instanceof Error?T.message:String(T)),console.log(" Timing at failure:",{nonExistentCacheCheck:`${x}ms`,clientCacheCheck:`${N}ms`,total:`${A}ms`}),console.timeEnd("getClientDataFromServer:total"),console.groupEnd(),t.info("Client data fetch failed",{...d,clientEmail:e,error:T instanceof Error?T.message:String(T),nonExistentCacheCheckMs:x,clientCacheCheckMs:N,totalMs:A,retryCount:c}),T}}async function RT(r,e,t){const n={sourceFile:Cr,functionName:"getDocumentListForProject"};t.debug("Starting to fetch project documents...",{...n,projectId:e});const s=new URL(B6);s.searchParams.append("integration_type",r),s.searchParams.append("project_id",e);try{const i=await Yr(s,{method:"GET",headers:{"Content-Type":"application/json"}},t);if(t.debug("Response received:",{...n,data:i}),!i.ok){if(i.status===404)return md(t,i),{documents:[]};throw new Error(`HTTP error! status: ${i.status}`)}const c=i.headers.get("content-type");if(c&&c.includes("application/json")){const d=await i.json();return t.debug("Parsed JSON response:",{...n,data:d}),{documents:d.documents||[]}}else throw new Error("Received non-JSON response from server")}catch(i){throw t.debug("Error fetching project documents:",{...n,error:i}),i}}async function r8(r,e,t){const n={sourceFile:Cr,functionName:"getCaseSummaryForProject"};t.debug("Starting to fetch case summary...",{...n,projectId:e});const s=new URL(G6);s.searchParams.append("integration_type",r),s.searchParams.append("project_id",e);try{const i=await Yr(s,{method:"GET",headers:{"Content-Type":"application/json"}},t);if(t.debug("Response received:",{...n,data:i}),!i.ok){if(i.status===404)return md(t,i),null;throw new Error(`HTTP error! status: ${i.status}`)}const c=i.headers.get("content-type");if(c&&c.includes("application/json")){const d=await i.json();return t.debug("Parsed JSON response:",{...n,data:d}),{caseFacts:d.caseFacts||"",supioLink:d.supioLink||"",caseType:d.caseType||"",statuteoflimitations:d.statuteoflimitations||{dateValue:"",doneDate:null},disbursementSheet:d.disbursementSheet||null,totalMeds:d.totalMeds||0,totalLiens:d.totalLiens||0}}else throw new Error("Received non-JSON response from server")}catch(i){return t.debug("Error fetching case summary:",{...n,error:i}),null}}async function n8(r,e){const t={sourceFile:Cr,functionName:"getEmailParticipantsFromServer"};e.debug("Starting to fetch response...",t);const n={email_thread_id:r};try{const s=await Yr(F6,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)},e);if(e.debug("Response received:",{...t,data:s}),!s.ok)throw md(e,s),new Error(`HTTP error! status: ${s.status}`);const i=s.headers.get("content-type");if(i&&i.includes("application/json")){const c=await s.json();return e.debug("Parsed JSON response:",{...t,data:c}),c.email_participants}else throw new Error("Received non-JSON response from server")}catch(s){throw e.error("Error fetching email participants:",s,t),s}}async function s8(r,e,t){const n={sourceFile:Cr,functionName:"getDocumentURLFromServer"};t.debug("Starting to fetch document data...",n);const s=new URL(H6);s.searchParams.append("integration_type",r),s.searchParams.append("document_id",e);try{const i=await Yr(s,{method:"GET",headers:{"Content-Type":"application/json"}},t);if(t.debug("Response received:",{...n,data:i}),!i.ok)throw i.status===404?new Error("Document not found or integration not configured"):new Error(`HTTP error! status: ${i.status}`);const c=i.headers.get("content-type");if(c&&c.includes("application/json")){const d=await i.json();if(t.debug("Parsed JSON response:",{...n,data:d}),!d.url)throw new Error("Document URL not found in response");return{documentId:parseInt(e),url:d.url}}else throw new Error("Received non-JSON response from server")}catch(i){throw t.error("Error fetching document data:",i,n),i}}async function V_(r,e,t){var i,c;const n={sourceFile:Cr},s=Date.now();console.group(` [${r.toUpperCase()}] searchProjectsFromServer - "${e}"`),console.time("searchProjectsFromServer:total"),console.log("Integration:",r),console.log("Search Term:",e);try{t.info("Searching projects",{...n,integrationType:r,searchTerm:e});const d=new URL(V6);d.searchParams.append("integration_type",r),d.searchParams.append("search_term",e),d.searchParams.append("exclude_archived","true"),d.searchParams.append("limit","10"),console.time("searchProjectsFromServer:apiCall"),console.log(" Making API request to:",d.toString());const m=Date.now(),p=await Yr(d,{method:"GET",headers:{"Content-Type":"application/json"}},t),v=Date.now()-m,x=Hy(p);if(console.timeEnd("searchProjectsFromServer:apiCall"),console.log(" Response status:",p.status,`(${v}ms)`),console.log(" Trace ID:",x||"N/A"),p.status===504&&(console.error(" 504 Gateway Timeout - API call took too long"),console.log("Request URL:",d.toString()),console.log("Time elapsed before timeout:",v,"ms"),console.log(" Trace ID for debugging:",x||"N/A")),!p.ok){if(p.status===404)return console.log(" No projects found (404)"),console.timeEnd("searchProjectsFromServer:total"),console.groupEnd(),t.debug("No projects found",{...n,traceId:x}),{projects:[],total:0,hasMore:!1};throw console.error(" API error:",p.status),console.timeEnd("searchProjectsFromServer:total"),console.groupEnd(),new Error(`Search failed: ${p.status}`)}const b=p.headers.get("content-type");if(b&&b.includes("application/json")){console.time("searchProjectsFromServer:parseJson");const S=await p.json();console.timeEnd("searchProjectsFromServer:parseJson");const N=Date.now()-s;return console.log(" Project search completed"),console.log(" Results:",((i=S.projects)==null?void 0:i.length)||0,"projects found"),console.log(" Timing breakdown:",{apiCall:`${v}ms`,total:`${N}ms`}),console.timeEnd("searchProjectsFromServer:total"),console.groupEnd(),t.info("Project search successful",{...n,resultCount:((c=S.projects)==null?void 0:c.length)||0}),S}else throw console.error(" Received non-JSON response"),console.timeEnd("searchProjectsFromServer:total"),console.groupEnd(),new Error("Received non-JSON response from server")}catch(d){const m=Date.now()-s;throw console.error(" Project search failed:",d instanceof Error?d.message:String(d)),console.log(" Timing at failure:",{total:`${m}ms`}),console.timeEnd("searchProjectsFromServer:total"),console.groupEnd(),t.error("Error searching projects",d,{...n,integrationType:r,searchTerm:e}),d}}async function PT(r,e,t){var i,c,d,m;const n={sourceFile:Cr},s=Date.now();console.group(` [${r.toUpperCase()}] getProjectDataById - ${e}`),console.time("getProjectDataById:total"),console.log("Integration:",r),console.log("Project ID:",e);try{t.info("Fetching project data by ID",{...n,integrationType:r,projectId:e});const p=new URL(q6);p.searchParams.append("integration_type",r),p.searchParams.append("project_id",e),console.time("getProjectDataById:apiCall"),console.log(" Making API request to:",p.toString());const v=Date.now(),x=await Yr(p,{method:"GET",headers:{"Content-Type":"application/json"}},t),b=Date.now()-v,S=Hy(x);if(console.timeEnd("getProjectDataById:apiCall"),console.log(" Response status:",x.status,`(${b}ms)`),console.log(" Trace ID:",S||"N/A"),x.status===504&&(console.error(" 504 Gateway Timeout - API call took too long"),console.log("Request URL:",p.toString()),console.log("Time elapsed before timeout:",b,"ms"),console.log(" Trace ID for debugging:",S||"N/A")),!x.ok){if(x.status===404)return console.log(" Project not found (404)"),console.timeEnd("getProjectDataById:total"),console.groupEnd(),t.debug("Project not found",{...n,traceId:S}),{};throw console.error(" API error:",x.status),console.timeEnd("getProjectDataById:total"),console.groupEnd(),new Error(`Failed to fetch project: ${x.status}`)}const N=x.headers.get("content-type");if(N&&N.includes("application/json")){console.time("getProjectDataById:parseJson");const E=await x.json();console.timeEnd("getProjectDataById:parseJson");const T=E.project||{},A=Date.now()-s;return console.log(" Project data fetched successfully"),console.log(" Data includes:",{hasCalendarEntries:!!((i=T.case_data)!=null&&i.calendar_entries||T.calendar_entries),hasNotes:!!((c=T.case_data)!=null&&c.notes||T.notes),hasTasks:!!((d=T.case_data)!=null&&d.last_completed_task||(m=T.case_data)!=null&&m.next_upcoming_task)}),console.log(" Timing breakdown:",{apiCall:`${b}ms`,total:`${A}ms`}),console.timeEnd("getProjectDataById:total"),console.groupEnd(),t.info("Project data fetched successfully",{...n,projectId:e}),T}else throw console.error(" Received non-JSON response"),console.timeEnd("getProjectDataById:total"),console.groupEnd(),new Error("Received non-JSON response from server")}catch(p){const v=Date.now()-s;throw console.error(" Project data fetch failed:",p instanceof Error?p.message:String(p)),console.log(" Timing at failure:",{total:`${v}ms`}),console.timeEnd("getProjectDataById:total"),console.groupEnd(),t.error("Error fetching project by ID",p,{...n,integrationType:r,projectId:e}),p}}async function o8(r,e){const t={sourceFile:Cr,functionName:"getUserDataFromServer"},n=Date.now(),s=`getUserDataFromServer:${n}`;r.debug("Starting to fetch user data...",t);const i=new URL(W6);i.searchParams.append("integration_type",e);try{const c=await Yr(i,{method:"GET",headers:{"Content-Type":"application/json"}},r),d=Hy(c);if(console.timeEnd("getUserDataFromServer:apiCall"),c.status===504&&console.error(" 504 Gateway Timeout - API call took too long"),r.debug("Response received:",{...t,data:c,traceId:d}),!c.ok)throw c.status===400?(console.error(" API error: 400 - Missing required parameters"),new Error("Missing required parameters")):c.status===404?(console.error(" API error: 404 - No integration found"),new Error("No integration found for the specified type")):(console.error(" API error:",c.status),new Error(`HTTP error! status: ${c.status}`));const m=c.headers.get("content-type");if(m&&m.includes("application/json")){console.time("getUserDataFromServer:parseJson");const p=await c.json();return console.timeEnd("getUserDataFromServer:parseJson"),console.timeEnd(s),console.groupEnd(),r.debug("Parsed JSON response:",{...t,data:p}),{id:p.id||null,name:p.name||null,rate:p.rate||0}}else throw console.error(" Received non-JSON response"),new Error("Received non-JSON response from server")}catch(c){const d=Date.now()-n;throw console.error(" User data fetch failed:",c instanceof Error?c.message:String(c)),console.log(" Timing at failure:",{total:`${d}ms`}),console.timeEnd(s),console.groupEnd(),r.error("Error fetching user data:",c,t),c}}async function i8(r,e,t){var i,c;const n={sourceFile:Cr,functionName:"searchFirmUsersFromServer"};t.debug("Starting to search firm users...",{...n,integrationType:r,searchTerm:e});const s=new URL(NT);s.searchParams.append("integration_type",r),s.searchParams.append("request_function","search_firm_users"),s.searchParams.append("search_term",e),s.searchParams.append("limit","10");try{const d=await Yr(s,{method:"GET",headers:{"Content-Type":"application/json"}},t);if(t.debug("Response received:",{...n,status:d.status}),!d.ok){if(d.status===404)return t.debug("No users found",n),{users:[],total:0,hasMore:!1};throw new Error(`HTTP error! status: ${d.status}`)}const m=d.headers.get("content-type");if(m&&m.includes("application/json")){const p=await d.json();return t.debug("Parsed JSON response:",{...n,usersCount:((i=p.users)==null?void 0:i.length)||0}),{users:p.users||[],total:p.total||((c=p.users)==null?void 0:c.length)||0,hasMore:p.has_more||!1}}else throw new Error("Received non-JSON response from server")}catch(d){throw t.error("Error searching firm users:",d,n),d}}async function jT(r,e){var s;const t={sourceFile:Cr,functionName:"getFirmUsersFromServer"};e.debug("Starting to fetch firm users...",{...t,integrationType:r});const n=new URL(NT);n.searchParams.append("integration_type",r),n.searchParams.append("request_function","get_firm_users");try{const i=await Yr(n,{method:"GET",headers:{"Content-Type":"application/json"}},e);if(e.debug("Response received:",{...t,status:i.status}),!i.ok)throw new Error(`HTTP error! status: ${i.status}`);const c=i.headers.get("content-type");if(c&&c.includes("application/json")){const d=await i.json();return e.debug("Parsed JSON response:",{...t,usersCount:((s=d.users)==null?void 0:s.length)||0}),d.users||[]}else throw new Error("Received non-JSON response from server")}catch(i){throw e.error("Error fetching firm users:",i,t),i}}async function a8(r,e,t,n,s,i,c,d,m,p,v,x,b,S){const N={sourceFile:Cr,functionName:"writeEmailFromThread"};S.debug("Starting to write email from thread to server...",N);try{const E=await Yr(rg,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_email:r,function:"write_email_from_thread",integration_type:e,thread_id:t,message_id:n,matter_id:s,write_time_entry:i,quantity:c,description:d,non_billable:m,no_charge:p,date:v,price:x,platform:b})},S);if(S.debug("Response received:",{...N,data:E,sourceFile:Cr}),!E.ok)throw new Error(`HTTP error! status: ${E.status}`);const T=E.headers.get("content-type");if(T&&T.includes("application/json")){const A=await E.json();return S.debug("Parsed JSON response:",{...N,data:A}),A.message||"Email logged successfully"}else throw new Error("Received non-JSON response from server")}catch(E){throw S.error("Error writing email from thread:",E,{...N,sourceFile:Cr}),E}}async function l8(r,e,t,n){const s={sourceFile:Cr,functionName:"archiveEmails"};try{const i=await Yr($6,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({thread_id:r,message_ids:e,provider:t})},n);if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);return await i.json()}catch(i){return n.error("Error archiving emails:",i,{...s,sourceFile:Cr}),{success:!1,error:String(i)}}}async function FT(r){const e={sourceFile:Cr,functionName:"getIntegrationSettingsFromServer"};r.debug("Starting to fetch integration settings...",{...e});const t=new URL(K6);try{const n=await Yr(t,{method:"GET",headers:{"Content-Type":"application/json"}},r);if(r.debug("Response received:",{...e,data:n}),!n.ok){if(n.status===404)return r.debug("No settings found, returning defaults",e),{};throw new Error(`HTTP error! status: ${n.status}`)}const s=n.headers.get("content-type");if(s&&s.includes("application/json")){const i=await n.json();return r.debug("Parsed JSON response:",{...e,data:i}),i.integration_settings||{}}else throw new Error("Received non-JSON response from server")}catch(n){return r.error("Error fetching integration settings:",n,e),{}}}async function c8(r,e,t){const n={sourceFile:Cr,functionName:"generateTaskDescriptionFromEmail"};t.debug("Starting to generate task description from email...",n);try{const s=await Yr(Y6,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({integration_type:r,email_content:e})},t);if(t.debug("Response received:",{...n,data:s}),!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const i=s.headers.get("content-type");if(i&&i.includes("application/json")){const c=await s.json();return t.debug("Parsed JSON response:",{...n,data:c}),{name:c.name||"",description:c.description||""}}else throw new Error("Received non-JSON response from server")}catch(s){throw t.error("Error generating task description:",s,n),s}}async function u8(r,e,t,n,s,i,c,d,m,p){const v={sourceFile:Cr,functionName:"createClioTask"};c.debug("Starting to create Clio task...",{...v,taskName:e,matterId:n,dueAt:s,priority:i,assigneeId:d,reminder:m,notificationFlags:p});try{const x={function:"write_task_to_clio",integration_type:r,name:e,description:t,matter_id:n,due_at:s,priority:i};d&&(x.assignee_id=d),m&&(x.reminder=m),p&&(x.notify_assignee=p.notifyAssignee,x.notify_completion=p.notifyCompletion);const b=await Yr(rg,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(x)},c);if(c.debug("Response received:",{...v,data:b}),!b.ok)throw new Error(`HTTP error! status: ${b.status}`);const S=b.headers.get("content-type");if(S&&S.includes("application/json")){const N=await b.json();return c.debug("Parsed JSON response:",{...v,data:N}),{taskId:N.task_id||"",message:N.message||"Task created successfully"}}else throw new Error("Received non-JSON response from server")}catch(x){throw c.error("Error creating Clio task:",x,v),x}}async function d8(r,e,t,n,s,i,c){const d={sourceFile:Cr,functionName:"createClioNote"};try{const p=await Yr(rg,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({function:"write_note_to_clio",integration_type:r,subject:e,detail:t,date:n,matter_id:s,contact_id:i})},c);if(!p.ok){const x=await p.json();throw new Error(x.message||`HTTP error! status: ${p.status}`)}const v=await p.json();return c.info("Note created successfully",{...d,noteId:v.note_id}),{noteId:v.note_id,message:v.message||"Note created successfully"}}catch(m){throw c.error("Error creating note",m,d),m}}async function f8(r,e){const t={sourceFile:Cr,functionName:"createContactInClio"};e.debug("Starting to create Clio contact...",{...t,email:r.email});try{const n=await Yr(rg,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({function:"create_contact_in_clio",integration_type:"clio",first_name:r.firstName,last_name:r.lastName,email:r.email,phone_number:r.phoneNumber,contact_type:r.type,company_name:r.companyName})},e);if(e.debug("Response received:",{...t,data:n}),!n.ok){const c=(await n.json().catch(()=>({}))).error||`HTTP error! status: ${n.status}`;throw new Error(c)}const s=n.headers.get("content-type");if(s&&s.includes("application/json")){const i=await n.json();return e.debug("Parsed JSON response:",{...t,data:i}),{id:i.contact_id||i.id||"",message:i.message||"Contact created successfully"}}else throw new Error("Received non-JSON response from server")}catch(n){throw e.error("Error creating Clio contact:",n,t),n}}async function h8(r,e,t,n,s){const i={sourceFile:Cr,functionName:"linkContactToMatter"};s.debug("Starting to link contact to matter...",{...i,contactId:e,matterId:t,relationship:n});try{const c=await Yr(rg,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({function:"link_contact_to_matter",integration_type:r,contact_id:e,matter_id:t,relationship:n})},s);if(s.debug("Response received:",{...i,data:c}),!c.ok){const p=(await c.json().catch(()=>({}))).error||`HTTP error! status: ${c.status}`;throw new Error(p)}const d=c.headers.get("content-type");if(d&&d.includes("application/json")){const m=await c.json();return s.debug("Parsed JSON response:",{...i,data:m}),{message:m.message||"Contact linked to matter successfully"}}else throw new Error("Received non-JSON response from server")}catch(c){throw s.error("Error linking contact to matter:",c,i),c}}function mn(){const r=w.useContext(B_);if(!r)throw new Error("usePlatform must be used within a PlatformProvider");if(!r.services)throw new Error("Platform services are not available. Services may still be loading or failed to initialize.");return r}const Xa=()=>mn().services.storage,Qa=()=>mn().services.data,OT=()=>mn().services.auth,p8=()=>mn().services.messaging,m8=()=>mn().services.tabs,g8=()=>mn().services.lifecycle,v8=()=>mn().services.logging,y8=({children:r})=>{const[e,t]=w.useState(!0),[n,s]=w.useState(!1),[i,c]=w.useState(!1),[d,m]=w.useState(null),[p,v]=w.useState("loading"),[x,b]=w.useState(null),[S,N]=w.useState(0),E=v8(),{platform:T}=mn(),A=Xa(),I=w.useCallback(async()=>{if(T!=="chrome"){t(!1),v("disconnected"),b(new Date);return}c(!0),v("loading"),m(null);try{const G=await By(E);t(G),v(G?"connected":"disconnected"),b(new Date),G&&(N(0),n||(s(!0),A&&A.setLocalItem("wasEverConnectedGmail",!0).catch(K=>{E.error("Failed to save wasEverConnected to storage",K,{sourceFile:"src/shared/contexts/GmailConnectionContext/GmailConnectionProvider.tsx"})}))),E.debug("Gmail connection status checked",{sourceFile:"src/shared/contexts/GmailConnectionContext/GmailConnectionProvider.tsx",connected:G,status:G?"connected":"disconnected"})}catch(G){const K=G instanceof Error?G.message:"Unknown error occurred";m(K),t(!1),v("error"),b(new Date),E.error("Error checking Gmail connection",G,{sourceFile:"src/shared/contexts/GmailConnectionContext/GmailConnectionProvider.tsx"})}finally{c(!1)}},[E,T,n,A]),D=w.useCallback(async()=>{try{N(ie=>ie+1),v("loading"),m(null);const{initiateIntegration:G,findIntegrationById:K}=await bw(async()=>{const{initiateIntegration:ie,findIntegrationById:ae}=await Promise.resolve().then(()=>C9);return{initiateIntegration:ie,findIntegrationById:ae}},void 0),{GMAIL_INTEGRATION_PAGE_URI:re,GMAIL_INTEGRATION_REDIRECT_URI:se}=await bw(async()=>{const{GMAIL_INTEGRATION_PAGE_URI:ie,GMAIL_INTEGRATION_REDIRECT_URI:ae}=await Promise.resolve().then(()=>SU);return{GMAIL_INTEGRATION_PAGE_URI:ie,GMAIL_INTEGRATION_REDIRECT_URI:ae}},void 0),he=re(se),U=await K("gmail");if(!U)throw new Error("Gmail integration not found");const ge=await G(E,U,he);return ge?await I():v("disconnected"),ge}catch(G){const K=G instanceof Error?G.message:"Failed to reconnect Gmail";throw m(K),v("error"),E.error("Failed to reconnect Gmail:",G,{sourceFile:"src/shared/contexts/GmailConnectionContext/GmailConnectionProvider.tsx",attemptNumber:S+1}),G}},[E,I,S]),j=w.useCallback(()=>{m(null),p==="error"&&v(e?"connected":"disconnected")},[p,e]),O=w.useCallback(async()=>{await I()},[I]);w.useEffect(()=>{if(T!=="chrome")return;const G=setInterval(()=>{I()},36e5);return()=>clearInterval(G)},[I,T]),w.useEffect(()=>{if(T!=="chrome")return;const K=(async()=>{try{const se=(await Yn.createServices()).storage;if(se.onChanged){const he=U=>{if(U.gmailConnectionStatus){const ge=U.gmailConnectionStatus.newValue;E.debug("Gmail connection status changed via storage",{sourceFile:"src/shared/contexts/GmailConnectionContext/GmailConnectionProvider.tsx",newStatus:ge,oldStatus:U.gmailConnectionStatus.oldValue}),ge!==void 0&&(t(ge),v(ge?"connected":"disconnected"),b(new Date),ge&&d&&m(null))}};return se.onChanged(he),()=>{se.removeChangeListener&&se.removeChangeListener(he)}}}catch(re){E.error("Failed to set up Gmail connection storage listener:",re,{sourceFile:"src/shared/contexts/GmailConnectionContext/GmailConnectionProvider.tsx"})}})();return()=>{K.then(re=>re==null?void 0:re())}},[T,E,d]),w.useEffect(()=>{(async()=>{if(!(T!=="chrome"||!A))try{const K=await A.getLocalItem("wasEverConnectedGmail");K!==null&&(s(K),E.debug("Loaded wasEverConnected from storage",{sourceFile:"src/shared/contexts/GmailConnectionContext/GmailConnectionProvider.tsx",wasEverConnected:K}))}catch(K){E.error("Failed to load wasEverConnected from storage",K,{sourceFile:"src/shared/contexts/GmailConnectionContext/GmailConnectionProvider.tsx"})}})()},[T,A,E]),w.useEffect(()=>{I()},[I]);const B={isConnected:e,wasEverConnected:n,isLoading:i,error:d,status:p,lastChecked:x,reconnectAttempts:S,checkConnection:I,initiateReconnection:D,clearError:j,forceRefresh:O};return u.jsx(dT.Provider,{value:B,children:r})},DT=w.createContext(void 0),LT=()=>{const r=w.useContext(DT);if(!r)throw new Error("useActiveSection must be used within an ActiveSectionProvider");return r},x8=({children:r})=>{const[e,t]=w.useState("main");return u.jsx(DT.Provider,{value:{activeSection:e,setActiveSection:t},children:r})};var _e=typeof window<"u"?window:void 0,Ss=typeof globalThis<"u"?globalThis:_e;typeof self>"u"&&(Ss.self=Ss),typeof File>"u"&&(Ss.File=function(){});var MT=Array.prototype,Sk=MT.forEach,Ek=MT.indexOf,ni=Ss==null?void 0:Ss.navigator,Ze=Ss==null?void 0:Ss.document,_s=Ss==null?void 0:Ss.location,Dw=Ss==null?void 0:Ss.fetch,Lw=Ss!=null&&Ss.XMLHttpRequest&&"withCredentials"in new Ss.XMLHttpRequest?Ss.XMLHttpRequest:void 0,kk=Ss==null?void 0:Ss.AbortController,Ro=ni==null?void 0:ni.userAgent,It=_e??{},Ul={DEBUG:!1,LIB_VERSION:"1.343.2"};function Ck(r,e,t,n,s,i,c){try{var d=r[i](c),m=d.value}catch(p){return void t(p)}d.done?e(m):Promise.resolve(m).then(n,s)}function Yf(r){return function(){var e=this,t=arguments;return new Promise((function(n,s){var i=r.apply(e,t);function c(m){Ck(i,n,s,c,d,"next",m)}function d(m){Ck(i,n,s,c,d,"throw",m)}c(void 0)}))}}function it(){return it=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)({}).hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},it.apply(null,arguments)}function $T(r,e){if(r==null)return{};var t={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(e.indexOf(n)!==-1)continue;t[n]=r[n]}return t}var w8=["amazonbot","amazonproductbot","app.hypefactors.com","applebot","archive.org_bot","awariobot","backlinksextendedbot","baiduspider","bingbot","bingpreview","chrome-lighthouse","dataforseobot","deepscan","duckduckbot","facebookexternal","facebookcatalog","http://yandex.com/bots","hubspot","ia_archiver","leikibot","linkedinbot","meta-externalagent","mj12bot","msnbot","nessus","petalbot","pinterest","prerender","rogerbot","screaming frog","sebot-wa","sitebulb","slackbot","slurp","trendictionbot","turnitin","twitterbot","vercel-screenshot","vercelbot","yahoo! slurp","yandexbot","zoombot","bot.htm","bot.php","(bot;","bot/","crawler","ahrefsbot","ahrefssiteaudit","semrushbot","siteauditbot","splitsignalbot","gptbot","oai-searchbot","chatgpt-user","perplexitybot","better uptime bot","sentryuptimebot","uptimerobot","headlesschrome","cypress","google-hoteladsverifier","adsbot-google","apis-google","duplexweb-google","feedfetcher-google","google favicon","google web preview","google-read-aloud","googlebot","googleother","google-cloudvertexbot","googleweblight","mediapartners-google","storebot-google","google-inspectiontool","bytespider"],Nk=function(r,e){if(e===void 0&&(e=[]),!r)return!1;var t=r.toLowerCase();return w8.concat(e).some((n=>{var s=n.toLowerCase();return t.indexOf(s)!==-1}))},b8=["$snapshot","$pageview","$pageleave","$set","survey dismissed","survey sent","survey shown","$identify","$groupidentify","$create_alias","$$client_ingestion_warning","$web_experiment_applied","$feature_enrollment_update","$feature_flag_called"];function pr(r,e){return r.indexOf(e)!==-1}var Gy=function(r){return r.trim()},Mw=function(r){return r.replace(/^\$/,"")},_8=Array.isArray,UT=Object.prototype,zT=UT.hasOwnProperty,Wy=UT.toString,$r=_8||function(r){return Wy.call(r)==="[object Array]"},qc=r=>typeof r=="function",qn=r=>r===Object(r)&&!$r(r),Jf=r=>{if(qn(r)){for(var e in r)if(zT.call(r,e))return!1;return!0}return!1},et=r=>r===void 0,Kn=r=>Wy.call(r)=="[object String]",$w=r=>Kn(r)&&r.trim().length===0,ua=r=>r===null,mr=r=>et(r)||ua(r),Kl=r=>Wy.call(r)=="[object Number]"&&r==r,Vf=r=>Kl(r)&&r>0,Vl=r=>Wy.call(r)==="[object Boolean]",S8=r=>r instanceof FormData,E8=r=>pr(b8,r);function Uw(r){return r===null||typeof r!="object"}function ly(r,e){return Object.prototype.toString.call(r)==="[object "+e+"]"}function HT(r){return!et(Event)&&(function(e,t){try{return e instanceof t}catch{return!1}})(r,Event)}var k8=[!0,"true",1,"1","yes"],Ax=r=>pr(k8,r),C8=[!1,"false",0,"0","no"];function qa(r,e,t,n,s){return e>t&&(n.warn("min cannot be greater than max."),e=t),Kl(r)?r>t?(n.warn(" cannot be  greater than max: "+t+". Using max value instead."),t):r<e?(n.warn(" cannot be less than min: "+e+". Using min value instead."),e):r:(n.warn(" must be a number. using max or fallback. max: "+t+", fallback: "+s),qa(s||t,e,t,n))}class N8{constructor(e){this.t={},this.i=e.i,this.o=qa(e.bucketSize,0,100,e.h),this.m=qa(e.refillRate,0,this.o,e.h),this.$=qa(e.refillInterval,0,864e5,e.h)}S(e,t){var n=t-e.lastAccess,s=Math.floor(n/this.$);if(s>0){var i=s*this.m;e.tokens=Math.min(e.tokens+i,this.o),e.lastAccess=e.lastAccess+s*this.$}}consumeRateLimit(e){var t,n=Date.now(),s=String(e),i=this.t[s];return i?this.S(i,n):(i={tokens:this.o,lastAccess:n},this.t[s]=i),i.tokens===0||(i.tokens--,i.tokens===0&&((t=this.i)==null||t.call(this,e)),i.tokens===0)}stop(){this.t={}}}var Ri="Mobile",cy="iOS",Wl="Android",Hm="Tablet",BT=Wl+" "+Hm,GT="iPad",WT="Apple",VT=WT+" Watch",Bm="Safari",hh="BlackBerry",qT="Samsung",KT=qT+"Browser",YT=qT+" Internet",ud="Chrome",T8=ud+" OS",JT=ud+" "+cy,q_="Internet Explorer",XT=q_+" "+Ri,K_="Opera",A8=K_+" Mini",Y_="Edge",QT="Microsoft "+Y_,rh="Firefox",ZT=rh+" "+cy,Gm="Nintendo",Wm="PlayStation",nh="Xbox",eA=Wl+" "+Ri,tA=Ri+" "+Bm,hm="Windows",zw=hm+" Phone",Tk="Nokia",Hw="Ouya",rA="Generic",I8=rA+" "+Ri.toLowerCase(),nA=rA+" "+Hm.toLowerCase(),Bw="Konqueror",io="(\\d+(\\.\\d+)?)",Ix=new RegExp("Version/"+io),R8=new RegExp(nh,"i"),P8=new RegExp(Wm+" \\w+","i"),j8=new RegExp(Gm+" \\w+","i"),J_=new RegExp(hh+"|PlayBook|BB10","i"),F8={"NT3.51":"NT 3.11","NT4.0":"NT 4.0","5.0":"2000",5.1:"XP",5.2:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1",6.4:"10","10.0":"10"},Nv,Ak,Rx,O8=(r,e)=>e&&pr(e,WT)||(function(t){return pr(t,Bm)&&!pr(t,ud)&&!pr(t,Wl)})(r),sA=function(r,e){return e=e||"",pr(r," OPR/")&&pr(r,"Mini")?A8:pr(r," OPR/")?K_:J_.test(r)?hh:pr(r,"IE"+Ri)||pr(r,"WPDesktop")?XT:pr(r,KT)?YT:pr(r,Y_)||pr(r,"Edg/")?QT:pr(r,"FBIOS")?"Facebook "+Ri:pr(r,"UCWEB")||pr(r,"UCBrowser")?"UC Browser":pr(r,"CriOS")?JT:pr(r,"CrMo")||pr(r,ud)?ud:pr(r,Wl)&&pr(r,Bm)?eA:pr(r,"FxiOS")?ZT:pr(r.toLowerCase(),Bw.toLowerCase())?Bw:O8(r,e)?pr(r,Ri)?tA:Bm:pr(r,rh)?rh:pr(r,"MSIE")||pr(r,"Trident/")?q_:pr(r,"Gecko")?rh:""},D8={[XT]:[new RegExp("rv:"+io)],[QT]:[new RegExp(Y_+"?\\/"+io)],[ud]:[new RegExp("("+ud+"|CrMo)\\/"+io)],[JT]:[new RegExp("CriOS\\/"+io)],"UC Browser":[new RegExp("(UCBrowser|UCWEB)\\/"+io)],[Bm]:[Ix],[tA]:[Ix],[K_]:[new RegExp("(Opera|OPR)\\/"+io)],[rh]:[new RegExp(rh+"\\/"+io)],[ZT]:[new RegExp("FxiOS\\/"+io)],[Bw]:[new RegExp("Konqueror[:/]?"+io,"i")],[hh]:[new RegExp(hh+" "+io),Ix],[eA]:[new RegExp("android\\s"+io,"i")],[YT]:[new RegExp(KT+"\\/"+io)],[q_]:[new RegExp("(rv:|MSIE )"+io)],Mozilla:[new RegExp("rv:"+io)]},L8=function(r,e){var t=sA(r,e),n=D8[t];if(et(n))return null;for(var s=0;s<n.length;s++){var i=n[s],c=r.match(i);if(c)return parseFloat(c[c.length-2])}return null},Ik=[[new RegExp(nh+"; "+nh+" (.*?)[);]","i"),r=>[nh,r&&r[1]||""]],[new RegExp(Gm,"i"),[Gm,""]],[new RegExp(Wm,"i"),[Wm,""]],[J_,[hh,""]],[new RegExp(hm,"i"),(r,e)=>{if(/Phone/.test(e)||/WPDesktop/.test(e))return[zw,""];if(new RegExp(Ri).test(e)&&!/IEMobile\b/.test(e))return[hm+" "+Ri,""];var t=/Windows NT ([0-9.]+)/i.exec(e);if(t&&t[1]){var n=t[1],s=F8[n]||"";return/arm/i.test(e)&&(s="RT"),[hm,s]}return[hm,""]}],[/((iPhone|iPad|iPod).*?OS (\d+)_(\d+)_?(\d+)?|iPhone)/,r=>{if(r&&r[3]){var e=[r[3],r[4],r[5]||"0"];return[cy,e.join(".")]}return[cy,""]}],[/(watch.*\/(\d+\.\d+\.\d+)|watch os,(\d+\.\d+),)/i,r=>{var e="";return r&&r.length>=3&&(e=et(r[2])?r[3]:r[2]),["watchOS",e]}],[new RegExp("("+Wl+" (\\d+)\\.(\\d+)\\.?(\\d+)?|"+Wl+")","i"),r=>{if(r&&r[2]){var e=[r[2],r[3],r[4]||"0"];return[Wl,e.join(".")]}return[Wl,""]}],[/Mac OS X (\d+)[_.](\d+)[_.]?(\d+)?/i,r=>{var e=["Mac OS X",""];if(r&&r[1]){var t=[r[1],r[2],r[3]||"0"];e[1]=t.join(".")}return e}],[/Mac/i,["Mac OS X",""]],[/CrOS/,[T8,""]],[/Linux|debian/i,["Linux",""]]],Rk=function(r){return j8.test(r)?Gm:P8.test(r)?Wm:R8.test(r)?nh:new RegExp(Hw,"i").test(r)?Hw:new RegExp("("+zw+"|WPDesktop)","i").test(r)?zw:/iPad/.test(r)?GT:/iPod/.test(r)?"iPod Touch":/iPhone/.test(r)?"iPhone":/(watch)(?: ?os[,/]|\d,\d\/)[\d.]+/i.test(r)?VT:J_.test(r)?hh:/(kobo)\s(ereader|touch)/i.test(r)?"Kobo":new RegExp(Tk,"i").test(r)?Tk:/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i.test(r)||/(kf[a-z]+)( bui|\)).+silk\//i.test(r)?"Kindle Fire":/(Android|ZTE)/i.test(r)?new RegExp(Ri).test(r)&&!/(9138B|TB782B|Nexus [97]|pixel c|HUAWEISHT|BTV|noble nook|smart ultra 6)/i.test(r)||/pixel[\daxl ]{1,6}/i.test(r)&&!/pixel c/i.test(r)||/(huaweimed-al00|tah-|APA|SM-G92|i980|zte|U304AA)/i.test(r)||/lmy47v/i.test(r)&&!/QTAQZ3/i.test(r)?Wl:BT:new RegExp("(pda|"+Ri+")","i").test(r)?I8:new RegExp(Hm,"i").test(r)&&!new RegExp(Hm+" pc","i").test(r)?nA:""},M8=r=>r instanceof Error;function $8(r){var e=globalThis._posthogChunkIds;if(e){var t=Object.keys(e);return Rx&&t.length===Ak||(Ak=t.length,Rx=t.reduce(((n,s)=>{Nv||(Nv={});var i=Nv[s];if(i)n[i[0]]=i[1];else for(var c=r(s),d=c.length-1;d>=0;d--){var m=c[d],p=m==null?void 0:m.filename,v=e[s];if(p&&v){n[p]=v,Nv[s]=[p,v];break}}return n}),{})),Rx}}class U8{constructor(e,t,n){n===void 0&&(n=[]),this.coercers=e,this.stackParser=t,this.modifiers=n}buildFromUnknown(e,t){t===void 0&&(t={});var n=t&&t.mechanism||{handled:!0,type:"generic"},s=this.buildCoercingContext(n,t,0).apply(e),i=this.buildParsingContext(t),c=this.parseStacktrace(s,i);return{$exception_list:this.convertToExceptionList(c,n),$exception_level:"error"}}modifyFrames(e){var t=this;return Yf((function*(){for(var n of e)n.stacktrace&&n.stacktrace.frames&&$r(n.stacktrace.frames)&&(n.stacktrace.frames=yield t.applyModifiers(n.stacktrace.frames));return e}))()}coerceFallback(e){var t;return{type:"Error",value:"Unknown error",stack:(t=e.syntheticException)==null?void 0:t.stack,synthetic:!0}}parseStacktrace(e,t){var n,s;return e.cause!=null&&(n=this.parseStacktrace(e.cause,t)),e.stack!=""&&e.stack!=null&&(s=this.applyChunkIds(this.stackParser(e.stack,e.synthetic?t.skipFirstLines:0),t.chunkIdMap)),it({},e,{cause:n,stack:s})}applyChunkIds(e,t){return e.map((n=>(n.filename&&t&&(n.chunk_id=t[n.filename]),n)))}applyCoercers(e,t){for(var n of this.coercers)if(n.match(e))return n.coerce(e,t);return this.coerceFallback(t)}applyModifiers(e){var t=this;return Yf((function*(){var n=e;for(var s of t.modifiers)n=yield s(n);return n}))()}convertToExceptionList(e,t){var n,s,i,c={type:e.type,value:e.value,mechanism:{type:(n=t.type)!==null&&n!==void 0?n:"generic",handled:(s=t.handled)===null||s===void 0||s,synthetic:(i=e.synthetic)!==null&&i!==void 0&&i}};e.stack&&(c.stacktrace={type:"raw",frames:e.stack});var d=[c];return e.cause!=null&&d.push(...this.convertToExceptionList(e.cause,it({},t,{handled:!0}))),d}buildParsingContext(e){var t;return{chunkIdMap:$8(this.stackParser),skipFirstLines:(t=e.skipFirstLines)!==null&&t!==void 0?t:1}}buildCoercingContext(e,t,n){n===void 0&&(n=0);var s=(i,c)=>{if(c<=4){var d=this.buildCoercingContext(e,t,c);return this.applyCoercers(i,d)}};return it({},t,{syntheticException:n==0?t.syntheticException:void 0,mechanism:e,apply:i=>s(i,n),next:i=>s(i,n+1)})}}var ph="?";function Gw(r,e,t,n,s){var i={platform:r,filename:e,function:t==="<anonymous>"?ph:t,in_app:!0};return et(n)||(i.lineno=n),et(s)||(i.colno=s),i}var oA=(r,e)=>{var t=r.indexOf("safari-extension")!==-1,n=r.indexOf("safari-web-extension")!==-1;return t||n?[r.indexOf("@")!==-1?r.split("@")[0]:ph,t?"safari-extension:"+e:"safari-web-extension:"+e]:[r,e]},z8=/^\s*at (\S+?)(?::(\d+))(?::(\d+))\s*$/i,H8=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,B8=/\((\S*)(?::(\d+))(?::(\d+))\)/,G8=(r,e)=>{var t=z8.exec(r);if(t){var[,n,s,i]=t;return Gw(e,n,ph,+s,+i)}var c=H8.exec(r);if(c){if(c[2]&&c[2].indexOf("eval")===0){var d=B8.exec(c[2]);d&&(c[2]=d[1],c[3]=d[2],c[4]=d[3])}var[m,p]=oA(c[1]||ph,c[2]);return Gw(e,p,m,c[3]?+c[3]:void 0,c[4]?+c[4]:void 0)}},W8=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,V8=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,q8=(r,e)=>{var t=W8.exec(r);if(t){if(t[3]&&t[3].indexOf(" > eval")>-1){var n=V8.exec(t[3]);n&&(t[1]=t[1]||"eval",t[3]=n[1],t[4]=n[2],t[5]="")}var s=t[3],i=t[1]||ph;return[i,s]=oA(i,s),Gw(e,s,i,t[4]?+t[4]:void 0,t[5]?+t[5]:void 0)}},Pk=/\(error: (.*)\)/,jk=50;function K8(){return(function(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return function(s,i){i===void 0&&(i=0);for(var c=[],d=s.split(`
`),m=i;m<d.length;m++){var p=d[m];if(!(p.length>1024)){var v=Pk.test(p)?p.replace(Pk,"$1"):p;if(!v.match(/\S*Error: /)){for(var x of t){var b=x(v,r);if(b){c.push(b);break}}if(c.length>=jk)break}}}return(function(S){if(!S.length)return[];var N=Array.from(S);return N.reverse(),N.slice(0,jk).map((E=>{return it({},E,{filename:E.filename||(T=N,T[T.length-1]||{}).filename,function:E.function||ph});var T}))})(c)}})("web:javascript",G8,q8)}class Y8{match(e){return this.isDOMException(e)||this.isDOMError(e)}coerce(e,t){var n=Kn(e.stack);return{type:this.getType(e),value:this.getValue(e),stack:n?e.stack:void 0,cause:e.cause?t.next(e.cause):void 0,synthetic:!1}}getType(e){return this.isDOMError(e)?"DOMError":"DOMException"}getValue(e){var t=e.name||(this.isDOMError(e)?"DOMError":"DOMException");return e.message?t+": "+e.message:t}isDOMException(e){return ly(e,"DOMException")}isDOMError(e){return ly(e,"DOMError")}}class J8{match(e){return(t=>t instanceof Error)(e)}coerce(e,t){return{type:this.getType(e),value:this.getMessage(e,t),stack:this.getStack(e),cause:e.cause?t.next(e.cause):void 0,synthetic:!1}}getType(e){return e.name||e.constructor.name}getMessage(e,t){var n=e.message;return n.error&&typeof n.error.message=="string"?String(n.error.message):String(n)}getStack(e){return e.stacktrace||e.stack||void 0}}class X8{constructor(){}match(e){return ly(e,"ErrorEvent")&&e.error!=null}coerce(e,t){var n,s=t.apply(e.error);return s||{type:"ErrorEvent",value:e.message,stack:(n=t.syntheticException)==null?void 0:n.stack,synthetic:!0}}}var Q8=/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/i;class Z8{match(e){return typeof e=="string"}coerce(e,t){var n,[s,i]=this.getInfos(e);return{type:s??"Error",value:i??e,stack:(n=t.syntheticException)==null?void 0:n.stack,synthetic:!0}}getInfos(e){var t="Error",n=e,s=e.match(Q8);return s&&(t=s[1],n=s[2]),[t,n]}}var ez=["fatal","error","warning","log","info","debug"];function iA(r,e){e===void 0&&(e=40);var t=Object.keys(r);if(t.sort(),!t.length)return"[object has no keys]";for(var n=t.length;n>0;n--){var s=t.slice(0,n).join(", ");if(!(s.length>e))return n===t.length||s.length<=e?s:s.slice(0,e)+"..."}return""}class tz{match(e){return typeof e=="object"&&e!==null}coerce(e,t){var n,s=this.getErrorPropertyFromObject(e);return s?t.apply(s):{type:this.getType(e),value:this.getValue(e),stack:(n=t.syntheticException)==null?void 0:n.stack,level:this.isSeverityLevel(e.level)?e.level:"error",synthetic:!0}}getType(e){return HT(e)?e.constructor.name:"Error"}getValue(e){if("name"in e&&typeof e.name=="string"){var t="'"+e.name+"' captured as exception";return"message"in e&&typeof e.message=="string"&&(t+=" with message: '"+e.message+"'"),t}if("message"in e&&typeof e.message=="string")return e.message;var n=this.getObjectClassName(e);return(n&&n!=="Object"?"'"+n+"'":"Object")+" captured as exception with keys: "+iA(e)}isSeverityLevel(e){return Kn(e)&&!$w(e)&&ez.indexOf(e)>=0}getErrorPropertyFromObject(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var n=e[t];if(M8(n))return n}}getObjectClassName(e){try{var t=Object.getPrototypeOf(e);return t?t.constructor.name:void 0}catch{return}}}class rz{match(e){return HT(e)}coerce(e,t){var n,s=e.constructor.name;return{type:s,value:s+" captured as exception with keys: "+iA(e),stack:(n=t.syntheticException)==null?void 0:n.stack,synthetic:!0}}}class nz{match(e){return Uw(e)}coerce(e,t){var n;return{type:"Error",value:"Primitive value captured as exception: "+String(e),stack:(n=t.syntheticException)==null?void 0:n.stack,synthetic:!0}}}class sz{match(e){return ly(e,"PromiseRejectionEvent")}coerce(e,t){var n,s=this.getUnhandledRejectionReason(e);return Uw(s)?{type:"UnhandledRejection",value:"Non-Error promise rejection captured with value: "+String(s),stack:(n=t.syntheticException)==null?void 0:n.stack,synthetic:!0}:t.apply(s)}getUnhandledRejectionReason(e){if(Uw(e))return e;try{if("reason"in e)return e.reason;if("detail"in e&&"reason"in e.detail)return e.detail.reason}catch{}return e}}var aA=function(r,e){var{debugEnabled:t}=e===void 0?{}:e,n={k:function(s){if(_e&&(Ul.DEBUG||It.POSTHOG_DEBUG||t)&&!et(_e.console)&&_e.console){for(var i=("__rrweb_original__"in _e.console[s])?_e.console[s].__rrweb_original__:_e.console[s],c=arguments.length,d=new Array(c>1?c-1:0),m=1;m<c;m++)d[m-1]=arguments[m];i(r,...d)}},info:function(){for(var s=arguments.length,i=new Array(s),c=0;c<s;c++)i[c]=arguments[c];n.k("log",...i)},warn:function(){for(var s=arguments.length,i=new Array(s),c=0;c<s;c++)i[c]=arguments[c];n.k("warn",...i)},error:function(){for(var s=arguments.length,i=new Array(s),c=0;c<s;c++)i[c]=arguments[c];n.k("error",...i)},critical:function(){for(var s=arguments.length,i=new Array(s),c=0;c<s;c++)i[c]=arguments[c];console.error(r,...i)},uninitializedWarning:s=>{n.error("You must initialize PostHog before calling "+s)},createLogger:(s,i)=>aA(r+" "+s,i)};return n},st=aA("[PostHog.js]"),bn=st.createLogger,oz=bn("[ExternalScriptsLoader]"),Fk=(r,e,t)=>{if(r.config.disable_external_dependency_loading)return oz.warn(e+" was requested but loading of external scripts is disabled."),t("Loading of external scripts is disabled");var n=Ze==null?void 0:Ze.querySelectorAll("script");if(n){for(var s,i=function(){if(n[c].src===e){var m=n[c];return m.__posthog_loading_callback_fired?{v:t()}:(m.addEventListener("load",(p=>{m.__posthog_loading_callback_fired=!0,t(void 0,p)})),m.onerror=p=>t(p),{v:void 0})}},c=0;c<n.length;c++)if(s=i())return s.v}var d=()=>{if(!Ze)return t("document not found");var m=Ze.createElement("script");if(m.type="text/javascript",m.crossOrigin="anonymous",m.src=e,m.onload=x=>{m.__posthog_loading_callback_fired=!0,t(void 0,x)},m.onerror=x=>t(x),r.config.prepare_external_dependency_script&&(m=r.config.prepare_external_dependency_script(m)),!m)return t("prepare_external_dependency_script returned null");if(r.config.external_scripts_inject_target==="head")Ze.head.appendChild(m);else{var p,v=Ze.querySelectorAll("body > script");v.length>0?(p=v[0].parentNode)==null||p.insertBefore(m,v[0]):Ze.body.appendChild(m)}};Ze!=null&&Ze.body?d():Ze==null||Ze.addEventListener("DOMContentLoaded",d)};It.__PosthogExtensions__=It.__PosthogExtensions__||{},It.__PosthogExtensions__.loadExternalDependency=(r,e,t)=>{var n="/static/"+e+".js?v="+r.version;if(e==="remote-config"&&(n="/array/"+r.config.token+"/config.js"),e==="toolbar"){var s=3e5;n=n+"&t="+Math.floor(Date.now()/s)*s}var i=r.requestRouter.endpointFor("assets",n);Fk(r,i,t)},It.__PosthogExtensions__.loadSiteApp=(r,e,t)=>{var n=r.requestRouter.endpointFor("api",e);Fk(r,n,t)};var uy={};function Kc(r,e,t){if($r(r)){if(Sk&&r.forEach===Sk)r.forEach(e,t);else if("length"in r&&r.length===+r.length){for(var n=0,s=r.length;n<s;n++)if(n in r&&e.call(t,r[n],n)===uy)return}}}function en(r,e,t){if(!mr(r)){if($r(r))return Kc(r,e,t);if(S8(r)){for(var n of r.entries())if(e.call(t,n[1],n[0])===uy)return}else for(var s in r)if(zT.call(r,s)&&e.call(t,r[s],s)===uy)return}}var Rn=function(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return Kc(t,(function(s){for(var i in s)s[i]!==void 0&&(r[i]=s[i])})),r},bh=function(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return Kc(t,(function(s){Kc(s,(function(i){r.push(i)}))})),r};function Kv(r){for(var e=Object.keys(r),t=e.length,n=new Array(t);t--;)n[t]=[e[t],r[e[t]]];return n}var Ok=function(r){try{return r()}catch{return}},iz=function(r){return function(){try{for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.apply(this,t)}catch(s){st.critical("Implementation error. Please turn on debug mode and open a ticket on https://app.posthog.com/home#panel=support%3Asupport%3A."),st.critical(s)}}},X_=function(r){var e={};return en(r,(function(t,n){(Kn(t)&&t.length>0||Kl(t))&&(e[n]=t)})),e};function az(r,e){return t=r,n=i=>Kn(i)&&!ua(e)?i.slice(0,e):i,s=new Set,(function i(c,d){return c!==Object(c)?n?n(c,d):c:s.has(c)?void 0:(s.add(c),$r(c)?(m=[],Kc(c,(p=>{m.push(i(p))}))):(m={},en(c,((p,v)=>{s.has(p)||(m[v]=i(p,v))}))),m);var m})(t);var t,n,s}var lz=["herokuapp.com","vercel.app","netlify.app"];function cz(r){var e=r==null?void 0:r.hostname;if(!Kn(e))return!1;var t=e.split(".").slice(-2).join(".");for(var n of lz)if(t===n)return!1;return!0}function lA(r,e){for(var t=0;t<r.length;t++)if(e(r[t]))return r[t]}function Mn(r,e,t,n){var{capture:s=!1,passive:i=!0}=n??{};r==null||r.addEventListener(e,t,{capture:s,passive:i})}var cA="$people_distinct_id",pm="__alias",mm="__timers",Dk="$autocapture_disabled_server_side",Ww="$heatmaps_enabled_server_side",Lk="$exception_capture_enabled_server_side",Vw="$error_tracking_suppression_rules",Mk="$error_tracking_capture_extension_exceptions",$k="$web_vitals_enabled_server_side",uA="$dead_clicks_enabled_server_side",Uk="$product_tours_enabled_server_side",zk="$web_vitals_allowed_metrics",Px="$session_recording_remote_config",dy="$sesid",dA="$session_is_sampled",Xf="$enabled_feature_flags",gm="$early_access_features",qw="$feature_flag_details",vm="$stored_person_properties",nd="$stored_group_properties",Kw="$surveys",fy="$flag_call_reported",zl="$user_state",Yw="$client_session_props",Jw="$capture_rate_limit",Xw="$initial_campaign_params",Qw="$initial_referrer_info",hy="$initial_person_info",py="$epp",fA="__POSTHOG_TOOLBAR__",qp="$posthog_cookieless",uz=[cA,pm,"__cmpns",mm,"$session_recording_enabled_server_side",Ww,dy,Xf,Vw,zl,gm,qw,nd,vm,Kw,fy,Yw,Jw,Xw,Qw,py,hy,"$conversations_widget_session_id","$conversations_ticket_id","$conversations_widget_state","$conversations_user_traits"];function Hk(r){return r instanceof Element&&(r.id===fA||!(r.closest==null||!r.closest(".toolbar-global-fade-container")))}function Vy(r){return!!r&&r.nodeType===1}function Yc(r,e){return!!r&&!!r.tagName&&r.tagName.toLowerCase()===e.toLowerCase()}function hA(r){return!!r&&r.nodeType===3}function pA(r){return!!r&&r.nodeType===11}function Q_(r){return r?Gy(r).split(/\s+/):[]}function Bk(r){var e=_e==null?void 0:_e.location.href;return!!(e&&r&&r.some((t=>e.match(t))))}function my(r){var e="";switch(typeof r.className){case"string":e=r.className;break;case"object":e=(r.className&&"baseVal"in r.className?r.className.baseVal:null)||r.getAttribute("class")||"";break;default:e=""}return Q_(e)}function mA(r){return mr(r)?null:Gy(r).split(/(\s+)/).filter((e=>Vm(e))).join("").replace(/[\r\n]/g," ").replace(/[ ]+/g," ").substring(0,255)}function ng(r){var e="";return Zw(r)&&!wA(r)&&r.childNodes&&r.childNodes.length&&en(r.childNodes,(function(t){var n;hA(t)&&t.textContent&&(e+=(n=mA(t.textContent))!==null&&n!==void 0?n:"")})),Gy(e)}function gA(r){return et(r.target)?r.srcElement||null:(e=r.target)!=null&&e.shadowRoot?r.composedPath()[0]||null:r.target||null;var e}var Z_=["a","button","form","input","select","textarea","label"];function vA(r,e){if(et(e))return!0;var t,n=function(i){if(e.some((c=>i.matches(c))))return{v:!0}};for(var s of r)if(t=n(s))return t.v;return!1}function yA(r){var e=r.parentNode;return!(!e||!Vy(e))&&e}var dz=["next","previous","prev",">","<"],Gk=10,Wk=[".ph-no-rageclick",".ph-no-capture"];function fz(r,e){if(!_e||eS(r))return!1;var t,n,s;if(Vl(e)?(t=!!e&&Wk,n=void 0):(t=(s=e==null?void 0:e.css_selector_ignorelist)!==null&&s!==void 0?s:Wk,n=e==null?void 0:e.content_ignorelist),t===!1)return!1;var{targetElementList:i}=xA(r,!1);return!(function(c,d){if(c===!1||et(c))return!1;var m;if(c===!0)m=dz;else{if(!$r(c))return!1;if(c.length>Gk)return st.error("[PostHog] content_ignorelist array cannot exceed "+Gk+" items. Use css_selector_ignorelist for more complex matching."),!1;m=c.map((p=>p.toLowerCase()))}return d.some((p=>{var{safeText:v,ariaLabel:x}=p;return m.some((b=>v.includes(b)||x.includes(b)))}))})(n,i.map((c=>{var d;return{safeText:ng(c).toLowerCase(),ariaLabel:((d=c.getAttribute("aria-label"))==null?void 0:d.toLowerCase().trim())||""}})))&&!vA(i,t)}var eS=r=>!r||Yc(r,"html")||!Vy(r),xA=(r,e)=>{if(!_e||eS(r))return{parentIsUsefulElement:!1,targetElementList:[]};for(var t=!1,n=[r],s=r;s.parentNode&&!Yc(s,"body");)if(pA(s.parentNode))n.push(s.parentNode.host),s=s.parentNode.host;else{var i=yA(s);if(!i)break;if(e||Z_.indexOf(i.tagName.toLowerCase())>-1)t=!0;else{var c=_e.getComputedStyle(i);c&&c.getPropertyValue("cursor")==="pointer"&&(t=!0)}n.push(i),s=i}return{parentIsUsefulElement:t,targetElementList:n}};function hz(r,e,t,n,s){var i,c,d,m;if(t===void 0&&(t=void 0),!_e||eS(r)||(i=t)!=null&&i.url_allowlist&&!Bk(t.url_allowlist)||(c=t)!=null&&c.url_ignorelist&&Bk(t.url_ignorelist))return!1;if((d=t)!=null&&d.dom_event_allowlist){var p=t.dom_event_allowlist;if(p&&!p.some((N=>e.type===N)))return!1}var{parentIsUsefulElement:v,targetElementList:x}=xA(r,n);if(!(function(N,E){var T=E==null?void 0:E.element_allowlist;if(et(T))return!0;var A,I=function(j){if(T.some((O=>j.tagName.toLowerCase()===O)))return{v:!0}};for(var D of N)if(A=I(D))return A.v;return!1})(x,t)||!vA(x,(m=t)==null?void 0:m.css_selector_allowlist))return!1;var b=_e.getComputedStyle(r);if(b&&b.getPropertyValue("cursor")==="pointer"&&e.type==="click")return!0;var S=r.tagName.toLowerCase();switch(S){case"html":return!1;case"form":return(s||["submit"]).indexOf(e.type)>=0;case"input":case"select":case"textarea":return(s||["change","click"]).indexOf(e.type)>=0;default:return v?(s||["click"]).indexOf(e.type)>=0:(s||["click"]).indexOf(e.type)>=0&&(Z_.indexOf(S)>-1||r.getAttribute("contenteditable")==="true")}}function Zw(r){for(var e=r;e.parentNode&&!Yc(e,"body");e=e.parentNode){var t=my(e);if(pr(t,"ph-sensitive")||pr(t,"ph-no-capture"))return!1}if(pr(my(r),"ph-include"))return!0;var n=r.type||"";if(Kn(n))switch(n.toLowerCase()){case"hidden":case"password":return!1}var s=r.name||r.id||"";return!(Kn(s)&&/^cc|cardnum|ccnum|creditcard|csc|cvc|cvv|exp|pass|pwd|routing|seccode|securitycode|securitynum|socialsec|socsec|ssn/i.test(s.replace(/[^a-zA-Z0-9]/g,"")))}function wA(r){return!!(Yc(r,"input")&&!["button","checkbox","submit","reset"].includes(r.type)||Yc(r,"select")||Yc(r,"textarea")||r.getAttribute("contenteditable")==="true")}var bA="(4[0-9]{12}(?:[0-9]{3})?)|(5[1-5][0-9]{14})|(6(?:011|5[0-9]{2})[0-9]{12})|(3[47][0-9]{13})|(3(?:0[0-5]|[68][0-9])[0-9]{11})|((?:2131|1800|35[0-9]{3})[0-9]{11})",pz=new RegExp("^(?:"+bA+")$"),mz=new RegExp(bA),_A="\\d{3}-?\\d{2}-?\\d{4}",gz=new RegExp("^("+_A+")$"),vz=new RegExp("("+_A+")");function Vm(r,e){return e===void 0&&(e=!0),!(mr(r)||Kn(r)&&(r=Gy(r),(e?pz:mz).test((r||"").replace(/[- ]/g,""))||(e?gz:vz).test(r)))}function SA(r){var e=ng(r);return Vm(e=(e+" "+EA(r)).trim())?e:""}function EA(r){var e="";return r&&r.childNodes&&r.childNodes.length&&en(r.childNodes,(function(t){var n;if(t&&((n=t.tagName)==null?void 0:n.toLowerCase())==="span")try{var s=ng(t);e=(e+" "+s).trim(),t.childNodes&&t.childNodes.length&&(e=(e+" "+EA(t)).trim())}catch(i){st.error("[AutoCapture]",i)}})),e}function yz(r){return(function(e){var t=e.map((n=>{var s,i,c="";if(n.tag_name&&(c+=n.tag_name),n.attr_class)for(var d of(n.attr_class.sort(),n.attr_class))c+="."+d.replace(/"/g,"");var m=it({},n.text?{text:n.text}:{},{"nth-child":(s=n.nth_child)!==null&&s!==void 0?s:0,"nth-of-type":(i=n.nth_of_type)!==null&&i!==void 0?i:0},n.href?{href:n.href}:{},n.attr_id?{attr_id:n.attr_id}:{},n.attributes),p={};return Kv(m).sort(((v,x)=>{var[b]=v,[S]=x;return b.localeCompare(S)})).forEach((v=>{var[x,b]=v;return p[Vk(x.toString())]=Vk(b.toString())})),c+=":",c+=Kv(p).map((v=>{var[x,b]=v;return x+'="'+b+'"'})).join("")}));return t.join(";")})((function(e){return e.map((t=>{var n,s,i={text:(n=t.$el_text)==null?void 0:n.slice(0,400),tag_name:t.tag_name,href:(s=t.attr__href)==null?void 0:s.slice(0,2048),attr_class:xz(t),attr_id:t.attr__id,nth_child:t.nth_child,nth_of_type:t.nth_of_type,attributes:{}};return Kv(t).filter((c=>{var[d]=c;return d.indexOf("attr__")===0})).forEach((c=>{var[d,m]=c;return i.attributes[d]=m})),i}))})(r))}function Vk(r){return r.replace(/"|\\"/g,'\\"')}function xz(r){var e=r.attr__class;return e?$r(e)?e:Q_(e):void 0}class kA{constructor(e){this.disabled=e===!1;var t=qn(e)?e:{};this.thresholdPx=t.threshold_px||30,this.timeoutMs=t.timeout_ms||1e3,this.clickCount=t.click_count||3,this.clicks=[]}isRageClick(e,t,n){if(this.disabled)return!1;var s=this.clicks[this.clicks.length-1];if(s&&Math.abs(e-s.x)+Math.abs(t-s.y)<this.thresholdPx&&n-s.timestamp<this.timeoutMs){if(this.clicks.push({x:e,y:t,timestamp:n}),this.clicks.length===this.clickCount)return!0}else this.clicks=[{x:e,y:t,timestamp:n}];return!1}}var gy=r=>{var e=Ze==null?void 0:Ze.createElement("a");return et(e)?null:(e.href=r,e)},wz=function(r,e){var t,n;e===void 0&&(e="&");var s=[];return en(r,(function(i,c){et(i)||et(c)||c==="undefined"||(t=encodeURIComponent((d=>d instanceof File)(i)?i.name:i.toString()),n=encodeURIComponent(c),s[s.length]=n+"="+t)})),s.join(e)},vy=function(r,e){for(var t,n=((r.split("#")[0]||"").split(/\?(.*)/)[1]||"").replace(/^\?+/g,"").split("&"),s=0;s<n.length;s++){var i=n[s].split("=");if(i[0]===e){t=i;break}}if(!$r(t)||t.length<2)return"";var c=t[1];try{c=decodeURIComponent(c)}catch{st.error("Skipping decoding for malformed query param: "+c)}return c.replace(/\+/g," ")},sg=function(r,e,t){if(!r||!e||!e.length)return r;for(var n=r.split("#"),s=n[0]||"",i=n[1],c=s.split("?"),d=c[1],m=c[0],p=(d||"").split("&"),v=[],x=0;x<p.length;x++){var b=p[x].split("=");$r(b)&&(e.includes(b[0])?v.push(b[0]+"="+t):v.push(p[x]))}var S=m;return d!=null&&(S+="?"+v.join("&")),i!=null&&(S+="#"+i),S},yy=function(r,e){var t=r.match(new RegExp(e+"=([^&]*)"));return t?t[1]:null},jx="$copy_autocapture",qk=bn("[AutoCapture]");function Fx(r,e){return e.length>r?e.slice(0,r)+"...":e}function bz(r){if(r.previousElementSibling)return r.previousElementSibling;var e=r;do e=e.previousSibling;while(e&&!Vy(e));return e}function _z(r,e,t,n){var s=r.tagName.toLowerCase(),i={tag_name:s};Z_.indexOf(s)>-1&&!t&&(s.toLowerCase()==="a"||s.toLowerCase()==="button"?i.$el_text=Fx(1024,SA(r)):i.$el_text=Fx(1024,ng(r)));var c=my(r);c.length>0&&(i.classes=c.filter((function(v){return v!==""}))),en(r.attributes,(function(v){var x;if((!wA(r)||["name","id","class","aria-label"].indexOf(v.name)!==-1)&&(n==null||!n.includes(v.name))&&!e&&Vm(v.value)&&(x=v.name,!Kn(x)||x.substring(0,10)!=="_ngcontent"&&x.substring(0,7)!=="_nghost")){var b=v.value;v.name==="class"&&(b=Q_(b).join(" ")),i["attr__"+v.name]=Fx(1024,b)}}));for(var d=1,m=1,p=r;p=bz(p);)d++,p.tagName===r.tagName&&m++;return i.nth_child=d,i.nth_of_type=m,i}function Sz(r,e){for(var t,n,{e:s,maskAllElementAttributes:i,maskAllText:c,elementAttributeIgnoreList:d,elementsChainAsString:m}=e,p=[r],v=r;v.parentNode&&!Yc(v,"body");)pA(v.parentNode)?(p.push(v.parentNode.host),v=v.parentNode.host):(p.push(v.parentNode),v=v.parentNode);var x,b=[],S={},N=!1,E=!1;if(en(p,(j=>{var O=Zw(j);j.tagName.toLowerCase()==="a"&&(N=j.getAttribute("href"),N=O&&N&&Vm(N)&&N),pr(my(j),"ph-no-capture")&&(E=!0),b.push(_z(j,i,c,d));var B=(function(G){if(!Zw(G))return{};var K={};return en(G.attributes,(function(re){if(re.name&&re.name.indexOf("data-ph-capture-attribute")===0){var se=re.name.replace("data-ph-capture-attribute-",""),he=re.value;se&&he&&Vm(he)&&(K[se]=he)}})),K})(j);Rn(S,B)})),E)return{props:{},explicitNoCapture:E};if(c||(r.tagName.toLowerCase()==="a"||r.tagName.toLowerCase()==="button"?b[0].$el_text=SA(r):b[0].$el_text=ng(r)),N){var T,A;b[0].attr__href=N;var I=(T=gy(N))==null?void 0:T.host,D=_e==null||(A=_e.location)==null?void 0:A.host;I&&D&&I!==D&&(x=N)}return{props:Rn({$event_type:s.type,$ce_version:1},m?{}:{$elements:b},{$elements_chain:yz(b)},(t=b[0])!=null&&t.$el_text?{$el_text:(n=b[0])==null?void 0:n.$el_text}:{},x&&s.type==="click"?{$external_click_url:x}:{},S)}}class Ez{constructor(e){this.P=!1,this.T=null,this.I=!1,this.instance=e,this.rageclicks=new kA(e.config.rageclick),this.C=null}get R(){var e,t,n=qn(this.instance.config.autocapture)?this.instance.config.autocapture:{};return n.url_allowlist=(e=n.url_allowlist)==null?void 0:e.map((s=>new RegExp(s))),n.url_ignorelist=(t=n.url_ignorelist)==null?void 0:t.map((s=>new RegExp(s))),n}F(){if(this.isBrowserSupported()){if(_e&&Ze){var e=n=>{n=n||(_e==null?void 0:_e.event);try{this.O(n)}catch(s){qk.error("Failed to capture event",s)}};if(Mn(Ze,"submit",e,{capture:!0}),Mn(Ze,"change",e,{capture:!0}),Mn(Ze,"click",e,{capture:!0}),this.R.capture_copied_text){var t=n=>{n=n||(_e==null?void 0:_e.event),this.O(n,jx)};Mn(Ze,"copy",t,{capture:!0}),Mn(Ze,"cut",t,{capture:!0})}}}else qk.info("Disabling Automatic Event Collection because this browser is not supported")}startIfEnabled(){this.isEnabled&&!this.P&&(this.F(),this.P=!0)}onRemoteConfig(e){e.elementsChainAsString&&(this.I=e.elementsChainAsString),this.instance.persistence&&this.instance.persistence.register({[Dk]:!!e.autocapture_opt_out}),this.T=!!e.autocapture_opt_out,this.startIfEnabled()}setElementSelectors(e){this.C=e}getElementSelectors(e){var t,n=[];return(t=this.C)==null||t.forEach((s=>{var i=Ze==null?void 0:Ze.querySelectorAll(s);i==null||i.forEach((c=>{e===c&&n.push(s)}))})),n}get isEnabled(){var e,t,n=(e=this.instance.persistence)==null?void 0:e.props[Dk],s=this.T;if(ua(s)&&!Vl(n)&&!this.instance.M())return!1;var i=(t=this.T)!==null&&t!==void 0?t:!!n;return!!this.instance.config.autocapture&&!i}O(e,t){if(t===void 0&&(t="$autocapture"),this.isEnabled){var n,s=gA(e);hA(s)&&(s=s.parentNode||null),t==="$autocapture"&&e.type==="click"&&e instanceof MouseEvent&&this.instance.config.rageclick&&(n=this.rageclicks)!=null&&n.isRageClick(e.clientX,e.clientY,e.timeStamp||new Date().getTime())&&fz(s,this.instance.config.rageclick)&&this.O(e,"$rageclick");var i=t===jx;if(s&&hz(s,e,this.R,i,i?["copy","cut"]:void 0)){var{props:c,explicitNoCapture:d}=Sz(s,{e,maskAllElementAttributes:this.instance.config.mask_all_element_attributes,maskAllText:this.instance.config.mask_all_text,elementAttributeIgnoreList:this.R.element_attribute_ignorelist,elementsChainAsString:this.I});if(d)return!1;var m=this.getElementSelectors(s);if(m&&m.length>0&&(c.$element_selectors=m),t===jx){var p,v=mA(_e==null||(p=_e.getSelection())==null?void 0:p.toString()),x=e.type||"clipboard";if(!v)return!1;c.$selected_content=v,c.$copy_type=x}return this.instance.capture(t,c),!0}}}isBrowserSupported(){return qc(Ze==null?void 0:Ze.querySelectorAll)}}Math.trunc||(Math.trunc=function(r){return r<0?Math.ceil(r):Math.floor(r)}),Number.isInteger||(Number.isInteger=function(r){return Kl(r)&&isFinite(r)&&Math.floor(r)===r});var Kk="0123456789abcdef";class xy{constructor(e){if(this.bytes=e,e.length!==16)throw new TypeError("not 128-bit length")}static fromFieldsV7(e,t,n,s){if(!Number.isInteger(e)||!Number.isInteger(t)||!Number.isInteger(n)||!Number.isInteger(s)||e<0||t<0||n<0||s<0||e>0xffffffffffff||t>4095||n>1073741823||s>4294967295)throw new RangeError("invalid field value");var i=new Uint8Array(16);return i[0]=e/Math.pow(2,40),i[1]=e/Math.pow(2,32),i[2]=e/Math.pow(2,24),i[3]=e/Math.pow(2,16),i[4]=e/Math.pow(2,8),i[5]=e,i[6]=112|t>>>8,i[7]=t,i[8]=128|n>>>24,i[9]=n>>>16,i[10]=n>>>8,i[11]=n,i[12]=s>>>24,i[13]=s>>>16,i[14]=s>>>8,i[15]=s,new xy(i)}toString(){for(var e="",t=0;t<this.bytes.length;t++)e=e+Kk.charAt(this.bytes[t]>>>4)+Kk.charAt(15&this.bytes[t]),t!==3&&t!==5&&t!==7&&t!==9||(e+="-");if(e.length!==36)throw new Error("Invalid UUIDv7 was generated");return e}clone(){return new xy(this.bytes.slice(0))}equals(e){return this.compareTo(e)===0}compareTo(e){for(var t=0;t<16;t++){var n=this.bytes[t]-e.bytes[t];if(n!==0)return Math.sign(n)}return 0}}class kz{constructor(){this.A=0,this.j=0,this.D=new Cz}generate(){var e=this.generateOrAbort();if(et(e)){this.A=0;var t=this.generateOrAbort();if(et(t))throw new Error("Could not generate UUID after timestamp reset");return t}return e}generateOrAbort(){var e=Date.now();if(e>this.A)this.A=e,this.L();else{if(!(e+1e4>this.A))return;this.j++,this.j>4398046511103&&(this.A++,this.L())}return xy.fromFieldsV7(this.A,Math.trunc(this.j/Math.pow(2,30)),this.j&Math.pow(2,30)-1,this.D.nextUint32())}L(){this.j=1024*this.D.nextUint32()+(1023&this.D.nextUint32())}}var Yk,CA=r=>{if(typeof UUIDV7_DENY_WEAK_RNG<"u"&&UUIDV7_DENY_WEAK_RNG)throw new Error("no cryptographically strong RNG available");for(var e=0;e<r.length;e++)r[e]=65536*Math.trunc(65536*Math.random())+Math.trunc(65536*Math.random());return r};_e&&!et(_e.crypto)&&crypto.getRandomValues&&(CA=r=>crypto.getRandomValues(r));class Cz{constructor(){this.N=new Uint32Array(8),this.U=1/0}nextUint32(){return this.U>=this.N.length&&(CA(this.N),this.U=0),this.N[this.U++]}}var Wc=()=>Nz().toString(),Nz=()=>(Yk||(Yk=new kz)).generate(),Kp="",Tz=/[a-z0-9][a-z0-9-]+\.[a-z]{2,}$/i;function Az(r,e){if(e){var t=(function(s,i){if(i===void 0&&(i=Ze),Kp)return Kp;if(!i||["localhost","127.0.0.1"].includes(s))return"";for(var c=s.split("."),d=Math.min(c.length,8),m="dmn_chk_"+Wc();!Kp&&d--;){var p=c.slice(d).join("."),v=m+"=1;domain=."+p+";path=/";i.cookie=v+";max-age=3",i.cookie.includes(m)&&(i.cookie=v+";max-age=0",Kp=p)}return Kp})(r);if(!t){var n=(s=>{var i=s.match(Tz);return i?i[0]:""})(r);n!==t&&st.info("Warning: cookie subdomain discovery mismatch",n,t),t=n}return t?"; domain=."+t:""}return""}var Ba={H:()=>!!Ze,B:function(r){st.error("cookieStore error: "+r)},q:function(r){if(Ze){try{for(var e=r+"=",t=Ze.cookie.split(";").filter((i=>i.length)),n=0;n<t.length;n++){for(var s=t[n];s.charAt(0)==" ";)s=s.substring(1,s.length);if(s.indexOf(e)===0)return decodeURIComponent(s.substring(e.length,s.length))}}catch{}return null}},W:function(r){var e;try{e=JSON.parse(Ba.q(r))||{}}catch{}return e},G:function(r,e,t,n,s){if(Ze)try{var i="",c="",d=Az(Ze.location.hostname,n);if(t){var m=new Date;m.setTime(m.getTime()+24*t*60*60*1e3),i="; expires="+m.toUTCString()}s&&(c="; secure");var p=r+"="+encodeURIComponent(JSON.stringify(e))+i+"; SameSite=Lax; path=/"+d+c;return p.length>3686.4&&st.warn("cookieStore warning: large cookie, len="+p.length),Ze.cookie=p,p}catch{return}},V:function(r,e){if(Ze!=null&&Ze.cookie)try{Ba.G(r,"",-1,e)}catch{return}}},Ox=null,hn={H:function(){if(!ua(Ox))return Ox;var r=!0;if(et(_e))r=!1;else try{var e="__mplssupport__";hn.G(e,"xyz"),hn.q(e)!=='"xyz"'&&(r=!1),hn.V(e)}catch{r=!1}return r||st.error("localStorage unsupported; falling back to cookie store"),Ox=r,r},B:function(r){st.error("localStorage error: "+r)},q:function(r){try{return _e==null?void 0:_e.localStorage.getItem(r)}catch(e){hn.B(e)}return null},W:function(r){try{return JSON.parse(hn.q(r))||{}}catch{}return null},G:function(r,e){try{_e==null||_e.localStorage.setItem(r,JSON.stringify(e))}catch(t){hn.B(t)}},V:function(r){try{_e==null||_e.localStorage.removeItem(r)}catch(e){hn.B(e)}}},Iz=["$device_id","distinct_id",dy,dA,py,hy],Tv={},Rz={H:function(){return!0},B:function(r){st.error("memoryStorage error: "+r)},q:function(r){return Tv[r]||null},W:function(r){return Tv[r]||null},G:function(r,e){Tv[r]=e},V:function(r){delete Tv[r]}},ed=null,bs={H:function(){if(!ua(ed))return ed;if(ed=!0,et(_e))ed=!1;else try{var r="__support__";bs.G(r,"xyz"),bs.q(r)!=='"xyz"'&&(ed=!1),bs.V(r)}catch{ed=!1}return ed},B:function(r){st.error("sessionStorage error: ",r)},q:function(r){try{return _e==null?void 0:_e.sessionStorage.getItem(r)}catch(e){bs.B(e)}return null},W:function(r){try{return JSON.parse(bs.q(r))||null}catch{}return null},G:function(r,e){try{_e==null||_e.sessionStorage.setItem(r,JSON.stringify(e))}catch(t){bs.B(t)}},V:function(r){try{_e==null||_e.sessionStorage.removeItem(r)}catch(e){bs.B(e)}}},Hl=(function(r){return r[r.PENDING=-1]="PENDING",r[r.DENIED=0]="DENIED",r[r.GRANTED=1]="GRANTED",r})({});class Pz{constructor(e){this._instance=e}get R(){return this._instance.config}get consent(){return this.J()?Hl.DENIED:this.K}isOptedOut(){return this.R.cookieless_mode==="always"||this.consent===Hl.DENIED||this.consent===Hl.PENDING&&(this.R.opt_out_capturing_by_default||this.R.cookieless_mode==="on_reject")}isOptedIn(){return!this.isOptedOut()}isExplicitlyOptedOut(){return this.consent===Hl.DENIED}optInOut(e){this.Y.G(this.X,e?1:0,this.R.cookie_expiration,this.R.cross_subdomain_cookie,this.R.secure_cookie)}reset(){this.Y.V(this.X,this.R.cross_subdomain_cookie)}get X(){var{token:e,opt_out_capturing_cookie_prefix:t,consent_persistence_name:n}=this._instance.config;return n||(t?t+e:"__ph_opt_in_out_"+e)}get K(){var e=this.Y.q(this.X);return Ax(e)?Hl.GRANTED:pr(C8,e)?Hl.DENIED:Hl.PENDING}get Y(){if(!this.Z){var e=this.R.opt_out_capturing_persistence_type;this.Z=e==="localStorage"?hn:Ba;var t=e==="localStorage"?Ba:hn;t.q(this.X)&&(this.Z.q(this.X)||this.optInOut(Ax(t.q(this.X))),t.V(this.X,this.R.cross_subdomain_cookie))}return this.Z}J(){return!!this.R.respect_dnt&&!!lA([ni==null?void 0:ni.doNotTrack,ni==null?void 0:ni.msDoNotTrack,It.doNotTrack],(e=>Ax(e)))}}var Av=bn("[Dead Clicks]"),jz=()=>!0,Fz=r=>{var e,t=!((e=r.instance.persistence)==null||!e.get_property(uA)),n=r.instance.config.capture_dead_clicks;return Vl(n)?n:!!qn(n)||t};class NA{get lazyLoadedDeadClicksAutocapture(){return this.tt}constructor(e,t,n){this.instance=e,this.isEnabled=t,this.onCapture=n,this.startIfEnabled()}onRemoteConfig(e){this.instance.persistence&&this.instance.persistence.register({[uA]:e==null?void 0:e.captureDeadClicks}),this.startIfEnabled()}startIfEnabled(){this.isEnabled(this)&&this.it((()=>{this.et()}))}it(e){var t,n;(t=It.__PosthogExtensions__)!=null&&t.initDeadClicksAutocapture&&e(),(n=It.__PosthogExtensions__)==null||n.loadExternalDependency==null||n.loadExternalDependency(this.instance,"dead-clicks-autocapture",(s=>{s?Av.error("failed to load script",s):e()}))}et(){var e;if(Ze){if(!this.tt&&(e=It.__PosthogExtensions__)!=null&&e.initDeadClicksAutocapture){var t=qn(this.instance.config.capture_dead_clicks)?this.instance.config.capture_dead_clicks:{};t.__onCapture=this.onCapture,this.tt=It.__PosthogExtensions__.initDeadClicksAutocapture(this.instance,t),this.tt.start(Ze),Av.info("starting...")}}else Av.error("`document` not found. Cannot start.")}stop(){this.tt&&(this.tt.stop(),this.tt=void 0,Av.info("stopping..."))}}var Yp=bn("[ExceptionAutocapture]");class Oz{constructor(e){var t,n,s;this.rt=()=>{var i;if(_e&&this.isEnabled&&(i=It.__PosthogExtensions__)!=null&&i.errorWrappingFunctions){var c=It.__PosthogExtensions__.errorWrappingFunctions.wrapOnError,d=It.__PosthogExtensions__.errorWrappingFunctions.wrapUnhandledRejection,m=It.__PosthogExtensions__.errorWrappingFunctions.wrapConsoleError;try{!this.st&&this.R.capture_unhandled_errors&&(this.st=c(this.captureException.bind(this))),!this.nt&&this.R.capture_unhandled_rejections&&(this.nt=d(this.captureException.bind(this))),!this.ot&&this.R.capture_console_errors&&(this.ot=m(this.captureException.bind(this)))}catch(p){Yp.error("failed to start",p),this.ut()}}},this._instance=e,this.ht=!((t=this._instance.persistence)==null||!t.props[Lk]),this.dt=new N8({refillRate:(n=this._instance.config.error_tracking.__exceptionRateLimiterRefillRate)!==null&&n!==void 0?n:1,bucketSize:(s=this._instance.config.error_tracking.__exceptionRateLimiterBucketSize)!==null&&s!==void 0?s:10,refillInterval:1e4,h:Yp}),this.R=this.vt(),this.startIfEnabledOrStop()}vt(){var e=this._instance.config.capture_exceptions,t={capture_unhandled_errors:!1,capture_unhandled_rejections:!1,capture_console_errors:!1};return qn(e)?t=it({},t,e):(et(e)?this.ht:e)&&(t=it({},t,{capture_unhandled_errors:!0,capture_unhandled_rejections:!0})),t}get isEnabled(){return this.R.capture_console_errors||this.R.capture_unhandled_errors||this.R.capture_unhandled_rejections}startIfEnabledOrStop(){this.isEnabled?(Yp.info("enabled"),this.ut(),this.it(this.rt)):this.ut()}it(e){var t,n;(t=It.__PosthogExtensions__)!=null&&t.errorWrappingFunctions&&e(),(n=It.__PosthogExtensions__)==null||n.loadExternalDependency==null||n.loadExternalDependency(this._instance,"exception-autocapture",(s=>{if(s)return Yp.error("failed to load script",s);e()}))}ut(){var e,t,n;(e=this.st)==null||e.call(this),this.st=void 0,(t=this.nt)==null||t.call(this),this.nt=void 0,(n=this.ot)==null||n.call(this),this.ot=void 0}onRemoteConfig(e){var t=e.autocaptureExceptions;this.ht=!!t||!1,this._instance.persistence&&this._instance.persistence.register({[Lk]:this.ht}),this.R=this.vt(),this.startIfEnabledOrStop()}onConfigChange(){this.R=this.vt()}captureException(e){var t,n,s=(t=e==null||(n=e.$exception_list)==null||(n=n[0])==null?void 0:n.type)!==null&&t!==void 0?t:"Exception";this.dt.consumeRateLimit(s)?Yp.info("Skipping exception capture because of client rate limiting.",{exception:s}):this._instance.exceptions.sendExceptionEvent(e)}}function Jk(r,e,t){try{if(!(e in r))return()=>{};var n=r[e],s=t(n);return qc(s)&&(s.prototype=s.prototype||{},Object.defineProperties(s,{__posthog_wrapped__:{enumerable:!1,value:!0}})),r[e]=s,()=>{r[e]=n}}catch{return()=>{}}}class Dz{constructor(e){var t;this._instance=e,this.ct=(_e==null||(t=_e.location)==null?void 0:t.pathname)||""}get isEnabled(){return this._instance.config.capture_pageview==="history_change"}startIfEnabled(){this.isEnabled&&(st.info("History API monitoring enabled, starting..."),this.monitorHistoryChanges())}stop(){this.ft&&this.ft(),this.ft=void 0,st.info("History API monitoring stopped")}monitorHistoryChanges(){var e,t;if(_e&&_e.history){var n=this;(e=_e.history.pushState)!=null&&e.__posthog_wrapped__||Jk(_e.history,"pushState",(s=>function(i,c,d){s.call(this,i,c,d),n._t("pushState")})),(t=_e.history.replaceState)!=null&&t.__posthog_wrapped__||Jk(_e.history,"replaceState",(s=>function(i,c,d){s.call(this,i,c,d),n._t("replaceState")})),this.bt()}}_t(e){try{var t,n=_e==null||(t=_e.location)==null?void 0:t.pathname;if(!n)return;n!==this.ct&&this.isEnabled&&this._instance.capture("$pageview",{navigation_type:e}),this.ct=n}catch(s){st.error("Error capturing "+e+" pageview",s)}}bt(){if(!this.ft){var e=()=>{this._t("popstate")};Mn(_e,"popstate",e),this.ft=()=>{_e&&_e.removeEventListener("popstate",e)}}}}var Dx=bn("[SegmentIntegration]");function Lz(r,e){var t=r.config.segment;if(!t)return e();(function(n,s){var i=n.config.segment;if(!i)return s();var c=m=>{var p=()=>m.anonymousId()||Wc();n.config.get_device_id=p,m.id()&&(n.register({distinct_id:m.id(),$device_id:p()}),n.persistence.set_property(zl,"identified")),s()},d=i.user();"then"in d&&qc(d.then)?d.then(c):c(d)})(r,(()=>{t.register((n=>{Promise&&Promise.resolve||Dx.warn("This browser does not have Promise support, and can not use the segment integration");var s=(i,c)=>{if(!c)return i;i.event.userId||i.event.anonymousId===n.get_distinct_id()||(Dx.info("No userId set, resetting PostHog"),n.reset()),i.event.userId&&i.event.userId!==n.get_distinct_id()&&(Dx.info("UserId set, identifying with PostHog"),n.identify(i.event.userId));var d=n.calculateEventProperties(c,i.event.properties);return i.event.properties=Object.assign({},d,i.event.properties),i};return{name:"PostHog JS",type:"enrichment",version:"1.0.0",isLoaded:()=>!0,load:()=>Promise.resolve(),track:i=>s(i,i.event.event),page:i=>s(i,"$pageview"),identify:i=>s(i,"$identify"),screen:i=>s(i,"$screen")}})(r)).then((()=>{e()}))}))}var TA="posthog-js";function AA(r,e){var{organization:t,projectId:n,prefix:s,severityAllowList:i=["error"],sendExceptionsToPostHog:c=!0}=e===void 0?{}:e;return d=>{var m,p,v,x,b;if(!(i==="*"||i.includes(d.level))||!r.__loaded)return d;d.tags||(d.tags={});var S=r.requestRouter.endpointFor("ui","/project/"+r.config.token+"/person/"+r.get_distinct_id());d.tags["PostHog Person URL"]=S,r.sessionRecordingStarted()&&(d.tags["PostHog Recording URL"]=r.get_session_replay_url({withTimestamp:!0}));var N=((m=d.exception)==null?void 0:m.values)||[],E=N.map((A=>it({},A,{stacktrace:A.stacktrace?it({},A.stacktrace,{type:"raw",frames:(A.stacktrace.frames||[]).map((I=>it({},I,{platform:"web:javascript"})))}):void 0}))),T={$exception_message:((p=N[0])==null?void 0:p.value)||d.message,$exception_type:(v=N[0])==null?void 0:v.type,$exception_level:d.level,$exception_list:E,$sentry_event_id:d.event_id,$sentry_exception:d.exception,$sentry_exception_message:((x=N[0])==null?void 0:x.value)||d.message,$sentry_exception_type:(b=N[0])==null?void 0:b.type,$sentry_tags:d.tags};return t&&n&&(T.$sentry_url=(s||"https://sentry.io/organizations/")+t+"/issues/?project="+n+"&query="+d.event_id),c&&r.exceptions.sendExceptionEvent(T),d}}class Mz{constructor(e,t,n,s,i,c){this.name=TA,this.setupOnce=function(d){d(AA(e,{organization:t,projectId:n,prefix:s,severityAllowList:i,sendExceptionsToPostHog:c==null||c}))}}}var $z=_e!=null&&_e.location?yy(_e.location.hash,"__posthog")||yy(location.hash,"state"):null,Xk="_postHogToolbarParams",Qk=bn("[Toolbar]"),zc=(function(r){return r[r.UNINITIALIZED=0]="UNINITIALIZED",r[r.LOADING=1]="LOADING",r[r.LOADED=2]="LOADED",r})(zc||{});class Uz{constructor(e){this.instance=e}yt(e){It.ph_toolbar_state=e}wt(){var e;return(e=It.ph_toolbar_state)!==null&&e!==void 0?e:zc.UNINITIALIZED}maybeLoadToolbar(e,t,n){if(e===void 0&&(e=void 0),t===void 0&&(t=void 0),n===void 0&&(n=void 0),!_e||!Ze)return!1;e=e??_e.location,n=n??_e.history;try{if(!t){try{_e.localStorage.setItem("test","test"),_e.localStorage.removeItem("test")}catch{return!1}t=_e==null?void 0:_e.localStorage}var s,i=$z||yy(e.hash,"__posthog")||yy(e.hash,"state"),c=i?Ok((()=>JSON.parse(atob(decodeURIComponent(i)))))||Ok((()=>JSON.parse(decodeURIComponent(i)))):null;return c&&c.action==="ph_authorize"?((s=c).source="url",s&&Object.keys(s).length>0&&(c.desiredHash?e.hash=c.desiredHash:n?n.replaceState(n.state,"",e.pathname+e.search):e.hash="")):((s=JSON.parse(t.getItem(Xk)||"{}")).source="localstorage",delete s.userIntent),!(!s.token||this.instance.config.token!==s.token)&&(this.loadToolbar(s),!0)}catch{return!1}}xt(e){var t=It.ph_load_toolbar||It.ph_load_editor;!mr(t)&&qc(t)?t(e,this.instance):Qk.warn("No toolbar load function found")}loadToolbar(e){var t=!(Ze==null||!Ze.getElementById(fA));if(!_e||t)return!1;var n=this.instance.requestRouter.region==="custom"&&this.instance.config.advanced_disable_toolbar_metrics,s=it({token:this.instance.config.token},e,{apiURL:this.instance.requestRouter.endpointFor("ui")},n?{instrument:!1}:{});if(_e.localStorage.setItem(Xk,JSON.stringify(it({},s,{source:void 0}))),this.wt()===zc.LOADED)this.xt(s);else if(this.wt()===zc.UNINITIALIZED){var i;this.yt(zc.LOADING),(i=It.__PosthogExtensions__)==null||i.loadExternalDependency==null||i.loadExternalDependency(this.instance,"toolbar",(c=>{if(c)return Qk.error("[Toolbar] Failed to load",c),void this.yt(zc.UNINITIALIZED);this.yt(zc.LOADED),this.xt(s)})),Mn(_e,"turbolinks:load",(()=>{this.yt(zc.UNINITIALIZED),this.loadToolbar(s)}))}return!0}Et(e){return this.loadToolbar(e)}maybeLoadEditor(e,t,n){return e===void 0&&(e=void 0),t===void 0&&(t=void 0),n===void 0&&(n=void 0),this.maybeLoadToolbar(e,t,n)}}var zz=bn("[TracingHeaders]");class Hz{constructor(e){this.$t=void 0,this.St=void 0,this.rt=()=>{var t,n;et(this.$t)&&((t=It.__PosthogExtensions__)==null||(t=t.tracingHeadersPatchFns)==null||t._patchXHR(this._instance.config.__add_tracing_headers||[],this._instance.get_distinct_id(),this._instance.sessionManager)),et(this.St)&&((n=It.__PosthogExtensions__)==null||(n=n.tracingHeadersPatchFns)==null||n._patchFetch(this._instance.config.__add_tracing_headers||[],this._instance.get_distinct_id(),this._instance.sessionManager))},this._instance=e}it(e){var t,n;(t=It.__PosthogExtensions__)!=null&&t.tracingHeadersPatchFns&&e(),(n=It.__PosthogExtensions__)==null||n.loadExternalDependency==null||n.loadExternalDependency(this._instance,"tracing-headers",(s=>{if(s)return zz.error("failed to load script",s);e()}))}startIfEnabledOrStop(){var e,t;this._instance.config.__add_tracing_headers?this.it(this.rt):((e=this.$t)==null||e.call(this),(t=this.St)==null||t.call(this),this.$t=void 0,this.St=void 0)}}var Iv="https?://(.*)",_h=["gclid","gclsrc","dclid","gbraid","wbraid","fbclid","msclkid","twclid","li_fat_id","igshid","ttclid","rdt_cid","epik","qclid","sccid","irclid","_kx"],Bz=bh(["utm_source","utm_medium","utm_campaign","utm_content","utm_term","gad_source","mc_cid"],_h),og="<masked>",Gz=["li_fat_id"];function IA(r,e,t){if(!Ze)return{};var n,s=e?bh([],_h,t||[]):[],i=RA(sg(Ze.URL,s,og),r),c=(n={},en(Gz,(function(d){var m=Ba.q(d);n[d]=m||null})),n);return Rn(c,i)}function RA(r,e){var t=Bz.concat(e||[]),n={};return en(t,(function(s){var i=vy(r,s);n[s]=i||null})),n}function PA(r){var e=(function(i){return i?i.search(Iv+"google.([^/?]*)")===0?"google":i.search(Iv+"bing.com")===0?"bing":i.search(Iv+"yahoo.com")===0?"yahoo":i.search(Iv+"duckduckgo.com")===0?"duckduckgo":null:null})(r),t=e!="yahoo"?"q":"p",n={};if(!ua(e)){n.$search_engine=e;var s=Ze?vy(Ze.referrer,t):"";s.length&&(n.ph_keyword=s)}return n}function Zk(){return navigator.language||navigator.userLanguage}function jA(){return(Ze==null?void 0:Ze.referrer)||"$direct"}function FA(r,e){var t=r?bh([],_h,e||[]):[],n=_s==null?void 0:_s.href.substring(0,1e3);return{r:jA().substring(0,1e3),u:n?sg(n,t,og):void 0}}function OA(r){var e,{r:t,u:n}=r,s={$referrer:t,$referring_domain:t==null?void 0:t=="$direct"?"$direct":(e=gy(t))==null?void 0:e.host};if(n){s.$current_url=n;var i=gy(n);s.$host=i==null?void 0:i.host,s.$pathname=i==null?void 0:i.pathname;var c=RA(n);Rn(s,c)}if(t){var d=PA(t);Rn(s,d)}return s}function DA(){try{return Intl.DateTimeFormat().resolvedOptions().timeZone}catch{return}}function Wz(){try{return new Date().getTimezoneOffset()}catch{return}}function Vz(r,e){if(!Ro)return{};var t,n,s,i=r?bh([],_h,e||[]):[],[c,d]=(function(m){for(var p=0;p<Ik.length;p++){var[v,x]=Ik[p],b=v.exec(m),S=b&&(qc(x)?x(b,m):x);if(S)return S}return["",""]})(Ro);return Rn(X_({$os:c,$os_version:d,$browser:sA(Ro,navigator.vendor),$device:Rk(Ro),$device_type:(n=Ro,s=Rk(n),s===GT||s===BT||s==="Kobo"||s==="Kindle Fire"||s===nA?Hm:s===Gm||s===nh||s===Wm||s===Hw?"Console":s===VT?"Wearable":s?Ri:"Desktop"),$timezone:DA(),$timezone_offset:Wz()}),{$current_url:sg(_s==null?void 0:_s.href,i,og),$host:_s==null?void 0:_s.host,$pathname:_s==null?void 0:_s.pathname,$raw_user_agent:Ro.length>1e3?Ro.substring(0,997)+"...":Ro,$browser_version:L8(Ro,navigator.vendor),$browser_language:Zk(),$browser_language_prefix:(t=Zk(),typeof t=="string"?t.split("-")[0]:void 0),$screen_height:_e==null?void 0:_e.screen.height,$screen_width:_e==null?void 0:_e.screen.width,$viewport_height:_e==null?void 0:_e.innerHeight,$viewport_width:_e==null?void 0:_e.innerWidth,$lib:"web",$lib_version:Ul.LIB_VERSION,$insert_id:Math.random().toString(36).substring(2,10)+Math.random().toString(36).substring(2,10),$time:Date.now()/1e3})}var $c=bn("[Web Vitals]"),eC=9e5;class qz{constructor(e){var t;this.kt=!1,this.P=!1,this.N={url:void 0,metrics:[],firstMetricTimestamp:void 0},this.Pt=()=>{clearTimeout(this.Tt),this.N.metrics.length!==0&&(this._instance.capture("$web_vitals",this.N.metrics.reduce(((n,s)=>it({},n,{["$web_vitals_"+s.name+"_event"]:it({},s),["$web_vitals_"+s.name+"_value"]:s.value})),{})),this.N={url:void 0,metrics:[],firstMetricTimestamp:void 0})},this.It=n=>{var s,i=(s=this._instance.sessionManager)==null?void 0:s.checkAndGetSessionAndWindowId(!0);if(et(i))$c.error("Could not read session ID. Dropping metrics!");else{this.N=this.N||{url:void 0,metrics:[],firstMetricTimestamp:void 0};var c=this.Ct();et(c)||(mr(n==null?void 0:n.name)||mr(n==null?void 0:n.value)?$c.error("Invalid metric received",n):this.Rt&&n.value>=this.Rt?$c.error("Ignoring metric with value >= "+this.Rt,n):(this.N.url!==c&&(this.Pt(),this.Tt=setTimeout(this.Pt,this.flushToCaptureTimeoutMs)),et(this.N.url)&&(this.N.url=c),this.N.firstMetricTimestamp=et(this.N.firstMetricTimestamp)?Date.now():this.N.firstMetricTimestamp,n.attribution&&n.attribution.interactionTargetElement&&(n.attribution.interactionTargetElement=void 0),this.N.metrics.push(it({},n,{$current_url:c,$session_id:i.sessionId,$window_id:i.windowId,timestamp:Date.now()})),this.N.metrics.length===this.allowedMetrics.length&&this.Pt()))}},this.rt=()=>{if(!this.P){var n,s,i,c,d=It.__PosthogExtensions__;et(d)||et(d.postHogWebVitalsCallbacks)||({onLCP:n,onCLS:s,onFCP:i,onINP:c}=d.postHogWebVitalsCallbacks),n&&s&&i&&c?(this.allowedMetrics.indexOf("LCP")>-1&&n(this.It.bind(this)),this.allowedMetrics.indexOf("CLS")>-1&&s(this.It.bind(this)),this.allowedMetrics.indexOf("FCP")>-1&&i(this.It.bind(this)),this.allowedMetrics.indexOf("INP")>-1&&c(this.It.bind(this)),this.P=!0):$c.error("web vitals callbacks not loaded - not starting")}},this._instance=e,this.kt=!((t=this._instance.persistence)==null||!t.props[$k]),this.startIfEnabled()}get allowedMetrics(){var e,t,n=qn(this._instance.config.capture_performance)?(e=this._instance.config.capture_performance)==null?void 0:e.web_vitals_allowed_metrics:void 0;return mr(n)?((t=this._instance.persistence)==null?void 0:t.props[zk])||["CLS","FCP","INP","LCP"]:n}get flushToCaptureTimeoutMs(){return(qn(this._instance.config.capture_performance)?this._instance.config.capture_performance.web_vitals_delayed_flush_ms:void 0)||5e3}get useAttribution(){var e=qn(this._instance.config.capture_performance)?this._instance.config.capture_performance.web_vitals_attribution:void 0;return e!=null&&e}get Rt(){var e=qn(this._instance.config.capture_performance)&&Kl(this._instance.config.capture_performance.__web_vitals_max_value)?this._instance.config.capture_performance.__web_vitals_max_value:eC;return 0<e&&e<=6e4?eC:e}get isEnabled(){var e=_s==null?void 0:_s.protocol;if(e!=="http:"&&e!=="https:")return $c.info("Web Vitals are disabled on non-http/https protocols"),!1;var t=qn(this._instance.config.capture_performance)?this._instance.config.capture_performance.web_vitals:Vl(this._instance.config.capture_performance)?this._instance.config.capture_performance:void 0;return Vl(t)?t:this.kt}startIfEnabled(){this.isEnabled&&!this.P&&($c.info("enabled, starting..."),this.it(this.rt))}onRemoteConfig(e){var t=qn(e.capturePerformance)&&!!e.capturePerformance.web_vitals,n=qn(e.capturePerformance)?e.capturePerformance.web_vitals_allowed_metrics:void 0;this._instance.persistence&&(this._instance.persistence.register({[$k]:t}),this._instance.persistence.register({[zk]:n})),this.kt=t,this.startIfEnabled()}it(e){var t,n;if((t=It.__PosthogExtensions__)!=null&&t.postHogWebVitalsCallbacks)e();else{var s=this.useAttribution?"web-vitals-with-attribution":"web-vitals";(n=It.__PosthogExtensions__)==null||n.loadExternalDependency==null||n.loadExternalDependency(this._instance,s,(i=>{i?$c.error("failed to load script",i):e()}))}}Ct(){var e=_e?_e.location.href:void 0;if(e){var t=this._instance.config.mask_personal_data_properties,n=this._instance.config.custom_personal_data_properties,s=t?bh([],_h,n||[]):[];return sg(e,s,og)}$c.error("Could not determine current URL")}}var Kz=bn("[Heatmaps]");function tC(r){return qn(r)&&"clientX"in r&&"clientY"in r&&Kl(r.clientX)&&Kl(r.clientY)}class Yz{constructor(e){var t;this.kt=!1,this.P=!1,this.Ft=null,this.instance=e,this.kt=!((t=this.instance.persistence)==null||!t.props[Ww]),this.rageclicks=new kA(e.config.rageclick)}get flushIntervalMilliseconds(){var e=5e3;return qn(this.instance.config.capture_heatmaps)&&this.instance.config.capture_heatmaps.flush_interval_milliseconds&&(e=this.instance.config.capture_heatmaps.flush_interval_milliseconds),e}get isEnabled(){return mr(this.instance.config.capture_heatmaps)?mr(this.instance.config.enable_heatmaps)?this.kt:this.instance.config.enable_heatmaps:this.instance.config.capture_heatmaps!==!1}startIfEnabled(){if(this.isEnabled){if(this.P)return;Kz.info("starting..."),this.Ot(),this.Mt()}else{var e;clearInterval((e=this.Ft)!==null&&e!==void 0?e:void 0),this.At(),this.getAndClearBuffer()}}onRemoteConfig(e){var t=!!e.heatmaps;this.instance.persistence&&this.instance.persistence.register({[Ww]:t}),this.kt=t,this.startIfEnabled()}getAndClearBuffer(){var e=this.N;return this.N=void 0,e}jt(e){this.Dt(e.originalEvent,"deadclick")}Mt(){this.Ft&&clearInterval(this.Ft),this.Ft=(function(e){return(e==null?void 0:e.visibilityState)==="visible"})(Ze)?setInterval(this.Lt.bind(this),this.flushIntervalMilliseconds):null}Ot(){_e&&Ze&&(this.Nt=this.Lt.bind(this),Mn(_e,"beforeunload",this.Nt),this.Ut=e=>this.Dt(e||(_e==null?void 0:_e.event)),Mn(Ze,"click",this.Ut,{capture:!0}),this.zt=e=>this.Ht(e||(_e==null?void 0:_e.event)),Mn(Ze,"mousemove",this.zt,{capture:!0}),this.Bt=new NA(this.instance,jz,this.jt.bind(this)),this.Bt.startIfEnabled(),this.qt=this.Mt.bind(this),Mn(Ze,"visibilitychange",this.qt),this.P=!0)}At(){var e;_e&&Ze&&(this.Nt&&_e.removeEventListener("beforeunload",this.Nt),this.Ut&&Ze.removeEventListener("click",this.Ut,{capture:!0}),this.zt&&Ze.removeEventListener("mousemove",this.zt,{capture:!0}),this.qt&&Ze.removeEventListener("visibilitychange",this.qt),clearTimeout(this.Wt),(e=this.Bt)==null||e.stop(),this.P=!1)}Gt(e,t){var n=this.instance.scrollManager.scrollY(),s=this.instance.scrollManager.scrollX(),i=this.instance.scrollManager.scrollElement(),c=(function(d,m,p){for(var v=d;v&&Vy(v)&&!Yc(v,"body");){if(v===p)return!1;if(pr(m,_e==null?void 0:_e.getComputedStyle(v).position))return!0;v=yA(v)}return!1})(gA(e),["fixed","sticky"],i);return{x:e.clientX+(c?0:s),y:e.clientY+(c?0:n),target_fixed:c,type:t}}Dt(e,t){var n;if(t===void 0&&(t="click"),!Hk(e.target)&&tC(e)){var s=this.Gt(e,t);(n=this.rageclicks)!=null&&n.isRageClick(e.clientX,e.clientY,new Date().getTime())&&this.Vt(it({},s,{type:"rageclick"})),this.Vt(s)}}Ht(e){!Hk(e.target)&&tC(e)&&(clearTimeout(this.Wt),this.Wt=setTimeout((()=>{this.Vt(this.Gt(e,"mousemove"))}),500))}Vt(e){if(_e){var t=_e.location.href,n=this.instance.config.mask_personal_data_properties,s=this.instance.config.custom_personal_data_properties,i=n?bh([],_h,s||[]):[],c=sg(t,i,og);this.N=this.N||{},this.N[c]||(this.N[c]=[]),this.N[c].push(e)}}Lt(){this.N&&!Jf(this.N)&&this.instance.capture("$$heatmap",{$heatmap_data:this.getAndClearBuffer()})}}class rC{constructor(e){this.Jt=(t,n,s)=>{s&&(s.noSessionId||s.activityTimeout||s.sessionPastMaximumLength)&&(st.info("[PageViewManager] Session rotated, clearing pageview state",{sessionId:t,changeReason:s}),this.Kt=void 0,this._instance.scrollManager.resetContext())},this._instance=e,this.Yt()}Yt(){var e;this.Xt=(e=this._instance.sessionManager)==null?void 0:e.onSessionId(this.Jt)}destroy(){var e;(e=this.Xt)==null||e.call(this),this.Xt=void 0}doPageView(e,t){var n,s=this.Qt(e,t);return this.Kt={pathname:(n=_e==null?void 0:_e.location.pathname)!==null&&n!==void 0?n:"",pageViewId:t,timestamp:e},this._instance.scrollManager.resetContext(),s}doPageLeave(e){var t;return this.Qt(e,(t=this.Kt)==null?void 0:t.pageViewId)}doEvent(){var e;return{$pageview_id:(e=this.Kt)==null?void 0:e.pageViewId}}Qt(e,t){var n=this.Kt;if(!n)return{$pageview_id:t};var s={$pageview_id:t,$prev_pageview_id:n.pageViewId},i=this._instance.scrollManager.getContext();if(i&&!this._instance.config.disable_scroll_properties){var{maxScrollHeight:c,lastScrollY:d,maxScrollY:m,maxContentHeight:p,lastContentY:v,maxContentY:x}=i;if(!(et(c)||et(d)||et(m)||et(p)||et(v)||et(x))){c=Math.ceil(c),d=Math.ceil(d),m=Math.ceil(m),p=Math.ceil(p),v=Math.ceil(v),x=Math.ceil(x);var b=c<=1?1:qa(d/c,0,1,st),S=c<=1?1:qa(m/c,0,1,st),N=p<=1?1:qa(v/p,0,1,st),E=p<=1?1:qa(x/p,0,1,st);s=Rn(s,{$prev_pageview_last_scroll:d,$prev_pageview_last_scroll_percentage:b,$prev_pageview_max_scroll:m,$prev_pageview_max_scroll_percentage:S,$prev_pageview_last_content:v,$prev_pageview_last_content_percentage:N,$prev_pageview_max_content:x,$prev_pageview_max_content_percentage:E})}}return n.pathname&&(s.$prev_pageview_pathname=n.pathname),n.timestamp&&(s.$prev_pageview_duration=(e.getTime()-n.timestamp.getTime())/1e3),s}}var Gl=(function(r){return r.GZipJS="gzip-js",r.Base64="base64",r})({}),Pi=Uint8Array,jo=Uint16Array,mh=Uint32Array,tS=new Pi([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),rS=new Pi([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),nC=new Pi([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),LA=function(r,e){for(var t=new jo(31),n=0;n<31;++n)t[n]=e+=1<<r[n-1];var s=new mh(t[30]);for(n=1;n<30;++n)for(var i=t[n];i<t[n+1];++i)s[i]=i-t[n]<<5|n;return[t,s]},MA=LA(tS,2),Jz=MA[0],eb=MA[1];Jz[28]=258,eb[258]=28;for(var sC=LA(rS,0)[1],$A=new jo(32768),on=0;on<32768;++on){var td=(43690&on)>>>1|(21845&on)<<1;td=(61680&(td=(52428&td)>>>2|(13107&td)<<2))>>>4|(3855&td)<<4,$A[on]=((65280&td)>>>8|(255&td)<<8)>>>1}var Cm=function(r,e,t){for(var n=r.length,s=0,i=new jo(e);s<n;++s)++i[r[s]-1];var c,d=new jo(e);for(s=0;s<e;++s)d[s]=d[s-1]+i[s-1]<<1;for(c=new jo(n),s=0;s<n;++s)c[s]=$A[d[r[s]-1]++]>>>15-r[s];return c},dd=new Pi(288);for(on=0;on<144;++on)dd[on]=8;for(on=144;on<256;++on)dd[on]=9;for(on=256;on<280;++on)dd[on]=7;for(on=280;on<288;++on)dd[on]=8;var wy=new Pi(32);for(on=0;on<32;++on)wy[on]=5;var Xz=Cm(dd,9),Qz=Cm(wy,5),UA=function(r){return(r/8>>0)+(7&r&&1)},zA=function(r,e,t){(t==null||t>r.length)&&(t=r.length);var n=new(r instanceof jo?jo:r instanceof mh?mh:Pi)(t-e);return n.set(r.subarray(e,t)),n},Ol=function(r,e,t){t<<=7&e;var n=e/8>>0;r[n]|=t,r[n+1]|=t>>>8},Jp=function(r,e,t){t<<=7&e;var n=e/8>>0;r[n]|=t,r[n+1]|=t>>>8,r[n+2]|=t>>>16},Lx=function(r,e){for(var t=[],n=0;n<r.length;++n)r[n]&&t.push({s:n,f:r[n]});var s=t.length,i=t.slice();if(!s)return[new Pi(0),0];if(s==1){var c=new Pi(t[0].s+1);return c[t[0].s]=1,[c,1]}t.sort((function(O,B){return O.f-B.f})),t.push({s:-1,f:25001});var d=t[0],m=t[1],p=0,v=1,x=2;for(t[0]={s:-1,f:d.f+m.f,l:d,r:m};v!=s-1;)d=t[t[p].f<t[x].f?p++:x++],m=t[p!=v&&t[p].f<t[x].f?p++:x++],t[v++]={s:-1,f:d.f+m.f,l:d,r:m};var b=i[0].s;for(n=1;n<s;++n)i[n].s>b&&(b=i[n].s);var S=new jo(b+1),N=tb(t[v-1],S,0);if(N>e){n=0;var E=0,T=N-e,A=1<<T;for(i.sort((function(O,B){return S[B.s]-S[O.s]||O.f-B.f}));n<s;++n){var I=i[n].s;if(!(S[I]>e))break;E+=A-(1<<N-S[I]),S[I]=e}for(E>>>=T;E>0;){var D=i[n].s;S[D]<e?E-=1<<e-S[D]++-1:++n}for(;n>=0&&E;--n){var j=i[n].s;S[j]==e&&(--S[j],++E)}N=e}return[new Pi(S),N]},tb=function(r,e,t){return r.s==-1?Math.max(tb(r.l,e,t+1),tb(r.r,e,t+1)):e[r.s]=t},oC=function(r){for(var e=r.length;e&&!r[--e];);for(var t=new jo(++e),n=0,s=r[0],i=1,c=function(m){t[n++]=m},d=1;d<=e;++d)if(r[d]==s&&d!=e)++i;else{if(!s&&i>2){for(;i>138;i-=138)c(32754);i>2&&(c(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(c(s),--i;i>6;i-=6)c(8304);i>2&&(c(i-3<<5|8208),i=0)}for(;i--;)c(s);i=1,s=r[d]}return[t.subarray(0,n),e]},Xp=function(r,e){for(var t=0,n=0;n<e.length;++n)t+=r[n]*e[n];return t},rb=function(r,e,t){var n=t.length,s=UA(e+2);r[s]=255&n,r[s+1]=n>>>8,r[s+2]=255^r[s],r[s+3]=255^r[s+1];for(var i=0;i<n;++i)r[s+i+4]=t[i];return 8*(s+4+n)},iC=function(r,e,t,n,s,i,c,d,m,p,v){Ol(e,v++,t),++s[256];for(var x=Lx(s,15),b=x[0],S=x[1],N=Lx(i,15),E=N[0],T=N[1],A=oC(b),I=A[0],D=A[1],j=oC(E),O=j[0],B=j[1],G=new jo(19),K=0;K<I.length;++K)G[31&I[K]]++;for(K=0;K<O.length;++K)G[31&O[K]]++;for(var re=Lx(G,7),se=re[0],he=re[1],U=19;U>4&&!se[nC[U-1]];--U);var ge,ie,ae,de,J=p+5<<3,Y=Xp(s,dd)+Xp(i,wy)+c,$=Xp(s,b)+Xp(i,E)+c+14+3*U+Xp(G,se)+(2*G[16]+3*G[17]+7*G[18]);if(J<=Y&&J<=$)return rb(e,v,r.subarray(m,m+p));if(Ol(e,v,1+($<Y)),v+=2,$<Y){ge=Cm(b,S),ie=b,ae=Cm(E,T),de=E;var Q=Cm(se,he);for(Ol(e,v,D-257),Ol(e,v+5,B-1),Ol(e,v+10,U-4),v+=14,K=0;K<U;++K)Ol(e,v+3*K,se[nC[K]]);v+=3*U;for(var F=[I,O],H=0;H<2;++H){var te=F[H];for(K=0;K<te.length;++K){var Se=31&te[K];Ol(e,v,Q[Se]),v+=se[Se],Se>15&&(Ol(e,v,te[K]>>>5&127),v+=te[K]>>>12)}}}else ge=Xz,ie=dd,ae=Qz,de=wy;for(K=0;K<d;++K)if(n[K]>255){Se=n[K]>>>18&31,Jp(e,v,ge[Se+257]),v+=ie[Se+257],Se>7&&(Ol(e,v,n[K]>>>23&31),v+=tS[Se]);var ue=31&n[K];Jp(e,v,ae[ue]),v+=de[ue],ue>3&&(Jp(e,v,n[K]>>>5&8191),v+=rS[ue])}else Jp(e,v,ge[n[K]]),v+=ie[n[K]];return Jp(e,v,ge[256]),v+ie[256]},Zz=new mh([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),eH=(function(){for(var r=new mh(256),e=0;e<256;++e){for(var t=e,n=9;--n;)t=(1&t&&3988292384)^t>>>1;r[e]=t}return r})(),tH=function(r,e,t,n,s){return(function(i,c,d,m,p,v){var x=i.length,b=new Pi(m+x+5*(1+Math.floor(x/7e3))+p),S=b.subarray(m,b.length-p),N=0;if(!c||x<8)for(var E=0;E<=x;E+=65535){var T=E+65535;T<x?N=rb(S,N,i.subarray(E,T)):(S[E]=v,N=rb(S,N,i.subarray(E,x)))}else{for(var A=Zz[c-1],I=A>>>13,D=8191&A,j=(1<<d)-1,O=new jo(32768),B=new jo(j+1),G=Math.ceil(d/3),K=2*G,re=function(qe){return(i[qe]^i[qe+1]<<G^i[qe+2]<<K)&j},se=new mh(25e3),he=new jo(288),U=new jo(32),ge=0,ie=0,ae=(E=0,0),de=0,J=0;E<x;++E){var Y=re(E),$=32767&E,Q=B[Y];if(O[$]=Q,B[Y]=$,de<=E){var F=x-E;if((ge>7e3||ae>24576)&&F>423){N=iC(i,S,0,se,he,U,ie,ae,J,E-J,N),ae=ge=ie=0,J=E;for(var H=0;H<286;++H)he[H]=0;for(H=0;H<30;++H)U[H]=0}var te=2,Se=0,ue=D,ke=$-Q&32767;if(F>2&&Y==re(E-ke))for(var X=Math.min(I,F)-1,we=Math.min(32767,E),Ne=Math.min(258,F);ke<=we&&--ue&&$!=Q;){if(i[E+te]==i[E+te-ke]){for(var Me=0;Me<Ne&&i[E+Me]==i[E+Me-ke];++Me);if(Me>te){if(te=Me,Se=ke,Me>X)break;var St=Math.min(ke,Me-2),Te=0;for(H=0;H<St;++H){var Ge=E-ke+H+32768&32767,Ee=Ge-O[Ge]+32768&32767;Ee>Te&&(Te=Ee,Q=Ge)}}}ke+=($=Q)-(Q=O[$])+32768&32767}if(Se){se[ae++]=268435456|eb[te]<<18|sC[Se];var ye=31&eb[te],Ke=31&sC[Se];ie+=tS[ye]+rS[Ke],++he[257+ye],++U[Ke],de=E+te,++ge}else se[ae++]=i[E],++he[i[E]]}}N=iC(i,S,v,se,he,U,ie,ae,J,E-J,N)}return zA(b,0,m+UA(N)+p)})(r,e.level==null?6:e.level,e.mem==null?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(r.length)))):12+e.mem,t,n,!0)},Mx=function(r,e,t){for(;t;++e)r[e]=t,t>>>=8};function rH(r,e){e===void 0&&(e={});var t=(function(){var d=4294967295;return{p:function(m){for(var p=d,v=0;v<m.length;++v)p=eH[255&p^m[v]]^p>>>8;d=p},d:function(){return 4294967295^d}}})(),n=r.length;t.p(r);var s,i=tH(r,e,10+((s=e).filename&&s.filename.length+1||0),8),c=i.length;return(function(d,m){var p=m.filename;if(d[0]=31,d[1]=139,d[2]=8,d[8]=m.level<2?4:m.level==9?2:0,d[9]=3,m.mtime!=0&&Mx(d,4,Math.floor(new Date(m.mtime||Date.now())/1e3)),p){d[3]=8;for(var v=0;v<=p.length;++v)d[v+10]=p.charCodeAt(v)}})(i,e),Mx(i,c-8,t.d()),Mx(i,c-4,n),i}var nH=function(r){var e,t,n,s,i="";for(e=t=0,n=(r=(r+"").replace(/\r\n/g,`
`).replace(/\r/g,`
`)).length,s=0;s<n;s++){var c=r.charCodeAt(s),d=null;c<128?t++:d=c>127&&c<2048?String.fromCharCode(c>>6|192,63&c|128):String.fromCharCode(c>>12|224,c>>6&63|128,63&c|128),ua(d)||(t>e&&(i+=r.substring(e,t)),i+=d,e=t=s+1)}return t>e&&(i+=r.substring(e,r.length)),i},sH=!!Lw||!!Dw,aC="text/plain",by=function(r,e,t){var n;t===void 0&&(t=!0);var[s,i]=r.split("?"),c=it({},e),d=(n=i==null?void 0:i.split("&").map((p=>{var v,[x,b]=p.split("="),S=t&&(v=c[x])!==null&&v!==void 0?v:b;return delete c[x],x+"="+S})))!==null&&n!==void 0?n:[],m=wz(c);return m&&d.push(m),s+"?"+d.join("&")},ym=(r,e)=>JSON.stringify(r,((t,n)=>typeof n=="bigint"?n.toString():n),e),$x=r=>{var{data:e,compression:t}=r;if(e){if(t===Gl.GZipJS){var n=rH((function(m,p){var v=m.length;if(typeof TextEncoder<"u")return new TextEncoder().encode(m);for(var x=new Pi(m.length+(m.length>>>1)),b=0,S=function(A){x[b++]=A},N=0;N<v;++N){if(b+5>x.length){var E=new Pi(b+8+(v-N<<1));E.set(x),x=E}var T=m.charCodeAt(N);T<128||p?S(T):T<2048?(S(192|T>>>6),S(128|63&T)):T>55295&&T<57344?(S(240|(T=65536+(1047552&T)|1023&m.charCodeAt(++N))>>>18),S(128|T>>>12&63),S(128|T>>>6&63),S(128|63&T)):(S(224|T>>>12),S(128|T>>>6&63),S(128|63&T))}return zA(x,0,b)})(ym(e)),{mtime:0}),s=new Blob([n],{type:aC});return{contentType:aC,body:s,estimatedSize:s.size}}if(t===Gl.Base64){var i=(function(m){var p,v,x,b,S,N="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",E=0,T=0,A="",I=[];if(!m)return m;m=nH(m);do p=(S=m.charCodeAt(E++)<<16|m.charCodeAt(E++)<<8|m.charCodeAt(E++))>>18&63,v=S>>12&63,x=S>>6&63,b=63&S,I[T++]=N.charAt(p)+N.charAt(v)+N.charAt(x)+N.charAt(b);while(E<m.length);switch(A=I.join(""),m.length%3){case 1:A=A.slice(0,-2)+"==";break;case 2:A=A.slice(0,-1)+"="}return A})(ym(e)),c=(m=>"data="+encodeURIComponent(typeof m=="string"?m:ym(m)))(i);return{contentType:"application/x-www-form-urlencoded",body:c,estimatedSize:new Blob([c]).size}}var d=ym(e);return{contentType:"application/json",body:d,estimatedSize:new Blob([d]).size}}},Yv=[];Dw&&Yv.push({transport:"fetch",method:r=>{var e,t,{contentType:n,body:s,estimatedSize:i}=(e=$x(r))!==null&&e!==void 0?e:{},c=new Headers;en(r.headers,(function(v,x){c.append(x,v)})),n&&c.append("Content-Type",n);var d=r.url,m=null;if(kk){var p=new kk;m={signal:p.signal,timeout:setTimeout((()=>p.abort()),r.timeout)}}Dw(d,it({method:(r==null?void 0:r.method)||"GET",headers:c,keepalive:r.method==="POST"&&(i||0)<52428.8,body:s,signal:(t=m)==null?void 0:t.signal},r.fetchOptions)).then((v=>v.text().then((x=>{var b={statusCode:v.status,text:x};if(v.status===200)try{b.json=JSON.parse(x)}catch(S){st.error(S)}r.callback==null||r.callback(b)})))).catch((v=>{st.error(v),r.callback==null||r.callback({statusCode:0,text:v})})).finally((()=>m?clearTimeout(m.timeout):null))}}),Lw&&Yv.push({transport:"XHR",method:r=>{var e,t=new Lw;t.open(r.method||"GET",r.url,!0);var{contentType:n,body:s}=(e=$x(r))!==null&&e!==void 0?e:{};en(r.headers,(function(i,c){t.setRequestHeader(c,i)})),n&&t.setRequestHeader("Content-Type",n),r.timeout&&(t.timeout=r.timeout),r.disableXHRCredentials||(t.withCredentials=!0),t.onreadystatechange=()=>{if(t.readyState===4){var i={statusCode:t.status,text:t.responseText};if(t.status===200)try{i.json=JSON.parse(t.responseText)}catch{}r.callback==null||r.callback(i)}},t.send(s)}}),ni!=null&&ni.sendBeacon&&Yv.push({transport:"sendBeacon",method:r=>{var e=by(r.url,{beacon:"1"});try{var t,{contentType:n,body:s}=(t=$x(r))!==null&&t!==void 0?t:{},i=typeof s=="string"?new Blob([s],{type:n}):s;ni.sendBeacon(e,i)}catch{}}});var _y=function(r,e){if(!(function(t){try{new RegExp(t)}catch{return!1}return!0})(e))return!1;try{return new RegExp(e).test(r)}catch{return!1}};function lC(r,e,t){return ym({distinct_id:r,userPropertiesToSet:e,userPropertiesToSetOnce:t})}var HA={exact:(r,e)=>e.some((t=>r.some((n=>t===n)))),is_not:(r,e)=>e.every((t=>r.every((n=>t!==n)))),regex:(r,e)=>e.some((t=>r.some((n=>_y(t,n))))),not_regex:(r,e)=>e.every((t=>r.every((n=>!_y(t,n))))),icontains:(r,e)=>e.map(Rv).some((t=>r.map(Rv).some((n=>t.includes(n))))),not_icontains:(r,e)=>e.map(Rv).every((t=>r.map(Rv).every((n=>!t.includes(n))))),gt:(r,e)=>e.some((t=>{var n=parseFloat(t);return!isNaN(n)&&r.some((s=>n>parseFloat(s)))})),lt:(r,e)=>e.some((t=>{var n=parseFloat(t);return!isNaN(n)&&r.some((s=>n<parseFloat(s)))}))},Rv=r=>r.toLowerCase();function BA(r,e){return!r||Object.entries(r).every((t=>{var[n,s]=t,i=e==null?void 0:e[n];if(et(i)||ua(i))return!1;var c=[String(i)],d=HA[s.operator];return!!d&&d(s.values,c)}))}var Ux=bn("[Error tracking]");class oH{constructor(e){var t,n;this.Zt=[],this.ti=new U8([new Y8,new sz,new X8,new J8,new rz,new tz,new Z8,new nz],K8()),this._instance=e,this.Zt=(t=(n=this._instance.persistence)==null?void 0:n.get_property(Vw))!==null&&t!==void 0?t:[]}onRemoteConfig(e){var t,n,s,i=(t=(n=e.errorTracking)==null?void 0:n.suppressionRules)!==null&&t!==void 0?t:[],c=(s=e.errorTracking)==null?void 0:s.captureExtensionExceptions;this.Zt=i,this._instance.persistence&&this._instance.persistence.register({[Vw]:this.Zt,[Mk]:c})}get ii(){var e,t=!!this._instance.get_property(Mk),n=this._instance.config.error_tracking.captureExtensionExceptions;return(e=n??t)!==null&&e!==void 0&&e}buildProperties(e,t){return this.ti.buildFromUnknown(e,{syntheticException:t==null?void 0:t.syntheticException,mechanism:{handled:t==null?void 0:t.handled}})}sendExceptionEvent(e){var t=e.$exception_list;if(this.ei(t)){if(this.ri(t))return void Ux.info("Skipping exception capture because a suppression rule matched");if(!this.ii&&this.si(t))return void Ux.info("Skipping exception capture because it was thrown by an extension");if(!this._instance.config.error_tracking.__capturePostHogExceptions&&this.ni(t))return void Ux.info("Skipping exception capture because it was thrown by the PostHog SDK")}return this._instance.capture("$exception",e,{_noTruncate:!0,_batchKey:"exceptionEvent"})}ri(e){if(e.length===0)return!1;var t=e.reduce(((n,s)=>{var{type:i,value:c}=s;return Kn(i)&&i.length>0&&n.$exception_types.push(i),Kn(c)&&c.length>0&&n.$exception_values.push(c),n}),{$exception_types:[],$exception_values:[]});return this.Zt.some((n=>{var s=n.values.map((i=>{var c,d=HA[i.operator],m=$r(i.value)?i.value:[i.value],p=(c=t[i.key])!==null&&c!==void 0?c:[];return m.length>0&&d(m,p)}));return n.type==="OR"?s.some(Boolean):s.every(Boolean)}))}si(e){return e.flatMap((t=>{var n,s;return(n=(s=t.stacktrace)==null?void 0:s.frames)!==null&&n!==void 0?n:[]})).some((t=>t.filename&&t.filename.startsWith("chrome-extension://")))}ni(e){if(e.length>0){var t,n,s,i,c=(t=(n=e[0].stacktrace)==null?void 0:n.frames)!==null&&t!==void 0?t:[],d=c[c.length-1];return(s=d==null||(i=d.filename)==null?void 0:i.includes("posthog.com/static"))!==null&&s!==void 0&&s}return!1}ei(e){return!mr(e)&&$r(e)}}var Xo=bn("[FeatureFlags]"),Qp=bn("[FeatureFlags]",{debugEnabled:!0}),zx="$active_feature_flags",Uf="$override_feature_flags",cC="$feature_flag_payloads",Zp="$override_feature_flag_payloads",uC="$feature_flag_request_id",dC="$feature_flag_evaluated_at",fC=r=>{var e={};for(var[t,n]of Kv(r||{}))n&&(e[t]=n);return e},iH=r=>{var e=r.flags;return e?(r.featureFlags=Object.fromEntries(Object.keys(e).map((t=>{var n;return[t,(n=e[t].variant)!==null&&n!==void 0?n:e[t].enabled]}))),r.featureFlagPayloads=Object.fromEntries(Object.keys(e).filter((t=>e[t].enabled)).filter((t=>{var n;return(n=e[t].metadata)==null?void 0:n.payload})).map((t=>{var n;return[t,(n=e[t].metadata)==null?void 0:n.payload]})))):Xo.warn("Using an older version of the feature flags endpoint. Please upgrade your PostHog server to the latest version"),r},aH=(function(r){return r.FeatureFlags="feature_flags",r.Recordings="recordings",r})({});class lH{constructor(e){this.oi=!1,this.ai=!1,this.li=!1,this.ui=!1,this.hi=!1,this.di=!1,this.vi=!1,this.ci=!1,this._instance=e,this.featureFlagEventHandlers=[]}fi(){var e,t=(e=this._instance.config.evaluation_contexts)!==null&&e!==void 0?e:this._instance.config.evaluation_environments;return!this._instance.config.evaluation_environments||this._instance.config.evaluation_contexts||this.ci||(Xo.warn("evaluation_environments is deprecated. Use evaluation_contexts instead. evaluation_environments will be removed in a future version."),this.ci=!0),t!=null&&t.length?t.filter((n=>{var s=n&&typeof n=="string"&&n.trim().length>0;return s||Xo.error("Invalid evaluation context found:",n,"Expected non-empty string"),s})):[]}pi(){return this.fi().length>0}flags(){if(this._instance.config.__preview_remote_config)this.di=!0;else{var e=!this.gi&&(this._instance.config.advanced_disable_feature_flags||this._instance.config.advanced_disable_feature_flags_on_first_load);this.mi({disableFlags:e})}}get hasLoadedFlags(){return this.ai}getFlags(){return Object.keys(this.getFlagVariants())}getFlagsWithDetails(){var e=this._instance.get_property(qw),t=this._instance.get_property(Uf),n=this._instance.get_property(Zp);if(!n&&!t)return e||{};var s=Rn({},e||{}),i=[...new Set([...Object.keys(n||{}),...Object.keys(t||{})])];for(var c of i){var d,m,p=s[c],v=t==null?void 0:t[c],x=et(v)?(d=p==null?void 0:p.enabled)!==null&&d!==void 0&&d:!!v,b=et(v)?p.variant:typeof v=="string"?v:void 0,S=n==null?void 0:n[c],N=it({},p,{enabled:x,variant:x?b??(p==null?void 0:p.variant):void 0});x!==(p==null?void 0:p.enabled)&&(N.original_enabled=p==null?void 0:p.enabled),b!==(p==null?void 0:p.variant)&&(N.original_variant=p==null?void 0:p.variant),S&&(N.metadata=it({},p==null?void 0:p.metadata,{payload:S,original_payload:p==null||(m=p.metadata)==null?void 0:m.payload})),s[c]=N}return this.oi||(Xo.warn(" Overriding feature flag details!",{flagDetails:e,overriddenPayloads:n,finalDetails:s}),this.oi=!0),s}getFlagVariants(){var e=this._instance.get_property(Xf),t=this._instance.get_property(Uf);if(!t)return e||{};for(var n=Rn({},e),s=Object.keys(t),i=0;i<s.length;i++)n[s[i]]=t[s[i]];return this.oi||(Xo.warn(" Overriding feature flags!",{enabledFlags:e,overriddenFlags:t,finalFlags:n}),this.oi=!0),n}getFlagPayloads(){var e=this._instance.get_property(cC),t=this._instance.get_property(Zp);if(!t)return e||{};for(var n=Rn({},e||{}),s=Object.keys(t),i=0;i<s.length;i++)n[s[i]]=t[s[i]];return this.oi||(Xo.warn(" Overriding feature flag payloads!",{flagPayloads:e,overriddenPayloads:t,finalPayloads:n}),this.oi=!0),n}reloadFeatureFlags(){this.ui||this._instance.config.advanced_disable_feature_flags||this.gi||(this._instance.bi.emit("featureFlagsReloading",!0),this.gi=setTimeout((()=>{this.mi()}),5))}yi(){clearTimeout(this.gi),this.gi=void 0}ensureFlagsLoaded(){this.ai||this.li||this.gi||this.reloadFeatureFlags()}setAnonymousDistinctId(e){this.$anon_distinct_id=e}setReloadingPaused(e){this.ui=e}mi(e){var t;if(this.yi(),!this._instance.M())if(this.li)this.hi=!0;else{var n=this._instance.config.token,s=this._instance.get_property("$device_id"),i={token:n,distinct_id:this._instance.get_distinct_id(),groups:this._instance.getGroups(),$anon_distinct_id:this.$anon_distinct_id,person_properties:it({},((t=this._instance.persistence)==null?void 0:t.get_initial_props())||{},this._instance.get_property(vm)||{}),group_properties:this._instance.get_property(nd)};ua(s)||et(s)||(i.$device_id=s),(e!=null&&e.disableFlags||this._instance.config.advanced_disable_feature_flags)&&(i.disable_flags=!0),this.pi()&&(i.evaluation_contexts=this.fi());var c=this._instance.config.__preview_remote_config,d=c?"/flags/?v=2":"/flags/?v=2&config=true",m=this._instance.config.advanced_only_evaluate_survey_feature_flags?"&only_evaluate_survey_feature_flags=true":"",p=this._instance.requestRouter.endpointFor("flags",d+m);c&&(i.timezone=DA()),this.li=!0,this._instance._send_request({method:"POST",url:p,data:i,compression:this._instance.config.disable_compression?void 0:Gl.Base64,timeout:this._instance.config.feature_flag_request_timeout_ms,callback:v=>{var x,b,S=!0;if(v.statusCode===200&&(this.hi||(this.$anon_distinct_id=void 0),S=!1),this.li=!1,this.di||(this.di=!0,this._instance.wi((b=v.json)!==null&&b!==void 0?b:{})),!i.disable_flags||this.hi)if(this.vi=!S,v.json&&(x=v.json.quotaLimited)!=null&&x.includes(aH.FeatureFlags))Xo.warn("You have hit your feature flags quota limit, and will not be able to load feature flags until the quota is reset.  Please visit https://posthog.com/docs/billing/limits-alerts to learn more.");else{var N;i.disable_flags||this.receivedFeatureFlags((N=v.json)!==null&&N!==void 0?N:{},S),this.hi&&(this.hi=!1,this.mi())}}})}}getFeatureFlag(e,t){var n;if(t===void 0&&(t={}),this.ai||this.getFlags()&&this.getFlags().length>0){var s=this.getFeatureFlagResult(e,t);return(n=s==null?void 0:s.variant)!==null&&n!==void 0?n:s==null?void 0:s.enabled}Xo.warn('getFeatureFlag for key "'+e+`" failed. Feature flags didn't load in time.`)}getFeatureFlagDetails(e){return this.getFlagsWithDetails()[e]}getFeatureFlagPayload(e){var t=this.getFeatureFlagResult(e,{send_event:!1});return t==null?void 0:t.payload}getFeatureFlagResult(e,t){if(t===void 0&&(t={}),this.ai||this.getFlags()&&this.getFlags().length>0){var n=this.getFlagVariants(),s=e in n,i=n[e],c=this.getFlagPayloads()[e],d=String(i),m=this._instance.get_property(uC)||void 0,p=this._instance.get_property(dC)||void 0,v=this._instance.get_property(fy)||{};if((t.send_event||!("send_event"in t))&&(!(e in v)||!v[e].includes(d))){var x,b,S,N,E,T,A,I,D;$r(v[e])?v[e].push(d):v[e]=[d],(x=this._instance.persistence)==null||x.register({[fy]:v});var j=this.getFeatureFlagDetails(e),O={$feature_flag:e,$feature_flag_response:i,$feature_flag_payload:c||null,$feature_flag_request_id:m,$feature_flag_evaluated_at:p,$feature_flag_bootstrapped_response:((b=this._instance.config.bootstrap)==null||(b=b.featureFlags)==null?void 0:b[e])||null,$feature_flag_bootstrapped_payload:((S=this._instance.config.bootstrap)==null||(S=S.featureFlagPayloads)==null?void 0:S[e])||null,$used_bootstrap_value:!this.vi};et(j==null||(N=j.metadata)==null?void 0:N.version)||(O.$feature_flag_version=j.metadata.version);var B,G=(E=j==null||(T=j.reason)==null?void 0:T.description)!==null&&E!==void 0?E:j==null||(A=j.reason)==null?void 0:A.code;G&&(O.$feature_flag_reason=G),j!=null&&(I=j.metadata)!=null&&I.id&&(O.$feature_flag_id=j.metadata.id),et(j==null?void 0:j.original_variant)&&et(j==null?void 0:j.original_enabled)||(O.$feature_flag_original_response=et(j.original_variant)?j.original_enabled:j.original_variant),j!=null&&(D=j.metadata)!=null&&D.original_payload&&(O.$feature_flag_original_payload=j==null||(B=j.metadata)==null?void 0:B.original_payload),this._instance.capture("$feature_flag_called",O)}if(s){var K=c;if(!et(c))try{K=JSON.parse(c)}catch{}return{key:e,enabled:!!i,variant:typeof i=="string"?i:void 0,payload:K}}}else Xo.warn('getFeatureFlagResult for key "'+e+`" failed. Feature flags didn't load in time.`)}getRemoteConfigPayload(e,t){var n=this._instance.config.token,s={distinct_id:this._instance.get_distinct_id(),token:n};this.pi()&&(s.evaluation_contexts=this.fi()),this._instance._send_request({method:"POST",url:this._instance.requestRouter.endpointFor("flags","/flags/?v=2&config=true"),data:s,compression:this._instance.config.disable_compression?void 0:Gl.Base64,timeout:this._instance.config.feature_flag_request_timeout_ms,callback:i=>{var c,d=(c=i.json)==null?void 0:c.featureFlagPayloads;t((d==null?void 0:d[e])||void 0)}})}isFeatureEnabled(e,t){if(t===void 0&&(t={}),this.ai||this.getFlags()&&this.getFlags().length>0){var n=this.getFeatureFlag(e,t);return et(n)?void 0:!!n}Xo.warn('isFeatureEnabled for key "'+e+`" failed. Feature flags didn't load in time.`)}addFeatureFlagsHandler(e){this.featureFlagEventHandlers.push(e)}removeFeatureFlagsHandler(e){this.featureFlagEventHandlers=this.featureFlagEventHandlers.filter((t=>t!==e))}receivedFeatureFlags(e,t){if(this._instance.persistence){this.ai=!0;var n=this.getFlagVariants(),s=this.getFlagPayloads(),i=this.getFlagsWithDetails();(function(c,d,m,p,v){m===void 0&&(m={}),p===void 0&&(p={}),v===void 0&&(v={});var x=iH(c),b=x.flags,S=x.featureFlags,N=x.featureFlagPayloads;if(S){var E=c.requestId,T=c.evaluatedAt;if($r(S)){Xo.warn("v1 of the feature flags endpoint is deprecated. Please use the latest version.");var A={};if(S)for(var I=0;I<S.length;I++)A[S[I]]=!0;d&&d.register({[zx]:S,[Xf]:A})}else{var D=S,j=N,O=b;if(c.errorsWhileComputingFlags)if(b){var B=new Set(Object.keys(b).filter((G=>{var K;return!((K=b[G])!=null&&K.failed)})));D=it({},m,Object.fromEntries(Object.entries(D).filter((G=>{var[K]=G;return B.has(K)})))),j=it({},p,Object.fromEntries(Object.entries(j||{}).filter((G=>{var[K]=G;return B.has(K)})))),O=it({},v,Object.fromEntries(Object.entries(O||{}).filter((G=>{var[K]=G;return B.has(K)}))))}else D=it({},m,D),j=it({},p,j),O=it({},v,O);d&&d.register(it({[zx]:Object.keys(fC(D)),[Xf]:D||{},[cC]:j||{},[qw]:O||{}},E?{[uC]:E}:{},T?{[dC]:T}:{}))}}})(e,this._instance.persistence,n,s,i),this.xi(t)}}override(e,t){t===void 0&&(t=!1),Xo.warn("override is deprecated. Please use overrideFeatureFlags instead."),this.overrideFeatureFlags({flags:e,suppressWarning:t})}overrideFeatureFlags(e){if(!this._instance.__loaded||!this._instance.persistence)return Xo.uninitializedWarning("posthog.featureFlags.overrideFeatureFlags");if(e===!1)return this._instance.persistence.unregister(Uf),this._instance.persistence.unregister(Zp),this.xi(),Qp.info("All overrides cleared");if(e&&typeof e=="object"&&("flags"in e||"payloads"in e)){var t,n=e;if(this.oi=!!((t=n.suppressWarning)!==null&&t!==void 0&&t),"flags"in n){if(n.flags===!1)this._instance.persistence.unregister(Uf),Qp.info("Flag overrides cleared");else if(n.flags){if($r(n.flags)){for(var s={},i=0;i<n.flags.length;i++)s[n.flags[i]]=!0;this._instance.persistence.register({[Uf]:s})}else this._instance.persistence.register({[Uf]:n.flags});Qp.info("Flag overrides set",{flags:n.flags})}}return"payloads"in n&&(n.payloads===!1?(this._instance.persistence.unregister(Zp),Qp.info("Payload overrides cleared")):n.payloads&&(this._instance.persistence.register({[Zp]:n.payloads}),Qp.info("Payload overrides set",{payloads:n.payloads}))),void this.xi()}this.xi()}onFeatureFlags(e){if(this.addFeatureFlagsHandler(e),this.ai){var{flags:t,flagVariants:n}=this.Ei();e(t,n)}return()=>this.removeFeatureFlagsHandler(e)}updateEarlyAccessFeatureEnrollment(e,t,n){var s,i=(this._instance.get_property(gm)||[]).find((p=>p.flagKey===e)),c={["$feature_enrollment/"+e]:t},d={$feature_flag:e,$feature_enrollment:t,$set:c};i&&(d.$early_access_feature_name=i.name),n&&(d.$feature_enrollment_stage=n),this._instance.capture("$feature_enrollment_update",d),this.setPersonPropertiesForFlags(c,!1);var m=it({},this.getFlagVariants(),{[e]:t});(s=this._instance.persistence)==null||s.register({[zx]:Object.keys(fC(m)),[Xf]:m}),this.xi()}getEarlyAccessFeatures(e,t,n){t===void 0&&(t=!1);var s=this._instance.get_property(gm),i=n?"&"+n.map((c=>"stage="+c)).join("&"):"";if(s&&!t)return e(s);this._instance._send_request({url:this._instance.requestRouter.endpointFor("api","/api/early_access_features/?token="+this._instance.config.token+i),method:"GET",callback:c=>{var d,m;if(c.json){var p=c.json.earlyAccessFeatures;return(d=this._instance.persistence)==null||d.unregister(gm),(m=this._instance.persistence)==null||m.register({[gm]:p}),e(p)}}})}Ei(){var e=this.getFlags(),t=this.getFlagVariants();return{flags:e.filter((n=>t[n])),flagVariants:Object.keys(t).filter((n=>t[n])).reduce(((n,s)=>(n[s]=t[s],n)),{})}}xi(e){var{flags:t,flagVariants:n}=this.Ei();this.featureFlagEventHandlers.forEach((s=>s(t,n,{errorsLoading:e})))}setPersonPropertiesForFlags(e,t){t===void 0&&(t=!0);var n=this._instance.get_property(vm)||{};this._instance.register({[vm]:it({},n,e)}),t&&this._instance.reloadFeatureFlags()}resetPersonPropertiesForFlags(){this._instance.unregister(vm)}setGroupPropertiesForFlags(e,t){t===void 0&&(t=!0);var n=this._instance.get_property(nd)||{};Object.keys(n).length!==0&&Object.keys(n).forEach((s=>{n[s]=it({},n[s],e[s]),delete e[s]})),this._instance.register({[nd]:it({},n,e)}),t&&this._instance.reloadFeatureFlags()}resetGroupPropertiesForFlags(e){if(e){var t=this._instance.get_property(nd)||{};this._instance.register({[nd]:it({},t,{[e]:{}})})}else this._instance.unregister(nd)}reset(){this.ai=!1,this.li=!1,this.ui=!1,this.hi=!1,this.di=!1,this.vi=!1,this.$anon_distinct_id=void 0,this.yi(),this.oi=!1}}var cH=["cookie","localstorage","localstorage+cookie","sessionstorage","memory"];class Hx{constructor(e,t){this.R=e,this.props={},this.$i=!1,this.Si=(n=>{var s="";return n.token&&(s=n.token.replace(/\+/g,"PL").replace(/\//g,"SL").replace(/=/g,"EQ")),n.persistence_name?"ph_"+n.persistence_name:"ph_"+s+"_posthog"})(e),this.Y=this.ki(e),this.load(),e.debug&&st.info("Persistence loaded",e.persistence,it({},this.props)),this.update_config(e,e,t),this.save()}isDisabled(){return!!this.Pi}ki(e){cH.indexOf(e.persistence.toLowerCase())===-1&&(st.critical("Unknown persistence type "+e.persistence+"; falling back to localStorage+cookie"),e.persistence="localStorage+cookie");var t=(function(s){s===void 0&&(s=[]);var i=[...Iz,...s];return it({},hn,{W:function(c){try{var d={};try{d=Ba.W(c)||{}}catch{}var m=Rn(d,JSON.parse(hn.q(c)||"{}"));return hn.G(c,m),m}catch{}return null},G:function(c,d,m,p,v,x){try{hn.G(c,d,void 0,void 0,x);var b={};i.forEach((S=>{d[S]&&(b[S]=d[S])})),Object.keys(b).length&&Ba.G(c,b,m,p,v,x)}catch(S){hn.B(S)}},V:function(c,d){try{_e==null||_e.localStorage.removeItem(c),Ba.V(c,d)}catch(m){hn.B(m)}}})})(e.cookie_persisted_properties||[]),n=e.persistence.toLowerCase();return n==="localstorage"&&hn.H()?hn:n==="localstorage+cookie"&&t.H()?t:n==="sessionstorage"&&bs.H()?bs:n==="memory"?Rz:n==="cookie"?Ba:t.H()?t:Ba}properties(){var e={};return en(this.props,(function(t,n){if(n===Xf&&qn(t))for(var s=Object.keys(t),i=0;i<s.length;i++)e["$feature/"+s[i]]=t[s[i]];else d=n,m=!1,(ua(c=uz)?m:Ek&&c.indexOf===Ek?c.indexOf(d)!=-1:(en(c,(function(p){if(m||(m=p===d))return uy})),m))||(e[n]=t);var c,d,m})),e}load(){if(!this.Pi){var e=this.Y.W(this.Si);e&&(this.props=Rn({},e))}}save(){this.Pi||this.Y.G(this.Si,this.props,this.Ti,this.Ii,this.Ci,this.R.debug)}remove(){this.Y.V(this.Si,!1),this.Y.V(this.Si,!0)}clear(){this.remove(),this.props={}}register_once(e,t,n){if(qn(e)){et(t)&&(t="None"),this.Ti=et(n)?this.Ri:n;var s=!1;if(en(e,((i,c)=>{this.props.hasOwnProperty(c)&&this.props[c]!==t||(this.props[c]=i,s=!0)})),s)return this.save(),!0}return!1}register(e,t){if(qn(e)){this.Ti=et(t)?this.Ri:t;var n=!1;if(en(e,((s,i)=>{e.hasOwnProperty(i)&&this.props[i]!==s&&(this.props[i]=s,n=!0)})),n)return this.save(),!0}return!1}unregister(e){e in this.props&&(delete this.props[e],this.save())}update_campaign_params(){if(!this.$i){var e=IA(this.R.custom_campaign_params,this.R.mask_personal_data_properties,this.R.custom_personal_data_properties);Jf(X_(e))||this.register(e),this.$i=!0}}update_search_keyword(){var e;this.register((e=Ze==null?void 0:Ze.referrer)?PA(e):{})}update_referrer_info(){var e;this.register_once({$referrer:jA(),$referring_domain:Ze!=null&&Ze.referrer&&((e=gy(Ze.referrer))==null?void 0:e.host)||"$direct"},void 0)}set_initial_person_info(){this.props[Xw]||this.props[Qw]||this.register_once({[hy]:FA(this.R.mask_personal_data_properties,this.R.custom_personal_data_properties)},void 0)}get_initial_props(){var e={};en([Qw,Xw],(c=>{var d=this.props[c];d&&en(d,(function(m,p){e["$initial_"+Mw(p)]=m}))}));var t,n,s=this.props[hy];if(s){var i=(t=OA(s),n={},en(t,(function(c,d){n["$initial_"+Mw(d)]=c})),n);Rn(e,i)}return e}safe_merge(e){return en(this.props,(function(t,n){n in e||(e[n]=t)})),e}update_config(e,t,n){if(this.Ri=this.Ti=e.cookie_expiration,this.set_disabled(e.disable_persistence||!!n),this.set_cross_subdomain(e.cross_subdomain_cookie),this.set_secure(e.secure_cookie),e.persistence!==t.persistence||!((c,d)=>{if(c.length!==d.length)return!1;var m=[...c].sort(),p=[...d].sort();return m.every(((v,x)=>v===p[x]))})(e.cookie_persisted_properties||[],t.cookie_persisted_properties||[])){var s=this.ki(e),i=this.props;this.clear(),this.Y=s,this.props=i,this.save()}}set_disabled(e){this.Pi=e,this.Pi?this.remove():this.save()}set_cross_subdomain(e){e!==this.Ii&&(this.Ii=e,this.remove(),this.save())}set_secure(e){e!==this.Ci&&(this.Ci=e,this.remove(),this.save())}set_event_timer(e,t){var n=this.props[mm]||{};n[e]=t,this.props[mm]=n,this.save()}remove_event_timer(e){var t=(this.props[mm]||{})[e];return et(t)||(delete this.props[mm][e],this.save()),t}get_property(e){return this.props[e]}set_property(e,t){this.props[e]=t,this.save()}}var hC=bn("[Product Tours]"),Bx="ph_product_tours";class uH{constructor(e){this.Fi=null,this.Oi=null,this._instance=e}onRemoteConfig(e){this._instance.persistence&&this._instance.persistence.register({[Uk]:!(e==null||!e.productTours)}),this.loadIfEnabled()}loadIfEnabled(){var e,t;this.Fi||(e=this._instance).config.disable_product_tours||(t=e.persistence)==null||!t.get_property(Uk)||this.it((()=>this.Mi()))}it(e){var t,n;(t=It.__PosthogExtensions__)!=null&&t.generateProductTours?e():(n=It.__PosthogExtensions__)==null||n.loadExternalDependency==null||n.loadExternalDependency(this._instance,"product-tours",(s=>{s?hC.error("Could not load product tours script",s):e()}))}Mi(){var e;!this.Fi&&(e=It.__PosthogExtensions__)!=null&&e.generateProductTours&&(this.Fi=It.__PosthogExtensions__.generateProductTours(this._instance,!0))}getProductTours(e,t){if(t===void 0&&(t=!1),!$r(this.Oi)||t){var n=this._instance.persistence;if(n){var s=n.props[Bx];if($r(s)&&!t)return this.Oi=s,void e(s,{isLoaded:!0})}this._instance._send_request({url:this._instance.requestRouter.endpointFor("api","/api/product_tours/?token="+this._instance.config.token),method:"GET",callback:i=>{var c=i.statusCode;if(c!==200||!i.json){var d="Product Tours API could not be loaded, status: "+c;return hC.error(d),void e([],{isLoaded:!1,error:d})}var m=$r(i.json.product_tours)?i.json.product_tours:[];this.Oi=m,n&&n.register({[Bx]:m}),e(m,{isLoaded:!0})}})}else e(this.Oi,{isLoaded:!0})}getActiveProductTours(e){mr(this.Fi)?e([],{isLoaded:!1,error:"Product tours not loaded"}):this.Fi.getActiveProductTours(e)}showProductTour(e){var t;(t=this.Fi)==null||t.showTourById(e)}previewTour(e){this.Fi?this.Fi.previewTour(e):this.it((()=>{var t;this.Mi(),(t=this.Fi)==null||t.previewTour(e)}))}dismissProductTour(){var e;(e=this.Fi)==null||e.dismissTour("user_clicked_skip")}nextStep(){var e;(e=this.Fi)==null||e.nextStep()}previousStep(){var e;(e=this.Fi)==null||e.previousStep()}clearCache(){var e;this.Oi=null,(e=this._instance.persistence)==null||e.unregister(Bx)}resetTour(e){var t;(t=this.Fi)==null||t.resetTour(e)}resetAllTours(){var e;(e=this.Fi)==null||e.resetAllTours()}cancelPendingTour(e){var t;(t=this.Fi)==null||t.cancelPendingTour(e)}}var em=(function(r){return r.Activation="events",r.Cancellation="cancelEvents",r})({});(function(r){return r.Button="button",r.Tab="tab",r.Selector="selector",r})({});(function(r){return r.TopLeft="top_left",r.TopRight="top_right",r.TopCenter="top_center",r.MiddleLeft="middle_left",r.MiddleRight="middle_right",r.MiddleCenter="middle_center",r.Left="left",r.Center="center",r.Right="right",r.NextToTrigger="next_to_trigger",r})({});(function(r){return r.Top="top",r.Left="left",r.Right="right",r.Bottom="bottom",r})({});var Gx=(function(r){return r.Popover="popover",r.API="api",r.Widget="widget",r.ExternalSurvey="external_survey",r})({});(function(r){return r.Open="open",r.MultipleChoice="multiple_choice",r.SingleChoice="single_choice",r.Rating="rating",r.Link="link",r})({});(function(r){return r.NextQuestion="next_question",r.End="end",r.ResponseBased="response_based",r.SpecificQuestion="specific_question",r})({});(function(r){return r.Once="once",r.Recurring="recurring",r.Always="always",r})({});var xm=(function(r){return r.SHOWN="survey shown",r.DISMISSED="survey dismissed",r.SENT="survey sent",r.ABANDONED="survey abandoned",r})({}),Wx=(function(r){return r.SURVEY_ID="$survey_id",r.SURVEY_NAME="$survey_name",r.SURVEY_RESPONSE="$survey_response",r.SURVEY_ITERATION="$survey_iteration",r.SURVEY_ITERATION_START_DATE="$survey_iteration_start_date",r.SURVEY_PARTIALLY_COMPLETED="$survey_partially_completed",r.SURVEY_SUBMISSION_ID="$survey_submission_id",r.SURVEY_QUESTIONS="$survey_questions",r.SURVEY_COMPLETED="$survey_completed",r.PRODUCT_TOUR_ID="$product_tour_id",r.SURVEY_LAST_SEEN_DATE="$survey_last_seen_date",r})({}),nb=(function(r){return r.Popover="popover",r.Inline="inline",r})({}),Kr=bn("[Surveys]"),GA="seenSurvey_",dH=(r,e)=>{var t="$survey_"+e+"/"+r.id;return r.current_iteration&&r.current_iteration>0&&(t="$survey_"+e+"/"+r.id+"/"+r.current_iteration),t},pC=r=>((e,t)=>{var n=""+e+t.id;return t.current_iteration&&t.current_iteration>0&&(n=""+e+t.id+"_"+t.current_iteration),n})(GA,r),fH=[Gx.Popover,Gx.Widget,Gx.API],hH={ignoreConditions:!1,ignoreDelay:!1,displayType:nb.Popover};class nS{constructor(){this.Ai={},this.Ai={}}on(e,t){return this.Ai[e]||(this.Ai[e]=[]),this.Ai[e].push(t),()=>{this.Ai[e]=this.Ai[e].filter((n=>n!==t))}}emit(e,t){for(var n of this.Ai[e]||[])n(t);for(var s of this.Ai["*"]||[])s(e,t)}}function zf(r,e,t){if(mr(r))return!1;switch(t){case"exact":return r===e;case"contains":var n=e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/_/g,".").replace(/%/g,".*");return new RegExp(n,"i").test(r);case"regex":try{return new RegExp(e).test(r)}catch{return!1}default:return!1}}class pH{constructor(e){this.ji=new nS,this.Di=(t,n)=>this.Li(t,n)&&this.Ni(t,n)&&this.Ui(t,n)&&this.zi(t,n),this.Li=(t,n)=>n==null||!n.event||(t==null?void 0:t.event)===(n==null?void 0:n.event),this._instance=e,this.Hi=new Set,this.Bi=new Set}init(){var e;if(!et((e=this._instance)==null?void 0:e._addCaptureHook)){var t;(t=this._instance)==null||t._addCaptureHook(((n,s)=>{this.on(n,s)}))}}register(e){var t,n;if(!et((t=this._instance)==null?void 0:t._addCaptureHook)&&(e.forEach((c=>{var d,m;(d=this.Bi)==null||d.add(c),(m=c.steps)==null||m.forEach((p=>{var v;(v=this.Hi)==null||v.add((p==null?void 0:p.event)||"")}))})),(n=this._instance)!=null&&n.autocapture)){var s,i=new Set;e.forEach((c=>{var d;(d=c.steps)==null||d.forEach((m=>{m!=null&&m.selector&&i.add(m==null?void 0:m.selector)}))})),(s=this._instance)==null||s.autocapture.setElementSelectors(i)}}on(e,t){var n;t!=null&&e.length!=0&&(this.Hi.has(e)||this.Hi.has(t==null?void 0:t.event))&&this.Bi&&((n=this.Bi)==null?void 0:n.size)>0&&this.Bi.forEach((s=>{this.qi(t,s)&&this.ji.emit("actionCaptured",s.name)}))}Wi(e){this.onAction("actionCaptured",(t=>e(t)))}qi(e,t){if((t==null?void 0:t.steps)==null)return!1;for(var n of t.steps)if(this.Di(e,n))return!0;return!1}onAction(e,t){return this.ji.on(e,t)}Ni(e,t){if(t!=null&&t.url){var n,s=e==null||(n=e.properties)==null?void 0:n.$current_url;if(!s||typeof s!="string"||!zf(s,t.url,t.url_matching||"contains"))return!1}return!0}Ui(e,t){return!!this.Gi(e,t)&&!!this.Vi(e,t)&&!!this.Ji(e,t)}Gi(e,t){var n;if(t==null||!t.href)return!0;var s=this.Ki(e);if(s.length>0)return s.some((d=>zf(d.href,t.href,t.href_matching||"exact")));var i,c=(e==null||(n=e.properties)==null?void 0:n.$elements_chain)||"";return!!c&&zf((i=c.match(/(?::|")href="(.*?)"/))?i[1]:"",t.href,t.href_matching||"exact")}Vi(e,t){var n;if(t==null||!t.text)return!0;var s=this.Ki(e);if(s.length>0)return s.some((p=>zf(p.text,t.text,t.text_matching||"exact")||zf(p.$el_text,t.text,t.text_matching||"exact")));var i,c,d,m=(e==null||(n=e.properties)==null?void 0:n.$elements_chain)||"";return!!m&&(i=(function(p){for(var v,x=[],b=/(?::|")text="(.*?)"/g;!mr(v=b.exec(p));)x.includes(v[1])||x.push(v[1]);return x})(m),c=t.text,d=t.text_matching||"exact",i.some((p=>zf(p,c,d))))}Ji(e,t){var n,s;if(t==null||!t.selector)return!0;var i=e==null||(n=e.properties)==null?void 0:n.$element_selectors;if(i!=null&&i.includes(t.selector))return!0;var c=(e==null||(s=e.properties)==null?void 0:s.$elements_chain)||"";if(t.selector_regex&&c)try{return new RegExp(t.selector_regex).test(c)}catch{return!1}return!1}Ki(e){var t;return(e==null||(t=e.properties)==null?void 0:t.$elements)==null?[]:e==null?void 0:e.properties.$elements}zi(e,t){return t==null||!t.properties||t.properties.length===0||BA(t.properties.reduce(((n,s)=>{var i=$r(s.value)?s.value.map(String):s.value!=null?[String(s.value)]:[];return n[s.key]={values:i,operator:s.operator||"exact"},n}),{}),e==null?void 0:e.properties)}}class mH{constructor(e){this._instance=e,this.Yi=new Map,this.Xi=new Map,this.Qi=new Map}Zi(e,t){return!!e&&BA(e.propertyFilters,t==null?void 0:t.properties)}te(e,t){var n=new Map;return e.forEach((s=>{var i;(i=s.conditions)==null||(i=i[t])==null||(i=i.values)==null||i.forEach((c=>{if(c!=null&&c.name){var d=n.get(c.name)||[];d.push(s.id),n.set(c.name,d)}}))})),n}ie(e,t,n){var s=(n===em.Activation?this.Yi:this.Xi).get(e),i=[];return this.ee((c=>{i=c.filter((d=>s==null?void 0:s.includes(d.id)))})),i.filter((c=>{var d,m=(d=c.conditions)==null||(d=d[n])==null||(d=d.values)==null?void 0:d.find((p=>p.name===e));return this.Zi(m,t)}))}register(e){var t;et((t=this._instance)==null?void 0:t._addCaptureHook)||(this.re(e),this.se(e))}se(e){var t=e.filter((n=>{var s,i;return((s=n.conditions)==null?void 0:s.actions)&&((i=n.conditions)==null||(i=i.actions)==null||(i=i.values)==null?void 0:i.length)>0}));t.length!==0&&(this.ne==null&&(this.ne=new pH(this._instance),this.ne.init(),this.ne.Wi((n=>{this.onAction(n)}))),t.forEach((n=>{var s,i,c,d,m;n.conditions&&(s=n.conditions)!=null&&s.actions&&(i=n.conditions)!=null&&(i=i.actions)!=null&&i.values&&((c=n.conditions)==null||(c=c.actions)==null||(c=c.values)==null?void 0:c.length)>0&&((d=this.ne)==null||d.register(n.conditions.actions.values),(m=n.conditions)==null||(m=m.actions)==null||(m=m.values)==null||m.forEach((p=>{if(p&&p.name){var v=this.Qi.get(p.name);v&&v.push(n.id),this.Qi.set(p.name,v||[n.id])}})))})))}re(e){var t,n=e.filter((i=>{var c,d;return((c=i.conditions)==null?void 0:c.events)&&((d=i.conditions)==null||(d=d.events)==null||(d=d.values)==null?void 0:d.length)>0})),s=e.filter((i=>{var c,d;return((c=i.conditions)==null?void 0:c.cancelEvents)&&((d=i.conditions)==null||(d=d.cancelEvents)==null||(d=d.values)==null?void 0:d.length)>0}));(n.length!==0||s.length!==0)&&((t=this._instance)==null||t._addCaptureHook(((i,c)=>{this.onEvent(i,c)})),this.Yi=this.te(e,em.Activation),this.Xi=this.te(e,em.Cancellation))}onEvent(e,t){var n,s=this.oe(),i=this.ae(),c=this.le(),d=((n=this._instance)==null||(n=n.persistence)==null?void 0:n.props[i])||[];if(c===e&&t&&d.length>0){var m,p;s.info("event matched, removing item from activated items",{event:e,eventPayload:t,existingActivatedItems:d});var v=(t==null||(m=t.properties)==null?void 0:m.$survey_id)||(t==null||(p=t.properties)==null?void 0:p.$product_tour_id);if(v){var x=d.indexOf(v);x>=0&&(d.splice(x,1),this.ue(d))}}else{if(this.Xi.has(e)){var b=this.ie(e,t,em.Cancellation);b.length>0&&(s.info("cancel event matched, cancelling items",{event:e,itemsToCancel:b.map((N=>N.id))}),b.forEach((N=>{var E=d.indexOf(N.id);E>=0&&d.splice(E,1),this.he(N.id)})),this.ue(d))}if(this.Yi.has(e)){s.info("event name matched",{event:e,eventPayload:t,items:this.Yi.get(e)});var S=this.ie(e,t,em.Activation);this.ue(d.concat(S.map((N=>N.id))||[]))}}}onAction(e){var t,n=this.ae(),s=((t=this._instance)==null||(t=t.persistence)==null?void 0:t.props[n])||[];this.Qi.has(e)&&this.ue(s.concat(this.Qi.get(e)||[]))}ue(e){var t,n=this.oe(),s=this.ae(),i=[...new Set(e)].filter((c=>!this.de(c)));n.info("updating activated items",{activatedItems:i}),(t=this._instance)==null||(t=t.persistence)==null||t.register({[s]:i})}getActivatedIds(){var e,t=this.ae(),n=(e=this._instance)==null||(e=e.persistence)==null?void 0:e.props[t];return n||[]}getEventToItemsMap(){return this.Yi}ve(){return this.ne}}class gH extends mH{constructor(e){super(e)}ae(){return"$surveys_activated"}le(){return xm.SHOWN}ee(e){var t;(t=this._instance)==null||t.getSurveys(e)}he(e){var t;(t=this._instance)==null||t.cancelPendingSurvey(e)}oe(){return Kr}de(){return!1}getSurveys(){return this.getActivatedIds()}getEventToSurveys(){return this.getEventToItemsMap()}}class vH{constructor(e){this.ce=void 0,this._surveyManager=null,this.fe=!1,this.pe=[],this.ge=null,this._instance=e,this._surveyEventReceiver=null}onRemoteConfig(e){if(!this._instance.config.disable_surveys){var t=e.surveys;if(mr(t))return Kr.warn("Flags not loaded yet. Not loading surveys.");var n=$r(t);this.ce=n?t.length>0:t,Kr.info("flags response received, isSurveysEnabled: "+this.ce),this.loadIfEnabled()}}reset(){localStorage.removeItem("lastSeenSurveyDate");for(var e=[],t=0;t<localStorage.length;t++){var n=localStorage.key(t);(n!=null&&n.startsWith(GA)||n!=null&&n.startsWith("inProgressSurvey_"))&&e.push(n)}e.forEach((s=>localStorage.removeItem(s)))}loadIfEnabled(){if(!this._surveyManager)if(this.fe)Kr.info("Already initializing surveys, skipping...");else if(this._instance.config.disable_surveys)Kr.info("Disabled. Not loading surveys.");else if(this._instance.config.cookieless_mode&&this._instance.consent.isOptedOut())Kr.info("Not loading surveys in cookieless mode without consent.");else{var e=It==null?void 0:It.__PosthogExtensions__;if(e){if(!et(this.ce)||this._instance.config.advanced_enable_surveys){var t=this.ce||this._instance.config.advanced_enable_surveys;this.fe=!0;try{var n=e.generateSurveys;if(n)return void this._e(n,t);var s=e.loadExternalDependency;if(!s)return void this.me("PostHog loadExternalDependency extension not found.");s(this._instance,"surveys",(i=>{i||!e.generateSurveys?this.me("Could not load surveys script",i):this._e(e.generateSurveys,t)}))}catch(i){throw this.me("Error initializing surveys",i),i}finally{this.fe=!1}}}else Kr.error("PostHog Extensions not found.")}}_e(e,t){this._surveyManager=e(this._instance,t),this._surveyEventReceiver=new gH(this._instance),Kr.info("Surveys loaded successfully"),this.be({isLoaded:!0})}me(e,t){Kr.error(e,t),this.be({isLoaded:!1,error:e})}onSurveysLoaded(e){return this.pe.push(e),this._surveyManager&&this.be({isLoaded:!0}),()=>{this.pe=this.pe.filter((t=>t!==e))}}getSurveys(e,t){if(t===void 0&&(t=!1),this._instance.config.disable_surveys)return Kr.info("Disabled. Not loading surveys."),e([]);var n,s=this._instance.get_property(Kw);if(s&&!t)return e(s,{isLoaded:!0});typeof Promise<"u"&&this.ge?this.ge.then((i=>{var{surveys:c,context:d}=i;return e(c,d)})):(typeof Promise<"u"&&(this.ge=new Promise((i=>{n=i}))),this._instance._send_request({url:this._instance.requestRouter.endpointFor("api","/api/surveys/?token="+this._instance.config.token),method:"GET",timeout:this._instance.config.surveys_request_timeout_ms,callback:i=>{var c;this.ge=null;var d=i.statusCode;if(d!==200||!i.json){var m="Surveys API could not be loaded, status: "+d;Kr.error(m);var p={isLoaded:!1,error:m};return e([],p),void(n==null||n({surveys:[],context:p}))}var v,x=i.json.surveys||[],b=x.filter((N=>(function(E){return!(!E.start_date||E.end_date)})(N)&&((function(E){var T;return!((T=E.conditions)==null||(T=T.events)==null||(T=T.values)==null||!T.length)})(N)||(function(E){var T;return!((T=E.conditions)==null||(T=T.actions)==null||(T=T.values)==null||!T.length)})(N))));b.length>0&&((v=this._surveyEventReceiver)==null||v.register(b)),(c=this._instance.persistence)==null||c.register({[Kw]:x});var S={isLoaded:!0};e(x,S),n==null||n({surveys:x,context:S})}}))}be(e){for(var t of this.pe)try{if(!e.isLoaded)return t([],e);this.getSurveys(t)}catch(n){Kr.error("Error in survey callback",n)}}getActiveMatchingSurveys(e,t){if(t===void 0&&(t=!1),!mr(this._surveyManager))return this._surveyManager.getActiveMatchingSurveys(e,t);Kr.warn("init was not called")}ye(e){var t=null;return this.getSurveys((n=>{var s;t=(s=n.find((i=>i.id===e)))!==null&&s!==void 0?s:null})),t}we(e){if(mr(this._surveyManager))return{eligible:!1,reason:"SDK is not enabled or survey functionality is not yet loaded"};var t=typeof e=="string"?this.ye(e):e;return t?this._surveyManager.checkSurveyEligibility(t):{eligible:!1,reason:"Survey not found"}}canRenderSurvey(e){if(mr(this._surveyManager))return Kr.warn("init was not called"),{visible:!1,disabledReason:"SDK is not enabled or survey functionality is not yet loaded"};var t=this.we(e);return{visible:t.eligible,disabledReason:t.reason}}canRenderSurveyAsync(e,t){return mr(this._surveyManager)?(Kr.warn("init was not called"),Promise.resolve({visible:!1,disabledReason:"SDK is not enabled or survey functionality is not yet loaded"})):new Promise((n=>{this.getSurveys((s=>{var i,c=(i=s.find((m=>m.id===e)))!==null&&i!==void 0?i:null;if(c){var d=this.we(c);n({visible:d.eligible,disabledReason:d.reason})}else n({visible:!1,disabledReason:"Survey not found"})}),t)}))}renderSurvey(e,t,n){var s;if(mr(this._surveyManager))Kr.warn("init was not called");else{var i=typeof e=="string"?this.ye(e):e;if(i!=null&&i.id)if(fH.includes(i.type)){var c=Ze==null?void 0:Ze.querySelector(t);if(c)return(s=i.appearance)!=null&&s.surveyPopupDelaySeconds?(Kr.info("Rendering survey "+i.id+" with delay of "+i.appearance.surveyPopupDelaySeconds+" seconds"),void setTimeout((()=>{var d,m;Kr.info("Rendering survey "+i.id+" with delay of "+((d=i.appearance)==null?void 0:d.surveyPopupDelaySeconds)+" seconds"),(m=this._surveyManager)==null||m.renderSurvey(i,c,n),Kr.info("Survey "+i.id+" rendered")}),1e3*i.appearance.surveyPopupDelaySeconds)):void this._surveyManager.renderSurvey(i,c,n);Kr.warn("Survey element not found")}else Kr.warn("Surveys of type "+i.type+" cannot be rendered in the app");else Kr.warn("Survey not found")}}displaySurvey(e,t){var n;if(mr(this._surveyManager))Kr.warn("init was not called");else{var s=this.ye(e);if(s){var i=s;if((n=s.appearance)!=null&&n.surveyPopupDelaySeconds&&t.ignoreDelay&&(i=it({},s,{appearance:it({},s.appearance,{surveyPopupDelaySeconds:0})})),t.displayType!==nb.Popover&&t.initialResponses&&Kr.warn("initialResponses is only supported for popover surveys. prefill will not be applied."),t.ignoreConditions===!1){var c=this.canRenderSurvey(s);if(!c.visible)return void Kr.warn("Survey is not eligible to be displayed: ",c.disabledReason)}t.displayType!==nb.Inline?this._surveyManager.handlePopoverSurvey(i,t):this.renderSurvey(i,t.selector,t.properties)}else Kr.warn("Survey not found")}}cancelPendingSurvey(e){mr(this._surveyManager)?Kr.warn("init was not called"):this._surveyManager.cancelSurvey(e)}handlePageUnload(){var e;(e=this._surveyManager)==null||e.handlePageUnload()}}var Dl=bn("[Conversations]");class yH{constructor(e){this.xe=void 0,this._conversationsManager=null,this.Ee=!1,this.$e=null,this._instance=e}onRemoteConfig(e){if(!this._instance.config.disable_conversations){var t=e.conversations;mr(t)||(Vl(t)?this.xe=t:(this.xe=t.enabled,this.$e=t),this.loadIfEnabled())}}reset(){var e;(e=this._conversationsManager)==null||e.reset(),this._conversationsManager=null,this.xe=void 0,this.$e=null}loadIfEnabled(){if(!this._conversationsManager&&!this.Ee&&!(this._instance.config.disable_conversations||this._instance.config.cookieless_mode&&this._instance.consent.isOptedOut())){var e=It==null?void 0:It.__PosthogExtensions__;if(e&&!et(this.xe)&&this.xe)if(this.$e&&this.$e.token){this.Ee=!0;try{var t=e.initConversations;if(t)return this.Se(t),void(this.Ee=!1);var n=e.loadExternalDependency;if(!n)return void this.ke("PostHog loadExternalDependency extension not found.");n(this._instance,"conversations",(s=>{s||!e.initConversations?this.ke("Could not load conversations script",s):this.Se(e.initConversations),this.Ee=!1}))}catch(s){this.ke("Error initializing conversations",s),this.Ee=!1}}else Dl.error("Conversations enabled but missing token in remote config.")}}Se(e){if(this.$e)try{this._conversationsManager=e(this.$e,this._instance),Dl.info("Conversations loaded successfully")}catch(t){this.ke("Error completing conversations initialization",t)}else Dl.error("Cannot complete initialization: remote config is null")}ke(e,t){Dl.error(e,t),this._conversationsManager=null,this.Ee=!1}show(){this._conversationsManager?this._conversationsManager.show():Dl.warn("Conversations not loaded yet.")}hide(){this._conversationsManager&&this._conversationsManager.hide()}isAvailable(){return this.xe===!0&&!ua(this._conversationsManager)}isVisible(){var e,t;return(e=(t=this._conversationsManager)==null?void 0:t.isVisible())!==null&&e!==void 0&&e}sendMessage(e,t,n){var s=this;return Yf((function*(){return s._conversationsManager?s._conversationsManager.sendMessage(e,t,n):(Dl.warn("Conversations not available yet."),null)}))()}getMessages(e,t){var n=this;return Yf((function*(){return n._conversationsManager?n._conversationsManager.getMessages(e,t):(Dl.warn("Conversations not available yet."),null)}))()}markAsRead(e){var t=this;return Yf((function*(){return t._conversationsManager?t._conversationsManager.markAsRead(e):(Dl.warn("Conversations not available yet."),null)}))()}getTickets(e){var t=this;return Yf((function*(){return t._conversationsManager?t._conversationsManager.getTickets(e):(Dl.warn("Conversations not available yet."),null)}))()}getCurrentTicketId(){var e,t;return(e=(t=this._conversationsManager)==null?void 0:t.getCurrentTicketId())!==null&&e!==void 0?e:null}getWidgetSessionId(){var e,t;return(e=(t=this._conversationsManager)==null?void 0:t.getWidgetSessionId())!==null&&e!==void 0?e:null}}class xH{constructor(e){var t;this.Pe=!1,this.Te=!1,this._instance=e,this._instance&&(t=this._instance.config.logs)!=null&&t.captureConsoleLogs&&(this.Pe=!0)}onRemoteConfig(e){var t,n=(t=e.logs)==null?void 0:t.captureConsoleLogs;!mr(n)&&n&&(this.Pe=!0,this.loadIfEnabled())}reset(){}loadIfEnabled(){if(this.Pe&&!this.Te){var e=bn("[logs]"),t=It==null?void 0:It.__PosthogExtensions__;if(t){var n=t.loadExternalDependency;n?n(this._instance,"logs",(s=>{var i;s||(i=t.logs)==null||!i.initializeLogs?e.error("Could not load logs script",s):(t.logs.initializeLogs(this._instance),this.Te=!0)})):e.error("PostHog loadExternalDependency extension not found.")}else e.error("PostHog Extensions not found.")}}}var mC=bn("[RateLimiter]");class wH{constructor(e){this.serverLimits={},this.lastEventRateLimited=!1,this.checkForLimiting=t=>{var n=t.text;if(n&&n.length)try{(JSON.parse(n).quota_limited||[]).forEach((s=>{mC.info((s||"events")+" is quota limited."),this.serverLimits[s]=new Date().getTime()+6e4}))}catch(s){return void mC.warn('could not rate limit - continuing. Error: "'+(s==null?void 0:s.message)+'"',{text:n})}},this.instance=e,this.lastEventRateLimited=this.clientRateLimitContext(!0).isRateLimited}get captureEventsPerSecond(){var e;return((e=this.instance.config.rate_limiting)==null?void 0:e.events_per_second)||10}get captureEventsBurstLimit(){var e;return Math.max(((e=this.instance.config.rate_limiting)==null?void 0:e.events_burst_limit)||10*this.captureEventsPerSecond,this.captureEventsPerSecond)}clientRateLimitContext(e){var t,n,s;e===void 0&&(e=!1);var{captureEventsBurstLimit:i,captureEventsPerSecond:c}=this,d=new Date().getTime(),m=(t=(n=this.instance.persistence)==null?void 0:n.get_property(Jw))!==null&&t!==void 0?t:{tokens:i,last:d};m.tokens+=(d-m.last)/1e3*c,m.last=d,m.tokens>i&&(m.tokens=i);var p=m.tokens<1;return p||e||(m.tokens=Math.max(0,m.tokens-1)),!p||this.lastEventRateLimited||e||this.instance.capture("$$client_ingestion_warning",{$$client_ingestion_warning_message:"posthog-js client rate limited. Config is set to "+c+" events per second and "+i+" events burst limit."},{skip_client_rate_limiting:!0}),this.lastEventRateLimited=p,(s=this.instance.persistence)==null||s.set_property(Jw,m),{isRateLimited:p,remainingTokens:m.tokens}}isServerRateLimited(e){var t=this.serverLimits[e||"events"]||!1;return t!==!1&&new Date().getTime()<t}}var rd=bn("[RemoteConfig]");class bH{constructor(e){this._instance=e}get remoteConfig(){var e;return(e=It._POSTHOG_REMOTE_CONFIG)==null||(e=e[this._instance.config.token])==null?void 0:e.config}Ie(e){var t,n;(t=It.__PosthogExtensions__)!=null&&t.loadExternalDependency?(n=It.__PosthogExtensions__)==null||n.loadExternalDependency==null||n.loadExternalDependency(this._instance,"remote-config",(()=>e(this.remoteConfig))):(rd.error("PostHog Extensions not found. Cannot load remote config."),e())}Ce(e){this._instance._send_request({method:"GET",url:this._instance.requestRouter.endpointFor("assets","/array/"+this._instance.config.token+"/config"),callback:t=>{e(t.json)}})}load(){try{if(this.remoteConfig)return rd.info("Using preloaded remote config",this.remoteConfig),void this.wi(this.remoteConfig);if(this._instance.M())return void rd.warn("Remote config is disabled. Falling back to local config.");this.Ie((e=>{if(!e)return rd.info("No config found after loading remote JS config. Falling back to JSON."),void this.Ce((t=>{this.wi(t)}));this.wi(e)}))}catch(e){rd.error("Error loading remote config",e)}}wi(e){e?this._instance.config.__preview_remote_config?(this._instance.wi(e),e.hasFeatureFlags!==!1&&this._instance.featureFlags.ensureFlagsLoaded()):rd.info("__preview_remote_config is disabled. Logging config instead",e):rd.error("Failed to fetch remote config from PostHog.")}}var sb=3e3;class _H{constructor(e,t){this.Re=!0,this.Fe=[],this.Oe=qa((t==null?void 0:t.flush_interval_ms)||sb,250,5e3,st.createLogger("flush interval"),sb),this.Me=e}enqueue(e){this.Fe.push(e),this.Ae||this.je()}unload(){this.De();var e=this.Fe.length>0?this.Le():{},t=Object.values(e);[...t.filter((n=>n.url.indexOf("/e")===0)),...t.filter((n=>n.url.indexOf("/e")!==0))].map((n=>{this.Me(it({},n,{transport:"sendBeacon"}))}))}enable(){this.Re=!1,this.je()}je(){var e=this;this.Re||(this.Ae=setTimeout((()=>{if(this.De(),this.Fe.length>0){var t=this.Le(),n=function(){var i=t[s],c=new Date().getTime();i.data&&$r(i.data)&&en(i.data,(d=>{d.offset=Math.abs(d.timestamp-c),delete d.timestamp})),e.Me(i)};for(var s in t)n()}}),this.Oe))}De(){clearTimeout(this.Ae),this.Ae=void 0}Le(){var e={};return en(this.Fe,(t=>{var n,s=t,i=(s?s.batchKey:null)||s.url;et(e[i])&&(e[i]=it({},s,{data:[]})),(n=e[i].data)==null||n.push(s.data)})),this.Fe=[],e}}var SH=["retriesPerformedSoFar"];class EH{constructor(e){this.Ne=!1,this.Ue=3e3,this.Fe=[],this._instance=e,this.Fe=[],this.ze=!0,!et(_e)&&"onLine"in _e.navigator&&(this.ze=_e.navigator.onLine,this.He=()=>{this.ze=!0,this.Lt()},this.Be=()=>{this.ze=!1},Mn(_e,"online",this.He),Mn(_e,"offline",this.Be))}get length(){return this.Fe.length}retriableRequest(e){var{retriesPerformedSoFar:t}=e,n=$T(e,SH);Vf(t)&&(n.url=by(n.url,{retry_count:t})),this._instance._send_request(it({},n,{callback:s=>{s.statusCode!==200&&(s.statusCode<400||s.statusCode>=500)&&(t??0)<10?this.qe(it({retriesPerformedSoFar:t},n)):n.callback==null||n.callback(s)}}))}qe(e){var t=e.retriesPerformedSoFar||0;e.retriesPerformedSoFar=t+1;var n=(function(c){var d=3e3*Math.pow(2,c),m=d/2,p=Math.min(18e5,d),v=(Math.random()-.5)*(p-m);return Math.ceil(p+v)})(t),s=Date.now()+n;this.Fe.push({retryAt:s,requestOptions:e});var i="Enqueued failed request for retry in "+n;navigator.onLine||(i+=" (Browser is offline)"),st.warn(i),this.Ne||(this.Ne=!0,this.We())}We(){if(this.Ge&&clearTimeout(this.Ge),this.Fe.length===0)return this.Ne=!1,void(this.Ge=void 0);this.Ge=setTimeout((()=>{this.ze&&this.Fe.length>0&&this.Lt(),this.We()}),this.Ue)}Lt(){var e=Date.now(),t=[],n=this.Fe.filter((i=>i.retryAt<e||(t.push(i),!1)));if(this.Fe=t,n.length>0)for(var{requestOptions:s}of n)this.retriableRequest(s)}unload(){for(var{requestOptions:e}of(this.Ge&&(clearTimeout(this.Ge),this.Ge=void 0),this.Ne=!1,et(_e)||(this.He&&(_e.removeEventListener("online",this.He),this.He=void 0),this.Be&&(_e.removeEventListener("offline",this.Be),this.Be=void 0)),this.Fe))try{this._instance._send_request(it({},e,{transport:"sendBeacon"}))}catch(t){st.error(t)}this.Fe=[]}}class kH{constructor(e){this.Ve=()=>{var t,n,s,i;this.Je||(this.Je={});var c=this.scrollElement(),d=this.scrollY(),m=c?Math.max(0,c.scrollHeight-c.clientHeight):0,p=d+((c==null?void 0:c.clientHeight)||0),v=(c==null?void 0:c.scrollHeight)||0;this.Je.lastScrollY=Math.ceil(d),this.Je.maxScrollY=Math.max(d,(t=this.Je.maxScrollY)!==null&&t!==void 0?t:0),this.Je.maxScrollHeight=Math.max(m,(n=this.Je.maxScrollHeight)!==null&&n!==void 0?n:0),this.Je.lastContentY=p,this.Je.maxContentY=Math.max(p,(s=this.Je.maxContentY)!==null&&s!==void 0?s:0),this.Je.maxContentHeight=Math.max(v,(i=this.Je.maxContentHeight)!==null&&i!==void 0?i:0)},this._instance=e}getContext(){return this.Je}resetContext(){var e=this.Je;return setTimeout(this.Ve,0),e}startMeasuringScrollPosition(){Mn(_e,"scroll",this.Ve,{capture:!0}),Mn(_e,"scrollend",this.Ve,{capture:!0}),Mn(_e,"resize",this.Ve)}scrollElement(){if(!this._instance.config.scroll_root_selector)return _e==null?void 0:_e.document.documentElement;var e=$r(this._instance.config.scroll_root_selector)?this._instance.config.scroll_root_selector:[this._instance.config.scroll_root_selector];for(var t of e){var n=_e==null?void 0:_e.document.querySelector(t);if(n)return n}}scrollY(){if(this._instance.config.scroll_root_selector){var e=this.scrollElement();return e&&e.scrollTop||0}return _e&&(_e.scrollY||_e.pageYOffset||_e.document.documentElement.scrollTop)||0}scrollX(){if(this._instance.config.scroll_root_selector){var e=this.scrollElement();return e&&e.scrollLeft||0}return _e&&(_e.scrollX||_e.pageXOffset||_e.document.documentElement.scrollLeft)||0}}var CH=r=>FA(r==null?void 0:r.config.mask_personal_data_properties,r==null?void 0:r.config.custom_personal_data_properties);class gC{constructor(e,t,n,s){this.Ke=i=>{var c=this.Ye();if(!c||c.sessionId!==i){var d={sessionId:i,props:this.Xe(this._instance)};this.Qe.register({[Yw]:d})}},this._instance=e,this.Ze=t,this.Qe=n,this.Xe=s||CH,this.Ze.onSessionId(this.Ke)}Ye(){return this.Qe.props[Yw]}getSetOnceProps(){var e,t=(e=this.Ye())==null?void 0:e.props;return t?"r"in t?OA(t):{$referring_domain:t.referringDomain,$pathname:t.initialPathName,utm_source:t.utm_source,utm_campaign:t.utm_campaign,utm_medium:t.utm_medium,utm_content:t.utm_content,utm_term:t.utm_term}:{}}getSessionProps(){var e={};return en(X_(this.getSetOnceProps()),((t,n)=>{n==="$current_url"&&(n="url"),e["$session_entry_"+Mw(n)]=t})),e}}var Vx=bn("[SessionId]");class vC{on(e,t){return this.tr.on(e,t)}constructor(e,t,n){var s;if(this.ir=[],this.er=void 0,this.tr=new nS,this.rr=(v,x)=>!(!Vf(v)||!Vf(x))&&Math.abs(v-x)>this.sessionTimeoutMs,!e.persistence)throw new Error("SessionIdManager requires a PostHogPersistence instance");if(e.config.cookieless_mode==="always")throw new Error('SessionIdManager cannot be used with cookieless_mode="always"');this.R=e.config,this.Qe=e.persistence,this.sr=void 0,this.nr=void 0,this._sessionStartTimestamp=null,this._sessionActivityTimestamp=null,this.ar=t||Wc,this.lr=n||Wc;var i=this.R.persistence_name||this.R.token,c=this.R.session_idle_timeout_seconds||1800;if(this._sessionTimeoutMs=1e3*qa(c,60,36e3,Vx.createLogger("session_idle_timeout_seconds"),1800),e.register({$configured_session_timeout_ms:this._sessionTimeoutMs}),this.ur(),this.hr="ph_"+i+"_window_id",this.dr="ph_"+i+"_primary_window_exists",this.vr()){var d=bs.W(this.hr),m=bs.W(this.dr);d&&!m?this.sr=d:bs.V(this.hr),bs.G(this.dr,!0)}if((s=this.R.bootstrap)!=null&&s.sessionID)try{var p=(v=>{var x=v.replace(/-/g,"");if(x.length!==32)throw new Error("Not a valid UUID");if(x[12]!=="7")throw new Error("Not a UUIDv7");return parseInt(x.substring(0,12),16)})(this.R.bootstrap.sessionID);this.cr(this.R.bootstrap.sessionID,new Date().getTime(),p)}catch(v){Vx.error("Invalid sessionID in bootstrap",v)}this.pr()}get sessionTimeoutMs(){return this._sessionTimeoutMs}onSessionId(e){return et(this.ir)&&(this.ir=[]),this.ir.push(e),this.nr&&e(this.nr,this.sr),()=>{this.ir=this.ir.filter((t=>t!==e))}}vr(){return this.R.persistence!=="memory"&&!this.Qe.Pi&&bs.H()}gr(e){e!==this.sr&&(this.sr=e,this.vr()&&bs.G(this.hr,e))}_r(){return this.sr?this.sr:this.vr()?bs.W(this.hr):null}cr(e,t,n){e===this.nr&&t===this._sessionActivityTimestamp&&n===this._sessionStartTimestamp||(this._sessionStartTimestamp=n,this._sessionActivityTimestamp=t,this.nr=e,this.Qe.register({[dy]:[t,e,n]}))}mr(){var e=this.Qe.props[dy];return $r(e)&&e.length===2&&e.push(e[0]),e||[0,null,0]}resetSessionId(){this.cr(null,null,null)}destroy(){clearTimeout(this.br),this.br=void 0,this.er&&_e&&(_e.removeEventListener("beforeunload",this.er,{capture:!1}),this.er=void 0),this.ir=[]}pr(){this.er=()=>{this.vr()&&bs.V(this.dr)},Mn(_e,"beforeunload",this.er,{capture:!1})}checkAndGetSessionAndWindowId(e,t){if(e===void 0&&(e=!1),t===void 0&&(t=null),this.R.cookieless_mode==="always")throw new Error('checkAndGetSessionAndWindowId should not be called with cookieless_mode="always"');var n=t||new Date().getTime(),[s,i,c]=this.mr(),d=this._r(),m=Vf(c)&&Math.abs(n-c)>864e5,p=!1,v=!i,x=!v&&!e&&this.rr(n,s);v||x||m?(i=this.ar(),d=this.lr(),Vx.info("new session ID generated",{sessionId:i,windowId:d,changeReason:{noSessionId:v,activityTimeout:x,sessionPastMaximumLength:m}}),c=n,p=!0):d||(d=this.lr(),p=!0);var b=Vf(s)&&e&&!m?s:n,S=Vf(c)?c:new Date().getTime();return this.gr(d),this.cr(i,b,S),e||this.ur(),p&&this.ir.forEach((N=>N(i,d,p?{noSessionId:v,activityTimeout:x,sessionPastMaximumLength:m}:void 0))),{sessionId:i,windowId:d,sessionStartTimestamp:S,changeReason:p?{noSessionId:v,activityTimeout:x,sessionPastMaximumLength:m}:void 0,lastActivityTimestamp:s}}ur(){clearTimeout(this.br),this.br=setTimeout((()=>{var[e]=this.mr();if(this.rr(new Date().getTime(),e)){var t=this.nr;this.resetSessionId(),this.tr.emit("forcedIdleReset",{idleSessionId:t})}}),1.1*this.sessionTimeoutMs)}}var NH=["$set_once","$set"],Uc=bn("[SiteApps]");class TH{constructor(e){this._instance=e,this.yr=[],this.apps={}}get isEnabled(){return!!this._instance.config.opt_in_site_apps}wr(e,t){if(t){var n=this.globalsForEvent(t);this.yr.push(n),this.yr.length>1e3&&(this.yr=this.yr.slice(10))}}get siteAppLoaders(){var e;return(e=It._POSTHOG_REMOTE_CONFIG)==null||(e=e[this._instance.config.token])==null?void 0:e.siteApps}init(){if(this.isEnabled){var e=this._instance._addCaptureHook(this.wr.bind(this));this.Er=()=>{e(),this.yr=[],this.Er=void 0}}}globalsForEvent(e){var t,n,s,i,c,d,m;if(!e)throw new Error("Event payload is required");var p={},v=this._instance.get_property("$groups")||[],x=this._instance.get_property("$stored_group_properties")||{};for(var[b,S]of Object.entries(x))p[b]={id:v[b],type:b,properties:S};var{$set_once:N,$set:E}=e;return{event:it({},$T(e,NH),{properties:it({},e.properties,E?{$set:it({},(t=(n=e.properties)==null?void 0:n.$set)!==null&&t!==void 0?t:{},E)}:{},N?{$set_once:it({},(s=(i=e.properties)==null?void 0:i.$set_once)!==null&&s!==void 0?s:{},N)}:{}),elements_chain:(c=(d=e.properties)==null?void 0:d.$elements_chain)!==null&&c!==void 0?c:"",distinct_id:(m=e.properties)==null?void 0:m.distinct_id}),person:{properties:this._instance.get_property("$stored_person_properties")},groups:p}}setupSiteApp(e){var t=this.apps[e.id],n=()=>{var d;!t.errored&&this.yr.length&&(Uc.info("Processing "+this.yr.length+" events for site app with id "+e.id),this.yr.forEach((m=>t.processEvent==null?void 0:t.processEvent(m))),t.processedBuffer=!0),Object.values(this.apps).every((m=>m.processedBuffer||m.errored))&&((d=this.Er)==null||d.call(this))},s=!1,i=d=>{t.errored=!d,t.loaded=!0,Uc.info("Site app with id "+e.id+" "+(d?"loaded":"errored")),s&&n()};try{var{processEvent:c}=e.init({posthog:this._instance,callback:d=>{i(d)}});c&&(t.processEvent=c),s=!0}catch(d){Uc.error("Error while initializing PostHog app with config id "+e.id,d),i(!1)}if(s&&t.loaded)try{n()}catch(d){Uc.error("Error while processing buffered events PostHog app with config id "+e.id,d),t.errored=!0}}$r(){var e=this.siteAppLoaders||[];for(var t of e)this.apps[t.id]={id:t.id,loaded:!1,errored:!1,processedBuffer:!1};for(var n of e)this.setupSiteApp(n)}Sr(e){if(Object.keys(this.apps).length!==0){var t=this.globalsForEvent(e);for(var n of Object.values(this.apps))try{n.processEvent==null||n.processEvent(t)}catch(s){Uc.error("Error while processing event "+e.event+" for site app "+n.id,s)}}}onRemoteConfig(e){var t,n,s,i=this;if((t=this.siteAppLoaders)!=null&&t.length)return this.isEnabled?(this.$r(),void this._instance.on("eventCaptured",(p=>this.Sr(p)))):void Uc.error('PostHog site apps are disabled. Enable the "opt_in_site_apps" config to proceed.');if((n=this.Er)==null||n.call(this),(s=e.siteApps)!=null&&s.length)if(this.isEnabled){var c=function(p){var v;It["__$$ph_site_app_"+p]=i._instance,(v=It.__PosthogExtensions__)==null||v.loadSiteApp==null||v.loadSiteApp(i._instance,m,(x=>{if(x)return Uc.error("Error while initializing PostHog app with config id "+p,x)}))};for(var{id:d,url:m}of e.siteApps)c(d)}else Uc.error('PostHog site apps are disabled. Enable the "opt_in_site_apps" config to proceed.')}}var WA=function(r,e){if(!r)return!1;var t=r.userAgent;if(t&&Nk(t,e))return!0;try{var n=r==null?void 0:r.userAgentData;if(n!=null&&n.brands&&n.brands.some((s=>Nk(s==null?void 0:s.brand,e))))return!0}catch{}return!!r.webdriver},wm=(function(r){return r.US="us",r.EU="eu",r.CUSTOM="custom",r})({}),yC="i.posthog.com";class AH{constructor(e){this.kr={},this.instance=e}get apiHost(){var e=this.instance.config.api_host.trim().replace(/\/$/,"");return e==="https://app.posthog.com"?"https://us.i.posthog.com":e}get flagsApiHost(){var e=this.instance.config.flags_api_host;return e?e.trim().replace(/\/$/,""):this.apiHost}get uiHost(){var e,t=(e=this.instance.config.ui_host)==null?void 0:e.replace(/\/$/,"");return t||(t=this.apiHost.replace("."+yC,".posthog.com")),t==="https://app.posthog.com"?"https://us.posthog.com":t}get region(){return this.kr[this.apiHost]||(/https:\/\/(app|us|us-assets)(\.i)?\.posthog\.com/i.test(this.apiHost)?this.kr[this.apiHost]=wm.US:/https:\/\/(eu|eu-assets)(\.i)?\.posthog\.com/i.test(this.apiHost)?this.kr[this.apiHost]=wm.EU:this.kr[this.apiHost]=wm.CUSTOM),this.kr[this.apiHost]}endpointFor(e,t){if(t===void 0&&(t=""),t&&(t=t[0]==="/"?t:"/"+t),e==="ui")return this.uiHost+t;if(e==="flags")return this.flagsApiHost+t;if(this.region===wm.CUSTOM)return this.apiHost+t;var n=yC+t;switch(e){case"assets":return"https://"+this.region+"-assets."+n;case"api":return"https://"+this.region+"."+n}}}var IH={icontains:(r,e)=>!!_e&&e.href.toLowerCase().indexOf(r.toLowerCase())>-1,not_icontains:(r,e)=>!!_e&&e.href.toLowerCase().indexOf(r.toLowerCase())===-1,regex:(r,e)=>!!_e&&_y(e.href,r),not_regex:(r,e)=>!!_e&&!_y(e.href,r),exact:(r,e)=>e.href===r,is_not:(r,e)=>e.href!==r};class Ls{constructor(e){var t=this;this.getWebExperimentsAndEvaluateDisplayLogic=function(n){n===void 0&&(n=!1),t.getWebExperiments((s=>{Ls.Pr("retrieved web experiments from the server"),t.Tr=new Map,s.forEach((i=>{if(i.feature_flag_key){var c;t.Tr&&(Ls.Pr("setting flag key ",i.feature_flag_key," to web experiment ",i),(c=t.Tr)==null||c.set(i.feature_flag_key,i));var d=t._instance.getFeatureFlag(i.feature_flag_key);Kn(d)&&i.variants[d]&&t.Ir(i.name,d,i.variants[d].transforms)}else if(i.variants)for(var m in i.variants){var p=i.variants[m];Ls.Cr(p)&&t.Ir(i.name,m,p.transforms)}}))}),n)},this._instance=e,this._instance.onFeatureFlags((n=>{this.onFeatureFlags(n)}))}onFeatureFlags(e){if(this._is_bot())Ls.Pr("Refusing to render web experiment since the viewer is a likely bot");else if(!this._instance.config.disable_web_experiments){if(mr(this.Tr))return this.Tr=new Map,this.loadIfEnabled(),void this.previewWebExperiment();Ls.Pr("applying feature flags",e),e.forEach((t=>{var n;if(this.Tr&&(n=this.Tr)!=null&&n.has(t)){var s,i=this._instance.getFeatureFlag(t),c=(s=this.Tr)==null?void 0:s.get(t);i&&c!=null&&c.variants[i]&&this.Ir(c.name,i,c.variants[i].transforms)}}))}}previewWebExperiment(){var e=Ls.getWindowLocation();if(e!=null&&e.search){var t=vy(e==null?void 0:e.search,"__experiment_id"),n=vy(e==null?void 0:e.search,"__experiment_variant");t&&n&&(Ls.Pr("previewing web experiments "+t+" && "+n),this.getWebExperiments((s=>{this.Rr(parseInt(t),n,s)}),!1,!0))}}loadIfEnabled(){this._instance.config.disable_web_experiments||this.getWebExperimentsAndEvaluateDisplayLogic()}getWebExperiments(e,t,n){if(this._instance.config.disable_web_experiments&&!n)return e([]);var s=this._instance.get_property("$web_experiments");if(s&&!t)return e(s);this._instance._send_request({url:this._instance.requestRouter.endpointFor("api","/api/web_experiments/?token="+this._instance.config.token),method:"GET",callback:i=>{if(i.statusCode!==200||!i.json)return e([]);var c=i.json.experiments||[];return e(c)}})}Rr(e,t,n){var s=n.filter((i=>i.id===e));s&&s.length>0&&(Ls.Pr("Previewing web experiment ["+s[0].name+"] with variant ["+t+"]"),this.Ir(s[0].name,t,s[0].variants[t].transforms))}static Cr(e){return!mr(e.conditions)&&Ls.Fr(e)&&Ls.Or(e)}static Fr(e){var t;if(mr(e.conditions)||mr((t=e.conditions)==null?void 0:t.url))return!0;var n,s,i,c=Ls.getWindowLocation();return!!c&&((n=e.conditions)==null||!n.url||IH[(s=(i=e.conditions)==null?void 0:i.urlMatchType)!==null&&s!==void 0?s:"icontains"](e.conditions.url,c))}static getWindowLocation(){return _e==null?void 0:_e.location}static Or(e){var t;if(mr(e.conditions)||mr((t=e.conditions)==null?void 0:t.utm))return!0;var n=IA();if(n.utm_source){var s,i,c,d,m,p,v,x,b=(s=e.conditions)==null||(s=s.utm)==null||!s.utm_campaign||((i=e.conditions)==null||(i=i.utm)==null?void 0:i.utm_campaign)==n.utm_campaign,S=(c=e.conditions)==null||(c=c.utm)==null||!c.utm_source||((d=e.conditions)==null||(d=d.utm)==null?void 0:d.utm_source)==n.utm_source,N=(m=e.conditions)==null||(m=m.utm)==null||!m.utm_medium||((p=e.conditions)==null||(p=p.utm)==null?void 0:p.utm_medium)==n.utm_medium,E=(v=e.conditions)==null||(v=v.utm)==null||!v.utm_term||((x=e.conditions)==null||(x=x.utm)==null?void 0:x.utm_term)==n.utm_term;return b&&N&&E&&S}return!1}static Pr(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];st.info("[WebExperiments] "+e,n)}Ir(e,t,n){this._is_bot()?Ls.Pr("Refusing to render web experiment since the viewer is a likely bot"):t!=="control"?n.forEach((s=>{if(s.selector){var i;Ls.Pr("applying transform of variant "+t+" for experiment "+e+" ",s);var c=(i=document)==null?void 0:i.querySelectorAll(s.selector);c==null||c.forEach((d=>{var m=d;s.html&&(m.innerHTML=s.html),s.css&&m.setAttribute("style",s.css)}))}})):Ls.Pr("Control variants leave the page unmodified.")}_is_bot(){return ni&&this._instance?WA(ni,this._instance.config.custom_blocked_useragents):void 0}}var RH=bn("[PostHog ExternalIntegrations]"),PH={intercom:"intercom-integration",crispChat:"crisp-chat-integration"};class jH{constructor(e){this._instance=e}it(e,t){var n;(n=It.__PosthogExtensions__)==null||n.loadExternalDependency==null||n.loadExternalDependency(this._instance,e,(s=>{if(s)return RH.error("failed to load script",s);t()}))}startIfEnabledOrStop(){var e=this,t=function(c){var d,m,p;!s||(d=It.__PosthogExtensions__)!=null&&(d=d.integrations)!=null&&d[c]||e.it(PH[c],(()=>{var v;(v=It.__PosthogExtensions__)==null||(v=v.integrations)==null||(v=v[c])==null||v.start(e._instance)})),!s&&(m=It.__PosthogExtensions__)!=null&&(m=m.integrations)!=null&&m[c]&&((p=It.__PosthogExtensions__)==null||(p=p.integrations)==null||(p=p[c])==null||p.stop())};for(var[n,s]of Object.entries((i=this._instance.config.integrations)!==null&&i!==void 0?i:{})){var i;t(n)}}}var ob="[SessionRecording]",tm=bn(ob);class xC{get started(){var e;return!((e=this.Mr)==null||!e.isStarted)}get status(){return this.Mr?this.Mr.status:this.Ar&&!this.jr?"disabled":"lazy_loading"}constructor(e){if(this._forceAllowLocalhostNetworkCapture=!1,this.Ar=!1,this.Dr=void 0,this._instance=e,!this._instance.sessionManager)throw tm.error("started without valid sessionManager"),new Error(ob+" started without valid sessionManager. This is a bug.");if(this._instance.config.cookieless_mode==="always")throw new Error(ob+' cannot be used with cookieless_mode="always"')}get jr(){var e,t=!((e=this._instance.get_property(Px))==null||!e.enabled),n=!this._instance.config.disable_session_recording,s=this._instance.config.disable_session_recording||this._instance.consent.isOptedOut();return _e&&t&&n&&!s}startIfEnabledOrStop(e){var t;if(!this.jr||(t=this.Mr)==null||!t.isStarted){var n=!et(Object.assign)&&!et(Array.from);this.jr&&n?(this.Lr(e),tm.info("starting")):this.stopRecording()}}Lr(e){var t,n,s;this.jr&&(It!=null&&(t=It.__PosthogExtensions__)!=null&&(t=t.rrweb)!=null&&t.record&&(n=It.__PosthogExtensions__)!=null&&n.initSessionRecording?this.Nr(e):(s=It.__PosthogExtensions__)==null||s.loadExternalDependency==null||s.loadExternalDependency(this._instance,this.Ur,(i=>{if(i)return tm.error("could not load recorder",i);this.Nr(e)})))}stopRecording(){var e,t;(e=this.Dr)==null||e.call(this),this.Dr=void 0,(t=this.Mr)==null||t.stop()}zr(){var e;(e=this._instance.persistence)==null||e.unregister(dA)}Hr(e){if(this._instance.persistence){var t,n,s=this._instance.persistence,i=()=>{var c=e.sessionRecording===!1?void 0:e.sessionRecording,d=c==null?void 0:c.sampleRate,m=mr(d)?null:parseFloat(d);mr(m)&&this.zr();var p=c==null?void 0:c.minimumDurationMilliseconds;s.register({[Px]:it({cache_timestamp:Date.now(),enabled:!!c},c,{networkPayloadCapture:it({capturePerformance:e.capturePerformance},c==null?void 0:c.networkPayloadCapture),canvasRecording:{enabled:c==null?void 0:c.recordCanvas,fps:c==null?void 0:c.canvasFps,quality:c==null?void 0:c.canvasQuality},sampleRate:m,minimumDurationMilliseconds:et(p)?null:p,endpoint:c==null?void 0:c.endpoint,triggerMatchType:c==null?void 0:c.triggerMatchType,masking:c==null?void 0:c.masking,urlTriggers:c==null?void 0:c.urlTriggers})})};i(),(t=this.Dr)==null||t.call(this),this.Dr=(n=this._instance.sessionManager)==null?void 0:n.onSessionId(i)}}onRemoteConfig(e){"sessionRecording"in e?e.sessionRecording!==!1?(this.Hr(e),this.Ar=!0,this.startIfEnabledOrStop()):this.Ar=!0:tm.info("skipping remote config with no sessionRecording",e)}log(e,t){var n;t===void 0&&(t="log"),(n=this.Mr)!=null&&n.log?this.Mr.log(e,t):tm.warn("log called before recorder was ready")}get Ur(){var e,t,n=(e=this._instance)==null||(e=e.persistence)==null?void 0:e.get_property(Px);return(n==null||(t=n.scriptConfig)==null?void 0:t.script)||"lazy-recorder"}Nr(e){var t,n;if((t=It.__PosthogExtensions__)==null||!t.initSessionRecording)throw Error("Called on script loaded before session recording is available");this.Mr||(this.Mr=(n=It.__PosthogExtensions__)==null?void 0:n.initSessionRecording(this._instance),this.Mr._forceAllowLocalhostNetworkCapture=this._forceAllowLocalhostNetworkCapture),this.Mr.start(e)}onRRwebEmit(e){var t;(t=this.Mr)==null||t.onRRwebEmit==null||t.onRRwebEmit(e)}overrideLinkedFlag(){var e,t;this.Mr||(t=this._instance.persistence)==null||t.register({$replay_override_linked_flag:!0}),(e=this.Mr)==null||e.overrideLinkedFlag()}overrideSampling(){var e,t;this.Mr||(t=this._instance.persistence)==null||t.register({$replay_override_sampling:!0}),(e=this.Mr)==null||e.overrideSampling()}overrideTrigger(e){var t,n;this.Mr||(n=this._instance.persistence)==null||n.register({[e==="url"?"$replay_override_url_trigger":"$replay_override_event_trigger"]:!0}),(t=this.Mr)==null||t.overrideTrigger(e)}get sdkDebugProperties(){var e;return((e=this.Mr)==null?void 0:e.sdkDebugProperties)||{$recording_status:this.status}}tryAddCustomEvent(e,t){var n;return!((n=this.Mr)==null||!n.tryAddCustomEvent(e,t))}}var Nm={},ib=()=>{},qf="posthog",VA=!sH&&(Ro==null?void 0:Ro.indexOf("MSIE"))===-1&&(Ro==null?void 0:Ro.indexOf("Mozilla"))===-1,wC=r=>{var e;return it({api_host:"https://us.i.posthog.com",flags_api_host:null,ui_host:null,token:"",autocapture:!0,cross_subdomain_cookie:cz(Ze==null?void 0:Ze.location),persistence:"localStorage+cookie",persistence_name:"",cookie_persisted_properties:[],loaded:ib,save_campaign_params:!0,custom_campaign_params:[],custom_blocked_useragents:[],save_referrer:!0,capture_pageleave:"if_capture_pageview",defaults:r??"unset",__preview_deferred_init_extensions:!1,debug:_s&&Kn(_s==null?void 0:_s.search)&&_s.search.indexOf("__posthog_debug=true")!==-1||!1,cookie_expiration:365,upgrade:!1,disable_session_recording:!1,disable_persistence:!1,disable_web_experiments:!0,disable_surveys:!1,disable_surveys_automatic_display:!1,disable_conversations:!1,disable_product_tours:!0,disable_external_dependency_loading:!1,enable_recording_console_log:void 0,secure_cookie:(_e==null||(e=_e.location)==null?void 0:e.protocol)==="https:",ip:!1,opt_out_capturing_by_default:!1,opt_out_persistence_by_default:!1,opt_out_useragent_filter:!1,opt_out_capturing_persistence_type:"localStorage",consent_persistence_name:null,opt_out_capturing_cookie_prefix:null,opt_in_site_apps:!1,property_denylist:[],respect_dnt:!1,sanitize_properties:null,request_headers:{},request_batching:!0,properties_string_max_length:65535,mask_all_element_attributes:!1,mask_all_text:!1,mask_personal_data_properties:!1,custom_personal_data_properties:[],advanced_disable_flags:!1,advanced_disable_decide:!1,advanced_disable_feature_flags:!1,advanced_disable_feature_flags_on_first_load:!1,advanced_only_evaluate_survey_feature_flags:!1,advanced_enable_surveys:!1,advanced_disable_toolbar_metrics:!1,feature_flag_request_timeout_ms:3e3,surveys_request_timeout_ms:1e4,on_request_error:t=>{var n="Bad HTTP status: "+t.statusCode+" "+t.text;st.error(n)},get_device_id:t=>t,capture_performance:void 0,name:"posthog",bootstrap:{},disable_compression:!1,session_idle_timeout_seconds:1800,person_profiles:"identified_only",before_send:void 0,request_queue_config:{flush_interval_ms:sb},error_tracking:{},_onCapture:ib,__preview_eager_load_replay:!1},(t=>({rageclick:!(t&&t>="2025-11-30")||{content_ignorelist:!0},capture_pageview:!(t&&t>="2025-05-24")||"history_change",session_recording:t&&t>="2025-11-30"?{strictMinimumDuration:!0}:{},external_scripts_inject_target:t&&t>="2026-01-30"?"head":"body",internal_or_test_user_hostname:t&&t>="2026-01-30"?/^(localhost|127\.0\.0\.1)$/:void 0}))(r))},bC=r=>{var e={};et(r.process_person)||(e.person_profiles=r.process_person),et(r.xhr_headers)||(e.request_headers=r.xhr_headers),et(r.cookie_name)||(e.persistence_name=r.cookie_name),et(r.disable_cookie)||(e.disable_persistence=r.disable_cookie),et(r.store_google)||(e.save_campaign_params=r.store_google),et(r.verbose)||(e.debug=r.verbose);var t=Rn({},e,r);return $r(r.property_blacklist)&&(et(r.property_denylist)?t.property_denylist=r.property_blacklist:$r(r.property_denylist)?t.property_denylist=[...r.property_blacklist,...r.property_denylist]:st.error("Invalid value for property_denylist config: "+r.property_denylist)),t};class FH{constructor(){this.__forceAllowLocalhost=!1}get Br(){return this.__forceAllowLocalhost}set Br(e){st.error("WebPerformanceObserver is deprecated and has no impact on network capture. Use `_forceAllowLocalhostNetworkCapture` on `posthog.sessionRecording`"),this.__forceAllowLocalhost=e}}class qy{get decideEndpointWasHit(){var e,t;return(e=(t=this.featureFlags)==null?void 0:t.hasLoadedFlags)!==null&&e!==void 0&&e}get flagsEndpointWasHit(){var e,t;return(e=(t=this.featureFlags)==null?void 0:t.hasLoadedFlags)!==null&&e!==void 0&&e}constructor(){this.webPerformance=new FH,this.qr=!1,this.version=Ul.LIB_VERSION,this.bi=new nS,this._calculate_event_properties=this.calculateEventProperties.bind(this),this.config=wC(),this.SentryIntegration=Mz,this.sentryIntegration=e=>(function(t,n){var s=AA(t,n);return{name:TA,processEvent:i=>s(i)}})(this,e),this.__request_queue=[],this.__loaded=!1,this.analyticsDefaultEndpoint="/e/",this.Wr=!1,this.Gr=null,this.Vr=null,this.Jr=null,this.featureFlags=new lH(this),this.toolbar=new Uz(this),this.scrollManager=new kH(this),this.pageViewManager=new rC(this),this.surveys=new vH(this),this.conversations=new yH(this),this.logs=new xH(this),this.experiments=new Ls(this),this.exceptions=new oH(this),this.rateLimiter=new wH(this),this.requestRouter=new AH(this),this.consent=new Pz(this),this.externalIntegrations=new jH(this),this.people={set:(e,t,n)=>{var s=Kn(e)?{[e]:t}:e;this.setPersonProperties(s),n==null||n({})},set_once:(e,t,n)=>{var s=Kn(e)?{[e]:t}:e;this.setPersonProperties(void 0,s),n==null||n({})}},this.on("eventCaptured",(e=>st.info('send "'+(e==null?void 0:e.event)+'"',e)))}init(e,t,n){if(n&&n!==qf){var s,i=(s=Nm[n])!==null&&s!==void 0?s:new qy;return i._init(e,t,n),Nm[n]=i,Nm[qf][n]=i,i}return this._init(e,t,n)}_init(e,t,n){var s;if(t===void 0&&(t={}),et(e)||$w(e))return st.critical("PostHog was initialized without a token. This likely indicates a misconfiguration. Please check the first argument passed to posthog.init()"),this;if(this.__loaded)return console.warn("[PostHog.js]","You have already initialized PostHog! Re-initializing is a no-op"),this;this.__loaded=!0,this.config={},t.debug=this.Kr(t.debug),this.Yr=t,this.Xr=[],t.person_profiles&&(this.Vr=t.person_profiles),this.set_config(Rn({},wC(t.defaults),bC(t),{name:n,token:e})),this.config.on_xhr_error&&st.error("on_xhr_error is deprecated. Use on_request_error instead"),this.compression=t.disable_compression?void 0:Gl.GZipJS;var i=this.Qr();this.persistence=new Hx(this.config,i),this.sessionPersistence=this.config.persistence==="sessionStorage"||this.config.persistence==="memory"?this.persistence:new Hx(it({},this.config,{persistence:"sessionStorage"}),i);var c=it({},this.persistence.props),d=it({},this.sessionPersistence.props);this.register({$initialization_time:new Date().toISOString()}),this.Zr=new _H((I=>this.ts(I)),this.config.request_queue_config),this.es=new EH(this),this.__request_queue=[];var m=this.config.cookieless_mode==="always"||this.config.cookieless_mode==="on_reject"&&this.consent.isExplicitlyOptedOut();if(m||(this.sessionManager=new vC(this),this.sessionPropsManager=new gC(this,this.sessionManager,this.persistence)),this.config.__preview_deferred_init_extensions?(st.info("Deferring extension initialization to improve startup performance"),setTimeout((()=>{this.rs(m)}),0)):(st.info("Initializing extensions synchronously"),this.rs(m)),Ul.DEBUG=Ul.DEBUG||this.config.debug,Ul.DEBUG&&st.info("Starting in debug mode",{this:this,config:t,thisC:it({},this.config),p:c,s:d}),((s=t.bootstrap)==null?void 0:s.distinctID)!==void 0){var p,v,x=this.config.get_device_id(Wc()),b=(p=t.bootstrap)!=null&&p.isIdentifiedID?x:t.bootstrap.distinctID;this.persistence.set_property(zl,(v=t.bootstrap)!=null&&v.isIdentifiedID?"identified":"anonymous"),this.register({distinct_id:t.bootstrap.distinctID,$device_id:b})}if(this.ss()){var S,N,E=Object.keys(((S=t.bootstrap)==null?void 0:S.featureFlags)||{}).filter((I=>{var D;return!((D=t.bootstrap)==null||(D=D.featureFlags)==null||!D[I])})).reduce(((I,D)=>{var j;return I[D]=((j=t.bootstrap)==null||(j=j.featureFlags)==null?void 0:j[D])||!1,I}),{}),T=Object.keys(((N=t.bootstrap)==null?void 0:N.featureFlagPayloads)||{}).filter((I=>E[I])).reduce(((I,D)=>{var j,O;return(j=t.bootstrap)!=null&&(j=j.featureFlagPayloads)!=null&&j[D]&&(I[D]=(O=t.bootstrap)==null||(O=O.featureFlagPayloads)==null?void 0:O[D]),I}),{});this.featureFlags.receivedFeatureFlags({featureFlags:E,featureFlagPayloads:T})}if(m)this.register_once({distinct_id:qp,$device_id:null},"");else if(!this.get_distinct_id()){var A=this.config.get_device_id(Wc());this.register_once({distinct_id:A,$device_id:A},""),this.persistence.set_property(zl,"anonymous")}return Mn(_e,"onpagehide"in self?"pagehide":"unload",this._handle_unload.bind(this),{passive:!1}),this.toolbar.maybeLoadToolbar(),t.segment?Lz(this,(()=>this.ns())):this.ns(),qc(this.config._onCapture)&&this.config._onCapture!==ib&&(st.warn("onCapture is deprecated. Please use `before_send` instead"),this.on("eventCaptured",(I=>this.config._onCapture(I.event,I)))),this.config.ip&&st.warn('The `ip` config option has NO EFFECT AT ALL and has been deprecated. Use a custom transformation or "Discard IP data" project setting instead. See https://posthog.com/tutorials/web-redact-properties#hiding-customer-ip-address for more information.'),this}rs(e){var t=performance.now();this.historyAutocapture=new Dz(this),this.historyAutocapture.startIfEnabled();var n=[];n.push((()=>{new Hz(this).startIfEnabledOrStop()})),n.push((()=>{var s;this.siteApps=new TH(this),(s=this.siteApps)==null||s.init()})),e||n.push((()=>{this.sessionRecording=new xC(this),this.sessionRecording.startIfEnabledOrStop()})),this.config.disable_scroll_properties||n.push((()=>{this.scrollManager.startMeasuringScrollPosition()})),n.push((()=>{this.autocapture=new Ez(this),this.autocapture.startIfEnabled()})),n.push((()=>{this.surveys.loadIfEnabled()})),n.push((()=>{this.logs.loadIfEnabled()})),n.push((()=>{this.conversations.loadIfEnabled()})),n.push((()=>{this.productTours=new uH(this),this.productTours.loadIfEnabled()})),n.push((()=>{this.heatmaps=new Yz(this),this.heatmaps.startIfEnabled()})),n.push((()=>{this.webVitalsAutocapture=new qz(this)})),n.push((()=>{this.exceptionObserver=new Oz(this),this.exceptionObserver.startIfEnabledOrStop()})),n.push((()=>{this.deadClicksAutocapture=new NA(this,Fz),this.deadClicksAutocapture.startIfEnabled()})),n.push((()=>{if(this.os){var s=this.os;this.os=void 0,this.wi(s)}})),this.ls(n,t)}ls(e,t){for(;e.length>0;){if(this.config.__preview_deferred_init_extensions&&performance.now()-t>=30&&e.length>0)return void setTimeout((()=>{this.ls(e,t)}),0);var n=e.shift();if(n)try{n()}catch(i){st.error("Error initializing extension:",i)}}var s=Math.round(performance.now()-t);this.register_for_session({$sdk_debug_extensions_init_method:this.config.__preview_deferred_init_extensions?"deferred":"synchronous",$sdk_debug_extensions_init_time_ms:s}),this.config.__preview_deferred_init_extensions&&st.info("PostHog extensions initialized ("+s+"ms)")}wi(e){var t,n,s,i,c,d,m,p,v;if(!Ze||!Ze.body)return st.info("document not ready yet, trying again in 500 milliseconds..."),void setTimeout((()=>{this.wi(e)}),500);this.config.__preview_deferred_init_extensions&&(this.os=e),this.compression=void 0,e.supportedCompression&&!this.config.disable_compression&&(this.compression=pr(e.supportedCompression,Gl.GZipJS)?Gl.GZipJS:pr(e.supportedCompression,Gl.Base64)?Gl.Base64:void 0),(t=e.analytics)!=null&&t.endpoint&&(this.analyticsDefaultEndpoint=e.analytics.endpoint),this.set_config({person_profiles:this.Vr?this.Vr:"identified_only"}),(n=this.siteApps)==null||n.onRemoteConfig(e),(s=this.sessionRecording)==null||s.onRemoteConfig(e),(i=this.autocapture)==null||i.onRemoteConfig(e),(c=this.heatmaps)==null||c.onRemoteConfig(e),this.surveys.onRemoteConfig(e),this.logs.onRemoteConfig(e),this.conversations.onRemoteConfig(e),(d=this.productTours)==null||d.onRemoteConfig(e),(m=this.webVitalsAutocapture)==null||m.onRemoteConfig(e),(p=this.exceptionObserver)==null||p.onRemoteConfig(e),this.exceptions.onRemoteConfig(e),(v=this.deadClicksAutocapture)==null||v.onRemoteConfig(e)}ns(){try{this.config.loaded(this)}catch(n){st.critical("`loaded` function failed",n)}if(this.us(),this.config.internal_or_test_user_hostname&&_s!=null&&_s.hostname){var e=_s.hostname,t=this.config.internal_or_test_user_hostname;(typeof t=="string"?e===t:t.test(e))&&this.setInternalOrTestUser()}this.config.capture_pageview&&setTimeout((()=>{(this.consent.isOptedIn()||this.config.cookieless_mode==="always")&&this.hs()}),1),new bH(this).load(),this.featureFlags.flags()}us(){var e;this.is_capturing()&&this.config.request_batching&&((e=this.Zr)==null||e.enable())}_dom_loaded(){this.is_capturing()&&Kc(this.__request_queue,(e=>this.ts(e))),this.__request_queue=[],this.us()}_handle_unload(){var e,t;this.surveys.handlePageUnload(),this.config.request_batching?(this.ds()&&this.capture("$pageleave"),(e=this.Zr)==null||e.unload(),(t=this.es)==null||t.unload()):this.ds()&&this.capture("$pageleave",null,{transport:"sendBeacon"})}_send_request(e){this.__loaded&&(VA?this.__request_queue.push(e):this.rateLimiter.isServerRateLimited(e.batchKey)||(e.transport=e.transport||this.config.api_transport,e.url=by(e.url,{ip:this.config.ip?1:0}),e.headers=it({},this.config.request_headers,e.headers),e.compression=e.compression==="best-available"?this.compression:e.compression,e.disableXHRCredentials=this.config.__preview_disable_xhr_credentials,this.config.__preview_disable_beacon&&(e.disableTransport=["sendBeacon"]),e.fetchOptions=e.fetchOptions||this.config.fetch_options,(t=>{var n,s,i,c=it({},t);c.timeout=c.timeout||6e4,c.url=by(c.url,{_:new Date().getTime().toString(),ver:Ul.LIB_VERSION,compression:c.compression});var d=(n=c.transport)!==null&&n!==void 0?n:"fetch",m=Yv.filter((v=>!c.disableTransport||!v.transport||!c.disableTransport.includes(v.transport))),p=(s=(i=lA(m,(v=>v.transport===d)))==null?void 0:i.method)!==null&&s!==void 0?s:m[0].method;if(!p)throw new Error("No available transport method");p(c)})(it({},e,{callback:t=>{var n,s;this.rateLimiter.checkForLimiting(t),t.statusCode>=400&&((n=(s=this.config).on_request_error)==null||n.call(s,t)),e.callback==null||e.callback(t)}}))))}ts(e){this.es?this.es.retriableRequest(e):this._send_request(e)}_execute_array(e){var t,n=[],s=[],i=[];Kc(e,(d=>{d&&(t=d[0],$r(t)?i.push(d):qc(d)?d.call(this):$r(d)&&t==="alias"?n.push(d):$r(d)&&t.indexOf("capture")!==-1&&qc(this[t])?i.push(d):s.push(d))}));var c=function(d,m){Kc(d,(function(p){if($r(p[0])){var v=m;en(p,(function(x){v=v[x[0]].apply(v,x.slice(1))}))}else this[p[0]].apply(this,p.slice(1))}),m)};c(n,this),c(s,this),c(i,this)}ss(){var e,t;return((e=this.config.bootstrap)==null?void 0:e.featureFlags)&&Object.keys((t=this.config.bootstrap)==null?void 0:t.featureFlags).length>0||!1}push(e){this._execute_array([e])}capture(e,t,n){var s;if(this.__loaded&&this.persistence&&this.sessionPersistence&&this.Zr){if(this.is_capturing())if(!et(e)&&Kn(e)){var i=!this.config.opt_out_useragent_filter&&this._is_bot();if(!(i&&!this.config.__preview_capture_bot_pageviews)){var c=n!=null&&n.skip_client_rate_limiting?void 0:this.rateLimiter.clientRateLimitContext();if(c==null||!c.isRateLimited){t!=null&&t.$current_url&&!Kn(t==null?void 0:t.$current_url)&&(st.error("Invalid `$current_url` property provided to `posthog.capture`. Input must be a string. Ignoring provided value."),t==null||delete t.$current_url),this.sessionPersistence.update_search_keyword(),this.config.save_campaign_params&&this.sessionPersistence.update_campaign_params(),this.config.save_referrer&&this.sessionPersistence.update_referrer_info(),(this.config.save_campaign_params||this.config.save_referrer)&&this.persistence.set_initial_person_info();var d=new Date,m=(n==null?void 0:n.timestamp)||d,p=Wc(),v={uuid:p,event:e,properties:this.calculateEventProperties(e,t||{},m,p)};e==="$pageview"&&this.config.__preview_capture_bot_pageviews&&i&&(v.event="$bot_pageview",v.properties.$browser_type="bot"),c&&(v.properties.$lib_rate_limit_remaining_tokens=c.remainingTokens),n!=null&&n.$set&&(v.$set=n==null?void 0:n.$set);var x,b=e!=="$groupidentify",S=this.vs(n==null?void 0:n.$set_once,b);if(S&&(v.$set_once=S),(v=az(v,n!=null&&n._noTruncate?null:this.config.properties_string_max_length)).timestamp=m,et(n==null?void 0:n.timestamp)||(v.properties.$event_time_override_provided=!0,v.properties.$event_time_override_system_time=d),e===xm.DISMISSED||e===xm.SENT){var N=t==null?void 0:t[Wx.SURVEY_ID],E=t==null?void 0:t[Wx.SURVEY_ITERATION];x={id:N,current_iteration:E},localStorage.getItem(pC(x))||localStorage.setItem(pC(x),"true"),v.$set=it({},v.$set,{[dH({id:N,current_iteration:E},e===xm.SENT?"responded":"dismissed")]:!0})}else e===xm.SHOWN&&(v.$set=it({},v.$set,{[Wx.SURVEY_LAST_SEEN_DATE]:new Date().toISOString()}));var T=it({},v.properties.$set,v.$set);if(Jf(T)||this.setPersonPropertiesForFlags(T),!mr(this.config.before_send)){var A=this.cs(v);if(!A)return;v=A}this.bi.emit("eventCaptured",v);var I={method:"POST",url:(s=n==null?void 0:n._url)!==null&&s!==void 0?s:this.requestRouter.endpointFor("api",this.analyticsDefaultEndpoint),data:v,compression:"best-available",batchKey:n==null?void 0:n._batchKey};return!this.config.request_batching||n&&(n==null||!n._batchKey)||n!=null&&n.send_instantly?this.ts(I):this.Zr.enqueue(I),v}st.critical("This capture call is ignored due to client rate limiting.")}}else st.error("No event name provided to posthog.capture")}else st.uninitializedWarning("posthog.capture")}_addCaptureHook(e){return this.on("eventCaptured",(t=>e(t.event,t)))}calculateEventProperties(e,t,n,s,i){if(n=n||new Date,!this.persistence||!this.sessionPersistence)return t;var c=i?void 0:this.persistence.remove_event_timer(e),d=it({},t);if(d.token=this.config.token,d.$config_defaults=this.config.defaults,(this.config.cookieless_mode=="always"||this.config.cookieless_mode=="on_reject"&&this.consent.isExplicitlyOptedOut())&&(d.$cookieless_mode=!0),e==="$snapshot"){var m=it({},this.persistence.properties(),this.sessionPersistence.properties());return d.distinct_id=m.distinct_id,(!Kn(d.distinct_id)&&!Kl(d.distinct_id)||$w(d.distinct_id))&&st.error("Invalid distinct_id for replay event. This indicates a bug in your implementation"),d}var p,v=Vz(this.config.mask_personal_data_properties,this.config.custom_personal_data_properties);if(this.sessionManager){var{sessionId:x,windowId:b}=this.sessionManager.checkAndGetSessionAndWindowId(i,n.getTime());d.$session_id=x,d.$window_id=b}this.sessionPropsManager&&Rn(d,this.sessionPropsManager.getSessionProps());try{var S;this.sessionRecording&&Rn(d,this.sessionRecording.sdkDebugProperties),d.$sdk_debug_retry_queue_size=(S=this.es)==null?void 0:S.length}catch(A){d.$sdk_debug_error_capturing_properties=String(A)}if(this.requestRouter.region===wm.CUSTOM&&(d.$lib_custom_api_host=this.config.api_host),p=e!=="$pageview"||i?e!=="$pageleave"||i?this.pageViewManager.doEvent():this.pageViewManager.doPageLeave(n):this.pageViewManager.doPageView(n,s),d=Rn(d,p),e==="$pageview"&&Ze&&(d.title=Ze.title),!et(c)){var N=n.getTime()-c;d.$duration=parseFloat((N/1e3).toFixed(3))}Ro&&this.config.opt_out_useragent_filter&&(d.$browser_type=this._is_bot()?"bot":"browser"),(d=Rn({},v,this.persistence.properties(),this.sessionPersistence.properties(),d)).$is_identified=this._isIdentified(),$r(this.config.property_denylist)?en(this.config.property_denylist,(function(A){delete d[A]})):st.error("Invalid value for property_denylist config: "+this.config.property_denylist+" or property_blacklist config: "+this.config.property_blacklist);var E=this.config.sanitize_properties;E&&(st.error("sanitize_properties is deprecated. Use before_send instead"),d=E(d,e));var T=this.fs();return d.$process_person_profile=T,T&&!i&&this.ps("_calculate_event_properties"),d}vs(e,t){var n;if(t===void 0&&(t=!0),!this.persistence||!this.fs()||this.qr)return e;var s=this.persistence.get_initial_props(),i=(n=this.sessionPropsManager)==null?void 0:n.getSetOnceProps(),c=Rn({},s,i||{},e||{}),d=this.config.sanitize_properties;return d&&(st.error("sanitize_properties is deprecated. Use before_send instead"),c=d(c,"$set_once")),t&&(this.qr=!0),Jf(c)?void 0:c}register(e,t){var n;(n=this.persistence)==null||n.register(e,t)}register_once(e,t,n){var s;(s=this.persistence)==null||s.register_once(e,t,n)}register_for_session(e){var t;(t=this.sessionPersistence)==null||t.register(e)}unregister(e){var t;(t=this.persistence)==null||t.unregister(e)}unregister_for_session(e){var t;(t=this.sessionPersistence)==null||t.unregister(e)}gs(e,t){this.register({[e]:t})}getFeatureFlag(e,t){return this.featureFlags.getFeatureFlag(e,t)}getFeatureFlagPayload(e){return this.featureFlags.getFeatureFlagPayload(e)}getFeatureFlagResult(e,t){return this.featureFlags.getFeatureFlagResult(e,t)}isFeatureEnabled(e,t){return this.featureFlags.isFeatureEnabled(e,t)}reloadFeatureFlags(){this.featureFlags.reloadFeatureFlags()}updateFlags(e,t,n){var s=n!=null&&n.merge?this.featureFlags.getFlagVariants():{},i=n!=null&&n.merge?this.featureFlags.getFlagPayloads():{},c=it({},s,e),d=it({},i,t),m={};for(var[p,v]of Object.entries(c)){var x=typeof v=="string";m[p]={key:p,enabled:!!x||!!v,variant:x?v:void 0,reason:void 0,metadata:et(d==null?void 0:d[p])?void 0:{id:0,version:void 0,description:void 0,payload:d[p]}}}this.featureFlags.receivedFeatureFlags({flags:m})}updateEarlyAccessFeatureEnrollment(e,t,n){this.featureFlags.updateEarlyAccessFeatureEnrollment(e,t,n)}getEarlyAccessFeatures(e,t,n){return t===void 0&&(t=!1),this.featureFlags.getEarlyAccessFeatures(e,t,n)}on(e,t){return this.bi.on(e,t)}onFeatureFlags(e){return this.featureFlags.onFeatureFlags(e)}onSurveysLoaded(e){return this.surveys.onSurveysLoaded(e)}onSessionId(e){var t,n;return(t=(n=this.sessionManager)==null?void 0:n.onSessionId(e))!==null&&t!==void 0?t:()=>{}}getSurveys(e,t){t===void 0&&(t=!1),this.surveys.getSurveys(e,t)}getActiveMatchingSurveys(e,t){t===void 0&&(t=!1),this.surveys.getActiveMatchingSurveys(e,t)}renderSurvey(e,t){this.surveys.renderSurvey(e,t)}displaySurvey(e,t){t===void 0&&(t=hH),this.surveys.displaySurvey(e,t)}cancelPendingSurvey(e){this.surveys.cancelPendingSurvey(e)}canRenderSurvey(e){return this.surveys.canRenderSurvey(e)}canRenderSurveyAsync(e,t){return t===void 0&&(t=!1),this.surveys.canRenderSurveyAsync(e,t)}identify(e,t,n){if(!this.__loaded||!this.persistence)return st.uninitializedWarning("posthog.identify");if(Kl(e)&&(e=e.toString(),st.warn("The first argument to posthog.identify was a number, but it should be a string. It has been converted to a string.")),e)if(["distinct_id","distinctid"].includes(e.toLowerCase()))st.critical('The string "'+e+'" was set in posthog.identify which indicates an error. This ID should be unique to the user and not a hardcoded string.');else if(e!==qp){if(this.ps("posthog.identify")){var s=this.get_distinct_id();if(this.register({$user_id:e}),!this.get_property("$device_id")){var i=s;this.register_once({$had_persisted_distinct_id:!0,$device_id:i},"")}e!==s&&e!==this.get_property(pm)&&(this.unregister(pm),this.register({distinct_id:e}));var c=(this.persistence.get_property(zl)||"anonymous")==="anonymous";e!==s&&c?(this.persistence.set_property(zl,"identified"),this.setPersonPropertiesForFlags(it({},n||{},t||{}),!1),this.capture("$identify",{distinct_id:e,$anon_distinct_id:s},{$set:t||{},$set_once:n||{}}),this.Jr=lC(e,t,n),this.featureFlags.setAnonymousDistinctId(s)):(t||n)&&this.setPersonProperties(t,n),e!==s&&(this.reloadFeatureFlags(),this.unregister(fy))}}else st.critical('The string "'+qp+'" was set in posthog.identify which indicates an error. This ID is only used as a sentinel value.');else st.error("Unique user id has not been set in posthog.identify")}setPersonProperties(e,t){if((e||t)&&this.ps("posthog.setPersonProperties")){var n=lC(this.get_distinct_id(),e,t);this.Jr!==n?(this.setPersonPropertiesForFlags(it({},t||{},e||{})),this.capture("$set",{$set:e||{},$set_once:t||{}}),this.Jr=n):st.info("A duplicate setPersonProperties call was made with the same properties. It has been ignored.")}}group(e,t,n){if(e&&t){var s=this.getGroups();s[e]!==t&&this.resetGroupPropertiesForFlags(e),this.register({$groups:it({},s,{[e]:t})}),n&&(this.capture("$groupidentify",{$group_type:e,$group_key:t,$group_set:n}),this.setGroupPropertiesForFlags({[e]:n})),s[e]===t||n||this.reloadFeatureFlags()}else st.error("posthog.group requires a group type and group key")}resetGroups(){this.register({$groups:{}}),this.resetGroupPropertiesForFlags(),this.reloadFeatureFlags()}setPersonPropertiesForFlags(e,t){t===void 0&&(t=!0),this.featureFlags.setPersonPropertiesForFlags(e,t)}resetPersonPropertiesForFlags(){this.featureFlags.resetPersonPropertiesForFlags()}setGroupPropertiesForFlags(e,t){t===void 0&&(t=!0),this.ps("posthog.setGroupPropertiesForFlags")&&this.featureFlags.setGroupPropertiesForFlags(e,t)}resetGroupPropertiesForFlags(e){this.featureFlags.resetGroupPropertiesForFlags(e)}reset(e){var t,n,s,i;if(st.info("reset"),!this.__loaded)return st.uninitializedWarning("posthog.reset");var c=this.get_property("$device_id");if(this.consent.reset(),(t=this.persistence)==null||t.clear(),(n=this.sessionPersistence)==null||n.clear(),this.surveys.reset(),this.featureFlags.reset(),(s=this.persistence)==null||s.set_property(zl,"anonymous"),(i=this.sessionManager)==null||i.resetSessionId(),this.Jr=null,this.config.cookieless_mode==="always")this.register_once({distinct_id:qp,$device_id:null},"");else{var d=this.config.get_device_id(Wc());this.register_once({distinct_id:d,$device_id:e?d:c},"")}this.register({$last_posthog_reset:new Date().toISOString()},1)}get_distinct_id(){return this.get_property("distinct_id")}getGroups(){return this.get_property("$groups")||{}}get_session_id(){var e,t;return(e=(t=this.sessionManager)==null?void 0:t.checkAndGetSessionAndWindowId(!0).sessionId)!==null&&e!==void 0?e:""}get_session_replay_url(e){if(!this.sessionManager)return"";var{sessionId:t,sessionStartTimestamp:n}=this.sessionManager.checkAndGetSessionAndWindowId(!0),s=this.requestRouter.endpointFor("ui","/project/"+this.config.token+"/replay/"+t);if(e!=null&&e.withTimestamp&&n){var i,c=(i=e.timestampLookBack)!==null&&i!==void 0?i:10;if(!n)return s;s+="?t="+Math.max(Math.floor((new Date().getTime()-n)/1e3)-c,0)}return s}alias(e,t){return e===this.get_property(cA)?(st.critical("Attempting to create alias for existing People user - aborting."),-2):this.ps("posthog.alias")?(et(t)&&(t=this.get_distinct_id()),e!==t?(this.gs(pm,e),this.capture("$create_alias",{alias:e,distinct_id:t})):(st.warn("alias matches current distinct_id - skipping api call."),this.identify(e),-1)):void 0}set_config(e){var t=it({},this.config);if(qn(e)){var n,s,i,c,d,m,p;Rn(this.config,bC(e));var v=this.Qr();(n=this.persistence)==null||n.update_config(this.config,t,v),this.sessionPersistence=this.config.persistence==="sessionStorage"||this.config.persistence==="memory"?this.persistence:new Hx(it({},this.config,{persistence:"sessionStorage"}),v);var x=this.Kr(this.config.debug);Vl(x)&&(this.config.debug=x),Vl(this.config.debug)&&(this.config.debug?(Ul.DEBUG=!0,hn.H()&&hn.G("ph_debug","true"),st.info("set_config",{config:e,oldConfig:t,newConfig:it({},this.config)})):(Ul.DEBUG=!1,hn.H()&&hn.V("ph_debug"))),(s=this.exceptionObserver)==null||s.onConfigChange(),(i=this.sessionRecording)==null||i.startIfEnabledOrStop(),(c=this.autocapture)==null||c.startIfEnabled(),(d=this.heatmaps)==null||d.startIfEnabled(),(m=this.exceptionObserver)==null||m.startIfEnabledOrStop(),this.surveys.loadIfEnabled(),this._s(),(p=this.externalIntegrations)==null||p.startIfEnabledOrStop()}}startSessionRecording(e){var t=e===!0,n={sampling:t||!(e==null||!e.sampling),linked_flag:t||!(e==null||!e.linked_flag),url_trigger:t||!(e==null||!e.url_trigger),event_trigger:t||!(e==null||!e.event_trigger)};if(Object.values(n).some(Boolean)){var s,i,c,d,m;(s=this.sessionManager)==null||s.checkAndGetSessionAndWindowId(),n.sampling&&((i=this.sessionRecording)==null||i.overrideSampling()),n.linked_flag&&((c=this.sessionRecording)==null||c.overrideLinkedFlag()),n.url_trigger&&((d=this.sessionRecording)==null||d.overrideTrigger("url")),n.event_trigger&&((m=this.sessionRecording)==null||m.overrideTrigger("event"))}this.set_config({disable_session_recording:!1})}stopSessionRecording(){this.set_config({disable_session_recording:!0})}sessionRecordingStarted(){var e;return!((e=this.sessionRecording)==null||!e.started)}captureException(e,t){var n=new Error("PostHog syntheticException"),s=this.exceptions.buildProperties(e,{handled:!0,syntheticException:n});return this.exceptions.sendExceptionEvent(it({},s,t))}startExceptionAutocapture(e){this.set_config({capture_exceptions:e==null||e})}stopExceptionAutocapture(){this.set_config({capture_exceptions:!1})}loadToolbar(e){return this.toolbar.loadToolbar(e)}get_property(e){var t;return(t=this.persistence)==null?void 0:t.props[e]}getSessionProperty(e){var t;return(t=this.sessionPersistence)==null?void 0:t.props[e]}toString(){var e,t=(e=this.config.name)!==null&&e!==void 0?e:qf;return t!==qf&&(t=qf+"."+t),t}_isIdentified(){var e,t;return((e=this.persistence)==null?void 0:e.get_property(zl))==="identified"||((t=this.sessionPersistence)==null?void 0:t.get_property(zl))==="identified"}fs(){var e,t;return!(this.config.person_profiles==="never"||this.config.person_profiles==="identified_only"&&!this._isIdentified()&&Jf(this.getGroups())&&((e=this.persistence)==null||(e=e.props)==null||!e[pm])&&((t=this.persistence)==null||(t=t.props)==null||!t[py]))}ds(){return this.config.capture_pageleave===!0||this.config.capture_pageleave==="if_capture_pageview"&&(this.config.capture_pageview===!0||this.config.capture_pageview==="history_change")}createPersonProfile(){this.fs()||this.ps("posthog.createPersonProfile")&&this.setPersonProperties({},{})}setInternalOrTestUser(){this.ps("posthog.setInternalOrTestUser")&&this.setPersonProperties({$internal_or_test_user:!0})}ps(e){return this.config.person_profiles==="never"?(st.error(e+' was called, but process_person is set to "never". This call will be ignored.'),!1):(this.gs(py,!0),!0)}Qr(){if(this.config.cookieless_mode==="always")return!0;var e=this.consent.isOptedOut(),t=this.config.opt_out_persistence_by_default||this.config.cookieless_mode==="on_reject";return this.config.disable_persistence||e&&!!t}_s(){var e,t,n,s,i=this.Qr();return((e=this.persistence)==null?void 0:e.Pi)!==i&&((n=this.persistence)==null||n.set_disabled(i)),((t=this.sessionPersistence)==null?void 0:t.Pi)!==i&&((s=this.sessionPersistence)==null||s.set_disabled(i)),i}opt_in_capturing(e){var t;if(this.config.cookieless_mode!=="always"){var n,s,i;this.config.cookieless_mode==="on_reject"&&this.consent.isExplicitlyOptedOut()&&(this.reset(!0),(n=this.sessionManager)==null||n.destroy(),(s=this.pageViewManager)==null||s.destroy(),this.sessionManager=new vC(this),this.pageViewManager=new rC(this),this.persistence&&(this.sessionPropsManager=new gC(this,this.sessionManager,this.persistence)),this.sessionRecording=new xC(this),this.sessionRecording.startIfEnabledOrStop()),this.consent.optInOut(!0),this._s(),this.us(),(t=this.sessionRecording)==null||t.startIfEnabledOrStop(),this.config.cookieless_mode=="on_reject"&&this.surveys.loadIfEnabled(),(et(e==null?void 0:e.captureEventName)||e!=null&&e.captureEventName)&&this.capture((i=e==null?void 0:e.captureEventName)!==null&&i!==void 0?i:"$opt_in",e==null?void 0:e.captureProperties,{send_instantly:!0}),this.config.capture_pageview&&this.hs()}else st.warn('Consent opt in/out is not valid with cookieless_mode="always" and will be ignored')}opt_out_capturing(){var e,t,n;this.config.cookieless_mode!=="always"?(this.config.cookieless_mode==="on_reject"&&this.consent.isOptedIn()&&this.reset(!0),this.consent.optInOut(!1),this._s(),this.config.cookieless_mode==="on_reject"&&(this.register({distinct_id:qp,$device_id:null}),(e=this.sessionManager)==null||e.destroy(),(t=this.pageViewManager)==null||t.destroy(),this.sessionManager=void 0,this.sessionPropsManager=void 0,(n=this.sessionRecording)==null||n.stopRecording(),this.sessionRecording=void 0,this.hs())):st.warn('Consent opt in/out is not valid with cookieless_mode="always" and will be ignored')}has_opted_in_capturing(){return this.consent.isOptedIn()}has_opted_out_capturing(){return this.consent.isOptedOut()}get_explicit_consent_status(){var e=this.consent.consent;return e===Hl.GRANTED?"granted":e===Hl.DENIED?"denied":"pending"}is_capturing(){return this.config.cookieless_mode==="always"||(this.config.cookieless_mode==="on_reject"?this.consent.isExplicitlyOptedOut()||this.consent.isOptedIn():!this.has_opted_out_capturing())}clear_opt_in_out_capturing(){this.consent.reset(),this._s()}_is_bot(){return ni?WA(ni,this.config.custom_blocked_useragents):void 0}hs(){Ze&&(Ze.visibilityState==="visible"?this.Wr||(this.Wr=!0,this.capture("$pageview",{title:Ze.title},{send_instantly:!0}),this.Gr&&(Ze.removeEventListener("visibilitychange",this.Gr),this.Gr=null)):this.Gr||(this.Gr=this.hs.bind(this),Mn(Ze,"visibilitychange",this.Gr)))}debug(e){e===!1?(_e==null||_e.console.log("You've disabled debug mode."),this.set_config({debug:!1})):(_e==null||_e.console.log("You're now in debug mode. All calls to PostHog will be logged in your console.\nYou can disable this with `posthog.debug(false)`."),this.set_config({debug:!0}))}M(){var e,t,n,s,i,c,d,m=this.Yr||{};return"advanced_disable_flags"in m?!!m.advanced_disable_flags:this.config.advanced_disable_flags!==!1?!!this.config.advanced_disable_flags:this.config.advanced_disable_decide===!0?(st.warn("Config field 'advanced_disable_decide' is deprecated. Please use 'advanced_disable_flags' instead. The old field will be removed in a future major version."),!0):(n="advanced_disable_decide",s=!1,i=st,c=(t="advanced_disable_flags")in(e=m)&&!mr(e[t]),d=n in e&&!mr(e[n]),c?e[t]:d?(i&&i.warn("Config field '"+n+"' is deprecated. Please use '"+t+"' instead. The old field will be removed in a future major version."),e[n]):s)}cs(e){if(mr(this.config.before_send))return e;var t=$r(this.config.before_send)?this.config.before_send:[this.config.before_send],n=e;for(var s of t){if(n=s(n),mr(n)){var i="Event '"+e.event+"' was rejected in beforeSend function";return E8(e.event)?st.warn(i+". This can cause unexpected behavior."):st.info(i),null}n.properties&&!Jf(n.properties)||st.warn("Event '"+e.event+"' has no properties after beforeSend function, this is likely an error.")}return n}getPageViewId(){var e;return(e=this.pageViewManager.Kt)==null?void 0:e.pageViewId}captureTraceFeedback(e,t){this.capture("$ai_feedback",{$ai_trace_id:String(e),$ai_feedback_text:t})}captureTraceMetric(e,t,n){this.capture("$ai_metric",{$ai_trace_id:String(e),$ai_metric_name:t,$ai_metric_value:String(n)})}Kr(e){var t=Vl(e)&&!e,n=hn.H()&&hn.q("ph_debug")==="true";return!t&&(!!n||e)}}(function(r,e){for(var t=0;t<e.length;t++)r.prototype[e[t]]=iz(r.prototype[e[t]])})(qy,["identify"]);var _C,Ga=(_C=Nm[qf]=new qy,(function(){function r(){r.done||(r.done=!0,VA=!1,en(Nm,(function(e){e._dom_loaded()})))}Ze!=null&&Ze.addEventListener?Ze.readyState==="complete"?r():Mn(Ze,"DOMContentLoaded",r,{capture:!1}):_e&&st.error("Browser doesn't support `document.addEventListener` so PostHog couldn't be initialized")})(),_C),qA=w.createContext({client:Ga,bootstrap:void 0});function KA(r,e,t){if(t===void 0&&(t=new WeakMap),r===e)return!0;if(typeof r!="object"||r===null||typeof e!="object"||e===null)return!1;if(t.has(r)&&t.get(r)===e)return!0;t.set(r,e);var n=Object.keys(r),s=Object.keys(e);if(n.length!==s.length)return!1;for(var i=0,c=n;i<c.length;i++){var d=c[i];if(!s.includes(d)||!KA(r[d],e[d],t))return!1}return!0}function OH(r){var e,t,n=r.children,s=r.client,i=r.apiKey,c=r.options,d=w.useRef(null),m=w.useMemo(function(){return s?(i&&console.warn("[PostHog.js] You have provided both `client` and `apiKey` to `PostHogProvider`. `apiKey` will be ignored in favour of `client`."),c&&console.warn("[PostHog.js] You have provided both `client` and `options` to `PostHogProvider`. `options` will be ignored in favour of `client`."),s):(i||console.warn("[PostHog.js] No `apiKey` or `client` were provided to `PostHogProvider`. Using default global `window.posthog` instance. You must initialize it manually. This is not recommended behavior."),Ga)},[s,i,JSON.stringify(c)]);return w.useEffect(function(){if(!s){var p=d.current;p?(i!==p.apiKey&&console.warn("[PostHog.js] You have provided a different `apiKey` to `PostHogProvider` than the one that was already initialized. This is not supported by our provider and we'll keep using the previous key. If you need to toggle between API Keys you need to control the `client` yourself and pass it in as a prop rather than an `apiKey` prop."),c&&!KA(c,p.options)&&Ga.set_config(c),d.current={apiKey:i,options:c??{}}):(Ga.__loaded&&console.warn("[PostHog.js] `posthog` was already loaded elsewhere. This may cause issues."),Ga.init(i,c),d.current={apiKey:i,options:c??{}})}},[s,i,JSON.stringify(c)]),br.createElement(qA.Provider,{value:{client:m,bootstrap:(e=c==null?void 0:c.bootstrap)!==null&&e!==void 0?e:(t=s==null?void 0:s.config)===null||t===void 0?void 0:t.bootstrap}},n)}var qx=function(r){return typeof r=="function"},ab=function(r,e){return ab=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])},ab(r,e)};function DH(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");ab(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var LH={componentStack:null,exceptionEvent:null,error:null},MH={INVALID_FALLBACK:"[PostHog.js][PostHogErrorBoundary] Invalid fallback prop, provide a valid React element or a function that returns a valid React element."};(function(r){DH(e,r);function e(t){var n=r.call(this,t)||this;return n.state=LH,n}return e.prototype.componentDidCatch=function(t,n){var s=this.props.additionalProperties,i;qx(s)?i=s(t):typeof s=="object"&&(i=s);var c=this.context.client,d=c.captureException(t,i),m=n.componentStack;this.setState({error:t,componentStack:m??null,exceptionEvent:d})},e.prototype.render=function(){var t=this.props,n=t.children,s=t.fallback,i=this.state;if(i.componentStack==null)return qx(n)?n():n;var c=qx(s)?br.createElement(s,{error:i.error,componentStack:i.componentStack,exceptionEvent:i.exceptionEvent}):s;return br.isValidElement(c)?c:(console.warn(MH.INVALID_FALLBACK),br.createElement(br.Fragment,null))},e.contextType=qA,e})(br.Component);function Jr(){var e;const r=w.useContext(B_);if(r.isLoading)return{debug:async()=>{},info:async()=>{},warn:async()=>{},error:async()=>{}};if(!((e=r.services)!=null&&e.logging))throw new Error("Logging provider not available. Make sure PlatformProvider is wrapping your component.");return r.services.logging}function SC(r){try{const e=r.split(".")[1];return JSON.parse(atob(e.replace(/-/g,"+").replace(/_/g,"/"))).email??null}catch{return null}}const $H=({children:r})=>{const e=Xa(),t=Jr();return w.useEffect(()=>{if(typeof window>"u"||!Tw){console.warn(" PostHog: Not initialized - missing or invalid key");return}(async()=>{const s=await Mm(t),i=s!=null&&s.id_token?SC(s.id_token):null;Ga.init(Tw,{api_host:J1,autocapture:!0,capture_pageview:!0,capture_pageleave:!0,capture_dead_clicks:!1,disable_session_recording:!0,loaded:c=>{i&&c.identify(i,{email:i}),console.log("PostHog: Initialized successfully")},debug:H1==="dev"})})()},[]),w.useEffect(()=>{var s;const n=i=>{"token"in i&&(i.token.newValue?Mm(t).then(c=>{const d=c!=null&&c.id_token?SC(c.id_token):null;d&&Ga.identify(d,{email:d})}):Ga.reset())};return(s=e==null?void 0:e.onChanged)==null||s.call(e,n),()=>{var i;(i=e==null?void 0:e.removeChangeListener)==null||i.call(e,n)}},[e,t]),u.jsx(OH,{client:Ga,children:r})},pn=w.forwardRef(({className:r,type:e,...t},n)=>u.jsx("input",{type:e,className:Fr("flex h-10 w-full rounded-md border border-neutral-200 bg-white px-3 py-2 text-base text-neutral-950 ring-offset-white file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-neutral-950 placeholder:text-neutral-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm dark:border-border dark:bg-card dark:text-gray-100 dark:ring-offset-neutral-950 dark:file:text-neutral-50 dark:placeholder:text-neutral-400 dark:focus-visible:ring-primary",r),ref:n,...t}));pn.displayName="Input";const EC=r=>typeof r=="boolean"?`${r}`:r===0?"0":r,kC=bT,sS=(r,e)=>t=>{var n;if((e==null?void 0:e.variants)==null)return kC(r,t==null?void 0:t.class,t==null?void 0:t.className);const{variants:s,defaultVariants:i}=e,c=Object.keys(s).map(p=>{const v=t==null?void 0:t[p],x=i==null?void 0:i[p];if(v===null)return null;const b=EC(v)||EC(x);return s[p][b]}),d=t&&Object.entries(t).reduce((p,v)=>{let[x,b]=v;return b===void 0||(p[x]=b),p},{}),m=e==null||(n=e.compoundVariants)===null||n===void 0?void 0:n.reduce((p,v)=>{let{class:x,className:b,...S}=v;return Object.entries(S).every(N=>{let[E,T]=N;return Array.isArray(T)?T.includes({...i,...d}[E]):{...i,...d}[E]===T})?[...p,x,b]:p},[]);return kC(r,c,m,t==null?void 0:t.class,t==null?void 0:t.className)},UH=sS("rounded-lg border border-neutral-200 bg-white text-neutral-950 shadow-sm dark:border-border dark:bg-card dark:text-card-foreground",{variants:{variant:{default:"",TemplateCard:"",ReferenceSourcesCard:"",IntegrationsCard:""}},defaultVariants:{variant:"default"}}),Es=w.forwardRef(({className:r,variant:e,...t},n)=>u.jsx("div",{ref:n,className:Fr(UH({variant:e,className:r})),...t}));Es.displayName="Card";const lo=w.forwardRef(({className:r,cardVariant:e,...t},n)=>u.jsx("div",{ref:n,className:Fr(e==="TemplateCard"?"flex flex-col space-y-1 p-4":"flex flex-col space-y-1.5 p-6",r),...t}));lo.displayName="CardHeader";const co=w.forwardRef(({className:r,...e},t)=>u.jsx("h3",{ref:t,className:Fr("font-semibold leading-none tracking-tight",r),...e}));co.displayName="CardTitle";const zH=w.forwardRef(({className:r,...e},t)=>u.jsx("p",{ref:t,className:Fr("text-sm text-neutral-500 dark:text-neutral-400",r),...e}));zH.displayName="CardDescription";const ks=w.forwardRef(({className:r,cardVariant:e,...t},n)=>u.jsx("div",{ref:n,className:Fr(e==="TemplateCard"?"p-0 pt-0":"p-6 pt-0",r),...t}));ks.displayName="CardContent";const HH=w.forwardRef(({className:r,...e},t)=>u.jsx("div",{ref:t,className:Fr("flex items-center p-6 pt-0",r),...e}));HH.displayName="CardFooter";function CC(r,e){if(typeof r=="function")return r(e);r!=null&&(r.current=e)}function nu(...r){return e=>{let t=!1;const n=r.map(s=>{const i=CC(s,e);return!t&&typeof i=="function"&&(t=!0),i});if(t)return()=>{for(let s=0;s<n.length;s++){const i=n[s];typeof i=="function"?i():CC(r[s],null)}}}}function $n(...r){return w.useCallback(nu(...r),r)}var BH=Symbol.for("react.lazy"),Sy=Sb[" use ".trim().toString()];function GH(r){return typeof r=="object"&&r!==null&&"then"in r}function YA(r){return r!=null&&typeof r=="object"&&"$$typeof"in r&&r.$$typeof===BH&&"_payload"in r&&GH(r._payload)}function WH(r){const e=qH(r),t=w.forwardRef((n,s)=>{let{children:i,...c}=n;YA(i)&&typeof Sy=="function"&&(i=Sy(i._payload));const d=w.Children.toArray(i),m=d.find(YH);if(m){const p=m.props.children,v=d.map(x=>x===m?w.Children.count(p)>1?w.Children.only(null):w.isValidElement(p)?p.props.children:null:x);return u.jsx(e,{...c,ref:s,children:w.isValidElement(p)?w.cloneElement(p,void 0,v):null})}return u.jsx(e,{...c,ref:s,children:i})});return t.displayName=`${r}.Slot`,t}var VH=WH("Slot");function qH(r){const e=w.forwardRef((t,n)=>{let{children:s,...i}=t;if(YA(s)&&typeof Sy=="function"&&(s=Sy(s._payload)),w.isValidElement(s)){const c=XH(s),d=JH(i,s.props);return s.type!==w.Fragment&&(d.ref=n?nu(n,c):c),w.cloneElement(s,d)}return w.Children.count(s)>1?w.Children.only(null):null});return e.displayName=`${r}.SlotClone`,e}var KH=Symbol("radix.slottable");function YH(r){return w.isValidElement(r)&&typeof r.type=="function"&&"__radixId"in r.type&&r.type.__radixId===KH}function JH(r,e){const t={...e};for(const n in e){const s=r[n],i=e[n];/^on[A-Z]/.test(n)?s&&i?t[n]=(...d)=>{const m=i(...d);return s(...d),m}:s&&(t[n]=s):n==="style"?t[n]={...s,...i}:n==="className"&&(t[n]=[s,i].filter(Boolean).join(" "))}return{...r,...t}}function XH(r){var n,s;let e=(n=Object.getOwnPropertyDescriptor(r.props,"ref"))==null?void 0:n.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=(s=Object.getOwnPropertyDescriptor(r,"ref"))==null?void 0:s.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}const QH=sS("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-white transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 dark:ring-offset-neutral-950 dark:focus-visible:ring-primary",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90 dark:bg-primary dark:text-primary-foreground dark:hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90 dark:bg-destructive dark:text-destructive-foreground dark:hover:bg-destructive/90",outline:"border border-neutral-200 bg-background hover:bg-accent hover:text-accent-foreground dark:border-neutral-800 dark:bg-background dark:hover:bg-accent dark:hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80 dark:bg-secondary dark:text-secondary-foreground dark:hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent dark:hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline dark:text-primary"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),Ye=w.forwardRef(({className:r,variant:e,size:t,asChild:n=!1,...s},i)=>{const c=n?VH:"button";return u.jsx(c,{className:Fr(QH({variant:e,size:t,className:r})),ref:i,...s})});Ye.displayName="Button";/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZH=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),JA=(...r)=>r.filter((e,t,n)=>!!e&&n.indexOf(e)===t).join(" ");/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var eB={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tB=w.forwardRef(({color:r="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:n,className:s="",children:i,iconNode:c,...d},m)=>w.createElement("svg",{ref:m,...eB,width:e,height:e,stroke:r,strokeWidth:n?Number(t)*24/Number(e):t,className:JA("lucide",s),...d},[...c.map(([p,v])=>w.createElement(p,v)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ir=(r,e)=>{const t=w.forwardRef(({className:n,...s},i)=>w.createElement(tB,{ref:i,iconNode:e,className:JA(`lucide-${ZH(r)}`,n),...s}));return t.displayName=`${r}`,t};/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XA=ir("ArrowDownToLine",[["path",{d:"M12 17V3",key:"1cwfxf"}],["path",{d:"m6 11 6 6 6-6",key:"12ii2o"}],["path",{d:"M19 21H5",key:"150jfl"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tm=ir("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rB=ir("ArrowRightToLine",[["path",{d:"M17 12H3",key:"8awo09"}],["path",{d:"m11 18 6-6-6-6",key:"8c2y43"}],["path",{d:"M21 5v14",key:"nzette"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nB=ir("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QA=ir("Briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kx=ir("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bl=ir("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sB=ir("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ls=ir("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sh=ir("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pv=ir("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oh=ir("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jc=ir("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oB=ir("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qf=ir("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iB=ir("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aB=ir("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wa=ir("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lB=ir("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cB=ir("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xc=ir("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uB=ir("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yx=ir("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dB=ir("Folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fB=ir("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZA=ir("ListTodo",[["rect",{x:"3",y:"5",width:"6",height:"6",rx:"1",key:"1defrl"}],["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ia=ir("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eu=ir("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hB=ir("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NC=ir("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pB=ir("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mB=ir("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gB=ir("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TC=ir("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vB=ir("Presentation",[["path",{d:"M2 3h20",key:"91anmk"}],["path",{d:"M21 3v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V3",key:"2k9sn8"}],["path",{d:"m7 21 5-5 5 5",key:"bip4we"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const si=ir("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ii=ir("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ih=ir("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ey=ir("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eI=ir("WifiOff",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aa=ir("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function $t(r,e,{checkForDefaultPrevented:t=!0}={}){return function(s){if(r==null||r(s),t===!1||!s.defaultPrevented)return e==null?void 0:e(s)}}function yB(r,e){const t=w.createContext(e),n=i=>{const{children:c,...d}=i,m=w.useMemo(()=>d,Object.values(d));return u.jsx(t.Provider,{value:m,children:c})};n.displayName=r+"Provider";function s(i){const c=w.useContext(t);if(c)return c;if(e!==void 0)return e;throw new Error(`\`${i}\` must be used within \`${r}\``)}return[n,s]}function Za(r,e=[]){let t=[];function n(i,c){const d=w.createContext(c),m=t.length;t=[...t,c];const p=x=>{var A;const{scope:b,children:S,...N}=x,E=((A=b==null?void 0:b[r])==null?void 0:A[m])||d,T=w.useMemo(()=>N,Object.values(N));return u.jsx(E.Provider,{value:T,children:S})};p.displayName=i+"Provider";function v(x,b){var E;const S=((E=b==null?void 0:b[r])==null?void 0:E[m])||d,N=w.useContext(S);if(N)return N;if(c!==void 0)return c;throw new Error(`\`${x}\` must be used within \`${i}\``)}return[p,v]}const s=()=>{const i=t.map(c=>w.createContext(c));return function(d){const m=(d==null?void 0:d[r])||i;return w.useMemo(()=>({[`__scope${r}`]:{...d,[r]:m}}),[d,m])}};return s.scopeName=r,[n,xB(s,...e)]}function xB(...r){const e=r[0];if(r.length===1)return e;const t=()=>{const n=r.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const c=n.reduce((d,{useScope:m,scopeName:p})=>{const x=m(i)[`__scope${p}`];return{...d,...x}},{});return w.useMemo(()=>({[`__scope${e.scopeName}`]:c}),[c])}};return t.scopeName=e.scopeName,t}var Yl=globalThis!=null&&globalThis.document?w.useLayoutEffect:()=>{},wB=Sb[" useInsertionEffect ".trim().toString()]||Yl;function su({prop:r,defaultProp:e,onChange:t=()=>{},caller:n}){const[s,i,c]=bB({defaultProp:e,onChange:t}),d=r!==void 0,m=d?r:s;{const v=w.useRef(r!==void 0);w.useEffect(()=>{const x=v.current;x!==d&&console.warn(`${n} is changing from ${x?"controlled":"uncontrolled"} to ${d?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),v.current=d},[d,n])}const p=w.useCallback(v=>{var x;if(d){const b=_B(v)?v(r):v;b!==r&&((x=c.current)==null||x.call(c,b))}else i(v)},[d,r,i,c]);return[m,p]}function bB({defaultProp:r,onChange:e}){const[t,n]=w.useState(r),s=w.useRef(t),i=w.useRef(e);return wB(()=>{i.current=e},[e]),w.useEffect(()=>{var c;s.current!==t&&((c=i.current)==null||c.call(i,t),s.current=t)},[t,s]),[t,n,i]}function _B(r){return typeof r=="function"}const SB=["top","right","bottom","left"],tu=Math.min,ei=Math.max,ky=Math.round,jv=Math.floor,Ya=r=>({x:r,y:r}),EB={left:"right",right:"left",bottom:"top",top:"bottom"},kB={start:"end",end:"start"};function lb(r,e,t){return ei(r,tu(e,t))}function Jl(r,e){return typeof r=="function"?r(e):r}function Xl(r){return r.split("-")[0]}function Sh(r){return r.split("-")[1]}function oS(r){return r==="x"?"y":"x"}function iS(r){return r==="y"?"height":"width"}const CB=new Set(["top","bottom"]);function Ka(r){return CB.has(Xl(r))?"y":"x"}function aS(r){return oS(Ka(r))}function NB(r,e,t){t===void 0&&(t=!1);const n=Sh(r),s=aS(r),i=iS(s);let c=s==="x"?n===(t?"end":"start")?"right":"left":n==="start"?"bottom":"top";return e.reference[i]>e.floating[i]&&(c=Cy(c)),[c,Cy(c)]}function TB(r){const e=Cy(r);return[cb(r),e,cb(e)]}function cb(r){return r.replace(/start|end/g,e=>kB[e])}const AC=["left","right"],IC=["right","left"],AB=["top","bottom"],IB=["bottom","top"];function RB(r,e,t){switch(r){case"top":case"bottom":return t?e?IC:AC:e?AC:IC;case"left":case"right":return e?AB:IB;default:return[]}}function PB(r,e,t,n){const s=Sh(r);let i=RB(Xl(r),t==="start",n);return s&&(i=i.map(c=>c+"-"+s),e&&(i=i.concat(i.map(cb)))),i}function Cy(r){return r.replace(/left|right|bottom|top/g,e=>EB[e])}function jB(r){return{top:0,right:0,bottom:0,left:0,...r}}function tI(r){return typeof r!="number"?jB(r):{top:r,right:r,bottom:r,left:r}}function Ny(r){const{x:e,y:t,width:n,height:s}=r;return{width:n,height:s,top:t,left:e,right:e+n,bottom:t+s,x:e,y:t}}function RC(r,e,t){let{reference:n,floating:s}=r;const i=Ka(e),c=aS(e),d=iS(c),m=Xl(e),p=i==="y",v=n.x+n.width/2-s.width/2,x=n.y+n.height/2-s.height/2,b=n[d]/2-s[d]/2;let S;switch(m){case"top":S={x:v,y:n.y-s.height};break;case"bottom":S={x:v,y:n.y+n.height};break;case"right":S={x:n.x+n.width,y:x};break;case"left":S={x:n.x-s.width,y:x};break;default:S={x:n.x,y:n.y}}switch(Sh(e)){case"start":S[c]-=b*(t&&p?-1:1);break;case"end":S[c]+=b*(t&&p?-1:1);break}return S}async function FB(r,e){var t;e===void 0&&(e={});const{x:n,y:s,platform:i,rects:c,elements:d,strategy:m}=r,{boundary:p="clippingAncestors",rootBoundary:v="viewport",elementContext:x="floating",altBoundary:b=!1,padding:S=0}=Jl(e,r),N=tI(S),T=d[b?x==="floating"?"reference":"floating":x],A=Ny(await i.getClippingRect({element:(t=await(i.isElement==null?void 0:i.isElement(T)))==null||t?T:T.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(d.floating)),boundary:p,rootBoundary:v,strategy:m})),I=x==="floating"?{x:n,y:s,width:c.floating.width,height:c.floating.height}:c.reference,D=await(i.getOffsetParent==null?void 0:i.getOffsetParent(d.floating)),j=await(i.isElement==null?void 0:i.isElement(D))?await(i.getScale==null?void 0:i.getScale(D))||{x:1,y:1}:{x:1,y:1},O=Ny(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:d,rect:I,offsetParent:D,strategy:m}):I);return{top:(A.top-O.top+N.top)/j.y,bottom:(O.bottom-A.bottom+N.bottom)/j.y,left:(A.left-O.left+N.left)/j.x,right:(O.right-A.right+N.right)/j.x}}const OB=async(r,e,t)=>{const{placement:n="bottom",strategy:s="absolute",middleware:i=[],platform:c}=t,d=i.filter(Boolean),m=await(c.isRTL==null?void 0:c.isRTL(e));let p=await c.getElementRects({reference:r,floating:e,strategy:s}),{x:v,y:x}=RC(p,n,m),b=n,S={},N=0;for(let T=0;T<d.length;T++){var E;const{name:A,fn:I}=d[T],{x:D,y:j,data:O,reset:B}=await I({x:v,y:x,initialPlacement:n,placement:b,strategy:s,middlewareData:S,rects:p,platform:{...c,detectOverflow:(E=c.detectOverflow)!=null?E:FB},elements:{reference:r,floating:e}});v=D??v,x=j??x,S={...S,[A]:{...S[A],...O}},B&&N<=50&&(N++,typeof B=="object"&&(B.placement&&(b=B.placement),B.rects&&(p=B.rects===!0?await c.getElementRects({reference:r,floating:e,strategy:s}):B.rects),{x:v,y:x}=RC(p,b,m)),T=-1)}return{x:v,y:x,placement:b,strategy:s,middlewareData:S}},DB=r=>({name:"arrow",options:r,async fn(e){const{x:t,y:n,placement:s,rects:i,platform:c,elements:d,middlewareData:m}=e,{element:p,padding:v=0}=Jl(r,e)||{};if(p==null)return{};const x=tI(v),b={x:t,y:n},S=aS(s),N=iS(S),E=await c.getDimensions(p),T=S==="y",A=T?"top":"left",I=T?"bottom":"right",D=T?"clientHeight":"clientWidth",j=i.reference[N]+i.reference[S]-b[S]-i.floating[N],O=b[S]-i.reference[S],B=await(c.getOffsetParent==null?void 0:c.getOffsetParent(p));let G=B?B[D]:0;(!G||!await(c.isElement==null?void 0:c.isElement(B)))&&(G=d.floating[D]||i.floating[N]);const K=j/2-O/2,re=G/2-E[N]/2-1,se=tu(x[A],re),he=tu(x[I],re),U=se,ge=G-E[N]-he,ie=G/2-E[N]/2+K,ae=lb(U,ie,ge),de=!m.arrow&&Sh(s)!=null&&ie!==ae&&i.reference[N]/2-(ie<U?se:he)-E[N]/2<0,J=de?ie<U?ie-U:ie-ge:0;return{[S]:b[S]+J,data:{[S]:ae,centerOffset:ie-ae-J,...de&&{alignmentOffset:J}},reset:de}}}),LB=function(r){return r===void 0&&(r={}),{name:"flip",options:r,async fn(e){var t,n;const{placement:s,middlewareData:i,rects:c,initialPlacement:d,platform:m,elements:p}=e,{mainAxis:v=!0,crossAxis:x=!0,fallbackPlacements:b,fallbackStrategy:S="bestFit",fallbackAxisSideDirection:N="none",flipAlignment:E=!0,...T}=Jl(r,e);if((t=i.arrow)!=null&&t.alignmentOffset)return{};const A=Xl(s),I=Ka(d),D=Xl(d)===d,j=await(m.isRTL==null?void 0:m.isRTL(p.floating)),O=b||(D||!E?[Cy(d)]:TB(d)),B=N!=="none";!b&&B&&O.push(...PB(d,E,N,j));const G=[d,...O],K=await m.detectOverflow(e,T),re=[];let se=((n=i.flip)==null?void 0:n.overflows)||[];if(v&&re.push(K[A]),x){const ie=NB(s,c,j);re.push(K[ie[0]],K[ie[1]])}if(se=[...se,{placement:s,overflows:re}],!re.every(ie=>ie<=0)){var he,U;const ie=(((he=i.flip)==null?void 0:he.index)||0)+1,ae=G[ie];if(ae&&(!(x==="alignment"?I!==Ka(ae):!1)||se.every(Y=>Ka(Y.placement)===I?Y.overflows[0]>0:!0)))return{data:{index:ie,overflows:se},reset:{placement:ae}};let de=(U=se.filter(J=>J.overflows[0]<=0).sort((J,Y)=>J.overflows[1]-Y.overflows[1])[0])==null?void 0:U.placement;if(!de)switch(S){case"bestFit":{var ge;const J=(ge=se.filter(Y=>{if(B){const $=Ka(Y.placement);return $===I||$==="y"}return!0}).map(Y=>[Y.placement,Y.overflows.filter($=>$>0).reduce(($,Q)=>$+Q,0)]).sort((Y,$)=>Y[1]-$[1])[0])==null?void 0:ge[0];J&&(de=J);break}case"initialPlacement":de=d;break}if(s!==de)return{reset:{placement:de}}}return{}}}};function PC(r,e){return{top:r.top-e.height,right:r.right-e.width,bottom:r.bottom-e.height,left:r.left-e.width}}function jC(r){return SB.some(e=>r[e]>=0)}const MB=function(r){return r===void 0&&(r={}),{name:"hide",options:r,async fn(e){const{rects:t,platform:n}=e,{strategy:s="referenceHidden",...i}=Jl(r,e);switch(s){case"referenceHidden":{const c=await n.detectOverflow(e,{...i,elementContext:"reference"}),d=PC(c,t.reference);return{data:{referenceHiddenOffsets:d,referenceHidden:jC(d)}}}case"escaped":{const c=await n.detectOverflow(e,{...i,altBoundary:!0}),d=PC(c,t.floating);return{data:{escapedOffsets:d,escaped:jC(d)}}}default:return{}}}}},rI=new Set(["left","top"]);async function $B(r,e){const{placement:t,platform:n,elements:s}=r,i=await(n.isRTL==null?void 0:n.isRTL(s.floating)),c=Xl(t),d=Sh(t),m=Ka(t)==="y",p=rI.has(c)?-1:1,v=i&&m?-1:1,x=Jl(e,r);let{mainAxis:b,crossAxis:S,alignmentAxis:N}=typeof x=="number"?{mainAxis:x,crossAxis:0,alignmentAxis:null}:{mainAxis:x.mainAxis||0,crossAxis:x.crossAxis||0,alignmentAxis:x.alignmentAxis};return d&&typeof N=="number"&&(S=d==="end"?N*-1:N),m?{x:S*v,y:b*p}:{x:b*p,y:S*v}}const UB=function(r){return r===void 0&&(r=0),{name:"offset",options:r,async fn(e){var t,n;const{x:s,y:i,placement:c,middlewareData:d}=e,m=await $B(e,r);return c===((t=d.offset)==null?void 0:t.placement)&&(n=d.arrow)!=null&&n.alignmentOffset?{}:{x:s+m.x,y:i+m.y,data:{...m,placement:c}}}}},zB=function(r){return r===void 0&&(r={}),{name:"shift",options:r,async fn(e){const{x:t,y:n,placement:s,platform:i}=e,{mainAxis:c=!0,crossAxis:d=!1,limiter:m={fn:A=>{let{x:I,y:D}=A;return{x:I,y:D}}},...p}=Jl(r,e),v={x:t,y:n},x=await i.detectOverflow(e,p),b=Ka(Xl(s)),S=oS(b);let N=v[S],E=v[b];if(c){const A=S==="y"?"top":"left",I=S==="y"?"bottom":"right",D=N+x[A],j=N-x[I];N=lb(D,N,j)}if(d){const A=b==="y"?"top":"left",I=b==="y"?"bottom":"right",D=E+x[A],j=E-x[I];E=lb(D,E,j)}const T=m.fn({...e,[S]:N,[b]:E});return{...T,data:{x:T.x-t,y:T.y-n,enabled:{[S]:c,[b]:d}}}}}},HB=function(r){return r===void 0&&(r={}),{options:r,fn(e){const{x:t,y:n,placement:s,rects:i,middlewareData:c}=e,{offset:d=0,mainAxis:m=!0,crossAxis:p=!0}=Jl(r,e),v={x:t,y:n},x=Ka(s),b=oS(x);let S=v[b],N=v[x];const E=Jl(d,e),T=typeof E=="number"?{mainAxis:E,crossAxis:0}:{mainAxis:0,crossAxis:0,...E};if(m){const D=b==="y"?"height":"width",j=i.reference[b]-i.floating[D]+T.mainAxis,O=i.reference[b]+i.reference[D]-T.mainAxis;S<j?S=j:S>O&&(S=O)}if(p){var A,I;const D=b==="y"?"width":"height",j=rI.has(Xl(s)),O=i.reference[x]-i.floating[D]+(j&&((A=c.offset)==null?void 0:A[x])||0)+(j?0:T.crossAxis),B=i.reference[x]+i.reference[D]+(j?0:((I=c.offset)==null?void 0:I[x])||0)-(j?T.crossAxis:0);N<O?N=O:N>B&&(N=B)}return{[b]:S,[x]:N}}}},BB=function(r){return r===void 0&&(r={}),{name:"size",options:r,async fn(e){var t,n;const{placement:s,rects:i,platform:c,elements:d}=e,{apply:m=()=>{},...p}=Jl(r,e),v=await c.detectOverflow(e,p),x=Xl(s),b=Sh(s),S=Ka(s)==="y",{width:N,height:E}=i.floating;let T,A;x==="top"||x==="bottom"?(T=x,A=b===(await(c.isRTL==null?void 0:c.isRTL(d.floating))?"start":"end")?"left":"right"):(A=x,T=b==="end"?"top":"bottom");const I=E-v.top-v.bottom,D=N-v.left-v.right,j=tu(E-v[T],I),O=tu(N-v[A],D),B=!e.middlewareData.shift;let G=j,K=O;if((t=e.middlewareData.shift)!=null&&t.enabled.x&&(K=D),(n=e.middlewareData.shift)!=null&&n.enabled.y&&(G=I),B&&!b){const se=ei(v.left,0),he=ei(v.right,0),U=ei(v.top,0),ge=ei(v.bottom,0);S?K=N-2*(se!==0||he!==0?se+he:ei(v.left,v.right)):G=E-2*(U!==0||ge!==0?U+ge:ei(v.top,v.bottom))}await m({...e,availableWidth:K,availableHeight:G});const re=await c.getDimensions(d.floating);return N!==re.width||E!==re.height?{reset:{rects:!0}}:{}}}};function Ky(){return typeof window<"u"}function Eh(r){return nI(r)?(r.nodeName||"").toLowerCase():"#document"}function oi(r){var e;return(r==null||(e=r.ownerDocument)==null?void 0:e.defaultView)||window}function el(r){var e;return(e=(nI(r)?r.ownerDocument:r.document)||window.document)==null?void 0:e.documentElement}function nI(r){return Ky()?r instanceof Node||r instanceof oi(r).Node:!1}function la(r){return Ky()?r instanceof Element||r instanceof oi(r).Element:!1}function Ja(r){return Ky()?r instanceof HTMLElement||r instanceof oi(r).HTMLElement:!1}function FC(r){return!Ky()||typeof ShadowRoot>"u"?!1:r instanceof ShadowRoot||r instanceof oi(r).ShadowRoot}const GB=new Set(["inline","contents"]);function ig(r){const{overflow:e,overflowX:t,overflowY:n,display:s}=ca(r);return/auto|scroll|overlay|hidden|clip/.test(e+n+t)&&!GB.has(s)}const WB=new Set(["table","td","th"]);function VB(r){return WB.has(Eh(r))}const qB=[":popover-open",":modal"];function Yy(r){return qB.some(e=>{try{return r.matches(e)}catch{return!1}})}const KB=["transform","translate","scale","rotate","perspective"],YB=["transform","translate","scale","rotate","perspective","filter"],JB=["paint","layout","strict","content"];function lS(r){const e=cS(),t=la(r)?ca(r):r;return KB.some(n=>t[n]?t[n]!=="none":!1)||(t.containerType?t.containerType!=="normal":!1)||!e&&(t.backdropFilter?t.backdropFilter!=="none":!1)||!e&&(t.filter?t.filter!=="none":!1)||YB.some(n=>(t.willChange||"").includes(n))||JB.some(n=>(t.contain||"").includes(n))}function XB(r){let e=ru(r);for(;Ja(e)&&!gh(e);){if(lS(e))return e;if(Yy(e))return null;e=ru(e)}return null}function cS(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const QB=new Set(["html","body","#document"]);function gh(r){return QB.has(Eh(r))}function ca(r){return oi(r).getComputedStyle(r)}function Jy(r){return la(r)?{scrollLeft:r.scrollLeft,scrollTop:r.scrollTop}:{scrollLeft:r.scrollX,scrollTop:r.scrollY}}function ru(r){if(Eh(r)==="html")return r;const e=r.assignedSlot||r.parentNode||FC(r)&&r.host||el(r);return FC(e)?e.host:e}function sI(r){const e=ru(r);return gh(e)?r.ownerDocument?r.ownerDocument.body:r.body:Ja(e)&&ig(e)?e:sI(e)}function qm(r,e,t){var n;e===void 0&&(e=[]),t===void 0&&(t=!0);const s=sI(r),i=s===((n=r.ownerDocument)==null?void 0:n.body),c=oi(s);if(i){const d=ub(c);return e.concat(c,c.visualViewport||[],ig(s)?s:[],d&&t?qm(d):[])}return e.concat(s,qm(s,[],t))}function ub(r){return r.parent&&Object.getPrototypeOf(r.parent)?r.frameElement:null}function oI(r){const e=ca(r);let t=parseFloat(e.width)||0,n=parseFloat(e.height)||0;const s=Ja(r),i=s?r.offsetWidth:t,c=s?r.offsetHeight:n,d=ky(t)!==i||ky(n)!==c;return d&&(t=i,n=c),{width:t,height:n,$:d}}function uS(r){return la(r)?r:r.contextElement}function ah(r){const e=uS(r);if(!Ja(e))return Ya(1);const t=e.getBoundingClientRect(),{width:n,height:s,$:i}=oI(e);let c=(i?ky(t.width):t.width)/n,d=(i?ky(t.height):t.height)/s;return(!c||!Number.isFinite(c))&&(c=1),(!d||!Number.isFinite(d))&&(d=1),{x:c,y:d}}const ZB=Ya(0);function iI(r){const e=oi(r);return!cS()||!e.visualViewport?ZB:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function eG(r,e,t){return e===void 0&&(e=!1),!t||e&&t!==oi(r)?!1:e}function fd(r,e,t,n){e===void 0&&(e=!1),t===void 0&&(t=!1);const s=r.getBoundingClientRect(),i=uS(r);let c=Ya(1);e&&(n?la(n)&&(c=ah(n)):c=ah(r));const d=eG(i,t,n)?iI(i):Ya(0);let m=(s.left+d.x)/c.x,p=(s.top+d.y)/c.y,v=s.width/c.x,x=s.height/c.y;if(i){const b=oi(i),S=n&&la(n)?oi(n):n;let N=b,E=ub(N);for(;E&&n&&S!==N;){const T=ah(E),A=E.getBoundingClientRect(),I=ca(E),D=A.left+(E.clientLeft+parseFloat(I.paddingLeft))*T.x,j=A.top+(E.clientTop+parseFloat(I.paddingTop))*T.y;m*=T.x,p*=T.y,v*=T.x,x*=T.y,m+=D,p+=j,N=oi(E),E=ub(N)}}return Ny({width:v,height:x,x:m,y:p})}function Xy(r,e){const t=Jy(r).scrollLeft;return e?e.left+t:fd(el(r)).left+t}function aI(r,e){const t=r.getBoundingClientRect(),n=t.left+e.scrollLeft-Xy(r,t),s=t.top+e.scrollTop;return{x:n,y:s}}function tG(r){let{elements:e,rect:t,offsetParent:n,strategy:s}=r;const i=s==="fixed",c=el(n),d=e?Yy(e.floating):!1;if(n===c||d&&i)return t;let m={scrollLeft:0,scrollTop:0},p=Ya(1);const v=Ya(0),x=Ja(n);if((x||!x&&!i)&&((Eh(n)!=="body"||ig(c))&&(m=Jy(n)),Ja(n))){const S=fd(n);p=ah(n),v.x=S.x+n.clientLeft,v.y=S.y+n.clientTop}const b=c&&!x&&!i?aI(c,m):Ya(0);return{width:t.width*p.x,height:t.height*p.y,x:t.x*p.x-m.scrollLeft*p.x+v.x+b.x,y:t.y*p.y-m.scrollTop*p.y+v.y+b.y}}function rG(r){return Array.from(r.getClientRects())}function nG(r){const e=el(r),t=Jy(r),n=r.ownerDocument.body,s=ei(e.scrollWidth,e.clientWidth,n.scrollWidth,n.clientWidth),i=ei(e.scrollHeight,e.clientHeight,n.scrollHeight,n.clientHeight);let c=-t.scrollLeft+Xy(r);const d=-t.scrollTop;return ca(n).direction==="rtl"&&(c+=ei(e.clientWidth,n.clientWidth)-s),{width:s,height:i,x:c,y:d}}const OC=25;function sG(r,e){const t=oi(r),n=el(r),s=t.visualViewport;let i=n.clientWidth,c=n.clientHeight,d=0,m=0;if(s){i=s.width,c=s.height;const v=cS();(!v||v&&e==="fixed")&&(d=s.offsetLeft,m=s.offsetTop)}const p=Xy(n);if(p<=0){const v=n.ownerDocument,x=v.body,b=getComputedStyle(x),S=v.compatMode==="CSS1Compat"&&parseFloat(b.marginLeft)+parseFloat(b.marginRight)||0,N=Math.abs(n.clientWidth-x.clientWidth-S);N<=OC&&(i-=N)}else p<=OC&&(i+=p);return{width:i,height:c,x:d,y:m}}const oG=new Set(["absolute","fixed"]);function iG(r,e){const t=fd(r,!0,e==="fixed"),n=t.top+r.clientTop,s=t.left+r.clientLeft,i=Ja(r)?ah(r):Ya(1),c=r.clientWidth*i.x,d=r.clientHeight*i.y,m=s*i.x,p=n*i.y;return{width:c,height:d,x:m,y:p}}function DC(r,e,t){let n;if(e==="viewport")n=sG(r,t);else if(e==="document")n=nG(el(r));else if(la(e))n=iG(e,t);else{const s=iI(r);n={x:e.x-s.x,y:e.y-s.y,width:e.width,height:e.height}}return Ny(n)}function lI(r,e){const t=ru(r);return t===e||!la(t)||gh(t)?!1:ca(t).position==="fixed"||lI(t,e)}function aG(r,e){const t=e.get(r);if(t)return t;let n=qm(r,[],!1).filter(d=>la(d)&&Eh(d)!=="body"),s=null;const i=ca(r).position==="fixed";let c=i?ru(r):r;for(;la(c)&&!gh(c);){const d=ca(c),m=lS(c);!m&&d.position==="fixed"&&(s=null),(i?!m&&!s:!m&&d.position==="static"&&!!s&&oG.has(s.position)||ig(c)&&!m&&lI(r,c))?n=n.filter(v=>v!==c):s=d,c=ru(c)}return e.set(r,n),n}function lG(r){let{element:e,boundary:t,rootBoundary:n,strategy:s}=r;const c=[...t==="clippingAncestors"?Yy(e)?[]:aG(e,this._c):[].concat(t),n],d=c[0],m=c.reduce((p,v)=>{const x=DC(e,v,s);return p.top=ei(x.top,p.top),p.right=tu(x.right,p.right),p.bottom=tu(x.bottom,p.bottom),p.left=ei(x.left,p.left),p},DC(e,d,s));return{width:m.right-m.left,height:m.bottom-m.top,x:m.left,y:m.top}}function cG(r){const{width:e,height:t}=oI(r);return{width:e,height:t}}function uG(r,e,t){const n=Ja(e),s=el(e),i=t==="fixed",c=fd(r,!0,i,e);let d={scrollLeft:0,scrollTop:0};const m=Ya(0);function p(){m.x=Xy(s)}if(n||!n&&!i)if((Eh(e)!=="body"||ig(s))&&(d=Jy(e)),n){const S=fd(e,!0,i,e);m.x=S.x+e.clientLeft,m.y=S.y+e.clientTop}else s&&p();i&&!n&&s&&p();const v=s&&!n&&!i?aI(s,d):Ya(0),x=c.left+d.scrollLeft-m.x-v.x,b=c.top+d.scrollTop-m.y-v.y;return{x,y:b,width:c.width,height:c.height}}function Jx(r){return ca(r).position==="static"}function LC(r,e){if(!Ja(r)||ca(r).position==="fixed")return null;if(e)return e(r);let t=r.offsetParent;return el(r)===t&&(t=t.ownerDocument.body),t}function cI(r,e){const t=oi(r);if(Yy(r))return t;if(!Ja(r)){let s=ru(r);for(;s&&!gh(s);){if(la(s)&&!Jx(s))return s;s=ru(s)}return t}let n=LC(r,e);for(;n&&VB(n)&&Jx(n);)n=LC(n,e);return n&&gh(n)&&Jx(n)&&!lS(n)?t:n||XB(r)||t}const dG=async function(r){const e=this.getOffsetParent||cI,t=this.getDimensions,n=await t(r.floating);return{reference:uG(r.reference,await e(r.floating),r.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function fG(r){return ca(r).direction==="rtl"}const hG={convertOffsetParentRelativeRectToViewportRelativeRect:tG,getDocumentElement:el,getClippingRect:lG,getOffsetParent:cI,getElementRects:dG,getClientRects:rG,getDimensions:cG,getScale:ah,isElement:la,isRTL:fG};function uI(r,e){return r.x===e.x&&r.y===e.y&&r.width===e.width&&r.height===e.height}function pG(r,e){let t=null,n;const s=el(r);function i(){var d;clearTimeout(n),(d=t)==null||d.disconnect(),t=null}function c(d,m){d===void 0&&(d=!1),m===void 0&&(m=1),i();const p=r.getBoundingClientRect(),{left:v,top:x,width:b,height:S}=p;if(d||e(),!b||!S)return;const N=jv(x),E=jv(s.clientWidth-(v+b)),T=jv(s.clientHeight-(x+S)),A=jv(v),D={rootMargin:-N+"px "+-E+"px "+-T+"px "+-A+"px",threshold:ei(0,tu(1,m))||1};let j=!0;function O(B){const G=B[0].intersectionRatio;if(G!==m){if(!j)return c();G?c(!1,G):n=setTimeout(()=>{c(!1,1e-7)},1e3)}G===1&&!uI(p,r.getBoundingClientRect())&&c(),j=!1}try{t=new IntersectionObserver(O,{...D,root:s.ownerDocument})}catch{t=new IntersectionObserver(O,D)}t.observe(r)}return c(!0),i}function mG(r,e,t,n){n===void 0&&(n={});const{ancestorScroll:s=!0,ancestorResize:i=!0,elementResize:c=typeof ResizeObserver=="function",layoutShift:d=typeof IntersectionObserver=="function",animationFrame:m=!1}=n,p=uS(r),v=s||i?[...p?qm(p):[],...qm(e)]:[];v.forEach(A=>{s&&A.addEventListener("scroll",t,{passive:!0}),i&&A.addEventListener("resize",t)});const x=p&&d?pG(p,t):null;let b=-1,S=null;c&&(S=new ResizeObserver(A=>{let[I]=A;I&&I.target===p&&S&&(S.unobserve(e),cancelAnimationFrame(b),b=requestAnimationFrame(()=>{var D;(D=S)==null||D.observe(e)})),t()}),p&&!m&&S.observe(p),S.observe(e));let N,E=m?fd(r):null;m&&T();function T(){const A=fd(r);E&&!uI(E,A)&&t(),E=A,N=requestAnimationFrame(T)}return t(),()=>{var A;v.forEach(I=>{s&&I.removeEventListener("scroll",t),i&&I.removeEventListener("resize",t)}),x==null||x(),(A=S)==null||A.disconnect(),S=null,m&&cancelAnimationFrame(N)}}const gG=UB,vG=zB,yG=LB,xG=BB,wG=MB,MC=DB,bG=HB,_G=(r,e,t)=>{const n=new Map,s={platform:hG,...t},i={...s.platform,_c:n};return OB(r,e,{...s,platform:i})};var dS=vN();const SG=bb(dS);var EG=typeof document<"u",kG=function(){},Jv=EG?w.useLayoutEffect:kG;function Ty(r,e){if(r===e)return!0;if(typeof r!=typeof e)return!1;if(typeof r=="function"&&r.toString()===e.toString())return!0;let t,n,s;if(r&&e&&typeof r=="object"){if(Array.isArray(r)){if(t=r.length,t!==e.length)return!1;for(n=t;n--!==0;)if(!Ty(r[n],e[n]))return!1;return!0}if(s=Object.keys(r),t=s.length,t!==Object.keys(e).length)return!1;for(n=t;n--!==0;)if(!{}.hasOwnProperty.call(e,s[n]))return!1;for(n=t;n--!==0;){const i=s[n];if(!(i==="_owner"&&r.$$typeof)&&!Ty(r[i],e[i]))return!1}return!0}return r!==r&&e!==e}function dI(r){return typeof window>"u"?1:(r.ownerDocument.defaultView||window).devicePixelRatio||1}function $C(r,e){const t=dI(r);return Math.round(e*t)/t}function Xx(r){const e=w.useRef(r);return Jv(()=>{e.current=r}),e}function CG(r){r===void 0&&(r={});const{placement:e="bottom",strategy:t="absolute",middleware:n=[],platform:s,elements:{reference:i,floating:c}={},transform:d=!0,whileElementsMounted:m,open:p}=r,[v,x]=w.useState({x:0,y:0,strategy:t,placement:e,middlewareData:{},isPositioned:!1}),[b,S]=w.useState(n);Ty(b,n)||S(n);const[N,E]=w.useState(null),[T,A]=w.useState(null),I=w.useCallback(Y=>{Y!==B.current&&(B.current=Y,E(Y))},[]),D=w.useCallback(Y=>{Y!==G.current&&(G.current=Y,A(Y))},[]),j=i||N,O=c||T,B=w.useRef(null),G=w.useRef(null),K=w.useRef(v),re=m!=null,se=Xx(m),he=Xx(s),U=Xx(p),ge=w.useCallback(()=>{if(!B.current||!G.current)return;const Y={placement:e,strategy:t,middleware:b};he.current&&(Y.platform=he.current),_G(B.current,G.current,Y).then($=>{const Q={...$,isPositioned:U.current!==!1};ie.current&&!Ty(K.current,Q)&&(K.current=Q,dS.flushSync(()=>{x(Q)}))})},[b,e,t,he,U]);Jv(()=>{p===!1&&K.current.isPositioned&&(K.current.isPositioned=!1,x(Y=>({...Y,isPositioned:!1})))},[p]);const ie=w.useRef(!1);Jv(()=>(ie.current=!0,()=>{ie.current=!1}),[]),Jv(()=>{if(j&&(B.current=j),O&&(G.current=O),j&&O){if(se.current)return se.current(j,O,ge);ge()}},[j,O,ge,se,re]);const ae=w.useMemo(()=>({reference:B,floating:G,setReference:I,setFloating:D}),[I,D]),de=w.useMemo(()=>({reference:j,floating:O}),[j,O]),J=w.useMemo(()=>{const Y={position:t,left:0,top:0};if(!de.floating)return Y;const $=$C(de.floating,v.x),Q=$C(de.floating,v.y);return d?{...Y,transform:"translate("+$+"px, "+Q+"px)",...dI(de.floating)>=1.5&&{willChange:"transform"}}:{position:t,left:$,top:Q}},[t,d,de.floating,v.x,v.y]);return w.useMemo(()=>({...v,update:ge,refs:ae,elements:de,floatingStyles:J}),[v,ge,ae,de,J])}const NG=r=>{function e(t){return{}.hasOwnProperty.call(t,"current")}return{name:"arrow",options:r,fn(t){const{element:n,padding:s}=typeof r=="function"?r(t):r;return n&&e(n)?n.current!=null?MC({element:n.current,padding:s}).fn(t):{}:n?MC({element:n,padding:s}).fn(t):{}}}},TG=(r,e)=>({...gG(r),options:[r,e]}),AG=(r,e)=>({...vG(r),options:[r,e]}),IG=(r,e)=>({...bG(r),options:[r,e]}),RG=(r,e)=>({...yG(r),options:[r,e]}),PG=(r,e)=>({...xG(r),options:[r,e]}),jG=(r,e)=>({...wG(r),options:[r,e]}),FG=(r,e)=>({...NG(r),options:[r,e]});function OG(r){const e=DG(r),t=w.forwardRef((n,s)=>{const{children:i,...c}=n,d=w.Children.toArray(i),m=d.find(MG);if(m){const p=m.props.children,v=d.map(x=>x===m?w.Children.count(p)>1?w.Children.only(null):w.isValidElement(p)?p.props.children:null:x);return u.jsx(e,{...c,ref:s,children:w.isValidElement(p)?w.cloneElement(p,void 0,v):null})}return u.jsx(e,{...c,ref:s,children:i})});return t.displayName=`${r}.Slot`,t}function DG(r){const e=w.forwardRef((t,n)=>{const{children:s,...i}=t;if(w.isValidElement(s)){const c=UG(s),d=$G(i,s.props);return s.type!==w.Fragment&&(d.ref=n?nu(n,c):c),w.cloneElement(s,d)}return w.Children.count(s)>1?w.Children.only(null):null});return e.displayName=`${r}.SlotClone`,e}var LG=Symbol("radix.slottable");function MG(r){return w.isValidElement(r)&&typeof r.type=="function"&&"__radixId"in r.type&&r.type.__radixId===LG}function $G(r,e){const t={...e};for(const n in e){const s=r[n],i=e[n];/^on[A-Z]/.test(n)?s&&i?t[n]=(...d)=>{const m=i(...d);return s(...d),m}:s&&(t[n]=s):n==="style"?t[n]={...s,...i}:n==="className"&&(t[n]=[s,i].filter(Boolean).join(" "))}return{...r,...t}}function UG(r){var n,s;let e=(n=Object.getOwnPropertyDescriptor(r.props,"ref"))==null?void 0:n.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=(s=Object.getOwnPropertyDescriptor(r,"ref"))==null?void 0:s.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}var zG=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Ur=zG.reduce((r,e)=>{const t=OG(`Primitive.${e}`),n=w.forwardRef((s,i)=>{const{asChild:c,...d}=s,m=c?t:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),u.jsx(m,{...d,ref:i})});return n.displayName=`Primitive.${e}`,{...r,[e]:n}},{});function fI(r,e){r&&dS.flushSync(()=>r.dispatchEvent(e))}var HG="Arrow",hI=w.forwardRef((r,e)=>{const{children:t,width:n=10,height:s=5,...i}=r;return u.jsx(Ur.svg,{...i,ref:e,width:n,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:r.asChild?t:u.jsx("polygon",{points:"0,0 30,0 15,10"})})});hI.displayName=HG;var BG=hI;function Ql(r){const e=w.useRef(r);return w.useEffect(()=>{e.current=r}),w.useMemo(()=>(...t)=>{var n;return(n=e.current)==null?void 0:n.call(e,...t)},[])}function GG(r){const[e,t]=w.useState(void 0);return Yl(()=>{if(r){t({width:r.offsetWidth,height:r.offsetHeight});const n=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const i=s[0];let c,d;if("borderBoxSize"in i){const m=i.borderBoxSize,p=Array.isArray(m)?m[0]:m;c=p.inlineSize,d=p.blockSize}else c=r.offsetWidth,d=r.offsetHeight;t({width:c,height:d})});return n.observe(r,{box:"border-box"}),()=>n.unobserve(r)}else t(void 0)},[r]),e}var fS="Popper",[pI,Qy]=Za(fS),[WG,mI]=pI(fS),gI=r=>{const{__scopePopper:e,children:t}=r,[n,s]=w.useState(null);return u.jsx(WG,{scope:e,anchor:n,onAnchorChange:s,children:t})};gI.displayName=fS;var vI="PopperAnchor",yI=w.forwardRef((r,e)=>{const{__scopePopper:t,virtualRef:n,...s}=r,i=mI(vI,t),c=w.useRef(null),d=$n(e,c),m=w.useRef(null);return w.useEffect(()=>{const p=m.current;m.current=(n==null?void 0:n.current)||c.current,p!==m.current&&i.onAnchorChange(m.current)}),n?null:u.jsx(Ur.div,{...s,ref:d})});yI.displayName=vI;var hS="PopperContent",[VG,qG]=pI(hS),xI=w.forwardRef((r,e)=>{var X,we,Ne,Me,St,Te;const{__scopePopper:t,side:n="bottom",sideOffset:s=0,align:i="center",alignOffset:c=0,arrowPadding:d=0,avoidCollisions:m=!0,collisionBoundary:p=[],collisionPadding:v=0,sticky:x="partial",hideWhenDetached:b=!1,updatePositionStrategy:S="optimized",onPlaced:N,...E}=r,T=mI(hS,t),[A,I]=w.useState(null),D=$n(e,Ge=>I(Ge)),[j,O]=w.useState(null),B=GG(j),G=(B==null?void 0:B.width)??0,K=(B==null?void 0:B.height)??0,re=n+(i!=="center"?"-"+i:""),se=typeof v=="number"?v:{top:0,right:0,bottom:0,left:0,...v},he=Array.isArray(p)?p:[p],U=he.length>0,ge={padding:se,boundary:he.filter(YG),altBoundary:U},{refs:ie,floatingStyles:ae,placement:de,isPositioned:J,middlewareData:Y}=CG({strategy:"fixed",placement:re,whileElementsMounted:(...Ge)=>mG(...Ge,{animationFrame:S==="always"}),elements:{reference:T.anchor},middleware:[TG({mainAxis:s+K,alignmentAxis:c}),m&&AG({mainAxis:!0,crossAxis:!1,limiter:x==="partial"?IG():void 0,...ge}),m&&RG({...ge}),PG({...ge,apply:({elements:Ge,rects:Ee,availableWidth:ye,availableHeight:Ke})=>{const{width:qe,height:ft}=Ee.reference,mt=Ge.floating.style;mt.setProperty("--radix-popper-available-width",`${ye}px`),mt.setProperty("--radix-popper-available-height",`${Ke}px`),mt.setProperty("--radix-popper-anchor-width",`${qe}px`),mt.setProperty("--radix-popper-anchor-height",`${ft}px`)}}),j&&FG({element:j,padding:d}),JG({arrowWidth:G,arrowHeight:K}),b&&jG({strategy:"referenceHidden",...ge})]}),[$,Q]=_I(de),F=Ql(N);Yl(()=>{J&&(F==null||F())},[J,F]);const H=(X=Y.arrow)==null?void 0:X.x,te=(we=Y.arrow)==null?void 0:we.y,Se=((Ne=Y.arrow)==null?void 0:Ne.centerOffset)!==0,[ue,ke]=w.useState();return Yl(()=>{A&&ke(window.getComputedStyle(A).zIndex)},[A]),u.jsx("div",{ref:ie.setFloating,"data-radix-popper-content-wrapper":"",style:{...ae,transform:J?ae.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:ue,"--radix-popper-transform-origin":[(Me=Y.transformOrigin)==null?void 0:Me.x,(St=Y.transformOrigin)==null?void 0:St.y].join(" "),...((Te=Y.hide)==null?void 0:Te.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:r.dir,children:u.jsx(VG,{scope:t,placedSide:$,onArrowChange:O,arrowX:H,arrowY:te,shouldHideArrow:Se,children:u.jsx(Ur.div,{"data-side":$,"data-align":Q,...E,ref:D,style:{...E.style,animation:J?void 0:"none"}})})})});xI.displayName=hS;var wI="PopperArrow",KG={top:"bottom",right:"left",bottom:"top",left:"right"},bI=w.forwardRef(function(e,t){const{__scopePopper:n,...s}=e,i=qG(wI,n),c=KG[i.placedSide];return u.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[c]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:u.jsx(BG,{...s,ref:t,style:{...s.style,display:"block"}})})});bI.displayName=wI;function YG(r){return r!==null}var JG=r=>({name:"transformOrigin",options:r,fn(e){var T,A,I;const{placement:t,rects:n,middlewareData:s}=e,c=((T=s.arrow)==null?void 0:T.centerOffset)!==0,d=c?0:r.arrowWidth,m=c?0:r.arrowHeight,[p,v]=_I(t),x={start:"0%",center:"50%",end:"100%"}[v],b=(((A=s.arrow)==null?void 0:A.x)??0)+d/2,S=(((I=s.arrow)==null?void 0:I.y)??0)+m/2;let N="",E="";return p==="bottom"?(N=c?x:`${b}px`,E=`${-m}px`):p==="top"?(N=c?x:`${b}px`,E=`${n.floating.height+m}px`):p==="right"?(N=`${-m}px`,E=c?x:`${S}px`):p==="left"&&(N=`${n.floating.width+m}px`,E=c?x:`${S}px`),{data:{x:N,y:E}}}});function _I(r){const[e,t="center"]=r.split("-");return[e,t]}var SI=gI,EI=yI,kI=xI,CI=bI,XG="Portal",pS=w.forwardRef((r,e)=>{var d;const{container:t,...n}=r,[s,i]=w.useState(!1);Yl(()=>i(!0),[]);const c=t||s&&((d=globalThis==null?void 0:globalThis.document)==null?void 0:d.body);return c?SG.createPortal(u.jsx(Ur.div,{...n,ref:e}),c):null});pS.displayName=XG;function QG(r,e){return w.useReducer((t,n)=>e[t][n]??t,r)}var da=r=>{const{present:e,children:t}=r,n=ZG(e),s=typeof t=="function"?t({present:n.isPresent}):w.Children.only(t),i=$n(n.ref,e7(s));return typeof t=="function"||n.isPresent?w.cloneElement(s,{ref:i}):null};da.displayName="Presence";function ZG(r){const[e,t]=w.useState(),n=w.useRef(null),s=w.useRef(r),i=w.useRef("none"),c=r?"mounted":"unmounted",[d,m]=QG(c,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return w.useEffect(()=>{const p=Fv(n.current);i.current=d==="mounted"?p:"none"},[d]),Yl(()=>{const p=n.current,v=s.current;if(v!==r){const b=i.current,S=Fv(p);r?m("MOUNT"):S==="none"||(p==null?void 0:p.display)==="none"?m("UNMOUNT"):m(v&&b!==S?"ANIMATION_OUT":"UNMOUNT"),s.current=r}},[r,m]),Yl(()=>{if(e){let p;const v=e.ownerDocument.defaultView??window,x=S=>{const E=Fv(n.current).includes(CSS.escape(S.animationName));if(S.target===e&&E&&(m("ANIMATION_END"),!s.current)){const T=e.style.animationFillMode;e.style.animationFillMode="forwards",p=v.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=T)})}},b=S=>{S.target===e&&(i.current=Fv(n.current))};return e.addEventListener("animationstart",b),e.addEventListener("animationcancel",x),e.addEventListener("animationend",x),()=>{v.clearTimeout(p),e.removeEventListener("animationstart",b),e.removeEventListener("animationcancel",x),e.removeEventListener("animationend",x)}}else m("ANIMATION_END")},[e,m]),{isPresent:["mounted","unmountSuspended"].includes(d),ref:w.useCallback(p=>{n.current=p?getComputedStyle(p):null,t(p)},[])}}function Fv(r){return(r==null?void 0:r.animationName)||"none"}function e7(r){var n,s;let e=(n=Object.getOwnPropertyDescriptor(r.props,"ref"))==null?void 0:n.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=(s=Object.getOwnPropertyDescriptor(r,"ref"))==null?void 0:s.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}function t7(r,e=globalThis==null?void 0:globalThis.document){const t=Ql(r);w.useEffect(()=>{const n=s=>{s.key==="Escape"&&t(s)};return e.addEventListener("keydown",n,{capture:!0}),()=>e.removeEventListener("keydown",n,{capture:!0})},[t,e])}var r7="DismissableLayer",db="dismissableLayer.update",n7="dismissableLayer.pointerDownOutside",s7="dismissableLayer.focusOutside",UC,NI=w.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Zy=w.forwardRef((r,e)=>{const{disableOutsidePointerEvents:t=!1,onEscapeKeyDown:n,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:c,onDismiss:d,...m}=r,p=w.useContext(NI),[v,x]=w.useState(null),b=(v==null?void 0:v.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,S]=w.useState({}),N=$n(e,G=>x(G)),E=Array.from(p.layers),[T]=[...p.layersWithOutsidePointerEventsDisabled].slice(-1),A=E.indexOf(T),I=v?E.indexOf(v):-1,D=p.layersWithOutsidePointerEventsDisabled.size>0,j=I>=A,O=a7(G=>{const K=G.target,re=[...p.branches].some(se=>se.contains(K));!j||re||(s==null||s(G),c==null||c(G),G.defaultPrevented||d==null||d())},b),B=l7(G=>{const K=G.target;[...p.branches].some(se=>se.contains(K))||(i==null||i(G),c==null||c(G),G.defaultPrevented||d==null||d())},b);return t7(G=>{I===p.layers.size-1&&(n==null||n(G),!G.defaultPrevented&&d&&(G.preventDefault(),d()))},b),w.useEffect(()=>{if(v)return t&&(p.layersWithOutsidePointerEventsDisabled.size===0&&(UC=b.body.style.pointerEvents,b.body.style.pointerEvents="none"),p.layersWithOutsidePointerEventsDisabled.add(v)),p.layers.add(v),zC(),()=>{t&&p.layersWithOutsidePointerEventsDisabled.size===1&&(b.body.style.pointerEvents=UC)}},[v,b,t,p]),w.useEffect(()=>()=>{v&&(p.layers.delete(v),p.layersWithOutsidePointerEventsDisabled.delete(v),zC())},[v,p]),w.useEffect(()=>{const G=()=>S({});return document.addEventListener(db,G),()=>document.removeEventListener(db,G)},[]),u.jsx(Ur.div,{...m,ref:N,style:{pointerEvents:D?j?"auto":"none":void 0,...r.style},onFocusCapture:$t(r.onFocusCapture,B.onFocusCapture),onBlurCapture:$t(r.onBlurCapture,B.onBlurCapture),onPointerDownCapture:$t(r.onPointerDownCapture,O.onPointerDownCapture)})});Zy.displayName=r7;var o7="DismissableLayerBranch",i7=w.forwardRef((r,e)=>{const t=w.useContext(NI),n=w.useRef(null),s=$n(e,n);return w.useEffect(()=>{const i=n.current;if(i)return t.branches.add(i),()=>{t.branches.delete(i)}},[t.branches]),u.jsx(Ur.div,{...r,ref:s})});i7.displayName=o7;function a7(r,e=globalThis==null?void 0:globalThis.document){const t=Ql(r),n=w.useRef(!1),s=w.useRef(()=>{});return w.useEffect(()=>{const i=d=>{if(d.target&&!n.current){let m=function(){TI(n7,t,p,{discrete:!0})};const p={originalEvent:d};d.pointerType==="touch"?(e.removeEventListener("click",s.current),s.current=m,e.addEventListener("click",s.current,{once:!0})):m()}else e.removeEventListener("click",s.current);n.current=!1},c=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(c),e.removeEventListener("pointerdown",i),e.removeEventListener("click",s.current)}},[e,t]),{onPointerDownCapture:()=>n.current=!0}}function l7(r,e=globalThis==null?void 0:globalThis.document){const t=Ql(r),n=w.useRef(!1);return w.useEffect(()=>{const s=i=>{i.target&&!n.current&&TI(s7,t,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",s),()=>e.removeEventListener("focusin",s)},[e,t]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function zC(){const r=new CustomEvent(db);document.dispatchEvent(r)}function TI(r,e,t,{discrete:n}){const s=t.originalEvent.target,i=new CustomEvent(r,{bubbles:!1,cancelable:!0,detail:t});e&&s.addEventListener(r,e,{once:!0}),n?fI(s,i):s.dispatchEvent(i)}var Qx,e0="HoverCard",[AI]=Za(e0,[Qy]),t0=Qy(),[c7,mS]=AI(e0),II=r=>{const{__scopeHoverCard:e,children:t,open:n,defaultOpen:s,onOpenChange:i,openDelay:c=700,closeDelay:d=300}=r,m=t0(e),p=w.useRef(0),v=w.useRef(0),x=w.useRef(!1),b=w.useRef(!1),[S,N]=su({prop:n,defaultProp:s??!1,onChange:i,caller:e0}),E=w.useCallback(()=>{clearTimeout(v.current),p.current=window.setTimeout(()=>N(!0),c)},[c,N]),T=w.useCallback(()=>{clearTimeout(p.current),!x.current&&!b.current&&(v.current=window.setTimeout(()=>N(!1),d))},[d,N]),A=w.useCallback(()=>N(!1),[N]);return w.useEffect(()=>()=>{clearTimeout(p.current),clearTimeout(v.current)},[]),u.jsx(c7,{scope:e,open:S,onOpenChange:N,onOpen:E,onClose:T,onDismiss:A,hasSelectionRef:x,isPointerDownOnContentRef:b,children:u.jsx(SI,{...m,children:t})})};II.displayName=e0;var RI="HoverCardTrigger",PI=w.forwardRef((r,e)=>{const{__scopeHoverCard:t,...n}=r,s=mS(RI,t),i=t0(t);return u.jsx(EI,{asChild:!0,...i,children:u.jsx(Ur.a,{"data-state":s.open?"open":"closed",...n,ref:e,onPointerEnter:$t(r.onPointerEnter,Iy(s.onOpen)),onPointerLeave:$t(r.onPointerLeave,Iy(s.onClose)),onFocus:$t(r.onFocus,s.onOpen),onBlur:$t(r.onBlur,s.onClose),onTouchStart:$t(r.onTouchStart,c=>c.preventDefault())})})});PI.displayName=RI;var u7="HoverCardPortal",[jK,d7]=AI(u7,{forceMount:void 0}),Ay="HoverCardContent",jI=w.forwardRef((r,e)=>{const t=d7(Ay,r.__scopeHoverCard),{forceMount:n=t.forceMount,...s}=r,i=mS(Ay,r.__scopeHoverCard);return u.jsx(da,{present:n||i.open,children:u.jsx(f7,{"data-state":i.open?"open":"closed",...s,onPointerEnter:$t(r.onPointerEnter,Iy(i.onOpen)),onPointerLeave:$t(r.onPointerLeave,Iy(i.onClose)),ref:e})})});jI.displayName=Ay;var f7=w.forwardRef((r,e)=>{const{__scopeHoverCard:t,onEscapeKeyDown:n,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:c,...d}=r,m=mS(Ay,t),p=t0(t),v=w.useRef(null),x=$n(e,v),[b,S]=w.useState(!1);return w.useEffect(()=>{if(b){const N=document.body;return Qx=N.style.userSelect||N.style.webkitUserSelect,N.style.userSelect="none",N.style.webkitUserSelect="none",()=>{N.style.userSelect=Qx,N.style.webkitUserSelect=Qx}}},[b]),w.useEffect(()=>{if(v.current){const N=()=>{S(!1),m.isPointerDownOnContentRef.current=!1,setTimeout(()=>{var T;((T=document.getSelection())==null?void 0:T.toString())!==""&&(m.hasSelectionRef.current=!0)})};return document.addEventListener("pointerup",N),()=>{document.removeEventListener("pointerup",N),m.hasSelectionRef.current=!1,m.isPointerDownOnContentRef.current=!1}}},[m.isPointerDownOnContentRef,m.hasSelectionRef]),w.useEffect(()=>{v.current&&p7(v.current).forEach(E=>E.setAttribute("tabindex","-1"))}),u.jsx(Zy,{asChild:!0,disableOutsidePointerEvents:!1,onInteractOutside:c,onEscapeKeyDown:n,onPointerDownOutside:s,onFocusOutside:$t(i,N=>{N.preventDefault()}),onDismiss:m.onDismiss,children:u.jsx(kI,{...p,...d,onPointerDown:$t(d.onPointerDown,N=>{N.currentTarget.contains(N.target)&&S(!0),m.hasSelectionRef.current=!1,m.isPointerDownOnContentRef.current=!0}),ref:x,style:{...d.style,userSelect:b?"text":void 0,WebkitUserSelect:b?"text":void 0,"--radix-hover-card-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-hover-card-content-available-width":"var(--radix-popper-available-width)","--radix-hover-card-content-available-height":"var(--radix-popper-available-height)","--radix-hover-card-trigger-width":"var(--radix-popper-anchor-width)","--radix-hover-card-trigger-height":"var(--radix-popper-anchor-height)"}})})}),h7="HoverCardArrow",FI=w.forwardRef((r,e)=>{const{__scopeHoverCard:t,...n}=r,s=t0(t);return u.jsx(CI,{...s,...n,ref:e})});FI.displayName=h7;function Iy(r){return e=>e.pointerType==="touch"?void 0:r()}function p7(r){const e=[],t=document.createTreeWalker(r,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP});for(;t.nextNode();)e.push(t.currentNode);return e}var m7=II,g7=PI,v7=jI,y7=FI;const fb="src/lib/utils/emailUtils.tsx";async function gS(r,e){try{await(await Yn.createServices()).contentScript.insertContentIntoComposeBox(r)}catch(t){e.error("Error inserting content into compose box",t,{sourceFile:fb,functionName:"insertHtmlIntoComposeBox"}),x7(r,e)}}function x7(r,e){const t=r.replace(/<([^>]+)class="ql-align-([^"]+)"([^>]*)>/g,'<$1style="text-align: $2"$3>');chrome.tabs.query({active:!0,currentWindow:!0},n=>{const s=n[0];if(!(s!=null&&s.id)){e.error("No active tab found or tab ID is undefined",void 0,{sourceFile:fb,functionName:"insertHtmlIntoComposeBoxLegacy"});return}chrome.scripting.executeScript({target:{tabId:s.id},func:i=>{console.debug("Script executing in tab context");function c(){return document.querySelector('div[role="textbox"][aria-label="Message Body"]')||document.querySelector('div[aria-label="Message body, press Alt+F10 to exit"]')}function d(p,v){document.execCommand("insertHTML",!1,v),console.debug("Inserted using execCommand fallback")}const m=c();if(m)console.debug("found composeBox: ",m);else{console.error("Compose box not found");return}try{m.focus(),navigator.clipboard&&navigator.clipboard.writeText?navigator.clipboard.writeText(i).then(()=>{document.execCommand("paste"),console.debug("Pasted using Clipboard API")}).catch(p=>{console.warn("Clipboard API failed, using fallback:",p),d(m,i)}):d(m,i)}catch(p){console.error("Error during paste operation:",p)}},args:[t]}).catch(i=>{e.error("Error executing script",i,{sourceFile:fb,functionName:"insertHtmlIntoComposeBoxLegacy"})})})}const w7="src/lib/types/Template.ts",HC=async(r,e)=>{const t="GetTemplateWithContentFromServerTemplate";try{const n=r.source;if(!n)throw new Error("Source value is undefined");const s={...r,source:n};return{id:s.template_id,timeStamp:Date.now(),title:s.templateName,description:s.templateDescription,tags:s.tags||[],source:s.source==="SCOPE_USER"?"personal":"org",content:s.templateBody}}catch(n){throw e.error("Error getting template content",n,{sourceFile:w7,functionName:t,templateId:r.template_id}),n}},$l="src/lib/utils/templateUtils.tsx",BC=async(r,e=!0)=>{const t="getAllTemplatesWithContent";try{const n=await Q6(r);r.debug("Templates from server",{sourceFile:$l,functionName:t,userCount:n.user_templates.length,orgCount:n.org_templates.length});const s=async v=>{const x="fetchPersonalTemplateWithErrorHandling";try{const b={...v,source:v.source||"SCOPE_USER"};return r.debug("Fetching personal template",{sourceFile:$l,functionName:x,templateId:b.template_id,scope:b.source}),await HC(b,r)}catch(b){return r.error("Failed to load personal template",b,{sourceFile:$l,functionName:x,templateId:v.template_id}),null}},i=async v=>{const x="fetchOrgTemplateWithErrorHandling";try{const b={...v,source:v.source||"SCOPE_TENANT"};return r.debug("Fetching org template",{sourceFile:$l,functionName:x,templateId:b.template_id,scope:b.source}),await HC(b,r)}catch(b){return r.error("Failed to load org template",b,{sourceFile:$l,functionName:x,templateId:v.template_id}),null}};let c=[];e&&(c=await Promise.all(n.user_templates.map(s)));const d=c.filter(Boolean),p=(await Promise.all(n.org_templates.map(i))).filter(Boolean);return r.info("Loaded templates",{sourceFile:$l,functionName:t,personalLoaded:d.length,personalTotal:n.user_templates.length,orgLoaded:p.length,orgTotal:n.org_templates.length}),e&&await jU(r,d),await FU(r,p),[...d,...p]}catch(n){r.error("Error in getAllTemplatesWithContent",n,{sourceFile:$l,functionName:t}),r.info("Falling back to cached templates from local storage",{sourceFile:$l,functionName:t});const s=await eT(r),i=await tT(r);return[...s,...i]}},b7=async r=>{const e="getTemplatesFromLocalStorage";try{const[t,n]=await Promise.all([eT(r),tT(r)]);return[...t,...n]}catch(t){return r.error("Error getting templates from local storage",t,{sourceFile:$l,functionName:e}),[]}};async function GC(r,{signalType:e,signalValue:t}){localStorage.setItem(e,t);try{const s=(await Yn.createServices()).tabs;s.openOptionsPage?await s.openOptionsPage():r.error("Tabs provider does not support options page",new Error("Tabs provider does not support options page"),{sourceFile:"src/shared/lib/utils/optionsUtils.ts",sourceFunction:"openOrFocusOptionsPage"})}catch(n){r.error("Error opening options page",n,{sourceFile:"src/shared/lib/utils/optionsUtils.ts",sourceFunction:"openOrFocusOptionsPage"})}}const r0=({feature:r,description:e,benefits:t=[],className:n="",variant:s="card"})=>{const{isConnected:i,isLoading:c,error:d,status:m,initiateReconnection:p}=Di(),{platform:v}=mn();if(v!=="chrome"||i)return null;const x=async()=>{try{await p()}catch(N){console.error("Failed to reconnect Gmail:",N)}},b=()=>m==="loading"?u.jsx(si,{className:"h-5 w-5 text-blue-600 animate-spin"}):m==="error"?u.jsx(ih,{className:"h-5 w-5 text-red-600"}):u.jsx(eu,{className:"h-5 w-5 text-amber-600"}),S=()=>m==="loading"?"Checking Gmail connection...":m==="error"?d||"Gmail connection error occurred":"Gmail connection required";return s==="banner"?u.jsxs("div",{className:`flex items-center justify-between bg-amber-50 border border-amber-200 px-4 py-3 rounded-lg ${n}`,children:[u.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[b(),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("p",{className:"text-sm font-medium text-amber-800",children:S()}),u.jsx("p",{className:"text-sm text-amber-700 mt-1",children:e||`Connect Gmail to access ${r} features.`})]})]}),u.jsx(Ye,{onClick:x,disabled:c,variant:"outline",size:"sm",className:"bg-amber-100 border-amber-300 text-amber-800 hover:bg-amber-200 hover:border-amber-400 whitespace-nowrap ml-4",children:c?u.jsxs(u.Fragment,{children:[u.jsx(si,{className:"h-4 w-4 mr-2 animate-spin"}),"Connecting..."]}):"Connect Gmail"})]}):s==="inline"?u.jsxs("div",{className:`flex items-center gap-2 text-amber-700 ${n}`,children:[b(),u.jsx("span",{className:"text-sm",children:S()}),u.jsx(Ye,{onClick:x,disabled:c,variant:"link",size:"sm",className:"h-auto p-0 text-amber-700 hover:text-amber-800",children:"Connect Gmail"})]}):u.jsx(Es,{className:`${n}`,children:u.jsx(ks,{className:"p-6",children:u.jsxs("div",{className:"flex items-start gap-4",children:[u.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-amber-100 rounded-full flex items-center justify-center",children:b()}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("h3",{className:"text-base font-semibold text-gray-900 mb-2",children:"Gmail Connection Required"}),u.jsx("p",{className:"text-gray-600 mb-4",children:e||`To access ${r}, you need to connect your Gmail account first.`}),t.length>0&&u.jsxs("div",{className:"mb-4",children:[u.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"What you'll get with Gmail connected:"}),u.jsx("ul",{className:"text-sm text-gray-600 space-y-1",children:t.map((N,E)=>u.jsxs("li",{className:"flex items-start gap-2",children:[u.jsx(Jc,{className:"h-4 w-4 text-green-600 mt-0.5 flex-shrink-0"}),u.jsx("span",{children:N})]},E))})]}),d&&u.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-3 mb-4",children:u.jsx("p",{className:"text-sm text-red-800",children:d})}),u.jsx("div",{className:"flex items-center gap-3",children:u.jsx(Ye,{onClick:x,disabled:c,className:"bg-blue-600 hover:bg-blue-700",children:c?u.jsxs(u.Fragment,{children:[u.jsx(si,{className:"h-4 w-4 mr-2 animate-spin"}),"Connecting..."]}):u.jsxs(u.Fragment,{children:[u.jsx(eu,{className:"h-4 w-4 mr-2"}),"Connect Gmail"]})})})]})]})})})},so="src/sidepanel/panels/TemplatesPanel.tsx",_7=({clientEmail:r,isAuthenticated:e})=>{const t=Jr(),{platform:n}=mn(),{isConnected:s}=Di(),[i,c]=w.useState(""),[d,m]=w.useState([]),[p,v]=w.useState(!1),[x,b]=w.useState([]),[S,N]=w.useState([]),[E,T]=w.useState("all"),[A,I]=w.useState([]),[D,j]=w.useState(!0),[O,B]=w.useState(!1),[G,K]=w.useState(null),re=w.useRef(null),se=w.useRef(null);w.useEffect(()=>{function H(te){p&&re.current&&!re.current.contains(te.target)&&se.current&&!se.current.contains(te.target)&&v(!1)}return document.addEventListener("mousedown",H),()=>{document.removeEventListener("mousedown",H)}},[p]),w.useEffect(()=>{function H(te){G&&!te.target.closest("[data-radix-hover-card-content]")&&K(null)}return G&&document.addEventListener("mousedown",H),()=>{document.removeEventListener("mousedown",H)}},[G]),w.useEffect(()=>{if(A.length>0){const H=A.filter(te=>{var Se,ue,ke,X,we;return(E==="all"||E==="org"&&te.source==="org"||E==="personal"&&te.source!=="org")&&(((Se=te.title)==null?void 0:Se.toLowerCase().includes(i.toLowerCase()))||((ue=te.content)==null?void 0:ue.toLowerCase().includes(i.toLowerCase()))||((ke=te.tags)==null?void 0:ke.some(Ne=>Ne.toLowerCase().includes(i.toLowerCase())))||((X=te.description)==null?void 0:X.toLowerCase().includes(i.toLowerCase())))&&(x.length===0||((we=te.tags)==null?void 0:we.some(Ne=>x.includes(Ne))))});if(i.trim()){const te=H.sort((Se,ue)=>{const ke=i.toLowerCase(),X=Me=>{var St,Te,Ge,Ee;return(St=Me.tags)!=null&&St.some(ye=>ye.toLowerCase().includes(ke))?1:(Te=Me.title)!=null&&Te.toLowerCase().includes(ke)?2:(Ge=Me.description)!=null&&Ge.toLowerCase().includes(ke)?3:(Ee=Me.content)!=null&&Ee.toLowerCase().includes(ke)?4:5},we=X(Se),Ne=X(ue);return we!==Ne?we-Ne:(Se.title||"").localeCompare(ue.title||"")});m(te)}else m(H)}},[A,i,x,E]),w.useEffect(()=>{if(!e){t.debug("Skipping template loading - user not authenticated",{sourceFile:so,isAuthenticated:e});return}const H=async()=>{j(!0);const te="loadTemplatesDirectly";try{t.info("Loading templates directly from server (like options page)",{sourceFile:so,functionName:te});const Se=await BC(t,!0);if(Se.length>0){t.info("Templates loaded successfully",{sourceFile:so,functionName:te,count:Se.length}),I(Se);const ue=await ay(t);let ke=[];ue.id!==""&&(ke=ue.templateConfiguration.tags||[]);const X=new Set(ke);Se.forEach(we=>{we.tags&&Array.isArray(we.tags)&&we.tags.forEach(Ne=>X.add(Ne))}),N(Array.from(X))}else t.info("No templates found!",{sourceFile:so,functionName:te}),I([])}catch(Se){t.error("Error loading templates directly from server",Se,{sourceFile:so,functionName:te});try{const ue=await b7(t);t.info("Fallback to local storage successful",{sourceFile:so,functionName:te,count:ue.length}),I(ue)}catch(ue){t.error("Fallback to local storage also failed",ue,{sourceFile:so,functionName:te}),I([])}}finally{j(!1)}};t.info("TemplatesPanel initialized, loading templates directly from server",{sourceFile:so,isAuthenticated:e}),H()},[t,e]);const he=w.useCallback(async()=>{if(O)return;B(!0);const H="refreshTemplates";t.info("Starting template refresh from server",{sourceFile:so,functionName:H});try{const te=await ay(t);let Se=[];te.id!==""?(t.debug("configuration loaded from storage",{sourceFile:so,functionName:H,config:te}),Se=te.templateConfiguration.tags||[]):t.warn("No configuration found in storage",{sourceFile:so,functionName:H}),t.info("Calling getAllTemplatesWithContent",{sourceFile:so,functionName:H});const ue=await BC(t,!0);t.info("getAllTemplatesWithContent completed",{sourceFile:so,functionName:H,templateCount:ue.length});const ke=new Set(Se);ue.forEach(we=>{we.tags&&Array.isArray(we.tags)&&we.tags.forEach(Ne=>ke.add(Ne))});const X=Array.from(ke);t.info("Template refresh successful",{sourceFile:so,functionName:H,templateCount:ue.length,tagsCount:X.length,templates:ue.map(we=>({title:we.title,tags:we.tags,source:we.source}))}),N(X),I(ue)}catch(te){t.error("Error refreshing templates from server",te,{sourceFile:so,functionName:H}),console.error("Template loading failed:",te)}finally{B(!1)}},[O,t]),U=()=>{v(!p)},ge=H=>{b(te=>te.includes(H)?te.filter(Se=>Se!==H):[...te,H])},ie=H=>{K(te=>te===H?null:H)},[ae,de]=w.useState(!1),J=w.useRef(null),Y=w.useRef(null);w.useEffect(()=>{function H(te){ae&&J.current&&!J.current.contains(te.target)&&Y.current&&!Y.current.contains(te.target)&&de(!1)}return document.addEventListener("mousedown",H),()=>{document.removeEventListener("mousedown",H)}},[ae]);const $=()=>{de(!ae)},Q=H=>{T(H),de(!1)};return n==="chrome"&&!s?u.jsx("div",{className:"p-4",children:u.jsx(r0,{feature:"Templates",description:"Connect your Gmail account to access and insert email templates",benefits:["Access all your personal and organization templates","Insert template content directly into compose box","Search and filter templates by tags and content"]})}):u.jsxs("div",{className:"space-y-4 h-full",children:[u.jsxs("div",{className:"relative",children:[u.jsx(pn,{type:"text",placeholder:"Search templates...",value:i,onChange:H=>c(H.target.value),className:"pl-10 pr-12"}),u.jsx(Ii,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:18}),u.jsx(Ye,{ref:se,variant:"outline",className:"absolute right-0 top-1/2 transform -translate-y-1/2",onClick:U,children:u.jsx(Yx,{})}),p&&u.jsx("div",{ref:re,className:"absolute right-0 mt-2 w-48 bg-white dark:bg-card border dark:border-border rounded shadow-lg z-10",children:S.length>0?S.map(H=>u.jsxs("label",{className:"block px-4 py-2 hover:bg-gray-50 dark:hover:bg-muted cursor-pointer text-gray-900 dark:text-gray-200",children:[u.jsx("input",{type:"checkbox",className:"mr-2",checked:x.includes(H),onChange:()=>ge(H)}),H]},H)):u.jsx("div",{className:"px-4 py-2 text-gray-500",children:"No tags available"})})]}),u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"relative",children:[u.jsxs(Ye,{ref:Y,variant:"outline",size:"sm",onClick:$,className:"flex items-center hover:bg-blue-50",children:[E==="all"&&u.jsxs(u.Fragment,{children:[u.jsx(Yx,{className:"mr-2 h-4 w-4"}),"All Templates (",d.length,")"]}),E==="personal"&&u.jsxs(u.Fragment,{children:[u.jsx(Ey,{className:"mr-2 h-4 w-4"}),"Personal Only (",d.length,")"]}),E==="org"&&u.jsxs(u.Fragment,{children:[u.jsx(Kx,{className:"mr-2 h-4 w-4"}),"Org Only (",d.length,")"]})]}),ae&&u.jsxs("div",{ref:J,className:"absolute left-0 mt-1 w-40 bg-white dark:bg-card border dark:border-border rounded shadow-lg z-10",children:[E!=="all"&&u.jsxs("div",{className:"px-4 py-2 hover:bg-gray-50 dark:hover:bg-muted cursor-pointer flex items-center text-gray-900 dark:text-gray-200",onClick:()=>Q("all"),children:[u.jsx(Yx,{className:"mr-2 h-4 w-4"}),"All Templates"]}),E!=="personal"&&u.jsxs("div",{className:"px-4 py-2 hover:bg-gray-50 dark:hover:bg-muted cursor-pointer flex items-center text-gray-900 dark:text-gray-200",onClick:()=>Q("personal"),children:[u.jsx(Ey,{className:"mr-2 h-4 w-4"}),"Personal Only"]}),E!=="org"&&A.filter(H=>H.source==="org").length>0&&u.jsxs("div",{className:"px-4 py-2 hover:bg-gray-50 dark:hover:bg-muted cursor-pointer flex items-center text-gray-900 dark:text-gray-200",onClick:()=>Q("org"),children:[u.jsx(Kx,{className:"mr-2 h-4 w-4"}),"Org Only"]})]})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(Ye,{size:"icon",className:"rounded-lg bg-blue-600 text-white hover:bg-blue-700 hover:text-white dark:bg-blue-600 dark:text-white dark:hover:bg-blue-700 border border-blue-600 dark:border-blue-600",title:"Add Template",onClick:()=>{GC(t,{signalType:"openCreateTemplate",signalValue:"true"})},children:u.jsx(oB,{className:"w-5 h-5"})}),u.jsx(Ye,{variant:"outline",size:"icon",className:"rounded-lg hover:bg-blue-50",title:"Refresh Templates",onClick:he,disabled:O||D,children:u.jsx(si,{className:`w-5 h-5 ${O?"animate-spin":""}`})})]})]}),D?u.jsxs("div",{className:"flex justify-center items-center py-12",children:[u.jsx(ia,{className:"h-8 w-8 animate-spin text-blue-600"}),u.jsx("span",{className:"ml-2 text-gray-600",children:"Loading templates..."})]}):u.jsxs("div",{className:"overflow-y-auto h-full pb-2",children:[d.map(H=>u.jsxs(Es,{className:"animate-fadeIn relative mb-2",children:[u.jsxs(lo,{children:[u.jsx(co,{className:"text-sm flex items-center",children:H.title}),H.tags&&H.tags.length>0&&u.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:H.tags.map((te,Se)=>u.jsx("span",{className:"inline-block bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full",children:te},Se))})]}),u.jsxs(ks,{children:[u.jsx("p",{className:"text-xs mb-2 overflow-hidden text-ellipsis max-h-[50px]",children:H.description}),u.jsxs("div",{className:"flex space-x-2",children:[u.jsx(Ye,{className:"flex-1 text-xs py-1 bg-blue-600 text-white hover:bg-blue-700 hover:text-white dark:bg-blue-600 dark:text-white dark:hover:bg-blue-700 w-1/2 border border-blue-600 dark:border-blue-600",onClick:()=>{gS(H.content,t)},children:u.jsxs("span",{className:"flex items-center justify-center w-full",children:[u.jsx(XA,{className:"w-4 h-4 flex-shrink-0 mr-1 rotate-90"}),u.jsx("span",{className:"hide-text-when-narrow",children:"Insert"})]})}),u.jsxs(m7,{open:G===H.id?!0:void 0,onOpenChange:te=>{!te&&G===H.id&&K(null)},openDelay:0,closeDelay:100,children:[u.jsx(g7,{asChild:!0,children:u.jsx(Ye,{variant:"outline",className:`text-xs py-1 bg-white dark:bg-card text-black dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-muted hover:text-blue-600 dark:hover:text-blue-400 w-1/4 ${G===H.id?"bg-gray-100 dark:bg-muted text-blue-600 dark:text-blue-400":""}`,onClick:te=>{te.preventDefault(),ie(H.id)},children:u.jsxs("span",{className:"flex items-center justify-center w-full",children:[u.jsx(lB,{className:"w-4 h-4 flex-shrink-0 mr-1"}),u.jsx("span",{className:"hide-text-when-narrow",children:"View"})]})})}),u.jsxs(v7,{className:"bg-white dark:bg-card border-2 mt-8 mr-8 border-gray-200 dark:border-border rounded-md text-gray-700 dark:text-gray-200 p-4 z-50 overflow-auto",align:"center",side:"top",style:{maxHeight:"40vh",maxWidth:"80vw",width:"auto",height:"auto",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.15)"},children:[u.jsx("div",{dangerouslySetInnerHTML:{__html:H.content}}),u.jsx(y7,{className:"fill-blue-500"})]})]}),H.source==="org"?u.jsx("div",{className:"w-1/4 flex items-center",title:"Organization templates can only be edited by an admin.",children:u.jsxs("span",{className:"text-xs py-1 px-2 bg-blue-100 text-blue-800 border border-blue-300 flex items-center justify-center w-full rounded-full",children:[u.jsx(Kx,{className:"w-4 h-4 flex-shrink-0 mr-1"}),u.jsx("span",{className:"hide-text-when-narrow",children:"Org"})]})}):u.jsx(Ye,{variant:"outline",className:"text-xs py-1 bg-white dark:bg-card text-black dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-muted w-1/4",title:"Edit Template",onClick:()=>{GC(t,{signalType:"editTemplateId",signalValue:H.id})},children:u.jsxs("span",{className:"flex items-center justify-center w-full",children:[u.jsx(mB,{className:"w-4 h-4 flex-shrink-0 mr-1"}),u.jsx("span",{className:"hide-text-when-narrow",children:"Edit"})]})})]})]})]},H.id)),d.length===0&&u.jsxs("div",{className:"mt-8 text-center text-gray-500",children:[u.jsx("p",{children:"No templates found matching your criteria."}),u.jsx("p",{className:"text-sm mt-2",children:"Try adjusting your filters or search terms."})]})]})]})},Ai=({src:r,width:e,height:t,alt:n,className:s})=>{const i=r.startsWith("/")?`${B1}${r}`:r;return u.jsx("img",{src:i,width:e,height:t,alt:n,className:s})},lh=({options:r,value:e,onChange:t})=>u.jsx("div",{className:"flex rounded-md shadow-sm",role:"radiogroup",children:r.map(n=>u.jsx(Ye,{role:"radio","aria-checked":e===n,variant:e===n?"default":"outline",className:`flex-1 text-xs ${e===n?"":"text-muted-foreground"}`,onClick:()=>t(n),children:n},n))});/*! @license DOMPurify 3.3.1 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.1/LICENSE */const{entries:OI,setPrototypeOf:WC,isFrozen:S7,getPrototypeOf:E7,getOwnPropertyDescriptor:k7}=Object;let{freeze:uo,seal:Fi,create:hb}=Object,{apply:pb,construct:mb}=typeof Reflect<"u"&&Reflect;uo||(uo=function(e){return e});Fi||(Fi=function(e){return e});pb||(pb=function(e,t){for(var n=arguments.length,s=new Array(n>2?n-2:0),i=2;i<n;i++)s[i-2]=arguments[i];return e.apply(t,s)});mb||(mb=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];return new e(...n)});const Ov=fo(Array.prototype.forEach),C7=fo(Array.prototype.lastIndexOf),VC=fo(Array.prototype.pop),rm=fo(Array.prototype.push),N7=fo(Array.prototype.splice),Xv=fo(String.prototype.toLowerCase),Zx=fo(String.prototype.toString),ew=fo(String.prototype.match),nm=fo(String.prototype.replace),T7=fo(String.prototype.indexOf),A7=fo(String.prototype.trim),sa=fo(Object.prototype.hasOwnProperty),oo=fo(RegExp.prototype.test),sm=I7(TypeError);function fo(r){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];return pb(r,e,n)}}function I7(r){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return mb(r,t)}}function dr(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Xv;WC&&WC(r,null);let n=e.length;for(;n--;){let s=e[n];if(typeof s=="string"){const i=t(s);i!==s&&(S7(e)||(e[n]=i),s=i)}r[s]=!0}return r}function R7(r){for(let e=0;e<r.length;e++)sa(r,e)||(r[e]=null);return r}function Ua(r){const e=hb(null);for(const[t,n]of OI(r))sa(r,t)&&(Array.isArray(n)?e[t]=R7(n):n&&typeof n=="object"&&n.constructor===Object?e[t]=Ua(n):e[t]=n);return e}function om(r,e){for(;r!==null;){const n=k7(r,e);if(n){if(n.get)return fo(n.get);if(typeof n.value=="function")return fo(n.value)}r=E7(r)}function t(){return null}return t}const qC=uo(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),tw=uo(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),rw=uo(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),P7=uo(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),nw=uo(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),j7=uo(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),KC=uo(["#text"]),YC=uo(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),sw=uo(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),JC=uo(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Dv=uo(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),F7=Fi(/\{\{[\w\W]*|[\w\W]*\}\}/gm),O7=Fi(/<%[\w\W]*|[\w\W]*%>/gm),D7=Fi(/\$\{[\w\W]*/gm),L7=Fi(/^data-[\-\w.\u00B7-\uFFFF]+$/),M7=Fi(/^aria-[\-\w]+$/),DI=Fi(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),$7=Fi(/^(?:\w+script|data):/i),U7=Fi(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),LI=Fi(/^html$/i),z7=Fi(/^[a-z][.\w]*(-[.\w]+)+$/i);var XC=Object.freeze({__proto__:null,ARIA_ATTR:M7,ATTR_WHITESPACE:U7,CUSTOM_ELEMENT:z7,DATA_ATTR:L7,DOCTYPE_NAME:LI,ERB_EXPR:O7,IS_ALLOWED_URI:DI,IS_SCRIPT_OR_DATA:$7,MUSTACHE_EXPR:F7,TMPLIT_EXPR:D7});const im={element:1,text:3,progressingInstruction:7,comment:8,document:9},H7=function(){return typeof window>"u"?null:window},B7=function(e,t){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let n=null;const s="data-tt-policy-suffix";t&&t.hasAttribute(s)&&(n=t.getAttribute(s));const i="dompurify"+(n?"#"+n:"");try{return e.createPolicy(i,{createHTML(c){return c},createScriptURL(c){return c}})}catch{return console.warn("TrustedTypes policy "+i+" could not be created."),null}},QC=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function MI(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:H7();const e=Be=>MI(Be);if(e.version="3.3.1",e.removed=[],!r||!r.document||r.document.nodeType!==im.document||!r.Element)return e.isSupported=!1,e;let{document:t}=r;const n=t,s=n.currentScript,{DocumentFragment:i,HTMLTemplateElement:c,Node:d,Element:m,NodeFilter:p,NamedNodeMap:v=r.NamedNodeMap||r.MozNamedAttrMap,HTMLFormElement:x,DOMParser:b,trustedTypes:S}=r,N=m.prototype,E=om(N,"cloneNode"),T=om(N,"remove"),A=om(N,"nextSibling"),I=om(N,"childNodes"),D=om(N,"parentNode");if(typeof c=="function"){const Be=t.createElement("template");Be.content&&Be.content.ownerDocument&&(t=Be.content.ownerDocument)}let j,O="";const{implementation:B,createNodeIterator:G,createDocumentFragment:K,getElementsByTagName:re}=t,{importNode:se}=n;let he=QC();e.isSupported=typeof OI=="function"&&typeof D=="function"&&B&&B.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:U,ERB_EXPR:ge,TMPLIT_EXPR:ie,DATA_ATTR:ae,ARIA_ATTR:de,IS_SCRIPT_OR_DATA:J,ATTR_WHITESPACE:Y,CUSTOM_ELEMENT:$}=XC;let{IS_ALLOWED_URI:Q}=XC,F=null;const H=dr({},[...qC,...tw,...rw,...nw,...KC]);let te=null;const Se=dr({},[...YC,...sw,...JC,...Dv]);let ue=Object.seal(hb(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),ke=null,X=null;const we=Object.seal(hb(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let Ne=!0,Me=!0,St=!1,Te=!0,Ge=!1,Ee=!0,ye=!1,Ke=!1,qe=!1,ft=!1,mt=!1,jt=!1,ut=!0,Jt=!1;const Or="user-content-";let jr=!0,Nr=!1,me={},je=null;const ht=dr({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let wt=null;const We=dr({},["audio","video","img","source","image","track"]);let Ve=null;const lt=dr({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Pe="http://www.w3.org/1998/Math/MathML",kt="http://www.w3.org/2000/svg",Ft="http://www.w3.org/1999/xhtml";let $e=Ft,cr=!1,Ut=null;const lr=dr({},[Pe,kt,Ft],Zx);let Wt=dr({},["mi","mo","mn","ms","mtext"]),Zt=dr({},["annotation-xml"]);const _n=dr({},["title","style","font","a","script"]);let Un=null;const Oo=["application/xhtml+xml","text/html"],Jn="text/html";let _r=null,gn=null;const po=t.createElement("form"),Do=function(q){return q instanceof RegExp||q instanceof Function},Sn=function(){let q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(gn&&gn===q)){if((!q||typeof q!="object")&&(q={}),q=Ua(q),Un=Oo.indexOf(q.PARSER_MEDIA_TYPE)===-1?Jn:q.PARSER_MEDIA_TYPE,_r=Un==="application/xhtml+xml"?Zx:Xv,F=sa(q,"ALLOWED_TAGS")?dr({},q.ALLOWED_TAGS,_r):H,te=sa(q,"ALLOWED_ATTR")?dr({},q.ALLOWED_ATTR,_r):Se,Ut=sa(q,"ALLOWED_NAMESPACES")?dr({},q.ALLOWED_NAMESPACES,Zx):lr,Ve=sa(q,"ADD_URI_SAFE_ATTR")?dr(Ua(lt),q.ADD_URI_SAFE_ATTR,_r):lt,wt=sa(q,"ADD_DATA_URI_TAGS")?dr(Ua(We),q.ADD_DATA_URI_TAGS,_r):We,je=sa(q,"FORBID_CONTENTS")?dr({},q.FORBID_CONTENTS,_r):ht,ke=sa(q,"FORBID_TAGS")?dr({},q.FORBID_TAGS,_r):Ua({}),X=sa(q,"FORBID_ATTR")?dr({},q.FORBID_ATTR,_r):Ua({}),me=sa(q,"USE_PROFILES")?q.USE_PROFILES:!1,Ne=q.ALLOW_ARIA_ATTR!==!1,Me=q.ALLOW_DATA_ATTR!==!1,St=q.ALLOW_UNKNOWN_PROTOCOLS||!1,Te=q.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Ge=q.SAFE_FOR_TEMPLATES||!1,Ee=q.SAFE_FOR_XML!==!1,ye=q.WHOLE_DOCUMENT||!1,ft=q.RETURN_DOM||!1,mt=q.RETURN_DOM_FRAGMENT||!1,jt=q.RETURN_TRUSTED_TYPE||!1,qe=q.FORCE_BODY||!1,ut=q.SANITIZE_DOM!==!1,Jt=q.SANITIZE_NAMED_PROPS||!1,jr=q.KEEP_CONTENT!==!1,Nr=q.IN_PLACE||!1,Q=q.ALLOWED_URI_REGEXP||DI,$e=q.NAMESPACE||Ft,Wt=q.MATHML_TEXT_INTEGRATION_POINTS||Wt,Zt=q.HTML_INTEGRATION_POINTS||Zt,ue=q.CUSTOM_ELEMENT_HANDLING||{},q.CUSTOM_ELEMENT_HANDLING&&Do(q.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(ue.tagNameCheck=q.CUSTOM_ELEMENT_HANDLING.tagNameCheck),q.CUSTOM_ELEMENT_HANDLING&&Do(q.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(ue.attributeNameCheck=q.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),q.CUSTOM_ELEMENT_HANDLING&&typeof q.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(ue.allowCustomizedBuiltInElements=q.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Ge&&(Me=!1),mt&&(ft=!0),me&&(F=dr({},KC),te=[],me.html===!0&&(dr(F,qC),dr(te,YC)),me.svg===!0&&(dr(F,tw),dr(te,sw),dr(te,Dv)),me.svgFilters===!0&&(dr(F,rw),dr(te,sw),dr(te,Dv)),me.mathMl===!0&&(dr(F,nw),dr(te,JC),dr(te,Dv))),q.ADD_TAGS&&(typeof q.ADD_TAGS=="function"?we.tagCheck=q.ADD_TAGS:(F===H&&(F=Ua(F)),dr(F,q.ADD_TAGS,_r))),q.ADD_ATTR&&(typeof q.ADD_ATTR=="function"?we.attributeCheck=q.ADD_ATTR:(te===Se&&(te=Ua(te)),dr(te,q.ADD_ATTR,_r))),q.ADD_URI_SAFE_ATTR&&dr(Ve,q.ADD_URI_SAFE_ATTR,_r),q.FORBID_CONTENTS&&(je===ht&&(je=Ua(je)),dr(je,q.FORBID_CONTENTS,_r)),q.ADD_FORBID_CONTENTS&&(je===ht&&(je=Ua(je)),dr(je,q.ADD_FORBID_CONTENTS,_r)),jr&&(F["#text"]=!0),ye&&dr(F,["html","head","body"]),F.table&&(dr(F,["tbody"]),delete ke.tbody),q.TRUSTED_TYPES_POLICY){if(typeof q.TRUSTED_TYPES_POLICY.createHTML!="function")throw sm('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof q.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw sm('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');j=q.TRUSTED_TYPES_POLICY,O=j.createHTML("")}else j===void 0&&(j=B7(S,s)),j!==null&&typeof O=="string"&&(O=j.createHTML(""));uo&&uo(q),gn=q}},Gs=dr({},[...tw,...rw,...P7]),Ws=dr({},[...nw,...j7]),Li=function(q){let De=D(q);(!De||!De.tagName)&&(De={namespaceURI:$e,tagName:"template"});const Qe=Xv(q.tagName),Tr=Xv(De.tagName);return Ut[q.namespaceURI]?q.namespaceURI===kt?De.namespaceURI===Ft?Qe==="svg":De.namespaceURI===Pe?Qe==="svg"&&(Tr==="annotation-xml"||Wt[Tr]):!!Gs[Qe]:q.namespaceURI===Pe?De.namespaceURI===Ft?Qe==="math":De.namespaceURI===kt?Qe==="math"&&Zt[Tr]:!!Ws[Qe]:q.namespaceURI===Ft?De.namespaceURI===kt&&!Zt[Tr]||De.namespaceURI===Pe&&!Wt[Tr]?!1:!Ws[Qe]&&(_n[Qe]||!Gs[Qe]):!!(Un==="application/xhtml+xml"&&Ut[q.namespaceURI]):!1},ln=function(q){rm(e.removed,{element:q});try{D(q).removeChild(q)}catch{T(q)}},zn=function(q,De){try{rm(e.removed,{attribute:De.getAttributeNode(q),from:De})}catch{rm(e.removed,{attribute:null,from:De})}if(De.removeAttribute(q),q==="is")if(ft||mt)try{ln(De)}catch{}else try{De.setAttribute(q,"")}catch{}},Pn=function(q){let De=null,Qe=null;if(qe)q="<remove></remove>"+q;else{const Br=ew(q,/^[\r\n\t ]+/);Qe=Br&&Br[0]}Un==="application/xhtml+xml"&&$e===Ft&&(q='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+q+"</body></html>");const Tr=j?j.createHTML(q):q;if($e===Ft)try{De=new b().parseFromString(Tr,Un)}catch{}if(!De||!De.documentElement){De=B.createDocument($e,"template",null);try{De.documentElement.innerHTML=cr?O:Tr}catch{}}const Xt=De.body||De.documentElement;return q&&Qe&&Xt.insertBefore(t.createTextNode(Qe),Xt.childNodes[0]||null),$e===Ft?re.call(De,ye?"html":"body")[0]:ye?De.documentElement:Xt},le=function(q){return G.call(q.ownerDocument||q,q,p.SHOW_ELEMENT|p.SHOW_COMMENT|p.SHOW_TEXT|p.SHOW_PROCESSING_INSTRUCTION|p.SHOW_CDATA_SECTION,null)},tt=function(q){return q instanceof x&&(typeof q.nodeName!="string"||typeof q.textContent!="string"||typeof q.removeChild!="function"||!(q.attributes instanceof v)||typeof q.removeAttribute!="function"||typeof q.setAttribute!="function"||typeof q.namespaceURI!="string"||typeof q.insertBefore!="function"||typeof q.hasChildNodes!="function")},Tt=function(q){return typeof d=="function"&&q instanceof d};function dt(Be,q,De){Ov(Be,Qe=>{Qe.call(e,q,De,gn)})}const ot=function(q){let De=null;if(dt(he.beforeSanitizeElements,q,null),tt(q))return ln(q),!0;const Qe=_r(q.nodeName);if(dt(he.uponSanitizeElement,q,{tagName:Qe,allowedTags:F}),Ee&&q.hasChildNodes()&&!Tt(q.firstElementChild)&&oo(/<[/\w!]/g,q.innerHTML)&&oo(/<[/\w!]/g,q.textContent)||q.nodeType===im.progressingInstruction||Ee&&q.nodeType===im.comment&&oo(/<[/\w]/g,q.data))return ln(q),!0;if(!(we.tagCheck instanceof Function&&we.tagCheck(Qe))&&(!F[Qe]||ke[Qe])){if(!ke[Qe]&&_t(Qe)&&(ue.tagNameCheck instanceof RegExp&&oo(ue.tagNameCheck,Qe)||ue.tagNameCheck instanceof Function&&ue.tagNameCheck(Qe)))return!1;if(jr&&!je[Qe]){const Tr=D(q)||q.parentNode,Xt=I(q)||q.childNodes;if(Xt&&Tr){const Br=Xt.length;for(let cn=Br-1;cn>=0;--cn){const ds=E(Xt[cn],!0);ds.__removalCount=(q.__removalCount||0)+1,Tr.insertBefore(ds,A(q))}}}return ln(q),!0}return q instanceof m&&!Li(q)||(Qe==="noscript"||Qe==="noembed"||Qe==="noframes")&&oo(/<\/no(script|embed|frames)/i,q.innerHTML)?(ln(q),!0):(Ge&&q.nodeType===im.text&&(De=q.textContent,Ov([U,ge,ie],Tr=>{De=nm(De,Tr," ")}),q.textContent!==De&&(rm(e.removed,{element:q.cloneNode()}),q.textContent=De)),dt(he.afterSanitizeElements,q,null),!1)},Vt=function(q,De,Qe){if(ut&&(De==="id"||De==="name")&&(Qe in t||Qe in po))return!1;if(!(Me&&!X[De]&&oo(ae,De))){if(!(Ne&&oo(de,De))){if(!(we.attributeCheck instanceof Function&&we.attributeCheck(De,q))){if(!te[De]||X[De]){if(!(_t(q)&&(ue.tagNameCheck instanceof RegExp&&oo(ue.tagNameCheck,q)||ue.tagNameCheck instanceof Function&&ue.tagNameCheck(q))&&(ue.attributeNameCheck instanceof RegExp&&oo(ue.attributeNameCheck,De)||ue.attributeNameCheck instanceof Function&&ue.attributeNameCheck(De,q))||De==="is"&&ue.allowCustomizedBuiltInElements&&(ue.tagNameCheck instanceof RegExp&&oo(ue.tagNameCheck,Qe)||ue.tagNameCheck instanceof Function&&ue.tagNameCheck(Qe))))return!1}else if(!Ve[De]){if(!oo(Q,nm(Qe,Y,""))){if(!((De==="src"||De==="xlink:href"||De==="href")&&q!=="script"&&T7(Qe,"data:")===0&&wt[q])){if(!(St&&!oo(J,nm(Qe,Y,"")))){if(Qe)return!1}}}}}}}return!0},_t=function(q){return q!=="annotation-xml"&&ew(q,$)},Qt=function(q){dt(he.beforeSanitizeAttributes,q,null);const{attributes:De}=q;if(!De||tt(q))return;const Qe={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:te,forceKeepAttr:void 0};let Tr=De.length;for(;Tr--;){const Xt=De[Tr],{name:Br,namespaceURI:cn,value:ds}=Xt,Cs=_r(Br),Mi=ds;let Gr=Br==="value"?Mi:A7(Mi);if(Qe.attrName=Cs,Qe.attrValue=Gr,Qe.keepAttr=!0,Qe.forceKeepAttr=void 0,dt(he.uponSanitizeAttribute,q,Qe),Gr=Qe.attrValue,Jt&&(Cs==="id"||Cs==="name")&&(zn(Br,q),Gr=Or+Gr),Ee&&oo(/((--!?|])>)|<\/(style|title|textarea)/i,Gr)){zn(Br,q);continue}if(Cs==="attributename"&&ew(Gr,"href")){zn(Br,q);continue}if(Qe.forceKeepAttr)continue;if(!Qe.keepAttr){zn(Br,q);continue}if(!Te&&oo(/\/>/i,Gr)){zn(Br,q);continue}Ge&&Ov([U,ge,ie],Xn=>{Gr=nm(Gr,Xn," ")});const Lo=_r(q.nodeName);if(!Vt(Lo,Cs,Gr)){zn(Br,q);continue}if(j&&typeof S=="object"&&typeof S.getAttributeType=="function"&&!cn)switch(S.getAttributeType(Lo,Cs)){case"TrustedHTML":{Gr=j.createHTML(Gr);break}case"TrustedScriptURL":{Gr=j.createScriptURL(Gr);break}}if(Gr!==Mi)try{cn?q.setAttributeNS(cn,Br,Gr):q.setAttribute(Br,Gr),tt(q)?ln(q):VC(e.removed)}catch{zn(Br,q)}}dt(he.afterSanitizeAttributes,q,null)},En=function Be(q){let De=null;const Qe=le(q);for(dt(he.beforeSanitizeShadowDOM,q,null);De=Qe.nextNode();)dt(he.uponSanitizeShadowNode,De,null),ot(De),Qt(De),De.content instanceof i&&Be(De.content);dt(he.afterSanitizeShadowDOM,q,null)};return e.sanitize=function(Be){let q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},De=null,Qe=null,Tr=null,Xt=null;if(cr=!Be,cr&&(Be="<!-->"),typeof Be!="string"&&!Tt(Be))if(typeof Be.toString=="function"){if(Be=Be.toString(),typeof Be!="string")throw sm("dirty is not a string, aborting")}else throw sm("toString is not a function");if(!e.isSupported)return Be;if(Ke||Sn(q),e.removed=[],typeof Be=="string"&&(Nr=!1),Nr){if(Be.nodeName){const ds=_r(Be.nodeName);if(!F[ds]||ke[ds])throw sm("root node is forbidden and cannot be sanitized in-place")}}else if(Be instanceof d)De=Pn("<!---->"),Qe=De.ownerDocument.importNode(Be,!0),Qe.nodeType===im.element&&Qe.nodeName==="BODY"||Qe.nodeName==="HTML"?De=Qe:De.appendChild(Qe);else{if(!ft&&!Ge&&!ye&&Be.indexOf("<")===-1)return j&&jt?j.createHTML(Be):Be;if(De=Pn(Be),!De)return ft?null:jt?O:""}De&&qe&&ln(De.firstChild);const Br=le(Nr?Be:De);for(;Tr=Br.nextNode();)ot(Tr),Qt(Tr),Tr.content instanceof i&&En(Tr.content);if(Nr)return Be;if(ft){if(mt)for(Xt=K.call(De.ownerDocument);De.firstChild;)Xt.appendChild(De.firstChild);else Xt=De;return(te.shadowroot||te.shadowrootmode)&&(Xt=se.call(n,Xt,!0)),Xt}let cn=ye?De.outerHTML:De.innerHTML;return ye&&F["!doctype"]&&De.ownerDocument&&De.ownerDocument.doctype&&De.ownerDocument.doctype.name&&oo(LI,De.ownerDocument.doctype.name)&&(cn="<!DOCTYPE "+De.ownerDocument.doctype.name+`>
`+cn),Ge&&Ov([U,ge,ie],ds=>{cn=nm(cn,ds," ")}),j&&jt?j.createHTML(cn):cn},e.setConfig=function(){let Be=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Sn(Be),Ke=!0},e.clearConfig=function(){gn=null,Ke=!1},e.isValidAttribute=function(Be,q,De){gn||Sn({});const Qe=_r(Be),Tr=_r(q);return Vt(Qe,Tr,De)},e.addHook=function(Be,q){typeof q=="function"&&rm(he[Be],q)},e.removeHook=function(Be,q){if(q!==void 0){const De=C7(he[Be],q);return De===-1?void 0:N7(he[Be],De,1)[0]}return VC(he[Be])},e.removeHooks=function(Be){he[Be]=[]},e.removeAllHooks=function(){he=QC()},e}var vS=MI();const Qv=r=>{var s;const e=r.replace(/^```html\s*/,""),t=document.createElement("div");return t.innerHTML=e.replace(/style="[^"]*"/g,""),(((s=t.textContent)==null?void 0:s.replace(/(\n{2,}|[ \t]+\n+|\n+[ \t]+)/g,`
`))||"").trim()},gb=r=>r.replace(/&quot;/g,'"').replace(/\\"/g,'"').replace(/\\n/g,`
`).replace(/\n{3,}/g,`

`).replace(/\\n/g,`
`).replace(/\\'/g,"'").replace(/\\"/g,'"').replace(/\\\\/g,"\\").replace(/```html/g,"").replace(/```/g,"").replace(/^"/,"").replace(/"$/,"").replace(/\u2019/g,"'").replace(/\u2018/g,"'").replace(/\u201A/g,"'").replace(/\u201B/g,"'"),$I=({htmlString:r})=>{const e=()=>({__html:vS.sanitize(r,{USE_PROFILES:{html:!0}})});return u.jsx("div",{className:"rich-text-content text-gray-800 dark:text-gray-200",style:{fontSize:"14px",lineHeight:"1.6",fontFamily:"Arial, sans-serif"},dangerouslySetInnerHTML:e()})},UI=w.forwardRef(({value:r,onChange:e,className:t,...n},s)=>{const i=w.useRef(null);w.useImperativeHandle(s,()=>i.current);const c=()=>{const d=i.current;d&&(d.style.height="auto",d.style.height=`${d.scrollHeight}px`)};return w.useEffect(()=>{c()},[r]),u.jsx("textarea",{ref:i,value:r,onChange:d=>{e&&e(d)},className:`auto-resizing-textarea ${t||""}`,...n})});UI.displayName="AutoResizingTextarea";var G7=Sb[" useId ".trim().toString()]||(()=>{}),W7=0;function ql(r){const[e,t]=w.useState(G7());return Yl(()=>{t(n=>n??String(W7++))},[r]),e?`radix-${e}`:""}var ow="focusScope.autoFocusOnMount",iw="focusScope.autoFocusOnUnmount",ZC={bubbles:!1,cancelable:!0},V7="FocusScope",yS=w.forwardRef((r,e)=>{const{loop:t=!1,trapped:n=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...c}=r,[d,m]=w.useState(null),p=Ql(s),v=Ql(i),x=w.useRef(null),b=$n(e,E=>m(E)),S=w.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;w.useEffect(()=>{if(n){let E=function(D){if(S.paused||!d)return;const j=D.target;d.contains(j)?x.current=j:Hc(x.current,{select:!0})},T=function(D){if(S.paused||!d)return;const j=D.relatedTarget;j!==null&&(d.contains(j)||Hc(x.current,{select:!0}))},A=function(D){if(document.activeElement===document.body)for(const O of D)O.removedNodes.length>0&&Hc(d)};document.addEventListener("focusin",E),document.addEventListener("focusout",T);const I=new MutationObserver(A);return d&&I.observe(d,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",E),document.removeEventListener("focusout",T),I.disconnect()}}},[n,d,S.paused]),w.useEffect(()=>{if(d){tN.add(S);const E=document.activeElement;if(!d.contains(E)){const A=new CustomEvent(ow,ZC);d.addEventListener(ow,p),d.dispatchEvent(A),A.defaultPrevented||(q7(Q7(zI(d)),{select:!0}),document.activeElement===E&&Hc(d))}return()=>{d.removeEventListener(ow,p),setTimeout(()=>{const A=new CustomEvent(iw,ZC);d.addEventListener(iw,v),d.dispatchEvent(A),A.defaultPrevented||Hc(E??document.body,{select:!0}),d.removeEventListener(iw,v),tN.remove(S)},0)}}},[d,p,v,S]);const N=w.useCallback(E=>{if(!t&&!n||S.paused)return;const T=E.key==="Tab"&&!E.altKey&&!E.ctrlKey&&!E.metaKey,A=document.activeElement;if(T&&A){const I=E.currentTarget,[D,j]=K7(I);D&&j?!E.shiftKey&&A===j?(E.preventDefault(),t&&Hc(D,{select:!0})):E.shiftKey&&A===D&&(E.preventDefault(),t&&Hc(j,{select:!0})):A===I&&E.preventDefault()}},[t,n,S.paused]);return u.jsx(Ur.div,{tabIndex:-1,...c,ref:b,onKeyDown:N})});yS.displayName=V7;function q7(r,{select:e=!1}={}){const t=document.activeElement;for(const n of r)if(Hc(n,{select:e}),document.activeElement!==t)return}function K7(r){const e=zI(r),t=eN(e,r),n=eN(e.reverse(),r);return[t,n]}function zI(r){const e=[],t=document.createTreeWalker(r,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const s=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||s?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;t.nextNode();)e.push(t.currentNode);return e}function eN(r,e){for(const t of r)if(!Y7(t,{upTo:e}))return t}function Y7(r,{upTo:e}){if(getComputedStyle(r).visibility==="hidden")return!0;for(;r;){if(e!==void 0&&r===e)return!1;if(getComputedStyle(r).display==="none")return!0;r=r.parentElement}return!1}function J7(r){return r instanceof HTMLInputElement&&"select"in r}function Hc(r,{select:e=!1}={}){if(r&&r.focus){const t=document.activeElement;r.focus({preventScroll:!0}),r!==t&&J7(r)&&e&&r.select()}}var tN=X7();function X7(){let r=[];return{add(e){const t=r[0];e!==t&&(t==null||t.pause()),r=rN(r,e),r.unshift(e)},remove(e){var t;r=rN(r,e),(t=r[0])==null||t.resume()}}}function rN(r,e){const t=[...r],n=t.indexOf(e);return n!==-1&&t.splice(n,1),t}function Q7(r){return r.filter(e=>e.tagName!=="A")}var aw=0;function HI(){w.useEffect(()=>{const r=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",r[0]??nN()),document.body.insertAdjacentElement("beforeend",r[1]??nN()),aw++,()=>{aw===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),aw--}},[])}function nN(){const r=document.createElement("span");return r.setAttribute("data-radix-focus-guard",""),r.tabIndex=0,r.style.outline="none",r.style.opacity="0",r.style.position="fixed",r.style.pointerEvents="none",r}var Zv="right-scroll-bar-position",ey="width-before-scroll-bar",Z7="with-scroll-bars-hidden",eW="--removed-body-scroll-bar-size";function lw(r,e){return typeof r=="function"?r(e):r&&(r.current=e),r}function tW(r,e){var t=w.useState(function(){return{value:r,callback:e,facade:{get current(){return t.value},set current(n){var s=t.value;s!==n&&(t.value=n,t.callback(n,s))}}}})[0];return t.callback=e,t.facade}var rW=typeof window<"u"?w.useLayoutEffect:w.useEffect,sN=new WeakMap;function nW(r,e){var t=tW(null,function(n){return r.forEach(function(s){return lw(s,n)})});return rW(function(){var n=sN.get(t);if(n){var s=new Set(n),i=new Set(r),c=t.current;s.forEach(function(d){i.has(d)||lw(d,null)}),i.forEach(function(d){s.has(d)||lw(d,c)})}sN.set(t,r)},[r]),t}function sW(r){return r}function oW(r,e){e===void 0&&(e=sW);var t=[],n=!1,s={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return t.length?t[t.length-1]:r},useMedium:function(i){var c=e(i,n);return t.push(c),function(){t=t.filter(function(d){return d!==c})}},assignSyncMedium:function(i){for(n=!0;t.length;){var c=t;t=[],c.forEach(i)}t={push:function(d){return i(d)},filter:function(){return t}}},assignMedium:function(i){n=!0;var c=[];if(t.length){var d=t;t=[],d.forEach(i),c=t}var m=function(){var v=c;c=[],v.forEach(i)},p=function(){return Promise.resolve().then(m)};p(),t={push:function(v){c.push(v),p()},filter:function(v){return c=c.filter(v),t}}}};return s}function iW(r){r===void 0&&(r={});var e=oW(null);return e.options=Ha({async:!0,ssr:!1},r),e}var BI=function(r){var e=r.sideCar,t=N1(r,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=e.read();if(!n)throw new Error("Sidecar medium not found");return w.createElement(n,Ha({},t))};BI.isSideCarExport=!0;function aW(r,e){return r.useMedium(e),BI}var GI=iW(),cw=function(){},n0=w.forwardRef(function(r,e){var t=w.useRef(null),n=w.useState({onScrollCapture:cw,onWheelCapture:cw,onTouchMoveCapture:cw}),s=n[0],i=n[1],c=r.forwardProps,d=r.children,m=r.className,p=r.removeScrollBar,v=r.enabled,x=r.shards,b=r.sideCar,S=r.noRelative,N=r.noIsolation,E=r.inert,T=r.allowPinchZoom,A=r.as,I=A===void 0?"div":A,D=r.gapMode,j=N1(r,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),O=b,B=nW([t,e]),G=Ha(Ha({},j),s);return w.createElement(w.Fragment,null,v&&w.createElement(O,{sideCar:GI,removeScrollBar:p,shards:x,noRelative:S,noIsolation:N,inert:E,setCallbacks:i,allowPinchZoom:!!T,lockRef:t,gapMode:D}),c?w.cloneElement(w.Children.only(d),Ha(Ha({},G),{ref:B})):w.createElement(I,Ha({},G,{className:m,ref:B}),d))});n0.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};n0.classNames={fullWidth:ey,zeroRight:Zv};var lW=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function cW(){if(!document)return null;var r=document.createElement("style");r.type="text/css";var e=lW();return e&&r.setAttribute("nonce",e),r}function uW(r,e){r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}function dW(r){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(r)}var fW=function(){var r=0,e=null;return{add:function(t){r==0&&(e=cW())&&(uW(e,t),dW(e)),r++},remove:function(){r--,!r&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},hW=function(){var r=fW();return function(e,t){w.useEffect(function(){return r.add(e),function(){r.remove()}},[e&&t])}},WI=function(){var r=hW(),e=function(t){var n=t.styles,s=t.dynamic;return r(n,s),null};return e},pW={left:0,top:0,right:0,gap:0},uw=function(r){return parseInt(r||"",10)||0},mW=function(r){var e=window.getComputedStyle(document.body),t=e[r==="padding"?"paddingLeft":"marginLeft"],n=e[r==="padding"?"paddingTop":"marginTop"],s=e[r==="padding"?"paddingRight":"marginRight"];return[uw(t),uw(n),uw(s)]},gW=function(r){if(r===void 0&&(r="margin"),typeof window>"u")return pW;var e=mW(r),t=document.documentElement.clientWidth,n=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,n-t+e[2]-e[0])}},vW=WI(),ch="data-scroll-locked",yW=function(r,e,t,n){var s=r.left,i=r.top,c=r.right,d=r.gap;return t===void 0&&(t="margin"),`
  .`.concat(Z7,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(d,"px ").concat(n,`;
  }
  body[`).concat(ch,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(n,";"),t==="margin"&&`
    padding-left: `.concat(s,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(c,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(d,"px ").concat(n,`;
    `),t==="padding"&&"padding-right: ".concat(d,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Zv,` {
    right: `).concat(d,"px ").concat(n,`;
  }
  
  .`).concat(ey,` {
    margin-right: `).concat(d,"px ").concat(n,`;
  }
  
  .`).concat(Zv," .").concat(Zv,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(ey," .").concat(ey,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(ch,`] {
    `).concat(eW,": ").concat(d,`px;
  }
`)},oN=function(){var r=parseInt(document.body.getAttribute(ch)||"0",10);return isFinite(r)?r:0},xW=function(){w.useEffect(function(){return document.body.setAttribute(ch,(oN()+1).toString()),function(){var r=oN()-1;r<=0?document.body.removeAttribute(ch):document.body.setAttribute(ch,r.toString())}},[])},wW=function(r){var e=r.noRelative,t=r.noImportant,n=r.gapMode,s=n===void 0?"margin":n;xW();var i=w.useMemo(function(){return gW(s)},[s]);return w.createElement(vW,{styles:yW(i,!e,s,t?"":"!important")})},vb=!1;if(typeof window<"u")try{var Lv=Object.defineProperty({},"passive",{get:function(){return vb=!0,!0}});window.addEventListener("test",Lv,Lv),window.removeEventListener("test",Lv,Lv)}catch{vb=!1}var Hf=vb?{passive:!1}:!1,bW=function(r){return r.tagName==="TEXTAREA"},VI=function(r,e){if(!(r instanceof Element))return!1;var t=window.getComputedStyle(r);return t[e]!=="hidden"&&!(t.overflowY===t.overflowX&&!bW(r)&&t[e]==="visible")},_W=function(r){return VI(r,"overflowY")},SW=function(r){return VI(r,"overflowX")},iN=function(r,e){var t=e.ownerDocument,n=e;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var s=qI(r,n);if(s){var i=KI(r,n),c=i[1],d=i[2];if(c>d)return!0}n=n.parentNode}while(n&&n!==t.body);return!1},EW=function(r){var e=r.scrollTop,t=r.scrollHeight,n=r.clientHeight;return[e,t,n]},kW=function(r){var e=r.scrollLeft,t=r.scrollWidth,n=r.clientWidth;return[e,t,n]},qI=function(r,e){return r==="v"?_W(e):SW(e)},KI=function(r,e){return r==="v"?EW(e):kW(e)},CW=function(r,e){return r==="h"&&e==="rtl"?-1:1},NW=function(r,e,t,n,s){var i=CW(r,window.getComputedStyle(e).direction),c=i*n,d=t.target,m=e.contains(d),p=!1,v=c>0,x=0,b=0;do{if(!d)break;var S=KI(r,d),N=S[0],E=S[1],T=S[2],A=E-T-i*N;(N||A)&&qI(r,d)&&(x+=A,b+=N);var I=d.parentNode;d=I&&I.nodeType===Node.DOCUMENT_FRAGMENT_NODE?I.host:I}while(!m&&d!==document.body||m&&(e.contains(d)||e===d));return(v&&Math.abs(x)<1||!v&&Math.abs(b)<1)&&(p=!0),p},Mv=function(r){return"changedTouches"in r?[r.changedTouches[0].clientX,r.changedTouches[0].clientY]:[0,0]},aN=function(r){return[r.deltaX,r.deltaY]},lN=function(r){return r&&"current"in r?r.current:r},TW=function(r,e){return r[0]===e[0]&&r[1]===e[1]},AW=function(r){return`
  .block-interactivity-`.concat(r,` {pointer-events: none;}
  .allow-interactivity-`).concat(r,` {pointer-events: all;}
`)},IW=0,Bf=[];function RW(r){var e=w.useRef([]),t=w.useRef([0,0]),n=w.useRef(),s=w.useState(IW++)[0],i=w.useState(WI)[0],c=w.useRef(r);w.useEffect(function(){c.current=r},[r]),w.useEffect(function(){if(r.inert){document.body.classList.add("block-interactivity-".concat(s));var E=WM([r.lockRef.current],(r.shards||[]).map(lN),!0).filter(Boolean);return E.forEach(function(T){return T.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),E.forEach(function(T){return T.classList.remove("allow-interactivity-".concat(s))})}}},[r.inert,r.lockRef.current,r.shards]);var d=w.useCallback(function(E,T){if("touches"in E&&E.touches.length===2||E.type==="wheel"&&E.ctrlKey)return!c.current.allowPinchZoom;var A=Mv(E),I=t.current,D="deltaX"in E?E.deltaX:I[0]-A[0],j="deltaY"in E?E.deltaY:I[1]-A[1],O,B=E.target,G=Math.abs(D)>Math.abs(j)?"h":"v";if("touches"in E&&G==="h"&&B.type==="range")return!1;var K=window.getSelection(),re=K&&K.anchorNode,se=re?re===B||re.contains(B):!1;if(se)return!1;var he=iN(G,B);if(!he)return!0;if(he?O=G:(O=G==="v"?"h":"v",he=iN(G,B)),!he)return!1;if(!n.current&&"changedTouches"in E&&(D||j)&&(n.current=O),!O)return!0;var U=n.current||O;return NW(U,T,E,U==="h"?D:j)},[]),m=w.useCallback(function(E){var T=E;if(!(!Bf.length||Bf[Bf.length-1]!==i)){var A="deltaY"in T?aN(T):Mv(T),I=e.current.filter(function(O){return O.name===T.type&&(O.target===T.target||T.target===O.shadowParent)&&TW(O.delta,A)})[0];if(I&&I.should){T.cancelable&&T.preventDefault();return}if(!I){var D=(c.current.shards||[]).map(lN).filter(Boolean).filter(function(O){return O.contains(T.target)}),j=D.length>0?d(T,D[0]):!c.current.noIsolation;j&&T.cancelable&&T.preventDefault()}}},[]),p=w.useCallback(function(E,T,A,I){var D={name:E,delta:T,target:A,should:I,shadowParent:PW(A)};e.current.push(D),setTimeout(function(){e.current=e.current.filter(function(j){return j!==D})},1)},[]),v=w.useCallback(function(E){t.current=Mv(E),n.current=void 0},[]),x=w.useCallback(function(E){p(E.type,aN(E),E.target,d(E,r.lockRef.current))},[]),b=w.useCallback(function(E){p(E.type,Mv(E),E.target,d(E,r.lockRef.current))},[]);w.useEffect(function(){return Bf.push(i),r.setCallbacks({onScrollCapture:x,onWheelCapture:x,onTouchMoveCapture:b}),document.addEventListener("wheel",m,Hf),document.addEventListener("touchmove",m,Hf),document.addEventListener("touchstart",v,Hf),function(){Bf=Bf.filter(function(E){return E!==i}),document.removeEventListener("wheel",m,Hf),document.removeEventListener("touchmove",m,Hf),document.removeEventListener("touchstart",v,Hf)}},[]);var S=r.removeScrollBar,N=r.inert;return w.createElement(w.Fragment,null,N?w.createElement(i,{styles:AW(s)}):null,S?w.createElement(wW,{noRelative:r.noRelative,gapMode:r.gapMode}):null)}function PW(r){for(var e=null;r!==null;)r instanceof ShadowRoot&&(e=r.host,r=r.host),r=r.parentNode;return e}const jW=aW(GI,RW);var xS=w.forwardRef(function(r,e){return w.createElement(n0,Ha({},r,{ref:e,sideCar:jW}))});xS.classNames=n0.classNames;var FW=function(r){if(typeof document>"u")return null;var e=Array.isArray(r)?r[0]:r;return e.ownerDocument.body},Gf=new WeakMap,$v=new WeakMap,Uv={},dw=0,YI=function(r){return r&&(r.host||YI(r.parentNode))},OW=function(r,e){return e.map(function(t){if(r.contains(t))return t;var n=YI(t);return n&&r.contains(n)?n:(console.error("aria-hidden",t,"in not contained inside",r,". Doing nothing"),null)}).filter(function(t){return!!t})},DW=function(r,e,t,n){var s=OW(e,Array.isArray(r)?r:[r]);Uv[t]||(Uv[t]=new WeakMap);var i=Uv[t],c=[],d=new Set,m=new Set(s),p=function(x){!x||d.has(x)||(d.add(x),p(x.parentNode))};s.forEach(p);var v=function(x){!x||m.has(x)||Array.prototype.forEach.call(x.children,function(b){if(d.has(b))v(b);else try{var S=b.getAttribute(n),N=S!==null&&S!=="false",E=(Gf.get(b)||0)+1,T=(i.get(b)||0)+1;Gf.set(b,E),i.set(b,T),c.push(b),E===1&&N&&$v.set(b,!0),T===1&&b.setAttribute(t,"true"),N||b.setAttribute(n,"true")}catch(A){console.error("aria-hidden: cannot operate on ",b,A)}})};return v(e),d.clear(),dw++,function(){c.forEach(function(x){var b=Gf.get(x)-1,S=i.get(x)-1;Gf.set(x,b),i.set(x,S),b||($v.has(x)||x.removeAttribute(n),$v.delete(x)),S||x.removeAttribute(t)}),dw--,dw||(Gf=new WeakMap,Gf=new WeakMap,$v=new WeakMap,Uv={})}},JI=function(r,e,t){t===void 0&&(t="data-aria-hidden");var n=Array.from(Array.isArray(r)?r:[r]),s=FW(r);return s?(n.push.apply(n,Array.from(s.querySelectorAll("[aria-live], script"))),DW(n,s,t,"aria-hidden")):function(){return null}};function LW(r){const e=MW(r),t=w.forwardRef((n,s)=>{const{children:i,...c}=n,d=w.Children.toArray(i),m=d.find(UW);if(m){const p=m.props.children,v=d.map(x=>x===m?w.Children.count(p)>1?w.Children.only(null):w.isValidElement(p)?p.props.children:null:x);return u.jsx(e,{...c,ref:s,children:w.isValidElement(p)?w.cloneElement(p,void 0,v):null})}return u.jsx(e,{...c,ref:s,children:i})});return t.displayName=`${r}.Slot`,t}function MW(r){const e=w.forwardRef((t,n)=>{const{children:s,...i}=t;if(w.isValidElement(s)){const c=HW(s),d=zW(i,s.props);return s.type!==w.Fragment&&(d.ref=n?nu(n,c):c),w.cloneElement(s,d)}return w.Children.count(s)>1?w.Children.only(null):null});return e.displayName=`${r}.SlotClone`,e}var $W=Symbol("radix.slottable");function UW(r){return w.isValidElement(r)&&typeof r.type=="function"&&"__radixId"in r.type&&r.type.__radixId===$W}function zW(r,e){const t={...e};for(const n in e){const s=r[n],i=e[n];/^on[A-Z]/.test(n)?s&&i?t[n]=(...d)=>{const m=i(...d);return s(...d),m}:s&&(t[n]=s):n==="style"?t[n]={...s,...i}:n==="className"&&(t[n]=[s,i].filter(Boolean).join(" "))}return{...r,...t}}function HW(r){var n,s;let e=(n=Object.getOwnPropertyDescriptor(r.props,"ref"))==null?void 0:n.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=(s=Object.getOwnPropertyDescriptor(r,"ref"))==null?void 0:s.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}var s0="Dialog",[XI]=Za(s0),[BW,fa]=XI(s0),QI=r=>{const{__scopeDialog:e,children:t,open:n,defaultOpen:s,onOpenChange:i,modal:c=!0}=r,d=w.useRef(null),m=w.useRef(null),[p,v]=su({prop:n,defaultProp:s??!1,onChange:i,caller:s0});return u.jsx(BW,{scope:e,triggerRef:d,contentRef:m,contentId:ql(),titleId:ql(),descriptionId:ql(),open:p,onOpenChange:v,onOpenToggle:w.useCallback(()=>v(x=>!x),[v]),modal:c,children:t})};QI.displayName=s0;var ZI="DialogTrigger",GW=w.forwardRef((r,e)=>{const{__scopeDialog:t,...n}=r,s=fa(ZI,t),i=$n(e,s.triggerRef);return u.jsx(Ur.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":_S(s.open),...n,ref:i,onClick:$t(r.onClick,s.onOpenToggle)})});GW.displayName=ZI;var wS="DialogPortal",[WW,eR]=XI(wS,{forceMount:void 0}),tR=r=>{const{__scopeDialog:e,forceMount:t,children:n,container:s}=r,i=fa(wS,e);return u.jsx(WW,{scope:e,forceMount:t,children:w.Children.map(n,c=>u.jsx(da,{present:t||i.open,children:u.jsx(pS,{asChild:!0,container:s,children:c})}))})};tR.displayName=wS;var Ry="DialogOverlay",rR=w.forwardRef((r,e)=>{const t=eR(Ry,r.__scopeDialog),{forceMount:n=t.forceMount,...s}=r,i=fa(Ry,r.__scopeDialog);return i.modal?u.jsx(da,{present:n||i.open,children:u.jsx(qW,{...s,ref:e})}):null});rR.displayName=Ry;var VW=LW("DialogOverlay.RemoveScroll"),qW=w.forwardRef((r,e)=>{const{__scopeDialog:t,...n}=r,s=fa(Ry,t);return u.jsx(xS,{as:VW,allowPinchZoom:!0,shards:[s.contentRef],children:u.jsx(Ur.div,{"data-state":_S(s.open),...n,ref:e,style:{pointerEvents:"auto",...n.style}})})}),hd="DialogContent",nR=w.forwardRef((r,e)=>{const t=eR(hd,r.__scopeDialog),{forceMount:n=t.forceMount,...s}=r,i=fa(hd,r.__scopeDialog);return u.jsx(da,{present:n||i.open,children:i.modal?u.jsx(KW,{...s,ref:e}):u.jsx(YW,{...s,ref:e})})});nR.displayName=hd;var KW=w.forwardRef((r,e)=>{const t=fa(hd,r.__scopeDialog),n=w.useRef(null),s=$n(e,t.contentRef,n);return w.useEffect(()=>{const i=n.current;if(i)return JI(i)},[]),u.jsx(sR,{...r,ref:s,trapFocus:t.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:$t(r.onCloseAutoFocus,i=>{var c;i.preventDefault(),(c=t.triggerRef.current)==null||c.focus()}),onPointerDownOutside:$t(r.onPointerDownOutside,i=>{const c=i.detail.originalEvent,d=c.button===0&&c.ctrlKey===!0;(c.button===2||d)&&i.preventDefault()}),onFocusOutside:$t(r.onFocusOutside,i=>i.preventDefault())})}),YW=w.forwardRef((r,e)=>{const t=fa(hd,r.__scopeDialog),n=w.useRef(!1),s=w.useRef(!1);return u.jsx(sR,{...r,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var c,d;(c=r.onCloseAutoFocus)==null||c.call(r,i),i.defaultPrevented||(n.current||(d=t.triggerRef.current)==null||d.focus(),i.preventDefault()),n.current=!1,s.current=!1},onInteractOutside:i=>{var m,p;(m=r.onInteractOutside)==null||m.call(r,i),i.defaultPrevented||(n.current=!0,i.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const c=i.target;((p=t.triggerRef.current)==null?void 0:p.contains(c))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&s.current&&i.preventDefault()}})}),sR=w.forwardRef((r,e)=>{const{__scopeDialog:t,trapFocus:n,onOpenAutoFocus:s,onCloseAutoFocus:i,...c}=r,d=fa(hd,t),m=w.useRef(null),p=$n(e,m);return HI(),u.jsxs(u.Fragment,{children:[u.jsx(yS,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:s,onUnmountAutoFocus:i,children:u.jsx(Zy,{role:"dialog",id:d.contentId,"aria-describedby":d.descriptionId,"aria-labelledby":d.titleId,"data-state":_S(d.open),...c,ref:p,onDismiss:()=>d.onOpenChange(!1)})}),u.jsxs(u.Fragment,{children:[u.jsx(JW,{titleId:d.titleId}),u.jsx(QW,{contentRef:m,descriptionId:d.descriptionId})]})]})}),bS="DialogTitle",oR=w.forwardRef((r,e)=>{const{__scopeDialog:t,...n}=r,s=fa(bS,t);return u.jsx(Ur.h2,{id:s.titleId,...n,ref:e})});oR.displayName=bS;var iR="DialogDescription",aR=w.forwardRef((r,e)=>{const{__scopeDialog:t,...n}=r,s=fa(iR,t);return u.jsx(Ur.p,{id:s.descriptionId,...n,ref:e})});aR.displayName=iR;var lR="DialogClose",cR=w.forwardRef((r,e)=>{const{__scopeDialog:t,...n}=r,s=fa(lR,t);return u.jsx(Ur.button,{type:"button",...n,ref:e,onClick:$t(r.onClick,()=>s.onOpenChange(!1))})});cR.displayName=lR;function _S(r){return r?"open":"closed"}var uR="DialogTitleWarning",[FK,dR]=yB(uR,{contentName:hd,titleName:bS,docsSlug:"dialog"}),JW=({titleId:r})=>{const e=dR(uR),t=`\`${e.contentName}\` requires a \`${e.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${e.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${e.docsSlug}`;return w.useEffect(()=>{r&&(document.getElementById(r)||console.error(t))},[t,r]),null},XW="DialogDescriptionWarning",QW=({contentRef:r,descriptionId:e})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${dR(XW).contentName}}.`;return w.useEffect(()=>{var i;const s=(i=r.current)==null?void 0:i.getAttribute("aria-describedby");e&&s&&(document.getElementById(e)||console.warn(n))},[n,r,e]),null},ZW=QI,e9=tR,fR=rR,hR=nR,pR=oR,mR=aR,t9=cR;const r9=ZW,n9=e9,gR=w.forwardRef(({className:r,...e},t)=>u.jsx(fR,{ref:t,className:Fr("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",r),...e}));gR.displayName=fR.displayName;const vR=w.forwardRef(({className:r,children:e,...t},n)=>u.jsxs(n9,{children:[u.jsx(gR,{}),u.jsxs(hR,{ref:n,className:Fr("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",r),...t,children:[e,u.jsxs(t9,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[u.jsx(aa,{className:"h-4 w-4"}),u.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));vR.displayName=hR.displayName;const yR=({className:r,...e})=>u.jsx("div",{className:Fr("flex flex-col space-y-1.5 text-center sm:text-left",r),...e});yR.displayName="DialogHeader";const xR=({className:r,...e})=>u.jsx("div",{className:Fr("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",r),...e});xR.displayName="DialogFooter";const wR=w.forwardRef(({className:r,...e},t)=>u.jsx(pR,{ref:t,className:Fr("text-lg font-semibold leading-none tracking-tight",r),...e}));wR.displayName=pR.displayName;const bR=w.forwardRef(({className:r,...e},t)=>u.jsx(mR,{ref:t,className:Fr("text-sm text-muted-foreground",r),...e}));bR.displayName=mR.displayName;const s9=({isOpen:r,onClose:e,title:t="Gmail Connection Required",description:n="This feature requires an active Gmail connection. Please connect your Gmail account to continue.",actionText:s="the requested action"})=>{const[i,c]=w.useState(!1),{initiateReconnection:d,wasEverConnected:m}=Di(),p=async()=>{c(!0);try{await d(),e()}catch(v){console.error("Failed to reconnect Gmail:",v)}finally{c(!1)}};return u.jsx(r9,{open:r,onOpenChange:e,children:u.jsxs(vR,{className:"sm:max-w-md",children:[u.jsxs(yR,{children:[u.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[u.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:u.jsx(eu,{className:"h-5 w-5 text-blue-600"})}),u.jsx(wR,{className:"text-lg font-semibold",children:t})]}),u.jsx(bR,{className:"text-sm text-gray-600 leading-relaxed",children:n})]}),u.jsx("div",{className:"bg-gray-50 rounded-lg p-4 my-4",children:u.jsxs("div",{className:"flex items-start gap-3",children:[u.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full mt-2 flex-shrink-0"}),u.jsxs("div",{className:"text-sm text-gray-700",children:[u.jsx("p",{className:"font-medium mb-1",children:"What happens next:"}),u.jsxs("p",{children:["You'll be redirected to Gmail's authorization page to ",m?"reconnect":"connect"," your account securely."]})]})]})}),u.jsxs(xR,{className:"flex gap-2 sm:gap-2",children:[u.jsx(Ye,{variant:"outline",onClick:e,disabled:i,className:"flex-1",children:"Cancel"}),u.jsx(Ye,{onClick:p,disabled:i,className:"flex-1 bg-blue-600 hover:bg-blue-700",children:i?u.jsxs(u.Fragment,{children:[u.jsx(si,{className:"h-4 w-4 mr-2 animate-spin"}),"Connecting..."]}):m?"Reconnect Gmail":"Connect Gmail"})]})]})})},sn="src/shared/components/sidepanel/panels/GenerateEmailDraftPanel.tsx",o9=()=>`The response should just be the email body with salutation at the beginning. Do not include a subject line in your response draft. 
    Do not add links to the references in your response draft. Do not add citation numbers in your response draft.
    Do not list the references in your response draft, since they will be added in a different section in the JSON response.
    Do not add a complimentary closing or a signature as this will be added later.`.trim(),i9=(r,e,t)=>{let n="";switch(r){case"Casual":n+="Keep the tone casual. ";break;case"Neutral":n+="Maintain a neutral tone. ";break;case"Formal":n+="Keep the tone formal. ";break}switch(e){case"Low":n+="Show low empathy. ";break;case"Neutral":n+="Maintain neutral empathy. ";break;case"High":n+="Show high empathy. ";break}switch(t){case"Simple":n+="Keep it simple amd use simple words. ";break;case"Neutral":n+="Maintain neutral complexity. ";break;case"Detailed":n+="Provide detailed information and you're free to use harder words. ";break}return n.trim()},a9=({clientEmail:r})=>{const e=Jr(),t=Xa(),n=Qa(),s=mn().platform,{isConnected:i}=Di(),[c,d]=w.useState(!1),[m,p]=w.useState(!1),[v,x]=w.useState(""),b=w.useRef(null),[S,N]=w.useState(!0),[E,T]=w.useState(""),[A,I]=w.useState([]),[D,j]=w.useState(0),[O,B]=w.useState(""),[G,K]=w.useState(!1),[re,se]=w.useState(!0),[he,U]=w.useState(!0),[ge,ie]=w.useState(!0),[ae,de]=w.useState(null),[J,Y]=w.useState(null),[$,Q]=w.useState([]),F=w.useRef(null),[H,te]=w.useState(""),[Se,ue]=w.useState("Neutral"),[ke,X]=w.useState("Neutral"),[we,Ne]=w.useState("Neutral"),Me=w.useRef(null),[St,Te]=w.useState(!1),[Ge,Ee]=w.useState(!1),[ye,Ke]=w.useState([]),[qe,ft]=w.useState(!0),[mt,jt]=w.useState(!1),ut="25dc68db26595a7485917129d6993f96",Jt="c1c8e460f2105029b2b4563f9222161c",Or=["Analyzing email thread...","Pulling relevant information...","Structuring your response...","Preparing personalized reply...","Finalizing your draft..."],jr=w.useCallback(async We=>{const Ve="fetchFromStorageProvider";if(!t)return"";try{const lt=await t.getLocalItem(We);return lt&&e.debug("Loaded additional context from storage",{sourceFile:sn,functionName:Ve}),lt||""}catch(lt){return e.error("Error loading additional context from storage",lt,{sourceFile:sn,functionName:Ve}),""}},[t,e]);w.useEffect(()=>{let We;const Ve=()=>{if(c){const lt=Math.floor(Math.random()*2e3)+1e3;We=setTimeout(()=>{j(Pe=>(Pe+1)%Or.length),Ve()},lt)}};return c&&Ve(),()=>{We&&clearTimeout(We)}},[c,Or.length]),w.useEffect(()=>{const We="useEffect[threadDataListener]";if(!n){e.debug("DataProvider not available yet",{sourceFile:sn,functionName:We});return}const Ve=async Pe=>{const kt=Pe!==null&&Pe.threadId!==F.current;if(Pe){if(e.debug("Thread changed via platform abstraction",{sourceFile:sn,functionName:We,threadId:Pe.threadId,isThreadChanged:kt}),Y(Pe.threadId),Q(Pe.participants||[]),Pe.messages&&Array.isArray(Pe.messages)&&Pe.messages.length>0&&Pe.messages[0]&&typeof Pe.messages[0]=="object"){const $e=Pe.messages.map((Ut,lr)=>({body:Ut.body||Ut.html||"",html:Ut.html||Ut.body||"",from:Ut.from||"",timestamp:Ut.timestamp||"",subject:lr===0&&Pe.subject||""}));de($e);const cr=$e.length>0?Qv($e[0].body):"";B(cr)}if(kt){T(""),I([]),Ke([]),p(!1),d(!1),ue("Neutral"),X("Neutral"),Ne("Neutral"),te("");const $e=`toneSettings_${Pe.threadId}`,cr=await jr($e);if(cr)try{const Ut=JSON.parse(cr),lr=["Casual","Neutral","Formal"],Wt=["Low","Neutral","High"],Zt=["Simple","Neutral","Detailed"];lr.includes(Ut.formality)&&ue(Ut.formality),Wt.includes(Ut.empathy)&&X(Ut.empathy),Zt.includes(Ut.complexity)&&Ne(Ut.complexity)}catch{}}F.current=Pe.threadId;const Ft=`additionalContext_${Pe.threadId}`;te(await jr(Ft))}else{e.debug("Thread cleared via platform abstraction",{sourceFile:sn,functionName:We});const Ft=F.current!==null;Y(null),de(null),Q([]),B(""),T(""),I([]),Ke([]),p(!1),d(!1),Ft&&(te(""),F.current=null)}};return n.onThreadChanged(Ve),(async()=>{try{const Pe=await n.getCurrentThread();await Ve(Pe)}catch(Pe){e.error("Error loading current thread",Pe,{sourceFile:sn,functionName:"loadCurrentThread"})}})(),()=>{n.removeThreadListener(Ve)}},[n,e]),w.useEffect(()=>{const Ve=setTimeout(async()=>{const lt="useEffect[saveAdditionalContext]";if(!(!J||!t))try{const Pe=`additionalContext_${J}`;await t.setLocalItem(Pe,H)}catch(Pe){e.error("Error saving additional context to storage",Pe,{sourceFile:sn,functionName:lt,threadId:J})}},500);return()=>clearTimeout(Ve)},[H,J,t,e]),w.useEffect(()=>{if(!J||!t)return;const Ve=setTimeout(async()=>{try{const lt=`toneSettings_${J}`;await t.setLocalItem(lt,JSON.stringify({formality:Se,empathy:ke,complexity:we}))}catch(lt){e.error("Error saving tone settings to storage",lt,{sourceFile:sn,functionName:"useEffect[saveToneSettings]",threadId:J})}},500);return()=>clearTimeout(Ve)},[Se,ke,we,J,t,e]);const Nr=w.useCallback(async We=>{try{if(!J)return e.debug("No thread ID available for cache check",{sourceFile:sn,functionName:We}),!1;const Ve=me(J),lt=await J5(Ve,e);return lt?(e.debug("Found cached response for thread",{sourceFile:sn,functionName:We,cacheKey:Ve,threadId:J}),T(lt.response),I(lt.references),Ke(lt.cmsData),d(!1),p(!0),!0):(e.debug("No cached response found for thread",{sourceFile:sn,functionName:We,cacheKey:Ve,threadId:J}),!1)}catch(Ve){return e.warn("Error checking for cached response",{sourceFile:sn,functionName:We,error:Ve}),!1}},[J,e]);w.useEffect(()=>{const Ve=setTimeout(async()=>{const lt="checkForCachedResponse";!J||E||c||await Nr(lt)},500);return()=>clearTimeout(Ve)},[J,Nr,E,c]),w.useEffect(()=>{(async()=>{const Ve="checkCachedResponseOnReady";S||!J||!ae||E||c||(e.debug("Component ready, checking for cached response immediately",{sourceFile:sn,functionName:Ve,threadId:J,hasThreadData:!!ae,isLoading:S,hasResponse:!!E}),await Nr(Ve))})()},[S,J,ae,Nr,E,c,e]),w.useEffect(()=>{if(m&&b.current){const We=setTimeout(()=>{var Ve;(Ve=b.current)==null||Ve.focus()},100);return()=>clearTimeout(We)}},[m]),w.useEffect(()=>{const We=async()=>{try{if(!t)return;const Pe=await t.getLocalItem("useUscis");Te(Pe??!1),e.debug("uscisIsEnabled loaded from storage via platform abstraction",{sourceFile:sn,functionName:"initializeUscisState",uscisEnabled:Pe??!1})}catch(Pe){e.error("Error loading USCIS state",Pe,{sourceFile:sn,functionName:"initializeUscisState"})}},Ve=async()=>{try{if(!t)return;const Pe=await t.getLocalItem("useOregon");Ee(Pe??!1),e.debug("oregonIsEnabled loaded from storage via platform abstraction",{sourceFile:sn,functionName:"initializeOregonState",oregonEnabled:Pe??!1})}catch(Pe){e.error("Error loading Oregon state",Pe,{sourceFile:sn,functionName:"initializeOregonState"})}},lt=async Pe=>{try{Pe.useUscis!==void 0&&(Te(Pe.useUscis),e.debug("USCIS setting changed via platform abstraction",{sourceFile:sn,functionName:"handleStorageChange",useUscis:Pe.useUscis})),Pe.useOregon!==void 0&&(Ee(Pe.useOregon),e.debug("Oregon setting changed via platform abstraction",{sourceFile:sn,functionName:"handleStorageChange",useOregon:Pe.useOregon}))}catch(kt){e.error("Error handling storage changes",kt,{sourceFile:sn,functionName:"handleStorageChange"})}};return We(),Ve(),t!=null&&t.onChanged&&t.onChanged(lt),N(!1),()=>{t!=null&&t.removeChangeListener&&lt&&t.removeChangeListener(lt)}},[t,e]),w.useEffect(()=>{if(E&&Me.current){const We=Me.current,lt=(We.scrollHeight-We.clientHeight)*.8;We.scrollTo({top:lt,behavior:"smooth"}),e.debug("Scrolling to 90% of bottom after response generation",{sourceFile:sn,functionName:"useEffect[fullResponse]"})}},[E,e]);const me=We=>`response_${We}`,je=async(We,Ve)=>{d(!0),T("Reformatting..."),p(!1);const lt="regenerateResponse";try{if(!J){e.error("Thread ID is not set for regeneration",void 0,{sourceFile:sn,functionName:lt}),d(!1);return}const Pe=me(J),kt=await IT(Ve,We,e);T(kt),d(!1),p(!0),await vk(Pe,kt,[],[],e)}catch(Pe){e.error("Error regenerating response",Pe,{sourceFile:sn,functionName:lt}),d(!1),p(!0)}},ht=async()=>{if(s==="chrome"&&!i){jt(!0);return}d(!0),p(!1);const We="handleGenerateResponse";try{const Ve=(ae==null?void 0:ae.map(lr=>`From: ${lr.from}
Timestamp: ${lr.timestamp}
Body: ${Qv(lr.body)}

`).join(""))||"",lt=[];if(St&&lt.push(ut),Ge&&lt.push(Jt),!J){e.error("Thread ID is not set",void 0,{sourceFile:sn,functionName:We}),d(!1);return}const Pe=i9(Se,ke,we),kt=o9(),Ft=me(J);let $e;s==="outlook"?$e=await AT(J,Ve,H,Pe,kt,$,e):$e=await TT(J,Ve,H,Pe,kt,lt,e);const cr=$e.response,Ut=gb(cr);T(Ut),I($e.references),Ke($e.cms_data||[]),d(!1),p(!0),await vk(Ft,Ut,$e.references,$e.cms_data||[],e)}catch(Ve){e.error("Error generating response",Ve,{sourceFile:sn,functionName:We}),d(!1)}};return s==="chrome"&&!i?u.jsx("div",{className:"p-4",children:u.jsx(r0,{feature:"Email Composition",description:"Connect your Gmail account to generate personalized email responses",benefits:["Analyze email threads and context automatically","Generate contextually relevant responses","Insert generated content directly into compose box"]})}):u.jsxs("div",{className:"space-y-4 h-full overflow-y-auto overflow-x-hidden",ref:Me,children:[u.jsxs(Es,{className:"overflow-hidden shadow-sm mb-4",children:[u.jsx(lo,{className:"p-3 border-b dark:border-border cursor-pointer",onClick:()=>U(!he),children:u.jsxs("div",{className:"flex items-center justify-between w-full",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx(co,{className:"text-sm font-semibold pr-1",children:"Current Email"}),u.jsxs("div",{className:"relative group",children:[u.jsx(Ai,{src:"/icons/info-circled.svg",width:16,height:16,alt:"Info",className:"h-4 w-4 text-muted-foreground dark:brightness-0 dark:invert"}),u.jsx("div",{className:"absolute left-0 top-full mt-2 w-48 p-2 bg-white dark:bg-gray-800 text-black dark:text-white text-xs rounded shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-opacity z-50 border dark:border-border",children:"This is the email Candle AI is responding to."})]})]}),u.jsx(Ai,{src:"/icons/chevron-down.svg",width:20,height:20,alt:"Chevron down",className:`h-5 w-5 text-muted-foreground dark:brightness-0 dark:invert transition-transform duration-200 ${he?"transform rotate-180":""}`})]})}),he&&u.jsx(ks,{className:"p-0.5",children:u.jsx("textarea",{value:S?"Loading...":ae?Qv(ae[0].body):s==="chrome"&&!i?"Gmail disconnected. Connect Gmail to view email content.":"Please select an email thread",disabled:!0,className:"w-full border dark:border-border rounded p-4 min-h-[100px] text-xs bg-white dark:bg-card text-gray-900 dark:text-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400"})})]}),u.jsxs(Es,{className:"overflow-hidden shadow-sm mb-4",children:[u.jsx(lo,{className:"p-3 border-b dark:border-border cursor-pointer",onClick:()=>se(!re),children:u.jsxs("div",{className:"flex items-center justify-between w-full",children:[u.jsx(co,{className:"text-sm font-semibold",children:"Anything specific you want the response to include?"}),u.jsx(Ai,{src:"/icons/chevron-down.svg",width:20,height:20,alt:"Chevron down",className:`h-5 w-5 text-muted-foreground dark:brightness-0 dark:invert transition-transform duration-200 ${re?"transform rotate-180":""}`})]})}),re&&u.jsx(ks,{className:"p-0.5",children:u.jsx("textarea",{className:"w-full border dark:border-border rounded p-4 min-h-[100px] text-sm bg-white dark:bg-card text-gray-900 dark:text-gray-200 placeholder:text-gray-400 dark:placeholder:text-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400",placeholder:`Examples: 'This client's visa is expiring soon. Suggest they renew it soon.'
'Respond in Spanish.'`,value:H,onChange:We=>te(We.target.value)})})]}),u.jsxs(Es,{className:"overflow-hidden shadow-sm mb-4",children:[u.jsx(lo,{className:"p-3 border-b dark:border-border cursor-pointer",onClick:()=>K(!G),children:u.jsxs("div",{className:"flex items-center justify-between w-full",children:[u.jsx(co,{className:"text-sm font-semibold",children:"Tone"}),u.jsx(Ai,{src:"/icons/chevron-down.svg",width:20,height:20,alt:"Chevron down",className:`h-5 w-5 text-muted-foreground dark:brightness-0 dark:invert transition-transform duration-200 ${G?"transform rotate-180":""}`})]})}),G&&u.jsxs(ks,{className:"p-4 space-y-4",children:[u.jsxs("div",{className:"space-y-2",children:[u.jsx("p",{className:"text-xs font-semibold text-neutral-700 dark:text-gray-300",children:"Formality"}),u.jsx(lh,{options:["Casual","Neutral","Formal"],value:Se,onChange:ue})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("p",{className:"text-xs font-semibold text-neutral-700 dark:text-gray-300",children:"Empathy"}),u.jsx(lh,{options:["Low","Neutral","High"],value:ke,onChange:X})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("p",{className:"text-xs font-semibold text-neutral-700 dark:text-gray-300",children:"Complexity"}),u.jsx(lh,{options:["Simple","Neutral","Detailed"],value:we,onChange:Ne})]})]})]}),u.jsx(Ye,{className:"w-full bg-blue-600 hover:bg-blue-700 text-white py-4 mt-2",onClick:ht,disabled:c||!J&&s!=="chrome"||s==="chrome"&&!i&&!J,children:c?"Generating...":s==="chrome"&&!i?"Connect Gmail to Generate Response":J?"Generate Response":"Select a thread"}),c&&u.jsxs("div",{className:"flex flex-col items-center justify-center",children:[u.jsx(ia,{className:"h-8 w-8 animate-spin text-blue-600"}),u.jsx("p",{className:"mt-2 text-sm text-gray-500",children:Or[D]})]}),u.jsxs("div",{className:"mb-24",children:[u.jsx(s9,{isOpen:mt,onClose:()=>jt(!1),title:"Gmail Connection Required",description:"Generate Response requires an active Gmail connection to analyze your email thread and create personalized responses.",actionText:"generate email responses"}),E&&!c&&u.jsxs(Es,{className:"animate-slide-fade-in mb-2 origin-top",children:[u.jsx(lo,{className:"p-3 border-b dark:border-border cursor-pointer",children:u.jsxs(co,{className:"flex items-center py-0 my-0 text-sm font-semibold",children:[u.jsx(Ai,{src:"/icons/email-icon.svg",width:16,height:16,alt:"Generated Response",className:"h-4 w-4 text-muted-foreground dark:brightness-0 dark:invert mr-2"}),u.jsx("p",{className:"text-sm font-semibold",children:"Generated Response"}),u.jsxs(Ye,{className:"ml-auto bg-blue-600 hover:bg-blue-700 text-white",size:"sm",onClick:()=>{gS(vS.sanitize(E),e)},children:[u.jsx(XA,{className:"w-4 h-4 flex-shrink-0 mr-1 rotate-90"}),"Insert"]})]})}),u.jsx(ks,{className:"p-6",children:u.jsx($I,{htmlString:E})})]}),m&&u.jsx("div",{className:"animate-fadeIn mb-2",children:u.jsxs("div",{className:"rounded-lg border-2 border-neutral-200 dark:border-border bg-neutral-50/50 dark:bg-card/50 overflow-hidden transition-all duration-200 focus-within:!border-blue-500 dark:focus-within:!border-blue-400 focus-within:ring-2 focus-within:ring-blue-500/20 dark:focus-within:ring-blue-400/20 focus-within:bg-white dark:focus-within:bg-card",children:[u.jsx("div",{className:"p-3 bg-white dark:bg-card",children:u.jsx(UI,{ref:b,placeholder:"Customize this response",value:v,className:"text-sm w-full bg-transparent text-gray-900 dark:text-gray-200 !border-0 !ring-0 !outline-none focus:!border-0 focus:!ring-0 focus:!outline-none focus-visible:!ring-0 focus-visible:!ring-offset-0 focus-visible:!outline-none min-h-[40px] max-h-40 py-0 px-0 placeholder:text-neutral-400 dark:placeholder:text-gray-500 resize-none",onChange:We=>x(We.target.value),onKeyDown:We=>{We.key==="Enter"&&!We.shiftKey&&v.trim()&&(We.preventDefault(),je(v,E),x(""))}})}),u.jsx("div",{className:"h-[1px] bg-neutral-200 dark:bg-border"}),u.jsxs("div",{className:"flex gap-0 bg-white dark:bg-card border-t dark:border-border",children:[u.jsx(Ye,{onClick:()=>{je("More empathetic",E)},variant:"ghost",className:"flex-1 rounded-none text-xs text-neutral-700 dark:text-gray-300 hover:bg-neutral-50 dark:hover:bg-muted py-2.5 h-auto font-normal",children:"More empathetic"}),u.jsx("div",{className:"w-[1px] bg-neutral-200 dark:bg-border my-1.5"}),u.jsx(Ye,{onClick:()=>{je("Make it shorter",E)},variant:"ghost",className:"flex-1 rounded-none text-xs text-neutral-700 dark:text-gray-300 hover:bg-neutral-50 dark:hover:bg-muted py-2.5 h-auto font-normal",children:"Make it shorter"}),u.jsx("div",{className:"w-[1px] bg-neutral-200 dark:bg-border my-1.5"}),u.jsx(Ye,{onClick:()=>{v&&(je(v,E),x(""))},disabled:!v.trim(),size:"icon",className:"h-auto w-12 rounded-none bg-blue-600 text-white hover:bg-blue-700 disabled:bg-blue-600/50 disabled:text-white/90 disabled:cursor-not-allowed transition-all duration-200",children:u.jsx(nB,{className:"h-4 w-4"})})]})]})})]})]})},l9=({isOpen:r,onToggle:e,value:t,onChange:n,onRefine:s,onRefineInstructionChange:i,hasGeneratedResponse:c=!1})=>{const[d,m]=w.useState(""),p=c&&!!s,v=p?d:t,x=N=>{p?(m(N),i==null||i(N)):n(N)},b=()=>{d.trim()&&s&&(s(d.trim()),m(""))},S=N=>{N.key==="Enter"&&!N.shiftKey&&d.trim()&&(N.preventDefault(),b())};return u.jsxs(Es,{className:"overflow-hidden shadow-sm mb-4",children:[u.jsx(lo,{className:"p-3 border-b dark:border-border cursor-pointer",onClick:e,role:"button","aria-expanded":r,tabIndex:0,onKeyDown:N=>{(N.key==="Enter"||N.key===" ")&&(N.preventDefault(),e())},children:u.jsxs("div",{className:"flex items-center justify-between w-full",children:[u.jsx("div",{className:"flex items-center gap-2",children:u.jsx(co,{className:"text-sm font-semibold",children:p?u.jsxs(u.Fragment,{children:["Refine this draft"," ",u.jsx("span",{className:"text-gray-500 dark:text-gray-300 text-xs",children:"Optional"})]}):"Additional context"})}),u.jsx(Ai,{src:"/icons/chevron-down.svg",width:20,height:20,alt:"Chevron down",className:`h-5 w-5 text-muted-foreground dark:brightness-0 dark:invert transition-transform duration-200 ${r?"transform rotate-180":""}`})]})}),r&&u.jsxs(ks,{className:"p-2",children:[u.jsx("div",{className:"rounded-lg border-2 border-neutral-200 dark:border-border bg-neutral-50/50 dark:bg-card/50 overflow-hidden transition-all duration-200 focus-within:!border-blue-500 dark:focus-within:!border-blue-400 focus-within:ring-2 focus-within:ring-blue-500/20 dark:focus-within:ring-blue-400/20 focus-within:bg-white dark:focus-within:bg-card",children:u.jsx("div",{className:"p-3 bg-white dark:bg-card",children:u.jsx("textarea",{className:"text-sm w-full bg-transparent text-gray-900 dark:text-gray-200 !border-0 !ring-0 !outline-none focus:!border-0 focus:!ring-0 focus:!outline-none focus-visible:!ring-0 focus-visible:!ring-offset-0 focus-visible:!outline-none min-h-[100px] max-h-40 py-0 px-0 placeholder:text-neutral-400 dark:placeholder:text-gray-500 resize-none",placeholder:"Anything specific you want to change or add to the draft?","aria-label":"Additional context for draft generation",value:v,onChange:N=>x(N.target.value),onKeyDown:p?S:void 0})})}),u.jsx("div",{className:"pb-3 pt-2",children:u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:'Examples: "Make this shorter." "Respond in Spanish." "Mention our meeting tomorrow."'})})]})]})},c9=({isOpen:r,onToggle:e,formality:t,empathy:n,complexity:s,onFormalityChange:i,onEmpathyChange:c,onComplexityChange:d})=>u.jsxs(Es,{className:"overflow-hidden shadow-sm mb-4",children:[u.jsx(lo,{className:"p-3 border-b dark:border-border cursor-pointer",onClick:e,role:"button","aria-expanded":r,tabIndex:0,onKeyDown:m=>{(m.key==="Enter"||m.key===" ")&&(m.preventDefault(),e())},children:u.jsxs("div",{className:"flex items-center justify-between w-full",children:[u.jsxs(co,{className:"text-sm font-semibold",children:["Adjust tone ",u.jsx("span",{className:"text-gray-500 dark:text-gray-300 text-xs",children:"Optional"})]}),u.jsx(Ai,{src:"/icons/chevron-down.svg",width:20,height:20,alt:"Chevron down",className:`h-5 w-5 text-muted-foreground dark:brightness-0 dark:invert transition-transform duration-200 ${r?"transform rotate-180":""}`})]})}),r&&u.jsxs(ks,{className:"p-4 space-y-4",children:[u.jsxs("div",{className:"space-y-2",children:[u.jsx("p",{className:"text-xs font-semibold text-neutral-700 dark:text-gray-300",children:"Formality"}),u.jsx(lh,{options:["Casual","Neutral","Formal"],value:t,onChange:m=>i(m)})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("p",{className:"text-xs font-semibold text-neutral-700 dark:text-gray-300",children:"Empathy"}),u.jsx(lh,{options:["Low","Neutral","High"],value:n,onChange:m=>c(m)})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("p",{className:"text-xs font-semibold text-neutral-700 dark:text-gray-300",children:"Complexity"}),u.jsx(lh,{options:["Simple","Neutral","Detailed"],value:s,onChange:m=>d(m)})]})]})]}),u9={loading:"Checking for updated information",success:"Case information refreshed just now","no-changes":"No updates found. Draft is up to date.",error:"Couldnt check for updates right now. Draft unchanged."},d9=({fullResponse:r,isGenerating:e,hasError:t,onInsert:n,onRefresh:s,onCreateDraft:i,refreshStatus:c,isRefreshed:d,hasPendingChanges:m,onApplyChanges:p,showApplySuccess:v})=>{if(t&&!r&&!e)return u.jsx(Es,{className:"mb-2",children:u.jsxs(ks,{className:"p-6 text-center",children:[u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4",children:"Draft not available yet."}),u.jsx(Ye,{className:"bg-blue-600 hover:bg-blue-700 text-white",onClick:i,children:"Create draft"})]})});if(e)return u.jsxs(Es,{className:"mb-2",children:[u.jsx(lo,{className:"p-3 border-b dark:border-border",children:u.jsxs(co,{className:"flex items-center py-0 my-0 text-sm font-semibold",children:[u.jsx(Ai,{src:"/icons/email-icon.svg",width:16,height:16,alt:"Draft",className:"h-4 w-4 text-muted-foreground dark:brightness-0 dark:invert mr-2"}),u.jsx("p",{className:"text-sm font-semibold",children:"Draft"})]})}),u.jsxs(ks,{className:"p-6",children:[u.jsxs("div",{className:"space-y-3 animate-pulse",role:"status","aria-label":"Loading draft",children:[u.jsx("div",{className:"h-3 bg-gray-200 dark:bg-gray-700 rounded w-3/4"}),u.jsx("div",{className:"h-3 bg-gray-200 dark:bg-gray-700 rounded w-full"}),u.jsx("div",{className:"h-3 bg-gray-200 dark:bg-gray-700 rounded w-5/6"}),u.jsx("div",{className:"h-3 bg-gray-200 dark:bg-gray-700 rounded w-2/3"})]}),u.jsxs("div",{className:"flex items-center justify-center mt-4",children:[u.jsx(ia,{className:"h-4 w-4 animate-spin text-blue-600 mr-2"}),u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Preparing your draft"})]})]})]});if(!r)return null;const x=c!=="idle"?u9[c]:d?"Case information refreshed":null;return u.jsxs(Es,{className:"animate-slide-fade-in mb-2 origin-top",children:[u.jsx(lo,{className:"p-3 border-b dark:border-border",children:u.jsxs(co,{className:"flex items-center py-0 my-0 text-sm font-semibold",children:[u.jsx(Ai,{src:"/icons/email-icon.svg",width:16,height:16,alt:"Draft",className:"h-4 w-4 text-muted-foreground dark:brightness-0 dark:invert mr-2"}),u.jsx("p",{className:"text-sm font-semibold",children:"Draft"}),u.jsxs(Ye,{className:"ml-auto bg-blue-600 hover:bg-blue-700 text-white",size:"sm",onClick:n,children:[u.jsx(rB,{className:"w-4 h-4 flex-shrink-0 mr-1"}),"Insert"]})]})}),u.jsxs(ks,{className:"p-6",children:[v?u.jsx("div",{className:"mb-4 flex items-center rounded-md bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 px-3 py-2",children:u.jsx("p",{className:"text-xs text-green-700 dark:text-green-400",children:"Draft updated just now"})}):u.jsxs("div",{className:"mb-4 text-xs text-gray-600 dark:text-gray-400 items-center",children:[x??u.jsx("p",{children:"Based on case information available when this email was received."}),c!=="loading"&&u.jsxs(u.Fragment,{children:[" ",u.jsx("button",{onClick:s,className:"text-blue-600 dark:text-blue-400",title:"Refresh with latest data","aria-label":"Refresh with latest data",children:"Refresh with latest data"})]}),c==="loading"&&u.jsx(ia,{className:"h-3 w-3 animate-spin text-blue-600 ml-2"})]}),u.jsx($I,{htmlString:r}),m&&p&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700 my-4"}),u.jsx(Ye,{className:"w-full bg-blue-600 hover:bg-blue-700 text-white",size:"sm",onClick:p,children:"Apply changes"}),u.jsx("p",{className:"text-xs text-center text-gray-500 dark:text-gray-400 mt-2",children:"Applies tone and refine settings below"})]})]})]})},An="src/shared/components/sidepanel/panels/GenerateEmailDraftPanelWithPrefetch.tsx",f9="25dc68db26595a7485917129d6993f96",h9="c1c8e460f2105029b2b4563f9222161c",p9=()=>`The response should just be the email body with salutation at the beginning. Do not include a subject line in your response draft.
    Do not add links to the references in your response draft. Do not add citation numbers in your response draft.
    Do not list the references in your response draft, since they will be added in a different section in the JSON response.
    Do not add a complimentary closing or a signature as this will be added later.`.trim(),am=(r,e,t)=>{let n="";switch(r){case"Casual":n+="Keep the tone casual. ";break;case"Neutral":n+="Maintain a neutral tone. ";break;case"Formal":n+="Keep the tone formal. ";break}switch(e){case"Low":n+="Show low empathy. ";break;case"Neutral":n+="Maintain neutral empathy. ";break;case"High":n+="Show high empathy. ";break}switch(t){case"Simple":n+="Keep it simple and use simple words. ";break;case"Neutral":n+="Maintain neutral complexity. ";break;case"Detailed":n+="Provide detailed information and you're free to use harder words. ";break}return n.trim()},m9=({clientEmail:r,onCmsRefresh:e,onGenerateRefreshReady:t})=>{const n=Jr(),s=Xa(),i=Qa(),c=mn().platform,{isConnected:d}=Di(),[m,p]=w.useState(!1),[v,x]=w.useState(!1),[b,S]=w.useState("idle"),[N,E]=w.useState(!1),[T,A]=w.useState(!1),[I,D]=w.useState(!0),[j,O]=w.useState(""),[B,G]=w.useState(!1),[K,re]=w.useState(!0),[se,he]=w.useState(null),[U,ge]=w.useState(null),[ie,ae]=w.useState([]),de=w.useRef(null),[J,Y]=w.useState(""),[$,Q]=w.useState("Neutral"),[F,H]=w.useState("Neutral"),[te,Se]=w.useState("Neutral"),ue=w.useRef(null),ke=w.useRef(0),X=w.useRef(0),[we,Ne]=w.useState(am($,F,te)),[Me,St]=w.useState(J),[Te,Ge]=w.useState(!1),[Ee,ye]=w.useState(!1),[Ke,qe]=w.useState(""),ft=w.useMemo(()=>am($,F,te),[$,F,te]),mt=w.useMemo(()=>p9(),[]),jt=()=>re(Pe=>!Pe),ut=()=>G(Pe=>!Pe),Jt=w.useCallback(async Pe=>{const kt="fetchFromStorageProvider";if(!s)return"";try{const Ft=await s.getLocalItem(Pe);return Ft&&n.debug("Loaded additional context from storage",{sourceFile:An,functionName:kt}),Ft||""}catch(Ft){return n.error("Error loading additional context from storage",Ft,{sourceFile:An,functionName:kt}),""}},[s,n]);w.useEffect(()=>{const Pe="useEffect[threadDataListener]";if(!i){n.debug("DataProvider not available yet",{sourceFile:An,functionName:Pe});return}const kt=async $e=>{const cr=$e!==null&&$e.threadId!==de.current;if($e){if(n.debug("Thread changed via platform abstraction",{sourceFile:An,functionName:Pe,threadId:$e.threadId,isThreadChanged:cr}),ge($e.threadId),ae($e.participants||[]),$e.messages&&Array.isArray($e.messages)&&$e.messages.length>0&&$e.messages[0]&&typeof $e.messages[0]=="object"){const lr=$e.messages.map((Wt,Zt)=>({body:Wt.body||Wt.html||"",html:Wt.html||Wt.body||"",from:Wt.from||"",timestamp:Wt.timestamp||"",subject:Zt===0&&$e.subject||""}));he(lr)}const Ut=++X.current;if(cr){O(""),p(!1),x(!1),S("idle"),E(!1),qe(""),Q("Neutral"),H("Neutral"),Se("Neutral"),Y(""),St("");const lr=`toneSettings_${$e.threadId}`,Wt=await Jt(lr);if(Ut!==X.current)return;if(Wt)try{const Zt=JSON.parse(Wt),_n=["Casual","Neutral","Formal"],Un=["Low","Neutral","High"],Oo=["Simple","Neutral","Detailed"],Jn=_n.includes(Zt.formality)?Zt.formality:"Neutral",_r=Un.includes(Zt.empathy)?Zt.empathy:"Neutral",gn=Oo.includes(Zt.complexity)?Zt.complexity:"Neutral";Q(Jn),H(_r),Se(gn),Ne(am(Jn,_r,gn))}catch{Ne(am("Neutral","Neutral","Neutral"))}else Ne(am("Neutral","Neutral","Neutral"))}if(de.current=$e.threadId,cr){const lr=`additionalContext_${$e.threadId}`,Wt=await Jt(lr);if(Ut!==X.current)return;Y(Wt),St(Wt)}else{const lr=`additionalContext_${$e.threadId}`,Wt=await Jt(lr);if(Ut!==X.current)return;Y(Wt)}}else{n.debug("Thread cleared via platform abstraction",{sourceFile:An,functionName:Pe});const Ut=de.current!==null;ge(null),he(null),ae([]),O(""),p(!1),x(!1),S("idle"),E(!1),Ut&&(Y(""),de.current=null)}};return i.onThreadChanged(kt),(async()=>{try{const $e=await i.getCurrentThread();await kt($e)}catch($e){n.error("Error loading current thread",$e,{sourceFile:An,functionName:"loadCurrentThread"})}})(),()=>{i.removeThreadListener(kt)}},[i,n]),w.useEffect(()=>{const kt=setTimeout(async()=>{const Ft="useEffect[saveAdditionalContext]";if(!(!U||!s))try{const $e=`additionalContext_${U}`;await s.setLocalItem($e,J)}catch($e){n.error("Error saving additional context to storage",$e,{sourceFile:An,functionName:Ft,threadId:U})}},500);return()=>clearTimeout(kt)},[J,U,s,n]),w.useEffect(()=>{if(!U||!s)return;const kt=setTimeout(async()=>{try{const Ft=`toneSettings_${U}`;await s.setLocalItem(Ft,JSON.stringify({formality:$,empathy:F,complexity:te}))}catch(Ft){n.error("Error saving tone settings to storage",Ft,{sourceFile:An,functionName:"useEffect[saveToneSettings]",threadId:U})}},500);return()=>clearTimeout(kt)},[$,F,te,U,s,n]),w.useEffect(()=>{const Pe=async()=>{try{if(!s)return;const $e=await s.getLocalItem("useUscis");Ge($e??!1),n.debug("uscisIsEnabled loaded from storage via platform abstraction",{sourceFile:An,functionName:"initializeUscisState",uscisEnabled:$e??!1})}catch($e){n.error("Error loading USCIS state",$e,{sourceFile:An,functionName:"initializeUscisState"})}},kt=async()=>{try{if(!s)return;const $e=await s.getLocalItem("useOregon");ye($e??!1),n.debug("oregonIsEnabled loaded from storage via platform abstraction",{sourceFile:An,functionName:"initializeOregonState",oregonEnabled:$e??!1})}catch($e){n.error("Error loading Oregon state",$e,{sourceFile:An,functionName:"initializeOregonState"})}},Ft=async $e=>{try{$e.useUscis!==void 0&&(Ge($e.useUscis),n.debug("USCIS setting changed via platform abstraction",{sourceFile:An,functionName:"handleStorageChange",useUscis:$e.useUscis})),$e.useOregon!==void 0&&(ye($e.useOregon),n.debug("Oregon setting changed via platform abstraction",{sourceFile:An,functionName:"handleStorageChange",useOregon:$e.useOregon}))}catch(cr){n.error("Error handling storage changes",cr,{sourceFile:An,functionName:"handleStorageChange"})}};return Pe(),kt(),s!=null&&s.onChanged&&s.onChanged(Ft),D(!1),()=>{s!=null&&s.removeChangeListener&&Ft&&s.removeChangeListener(Ft)}},[s,n]),w.useEffect(()=>{if(j&&ue.current){const Pe=ue.current,Ft=(Pe.scrollHeight-Pe.clientHeight)*.8;Pe.scrollTo({top:Ft,behavior:"smooth"}),n.debug("Scrolling to 90% of bottom after response generation",{sourceFile:An,functionName:"useEffect[fullResponse]"})}},[j,n]);const Or=w.useCallback(async(Pe,kt)=>{p(!0);const Ft="regenerateResponse";try{if(!U){n.error("Thread ID is not set for regeneration",void 0,{sourceFile:An,functionName:Ft}),p(!1);return}const $e=await IT(kt,Pe,n,U);O(gb($e)),p(!1)}catch($e){n.error("Error regenerating response",$e,{sourceFile:An,functionName:Ft}),p(!1)}},[U,n]),jr=w.useCallback(()=>{gS(vS.sanitize(j),n)},[j,n]),Nr=w.useCallback(Pe=>{qe(Pe)},[]),me=w.useCallback(async Pe=>{const kt=++ke.current;p(!0);const Ft="handleGenerateResponse";try{const $e=(se==null?void 0:se.map(Zt=>`From: ${Zt.from}
Timestamp: ${Zt.timestamp}
Body: ${Qv(Zt.body)}

`).join(""))||"",cr=[];if(Te&&cr.push(f9),Ee&&cr.push(h9),!U){n.error("Thread ID is not set",void 0,{sourceFile:An,functionName:Ft}),p(!1);return}let Ut;const lr=(Pe==null?void 0:Pe.skipCache)??!1;if(c==="outlook"?Ut=await AT(U,$e,J,ft,mt,ie,n,lr):Ut=await TT(U,$e,J,ft,mt,cr,n,lr),kt!==ke.current)return;if(Ut.response==="error")throw new Error("Server returned error response");const Wt=gb(Ut.response);O(Wt),p(!1),S(Zt=>Zt==="loading"?"success":Zt),Ut.refreshed===!0&&E(!0),Ne(ft),St(J),Ut.raw_cms_data&&(Z6(Ut.raw_cms_data,n),e==null||e())}catch($e){n.error("Error generating response",$e,{sourceFile:An,functionName:Ft}),p(!1),x(!0),S(cr=>cr==="loading"?"error":cr)}},[c,se,J,ft,mt,Te,Ee,U,ie,n,e]),je=w.useCallback(async()=>{S("loading"),await me({skipCache:!0}),e==null||e()},[me,e]),ht=w.useCallback(async()=>{S("loading"),await me({skipCache:!0})},[me]);w.useEffect(()=>{t==null||t(ht)},[t,ht]);const wt=w.useCallback(()=>{x(!1),me()},[me]),We=w.useCallback(async()=>{try{if(J!==Me){O(""),await me({skipCache:!0}),Ne(ft),St(J),qe(""),A(!0);return}const kt=[];if(ft!==we&&kt.push(`Rewrite this email draft applying the following tone: ${ft}`),Ke.trim()&&kt.push(Ke.trim()),kt.length===0)return;await Or(kt.join(`

Also: `),j),Ne(ft),qe(""),A(!0)}catch(Pe){n.error("Error applying changes",Pe,{sourceFile:An,functionName:"handleApplyChanges"})}},[J,ft,Ke,j,Or,me,Me,we,n]),Ve=(ft!==we||J!==Me||Ke.trim().length>0)&&!!j&&!m;return w.useEffect(()=>{if(I||!U||!se||j||m||v||c==="chrome"&&!d)return;let Pe=!1;return(()=>{Pe||me()})(),()=>{Pe=!0}},[I,U,se,j,m,v,c,d,me,n]),w.useEffect(()=>{if(b!=="idle"&&b!=="loading"){const Pe=setTimeout(()=>S("idle"),5e3);return()=>clearTimeout(Pe)}},[b]),w.useEffect(()=>{if(T){const Pe=setTimeout(()=>A(!1),5e3);return()=>clearTimeout(Pe)}},[T]),c==="chrome"&&!d?u.jsx("div",{className:"p-4",children:u.jsx(r0,{feature:"Email Composition",description:"Connect your Gmail account to generate personalized email responses",benefits:["Analyze email threads and context automatically","Generate contextually relevant responses","Insert generated content directly into compose box"]})}):u.jsxs("div",{className:"space-y-4 h-full overflow-y-auto overflow-x-hidden",ref:ue,children:[u.jsx(d9,{fullResponse:j,isGenerating:m,hasError:v,onInsert:jr,onRefresh:je,onCreateDraft:wt,refreshStatus:b,isRefreshed:N,hasPendingChanges:Ve,onApplyChanges:We,showApplySuccess:T}),u.jsx(c9,{isOpen:B,onToggle:ut,formality:$,empathy:F,complexity:te,onFormalityChange:Q,onEmpathyChange:H,onComplexityChange:Se}),u.jsx(l9,{isOpen:K,onToggle:jt,value:J,onChange:Y,onRefine:Nr,onRefineInstructionChange:qe,hasGeneratedResponse:!!j}),u.jsx("div",{className:"mb-24"})]})},g9=()=>{const[r,e]=w.useState(!1),t=Xa(),n=Jr(),s=OT();w.useEffect(()=>{n.info("LoginPanel component loaded",{sourceFile:"src/sidepanel/panels/LoginPanel.tsx"});const c=d=>{d.token&&(e(!1),n.info("Token detected in storage, auth state will be updated automatically",{sourceFile:"src/sidepanel/panels/LoginPanel.tsx"}))};return t!=null&&t.onChanged&&t.onChanged(c),()=>{t!=null&&t.removeChangeListener&&t.removeChangeListener(c)}},[t,n]);const i=async()=>{n.info("Login button clicked",{sourceFile:"src/sidepanel/panels/LoginPanel.tsx"}),e(!0);try{await s.login(),n.info("Login completed successfully",{sourceFile:"src/sidepanel/panels/LoginPanel.tsx"}),e(!1)}catch(c){n.error("Login failed",c,{sourceFile:"src/sidepanel/panels/LoginPanel.tsx"}),e(!1)}};return u.jsxs("div",{className:"flex flex-col items-center justify-center h-full px-6 bg-gradient-to-b from-blue-50/30 to-white dark:from-gray-900 dark:to-gray-950 animate-fade-in",children:[u.jsx("div",{className:"flex items-center justify-center max-w-md w-full mb-8",children:u.jsxs("svg",{width:"400",height:"200",viewBox:"0 0 400 300",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"w-full h-auto max-h-[200px] drop-shadow-lg",children:[u.jsxs("defs",{children:[u.jsxs("linearGradient",{id:"emailGradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[u.jsx("stop",{offset:"0%",style:{stopColor:"#EEF2FF",stopOpacity:1}}),u.jsx("stop",{offset:"100%",style:{stopColor:"#E0E7FF",stopOpacity:1}})]}),u.jsxs("linearGradient",{id:"glowGradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[u.jsx("stop",{offset:"0%",style:{stopColor:"#818CF8",stopOpacity:.6}}),u.jsx("stop",{offset:"100%",style:{stopColor:"#4F46E5",stopOpacity:.3}})]}),u.jsxs("filter",{id:"glow",children:[u.jsx("feGaussianBlur",{stdDeviation:"4",result:"coloredBlur"}),u.jsxs("feMerge",{children:[u.jsx("feMergeNode",{in:"coloredBlur"}),u.jsx("feMergeNode",{in:"SourceGraphic"})]})]})]}),u.jsx("circle",{cx:"200",cy:"150",r:"120",fill:"url(#glowGradient)",opacity:"0.3",className:"animate-pulse-slow"}),u.jsx("circle",{cx:"200",cy:"150",r:"80",fill:"url(#glowGradient)",opacity:"0.2",className:"animate-pulse-slow",style:{animationDelay:"0.5s"}}),u.jsxs("g",{className:"animate-float",children:[u.jsx("rect",{x:"100",y:"80",width:"200",height:"140",rx:"8",fill:"url(#emailGradient)",stroke:"#6366F1",strokeWidth:"2"}),u.jsx("line",{x1:"120",y1:"110",x2:"240",y2:"110",stroke:"#94A3B8",strokeWidth:"2",strokeLinecap:"round"}),u.jsx("line",{x1:"120",y1:"130",x2:"260",y2:"130",stroke:"#94A3B8",strokeWidth:"2",strokeLinecap:"round"}),u.jsx("line",{x1:"120",y1:"150",x2:"230",y2:"150",stroke:"#94A3B8",strokeWidth:"2",strokeLinecap:"round"}),u.jsx("line",{x1:"120",y1:"170",x2:"250",y2:"170",stroke:"#94A3B8",strokeWidth:"2",strokeLinecap:"round"}),u.jsx("line",{x1:"120",y1:"190",x2:"210",y2:"190",stroke:"#94A3B8",strokeWidth:"2",strokeLinecap:"round"})]}),u.jsxs("g",{className:"animate-sparkle",children:[u.jsx("circle",{cx:"80",cy:"60",r:"4",fill:"#818CF8",filter:"url(#glow)"}),u.jsx("path",{d:"M 80 50 L 82 58 L 90 60 L 82 62 L 80 70 L 78 62 L 70 60 L 78 58 Z",fill:"#818CF8",filter:"url(#glow)"})]}),u.jsxs("g",{className:"animate-sparkle",style:{animationDelay:"0.7s"},children:[u.jsx("circle",{cx:"320",cy:"80",r:"3",fill:"#4F46E5",filter:"url(#glow)"}),u.jsx("path",{d:"M 320 72 L 321.5 78 L 328 80 L 321.5 82 L 320 88 L 318.5 82 L 312 80 L 318.5 78 Z",fill:"#4F46E5",filter:"url(#glow)"})]}),u.jsxs("g",{className:"animate-sparkle",style:{animationDelay:"1.4s"},children:[u.jsx("circle",{cx:"310",cy:"230",r:"3.5",fill:"#818CF8",filter:"url(#glow)"}),u.jsx("path",{d:"M 310 221 L 311.8 227.5 L 319 230 L 311.8 232.5 L 310 239 L 308.2 232.5 L 301 230 L 308.2 227.5 Z",fill:"#818CF8",filter:"url(#glow)"})]}),u.jsxs("g",{className:"animate-sparkle",style:{animationDelay:"0.3s"},children:[u.jsx("circle",{cx:"90",cy:"240",r:"3",fill:"#6366F1",filter:"url(#glow)"}),u.jsx("path",{d:"M 90 233 L 91.5 238 L 97 240 L 91.5 242 L 90 247 L 88.5 242 L 83 240 L 88.5 238 Z",fill:"#6366F1",filter:"url(#glow)"})]}),u.jsxs("g",{className:"animate-sparkle",style:{animationDelay:"1s"},children:[u.jsx("circle",{cx:"320",cy:"150",r:"5",fill:"#4F46E5",filter:"url(#glow)"}),u.jsx("path",{d:"M 320 138 L 323 147 L 333 150 L 323 153 L 320 162 L 317 153 L 307 150 L 317 147 Z",fill:"#4F46E5",filter:"url(#glow)"})]}),u.jsx("circle",{cx:"85",cy:"150",r:"2.5",fill:"#818CF8",opacity:"0.6",className:"animate-sparkle"}),u.jsx("circle",{cx:"315",cy:"200",r:"2",fill:"#6366F1",opacity:"0.5",className:"animate-sparkle",style:{animationDelay:"0.5s"}}),u.jsx("circle",{cx:"280",cy:"70",r:"2",fill:"#4F46E5",opacity:"0.6",className:"animate-sparkle",style:{animationDelay:"1s"}})]})}),u.jsxs("div",{className:"text-center mb-6 space-y-3 animate-slide-up",children:[u.jsxs("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white leading-tight",children:["Legal emails,",u.jsx("br",{}),"effortlessly handled"]}),u.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 max-w-xs mx-auto",children:"AI-powered email assistant for legal professionals"})]}),u.jsx("div",{className:"w-full max-w-xs animate-slide-up",style:{animationDelay:"0.2s"},children:u.jsx(Ye,{onClick:i,className:"w-full h-12 text-base font-medium shadow-lg hover:shadow-xl transition-all duration-200 hover:scale-[1.02] bg-blue-600 hover:bg-blue-700 dark:bg-blue-600 dark:hover:bg-blue-700",disabled:r,children:r?u.jsxs("span",{className:"flex items-center justify-center gap-2",children:[u.jsxs("svg",{className:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[u.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),u.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Logging in..."]}):"Get Started"})})]})},v9=[{available:!0,id:"gmail",name:"Gmail",description:"Connect your Gmail account to access your email",authMethod:"oauth",authUrl:M_(L_),logo:"/gmail.svg",homeUrl:"https://mail.google.com",isConnected:!1,category:"email"},{available:!0,id:"filevine",name:"Filevine",description:"Connect your Filevine account to access case status",authMethod:"custom",authUrl:"https://identity.filevine.com/",customAuthFields:[{id:"clientId",displayName:"Client ID",type:"text"},{id:"clientSecret",displayName:"Client Secret",type:"text"},{id:"PAT",displayName:"Personal Access Token",type:"text"},{id:"organizationId",displayName:"Organization ID",type:"text"},{id:"userId",displayName:"User ID",type:"text"}],logo:"/filevine.svg",homeUrl:"https://identity.filevine.com/",isConnected:!1,category:"case_management"},{available:!0,id:"clio",name:"Clio",description:"Connect your Clio account to access case status",authMethod:"server",authUrl:$_+"clio",logo:"/clio.svg",homeUrl:"https://app.clio.com",isConnected:!1,category:"case_management"},{available:!1,id:"drive",name:"Google Drive",description:"Connect your Google account to access files on Drive",authMethod:"oauth",authUrl:"/api/auth/google",logo:"/google.svg",homeUrl:"https://drive.google.com",isConnected:!1,category:"data_management"},{available:!1,id:"onedrive",name:"OneDrive",description:"Connect your Microsoft account to access files on OneDrive",authMethod:"oauth",authUrl:"/api/auth/onedrive",logo:"/onedrive.svg",homeUrl:"https://onedrive.live.com",isConnected:!1,category:"data_management"}],_R=[{available:!0,id:"inszoom",name:"INSZoom",description:"Connect your INSZoom account to access case status",authMethod:"custom",authUrl:"https://global.inszoom.com/",logo:"/inszoom.ico",customAuthFields:[{id:"auth_key",displayName:"Authorization Key",type:"text"},{id:"subscription_key",displayName:"Subscription Key",type:"text"},{id:"case_status_report",displayName:"Latest Case Status Report",type:"file"}],homeUrl:"https://global.inszoom.com",isConnected:!1,category:"case_management"},{available:!1,id:"drive",name:"Google Drive",description:"Connect your Google account to access files on Drive",authMethod:"oauth",authUrl:"/api/auth/google",logo:"/google.svg",homeUrl:"https://drive.google.com",isConnected:!1,category:"data_management"},{available:!1,id:"onedrive",name:"OneDrive",description:"Connect your Microsoft account to access files on OneDrive",authMethod:"oauth",authUrl:"/api/auth/onedrive",logo:"/onedrive.svg",homeUrl:"https://onedrive.live.com",isConnected:!1,category:"data_management"}],Pr="src/lib/utils/integrationUtils.tsx";async function SS(r){const e=v9.find(n=>n.id===r);return e||_R.find(n=>n.id===r)||null}async function y9(r){return _R.find(e=>e.id===r)||null}async function SR(r,e,t,n,s){if(e.authMethod==="server")throw new Error("Integration is a server integration which shouldn't be initiated by the extension");r.info("Initiating integration process for integration:",{sourceFile:Pr,integrationId:e});try{let i;if(s&&Object.keys(s).length>0){r.info("Starting file serialization process",{sourceFile:Pr,fileCount:Object.keys(s).length});const d=100*1024*1024;for(const[m,p]of Object.entries(s))if(p.size>d){const v=`File "${p.name}" exceeds 100MB limit. File size: ${(p.size/1048576).toFixed(2)}MB`;throw r.error("File size validation failed",new Error(v),{sourceFile:Pr,fieldId:m,fileName:p.name,fileSize:p.size,maxSize:d}),new Error(v)}i={};for(const[m,p]of Object.entries(s)){const v=await Nx(p);r.info("Original file checksum calculated",{sourceFile:Pr,fieldId:m,fileName:p.name,fileSize:p.size,fileType:p.type,originalChecksum:v});const x=await p.arrayBuffer(),b=new Uint8Array(x),S=await Nx(x);r.info("ArrayBuffer checksum calculated",{sourceFile:Pr,fieldId:m,fileName:p.name,bufferChecksum:S,bufferSize:x.byteLength,checksumMatch:v===S});let N="";const E=8192;for(let O=0;O<b.length;O+=E){const B=b.slice(O,O+E);N+=String.fromCharCode(...B)}const T=btoa(N),A=atob(T),I=new ArrayBuffer(A.length),D=new Uint8Array(I);for(let O=0;O<A.length;O++)D[O]=A.charCodeAt(O);const j=await Nx(I);i[m]={name:p.name,type:p.type,size:p.size,data:T},r.info("File serialization completed",{sourceFile:Pr,fieldId:m,fileName:p.name,fileSize:p.size,base64Length:T.length,originalChecksum:v,bufferChecksum:S,decodedChecksum:j,allChecksumsMatch:v===S&&S===j})}r.info("All files serialized successfully",{sourceFile:Pr,serializedFileCount:Object.keys(i).length})}const c=await Yn.createServices();if(c.messaging.sendMessage){const d=await c.messaging.sendMessage({type:"INITIATE_INTEGRATION",integration:e,authUrl:t,credentials:n,files:i});if(!d.success)throw new Error(d.error||"Integration failed");return r.info("Integration initiated successfully",{sourceFile:Pr}),d.success}else{const d=await chrome.runtime.sendMessage({type:"INITIATE_INTEGRATION",integration:e,authUrl:t,credentials:n,files:i});if(!d.success)throw new Error(d.error||"Integration failed");return r.info("Integration initiated successfully",{sourceFile:Pr}),d.success}}catch(i){throw r.error("Integration failed:",i,{sourceFile:Pr}),i}}async function x9(r,e){try{const t=await Yn.createServices();if(t.messaging.sendMessage){const n=await t.messaging.sendMessage({type:"DISCONNECT_INTEGRATION",integration:e});if(!n.success)throw new Error(n.error||"Disconnection failed");return r.info("Integration disconnected successfully",{sourceFile:Pr}),n.success}else{const n=await chrome.runtime.sendMessage({type:"DISCONNECT_INTEGRATION",integration:e});if(!n.success)throw new Error(n.error||"Disconnection failed");return r.info("Integration disconnected successfully",{sourceFile:Pr}),n.success}}catch(t){throw r.error("Disconnection failed:",t,{sourceFile:Pr}),t}}async function ER(r){const e="isCaseManagementSystemIntegrationConnected";try{r.debug("Starting CMS integration check",{sourceFile:Pr,functionName:e});const t=await Zm(r);r.debug("Local integrations retrieved",{sourceFile:Pr,functionName:e,count:t.length,integrations:t.map(p=>p.integration_type)});const n=t.some(p=>p.integration_type==="filevine"||p.integration_type==="clio"||p.integration_type==="inszoom");if(r.debug("Local CMS integration check result",{sourceFile:Pr,functionName:e,isConnectedLocally:n}),n)return r.info("CMS integration found in local storage",{sourceFile:Pr,functionName:e}),!0;const[s,i]=await Promise.all([Zc("user",r).catch(()=>[]),Zc("tenant",r).catch(()=>[])]),c=s.map(p=>({integration_type:p.integration_type,tenantId_userId:p.tenantId_userId,scope:"user"})),d=i.map(p=>({integration_type:p.integration_type,tenantId_userId:p.tenantId_userId,scope:"tenant"})),m=[...c,...d];return await Qm(r,m),m.some(p=>p.integration_type==="filevine"||p.integration_type==="clio"||p.integration_type==="inszoom");return r.info("Final CMS integration check result",{sourceFile:Pr,functionName:e,isConnectedOnServer}),isConnectedOnServer}catch(t){return r.error("Failed to check if CMS integration is connected",t,{sourceFile:Pr,functionName:e}),!1}}async function w9(r,e){try{if((await Zm(r)).some(p=>p.integration_type===e))return!0;const[s,i]=await Promise.all([Zc("user",r).catch(()=>[]),Zc("tenant",r).catch(()=>[])]),c=s.map(p=>({integration_type:p.integration_type,tenantId_userId:p.tenantId_userId,scope:"user"})),d=i.map(p=>({integration_type:p.integration_type,tenantId_userId:p.tenantId_userId,scope:"tenant"})),m=[...c,...d];return await Qm(r,m),m.some(p=>p.integration_type===e)||!1}catch(t){return r.warn("Failed to check if integration is connected:",{sourceFile:Pr,integrationId:e,error:t}),!1}}async function kR(r){try{r.info("Refreshing integrations from server",{sourceFile:Pr}),await rT(r);const[e,t]=await Promise.all([Zc("user",r).catch(()=>[]),Zc("tenant",r).catch(()=>[])]),n=e.map(c=>({integration_type:c.integration_type,tenantId_userId:c.tenantId_userId,scope:"user"})),s=t.map(c=>({integration_type:c.integration_type,tenantId_userId:c.tenantId_userId,scope:"tenant"})),i=[...n,...s];return await Qm(r,i),r.info("Refreshed integrations from server",{sourceFile:Pr,userCount:n.length,tenantCount:s.length,totalCount:i.length}),!0}catch(e){return r.warn("Failed to refresh integrations:",{sourceFile:Pr,error:e}),!1}}async function CR(r){try{const e=await Zm(r);if(e.length>0)return e;const[t,n]=await Promise.all([Zc("user",r).catch(d=>(r.warn("Failed to fetch user integrations:",{sourceFile:Pr,error:d}),[])),Zc("tenant",r).catch(d=>(r.warn("Failed to fetch tenant integrations:",{sourceFile:Pr,error:d}),[]))]),s=t.map(d=>({...d,scope:"user"})),i=n.map(d=>({...d,scope:"tenant"})),c=[...s,...i];return await Qm(r,c),r.info("Saved merged integrations to local storage",{sourceFile:Pr,userCount:s.length,tenantCount:i.length,totalCount:c.length,integrations:c}),c}catch(e){return r.error("Failed to list integrations:",e,{sourceFile:Pr}),[]}}async function b9(r,e){try{return(await Zm(r)).find(n=>n.integration_type===e)||null}catch(t){return r.error("Failed to get integration details:",t,{sourceFile:Pr}),null}}async function _9(r,e){var i;const t=await ay(r),n=((i=t.integrations)==null?void 0:i.filter(c=>c.integration_type!==e.integration_type))||[];n.push(e);const s={...t,integrations:n};await Z1(r,s)}async function S9(r,e){var i;const t=await ay(r),n=((i=t.integrations)==null?void 0:i.filter(c=>c.integration_type!==e))||[],s={...t,integrations:n};await Z1(r,s)}async function E9(r,e){if(!e)throw new Error("Integration not found");if(e.authMethod!=="server")throw new Error("Integration is not a server integration");try{const t=await Mm(r);if(!t)throw r.warn("Failed to get authentication token",{sourceFile:Pr}),new Error("Authentication required. Please log in first.");const n=`${$_}${e.id}?token=${encodeURIComponent(t.id_token)}`;r.debug("Opening server auth page",{sourceFile:Pr,integrationId:e.id}),window.open(n,"_blank")}catch(t){throw r.error("Failed to open server auth page:",t,{sourceFile:Pr}),t}}async function k9(r){try{return await rT(r),await hT(r),!0}catch(e){return r.error("Failed to clear integration data:",e,{sourceFile:Pr}),!1}}const C9=Object.freeze(Object.defineProperty({__proto__:null,clearIntegrationData:k9,disconnectIntegration:x9,findIntegrationById:SS,findOrgIntegrationById:y9,getIntegrationDetails:b9,initiateIntegration:SR,isCaseManagementSystemIntegrationConnected:ER,isIntegrationConnected:w9,listIntegrations:CR,openServerAuthPageForIntegration:E9,refreshIntegrations:kR,removeIntegrationDetails:S9,saveIntegrationDetails:_9},Symbol.toStringTag,{value:"Module"})),lm="src/components/ui/DetailsTable.tsx",cN=r=>u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",width:"16",height:"16",...r,className:`inline-block w-4 h-4 ${r.className||""}`,children:[u.jsx("path",{d:"M11 3a1 1 0 100 2h2.586l-6.293 6.293a1 1 0 101.414 1.414L15 6.414V9a1 1 0 102 0V4a1 1 0 00-1-1h-5z"}),u.jsx("path",{d:"M5 5a2 2 0 00-2 2v8a2 2 0 002 2h8a2 2 0 002-2v-3a1 1 0 10-2 0v3H5V7h3a1 1 0 000-2H5z"})]}),Zl=({details:r,linkableFields:e})=>{const t=Jr(),[n,s]=br.useState(new Set),[i,c]=br.useState(new Set),d=80;if(!r)return t.debug("No important details to render",{sourceFile:lm}),null;if(Object.keys(r).length===0)return t.debug("No important details to render",{sourceFile:lm}),null;const m=N=>{const E=document.createElement("textarea");E.value=N,E.style.position="fixed",E.style.opacity="0",document.body.appendChild(E),E.select();const T=document.execCommand("copy");return document.body.removeChild(E),T},p=(N,E)=>{navigator.clipboard.writeText(N).then(()=>{t.debug("Copied to clipboard",{sourceFile:lm,copiedValue:N}),c(T=>new Set([...T,E])),setTimeout(()=>{c(T=>{const A=new Set(T);return A.delete(E),A})},2e3)}).catch(T=>{t.error("Failed to copy with navigator.clipboard.writeText",T,{sourceFile:lm});try{m(N)&&(c(A=>new Set([...A,E])),setTimeout(()=>{c(A=>{const I=new Set(A);return I.delete(E),I})},2e3))}catch(A){t.error("Failed to copy with document.execCommand",A,{sourceFile:lm})}})},v=N=>{const E=new Set(n);E.has(N)?E.delete(N):E.add(N),s(E)},x=N=>{if(!N)return"";try{return new Date(N).toLocaleDateString(void 0,{timeZone:"UTC"})}catch{return N}},b=N=>{try{const E=new URL(N);return E.protocol==="http:"||E.protocol==="https:"}catch{return!1}},S=N=>N.split(/(\[\[.*?\]\]|\(\(.*?\)\))/g).map((T,A)=>{if(T.startsWith("[[")&&T.endsWith("]]")){const I=T.slice(2,-2);return u.jsx("span",{className:"font-semibold",children:I},A)}else if(T.startsWith("((")&&T.endsWith("))")){const I=T.slice(2,-2);return/^\d{4}-\d{2}-\d{2}/.test(I)?u.jsx("span",{className:"text-base",children:x(I)},A):u.jsx("span",{className:"text-base",children:I},A)}return T});return u.jsx("div",{className:"p-1",children:u.jsx("table",{className:"w-full text-sm text-left text-gray-700 dark:text-gray-300 table-fixed",children:u.jsx("tbody",{children:Object.entries(r).map(([N,E],T)=>{let A;E===""||E===null||E===void 0?A="":typeof E=="string"||typeof E=="number"?A=String(E):A=JSON.stringify(E);const I=e==null?void 0:e.find(G=>G.field===N),D=b(A),j=A.length>d,O=n.has(T),B=j&&!O?A.substring(0,d)+"...":A;return u.jsxs("tr",{className:"bg-card",children:[u.jsx("td",{className:"py-2 px-3 whitespace-normal font-medium w-2/5 text-gray-800 dark:text-gray-200",children:I?u.jsxs("a",{href:I.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 dark:text-blue-400 hover:underline whitespace-normal hover:text-blue-800 dark:hover:text-blue-300 flex items-center gap-1",children:[N,u.jsx(cN,{})]}):N}),u.jsx("td",{className:`py-2 px-3 whitespace-pre-wrap break-words ${D?"":"hover:bg-gray-100 dark:hover:bg-muted"}`,style:D?{}:{cursor:`url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>') 10 10, copy`},onClick:()=>!D&&!j&&p(A,T),title:D?"Click to open link":j?"":"Click to copy",children:D?u.jsxs("a",{href:A,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 dark:text-blue-400 hover:underline break-words flex items-center gap-1",children:[S(A),u.jsx(cN,{className:"flex-shrink-0"})]}):u.jsxs("div",{children:[u.jsxs("div",{className:"relative",children:[u.jsx("span",{className:"break-words text-gray-700 dark:text-gray-300",onClick:()=>!j&&p(A,T),children:S(B)}),i.has(T)&&u.jsx("span",{className:"absolute -top-1 -right-1 bg-white dark:bg-gray-700 text-black dark:text-white text-xs px-2 py-1 rounded-full shadow-lg border border-gray-300 dark:border-gray-600",children:"Copied!"})]}),j&&u.jsx("div",{className:"mt-1",children:u.jsx("button",{onClick:G=>{G.stopPropagation(),v(T)},className:"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 underline text-sm",children:O?"show less":"show more"})})]})})]},T)})})})})},In="src/shared/components/sidepanel/mainPanelContent/EmailSummaryBox.tsx",N9=()=>{const[r,e]=w.useState(""),[t,n]=w.useState(null),[s,i]=w.useState(null),[c,d]=w.useState(!1),[m,p]=w.useState(!0),[v,x]=w.useState(!1),[b,S]=w.useState("summary"),[N,E]=w.useState(null),[T,A]=w.useState(null),[I,D]=w.useState(0),{platform:j}=mn(),O=Qa(),B=Jr(),G=w.useRef(null),K=w.useRef(null),re=w.useRef(!1),se=["Analyzing email content...","Extracting key information...","Identifying important details...","Generating summary...","Finalizing insights..."];w.useEffect(()=>{let J;const Y=()=>{if(c){const $=Math.floor(Math.random()*1500)+500;J=setTimeout(()=>{D(Q=>(Q+1)%se.length),Y()},$)}};return c&&Y(),()=>{J&&clearTimeout(J)}},[c,se.length]);const he=w.useCallback(async J=>{if(re.current&&G.current===J){B.debug("Already loading summary for thread:",{threadId:J,sourceFile:In});return}G.current=J,d(!0),re.current=!0;try{const Y=await e8(J,B);G.current===J?(B.debug("Summary response:",{summaryResponse:Y,sourceFile:In}),e(Y.summary),E(Y.importantDetails),d(!1),re.current=!1):B.debug("Ignoring summary response for outdated thread:",{threadId:J,sourceFile:In})}catch(Y){B.error("Error fetching email summary:",Y,{sourceFile:In}),G.current===J&&(d(!1),re.current=!1)}},[B]),U=w.useCallback(async(J,Y)=>{if(re.current&&G.current===J){B.debug("Already loading summary for thread:",{threadId:J,sourceFile:In});return}G.current=J,d(!0),re.current=!0;const $=await G5(J,B);if($){B.debug("Using cached summary for thread:",{threadId:J,sourceFile:In}),e($.summary),E($.importantDetails),d(!1),re.current=!1;return}try{if(!Y){B.warn("No thread data found",{sourceFile:In,functionName:"fetchEmailSummaryForOutlook"}),d(!1),re.current=!1;return}const Q=await t8(Y,B);G.current===J?(B.debug("Summary response:",{summaryResponse:Q,sourceFile:In}),await B5(J,Q.summary,Q.importantDetails,B),e(Q.summary),E(Q.importantDetails),d(!1),re.current=!1):B.debug("Ignoring summary response for outdated thread:",{threadId:J,sourceFile:In})}catch(Q){B.error("Error fetching email summary for Outlook:",Q,{sourceFile:In}),G.current===J&&(d(!1),re.current=!1,e("Error fetching email summary. Please try again."))}},[B]);w.useEffect(()=>{const J=async()=>{B.info("Checking if Gmail is connected",{sourceFile:In});const $=await By(B);B.info("Gmail connection check result",{connected:$,sourceFile:In}),p($)},Y=async()=>{try{const Q=(await Yn.createServices()).storage;if(Q.onChanged){const F=H=>{if(H.gmailConnectionStatus){const te=H.gmailConnectionStatus.newValue;B.info("Gmail connection status changed via storage",{sourceFile:In,newStatus:te,oldStatus:H.gmailConnectionStatus.oldValue}),p(!0)}};return Q.onChanged(F),()=>{Q.removeChangeListener&&Q.removeChangeListener(F)}}}catch($){B.error("Failed to set up storage listener:",$,{sourceFile:In})}};if(j==="chrome"){const Q=(async()=>(await J(),await Y()))();return()=>{Q.then(F=>F==null?void 0:F())}}else j==="outlook"&&(p(!1),console.log("Not calling checkGmailConnection for Outlook"))},[j,B]),w.useEffect(()=>{if(O!=null&&O.onThreadChanged){const J=$=>{if(B.debug("Thread change received",{sourceFile:In,functionName:"handleThreadChange",hasThread:!!$,threadId:$==null?void 0:$.threadId,platform:j}),!$){B.debug("No thread provided, keeping current state",{sourceFile:In}),n(null),i(null);return}if(n($.threadId||null),B.debug("Thread ID set",{sourceFile:In,threadId:$.threadId}),$.messages&&Array.isArray($.messages)&&$.messages.length>0&&$.messages[0]&&typeof $.messages[0]=="object"){const Q=$.messages.map((F,H)=>({body:F.body||F.html||"",html:F.html||F.body||"",from:F.from||"",timestamp:F.timestamp||"",subject:H===0&&$.subject||""}));i(JSON.stringify(Q)),B.debug("Thread data converted and set",{sourceFile:In,messageCount:Q.length})}};return O.onThreadChanged(J),(async()=>{try{const $=await O.getCurrentThread();J($)}catch($){B.error("Error loading current thread",$,{sourceFile:In,functionName:"loadCurrentThread"})}})(),()=>{O.removeThreadListener&&O.removeThreadListener(J)}}},[O,j,B]),w.useEffect(()=>{t&&m&&j==="chrome"?(t!==G.current||!re.current)&&he(t):!m&&j==="chrome"?(e("Connect to Gmail to enable email summaries"),E(null),S("summary"),G.current=null,re.current=!1,d(!1)):!m&&j==="outlook"&&s&&t?(t!==G.current||!re.current)&&U(t||"",s):(e("Select a thread to summarize"),E(null),S("summary"),G.current=null,re.current=!1,d(!1))},[t,m,he,U,j,s]);const ge=async()=>{try{x(!0);const J=M_(L_),Y=await SS("gmail");if(!Y){B.error("Gmail integration not found",new Error("Gmail integration not found"),{sourceFile:In});return}await SR(B,Y,J)&&(p(!0),t&&he(t))}catch(J){B.error("Failed to connect to Gmail:",J,{sourceFile:In}),e("Failed to connect to Gmail. Please try again.")}finally{x(!1)}},ie=()=>N?u.jsx(Zl,{details:N}):null,ae=()=>{b==="summary"&&K.current&&(A(K.current.offsetHeight),S("details"))},de=N!==null&&Object.keys(N).length>0;return w.useEffect(()=>{de||S("summary")},[de]),w.useEffect(()=>{T&&document.documentElement.style.setProperty("--content-height",`${T}px`)},[T]),u.jsxs("div",{className:"w-full max-w-full min-h-[3rem] border rounded-lg shadow-sm bg-white mx-2 mt-1 mb-2 overflow-hidden box-border border-b-0",title:"Email Summary",style:{maxWidth:"calc(100% - 1rem)"},children:[u.jsx("div",{className:"flex items-center justify-center py-1 px-2 border-b bg-gray-150 min-w-0",children:u.jsxs("div",{className:"flex items-center gap-1 bg-gray-150 p-1 rounded-full",children:[u.jsxs("button",{className:`px-3 py-1.5 rounded-full text-sm font-medium transition-colors whitespace-nowrap flex items-center gap-1.5 ${b==="summary"?"text-blue-700 border bg-white border-blue-200":"bg-gray-75 text-gray-600 hover:bg-gray-100 border border-gray-200"}`,onClick:()=>S("summary"),children:[u.jsx(eu,{className:"w-3.5 h-3.5"}),"Summary"]}),de&&u.jsxs("button",{className:`px-3 py-1.5 rounded-full text-sm font-medium transition-colors flex items-center gap-1.5 whitespace-nowrap ${b==="details"?"text-blue-700 border bg-white border-blue-200":"bg-gray-75 text-gray-600 hover:bg-gray-100 border border-gray-200"}`,onClick:ae,children:[u.jsx(Ai,{src:"/icons/info-circled.svg",width:14,height:14,alt:"Info",className:"w-3.5 h-3.5"}),"Key Points"]})]})}),u.jsx("div",{className:"w-full min-w-0",children:c?u.jsxs("div",{className:"w-full border rounded flex flex-col items-center justify-center bg-gray-50 p-4",children:[u.jsx(ia,{className:"h-8 w-8 animate-spin text-blue-600"}),u.jsx("div",{className:"text-center text-sm text-gray-500",children:se[I]})]}):!m&&j==="chrome"?u.jsxs("div",{className:"w-full p-4 flex flex-col items-center justify-center",children:[u.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Connect to Gmail to enable email summaries"}),u.jsx(Ye,{onClick:ge,className:"w-full bg-blue-600 hover:bg-blue-700 text-white py-4 mt-2",disabled:v,children:v?"Connecting...":"Connect Gmail"})]}):u.jsx("div",{className:"w-full min-w-0 overflow-hidden",children:b==="summary"?u.jsx("div",{ref:K,className:"p-3 text-sm text-gray-600 whitespace-pre-wrap break-words overflow-wrap-anywhere",children:r}):u.jsx("div",{className:"overflow-y-auto",children:ie()})})})]})};function uN(r){const e=T9(r),t=w.forwardRef((n,s)=>{const{children:i,...c}=n,d=w.Children.toArray(i),m=d.find(I9);if(m){const p=m.props.children,v=d.map(x=>x===m?w.Children.count(p)>1?w.Children.only(null):w.isValidElement(p)?p.props.children:null:x);return u.jsx(e,{...c,ref:s,children:w.isValidElement(p)?w.cloneElement(p,void 0,v):null})}return u.jsx(e,{...c,ref:s,children:i})});return t.displayName=`${r}.Slot`,t}function T9(r){const e=w.forwardRef((t,n)=>{const{children:s,...i}=t;if(w.isValidElement(s)){const c=P9(s),d=R9(i,s.props);return s.type!==w.Fragment&&(d.ref=n?nu(n,c):c),w.cloneElement(s,d)}return w.Children.count(s)>1?w.Children.only(null):null});return e.displayName=`${r}.SlotClone`,e}var A9=Symbol("radix.slottable");function I9(r){return w.isValidElement(r)&&typeof r.type=="function"&&"__radixId"in r.type&&r.type.__radixId===A9}function R9(r,e){const t={...e};for(const n in e){const s=r[n],i=e[n];/^on[A-Z]/.test(n)?s&&i?t[n]=(...d)=>{const m=i(...d);return s(...d),m}:s&&(t[n]=s):n==="style"?t[n]={...s,...i}:n==="className"&&(t[n]=[s,i].filter(Boolean).join(" "))}return{...r,...t}}function P9(r){var n,s;let e=(n=Object.getOwnPropertyDescriptor(r.props,"ref"))==null?void 0:n.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=(s=Object.getOwnPropertyDescriptor(r,"ref"))==null?void 0:s.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}function ES(r){const e=r+"CollectionProvider",[t,n]=Za(e),[s,i]=t(e,{collectionRef:{current:null},itemMap:new Map}),c=E=>{const{scope:T,children:A}=E,I=br.useRef(null),D=br.useRef(new Map).current;return u.jsx(s,{scope:T,itemMap:D,collectionRef:I,children:A})};c.displayName=e;const d=r+"CollectionSlot",m=uN(d),p=br.forwardRef((E,T)=>{const{scope:A,children:I}=E,D=i(d,A),j=$n(T,D.collectionRef);return u.jsx(m,{ref:j,children:I})});p.displayName=d;const v=r+"CollectionItemSlot",x="data-radix-collection-item",b=uN(v),S=br.forwardRef((E,T)=>{const{scope:A,children:I,...D}=E,j=br.useRef(null),O=$n(T,j),B=i(v,A);return br.useEffect(()=>(B.itemMap.set(j,{ref:j,...D}),()=>void B.itemMap.delete(j))),u.jsx(b,{[x]:"",ref:O,children:I})});S.displayName=v;function N(E){const T=i(r+"CollectionConsumer",E);return br.useCallback(()=>{const I=T.collectionRef.current;if(!I)return[];const D=Array.from(I.querySelectorAll(`[${x}]`));return Array.from(T.itemMap.values()).sort((B,G)=>D.indexOf(B.ref.current)-D.indexOf(G.ref.current))},[T.collectionRef,T.itemMap])}return[{Provider:c,Slot:p,ItemSlot:S},N,n]}var j9=w.createContext(void 0);function o0(r){const e=w.useContext(j9);return r||e||"ltr"}var fw="rovingFocusGroup.onEntryFocus",F9={bubbles:!1,cancelable:!0},ag="RovingFocusGroup",[yb,NR,O9]=ES(ag),[D9,i0]=Za(ag,[O9]),[L9,M9]=D9(ag),TR=w.forwardRef((r,e)=>u.jsx(yb.Provider,{scope:r.__scopeRovingFocusGroup,children:u.jsx(yb.Slot,{scope:r.__scopeRovingFocusGroup,children:u.jsx($9,{...r,ref:e})})}));TR.displayName=ag;var $9=w.forwardRef((r,e)=>{const{__scopeRovingFocusGroup:t,orientation:n,loop:s=!1,dir:i,currentTabStopId:c,defaultCurrentTabStopId:d,onCurrentTabStopIdChange:m,onEntryFocus:p,preventScrollOnEntryFocus:v=!1,...x}=r,b=w.useRef(null),S=$n(e,b),N=o0(i),[E,T]=su({prop:c,defaultProp:d??null,onChange:m,caller:ag}),[A,I]=w.useState(!1),D=Ql(p),j=NR(t),O=w.useRef(!1),[B,G]=w.useState(0);return w.useEffect(()=>{const K=b.current;if(K)return K.addEventListener(fw,D),()=>K.removeEventListener(fw,D)},[D]),u.jsx(L9,{scope:t,orientation:n,dir:N,loop:s,currentTabStopId:E,onItemFocus:w.useCallback(K=>T(K),[T]),onItemShiftTab:w.useCallback(()=>I(!0),[]),onFocusableItemAdd:w.useCallback(()=>G(K=>K+1),[]),onFocusableItemRemove:w.useCallback(()=>G(K=>K-1),[]),children:u.jsx(Ur.div,{tabIndex:A||B===0?-1:0,"data-orientation":n,...x,ref:S,style:{outline:"none",...r.style},onMouseDown:$t(r.onMouseDown,()=>{O.current=!0}),onFocus:$t(r.onFocus,K=>{const re=!O.current;if(K.target===K.currentTarget&&re&&!A){const se=new CustomEvent(fw,F9);if(K.currentTarget.dispatchEvent(se),!se.defaultPrevented){const he=j().filter(de=>de.focusable),U=he.find(de=>de.active),ge=he.find(de=>de.id===E),ae=[U,ge,...he].filter(Boolean).map(de=>de.ref.current);RR(ae,v)}}O.current=!1}),onBlur:$t(r.onBlur,()=>I(!1))})})}),AR="RovingFocusGroupItem",IR=w.forwardRef((r,e)=>{const{__scopeRovingFocusGroup:t,focusable:n=!0,active:s=!1,tabStopId:i,children:c,...d}=r,m=ql(),p=i||m,v=M9(AR,t),x=v.currentTabStopId===p,b=NR(t),{onFocusableItemAdd:S,onFocusableItemRemove:N,currentTabStopId:E}=v;return w.useEffect(()=>{if(n)return S(),()=>N()},[n,S,N]),u.jsx(yb.ItemSlot,{scope:t,id:p,focusable:n,active:s,children:u.jsx(Ur.span,{tabIndex:x?0:-1,"data-orientation":v.orientation,...d,ref:e,onMouseDown:$t(r.onMouseDown,T=>{n?v.onItemFocus(p):T.preventDefault()}),onFocus:$t(r.onFocus,()=>v.onItemFocus(p)),onKeyDown:$t(r.onKeyDown,T=>{if(T.key==="Tab"&&T.shiftKey){v.onItemShiftTab();return}if(T.target!==T.currentTarget)return;const A=H9(T,v.orientation,v.dir);if(A!==void 0){if(T.metaKey||T.ctrlKey||T.altKey||T.shiftKey)return;T.preventDefault();let D=b().filter(j=>j.focusable).map(j=>j.ref.current);if(A==="last")D.reverse();else if(A==="prev"||A==="next"){A==="prev"&&D.reverse();const j=D.indexOf(T.currentTarget);D=v.loop?B9(D,j+1):D.slice(j+1)}setTimeout(()=>RR(D))}}),children:typeof c=="function"?c({isCurrentTabStop:x,hasTabStop:E!=null}):c})})});IR.displayName=AR;var U9={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function z9(r,e){return e!=="rtl"?r:r==="ArrowLeft"?"ArrowRight":r==="ArrowRight"?"ArrowLeft":r}function H9(r,e,t){const n=z9(r.key,t);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return U9[n]}function RR(r,e=!1){const t=document.activeElement;for(const n of r)if(n===t||(n.focus({preventScroll:e}),document.activeElement!==t))return}function B9(r,e){return r.map((t,n)=>r[(e+n)%r.length])}var PR=TR,jR=IR,a0="Tabs",[G9]=Za(a0,[i0]),FR=i0(),[W9,kS]=G9(a0),OR=w.forwardRef((r,e)=>{const{__scopeTabs:t,value:n,onValueChange:s,defaultValue:i,orientation:c="horizontal",dir:d,activationMode:m="automatic",...p}=r,v=o0(d),[x,b]=su({prop:n,onChange:s,defaultProp:i??"",caller:a0});return u.jsx(W9,{scope:t,baseId:ql(),value:x,onValueChange:b,orientation:c,dir:v,activationMode:m,children:u.jsx(Ur.div,{dir:v,"data-orientation":c,...p,ref:e})})});OR.displayName=a0;var DR="TabsList",LR=w.forwardRef((r,e)=>{const{__scopeTabs:t,loop:n=!0,...s}=r,i=kS(DR,t),c=FR(t);return u.jsx(PR,{asChild:!0,...c,orientation:i.orientation,dir:i.dir,loop:n,children:u.jsx(Ur.div,{role:"tablist","aria-orientation":i.orientation,...s,ref:e})})});LR.displayName=DR;var MR="TabsTrigger",$R=w.forwardRef((r,e)=>{const{__scopeTabs:t,value:n,disabled:s=!1,...i}=r,c=kS(MR,t),d=FR(t),m=HR(c.baseId,n),p=BR(c.baseId,n),v=n===c.value;return u.jsx(jR,{asChild:!0,...d,focusable:!s,active:v,children:u.jsx(Ur.button,{type:"button",role:"tab","aria-selected":v,"aria-controls":p,"data-state":v?"active":"inactive","data-disabled":s?"":void 0,disabled:s,id:m,...i,ref:e,onMouseDown:$t(r.onMouseDown,x=>{!s&&x.button===0&&x.ctrlKey===!1?c.onValueChange(n):x.preventDefault()}),onKeyDown:$t(r.onKeyDown,x=>{[" ","Enter"].includes(x.key)&&c.onValueChange(n)}),onFocus:$t(r.onFocus,()=>{const x=c.activationMode!=="manual";!v&&!s&&x&&c.onValueChange(n)})})})});$R.displayName=MR;var UR="TabsContent",zR=w.forwardRef((r,e)=>{const{__scopeTabs:t,value:n,forceMount:s,children:i,...c}=r,d=kS(UR,t),m=HR(d.baseId,n),p=BR(d.baseId,n),v=n===d.value,x=w.useRef(v);return w.useEffect(()=>{const b=requestAnimationFrame(()=>x.current=!1);return()=>cancelAnimationFrame(b)},[]),u.jsx(da,{present:s||v,children:({present:b})=>u.jsx(Ur.div,{"data-state":v?"active":"inactive","data-orientation":d.orientation,role:"tabpanel","aria-labelledby":m,hidden:!b,id:p,tabIndex:0,...c,ref:e,style:{...r.style,animationDuration:x.current?"0s":void 0},children:b&&i})})});zR.displayName=UR;function HR(r,e){return`${r}-trigger-${e}`}function BR(r,e){return`${r}-content-${e}`}var V9=OR,GR=LR,WR=$R,VR=zR;const q9=V9,qR=w.forwardRef(({className:r,...e},t)=>u.jsx(GR,{ref:t,className:Fr("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",r),...e}));qR.displayName=GR.displayName;const ty=w.forwardRef(({className:r,...e},t)=>u.jsx(WR,{ref:t,className:Fr("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm overflow-x-hidden",r),...e}));ty.displayName=WR.displayName;const ry=w.forwardRef(({className:r,...e},t)=>u.jsx(VR,{ref:t,className:Fr("ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",r),...e}));ry.displayName=VR.displayName;const K9="https://rubypowerslaw.filevineapp.com",Mr="src/sidepanel/panels/DocViewerPanel.tsx",KR=({documentId:r,documentName:e,onBack:t})=>{const n=Jr();n.info(`[DocViewerPanel] Initializing with documentId: ${r}, documentName: ${e}`,{sourceFile:Mr});const[s,i]=w.useState(null),[c,d]=w.useState(!0),[m,p]=w.useState(null),[v,x]=w.useState("other"),[b,S]=w.useState(!0),[N,E]=w.useState(!1),[T,A]=w.useState(0),[I,D]=w.useState(!1),j=w.useRef(null),O=w.useCallback(U=>{n.info(`[DocViewerPanel] getDocumentType called with extension: ${U}`,{sourceFile:Mr});const ge=["jpg","jpeg","png","gif","bmp","webp","svg","tiff"],ie=["pdf"],ae=["doc","docx","xls","xlsx","ppt","pptx","odt","ods","odp","rtf"],de=["txt","md","csv","json","xml","html","htm"];let J="other";return ge.includes(U)?J="image":ie.includes(U)?J="pdf":ae.includes(U)?J="office":de.includes(U)&&(J="text"),n.info(`[DocViewerPanel] Document type determined: ${J} for extension: ${U}`,{sourceFile:Mr}),J},[n]);w.useEffect(()=>{(async()=>{var ge;if(n.info(`[DocViewerPanel] Starting fetchDocumentUrl for documentId: ${r}`,{sourceFile:Mr}),!r){n.warn("[DocViewerPanel] No document ID provided",{sourceFile:Mr,error:"No document ID provided"}),p("No document ID provided"),d(!1);return}d(!0),p(null);try{n.info(`[DocViewerPanel] Fetching document URL from server for documentId: ${r}`,{sourceFile:Mr});const ie=await s8("filevine",r.toString(),n);if(n.info("[DocViewerPanel] Received document data:",{sourceFile:Mr,documentData:ie}),!ie.url){const J=new Error("Document URL not found in response");throw n.error("[DocViewerPanel] Document URL not found in response",J,{sourceFile:Mr}),J}n.info(`[DocViewerPanel] Setting document URL: ${ie.url}`,{sourceFile:Mr}),i(ie.url);const ae=((ge=e.split(".").pop())==null?void 0:ge.toLowerCase())||"";n.info(`[DocViewerPanel] Detected file extension: ${ae}`,{sourceFile:Mr});const de=O(ae);n.info(`[DocViewerPanel] Determined document type: ${de}`,{sourceFile:Mr}),x(de)}catch(ie){n.error("[DocViewerPanel] Error fetching document URL:",ie,{sourceFile:Mr}),p("Failed to load document. Please try again later.")}finally{d(!1)}})()},[r,e,T,n,O]),w.useEffect(()=>(j.current&&(clearTimeout(j.current),j.current=null),D(!1),!c&&b&&v!=="image"&&(n.info("[DocViewerPanel] Setting loading timeout for document",{sourceFile:Mr}),j.current=setTimeout(()=>{n.info("[DocViewerPanel] Document loading is taking too long",{sourceFile:Mr}),D(!0)},1e4)),()=>{j.current&&(clearTimeout(j.current),j.current=null)}),[c,b,v,n]);const B=()=>{n.info("[DocViewerPanel] iframe loaded successfully",{sourceFile:Mr}),S(!1),E(!1),D(!1),j.current&&(clearTimeout(j.current),j.current=null)},G=U=>{n.error("[DocViewerPanel] iframe error:",U,{sourceFile:Mr}),S(!1),E(!0),D(!1),j.current&&(clearTimeout(j.current),j.current=null)},K=()=>{n.info("[DocViewerPanel] Retrying document load",{sourceFile:Mr}),S(!0),E(!1),D(!1),A(U=>U+1)},re=()=>{if(r){const U=`${K9}/docwebviewer/view/${r}`;n.info(`[DocViewerPanel] Opening document in new tab with original URL: ${U}`,{sourceFile:Mr}),window.open(U,"_blank")}},se=()=>{if(!s){n.warn("[DocViewerPanel] No document URL available for download",{sourceFile:Mr});return}try{n.info(`[DocViewerPanel] Starting download for: ${e}`,{sourceFile:Mr});const U=new URL(s);U.searchParams.set("response-content-disposition",`attachment; filename="${encodeURIComponent(e)}"`);const ge=document.createElement("a");ge.href=U.toString(),ge.download=e,ge.target="_blank",ge.rel="noopener noreferrer",document.body.appendChild(ge),ge.click(),setTimeout(()=>{document.body.removeChild(ge)},100),n.info(`[DocViewerPanel] Download initiated for: ${e}`,{sourceFile:Mr})}catch(U){n.error("[DocViewerPanel] Error downloading document:",U,{sourceFile:Mr})}};if(c)return n.info("[DocViewerPanel] Rendering loading state",{sourceFile:Mr}),u.jsxs(Es,{className:"w-full h-full",children:[u.jsx(lo,{className:"pb-4",children:u.jsxs("div",{className:"flex flex-row items-start gap-3",children:[u.jsx(Ye,{variant:"ghost",size:"sm",onClick:t,className:"h-8 w-8 p-0 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors shrink-0 mt-0.5","aria-label":"Go back",title:"Go back",children:u.jsx(Tm,{className:"h-4 w-4"})}),u.jsx(co,{className:"text-base font-semibold leading-relaxed break-words flex-1 min-w-0",children:e})]})}),u.jsx(ks,{className:"flex items-center justify-center h-[80vh]",children:u.jsxs("div",{className:"text-center",children:[u.jsx(ia,{className:"h-8 w-8 animate-spin mx-auto mb-4 text-blue-600 dark:text-blue-400"}),u.jsx("p",{className:"dark:text-gray-200",children:"Loading document..."})]})})]});if(m)return n.info(`[DocViewerPanel] Rendering error state: ${m}`,{sourceFile:Mr}),u.jsxs(Es,{className:"w-full h-full",children:[u.jsx(lo,{className:"pb-4",children:u.jsxs("div",{className:"flex flex-row items-start gap-3",children:[u.jsx(Ye,{variant:"ghost",size:"sm",onClick:t,className:"h-8 w-8 p-0 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors shrink-0 mt-0.5","aria-label":"Go back",title:"Go back",children:u.jsx(Tm,{className:"h-4 w-4"})}),u.jsx(co,{className:"text-base font-semibold leading-relaxed break-words flex-1 min-w-0",children:e})]})}),u.jsx(ks,{className:"flex items-center justify-center h-[80vh]",children:u.jsxs("div",{className:"text-center text-red-500",children:[u.jsx("p",{children:m}),u.jsxs(Ye,{variant:"outline",className:"mt-4",onClick:K,children:[u.jsx(si,{className:"h-4 w-4 mr-2"}),"Retry"]})]})})]});const he=()=>{if(n.info(`[DocViewerPanel] renderDocumentViewer called with documentType: ${v}, documentUrl: ${s}`,{sourceFile:Mr}),!s)return n.info("[DocViewerPanel] No document URL available, returning null",{sourceFile:Mr}),null;const U=`https://docs.google.com/viewer?url=${encodeURIComponent(s||"")}&embedded=true`;n.info(`[DocViewerPanel] Google Docs Viewer URL: ${U}`,{sourceFile:Mr});const ge=v==="pdf"?"PDF":v==="office"?"Office document":v==="text"?"Text document":v==="image"?"Image":"Document";return v==="image"?(n.info("[DocViewerPanel] Rendering image viewer",{sourceFile:Mr}),u.jsx("div",{className:"w-full h-full flex items-center justify-center overflow-auto",children:u.jsx("img",{src:s,alt:e,className:"max-w-full max-h-full object-contain",onLoad:()=>S(!1),onError:()=>{S(!1),E(!0)}})})):(n.info(`[DocViewerPanel] Rendering ${ge} viewer with Google Docs for: ${e}`,{sourceFile:Mr}),u.jsxs("div",{className:"w-full h-full relative",children:[b&&u.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white dark:bg-gray-900 bg-opacity-80 dark:bg-opacity-80 z-10",children:u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 dark:border-gray-100 mx-auto mb-4"}),u.jsxs("p",{className:"dark:text-gray-200",children:["Loading ",ge.toLowerCase(),"..."]}),u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-2",children:"This may take a moment for large files"}),I&&u.jsxs("div",{className:"mt-4 p-4 bg-yellow-50 border border-yellow-200 rounded-md",children:[u.jsx("p",{className:"text-amber-700 font-medium",children:"This is taking longer than expected."}),u.jsx("p",{className:"text-sm text-amber-600 mt-1",children:v==="office"?"Office documents can sometimes be slow to load in the viewer.":"This document might be large or complex."}),u.jsxs("div",{className:"mt-3 flex justify-center space-x-3",children:[u.jsxs(Ye,{variant:"outline",size:"sm",onClick:K,children:[u.jsx(si,{className:"h-3 w-3 mr-1"}),"Retry"]}),u.jsx(Ye,{variant:"default",size:"sm",onClick:re,children:"Open in new tab"})]})]})]})}),N&&u.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white dark:bg-gray-900 z-10",children:u.jsxs("div",{className:"text-center text-red-500 dark:text-red-400",children:[u.jsxs("p",{children:["Failed to load ",ge.toLowerCase(),"."]}),u.jsx("p",{className:"text-sm mt-2 dark:text-gray-400",children:"The document might be too large or in an unsupported format."}),u.jsxs("div",{className:"mt-4 flex justify-center space-x-3",children:[u.jsxs(Ye,{variant:"outline",onClick:K,children:[u.jsx(si,{className:"h-4 w-4 mr-2"}),"Retry"]}),u.jsx(Ye,{variant:"default",onClick:re,children:"Open in new tab"})]})]})}),u.jsx("iframe",{src:U,className:"w-full h-full border-none",title:e,sandbox:"allow-scripts allow-same-origin allow-forms allow-popups allow-popups-to-escape-sandbox",onLoad:B,onError:G})]}))};return n.info(`[DocViewerPanel] Rendering main component with documentType: ${v}`,{sourceFile:Mr}),u.jsxs(Es,{className:"w-full h-full",children:[u.jsxs(lo,{className:"pb-4",children:[u.jsxs("div",{className:"flex flex-row items-start gap-3",children:[u.jsx(Ye,{variant:"ghost",size:"sm",onClick:t,className:"h-8 w-8 p-0 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors shrink-0 mt-0.5","aria-label":"Go back",title:"Go back",children:u.jsx(Tm,{className:"h-4 w-4"})}),u.jsx(co,{className:"text-base font-semibold leading-relaxed break-words flex-1 min-w-0",children:e})]}),!c&&u.jsxs("div",{className:"flex gap-2 pl-8 pr-6",children:[u.jsxs(Ye,{variant:"outline",size:"sm",onClick:se,className:"h-9 px-4","aria-label":"Download file",children:[u.jsx(aB,{className:"h-4 w-4 mr-2"}),"Download"]}),u.jsxs(Ye,{variant:"outline",size:"sm",onClick:re,className:"h-9 px-4","aria-label":"Open in new tab",children:[u.jsx(Wa,{className:"h-4 w-4 mr-2"}),"Open in new tab"]})]})]}),u.jsx(ks,{className:"h-[80vh] overflow-hidden",children:he()})]})},Ll="src/sidepanel/panels/ClientDocumentsPanel.tsx",Y9="https://rubypowerslaw.filevineapp.com",J9=({clientEmail:r,projectId:e,documents:t,isLoading:n,error:s,goBack:i,initialSelectedDocument:c})=>{const d=Jr(),[m,p]=w.useState([]),[v,x]=w.useState(!1),[b,S]=w.useState(null),[N,E]=w.useState(""),[T,A]=w.useState(null),[I,D]=w.useState({contracts:!1,payments:!1,allDocuments:!0}),[j,O]=w.useState({});w.useEffect(()=>{const $={sourceFile:Ll,functionName:"useEffect[fetchData]"};if(t&&t.length>0||n){t&&p(t);return}(async()=>{if(!e){S("No project ID provided. Please select a valid project.");return}x(!0),S(null);try{const F=await mT(e,d);if(F){d.debug("Using cached documents for project",{...$,data:{projectId:e}}),p(F),x(!1);return}d.debug("ClientDocumentsPanel: Fetching documents from server for project",{...$,data:{projectId:e}});const te=(await RT("filevine",e,d)).documents.map(Se=>({name:Se.filename,url:`${Y9}/docwebviewer/view/${Se.documentId}`,documentId:Se.documentId,folderName:Se.folderName}));await pT(e,te,d),p(te)}catch(F){d.error("Error fetching documents:",F,$),S("Failed to load documents. Please try again later.")}finally{x(!1)}})()},[e,t,n,d]);const B=n!==void 0?n:v,G=s!==void 0?s:b,K=br.useMemo(()=>{const $={sourceFile:Ll,functionName:"useMemo[filteredDocuments]"};return d.debug("Computing filteredDocuments",$),m.filter(Q=>Q.name.toLowerCase().includes(N.toLowerCase()))},[m,N,d]),re=m.filter($=>$.folderName&&$.folderName.toLowerCase().includes("contract")),se=m.filter($=>$.folderName&&$.folderName.toLowerCase().includes("payment")),he=$=>{var te;const Q={sourceFile:Ll,functionName:"isViewableDocument",data:{filename:$}},F=(te=$.split(".").pop())==null?void 0:te.toLowerCase(),H=["pdf","jpg","jpeg","png","gif","bmp","webp","doc","docx","xls","xlsx","ppt","pptx","odt","ods","odp","rtf","txt"];return d.debug(`File extension: ${F}`,Q),d.debug(`Viewable extensions: ${H}`,Q),H.includes(F||"")},U=$=>{var F;const Q=((F=$.split(".").pop())==null?void 0:F.toLowerCase())||"";return["jpg","jpeg","png","gif","bmp","webp","svg","tiff"].includes(Q)?u.jsx(fB,{className:"h-4 w-4 text-purple-500 dark:text-purple-400"}):["xls","xlsx","csv","ods"].includes(Q)?u.jsx(cB,{className:"h-4 w-4 text-green-500 dark:text-green-400"}):["ppt","pptx","odp"].includes(Q)?u.jsx(vB,{className:"h-4 w-4 text-orange-500 dark:text-orange-400"}):["pdf","doc","docx","txt","rtf","odt"].includes(Q)?u.jsx(Xc,{className:"h-4 w-4 text-blue-500 dark:text-blue-400"}):u.jsx(uB,{className:"h-4 w-4 text-gray-500 dark:text-gray-400"})},ge=$=>{const Q={sourceFile:Ll,functionName:"handleViewDocument",data:{docName:$.name,docId:$.documentId,url:$.url,folder:$.folderName}};d.debug("Handling view document",Q),$.documentId&&he($.name)?(d.debug("Selected document",Q),A({name:$.name,documentId:$.documentId,url:$.url,folderName:$.folderName})):$.url&&(d.debug("Opening document URL",Q),window.open($.url,"_blank"))},ie=$=>{D(Q=>({...Q,[$]:!Q[$]}))},ae=$=>{const Q={sourceFile:Ll,functionName:"toggleFolder",data:{folderName:$}};d.debug("Toggling folder",Q),O(F=>({...F,[$]:!F[$]}))},de=br.useCallback($=>{const Q={sourceFile:Ll,functionName:"groupDocumentsByFolder"};d.debug("Running groupDocumentsByFolder",Q);const F={};return F["No Folder"]=[],$.forEach(H=>{const te=H.folderName||"No Folder";F[te]||(F[te]=[]),F[te].push(H)}),F["No Folder"].length===0&&delete F["No Folder"],F},[d]),J=br.useMemo(()=>{const $={sourceFile:Ll,functionName:"useMemo[groupedFilteredDocuments]"};return d.debug("Computing groupedFilteredDocuments",$),de(K)},[K,de,d]);w.useEffect(()=>{const $={sourceFile:Ll,functionName:"useEffect[folderExpansion]"};if(d.debug("Running folder expansion initialization effect",$),K.length>0){const Q=Object.keys(J);d.debug(`Found folders: ${Q.join(", ")}`,$),O(F=>{const H={...F};let te=!1;return Q.forEach(Se=>{H[Se]===void 0&&(H[Se]=!1,te=!0)}),te?H:F})}},[J,K.length,d]),w.useEffect(()=>{const $={sourceFile:Ll,functionName:"useEffect[initialSelectedDocument]"};c&&(d.debug("Setting initial selected document",{...$,document:c}),A({name:c.name,documentId:c.documentId,url:c.url}))},[c,d]);const Y=()=>!B&&!G&&m.length===0?u.jsx("div",{className:"text-gray-500 dark:text-gray-400 text-center py-4",children:"No documents found for this client."}):!B&&!G&&m.length>0?u.jsxs("div",{className:"space-y-4",children:[re.length>0&&u.jsxs("div",{children:[u.jsxs("button",{onClick:()=>ie("contracts"),className:"flex items-center justify-between w-full py-2 text-left font-medium text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-md px-2",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx(Xc,{className:"h-4 w-4 mr-2 text-blue-500 dark:text-blue-400"}),u.jsxs("span",{children:["Contracts (",re.length,")"]})]}),I.contracts?u.jsx(Pv,{className:"h-4 w-4"}):u.jsx(ls,{className:"h-4 w-4"})]}),I.contracts&&u.jsx("ul",{className:"ml-6 mt-2 space-y-1 text-sm",children:re.map($=>u.jsxs("li",{className:"flex items-center gap-2 text-gray-600 dark:text-gray-400",children:[u.jsx("span",{className:"flex-shrink-0",children:U($.name)}),u.jsx("button",{onClick:()=>ge($),className:"text-blue-600 dark:text-blue-400 hover:underline hover:text-blue-800 dark:hover:text-blue-300 focus:outline-none text-left truncate min-w-0",title:$.name,children:$.name})]},$.documentId))})]}),se.length>0&&u.jsxs("div",{children:[u.jsxs("button",{onClick:()=>ie("payments"),className:"flex items-center justify-between w-full py-2 text-left font-medium text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-md px-2",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx(iB,{className:"h-4 w-4 mr-2 text-green-500 dark:text-green-400"}),u.jsxs("span",{children:["Payments (",se.length,")"]})]}),I.payments?u.jsx(Pv,{className:"h-4 w-4"}):u.jsx(ls,{className:"h-4 w-4"})]}),I.payments&&u.jsx("ul",{className:"ml-6 mt-2 space-y-1 text-sm",children:se.map($=>u.jsxs("li",{className:"flex items-center gap-2 text-gray-600 dark:text-gray-400",children:[u.jsx("span",{className:"flex-shrink-0",children:U($.name)}),u.jsx("button",{onClick:()=>ge($),className:"text-blue-600 dark:text-blue-400 hover:underline hover:text-blue-800 dark:hover:text-blue-300 focus:outline-none text-left truncate min-w-0",title:$.name,children:$.name})]},$.documentId))})]}),K.length>0&&u.jsxs("div",{children:[u.jsxs("button",{onClick:()=>ie("allDocuments"),className:"flex items-center justify-between w-full py-2 text-left font-medium text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-md px-2",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx(Xc,{className:"h-4 w-4 mr-2 text-gray-500 dark:text-gray-400"}),u.jsxs("span",{children:["All Documents (",K.length,")"]})]}),I.allDocuments?u.jsx(Pv,{className:"h-4 w-4"}):u.jsx(ls,{className:"h-4 w-4"})]}),I.allDocuments&&u.jsx("div",{className:"ml-2 mt-2 space-y-2 text-sm",children:Object.entries(J).map(([$,Q])=>u.jsxs("div",{children:[u.jsxs("button",{onClick:()=>ae($),className:"flex items-center justify-between w-full py-1 text-left font-medium text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-md px-1",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(dB,{className:"h-4 w-4 text-amber-500 dark:text-amber-400"}),u.jsxs("span",{children:[$," (",Q.length,")"]})]}),j[$]?u.jsx(Pv,{className:"h-4 w-4"}):u.jsx(ls,{className:"h-4 w-4"})]}),j[$]&&u.jsx("ul",{className:"ml-6 mt-1 space-y-1",children:Q.map(F=>u.jsxs("li",{className:"flex items-center gap-2 text-gray-600 dark:text-gray-400",children:[u.jsx("span",{className:"flex-shrink-0",children:U(F.name)}),u.jsx("button",{onClick:()=>ge(F),className:"text-blue-600 dark:text-blue-400 hover:underline hover:text-blue-800 dark:hover:text-blue-300 focus:outline-none text-left truncate min-w-0",title:F.name,children:F.name})]},F.documentId))})]},$))})]})]}):null;return u.jsx("div",{className:"flex flex-col h-full bg-background",children:u.jsx("div",{className:"flex-grow overflow-hidden",children:T?u.jsx(KR,{documentId:T.documentId,documentName:T.name,onBack:()=>A(null)}):B?u.jsxs(Es,{className:"w-full h-full",children:[u.jsx(lo,{className:"pb-4",children:u.jsxs("div",{className:"flex flex-row items-start gap-3",children:[i&&u.jsx(Ye,{variant:"ghost",size:"sm",onClick:i,className:"h-8 w-8 p-0 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors shrink-0 mt-0.5","aria-label":"Go back",title:"Go back",children:u.jsx(Tm,{className:"h-4 w-4"})}),u.jsx(co,{className:"text-base font-semibold leading-relaxed break-words flex-1 min-w-0",children:"Project Documents"})]})}),u.jsx(ks,{className:"flex items-center justify-center h-[80vh]",children:u.jsxs("div",{className:"text-center",children:[u.jsx(ia,{className:"h-8 w-8 animate-spin mx-auto mb-4 text-blue-600 dark:text-blue-400"}),u.jsx("p",{className:"dark:text-gray-200",children:"Loading documents..."})]})})]}):G?u.jsxs("div",{className:"text-red-600 bg-red-50 p-3 rounded-md",children:["Error: ",G]}):u.jsxs(Es,{className:"mb-4",children:[u.jsx(lo,{className:"pb-2",children:u.jsxs("div",{className:"flex flex-row items-start gap-3",children:[i&&u.jsx(Ye,{variant:"ghost",size:"sm",onClick:i,className:"h-8 w-8 p-0 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors shrink-0 mt-0.5","aria-label":"Go back",title:"Go back",children:u.jsx(Tm,{className:"h-4 w-4"})}),u.jsx(co,{className:"text-base font-semibold leading-relaxed break-words flex-1 min-w-0",children:"Project Documents"})]})}),u.jsxs(ks,{className:"px-4 pt-2 pb-4",children:[u.jsxs("div",{className:"relative mb-4",children:[u.jsx(Ii,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),u.jsx(pn,{type:"text",placeholder:"Search All Documents...",value:N,onChange:$=>E($.target.value),className:"w-full pl-9 pr-4 py-2 h-9 text-sm border rounded-md"})]}),u.jsx("div",{className:"overflow-y-auto max-h-[80vh] pb-32",children:Y()})]})]})})})};function X9(r){const e=Q9(r),t=w.forwardRef((n,s)=>{const{children:i,...c}=n,d=w.Children.toArray(i),m=d.find(eV);if(m){const p=m.props.children,v=d.map(x=>x===m?w.Children.count(p)>1?w.Children.only(null):w.isValidElement(p)?p.props.children:null:x);return u.jsx(e,{...c,ref:s,children:w.isValidElement(p)?w.cloneElement(p,void 0,v):null})}return u.jsx(e,{...c,ref:s,children:i})});return t.displayName=`${r}.Slot`,t}function Q9(r){const e=w.forwardRef((t,n)=>{const{children:s,...i}=t;if(w.isValidElement(s)){const c=rV(s),d=tV(i,s.props);return s.type!==w.Fragment&&(d.ref=n?nu(n,c):c),w.cloneElement(s,d)}return w.Children.count(s)>1?w.Children.only(null):null});return e.displayName=`${r}.SlotClone`,e}var Z9=Symbol("radix.slottable");function eV(r){return w.isValidElement(r)&&typeof r.type=="function"&&"__radixId"in r.type&&r.type.__radixId===Z9}function tV(r,e){const t={...e};for(const n in e){const s=r[n],i=e[n];/^on[A-Z]/.test(n)?s&&i?t[n]=(...d)=>{const m=i(...d);return s(...d),m}:s&&(t[n]=s):n==="style"?t[n]={...s,...i}:n==="className"&&(t[n]=[s,i].filter(Boolean).join(" "))}return{...r,...t}}function rV(r){var n,s;let e=(n=Object.getOwnPropertyDescriptor(r.props,"ref"))==null?void 0:n.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=(s=Object.getOwnPropertyDescriptor(r,"ref"))==null?void 0:s.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}var xb=["Enter"," "],nV=["ArrowDown","PageUp","Home"],YR=["ArrowUp","PageDown","End"],sV=[...nV,...YR],oV={ltr:[...xb,"ArrowRight"],rtl:[...xb,"ArrowLeft"]},iV={ltr:["ArrowLeft"],rtl:["ArrowRight"]},lg="Menu",[Km,aV,lV]=ES(lg),[gd,JR]=Za(lg,[lV,Qy,i0]),l0=Qy(),XR=i0(),[cV,vd]=gd(lg),[uV,cg]=gd(lg),QR=r=>{const{__scopeMenu:e,open:t=!1,children:n,dir:s,onOpenChange:i,modal:c=!0}=r,d=l0(e),[m,p]=w.useState(null),v=w.useRef(!1),x=Ql(i),b=o0(s);return w.useEffect(()=>{const S=()=>{v.current=!0,document.addEventListener("pointerdown",N,{capture:!0,once:!0}),document.addEventListener("pointermove",N,{capture:!0,once:!0})},N=()=>v.current=!1;return document.addEventListener("keydown",S,{capture:!0}),()=>{document.removeEventListener("keydown",S,{capture:!0}),document.removeEventListener("pointerdown",N,{capture:!0}),document.removeEventListener("pointermove",N,{capture:!0})}},[]),u.jsx(SI,{...d,children:u.jsx(cV,{scope:e,open:t,onOpenChange:x,content:m,onContentChange:p,children:u.jsx(uV,{scope:e,onClose:w.useCallback(()=>x(!1),[x]),isUsingKeyboardRef:v,dir:b,modal:c,children:n})})})};QR.displayName=lg;var dV="MenuAnchor",CS=w.forwardRef((r,e)=>{const{__scopeMenu:t,...n}=r,s=l0(t);return u.jsx(EI,{...s,...n,ref:e})});CS.displayName=dV;var NS="MenuPortal",[fV,ZR]=gd(NS,{forceMount:void 0}),eP=r=>{const{__scopeMenu:e,forceMount:t,children:n,container:s}=r,i=vd(NS,e);return u.jsx(fV,{scope:e,forceMount:t,children:u.jsx(da,{present:t||i.open,children:u.jsx(pS,{asChild:!0,container:s,children:n})})})};eP.displayName=NS;var ji="MenuContent",[hV,TS]=gd(ji),tP=w.forwardRef((r,e)=>{const t=ZR(ji,r.__scopeMenu),{forceMount:n=t.forceMount,...s}=r,i=vd(ji,r.__scopeMenu),c=cg(ji,r.__scopeMenu);return u.jsx(Km.Provider,{scope:r.__scopeMenu,children:u.jsx(da,{present:n||i.open,children:u.jsx(Km.Slot,{scope:r.__scopeMenu,children:c.modal?u.jsx(pV,{...s,ref:e}):u.jsx(mV,{...s,ref:e})})})})}),pV=w.forwardRef((r,e)=>{const t=vd(ji,r.__scopeMenu),n=w.useRef(null),s=$n(e,n);return w.useEffect(()=>{const i=n.current;if(i)return JI(i)},[]),u.jsx(AS,{...r,ref:s,trapFocus:t.open,disableOutsidePointerEvents:t.open,disableOutsideScroll:!0,onFocusOutside:$t(r.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>t.onOpenChange(!1)})}),mV=w.forwardRef((r,e)=>{const t=vd(ji,r.__scopeMenu);return u.jsx(AS,{...r,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>t.onOpenChange(!1)})}),gV=X9("MenuContent.ScrollLock"),AS=w.forwardRef((r,e)=>{const{__scopeMenu:t,loop:n=!1,trapFocus:s,onOpenAutoFocus:i,onCloseAutoFocus:c,disableOutsidePointerEvents:d,onEntryFocus:m,onEscapeKeyDown:p,onPointerDownOutside:v,onFocusOutside:x,onInteractOutside:b,onDismiss:S,disableOutsideScroll:N,...E}=r,T=vd(ji,t),A=cg(ji,t),I=l0(t),D=XR(t),j=aV(t),[O,B]=w.useState(null),G=w.useRef(null),K=$n(e,G,T.onContentChange),re=w.useRef(0),se=w.useRef(""),he=w.useRef(0),U=w.useRef(null),ge=w.useRef("right"),ie=w.useRef(0),ae=N?xS:w.Fragment,de=N?{as:gV,allowPinchZoom:!0}:void 0,J=$=>{var X,we;const Q=se.current+$,F=j().filter(Ne=>!Ne.disabled),H=document.activeElement,te=(X=F.find(Ne=>Ne.ref.current===H))==null?void 0:X.textValue,Se=F.map(Ne=>Ne.textValue),ue=TV(Se,Q,te),ke=(we=F.find(Ne=>Ne.textValue===ue))==null?void 0:we.ref.current;(function Ne(Me){se.current=Me,window.clearTimeout(re.current),Me!==""&&(re.current=window.setTimeout(()=>Ne(""),1e3))})(Q),ke&&setTimeout(()=>ke.focus())};w.useEffect(()=>()=>window.clearTimeout(re.current),[]),HI();const Y=w.useCallback($=>{var F,H;return ge.current===((F=U.current)==null?void 0:F.side)&&IV($,(H=U.current)==null?void 0:H.area)},[]);return u.jsx(hV,{scope:t,searchRef:se,onItemEnter:w.useCallback($=>{Y($)&&$.preventDefault()},[Y]),onItemLeave:w.useCallback($=>{var Q;Y($)||((Q=G.current)==null||Q.focus(),B(null))},[Y]),onTriggerLeave:w.useCallback($=>{Y($)&&$.preventDefault()},[Y]),pointerGraceTimerRef:he,onPointerGraceIntentChange:w.useCallback($=>{U.current=$},[]),children:u.jsx(ae,{...de,children:u.jsx(yS,{asChild:!0,trapped:s,onMountAutoFocus:$t(i,$=>{var Q;$.preventDefault(),(Q=G.current)==null||Q.focus({preventScroll:!0})}),onUnmountAutoFocus:c,children:u.jsx(Zy,{asChild:!0,disableOutsidePointerEvents:d,onEscapeKeyDown:p,onPointerDownOutside:v,onFocusOutside:x,onInteractOutside:b,onDismiss:S,children:u.jsx(PR,{asChild:!0,...D,dir:A.dir,orientation:"vertical",loop:n,currentTabStopId:O,onCurrentTabStopIdChange:B,onEntryFocus:$t(m,$=>{A.isUsingKeyboardRef.current||$.preventDefault()}),preventScrollOnEntryFocus:!0,children:u.jsx(kI,{role:"menu","aria-orientation":"vertical","data-state":vP(T.open),"data-radix-menu-content":"",dir:A.dir,...I,...E,ref:K,style:{outline:"none",...E.style},onKeyDown:$t(E.onKeyDown,$=>{const F=$.target.closest("[data-radix-menu-content]")===$.currentTarget,H=$.ctrlKey||$.altKey||$.metaKey,te=$.key.length===1;F&&($.key==="Tab"&&$.preventDefault(),!H&&te&&J($.key));const Se=G.current;if($.target!==Se||!sV.includes($.key))return;$.preventDefault();const ke=j().filter(X=>!X.disabled).map(X=>X.ref.current);YR.includes($.key)&&ke.reverse(),CV(ke)}),onBlur:$t(r.onBlur,$=>{$.currentTarget.contains($.target)||(window.clearTimeout(re.current),se.current="")}),onPointerMove:$t(r.onPointerMove,Ym($=>{const Q=$.target,F=ie.current!==$.clientX;if($.currentTarget.contains(Q)&&F){const H=$.clientX>ie.current?"right":"left";ge.current=H,ie.current=$.clientX}}))})})})})})})});tP.displayName=ji;var vV="MenuGroup",IS=w.forwardRef((r,e)=>{const{__scopeMenu:t,...n}=r;return u.jsx(Ur.div,{role:"group",...n,ref:e})});IS.displayName=vV;var yV="MenuLabel",rP=w.forwardRef((r,e)=>{const{__scopeMenu:t,...n}=r;return u.jsx(Ur.div,{...n,ref:e})});rP.displayName=yV;var Py="MenuItem",dN="menu.itemSelect",c0=w.forwardRef((r,e)=>{const{disabled:t=!1,onSelect:n,...s}=r,i=w.useRef(null),c=cg(Py,r.__scopeMenu),d=TS(Py,r.__scopeMenu),m=$n(e,i),p=w.useRef(!1),v=()=>{const x=i.current;if(!t&&x){const b=new CustomEvent(dN,{bubbles:!0,cancelable:!0});x.addEventListener(dN,S=>n==null?void 0:n(S),{once:!0}),fI(x,b),b.defaultPrevented?p.current=!1:c.onClose()}};return u.jsx(nP,{...s,ref:m,disabled:t,onClick:$t(r.onClick,v),onPointerDown:x=>{var b;(b=r.onPointerDown)==null||b.call(r,x),p.current=!0},onPointerUp:$t(r.onPointerUp,x=>{var b;p.current||(b=x.currentTarget)==null||b.click()}),onKeyDown:$t(r.onKeyDown,x=>{const b=d.searchRef.current!=="";t||b&&x.key===" "||xb.includes(x.key)&&(x.currentTarget.click(),x.preventDefault())})})});c0.displayName=Py;var nP=w.forwardRef((r,e)=>{const{__scopeMenu:t,disabled:n=!1,textValue:s,...i}=r,c=TS(Py,t),d=XR(t),m=w.useRef(null),p=$n(e,m),[v,x]=w.useState(!1),[b,S]=w.useState("");return w.useEffect(()=>{const N=m.current;N&&S((N.textContent??"").trim())},[i.children]),u.jsx(Km.ItemSlot,{scope:t,disabled:n,textValue:s??b,children:u.jsx(jR,{asChild:!0,...d,focusable:!n,children:u.jsx(Ur.div,{role:"menuitem","data-highlighted":v?"":void 0,"aria-disabled":n||void 0,"data-disabled":n?"":void 0,...i,ref:p,onPointerMove:$t(r.onPointerMove,Ym(N=>{n?c.onItemLeave(N):(c.onItemEnter(N),N.defaultPrevented||N.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:$t(r.onPointerLeave,Ym(N=>c.onItemLeave(N))),onFocus:$t(r.onFocus,()=>x(!0)),onBlur:$t(r.onBlur,()=>x(!1))})})})}),xV="MenuCheckboxItem",sP=w.forwardRef((r,e)=>{const{checked:t=!1,onCheckedChange:n,...s}=r;return u.jsx(cP,{scope:r.__scopeMenu,checked:t,children:u.jsx(c0,{role:"menuitemcheckbox","aria-checked":jy(t)?"mixed":t,...s,ref:e,"data-state":PS(t),onSelect:$t(s.onSelect,()=>n==null?void 0:n(jy(t)?!0:!t),{checkForDefaultPrevented:!1})})})});sP.displayName=xV;var oP="MenuRadioGroup",[wV,bV]=gd(oP,{value:void 0,onValueChange:()=>{}}),iP=w.forwardRef((r,e)=>{const{value:t,onValueChange:n,...s}=r,i=Ql(n);return u.jsx(wV,{scope:r.__scopeMenu,value:t,onValueChange:i,children:u.jsx(IS,{...s,ref:e})})});iP.displayName=oP;var aP="MenuRadioItem",lP=w.forwardRef((r,e)=>{const{value:t,...n}=r,s=bV(aP,r.__scopeMenu),i=t===s.value;return u.jsx(cP,{scope:r.__scopeMenu,checked:i,children:u.jsx(c0,{role:"menuitemradio","aria-checked":i,...n,ref:e,"data-state":PS(i),onSelect:$t(n.onSelect,()=>{var c;return(c=s.onValueChange)==null?void 0:c.call(s,t)},{checkForDefaultPrevented:!1})})})});lP.displayName=aP;var RS="MenuItemIndicator",[cP,_V]=gd(RS,{checked:!1}),uP=w.forwardRef((r,e)=>{const{__scopeMenu:t,forceMount:n,...s}=r,i=_V(RS,t);return u.jsx(da,{present:n||jy(i.checked)||i.checked===!0,children:u.jsx(Ur.span,{...s,ref:e,"data-state":PS(i.checked)})})});uP.displayName=RS;var SV="MenuSeparator",dP=w.forwardRef((r,e)=>{const{__scopeMenu:t,...n}=r;return u.jsx(Ur.div,{role:"separator","aria-orientation":"horizontal",...n,ref:e})});dP.displayName=SV;var EV="MenuArrow",fP=w.forwardRef((r,e)=>{const{__scopeMenu:t,...n}=r,s=l0(t);return u.jsx(CI,{...s,...n,ref:e})});fP.displayName=EV;var kV="MenuSub",[OK,hP]=gd(kV),bm="MenuSubTrigger",pP=w.forwardRef((r,e)=>{const t=vd(bm,r.__scopeMenu),n=cg(bm,r.__scopeMenu),s=hP(bm,r.__scopeMenu),i=TS(bm,r.__scopeMenu),c=w.useRef(null),{pointerGraceTimerRef:d,onPointerGraceIntentChange:m}=i,p={__scopeMenu:r.__scopeMenu},v=w.useCallback(()=>{c.current&&window.clearTimeout(c.current),c.current=null},[]);return w.useEffect(()=>v,[v]),w.useEffect(()=>{const x=d.current;return()=>{window.clearTimeout(x),m(null)}},[d,m]),u.jsx(CS,{asChild:!0,...p,children:u.jsx(nP,{id:s.triggerId,"aria-haspopup":"menu","aria-expanded":t.open,"aria-controls":s.contentId,"data-state":vP(t.open),...r,ref:nu(e,s.onTriggerChange),onClick:x=>{var b;(b=r.onClick)==null||b.call(r,x),!(r.disabled||x.defaultPrevented)&&(x.currentTarget.focus(),t.open||t.onOpenChange(!0))},onPointerMove:$t(r.onPointerMove,Ym(x=>{i.onItemEnter(x),!x.defaultPrevented&&!r.disabled&&!t.open&&!c.current&&(i.onPointerGraceIntentChange(null),c.current=window.setTimeout(()=>{t.onOpenChange(!0),v()},100))})),onPointerLeave:$t(r.onPointerLeave,Ym(x=>{var S,N;v();const b=(S=t.content)==null?void 0:S.getBoundingClientRect();if(b){const E=(N=t.content)==null?void 0:N.dataset.side,T=E==="right",A=T?-5:5,I=b[T?"left":"right"],D=b[T?"right":"left"];i.onPointerGraceIntentChange({area:[{x:x.clientX+A,y:x.clientY},{x:I,y:b.top},{x:D,y:b.top},{x:D,y:b.bottom},{x:I,y:b.bottom}],side:E}),window.clearTimeout(d.current),d.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(x),x.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:$t(r.onKeyDown,x=>{var S;const b=i.searchRef.current!=="";r.disabled||b&&x.key===" "||oV[n.dir].includes(x.key)&&(t.onOpenChange(!0),(S=t.content)==null||S.focus(),x.preventDefault())})})})});pP.displayName=bm;var mP="MenuSubContent",gP=w.forwardRef((r,e)=>{const t=ZR(ji,r.__scopeMenu),{forceMount:n=t.forceMount,...s}=r,i=vd(ji,r.__scopeMenu),c=cg(ji,r.__scopeMenu),d=hP(mP,r.__scopeMenu),m=w.useRef(null),p=$n(e,m);return u.jsx(Km.Provider,{scope:r.__scopeMenu,children:u.jsx(da,{present:n||i.open,children:u.jsx(Km.Slot,{scope:r.__scopeMenu,children:u.jsx(AS,{id:d.contentId,"aria-labelledby":d.triggerId,...s,ref:p,align:"start",side:c.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:v=>{var x;c.isUsingKeyboardRef.current&&((x=m.current)==null||x.focus()),v.preventDefault()},onCloseAutoFocus:v=>v.preventDefault(),onFocusOutside:$t(r.onFocusOutside,v=>{v.target!==d.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:$t(r.onEscapeKeyDown,v=>{c.onClose(),v.preventDefault()}),onKeyDown:$t(r.onKeyDown,v=>{var S;const x=v.currentTarget.contains(v.target),b=iV[c.dir].includes(v.key);x&&b&&(i.onOpenChange(!1),(S=d.trigger)==null||S.focus(),v.preventDefault())})})})})})});gP.displayName=mP;function vP(r){return r?"open":"closed"}function jy(r){return r==="indeterminate"}function PS(r){return jy(r)?"indeterminate":r?"checked":"unchecked"}function CV(r){const e=document.activeElement;for(const t of r)if(t===e||(t.focus(),document.activeElement!==e))return}function NV(r,e){return r.map((t,n)=>r[(e+n)%r.length])}function TV(r,e,t){const s=e.length>1&&Array.from(e).every(p=>p===e[0])?e[0]:e,i=t?r.indexOf(t):-1;let c=NV(r,Math.max(i,0));s.length===1&&(c=c.filter(p=>p!==t));const m=c.find(p=>p.toLowerCase().startsWith(s.toLowerCase()));return m!==t?m:void 0}function AV(r,e){const{x:t,y:n}=r;let s=!1;for(let i=0,c=e.length-1;i<e.length;c=i++){const d=e[i],m=e[c],p=d.x,v=d.y,x=m.x,b=m.y;v>n!=b>n&&t<(x-p)*(n-v)/(b-v)+p&&(s=!s)}return s}function IV(r,e){if(!e)return!1;const t={x:r.clientX,y:r.clientY};return AV(t,e)}function Ym(r){return e=>e.pointerType==="mouse"?r(e):void 0}var RV=QR,PV=CS,jV=eP,FV=tP,OV=IS,DV=rP,LV=c0,MV=sP,$V=iP,UV=lP,zV=uP,HV=dP,BV=fP,GV=pP,WV=gP,u0="DropdownMenu",[VV]=Za(u0,[JR]),ho=JR(),[qV,yP]=VV(u0),xP=r=>{const{__scopeDropdownMenu:e,children:t,dir:n,open:s,defaultOpen:i,onOpenChange:c,modal:d=!0}=r,m=ho(e),p=w.useRef(null),[v,x]=su({prop:s,defaultProp:i??!1,onChange:c,caller:u0});return u.jsx(qV,{scope:e,triggerId:ql(),triggerRef:p,contentId:ql(),open:v,onOpenChange:x,onOpenToggle:w.useCallback(()=>x(b=>!b),[x]),modal:d,children:u.jsx(RV,{...m,open:v,onOpenChange:x,dir:n,modal:d,children:t})})};xP.displayName=u0;var wP="DropdownMenuTrigger",bP=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,disabled:n=!1,...s}=r,i=yP(wP,t),c=ho(t);return u.jsx(PV,{asChild:!0,...c,children:u.jsx(Ur.button,{type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":n?"":void 0,disabled:n,...s,ref:nu(e,i.triggerRef),onPointerDown:$t(r.onPointerDown,d=>{!n&&d.button===0&&d.ctrlKey===!1&&(i.onOpenToggle(),i.open||d.preventDefault())}),onKeyDown:$t(r.onKeyDown,d=>{n||(["Enter"," "].includes(d.key)&&i.onOpenToggle(),d.key==="ArrowDown"&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(d.key)&&d.preventDefault())})})})});bP.displayName=wP;var KV="DropdownMenuPortal",_P=r=>{const{__scopeDropdownMenu:e,...t}=r,n=ho(e);return u.jsx(jV,{...n,...t})};_P.displayName=KV;var SP="DropdownMenuContent",EP=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=yP(SP,t),i=ho(t),c=w.useRef(!1);return u.jsx(FV,{id:s.contentId,"aria-labelledby":s.triggerId,...i,...n,ref:e,onCloseAutoFocus:$t(r.onCloseAutoFocus,d=>{var m;c.current||(m=s.triggerRef.current)==null||m.focus(),c.current=!1,d.preventDefault()}),onInteractOutside:$t(r.onInteractOutside,d=>{const m=d.detail.originalEvent,p=m.button===0&&m.ctrlKey===!0,v=m.button===2||p;(!s.modal||v)&&(c.current=!0)}),style:{...r.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});EP.displayName=SP;var YV="DropdownMenuGroup",JV=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=ho(t);return u.jsx(OV,{...s,...n,ref:e})});JV.displayName=YV;var XV="DropdownMenuLabel",kP=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=ho(t);return u.jsx(DV,{...s,...n,ref:e})});kP.displayName=XV;var QV="DropdownMenuItem",CP=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=ho(t);return u.jsx(LV,{...s,...n,ref:e})});CP.displayName=QV;var ZV="DropdownMenuCheckboxItem",NP=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=ho(t);return u.jsx(MV,{...s,...n,ref:e})});NP.displayName=ZV;var eq="DropdownMenuRadioGroup",tq=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=ho(t);return u.jsx($V,{...s,...n,ref:e})});tq.displayName=eq;var rq="DropdownMenuRadioItem",TP=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=ho(t);return u.jsx(UV,{...s,...n,ref:e})});TP.displayName=rq;var nq="DropdownMenuItemIndicator",AP=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=ho(t);return u.jsx(zV,{...s,...n,ref:e})});AP.displayName=nq;var sq="DropdownMenuSeparator",IP=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=ho(t);return u.jsx(HV,{...s,...n,ref:e})});IP.displayName=sq;var oq="DropdownMenuArrow",iq=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=ho(t);return u.jsx(BV,{...s,...n,ref:e})});iq.displayName=oq;var aq="DropdownMenuSubTrigger",RP=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=ho(t);return u.jsx(GV,{...s,...n,ref:e})});RP.displayName=aq;var lq="DropdownMenuSubContent",PP=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=ho(t);return u.jsx(WV,{...s,...n,ref:e,style:{...r.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});PP.displayName=lq;var cq=xP,uq=bP,dq=_P,jP=EP,FP=kP,OP=CP,DP=NP,LP=TP,MP=AP,$P=IP,UP=RP,zP=PP;const ti=cq,ri=uq,fq=w.forwardRef(({className:r,inset:e,children:t,...n},s)=>u.jsxs(UP,{ref:s,className:Fr("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",e&&"pl-8",r),...n,children:[t,u.jsx(sh,{className:"ml-auto h-4 w-4"})]}));fq.displayName=UP.displayName;const hq=w.forwardRef(({className:r,...e},t)=>u.jsx(zP,{ref:t,className:Fr("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in data-[side=bottom]:slide-in-from-top-1 data-[side=left]:slide-in-from-right-1 data-[side=right]:slide-in-from-left-1 data-[side=top]:slide-in-from-bottom-1",r),...e}));hq.displayName=zP.displayName;const Po=w.forwardRef(({className:r,sideOffset:e=4,...t},n)=>u.jsx(dq,{children:u.jsx(jP,{ref:n,sideOffset:e,className:Fr("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-white dark:bg-card p-1 text-neutral-950 dark:text-card-foreground shadow-md animate-in data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r),...t})}));Po.displayName=jP.displayName;const Bs=w.forwardRef(({className:r,inset:e,...t},n)=>u.jsx(OP,{ref:n,className:Fr("relative flex cursor-pointer select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors hover:bg-neutral-100 dark:hover:bg-muted focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 dark:text-gray-200",e&&"pl-8",r),...t}));Bs.displayName=OP.displayName;const pq=w.forwardRef(({className:r,children:e,checked:t,...n},s)=>u.jsxs(DP,{ref:s,className:Fr("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r),checked:t,...n,children:[u.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:u.jsx(MP,{children:u.jsx(sB,{className:"h-4 w-4"})})}),e]}));pq.displayName=DP.displayName;const mq=w.forwardRef(({className:r,children:e,...t},n)=>u.jsxs(LP,{ref:n,className:Fr("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r),...t,children:[u.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:u.jsx(MP,{children:u.jsx("div",{className:"h-2 w-2 rounded-full bg-current"})})}),e]}));mq.displayName=LP.displayName;const gq=w.forwardRef(({className:r,inset:e,...t},n)=>u.jsx(FP,{ref:n,className:Fr("px-2 py-1.5 text-sm font-semibold",e&&"pl-8",r),...t}));gq.displayName=FP.displayName;const Fy=w.forwardRef(({className:r,...e},t)=>u.jsx($P,{ref:t,className:Fr("-mx-1 my-1 h-px bg-neutral-100",r),...e}));Fy.displayName=$P.displayName;var _m={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */var vq=_m.exports,fN;function yq(){return fN||(fN=1,(function(r,e){(function(){var t,n="4.17.23",s=200,i="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",c="Expected a function",d="Invalid `variable` option passed into `_.template`",m="__lodash_hash_undefined__",p=500,v="__lodash_placeholder__",x=1,b=2,S=4,N=1,E=2,T=1,A=2,I=4,D=8,j=16,O=32,B=64,G=128,K=256,re=512,se=30,he="...",U=800,ge=16,ie=1,ae=2,de=3,J=1/0,Y=9007199254740991,$=17976931348623157e292,Q=NaN,F=4294967295,H=F-1,te=F>>>1,Se=[["ary",G],["bind",T],["bindKey",A],["curry",D],["curryRight",j],["flip",re],["partial",O],["partialRight",B],["rearg",K]],ue="[object Arguments]",ke="[object Array]",X="[object AsyncFunction]",we="[object Boolean]",Ne="[object Date]",Me="[object DOMException]",St="[object Error]",Te="[object Function]",Ge="[object GeneratorFunction]",Ee="[object Map]",ye="[object Number]",Ke="[object Null]",qe="[object Object]",ft="[object Promise]",mt="[object Proxy]",jt="[object RegExp]",ut="[object Set]",Jt="[object String]",Or="[object Symbol]",jr="[object Undefined]",Nr="[object WeakMap]",me="[object WeakSet]",je="[object ArrayBuffer]",ht="[object DataView]",wt="[object Float32Array]",We="[object Float64Array]",Ve="[object Int8Array]",lt="[object Int16Array]",Pe="[object Int32Array]",kt="[object Uint8Array]",Ft="[object Uint8ClampedArray]",$e="[object Uint16Array]",cr="[object Uint32Array]",Ut=/\b__p \+= '';/g,lr=/\b(__p \+=) '' \+/g,Wt=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Zt=/&(?:amp|lt|gt|quot|#39);/g,_n=/[&<>"']/g,Un=RegExp(Zt.source),Oo=RegExp(_n.source),Jn=/<%-([\s\S]+?)%>/g,_r=/<%([\s\S]+?)%>/g,gn=/<%=([\s\S]+?)%>/g,po=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Do=/^\w*$/,Sn=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Gs=/[\\^$.*+?()[\]{}|]/g,Ws=RegExp(Gs.source),Li=/^\s+/,ln=/\s/,zn=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Pn=/\{\n\/\* \[wrapped with (.+)\] \*/,le=/,? & /,tt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Tt=/[()=,{}\[\]\/\s]/,dt=/\\(\\)?/g,ot=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Vt=/\w*$/,_t=/^[-+]0x[0-9a-f]+$/i,Qt=/^0b[01]+$/i,En=/^\[object .+?Constructor\]$/,Be=/^0o[0-7]+$/i,q=/^(?:0|[1-9]\d*)$/,De=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Qe=/($^)/,Tr=/['\n\r\u2028\u2029\\]/g,Xt="\\ud800-\\udfff",Br="\\u0300-\\u036f",cn="\\ufe20-\\ufe2f",ds="\\u20d0-\\u20ff",Cs=Br+cn+ds,Mi="\\u2700-\\u27bf",Gr="a-z\\xdf-\\xf6\\xf8-\\xff",Lo="\\xac\\xb1\\xd7\\xf7",Xn="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",ou="\\u2000-\\u206f",Ns=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",pa="A-Z\\xc0-\\xd6\\xd8-\\xde",iu="\\ufe0e\\ufe0f",au=Lo+Xn+ou+Ns,li="[']",ci="["+Xt+"]",Vs="["+au+"]",qs="["+Cs+"]",lu="\\d+",kh="["+Mi+"]",ec="["+Gr+"]",cu="[^"+Xt+au+lu+Mi+Gr+pa+"]",tl="\\ud83c[\\udffb-\\udfff]",rl="(?:"+qs+"|"+tl+")",yd="[^"+Xt+"]",nl="(?:\\ud83c[\\udde6-\\uddff]){2}",vr="[\\ud800-\\udbff][\\udc00-\\udfff]",Ks="["+pa+"]",sl="\\u200d",tc="(?:"+ec+"|"+cu+")",uu="(?:"+Ks+"|"+cu+")",du="(?:"+li+"(?:d|ll|m|re|s|t|ve))?",fu="(?:"+li+"(?:D|LL|M|RE|S|T|VE))?",rc=rl+"?",ol="["+iu+"]?",ui="(?:"+sl+"(?:"+[yd,nl,vr].join("|")+")"+ol+rc+")*",di="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Mo="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",$i=ol+rc+ui,be="(?:"+[kh,nl,vr].join("|")+")"+$i,ze="(?:"+[yd+qs+"?",qs,nl,vr,ci].join("|")+")",Je=RegExp(li,"g"),At=RegExp(qs,"g"),Ct=RegExp(tl+"(?="+tl+")|"+ze+$i,"g"),zt=RegExp([Ks+"?"+ec+"+"+du+"(?="+[Vs,Ks,"$"].join("|")+")",uu+"+"+fu+"(?="+[Vs,Ks+tc,"$"].join("|")+")",Ks+"?"+tc+"+"+du,Ks+"+"+fu,Mo,di,lu,be].join("|"),"g"),at=RegExp("["+sl+Xt+Cs+iu+"]"),pt=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Qn=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Ys=-1,Sr={};Sr[wt]=Sr[We]=Sr[Ve]=Sr[lt]=Sr[Pe]=Sr[kt]=Sr[Ft]=Sr[$e]=Sr[cr]=!0,Sr[ue]=Sr[ke]=Sr[je]=Sr[we]=Sr[ht]=Sr[Ne]=Sr[St]=Sr[Te]=Sr[Ee]=Sr[ye]=Sr[qe]=Sr[jt]=Sr[ut]=Sr[Jt]=Sr[Nr]=!1;var er={};er[ue]=er[ke]=er[je]=er[ht]=er[we]=er[Ne]=er[wt]=er[We]=er[Ve]=er[lt]=er[Pe]=er[Ee]=er[ye]=er[qe]=er[jt]=er[ut]=er[Jt]=er[Or]=er[kt]=er[Ft]=er[$e]=er[cr]=!0,er[St]=er[Te]=er[Nr]=!1;var ma={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},Ui={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},xd={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},wd={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},il=parseFloat,bd=parseInt,_d=typeof _v=="object"&&_v&&_v.Object===Object&&_v,ug=typeof self=="object"&&self&&self.Object===Object&&self,Xr=_d||ug||Function("return this")(),hu=e&&!e.nodeType&&e,fi=hu&&!0&&r&&!r.nodeType&&r,Ch=fi&&fi.exports===hu,nc=Ch&&_d.process,fs=(function(){try{var oe=fi&&fi.require&&fi.require("util").types;return oe||nc&&nc.binding&&nc.binding("util")}catch{}})(),Nh=fs&&fs.isArrayBuffer,Ts=fs&&fs.isDate,al=fs&&fs.isMap,Sd=fs&&fs.isRegExp,sc=fs&&fs.isSet,dg=fs&&fs.isTypedArray;function hs(oe,Ce,ve){switch(ve.length){case 0:return oe.call(Ce);case 1:return oe.call(Ce,ve[0]);case 2:return oe.call(Ce,ve[0],ve[1]);case 3:return oe.call(Ce,ve[0],ve[1],ve[2])}return oe.apply(Ce,ve)}function Th(oe,Ce,ve,rt){for(var qt=-1,Er=oe==null?0:oe.length;++qt<Er;){var vn=oe[qt];Ce(rt,vn,ve(vn),oe)}return rt}function Zn(oe,Ce){for(var ve=-1,rt=oe==null?0:oe.length;++ve<rt&&Ce(oe[ve],ve,oe)!==!1;);return oe}function Ed(oe,Ce){for(var ve=oe==null?0:oe.length;ve--&&Ce(oe[ve],ve,oe)!==!1;);return oe}function Ah(oe,Ce){for(var ve=-1,rt=oe==null?0:oe.length;++ve<rt;)if(!Ce(oe[ve],ve,oe))return!1;return!0}function ga(oe,Ce){for(var ve=-1,rt=oe==null?0:oe.length,qt=0,Er=[];++ve<rt;){var vn=oe[ve];Ce(vn,ve,oe)&&(Er[qt++]=vn)}return Er}function kd(oe,Ce){var ve=oe==null?0:oe.length;return!!ve&&oc(oe,Ce,0)>-1}function Ih(oe,Ce,ve){for(var rt=-1,qt=oe==null?0:oe.length;++rt<qt;)if(ve(Ce,oe[rt]))return!0;return!1}function zr(oe,Ce){for(var ve=-1,rt=oe==null?0:oe.length,qt=Array(rt);++ve<rt;)qt[ve]=Ce(oe[ve],ve,oe);return qt}function va(oe,Ce){for(var ve=-1,rt=Ce.length,qt=oe.length;++ve<rt;)oe[qt+ve]=Ce[ve];return oe}function Rh(oe,Ce,ve,rt){var qt=-1,Er=oe==null?0:oe.length;for(rt&&Er&&(ve=oe[++qt]);++qt<Er;)ve=Ce(ve,oe[qt],qt,oe);return ve}function p0(oe,Ce,ve,rt){var qt=oe==null?0:oe.length;for(rt&&qt&&(ve=oe[--qt]);qt--;)ve=Ce(ve,oe[qt],qt,oe);return ve}function Ph(oe,Ce){for(var ve=-1,rt=oe==null?0:oe.length;++ve<rt;)if(Ce(oe[ve],ve,oe))return!0;return!1}var m0=Fh("length");function fg(oe){return oe.split("")}function g0(oe){return oe.match(tt)||[]}function hg(oe,Ce,ve){var rt;return ve(oe,function(qt,Er,vn){if(Ce(qt,Er,vn))return rt=Er,!1}),rt}function Cd(oe,Ce,ve,rt){for(var qt=oe.length,Er=ve+(rt?1:-1);rt?Er--:++Er<qt;)if(Ce(oe[Er],Er,oe))return Er;return-1}function oc(oe,Ce,ve){return Ce===Ce?Ad(oe,Ce,ve):Cd(oe,pg,ve)}function jh(oe,Ce,ve,rt){for(var qt=ve-1,Er=oe.length;++qt<Er;)if(rt(oe[qt],Ce))return qt;return-1}function pg(oe){return oe!==oe}function mg(oe,Ce){var ve=oe==null?0:oe.length;return ve?Oh(oe,Ce)/ve:Q}function Fh(oe){return function(Ce){return Ce==null?t:Ce[oe]}}function Nd(oe){return function(Ce){return oe==null?t:oe[Ce]}}function gg(oe,Ce,ve,rt,qt){return qt(oe,function(Er,vn,Dr){ve=rt?(rt=!1,Er):Ce(ve,Er,vn,Dr)}),ve}function v0(oe,Ce){var ve=oe.length;for(oe.sort(Ce);ve--;)oe[ve]=oe[ve].value;return oe}function Oh(oe,Ce){for(var ve,rt=-1,qt=oe.length;++rt<qt;){var Er=Ce(oe[rt]);Er!==t&&(ve=ve===t?Er:ve+Er)}return ve}function Dh(oe,Ce){for(var ve=-1,rt=Array(oe);++ve<oe;)rt[ve]=Ce(ve);return rt}function y0(oe,Ce){return zr(Ce,function(ve){return[ve,oe[ve]]})}function vg(oe){return oe&&oe.slice(0,Id(oe)+1).replace(Li,"")}function Js(oe){return function(Ce){return oe(Ce)}}function pu(oe,Ce){return zr(Ce,function(ve){return oe[ve]})}function zi(oe,Ce){return oe.has(Ce)}function yg(oe,Ce){for(var ve=-1,rt=oe.length;++ve<rt&&oc(Ce,oe[ve],0)>-1;);return ve}function Lh(oe,Ce){for(var ve=oe.length;ve--&&oc(Ce,oe[ve],0)>-1;);return ve}function xg(oe,Ce){for(var ve=oe.length,rt=0;ve--;)oe[ve]===Ce&&++rt;return rt}var wg=Nd(ma),bg=Nd(Ui);function _g(oe){return"\\"+wd[oe]}function ic(oe,Ce){return oe==null?t:oe[Ce]}function ac(oe){return at.test(oe)}function x0(oe){return pt.test(oe)}function w0(oe){for(var Ce,ve=[];!(Ce=oe.next()).done;)ve.push(Ce.value);return ve}function Td(oe){var Ce=-1,ve=Array(oe.size);return oe.forEach(function(rt,qt){ve[++Ce]=[qt,rt]}),ve}function Mh(oe,Ce){return function(ve){return oe(Ce(ve))}}function mo(oe,Ce){for(var ve=-1,rt=oe.length,qt=0,Er=[];++ve<rt;){var vn=oe[ve];(vn===Ce||vn===v)&&(oe[ve]=v,Er[qt++]=ve)}return Er}function ya(oe){var Ce=-1,ve=Array(oe.size);return oe.forEach(function(rt){ve[++Ce]=rt}),ve}function b0(oe){var Ce=-1,ve=Array(oe.size);return oe.forEach(function(rt){ve[++Ce]=[rt,rt]}),ve}function Ad(oe,Ce,ve){for(var rt=ve-1,qt=oe.length;++rt<qt;)if(oe[rt]===Ce)return rt;return-1}function _0(oe,Ce,ve){for(var rt=ve+1;rt--;)if(oe[rt]===Ce)return rt;return rt}function ll(oe){return ac(oe)?Eg(oe):m0(oe)}function Xs(oe){return ac(oe)?kg(oe):fg(oe)}function Id(oe){for(var Ce=oe.length;Ce--&&ln.test(oe.charAt(Ce)););return Ce}var Sg=Nd(xd);function Eg(oe){for(var Ce=Ct.lastIndex=0;Ct.test(oe);)++Ce;return Ce}function kg(oe){return oe.match(Ct)||[]}function S0(oe){return oe.match(zt)||[]}var E0=(function oe(Ce){Ce=Ce==null?Xr:lc.defaults(Xr.Object(),Ce,lc.pick(Xr,Qn));var ve=Ce.Array,rt=Ce.Date,qt=Ce.Error,Er=Ce.Function,vn=Ce.Math,Dr=Ce.Object,mu=Ce.RegExp,k0=Ce.String,go=Ce.TypeError,Hi=ve.prototype,$h=Er.prototype,hi=Dr.prototype,cc=Ce["__core-js_shared__"],gu=$h.toString,yr=hi.hasOwnProperty,uc=0,Rd=(function(){var l=/[^.]+$/.exec(cc&&cc.keys&&cc.keys.IE_PROTO||"");return l?"Symbol(src)_1."+l:""})(),vu=hi.toString,Pd=gu.call(Dr),Cg=Xr._,Ng=mu("^"+gu.call(yr).replace(Gs,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),yu=Ch?Ce.Buffer:t,Bi=Ce.Symbol,xu=Ce.Uint8Array,Uh=yu?yu.allocUnsafe:t,$o=Mh(Dr.getPrototypeOf,Dr),jd=Dr.create,Fd=hi.propertyIsEnumerable,Od=Hi.splice,Tg=Bi?Bi.isConcatSpreadable:t,Gi=Bi?Bi.iterator:t,cl=Bi?Bi.toStringTag:t,wu=(function(){try{var l=Aa(Dr,"defineProperty");return l({},"",{}),l}catch{}})(),Ag=Ce.clearTimeout!==Xr.clearTimeout&&Ce.clearTimeout,Wr=rt&&rt.now!==Xr.Date.now&&rt.now,zh=Ce.setTimeout!==Xr.setTimeout&&Ce.setTimeout,ul=vn.ceil,xa=vn.floor,Dd=Dr.getOwnPropertySymbols,Hh=yu?yu.isBuffer:t,dc=Ce.isFinite,Ld=Hi.join,fc=Mh(Dr.keys,Dr),yn=vn.max,es=vn.min,C0=rt.now,Ig=Ce.parseInt,bu=vn.random,Md=Hi.reverse,_u=Aa(Ce,"DataView"),dl=Aa(Ce,"Map"),Su=Aa(Ce,"Promise"),wa=Aa(Ce,"Set"),Eu=Aa(Ce,"WeakMap"),hc=Aa(Dr,"create"),$d=Eu&&new Eu,pc={},Bh=Ia(_u),ba=Ia(dl),Rg=Ia(Su),mc=Ia(wa),pi=Ia(Eu),_a=Bi?Bi.prototype:t,Qs=_a?_a.valueOf:t,Ud=_a?_a.toString:t;function L(l){if(wn(l)&&!rr(l)&&!(l instanceof tr)){if(l instanceof ts)return l;if(yr.call(l,"__wrapped__"))return ov(l)}return new ts(l)}var gc=(function(){function l(){}return function(f){if(!fn(f))return{};if(jd)return jd(f);l.prototype=f;var y=new l;return l.prototype=t,y}})();function mi(){}function ts(l,f){this.__wrapped__=l,this.__actions__=[],this.__chain__=!!f,this.__index__=0,this.__values__=t}L.templateSettings={escape:Jn,evaluate:_r,interpolate:gn,variable:"",imports:{_:L}},L.prototype=mi.prototype,L.prototype.constructor=L,ts.prototype=gc(mi.prototype),ts.prototype.constructor=ts;function tr(l){this.__wrapped__=l,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=F,this.__views__=[]}function zd(){var l=new tr(this.__wrapped__);return l.__actions__=ms(this.__actions__),l.__dir__=this.__dir__,l.__filtered__=this.__filtered__,l.__iteratees__=ms(this.__iteratees__),l.__takeCount__=this.__takeCount__,l.__views__=ms(this.__views__),l}function Gh(){if(this.__filtered__){var l=new tr(this);l.__dir__=-1,l.__filtered__=!0}else l=this.clone(),l.__dir__*=-1;return l}function vc(){var l=this.__wrapped__.value(),f=this.__dir__,y=rr(l),k=f<0,R=y?l.length:0,M=yp(0,R,this.__views__),V=M.start,ee=M.end,ce=ee-V,Ie=k?ee:V-1,Re=this.__iteratees__,Le=Re.length,Xe=0,bt=es(ce,this.__takeCount__);if(!y||!k&&R==ce&&bt==ce)return kc(l,this.__actions__);var Bt=[];e:for(;ce--&&Xe<bt;){Ie+=f;for(var ar=-1,Gt=l[Ie];++ar<Le;){var fr=Re[ar],wr=fr.iteratee,Yo=fr.type,no=wr(Gt);if(Yo==ae)Gt=no;else if(!no){if(Yo==ie)continue e;break e}}Bt[Xe++]=Gt}return Bt}tr.prototype=gc(mi.prototype),tr.prototype.constructor=tr;function As(l){var f=-1,y=l==null?0:l.length;for(this.clear();++f<y;){var k=l[f];this.set(k[0],k[1])}}function Vr(){this.__data__=hc?hc(null):{},this.size=0}function Hr(l){var f=this.has(l)&&delete this.__data__[l];return this.size-=f?1:0,f}function Sa(l){var f=this.__data__;if(hc){var y=f[l];return y===m?t:y}return yr.call(f,l)?f[l]:t}function rs(l){var f=this.__data__;return hc?f[l]!==t:yr.call(f,l)}function Is(l,f){var y=this.__data__;return this.size+=this.has(l)?0:1,y[l]=hc&&f===t?m:f,this}As.prototype.clear=Vr,As.prototype.delete=Hr,As.prototype.get=Sa,As.prototype.has=rs,As.prototype.set=Is;function ps(l){var f=-1,y=l==null?0:l.length;for(this.clear();++f<y;){var k=l[f];this.set(k[0],k[1])}}function yc(){this.__data__=[],this.size=0}function Rs(l){var f=this.__data__,y=ss(f,l);if(y<0)return!1;var k=f.length-1;return y==k?f.pop():Od.call(f,y,1),--this.size,!0}function Hd(l){var f=this.__data__,y=ss(f,l);return y<0?t:f[y][1]}function Pg(l){return ss(this.__data__,l)>-1}function jg(l,f){var y=this.__data__,k=ss(y,l);return k<0?(++this.size,y.push([l,f])):y[k][1]=f,this}ps.prototype.clear=yc,ps.prototype.delete=Rs,ps.prototype.get=Hd,ps.prototype.has=Pg,ps.prototype.set=jg;function vo(l){var f=-1,y=l==null?0:l.length;for(this.clear();++f<y;){var k=l[f];this.set(k[0],k[1])}}function Fg(){this.size=0,this.__data__={hash:new As,map:new(dl||ps),string:new As}}function Wi(l){var f=Uu(this,l).delete(l);return this.size-=f?1:0,f}function Bd(l){return Uu(this,l).get(l)}function Wh(l){return Uu(this,l).has(l)}function Og(l,f){var y=Uu(this,l),k=y.size;return y.set(l,f),this.size+=y.size==k?0:1,this}vo.prototype.clear=Fg,vo.prototype.delete=Wi,vo.prototype.get=Bd,vo.prototype.has=Wh,vo.prototype.set=Og;function fl(l){var f=-1,y=l==null?0:l.length;for(this.__data__=new vo;++f<y;)this.add(l[f])}function Ea(l){return this.__data__.set(l,m),this}function xc(l){return this.__data__.has(l)}fl.prototype.add=fl.prototype.push=Ea,fl.prototype.has=xc;function ns(l){var f=this.__data__=new ps(l);this.size=f.size}function Gd(){this.__data__=new ps,this.size=0}function Wd(l){var f=this.__data__,y=f.delete(l);return this.size=f.size,y}function yo(l){return this.__data__.get(l)}function xo(l){return this.__data__.has(l)}function hl(l,f){var y=this.__data__;if(y instanceof ps){var k=y.__data__;if(!dl||k.length<s-1)return k.push([l,f]),this.size=++y.size,this;y=this.__data__=new vo(k)}return y.set(l,f),this.size=y.size,this}ns.prototype.clear=Gd,ns.prototype.delete=Wd,ns.prototype.get=yo,ns.prototype.has=xo,ns.prototype.set=hl;function gi(l,f){var y=rr(l),k=!y&&Qu(l),R=!y&&!k&&Oc(l),M=!y&&!k&&!R&&Of(l),V=y||k||R||M,ee=V?Dh(l.length,k0):[],ce=ee.length;for(var Ie in l)(f||yr.call(l,Ie))&&!(V&&(Ie=="length"||R&&(Ie=="offset"||Ie=="parent")||M&&(Ie=="buffer"||Ie=="byteLength"||Ie=="byteOffset")||Zr(Ie,ce)))&&ee.push(Ie);return ee}function vi(l){var f=l.length;return f?l[Sc(0,f-1)]:t}function pl(l,f){return yf(ms(l),Vi(f,0,l.length))}function Dg(l){return yf(ms(l))}function ku(l,f,y){(y!==t&&!ra(l[f],y)||y===t&&!(f in l))&&yi(l,f,y)}function ml(l,f,y){var k=l[f];(!(yr.call(l,f)&&ra(k,y))||y===t&&!(f in l))&&yi(l,f,y)}function ss(l,f){for(var y=l.length;y--;)if(ra(l[y][0],f))return y;return-1}function Zs(l,f,y,k){return wi(l,function(R,M,V){f(k,R,y(R),V)}),k}function qr(l,f){return l&&zo(f,as(f),l)}function Uo(l,f){return l&&zo(f,To(f),l)}function yi(l,f,y){f=="__proto__"&&wu?wu(l,f,{configurable:!0,enumerable:!0,value:y,writable:!0}):l[f]=y}function Vd(l,f){for(var y=-1,k=f.length,R=ve(k),M=l==null;++y<k;)R[y]=M?t:J0(l,f[y]);return R}function Vi(l,f,y){return l===l&&(y!==t&&(l=l<=y?l:y),f!==t&&(l=l>=f?l:f)),l}function Ps(l,f,y,k,R,M){var V,ee=f&x,ce=f&b,Ie=f&S;if(y&&(V=R?y(l,k,R,M):y(l)),V!==t)return V;if(!fn(l))return l;var Re=rr(l);if(Re){if(V=Hu(l),!ee)return ms(l,V)}else{var Le=Gn(l),Xe=Le==Te||Le==Ge;if(Oc(l))return ip(l,ee);if(Le==qe||Le==ue||Xe&&!R){if(V=ce||Xe?{}:Wn(l),!ee)return ce?T0(l,Uo(V,l)):of(l,qr(V,l))}else{if(!er[Le])return R?l:{};V=A0(l,Le,ee)}}M||(M=new ns);var bt=M.get(l);if(bt)return bt;M.set(l,V),GS(l)?l.forEach(function(Gt){V.add(Ps(Gt,f,y,Gt,l,M))}):HS(l)&&l.forEach(function(Gt,fr){V.set(fr,Ps(Gt,f,y,fr,l,M))});var Bt=Ie?ce?$u:Mu:ce?To:as,ar=Re?t:Bt(l);return Zn(ar||l,function(Gt,fr){ar&&(fr=Gt,Gt=l[fr]),ml(V,fr,Ps(Gt,f,y,fr,l,M))}),V}function Lg(l){var f=as(l);return function(y){return Cu(y,l,f)}}function Cu(l,f,y){var k=y.length;if(l==null)return!k;for(l=Dr(l);k--;){var R=y[k],M=f[R],V=l[R];if(V===t&&!(R in l)||!M(V))return!1}return!0}function Vh(l,f,y){if(typeof l!="function")throw new go(c);return Pc(function(){l.apply(t,y)},f)}function xi(l,f,y,k){var R=-1,M=kd,V=!0,ee=l.length,ce=[],Ie=f.length;if(!ee)return ce;y&&(f=zr(f,Js(y))),k?(M=Ih,V=!1):f.length>=s&&(M=zi,V=!1,f=new fl(f));e:for(;++R<ee;){var Re=l[R],Le=y==null?Re:y(Re);if(Re=k||Re!==0?Re:0,V&&Le===Le){for(var Xe=Ie;Xe--;)if(f[Xe]===Le)continue e;ce.push(Re)}else M(f,Le,k)||ce.push(Re)}return ce}var wi=Eo(eo),Mg=Eo(ka,!0);function Nu(l,f){var y=!0;return wi(l,function(k,R,M){return y=!!f(k,R,M),y}),y}function gl(l,f,y){for(var k=-1,R=l.length;++k<R;){var M=l[k],V=f(M);if(V!=null&&(ee===t?V===V&&!Ko(V):y(V,ee)))var ee=V,ce=M}return ce}function $g(l,f,y,k){var R=l.length;for(y=sr(y),y<0&&(y=-y>R?0:R+y),k=k===t||k>R?R:sr(k),k<0&&(k+=R),k=y>k?0:VS(k);y<k;)l[y++]=f;return l}function qh(l,f){var y=[];return wi(l,function(k,R,M){f(k,R,M)&&y.push(k)}),y}function an(l,f,y,k,R){var M=-1,V=l.length;for(y||(y=mf),R||(R=[]);++M<V;){var ee=l[M];f>0&&y(ee)?f>1?an(ee,f-1,y,k,R):va(R,ee):k||(R[R.length]=ee)}return R}var qd=lf(),Tu=lf(!0);function eo(l,f){return l&&qd(l,f,as)}function ka(l,f){return l&&Tu(l,f,as)}function wc(l,f){return ga(f,function(y){return Al(l[y])})}function qi(l,f){f=Si(f,l);for(var y=0,k=f.length;l!=null&&y<k;)l=l[Wo(f[y++])];return y&&y==k?l:t}function Kd(l,f,y){var k=f(l);return rr(l)?k:va(k,y(l))}function Hn(l){return l==null?l===t?jr:Ke:cl&&cl in Dr(l)?pf(l):wp(l)}function Ca(l,f){return l>f}function wo(l,f){return l!=null&&yr.call(l,f)}function vl(l,f){return l!=null&&f in Dr(l)}function Kh(l,f,y){return l>=es(f,y)&&l<yn(f,y)}function Yd(l,f,y){for(var k=y?Ih:kd,R=l[0].length,M=l.length,V=M,ee=ve(M),ce=1/0,Ie=[];V--;){var Re=l[V];V&&f&&(Re=zr(Re,Js(f))),ce=es(Re.length,ce),ee[V]=!y&&(f||R>=120&&Re.length>=120)?new fl(V&&Re):t}Re=l[0];var Le=-1,Xe=ee[0];e:for(;++Le<R&&Ie.length<ce;){var bt=Re[Le],Bt=f?f(bt):bt;if(bt=y||bt!==0?bt:0,!(Xe?zi(Xe,Bt):k(Ie,Bt,y))){for(V=M;--V;){var ar=ee[V];if(!(ar?zi(ar,Bt):k(l[V],Bt,y)))continue e}Xe&&Xe.push(Bt),Ie.push(bt)}}return Ie}function Ki(l,f,y,k){return eo(l,function(R,M,V){f(k,y(R),M,V)}),k}function bo(l,f,y){f=Si(f,l),l=jn(l,f);var k=l==null?l:l[Wo(ys(f))];return k==null?t:hs(k,l,y)}function Jd(l){return wn(l)&&Hn(l)==ue}function Ug(l){return wn(l)&&Hn(l)==je}function Yi(l){return wn(l)&&Hn(l)==Ne}function _o(l,f,y,k,R){return l===f?!0:l==null||f==null||!wn(l)&&!wn(f)?l!==l&&f!==f:Xd(l,f,y,k,_o,R)}function Xd(l,f,y,k,R,M){var V=rr(l),ee=rr(f),ce=V?ke:Gn(l),Ie=ee?ke:Gn(f);ce=ce==ue?qe:ce,Ie=Ie==ue?qe:Ie;var Re=ce==qe,Le=Ie==qe,Xe=ce==Ie;if(Xe&&Oc(l)){if(!Oc(f))return!1;V=!0,Re=!1}if(Xe&&!Re)return M||(M=new ns),V||Of(l)?gp(l,f,y,k,R,M):vp(l,f,ce,y,k,R,M);if(!(y&N)){var bt=Re&&yr.call(l,"__wrapped__"),Bt=Le&&yr.call(f,"__wrapped__");if(bt||Bt){var ar=bt?l.value():l,Gt=Bt?f.value():f;return M||(M=new ns),R(ar,Gt,y,k,M)}}return Xe?(M||(M=new ns),Xg(l,f,y,k,R,M)):!1}function zg(l){return wn(l)&&Gn(l)==Ee}function bc(l,f,y,k){var R=y.length,M=R,V=!k;if(l==null)return!M;for(l=Dr(l);R--;){var ee=y[R];if(V&&ee[2]?ee[1]!==l[ee[0]]:!(ee[0]in l))return!1}for(;++R<M;){ee=y[R];var ce=ee[0],Ie=l[ce],Re=ee[1];if(V&&ee[2]){if(Ie===t&&!(ce in l))return!1}else{var Le=new ns;if(k)var Xe=k(Ie,Re,ce,l,f,Le);if(!(Xe===t?_o(Re,Ie,N|E,k,Le):Xe))return!1}}return!0}function Yh(l){if(!fn(l)||ev(l))return!1;var f=Al(l)?Ng:En;return f.test(Ia(l))}function Au(l){return wn(l)&&Hn(l)==jt}function bi(l){return wn(l)&&Gn(l)==ut}function Iu(l){return wn(l)&&xv(l.length)&&!!Sr[Hn(l)]}function _c(l){return typeof l=="function"?l:l==null?Ao:typeof l=="object"?rr(l)?Qr(l[0],l[1]):Qd(l):nE(l)}function Ji(l){if(!ea(l))return fc(l);var f=[];for(var y in Dr(l))yr.call(l,y)&&y!="constructor"&&f.push(y);return f}function Jh(l){if(!fn(l))return nv(l);var f=ea(l),y=[];for(var k in l)k=="constructor"&&(f||!yr.call(l,k))||y.push(k);return y}function Na(l,f){return l<f}function Xh(l,f){var y=-1,k=No(l)?ve(l.length):[];return wi(l,function(R,M,V){k[++y]=f(R,M,V)}),k}function Qd(l){var f=zu(l);return f.length==1&&f[0][2]?gf(f[0][0],f[0][1]):function(y){return y===l||bc(y,l,f)}}function Qr(l,f){return ct(l)&&Gu(f)?gf(Wo(l),f):function(y){var k=J0(y,l);return k===t&&k===f?X0(y,l):_o(f,k,N|E)}}function yl(l,f,y,k,R){l!==f&&qd(f,function(M,V){if(R||(R=new ns),fn(M))Qh(l,f,V,y,yl,k,R);else{var ee=k?k(Ci(l,V),M,V+"",l,f,R):t;ee===t&&(ee=M),ku(l,V,ee)}},To)}function Qh(l,f,y,k,R,M,V){var ee=Ci(l,y),ce=Ci(f,y),Ie=V.get(ce);if(Ie){ku(l,y,Ie);return}var Re=M?M(ee,ce,y+"",l,f,V):t,Le=Re===t;if(Le){var Xe=rr(ce),bt=!Xe&&Oc(ce),Bt=!Xe&&!bt&&Of(ce);Re=ce,Xe||bt||Bt?rr(ee)?Re=ee:Nn(ee)?Re=ms(ee):bt?(Le=!1,Re=ip(ce,!0)):Bt?(Le=!1,Re=Vg(ce,!0)):Re=[]:Mp(ce)||Qu(ce)?(Re=ee,Qu(ee)?Re=qS(ee):(!fn(ee)||Al(ee))&&(Re=Wn(ce))):Le=!1}Le&&(V.set(ce,Re),R(Re,ce,k,M,V),V.delete(ce)),ku(l,y,Re)}function Zd(l,f){var y=l.length;if(y)return f+=f<0?y:0,Zr(f,y)?l[f]:t}function Ru(l,f,y){f.length?f=zr(f,function(M){return rr(M)?function(V){return qi(V,M.length===1?M[0]:M)}:M}):f=[Ao];var k=-1;f=zr(f,Js(Mt()));var R=Xh(l,function(M,V,ee){var ce=zr(f,function(Ie){return Ie(M)});return{criteria:ce,index:++k,value:M}});return v0(R,function(M,V){return N0(M,V,y)})}function Zh(l,f){return Ta(l,f,function(y,k){return X0(l,k)})}function Ta(l,f,y){for(var k=-1,R=f.length,M={};++k<R;){var V=f[k],ee=qi(l,V);y(ee,V)&&wl(M,Si(V,l),ee)}return M}function tn(l){return function(f){return qi(f,l)}}function un(l,f,y,k){var R=k?jh:oc,M=-1,V=f.length,ee=l;for(l===f&&(f=ms(f)),y&&(ee=zr(l,Js(y)));++M<V;)for(var ce=0,Ie=f[M],Re=y?y(Ie):Ie;(ce=R(ee,Re,ce,k))>-1;)ee!==l&&Od.call(ee,ce,1),Od.call(l,ce,1);return l}function kn(l,f){for(var y=l?f.length:0,k=y-1;y--;){var R=f[y];if(y==k||R!==M){var M=R;Zr(R)?Od.call(l,R,1):rf(l,R)}}return l}function Sc(l,f){return l+xa(bu()*(f-l+1))}function Pu(l,f,y,k){for(var R=-1,M=yn(ul((f-l)/(y||1)),0),V=ve(M);M--;)V[k?M:++R]=l,l+=y;return V}function xl(l,f){var y="";if(!l||f<1||f>Y)return y;do f%2&&(y+=l),f=xa(f/2),f&&(l+=l);while(f);return y}function nr(l,f){return to(vf(l,f,Ao),l+"")}function os(l){return vi(Df(l))}function ep(l,f){var y=Df(l);return yf(y,Vi(f,0,y.length))}function wl(l,f,y,k){if(!fn(l))return l;f=Si(f,l);for(var R=-1,M=f.length,V=M-1,ee=l;ee!=null&&++R<M;){var ce=Wo(f[R]),Ie=y;if(ce==="__proto__"||ce==="constructor"||ce==="prototype")return l;if(R!=V){var Re=ee[ce];Ie=k?k(Re,ce,ee):t,Ie===t&&(Ie=fn(Re)?Re:Zr(f[R+1])?[]:{})}ml(ee,ce,Ie),ee=ee[ce]}return l}var ef=$d?function(l,f){return $d.set(l,f),l}:Ao,_i=wu?function(l,f){return wu(l,"toString",{configurable:!0,enumerable:!1,value:Z0(f),writable:!0})}:Ao;function So(l){return yf(Df(l))}function is(l,f,y){var k=-1,R=l.length;f<0&&(f=-f>R?0:R+f),y=y>R?R:y,y<0&&(y+=R),R=f>y?0:y-f>>>0,f>>>=0;for(var M=ve(R);++k<R;)M[k]=l[k+f];return M}function tp(l,f){var y;return wi(l,function(k,R,M){return y=f(k,R,M),!y}),!!y}function Ec(l,f,y){var k=0,R=l==null?k:l.length;if(typeof f=="number"&&f===f&&R<=te){for(;k<R;){var M=k+R>>>1,V=l[M];V!==null&&!Ko(V)&&(y?V<=f:V<f)?k=M+1:R=M}return R}return tf(l,f,Ao,y)}function tf(l,f,y,k){var R=0,M=l==null?0:l.length;if(M===0)return 0;f=y(f);for(var V=f!==f,ee=f===null,ce=Ko(f),Ie=f===t;R<M;){var Re=xa((R+M)/2),Le=y(l[Re]),Xe=Le!==t,bt=Le===null,Bt=Le===Le,ar=Ko(Le);if(V)var Gt=k||Bt;else Ie?Gt=Bt&&(k||Xe):ee?Gt=Bt&&Xe&&(k||!bt):ce?Gt=Bt&&Xe&&!bt&&(k||!ar):bt||ar?Gt=!1:Gt=k?Le<=f:Le<f;Gt?R=Re+1:M=Re}return es(M,H)}function rp(l,f){for(var y=-1,k=l.length,R=0,M=[];++y<k;){var V=l[y],ee=f?f(V):V;if(!y||!ra(ee,ce)){var ce=ee;M[R++]=V===0?0:V}}return M}function np(l){return typeof l=="number"?l:Ko(l)?Q:+l}function js(l){if(typeof l=="string")return l;if(rr(l))return zr(l,js)+"";if(Ko(l))return Ud?Ud.call(l):"";var f=l+"";return f=="0"&&1/l==-J?"-0":f}function Xi(l,f,y){var k=-1,R=kd,M=l.length,V=!0,ee=[],ce=ee;if(y)V=!1,R=Ih;else if(M>=s){var Ie=f?null:Jg(l);if(Ie)return ya(Ie);V=!1,R=zi,ce=new fl}else ce=f?[]:ee;e:for(;++k<M;){var Re=l[k],Le=f?f(Re):Re;if(Re=y||Re!==0?Re:0,V&&Le===Le){for(var Xe=ce.length;Xe--;)if(ce[Xe]===Le)continue e;f&&ce.push(Le),ee.push(Re)}else R(ce,Le,y)||(ce!==ee&&ce.push(Le),ee.push(Re))}return ee}function rf(l,f){f=Si(f,l);var y=-1,k=f.length;if(!k)return!0;for(var R=l==null||typeof l!="object"&&typeof l!="function";++y<k;){var M=f[y];if(typeof M=="string"){if(M==="__proto__"&&!yr.call(l,"__proto__"))return!1;if(M==="constructor"&&y+1<k&&typeof f[y+1]=="string"&&f[y+1]==="prototype"){if(R&&y===0)continue;return!1}}}var V=jn(l,f);return V==null||delete V[Wo(ys(f))]}function sp(l,f,y,k){return wl(l,f,y(qi(l,f)),k)}function ju(l,f,y,k){for(var R=l.length,M=k?R:-1;(k?M--:++M<R)&&f(l[M],M,l););return y?is(l,k?0:M,k?M+1:R):is(l,k?M+1:0,k?R:M)}function kc(l,f){var y=l;return y instanceof tr&&(y=y.value()),Rh(f,function(k,R){return R.func.apply(R.thisArg,va([k],R.args))},y)}function nf(l,f,y){var k=l.length;if(k<2)return k?Xi(l[0]):[];for(var R=-1,M=ve(k);++R<k;)for(var V=l[R],ee=-1;++ee<k;)ee!=R&&(M[R]=xi(M[R]||V,l[ee],f,y));return Xi(an(M,1),f,y)}function Fu(l,f,y){for(var k=-1,R=l.length,M=f.length,V={};++k<R;){var ee=k<M?f[k]:t;y(V,l[k],ee)}return V}function Cc(l){return Nn(l)?l:[]}function sf(l){return typeof l=="function"?l:Ao}function Si(l,f){return rr(l)?l:ct(l,f)?[l]:Sp(Lr(l))}var Hg=nr;function Qi(l,f,y){var k=l.length;return y=y===t?k:y,!f&&y>=k?l:is(l,f,y)}var op=Ag||function(l){return Xr.clearTimeout(l)};function ip(l,f){if(f)return l.slice();var y=l.length,k=Uh?Uh(y):new l.constructor(y);return l.copy(k),k}function Ou(l){var f=new l.constructor(l.byteLength);return new xu(f).set(new xu(l)),f}function Bg(l,f){var y=f?Ou(l.buffer):l.buffer;return new l.constructor(y,l.byteOffset,l.byteLength)}function Gg(l){var f=new l.constructor(l.source,Vt.exec(l));return f.lastIndex=l.lastIndex,f}function Wg(l){return Qs?Dr(Qs.call(l)):{}}function Vg(l,f){var y=f?Ou(l.buffer):l.buffer;return new l.constructor(y,l.byteOffset,l.length)}function ap(l,f){if(l!==f){var y=l!==t,k=l===null,R=l===l,M=Ko(l),V=f!==t,ee=f===null,ce=f===f,Ie=Ko(f);if(!ee&&!Ie&&!M&&l>f||M&&V&&ce&&!ee&&!Ie||k&&V&&ce||!y&&ce||!R)return 1;if(!k&&!M&&!Ie&&l<f||Ie&&y&&R&&!k&&!M||ee&&y&&R||!V&&R||!ce)return-1}return 0}function N0(l,f,y){for(var k=-1,R=l.criteria,M=f.criteria,V=R.length,ee=y.length;++k<V;){var ce=ap(R[k],M[k]);if(ce){if(k>=ee)return ce;var Ie=y[k];return ce*(Ie=="desc"?-1:1)}}return l.index-f.index}function qg(l,f,y,k){for(var R=-1,M=l.length,V=y.length,ee=-1,ce=f.length,Ie=yn(M-V,0),Re=ve(ce+Ie),Le=!k;++ee<ce;)Re[ee]=f[ee];for(;++R<V;)(Le||R<M)&&(Re[y[R]]=l[R]);for(;Ie--;)Re[ee++]=l[R++];return Re}function lp(l,f,y,k){for(var R=-1,M=l.length,V=-1,ee=y.length,ce=-1,Ie=f.length,Re=yn(M-ee,0),Le=ve(Re+Ie),Xe=!k;++R<Re;)Le[R]=l[R];for(var bt=R;++ce<Ie;)Le[bt+ce]=f[ce];for(;++V<ee;)(Xe||R<M)&&(Le[bt+y[V]]=l[R++]);return Le}function ms(l,f){var y=-1,k=l.length;for(f||(f=ve(k));++y<k;)f[y]=l[y];return f}function zo(l,f,y,k){var R=!y;y||(y={});for(var M=-1,V=f.length;++M<V;){var ee=f[M],ce=k?k(y[ee],l[ee],ee,y,l):t;ce===t&&(ce=l[ee]),R?yi(y,ee,ce):ml(y,ee,ce)}return y}function of(l,f){return zo(l,Ho(l),f)}function T0(l,f){return zo(l,Qg(l),f)}function af(l,f){return function(y,k){var R=rr(y)?Th:Zs,M=f?f():{};return R(y,l,Mt(k,2),M)}}function Nc(l){return nr(function(f,y){var k=-1,R=y.length,M=R>1?y[R-1]:t,V=R>2?y[2]:t;for(M=l.length>3&&typeof M=="function"?(R--,M):t,V&&vs(y[0],y[1],V)&&(M=R<3?t:M,R=1),f=Dr(f);++k<R;){var ee=y[k];ee&&l(f,ee,k,M)}return f})}function Eo(l,f){return function(y,k){if(y==null)return y;if(!No(y))return l(y,k);for(var R=y.length,M=f?R:-1,V=Dr(y);(f?M--:++M<R)&&k(V[M],M,V)!==!1;);return y}}function lf(l){return function(f,y,k){for(var R=-1,M=Dr(f),V=k(f),ee=V.length;ee--;){var ce=V[l?ee:++R];if(y(M[ce],ce,M)===!1)break}return f}}function cf(l,f,y){var k=f&T,R=Tc(l);function M(){var V=this&&this!==Xr&&this instanceof M?R:l;return V.apply(k?y:this,arguments)}return M}function cp(l){return function(f){f=Lr(f);var y=ac(f)?Xs(f):t,k=y?y[0]:f.charAt(0),R=y?Qi(y,1).join(""):f.slice(1);return k[l]()+R}}function bl(l){return function(f){return Rh(tE(eE(f).replace(Je,"")),l,"")}}function Tc(l){return function(){var f=arguments;switch(f.length){case 0:return new l;case 1:return new l(f[0]);case 2:return new l(f[0],f[1]);case 3:return new l(f[0],f[1],f[2]);case 4:return new l(f[0],f[1],f[2],f[3]);case 5:return new l(f[0],f[1],f[2],f[3],f[4]);case 6:return new l(f[0],f[1],f[2],f[3],f[4],f[5]);case 7:return new l(f[0],f[1],f[2],f[3],f[4],f[5],f[6])}var y=gc(l.prototype),k=l.apply(y,f);return fn(k)?k:y}}function up(l,f,y){var k=Tc(l);function R(){for(var M=arguments.length,V=ve(M),ee=M,ce=Zi(R);ee--;)V[ee]=arguments[ee];var Ie=M<3&&V[0]!==ce&&V[M-1]!==ce?[]:mo(V,ce);if(M-=Ie.length,M<y)return gs(l,f,Ac,R.placeholder,t,V,Ie,t,t,y-M);var Re=this&&this!==Xr&&this instanceof R?k:l;return hs(Re,this,V)}return R}function _l(l){return function(f,y,k){var R=Dr(f);if(!No(f)){var M=Mt(y,3);f=as(f),y=function(ee){return M(R[ee],ee,R)}}var V=l(f,y,k);return V>-1?R[M?f[V]:V]:t}}function uf(l){return ki(function(f){var y=f.length,k=y,R=ts.prototype.thru;for(l&&f.reverse();k--;){var M=f[k];if(typeof M!="function")throw new go(c);if(R&&!V&&Ic(M)=="wrapper")var V=new ts([],!0)}for(k=V?k:y;++k<y;){M=f[k];var ee=Ic(M),ce=ee=="wrapper"?hf(M):t;ce&&Bu(ce[0])&&ce[1]==(G|D|O|K)&&!ce[4].length&&ce[9]==1?V=V[Ic(ce[0])].apply(V,ce[3]):V=M.length==1&&Bu(M)?V[ee]():V.thru(M)}return function(){var Ie=arguments,Re=Ie[0];if(V&&Ie.length==1&&rr(Re))return V.plant(Re).value();for(var Le=0,Xe=y?f[Le].apply(this,Ie):Re;++Le<y;)Xe=f[Le].call(this,Xe);return Xe}})}function Ac(l,f,y,k,R,M,V,ee,ce,Ie){var Re=f&G,Le=f&T,Xe=f&A,bt=f&(D|j),Bt=f&re,ar=Xe?t:Tc(l);function Gt(){for(var fr=arguments.length,wr=ve(fr),Yo=fr;Yo--;)wr[Yo]=arguments[Yo];if(bt)var no=Zi(Gt),Jo=xg(wr,no);if(k&&(wr=qg(wr,k,R,bt)),M&&(wr=lp(wr,M,V,bt)),fr-=Jo,bt&&fr<Ie){var Tn=mo(wr,no);return gs(l,f,Ac,Gt.placeholder,y,wr,Tn,ee,ce,Ie-fr)}var na=Le?y:this,Rl=Xe?na[l]:l;return fr=wr.length,ee?wr=Bo(wr,ee):Bt&&fr>1&&wr.reverse(),Re&&ce<fr&&(wr.length=ce),this&&this!==Xr&&this instanceof Gt&&(Rl=ar||Tc(Rl)),Rl.apply(na,wr)}return Gt}function Kg(l,f){return function(y,k){return Ki(y,l,f(k),{})}}function Du(l,f){return function(y,k){var R;if(y===t&&k===t)return f;if(y!==t&&(R=y),k!==t){if(R===t)return k;typeof y=="string"||typeof k=="string"?(y=js(y),k=js(k)):(y=np(y),k=np(k)),R=l(y,k)}return R}}function df(l){return ki(function(f){return f=zr(f,Js(Mt())),nr(function(y){var k=this;return l(f,function(R){return hs(R,k,y)})})})}function Lu(l,f){f=f===t?" ":js(f);var y=f.length;if(y<2)return y?xl(f,l):f;var k=xl(f,ul(l/ll(f)));return ac(f)?Qi(Xs(k),0,l).join(""):k.slice(0,l)}function Yg(l,f,y,k){var R=f&T,M=Tc(l);function V(){for(var ee=-1,ce=arguments.length,Ie=-1,Re=k.length,Le=ve(Re+ce),Xe=this&&this!==Xr&&this instanceof V?M:l;++Ie<Re;)Le[Ie]=k[Ie];for(;ce--;)Le[Ie++]=arguments[++ee];return hs(Xe,R?y:this,Le)}return V}function dp(l){return function(f,y,k){return k&&typeof k!="number"&&vs(f,y,k)&&(y=k=t),f=Il(f),y===t?(y=f,f=0):y=Il(y),k=k===t?f<y?1:-1:Il(k),Pu(f,y,k,l)}}function ff(l){return function(f,y){return typeof f=="string"&&typeof y=="string"||(f=Ni(f),y=Ni(y)),l(f,y)}}function gs(l,f,y,k,R,M,V,ee,ce,Ie){var Re=f&D,Le=Re?V:t,Xe=Re?t:V,bt=Re?M:t,Bt=Re?t:M;f|=Re?O:B,f&=~(Re?B:O),f&I||(f&=-4);var ar=[l,f,R,bt,Le,Bt,Xe,ee,ce,Ie],Gt=y.apply(t,ar);return Bu(l)&&bp(Gt,ar),Gt.placeholder=k,_p(Gt,l,f)}function Bn(l){var f=vn[l];return function(y,k){if(y=Ni(y),k=k==null?0:es(sr(k),292),k&&dc(y)){var R=(Lr(y)+"e").split("e"),M=f(R[0]+"e"+(+R[1]+k));return R=(Lr(M)+"e").split("e"),+(R[0]+"e"+(+R[1]-k))}return f(y)}}var Jg=wa&&1/ya(new wa([,-0]))[1]==J?function(l){return new wa(l)}:rx;function fp(l){return function(f){var y=Gn(f);return y==Ee?Td(f):y==ut?b0(f):y0(f,l(f))}}function Ei(l,f,y,k,R,M,V,ee){var ce=f&A;if(!ce&&typeof l!="function")throw new go(c);var Ie=k?k.length:0;if(Ie||(f&=-97,k=R=t),V=V===t?V:yn(sr(V),0),ee=ee===t?ee:sr(ee),Ie-=R?R.length:0,f&B){var Re=k,Le=R;k=R=t}var Xe=ce?t:hf(l),bt=[l,f,y,k,R,Re,Le,M,V,ee];if(Xe&&rv(bt,Xe),l=bt[0],f=bt[1],y=bt[2],k=bt[3],R=bt[4],ee=bt[9]=bt[9]===t?ce?0:l.length:yn(bt[9]-Ie,0),!ee&&f&(D|j)&&(f&=-25),!f||f==T)var Bt=cf(l,f,y);else f==D||f==j?Bt=up(l,f,ee):(f==O||f==(T|O))&&!R.length?Bt=Yg(l,f,y,k):Bt=Ac.apply(t,bt);var ar=Xe?ef:bp;return _p(ar(Bt,bt),l,f)}function hp(l,f,y,k){return l===t||ra(l,hi[y])&&!yr.call(k,y)?f:l}function pp(l,f,y,k,R,M){return fn(l)&&fn(f)&&(M.set(f,l),yl(l,f,t,pp,M),M.delete(f)),l}function mp(l){return Mp(l)?t:l}function gp(l,f,y,k,R,M){var V=y&N,ee=l.length,ce=f.length;if(ee!=ce&&!(V&&ce>ee))return!1;var Ie=M.get(l),Re=M.get(f);if(Ie&&Re)return Ie==f&&Re==l;var Le=-1,Xe=!0,bt=y&E?new fl:t;for(M.set(l,f),M.set(f,l);++Le<ee;){var Bt=l[Le],ar=f[Le];if(k)var Gt=V?k(ar,Bt,Le,f,l,M):k(Bt,ar,Le,l,f,M);if(Gt!==t){if(Gt)continue;Xe=!1;break}if(bt){if(!Ph(f,function(fr,wr){if(!zi(bt,wr)&&(Bt===fr||R(Bt,fr,y,k,M)))return bt.push(wr)})){Xe=!1;break}}else if(!(Bt===ar||R(Bt,ar,y,k,M))){Xe=!1;break}}return M.delete(l),M.delete(f),Xe}function vp(l,f,y,k,R,M,V){switch(y){case ht:if(l.byteLength!=f.byteLength||l.byteOffset!=f.byteOffset)return!1;l=l.buffer,f=f.buffer;case je:return!(l.byteLength!=f.byteLength||!M(new xu(l),new xu(f)));case we:case Ne:case ye:return ra(+l,+f);case St:return l.name==f.name&&l.message==f.message;case jt:case Jt:return l==f+"";case Ee:var ee=Td;case ut:var ce=k&N;if(ee||(ee=ya),l.size!=f.size&&!ce)return!1;var Ie=V.get(l);if(Ie)return Ie==f;k|=E,V.set(l,f);var Re=gp(ee(l),ee(f),k,R,M,V);return V.delete(l),Re;case Or:if(Qs)return Qs.call(l)==Qs.call(f)}return!1}function Xg(l,f,y,k,R,M){var V=y&N,ee=Mu(l),ce=ee.length,Ie=Mu(f),Re=Ie.length;if(ce!=Re&&!V)return!1;for(var Le=ce;Le--;){var Xe=ee[Le];if(!(V?Xe in f:yr.call(f,Xe)))return!1}var bt=M.get(l),Bt=M.get(f);if(bt&&Bt)return bt==f&&Bt==l;var ar=!0;M.set(l,f),M.set(f,l);for(var Gt=V;++Le<ce;){Xe=ee[Le];var fr=l[Xe],wr=f[Xe];if(k)var Yo=V?k(wr,fr,Xe,f,l,M):k(fr,wr,Xe,l,f,M);if(!(Yo===t?fr===wr||R(fr,wr,y,k,M):Yo)){ar=!1;break}Gt||(Gt=Xe=="constructor")}if(ar&&!Gt){var no=l.constructor,Jo=f.constructor;no!=Jo&&"constructor"in l&&"constructor"in f&&!(typeof no=="function"&&no instanceof no&&typeof Jo=="function"&&Jo instanceof Jo)&&(ar=!1)}return M.delete(l),M.delete(f),ar}function ki(l){return to(vf(l,t,wf),l+"")}function Mu(l){return Kd(l,as,Ho)}function $u(l){return Kd(l,To,Qg)}var hf=$d?function(l){return $d.get(l)}:rx;function Ic(l){for(var f=l.name+"",y=pc[f],k=yr.call(pc,f)?y.length:0;k--;){var R=y[k],M=R.func;if(M==null||M==l)return R.name}return f}function Zi(l){var f=yr.call(L,"placeholder")?L:l;return f.placeholder}function Mt(){var l=L.iteratee||ex;return l=l===ex?_c:l,arguments.length?l(arguments[0],arguments[1]):l}function Uu(l,f){var y=l.__data__;return Rc(f)?y[typeof f=="string"?"string":"hash"]:y.map}function zu(l){for(var f=as(l),y=f.length;y--;){var k=f[y],R=l[k];f[y]=[k,R,Gu(R)]}return f}function Aa(l,f){var y=ic(l,f);return Yh(y)?y:t}function pf(l){var f=yr.call(l,cl),y=l[cl];try{l[cl]=t;var k=!0}catch{}var R=vu.call(l);return k&&(f?l[cl]=y:delete l[cl]),R}var Ho=Dd?function(l){return l==null?[]:(l=Dr(l),ga(Dd(l),function(f){return Fd.call(l,f)}))}:nx,Qg=Dd?function(l){for(var f=[];l;)va(f,Ho(l)),l=$o(l);return f}:nx,Gn=Hn;(_u&&Gn(new _u(new ArrayBuffer(1)))!=ht||dl&&Gn(new dl)!=Ee||Su&&Gn(Su.resolve())!=ft||wa&&Gn(new wa)!=ut||Eu&&Gn(new Eu)!=Nr)&&(Gn=function(l){var f=Hn(l),y=f==qe?l.constructor:t,k=y?Ia(y):"";if(k)switch(k){case Bh:return ht;case ba:return Ee;case Rg:return ft;case mc:return ut;case pi:return Nr}return f});function yp(l,f,y){for(var k=-1,R=y.length;++k<R;){var M=y[k],V=M.size;switch(M.type){case"drop":l+=V;break;case"dropRight":f-=V;break;case"take":f=es(f,l+V);break;case"takeRight":l=yn(l,f-V);break}}return{start:l,end:f}}function Zg(l){var f=l.match(Pn);return f?f[1].split(le):[]}function xp(l,f,y){f=Si(f,l);for(var k=-1,R=f.length,M=!1;++k<R;){var V=Wo(f[k]);if(!(M=l!=null&&y(l,V)))break;l=l[V]}return M||++k!=R?M:(R=l==null?0:l.length,!!R&&xv(R)&&Zr(V,R)&&(rr(l)||Qu(l)))}function Hu(l){var f=l.length,y=new l.constructor(f);return f&&typeof l[0]=="string"&&yr.call(l,"index")&&(y.index=l.index,y.input=l.input),y}function Wn(l){return typeof l.constructor=="function"&&!ea(l)?gc($o(l)):{}}function A0(l,f,y){var k=l.constructor;switch(f){case je:return Ou(l);case we:case Ne:return new k(+l);case ht:return Bg(l,y);case wt:case We:case Ve:case lt:case Pe:case kt:case Ft:case $e:case cr:return Vg(l,y);case Ee:return new k;case ye:case Jt:return new k(l);case jt:return Gg(l);case ut:return new k;case Or:return Wg(l)}}function I0(l,f){var y=f.length;if(!y)return l;var k=y-1;return f[k]=(y>1?"& ":"")+f[k],f=f.join(y>2?", ":" "),l.replace(zn,`{
/* [wrapped with `+f+`] */
`)}function mf(l){return rr(l)||Qu(l)||!!(Tg&&l&&l[Tg])}function Zr(l,f){var y=typeof l;return f=f??Y,!!f&&(y=="number"||y!="symbol"&&q.test(l))&&l>-1&&l%1==0&&l<f}function vs(l,f,y){if(!fn(y))return!1;var k=typeof f;return(k=="number"?No(y)&&Zr(f,y.length):k=="string"&&f in y)?ra(y[f],l):!1}function ct(l,f){if(rr(l))return!1;var y=typeof l;return y=="number"||y=="symbol"||y=="boolean"||l==null||Ko(l)?!0:Do.test(l)||!po.test(l)||f!=null&&l in Dr(f)}function Rc(l){var f=typeof l;return f=="string"||f=="number"||f=="symbol"||f=="boolean"?l!=="__proto__":l===null}function Bu(l){var f=Ic(l),y=L[f];if(typeof y!="function"||!(f in tr.prototype))return!1;if(l===y)return!0;var k=hf(y);return!!k&&l===k[0]}function ev(l){return!!Rd&&Rd in l}var R0=cc?Al:sx;function ea(l){var f=l&&l.constructor,y=typeof f=="function"&&f.prototype||hi;return l===y}function Gu(l){return l===l&&!fn(l)}function gf(l,f){return function(y){return y==null?!1:y[l]===f&&(f!==t||l in Dr(y))}}function tv(l){var f=pe(l,function(k){return y.size===p&&y.clear(),k}),y=f.cache;return f}function rv(l,f){var y=l[1],k=f[1],R=y|k,M=R<(T|A|G),V=k==G&&y==D||k==G&&y==K&&l[7].length<=f[8]||k==(G|K)&&f[7].length<=f[8]&&y==D;if(!(M||V))return l;k&T&&(l[2]=f[2],R|=y&T?0:I);var ee=f[3];if(ee){var ce=l[3];l[3]=ce?qg(ce,ee,f[4]):ee,l[4]=ce?mo(l[3],v):f[4]}return ee=f[5],ee&&(ce=l[5],l[5]=ce?lp(ce,ee,f[6]):ee,l[6]=ce?mo(l[5],v):f[6]),ee=f[7],ee&&(l[7]=ee),k&G&&(l[8]=l[8]==null?f[8]:es(l[8],f[8])),l[9]==null&&(l[9]=f[9]),l[0]=f[0],l[1]=R,l}function nv(l){var f=[];if(l!=null)for(var y in Dr(l))f.push(y);return f}function wp(l){return vu.call(l)}function vf(l,f,y){return f=yn(f===t?l.length-1:f,0),function(){for(var k=arguments,R=-1,M=yn(k.length-f,0),V=ve(M);++R<M;)V[R]=k[f+R];R=-1;for(var ee=ve(f+1);++R<f;)ee[R]=k[R];return ee[f]=y(V),hs(l,this,ee)}}function jn(l,f){return f.length<2?l:qi(l,is(f,0,-1))}function Bo(l,f){for(var y=l.length,k=es(f.length,y),R=ms(l);k--;){var M=f[k];l[k]=Zr(M,y)?R[M]:t}return l}function Ci(l,f){if(!(f==="constructor"&&typeof l[f]=="function")&&f!="__proto__")return l[f]}var bp=Go(ef),Pc=zh||function(l,f){return Xr.setTimeout(l,f)},to=Go(_i);function _p(l,f,y){var k=f+"";return to(l,I0(k,sv(Zg(k),y)))}function Go(l){var f=0,y=0;return function(){var k=C0(),R=ge-(k-y);if(y=k,R>0){if(++f>=U)return arguments[0]}else f=0;return l.apply(t,arguments)}}function yf(l,f){var y=-1,k=l.length,R=k-1;for(f=f===t?k:f;++y<f;){var M=Sc(y,R),V=l[M];l[M]=l[y],l[y]=V}return l.length=f,l}var Sp=tv(function(l){var f=[];return l.charCodeAt(0)===46&&f.push(""),l.replace(Sn,function(y,k,R,M){f.push(R?M.replace(dt,"$1"):k||y)}),f});function Wo(l){if(typeof l=="string"||Ko(l))return l;var f=l+"";return f=="0"&&1/l==-J?"-0":f}function Ia(l){if(l!=null){try{return gu.call(l)}catch{}try{return l+""}catch{}}return""}function sv(l,f){return Zn(Se,function(y){var k="_."+y[0];f&y[1]&&!kd(l,k)&&l.push(k)}),l.sort()}function ov(l){if(l instanceof tr)return l.clone();var f=new ts(l.__wrapped__,l.__chain__);return f.__actions__=ms(l.__actions__),f.__index__=l.__index__,f.__values__=l.__values__,f}function xf(l,f,y){(y?vs(l,f,y):f===t)?f=1:f=yn(sr(f),0);var k=l==null?0:l.length;if(!k||f<1)return[];for(var R=0,M=0,V=ve(ul(k/f));R<k;)V[M++]=is(l,R,R+=f);return V}function Ep(l){for(var f=-1,y=l==null?0:l.length,k=0,R=[];++f<y;){var M=l[f];M&&(R[k++]=M)}return R}function ko(){var l=arguments.length;if(!l)return[];for(var f=ve(l-1),y=arguments[0],k=l;k--;)f[k-1]=arguments[k];return va(rr(y)?ms(y):[y],an(f,1))}var xr=nr(function(l,f){return Nn(l)?xi(l,an(f,1,Nn,!0)):[]}),Fn=nr(function(l,f){var y=ys(f);return Nn(y)&&(y=t),Nn(l)?xi(l,an(f,1,Nn,!0),Mt(y,2)):[]}),xn=nr(function(l,f){var y=ys(f);return Nn(y)&&(y=t),Nn(l)?xi(l,an(f,1,Nn,!0),t,y):[]});function Vn(l,f,y){var k=l==null?0:l.length;return k?(f=y||f===t?1:sr(f),is(l,f<0?0:f,k)):[]}function ro(l,f,y){var k=l==null?0:l.length;return k?(f=y||f===t?1:sr(f),f=k-f,is(l,0,f<0?0:f)):[]}function jc(l,f){return l&&l.length?ju(l,Mt(f,3),!0,!0):[]}function Cn(l,f){return l&&l.length?ju(l,Mt(f,3),!0):[]}function Wu(l,f,y,k){var R=l==null?0:l.length;return R?(y&&typeof y!="number"&&vs(l,f,y)&&(y=0,k=R),$g(l,f,y,k)):[]}function Ra(l,f,y){var k=l==null?0:l.length;if(!k)return-1;var R=y==null?0:sr(y);return R<0&&(R=yn(k+R,0)),Cd(l,Mt(f,3),R)}function Vu(l,f,y){var k=l==null?0:l.length;if(!k)return-1;var R=k-1;return y!==t&&(R=sr(y),R=y<0?yn(k+R,0):es(R,k-1)),Cd(l,Mt(f,3),R,!0)}function wf(l){var f=l==null?0:l.length;return f?an(l,1):[]}function qu(l){var f=l==null?0:l.length;return f?an(l,J):[]}function Fs(l,f){var y=l==null?0:l.length;return y?(f=f===t?1:sr(f),an(l,f)):[]}function kp(l){for(var f=-1,y=l==null?0:l.length,k={};++f<y;){var R=l[f];k[R[0]]=R[1]}return k}function Sl(l){return l&&l.length?l[0]:t}function ta(l,f,y){var k=l==null?0:l.length;if(!k)return-1;var R=y==null?0:sr(y);return R<0&&(R=yn(k+R,0)),oc(l,f,R)}function bf(l){var f=l==null?0:l.length;return f?is(l,0,-1):[]}var Cp=nr(function(l){var f=zr(l,Cc);return f.length&&f[0]===l[0]?Yd(f):[]}),Pa=nr(function(l){var f=ys(l),y=zr(l,Cc);return f===ys(y)?f=t:y.pop(),y.length&&y[0]===l[0]?Yd(y,Mt(f,2)):[]}),_f=nr(function(l){var f=ys(l),y=zr(l,Cc);return f=typeof f=="function"?f:t,f&&y.pop(),y.length&&y[0]===l[0]?Yd(y,t,f):[]});function ja(l,f){return l==null?"":Ld.call(l,f)}function ys(l){var f=l==null?0:l.length;return f?l[f-1]:t}function Ku(l,f,y){var k=l==null?0:l.length;if(!k)return-1;var R=k;return y!==t&&(R=sr(y),R=R<0?yn(k+R,0):es(R,k-1)),f===f?_0(l,f,R):Cd(l,pg,R,!0)}function Np(l,f){return l&&l.length?Zd(l,sr(f)):t}var Sf=nr(Yu);function Yu(l,f){return l&&l.length&&f&&f.length?un(l,f):l}function xs(l,f,y){return l&&l.length&&f&&f.length?un(l,f,Mt(y,2)):l}function Fa(l,f,y){return l&&l.length&&f&&f.length?un(l,f,t,y):l}var Vo=ki(function(l,f){var y=l==null?0:l.length,k=Vd(l,f);return kn(l,zr(f,function(R){return Zr(R,y)?+R:R}).sort(ap)),k});function Os(l,f){var y=[];if(!(l&&l.length))return y;var k=-1,R=[],M=l.length;for(f=Mt(f,3);++k<M;){var V=l[k];f(V,k,l)&&(y.push(V),R.push(k))}return kn(l,R),y}function Ef(l){return l==null?l:Md.call(l)}function Tp(l,f,y){var k=l==null?0:l.length;return k?(y&&typeof y!="number"&&vs(l,f,y)?(f=0,y=k):(f=f==null?0:sr(f),y=y===t?k:sr(y)),is(l,f,y)):[]}function Ap(l,f){return Ec(l,f)}function P0(l,f,y){return tf(l,f,Mt(y,2))}function Oa(l,f){var y=l==null?0:l.length;if(y){var k=Ec(l,f);if(k<y&&ra(l[k],f))return k}return-1}function iv(l,f){return Ec(l,f,!0)}function Ip(l,f,y){return tf(l,f,Mt(y,2),!0)}function El(l,f){var y=l==null?0:l.length;if(y){var k=Ec(l,f,!0)-1;if(ra(l[k],f))return k}return-1}function Rp(l){return l&&l.length?rp(l):[]}function kl(l,f){return l&&l.length?rp(l,Mt(f,2)):[]}function av(l){var f=l==null?0:l.length;return f?is(l,1,f):[]}function lv(l,f,y){return l&&l.length?(f=y||f===t?1:sr(f),is(l,0,f<0?0:f)):[]}function Pp(l,f,y){var k=l==null?0:l.length;return k?(f=y||f===t?1:sr(f),f=k-f,is(l,f<0?0:f,k)):[]}function kf(l,f){return l&&l.length?ju(l,Mt(f,3),!1,!0):[]}function j0(l,f){return l&&l.length?ju(l,Mt(f,3)):[]}var F0=nr(function(l){return Xi(an(l,1,Nn,!0))}),cv=nr(function(l){var f=ys(l);return Nn(f)&&(f=t),Xi(an(l,1,Nn,!0),Mt(f,2))}),uv=nr(function(l){var f=ys(l);return f=typeof f=="function"?f:t,Xi(an(l,1,Nn,!0),t,f)});function Cl(l){return l&&l.length?Xi(l):[]}function O0(l,f){return l&&l.length?Xi(l,Mt(f,2)):[]}function Fc(l,f){return f=typeof f=="function"?f:t,l&&l.length?Xi(l,t,f):[]}function Cf(l){if(!(l&&l.length))return[];var f=0;return l=ga(l,function(y){if(Nn(y))return f=yn(y.length,f),!0}),Dh(f,function(y){return zr(l,Fh(y))})}function rn(l,f){if(!(l&&l.length))return[];var y=Cf(l);return f==null?y:zr(y,function(k){return hs(f,t,k)})}var D0=nr(function(l,f){return Nn(l)?xi(l,f):[]}),dv=nr(function(l){return nf(ga(l,Nn))}),L0=nr(function(l){var f=ys(l);return Nn(f)&&(f=t),nf(ga(l,Nn),Mt(f,2))}),M0=nr(function(l){var f=ys(l);return f=typeof f=="function"?f:t,nf(ga(l,Nn),t,f)}),fv=nr(Cf);function hv(l,f){return Fu(l||[],f||[],ml)}function $0(l,f){return Fu(l||[],f||[],wl)}var Co=nr(function(l){var f=l.length,y=f>1?l[f-1]:t;return y=typeof y=="function"?(l.pop(),y):t,rn(l,y)});function Nf(l){var f=L(l);return f.__chain__=!0,f}function U0(l,f){return f(l),l}function qo(l,f){return f(l)}var Tf=ki(function(l){var f=l.length,y=f?l[0]:0,k=this.__wrapped__,R=function(M){return Vd(M,l)};return f>1||this.__actions__.length||!(k instanceof tr)||!Zr(y)?this.thru(R):(k=k.slice(y,+y+(f?1:0)),k.__actions__.push({func:qo,args:[R],thisArg:t}),new ts(k,this.__chain__).thru(function(M){return f&&!M.length&&M.push(t),M}))});function Nl(){return Nf(this)}function Af(){return new ts(this.value(),this.__chain__)}function jp(){this.__values__===t&&(this.__values__=WS(this.value()));var l=this.__index__>=this.__values__.length,f=l?t:this.__values__[this.__index__++];return{done:l,value:f}}function Fp(){return this}function z0(l){for(var f,y=this;y instanceof mi;){var k=ov(y);k.__index__=0,k.__values__=t,f?R.__wrapped__=k:f=k;var R=k;y=y.__wrapped__}return R.__wrapped__=l,f}function Op(){var l=this.__wrapped__;if(l instanceof tr){var f=l;return this.__actions__.length&&(f=new tr(this)),f=f.reverse(),f.__actions__.push({func:qo,args:[Ef],thisArg:t}),new ts(f,this.__chain__)}return this.thru(Ef)}function H0(){return kc(this.__wrapped__,this.__actions__)}var pv=af(function(l,f,y){yr.call(l,y)?++l[y]:yi(l,y,1)});function mv(l,f,y){var k=rr(l)?Ah:Nu;return y&&vs(l,f,y)&&(f=t),k(l,Mt(f,3))}function If(l,f){var y=rr(l)?ga:qh;return y(l,Mt(f,3))}var Rf=_l(Ra),gv=_l(Vu);function Dp(l,f){return an(Tl(l,f),1)}function B0(l,f){return an(Tl(l,f),J)}function vv(l,f,y){return y=y===t?1:sr(y),an(Tl(l,f),y)}function Pf(l,f){var y=rr(l)?Zn:wi;return y(l,Mt(f,3))}function Ju(l,f){var y=rr(l)?Ed:Mg;return y(l,Mt(f,3))}var Lp=af(function(l,f,y){yr.call(l,y)?l[y].push(f):yi(l,y,[f])});function jf(l,f,y,k){l=No(l)?l:Df(l),y=y&&!k?sr(y):0;var R=l.length;return y<0&&(y=yn(R+y,0)),wv(l)?y<=R&&l.indexOf(f,y)>-1:!!R&&oc(l,f,y)>-1}var yv=nr(function(l,f,y){var k=-1,R=typeof f=="function",M=No(l)?ve(l.length):[];return wi(l,function(V){M[++k]=R?hs(f,V,y):bo(V,f,y)}),M}),G0=af(function(l,f,y){yi(l,y,f)});function Tl(l,f){var y=rr(l)?zr:Xh;return y(l,Mt(f,3))}function W0(l,f,y,k){return l==null?[]:(rr(f)||(f=f==null?[]:[f]),y=k?t:y,rr(y)||(y=y==null?[]:[y]),Ru(l,f,y))}var Xu=af(function(l,f,y){l[y?0:1].push(f)},function(){return[[],[]]});function V0(l,f,y){var k=rr(l)?Rh:gg,R=arguments.length<3;return k(l,Mt(f,4),y,R,wi)}function Ff(l,f,y){var k=rr(l)?p0:gg,R=arguments.length<3;return k(l,Mt(f,4),y,R,Mg)}function o(l,f){var y=rr(l)?ga:qh;return y(l,He(Mt(f,3)))}function a(l){var f=rr(l)?vi:os;return f(l)}function h(l,f,y){(y?vs(l,f,y):f===t)?f=1:f=sr(f);var k=rr(l)?pl:ep;return k(l,f)}function g(l){var f=rr(l)?Dg:So;return f(l)}function _(l){if(l==null)return 0;if(No(l))return wv(l)?ll(l):l.length;var f=Gn(l);return f==Ee||f==ut?l.size:Ji(l).length}function C(l,f,y){var k=rr(l)?Ph:tp;return y&&vs(l,f,y)&&(f=t),k(l,Mt(f,3))}var P=nr(function(l,f){if(l==null)return[];var y=f.length;return y>1&&vs(l,f[0],f[1])?f=[]:y>2&&vs(f[0],f[1],f[2])&&(f=[f[0]]),Ru(l,an(f,1),[])}),W=Wr||function(){return Xr.Date.now()};function Z(l,f){if(typeof f!="function")throw new go(c);return l=sr(l),function(){if(--l<1)return f.apply(this,arguments)}}function xe(l,f,y){return f=y?t:f,f=l&&f==null?l.length:f,Ei(l,G,t,t,t,t,f)}function Oe(l,f){var y;if(typeof f!="function")throw new go(c);return l=sr(l),function(){return--l>0&&(y=f.apply(this,arguments)),l<=1&&(f=t),y}}var Ue=nr(function(l,f,y){var k=T;if(y.length){var R=mo(y,Zi(Ue));k|=O}return Ei(l,k,f,y,R)}),Fe=nr(function(l,f,y){var k=T|A;if(y.length){var R=mo(y,Zi(Fe));k|=O}return Ei(f,k,l,y,R)});function nt(l,f,y){f=y?t:f;var k=Ei(l,D,t,t,t,t,t,f);return k.placeholder=nt.placeholder,k}function gt(l,f,y){f=y?t:f;var k=Ei(l,j,t,t,t,t,t,f);return k.placeholder=gt.placeholder,k}function vt(l,f,y){var k,R,M,V,ee,ce,Ie=0,Re=!1,Le=!1,Xe=!0;if(typeof l!="function")throw new go(c);f=Ni(f)||0,fn(y)&&(Re=!!y.leading,Le="maxWait"in y,M=Le?yn(Ni(y.maxWait)||0,f):M,Xe="trailing"in y?!!y.trailing:Xe);function bt(Tn){var na=k,Rl=R;return k=R=t,Ie=Tn,V=l.apply(Rl,na),V}function Bt(Tn){return Ie=Tn,ee=Pc(fr,f),Re?bt(Tn):V}function ar(Tn){var na=Tn-ce,Rl=Tn-Ie,sE=f-na;return Le?es(sE,M-Rl):sE}function Gt(Tn){var na=Tn-ce,Rl=Tn-Ie;return ce===t||na>=f||na<0||Le&&Rl>=M}function fr(){var Tn=W();if(Gt(Tn))return wr(Tn);ee=Pc(fr,ar(Tn))}function wr(Tn){return ee=t,Xe&&k?bt(Tn):(k=R=t,V)}function Yo(){ee!==t&&op(ee),Ie=0,k=ce=R=ee=t}function no(){return ee===t?V:wr(W())}function Jo(){var Tn=W(),na=Gt(Tn);if(k=arguments,R=this,ce=Tn,na){if(ee===t)return Bt(ce);if(Le)return op(ee),ee=Pc(fr,f),bt(ce)}return ee===t&&(ee=Pc(fr,f)),V}return Jo.cancel=Yo,Jo.flush=no,Jo}var dn=nr(function(l,f){return Vh(l,1,f)}),fe=nr(function(l,f,y){return Vh(l,Ni(f)||0,y)});function ne(l){return Ei(l,re)}function pe(l,f){if(typeof l!="function"||f!=null&&typeof f!="function")throw new go(c);var y=function(){var k=arguments,R=f?f.apply(this,k):k[0],M=y.cache;if(M.has(R))return M.get(R);var V=l.apply(this,k);return y.cache=M.set(R,V)||M,V};return y.cache=new(pe.Cache||vo),y}pe.Cache=vo;function He(l){if(typeof l!="function")throw new go(c);return function(){var f=arguments;switch(f.length){case 0:return!l.call(this);case 1:return!l.call(this,f[0]);case 2:return!l.call(this,f[0],f[1]);case 3:return!l.call(this,f[0],f[1],f[2])}return!l.apply(this,f)}}function yt(l){return Oe(2,l)}var Ot=Hg(function(l,f){f=f.length==1&&rr(f[0])?zr(f[0],Js(Mt())):zr(an(f,1),Js(Mt()));var y=f.length;return nr(function(k){for(var R=-1,M=es(k.length,y);++R<M;)k[R]=f[R].call(this,k[R]);return hs(l,this,k)})}),Nt=nr(function(l,f){var y=mo(f,Zi(Nt));return Ei(l,O,t,f,y)}),Ht=nr(function(l,f){var y=mo(f,Zi(Ht));return Ei(l,B,t,f,y)}),On=ki(function(l,f){return Ei(l,K,t,t,t,f)});function kr(l,f){if(typeof l!="function")throw new go(c);return f=f===t?f:sr(f),nr(l,f)}function Da(l,f){if(typeof l!="function")throw new go(c);return f=f==null?0:yn(sr(f),0),nr(function(y){var k=y[f],R=Qi(y,0,f);return k&&va(R,k),hs(l,this,R)})}function q0(l,f,y){var k=!0,R=!0;if(typeof l!="function")throw new go(c);return fn(y)&&(k="leading"in y?!!y.leading:k,R="trailing"in y?!!y.trailing:R),vt(l,f,{leading:k,maxWait:f,trailing:R})}function pj(l){return xe(l,1)}function mj(l,f){return Nt(sf(f),l)}function gj(){if(!arguments.length)return[];var l=arguments[0];return rr(l)?l:[l]}function vj(l){return Ps(l,S)}function yj(l,f){return f=typeof f=="function"?f:t,Ps(l,S,f)}function xj(l){return Ps(l,x|S)}function wj(l,f){return f=typeof f=="function"?f:t,Ps(l,x|S,f)}function bj(l,f){return f==null||Cu(l,f,as(f))}function ra(l,f){return l===f||l!==l&&f!==f}var _j=ff(Ca),Sj=ff(function(l,f){return l>=f}),Qu=Jd((function(){return arguments})())?Jd:function(l){return wn(l)&&yr.call(l,"callee")&&!Fd.call(l,"callee")},rr=ve.isArray,Ej=Nh?Js(Nh):Ug;function No(l){return l!=null&&xv(l.length)&&!Al(l)}function Nn(l){return wn(l)&&No(l)}function kj(l){return l===!0||l===!1||wn(l)&&Hn(l)==we}var Oc=Hh||sx,Cj=Ts?Js(Ts):Yi;function Nj(l){return wn(l)&&l.nodeType===1&&!Mp(l)}function Tj(l){if(l==null)return!0;if(No(l)&&(rr(l)||typeof l=="string"||typeof l.splice=="function"||Oc(l)||Of(l)||Qu(l)))return!l.length;var f=Gn(l);if(f==Ee||f==ut)return!l.size;if(ea(l))return!Ji(l).length;for(var y in l)if(yr.call(l,y))return!1;return!0}function Aj(l,f){return _o(l,f)}function Ij(l,f,y){y=typeof y=="function"?y:t;var k=y?y(l,f):t;return k===t?_o(l,f,t,y):!!k}function K0(l){if(!wn(l))return!1;var f=Hn(l);return f==St||f==Me||typeof l.message=="string"&&typeof l.name=="string"&&!Mp(l)}function Rj(l){return typeof l=="number"&&dc(l)}function Al(l){if(!fn(l))return!1;var f=Hn(l);return f==Te||f==Ge||f==X||f==mt}function zS(l){return typeof l=="number"&&l==sr(l)}function xv(l){return typeof l=="number"&&l>-1&&l%1==0&&l<=Y}function fn(l){var f=typeof l;return l!=null&&(f=="object"||f=="function")}function wn(l){return l!=null&&typeof l=="object"}var HS=al?Js(al):zg;function Pj(l,f){return l===f||bc(l,f,zu(f))}function jj(l,f,y){return y=typeof y=="function"?y:t,bc(l,f,zu(f),y)}function Fj(l){return BS(l)&&l!=+l}function Oj(l){if(R0(l))throw new qt(i);return Yh(l)}function Dj(l){return l===null}function Lj(l){return l==null}function BS(l){return typeof l=="number"||wn(l)&&Hn(l)==ye}function Mp(l){if(!wn(l)||Hn(l)!=qe)return!1;var f=$o(l);if(f===null)return!0;var y=yr.call(f,"constructor")&&f.constructor;return typeof y=="function"&&y instanceof y&&gu.call(y)==Pd}var Y0=Sd?Js(Sd):Au;function Mj(l){return zS(l)&&l>=-Y&&l<=Y}var GS=sc?Js(sc):bi;function wv(l){return typeof l=="string"||!rr(l)&&wn(l)&&Hn(l)==Jt}function Ko(l){return typeof l=="symbol"||wn(l)&&Hn(l)==Or}var Of=dg?Js(dg):Iu;function $j(l){return l===t}function Uj(l){return wn(l)&&Gn(l)==Nr}function zj(l){return wn(l)&&Hn(l)==me}var Hj=ff(Na),Bj=ff(function(l,f){return l<=f});function WS(l){if(!l)return[];if(No(l))return wv(l)?Xs(l):ms(l);if(Gi&&l[Gi])return w0(l[Gi]());var f=Gn(l),y=f==Ee?Td:f==ut?ya:Df;return y(l)}function Il(l){if(!l)return l===0?l:0;if(l=Ni(l),l===J||l===-J){var f=l<0?-1:1;return f*$}return l===l?l:0}function sr(l){var f=Il(l),y=f%1;return f===f?y?f-y:f:0}function VS(l){return l?Vi(sr(l),0,F):0}function Ni(l){if(typeof l=="number")return l;if(Ko(l))return Q;if(fn(l)){var f=typeof l.valueOf=="function"?l.valueOf():l;l=fn(f)?f+"":f}if(typeof l!="string")return l===0?l:+l;l=vg(l);var y=Qt.test(l);return y||Be.test(l)?bd(l.slice(2),y?2:8):_t.test(l)?Q:+l}function qS(l){return zo(l,To(l))}function Gj(l){return l?Vi(sr(l),-Y,Y):l===0?l:0}function Lr(l){return l==null?"":js(l)}var Wj=Nc(function(l,f){if(ea(f)||No(f)){zo(f,as(f),l);return}for(var y in f)yr.call(f,y)&&ml(l,y,f[y])}),KS=Nc(function(l,f){zo(f,To(f),l)}),bv=Nc(function(l,f,y,k){zo(f,To(f),l,k)}),Vj=Nc(function(l,f,y,k){zo(f,as(f),l,k)}),qj=ki(Vd);function Kj(l,f){var y=gc(l);return f==null?y:qr(y,f)}var Yj=nr(function(l,f){l=Dr(l);var y=-1,k=f.length,R=k>2?f[2]:t;for(R&&vs(f[0],f[1],R)&&(k=1);++y<k;)for(var M=f[y],V=To(M),ee=-1,ce=V.length;++ee<ce;){var Ie=V[ee],Re=l[Ie];(Re===t||ra(Re,hi[Ie])&&!yr.call(l,Ie))&&(l[Ie]=M[Ie])}return l}),Jj=nr(function(l){return l.push(t,pp),hs(YS,t,l)});function Xj(l,f){return hg(l,Mt(f,3),eo)}function Qj(l,f){return hg(l,Mt(f,3),ka)}function Zj(l,f){return l==null?l:qd(l,Mt(f,3),To)}function eF(l,f){return l==null?l:Tu(l,Mt(f,3),To)}function tF(l,f){return l&&eo(l,Mt(f,3))}function rF(l,f){return l&&ka(l,Mt(f,3))}function nF(l){return l==null?[]:wc(l,as(l))}function sF(l){return l==null?[]:wc(l,To(l))}function J0(l,f,y){var k=l==null?t:qi(l,f);return k===t?y:k}function oF(l,f){return l!=null&&xp(l,f,wo)}function X0(l,f){return l!=null&&xp(l,f,vl)}var iF=Kg(function(l,f,y){f!=null&&typeof f.toString!="function"&&(f=vu.call(f)),l[f]=y},Z0(Ao)),aF=Kg(function(l,f,y){f!=null&&typeof f.toString!="function"&&(f=vu.call(f)),yr.call(l,f)?l[f].push(y):l[f]=[y]},Mt),lF=nr(bo);function as(l){return No(l)?gi(l):Ji(l)}function To(l){return No(l)?gi(l,!0):Jh(l)}function cF(l,f){var y={};return f=Mt(f,3),eo(l,function(k,R,M){yi(y,f(k,R,M),k)}),y}function uF(l,f){var y={};return f=Mt(f,3),eo(l,function(k,R,M){yi(y,R,f(k,R,M))}),y}var dF=Nc(function(l,f,y){yl(l,f,y)}),YS=Nc(function(l,f,y,k){yl(l,f,y,k)}),fF=ki(function(l,f){var y={};if(l==null)return y;var k=!1;f=zr(f,function(M){return M=Si(M,l),k||(k=M.length>1),M}),zo(l,$u(l),y),k&&(y=Ps(y,x|b|S,mp));for(var R=f.length;R--;)rf(y,f[R]);return y});function hF(l,f){return JS(l,He(Mt(f)))}var pF=ki(function(l,f){return l==null?{}:Zh(l,f)});function JS(l,f){if(l==null)return{};var y=zr($u(l),function(k){return[k]});return f=Mt(f),Ta(l,y,function(k,R){return f(k,R[0])})}function mF(l,f,y){f=Si(f,l);var k=-1,R=f.length;for(R||(R=1,l=t);++k<R;){var M=l==null?t:l[Wo(f[k])];M===t&&(k=R,M=y),l=Al(M)?M.call(l):M}return l}function gF(l,f,y){return l==null?l:wl(l,f,y)}function vF(l,f,y,k){return k=typeof k=="function"?k:t,l==null?l:wl(l,f,y,k)}var XS=fp(as),QS=fp(To);function yF(l,f,y){var k=rr(l),R=k||Oc(l)||Of(l);if(f=Mt(f,4),y==null){var M=l&&l.constructor;R?y=k?new M:[]:fn(l)?y=Al(M)?gc($o(l)):{}:y={}}return(R?Zn:eo)(l,function(V,ee,ce){return f(y,V,ee,ce)}),y}function xF(l,f){return l==null?!0:rf(l,f)}function wF(l,f,y){return l==null?l:sp(l,f,sf(y))}function bF(l,f,y,k){return k=typeof k=="function"?k:t,l==null?l:sp(l,f,sf(y),k)}function Df(l){return l==null?[]:pu(l,as(l))}function _F(l){return l==null?[]:pu(l,To(l))}function SF(l,f,y){return y===t&&(y=f,f=t),y!==t&&(y=Ni(y),y=y===y?y:0),f!==t&&(f=Ni(f),f=f===f?f:0),Vi(Ni(l),f,y)}function EF(l,f,y){return f=Il(f),y===t?(y=f,f=0):y=Il(y),l=Ni(l),Kh(l,f,y)}function kF(l,f,y){if(y&&typeof y!="boolean"&&vs(l,f,y)&&(f=y=t),y===t&&(typeof f=="boolean"?(y=f,f=t):typeof l=="boolean"&&(y=l,l=t)),l===t&&f===t?(l=0,f=1):(l=Il(l),f===t?(f=l,l=0):f=Il(f)),l>f){var k=l;l=f,f=k}if(y||l%1||f%1){var R=bu();return es(l+R*(f-l+il("1e-"+((R+"").length-1))),f)}return Sc(l,f)}var CF=bl(function(l,f,y){return f=f.toLowerCase(),l+(y?ZS(f):f)});function ZS(l){return Q0(Lr(l).toLowerCase())}function eE(l){return l=Lr(l),l&&l.replace(De,wg).replace(At,"")}function NF(l,f,y){l=Lr(l),f=js(f);var k=l.length;y=y===t?k:Vi(sr(y),0,k);var R=y;return y-=f.length,y>=0&&l.slice(y,R)==f}function TF(l){return l=Lr(l),l&&Oo.test(l)?l.replace(_n,bg):l}function AF(l){return l=Lr(l),l&&Ws.test(l)?l.replace(Gs,"\\$&"):l}var IF=bl(function(l,f,y){return l+(y?"-":"")+f.toLowerCase()}),RF=bl(function(l,f,y){return l+(y?" ":"")+f.toLowerCase()}),PF=cp("toLowerCase");function jF(l,f,y){l=Lr(l),f=sr(f);var k=f?ll(l):0;if(!f||k>=f)return l;var R=(f-k)/2;return Lu(xa(R),y)+l+Lu(ul(R),y)}function FF(l,f,y){l=Lr(l),f=sr(f);var k=f?ll(l):0;return f&&k<f?l+Lu(f-k,y):l}function OF(l,f,y){l=Lr(l),f=sr(f);var k=f?ll(l):0;return f&&k<f?Lu(f-k,y)+l:l}function DF(l,f,y){return y||f==null?f=0:f&&(f=+f),Ig(Lr(l).replace(Li,""),f||0)}function LF(l,f,y){return(y?vs(l,f,y):f===t)?f=1:f=sr(f),xl(Lr(l),f)}function MF(){var l=arguments,f=Lr(l[0]);return l.length<3?f:f.replace(l[1],l[2])}var $F=bl(function(l,f,y){return l+(y?"_":"")+f.toLowerCase()});function UF(l,f,y){return y&&typeof y!="number"&&vs(l,f,y)&&(f=y=t),y=y===t?F:y>>>0,y?(l=Lr(l),l&&(typeof f=="string"||f!=null&&!Y0(f))&&(f=js(f),!f&&ac(l))?Qi(Xs(l),0,y):l.split(f,y)):[]}var zF=bl(function(l,f,y){return l+(y?" ":"")+Q0(f)});function HF(l,f,y){return l=Lr(l),y=y==null?0:Vi(sr(y),0,l.length),f=js(f),l.slice(y,y+f.length)==f}function BF(l,f,y){var k=L.templateSettings;y&&vs(l,f,y)&&(f=t),l=Lr(l),f=bv({},f,k,hp);var R=bv({},f.imports,k.imports,hp),M=as(R),V=pu(R,M),ee,ce,Ie=0,Re=f.interpolate||Qe,Le="__p += '",Xe=mu((f.escape||Qe).source+"|"+Re.source+"|"+(Re===gn?ot:Qe).source+"|"+(f.evaluate||Qe).source+"|$","g"),bt="//# sourceURL="+(yr.call(f,"sourceURL")?(f.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Ys+"]")+`
`;l.replace(Xe,function(Gt,fr,wr,Yo,no,Jo){return wr||(wr=Yo),Le+=l.slice(Ie,Jo).replace(Tr,_g),fr&&(ee=!0,Le+=`' +
__e(`+fr+`) +
'`),no&&(ce=!0,Le+=`';
`+no+`;
__p += '`),wr&&(Le+=`' +
((__t = (`+wr+`)) == null ? '' : __t) +
'`),Ie=Jo+Gt.length,Gt}),Le+=`';
`;var Bt=yr.call(f,"variable")&&f.variable;if(!Bt)Le=`with (obj) {
`+Le+`
}
`;else if(Tt.test(Bt))throw new qt(d);Le=(ce?Le.replace(Ut,""):Le).replace(lr,"$1").replace(Wt,"$1;"),Le="function("+(Bt||"obj")+`) {
`+(Bt?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(ee?", __e = _.escape":"")+(ce?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+Le+`return __p
}`;var ar=rE(function(){return Er(M,bt+"return "+Le).apply(t,V)});if(ar.source=Le,K0(ar))throw ar;return ar}function GF(l){return Lr(l).toLowerCase()}function WF(l){return Lr(l).toUpperCase()}function VF(l,f,y){if(l=Lr(l),l&&(y||f===t))return vg(l);if(!l||!(f=js(f)))return l;var k=Xs(l),R=Xs(f),M=yg(k,R),V=Lh(k,R)+1;return Qi(k,M,V).join("")}function qF(l,f,y){if(l=Lr(l),l&&(y||f===t))return l.slice(0,Id(l)+1);if(!l||!(f=js(f)))return l;var k=Xs(l),R=Lh(k,Xs(f))+1;return Qi(k,0,R).join("")}function KF(l,f,y){if(l=Lr(l),l&&(y||f===t))return l.replace(Li,"");if(!l||!(f=js(f)))return l;var k=Xs(l),R=yg(k,Xs(f));return Qi(k,R).join("")}function YF(l,f){var y=se,k=he;if(fn(f)){var R="separator"in f?f.separator:R;y="length"in f?sr(f.length):y,k="omission"in f?js(f.omission):k}l=Lr(l);var M=l.length;if(ac(l)){var V=Xs(l);M=V.length}if(y>=M)return l;var ee=y-ll(k);if(ee<1)return k;var ce=V?Qi(V,0,ee).join(""):l.slice(0,ee);if(R===t)return ce+k;if(V&&(ee+=ce.length-ee),Y0(R)){if(l.slice(ee).search(R)){var Ie,Re=ce;for(R.global||(R=mu(R.source,Lr(Vt.exec(R))+"g")),R.lastIndex=0;Ie=R.exec(Re);)var Le=Ie.index;ce=ce.slice(0,Le===t?ee:Le)}}else if(l.indexOf(js(R),ee)!=ee){var Xe=ce.lastIndexOf(R);Xe>-1&&(ce=ce.slice(0,Xe))}return ce+k}function JF(l){return l=Lr(l),l&&Un.test(l)?l.replace(Zt,Sg):l}var XF=bl(function(l,f,y){return l+(y?" ":"")+f.toUpperCase()}),Q0=cp("toUpperCase");function tE(l,f,y){return l=Lr(l),f=y?t:f,f===t?x0(l)?S0(l):g0(l):l.match(f)||[]}var rE=nr(function(l,f){try{return hs(l,t,f)}catch(y){return K0(y)?y:new qt(y)}}),QF=ki(function(l,f){return Zn(f,function(y){y=Wo(y),yi(l,y,Ue(l[y],l))}),l});function ZF(l){var f=l==null?0:l.length,y=Mt();return l=f?zr(l,function(k){if(typeof k[1]!="function")throw new go(c);return[y(k[0]),k[1]]}):[],nr(function(k){for(var R=-1;++R<f;){var M=l[R];if(hs(M[0],this,k))return hs(M[1],this,k)}})}function eO(l){return Lg(Ps(l,x))}function Z0(l){return function(){return l}}function tO(l,f){return l==null||l!==l?f:l}var rO=uf(),nO=uf(!0);function Ao(l){return l}function ex(l){return _c(typeof l=="function"?l:Ps(l,x))}function sO(l){return Qd(Ps(l,x))}function oO(l,f){return Qr(l,Ps(f,x))}var iO=nr(function(l,f){return function(y){return bo(y,l,f)}}),aO=nr(function(l,f){return function(y){return bo(l,y,f)}});function tx(l,f,y){var k=as(f),R=wc(f,k);y==null&&!(fn(f)&&(R.length||!k.length))&&(y=f,f=l,l=this,R=wc(f,as(f)));var M=!(fn(y)&&"chain"in y)||!!y.chain,V=Al(l);return Zn(R,function(ee){var ce=f[ee];l[ee]=ce,V&&(l.prototype[ee]=function(){var Ie=this.__chain__;if(M||Ie){var Re=l(this.__wrapped__),Le=Re.__actions__=ms(this.__actions__);return Le.push({func:ce,args:arguments,thisArg:l}),Re.__chain__=Ie,Re}return ce.apply(l,va([this.value()],arguments))})}),l}function lO(){return Xr._===this&&(Xr._=Cg),this}function rx(){}function cO(l){return l=sr(l),nr(function(f){return Zd(f,l)})}var uO=df(zr),dO=df(Ah),fO=df(Ph);function nE(l){return ct(l)?Fh(Wo(l)):tn(l)}function hO(l){return function(f){return l==null?t:qi(l,f)}}var pO=dp(),mO=dp(!0);function nx(){return[]}function sx(){return!1}function gO(){return{}}function vO(){return""}function yO(){return!0}function xO(l,f){if(l=sr(l),l<1||l>Y)return[];var y=F,k=es(l,F);f=Mt(f),l-=F;for(var R=Dh(k,f);++y<l;)f(y);return R}function wO(l){return rr(l)?zr(l,Wo):Ko(l)?[l]:ms(Sp(Lr(l)))}function bO(l){var f=++uc;return Lr(l)+f}var _O=Du(function(l,f){return l+f},0),SO=Bn("ceil"),EO=Du(function(l,f){return l/f},1),kO=Bn("floor");function CO(l){return l&&l.length?gl(l,Ao,Ca):t}function NO(l,f){return l&&l.length?gl(l,Mt(f,2),Ca):t}function TO(l){return mg(l,Ao)}function AO(l,f){return mg(l,Mt(f,2))}function IO(l){return l&&l.length?gl(l,Ao,Na):t}function RO(l,f){return l&&l.length?gl(l,Mt(f,2),Na):t}var PO=Du(function(l,f){return l*f},1),jO=Bn("round"),FO=Du(function(l,f){return l-f},0);function OO(l){return l&&l.length?Oh(l,Ao):0}function DO(l,f){return l&&l.length?Oh(l,Mt(f,2)):0}return L.after=Z,L.ary=xe,L.assign=Wj,L.assignIn=KS,L.assignInWith=bv,L.assignWith=Vj,L.at=qj,L.before=Oe,L.bind=Ue,L.bindAll=QF,L.bindKey=Fe,L.castArray=gj,L.chain=Nf,L.chunk=xf,L.compact=Ep,L.concat=ko,L.cond=ZF,L.conforms=eO,L.constant=Z0,L.countBy=pv,L.create=Kj,L.curry=nt,L.curryRight=gt,L.debounce=vt,L.defaults=Yj,L.defaultsDeep=Jj,L.defer=dn,L.delay=fe,L.difference=xr,L.differenceBy=Fn,L.differenceWith=xn,L.drop=Vn,L.dropRight=ro,L.dropRightWhile=jc,L.dropWhile=Cn,L.fill=Wu,L.filter=If,L.flatMap=Dp,L.flatMapDeep=B0,L.flatMapDepth=vv,L.flatten=wf,L.flattenDeep=qu,L.flattenDepth=Fs,L.flip=ne,L.flow=rO,L.flowRight=nO,L.fromPairs=kp,L.functions=nF,L.functionsIn=sF,L.groupBy=Lp,L.initial=bf,L.intersection=Cp,L.intersectionBy=Pa,L.intersectionWith=_f,L.invert=iF,L.invertBy=aF,L.invokeMap=yv,L.iteratee=ex,L.keyBy=G0,L.keys=as,L.keysIn=To,L.map=Tl,L.mapKeys=cF,L.mapValues=uF,L.matches=sO,L.matchesProperty=oO,L.memoize=pe,L.merge=dF,L.mergeWith=YS,L.method=iO,L.methodOf=aO,L.mixin=tx,L.negate=He,L.nthArg=cO,L.omit=fF,L.omitBy=hF,L.once=yt,L.orderBy=W0,L.over=uO,L.overArgs=Ot,L.overEvery=dO,L.overSome=fO,L.partial=Nt,L.partialRight=Ht,L.partition=Xu,L.pick=pF,L.pickBy=JS,L.property=nE,L.propertyOf=hO,L.pull=Sf,L.pullAll=Yu,L.pullAllBy=xs,L.pullAllWith=Fa,L.pullAt=Vo,L.range=pO,L.rangeRight=mO,L.rearg=On,L.reject=o,L.remove=Os,L.rest=kr,L.reverse=Ef,L.sampleSize=h,L.set=gF,L.setWith=vF,L.shuffle=g,L.slice=Tp,L.sortBy=P,L.sortedUniq=Rp,L.sortedUniqBy=kl,L.split=UF,L.spread=Da,L.tail=av,L.take=lv,L.takeRight=Pp,L.takeRightWhile=kf,L.takeWhile=j0,L.tap=U0,L.throttle=q0,L.thru=qo,L.toArray=WS,L.toPairs=XS,L.toPairsIn=QS,L.toPath=wO,L.toPlainObject=qS,L.transform=yF,L.unary=pj,L.union=F0,L.unionBy=cv,L.unionWith=uv,L.uniq=Cl,L.uniqBy=O0,L.uniqWith=Fc,L.unset=xF,L.unzip=Cf,L.unzipWith=rn,L.update=wF,L.updateWith=bF,L.values=Df,L.valuesIn=_F,L.without=D0,L.words=tE,L.wrap=mj,L.xor=dv,L.xorBy=L0,L.xorWith=M0,L.zip=fv,L.zipObject=hv,L.zipObjectDeep=$0,L.zipWith=Co,L.entries=XS,L.entriesIn=QS,L.extend=KS,L.extendWith=bv,tx(L,L),L.add=_O,L.attempt=rE,L.camelCase=CF,L.capitalize=ZS,L.ceil=SO,L.clamp=SF,L.clone=vj,L.cloneDeep=xj,L.cloneDeepWith=wj,L.cloneWith=yj,L.conformsTo=bj,L.deburr=eE,L.defaultTo=tO,L.divide=EO,L.endsWith=NF,L.eq=ra,L.escape=TF,L.escapeRegExp=AF,L.every=mv,L.find=Rf,L.findIndex=Ra,L.findKey=Xj,L.findLast=gv,L.findLastIndex=Vu,L.findLastKey=Qj,L.floor=kO,L.forEach=Pf,L.forEachRight=Ju,L.forIn=Zj,L.forInRight=eF,L.forOwn=tF,L.forOwnRight=rF,L.get=J0,L.gt=_j,L.gte=Sj,L.has=oF,L.hasIn=X0,L.head=Sl,L.identity=Ao,L.includes=jf,L.indexOf=ta,L.inRange=EF,L.invoke=lF,L.isArguments=Qu,L.isArray=rr,L.isArrayBuffer=Ej,L.isArrayLike=No,L.isArrayLikeObject=Nn,L.isBoolean=kj,L.isBuffer=Oc,L.isDate=Cj,L.isElement=Nj,L.isEmpty=Tj,L.isEqual=Aj,L.isEqualWith=Ij,L.isError=K0,L.isFinite=Rj,L.isFunction=Al,L.isInteger=zS,L.isLength=xv,L.isMap=HS,L.isMatch=Pj,L.isMatchWith=jj,L.isNaN=Fj,L.isNative=Oj,L.isNil=Lj,L.isNull=Dj,L.isNumber=BS,L.isObject=fn,L.isObjectLike=wn,L.isPlainObject=Mp,L.isRegExp=Y0,L.isSafeInteger=Mj,L.isSet=GS,L.isString=wv,L.isSymbol=Ko,L.isTypedArray=Of,L.isUndefined=$j,L.isWeakMap=Uj,L.isWeakSet=zj,L.join=ja,L.kebabCase=IF,L.last=ys,L.lastIndexOf=Ku,L.lowerCase=RF,L.lowerFirst=PF,L.lt=Hj,L.lte=Bj,L.max=CO,L.maxBy=NO,L.mean=TO,L.meanBy=AO,L.min=IO,L.minBy=RO,L.stubArray=nx,L.stubFalse=sx,L.stubObject=gO,L.stubString=vO,L.stubTrue=yO,L.multiply=PO,L.nth=Np,L.noConflict=lO,L.noop=rx,L.now=W,L.pad=jF,L.padEnd=FF,L.padStart=OF,L.parseInt=DF,L.random=kF,L.reduce=V0,L.reduceRight=Ff,L.repeat=LF,L.replace=MF,L.result=mF,L.round=jO,L.runInContext=oe,L.sample=a,L.size=_,L.snakeCase=$F,L.some=C,L.sortedIndex=Ap,L.sortedIndexBy=P0,L.sortedIndexOf=Oa,L.sortedLastIndex=iv,L.sortedLastIndexBy=Ip,L.sortedLastIndexOf=El,L.startCase=zF,L.startsWith=HF,L.subtract=FO,L.sum=OO,L.sumBy=DO,L.template=BF,L.times=xO,L.toFinite=Il,L.toInteger=sr,L.toLength=VS,L.toLower=GF,L.toNumber=Ni,L.toSafeInteger=Gj,L.toString=Lr,L.toUpper=WF,L.trim=VF,L.trimEnd=qF,L.trimStart=KF,L.truncate=YF,L.unescape=JF,L.uniqueId=bO,L.upperCase=XF,L.upperFirst=Q0,L.each=Pf,L.eachRight=Ju,L.first=Sl,tx(L,(function(){var l={};return eo(L,function(f,y){yr.call(L.prototype,y)||(l[y]=f)}),l})(),{chain:!1}),L.VERSION=n,Zn(["bind","bindKey","curry","curryRight","partial","partialRight"],function(l){L[l].placeholder=L}),Zn(["drop","take"],function(l,f){tr.prototype[l]=function(y){y=y===t?1:yn(sr(y),0);var k=this.__filtered__&&!f?new tr(this):this.clone();return k.__filtered__?k.__takeCount__=es(y,k.__takeCount__):k.__views__.push({size:es(y,F),type:l+(k.__dir__<0?"Right":"")}),k},tr.prototype[l+"Right"]=function(y){return this.reverse()[l](y).reverse()}}),Zn(["filter","map","takeWhile"],function(l,f){var y=f+1,k=y==ie||y==de;tr.prototype[l]=function(R){var M=this.clone();return M.__iteratees__.push({iteratee:Mt(R,3),type:y}),M.__filtered__=M.__filtered__||k,M}}),Zn(["head","last"],function(l,f){var y="take"+(f?"Right":"");tr.prototype[l]=function(){return this[y](1).value()[0]}}),Zn(["initial","tail"],function(l,f){var y="drop"+(f?"":"Right");tr.prototype[l]=function(){return this.__filtered__?new tr(this):this[y](1)}}),tr.prototype.compact=function(){return this.filter(Ao)},tr.prototype.find=function(l){return this.filter(l).head()},tr.prototype.findLast=function(l){return this.reverse().find(l)},tr.prototype.invokeMap=nr(function(l,f){return typeof l=="function"?new tr(this):this.map(function(y){return bo(y,l,f)})}),tr.prototype.reject=function(l){return this.filter(He(Mt(l)))},tr.prototype.slice=function(l,f){l=sr(l);var y=this;return y.__filtered__&&(l>0||f<0)?new tr(y):(l<0?y=y.takeRight(-l):l&&(y=y.drop(l)),f!==t&&(f=sr(f),y=f<0?y.dropRight(-f):y.take(f-l)),y)},tr.prototype.takeRightWhile=function(l){return this.reverse().takeWhile(l).reverse()},tr.prototype.toArray=function(){return this.take(F)},eo(tr.prototype,function(l,f){var y=/^(?:filter|find|map|reject)|While$/.test(f),k=/^(?:head|last)$/.test(f),R=L[k?"take"+(f=="last"?"Right":""):f],M=k||/^find/.test(f);R&&(L.prototype[f]=function(){var V=this.__wrapped__,ee=k?[1]:arguments,ce=V instanceof tr,Ie=ee[0],Re=ce||rr(V),Le=function(fr){var wr=R.apply(L,va([fr],ee));return k&&Xe?wr[0]:wr};Re&&y&&typeof Ie=="function"&&Ie.length!=1&&(ce=Re=!1);var Xe=this.__chain__,bt=!!this.__actions__.length,Bt=M&&!Xe,ar=ce&&!bt;if(!M&&Re){V=ar?V:new tr(this);var Gt=l.apply(V,ee);return Gt.__actions__.push({func:qo,args:[Le],thisArg:t}),new ts(Gt,Xe)}return Bt&&ar?l.apply(this,ee):(Gt=this.thru(Le),Bt?k?Gt.value()[0]:Gt.value():Gt)})}),Zn(["pop","push","shift","sort","splice","unshift"],function(l){var f=Hi[l],y=/^(?:push|sort|unshift)$/.test(l)?"tap":"thru",k=/^(?:pop|shift)$/.test(l);L.prototype[l]=function(){var R=arguments;if(k&&!this.__chain__){var M=this.value();return f.apply(rr(M)?M:[],R)}return this[y](function(V){return f.apply(rr(V)?V:[],R)})}}),eo(tr.prototype,function(l,f){var y=L[f];if(y){var k=y.name+"";yr.call(pc,k)||(pc[k]=[]),pc[k].push({name:f,func:y})}}),pc[Ac(t,A).name]=[{name:"wrapper",func:t}],tr.prototype.clone=zd,tr.prototype.reverse=Gh,tr.prototype.value=vc,L.prototype.at=Tf,L.prototype.chain=Nl,L.prototype.commit=Af,L.prototype.next=jp,L.prototype.plant=z0,L.prototype.reverse=Op,L.prototype.toJSON=L.prototype.valueOf=L.prototype.value=H0,L.prototype.first=L.prototype.head,Gi&&(L.prototype[Gi]=Fp),L}),lc=E0();fi?((fi.exports=lc)._=lc,hu._=lc):Xr._=lc}).call(vq)})(_m,_m.exports)),_m.exports}var ny=yq();const hw="src/shared/components/sidepanel/panels/components/UnifiedSearch.tsx",HP=({onMatterSelected:r,integrationType:e="clio"})=>{const t=Jr(),n=w.useRef(null),[s,i]=w.useState(""),[c,d]=w.useState([]),[m,p]=w.useState(!1),[v,x]=w.useState(!1),[b,S]=w.useState(null);w.useEffect(()=>{const T=A=>{n.current&&!n.current.contains(A.target)&&x(!1)};return document.addEventListener("mousedown",T),()=>{document.removeEventListener("mousedown",T)}},[]);const N=w.useMemo(()=>ny.debounce(async T=>{if(!T.trim()||T.length<2){d([]),S(null);return}p(!0),S(null);try{const A=await V_(e,T,t);d(A.projects||[]),A.projects.length===0&&S(`No matters found for "${T}"`)}catch(A){t.error("Matter search failed",A,{sourceFile:hw}),S("Failed to search matters. Please try again."),d([])}finally{p(!1)}},400),[t,e]),E=T=>{var A,I;try{t.info("Matter selected via unified search",{matterId:(I=(A=T.projectId)==null?void 0:A.native)==null?void 0:I.toString(),matterName:T.projectName,sourceFile:hw}),r(T),x(!1),i(""),d([]),S(null)}catch(D){t.error("Failed to select matter",D,{sourceFile:hw})}};return u.jsxs("div",{ref:n,className:"w-full mb-3 p-1",children:[u.jsxs("div",{className:"relative",children:[u.jsx(Ii,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400 pointer-events-none z-10"}),u.jsx(pn,{placeholder:e==="filevine"?"Search projects in Filevine...":"Search matters in Clio...",value:s,onChange:T=>{const A=T.target.value;i(A),x(!0),N(A)},onFocus:()=>x(!0),className:"pl-10 pr-10 h-10 text-sm border border-border/50 rounded-lg shadow-sm bg-card"}),s&&u.jsx("button",{onClick:T=>{T.stopPropagation(),i(""),d([]),S(null),x(!1)},className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 z-10",children:u.jsx(aa,{className:"w-4 h-4"})})]}),v&&(s.length>=2||m||c.length>0)&&u.jsx("div",{className:"relative",children:u.jsx("div",{className:"absolute top-2 left-0 right-0 z-50 w-full max-w-full border border-border/50 rounded-lg shadow-lg bg-card",children:u.jsx("div",{className:"max-h-[300px] overflow-y-auto",children:m?u.jsxs("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 flex items-center gap-2",children:[u.jsx("div",{className:"w-4 h-4 border-2 border-gray-300 border-t-gray-600 rounded-full animate-spin"}),"Searching..."]}):b&&c.length===0?u.jsx("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:b}):c.length>0?c.map(T=>u.jsxs("div",{className:"flex flex-col items-start p-3 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-800 border-b border-gray-100 dark:border-gray-700 last:border-b-0",onClick:()=>E(T),children:[u.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-gray-100",children:T.projectName}),u.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5",children:[T.phaseName,"  Client: ",T.clientName]})]},T.projectId.native)):s.trim()&&!m?u.jsxs("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:['No matters found for "',s,'"']}):u.jsx("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:e==="filevine"?"Type at least 2 characters to search projects...":"Type at least 2 characters to search matters..."})})})})]})},cs=({rows:r=2})=>u.jsx("div",{className:"p-1",children:u.jsx("table",{className:"w-full text-sm text-left text-gray-600 dark:text-gray-300",children:u.jsx("tbody",{children:Array.from({length:r}).map((e,t)=>u.jsxs("tr",{className:"bg-card animate-pulse",children:[u.jsx("td",{className:"py-2 px-3 whitespace-normal font-medium w-1/3",children:u.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-3/4"})}),u.jsx("td",{className:"py-2 px-3",children:u.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-full"})})]},t))})})}),xq="src/sidepanel/panels/components/FilevineClientInfoBox.tsx",wq=({clientEmail:r,emailParticipants:e,emailParticipantClients:t,tempClientEmail:n,setTempClientEmail:s,setIsManuallySet:i,isManuallySet:c,selectedClientDetails:d,isLoading:m,ClientNavigation:p,setClientEmail:v,isValidClient:x,isTempEmailValid:b,isValidating:S,isProjectManuallySelected:N=!1})=>{const E=Jr(),{isConnected:T,initiateReconnection:A}=Di(),{platform:I}=mn(),D=()=>u.jsx(cs,{rows:2}),j=()=>u.jsxs("div",{className:"p-4 text-center",children:[u.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-3",children:u.jsx(eu,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"})}),u.jsx("p",{className:"text-sm font-medium text-gray-800 mb-2",children:"Gmail disconnected"}),u.jsx("p",{className:"text-xs text-gray-600 mb-4",children:"Connect Gmail to view email insights"}),u.jsxs(Ye,{onClick:async()=>{try{await A()}catch(O){E.error("Failed to reconnect Gmail:",O,{sourceFile:xq})}},size:"sm",className:"bg-blue-600 hover:bg-blue-700 text-white text-xs px-4 py-2",children:[u.jsx(si,{className:"h-3 w-3 mr-1"}),"Reconnect Gmail"]})]});return u.jsxs("div",{className:"w-full min-h-[4rem] border border-border/50 rounded-lg shadow-sm bg-card text-card-foreground",title:"Client Information",children:[u.jsx("div",{className:"flex items-center justify-between p-2 border-b bg-muted",children:u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(Ey,{className:"w-3.5 h-3.5 text-slate-600 dark:text-gray-300"}),u.jsx("span",{className:"font-medium text-sm text-slate-800 dark:text-white",children:"CONTACT"})]})}),m?D():N?d&&Object.keys(d).length>0?u.jsx(Zl,{details:d}):u.jsxs("div",{className:"p-4 text-center",children:[u.jsx(Ii,{className:"w-8 h-8 mx-auto mb-2 text-gray-400"}),u.jsx("div",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Project Manually Selected"}),u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"No contact information available for this project"})]}):u.jsxs(u.Fragment,{children:[t.length>0&&!c&&u.jsx(p,{}),c&&r&&u.jsx("div",{className:"px-3 py-2 bg-gray-50 dark:bg-gray-800 border-b dark:border-gray-700",children:u.jsxs("div",{className:"flex flex-col",children:[u.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate",children:r}),u.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5",children:"(Manually set)"})]})}),S&&e.length>0&&t.length===0&&!c?u.jsx(cs,{rows:2}):d&&Object.keys(d).length>0?u.jsx(Zl,{details:d}):I==="chrome"&&!T?j():u.jsx("div",{className:"p-3 text-sm text-gray-600 dark:text-gray-400",children:u.jsx("p",{className:"mb-2",children:c&&r?`No contact information found for ${r}`:e.length>0&&t.length===0?`No contact information available for emails on the selected thread:
                        ${e.join(", ")}`:e.length>0?"No contact information available for the selected email ID":"Select a contact email thread to view contact information"})})]})]})};var d0="Collapsible",[bq,BP]=Za(d0),[_q,jS]=bq(d0),GP=w.forwardRef((r,e)=>{const{__scopeCollapsible:t,open:n,defaultOpen:s,disabled:i,onOpenChange:c,...d}=r,[m,p]=su({prop:n,defaultProp:s??!1,onChange:c,caller:d0});return u.jsx(_q,{scope:t,disabled:i,contentId:ql(),open:m,onOpenToggle:w.useCallback(()=>p(v=>!v),[p]),children:u.jsx(Ur.div,{"data-state":OS(m),"data-disabled":i?"":void 0,...d,ref:e})})});GP.displayName=d0;var WP="CollapsibleTrigger",VP=w.forwardRef((r,e)=>{const{__scopeCollapsible:t,...n}=r,s=jS(WP,t);return u.jsx(Ur.button,{type:"button","aria-controls":s.contentId,"aria-expanded":s.open||!1,"data-state":OS(s.open),"data-disabled":s.disabled?"":void 0,disabled:s.disabled,...n,ref:e,onClick:$t(r.onClick,s.onOpenToggle)})});VP.displayName=WP;var FS="CollapsibleContent",qP=w.forwardRef((r,e)=>{const{forceMount:t,...n}=r,s=jS(FS,r.__scopeCollapsible);return u.jsx(da,{present:t||s.open,children:({present:i})=>u.jsx(Sq,{...n,ref:e,present:i})})});qP.displayName=FS;var Sq=w.forwardRef((r,e)=>{const{__scopeCollapsible:t,present:n,children:s,...i}=r,c=jS(FS,t),[d,m]=w.useState(n),p=w.useRef(null),v=$n(e,p),x=w.useRef(0),b=x.current,S=w.useRef(0),N=S.current,E=c.open||d,T=w.useRef(E),A=w.useRef(void 0);return w.useEffect(()=>{const I=requestAnimationFrame(()=>T.current=!1);return()=>cancelAnimationFrame(I)},[]),Yl(()=>{const I=p.current;if(I){A.current=A.current||{transitionDuration:I.style.transitionDuration,animationName:I.style.animationName},I.style.transitionDuration="0s",I.style.animationName="none";const D=I.getBoundingClientRect();x.current=D.height,S.current=D.width,T.current||(I.style.transitionDuration=A.current.transitionDuration,I.style.animationName=A.current.animationName),m(n)}},[c.open,n]),u.jsx(Ur.div,{"data-state":OS(c.open),"data-disabled":c.disabled?"":void 0,id:c.contentId,hidden:!E,...i,ref:v,style:{"--radix-collapsible-content-height":b?`${b}px`:void 0,"--radix-collapsible-content-width":N?`${N}px`:void 0,...r.style},children:E&&s})});function OS(r){return r?"open":"closed"}var Eq=GP,kq=VP,Cq=qP,ha="Accordion",Nq=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[DS,Tq,Aq]=ES(ha),[f0]=Za(ha,[Aq,BP]),LS=BP(),KP=br.forwardRef((r,e)=>{const{type:t,...n}=r,s=n,i=n;return u.jsx(DS.Provider,{scope:r.__scopeAccordion,children:t==="multiple"?u.jsx(jq,{...i,ref:e}):u.jsx(Pq,{...s,ref:e})})});KP.displayName=ha;var[YP,Iq]=f0(ha),[JP,Rq]=f0(ha,{collapsible:!1}),Pq=br.forwardRef((r,e)=>{const{value:t,defaultValue:n,onValueChange:s=()=>{},collapsible:i=!1,...c}=r,[d,m]=su({prop:t,defaultProp:n??"",onChange:s,caller:ha});return u.jsx(YP,{scope:r.__scopeAccordion,value:br.useMemo(()=>d?[d]:[],[d]),onItemOpen:m,onItemClose:br.useCallback(()=>i&&m(""),[i,m]),children:u.jsx(JP,{scope:r.__scopeAccordion,collapsible:i,children:u.jsx(XP,{...c,ref:e})})})}),jq=br.forwardRef((r,e)=>{const{value:t,defaultValue:n,onValueChange:s=()=>{},...i}=r,[c,d]=su({prop:t,defaultProp:n??[],onChange:s,caller:ha}),m=br.useCallback(v=>d((x=[])=>[...x,v]),[d]),p=br.useCallback(v=>d((x=[])=>x.filter(b=>b!==v)),[d]);return u.jsx(YP,{scope:r.__scopeAccordion,value:c,onItemOpen:m,onItemClose:p,children:u.jsx(JP,{scope:r.__scopeAccordion,collapsible:!0,children:u.jsx(XP,{...i,ref:e})})})}),[Fq,h0]=f0(ha),XP=br.forwardRef((r,e)=>{const{__scopeAccordion:t,disabled:n,dir:s,orientation:i="vertical",...c}=r,d=br.useRef(null),m=$n(d,e),p=Tq(t),x=o0(s)==="ltr",b=$t(r.onKeyDown,S=>{var K;if(!Nq.includes(S.key))return;const N=S.target,E=p().filter(re=>{var se;return!((se=re.ref.current)!=null&&se.disabled)}),T=E.findIndex(re=>re.ref.current===N),A=E.length;if(T===-1)return;S.preventDefault();let I=T;const D=0,j=A-1,O=()=>{I=T+1,I>j&&(I=D)},B=()=>{I=T-1,I<D&&(I=j)};switch(S.key){case"Home":I=D;break;case"End":I=j;break;case"ArrowRight":i==="horizontal"&&(x?O():B());break;case"ArrowDown":i==="vertical"&&O();break;case"ArrowLeft":i==="horizontal"&&(x?B():O());break;case"ArrowUp":i==="vertical"&&B();break}const G=I%A;(K=E[G].ref.current)==null||K.focus()});return u.jsx(Fq,{scope:t,disabled:n,direction:s,orientation:i,children:u.jsx(DS.Slot,{scope:t,children:u.jsx(Ur.div,{...c,"data-orientation":i,ref:m,onKeyDown:n?void 0:b})})})}),Oy="AccordionItem",[Oq,MS]=f0(Oy),QP=br.forwardRef((r,e)=>{const{__scopeAccordion:t,value:n,...s}=r,i=h0(Oy,t),c=Iq(Oy,t),d=LS(t),m=ql(),p=n&&c.value.includes(n)||!1,v=i.disabled||r.disabled;return u.jsx(Oq,{scope:t,open:p,disabled:v,triggerId:m,children:u.jsx(Eq,{"data-orientation":i.orientation,"data-state":sj(p),...d,...s,ref:e,disabled:v,open:p,onOpenChange:x=>{x?c.onItemOpen(n):c.onItemClose(n)}})})});QP.displayName=Oy;var ZP="AccordionHeader",ej=br.forwardRef((r,e)=>{const{__scopeAccordion:t,...n}=r,s=h0(ha,t),i=MS(ZP,t);return u.jsx(Ur.h3,{"data-orientation":s.orientation,"data-state":sj(i.open),"data-disabled":i.disabled?"":void 0,...n,ref:e})});ej.displayName=ZP;var wb="AccordionTrigger",tj=br.forwardRef((r,e)=>{const{__scopeAccordion:t,...n}=r,s=h0(ha,t),i=MS(wb,t),c=Rq(wb,t),d=LS(t);return u.jsx(DS.ItemSlot,{scope:t,children:u.jsx(kq,{"aria-disabled":i.open&&!c.collapsible||void 0,"data-orientation":s.orientation,id:i.triggerId,...d,...n,ref:e})})});tj.displayName=wb;var rj="AccordionContent",nj=br.forwardRef((r,e)=>{const{__scopeAccordion:t,...n}=r,s=h0(ha,t),i=MS(rj,t),c=LS(t);return u.jsx(Cq,{role:"region","aria-labelledby":i.triggerId,"data-orientation":s.orientation,...c,...n,ref:e,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...r.style}})});nj.displayName=rj;function sj(r){return r?"open":"closed"}var Dq=KP,Lq=QP,Mq=ej,oj=tj,ij=nj;const $q=Dq,aj=w.forwardRef(({className:r,...e},t)=>u.jsx(Lq,{ref:t,className:Fr("border-b border-neutral-200 dark:border-border",r),...e}));aj.displayName="AccordionItem";const lj=w.forwardRef(({className:r,children:e,...t},n)=>u.jsx(Mq,{className:"flex",children:u.jsxs(oj,{ref:n,className:Fr("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",r),...t,children:[e,u.jsx(ls,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})}));lj.displayName=oj.displayName;const cj=w.forwardRef(({className:r,children:e,...t},n)=>u.jsx(ij,{ref:n,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...t,children:u.jsx("div",{className:Fr("pb-4 pt-0",r),children:e})}));cj.displayName=ij.displayName;const Uq="src/shared/components/sidepanel/panels/components/FilevineCaseInfoBox.tsx",zq=({caseSummaryData:r,isCaseSummaryLoading:e,caseSummaryError:t,caseDetails:n,onDocumentView:s})=>{if(e)return u.jsxs("div",{className:"space-y-2",children:[u.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded animate-pulse"}),u.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded animate-pulse"}),u.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded animate-pulse"})]});if(t)return u.jsx("div",{className:"text-sm text-red-600 dark:text-red-400",children:t});if(!r)return null;const i={};return r.caseFacts&&(i["Case Facts"]=r.caseFacts),r.caseType&&(i["Case Type"]=r.caseType),r.supioLink&&(i["Supio Link"]=r.supioLink),n.incidentDate&&(i["Incident Date"]=new Date(n.incidentDate).toLocaleDateString(void 0,{timeZone:"UTC"})),r.statuteoflimitations&&r.statuteoflimitations.dateValue&&(i["Statute of Limitations (SOL)"]=new Date(r.statuteoflimitations.dateValue).toLocaleDateString(void 0,{timeZone:"UTC"})),r.totalMeds>0&&(i["Total Meds"]=`$${r.totalMeds.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`),r.totalLiens>0&&(i["Total Liens"]=`$${r.totalLiens.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`),u.jsxs("div",{className:"space-y-3",children:[u.jsx(Zl,{details:i}),r.disbursementSheet&&u.jsx("div",{className:"px-3 pb-2",children:u.jsx("table",{className:"w-full text-sm text-left text-gray-700 dark:text-gray-300",children:u.jsx("tbody",{children:u.jsxs("tr",{className:"bg-card",children:[u.jsx("td",{className:"py-4 px-3 whitespace-normal font-medium w-1/3 text-gray-800 dark:text-gray-200",children:"Disbursement Sheet"}),u.jsx("td",{className:"py-2 px-3",children:u.jsxs("button",{onClick:()=>{s&&r.disbursementSheet&&s({name:r.disbursementSheet.filename,documentId:r.disbursementSheet.documentId,url:""})},className:"text-blue-600 dark:text-blue-400 hover:underline inline-flex items-center gap-1 cursor-pointer focus:outline-none",children:[u.jsx(Xc,{className:"w-3 h-3"}),r.disbursementSheet.filename]})})]})})})})]})},Hq=({clientEmail:r,selectedCaseDetails:e,casesForCurrentClient:t,currentCaseIndex:n,caseDetails:s,nextCase:i,prevCase:c,isLoading:d,setCurrentCaseIndex:m,isValidating:p=!1,handleSectionClick:v,projectId:x,onDocumentView:b})=>{const S=Jr(),[N,E]=w.useState(""),[T,A]=w.useState(!1),[I,D]=w.useState(null),[j,O]=w.useState(!1),[B,G]=w.useState(null),[K,re]=w.useState(!1),[se,he]=w.useState(!1),[U,ge]=w.useState(!1),ie=w.useMemo(()=>{if(!N.trim())return t;const Te=N.toLowerCase();return t.filter(Ge=>String(Ge.projectName||"").toLowerCase().includes(Te))},[t,N]),ae=Te=>{A(Te),Te||E("")},de=async()=>{if(!(!x||I)){O(!0),G(null);try{const Te=await r8("filevine",x,S);D(Te)}catch(Te){S.error("Error fetching case summary",Te,{sourceFile:Uq}),G("Failed to load case summary data")}finally{O(!1)}}};w.useEffect(()=>{D(null),G(null)},[x]),w.useEffect(()=>{re(!1),he(!1),ge(!1)},[x]);const J=Te=>{if(!Te)return"";try{return new Date(Te).toLocaleDateString(void 0,{timeZone:"UTC"})}catch{return""}},Y=Te=>{if(!Te)return"";try{return new Date(Te).toLocaleTimeString(void 0,{hour:"numeric",minute:"2-digit"})}catch{return""}},$=Te=>{const Ge=["a","b","br","div","em","i","li","ol","p","s","strong","u","ul"],Ee=["href","rel","type","target"],Ke=new DOMParser().parseFromString(Te,"text/html"),qe=Ke.body.getElementsByTagName("*");for(let ft=qe.length-1;ft>=0;ft--){const mt=qe[ft];Ge.includes(mt.tagName.toLowerCase())?Array.from(mt.attributes).forEach(ut=>{Ee.includes(ut.name.toLowerCase())||mt.removeAttribute(ut.name)}):mt.replaceWith(document.createTextNode(mt.textContent||""))}return Ke.body.innerHTML},Q=Te=>{const Ge=typeof Te=="string"?Te:String(Te??"");return(new DOMParser().parseFromString(Ge,"text/html").body.textContent||"").length>200},F=t.length>0&&n<t.length?t[n]:null,H=F==null?void 0:F.last_completed_task,te=F==null?void 0:F.next_upcoming_task,Se=F==null?void 0:F.most_recent_note,ue=H||te,ke=Se&&Se.detail,X=()=>u.jsxs("div",{className:"border-t bg-card",children:[u.jsx("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800",children:u.jsxs("div",{className:"flex items-center gap-2 cursor-pointer flex-1 hover:opacity-80 transition-opacity",onClick:()=>re(!K),children:[u.jsx(ZA,{className:"w-4 h-4 text-slate-600 dark:text-gray-300"}),u.jsx("span",{className:"font-medium text-sm text-slate-800 dark:text-white",children:"Tasks"}),ue&&!d&&(K?u.jsx(sh,{className:"w-4 h-4 text-gray-400"}):u.jsx(ls,{className:"w-4 h-4 text-gray-400"}))]})}),!K&&u.jsx(u.Fragment,{children:d?u.jsx(cs,{rows:2}):ue?u.jsxs("div",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:[H&&u.jsx("div",{className:"p-3 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:u.jsxs("div",{className:"flex items-start gap-2 mb-2",children:[u.jsx(Jc,{className:"w-4 h-4 text-green-600 dark:text-green-400 mt-0.5 flex-shrink-0"}),u.jsxs("div",{className:"flex-1",children:[u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 font-medium mb-1",children:"Last Completed Task"}),u.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-gray-100 mb-1 prose prose-sm max-w-none dark:prose-invert",dangerouslySetInnerHTML:{__html:$(String(H.name||"Untitled Task"))}}),!!H.completed_at&&u.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600 dark:text-gray-400",children:[u.jsx(Bl,{className:"w-3 h-3"}),u.jsxs("span",{children:["Completed: ",J(String(H.completed_at))]})]})]})]})}),te&&u.jsx("div",{className:"p-3 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:u.jsxs("div",{className:"flex items-start gap-2 mb-2",children:[u.jsx(Qf,{className:"w-4 h-4 text-blue-600 dark:text-blue-400 mt-0.5 flex-shrink-0"}),u.jsxs("div",{className:"flex-1",children:[u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 font-medium mb-1",children:"Next Upcoming Task"}),u.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-gray-100 mb-1 prose prose-sm max-w-none dark:prose-invert",dangerouslySetInnerHTML:{__html:$(String(te.name||"Untitled Task"))}}),!!te.due_at&&u.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600 dark:text-gray-400",children:[u.jsx(Bl,{className:"w-3 h-3"}),u.jsxs("span",{children:["Due: ",J(String(te.due_at))]})]})]})]})})]}):u.jsx("div",{className:"p-3 text-sm text-gray-600 dark:text-gray-400",children:r&&t.length>0?"No tasks found for this project":"Select a client email thread to view tasks"})})]}),we=()=>u.jsxs("div",{className:"border-t bg-card",children:[u.jsx("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800",children:u.jsxs("div",{className:"flex items-center gap-2 cursor-pointer flex-1 hover:opacity-80 transition-opacity",onClick:()=>he(!se),children:[u.jsx(Xc,{className:"w-4 h-4 text-slate-600 dark:text-gray-300"}),u.jsx("span",{className:"font-medium text-sm text-slate-800 dark:text-white",children:"Latest Note"}),!!ke&&!d&&(se?u.jsx(sh,{className:"w-4 h-4 text-gray-400"}):u.jsx(ls,{className:"w-4 h-4 text-gray-400"}))]})}),!se&&u.jsx(u.Fragment,{children:d?u.jsx(cs,{rows:1}):ke?u.jsx("div",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:u.jsxs("div",{className:"p-3 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:[!!Se.subject&&u.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-gray-100 mb-2",children:String(Se.subject)}),u.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600 dark:text-gray-400 mb-2",children:[u.jsx(Bl,{className:"w-3 h-3"}),u.jsx("span",{children:J(String(Se.created_at||""))}),(()=>{const Te=Y(String(Se.created_at||""));return Te?u.jsxs(u.Fragment,{children:[u.jsx("span",{children:""}),u.jsx(Qf,{className:"w-3 h-3"}),u.jsx("span",{children:Te})]}):null})()]}),u.jsx("div",{className:"text-sm text-gray-700 dark:text-gray-300",children:(()=>{const Te=String(Se.detail||""),Ge=Q(Te);return U||!Ge?u.jsx("div",{className:"prose prose-sm max-w-none dark:prose-invert",dangerouslySetInnerHTML:{__html:$(Te)}}):u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"line-clamp-3 prose prose-sm max-w-none dark:prose-invert",dangerouslySetInnerHTML:{__html:$(Te)}}),u.jsx("button",{onClick:Ee=>{Ee.stopPropagation(),ge(!0)},className:"text-blue-600 dark:text-blue-400 hover:underline mt-1 text-xs font-medium",children:"Expand"})]})})()}),U&&u.jsx("button",{onClick:Te=>{Te.stopPropagation(),ge(!1)},className:"text-blue-600 dark:text-blue-400 hover:underline mt-2 text-xs font-medium",children:"Show less"})]})}):u.jsx("div",{className:"p-3 text-sm text-gray-600 dark:text-gray-400",children:r&&t.length>0?"No notes found for this project":"Select a client email thread to view notes"})})]}),Ne=()=>u.jsx(cs,{rows:2}),Me=()=>v?u.jsxs(Ye,{variant:"ghost",className:"justify-between w-full text-sm px-0 hover:bg-transparent",onClick:()=>v("Project Documents"),children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx(Xc,{className:"h-4 w-4 mr-2 text-blue-500 dark:text-blue-400"}),u.jsx("span",{className:"text-blue-500 dark:text-blue-400",children:"Project Documents"})]}),u.jsx(Ai,{src:"/icons/chevron-right.svg",width:16,height:16,alt:"Chevron right",className:"h-4 w-4"})]}):null,St=Te=>{if(m)m(Te);else if(Te>n)for(let Ge=n;Ge<Te;Ge++)i();else if(Te<n)for(let Ge=n;Ge>Te;Ge--)c()};return u.jsxs("div",{className:"w-full min-h-[4rem] border border-border/50 rounded-lg shadow-sm bg-card text-card-foreground",title:"Case Information",children:[u.jsx("div",{className:"flex items-center justify-between p-2 border-b bg-muted",children:u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(QA,{className:"w-3.5 h-3.5 text-slate-600 dark:text-gray-300"}),u.jsx("span",{className:"font-medium text-sm text-slate-800 dark:text-white",children:"PROJECTS"})]})}),d?Ne():e&&Object.keys(e).length>0?u.jsxs(u.Fragment,{children:[t.length>0&&u.jsxs("div",{className:"flex items-center px-3 py-1 bg-gray-50 dark:bg-gray-800 border-b dark:border-gray-700 gap-2",children:[u.jsxs("div",{className:"flex-1 min-w-0 flex items-center",children:[t.length>1&&u.jsxs(ti,{open:T,onOpenChange:ae,children:[u.jsx(ri,{asChild:!0,children:u.jsxs(Ye,{variant:"ghost",size:"sm",className:"h-8 text-xs text-gray-600 dark:text-gray-300 flex items-center gap-1 px-2 max-w-full",children:[u.jsx("span",{className:"truncate",title:e.Title||"",children:e.Title||"Case"}),u.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400 flex-shrink-0",children:["(",n+1,"/",t.length,")"]}),u.jsx(ls,{className:"w-3 h-3 ml-1 flex-shrink-0"})]})}),u.jsxs(Po,{align:"start",className:"w-[280px] p-0",children:[u.jsxs("div",{className:"p-2 border-b border-gray-200 dark:border-gray-700",children:[u.jsxs("div",{className:"relative",children:[u.jsx(Ii,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),u.jsx(pn,{placeholder:"Search projects...",value:N,onChange:Te=>E(Te.target.value),className:"pl-8 pr-8 h-8 text-xs",autoFocus:!0,onClick:Te=>Te.stopPropagation(),onKeyDown:Te=>Te.stopPropagation()}),N&&u.jsx("button",{onClick:Te=>{Te.stopPropagation(),E("")},className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:u.jsx(aa,{className:"w-4 h-4"})})]}),N&&u.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:["Showing ",ie.length," of ",t.length]})]}),u.jsx("div",{className:"max-h-[200px] overflow-y-auto",children:ie.length>0?ie.map((Te,Ge)=>{const Ee=t.findIndex(ye=>ye===Te);return u.jsx(Bs,{className:`text-xs truncate ${Ee===n?"bg-gray-100 dark:bg-gray-700 font-medium":""}`,onClick:()=>St(Ee),children:String(Te.projectName||`Case ${Ee+1}`)},Ee)}):u.jsxs("div",{className:"p-3 text-xs text-center text-gray-500 dark:text-gray-400",children:['No projects match "',N,'"']})})]})]}),t.length===1&&u.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-300 px-2 truncate",title:e.Title||"",children:e.Title||"Case"})]}),s.projectUrl&&u.jsxs("a",{href:s.projectUrl,target:"_blank",rel:"noopener noreferrer",className:"h-8 text-xs text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 border border-blue-200 dark:border-blue-800 px-3 flex-shrink-0 rounded-md inline-flex items-center gap-1 no-underline hover:no-underline",children:[u.jsx(Wa,{className:"w-3 h-3"}),"View"]})]}),u.jsx("div",{className:"break-words overflow-hidden",children:u.jsx(Zl,{details:e})}),u.jsx("div",{className:"px-3 border-t",children:Me()}),X(),we(),s.projectTypeCode&&s.projectTypeCode!=="IM"&&u.jsx("div",{className:"border-t",children:u.jsx($q,{type:"single",collapsible:!0,onValueChange:Te=>{Te==="view-more"&&de()},children:u.jsxs(aj,{value:"view-more",className:"border-0",children:[u.jsx(lj,{className:"px-3 py-2 hover:no-underline text-sm font-medium",children:"View More"}),u.jsx(cj,{className:"px-3 pb-2",children:u.jsx(zq,{caseSummaryData:I,isCaseSummaryLoading:j,caseSummaryError:B,caseDetails:s,onDocumentView:b})})]})},x)})]}):p?u.jsx(cs,{rows:2}):u.jsx("div",{className:"p-3 text-sm text-gray-600 dark:text-gray-400",children:r?u.jsx(u.Fragment,{children:u.jsx("p",{className:"mb-2",children:"Select a client email thread to view project information"})}):"Select a client email thread to view case information"})]})},hr="src/sidepanel/mainPanelContent/FilevineInsights.tsx",Bq="https://rubypowerslaw.filevineapp.com",Gq=({toggleSection:r,clientEmail:e,setClientEmail:t,setProjectId:n,setDocuments:s,setIsDocumentsLoading:i,setDocumentsError:c,onDocumentView:d,tempClientEmail:m,setTempClientEmail:p,emailParticipants:v,emailParticipantClients:x,currentClientIndex:b,setCurrentClientIndex:S,currentCaseIndex:N,casesForCurrentClient:E,setCasesForCurrentClient:T,isManuallySet:A,setIsManuallySet:I,isProjectManuallySelected:D,setIsProjectManuallySelected:j,isValidClient:O,isTempEmailValid:B,nextCase:G,prevCase:K,handleSetCurrentCaseIndex:re,ClientNavigation:se,onClientDataValidated:he,isValidating:U,refreshTrigger:ge,integrationSettings:ie,isPrefetchEnabled:ae})=>{const[de,J]=w.useState(!1),[Y,$]=w.useState({}),[Q,F]=w.useState({}),[H,te]=w.useState({}),[Se,ue]=w.useState(!1),[ke,X]=w.useState(void 0),[we,Ne]=w.useState([]),[Me,St]=w.useState(!1),[Te,Ge]=w.useState(null),Ee=w.useRef({}),ye=Jr(),Ke=Qa(),qe=w.useCallback(me=>{if(!me||!me.client_data)return!1;const je=me.client_data;return je&&typeof je=="object"&&Object.keys(je).length>0},[]),ft=w.useCallback(me=>{ye.info("selectClientDetails called",{sourceFile:hr,hasDetails:!!me,detailsKeys:me?Object.keys(me):[]});const je=wt=>{const We=wt.replace(/\D/g,"");return We.length===10?`(${We.slice(0,3)}) ${We.slice(3,6)}-${We.slice(6)}`:wt};ye.debug("Client details received for formatting",{sourceFile:hr,caseNames:me.caseNames});const ht={Name:me.fullName||"",Phone:je(me.phoneNumber||""),Address:me.fullAddress||""};ye.info("Client details formatted and set",{sourceFile:hr,selectedDetails:ht,originalDetails:me}),F(ht)},[ye]),mt=w.useCallback(me=>{ye.info("selectCaseDetails called",{sourceFile:hr,hasDetails:!!me,detailsKeys:me?Object.keys(me):[]});let je="";if(me.projectName){const We=me.projectName.match(/(\d{2}-\d{3})/);We&&We[1]&&(je=We[1])}ye.debug("Case details received for formatting",{sourceFile:hr});const wt=(me.projectTypeCode||"")==="IM"?{Title:me.projectName||"","Internal Case ID":je,"Assigned To":me.firstPrimaryName||"",Phase:me.phaseName||"",Tags:me.hashtags||"","Filevine Email":me.projectEmailAddress||""}:{Title:me.projectName||"","Assigned To":me.firstPrimaryName||"",Phase:me.phaseName||"",Tags:me.hashtags||"","Filevine Email":me.projectEmailAddress||""};ye.info("Case details formatted and set",{sourceFile:hr,selectedDetails:wt,originalDetails:me}),te(wt)},[ye]),jt=w.useCallback(async me=>{if(Ee.current[me]){ye.debug("Using cached client data",{sourceFile:hr,email:me});return}try{ye.debug("Fetching client data",{sourceFile:hr,email:me});const je=await Ke.getCurrentThreadId(),ht=await W_("filevine",me,ye,!1,void 0,je);Ee.current[me]=ht}catch(je){throw je instanceof Error&&(je.message.includes("Client not found")||je.message.includes("(cached)"))?ye.debug("Client not found for email (including cached)",{sourceFile:hr,email:me}):ye.error(`Error fetching client data for ${me}`,je,{sourceFile:hr}),je}},[ye,Ke]),ut=w.useCallback(async()=>{if(ye.info("fetchClientData called",{sourceFile:hr,clientEmail:e,isFilevineConnected:de,hasClientEmail:!!e}),!e||!de){ye.info("fetchClientData early return",{sourceFile:hr,reason:e?"filevine not connected":"no client email",clientEmail:e,isFilevineConnected:de});return}try{if(ue(!0),ye.info("fetchClientData: fetching from server",{sourceFile:hr,clientEmail:e}),!Ee.current[e])try{await jt(e)}catch(Ve){Ve instanceof Error&&Ve.message.includes("(cached)")?ye.debug("Using cached knowledge that this client doesn't exist",{sourceFile:hr,clientEmail:e}):ye.error("Error fetching client data",Ve,{sourceFile:hr}),$({}),T([]),F({}),te({}),ue(!1);return}const me=Ee.current[e];if(!me){$({}),T([]),F({}),te({}),ue(!1),he(e,!1);return}const je=qe(me);if(he(e,je),!je){ye.debug("Client data exists but is not valid",{sourceFile:hr,clientEmail:e}),$({}),T([]),F({}),te({}),ue(!1);return}const ht=me.client_data;ft(ht);const wt=me.case_data||[];T(wt);const We=wt.length>0?Object.entries(wt[0]).reduce((Ve,[lt,Pe])=>(Ve[lt]=String(Pe),Ve),{}):{};$(We),mt(We)}catch(me){ye.error("Error processing client data",me,{sourceFile:hr}),$({}),T([]),e&&he(e,!1)}finally{ue(!1)}},[e,de,jt,ye,ft,mt,T,he,qe]);w.useEffect(()=>{ye.info("FilevineInsights component initialized",{sourceFile:hr,clientEmail:e,emailParticipants:v.length,currentClientIndex:b,currentCaseIndex:N,casesForCurrentClient:E.length}),(async()=>{try{J(!0)}catch(je){ye.error("Error checking Filevine connection",je,{sourceFile:hr}),J(!1)}})()},[ye,E.length,N,b,e,v.length]),w.useEffect(()=>{U&&v.length>0&&(Ee.current={},ye.debug("Cleared component-level client data cache for refresh",{sourceFile:hr}))},[U,v.length,ye]),w.useEffect(()=>{const me=async()=>{if(de){ye.info("Validating all email participants",{sourceFile:hr,participantCount:v.length});for(const je of v)try{await jt(je);const ht=Ee.current[je],wt=qe(ht);he(je,wt),ye.debug("Participant validation result",{sourceFile:hr,email:je,hasValidData:wt})}catch(ht){ye.debug("Participant validation failed",{sourceFile:hr,email:je,error:ht}),he(je,!1)}}};v.length>0&&de&&me()},[v,de,jt,qe,he,ye,ge]),w.useEffect(()=>{if(D){ye.debug("Skipping fetchClientData because project was manually selected",{sourceFile:hr,clientEmail:e,isProjectManuallySelected:D});return}e&&de&&(ye.info("Fetching client data for email",{sourceFile:hr,clientEmail:e,isPrefetchEnabled:ae}),ut(),p(e),A&&!v.includes(e.toLowerCase())&&ye.debug("Manually set email not in participants, validating separately",{sourceFile:hr,clientEmail:e}))},[e,de,ut,p,A,D,v,ye,ae]),w.useEffect(()=>{D||(!e||v.length===0&&!A)&&(p(null),F({}),te({}))},[e,v.length,A,D,p,F,te]),w.useEffect(()=>{var me;if(E.length>0&&N<E.length){const je=E[N],ht=je?Object.entries(je).reduce((We,[Ve,lt])=>(We[Ve]=String(lt),We),{}):{};$(ht),mt(ht);const wt=(me=je==null?void 0:je.projectId)!=null&&me.native?String(je.projectId.native):void 0;X(wt),n&&wt&&n(wt)}},[N,E,mt,n]);const Jt=w.useCallback(async()=>{var ht;if(!de||E.length===0)return;const me=E[N],je=((ht=me==null?void 0:me.projectId)==null?void 0:ht.native)||(me==null?void 0:me.projectId);if(!je){ye.debug("No project ID found for current case",{sourceFile:hr,currentCaseIndex:N});const wt="No project ID available. Cannot fetch documents.";Ge(wt),c&&c(wt);return}St(!0),i&&i(!0),Ge(null),c&&c(null);try{const wt=await mT(String(je),ye);if(wt){ye.debug("Using cached documents for project",{sourceFile:hr,projectId:je}),Ne(wt),s&&s(wt),St(!1),i&&i(!1);return}const Ve=(await RT("filevine",String(je),ye)).documents.map(lt=>({name:lt.filename,url:`${Bq}/docwebviewer/view/${lt.documentId}`,documentId:lt.documentId,folderName:lt.folderName}));await pT(String(je),Ve,ye),Ne(Ve),s&&s(Ve)}catch(wt){ye.error("Error fetching documents",wt,{sourceFile:hr});const We="Failed to load documents. Please try again later.";Ge(We),c&&c(We)}finally{St(!1),i&&i(!1)}},[de,E,N,s,i,c,ye]),Or=w.useCallback((me,je)=>{var ht;try{const wt=((ht=me.projectId)==null?void 0:ht.native)||me.projectId;ye.info("Project manually selected via search",{projectId:wt,projectName:me.projectName,sourceFile:hr}),$(me),mt(me),T([me]),t(""),F(je?{Name:je}:{}),j(!0),X(wt),n&&wt&&n(wt)}catch(wt){ye.error("Failed to set manually selected project",wt,{sourceFile:hr})}},[ye,mt,T,t,j,n]),jr=w.useCallback(async me=>{var wt,We;const je=(wt=me.projectId)==null?void 0:wt.native,ht={projectId:{native:je||null,partner:((We=me.projectId)==null?void 0:We.partner)||null},projectName:me.projectName||"",projectTypeCode:me.projectTypeCode||"",projectTypeName:me.projectTypeName||"",phaseName:me.phaseName||"",phaseDate:me.phaseDate||"",firstPrimaryName:me.firstPrimaryName||"",firstPrimaryUsername:me.firstPrimaryUsername||"",hashtags:Array.isArray(me.hashtags)?me.hashtags.join(", "):"",projectEmailAddress:me.projectEmailAddress||"",projectUrl:me.projectUrl||"",incidentDate:me.incidentDate||""};if(Or(ht,me.clientName||""),je)try{const Ve=await PT("filevine",String(je),ye);if(Ve&&Object.keys(Ve).length>0){const lt=Ve.case_data||Ve,Pe={...ht,most_recent_note:lt.most_recent_note||null,last_completed_task:lt.last_completed_task||null,next_upcoming_task:lt.next_upcoming_task||null};Or(Pe,me.clientName||"")}}catch(Ve){ye.error("Failed to fetch project details on selection",Ve,{sourceFile:hr})}},[Or,ye]);if(!de)return null;const Nr=me=>{ye.debug(`[FilevineInfoBox] handleSectionClick called with section: "${me}"`,{sourceFile:hr,functionName:"handleSectionClick",data:{section:me}}),r?(ye.debug(`[FilevineInfoBox] Calling toggleSection with section: "${me}"`,{sourceFile:hr,functionName:"handleSectionClick",data:{section:me}}),r(me),me.toLowerCase()==="project documents"?(ye.debug('[FilevineInfoBox] Section is "project documents", calling fetchMatterDocuments',{sourceFile:hr,functionName:"handleSectionClick",data:{section:me}}),Jt()):ye.debug('[FilevineInfoBox] Section is not "project documents", not calling fetchMatterDocuments',{sourceFile:hr,functionName:"handleSectionClick",data:{section:me}})):ye.warn("[FilevineInfoBox] toggleSection is not defined. Cannot navigate.",{sourceFile:hr,functionName:"handleSectionClick",data:{section:me}})};return u.jsxs("div",{className:"space-y-4 overflow-y-auto h-full mt-0",children:[u.jsx(HP,{onMatterSelected:jr,integrationType:"filevine"}),u.jsx(wq,{clientEmail:e,emailParticipants:v,emailParticipantClients:x,currentClientIndex:b,setCurrentClientIndex:S,setClientEmail:t,isManuallySet:A,selectedClientDetails:Q,isLoading:Se,ClientNavigation:se,tempClientEmail:m,setTempClientEmail:p,setIsManuallySet:I,isValidClient:O,isTempEmailValid:B,isValidating:U,isProjectManuallySelected:D}),u.jsx(Hq,{clientEmail:e,selectedCaseDetails:H,casesForCurrentClient:E,currentCaseIndex:N,caseDetails:Y,nextCase:G,prevCase:K,isLoading:Se,setCurrentCaseIndex:re,isValidating:U,handleSectionClick:Nr,projectId:ke,onDocumentView:d}),u.jsx("div",{className:"h-8"})]})},Wq=sS("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),$S=w.forwardRef(({className:r,variant:e,...t},n)=>u.jsx("div",{ref:n,role:"alert",className:Fr(Wq({variant:e}),r),...t}));$S.displayName="Alert";const Vq=w.forwardRef(({className:r,...e},t)=>u.jsx("h5",{ref:t,className:Fr("mb-1 font-medium leading-none tracking-tight",r),...e}));Vq.displayName="AlertTitle";const US=w.forwardRef(({className:r,...e},t)=>u.jsx("div",{ref:t,className:Fr("text-sm [&_p]:leading-relaxed",r),...e}));US.displayName="AlertDescription";const zv="src/shared/components/sidepanel/panels/components/ClioContactCreation.tsx",hN=r=>{if(!r||r.trim()==="")return!0;if(!/^[\d\s+().-]+$/.test(r))return!1;const t=r.replace(/\D/g,"");return t.length>=7&&t.length<=15},qq=({emailParticipants:r,emailParticipantClients:e,getClientNameFromCache:t,onContactsCreated:n})=>{const s=Jr(),[i,c]=w.useState([]),[d,m]=w.useState(!1),[p,v]=w.useState(!1),[x,b]=w.useState([]),[S,N]=w.useState({}),[E,T]=w.useState([]),[A,I]=w.useState(!1),[D,j]=w.useState(null),[O,B]=w.useState(!1),G=w.useCallback(ie=>{const ae=ie.toLowerCase();return e.some(de=>de.toLowerCase()===ae)},[e]);w.useEffect(()=>{const ie=r.map((ae,de)=>{const J=G(ae);let Y="";if(J){const $=t(ae);$&&(Y=$)}return Y||(Y=ae.split("@")[0].split(".").map(Q=>Q.charAt(0).toUpperCase()+Q.slice(1).toLowerCase()).join(" ")),{id:`participant-${de}`,name:Y,email:ae,inClio:J}});c(ie),s.debug("Participants initialized with Clio status",{sourceFile:zv,totalParticipants:ie.length,inClio:ie.filter(ae=>ae.inClio).length,notInClio:ie.filter(ae=>!ae.inClio).length})},[r,e,s,G,t]);const K=i.some(ie=>!ie.inClio),re=()=>{m(!0),v(!1);const ie={};i.forEach(ae=>{if(!ae.inClio){const de=ae.name.split(" ");ie[ae.id]={firstName:de[0]||"",lastName:de.slice(1).join(" ")||"",email:ae.email,phoneNumber:"",type:"person",companyName:""}}}),N(ie)},se=()=>{m(!1),b([]),j(null)},he=ie=>{b(ae=>ae.includes(ie)?ae.filter(de=>de!==ie):[...ae,ie])},U=(ie,ae,de)=>{N(J=>({...J,[ie]:{...J[ie],[ae]:de}}))},ge=async()=>{var ie,ae,de;I(!0),j(null);for(const J of x){const Y=S[J];if(!Y){j({type:"validation",message:"Contact data is missing. Please try again."}),I(!1);return}if(Y.type==="person"){if(!((ie=Y.firstName)!=null&&ie.trim())||!((ae=Y.lastName)!=null&&ae.trim())){j({type:"validation",message:"First and Last name is required for person contacts."}),I(!1);return}}else if(Y.type==="company"&&!((de=Y.companyName)!=null&&de.trim())){j({type:"validation",message:"Company name is required for company contacts."}),I(!1);return}if(Y!=null&&Y.phoneNumber&&!hN(Y.phoneNumber)){j({type:"validation",message:"Invalid phone number. Please enter 7-15 digits with optional formatting (+, -, spaces, parentheses)."}),I(!1);return}}try{const J=[];for(const $ of x){const Q=i.find(H=>H.id===$),F=S[$];if(!(!Q||!F))try{const H=await f8(F,s),te=F.type==="company"?F.companyName||"":`${F.firstName||""} ${F.lastName||""}`.trim();J.push({id:H.id,name:te||Q.name,email:Q.email}),s.info("Contact created successfully in Clio",{sourceFile:zv,email:Q.email})}catch(H){if(s.error("Error creating contact in Clio",H,{sourceFile:zv,email:Q.email}),H instanceof Error&&(H.message.includes("duplicate")||H.message.includes("already exists")?j({type:"duplicate",message:"A contact with this email already exists in Clio."}):H.message.includes("permission")?j({type:"permission",message:"You do not have permission to create contacts in Clio. Contact your admin."}):j({type:"network",message:"Something went wrong. Please try again."})),J.length>0){const te=[...E,...J];T(te),c(ue=>ue.map(ke=>{const X=J.find(we=>we.email.toLowerCase()===ke.email.toLowerCase());return X?{...ke,inClio:!0,name:X.name}:ke}));const Se=J.map(ue=>{var ke;return(ke=i.find(X=>X.email.toLowerCase()===ue.email.toLowerCase()))==null?void 0:ke.id}).filter(Boolean);b(ue=>ue.filter(ke=>!Se.includes(ke))),n&&n(te)}I(!1);return}}B(!0);const Y=[...E,...J];T(Y),m(!1),b([]),I(!1),c($=>$.map(Q=>{const F=J.find(H=>H.email.toLowerCase()===Q.email.toLowerCase());return F?{...Q,inClio:!0,name:F.name}:Q})),n&&n(Y)}catch(J){s.error("Unexpected error in contact creation flow",J,{sourceFile:zv}),j({type:"network",message:"Something went wrong. Please try again."}),I(!1)}};return i.length===0||!K&&E.length===0?null:u.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700",children:u.jsxs("div",{className:"p-4",children:[!O&&u.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 border border-gray-300 dark:border-gray-600 rounded-md p-4",children:[u.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:"Some email participants are not contacts in Clio."}),K&&!d&&u.jsxs("div",{className:"flex items-center gap-3 mt-3",children:[u.jsx(Ye,{onClick:re,size:"sm",className:"h-9",children:"Add to Clio"}),u.jsx("button",{onClick:()=>v(!p),className:"text-sm text-blue-600 dark:text-blue-400 hover:underline",children:"How this works"})]}),p&&u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-3 leading-relaxed",children:"Create a Clio contact from email participants so Candle can show client and matter context."}),d&&u.jsxs("div",{className:"mt-4 border-t dark:border-gray-700 pt-4",children:[u.jsx("h4",{className:"text-sm font-semibold text-gray-800 dark:text-gray-200 mb-1",children:"Add contact to Clio"}),u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-4",children:"Select people on this email thread"}),D&&u.jsx("div",{role:"alert","aria-live":"assertive",className:"mb-4",children:u.jsx("div",{className:"flex items-start bg-red-50 dark:bg-red-950/30 border border-red-200 dark:border-red-800 text-red-900 dark:text-red-100 rounded-md p-3",children:u.jsxs("div",{className:"flex-1",children:[u.jsx("p",{className:"text-sm",children:D.message}),D.type==="network"&&u.jsx("div",{className:"mt-2",children:u.jsx(Ye,{onClick:ge,size:"sm",variant:"destructive",className:"h-7 text-xs",children:"Retry"})})]})})}),u.jsx("div",{className:"space-y-2 mb-4",children:i.map(ie=>u.jsxs("div",{className:`flex items-center gap-3 p-3 border dark:border-gray-600 rounded-md ${ie.inClio?"bg-gray-50 dark:bg-gray-800 opacity-60":"bg-white dark:bg-gray-900"}`,children:[u.jsx("input",{type:"checkbox",checked:x.includes(ie.id),onChange:()=>he(ie.id),disabled:ie.inClio,className:"h-4 w-4 text-blue-600"}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate",children:ie.name}),u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:ie.email})]}),u.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${ie.inClio?"bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-400 border border-green-300 dark:border-green-800":"bg-orange-100 dark:bg-orange-900/30 text-orange-800 dark:text-orange-400 border border-orange-300 dark:border-orange-800"}`,children:ie.inClio?"In Clio":"Not in Clio"})]},ie.id))}),x.length>0&&u.jsx("div",{className:"border-t dark:border-gray-700 pt-4 space-y-4",children:x.map(ie=>{const ae=i.find(J=>J.id===ie),de=S[ie]||{};return ae?u.jsxs("div",{className:"space-y-3",children:[u.jsx("div",{className:"text-sm font-semibold text-gray-800 dark:text-gray-200",children:ae.name}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Contact type"}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{onClick:()=>U(ie,"type","person"),className:`flex-1 px-3 py-2 text-sm border rounded transition-colors ${de.type==="person"?"bg-blue-600 dark:bg-blue-700 text-white border-blue-600 dark:border-blue-700":"bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 border-gray-300 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:"Person"}),u.jsx("button",{onClick:()=>U(ie,"type","company"),className:`flex-1 px-3 py-2 text-sm border rounded transition-colors ${de.type==="company"?"bg-blue-600 dark:bg-blue-700 text-white border-blue-600 dark:border-blue-700":"bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 border-gray-300 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:"Company"})]})]}),de.type==="person"?u.jsxs(u.Fragment,{children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"First name"}),u.jsx(pn,{type:"text",value:de.firstName||"",onChange:J=>U(ie,"firstName",J.target.value),className:"h-9 text-sm"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Last name"}),u.jsx(pn,{type:"text",value:de.lastName||"",onChange:J=>U(ie,"lastName",J.target.value),className:"h-9 text-sm"})]})]}):u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Company name"}),u.jsx(pn,{type:"text",value:de.companyName||"",onChange:J=>U(ie,"companyName",J.target.value),className:"h-9 text-sm"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Phone number (optional)"}),u.jsx(pn,{type:"tel",value:de.phoneNumber||"",onChange:J=>U(ie,"phoneNumber",J.target.value),placeholder:"+1 (555) 123-4567",className:"h-9 text-sm"}),de.phoneNumber&&!hN(de.phoneNumber)&&u.jsx("p",{className:"text-xs text-red-600 dark:text-red-400 mt-1",children:"Please enter a valid phone number (7-15 digits)"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Email"}),u.jsx(pn,{type:"text",value:de.email||"",readOnly:!0,disabled:!0,className:"h-9 text-sm"})]})]},ie):null})}),u.jsxs("div",{className:"flex gap-2 mt-4 pt-4 border-t dark:border-gray-700",children:[u.jsx(Ye,{onClick:ge,disabled:x.length===0||A,size:"sm",className:"h-9",children:A?"Creating...":"Create contact"}),u.jsx(Ye,{onClick:se,variant:"outline",size:"sm",className:"h-9",children:"Cancel"})]})]})]}),O&&u.jsxs("div",{className:"bg-green-50 dark:bg-green-900/30 border border-green-200 dark:border-green-700 rounded-md p-4",children:[u.jsx("h4",{className:"text-sm font-semibold text-green-900 dark:text-green-100 mb-2",children:"This contact has been added in Clio"}),u.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mb-2",children:"Clio may take a few minutes to show updates."}),u.jsx("div",{className:"space-y-2",children:E.map(ie=>u.jsxs("div",{className:"flex items-center justify-between p-2 bg-white dark:bg-gray-800 rounded-md border border-gray-200 dark:border-gray-600",children:[u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate",children:ie.name}),u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:ie.email})]}),u.jsx("span",{className:"px-2 py-1 text-xs bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-400 border border-green-300 dark:border-green-800 rounded-full",children:"In Clio"})]},ie.id))}),u.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-3",children:"Go to the Matter section below to link this contact to a matter."}),K&&u.jsx(Ye,{onClick:()=>{B(!1),m(!0)},size:"sm",variant:"outline",className:"h-8 text-xs mt-3",children:"Add more contacts"})]})]})})},Kq=({clientEmail:r,emailParticipants:e,emailParticipantClients:t,currentClientIndex:n,setCurrentClientIndex:s,setClientEmail:i,isManuallySet:c,selectedClientDetails:d,linkableFields:m,isLoading:p,ClientNavigation:v,handleSectionClick:x,tempClientEmail:b,setTempClientEmail:S,setIsManuallySet:N,isValidClient:E,isTempEmailValid:T,showClientDocumentsButton:A,isValidating:I,fetchError:D=!1,isRateLimited:j=!1,hasTransientError:O=!1,onContactsCreated:B,getClientNameFromCache:G,isClientDataValidationComplete:K})=>{var ie;Jr();const re=()=>u.jsx(cs,{rows:2}),se=(ie=m.find(ae=>ae.field==="Name"))==null?void 0:ie.url,he=()=>u.jsxs("div",{className:"flex items-center px-3 py-1 bg-gray-50 dark:bg-gray-800 border-b dark:border-gray-700 gap-2",children:[u.jsx("div",{className:"flex-1 min-w-0 flex items-center",children:u.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-300 truncate",title:b||"",children:[b," (Manually set)"]})}),se&&u.jsxs("a",{href:se,target:"_blank",rel:"noopener noreferrer",className:"h-8 text-xs text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 border border-blue-200 dark:border-blue-800 px-3 flex-shrink-0 rounded-md inline-flex items-center gap-1 no-underline hover:no-underline",children:[u.jsx(Wa,{className:"w-3 h-3"}),"View"]})]}),U=()=>u.jsx(Zl,{details:d}),ge=()=>{let ae="Select a client email thread to view client information";return c&&r?ae=`No client information found for ${r}`:e.length>0&&(t.length===0?ae=`No client information available for emails on the selected thread: ${e.join(", ")}`:ae="No client information available for the selected email ID"),u.jsx("div",{className:"p-3 text-sm text-gray-600 dark:text-gray-400",children:u.jsx("p",{className:"mb-2",children:ae})})};return u.jsxs("div",{className:"w-full min-h-[4rem] border border-border/50 rounded-lg shadow-sm bg-card text-card-foreground",title:"Client Information",children:[u.jsxs("div",{className:"flex items-center justify-between p-2 border-b bg-muted",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(Ey,{className:"w-3.5 h-3.5 text-slate-600 dark:text-gray-300"}),u.jsx("span",{className:"font-medium text-sm text-slate-800 dark:text-white",children:"CONTACT"})]}),u.jsxs(ti,{children:[u.jsx(ri,{asChild:!0,children:u.jsx(Ye,{variant:"ghost",size:"icon",className:"h-6 w-6 hidden",children:u.jsx(Ii,{className:"h-4 w-4"})})}),u.jsx(Po,{align:"end",className:"p-2",children:u.jsx("div",{className:"flex flex-col gap-2 w-64",children:u.jsxs("div",{className:"flex gap-2 items-center",children:[u.jsx(pn,{type:"email",value:b||"",onChange:ae=>S(ae.target.value),placeholder:"Set client email",className:`flex-1 px-2 py-1 h-8 text-xs ${T===!1?"border-red-300 focus:ring-red-500":""}`}),u.jsx(Ye,{variant:"outline",size:"sm",className:`h-8 text-xs px-2 ${T===!1?"bg-red-50 hover:bg-red-100":""}`,onClick:()=>{i(b||""),N(!0)},disabled:!b,title:T===!1?"Warning: This email is not recognized as a valid client in Clio":"Set email as current client",children:"Search"})]})})})]})]}),p?re():D?u.jsxs("div",{className:"flex items-center gap-1.5 px-3 py-2 text-xs text-amber-700 dark:text-amber-400",children:[u.jsx(oh,{className:"h-3.5 w-3.5 flex-shrink-0"}),u.jsx("span",{children:j?"Failed to refresh. Please try again later.":"Failed to fetch contact data. Please try again later."})]}):u.jsxs(u.Fragment,{children:[j&&u.jsxs("div",{className:"flex items-center gap-1.5 px-3 py-2 text-xs text-amber-700 dark:text-amber-400",children:[u.jsx(oh,{className:"h-3.5 w-3.5 flex-shrink-0"}),u.jsx("span",{children:"Failed to refresh. Try again later."})]}),t.length>0&&!c&&u.jsx(v,{clientUrl:se}),c&&r&&u.jsx(he,{}),d&&Object.keys(d).length>0?u.jsx(U,{}):I&&!c?u.jsx(cs,{rows:2}):O&&!c?u.jsx("div",{className:"flex justify-center p-2",children:u.jsxs($S,{variant:"default",className:"w-full border-amber-200 bg-amber-50 dark:border-amber-800 dark:bg-amber-950",children:[u.jsx(oh,{className:"h-4 w-4 text-amber-600 dark:text-amber-400"}),u.jsx(US,{className:"ml-2 text-amber-800 dark:text-amber-200",children:"Failed to fetch contact data. Please try again later."})]})}):u.jsx(ge,{})]}),K&&!c&&!O&&e.length!==t.length&&G&&u.jsx(qq,{emailParticipants:e,emailParticipantClients:t,getClientNameFromCache:G,onContactsCreated:B})]})},Hv="src/shared/components/sidepanel/panels/components/ClioMatterLinking.tsx",pw=({createdContacts:r,onMatterLinked:e})=>{const t=Jr(),[n,s]=w.useState(!1),[i,c]=w.useState(""),[d,m]=w.useState(!1),[p,v]=w.useState(null),[x,b]=w.useState([]),[S,N]=w.useState([]),[E,T]=w.useState({}),[A,I]=w.useState(!1),[D,j]=w.useState(null),[O,B]=w.useState(null),[G,K]=w.useState(!1),re=()=>{s(!0),j(null),N(r.map(ae=>ae.id))},se=()=>{s(!1),c(""),m(!1),v(null),j(null),T({})},he=async ae=>{if(c(ae),m(!0),!ae){v(null),b([]);return}if(ae.length<3){b([]);return}K(!0);try{const J=((await V_("clio",ae,t)).projects||[]).map(Y=>{var $;return{id:String((($=Y.projectId)==null?void 0:$.native)||""),name:Y.projectName||"",status:Y.isArchived?"closed":"open",description:Y.projectName||""}});b(J)}catch(de){t.error("Error searching matters",de,{sourceFile:Hv,searchQuery:ae})}finally{K(!1)}},U=ae=>{v(ae),c(ae.name),m(!1)},ge=ae=>{N(de=>de.includes(ae)?de.filter(J=>J!==ae):[...de,ae])},ie=async()=>{if(p){I(!0),j(null);try{const ae=[];for(const de of S){const J=E[de]||"Related Contact";try{await h8("clio",de,p.id,J,t),ae.push(de),t.info("Contact linked to matter successfully",{sourceFile:Hv})}catch(Y){t.error("Error linking contact to matter",Y,{sourceFile:Hv}),Y instanceof Error&&(Y.message.includes("permission")?j({type:"permission",message:"You do not have permission to modify matters in Clio. Contact your admin."}):j({type:"network",message:"Something went wrong. Please try again."})),ae.length>0&&(N($=>$.filter(Q=>!ae.includes(Q))),e&&e(p.id)),I(!1);return}}B(p),s(!1),I(!1),e&&e(p.id)}catch(ae){t.error("Unexpected error in matter linking flow",ae,{sourceFile:Hv}),j({type:"network",message:"Something went wrong. Please try again."}),I(!1)}}};return u.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700",children:u.jsxs("div",{className:"p-2",children:[!n&&!O&&u.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 border border-gray-300 dark:border-gray-600 rounded-md p-4",children:[u.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:"Link the created contact(s) to a matter as related contacts."}),u.jsx(Ye,{onClick:re,size:"sm",className:"h-9",children:"Add to a matter"})]}),n&&u.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 border border-gray-300 dark:border-gray-600 rounded-md p-4",children:[u.jsx("h4",{className:"text-sm font-semibold text-gray-800 dark:text-gray-200 mb-1",children:"Link matter as a related contact"}),u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-4",children:"Add as a related contact in Clio"}),D&&u.jsx("div",{role:"alert","aria-live":"assertive",className:"mb-4",children:u.jsx("div",{className:"flex items-start bg-red-50 dark:bg-red-950/30 border border-red-200 dark:border-red-800 text-red-900 dark:text-red-100 rounded-md p-3",children:u.jsxs("div",{className:"flex-1",children:[u.jsx("p",{className:"text-sm",children:D.message}),D.type==="network"&&u.jsx("div",{className:"mt-2",children:u.jsx(Ye,{onClick:ie,size:"sm",variant:"destructive",className:"h-7 text-xs",children:"Retry"})})]})})}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Matter"}),u.jsx(pn,{type:"text",placeholder:"Search matters...",value:i,onChange:ae=>he(ae.target.value),onFocus:()=>m(!0),className:"h-9 text-sm"}),d&&i&&x.length>0&&u.jsx("div",{className:"mt-1 max-h-48 overflow-y-auto border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 shadow-lg",children:x.map(ae=>u.jsxs("div",{onClick:()=>U(ae),className:"flex items-center justify-between p-3 hover:bg-gray-50 dark:hover:bg-gray-700 cursor-pointer border-b dark:border-gray-600 last:border-b-0",children:[u.jsx("div",{className:"text-sm text-gray-900 dark:text-gray-100 flex-1 truncate",children:ae.name}),u.jsx("span",{className:`ml-2 px-2 py-1 text-xs rounded-full ${ae.status==="open"?"bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-400 border border-blue-300 dark:border-blue-800":"bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-300 border border-gray-300 dark:border-gray-700"}`,children:ae.status==="open"?"Open":"Closed"})]},ae.id))}),G&&u.jsx("div",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400",children:"Searching matters..."})]}),p&&u.jsx(u.Fragment,{children:u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Related contact(s) to add"}),r.map(ae=>u.jsxs("div",{className:"mb-4",children:[u.jsxs("div",{className:"flex items-center gap-3 p-3 border dark:border-gray-600 rounded-md bg-white dark:bg-gray-800",children:[u.jsx("input",{type:"checkbox",checked:S.includes(ae.id),onChange:()=>ge(ae.id),className:"h-4 w-4 text-blue-600"}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate",children:ae.name}),u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:ae.email})]})]}),S.includes(ae.id)&&u.jsxs("div",{className:"mt-2",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Relationship"}),u.jsx(pn,{type:"text",placeholder:"e.g., Opposing Counsel, Co-Counsel, Employee",value:E[ae.id]||"",onChange:de=>T(J=>({...J,[ae.id]:de.target.value})),className:"h-9 text-sm"})]})]},ae.id))]})}),u.jsxs("div",{className:"flex gap-2 pt-4 border-t dark:border-gray-700",children:[u.jsx(Ye,{onClick:ie,disabled:!p||S.length===0||A,size:"sm",className:"h-9",children:A?"Saving...":"Save"}),u.jsx(Ye,{onClick:se,variant:"outline",size:"sm",className:"h-9",children:"Back"})]})]}),O&&!n&&u.jsxs("div",{className:"bg-green-50 dark:bg-green-900/30 border border-green-200 dark:border-green-700 rounded-md p-4",children:[u.jsx("h4",{className:"text-sm font-semibold text-green-900 dark:text-green-100 mb-3",children:"Added to matter"}),u.jsx("div",{className:"mb-3 p-3 bg-white dark:bg-gray-800 rounded-md border border-gray-200 dark:border-gray-600",children:u.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:O.name})}),u.jsx("div",{className:"space-y-2 mb-3",children:r.filter(ae=>S.includes(ae.id)).map(ae=>u.jsxs("div",{className:"flex items-center justify-between p-2 bg-white dark:bg-gray-800 rounded-md border border-gray-200 dark:border-gray-600",children:[u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate",children:ae.name}),u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:E[ae.id]||"Related contact"})]}),u.jsxs("a",{href:`https://app.clio.com/nc#/contacts/${ae.id}`,target:"_blank",rel:"noopener noreferrer",className:"h-7 text-xs text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 border border-blue-200 dark:border-blue-800 px-2 flex-shrink-0 rounded-md inline-flex items-center gap-1 no-underline hover:no-underline ml-2",children:[u.jsx(Wa,{className:"w-3 h-3"}),"View"]})]},ae.id))}),u.jsx("div",{className:"flex gap-2",children:u.jsx(Ye,{onClick:()=>{B(null),s(!0),v(null),c(""),T({})},variant:"outline",size:"sm",className:"h-9 whitespace-nowrap",children:"Link another matter"})})]})]})})},Ml="src/shared/components/sidepanel/panels/components/ClioCaseInfoBox.tsx",Yq=({clientEmail:r,selectedCaseDetails:e,casesForCurrentClient:t,currentCaseIndex:n,linkableFields:s,nextCase:i,prevCase:c,isLoading:d,isManuallySet:m,setCurrentCaseIndex:p,calendarEntries:v=[],isValidating:x=!1,caseUrl:b,matterId:S,onMatterManuallySelected:N,fetchError:E=!1,isRateLimited:T=!1,hasTransientError:A=!1,userData:I,createdContacts:D=[],onMatterLinked:j,pageSize:O=5,currentPage:B=1,totalMatters:G,onNavigateToPage:K,allMatterSummaries:re=[],isLoadingMatterDetails:se=!1,matterDetailError:he=!1})=>{var Mo,$i;const U=Jr(),ge=Qa(),[ie,ae]=w.useState(!1),[de,J]=w.useState(!1),[Y,$]=w.useState(!1),[Q,F]=w.useState(!1),[H,te]=w.useState(""),[Se,ue]=w.useState(!1),ke=w.useRef(!1),[X,we]=w.useState(""),[Ne,Me]=w.useState([]),[St,Te]=w.useState(!1),[Ge,Ee]=w.useState(!1),[ye,Ke]=w.useState(null),[qe,ft]=w.useState(null),mt=w.useMemo(()=>{if(re.length>0&&S){const be=re.findIndex(ze=>ze.id===S);if(be!==-1)return be+1}return(B-1)*O+n+1},[re,S,B,O,n]),[jt,ut]=w.useState(!1),[Jt,Or]=w.useState(""),[jr,Nr]=w.useState(""),[me,je]=w.useState(new Date().toISOString().split("T")[0]),[ht,wt]=w.useState("Normal"),[We,Ve]=w.useState(!1),[lt,Pe]=w.useState(!1),[kt,Ft]=w.useState(!1),$e=w.useRef(!1),cr=w.useRef(null),Ut=w.useRef(!1),[lr,Wt]=w.useState(null),[Zt,_n]=w.useState(null),[Un,Oo]=w.useState(!0),[Jn,_r]=w.useState(!1),[gn,po]=w.useState(""),[Do,Sn]=w.useState([]),[Gs,Ws]=w.useState(!1),[Li,ln]=w.useState(!1),[zn,Pn]=w.useState(null),[le,tt]=w.useState(""),[Tt,dt]=w.useState(""),[ot,Vt]=w.useState(!1),[_t,Qt]=w.useState(1),[En,Be]=w.useState("Days"),[q]=w.useState("Email"),[De,Qe]=w.useState(!1),[Tr,Xt]=w.useState(!0),[Br,cn]=w.useState(!0),[ds,Cs]=w.useState(!0),[Mi,Gr]=w.useState(!1),[Lo,Xn]=w.useState(""),[ou,Ns]=w.useState(""),[pa,iu]=w.useState(new Date().toISOString().split("T")[0]),[au,li]=w.useState(!1),[ci,Vs]=w.useState(null),qs=()=>{Or(""),Nr(""),je(new Date().toISOString().split("T")[0]),wt("Normal"),tt((I==null?void 0:I.id)||""),dt((I==null?void 0:I.name)||""),po(""),Sn([]),Pn(null),Vt(!1),Qt(1),Be("Days"),$e.current=!1,Wt(null),Oo(!0),Xt(!0),cn(!0)},lu=()=>{Xn(""),Ns(""),iu(new Date().toISOString().split("T")[0]),Vs(null)};w.useEffect(()=>{_n(null)},[S]),w.useEffect(()=>{if(!lr)return;const be=setTimeout(()=>Wt(null),5e3);return()=>clearTimeout(be)},[lr]),w.useEffect(()=>{if(!ci)return;const be=setTimeout(()=>Vs(null),5e3);return()=>clearTimeout(be)},[ci]),w.useEffect(()=>{const be=!!(le&&(I!=null&&I.id)&&le!==I.id);Cs(!be)},[le,I]),w.useEffect(()=>{D&&D.length>0?_r(!0):_r(!1)},[D]),w.useEffect(()=>{S||(qs(),ut(!1)),jt||($e.current=!1)},[jt,S]),w.useEffect(()=>{jt&&I&&!le&&(tt(I.id),dt(I.name))},[jt,I,le]);const kh=w.useMemo(()=>ny.debounce(async be=>{if(!be.trim()||be.length<2){Sn([]),Pn(null);return}Ws(!0),Pn(null);try{const ze=await xT(U),Je=be.toLowerCase();if(ze){const At=ze.filter(Ct=>Ct.name.toLowerCase().includes(Je)).sort((Ct,zt)=>{const at=Ct.name.toLowerCase().startsWith(Je),pt=zt.name.toLowerCase().startsWith(Je);return at!==pt?at?-1:1:Ct.name.localeCompare(zt.name)});Sn(At),At.length===0&&Pn(`No users found for "${be}"`)}else{Ut.current||(Ut.current=!0,jT("clio",U).then(Ct=>yT(Ct.map(({id:zt,name:at})=>({id:zt,name:at})),U)).catch(Ct=>U.error("Failed to refresh firm users cache",Ct,{sourceFile:Ml})).finally(()=>{Ut.current=!1}));const At=await i8("clio",be,U);Sn((At.users||[]).map(({id:Ct,name:zt})=>({id:Ct,name:zt}))),(At.users||[]).length===0&&Pn(`No users found for "${be}"`)}}catch(ze){U.error("Assignee search failed",ze,{sourceFile:Ml}),Pn("Failed to search users. Please try again."),Sn([])}finally{Ws(!1)}},400),[U]);w.useEffect(()=>{const be=async ze=>{if(!ze){qs(),ut(!1);return}if(ze.threadId!=cr.current){qs(),ut(!1),cr.current=String(ze.threadId),_n(null);return}};return ge&&(ge.onThreadChanged(be),ge.getCurrentThread().then(ze=>{be(ze)}).catch(ze=>{U.error("Error getting initial thread",ze,{sourceFile:"ClioCaseInfoBox.tsx"})})),()=>{ge==null||ge.removeThreadListener(be)}},[ge,U]),w.useEffect(()=>{(async()=>{var ze;if(jt&&!$e.current){$e.current=!0,Ve(!0);try{const Je=await ge.getCurrentThread();if(Je&&((ze=Je==null?void 0:Je.messages)==null?void 0:ze.length)>0){const At=Je.messages[Je.messages.length-1].subject,Ct=Je.messages[Je.messages.length-1].body,zt="Subject: "+At+`
Body: `+Ct,at=await c8("clio",zt,U);Or(at.name),Nr(at.description)}}catch(Je){U.error("Failed to generate task description",Je,{sourceFile:Ml})}finally{Ve(!1)}}})()},[jt,ge,U]);const ec=async()=>{var Je;Wt(null);const be=[];if(Jt.trim()||be.push("Task Name"),jr.trim()||be.push("Task Description"),S||be.push("Matter"),le||be.push("Assign To"),(!me||!/^\d{4}-\d{2}-\d{2}$/.test(me)||Number.isNaN(Date.parse(me)))&&be.push("Date"),be.length>0){Wt({type:"error",text:`Please fill in the following fields: ${be.join(", ")}`});return}Pe(!0);try{const At=me?new Date(me).toISOString():null;let Ct=jr;if(Un){const pt=await ge.getCurrentThread();if(!pt||((Je=pt==null?void 0:pt.messages)==null?void 0:Je.length)<1){Wt({type:"error",text:"Something went wrong. Please try again"});return}const Qn=pt.messages[pt.messages.length-1].body;Ct=jr+`

Referenced Email Below

`+Qn}await u8("clio",Jt,Ct,S,At,ht,U,le||void 0,ot?{value:_t,unit:En,method:q,assigneeId:le||void 0}:void 0,ds?void 0:{notifyAssignee:Tr,notifyCompletion:Br}),qs(),ut(!1),Wt({type:"success",text:"Task created successfully!"}),_n({name:Jt,description:jr,due_at:me,priority:ht})}catch(At){U.error("Failed to create task",At,{sourceFile:Ml}),Wt({type:"error",text:"Failed to create task. Please try again."})}finally{Pe(!1)}},cu=async()=>{li(!0),Vs(null);const be=[];if(Lo.trim()||be.push("Subject"),ou.trim()||be.push("Note"),S||be.push("Matter"),(!pa||!/^\d{4}-\d{2}-\d{2}$/.test(pa)||Number.isNaN(Date.parse(pa)))&&be.push("Date"),be.length>0){Vs({type:"error",text:`Please fill in: ${be.join(", ")}`}),li(!1);return}try{const Je=await d8("clio",Lo,ou,pa,S,null,U);U.info("Note created successfully",{sourceFile:Ml,noteId:Je.noteId}),lu(),Gr(!1),Vs({type:"success",text:"Note created successfully!"})}catch(Je){U.error("Error creating note",Je,{sourceFile:Ml}),Vs({type:"error",text:Je instanceof Error?Je.message:"Failed to create note"})}finally{li(!1)}};w.useMemo(()=>{if(!H.trim())return t;const be=H.toLowerCase();return t.filter(ze=>String(ze.description||"").toLowerCase().includes(be))},[t,H]);const tl=be=>{if(ue(be),ke.current){be&&(ke.current=!1);return}const ze=qe||S;if(be&&re.length>0&&ze){const Je=re.findIndex(At=>At.id===ze);if(Je!==-1){const At=Math.floor(Je/O)+1;At!==B&&K&&K(At)}}be||te("")},rl=w.useMemo(()=>ny.debounce(async be=>{if(!be.trim()||be.length<2){Me([]),Ke(null);return}Te(!0),Ke(null);try{const ze=await V_("clio",be,U);Me(ze.projects||[]),ze.projects.length===0&&Ke(`No matters found for "${be}"`)}catch(ze){U.error("Matter search failed",ze,{sourceFile:Ml}),Ke("Failed to search matters. Please try again."),Me([])}finally{Te(!1)}},400),[U]),yd=be=>{var ze,Je;try{const At={id:((Je=(ze=be.projectId)==null?void 0:ze.native)==null?void 0:Je.toString())||"",description:be.projectName||"",practice_area:be.projectTypeName||"",matter_stage:be.phaseName||"",status:be.isArchived?"Closed":"Open",client_name:be.clientName||"",responsible_attorney:be.firstPrimaryName||"",url:be.projectUrl||"",name:be.projectName||""};U.info("Matter manually selected via search",{matterId:At.id,matterName:At.description,sourceFile:Ml}),N&&N(At),Ee(!1),we(""),Me([]),Ke(null)}catch(At){U.error("Failed to select matter",At,{sourceFile:Ml})}},nl=()=>u.jsx(cs,{rows:2}),vr=be=>{if(ft(null),p)p(be);else if(be>n)for(let ze=n;ze<be;ze++)i();else if(be<n)for(let ze=n;ze>be;ze--)c()},Ks=be=>{try{const ze=be.split("T")[0];if(!ze)return be;const[Je,At,Ct]=ze.split("-").map(Number);return isNaN(Je)||isNaN(At)||isNaN(Ct)||At<1||At>12?be:`${["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][At-1]} ${Ct}, ${Je}`}catch{return be}},sl=be=>{try{const ze=be.split("T")[1];if(!ze)return"";const Je=ze.split(/[Z+-]/)[0],[At,Ct]=Je.split(":").map(Number);if(isNaN(At)||isNaN(Ct))return"";const zt=At>=12?"PM":"AM",at=At%12||12,pt=Ct.toString().padStart(2,"0");return`${at}:${pt} ${zt}`}catch{return""}},tc=be=>be?(new DOMParser().parseFromString(be,"text/html").body.textContent||"").length>200:!1,uu=be=>{const ze=["a","b","br","div","em","i","li","ol","p","s","strong","u","ul"],Je=["href","rel","type","target"],Ct=new DOMParser().parseFromString(be,"text/html"),zt=Ct.body.getElementsByTagName("*");for(let at=zt.length-1;at>=0;at--){const pt=zt[at];ze.includes(pt.tagName.toLowerCase())?Array.from(pt.attributes).forEach(Ys=>{Je.includes(Ys.name.toLowerCase())||pt.removeAttribute(Ys.name)}):pt.replaceWith(document.createTextNode(pt.textContent||""))}return Ct.body.innerHTML},du=()=>{if(!t.length||n>=t.length)return[];const be=t[n],ze=String(be.id||"");return ze?v.filter(Je=>{var Ct;return String(((Ct=Je.matter)==null?void 0:Ct.id)||Je.case_id||"")===ze}):[]},fu=be=>{const ze=String(be.start_at||be.date||"");if(!ze)return!1;try{return new Date(ze)>=new Date}catch{return!1}},rc=()=>{const ze=du().filter(fu).sort((Je,At)=>{const Ct=new Date(String(Je.start_at||Je.date||"")),zt=new Date(String(At.start_at||At.date||""));return Ct.getTime()-zt.getTime()});return ze.length>0?[ze[0]]:ze},ol=()=>{const be=rc(),ze=t.length>0&&n<t.length?t[n]:null,Je=ze==null?void 0:ze.id,At=Je?`https://app.clio.com/nc/#/matters/${Je}/calendar`:null;return u.jsxs("div",{className:"border-t bg-card",children:[u.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800",children:[u.jsxs("div",{className:"flex items-center gap-2 cursor-pointer flex-1 hover:opacity-80 transition-opacity",onClick:()=>ae(!ie),children:[u.jsx(Bl,{className:"w-4 h-4 text-slate-600 dark:text-gray-300"}),u.jsx("span",{className:"font-medium text-sm text-slate-800 dark:text-white",children:"Next Event"}),be.length>0&&!d&&(ie?u.jsx(sh,{className:"w-4 h-4 text-gray-400"}):u.jsx(ls,{className:"w-4 h-4 text-gray-400"}))]}),At&&u.jsxs("a",{href:At,target:"_blank",rel:"noopener noreferrer",className:"h-7 text-xs text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 border border-blue-200 dark:border-blue-800 px-2 flex-shrink-0 rounded-md inline-flex items-center gap-1 no-underline hover:no-underline",onClick:Ct=>Ct.stopPropagation(),children:[u.jsx(Wa,{className:"w-3 h-3"}),"View all"]})]}),!ie&&u.jsx(u.Fragment,{children:d?u.jsx(cs,{rows:2}):be.length>0?u.jsx("div",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:be.map((Ct,zt)=>{const at=String(Ct.start_at||Ct.date||""),pt=String(Ct.end_at||""),Qn=String(Ct.summary||Ct.title||"Calendar Event"),Ys=String(Ct.location||"");return u.jsxs("div",{className:"p-3 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:[u.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-gray-100 mb-1",children:Qn}),u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"space-y-1",children:[u.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600 dark:text-gray-400",children:[u.jsx(Bl,{className:"w-3 h-3"}),u.jsx("span",{children:Ks(at)})]}),Ys&&u.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600 dark:text-gray-400",children:[u.jsx(hB,{className:"w-3 h-3"}),u.jsx("span",{children:Ys})]})]}),u.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600 dark:text-gray-400",children:[u.jsx(Qf,{className:"w-3 h-3"}),u.jsxs("span",{children:[sl(at),pt&&` - ${sl(pt)}`]})]})]})]},zt)})}):u.jsx("div",{className:"p-3 text-sm text-gray-600 dark:text-gray-400",children:r&&t.length>0?u.jsx(u.Fragment,{children:u.jsx("p",{className:"mb-2",children:"No upcoming calendar entries found for this case"})}):"Select a client email thread to view calendar entries"})})]})},ui=()=>{const be=t.length>0&&n<t.length?t[n]:null,ze=be==null?void 0:be.last_completed_task,Je=be==null?void 0:be.next_upcoming_task,At=ze||Je,Ct=be==null?void 0:be.id,zt=Ct?`https://app.clio.com/nc/#/matters/${Ct}/tasks`:null;return u.jsxs("div",{className:"border-t bg-card",children:[u.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800",children:[u.jsxs("div",{className:"flex items-center gap-2 cursor-pointer flex-1 hover:opacity-80 transition-opacity",onClick:()=>J(!de),children:[u.jsx(ZA,{className:"w-4 h-4 text-slate-600 dark:text-gray-300"}),u.jsx("span",{className:"font-medium text-sm text-slate-800 dark:text-white",children:"Tasks"}),(At||jt)&&!d&&(de?u.jsx(sh,{className:"w-4 h-4 text-gray-400"}):u.jsx(ls,{className:"w-4 h-4 text-gray-400"}))]}),u.jsxs("div",{className:"flex items-center gap-2",children:[S&&(jt?u.jsxs(Ye,{variant:"ghost",size:"sm",className:"h-7 text-xs text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 px-2",onClick:at=>{at.stopPropagation(),ut(!1),qs()},children:[u.jsx(NC,{className:"w-3 h-3 mr-1"}),"Remove"]}):u.jsxs(Ye,{variant:"ghost",size:"sm",className:"h-7 text-xs text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 px-2",onClick:at=>{at.stopPropagation(),ut(!0)},children:[u.jsx(TC,{className:"w-3 h-3 mr-1"}),"Add Task"]})),zt&&u.jsxs("a",{href:zt,target:"_blank",rel:"noopener noreferrer",className:"h-7 text-xs text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 border border-blue-200 dark:border-blue-800 px-2 flex-shrink-0 rounded-md inline-flex items-center gap-1 no-underline hover:no-underline",onClick:at=>at.stopPropagation(),children:[u.jsx(Wa,{className:"w-3 h-3"}),"View all"]})]})]}),!de&&u.jsxs(u.Fragment,{children:[jt&&u.jsx("div",{className:"p-3 border-b border-gray-200 dark:border-gray-700 bg-gray-50/50 dark:bg-gray-800/50",children:u.jsxs("div",{className:"space-y-3",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Task Name"}),u.jsx(pn,{disabled:We,placeholder:We?"Generating task name...":"Enter task name...",value:Jt,onChange:at=>Or(at.target.value),className:"h-8 text-sm"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Task Description"}),u.jsx("textarea",{placeholder:We?"Generating task description...":"Enter task description...",value:jr,onChange:at=>Nr(at.target.value),disabled:We,className:`w-full min-h-[80px] px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 resize-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${We?"opacity-60 cursor-not-allowed":""}`}),We&&u.jsxs("div",{className:"flex items-center gap-2 mt-1 text-xs text-gray-500 dark:text-gray-400",children:[u.jsx("div",{className:"w-3 h-3 border-2 border-gray-300 border-t-blue-600 rounded-full animate-spin"}),"Generating task from email..."]})]}),u.jsxs("div",{className:"flex gap-3",children:[u.jsxs("div",{className:"flex-1",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Due At"}),u.jsx(pn,{type:"date",value:me,onChange:at=>je(at.target.value),className:"h-8 text-sm"})]}),u.jsxs("div",{className:"flex-1",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Priority"}),u.jsxs(ti,{open:kt,onOpenChange:Ft,children:[u.jsx(ri,{asChild:!0,children:u.jsxs(Ye,{variant:"outline",className:"w-full h-8 text-sm justify-between font-normal",children:[u.jsx("span",{children:ht}),u.jsx(ls,{className:"w-3 h-3 ml-2 flex-shrink-0"})]})}),u.jsx(Po,{align:"start",className:"w-[140px]",children:["High","Normal","Low"].map(at=>u.jsx(Bs,{className:`cursor-pointer ${ht===at?"bg-gray-100 dark:bg-gray-700":""}`,onClick:()=>{wt(at),Ft(!1)},children:at},at))})]})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Assign To"}),u.jsxs(ti,{open:Li,onOpenChange:ln,children:[u.jsx(ri,{asChild:!0,children:u.jsxs(Ye,{variant:"outline",className:"w-full h-8 text-sm justify-between font-normal",children:[u.jsx("span",{className:"truncate",children:Tt||"Select assignee"}),u.jsx(ls,{className:"w-3 h-3 ml-2 flex-shrink-0"})]})}),u.jsxs(Po,{align:"start",className:"w-[320px] p-0",children:[u.jsxs("div",{className:"p-3 border-b border-gray-200 dark:border-gray-700",children:[u.jsx("div",{className:"text-sm font-medium mb-2 text-gray-800 dark:text-gray-200",children:"Search Users"}),u.jsxs("div",{className:"relative",children:[u.jsx(Ii,{className:"absolute left-2 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),u.jsx(pn,{placeholder:"Search by name...",value:gn,onChange:at=>{const pt=at.target.value;po(pt),kh(pt)},className:"pl-8 pr-8 h-9 text-sm",autoFocus:!0,onClick:at=>at.stopPropagation(),onKeyDown:at=>at.stopPropagation()}),gn&&u.jsx("button",{onClick:at=>{at.stopPropagation(),po(""),Sn([]),Pn(null)},className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:u.jsx(aa,{className:"w-4 h-4"})})]})]}),u.jsx("div",{className:"max-h-[300px] overflow-y-auto",children:Gs?u.jsxs("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 flex items-center gap-2",children:[u.jsx("div",{className:"w-4 h-4 border-2 border-gray-300 border-t-gray-600 rounded-full animate-spin"}),"Searching..."]}):zn&&Do.length===0?u.jsx("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:zn}):Do.length>0?Do.map(at=>u.jsx(Bs,{className:"flex flex-col items-start p-3 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-800",onClick:()=>{tt(at.id),dt(at.name),ln(!1),po(""),Sn([])},children:u.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-gray-100",children:at.name})},at.id)):gn.trim().length>=2&&!Gs?u.jsxs("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:['No users found for "',gn,'"']}):u.jsx("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:Tt?u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Currently assigned to: ",Tt]}),u.jsx("div",{className:"text-xs",children:"Type at least 2 characters to search for other users..."})]}):"Type at least 2 characters to search users..."})})]})]})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("input",{type:"checkbox",id:"hasReminder",checked:ot,onChange:at=>Vt(at.target.checked),className:"cursor-pointer"}),u.jsx("label",{htmlFor:"hasReminder",className:"text-xs font-medium text-gray-700 dark:text-gray-300 cursor-pointer",children:"Add Reminder"})]}),ot&&u.jsxs("div",{className:"pl-5 space-y-2 border-l-2 border-gray-200 dark:border-gray-600",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Remind"}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx(pn,{type:"number",min:"1",value:_t,onChange:at=>Qt(Math.max(1,parseInt(at.target.value)||1)),className:"h-8 text-sm w-20"}),u.jsxs(ti,{open:De,onOpenChange:Qe,children:[u.jsx(ri,{asChild:!0,children:u.jsxs(Ye,{variant:"outline",className:"flex-1 h-8 text-sm justify-between font-normal",children:[u.jsx("span",{children:En}),u.jsx(ls,{className:"w-3 h-3 ml-2 flex-shrink-0"})]})}),u.jsx(Po,{align:"start",className:"w-[140px]",children:["Minutes","Hours","Days","Weeks"].map(at=>u.jsx(Bs,{className:`cursor-pointer ${En===at?"bg-gray-100 dark:bg-gray-700":""}`,onClick:()=>{Be(at),Qe(!1)},children:at},at))})]})]}),u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"before due date"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Delivery Method"}),u.jsx("div",{className:"w-full h-8 px-3 text-sm flex items-center border border-input rounded-md bg-gray-50 dark:bg-gray-800 text-gray-700 dark:text-gray-300",children:"Email"})]})]})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("input",{type:"checkbox",id:"appendEmailToDescription",checked:Un,onChange:at=>Oo(at.target.checked),className:"cursor-pointer"}),u.jsx("label",{htmlFor:"appendEmailToDescription",className:"text-xs text-gray-700 dark:text-gray-300 cursor-pointer",children:"Append email to Description"})]}),!ds&&u.jsxs("div",{className:"space-y-2 pt-2 border-t border-gray-200 dark:border-gray-700",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("input",{type:"checkbox",id:"notifyAssignee",checked:Tr,onChange:at=>Xt(at.target.checked),className:"cursor-pointer"}),u.jsx("label",{htmlFor:"notifyAssignee",className:"text-xs text-gray-700 dark:text-gray-300 cursor-pointer",children:"Notify assignee when task is assigned"})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("input",{type:"checkbox",id:"notifyCompletion",checked:Br,onChange:at=>cn(at.target.checked),className:"cursor-pointer"}),u.jsx("label",{htmlFor:"notifyCompletion",className:"text-xs text-gray-700 dark:text-gray-300 cursor-pointer",children:"Notify me when task is completed"})]})]}),u.jsx(Ye,{onClick:ec,disabled:lt,className:"w-full h-8 text-sm",children:lt?"Creating task in Clio...":"Create Task"})]})}),lr&&u.jsx("div",{className:`p-2 rounded-md text-sm ${lr.type==="success"?"bg-green-50 dark:bg-green-900/20 text-green-700 dark:text-green-400 border border-green-200 dark:border-green-800":"bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-400 border border-red-200 dark:border-red-800"}`,children:lr.text}),Zt&&u.jsx("div",{className:"p-3 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:u.jsxs("div",{className:"flex items-start gap-2 mb-2",children:[u.jsx(Qf,{className:"w-4 h-4 text-blue-600 dark:text-blue-400 mt-0.5 flex-shrink-0"}),u.jsxs("div",{className:"flex-1",children:[u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 font-medium mb-1",children:"Newly Created Task"}),u.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-gray-100 mb-1",children:String(Zt.name||"Untitled Task")}),u.jsxs("div",{className:"space-y-1",children:[!!Zt.due_at&&u.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600 dark:text-gray-400",children:[u.jsx(Bl,{className:"w-3 h-3"}),u.jsxs("span",{children:["Due: ",Ks(String(Zt.due_at))]})]}),!!Zt.priority&&u.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600 dark:text-gray-400",children:[u.jsx("span",{className:"font-medium",children:"Priority:"}),u.jsx("span",{children:String(Zt.priority)})]})]})]})]})}),d?u.jsx(cs,{rows:2}):At?u.jsxs("div",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:[ze&&u.jsx("div",{className:"p-3 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:u.jsxs("div",{className:"flex items-start gap-2 mb-2",children:[u.jsx(Jc,{className:"w-4 h-4 text-green-600 dark:text-green-400 mt-0.5 flex-shrink-0"}),u.jsxs("div",{className:"flex-1",children:[u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 font-medium mb-1",children:"Last Completed Task"}),u.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-gray-100 mb-1",children:String(ze.name||"Untitled Task")}),!!ze.completed_at&&u.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600 dark:text-gray-400",children:[u.jsx(Bl,{className:"w-3 h-3"}),u.jsxs("span",{children:["Completed: ",Ks(String(ze.completed_at))]})]})]})]})}),Je&&u.jsx("div",{className:"p-3 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:u.jsxs("div",{className:"flex items-start gap-2 mb-2",children:[u.jsx(Qf,{className:"w-4 h-4 text-blue-600 dark:text-blue-400 mt-0.5 flex-shrink-0"}),u.jsxs("div",{className:"flex-1",children:[u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 font-medium mb-1",children:"Next Upcoming Task"}),u.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-gray-100 mb-1",children:String(Je.name||"Untitled Task")}),u.jsxs("div",{className:"space-y-1",children:[!!Je.due_at&&u.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600 dark:text-gray-400",children:[u.jsx(Bl,{className:"w-3 h-3"}),u.jsxs("span",{children:["Due: ",Ks(String(Je.due_at))]})]}),!!Je.priority&&u.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600 dark:text-gray-400",children:[u.jsx("span",{className:"font-medium",children:"Priority:"}),u.jsx("span",{children:ny.capitalize(String(Je.priority))})]})]})]})]})})]}):!jt&&!Zt?u.jsx("div",{className:"p-3 text-sm text-gray-600 dark:text-gray-400",children:r&&t.length>0?u.jsx(u.Fragment,{children:u.jsx("p",{className:"mb-2",children:"No tasks found for this matter"})}):"Select a client email thread to view tasks"}):null]})]})},di=()=>{const be=t.length>0&&n<t.length?t[n]:null,ze=be==null?void 0:be.most_recent_note,Je=ze&&ze.detail,At=be==null?void 0:be.id,Ct=At?`https://app.clio.com/nc/#/matters/${At}/notes`:null;return u.jsxs("div",{className:"border-t bg-card",children:[u.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800",children:[u.jsxs("div",{className:"flex items-center gap-2 cursor-pointer flex-1 hover:opacity-80 transition-opacity",onClick:()=>$(!Y),children:[u.jsx(Xc,{className:"w-4 h-4 text-slate-600 dark:text-gray-300"}),u.jsx("span",{className:"font-medium text-sm text-slate-800 dark:text-white",children:"Latest Note"}),!!Je&&!d&&u.jsx(u.Fragment,{children:Y?u.jsx(sh,{className:"w-4 h-4 text-gray-400"}):u.jsx(ls,{className:"w-4 h-4 text-gray-400"})})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[At&&(Mi?u.jsxs(Ye,{variant:"ghost",size:"sm",className:"h-7 text-xs text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 px-2",onClick:zt=>{zt.stopPropagation(),Gr(!1),lu()},children:[u.jsx(NC,{className:"w-3 h-3 mr-1"}),"Remove"]}):u.jsxs(Ye,{variant:"ghost",size:"sm",className:"h-7 text-xs text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 px-2",onClick:zt=>{zt.stopPropagation(),Gr(!0)},children:[u.jsx(TC,{className:"w-3 h-3 mr-1"}),"Add Note"]})),Ct&&u.jsxs("a",{href:Ct,target:"_blank",rel:"noopener noreferrer",className:"h-7 text-xs text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 border border-blue-200 dark:border-blue-800 px-2 flex-shrink-0 rounded-md inline-flex items-center gap-1 no-underline hover:no-underline",onClick:zt=>zt.stopPropagation(),children:[u.jsx(Wa,{className:"w-3 h-3"}),"View all"]})]})]}),Mi&&u.jsx("div",{className:"bg-gray-50/50 dark:bg-gray-800/30 p-3 border-b border-gray-200 dark:border-gray-700",children:u.jsxs("div",{className:"space-y-3",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Subject"}),u.jsx(pn,{type:"text",value:Lo,onChange:zt=>Xn(zt.target.value),placeholder:"Enter note subject...",className:"h-9 text-sm"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Note"}),u.jsx("textarea",{value:ou,onChange:zt=>Ns(zt.target.value),placeholder:"Enter note details...",className:"w-full min-h-[80px] px-3 py-2 text-sm border rounded-md resize-y dark:bg-gray-800 dark:border-gray-600 dark:text-gray-100",rows:3})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Date"}),u.jsx(pn,{type:"date",value:pa,onChange:zt=>iu(zt.target.value),className:"h-9 text-sm"})]}),u.jsx(Ye,{onClick:cu,disabled:au,className:"w-full h-9",children:au?"Creating note in Clio...":"Create Note"})]})}),ci&&u.jsx("div",{className:`p-2 rounded-md text-sm ${ci.type==="success"?"bg-green-50 dark:bg-green-900/20 text-green-700 dark:text-green-400 border border-green-200 dark:border-green-800":"bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-400 border border-red-200 dark:border-red-800"}`,children:ci.text}),!Y&&u.jsx(u.Fragment,{children:d?u.jsx(cs,{rows:1}):Je?u.jsx("div",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:u.jsxs("div",{className:"p-3 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:[u.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-gray-100 mb-2",children:String(ze.subject||"Note")}),u.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600 dark:text-gray-400 mb-2",children:[u.jsx(Bl,{className:"w-3 h-3"}),u.jsx("span",{children:Ks(String(ze.created_at))}),(()=>{const zt=sl(String(ze.created_at||""));return zt?u.jsxs(u.Fragment,{children:[u.jsx("span",{children:""}),u.jsx(Qf,{className:"w-3 h-3"}),u.jsx("span",{children:zt})]}):null})()]}),u.jsx("div",{className:"text-sm text-gray-700 dark:text-gray-300",children:(()=>{const zt=String(ze.detail||""),at=tc(zt);return Q||!at?u.jsx("div",{className:"prose prose-sm max-w-none dark:prose-invert",dangerouslySetInnerHTML:{__html:uu(zt)}}):u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"line-clamp-3 prose prose-sm max-w-none dark:prose-invert",dangerouslySetInnerHTML:{__html:uu(zt)}}),u.jsx("button",{onClick:pt=>{pt.stopPropagation(),F(!0)},className:"text-blue-600 dark:text-blue-400 hover:underline mt-1 text-xs font-medium",children:"Expand"})]})})()}),Q&&u.jsx("button",{onClick:zt=>{zt.stopPropagation(),F(!1)},className:"text-blue-600 dark:text-blue-400 hover:underline mt-2 text-xs font-medium",children:"Show less"})]})}):u.jsx("div",{className:"p-3 text-sm text-gray-600 dark:text-gray-400",children:r&&t.length>0?"No notes found for this matter":"Select a client email thread to view matter notes"})})]})};return u.jsxs("div",{className:"w-full min-h-[4rem] border border-border/50 rounded-lg shadow-sm bg-card text-card-foreground",title:"Matters and Calendar Information",children:[u.jsxs("div",{className:"flex items-center justify-between p-2 border-b bg-muted",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(QA,{className:"w-3.5 h-3.5 text-slate-600 dark:text-gray-300"}),u.jsx("span",{className:"font-medium text-sm text-slate-800 dark:text-white",children:"MATTERS"})]}),u.jsxs(ti,{open:Ge,onOpenChange:Ee,children:[u.jsx(ri,{asChild:!0,children:u.jsx(Ye,{variant:"ghost",size:"icon",className:"h-8 w-8 hidden",title:"Search all matters",children:u.jsx(Ii,{className:"h-4 w-4"})})}),u.jsxs(Po,{align:"end",className:"w-[320px] p-0",children:[u.jsxs("div",{className:"p-3 border-b border-gray-200 dark:border-gray-700",children:[u.jsx("div",{className:"text-sm font-medium mb-2 text-gray-800 dark:text-gray-200",children:"Search All Matters"}),u.jsxs("div",{className:"relative",children:[u.jsx(Ii,{className:"absolute left-2 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),u.jsx(pn,{placeholder:"Search by matter or client name...",value:X,onChange:be=>{const ze=be.target.value;we(ze),rl(ze)},className:"pl-8 pr-8 h-9 text-sm",autoFocus:!0,onClick:be=>be.stopPropagation(),onKeyDown:be=>be.stopPropagation()}),X&&u.jsx("button",{onClick:be=>{be.stopPropagation(),we(""),Me([]),Ke(null)},className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:u.jsx(aa,{className:"w-4 h-4"})})]})]}),u.jsx("div",{className:"max-h-[300px] overflow-y-auto",children:St?u.jsxs("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 flex items-center gap-2",children:[u.jsx("div",{className:"w-4 h-4 border-2 border-gray-300 border-t-gray-600 rounded-full animate-spin"}),"Searching..."]}):ye&&Ne.length===0?u.jsx("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:ye}):Ne.length>0?Ne.map(be=>u.jsxs(Bs,{className:"flex flex-col items-start p-3 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-800",onClick:()=>yd(be),children:[u.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-gray-100",children:be.projectName}),u.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5",children:[be.phaseName,"  Client: ",be.clientName]})]},be.projectId.native)):X.trim()&&!St?u.jsxs("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:['No matters found for "',X,'"']}):u.jsx("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:"Type at least 2 characters to search matters..."})})]})]})]}),d?nl():E?u.jsxs("div",{className:"flex items-center gap-1.5 px-3 py-2 text-xs text-amber-700 dark:text-amber-400",children:[u.jsx(oh,{className:"h-3.5 w-3.5 flex-shrink-0"}),u.jsx("span",{children:T?"Failed to refresh. Please try again later.":"Failed to fetch matter data. Please try again later."})]}):e&&Object.keys(e).length>0?u.jsxs(u.Fragment,{children:[T&&u.jsxs("div",{className:"flex items-center gap-1.5 px-3 py-2 text-xs text-amber-700 dark:text-amber-400",children:[u.jsx(oh,{className:"h-3.5 w-3.5 flex-shrink-0"}),u.jsx("span",{children:"Failed to refresh. Try again later."})]}),t.length>0&&u.jsxs("div",{className:"flex items-center px-3 py-1 bg-gray-50 dark:bg-gray-800 border-b dark:border-gray-700 gap-2",children:[u.jsx("div",{className:"flex-1 min-w-0 flex items-center",children:(()=>{const be=G??t.length,ze=be>O,Je=ze?Math.ceil(be/O):1,At=(B-1)*O+1,Ct=Math.min(B*O,be),zt=(()=>{if(!H.trim())return t;const pt=H.toLowerCase();return re.length>0&&H.length>=2?re.filter(Qn=>(Qn.description||"").toLowerCase().includes(pt)):t.filter(Qn=>String(Qn.description||"").toLowerCase().includes(pt))})(),at=()=>{if(Je<=5)return Array.from({length:Je},(Qn,Ys)=>Ys+1);const pt=[];return B<=3?pt.push(1,2,3,"...",Je):B>=Je-2?pt.push(1,"...",Je-2,Je-1,Je):pt.push(1,"...",B,"...",Je),pt};return u.jsx(u.Fragment,{children:t.length>1||ze?u.jsxs(ti,{open:Se,onOpenChange:tl,children:[u.jsx(ri,{asChild:!0,children:u.jsxs(Ye,{variant:"ghost",size:"sm",className:"h-auto text-left text-gray-600 dark:text-gray-300 flex flex-col items-start gap-0 px-2 py-1 max-w-full overflow-hidden",children:[u.jsx("span",{className:"text-sm truncate font-medium w-full",title:e.Title||"",children:e.Title||"Case"}),u.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400 flex items-center gap-1",children:[mt," of ",be," matters in Clio",u.jsx(ls,{className:"w-3 h-3"})]})]})}),u.jsxs(Po,{align:"start",className:"w-[320px] p-0",children:[u.jsx("div",{className:"p-2 border-b border-gray-200 dark:border-gray-700",children:u.jsxs("div",{className:"relative",children:[u.jsx(Ii,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),u.jsx(pn,{placeholder:"Search matters...",value:H,onChange:pt=>te(pt.target.value),className:"pl-8 pr-8 h-8 text-xs",autoFocus:!0,onClick:pt=>pt.stopPropagation(),onKeyDown:pt=>pt.stopPropagation()}),H&&u.jsx("button",{onClick:pt=>{pt.stopPropagation(),te("")},className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:u.jsx(aa,{className:"w-4 h-4"})})]})}),!H.trim()&&B===1&&u.jsx("div",{className:"px-3 py-1.5 text-xs text-gray-500 dark:text-gray-400 border-b border-gray-100 dark:border-gray-700",children:"Sorted by: Last opened in Clio"}),H.trim()&&re.length>0&&H.length>=2&&u.jsxs("div",{className:"px-3 py-1.5 text-xs text-gray-500 dark:text-gray-400 border-b border-gray-100 dark:border-gray-700",children:["Searching all ",be," matters"]}),u.jsx("div",{className:"max-h-[250px] overflow-y-auto",children:zt.length>0?zt.map(pt=>{const Qn=H.length>=2&&re.length>0,Ys=t.indexOf(pt),Sr=Ys!==-1,er=String(pt.id||""),ma=qe?er===qe:Sr&&Ys===n,Ui=String(pt.description||"Case"),xd=ma?"bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400 font-medium":"";return Qn?u.jsx("button",{type:"button",className:`relative flex w-full cursor-pointer select-none items-center rounded-sm text-sm outline-none transition-colors hover:bg-neutral-100 dark:hover:bg-muted dark:text-gray-200 py-2.5 px-3 truncate text-left ${xd}`,onClick:()=>{if(N&&er){ft(er);const wd=re.findIndex(il=>il.id===er);if(wd!==-1&&K){const il=Math.floor(wd/O)+1;K(il)}N({id:er,description:String(pt.description||""),name:String(pt.name||"")},{preservePagination:!0}),ue(!1),te("")}},children:Ui},er||Ui):u.jsx(Bs,{className:`text-sm py-2.5 px-3 truncate ${xd}`,onClick:()=>{Sr?vr(Ys):N&&er&&(ft(er),ue(!1),N({id:er,description:String(pt.description||""),name:String(pt.name||"")},{preservePagination:!0}))},children:Ui},er||Ui)}):u.jsxs("div",{className:"p-3 text-xs text-center text-gray-500 dark:text-gray-400",children:["No matters match ",H,""]})}),ze&&!(H.trim()&&re.length>0&&H.length>=2)&&u.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 px-3 py-2",onPointerDown:pt=>{pt.preventDefault(),pt.stopPropagation()},onClick:pt=>pt.stopPropagation(),children:[u.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mb-2",children:["Showing ",At,"-",Ct," of ",be," matters"]}),u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("button",{onClick:()=>{ke.current=!0,K==null||K(B-1)},disabled:B<=1,className:"text-xs px-2 py-1 text-gray-600 dark:text-gray-400 border border-gray-300 dark:border-gray-600 rounded hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-40 disabled:cursor-not-allowed",children:" Newer"}),u.jsx("div",{className:"flex items-center gap-1",children:at().map((pt,Qn)=>pt==="..."?u.jsx("span",{className:"text-xs text-gray-400 px-1",children:""},`ellipsis-${Qn}`):u.jsx("button",{disabled:pt===B,className:`text-xs w-6 h-6 rounded flex items-center justify-center ${pt===B?"bg-blue-600 text-white font-medium":"text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700"} disabled:cursor-not-allowed`,onClick:()=>{typeof pt=="number"&&(ke.current=!0,K==null||K(pt))},children:pt},pt))}),u.jsx("button",{onClick:()=>{ke.current=!0,K==null||K(B+1)},disabled:B>=Je,className:"text-xs px-2 py-1 text-gray-600 dark:text-gray-400 border border-gray-300 dark:border-gray-600 rounded hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-40 disabled:cursor-not-allowed",children:"Older "})]})]})]})]}):u.jsxs("div",{className:"flex flex-col px-2 py-1 overflow-hidden",children:[u.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-300 truncate font-medium w-full",title:e.Title||"",children:e.Title||"Case"}),!m&&u.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[mt," of ",be," matters in Clio"]})]})})})()}),((Mo=s.find(be=>be.field==="Title"))==null?void 0:Mo.url)&&u.jsxs("a",{href:($i=s.find(be=>be.field==="Title"))==null?void 0:$i.url,target:"_blank",rel:"noopener noreferrer",className:"h-8 text-xs text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 border border-blue-200 dark:border-blue-800 px-3 flex-shrink-0 rounded-md inline-flex items-center gap-1 no-underline hover:no-underline",children:[u.jsx(Wa,{className:"w-3 h-3"}),"View"]})]}),Jn&&!m&&u.jsx(pw,{createdContacts:D,onMatterLinked:j}),he&&u.jsxs($S,{variant:"destructive",className:"m-2",children:[u.jsx(oh,{className:"h-4 w-4"}),u.jsx(US,{className:"ml-2",children:"Failed to load matter details. Previous details shown below."})]}),se?u.jsx(cs,{rows:5}):u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"break-words",children:u.jsx(Zl,{details:e})}),S&&u.jsx("div",{className:"border-t bg-card p-3",children:u.jsxs("a",{href:`https://app.clio.com/nc/#/matters/${S}/documents`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-sm text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 hover:underline transition-colors",children:[u.jsx(Xc,{className:"w-4 h-4 text-blue-500"}),u.jsx("span",{children:"View all documents in Clio"}),u.jsx(Wa,{className:"w-3 h-3"})]})}),di(),ol(),ui()]})]}):x?u.jsx(cs,{rows:2}):u.jsx("div",{className:"p-3 text-sm text-gray-600 dark:text-gray-400",children:r?u.jsxs(u.Fragment,{children:[u.jsx("p",{className:"mb-2",children:"Select a client email thread to view matter information"}),Jn&&!m&&u.jsx(pw,{createdContacts:D,onMatterLinked:j})]}):u.jsxs(u.Fragment,{children:[Jn&&!m&&u.jsx(pw,{createdContacts:D,onMatterLinked:j}),!Jn&&"Select a client email thread to view case information"]})})]})},ws="src/shared/hooks/useParticipantValidation.ts",Jq=0,mw=1,pN=2e3,mN=3e4;function Xq(r){const e=r.message.toLowerCase();return e.includes("client not found")||e.includes("404")||e.includes("not found")}function Qq(r){const e=r.message.toLowerCase();return e.includes("timed out")||e.includes("timeout")||e.includes("504")||e.includes("503")||e.includes("429")||e.includes("network")||e.includes("failed to fetch")}function Zq({emailParticipants:r,getClientDetailsForEmail:e,clientDataCache:t,isValidClientData:n,onClientDataValidated:s,refreshTrigger:i,onTransientError:c,isRateLimitedData:d,onValidationComplete:m}){const p=Jr(),v=w.useRef(null),x=w.useRef(new Set),b=w.useCallback(async(A,I,D=!1)=>{var he,U;if(I.aborted)return;const j=A.toLowerCase();if(x.current.has(j)){p.debug("Skipping duplicate in-flight validation",{sourceFile:ws,email:A});return}const O=(he=t.current)==null?void 0:he[A];if(O&&typeof O=="object"&&"pagination"in O&&O.pagination!=null){const ge=n(O);s(A,ge),p.debug("Participant validated from L1 cache (skipped API call)",{sourceFile:ws,email:A,hasValidData:ge});return}const B=await zm(A,p);if(B&&"pagination"in B&&B.pagination!=null){t.current&&(t.current[A]=B);const ge=n(B);s(A,ge),p.debug("Participant validated from L2 cache (skipped API call)",{sourceFile:ws,email:A,hasValidData:ge});return}x.current.add(j);let G,K,re=!1;const se=e(A,D);try{if(await Promise.race([se,new Promise((ae,de)=>{G=setTimeout(()=>{re=!0,de(new Error(`Request timed out after ${mN}ms`))},mN),K=()=>{clearTimeout(G),de(new DOMException("Aborted","AbortError"))},I.addEventListener("abort",K,{once:!0})})]),I.aborted)return;const ge=(U=t.current)==null?void 0:U[A],ie=ge?n(ge):!1;!ie&&ge&&(d!=null&&d(ge))?(p.warn("Participant rate-limited during validation  treating as transient, not invalid",{sourceFile:ws,email:A}),s(A,!1),c==null||c(A,new Error("Rate limited  please try again shortly"))):s(A,ie),p.debug("Participant validation result",{sourceFile:ws,email:A,hasValidData:ie})}catch(ge){if(I.aborted)return;ge instanceof Error?Xq(ge)?(p.debug("Participant not found in system",{sourceFile:ws,email:A,error:ge.message}),s(A,!1)):Qq(ge)?(p.warn("Participant validation timed out or network error - marking as pending",{sourceFile:ws,email:A,error:ge.message}),s(A,!1),c==null||c(A,ge),re&&se.then(()=>{var de;if(I.aborted)return;const ie=(de=t.current)==null?void 0:de[A];(ie?n(ie):!1)&&(p.info("Request succeeded after timeout - updating validation",{sourceFile:ws,email:A}),console.log(` [Late Success] Data loaded after timeout for ${A}`),s(A,!0))}).catch(ie=>{I.aborted||p.debug("Request failed after timeout",{sourceFile:ws,email:A,error:ie instanceof Error?ie.message:String(ie)})})):(p.error("Participant validation failed with unexpected error",ge,{sourceFile:ws,email:A}),s(A,!1)):(p.error("Participant validation failed with non-Error",new Error(String(ge)),{sourceFile:ws,email:A}),s(A,!1))}finally{G!==void 0&&clearTimeout(G),K&&I.removeEventListener("abort",K),x.current.delete(j)}},[e,t,n,s,c,d,p]),S=w.useCallback(async(A,I,D=!1)=>{await Promise.all(A.map(j=>b(j,I,D)))},[b]),N=(A,I)=>new Promise((D,j)=>{if(I.aborted)return j(new DOMException("Aborted","AbortError"));const O=()=>{clearTimeout(B),j(new DOMException("Aborted","AbortError"))},B=setTimeout(()=>{I.removeEventListener("abort",O),D()},A);I.addEventListener("abort",O,{once:!0})}),E=w.useMemo(()=>[...r].sort().join(","),[r]),T=w.useRef(Jq);w.useEffect(()=>{var B;if(r.length===0)return;(B=v.current)==null||B.abort();const A=new AbortController;v.current=A;const I=x.current,D=i>T.current,j=t.current;return D&&j&&(Object.keys(j).forEach(G=>{delete j[G]}),vT(p),H5(),I.clear(),p.debug("Cleared all cache tiers for refresh",{sourceFile:ws,refreshTrigger:i})),T.current=i,(async()=>{const{signal:G}=A;p.info("Validating all email participants (rate-limited)",{sourceFile:ws,participantCount:r.length,batchSize:mw,batchDelayMs:pN});const K=[];for(let re=0;re<r.length;re+=mw)K.push(r.slice(re,re+mw));for(let re=0;re<K.length;re++){if(G.aborted){p.debug("Validation aborted",{sourceFile:ws});return}const se=K[re];if(p.debug("Processing validation batch",{sourceFile:ws,batchIndex:re+1,totalBatches:K.length,batchEmails:se}),await S(se,G,D),re<K.length-1&&!G.aborted)try{await N(pN,G)}catch(he){if(he instanceof DOMException&&he.name==="AbortError"){p.debug("Validation delay aborted",{sourceFile:ws});return}throw he}}p.info("Completed validating all participants",{sourceFile:ws,participantCount:r.length}),m==null||m()})(),()=>{A.abort(),I.clear()}},[E,S,p,i,t,m])}const uj=w.createContext(void 0),eK=({children:r})=>{const[e,t]=w.useState(0),[n,s]=w.useState(!1),i=w.useRef(null),[c,d]=w.useState(!0),m=w.useRef(new Map),p=Xa(),v=async A=>{try{return await p.getLocalItem(`elapsedTime_${A}`)??0}catch(I){return console.warn("Failed to read from storage, using in-memory storage:",I),m.current.get(A)??0}},x=async(A,I)=>{try{await p.setLocalItem(`elapsedTime_${A}`,I)}catch(D){console.warn("Failed to write to storage, using in-memory storage:",D),m.current.set(A,I)}},b=()=>{i.current!==null&&(window.clearInterval(i.current),i.current=null)},S=async A=>{!n&&c&&(s(!0),b(),v(A).then(I=>{t(I)}),i.current=window.setInterval(()=>{t(I=>{const D=I+1;return x(A,D),D})},1e3))},N=async A=>{if(n){s(!1),b();const I=await v(A);x(A,I)}},E=A=>{x(A,0),t(0)},T=async A=>await v(A);return w.useEffect(()=>()=>{b()},[]),u.jsx(uj.Provider,{value:{elapsedTime:e,isTimerRunning:n,startTimer:S,stopTimer:N,resetTimer:E,getElapsedTimeForThread:T,setShouldStartTimer:d,setElapsedTime:t},children:r})},tK=()=>{const r=w.useContext(uj);if(!r)throw new Error("useTimer must be used within a TimerProvider");return r},cm=r=>{const e=Math.floor(r/3600),t=Math.floor(r%3600/60),n=r%60,s=i=>String(i).padStart(2,"0");return`${s(e)}:${s(t)}:${s(n)}`},rK=({userData:r,clientEmail:e,currentCaseIndex:t,casesForCurrentClient:n,archiveEmailEnabled:s})=>{const i=Jr(),{elapsedTime:c,isTimerRunning:d,startTimer:m,stopTimer:p,resetTimer:v,setShouldStartTimer:x,setElapsedTime:b}=tK(),S=Qa(),{platform:N}=mn(),[E,T]=w.useState(n[0]||null),[A,I]=w.useState(!1),[D,j]=w.useState(!1),O=br.useRef(null),B=br.useRef(void 0),[G,K]=w.useState(n||[]),[re,se]=w.useState(new Date().toISOString().slice(0,10)),[he,U]=w.useState(cm(c)),[ge,ie]=w.useState(""),[ae,de]=w.useState(!1),[J,Y]=w.useState((r==null?void 0:r.rate)||null),[$,Q]=w.useState(!1),[F,H]=w.useState(!1),[te,Se]=w.useState(!1),[ue,ke]=w.useState("Failed to save time entry. Please try again."),[X,we]=w.useState(!1),[Ne,Me]=w.useState(!1),St=w.useRef(c);w.useEffect(()=>{St.current=c},[c]);const Te=w.useCallback(async(Ee,ye,Ke)=>{const qe=ge.trim().replace(/[<>]/g,"").substring(0,5e3),ft=Ke??St.current,mt=N==="outlook"?"outlook":"gmail";await a8(e,"clio",Ee,ye,E==null?void 0:E.id,A,ft,qe,A?F:null,A&&F?!te:null,A?re:null,A?J:null,mt,i)},[e,ge,E,A,F,te,re,J,N,i]);w.useEffect(()=>{d&&U(cm(c))},[c,d]),w.useEffect(()=>{var Ee,ye,Ke,qe;(qe=(Ke=(ye=(Ee=E==null?void 0:E.raw_data)==null?void 0:Ee.custom_rate)==null?void 0:ye.rates)==null?void 0:Ke[0])!=null&&qe.rate?Y(E.raw_data.custom_rate.rates[0].rate):Y((r==null?void 0:r.rate)||0)},[E,r]),w.useEffect(()=>{if(!A)return;(async()=>{const ye=await(S==null?void 0:S.getCurrentThread()),Ke=(ye==null?void 0:ye.threadId)||null;if(Ke){de(!0);try{if(N==="outlook"){const mt=((ye==null?void 0:ye.messages)||[]).slice(-3).map((ut,Jt)=>`Email ${Jt} Subject: ${ut.subject||""}
Email ${Jt} Body: ${ut.body||""}

`).join(""),jt=await _k(Ke,mt,i);ie(jt.description)}else{const qe=await _k(Ke,null,i);ie(qe.description)}}catch(qe){i.error("Error generating email description summary",qe,{sourceFile:"InsightsTimer.tsx"})}finally{de(!1)}}})()},[A]);const Ge=async()=>{if(we(!0),!re||!/^\d{4}-\d{2}-\d{2}$/.test(re)||Number.isNaN(Date.parse(re))){we(!1),Me(!0),ke("Please select a valid date (YYYY-MM-DD).");return}if(O.current===null){we(!1),Me(!0),ke("Unable to retrieve email details. Please try again.");return}if(!(E!=null&&E.id)){we(!1),Me(!0),ke("Please select a matter.");return}let ye=c;if(A){const Ke=/^(\d{1,2}):([0-5]\d):([0-5]\d)$/,qe=he.trim().match(Ke);if(!qe){we(!1),Me(!0),ke("Please enter a valid duration in HH:MM:SS format.");return}const[,ft,mt,jt]=qe;ye=Number(ft)*3600+Number(mt)*60+Number(jt)}try{if(!O.current){we(!1),Me(!0),ke("Unable to retrieve email thread information.");return}const Ke=O.current,qe=B.current;await Te(Ke,qe,ye),i.info("Time entry successfully written to server",{sourceFile:"InsightsTimer.tsx"}),s&&Ke&&l8(Ke,qe?[qe]:[],N==="outlook"?"outlook":"gmail",i).then(mt=>{mt.success?i.info("Email archived successfully",{sourceFile:"InsightsTimer.tsx"}):i.warn("Email archive failed",{sourceFile:"InsightsTimer.tsx",error:mt.error})}),ke(A?"New email log and time entry created successfully.":"New email log created successfully."),we(!1),Me(!1),j(!0),I(!1),Ke&&(await p(Ke),v(Ke))}catch(Ke){i.error("Error writing time entry to server",Ke,{sourceFile:"InsightsTimer.tsx"}),we(!1),Me(!0),ke("Something went wrong. Please try again.")}};return w.useEffect(()=>{d&&(S==null||S.getCurrentThread().then(Ee=>{O.current=(Ee==null?void 0:Ee.threadId)||null,B.current=Ee==null?void 0:Ee.messageId}))},[d,S]),w.useEffect(()=>{K(n),T(n[t]||null),j(!1)},[t,n,r]),w.useEffect(()=>{let Ee=!0;const ye=async ut=>{if(!Ee)return;const Jt=(ut==null?void 0:ut.threadId)||null;if(!Jt){O.current&&document.visibilityState==="visible"&&(await p(O.current),b(0),i.info("Thread cleared - stopping timer",{sourceFile:"InsightsTimer.tsx"})),O.current=null,B.current=void 0,I(!1);return}Jt!==O.current&&(i.info("Thread changed - starting timer",{sourceFile:"InsightsTimer.tsx",oldThreadId:O.current,newThreadId:Jt}),O.current&&await p(O.current),I(!1),O.current=Jt,B.current=ut==null?void 0:ut.messageId,x(!0),document.visibilityState==="visible"&&m(Jt))};S&&(S.onThreadChanged(ye),S.getCurrentThread().then(ut=>{ye(ut)}).catch(ut=>{i.error("Error getting initial thread",ut,{sourceFile:"InsightsTimer.tsx"})}));const Ke=async()=>{O.current&&await p(O.current)},qe=async()=>{try{if(!S)return;const ut=await S.getCurrentThread(),Jt=(ut==null?void 0:ut.threadId)||null;if(!Jt||d&&O.current===Jt)return;O.current=Jt,B.current=ut==null?void 0:ut.messageId,m(Jt)}catch(ut){i.error("Error starting timer on visibility/focus",ut,{sourceFile:"InsightsTimer.tsx"})}},ft=()=>{document.visibilityState==="hidden"?Ke():document.visibilityState==="visible"&&qe()},mt=()=>qe(),jt=()=>Ke();return document.addEventListener("visibilitychange",ft),window.addEventListener("focus",mt),window.addEventListener("blur",jt),document.visibilityState==="visible"&&qe(),()=>{Ee=!1,S&&S.removeThreadListener(ye),document.removeEventListener("visibilitychange",ft),window.removeEventListener("focus",mt),window.removeEventListener("blur",jt)}},[S,m,p,x,i]),w.useEffect(()=>{if(D||Ne){const Ee=setTimeout(()=>{j(!1),Me(!1)},5e3);return()=>clearTimeout(Ee)}},[D,Ne]),u.jsxs("div",{className:"flex flex-col gap-3 p-2 border rounded-md bg-blue-50 dark:bg-gray-800 border-blue-500 dark:border-gray-600 shadow-sm",children:[u.jsx("h2",{className:"text-sm font-semibold text-gray-700 dark:text-gray-200",children:"File email log"}),u.jsxs("div",{className:"flex items-center gap-1.5 overflow-hidden",children:[u.jsxs("button",{type:"button",onClick:async()=>{O.current&&(d?(x(!1),await p(O.current)):(x(!0),m(O.current)))},className:"flex items-center justify-start gap-1.5 w-[110px] h-[34px] px-2 rounded-md bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors border border-gray-200 dark:border-gray-600 overflow-hidden flex-shrink-0",children:[u.jsx("div",{className:"w-4 h-4 flex items-center justify-center flex-shrink-0",children:d?u.jsx(pB,{className:"w-4 h-4 text-green-700 dark:text-green-400"}):u.jsx(gB,{className:"w-4 h-4 text-gray-700 dark:text-gray-300"})}),u.jsx("span",{className:`text-base font-semibold ${d?"text-green-700 dark:text-green-400":"text-gray-700 dark:text-gray-300"} whitespace-nowrap w-[70px] text-center flex-shrink-0`,children:cm(c)})]}),u.jsxs("label",{className:"flex items-center gap-1 text-xs text-gray-600 dark:text-gray-400 flex-shrink min-w-0",children:[u.jsx("input",{type:"checkbox",checked:A,onChange:async Ee=>{I(Ee.target.checked),Ee.target.checked&&O.current&&(x(!1),await p(O.current))},className:"cursor-pointer flex-shrink-0"}),u.jsx("span",{className:"truncate",children:"Add time entry"})]}),u.jsx("div",{className:"min-w-0 flex-1",children:u.jsx(Ye,{disabled:X,onClick:async()=>{O.current&&(x(!1),await p(O.current),Ge())},size:"sm",className:"h-8 text-xs px-1.5 w-full flex items-center justify-center",children:u.jsx("span",{className:"truncate",children:X?"Saving...":"Save"})})})]}),u.jsx("div",{className:"min-w-0",children:u.jsx("div",{className:"flex items-center gap-2 w-full min-w-0",children:u.jsxs(ti,{children:[u.jsx(ri,{asChild:!0,children:u.jsxs(Ye,{variant:"ghost",size:"sm",className:"h-8 text-xs text-gray-600 dark:text-gray-300 flex items-center gap-1 px-2 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md w-full justify-between min-w-0",children:[u.jsx("span",{className:"truncate",title:String((E==null?void 0:E.description)||"Select a matter"),style:{maxWidth:"24ch",display:"inline-block"},children:String((E==null?void 0:E.description)||"Select a matter")}),u.jsx(ls,{className:"w-3 h-3 ml-1"})]})}),u.jsx(Po,{align:"start",className:"w-full max-h-[200px] overflow-y-auto",style:{width:"100%"},children:G.map((Ee,ye)=>u.jsx(Bs,{className:"text-xs truncate max-w-full",onClick:()=>T(Ee),title:String((Ee==null?void 0:Ee.description)||`Case ${ye+1}`),children:String((Ee==null?void 0:Ee.description)||`Case ${ye+1}`)},ye))})]})})}),A&&u.jsxs("div",{className:"flex flex-col gap-3 pt-2 border-t border-blue-200 dark:border-gray-600",children:[u.jsxs("div",{className:"flex gap-3",children:[u.jsxs("div",{className:"shrink-0",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Date"}),u.jsx("input",{type:"date",value:re,onChange:Ee=>se(Ee.target.value),className:"block border border-gray-300 dark:border-gray-600 text-gray-600 dark:text-gray-300 bg-white dark:bg-gray-800 rounded-md px-2 py-1.5 text-xs focus:ring-blue-500 focus:border-blue-500"})]}),u.jsxs("div",{className:"shrink-0",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Duration"}),u.jsx("input",{type:"text",value:he,onChange:Ee=>{const ye=Ee.target.value,Ke=/^(\d{0,2})(:\d{0,2}){0,2}$/;ye.length<=8&&/^[0-9:]*$/.test(ye)&&Ke.test(ye)&&U(ye)},onBlur:Ee=>{const ye=Ee.target.value.trim(),Ke=/^(\d{1,2}):([0-5]\d):([0-5]\d)$/;if(Ke.test(ye)){const[,qe,ft,mt]=ye.match(Ke);U(cm(Number(qe)*3600+Number(ft)*60+Number(mt)))}else U(cm(c))},style:{width:"10ch"},className:"block border border-gray-300 dark:border-gray-600 text-gray-600 dark:text-gray-300 bg-white dark:bg-gray-800 rounded-md px-2 py-1.5 text-xs focus:ring-blue-500 focus:border-blue-500","aria-label":"Duration (HH:MM:SS)"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Description"}),u.jsx("textarea",{disabled:ae,value:ae?"Generating AI description...":ge,onChange:Ee=>ie(Ee.target.value),rows:3,className:"block w-full border border-gray-300 dark:border-gray-600 text-gray-600 dark:text-gray-300 bg-white dark:bg-gray-800 rounded-md px-2 py-1.5 text-xs focus:ring-blue-500 focus:border-blue-500"})]}),u.jsx("div",{className:"bg-white dark:bg-gray-800/50 border border-gray-200 dark:border-gray-600 rounded-md p-3",children:u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-xs font-medium text-gray-900 dark:text-gray-100",children:"Billed By"}),u.jsx("p",{className:"text-xs font-medium text-gray-900 dark:text-gray-100 mt-1",children:"Rate"})]}),u.jsxs("div",{className:"text-right",children:[u.jsx("p",{className:"text-xs text-gray-700 dark:text-gray-300",children:(r==null?void 0:r.name)||"Unknown"}),u.jsxs("div",{className:"flex items-center justify-end gap-1 mt-1",children:[u.jsx("input",{value:J??0,onChange:Ee=>Y(Number(Ee.target.value)||0),onBlur:()=>Q(!1),disabled:!$,"aria-label":"Rate",style:{width:`${Math.max(String(J??0).length,1)+1}ch`},className:$?"text-xs text-right text-gray-700 dark:text-gray-300 border border-gray-200 dark:border-gray-600 rounded bg-white dark:bg-gray-800":"text-xs text-right text-gray-700 dark:text-gray-300 border border-transparent rounded bg-transparent"}),u.jsx("button",{type:"button","aria-label":"Edit rate",onClick:()=>Q(!$),className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536M4 20h4.586a1 1 0 00.707-.293l9.414-9.414a1 1 0 000-1.414L15.121 4.88a1 1 0 00-1.414 0L4 14.586V20z"})})})]})]})]})}),u.jsxs("div",{className:"bg-blue-50 dark:bg-blue-950/30 border border-blue-100 dark:border-blue-900 rounded-md p-2 flex flex-col gap-1",children:[u.jsxs("label",{className:"flex items-center gap-1.5 text-xs font-medium text-blue-600 dark:text-blue-400 cursor-pointer",children:[u.jsx("input",{type:"checkbox",checked:F,onChange:Ee=>H(Ee.target.checked),className:"cursor-pointer"}),"Non-billable"]}),F&&u.jsxs("label",{className:"flex items-center gap-1.5 text-xs font-medium text-blue-600 dark:text-blue-400 cursor-pointer",children:[u.jsx("input",{type:"checkbox",checked:te,onChange:Ee=>Se(Ee.target.checked),className:"cursor-pointer"}),"Show this entry on the bill"]})]})]}),D&&u.jsx("div",{role:"status","aria-live":"assertive",children:u.jsx("div",{className:"flex items-start border rounded-md p-2 border-green-200 dark:border-green-700 text-green-900 dark:text-green-100 bg-green-50 dark:bg-green-900",children:u.jsx("p",{className:"text-xs",children:ue})})}),Ne&&u.jsx("div",{role:"alert","aria-live":"assertive",children:u.jsx("div",{className:"flex items-start border rounded-md p-2 border-red-200 dark:border-red-700 text-red-900 dark:text-red-100 bg-red-50 dark:bg-red-900",children:u.jsx("p",{className:"text-xs",children:ue})})})]})},Kt="src/sidepanel/panels/ClioInsights.tsx",nK=({clientEmail:r,setClientEmail:e,tempClientEmail:t,setTempClientEmail:n,emailParticipants:s,emailParticipantClients:i,currentClientIndex:c,setCurrentClientIndex:d,currentCaseIndex:m,casesForCurrentClient:p,setCasesForCurrentClient:v,isManuallySet:x,setIsManuallySet:b,isProjectManuallySelected:S,setIsProjectManuallySelected:N,isValidClient:E,isTempEmailValid:T,nextCase:A,prevCase:I,handleSetCurrentCaseIndex:D,ClientNavigation:j,onClientDataValidated:O,onTransientError:B,isValidating:G,refreshTrigger:K,integrationSettings:re,hasTransientError:se,isPrefetchEnabled:he})=>{const U=Jr(),ge=Xa(),ie=Qa(),ae=w.useRef(r);ae.current=r;const de=le=>le!==ae.current,[J]=w.useState(!0),[Y,$]=w.useState({}),[Q,F]=w.useState({}),[H,te]=w.useState({}),[Se,ue]=w.useState({}),[ke,X]=w.useState([]),[we,Ne]=w.useState(!1),[Me,St]=w.useState(null),[Te,Ge]=w.useState(!1),[Ee,ye]=w.useState(null),[Ke,qe]=w.useState(!1),[ft,mt]=w.useState(!1),[jt,ut]=w.useState([]),[Jt,Or]=w.useState(!1),jr=5,[Nr,me]=w.useState(1),[je,ht]=w.useState(0),[wt,We]=w.useState(!1),[Ve,lt]=w.useState(!1),Pe=w.useRef(new Map),[kt,Ft]=w.useState([]),$e=w.useRef({}),cr=w.useCallback(le=>{const tt=typeof le=="string"?parseFloat(le):le;return isNaN(tt)?"$0.00":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(tt)},[]),Ut=w.useCallback(le=>{if(!le||!le.client_data||!Array.isArray(le.client_data)||le.client_data.length===0)return!1;const tt=le.client_data[0];return tt&&typeof tt=="object"&&Object.keys(tt).length>0},[]),lr=w.useCallback(le=>{if(U.info("selectClientDetails called",{sourceFile:Kt,hasDetails:!!le,detailsKeys:le?Object.keys(le):[]}),!le){U.warn("selectClientDetails called with undefined details",{sourceFile:Kt}),F({}),te({}),$({}),ue({});return}U.info("Client details received for formatting",{sourceFile:Kt,clientDetails:le});const tt=_t=>{const Qt=_t.replace(/\D/g,"");return Qt.length===10?`(${Qt.slice(0,3)}) ${Qt.slice(3,6)}-${Qt.slice(6)}`:_t};let Tt="";if(le.primary_phone_number)Tt=le.primary_phone_number;else if(le.phone_numbers)try{const _t=JSON.parse(le.phone_numbers);Array.isArray(_t)&&_t.length>0&&(Tt=_t[0].number||"")}catch{const _t=le.phone_numbers;Array.isArray(_t)&&_t.length>0&&(Tt=_t[0].number||"")}else le.phones&&Array.isArray(le.phones)&&(Tt=le.phones[0]||"");let dt="";if(le.primary_email_address)dt=le.primary_email_address;else if(le.email_addresses)try{const _t=JSON.parse(le.email_addresses);Array.isArray(_t)&&_t.length>0&&(dt=_t[0].address||"")}catch{const _t=le.email_addresses;Array.isArray(_t)&&_t.length>0&&(dt=_t[0].address||"")}else le.emails&&Array.isArray(le.emails)&&(dt=le.emails[0]||"");let ot="";try{let _t=[];le.addresses&&(typeof le.addresses=="string"?_t=JSON.parse(le.addresses):_t=le.addresses);const Qt=_t[0];Qt&&(ot=`${Qt.street?`${Qt.street}, `:""}${Qt.city?`${Qt.city}, `:""}${Qt.province?`${Qt.province}, `:""}${Qt.country?`${Qt.country} `:""}${Qt.postal_code?`${Qt.postal_code}`:""}`.trim())}catch{U.warn("Error formatting address",{sourceFile:Kt})}const Vt={Name:le.name||"",Email:dt||"",Phone:tt(Tt),Address:ot||""};U.info("Client details formatted and set",{sourceFile:Kt,selectedDetails:Vt,originalDetails:le}),F(le),te(Vt)},[U,cr]),Wt=w.useCallback(le=>{U.info("selectCaseDetails called",{sourceFile:Kt,hasDetails:!!le,detailsKeys:le?Object.keys(le):[]}),U.info("Case details received for formatting",{sourceFile:Kt,caseNames:le});const tt={"Matter Number":le.name||"",Title:le.description||"","Maildrop Address":le.maildrop_address||"","Practice Area":le.practice_area||"",Status:le.status||"",Stage:le.matter_stage||"","Assigned To":le.responsible_attorney||"","Rate Type":le.custom_rate||"","Outstanding Balance":cr(le.outstanding_balance||le.balance_outstanding||le.balance||0)};U.info("Case details formatted and set",{sourceFile:Kt,selectedDetails:tt,originalDetails:le}),ue(tt)},[U,cr]),Zt=w.useCallback(le=>{for(const tt of Pe.current.values()){const Tt=tt.find(dt=>String(dt.id)===le);if(Tt&&Tt.calendar_entries!==void 0)return Tt}return null},[]),_n=w.useCallback(async(le,tt)=>{U.info("Matter manually selected",{sourceFile:Kt,matterId:le.id,matterName:le.description}),tt!=null&&tt.preservePagination||(e(""),b(!0)),N(!0),tt!=null&&tt.preservePagination||(me(1),ht(1),Pe.current.clear());const Tt=Zt(le.id);if(Tt){U.info("Using cached matter data from page cache",{sourceFile:Kt,matterId:le.id});const dt={};Object.entries(Tt).forEach(([_t,Qt])=>{dt[_t]=String(Qt??"")}),$(dt),Wt(dt);const ot=String(Tt.id||le.id||""),Vt=(Tt.calendar_entries||[]).map(_t=>({..._t,case_id:ot}));X(Vt),tt!=null&&tt.preservePagination||(v([Tt]),D(0));return}We(!0),lt(!1);try{const dt=await PT("clio",le.id,U);if(dt&&Object.keys(dt).length>0){const ot=dt.case_data||dt,Vt=dt.client_data||{};U.info("Complete matter data fetched successfully",{sourceFile:Kt,matterId:le.id,hasCalendarEntries:!!ot.calendar_entries,hasLastCompletedTask:!!ot.last_completed_task,hasNextUpcomingTask:!!ot.next_upcoming_task,hasClientData:!!Vt&&Object.keys(Vt).length>0});const _t={};if(Object.entries(ot).forEach(([Be,q])=>{_t[Be]=String(q??"")}),$(_t),Wt(_t),Vt&&Object.keys(Vt).length>0){lr(Vt);let Be="";if(Vt.primary_email_address)Be=String(Vt.primary_email_address);else if(Vt.email_addresses)try{const q=JSON.parse(String(Vt.email_addresses));Array.isArray(q)&&q.length>0&&(Be=q[0].address||"")}catch{const q=Vt.email_addresses;Array.isArray(q)&&q.length>0&&(Be=q[0].address||"")}else Vt.emails&&Array.isArray(Vt.emails)&&(Be=String(Vt.emails[0]||""));Be&&n(Be)}const Qt=String(ot.id||le.id||""),En=(ot.calendar_entries||[]).map(Be=>({...Be,case_id:Qt}));X(En),tt!=null&&tt.preservePagination||(v([ot]),D(0))}else{U.warn("Failed to fetch complete matter data, using basic data",{sourceFile:Kt,matterId:le.id});const ot={};Object.entries(le).forEach(([Vt,_t])=>{ot[Vt]=String(_t??"")}),$(ot),Wt(ot),X([]),tt!=null&&tt.preservePagination||(v([le]),D(0))}}catch(dt){U.error("Error fetching complete matter data",dt,{sourceFile:Kt,matterId:le.id}),lt(!0);const ot={};Object.entries(le).forEach(([Vt,_t])=>{ot[Vt]=String(_t??"")}),$(ot),Wt(ot),X([]),tt!=null&&tt.preservePagination||(v([le]),D(0))}finally{We(!1)}},[U,e,n,b,N,v,D,Wt,lr,X,Zt]),Un=w.useCallback(async(le,tt=!1)=>{if($e.current[le]){const dt=$e.current[le];if("pagination"in dt&&dt.pagination!=null){console.log(` [Cache L1] Component cache HIT for ${le}`),U.debug("Using cached client data (component cache)",{sourceFile:Kt,email:le});return}console.log(` [Cache L1] Stale pre-pagination data for ${le}, refetching`),delete $e.current[le]}console.log(` [Cache L2] Checking browser storage for ${le}...`);const Tt=await zm(le,U);if(Tt){if("pagination"in Tt&&Tt.pagination!=null){console.log(` [Cache L2] Browser storage HIT - SALVAGED data for ${le}`),U.debug("Using cached client data (browser storage - salvaged)",{sourceFile:Kt,email:le}),$e.current[le]=Tt;return}console.log(` [Cache L2] Stale pre-pagination data for ${le}, clearing and refetching`),await jw(le,U)}console.log(` [Cache L2] Browser storage MISS for ${le}`);try{console.log(` [Cache L3] Fetching from SERVER for ${le}...`),U.debug("Fetching client data from server",{sourceFile:Kt,email:le});const dt=await ie.getCurrentThreadId(),ot=await W_("clio",le,U,tt,{limit:jr},dt);$e.current[le]=ot}catch(dt){throw dt instanceof Error&&dt.message.includes("Client not found")?U.debug("Client not found for email",{sourceFile:Kt,email:le}):U.error(`Error fetching client data for ${le}`,dt,{sourceFile:Kt}),dt}},[U,ie]),Oo=w.useCallback(async()=>{U.info("fetchUserData called",{sourceFile:Kt,clientEmail:r});try{const le=await o8(U,"clio");ye(le)}catch(le){U.error("Error processing user data",le,{sourceFile:Kt})}},[U]),Jn=w.useCallback(le=>{var _t;le.pagination?(ht(le.pagination.total_matters),le.pagination.matter_summaries&&Ft(le.pagination.matter_summaries),Pe.current.set(1,le.case_data||[])):(ht(((_t=le.case_data)==null?void 0:_t.length)??0),Ft([]));const tt=Ut(le);if(O(r,tt),!tt){U.debug("Cached client data is not valid",{sourceFile:Kt,clientEmail:r}),$({}),v([]),X([]),te({}),ue({}),F({});return}const Tt=le.client_data[0];lr(Tt);const dt=le.case_data||[];v(dt),D(0);const ot=dt.flatMap(Qt=>{const En=String(Qt.id||"");return(Qt.calendar_entries||[]).map(q=>({...q,case_id:En}))});X(ot);const Vt=dt.length>0?Object.entries(dt[0]).reduce((Qt,[En,Be])=>(Qt[En]=String(Be),Qt),{}):{};$(Vt),Wt(Vt),St(null)},[r,Ut,O,U,lr,Wt,v,D]),_r=w.useCallback(async(le=!1)=>{var dt;if(U.info("fetchClientData called",{sourceFile:Kt,clientEmail:r,hasClientEmail:!!r}),!r){U.info("fetchClientData early return",{sourceFile:Kt,reason:r?"clio not connected":"no client email",clientEmail:r});return}le&&delete $e.current[r];const tt=$e.current[r];if(!le&&tt&&"pagination"in tt&&tt.pagination!=null){U.info("fetchClientData: L1 cache hit, restoring from component cache",{sourceFile:Kt,clientEmail:r}),Jn(tt);return}const Tt=le?null:await zm(r,U);if(Tt&&"pagination"in Tt&&Tt.pagination!=null){U.info("fetchClientData: L2 cache hit, restoring from browser cache",{sourceFile:Kt,clientEmail:r}),$e.current[r]=Tt,Jn(Tt);return}Pe.current.clear(),me(1),ht(0),Ft([]),D(0);try{if(Ne(!0),St(null),le&&Ge(!1),U.info("fetchClientData: cache miss, fetching from server",{sourceFile:Kt,clientEmail:r}),!$e.current[r])try{if(await Un(r,le),de(r))return}catch(q){q instanceof Error&&q.message.includes("(cached)")?U.debug("Using cached knowledge that this client doesn't exist",{sourceFile:Kt,clientEmail:r}):q instanceof Error&&q.message.includes("Client not found")?U.debug("Client not found",{sourceFile:Kt,clientEmail:r}):(U.error("Error fetching client data",q,{sourceFile:Kt}),St("both")),$({}),v([]),X([]),te({}),ue({}),F({}),Ne(!1);return}const ot=$e.current[r];if(ot!=null&&ot.pagination?(ht(ot.pagination.total_matters),ot.pagination.matter_summaries&&Ft(ot.pagination.matter_summaries),Pe.current.set(1,ot.case_data||[])):(ht(((dt=ot==null?void 0:ot.case_data)==null?void 0:dt.length)??0),Ft([])),!ot){$({}),v([]),X([]),te({}),ue({}),F({}),Ne(!1),O(r,!1);return}const Vt=Ut(ot);if(!Vt&&ot._rate_limited){Ge(!0),St("rate_limited"),$({}),v([]),X([]),te({}),ue({}),F({}),Ne(!1);return}if(O(r,Vt),!Vt){U.debug("Client data exists but is not valid",{sourceFile:Kt,clientEmail:r}),$({}),v([]),X([]),te({}),ue({}),F({}),Ne(!1);return}if(de(r))return;const _t=ot.client_data[0];U.debug("Client data received",{sourceFile:Kt,clientDataAsRecord:_t}),lr(_t);const Qt=ot.case_data||[];v(Qt),D(0);const En=Qt.flatMap(q=>{const De=String(q.id||"");return(q.calendar_entries||[]).map(Tr=>({...Tr,case_id:De}))});X(En);const Be=Qt.length>0?Object.entries(Qt[0]).reduce((q,[De,Qe])=>(q[De]=String(Qe),q),{}):{};if($(Be),Wt(Be),ot._rate_limited){const q=ot.client_data.length>0||ot.case_data.length>0;U.info("Rate-limited response",{sourceFile:Kt,clientEmail:r,hasCachedData:q,retryAfter:ot._retry_after}),Ge(!0),q||St("rate_limited")}}catch(ot){U.error("Error processing client data",ot,{sourceFile:Kt}),St("both"),$({}),v([]),X([]),r&&O(r,!1)}finally{Ne(!1)}},[r,Un,U,lr,Wt,v,O,Ut,D,Jn]),gn=w.useCallback(le=>{if(le===Nr||le<1)return;const tt=kt.length>0?kt.length:je,Tt=Math.ceil(tt/jr);if(!(le>Tt)){if(le===1&&Pe.current.get(1))v(Pe.current.get(1));else{const dt=(le-1)*jr,Vt=kt.slice(dt,dt+jr).map(_t=>({id:_t.id,description:_t.description,display_number:_t.display_number}));v(Vt)}me(le),D(0),kt.length>0&&ht(kt.length)}},[Nr,kt,je,v,D]);w.useEffect(()=>{const le=async()=>{if(!await xT(U))try{const dt=(await jT("clio",U)).map(({id:ot,name:Vt})=>({id:ot,name:Vt}));await yT(dt,U)}catch(Tt){U.error("Error fetching firm users",Tt,{sourceFile:Kt})}};Oo(),le()},[]),w.useEffect(()=>{(async()=>{var tt,Tt,dt,ot,Vt,_t,Qt,En;if(re&&re.clio){const Be=((Tt=(tt=re==null?void 0:re.clio)==null?void 0:tt.timeTracking)==null?void 0:Tt.enabled)||!1,q=((ot=(dt=re==null?void 0:re.clio)==null?void 0:dt.emailArchiving)==null?void 0:ot.enabled)||!1;qe(Be),mt(q);return}try{const Be=await ge.getLocalItem("integrationSettings");if(Be&&Be.clio){const q=((_t=(Vt=Be==null?void 0:Be.clio)==null?void 0:Vt.timeTracking)==null?void 0:_t.enabled)||!1,De=((En=(Qt=Be==null?void 0:Be.clio)==null?void 0:Qt.emailArchiving)==null?void 0:En.enabled)||!1;qe(q),mt(De)}else qe(!1),mt(!1)}catch(Be){U.error("Failed to fetch integration settings from storage",Be,{sourceFile:Kt}),qe(!1),mt(!1)}})()},[re]),w.useEffect(()=>{K>0&&(U.info("Clearing component cache due to refresh trigger",{sourceFile:Kt,refreshTrigger:K}),$e.current={},Promise.all(s.map(le=>jw(le,U))).catch(le=>{U.error("Failed to clear L2 cache during refresh",le,{sourceFile:Kt})}),Or(!1),r&&_r(!0))},[K]),w.useEffect(()=>{Or(!1),s.length===0&&ut([])},[s]);const po=w.useCallback(()=>{U.info("All participant validations complete",{sourceFile:Kt,participantCount:s.length}),Or(!0)},[U,s.length]),Do=w.useCallback(le=>!!le._rate_limited,[]);Zq({emailParticipants:s,getClientDetailsForEmail:Un,clientDataCache:$e,isValidClientData:Ut,onClientDataValidated:O,refreshTrigger:K,onTransientError:B,onValidationComplete:po,isRateLimitedData:Do}),w.useEffect(()=>{U.info("useEffect: client email or connection changed",{sourceFile:Kt,clientEmail:r,willFetchData:!!r}),r&&(U.info("Fetching client data for email",{sourceFile:Kt,clientEmail:r,isPrefetchEnabled:he}),_r(),n(r),x&&!s.includes(r.toLowerCase())&&U.debug("Manually set email not in participants, validating separately",{sourceFile:Kt,clientEmail:r}))},[r,_r,n,x,s,U,he]),w.useEffect(()=>{!x&&(!r||s.length===0)&&(n(null),te({}),ue({}),X([]))},[r,s.length,x,n,te,ue]),w.useEffect(()=>{if(U.info("useEffect: case index changed",{sourceFile:Kt,currentCaseIndex:m,casesCount:p.length,willUpdateCaseDetails:p.length>0&&m<p.length}),p.length>0&&m<p.length){const le=p[m];U.info("Updating case details for index",{sourceFile:Kt,currentCaseIndex:m,caseData:le?Object.keys(le):null});const tt=le?Object.entries(le).reduce((Tt,[dt,ot])=>(Tt[dt]=String(ot),Tt),{}):{};$(tt),Wt(tt),U.info("Case details updated",{sourceFile:Kt,formattedCaseData:tt})}},[m,p,Wt,U]);const Sn=w.useCallback(le=>{U.info("Contacts created, storing for matter linking",{sourceFile:Kt,contactCount:le.length}),ut(le)},[U]),Gs=w.useCallback(le=>{U.info("Contact linked to matter successfully",{sourceFile:Kt})},[U]),Ws=w.useCallback(async le=>{var Tt,dt;Ne(!0);const tt={id:((dt=(Tt=le.projectId)==null?void 0:Tt.native)==null?void 0:dt.toString())||"",description:le.projectName||"",practice_area:le.projectTypeName||"",matter_stage:le.phaseName||"",status:le.isArchived?"Closed":"Open",client_name:le.clientName||"",responsible_attorney:le.firstPrimaryName||"",url:le.projectUrl||"",name:le.projectName||""};await _n(tt).then(()=>{Ne(!1)})},[_n]),Li=w.useCallback(le=>{const tt=$e.current[le]?$e.current[le]:$e.current[le.toLowerCase()];if(tt!=null&&tt.client_data&&Array.isArray(tt.client_data)&&tt.client_data.length>0){const Tt=tt.client_data[0];return String(Tt.name||"")}return null},[]),ln=(Me==="client"||Me==="both"||Me==="rate_limited")&&!we,zn=(Me==="matter"||Me==="both"||Me==="rate_limited")&&!we,Pn=(Me==="rate_limited"||Te)&&!we;return J?u.jsxs("div",{className:"relative h-full",children:[u.jsxs("div",{className:"space-y-4 overflow-y-auto h-full mt-0 pb-32",children:[u.jsx(HP,{onMatterSelected:Ws}),u.jsx(Kq,{clientEmail:r,emailParticipants:s,emailParticipantClients:i,currentClientIndex:c,setCurrentClientIndex:d,setClientEmail:e,isManuallySet:x,selectedClientDetails:H,linkableFields:[{field:"Name",url:Q.url||""}].filter(le=>le.url),isLoading:we,ClientNavigation:j,handleSectionClick:()=>{},tempClientEmail:t||"",setTempClientEmail:n,setIsManuallySet:b,isValidClient:E||!1,isTempEmailValid:T||!1,showClientDocumentsButton:!1,isValidating:G,fetchError:ln,isRateLimited:Pn,hasTransientError:se,onContactsCreated:Sn,getClientNameFromCache:Li,isClientDataValidationComplete:Jt}),u.jsx(Yq,{clientEmail:r,selectedCaseDetails:Se,casesForCurrentClient:p,currentCaseIndex:m,linkableFields:[{field:"Title",url:Y.url||""}].filter(le=>le.url),nextCase:A,prevCase:I,isLoading:we,isManuallySet:x,setCurrentCaseIndex:D,calendarEntries:ke,isValidating:G,matterId:Y.id||"",onMatterManuallySelected:_n,fetchError:zn,isRateLimited:Pn,userData:Ee,createdContacts:jt,onMatterLinked:Gs,pageSize:jr,currentPage:Nr,totalMatters:je,onNavigateToPage:gn,allMatterSummaries:kt,isLoadingMatterDetails:wt,matterDetailError:Ve})]}),Ke&&u.jsx("div",{className:"fixed bottom-5 left-4 right-4 z-10 shadow-[0_-4px_12px_rgba(0,0,0,0.1)]",children:u.jsx(rK,{userData:Ee,clientEmail:r,emailParticipantClients:i,currentCaseIndex:m,casesForCurrentClient:p,archiveEmailEnabled:ft})})]}):(U.info("ClioInsights not rendering - Clio not connected",{sourceFile:Kt,isClioConnected:J}),null)},sK=({clientEmail:r,emailParticipants:e,emailParticipantClients:t,currentClientIndex:n,setCurrentClientIndex:s,setClientEmail:i,isManuallySet:c,selectedClientDetails:d,isLoading:m,ClientNavigation:p,handleSectionClick:v,tempClientEmail:x,setTempClientEmail:b,setIsManuallySet:S,isValidClient:N,isTempEmailValid:E,isValidating:T})=>{const A=()=>u.jsx(cs,{rows:2});return u.jsxs("div",{className:"w-full min-h-[4rem] border border-border/50 rounded-lg shadow-sm bg-card text-card-foreground",title:"Client Information",children:[u.jsxs("div",{className:"flex items-center justify-between p-2 border-b bg-muted",children:[u.jsx("div",{className:"flex items-center gap-2",children:u.jsx("a",{href:"https://global.inszoom.com/CorpAttorney/aty_dashboard.aspx?phn_msg=False&QLogin=Y",target:"_blank",rel:"noopener noreferrer",className:"font-medium text-sm ml-2 hover:opacity-80 text-blue-700 dark:text-blue-400 underline underline-offset-4 decoration-blue-700 dark:decoration-blue-400 transition-opacity cursor-pointer",children:"CLIENT"})}),u.jsxs(ti,{children:[u.jsx(ri,{asChild:!0,children:u.jsx(Ye,{variant:"ghost",size:"icon",className:"h-6 w-6",children:u.jsx(Ii,{className:"h-4 w-4"})})}),u.jsx(Po,{align:"end",className:"p-2",children:u.jsx("div",{className:"flex flex-col gap-2 w-64",children:u.jsxs("div",{className:"flex gap-2 items-center",children:[u.jsx(pn,{type:"email",value:x||"",onChange:I=>b(I.target.value),placeholder:"Set client email",className:`flex-1 px-2 py-1 h-8 text-xs ${E===!1?"border-red-300 focus:ring-red-500":""}`}),u.jsx(Ye,{variant:"outline",size:"sm",className:`h-8 text-xs px-2 ${E===!1?"bg-red-50 hover:bg-red-100":""}`,onClick:()=>{i(x||"",!0)},disabled:!x,title:E===!1?"Warning: This email is not recognized as a valid client in INSZoom":"Set email as current client",children:"Search"})]})})})]})]}),m?A():u.jsxs(u.Fragment,{children:[t.length>1&&!c&&u.jsx(p,{}),c&&r&&u.jsx("div",{className:"px-3 py-1 bg-gray-50 dark:bg-gray-800 border-b dark:border-gray-700",children:u.jsxs("span",{className:"text-xs text-gray-600 dark:text-gray-300 truncate max-w-[200px]",title:r||"",children:[r," (Manually set)"]})}),T&&e.length>0&&t.length===0&&!c?u.jsx(cs,{rows:2}):d&&Object.keys(d).length>0?u.jsx(Zl,{details:d}):u.jsx("div",{className:"p-3 text-sm text-gray-600 dark:text-gray-400",children:u.jsx("p",{className:"mb-2",children:c&&r?`No client information found for ${r}`:e.length>0&&t.length===0?`No client information available for emails on the selected thread:
                      ${e.join(", ")}`:e.length>0?"No client information available for the selected email ID":"Select a clientemail thread to view client information"})})]})]})},oK=({clientEmail:r,selectedCaseDetails:e,casesForCurrentClient:t,currentCaseIndex:n,caseDetails:s,nextCase:i,prevCase:c,isLoading:d,setCurrentCaseIndex:m,isValidating:p=!1})=>{const[v,x]=w.useState(""),[b,S]=w.useState(!1),N=w.useMemo(()=>{if(!v.trim())return t;const I=v.toLowerCase();return t.filter(D=>{var O;return String(D.projectName||((O=D.Data)==null?void 0:O.CaseDescription)||"").toLowerCase().includes(I)})},[t,v]),E=I=>{S(I),I||x("")},T=()=>u.jsx(cs,{rows:2}),A=I=>{if(m)m(I);else if(I>n)for(let D=n;D<I;D++)i();else if(I<n)for(let D=n;D>I;D--)c()};return u.jsxs("div",{className:"w-full min-h-[4rem] border border-border/50 rounded-lg shadow-sm bg-card text-card-foreground",title:"Case Information",children:[u.jsx("div",{className:"flex items-center justify-between p-2 border-b bg-muted",children:u.jsx("div",{className:"flex items-center gap-2",children:u.jsx("a",{href:"https://global.inszoom.com/CorpAttorney/aty_dashboard.aspx?phn_msg=False&QLogin=Y",target:"_blank",rel:"noopener noreferrer",className:"font-medium text-sm ml-2 hover:opacity-80 text-blue-700 dark:text-blue-400 underline underline-offset-4 decoration-blue-700 dark:decoration-blue-400 transition-opacity cursor-pointer",children:"CASES"})})}),d?T():e&&Object.keys(e).length>0?u.jsxs(u.Fragment,{children:[t.length>1&&u.jsx("div",{className:"flex justify-between items-center px-3 py-1 bg-gray-50 dark:bg-gray-800 border-b dark:border-gray-700",children:u.jsx("div",{className:"flex-1 flex items-center",children:u.jsxs(ti,{open:b,onOpenChange:E,children:[u.jsx(ri,{asChild:!0,children:u.jsxs(Ye,{variant:"ghost",size:"sm",className:"h-8 text-sm text-gray-600 dark:text-gray-300 flex items-center gap-1 px-2",children:[u.jsx("span",{className:"truncate max-w-[180px]",title:e.Title||e["Case Description"]||"",children:e.Title||e["Case Description"]||"Case"}),u.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["(",n+1,"/",t.length,")"]}),u.jsx(ls,{className:"w-3 h-3 ml-1"})]})}),u.jsxs(Po,{align:"start",className:"w-[280px] p-0",children:[u.jsxs("div",{className:"p-2 border-b border-gray-200 dark:border-gray-700",children:[u.jsxs("div",{className:"relative",children:[u.jsx(Ii,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),u.jsx(pn,{placeholder:"Search cases...",value:v,onChange:I=>x(I.target.value),className:"pl-8 pr-8 h-8 text-xs",autoFocus:!0,onClick:I=>I.stopPropagation(),onKeyDown:I=>I.stopPropagation()}),v&&u.jsx("button",{onClick:I=>{I.stopPropagation(),x("")},className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:u.jsx(aa,{className:"w-4 h-4"})})]}),v&&u.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:["Showing ",N.length," of ",t.length]})]}),u.jsx("div",{className:"max-h-[200px] overflow-y-auto",children:N.length>0?N.map((I,D)=>{var B;const j=t.findIndex(G=>G===I),O=String(I.projectName||((B=I.Data)==null?void 0:B.CaseDescription)||`Case ${j+1}`);return u.jsx(Bs,{className:`text-xs truncate ${j===n?"bg-gray-100 dark:bg-gray-700 font-medium":""}`,onClick:()=>A(j),title:O,children:O},j)}):u.jsxs("div",{className:"p-3 text-xs text-center text-gray-500 dark:text-gray-400",children:['No cases match "',v,'"']})})]})]})})}),u.jsx("div",{className:"break-words overflow-hidden",children:u.jsx(Zl,{details:e,linkableFields:[{field:"Title",url:s.projectUrl}]})})]}):p?u.jsx(cs,{rows:2}):u.jsx("div",{className:"p-3 text-sm text-gray-600 dark:text-gray-400",children:r?u.jsx(u.Fragment,{children:u.jsx("p",{className:"mb-2",children:"Select a client email thread to view case information"})}):"Select a client email thread to view case information"})]})},Rr="src/sidepanel/panels/InsZoomInsights.tsx",Qo=r=>{if(!r)return"";try{return new Date(r).toLocaleDateString(void 0,{timeZone:"UTC"})}catch{return r}},gN=r=>{if(console.log("caseData",r),!r||Object.keys(r).length===0)return{};const e=n=>n.replace(/([a-z])([A-Z])/g,"$1 $2");return Object.entries(r).reduce((n,[s,i])=>{if(i!==null&&typeof i=="object"&&!Array.isArray(i)){let c=Object.entries(i);if(s==="report_fields")return Object.fromEntries(c),c.filter(([x,b])=>x!=="i797_valid_from"&&x!=="i797_valid_to"&&b!==null&&b!==void 0).forEach(([x,b])=>{const S=x.replace(/_/g," ").replace(/\b\w/g,E=>E.toUpperCase()).replace(/I797/g,"I-797").replace(/H Or L/g,"H/L");let N=String(b);N.includes(" 00:00:00")&&(N=Qo(N.split(" ")[0])),n[S]=N}),console.log("promoted report_fields to top level",Object.keys(n)),n;s==="MilestoneCompletedDate"&&(c=c.sort(([,x],[,b])=>{const S=new Date(String(x)),N=new Date(String(b)),E=!isNaN(S.getTime()),T=!isNaN(N.getTime());return E&&T?N.getTime()-S.getTime():E&&!T?-1:!E&&T?1:0}));const d=[],m=[];c.forEach(([x,b])=>{const S=new Date(String(b));!isNaN(S.getTime())?d.push([x,b]):m.push([x,b])});const p=d.map(([x,b])=>`[[${e(x)}]]:
    ((${b}))
`).join(`
`),v=m.length>0?`
[[Not Completed:]]
${m.map(([x])=>`  - ${e(x)}`).join(`
`)}
`:"";n[s]=p+v}else{const c=i!=null?String(i):"";c.includes(`
`)?n[s]=`
  ${c.replace(/\n/g,`
  `)}`:n[s]=c}return n},{})},iK=({clientEmail:r,setClientEmail:e,tempClientEmail:t,setTempClientEmail:n,emailParticipants:s,emailParticipantClients:i,currentClientIndex:c,setCurrentClientIndex:d,currentCaseIndex:m,casesForCurrentClient:p,setCasesForCurrentClient:v,isManuallySet:x,setIsManuallySet:b,isProjectManuallySelected:S,setIsProjectManuallySelected:N,isValidClient:E,isTempEmailValid:T,nextCase:A,prevCase:I,handleSetCurrentCaseIndex:D,ClientNavigation:j,onClientDataValidated:O,isValidating:B,refreshTrigger:G,integrationSettings:K,isPrefetchEnabled:re})=>{const se=Jr(),he=Qa(),[U]=w.useState(!0),[ge,ie]=w.useState({}),[ae,de]=w.useState({}),[J,Y]=w.useState({}),[$,Q]=w.useState(!1),F=w.useRef({}),H=w.useCallback(X=>{if(!X||!X.client_data)return!1;const we=X.client_data;return we&&typeof we=="object"&&Object.keys(we).length>0},[]),te=w.useCallback(async(X,we=!1)=>{if(se.info("getClientDetailsForEmail called",{sourceFile:Rr,email:X,hasCachedData:!!F.current[X],forceRefresh:we}),we&&F.current[X]&&(se.info("Force refresh requested - clearing component cache",{sourceFile:Rr,email:X}),delete F.current[X]),F.current[X]&&!we){se.info("Using cached client data",{sourceFile:Rr,email:X}),se.debug("Using cached client data",{sourceFile:Rr,email:X});return}try{se.info("Starting client data fetch from server",{sourceFile:Rr,email:X,forceRefresh:we}),se.debug("Fetching client data",{sourceFile:Rr,email:X,forceRefresh:we});const Ne=await he.getCurrentThreadId(),Me=await W_("inszoom",X,se,we,void 0,Ne),St=Array.isArray(Me==null?void 0:Me.client_data)?Me.client_data[0]:Me==null?void 0:Me.client_data;if(Me&&St&&St.Data){const Te=St.Data;let Ge="",Ee="",ye="",Ke="";Te.ArrivalAndDepartureDetails&&typeof Te.ArrivalAndDepartureDetails=="object"&&Te.ArrivalAndDepartureDetails!==null&&"ImmigrantStatusOnI94"in Te.ArrivalAndDepartureDetails&&(Ge=String(Te.ArrivalAndDepartureDetails.ImmigrantStatusOnI94||""),Ee=Qo(String(Te.ArrivalAndDepartureDetails.I94ValidFrom||"")),ye=Qo(String(Te.ArrivalAndDepartureDetails.DateOfExpiration||"")),Ke=String(Te.ArrivalAndDepartureDetails.I94Number||""));const qe={...Me.client_data,FirstName:String(Te.FirstName||""),LastName:String(Te.LastName||""),Email:String(Te.Email||X),FileNumber:String(Te.FileNumber||""),Category:String(Te.Category||""),ImmigrantStatusOnI94:Ge,I94ValidFrom:Ee,I94ValidTo:ye,I94Number:Ke,...Te.report_fields&&{report_fields:Te.report_fields}};F.current[X]={client_data:qe,case_data:Me.case_data||[],timestamp:Date.now()}}else F.current[X]={client_data:Me.client_data,case_data:[],timestamp:Date.now()}}catch(Ne){throw Ne instanceof Error&&(Ne.message.includes("Client not found")||Ne.message.includes("(cached)"))?se.debug("Client not found for email (including cached)",{sourceFile:Rr,email:X}):se.error(`Error fetching client data for ${X}`,Ne,{sourceFile:Rr}),Ne}},[se,he]),Se=w.useCallback(X=>{se.info("selectClientDetails called",{sourceFile:Rr,hasDetails:!!X,detailsKeys:X?Object.keys(X):[]}),se.debug("Client details received for formatting",{sourceFile:Rr,details:X});const we=X.FirstName&&X.LastName?`${X.FirstName} ${X.LastName}`:X.fullName||"";let Ne="";if(X.visa_details&&typeof X.visa_details=="object"&&X.visa_details!==null){const Ge=X.visa_details;Ge.Data&&Array.isArray(Ge.Data)&&(Ne=Ge.Data.map(ye=>{const Ke=String(ye.VisaType||""),qe=Qo(String(ye.IssuanceDate||"")),ft=Qo(String(ye.ExpirationDate||""));return`[[${Ke}]]:
${qe} - ${ft}
`}).join(`
`))}let Me="";if(X.passport_details&&typeof X.passport_details=="object"&&X.passport_details!==null){const Ge=X.passport_details;Ge.Data&&Array.isArray(Ge.Data)&&(Me=Ge.Data.map(ye=>{const Ke=String(ye.PassportNo||""),qe=String(ye.PassportType||""),ft=String(ye.PassportIssuingCountry||""),mt=Qo(String(ye.PassportIssuanceDate||"")),jt=Qo(String(ye.PassportExpirationDate||""));return`[[${ft} (${qe})]]
${Ke} :
${mt} - ${jt}
`}).join(`
`))}let St="";if(X.report_fields&&typeof X.report_fields=="object"&&X.report_fields!==null){const Ge=X.report_fields,Ee=Ge.priority_date_1||"",ye=Ge.priority_date_1_country||"",Ke=Ge.priority_date_2||"",qe=Ge.priority_date_2_country||"",ft=[];if(Ee||ye){const mt=`${Ee}${ye?` [${ye}]`:""}`;ft.push(mt)}if(Ke||qe){const mt=`${Ke}${qe?` [${qe}]`:""}`;ft.push(mt)}ft.length>0&&(St=ft.join(`
`))}const Te={Name:we,"Immigration Status":X.ImmigrantStatusOnI94||"","I-94 Number":X.I94Number||"","I-94 Validity":`${X.I94ValidFrom} - ${X.I94ValidTo}`||""};if(X.report_fields&&typeof X.report_fields=="object"&&X.report_fields!==null){const Ge=X.report_fields,Ee=Ge.i797_status||"";Te["I-797 Status"]=Ee;const ye=Ge.i797_valid_from||"",Ke=Ge.i797_valid_to||"";if(ye&&ye.trim()!==""||Ke&&Ke.trim()!==""){const qe=ye?Qo(ye.split(" ")[0]):"",ft=Ke?Qo(Ke.split(" ")[0]):"";Te["I-797 Validity"]=`${qe} - ${ft}`}else Te["I-797 Validity"]=""}else Te["I-797 Status"]="",Te["I-797 Validity"]="";if(Te["Passport Details"]=Me,Te["Visa Details"]=Ne,X.report_fields&&typeof X.report_fields=="object"&&X.report_fields!==null){const Ee=X.report_fields.h_or_l_max_out_date||"";Ee&&Ee.includes(" 00:00:00")?Te["H/L Maxout Date"]=Qo(Ee.split(" ")[0]):Te["H/L Maxout Date"]=Ee}else Te["H/L Maxout Date"]="";if(Te["Priority Dates"]=St,X.report_fields&&typeof X.report_fields=="object"&&X.report_fields!==null){const Ee=X.report_fields.maxout_date_applicability_notes||"";Te["Maxout Date Applicability and Notes"]=Ee}else Te["Maxout Date Applicability and Notes"]="";se.info("Client details formatted and set",{sourceFile:Rr,selectedDetails:Te,originalDetails:X}),de(Te)},[se]),ue=w.useCallback(X=>{se.info("selectCaseDetails called",{sourceFile:Rr,hasDetails:!!X,details:X||[]});const we={"Case Description":X.CaseDescription||X.projectName||"","Case Manager":X.WorkingCaseManagers_names||"","Case Status":X.CaseStatus||"","Opened Date":Qo(X.CaseOpenedDate)||"","Date Filed":Qo(X.DateSentToGovt)||""};we["Last Step Completed"]=X["Last Step Completed"]||"",we["Last Step Completed Date"]=Qo(X["Last Step Completed Date"])||"",we["Receipt Number"]=X["Receipt Number"]||"",we["Case Main Receipt Status"]=X["Case Main Receipt Status"]||"",se.info("Case details formatted and set",{sourceFile:Rr,selectedDetails:we,originalDetails:X}),Y(we)},[se]),ke=w.useCallback(async(X=!1)=>{if(se.info("fetchClientData called",{sourceFile:Rr,clientEmail:r,isINSZoomConnected:U,hasClientEmail:!!r,forceRefresh:X}),!r||!U){se.info("fetchClientData early return",{sourceFile:Rr,reason:r?"INSZoom not connected":"no client email",clientEmail:r,isINSZoomConnected:U});return}try{if(Q(!0),se.info("fetchClientData: fetching from server",{sourceFile:Rr,clientEmail:r,forceRefresh:X}),X||!F.current[r]||F.current[r].timestamp<Date.now()-1e3*60*60*24)try{await te(r,X)}catch(Ge){Ge instanceof Error&&Ge.message.includes("(cached)")?se.debug("Using cached knowledge that this client doesn't exist",{sourceFile:Rr,clientEmail:r}):se.error("Error fetching client data",Ge,{sourceFile:Rr}),ie({}),v([]),de({}),Y({}),Q(!1);return}const we=F.current[r];if(!we){ie({}),v([]),de({}),Y({}),Q(!1),O(r,!1);return}const Ne=H(we);if(O(r,Ne),!Ne){se.debug("Client data exists but is not valid",{sourceFile:Rr,clientEmail:r}),ie({}),v([]),de({}),Y({}),Q(!1);return}const Me=we.client_data;Se(Me);const Te=(we.case_data||[]).sort((Ge,Ee)=>{const ye=Ge.Data||Ge,Ke=Ee.Data||Ee,qe=ye.CaseOpenedDate,ft=Ke.CaseOpenedDate;if(!qe&&!ft)return 0;if(!qe)return 1;if(!ft)return-1;const mt=new Date(qe),jt=new Date(ft),ut=!isNaN(mt.getTime()),Jt=!isNaN(jt.getTime());return!ut&&!Jt?0:ut?Jt?jt.getTime()-mt.getTime():-1:1});if(v(Te),Te.length>0){const Ge=Te[0].Data||Te[0],Ee=gN(Ge);ie(Ee),ue(Ee)}else ie({}),ue({})}catch(we){se.error("Error processing client data",we,{sourceFile:Rr}),ie({}),v([]),r&&O(r,!1)}finally{Q(!1)}},[r,U,te,se,Se,ue,v,O,H]);return w.useEffect(()=>{B&&s.length>0&&(F.current={},se.debug("Cleared component-level client data cache for refresh",{sourceFile:Rr}))},[B,s.length,se]),w.useEffect(()=>{const X=async()=>{if(U){se.info("Validating all email participants",{sourceFile:Rr,participantCount:s.length});for(const we of s)try{await te(we);const Ne=F.current[we],Me=H(Ne);O(we,Me),se.debug("Participant validation result",{sourceFile:Rr,email:we,hasValidData:Me})}catch(Ne){se.debug("Participant validation failed",{sourceFile:Rr,email:we,error:Ne}),O(we,!1)}}};s.length>0&&U&&X()},[s,U,te,H,O,se,G]),w.useEffect(()=>{se.info("useEffect: client email or connection changed",{sourceFile:Rr,clientEmail:r,isINSZoomConnected:U,willFetchData:!!(r&&U)}),r&&U&&(se.info("Fetching client data for email",{sourceFile:Rr,clientEmail:r,isPrefetchEnabled:re}),ke(x),n(r),x&&!s.includes(r.toLowerCase())&&se.debug("Manually set email not in participants, validating separately",{sourceFile:Rr,clientEmail:r}))},[r,U,ke,n,x,s,se,re]),w.useEffect(()=>{(!r||s.length===0&&!x)&&(n(null),de({}),Y({}))},[r,s.length,x,n,de,Y]),w.useEffect(()=>{if(se.info("useEffect: case index changed",{sourceFile:Rr,currentCaseIndex:m,casesCount:p.length,willUpdateCaseDetails:p.length>0&&m<p.length}),p.length>0&&m<p.length){const X=p[m];se.info("Updating case details for index",{sourceFile:Rr,currentCaseIndex:m,caseData:X?Object.keys(X):null});const we=X.Data||X,Ne=gN(we);ie(Ne),ue(Ne),se.info("Case details updated",{sourceFile:Rr,formattedCaseData:Object.keys(Ne)})}},[m,p,ue,se]),U?(se.info("INSZoomInsights rendering components",{sourceFile:Rr,clientEmail:r,selectedClientDetails:Object.keys(ae),selectedCaseDetails:Object.keys(J),isLoading:$}),u.jsxs("div",{className:"space-y-4 overflow-y-auto h-full mt-0",children:[u.jsx(sK,{clientEmail:r,emailParticipants:s,emailParticipantClients:i,currentClientIndex:c,setCurrentClientIndex:d,setClientEmail:e,isManuallySet:x,selectedClientDetails:ae,isLoading:$,ClientNavigation:j,handleSectionClick:()=>{},tempClientEmail:t,setTempClientEmail:n,setIsManuallySet:b,isValidClient:E,isTempEmailValid:T,isValidating:B}),u.jsx(oK,{clientEmail:r,selectedCaseDetails:J,casesForCurrentClient:p,currentCaseIndex:m,caseDetails:ge,nextCase:A,prevCase:I,isLoading:$,setCurrentCaseIndex:D,isValidating:B})]})):(se.info("INSZoomInsights not rendering - INSZoom not connected",{sourceFile:Rr,isINSZoomConnected:U}),null)},aK=/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;function lK(r){return r.filter(e=>e&&e.trim().length>0&&aK.test(e.trim())).map(e=>e.trim().toLowerCase())}function cK(r,e){if(!e)return r;const t=e.toLowerCase(),n=t.split("@")[1];return n?["gmail.com","googlemail.com","outlook.com","hotmail.com","live.com","yahoo.com","ymail.com","aol.com","icloud.com","me.com","mac.com","protonmail.com","proton.me","mail.com","zoho.com","gmx.com","gmx.net","trycandle.ai"].includes(n)?r.filter(c=>c.toLowerCase()!==t):r.filter(c=>c.toLowerCase().split("@")[1]!==n):r}const dj={rawParticipants:[],sanitizedParticipants:[],emailsWithValidData:new Set,validatedEmails:new Set,selectedClient:"",isValidating:!1,isManuallySet:!1,isProjectManuallySelected:!1,refreshTrigger:0,integrationSettings:{},hasTransientError:!1};function uK(r,e){var t,n;switch(e.type){case"SET_RAW_PARTICIPANTS":{const s=lK(e.participants);return console.log(" [Reducer] SET_RAW_PARTICIPANTS:",{rawCount:((t=e.participants)==null?void 0:t.length)??0,sanitizedCount:s.length,raw:e.participants,sanitized:s,filtered:(n=e.participants)==null?void 0:n.filter(i=>!s.includes(i.toLowerCase().trim()))}),JSON.stringify(s)===JSON.stringify(r.sanitizedParticipants)?(console.log(" [Reducer] Participants unchanged, skipping update"),r):{...r,rawParticipants:e.participants,sanitizedParticipants:s,isValidating:s.length>0}}case"MARK_EMAIL_VALIDATED":{const s=new Set(r.validatedEmails);s.add(e.email.toLowerCase());const i=new Set(r.emailsWithValidData),c=e.email.toLowerCase(),d=r.selectedClient&&c===r.selectedClient.toLowerCase();e.isValid?i.add(c):(!r.isValidating||!d)&&i.delete(c);const m=r.sanitizedParticipants.length>0&&s.size>=r.sanitizedParticipants.length;return m&&d&&!e.isValid&&i.delete(c),{...r,validatedEmails:s,emailsWithValidData:i,isValidating:!m}}case"SELECT_CLIENT":return{...r,selectedClient:e.email,isManuallySet:e.isManual};case"SET_MANUALLY_SET":return{...r,isManuallySet:e.value};case"SET_PROJECT_MANUALLY_SELECTED":return{...r,isProjectManuallySelected:e.value};case"START_VALIDATION":return{...r,isValidating:!0};case"COMPLETE_VALIDATION":return{...r,isValidating:!1};case"RESET_STATE":return{...dj,refreshTrigger:r.refreshTrigger,hasTransientError:!1};case"REFRESH_DATA":{const s=new Set;return r.selectedClient&&s.add(r.selectedClient.toLowerCase()),{...r,emailsWithValidData:s,validatedEmails:new Set,isValidating:!0,isManuallySet:!1,isProjectManuallySelected:!1,refreshTrigger:r.refreshTrigger+1,hasTransientError:!1}}case"SET_INTEGRATION_SETTINGS":return{...r,integrationSettings:e.settings};case"SET_TRANSIENT_ERROR":return{...r,hasTransientError:e.hasError};default:return r}}function dK({platform:r,dataProvider:e,isIntegrationConnected:t}){const n=Jr(),[s,i]=w.useReducer(uK,dj),c=w.useRef(!1),d=w.useRef(0),m=Xa();w.useEffect(()=>{(async()=>{try{const re=await FT(n);Object.keys(re).length>0&&await m.setLocalItem("integrationSettings",re),i({type:"SET_INTEGRATION_SETTINGS",settings:re})}catch(re){n.error("Failed to fetch integration settings",re,{sourceFile:"src/shared/hooks/useEmailParticipants.ts"})}})()},[n]);const p=s.sanitizedParticipants.filter(K=>s.emailsWithValidData.has(K.toLowerCase())),v=Math.max(0,p.indexOf(s.selectedClient)),x=w.useCallback((K,re)=>{n.info("Client data validation result received",{sourceFile:"useEmailParticipants.ts",email:K,isValid:re}),i({type:"MARK_EMAIL_VALIDATED",email:K,isValid:re}),re&&i({type:"SET_TRANSIENT_ERROR",hasError:!1})},[n]),b=w.useCallback((K,re=!1)=>{i({type:"SELECT_CLIENT",email:K,isManual:re})},[]),S=w.useCallback(K=>{i({type:"SET_MANUALLY_SET",value:K})},[]),N=w.useCallback(K=>{i({type:"SET_PROJECT_MANUALLY_SELECTED",value:K})},[]),E=w.useCallback((K,re)=>{n.warn("Transient error during validation - user should try again later",{sourceFile:"useEmailParticipants.ts",email:K,error:re.message}),i({type:"SET_TRANSIENT_ERROR",hasError:!0})},[n]),T=w.useCallback(()=>{n.debug("Resetting participant state",{sourceFile:"useEmailParticipants.ts"}),i({type:"RESET_STATE"})},[n]),A=w.useCallback(async()=>{const K=Date.now();if(K-d.current<50){n.debug("Debouncing fetchParticipants call",{sourceFile:"useEmailParticipants.ts"});return}d.current=K;try{if(r==="chrome"){const se=await e.getCurrentThreadId();if(se){n.info("Getting participants for Chrome",{sourceFile:"useEmailParticipants.ts",threadId:se}),console.log(` [Participants] Fetching for thread: ${se}`);try{const he=await n8(se,n);console.log(` [Participants] Server returned ${(he==null?void 0:he.length)??0} participants:`,he),n.info("Received participants from server",{sourceFile:"useEmailParticipants.ts",threadId:se,participantCount:(he==null?void 0:he.length)??0,participants:he==null?void 0:he.slice(0,5)}),(!he||he.length===0)&&(console.warn(` [Participants] No participants returned for thread ${se}`),n.warn("No participants returned from server",{sourceFile:"useEmailParticipants.ts",threadId:se})),i({type:"SET_RAW_PARTICIPANTS",participants:he||[]})}catch(he){console.error(` [Participants] Error fetching for thread ${se}:`,he),n.error("Error fetching participants for Chrome",he,{sourceFile:"useEmailParticipants.ts",threadId:se}),T()}}else console.warn(" [Participants] No threadId found for Chrome"),n.debug("No threadId found for Chrome",{sourceFile:"useEmailParticipants.ts"}),T()}else if(r==="outlook"){n.debug("Getting participants for Outlook",{sourceFile:"useEmailParticipants.ts"});try{const se=await e.getCurrentThread();if(se){let he=se.participants;const U=e.getCurrentUserEmail();if(U){const ge=he.length;he=cK(he,U),n.debug("Applied domain filtering for Outlook participants",{sourceFile:"useEmailParticipants.ts",userEmail:U,originalCount:ge,filteredCount:he.length})}else n.warn("Could not get user email, skipping domain filtering",{sourceFile:"useEmailParticipants.ts"});i({type:"SET_RAW_PARTICIPANTS",participants:he})}else n.debug("No thread found for Outlook",{sourceFile:"useEmailParticipants.ts"}),T()}catch(se){n.error("Error fetching participants for Outlook",se,{sourceFile:"useEmailParticipants.ts"}),T()}}}catch(se){n.error("Error in fetchParticipants",se,{sourceFile:"useEmailParticipants.ts"}),T()}},[r,e,n,T]),I=w.useCallback(async()=>{if(!(s.isValidating||s.sanitizedParticipants.length===0)){n.info("Starting participant data refresh",{sourceFile:"useEmailParticipants.ts",participantCount:s.sanitizedParticipants.length});try{await Promise.all(s.sanitizedParticipants.map(K=>jw(K,n))),i({type:"REFRESH_DATA"}),n.info("Participant data refresh initiated",{sourceFile:"useEmailParticipants.ts"})}catch(K){n.error("Error refreshing participant data",K,{sourceFile:"useEmailParticipants.ts"})}}},[s.isValidating,s.sanitizedParticipants,n]),D=p.length>0,j=p[0]??"",O=s.selectedClient?p.includes(s.selectedClient):!0,B=D&&!s.selectedClient&&!s.isManuallySet&&!s.isProjectManuallySelected,G=!s.isValidating&&s.selectedClient&&!O&&!s.isManuallySet&&!s.isProjectManuallySelected;return w.useEffect(()=>{B?(n.info("Auto-selecting first validated client",{sourceFile:"useEmailParticipants.ts",selectedClient:j}),i({type:"SELECT_CLIENT",email:j,isManual:!1})):G&&(n.info("Current client no longer valid, clearing",{sourceFile:"useEmailParticipants.ts",clientEmail:s.selectedClient}),i({type:"SELECT_CLIENT",email:"",isManual:!1}))},[B,G,j,s.selectedClient,n]),w.useEffect(()=>{if(e!=null&&e.onThreadChanged){const K=re=>{re?(n.debug("Thread changed",{sourceFile:"useEmailParticipants.ts",newThreadId:re.threadId}),i({type:"RESET_STATE"}),A()):(n.info("Thread cleared",{sourceFile:"useEmailParticipants.ts"}),i({type:"RESET_STATE"}))};return e.onThreadChanged(K),()=>{e.removeThreadListener&&e.removeThreadListener(K)}}},[e,A,n]),w.useEffect(()=>{t&&!c.current&&(c.current=!0,A())},[t,A]),{validClients:p,selectedClient:s.selectedClient,currentClientIndex:v,sanitizedParticipants:s.sanitizedParticipants,isValidating:s.isValidating,isManuallySet:s.isManuallySet,isProjectManuallySelected:s.isProjectManuallySelected,refreshTrigger:s.refreshTrigger,integrationSettings:s.integrationSettings,hasTransientError:s.hasTransientError,selectClient:b,setManuallySet:S,setProjectManuallySelected:N,handleClientDataValidated:x,handleTransientError:E,refresh:I,resetState:T}}function fK({toggleSection:r,clientEmail:e,setClientEmail:t,setProjectId:n,setDocuments:s,setIsDocumentsLoading:i,setDocumentsError:c,onDocumentView:d,onRefreshReady:m,onGenerateRefresh:p,isPrefetchEnabled:v}){const x=Jr(),b=mn().platform,S=Qa();Xa();const{isConnected:N}=Di(),[E,T]=w.useState([]),[A,I]=w.useState(null),[D,j]=w.useState(!0),[O,B]=w.useState(0),[G,K]=w.useState([]),[re,se]=w.useState(null),[he,U]=w.useState(null),[ge,ie]=w.useState(!1),[ae,de]=w.useState(!1),[J,Y]=w.useState(!1),$=ge||ae||J,{validClients:Q,selectedClient:F,currentClientIndex:H,sanitizedParticipants:te,isValidating:Se,isManuallySet:ue,isProjectManuallySelected:ke,refreshTrigger:X,integrationSettings:we,hasTransientError:Ne,selectClient:Me,setManuallySet:St,setProjectManuallySelected:Te,handleClientDataValidated:Ge,handleTransientError:Ee,refresh:ye}=dK({platform:b,dataProvider:S,isIntegrationConnected:$});w.useEffect(()=>{m==null||m(ye)},[m,ye]),w.useEffect(()=>{t(F)},[F,t]),w.useEffect(()=>{(async()=>{await kR(x)})()},[x]);const Ke=w.useCallback(()=>{if(O<G.length-1){const me=O+1;B(me)}},[O,G.length]),qe=w.useCallback(()=>{if(O>0){const me=O-1;B(me)}},[O]),ft=w.useRef(G.length);ft.current=G.length;const mt=w.useCallback(me=>{me>=0&&me<ft.current&&B(me)},[]);w.useEffect(()=>{B(0)},[F]);const jt=w.useCallback(({className:me="",clientUrl:je})=>u.jsxs("div",{className:`flex items-center px-3 py-1 bg-gray-50 dark:bg-gray-800 border-b dark:border-gray-700 gap-2 ${me}`,children:[u.jsx("div",{className:"flex-1 min-w-0 flex items-center",children:u.jsxs(ti,{children:[u.jsx(ri,{asChild:!0,children:u.jsxs(Ye,{variant:"ghost",size:"sm",className:"h-8 text-sm text-gray-600 dark:text-gray-300 flex items-center gap-1 px-2 max-w-full",children:[u.jsx("span",{className:"truncate",title:F||"",children:F||"No client"}),u.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400 flex-shrink-0",children:["(",H+1,"/",Q.length,")"]}),u.jsx(ls,{className:"w-3 h-3 ml-1 flex-shrink-0"})]})}),u.jsx(Po,{align:"start",className:"max-h-[200px] overflow-y-auto",children:Q.map((ht,wt)=>u.jsx(Bs,{className:`text-xs ${ht===F?"bg-gray-100 dark:bg-gray-700 font-medium":""}`,onClick:()=>{Me(ht,!1)},children:ht},ht))})]})}),je&&u.jsxs("a",{href:je,target:"_blank",rel:"noopener noreferrer",className:"h-8 text-xs text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 border border-blue-200 dark:border-blue-800 px-3 flex-shrink-0 rounded-md inline-flex items-center gap-1 no-underline hover:no-underline",children:[u.jsx(Wa,{className:"w-3 h-3"}),"View"]})]}),[F,H,Q,Me]);w.useEffect(()=>{(async()=>{try{const je=await CR(x),ht=je.some(Ve=>Ve.integration_type==="filevine"),wt=je.some(Ve=>Ve.integration_type==="clio"),We=je.some(Ve=>Ve.integration_type==="inszoom");ie(ht),de(wt),Y(We)}catch(je){x.error("Error checking integration connections",je,{sourceFile:"src/shared/components/sidepanel/panels/InsightsPanel.tsx"})}})()},[x]),w.useEffect(()=>{(async()=>{try{const je=await Zm(x);T(je||[]);const ht=(je==null?void 0:je.some(lt=>lt.integration_type.toLowerCase()==="filevine"))||!1,wt=(je==null?void 0:je.some(lt=>lt.integration_type.toLowerCase()==="clio"))||!1,We=(je==null?void 0:je.some(lt=>lt.integration_type.toLowerCase()==="inszoom"))||!1;let Ve=null;if(ht?Ve="filevine":wt?Ve="clio":We&&(Ve="inszoom"),Ve){const lt=await SS(Ve);I(lt)}else I(null)}catch(je){x.error("Error fetching integrations:",je,{sourceFile:"src/shared/components/sidepanel/panels/InsightsPanel.tsx"})}finally{j(!1)}})()},[x]);const ut=E.some(me=>me.integration_type.toLowerCase()==="filevine"),Jt=E.some(me=>me.integration_type.toLowerCase()==="clio"),Or=E.some(me=>me.integration_type.toLowerCase()==="inszoom");w.useEffect(()=>{U(re?!0:null)},[re]);const jr={clientEmail:F,setClientEmail:(me,je)=>{if(!me)Me("",!1);else{const ht=Q.indexOf(me),wt=je===!0?!0:ht<0;Me(me,wt)}},tempClientEmail:re,setTempClientEmail:se,emailParticipants:te,emailParticipantClients:Q,currentClientIndex:H,setCurrentClientIndex:me=>{const je=Q[me];je?Me(je,!1):(x.warn("Invalid client index",{sourceFile:"src/shared/components/sidepanel/panels/InsightsPanel.tsx",index:me,availableClients:Q.length}),Me("",!1))},currentCaseIndex:O,casesForCurrentClient:G,setCasesForCurrentClient:K,isManuallySet:ue,setIsManuallySet:me=>{St(me)},isProjectManuallySelected:ke,setIsProjectManuallySelected:Te,isValidClient:F?!0:null,isTempEmailValid:he,nextCase:Ke,prevCase:qe,handleSetCurrentCaseIndex:mt,ClientNavigation:jt,onClientDataValidated:Ge,onTransientError:Ee,isValidating:Se,refreshTrigger:X,integrationSettings:we,hasTransientError:Ne,isPrefetchEnabled:v},Nr=b==="chrome"&&!N;return u.jsx("div",{className:"h-full",children:Nr?u.jsx("div",{className:"p-4",children:u.jsx(r0,{feature:"Insights",description:"Connect your Gmail account to view client insights and case information",benefits:["Automatically identify clients from email participants","View relevant case information and documents","Access client details from your case management system"]})}):D?u.jsxs("div",{className:"flex flex-col items-center justify-center h-full",children:[u.jsx(ia,{className:"h-8 w-8 animate-spin text-blue-600"}),u.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"Loading integrations..."})]}):u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"flex items-center justify-between mb-2",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Data Provider:"}),A&&u.jsxs("a",{href:A.homeUrl,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1.5 hover:opacity-80 transition-opacity",title:`Open ${A.name}`,children:[u.jsx(Ai,{src:A.logo,width:18,height:18,alt:A.name,className:"h-4 w-auto dark:brightness-0 dark:invert"}),u.jsx("span",{className:"text-xs font-medium text-blue-600 dark:text-blue-400",children:A.name})]})]}),u.jsx(Ye,{size:"icon",variant:"ghost",onClick:()=>{ye(),p==null||p()},disabled:Se||te.length===0,className:"h-6 w-6",title:Se?"Refreshing...":te.length===0?"No participants to refresh":"Refresh participant data",children:u.jsx(si,{className:`h-3 w-3 ${Se?"animate-spin":""}`})})]}),ut&&u.jsx(Gq,{toggleSection:r,setDocuments:s,setIsDocumentsLoading:i,setDocumentsError:c,setProjectId:n,onDocumentView:d,...jr}),Jt&&u.jsx(nK,{...jr}),Or&&u.jsx(iK,{...jr})]})})}const hK={showEmailSummary:!1,showInsightsTab:!0,showComposeTab:!0,showTemplatesTab:!0},pK=()=>hK,mK=r=>pK()[r],gK=({className:r=""})=>{const[e,t]=w.useState(!1),{isConnected:n,wasEverConnected:s,isLoading:i,error:c,status:d,reconnectAttempts:m,initiateReconnection:p,clearError:v}=Di(),{platform:x}=mn();if(x!=="chrome"||n&&d!=="error"||e)return null;const b=async()=>{try{await p()}catch(D){console.error("Failed to reconnect Gmail:",D)}},S=()=>{t(!0),c&&v()},N=()=>d==="error"?"bg-red-50 border-red-200":s?"bg-yellow-50 border-yellow-200":"bg-blue-50 border-blue-200",E=()=>d==="error"?u.jsx(ih,{className:"h-4 w-4 text-red-600 flex-shrink-0"}):s?u.jsx(ih,{className:"h-4 w-4 text-yellow-600 flex-shrink-0"}):u.jsx(ih,{className:"h-4 w-4 text-blue-600 flex-shrink-0"}),T=()=>d==="error"?c||"Gmail connection error occurred":s?"Gmail connection lost. Some features may not work properly.":"Gmail connection required to access all features.",A=()=>d==="error"?"text-red-800":s?"text-yellow-800":"text-blue-800",I=()=>d==="error"?"bg-red-100 border-red-300 text-red-800 hover:bg-red-200 hover:border-red-400":s?"bg-yellow-100 border-yellow-300 text-yellow-800 hover:bg-yellow-200 hover:border-yellow-400":"bg-blue-100 border-blue-300 text-blue-800 hover:bg-blue-200 hover:border-blue-400";return u.jsxs("div",{className:`flex items-center justify-between ${N()} px-4 py-3 ${r}`,role:"alert","aria-live":"polite","aria-atomic":"true",children:[u.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[E(),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("p",{className:`text-sm ${A()} font-medium`,children:T()}),m>0&&u.jsxs("p",{className:`text-xs ${A()} opacity-75 mt-1`,children:["Reconnect attempts: ",m]})]})]}),u.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[u.jsx(Ye,{onClick:b,disabled:i,variant:"outline",size:"sm",className:`${I()} text-xs px-3 py-1 h-auto whitespace-nowrap`,"aria-label":i?"Connecting to Gmail...":s?"Reconnect Gmail account":"Connect Gmail account",children:i?u.jsxs(u.Fragment,{children:[u.jsx(si,{className:"h-3 w-3 mr-1 animate-spin","aria-hidden":"true"}),"Connecting..."]}):s?"Reconnect Gmail":"Connect Gmail"}),u.jsx(Ye,{onClick:S,variant:"ghost",size:"sm",className:`${d==="error"?"text-red-600 hover:text-red-800 hover:bg-red-100":s?"text-yellow-600 hover:text-yellow-800 hover:bg-yellow-100":"text-blue-600 hover:text-blue-800 hover:bg-blue-100"} p-1 h-auto`,"aria-label":"Dismiss Gmail connection banner",children:u.jsx(aa,{className:"h-4 w-4","aria-hidden":"true"})})]})]})},fj=w.createContext(void 0),hj=()=>{const r=w.useContext(fj);if(r===void 0)throw new Error("useToast must be used within a ToastProvider");return r},vK=({children:r})=>{const[e,t]=w.useState([]),n=w.useCallback(d=>{const m=Math.random().toString(36).substr(2,9),p={...d,id:m};t(x=>[...x,p]);const v=d.duration??5e3;return v>0&&setTimeout(()=>{t(x=>x.filter(b=>b.id!==m))},v),m},[]),s=w.useCallback(d=>{t(m=>m.filter(p=>p.id!==d))},[]),i=w.useCallback(()=>{t([])},[]),c={toasts:e,addToast:n,removeToast:s,clearAll:i};return u.jsxs(fj.Provider,{value:c,children:[r,u.jsx(yK,{})]})},yK=()=>{const{toasts:r,removeToast:e}=hj();return r.length===0?null:u.jsx("div",{className:"fixed top-4 right-4 z-50 flex flex-col gap-2 max-w-sm",children:r.map(t=>u.jsx(xK,{toast:t,onRemove:e},t.id))})},xK=({toast:r,onRemove:e})=>{const t=s=>{switch(s){case"success":return u.jsx(Jc,{className:"h-5 w-5 text-green-600"});case"error":return u.jsx(ih,{className:"h-5 w-5 text-red-600"});case"warning":return u.jsx(eI,{className:"h-5 w-5 text-amber-600"});case"info":return u.jsx(eu,{className:"h-5 w-5 text-blue-600"});default:return null}},n=s=>{switch(s){case"success":return"bg-green-50 border-green-200";case"error":return"bg-red-50 border-red-200";case"warning":return"bg-amber-50 border-amber-200";case"info":return"bg-blue-50 border-blue-200";default:return"bg-gray-50 border-gray-200"}};return u.jsxs("div",{className:`flex items-start gap-3 p-4 rounded-lg border shadow-lg animate-in slide-in-from-right-full ${n(r.type)}`,children:[t(r.type),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("p",{className:"text-sm font-medium text-gray-900",children:r.title}),r.description&&u.jsx("p",{className:"text-sm text-gray-600 mt-1",children:r.description}),r.action&&u.jsx(Ye,{onClick:r.action.onClick,variant:"outline",size:"sm",className:"mt-2 h-7 text-xs",children:r.action.label})]}),u.jsx(Ye,{onClick:()=>e(r.id),variant:"ghost",size:"sm",className:"p-1 h-auto",children:u.jsx(aa,{className:"h-4 w-4"})})]})},wK=()=>{const{addToast:r}=hj(),e=w.useCallback(()=>{r({type:"success",title:"Gmail Connected",description:"Successfully connected to Gmail. All features are now available.",duration:4e3})},[r]),t=w.useCallback(c=>{r({type:"warning",title:"Gmail Connection Lost",description:"Some features may not work properly until you reconnect.",duration:0,action:c?{label:"Reconnect",onClick:c}:void 0})},[r]),n=w.useCallback((c,d)=>{r({type:"error",title:"Gmail Connection Error",description:c,duration:0,action:d?{label:"Retry",onClick:d}:void 0})},[r]),s=w.useCallback(()=>{r({type:"success",title:"Gmail Reconnected",description:"Successfully reconnected to Gmail.",duration:3e3})},[r]),i=w.useCallback(c=>{r({type:"error",title:"Reconnection Failed",description:"Failed to reconnect to Gmail. Please try again.",duration:0,action:c?{label:"Try Again",onClick:c}:void 0})},[r]);return{showConnectionSuccess:e,showConnectionLost:t,showConnectionError:n,showReconnectionSuccess:s,showReconnectionFailed:i}},bK=()=>{const{status:r,error:e,isConnected:t,initiateReconnection:n}=Di(),{platform:s}=mn(),{showConnectionSuccess:i,showConnectionLost:c,showConnectionError:d,showReconnectionSuccess:m,showReconnectionFailed:p}=wK(),v=w.useRef("loading"),x=w.useRef(!0),b=w.useRef(!1);return w.useEffect(()=>{if(s!=="chrome")return;const S=v.current,N=x.current,E=b.current;if(!(!E&&r==="loading")){if(!E){b.current=!0,v.current=r,x.current=t;return}if(S!==r||N!==t)switch(r){case"connected":(S==="disconnected"||S==="error"||!N)&&(S==="loading"?m():i());break;case"disconnected":N&&S==="connected"&&c(()=>{n().catch(A=>{console.error("Failed to reconnect from toast:",A)})});break;case"error":d(e||"Unknown connection error occurred",()=>{n().catch(A=>{console.error("Failed to reconnect from toast:",A),p(()=>{n().catch(console.error)})})});break}v.current=r,x.current=t}},[r,e,t,s,n,i,c,d,m,p]),null},_K=({activeSection:r,toggleSection:e})=>{const t=Jr();t.debug(`[MainPanelContent] Rendering with activeSection: "${r}"`,{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx",functionName:"MainPanelContent",data:{activeSection:r}});const n=OT(),s=Xa(),{platform:i}=mn(),{isConnected:c,wasEverConnected:d}=Di(),m=i==="chrome"&&!c&&d,[p,v]=w.useState(""),[x,b]=w.useState(""),[S,N]=w.useState([]),[E,T]=w.useState(!1),[A,I]=w.useState(null),[D,j]=w.useState(null),[O,B]=w.useState("compose"),[G,K]=w.useState(!1),[re,se]=w.useState(!1),[he,U]=w.useState(!1),[ge,ie]=w.useState(!1),ae=w.useRef(!1),de=w.useRef(!1),J=w.useRef(null),Y=w.useRef(null),$=w.useRef(null),Q=w.useCallback(async()=>{try{t.info("Checking authentication status...",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"});const ue=await(n==null?void 0:n.isAuthenticated());return t.info("Authentication status checked",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx",authenticated:ue}),ue||!1}catch(ue){return t.error("Failed to check auth status",ue,{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"}),!1}},[n,t]);w.useEffect(()=>{t.info("MainPanelContent component loaded",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"});const ue=async()=>{const X=await Q();se(!0),U(X),X?(t.info("Valid token found. User is authenticated.",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"}),r==="login"&&e("main")):(t.info("No valid token found. Show login page.",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"}),e("login"))},ke=X=>{X.token&&(t.info("Token detected in storage, auth state will be updated automatically",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"}),ue(),By(t))};return s!=null&&s.onChanged&&s.onChanged(ke),ue(),()=>{s!=null&&s.removeChangeListener&&s.removeChangeListener(ke)}},[n,s,e,t,Q,r]),w.useEffect(()=>{if(!re||!he||de.current){t.debug("Skipping CMS integration check - auth not ready, not authenticated, or already checked",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx",isAuthChecked:re,isAuthenticated:he,hasRunInitialCheck:de.current});return}de.current=!0;const ue=async()=>{try{t.info("Checking Case Management System connection status",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"});const X=await ER(t);t.info("Case Management System connection status result",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx",connected:X}),K(X),ae.current||(X?(t.info("CMS connected, setting active tab to insights",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"}),B("insights")):(t.info("CMS not connected, setting active tab to compose",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"}),B("compose")),ae.current=!0)}catch(X){t.error("Error checking Case Management System connection",X,{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"}),K(!1),ae.current||(B("compose"),ae.current=!0)}},ke=X=>{if(!X.integrations)return;t.info("Integrations changed via storage, rechecking CMS connection",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx",oldValue:X.integrations.oldValue,newValue:X.integrations.newValue});const we=X.integrations.newValue;if(!Array.isArray(we))return;const Ne=["inszoom","filevine","clio"];we.some(St=>Ne.includes(St.integration_type))&&(t.info("CMS integration found",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx",newValue:X.integrations.newValue}),K(!0))};return ue(),s!=null&&s.onChanged&&s.onChanged(ke),()=>{s!=null&&s.removeChangeListener&&s.removeChangeListener(ke)}},[re,he,t,s]),w.useEffect(()=>{if(!re||!he)return;(async()=>{var ke;try{const X=await FT(t);let we=!1;try{if(X&&typeof X=="object"){const Ne=X==null?void 0:X.email;we=!!((ke=Ne==null?void 0:Ne.prefetch)!=null&&ke.enabled)}}catch{we=!1}ie(we),t.debug("Prefetch setting checked",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx",prefetchEnabled:we})}catch(X){t.error("Error checking prefetch setting",X,{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"}),ie(!1)}})()},[re,he,t]);const F=w.useRef(p);w.useEffect(()=>{p!==F.current&&(F.current=p,G&&B("insights"))},[p,G]);const H=ue=>{B(ue),e(ue==="login"?"login":"main")},te=()=>{t.debug("[MainPanelContent] goBack called. Setting activeSection to null.",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx",functionName:"goBack"}),e("main"),j(null)},Se=ue=>{t.debug("[MainPanelContent] handleDocumentView called",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx",functionName:"handleDocumentView",data:{document:ue}}),j(ue),e("Project Documents")};return w.useEffect(()=>{r==="Project Documents"&&J.current&&(J.current.scrollTop=0)},[r]),u.jsxs(vK,{children:[u.jsx(bK,{}),u.jsxs("div",{ref:J,className:`flex flex-col h-full relative ${r==="login"||r==="Project Documents"?"overflow-hidden":"overflow-y-auto"}`,children:[r!=="login"&&u.jsx(gK,{className:"flex-shrink-0"}),u.jsxs("div",{className:"flex flex-col",children:[mK("showEmailSummary")&&u.jsx("div",{className:"flex-shrink-0 border-b-2 border-gray-300",children:u.jsx(N9,{})}),u.jsx("div",{className:"flex-grow flex flex-col",children:m?u.jsx("div",{className:"flex-grow"}):u.jsxs(q9,{defaultValue:G?"insights":"compose",value:O,onValueChange:H,className:"w-full flex flex-col",children:[u.jsxs(qR,{className:`grid ${G?"grid-cols-3":"grid-cols-2"} w-full bg-white dark:bg-card border-b dark:border-border p-0 h-9 flex-shrink-0`,children:[G&&u.jsx(ty,{value:"insights",className:"mx-1 my-0.5 text-sm text-gray-600 dark:text-gray-200 data-[state=active]:text-blue-600 dark:data-[state=active]:text-blue-400 data-[state=active]:bg-white dark:data-[state=active]:bg-muted data-[state=active]:shadow-sm data-[state=active]:font-medium border-gray-200 dark:border-border data-[state=active]:border-b-2 data-[state=active]:border-b-blue-600 dark:data-[state=active]:border-b-blue-400",children:"Insights"}),u.jsx(ty,{value:"compose",className:"mx-1 my-0.5 text-sm text-gray-600 dark:text-gray-200 data-[state=active]:text-blue-600 dark:data-[state=active]:text-blue-400 data-[state=active]:bg-white dark:data-[state=active]:bg-muted data-[state=active]:shadow-sm data-[state=active]:font-medium border-gray-200 dark:border-border data-[state=active]:border-b-2 data-[state=active]:border-b-blue-600 dark:data-[state=active]:border-b-blue-400",children:"Compose"}),u.jsx(ty,{value:"templates",className:"mx-1 my-0.5 text-sm text-gray-600 dark:text-gray-200 data-[state=active]:text-blue-600 dark:data-[state=active]:text-blue-400 data-[state=active]:bg-white dark:data-[state=active]:bg-muted data-[state=active]:shadow-sm data-[state=active]:font-medium border-gray-200 dark:border-border data-[state=active]:border-b-2 data-[state=active]:border-b-blue-600 dark:data-[state=active]:border-b-blue-400",children:"Templates"})]}),u.jsxs("div",{className:"flex-grow mb-0",children:[G&&u.jsx(ry,{forceMount:!0,value:"insights",className:`p-4 ${O==="insights"?"block":"hidden"}`,children:u.jsx(fK,{toggleSection:e,clientEmail:p,setClientEmail:v,setProjectId:b,setDocuments:N,setIsDocumentsLoading:T,setDocumentsError:I,onDocumentView:Se,onRefreshReady:ue=>{Y.current=ue},onGenerateRefresh:ge?()=>{var ue;(ue=$.current)==null||ue.call($)}:void 0,isPrefetchEnabled:ge})}),u.jsx(ry,{forceMount:!0,value:"compose",className:`p-4 ${O==="compose"?"block":"hidden"}`,children:ge?u.jsx(m9,{clientEmail:p,onCmsRefresh:()=>{var ue;(ue=Y.current)==null||ue.call(Y)},onGenerateRefreshReady:ue=>{$.current=ue}}):u.jsx(a9,{clientEmail:p})}),u.jsx(ry,{forceMount:!0,value:"templates",className:`p-4 ${O==="templates"?"block":"hidden"}`,children:u.jsx(_7,{clientEmail:p,isAuthenticated:he})})]})]})})]})," ",r==="login"&&u.jsx("div",{className:"fixed inset-0 bg-white dark:bg-gray-950 z-50",children:u.jsx(g9,{})}),r==="Project Documents"&&(t.debug('[MainPanelContent] activeSection is "Project Documents". Rendering overlay.',{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx",functionName:"MainPanelContent.render",data:{activeSection:r,selectedDocumentToView:D}}),u.jsx("div",{className:"absolute inset-0 bg-white dark:bg-gray-950 z-10",children:D?u.jsx(KR,{documentId:D.documentId,documentName:D.name,onBack:te}):u.jsx(J9,{clientEmail:p,projectId:x,documents:S,isLoading:E,error:A,goBack:te})}))]})]})},SK=()=>{var x;const[r,e]=w.useState(null),t=Jr(),{platform:n}=mn(),s=Qa(),{isConnected:i}=Di();if(w.useEffect(()=>{var E,T;if(n!=="chrome")return;const b=async()=>{var A;try{if((A=chrome==null?void 0:chrome.tabs)!=null&&A.query){const[I]=await chrome.tabs.query({active:!0,currentWindow:!0});if(I!=null&&I.id&&(I!=null&&I.windowId)){let D;try{const j=await(s==null?void 0:s.getCurrentThread());D=j==null?void 0:j.subject}catch(j){t.debug("Could not get email thread subject",{sourceFile:"src/shared/components/sidepanel/TabIndicator.tsx",sourceFunction:"getCurrentTabInfo",error:j})}e({tabId:I.id,windowId:I.windowId,title:I.title,url:I.url,emailSubject:D}),t.debug("Updated tab info in indicator",{sourceFile:"src/shared/components/sidepanel/TabIndicator.tsx",sourceFunction:"getCurrentTabInfo",tabId:I.id,windowId:I.windowId,title:I.title,emailSubject:D})}}}catch(I){t.error("Error getting current tab info",I,{sourceFile:"src/shared/components/sidepanel/TabIndicator.tsx",sourceFunction:"getCurrentTabInfo"})}};b();const S=[];if((E=chrome==null?void 0:chrome.tabs)!=null&&E.onActivated){const A=I=>{t.debug("Tab activated in indicator",{sourceFile:"src/shared/components/sidepanel/TabIndicator.tsx",sourceFunction:"handleTabActivated",tabId:I.tabId,windowId:I.windowId}),setTimeout(b,200)};chrome.tabs.onActivated.addListener(A),S.push(()=>{var I,D;(D=(I=chrome==null?void 0:chrome.tabs)==null?void 0:I.onActivated)!=null&&D.removeListener&&chrome.tabs.onActivated.removeListener(A)})}if((T=chrome==null?void 0:chrome.tabs)!=null&&T.onUpdated){const A=(I,D,j)=>{var O;D.url&&j.active&&j.windowId&&(t.debug("Tab URL updated, refreshing tab indicator",{sourceFile:"src/shared/components/sidepanel/TabIndicator.tsx",sourceFunction:"handleTabUpdated",tabId:I,newUrl:D.url}),setTimeout(b,300)),D.status==="complete"&&j.active&&((O=j.url)!=null&&O.includes("mail.google.com"))&&setTimeout(b,500)};chrome.tabs.onUpdated.addListener(A),S.push(()=>{var I,D;(D=(I=chrome==null?void 0:chrome.tabs)==null?void 0:I.onUpdated)!=null&&D.removeListener&&chrome.tabs.onUpdated.removeListener(A)})}if(s!=null&&s.onThreadChanged){const A=()=>{t.debug("Thread data changed, updating tab indicator",{sourceFile:"src/shared/components/sidepanel/TabIndicator.tsx",sourceFunction:"handleThreadChanged"}),setTimeout(b,100)};s.onThreadChanged(A),S.push(()=>{s.removeThreadListener&&s.removeThreadListener(A)})}const N=setInterval(()=>{b()},3e3);return S.push(()=>{clearInterval(N)}),()=>{S.forEach(A=>A())}},[n,t,s]),n!=="chrome"||!r||!i)return null;const c=()=>{var b;return r.emailSubject&&r.emailSubject!=="No Subject"?r.emailSubject.length>50?`${r.emailSubject.substring(0,50)}...`:r.emailSubject:(b=r.url)!=null&&b.includes("mail.google.com")?"Open an email to begin":r.title?r.title.length>30?`${r.title.substring(0,30)}...`:r.title:"No content available"},d=()=>{var b;return r.emailSubject&&r.emailSubject!=="No Subject"?"border-green-400 bg-green-50 dark:border-green-500 dark:bg-green-950":(b=r.url)!=null&&b.includes("mail.google.com")?"border-yellow-400 bg-yellow-50 dark:border-yellow-500 dark:bg-yellow-950":"border-blue-400 bg-blue-50 dark:border-blue-500 dark:bg-blue-950"},m=()=>{var b;return r.emailSubject&&r.emailSubject!=="No Subject"?"bg-green-400 dark:bg-green-500":(b=r.url)!=null&&b.includes("mail.google.com")?"bg-yellow-400 dark:bg-yellow-500":"bg-blue-400 dark:bg-blue-500"},p=()=>{var b;return r.emailSubject&&r.emailSubject!=="No Subject"?"text-green-800 dark:text-green-200":(b=r.url)!=null&&b.includes("mail.google.com")?"text-yellow-800 dark:text-yellow-200":"text-blue-800 dark:text-blue-200"},v=()=>{var b;return r.emailSubject&&r.emailSubject!=="No Subject"?"text-green-600 dark:text-green-300":(b=r.url)!=null&&b.includes("mail.google.com")?"text-yellow-600 dark:text-yellow-300":"text-blue-600 dark:text-blue-300"};return u.jsx("div",{className:`border-l-4 px-3 py-1.5 mb-2 rounded-r-md ${d()}`,children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"flex-shrink-0",children:u.jsx("div",{className:`w-2 h-2 rounded-full animate-pulse ${m()}`})}),u.jsxs("div",{className:"ml-3 flex-1 min-w-0",children:[u.jsx("p",{className:`text-sm font-medium ${p()}`,children:r.emailSubject&&r.emailSubject!=="No Subject"?"Email Opened":(x=r.url)!=null&&x.includes("mail.google.com")?"No Email Selected":"Active Tab"}),u.jsx("p",{className:`text-sm ${v()} truncate`,title:r.emailSubject||r.title,children:c()})]})]})})},EK=()=>{const{activeSection:r,setActiveSection:e}=LT(),t=p8(),n=g8(),s=Jr(),{platform:i}=mn(),c=d=>{if(s.debug(`toggleSection called with section: "${d}"`,{sourceFile:"src/shared/components/sidepanel/SidePanelContent.tsx",section:d,currentActiveSection:r}),r===d){s.debug(`toggleSection called with section: "${d}" but activeSection is already ${r}`,{sourceFile:"src/shared/components/sidepanel/SidePanelContent.tsx",section:d,currentActiveSection:r});return}else s.debug(`toggleSection called with section: "${d}" changing activeSection from ${r}`,{sourceFile:"src/shared/components/sidepanel/SidePanelContent.tsx",section:d,currentActiveSection:r}),e(d)};return w.useEffect(()=>{if(t!=null&&t.onMessage){const d=async m=>{if(m.type==="USER_LOGGED_OUT"&&(s.info("Received logout notification in sidepanel",{sourceFile:"src/shared/components/sidepanel/SidePanelContent.tsx"}),n!=null&&n.closeWindow))try{await n.closeWindow()}catch(p){s.error("Failed to close window",p,{sourceFile:"src/shared/components/sidepanel/SidePanelContent.tsx"})}};return t.onMessage(d),()=>{t.removeMessageListener&&t.removeMessageListener(d)}}},[t,n,s]),w.useEffect(()=>{if(i==="chrome"&&(t!=null&&t.sendMessage))return t.sendMessage({type:"SIDE_PANEL_MOUNTED"}).catch(()=>{}),()=>{t.sendMessage&&t.sendMessage({type:"SIDE_PANEL_UNMOUNTED"}).catch(()=>{})}},[i,t]),u.jsxs("div",{className:"flex flex-col h-full",children:[r!=="login"&&r!=="Project Documents"&&u.jsx(SK,{}),u.jsx("div",{className:"flex-grow min-h-0",children:u.jsx(_K,{activeSection:r,toggleSection:c})})]})},kK=()=>u.jsx(eK,{children:u.jsx(EK,{})}),CK=({variant:r})=>{const e=`logo ${r?`logo--${r}`:""}`;return u.jsx("div",{className:e,children:"candle"})},NK=({className:r="",variant:e="badge",showLastChecked:t=!1,hideInLogin:n=!1})=>{const[s,i]=w.useState(!1),{isConnected:c,isLoading:d,error:m,status:p,lastChecked:v,reconnectAttempts:x,wasEverConnected:b,initiateReconnection:S,clearError:N,forceRefresh:E}=Di(),{platform:T}=mn();if(T!=="chrome"||n)return null;const A=G=>{switch(G){case"connected":return u.jsx(Jc,{className:"h-4 w-4 text-green-600"});case"disconnected":return u.jsx(eI,{className:"h-4 w-4 text-amber-600"});case"loading":return u.jsx(ia,{className:"h-4 w-4 animate-spin text-blue-600"});case"error":return u.jsx(ih,{className:"h-4 w-4 text-red-600"});default:return u.jsx(eu,{className:"h-4 w-4 text-gray-400"})}},I=G=>{switch(G){case"connected":return"bg-green-50 border-green-200 text-green-800";case"disconnected":return"bg-amber-50 border-amber-200 text-amber-800";case"loading":return"bg-blue-50 border-blue-200 text-blue-800";case"error":return"bg-red-50 border-red-200 text-red-800";default:return"bg-gray-50 border-gray-200 text-gray-600"}},D=G=>{switch(G){case"connected":return"Gmail Connected";case"disconnected":return"Gmail Disconnected";case"loading":return"Checking Connection...";case"error":return"Connection Error";default:return"Unknown Status"}},j=async()=>{try{await S(),i(!1)}catch(G){console.error("Failed to reconnect Gmail:",G)}},O=async()=>{try{await E()}catch(G){console.error("Failed to refresh connection status:",G)}},B=G=>{if(!G)return"Never checked";const re=new Date().getTime()-G.getTime(),se=Math.floor(re/6e4),he=Math.floor(re%6e4/1e3);return se<1?`${he}s ago`:se<60?`${se}m ago`:`${Math.floor(se/60)}h ago`};return e==="minimal"?u.jsxs("div",{className:`flex items-center gap-1 ${r}`,title:D(p),children:[u.jsx("div",{className:"cursor-pointer",title:D(p),"aria-label":D(p),children:A(p)}),!c&&!d&&u.jsx(Ye,{onClick:j,variant:"ghost",size:"sm",className:"h-6 px-2 text-xs",disabled:d,title:b?"Reconnect to Gmail":"Connect to Gmail",children:b?"Reconnect":"Connect"})]}):e==="full"?u.jsxs("div",{className:`flex items-center justify-between p-3 rounded-lg border ${I(p)} ${r}`,children:[u.jsxs("div",{className:"flex items-center gap-3",children:[A(p),u.jsxs("div",{className:"flex-1",children:[u.jsx("p",{className:"text-sm font-medium",children:D(p)}),m&&u.jsx("p",{className:"text-xs mt-1 opacity-80",children:m}),t&&v&&u.jsxs("p",{className:"text-xs mt-1 opacity-60",children:["Last checked: ",B(v)]})]})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[!c&&!d&&u.jsx(Ye,{onClick:j,variant:"outline",size:"sm",className:"text-xs",disabled:d,children:d?u.jsxs(u.Fragment,{children:[u.jsx(ia,{className:"h-3 w-3 mr-1 animate-spin"}),"Connecting..."]}):b?"Reconnect Gmail":"Connect Gmail"}),u.jsx(Ye,{onClick:O,variant:"ghost",size:"sm",className:"p-1",disabled:d,children:u.jsx(si,{className:`h-3 w-3 ${d?"animate-spin":""}`})}),m&&u.jsx(Ye,{onClick:N,variant:"ghost",size:"sm",className:"p-1",children:u.jsx(aa,{className:"h-3 w-3"})})]})]}):u.jsxs(ti,{open:s,onOpenChange:i,children:[u.jsx(ri,{asChild:!0,children:u.jsxs(Ye,{variant:"ghost",size:"sm",className:`h-8 px-2 flex items-center gap-2 ${I(p)} border hover:opacity-80 ${r}`,"aria-label":`Gmail connection status: ${D(p)}`,"aria-expanded":s,"aria-haspopup":"menu",children:[A(p),u.jsx("span",{className:"text-xs font-medium",children:D(p)})]})}),u.jsxs(Po,{align:"end",className:"w-80",children:[u.jsxs("div",{className:"p-3",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[A(p),u.jsx("span",{className:"font-medium text-sm",children:D(p)})]}),m&&u.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-2 mb-3",children:u.jsx("p",{className:"text-xs text-red-800",children:m})}),u.jsxs("div",{className:"text-xs text-gray-600 mb-3",children:[u.jsxs("p",{children:["Last checked: ",B(v)]}),x>0&&u.jsxs("p",{children:["Reconnect attempts: ",x]})]}),p==="connected"&&u.jsx("div",{className:"bg-green-50 border border-green-200 rounded-md p-2 mb-3",children:u.jsx("p",{className:"text-xs text-green-800",children:"Gmail is connected and working properly. All features are available."})}),p==="disconnected"&&u.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-md p-2 mb-3",children:u.jsx("p",{className:"text-xs text-amber-800",children:b?'Gmail connection lost. Some features may not work properly. Click "Reconnect Gmail" to restore connection.':'Gmail connection required. Some features may not work properly. Click "Connect Gmail" to enable all features.'})})]}),u.jsx(Fy,{}),u.jsxs("div",{className:"p-2",children:[u.jsx(Bs,{asChild:!0,children:u.jsxs(Ye,{onClick:O,variant:"ghost",size:"sm",className:"w-full justify-start",disabled:d,children:[u.jsx(si,{className:`h-4 w-4 mr-2 ${d?"animate-spin":""}`}),"Refresh Status"]})}),!c&&u.jsx(Bs,{asChild:!0,children:u.jsx(Ye,{onClick:j,variant:"ghost",size:"sm",className:"w-full justify-start",disabled:d,children:d?u.jsxs(u.Fragment,{children:[u.jsx(ia,{className:"h-4 w-4 mr-2 animate-spin"}),"Connecting..."]}):u.jsxs(u.Fragment,{children:[u.jsx(eu,{className:"h-4 w-4 mr-2"}),b?"Reconnect Gmail":"Connect Gmail"]})})}),m&&u.jsx(Bs,{asChild:!0,children:u.jsxs(Ye,{onClick:N,variant:"ghost",size:"sm",className:"w-full justify-start",children:[u.jsx(aa,{className:"h-4 w-4 mr-2"}),"Clear Error"]})})]})]})]})},TK=({className:r="",variant:e="badge",hideInLogin:t=!1})=>{const{platform:n}=mn();if(n!=="outlook"||t)return null;const s="Outlook Connected";return e==="minimal"?u.jsx("div",{className:`flex items-center gap-1 ${r}`,title:s,children:u.jsx("div",{className:"cursor-pointer",title:s,"aria-label":s,children:u.jsx(Jc,{className:"h-4 w-4 text-green-600"})})}):e==="full"?u.jsx("div",{className:`flex items-center justify-between p-3 rounded-lg border bg-green-50 border-green-200 text-green-800 ${r}`,children:u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx(Jc,{className:"h-4 w-4 text-green-600"}),u.jsx("div",{className:"flex-1",children:u.jsx("p",{className:"text-sm font-medium",children:s})})]})}):u.jsxs("div",{className:`h-8 px-2 flex items-center gap-2 bg-green-50 border-green-200 text-green-800 border rounded ${r}`,children:[u.jsx(Jc,{className:"h-4 w-4 text-green-600"}),u.jsx("span",{className:"text-xs font-medium",children:s})]})},Wf="src/shared/components/sidepanel/mainPanelContent/panelHeader.tsx",AK=r=>u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",width:"18",height:"18",...r,children:[u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),IK=({className:r})=>{const{activeSection:e,setActiveSection:t}=LT(),n=m8(),s=Jr(),i=async()=>{if(n!=null&&n.openOptionsPage)try{await n.openOptionsPage()}catch(m){s.error("Failed to open options page",m,{sourceFile:Wf})}else s.warn("Options page opening not available on this platform",{sourceFile:Wf})},c=async()=>{if(n!=null&&n.openURL)try{await n.openURL(q1,"_blank")}catch(m){s.error("Failed to open feedback form",m,{sourceFile:Wf})}else s.warn("openURL not available on this platform",{sourceFile:Wf})},d=async()=>{s.info("Logout initiated",{sourceFile:Wf});try{await zy(s),await RU(s),await hT(s),t("login")}catch(m){s.error("Failed to logout",m,{sourceFile:Wf})}};return u.jsxs("div",{className:`relative flex items-center justify-between px-3 py-1 bg-blue-600 border-b border-gray-200 text-gray-100 ${r}`,children:[u.jsxs("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2",children:[u.jsx(NK,{variant:"minimal",className:"text-white border-white/20 hover:bg-white/10",hideInLogin:e==="login"}),u.jsx(TK,{variant:"minimal",className:"text-white border-white/20 hover:bg-white/10",hideInLogin:e==="login"})]}),u.jsx("div",{className:"flex-1 flex justify-center",children:u.jsx(CK,{variant:"panel"})}),u.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:u.jsxs(ti,{children:[u.jsx(ri,{asChild:!0,children:u.jsx("button",{className:"p-1 rounded hover:bg-white/10 transition-colors",children:u.jsx(AK,{className:"text-white"})})}),u.jsxs(Po,{align:"end",side:"bottom",sideOffset:5,children:[u.jsx(Bs,{onClick:i,children:"Configure"}),u.jsx(Fy,{}),u.jsx(Bs,{onClick:c,children:"Feedback"}),u.jsx(Fy,{}),u.jsx(Bs,{onClick:d,children:"Logout"})]})]})})]})};function gw(){try{const r=Office.context.officeTheme;if(console.log(" Outlook Theme Detection:",r),r){const e=r.bodyBackgroundColor;if(console.log(" Background Color:",e),e){const t=e.replace("#",""),n=parseInt(t.substring(0,2),16),s=parseInt(t.substring(2,4),16),i=parseInt(t.substring(4,6),16),c=(n+s+i)/3;console.log(` Brightness: ${c} (R:${n}, G:${s}, B:${i})`),c<128?(console.log(" Dark mode detected - applying dark class"),document.documentElement.classList.add("dark")):(console.log(" Light mode detected - removing dark class"),document.documentElement.classList.remove("dark")),console.log(" HTML classes:",document.documentElement.className)}}else console.warn(" Office theme not available")}catch(r){console.error(" Error detecting Outlook theme:",r)}}Office.onReady(()=>{gw(),Office.context.mailbox&&Office.context.mailbox.addHandlerAsync(Office.EventType.OfficeThemeChanged,r=>{console.log(" Office theme changed event triggered"),gw()},r=>{r.status===Office.AsyncResultStatus.Succeeded?console.log(" Office theme change listener added successfully"):console.warn(" Failed to add Office theme change listener:",r.error)}),window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>{console.log(" System color scheme changed:",e.matches?"dark":"light"),gw()}),KO.createRoot(document.getElementById("root")).render(u.jsx(br.StrictMode,{children:u.jsx(T5,{children:u.jsx(y8,{children:u.jsx(x8,{children:u.jsx($H,{children:u.jsxs("div",{className:"sidepanel-container",children:[u.jsx(IK,{className:"sticky top-0 z-50 border-b-0"}),u.jsx(kK,{})]})})})})})}))});export{cd as f,Ly as t};
