const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index.DS5eee3c.js","assets/modulepreload-polyfill.B5Qt9EMX.js"])))=>i.map(i=>d[i]);
var FO=Object.defineProperty;var jO=(r,e,t)=>e in r?FO(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var H=(r,e,t)=>jO(r,typeof e!="symbol"?e+"":e,t);import"./modulepreload-polyfill.B5Qt9EMX.js";function OO(r,e){for(var t=0;t<e.length;t++){const n=e[t];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in r)){const i=Object.getOwnPropertyDescriptor(n,s);i&&Object.defineProperty(r,s,i.get?i:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}))}var bv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Nb(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var lx={exports:{}},Mp={},cx={exports:{}},or={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aS;function DO(){if(aS)return or;aS=1;var r=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),c=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),x=Symbol.iterator;function b(O){return O===null||typeof O!="object"?null:(O=x&&O[x]||O["@@iterator"],typeof O=="function"?O:null)}var E={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},T=Object.assign,S={};function N(O,U,ne){this.props=O,this.context=U,this.refs=S,this.updater=ne||E}N.prototype.isReactComponent={},N.prototype.setState=function(O,U){if(typeof O!="object"&&typeof O!="function"&&O!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,O,U,"setState")},N.prototype.forceUpdate=function(O){this.updater.enqueueForceUpdate(this,O,"forceUpdate")};function R(){}R.prototype=N.prototype;function A(O,U,ne){this.props=O,this.context=U,this.refs=S,this.updater=ne||E}var j=A.prototype=new R;j.constructor=A,T(j,N.prototype),j.isPureReactComponent=!0;var P=Array.isArray,$=Object.prototype.hasOwnProperty,W={current:null},M={key:!0,ref:!0,__self:!0,__source:!0};function V(O,U,ne){var Ee,q={},le=null,xe=null;if(U!=null)for(Ee in U.ref!==void 0&&(xe=U.ref),U.key!==void 0&&(le=""+U.key),U)$.call(U,Ee)&&!M.hasOwnProperty(Ee)&&(q[Ee]=U[Ee]);var ye=arguments.length-2;if(ye===1)q.children=ne;else if(1<ye){for(var de=Array(ye),Te=0;Te<ye;Te++)de[Te]=arguments[Te+2];q.children=de}if(O&&O.defaultProps)for(Ee in ye=O.defaultProps,ye)q[Ee]===void 0&&(q[Ee]=ye[Ee]);return{$$typeof:r,type:O,key:le,ref:xe,props:q,_owner:W.current}}function X(O,U){return{$$typeof:r,type:O.type,key:U,ref:O.ref,props:O.props,_owner:O._owner}}function ie(O){return typeof O=="object"&&O!==null&&O.$$typeof===r}function J(O){var U={"=":"=0",":":"=2"};return"$"+O.replace(/[=:]/g,function(ne){return U[ne]})}var ae=/\/+/g;function we(O,U){return typeof O=="object"&&O!==null&&O.key!=null?J(""+O.key):U.toString(36)}function ue(O,U,ne,Ee,q){var le=typeof O;(le==="undefined"||le==="boolean")&&(O=null);var xe=!1;if(O===null)xe=!0;else switch(le){case"string":case"number":xe=!0;break;case"object":switch(O.$$typeof){case r:case e:xe=!0}}if(xe)return xe=O,q=q(xe),O=Ee===""?"."+we(xe,0):Ee,P(q)?(ne="",O!=null&&(ne=O.replace(ae,"$&/")+"/"),ue(q,U,ne,"",function(Te){return Te})):q!=null&&(ie(q)&&(q=X(q,ne+(!q.key||xe&&xe.key===q.key?"":(""+q.key).replace(ae,"$&/")+"/")+O)),U.push(q)),1;if(xe=0,Ee=Ee===""?".":Ee+":",P(O))for(var ye=0;ye<O.length;ye++){le=O[ye];var de=Ee+we(le,ye);xe+=ue(le,U,ne,de,q)}else if(de=b(O),typeof de=="function")for(O=de.call(O),ye=0;!(le=O.next()).done;)le=le.value,de=Ee+we(le,ye++),xe+=ue(le,U,ne,de,q);else if(le==="object")throw U=String(O),Error("Objects are not valid as a React child (found: "+(U==="[object Object]"?"object with keys {"+Object.keys(O).join(", ")+"}":U)+"). If you meant to render a collection of children, use an array instead.");return xe}function oe(O,U,ne){if(O==null)return O;var Ee=[],q=0;return ue(O,Ee,"","",function(le){return U.call(ne,le,q++)}),Ee}function pe(O){if(O._status===-1){var U=O._result;U=U(),U.then(function(ne){(O._status===0||O._status===-1)&&(O._status=1,O._result=ne)},function(ne){(O._status===0||O._status===-1)&&(O._status=2,O._result=ne)}),O._status===-1&&(O._status=0,O._result=U)}if(O._status===1)return O._result.default;throw O._result}var te={current:null},B={transition:null},z={ReactCurrentDispatcher:te,ReactCurrentBatchConfig:B,ReactCurrentOwner:W};function Y(){throw Error("act(...) is not supported in production builds of React.")}return or.Children={map:oe,forEach:function(O,U,ne){oe(O,function(){U.apply(this,arguments)},ne)},count:function(O){var U=0;return oe(O,function(){U++}),U},toArray:function(O){return oe(O,function(U){return U})||[]},only:function(O){if(!ie(O))throw Error("React.Children.only expected to receive a single React element child.");return O}},or.Component=N,or.Fragment=t,or.Profiler=s,or.PureComponent=A,or.StrictMode=n,or.Suspense=p,or.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=z,or.act=Y,or.cloneElement=function(O,U,ne){if(O==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+O+".");var Ee=T({},O.props),q=O.key,le=O.ref,xe=O._owner;if(U!=null){if(U.ref!==void 0&&(le=U.ref,xe=W.current),U.key!==void 0&&(q=""+U.key),O.type&&O.type.defaultProps)var ye=O.type.defaultProps;for(de in U)$.call(U,de)&&!M.hasOwnProperty(de)&&(Ee[de]=U[de]===void 0&&ye!==void 0?ye[de]:U[de])}var de=arguments.length-2;if(de===1)Ee.children=ne;else if(1<de){ye=Array(de);for(var Te=0;Te<de;Te++)ye[Te]=arguments[Te+2];Ee.children=ye}return{$$typeof:r,type:O.type,key:q,ref:le,props:Ee,_owner:xe}},or.createContext=function(O){return O={$$typeof:c,_currentValue:O,_currentValue2:O,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},O.Provider={$$typeof:i,_context:O},O.Consumer=O},or.createElement=V,or.createFactory=function(O){var U=V.bind(null,O);return U.type=O,U},or.createRef=function(){return{current:null}},or.forwardRef=function(O){return{$$typeof:d,render:O}},or.isValidElement=ie,or.lazy=function(O){return{$$typeof:g,_payload:{_status:-1,_result:O},_init:pe}},or.memo=function(O,U){return{$$typeof:m,type:O,compare:U===void 0?null:U}},or.startTransition=function(O){var U=B.transition;B.transition={};try{O()}finally{B.transition=U}},or.unstable_act=Y,or.useCallback=function(O,U){return te.current.useCallback(O,U)},or.useContext=function(O){return te.current.useContext(O)},or.useDebugValue=function(){},or.useDeferredValue=function(O){return te.current.useDeferredValue(O)},or.useEffect=function(O,U){return te.current.useEffect(O,U)},or.useId=function(){return te.current.useId()},or.useImperativeHandle=function(O,U,ne){return te.current.useImperativeHandle(O,U,ne)},or.useInsertionEffect=function(O,U){return te.current.useInsertionEffect(O,U)},or.useLayoutEffect=function(O,U){return te.current.useLayoutEffect(O,U)},or.useMemo=function(O,U){return te.current.useMemo(O,U)},or.useReducer=function(O,U,ne){return te.current.useReducer(O,U,ne)},or.useRef=function(O){return te.current.useRef(O)},or.useState=function(O){return te.current.useState(O)},or.useSyncExternalStore=function(O,U,ne){return te.current.useSyncExternalStore(O,U,ne)},or.useTransition=function(){return te.current.useTransition()},or.version="18.3.1",or}var lS;function Tb(){return lS||(lS=1,cx.exports=DO()),cx.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cS;function LO(){if(cS)return Mp;cS=1;var r=Tb(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function c(d,p,m){var g,x={},b=null,E=null;m!==void 0&&(b=""+m),p.key!==void 0&&(b=""+p.key),p.ref!==void 0&&(E=p.ref);for(g in p)n.call(p,g)&&!i.hasOwnProperty(g)&&(x[g]=p[g]);if(d&&d.defaultProps)for(g in p=d.defaultProps,p)x[g]===void 0&&(x[g]=p[g]);return{$$typeof:e,type:d,key:b,ref:E,props:x,_owner:s.current}}return Mp.Fragment=t,Mp.jsx=c,Mp.jsxs=c,Mp}var uS;function MO(){return uS||(uS=1,lx.exports=LO()),lx.exports}var u=MO(),w=Tb();const dr=Nb(w),Rb=OO({__proto__:null,default:dr},[w]);var _v={},ux={exports:{}},_o={},dx={exports:{}},fx={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dS;function $O(){return dS||(dS=1,(function(r){function e(B,z){var Y=B.length;B.push(z);e:for(;0<Y;){var O=Y-1>>>1,U=B[O];if(0<s(U,z))B[O]=z,B[Y]=U,Y=O;else break e}}function t(B){return B.length===0?null:B[0]}function n(B){if(B.length===0)return null;var z=B[0],Y=B.pop();if(Y!==z){B[0]=Y;e:for(var O=0,U=B.length,ne=U>>>1;O<ne;){var Ee=2*(O+1)-1,q=B[Ee],le=Ee+1,xe=B[le];if(0>s(q,Y))le<U&&0>s(xe,q)?(B[O]=xe,B[le]=Y,O=le):(B[O]=q,B[Ee]=Y,O=Ee);else if(le<U&&0>s(xe,Y))B[O]=xe,B[le]=Y,O=le;else break e}}return z}function s(B,z){var Y=B.sortIndex-z.sortIndex;return Y!==0?Y:B.id-z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;r.unstable_now=function(){return i.now()}}else{var c=Date,d=c.now();r.unstable_now=function(){return c.now()-d}}var p=[],m=[],g=1,x=null,b=3,E=!1,T=!1,S=!1,N=typeof setTimeout=="function"?setTimeout:null,R=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function j(B){for(var z=t(m);z!==null;){if(z.callback===null)n(m);else if(z.startTime<=B)n(m),z.sortIndex=z.expirationTime,e(p,z);else break;z=t(m)}}function P(B){if(S=!1,j(B),!T)if(t(p)!==null)T=!0,pe($);else{var z=t(m);z!==null&&te(P,z.startTime-B)}}function $(B,z){T=!1,S&&(S=!1,R(V),V=-1),E=!0;var Y=b;try{for(j(z),x=t(p);x!==null&&(!(x.expirationTime>z)||B&&!J());){var O=x.callback;if(typeof O=="function"){x.callback=null,b=x.priorityLevel;var U=O(x.expirationTime<=z);z=r.unstable_now(),typeof U=="function"?x.callback=U:x===t(p)&&n(p),j(z)}else n(p);x=t(p)}if(x!==null)var ne=!0;else{var Ee=t(m);Ee!==null&&te(P,Ee.startTime-z),ne=!1}return ne}finally{x=null,b=Y,E=!1}}var W=!1,M=null,V=-1,X=5,ie=-1;function J(){return!(r.unstable_now()-ie<X)}function ae(){if(M!==null){var B=r.unstable_now();ie=B;var z=!0;try{z=M(!0,B)}finally{z?we():(W=!1,M=null)}}else W=!1}var we;if(typeof A=="function")we=function(){A(ae)};else if(typeof MessageChannel<"u"){var ue=new MessageChannel,oe=ue.port2;ue.port1.onmessage=ae,we=function(){oe.postMessage(null)}}else we=function(){N(ae,0)};function pe(B){M=B,W||(W=!0,we())}function te(B,z){V=N(function(){B(r.unstable_now())},z)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(B){B.callback=null},r.unstable_continueExecution=function(){T||E||(T=!0,pe($))},r.unstable_forceFrameRate=function(B){0>B||125<B?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):X=0<B?Math.floor(1e3/B):5},r.unstable_getCurrentPriorityLevel=function(){return b},r.unstable_getFirstCallbackNode=function(){return t(p)},r.unstable_next=function(B){switch(b){case 1:case 2:case 3:var z=3;break;default:z=b}var Y=b;b=z;try{return B()}finally{b=Y}},r.unstable_pauseExecution=function(){},r.unstable_requestPaint=function(){},r.unstable_runWithPriority=function(B,z){switch(B){case 1:case 2:case 3:case 4:case 5:break;default:B=3}var Y=b;b=B;try{return z()}finally{b=Y}},r.unstable_scheduleCallback=function(B,z,Y){var O=r.unstable_now();switch(typeof Y=="object"&&Y!==null?(Y=Y.delay,Y=typeof Y=="number"&&0<Y?O+Y:O):Y=O,B){case 1:var U=-1;break;case 2:U=250;break;case 5:U=1073741823;break;case 4:U=1e4;break;default:U=5e3}return U=Y+U,B={id:g++,callback:z,priorityLevel:B,startTime:Y,expirationTime:U,sortIndex:-1},Y>O?(B.sortIndex=Y,e(m,B),t(p)===null&&B===t(m)&&(S?(R(V),V=-1):S=!0,te(P,Y-O))):(B.sortIndex=U,e(p,B),T||E||(T=!0,pe($))),B},r.unstable_shouldYield=J,r.unstable_wrapCallback=function(B){var z=b;return function(){var Y=b;b=z;try{return B.apply(this,arguments)}finally{b=Y}}}})(fx)),fx}var fS;function UO(){return fS||(fS=1,dx.exports=$O()),dx.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hS;function zO(){if(hS)return _o;hS=1;var r=Tb(),e=UO();function t(o){for(var a="https://reactjs.org/docs/error-decoder.html?invariant="+o,h=1;h<arguments.length;h++)a+="&args[]="+encodeURIComponent(arguments[h]);return"Minified React error #"+o+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,s={};function i(o,a){c(o,a),c(o+"Capture",a)}function c(o,a){for(s[o]=a,o=0;o<a.length;o++)n.add(a[o])}var d=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),p=Object.prototype.hasOwnProperty,m=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,g={},x={};function b(o){return p.call(x,o)?!0:p.call(g,o)?!1:m.test(o)?x[o]=!0:(g[o]=!0,!1)}function E(o,a,h,v){if(h!==null&&h.type===0)return!1;switch(typeof a){case"function":case"symbol":return!0;case"boolean":return v?!1:h!==null?!h.acceptsBooleans:(o=o.toLowerCase().slice(0,5),o!=="data-"&&o!=="aria-");default:return!1}}function T(o,a,h,v){if(a===null||typeof a>"u"||E(o,a,h,v))return!0;if(v)return!1;if(h!==null)switch(h.type){case 3:return!a;case 4:return a===!1;case 5:return isNaN(a);case 6:return isNaN(a)||1>a}return!1}function S(o,a,h,v,_,k,F){this.acceptsBooleans=a===2||a===3||a===4,this.attributeName=v,this.attributeNamespace=_,this.mustUseProperty=h,this.propertyName=o,this.type=a,this.sanitizeURL=k,this.removeEmptyString=F}var N={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(o){N[o]=new S(o,0,!1,o,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(o){var a=o[0];N[a]=new S(a,1,!1,o[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(o){N[o]=new S(o,2,!1,o.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(o){N[o]=new S(o,2,!1,o,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(o){N[o]=new S(o,3,!1,o.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(o){N[o]=new S(o,3,!0,o,null,!1,!1)}),["capture","download"].forEach(function(o){N[o]=new S(o,4,!1,o,null,!1,!1)}),["cols","rows","size","span"].forEach(function(o){N[o]=new S(o,6,!1,o,null,!1,!1)}),["rowSpan","start"].forEach(function(o){N[o]=new S(o,5,!1,o.toLowerCase(),null,!1,!1)});var R=/[\-:]([a-z])/g;function A(o){return o[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(o){var a=o.replace(R,A);N[a]=new S(a,1,!1,o,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(o){var a=o.replace(R,A);N[a]=new S(a,1,!1,o,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(o){var a=o.replace(R,A);N[a]=new S(a,1,!1,o,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(o){N[o]=new S(o,1,!1,o.toLowerCase(),null,!1,!1)}),N.xlinkHref=new S("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(o){N[o]=new S(o,1,!1,o.toLowerCase(),null,!0,!0)});function j(o,a,h,v){var _=N.hasOwnProperty(a)?N[a]:null;(_!==null?_.type!==0:v||!(2<a.length)||a[0]!=="o"&&a[0]!=="O"||a[1]!=="n"&&a[1]!=="N")&&(T(a,h,_,v)&&(h=null),v||_===null?b(a)&&(h===null?o.removeAttribute(a):o.setAttribute(a,""+h)):_.mustUseProperty?o[_.propertyName]=h===null?_.type===3?!1:"":h:(a=_.attributeName,v=_.attributeNamespace,h===null?o.removeAttribute(a):(_=_.type,h=_===3||_===4&&h===!0?"":""+h,v?o.setAttributeNS(v,a,h):o.setAttribute(a,h))))}var P=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,$=Symbol.for("react.element"),W=Symbol.for("react.portal"),M=Symbol.for("react.fragment"),V=Symbol.for("react.strict_mode"),X=Symbol.for("react.profiler"),ie=Symbol.for("react.provider"),J=Symbol.for("react.context"),ae=Symbol.for("react.forward_ref"),we=Symbol.for("react.suspense"),ue=Symbol.for("react.suspense_list"),oe=Symbol.for("react.memo"),pe=Symbol.for("react.lazy"),te=Symbol.for("react.offscreen"),B=Symbol.iterator;function z(o){return o===null||typeof o!="object"?null:(o=B&&o[B]||o["@@iterator"],typeof o=="function"?o:null)}var Y=Object.assign,O;function U(o){if(O===void 0)try{throw Error()}catch(h){var a=h.stack.trim().match(/\n( *(at )?)/);O=a&&a[1]||""}return`
`+O+o}var ne=!1;function Ee(o,a){if(!o||ne)return"";ne=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(a)if(a=function(){throw Error()},Object.defineProperty(a.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(a,[])}catch(ge){var v=ge}Reflect.construct(o,[],a)}else{try{a.call()}catch(ge){v=ge}o.call(a.prototype)}else{try{throw Error()}catch(ge){v=ge}o()}}catch(ge){if(ge&&v&&typeof ge.stack=="string"){for(var _=ge.stack.split(`
`),k=v.stack.split(`
`),F=_.length-1,G=k.length-1;1<=F&&0<=G&&_[F]!==k[G];)G--;for(;1<=F&&0<=G;F--,G--)if(_[F]!==k[G]){if(F!==1||G!==1)do if(F--,G--,0>G||_[F]!==k[G]){var Q=`
`+_[F].replace(" at new "," at ");return o.displayName&&Q.includes("<anonymous>")&&(Q=Q.replace("<anonymous>",o.displayName)),Q}while(1<=F&&0<=G);break}}}finally{ne=!1,Error.prepareStackTrace=h}return(o=o?o.displayName||o.name:"")?U(o):""}function q(o){switch(o.tag){case 5:return U(o.type);case 16:return U("Lazy");case 13:return U("Suspense");case 19:return U("SuspenseList");case 0:case 2:case 15:return o=Ee(o.type,!1),o;case 11:return o=Ee(o.type.render,!1),o;case 1:return o=Ee(o.type,!0),o;default:return""}}function le(o){if(o==null)return null;if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o;switch(o){case M:return"Fragment";case W:return"Portal";case X:return"Profiler";case V:return"StrictMode";case we:return"Suspense";case ue:return"SuspenseList"}if(typeof o=="object")switch(o.$$typeof){case J:return(o.displayName||"Context")+".Consumer";case ie:return(o._context.displayName||"Context")+".Provider";case ae:var a=o.render;return o=o.displayName,o||(o=a.displayName||a.name||"",o=o!==""?"ForwardRef("+o+")":"ForwardRef"),o;case oe:return a=o.displayName||null,a!==null?a:le(o.type)||"Memo";case pe:a=o._payload,o=o._init;try{return le(o(a))}catch{}}return null}function xe(o){var a=o.type;switch(o.tag){case 24:return"Cache";case 9:return(a.displayName||"Context")+".Consumer";case 10:return(a._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return o=a.render,o=o.displayName||o.name||"",a.displayName||(o!==""?"ForwardRef("+o+")":"ForwardRef");case 7:return"Fragment";case 5:return a;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return le(a);case 8:return a===V?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a}return null}function ye(o){switch(typeof o){case"boolean":case"number":case"string":case"undefined":return o;case"object":return o;default:return""}}function de(o){var a=o.type;return(o=o.nodeName)&&o.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function Te(o){var a=de(o)?"checked":"value",h=Object.getOwnPropertyDescriptor(o.constructor.prototype,a),v=""+o[a];if(!o.hasOwnProperty(a)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var _=h.get,k=h.set;return Object.defineProperty(o,a,{configurable:!0,get:function(){return _.call(this)},set:function(F){v=""+F,k.call(this,F)}}),Object.defineProperty(o,a,{enumerable:h.enumerable}),{getValue:function(){return v},setValue:function(F){v=""+F},stopTracking:function(){o._valueTracker=null,delete o[a]}}}}function Be(o){o._valueTracker||(o._valueTracker=Te(o))}function Ge(o){if(!o)return!1;var a=o._valueTracker;if(!a)return!0;var h=a.getValue(),v="";return o&&(v=de(o)?o.checked?"true":"false":o.value),o=v,o!==h?(a.setValue(o),!0):!1}function Me(o){if(o=o||(typeof document<"u"?document:void 0),typeof o>"u")return null;try{return o.activeElement||o.body}catch{return o.body}}function Ae(o,a){var h=a.checked;return Y({},a,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:h??o._wrapperState.initialChecked})}function ct(o,a){var h=a.defaultValue==null?"":a.defaultValue,v=a.checked!=null?a.checked:a.defaultChecked;h=ye(a.value!=null?a.value:h),o._wrapperState={initialChecked:v,initialValue:h,controlled:a.type==="checkbox"||a.type==="radio"?a.checked!=null:a.value!=null}}function Bt(o,a){a=a.checked,a!=null&&j(o,"checked",a,!1)}function yt(o,a){Bt(o,a);var h=ye(a.value),v=a.type;if(h!=null)v==="number"?(h===0&&o.value===""||o.value!=h)&&(o.value=""+h):o.value!==""+h&&(o.value=""+h);else if(v==="submit"||v==="reset"){o.removeAttribute("value");return}a.hasOwnProperty("value")?Gt(o,a.type,h):a.hasOwnProperty("defaultValue")&&Gt(o,a.type,ye(a.defaultValue)),a.checked==null&&a.defaultChecked!=null&&(o.defaultChecked=!!a.defaultChecked)}function sr(o,a,h){if(a.hasOwnProperty("value")||a.hasOwnProperty("defaultValue")){var v=a.type;if(!(v!=="submit"&&v!=="reset"||a.value!==void 0&&a.value!==null))return;a=""+o._wrapperState.initialValue,h||a===o.value||(o.value=a),o.defaultValue=a}h=o.name,h!==""&&(o.name=""),o.defaultChecked=!!o._wrapperState.initialChecked,h!==""&&(o.name=h)}function Gt(o,a,h){(a!=="number"||Me(o.ownerDocument)!==o)&&(h==null?o.defaultValue=""+o._wrapperState.initialValue:o.defaultValue!==""+h&&(o.defaultValue=""+h))}var Zt=Array.isArray;function Kt(o,a,h,v){if(o=o.options,a){a={};for(var _=0;_<h.length;_++)a["$"+h[_]]=!0;for(h=0;h<o.length;h++)_=a.hasOwnProperty("$"+o[h].value),o[h].selected!==_&&(o[h].selected=_),_&&v&&(o[h].defaultSelected=!0)}else{for(h=""+ye(h),a=null,_=0;_<o.length;_++){if(o[_].value===h){o[_].selected=!0,v&&(o[_].defaultSelected=!0);return}a!==null||o[_].disabled||(a=o[_])}a!==null&&(a.selected=!0)}}function Kr(o,a){if(a.dangerouslySetInnerHTML!=null)throw Error(t(91));return Y({},a,{value:void 0,defaultValue:void 0,children:""+o._wrapperState.initialValue})}function _t(o,a){var h=a.value;if(h==null){if(h=a.children,a=a.defaultValue,h!=null){if(a!=null)throw Error(t(92));if(Zt(h)){if(1<h.length)throw Error(t(93));h=h[0]}a=h}a==null&&(a=""),h=a}o._wrapperState={initialValue:ye(h)}}function Se(o,a){var h=ye(a.value),v=ye(a.defaultValue);h!=null&&(h=""+h,h!==o.value&&(o.value=h),a.defaultValue==null&&o.defaultValue!==h&&(o.defaultValue=h)),v!=null&&(o.defaultValue=""+v)}function $e(o){var a=o.textContent;a===o._wrapperState.initialValue&&a!==""&&a!==null&&(o.value=a)}function Nt(o){switch(o){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function it(o,a){return o==null||o==="http://www.w3.org/1999/xhtml"?Nt(a):o==="http://www.w3.org/2000/svg"&&a==="foreignObject"?"http://www.w3.org/1999/xhtml":o}var dt,Ut=(function(o){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(a,h,v,_){MSApp.execUnsafeLocalFunction(function(){return o(a,h,v,_)})}:o})(function(o,a){if(o.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in o)o.innerHTML=a;else{for(dt=dt||document.createElement("div"),dt.innerHTML="<svg>"+a.valueOf().toString()+"</svg>",a=dt.firstChild;o.firstChild;)o.removeChild(o.firstChild);for(;a.firstChild;)o.appendChild(a.firstChild)}});function Or(o,a){if(a){var h=o.firstChild;if(h&&h===o.lastChild&&h.nodeType===3){h.nodeValue=a;return}}o.textContent=a}var Ke={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Pt=["Webkit","ms","Moz","O"];Object.keys(Ke).forEach(function(o){Pt.forEach(function(a){a=a+o.charAt(0).toUpperCase()+o.substring(1),Ke[a]=Ke[o]})});function Lt(o,a,h){return a==null||typeof a=="boolean"||a===""?"":h||typeof a!="number"||a===0||Ke.hasOwnProperty(o)&&Ke[o]?(""+a).trim():a+"px"}function et(o,a){o=o.style;for(var h in a)if(a.hasOwnProperty(h)){var v=h.indexOf("--")===0,_=Lt(h,a[h],v);h==="float"&&(h="cssFloat"),v?o.setProperty(h,_):o[h]=_}}var er=Y({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function zr(o,a){if(a){if(er[o]&&(a.children!=null||a.dangerouslySetInnerHTML!=null))throw Error(t(137,o));if(a.dangerouslySetInnerHTML!=null){if(a.children!=null)throw Error(t(60));if(typeof a.dangerouslySetInnerHTML!="object"||!("__html"in a.dangerouslySetInnerHTML))throw Error(t(61))}if(a.style!=null&&typeof a.style!="object")throw Error(t(62))}}function kr(o,a){if(o.indexOf("-")===-1)return typeof a.is=="string";switch(o){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wn=null;function Dr(o){return o=o.target||o.srcElement||window,o.correspondingUseElement&&(o=o.correspondingUseElement),o.nodeType===3?o.parentNode:o}var Yr=null,Nn=null,xs=null;function Us(o){if(o=Yn(o)){if(typeof Yr!="function")throw Error(t(280));var a=o.stateNode;a&&(a=zd(a),Yr(o.stateNode,o.type,a))}}function To(o){Nn?xs?xs.push(o):xs=[o]:Nn=o}function Ai(){if(Nn){var o=Nn,a=xs;if(xs=Nn=null,Us(o),a)for(o=0;o<a.length;o++)Us(a[o])}}function Nr(o,a){return o(a)}function Dn(){}var ve=!1;function Ue(o,a,h){if(ve)return o(a,h);ve=!0;try{return Nr(o,a,h)}finally{ve=!1,(Nn!==null||xs!==null)&&(Dn(),Ai())}}function ht(o,a){var h=o.stateNode;if(h===null)return null;var v=zd(h);if(v===null)return null;h=v[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(v=!v.disabled)||(o=o.type,v=!(o==="button"||o==="input"||o==="select"||o==="textarea")),o=!v;break e;default:o=!1}if(o)return null;if(h&&typeof h!="function")throw Error(t(231,a,typeof h));return h}var It=!1;if(d)try{var zt={};Object.defineProperty(zt,"passive",{get:function(){It=!0}}),window.addEventListener("test",zt,zt),window.removeEventListener("test",zt,zt)}catch{It=!1}function lr(o,a,h,v,_,k,F,G,Q){var ge=Array.prototype.slice.call(arguments,3);try{a.apply(h,ge)}catch(Pe){this.onError(Pe)}}var mt=!1,Tt=null,wr=!1,en=null,Ro={onError:function(o){mt=!0,Tt=o}};function aa(o,a,h,v,_,k,F,G,Q){mt=!1,Tt=null,lr.apply(Ro,arguments)}function ss(o,a,h,v,_,k,F,G,Q){if(aa.apply(this,arguments),mt){if(mt){var ge=Tt;mt=!1,Tt=null}else throw Error(t(198));wr||(wr=!0,en=ge)}}function zs(o){var a=o,h=o;if(o.alternate)for(;a.return;)a=a.return;else{o=a;do a=o,(a.flags&4098)!==0&&(h=a.return),o=a.return;while(o)}return a.tag===3?h:null}function Ii(o){if(o.tag===13){var a=o.memoizedState;if(a===null&&(o=o.alternate,o!==null&&(a=o.memoizedState)),a!==null)return a.dehydrated}return null}function la(o){if(zs(o)!==o)throw Error(t(188))}function ca(o){var a=o.alternate;if(!a){if(a=zs(o),a===null)throw Error(t(188));return a!==o?null:o}for(var h=o,v=a;;){var _=h.return;if(_===null)break;var k=_.alternate;if(k===null){if(v=_.return,v!==null){h=v;continue}break}if(_.child===k.child){for(k=_.child;k;){if(k===h)return la(_),o;if(k===v)return la(_),a;k=k.sibling}throw Error(t(188))}if(h.return!==v.return)h=_,v=k;else{for(var F=!1,G=_.child;G;){if(G===h){F=!0,h=_,v=k;break}if(G===v){F=!0,v=_,h=k;break}G=G.sibling}if(!F){for(G=k.child;G;){if(G===h){F=!0,h=k,v=_;break}if(G===v){F=!0,v=k,h=_;break}G=G.sibling}if(!F)throw Error(t(189))}}if(h.alternate!==v)throw Error(t(190))}if(h.tag!==3)throw Error(t(188));return h.stateNode.current===h?o:a}function qa(o){return o=ca(o),o!==null?at(o):null}function at(o){if(o.tag===5||o.tag===6)return o;for(o=o.child;o!==null;){var a=at(o);if(a!==null)return a;o=o.sibling}return null}var Z=e.unstable_scheduleCallback,Oe=e.unstable_cancelCallback,Ze=e.unstable_shouldYield,Tr=e.unstable_requestPaint,Ht=e.unstable_now,Hr=e.unstable_getCurrentPriorityLevel,un=e.unstable_ImmediatePriority,ws=e.unstable_UserBlockingPriority,os=e.unstable_NormalPriority,ti=e.unstable_LowPriority,Br=e.unstable_IdlePriority,ri=null,Ln=null;function md(o){if(Ln&&typeof Ln.onCommitFiberRoot=="function")try{Ln.onCommitFiberRoot(ri,o,void 0,(o.current.flags&128)===128)}catch{}}var Mn=Math.clz32?Math.clz32:ql,tu=Math.log,ru=Math.LN2;function ql(o){return o>>>=0,o===0?32:31-(tu(o)/ru|0)|0}var so=64,Ao=4194304;function oo(o){switch(o&-o){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return o&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return o}}function ni(o,a){var h=o.pendingLanes;if(h===0)return 0;var v=0,_=o.suspendedLanes,k=o.pingedLanes,F=h&268435455;if(F!==0){var G=F&~_;G!==0?v=oo(G):(k&=F,k!==0&&(v=oo(k)))}else F=h&~_,F!==0?v=oo(F):k!==0&&(v=oo(k));if(v===0)return 0;if(a!==0&&a!==v&&(a&_)===0&&(_=v&-v,k=a&-a,_>=k||_===16&&(k&4194240)!==0))return a;if((v&4)!==0&&(v|=h&16),a=o.entangledLanes,a!==0)for(o=o.entanglements,a&=v;0<a;)h=31-Mn(a),_=1<<h,v|=o[h],a&=~_;return v}function gd(o,a){switch(o){case 1:case 2:case 4:return a+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Eh(o,a){for(var h=o.suspendedLanes,v=o.pingedLanes,_=o.expirationTimes,k=o.pendingLanes;0<k;){var F=31-Mn(k),G=1<<F,Q=_[F];Q===-1?((G&h)===0||(G&v)!==0)&&(_[F]=gd(G,a)):Q<=a&&(o.expiredLanes|=G),k&=~G}}function Kl(o){return o=o.pendingLanes&-1073741825,o!==0?o:o&1073741824?1073741824:0}function nu(){var o=so;return so<<=1,(so&4194240)===0&&(so=64),o}function Ka(o){for(var a=[],h=0;31>h;h++)a.push(o);return a}function Ya(o,a,h){o.pendingLanes|=a,a!==536870912&&(o.suspendedLanes=0,o.pingedLanes=0),o=o.eventTimes,a=31-Mn(a),o[a]=h}function vd(o,a){var h=o.pendingLanes&~a;o.pendingLanes=a,o.suspendedLanes=0,o.pingedLanes=0,o.expiredLanes&=a,o.mutableReadLanes&=a,o.entangledLanes&=a,a=o.entanglements;var v=o.eventTimes;for(o=o.expirationTimes;0<h;){var _=31-Mn(h),k=1<<_;a[_]=0,v[_]=-1,o[_]=-1,h&=~k}}function Ja(o,a){var h=o.entangledLanes|=a;for(o=o.entanglements;h;){var v=31-Mn(h),_=1<<v;_&a|o[v]&a&&(o[v]|=a),h&=~_}}var nr=0;function Io(o){return o&=-o,1<o?4<o?(o&268435455)!==0?16:536870912:4:1}var su,Xa,yd,ou,iu,Yl=!1,Qa=[],si=null,Po=null,Fo=null,be=new Map,Le=new Map,He=[],Et="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ft(o,a){switch(o){case"focusin":case"focusout":si=null;break;case"dragenter":case"dragleave":Po=null;break;case"mouseover":case"mouseout":Fo=null;break;case"pointerover":case"pointerout":be.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":Le.delete(a.pointerId)}}function gt(o,a,h,v,_,k){return o===null||o.nativeEvent!==k?(o={blockedOn:a,domEventName:h,eventSystemFlags:v,nativeEvent:k,targetContainers:[_]},a!==null&&(a=Yn(a),a!==null&&Xa(a)),o):(o.eventSystemFlags|=v,a=o.targetContainers,_!==null&&a.indexOf(_)===-1&&a.push(_),o)}function tt(o,a,h,v,_){switch(a){case"focusin":return si=gt(si,o,a,h,v,_),!0;case"dragenter":return Po=gt(Po,o,a,h,v,_),!0;case"mouseover":return Fo=gt(Fo,o,a,h,v,_),!0;case"pointerover":var k=_.pointerId;return be.set(k,gt(be.get(k)||null,o,a,h,v,_)),!0;case"gotpointercapture":return k=_.pointerId,Le.set(k,gt(Le.get(k)||null,o,a,h,v,_)),!0}return!1}function st(o){var a=li(o.target);if(a!==null){var h=zs(a);if(h!==null){if(a=h.tag,a===13){if(a=Ii(h),a!==null){o.blockedOn=a,iu(o.priority,function(){yd(h)});return}}else if(a===3&&h.stateNode.current.memoizedState.isDehydrated){o.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}o.blockedOn=null}function Tn(o){if(o.blockedOn!==null)return!1;for(var a=o.targetContainers;0<a.length;){var h=_d(o.domEventName,o.eventSystemFlags,a[0],o.nativeEvent);if(h===null){h=o.nativeEvent;var v=new h.constructor(h.type,h);wn=v,h.target.dispatchEvent(v),wn=null}else return a=Yn(h),a!==null&&Xa(a),o.blockedOn=h,!1;a.shift()}return!0}function bs(o,a,h){Tn(o)&&h.delete(a)}function xd(){Yl=!1,si!==null&&Tn(si)&&(si=null),Po!==null&&Tn(Po)&&(Po=null),Fo!==null&&Tn(Fo)&&(Fo=null),be.forEach(bs),Le.forEach(bs)}function qt(o,a){o.blockedOn===a&&(o.blockedOn=null,Yl||(Yl=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,xd)))}function vr(o){function a(_){return qt(_,o)}if(0<Qa.length){qt(Qa[0],o);for(var h=1;h<Qa.length;h++){var v=Qa[h];v.blockedOn===o&&(v.blockedOn=null)}}for(si!==null&&qt(si,o),Po!==null&&qt(Po,o),Fo!==null&&qt(Fo,o),be.forEach(a),Le.forEach(a),h=0;h<He.length;h++)v=He[h],v.blockedOn===o&&(v.blockedOn=null);for(;0<He.length&&(h=He[0],h.blockedOn===null);)st(h),h.blockedOn===null&&He.shift()}var jo=P.ReactCurrentBatchConfig,Za=!0;function wd(o,a,h,v){var _=nr,k=jo.transition;jo.transition=null;try{nr=1,Sh(o,a,h,v)}finally{nr=_,jo.transition=k}}function au(o,a,h,v){var _=nr,k=jo.transition;jo.transition=null;try{nr=4,Sh(o,a,h,v)}finally{nr=_,jo.transition=k}}function Sh(o,a,h,v){if(Za){var _=_d(o,a,h,v);if(_===null)zh(o,a,v,bd,h),Ft(o,v);else if(tt(_,o,a,h,v))v.stopPropagation();else if(Ft(o,v),a&4&&-1<Et.indexOf(o)){for(;_!==null;){var k=Yn(_);if(k!==null&&su(k),k=_d(o,a,h,v),k===null&&zh(o,a,v,bd,h),k===_)break;_=k}_!==null&&v.stopPropagation()}else zh(o,a,v,null,h)}}var bd=null;function _d(o,a,h,v){if(bd=null,o=Dr(v),o=li(o),o!==null)if(a=zs(o),a===null)o=null;else if(h=a.tag,h===13){if(o=Ii(a),o!==null)return o;o=null}else if(h===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;o=null}else a!==o&&(o=null);return bd=o,null}function cg(o){switch(o){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Hr()){case un:return 1;case ws:return 4;case os:case ti:return 16;case Br:return 536870912;default:return 16}default:return 16}}var Jr=null,lu=null,oi=null;function Ch(){if(oi)return oi;var o,a=lu,h=a.length,v,_="value"in Jr?Jr.value:Jr.textContent,k=_.length;for(o=0;o<h&&a[o]===_[o];o++);var F=h-o;for(v=1;v<=F&&a[h-v]===_[k-v];v++);return oi=_.slice(o,1<v?1-v:void 0)}function Jl(o){var a=o.keyCode;return"charCode"in o?(o=o.charCode,o===0&&a===13&&(o=13)):o=a,o===10&&(o=13),32<=o||o===13?o:0}function is(){return!0}function kh(){return!1}function _s(o){function a(h,v,_,k,F){this._reactName=h,this._targetInst=_,this.type=v,this.nativeEvent=k,this.target=F,this.currentTarget=null;for(var G in o)o.hasOwnProperty(G)&&(h=o[G],this[G]=h?h(k):k[G]);return this.isDefaultPrevented=(k.defaultPrevented!=null?k.defaultPrevented:k.returnValue===!1)?is:kh,this.isPropagationStopped=kh,this}return Y(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=is)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=is)},persist:function(){},isPersistent:is}),a}var el={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(o){return o.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ed=_s(el),Xl=Y({},el,{view:0,detail:0}),ug=_s(Xl),as,Nh,qn,Sd=Y({},Xl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ph,button:0,buttons:0,relatedTarget:function(o){return o.relatedTarget===void 0?o.fromElement===o.srcElement?o.toElement:o.fromElement:o.relatedTarget},movementX:function(o){return"movementX"in o?o.movementX:(o!==qn&&(qn&&o.type==="mousemove"?(as=o.screenX-qn.screenX,Nh=o.screenY-qn.screenY):Nh=as=0,qn=o),as)},movementY:function(o){return"movementY"in o?o.movementY:Nh}}),Th=_s(Sd),ua=Y({},Sd,{dataTransfer:0}),Cd=_s(ua),Rh=Y({},Xl,{relatedTarget:0}),Lr=_s(Rh),da=Y({},el,{animationName:0,elapsedTime:0,pseudoElement:0}),Ah=_s(da),v0=Y({},el,{clipboardData:function(o){return"clipboardData"in o?o.clipboardData:window.clipboardData}}),Ih=_s(v0),y0=Y({},el,{data:0}),dg=_s(y0),x0={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},fg={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},kd={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ql(o){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(o):(o=kd[o])?!!a[o]:!1}function Ph(){return Ql}var hg=Y({},Xl,{key:function(o){if(o.key){var a=x0[o.key]||o.key;if(a!=="Unidentified")return a}return o.type==="keypress"?(o=Jl(o),o===13?"Enter":String.fromCharCode(o)):o.type==="keydown"||o.type==="keyup"?fg[o.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ph,charCode:function(o){return o.type==="keypress"?Jl(o):0},keyCode:function(o){return o.type==="keydown"||o.type==="keyup"?o.keyCode:0},which:function(o){return o.type==="keypress"?Jl(o):o.type==="keydown"||o.type==="keyup"?o.keyCode:0}}),pg=_s(hg),Fh=Y({},Sd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Nd=_s(Fh),mg=Y({},Xl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ph}),w0=_s(mg),jh=Y({},el,{propertyName:0,elapsedTime:0,pseudoElement:0}),Oh=_s(jh),b0=Y({},Sd,{deltaX:function(o){return"deltaX"in o?o.deltaX:"wheelDeltaX"in o?-o.wheelDeltaX:0},deltaY:function(o){return"deltaY"in o?o.deltaY:"wheelDeltaY"in o?-o.wheelDeltaY:"wheelDelta"in o?-o.wheelDelta:0},deltaZ:0,deltaMode:0}),gg=_s(b0),Hs=[9,13,27,32],cu=d&&"CompositionEvent"in window,Pi=null;d&&"documentMode"in document&&(Pi=document.documentMode);var vg=d&&"TextEvent"in window&&!Pi,Dh=d&&(!cu||Pi&&8<Pi&&11>=Pi),yg=" ",xg=!1;function wg(o,a){switch(o){case"keyup":return Hs.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function bg(o){return o=o.detail,typeof o=="object"&&"data"in o?o.data:null}var Zl=!1;function ec(o,a){switch(o){case"compositionend":return bg(a);case"keypress":return a.which!==32?null:(xg=!0,yg);case"textInput":return o=a.data,o===yg&&xg?null:o;default:return null}}function _0(o,a){if(Zl)return o==="compositionend"||!cu&&wg(o,a)?(o=Ch(),oi=lu=Jr=null,Zl=!1,o):null;switch(o){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return Dh&&a.locale!=="ko"?null:a.data;default:return null}}var E0={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Td(o){var a=o&&o.nodeName&&o.nodeName.toLowerCase();return a==="input"?!!E0[o.type]:a==="textarea"}function Lh(o,a,h,v){To(v),a=Ld(a,"onChange"),0<a.length&&(h=new Ed("onChange","change",null,h,v),o.push({event:h,listeners:a}))}var io=null,fa=null;function S0(o){Tg(o,0)}function Rd(o){var a=Wt(o);if(Ge(a))return o}function C0(o,a){if(o==="change")return a}var tl=!1;if(d){var Bs;if(d){var Ad="oninput"in document;if(!Ad){var _g=document.createElement("div");_g.setAttribute("oninput","return;"),Ad=typeof _g.oninput=="function"}Bs=Ad}else Bs=!1;tl=Bs&&(!document.documentMode||9<document.documentMode)}function Eg(){io&&(io.detachEvent("onpropertychange",Sg),fa=io=null)}function Sg(o){if(o.propertyName==="value"&&Rd(fa)){var a=[];Lh(a,fa,o,Dr(o)),Ue(S0,a)}}function k0(o,a,h){o==="focusin"?(Eg(),io=a,fa=h,io.attachEvent("onpropertychange",Sg)):o==="focusout"&&Eg()}function N0(o){if(o==="selectionchange"||o==="keyup"||o==="keydown")return Rd(fa)}function tc(o,a){if(o==="click")return Rd(a)}function se(o,a){if(o==="input"||o==="change")return Rd(a)}function Ce(o,a){return o===a&&(o!==0||1/o===1/a)||o!==o&&a!==a}var me=typeof Object.is=="function"?Object.is:Ce;function Ye(o,a){if(me(o,a))return!0;if(typeof o!="object"||o===null||typeof a!="object"||a===null)return!1;var h=Object.keys(o),v=Object.keys(a);if(h.length!==v.length)return!1;for(v=0;v<h.length;v++){var _=h[v];if(!p.call(a,_)||!me(o[_],a[_]))return!1}return!0}function Mt(o){for(;o&&o.firstChild;)o=o.firstChild;return o}function yr(o,a){var h=Mt(o);o=0;for(var v;h;){if(h.nodeType===3){if(v=o+h.textContent.length,o<=a&&v>=a)return{node:h,offset:a-o};o=v}e:{for(;h;){if(h.nextSibling){h=h.nextSibling;break e}h=h.parentNode}h=void 0}h=Mt(h)}}function mn(o,a){return o&&a?o===a?!0:o&&o.nodeType===3?!1:a&&a.nodeType===3?mn(o,a.parentNode):"contains"in o?o.contains(a):o.compareDocumentPosition?!!(o.compareDocumentPosition(a)&16):!1:!1}function Ar(){for(var o=window,a=Me();a instanceof o.HTMLIFrameElement;){try{var h=typeof a.contentWindow.location.href=="string"}catch{h=!1}if(h)o=a.contentWindow;else break;a=Me(o.document)}return a}function uu(o){var a=o&&o.nodeName&&o.nodeName.toLowerCase();return a&&(a==="input"&&(o.type==="text"||o.type==="search"||o.type==="tel"||o.type==="url"||o.type==="password")||a==="textarea"||o.contentEditable==="true")}function T0(o){var a=Ar(),h=o.focusedElem,v=o.selectionRange;if(a!==h&&h&&h.ownerDocument&&mn(h.ownerDocument.documentElement,h)){if(v!==null&&uu(h)){if(a=v.start,o=v.end,o===void 0&&(o=a),"selectionStart"in h)h.selectionStart=a,h.selectionEnd=Math.min(o,h.value.length);else if(o=(a=h.ownerDocument||document)&&a.defaultView||window,o.getSelection){o=o.getSelection();var _=h.textContent.length,k=Math.min(v.start,_);v=v.end===void 0?k:Math.min(v.end,_),!o.extend&&k>v&&(_=v,v=k,k=_),_=yr(h,k);var F=yr(h,v);_&&F&&(o.rangeCount!==1||o.anchorNode!==_.node||o.anchorOffset!==_.offset||o.focusNode!==F.node||o.focusOffset!==F.offset)&&(a=a.createRange(),a.setStart(_.node,_.offset),o.removeAllRanges(),k>v?(o.addRange(a),o.extend(F.node,F.offset)):(a.setEnd(F.node,F.offset),o.addRange(a)))}}for(a=[],o=h;o=o.parentNode;)o.nodeType===1&&a.push({element:o,left:o.scrollLeft,top:o.scrollTop});for(typeof h.focus=="function"&&h.focus(),h=0;h<a.length;h++)o=a[h],o.element.scrollLeft=o.left,o.element.scrollTop=o.top}}var ao=d&&"documentMode"in document&&11>=document.documentMode,Fi=null,Mh=null,ii=null,rc=!1;function du(o,a,h){var v=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;rc||Fi==null||Fi!==Me(v)||(v=Fi,"selectionStart"in v&&uu(v)?v={start:v.selectionStart,end:v.selectionEnd}:(v=(v.ownerDocument&&v.ownerDocument.defaultView||window).getSelection(),v={anchorNode:v.anchorNode,anchorOffset:v.anchorOffset,focusNode:v.focusNode,focusOffset:v.focusOffset}),ii&&Ye(ii,v)||(ii=v,v=Ld(Mh,"onSelect"),0<v.length&&(a=new Ed("onSelect","select",null,a,h),o.push({event:a,listeners:v}),a.target=Fi)))}function pr(o,a){var h={};return h[o.toLowerCase()]=a.toLowerCase(),h["Webkit"+o]="webkit"+a,h["Moz"+o]="moz"+a,h}var nc={animationend:pr("Animation","AnimationEnd"),animationiteration:pr("Animation","AnimationIteration"),animationstart:pr("Animation","AnimationStart"),transitionend:pr("Transition","TransitionEnd")},Id={},fu={};d&&(fu=document.createElement("div").style,"AnimationEvent"in window||(delete nc.animationend.animation,delete nc.animationiteration.animation,delete nc.animationstart.animation),"TransitionEvent"in window||delete nc.transitionend.transition);function Pd(o){if(Id[o])return Id[o];if(!nc[o])return o;var a=nc[o],h;for(h in a)if(a.hasOwnProperty(h)&&h in fu)return Id[o]=a[h];return o}var Cg=Pd("animationend"),kg=Pd("animationiteration"),hu=Pd("animationstart"),ji=Pd("transitionend"),pu=new Map,$h="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Oo(o,a){pu.set(o,a),i(a,[o])}for(var Fd=0;Fd<$h.length;Fd++){var jd=$h[Fd],Od=jd.toLowerCase(),Ng=jd[0].toUpperCase()+jd.slice(1);Oo(Od,"on"+Ng)}Oo(Cg,"onAnimationEnd"),Oo(kg,"onAnimationIteration"),Oo(hu,"onAnimationStart"),Oo("dblclick","onDoubleClick"),Oo("focusin","onFocus"),Oo("focusout","onBlur"),Oo(ji,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),i("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),i("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),i("onBeforeInput",["compositionend","keypress","textInput","paste"]),i("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Oi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),rl=new Set("cancel close invalid load scroll toggle".split(" ").concat(Oi));function mu(o,a,h){var v=o.type||"unknown-event";o.currentTarget=h,ss(v,a,void 0,o),o.currentTarget=null}function Tg(o,a){a=(a&4)!==0;for(var h=0;h<o.length;h++){var v=o[h],_=v.event;v=v.listeners;e:{var k=void 0;if(a)for(var F=v.length-1;0<=F;F--){var G=v[F],Q=G.instance,ge=G.currentTarget;if(G=G.listener,Q!==k&&_.isPropagationStopped())break e;mu(_,G,ge),k=Q}else for(F=0;F<v.length;F++){if(G=v[F],Q=G.instance,ge=G.currentTarget,G=G.listener,Q!==k&&_.isPropagationStopped())break e;mu(_,G,ge),k=Q}}}if(wr)throw o=en,wr=!1,en=null,o}function Gr(o,a){var h=a[Ud];h===void 0&&(h=a[Ud]=new Set);var v=o+"__bubble";h.has(v)||(Dd(a,o,2,!1),h.add(v))}function Uh(o,a,h){var v=0;a&&(v|=4),Dd(h,o,v,a)}var nl="_reactListening"+Math.random().toString(36).slice(2);function ha(o){if(!o[nl]){o[nl]=!0,n.forEach(function(h){h!=="selectionchange"&&(rl.has(h)||Uh(h,!1,o),Uh(h,!0,o))});var a=o.nodeType===9?o:o.ownerDocument;a===null||a[nl]||(a[nl]=!0,Uh("selectionchange",!1,a))}}function Dd(o,a,h,v){switch(cg(a)){case 1:var _=wd;break;case 4:_=au;break;default:_=Sh}h=_.bind(null,a,h,o),_=void 0,!It||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(_=!0),v?_!==void 0?o.addEventListener(a,h,{capture:!0,passive:_}):o.addEventListener(a,h,!0):_!==void 0?o.addEventListener(a,h,{passive:_}):o.addEventListener(a,h,!1)}function zh(o,a,h,v,_){var k=v;if((a&1)===0&&(a&2)===0&&v!==null)e:for(;;){if(v===null)return;var F=v.tag;if(F===3||F===4){var G=v.stateNode.containerInfo;if(G===_||G.nodeType===8&&G.parentNode===_)break;if(F===4)for(F=v.return;F!==null;){var Q=F.tag;if((Q===3||Q===4)&&(Q=F.stateNode.containerInfo,Q===_||Q.nodeType===8&&Q.parentNode===_))return;F=F.return}for(;G!==null;){if(F=li(G),F===null)return;if(Q=F.tag,Q===5||Q===6){v=k=F;continue e}G=G.parentNode}}v=v.return}Ue(function(){var ge=k,Pe=Dr(h),je=[];e:{var Ie=pu.get(o);if(Ie!==void 0){var Je=Ed,nt=o;switch(o){case"keypress":if(Jl(h)===0)break e;case"keydown":case"keyup":Je=pg;break;case"focusin":nt="focus",Je=Lr;break;case"focusout":nt="blur",Je=Lr;break;case"beforeblur":case"afterblur":Je=Lr;break;case"click":if(h.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Je=Th;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Je=Cd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Je=w0;break;case Cg:case kg:case hu:Je=Ah;break;case ji:Je=Oh;break;case"scroll":Je=ug;break;case"wheel":Je=gg;break;case"copy":case"cut":case"paste":Je=Ih;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Je=Nd}var ot=(a&4)!==0,fn=!ot&&o==="scroll",fe=ot?Ie!==null?Ie+"Capture":null:Ie;ot=[];for(var re=ge,he;re!==null;){he=re;var De=he.stateNode;if(he.tag===5&&De!==null&&(he=De,fe!==null&&(De=ht(re,fe),De!=null&&ot.push(sc(re,De,he)))),fn)break;re=re.return}0<ot.length&&(Ie=new Je(Ie,nt,null,h,Pe),je.push({event:Ie,listeners:ot}))}}if((a&7)===0){e:{if(Ie=o==="mouseover"||o==="pointerover",Je=o==="mouseout"||o==="pointerout",Ie&&h!==wn&&(nt=h.relatedTarget||h.fromElement)&&(li(nt)||nt[Gs]))break e;if((Je||Ie)&&(Ie=Pe.window===Pe?Pe:(Ie=Pe.ownerDocument)?Ie.defaultView||Ie.parentWindow:window,Je?(nt=h.relatedTarget||h.toElement,Je=ge,nt=nt?li(nt):null,nt!==null&&(fn=zs(nt),nt!==fn||nt.tag!==5&&nt.tag!==6)&&(nt=null)):(Je=null,nt=ge),Je!==nt)){if(ot=Th,De="onMouseLeave",fe="onMouseEnter",re="mouse",(o==="pointerout"||o==="pointerover")&&(ot=Nd,De="onPointerLeave",fe="onPointerEnter",re="pointer"),fn=Je==null?Ie:Wt(Je),he=nt==null?Ie:Wt(nt),Ie=new ot(De,re+"leave",Je,h,Pe),Ie.target=fn,Ie.relatedTarget=he,De=null,li(Pe)===ge&&(ot=new ot(fe,re+"enter",nt,h,Pe),ot.target=he,ot.relatedTarget=fn,De=ot),fn=De,Je&&nt)t:{for(ot=Je,fe=nt,re=0,he=ot;he;he=oc(he))re++;for(he=0,De=fe;De;De=oc(De))he++;for(;0<re-he;)ot=oc(ot),re--;for(;0<he-re;)fe=oc(fe),he--;for(;re--;){if(ot===fe||fe!==null&&ot===fe.alternate)break t;ot=oc(ot),fe=oc(fe)}ot=null}else ot=null;Je!==null&&gn(je,Ie,Je,ot,!1),nt!==null&&fn!==null&&gn(je,fn,nt,ot,!0)}}e:{if(Ie=ge?Wt(ge):window,Je=Ie.nodeName&&Ie.nodeName.toLowerCase(),Je==="select"||Je==="input"&&Ie.type==="file")var lt=C0;else if(Td(Ie))if(tl)lt=se;else{lt=N0;var St=k0}else(Je=Ie.nodeName)&&Je.toLowerCase()==="input"&&(Ie.type==="checkbox"||Ie.type==="radio")&&(lt=tc);if(lt&&(lt=lt(o,ge))){Lh(je,lt,h,Pe);break e}St&&St(o,Ie,ge),o==="focusout"&&(St=Ie._wrapperState)&&St.controlled&&Ie.type==="number"&&Gt(Ie,"number",Ie.value)}switch(St=ge?Wt(ge):window,o){case"focusin":(Td(St)||St.contentEditable==="true")&&(Fi=St,Mh=ge,ii=null);break;case"focusout":ii=Mh=Fi=null;break;case"mousedown":rc=!0;break;case"contextmenu":case"mouseup":case"dragend":rc=!1,du(je,h,Pe);break;case"selectionchange":if(ao)break;case"keydown":case"keyup":du(je,h,Pe)}var vt;if(cu)e:{switch(o){case"compositionstart":var jt="onCompositionStart";break e;case"compositionend":jt="onCompositionEnd";break e;case"compositionupdate":jt="onCompositionUpdate";break e}jt=void 0}else Zl?wg(o,h)&&(jt="onCompositionEnd"):o==="keydown"&&h.keyCode===229&&(jt="onCompositionStart");jt&&(Dh&&h.locale!=="ko"&&(Zl||jt!=="onCompositionStart"?jt==="onCompositionEnd"&&Zl&&(vt=Ch()):(Jr=Pe,lu="value"in Jr?Jr.value:Jr.textContent,Zl=!0)),St=Ld(ge,jt),0<St.length&&(jt=new dg(jt,o,null,h,Pe),je.push({event:jt,listeners:St}),vt?jt.data=vt:(vt=bg(h),vt!==null&&(jt.data=vt)))),(vt=vg?ec(o,h):_0(o,h))&&(ge=Ld(ge,"onBeforeInput"),0<ge.length&&(Pe=new dg("onBeforeInput","beforeinput",null,h,Pe),je.push({event:Pe,listeners:ge}),Pe.data=vt))}Tg(je,a)})}function sc(o,a,h){return{instance:o,listener:a,currentTarget:h}}function Ld(o,a){for(var h=a+"Capture",v=[];o!==null;){var _=o,k=_.stateNode;_.tag===5&&k!==null&&(_=k,k=ht(o,h),k!=null&&v.unshift(sc(o,k,_)),k=ht(o,a),k!=null&&v.push(sc(o,k,_))),o=o.return}return v}function oc(o){if(o===null)return null;do o=o.return;while(o&&o.tag!==5);return o||null}function gn(o,a,h,v,_){for(var k=a._reactName,F=[];h!==null&&h!==v;){var G=h,Q=G.alternate,ge=G.stateNode;if(Q!==null&&Q===v)break;G.tag===5&&ge!==null&&(G=ge,_?(Q=ht(h,k),Q!=null&&F.unshift(sc(h,Q,G))):_||(Q=ht(h,k),Q!=null&&F.push(sc(h,Q,G)))),h=h.return}F.length!==0&&o.push({event:a,listeners:F})}var Kn=/\r\n?/g,R0=/\u0000|\uFFFD/g;function Rg(o){return(typeof o=="string"?o:""+o).replace(Kn,`
`).replace(R0,"")}function gu(o,a,h){if(a=Rg(a),Rg(o)!==a&&h)throw Error(t(425))}function Md(){}var vu=null,sl=null;function yu(o,a){return o==="textarea"||o==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var pa=typeof setTimeout=="function"?setTimeout:void 0,xu=typeof clearTimeout=="function"?clearTimeout:void 0,ic=typeof Promise=="function"?Promise:void 0,$d=typeof queueMicrotask=="function"?queueMicrotask:typeof ic<"u"?function(o){return ic.resolve(null).then(o).catch(ac)}:pa;function ac(o){setTimeout(function(){throw o})}function Hh(o,a){var h=a,v=0;do{var _=h.nextSibling;if(o.removeChild(h),_&&_.nodeType===8)if(h=_.data,h==="/$"){if(v===0){o.removeChild(_),vr(a);return}v--}else h!=="$"&&h!=="$?"&&h!=="$!"||v++;h=_}while(h);vr(a)}function ma(o){for(;o!=null;o=o.nextSibling){var a=o.nodeType;if(a===1||a===3)break;if(a===8){if(a=o.data,a==="$"||a==="$!"||a==="$?")break;if(a==="/$")return null}}return o}function Ag(o){o=o.previousSibling;for(var a=0;o;){if(o.nodeType===8){var h=o.data;if(h==="$"||h==="$!"||h==="$?"){if(a===0)return o;a--}else h==="/$"&&a++}o=o.previousSibling}return null}var lc=Math.random().toString(36).slice(2),ai="__reactFiber$"+lc,ga="__reactProps$"+lc,Gs="__reactContainer$"+lc,Ud="__reactEvents$"+lc,D="__reactListeners$"+lc,cc="__reactHandles$"+lc;function li(o){var a=o[ai];if(a)return a;for(var h=o.parentNode;h;){if(a=h[Gs]||h[ai]){if(h=a.alternate,a.child!==null||h!==null&&h.child!==null)for(o=Ag(o);o!==null;){if(h=o[ai])return h;o=Ag(o)}return a}o=h,h=o.parentNode}return null}function Yn(o){return o=o[ai]||o[Gs],!o||o.tag!==5&&o.tag!==6&&o.tag!==13&&o.tag!==3?null:o}function Wt(o){if(o.tag===5||o.tag===6)return o.stateNode;throw Error(t(33))}function zd(o){return o[ga]||null}var Bh=[],uc=-1;function Es(o){return{current:o}}function Wr(o){0>uc||(o.current=Bh[uc],Bh[uc]=null,uc--)}function Mr(o,a){uc++,Bh[uc]=o.current,o.current=a}var va={},Jn=Es(va),Ss=Es(!1),ls=va;function dc(o,a){var h=o.type.contextTypes;if(!h)return va;var v=o.stateNode;if(v&&v.__reactInternalMemoizedUnmaskedChildContext===a)return v.__reactInternalMemoizedMaskedChildContext;var _={},k;for(k in h)_[k]=a[k];return v&&(o=o.stateNode,o.__reactInternalMemoizedUnmaskedChildContext=a,o.__reactInternalMemoizedMaskedChildContext=_),_}function Cs(o){return o=o.childContextTypes,o!=null}function Hd(){Wr(Ss),Wr(Jn)}function Ig(o,a,h){if(Jn.current!==va)throw Error(t(168));Mr(Jn,a),Mr(Ss,h)}function Pg(o,a,h){var v=o.stateNode;if(a=a.childContextTypes,typeof v.getChildContext!="function")return h;v=v.getChildContext();for(var _ in v)if(!(_ in a))throw Error(t(108,xe(o)||"Unknown",_));return Y({},h,v)}function lo(o){return o=(o=o.stateNode)&&o.__reactInternalMemoizedMergedChildContext||va,ls=Jn.current,Mr(Jn,o),Mr(Ss,Ss.current),!0}function Fg(o,a,h){var v=o.stateNode;if(!v)throw Error(t(169));h?(o=Pg(o,a,ls),v.__reactInternalMemoizedMergedChildContext=o,Wr(Ss),Wr(Jn),Mr(Jn,o)):Wr(Ss),Mr(Ss,h)}var Di=null,Bd=!1,Gh=!1;function jg(o){Di===null?Di=[o]:Di.push(o)}function ol(o){Bd=!0,jg(o)}function ya(){if(!Gh&&Di!==null){Gh=!0;var o=0,a=nr;try{var h=Di;for(nr=1;o<h.length;o++){var v=h[o];do v=v(!0);while(v!==null)}Di=null,Bd=!1}catch(_){throw Di!==null&&(Di=Di.slice(o+1)),Z(un,ya),_}finally{nr=a,Gh=!1}}return null}var fc=[],Xn=0,Gd=null,Wd=0,co=[],uo=0,il=null,ci=1,ui="";function al(o,a){fc[Xn++]=Wd,fc[Xn++]=Gd,Gd=o,Wd=a}function Og(o,a,h){co[uo++]=ci,co[uo++]=ui,co[uo++]=il,il=o;var v=ci;o=ui;var _=32-Mn(v)-1;v&=~(1<<_),h+=1;var k=32-Mn(a)+_;if(30<k){var F=_-_%5;k=(v&(1<<F)-1).toString(32),v>>=F,_-=F,ci=1<<32-Mn(a)+_|h<<_|v,ui=k+o}else ci=1<<k|h<<_|v,ui=o}function wu(o){o.return!==null&&(al(o,1),Og(o,1,0))}function ll(o){for(;o===Gd;)Gd=fc[--Xn],fc[Xn]=null,Wd=fc[--Xn],fc[Xn]=null;for(;o===il;)il=co[--uo],co[uo]=null,ui=co[--uo],co[uo]=null,ci=co[--uo],co[uo]=null}var Qn=null,Ws=null,Vr=!1,Do=null;function di(o,a){var h=yo(5,null,null,0);h.elementType="DELETED",h.stateNode=a,h.return=o,a=o.deletions,a===null?(o.deletions=[h],o.flags|=16):a.push(h)}function Vd(o,a){switch(o.tag){case 5:var h=o.type;return a=a.nodeType!==1||h.toLowerCase()!==a.nodeName.toLowerCase()?null:a,a!==null?(o.stateNode=a,Qn=o,Ws=ma(a.firstChild),!0):!1;case 6:return a=o.pendingProps===""||a.nodeType!==3?null:a,a!==null?(o.stateNode=a,Qn=o,Ws=null,!0):!1;case 13:return a=a.nodeType!==8?null:a,a!==null?(h=il!==null?{id:ci,overflow:ui}:null,o.memoizedState={dehydrated:a,treeContext:h,retryLane:1073741824},h=yo(18,null,null,0),h.stateNode=a,h.return=o,o.child=h,Qn=o,Ws=null,!0):!1;default:return!1}}function Li(o){return(o.mode&1)!==0&&(o.flags&128)===0}function ks(o){if(Vr){var a=Ws;if(a){var h=a;if(!Vd(o,a)){if(Li(o))throw Error(t(418));a=ma(h.nextSibling);var v=Qn;a&&Vd(o,a)?di(v,h):(o.flags=o.flags&-4097|2,Vr=!1,Qn=o)}}else{if(Li(o))throw Error(t(418));o.flags=o.flags&-4097|2,Vr=!1,Qn=o}}}function Dg(o){for(o=o.return;o!==null&&o.tag!==5&&o.tag!==3&&o.tag!==13;)o=o.return;Qn=o}function bu(o){if(o!==Qn)return!1;if(!Vr)return Dg(o),Vr=!0,!1;var a;if((a=o.tag!==3)&&!(a=o.tag!==5)&&(a=o.type,a=a!=="head"&&a!=="body"&&!yu(o.type,o.memoizedProps)),a&&(a=Ws)){if(Li(o))throw Wh(),Error(t(418));for(;a;)di(o,a),a=ma(a.nextSibling)}if(Dg(o),o.tag===13){if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(t(317));e:{for(o=o.nextSibling,a=0;o;){if(o.nodeType===8){var h=o.data;if(h==="/$"){if(a===0){Ws=ma(o.nextSibling);break e}a--}else h!=="$"&&h!=="$!"&&h!=="$?"||a++}o=o.nextSibling}Ws=null}}else Ws=Qn?ma(o.stateNode.nextSibling):null;return!0}function Wh(){for(var o=Ws;o;)o=ma(o.nextSibling)}function fi(){Ws=Qn=null,Vr=!1}function hi(o){Do===null?Do=[o]:Do.push(o)}var Lg=P.ReactCurrentBatchConfig;function _u(o,a,h){if(o=h.ref,o!==null&&typeof o!="function"&&typeof o!="object"){if(h._owner){if(h=h._owner,h){if(h.tag!==1)throw Error(t(309));var v=h.stateNode}if(!v)throw Error(t(147,o));var _=v,k=""+o;return a!==null&&a.ref!==null&&typeof a.ref=="function"&&a.ref._stringRef===k?a.ref:(a=function(F){var G=_.refs;F===null?delete G[k]:G[k]=F},a._stringRef=k,a)}if(typeof o!="string")throw Error(t(284));if(!h._owner)throw Error(t(290,o))}return o}function cl(o,a){throw o=Object.prototype.toString.call(a),Error(t(31,o==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":o))}function Mg(o){var a=o._init;return a(o._payload)}function Vh(o){function a(fe,re){if(o){var he=fe.deletions;he===null?(fe.deletions=[re],fe.flags|=16):he.push(re)}}function h(fe,re){if(!o)return null;for(;re!==null;)a(fe,re),re=re.sibling;return null}function v(fe,re){for(fe=new Map;re!==null;)re.key!==null?fe.set(re.key,re):fe.set(re.index,re),re=re.sibling;return fe}function _(fe,re){return fe=Bo(fe,re),fe.index=0,fe.sibling=null,fe}function k(fe,re,he){return fe.index=he,o?(he=fe.alternate,he!==null?(he=he.index,he<re?(fe.flags|=2,re):he):(fe.flags|=2,re)):(fe.flags|=1048576,re)}function F(fe){return o&&fe.alternate===null&&(fe.flags|=2),fe}function G(fe,re,he,De){return re===null||re.tag!==6?(re=Pp(he,fe.mode,De),re.return=fe,re):(re=_(re,he),re.return=fe,re)}function Q(fe,re,he,De){var lt=he.type;return lt===M?Pe(fe,re,he.props.children,De,he.key):re!==null&&(re.elementType===lt||typeof lt=="object"&&lt!==null&&lt.$$typeof===pe&&Mg(lt)===re.type)?(De=_(re,he.props),De.ref=_u(fe,re,he),De.return=fe,De):(De=Tf(he.type,he.key,he.props,null,fe.mode,De),De.ref=_u(fe,re,he),De.return=fe,De)}function ge(fe,re,he,De){return re===null||re.tag!==4||re.stateNode.containerInfo!==he.containerInfo||re.stateNode.implementation!==he.implementation?(re=Fp(he,fe.mode,De),re.return=fe,re):(re=_(re,he.children||[]),re.return=fe,re)}function Pe(fe,re,he,De,lt){return re===null||re.tag!==7?(re=wl(he,fe.mode,De,lt),re.return=fe,re):(re=_(re,he),re.return=fe,re)}function je(fe,re,he){if(typeof re=="string"&&re!==""||typeof re=="number")return re=Pp(""+re,fe.mode,he),re.return=fe,re;if(typeof re=="object"&&re!==null){switch(re.$$typeof){case $:return he=Tf(re.type,re.key,re.props,null,fe.mode,he),he.ref=_u(fe,null,re),he.return=fe,he;case W:return re=Fp(re,fe.mode,he),re.return=fe,re;case pe:var De=re._init;return je(fe,De(re._payload),he)}if(Zt(re)||z(re))return re=wl(re,fe.mode,he,null),re.return=fe,re;cl(fe,re)}return null}function Ie(fe,re,he,De){var lt=re!==null?re.key:null;if(typeof he=="string"&&he!==""||typeof he=="number")return lt!==null?null:G(fe,re,""+he,De);if(typeof he=="object"&&he!==null){switch(he.$$typeof){case $:return he.key===lt?Q(fe,re,he,De):null;case W:return he.key===lt?ge(fe,re,he,De):null;case pe:return lt=he._init,Ie(fe,re,lt(he._payload),De)}if(Zt(he)||z(he))return lt!==null?null:Pe(fe,re,he,De,null);cl(fe,he)}return null}function Je(fe,re,he,De,lt){if(typeof De=="string"&&De!==""||typeof De=="number")return fe=fe.get(he)||null,G(re,fe,""+De,lt);if(typeof De=="object"&&De!==null){switch(De.$$typeof){case $:return fe=fe.get(De.key===null?he:De.key)||null,Q(re,fe,De,lt);case W:return fe=fe.get(De.key===null?he:De.key)||null,ge(re,fe,De,lt);case pe:var St=De._init;return Je(fe,re,he,St(De._payload),lt)}if(Zt(De)||z(De))return fe=fe.get(he)||null,Pe(re,fe,De,lt,null);cl(re,De)}return null}function nt(fe,re,he,De){for(var lt=null,St=null,vt=re,jt=re=0,In=null;vt!==null&&jt<he.length;jt++){vt.index>jt?(In=vt,vt=null):In=vt.sibling;var xr=Ie(fe,vt,he[jt],De);if(xr===null){vt===null&&(vt=In);break}o&&vt&&xr.alternate===null&&a(fe,vt),re=k(xr,re,jt),St===null?lt=xr:St.sibling=xr,St=xr,vt=In}if(jt===he.length)return h(fe,vt),Vr&&al(fe,jt),lt;if(vt===null){for(;jt<he.length;jt++)vt=je(fe,he[jt],De),vt!==null&&(re=k(vt,re,jt),St===null?lt=vt:St.sibling=vt,St=vt);return Vr&&al(fe,jt),lt}for(vt=v(fe,vt);jt<he.length;jt++)In=Je(vt,fe,jt,he[jt],De),In!==null&&(o&&In.alternate!==null&&vt.delete(In.key===null?jt:In.key),re=k(In,re,jt),St===null?lt=In:St.sibling=In,St=In);return o&&vt.forEach(function(Aa){return a(fe,Aa)}),Vr&&al(fe,jt),lt}function ot(fe,re,he,De){var lt=z(he);if(typeof lt!="function")throw Error(t(150));if(he=lt.call(he),he==null)throw Error(t(151));for(var St=lt=null,vt=re,jt=re=0,In=null,xr=he.next();vt!==null&&!xr.done;jt++,xr=he.next()){vt.index>jt?(In=vt,vt=null):In=vt.sibling;var Aa=Ie(fe,vt,xr.value,De);if(Aa===null){vt===null&&(vt=In);break}o&&vt&&Aa.alternate===null&&a(fe,vt),re=k(Aa,re,jt),St===null?lt=Aa:St.sibling=Aa,St=Aa,vt=In}if(xr.done)return h(fe,vt),Vr&&al(fe,jt),lt;if(vt===null){for(;!xr.done;jt++,xr=he.next())xr=je(fe,xr.value,De),xr!==null&&(re=k(xr,re,jt),St===null?lt=xr:St.sibling=xr,St=xr);return Vr&&al(fe,jt),lt}for(vt=v(fe,vt);!xr.done;jt++,xr=he.next())xr=Je(vt,fe,jt,xr.value,De),xr!==null&&(o&&xr.alternate!==null&&vt.delete(xr.key===null?jt:xr.key),re=k(xr,re,jt),St===null?lt=xr:St.sibling=xr,St=xr);return o&&vt.forEach(function(J0){return a(fe,J0)}),Vr&&al(fe,jt),lt}function fn(fe,re,he,De){if(typeof he=="object"&&he!==null&&he.type===M&&he.key===null&&(he=he.props.children),typeof he=="object"&&he!==null){switch(he.$$typeof){case $:e:{for(var lt=he.key,St=re;St!==null;){if(St.key===lt){if(lt=he.type,lt===M){if(St.tag===7){h(fe,St.sibling),re=_(St,he.props.children),re.return=fe,fe=re;break e}}else if(St.elementType===lt||typeof lt=="object"&&lt!==null&&lt.$$typeof===pe&&Mg(lt)===St.type){h(fe,St.sibling),re=_(St,he.props),re.ref=_u(fe,St,he),re.return=fe,fe=re;break e}h(fe,St);break}else a(fe,St);St=St.sibling}he.type===M?(re=wl(he.props.children,fe.mode,De,he.key),re.return=fe,fe=re):(De=Tf(he.type,he.key,he.props,null,fe.mode,De),De.ref=_u(fe,re,he),De.return=fe,fe=De)}return F(fe);case W:e:{for(St=he.key;re!==null;){if(re.key===St)if(re.tag===4&&re.stateNode.containerInfo===he.containerInfo&&re.stateNode.implementation===he.implementation){h(fe,re.sibling),re=_(re,he.children||[]),re.return=fe,fe=re;break e}else{h(fe,re);break}else a(fe,re);re=re.sibling}re=Fp(he,fe.mode,De),re.return=fe,fe=re}return F(fe);case pe:return St=he._init,fn(fe,re,St(he._payload),De)}if(Zt(he))return nt(fe,re,he,De);if(z(he))return ot(fe,re,he,De);cl(fe,he)}return typeof he=="string"&&he!==""||typeof he=="number"?(he=""+he,re!==null&&re.tag===6?(h(fe,re.sibling),re=_(re,he),re.return=fe,fe=re):(h(fe,re),re=Pp(he,fe.mode,De),re.return=fe,fe=re),F(fe)):h(fe,re)}return fn}var ln=Vh(!0),qd=Vh(!1),Eu=Es(null),Vs=null,xa=null,hc=null;function Mi(){hc=xa=Vs=null}function Kd(o){var a=Eu.current;Wr(Eu),o._currentValue=a}function $n(o,a,h){for(;o!==null;){var v=o.alternate;if((o.childLanes&a)!==a?(o.childLanes|=a,v!==null&&(v.childLanes|=a)):v!==null&&(v.childLanes&a)!==a&&(v.childLanes|=a),o===h)break;o=o.return}}function wa(o,a){Vs=o,hc=xa=null,o=o.dependencies,o!==null&&o.firstContext!==null&&((o.lanes&a)!==0&&(us=!0),o.firstContext=null)}function fo(o){var a=o._currentValue;if(hc!==o)if(o={context:o,memoizedValue:a,next:null},xa===null){if(Vs===null)throw Error(t(308));xa=o,Vs.dependencies={lanes:0,firstContext:o}}else xa=xa.next=o;return a}var ul=null;function qh(o){ul===null?ul=[o]:ul.push(o)}function Yd(o,a,h,v){var _=a.interleaved;return _===null?(h.next=h,qh(a)):(h.next=_.next,_.next=h),a.interleaved=h,$i(o,v)}function $i(o,a){o.lanes|=a;var h=o.alternate;for(h!==null&&(h.lanes|=a),h=o,o=o.return;o!==null;)o.childLanes|=a,h=o.alternate,h!==null&&(h.childLanes|=a),h=o,o=o.return;return h.tag===3?h.stateNode:null}var ho=!1;function Jd(o){o.updateQueue={baseState:o.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function $g(o,a){o=o.updateQueue,a.updateQueue===o&&(a.updateQueue={baseState:o.baseState,firstBaseUpdate:o.firstBaseUpdate,lastBaseUpdate:o.lastBaseUpdate,shared:o.shared,effects:o.effects})}function Ui(o,a){return{eventTime:o,lane:a,tag:0,payload:null,callback:null,next:null}}function po(o,a,h){var v=o.updateQueue;if(v===null)return null;if(v=v.shared,(mr&2)!==0){var _=v.pending;return _===null?a.next=a:(a.next=_.next,_.next=a),v.pending=a,$i(o,h)}return _=v.interleaved,_===null?(a.next=a,qh(v)):(a.next=_.next,_.next=a),v.interleaved=a,$i(o,h)}function Xd(o,a,h){if(a=a.updateQueue,a!==null&&(a=a.shared,(h&4194240)!==0)){var v=a.lanes;v&=o.pendingLanes,h|=v,a.lanes=h,Ja(o,h)}}function Ug(o,a){var h=o.updateQueue,v=o.alternate;if(v!==null&&(v=v.updateQueue,h===v)){var _=null,k=null;if(h=h.firstBaseUpdate,h!==null){do{var F={eventTime:h.eventTime,lane:h.lane,tag:h.tag,payload:h.payload,callback:h.callback,next:null};k===null?_=k=F:k=k.next=F,h=h.next}while(h!==null);k===null?_=k=a:k=k.next=a}else _=k=a;h={baseState:v.baseState,firstBaseUpdate:_,lastBaseUpdate:k,shared:v.shared,effects:v.effects},o.updateQueue=h;return}o=h.lastBaseUpdate,o===null?h.firstBaseUpdate=a:o.next=a,h.lastBaseUpdate=a}function pc(o,a,h,v){var _=o.updateQueue;ho=!1;var k=_.firstBaseUpdate,F=_.lastBaseUpdate,G=_.shared.pending;if(G!==null){_.shared.pending=null;var Q=G,ge=Q.next;Q.next=null,F===null?k=ge:F.next=ge,F=Q;var Pe=o.alternate;Pe!==null&&(Pe=Pe.updateQueue,G=Pe.lastBaseUpdate,G!==F&&(G===null?Pe.firstBaseUpdate=ge:G.next=ge,Pe.lastBaseUpdate=Q))}if(k!==null){var je=_.baseState;F=0,Pe=ge=Q=null,G=k;do{var Ie=G.lane,Je=G.eventTime;if((v&Ie)===Ie){Pe!==null&&(Pe=Pe.next={eventTime:Je,lane:0,tag:G.tag,payload:G.payload,callback:G.callback,next:null});e:{var nt=o,ot=G;switch(Ie=a,Je=h,ot.tag){case 1:if(nt=ot.payload,typeof nt=="function"){je=nt.call(Je,je,Ie);break e}je=nt;break e;case 3:nt.flags=nt.flags&-65537|128;case 0:if(nt=ot.payload,Ie=typeof nt=="function"?nt.call(Je,je,Ie):nt,Ie==null)break e;je=Y({},je,Ie);break e;case 2:ho=!0}}G.callback!==null&&G.lane!==0&&(o.flags|=64,Ie=_.effects,Ie===null?_.effects=[G]:Ie.push(G))}else Je={eventTime:Je,lane:Ie,tag:G.tag,payload:G.payload,callback:G.callback,next:null},Pe===null?(ge=Pe=Je,Q=je):Pe=Pe.next=Je,F|=Ie;if(G=G.next,G===null){if(G=_.shared.pending,G===null)break;Ie=G,G=Ie.next,Ie.next=null,_.lastBaseUpdate=Ie,_.shared.pending=null}}while(!0);if(Pe===null&&(Q=je),_.baseState=Q,_.firstBaseUpdate=ge,_.lastBaseUpdate=Pe,a=_.shared.interleaved,a!==null){_=a;do F|=_.lane,_=_.next;while(_!==a)}else k===null&&(_.shared.lanes=0);Ca|=F,o.lanes=F,o.memoizedState=je}}function Kh(o,a,h){if(o=a.effects,a.effects=null,o!==null)for(a=0;a<o.length;a++){var v=o[a],_=v.callback;if(_!==null){if(v.callback=null,v=h,typeof _!="function")throw Error(t(191,_));_.call(v)}}}var Su={},pi=Es(Su),Cu=Es(Su),mc=Es(Su);function zi(o){if(o===Su)throw Error(t(174));return o}function Yh(o,a){switch(Mr(mc,a),Mr(Cu,o),Mr(pi,Su),o=a.nodeType,o){case 9:case 11:a=(a=a.documentElement)?a.namespaceURI:it(null,"");break;default:o=o===8?a.parentNode:a,a=o.namespaceURI||null,o=o.tagName,a=it(a,o)}Wr(pi),Mr(pi,a)}function ba(){Wr(pi),Wr(Cu),Wr(mc)}function Jh(o){zi(mc.current);var a=zi(pi.current),h=it(a,o.type);a!==h&&(Mr(Cu,o),Mr(pi,h))}function Qd(o){Cu.current===o&&(Wr(pi),Wr(Cu))}var Xr=Es(0);function dl(o){for(var a=o;a!==null;){if(a.tag===13){var h=a.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||h.data==="$?"||h.data==="$!"))return a}else if(a.tag===19&&a.memoizedProps.revealOrder!==void 0){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===o)break;for(;a.sibling===null;){if(a.return===null||a.return===o)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var Xh=[];function Zd(){for(var o=0;o<Xh.length;o++)Xh[o]._workInProgressVersionPrimary=null;Xh.length=0}var ku=P.ReactCurrentDispatcher,Qh=P.ReactCurrentBatchConfig,_a=0,tn=null,dn=null,bn=null,gc=!1,Nu=!1,fl=0,Yt=0;function Zn(){throw Error(t(321))}function Zh(o,a){if(a===null)return!1;for(var h=0;h<a.length&&h<o.length;h++)if(!me(o[h],a[h]))return!1;return!0}function hl(o,a,h,v,_,k){if(_a=k,tn=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,ku.current=o===null||o.memoizedState===null?I0:af,o=h(v,_),Nu){k=0;do{if(Nu=!1,fl=0,25<=k)throw Error(t(301));k+=1,bn=dn=null,a.updateQueue=null,ku.current=wc,o=h(v,_)}while(Nu)}if(ku.current=of,a=dn!==null&&dn.next!==null,_a=0,bn=dn=tn=null,gc=!1,a)throw Error(t(300));return o}function ef(){var o=fl!==0;return fl=0,o}function mi(){var o={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return bn===null?tn.memoizedState=bn=o:bn=bn.next=o,bn}function mo(){if(dn===null){var o=tn.alternate;o=o!==null?o.memoizedState:null}else o=dn.next;var a=bn===null?tn.memoizedState:bn.next;if(a!==null)bn=a,dn=o;else{if(o===null)throw Error(t(310));dn=o,o={memoizedState:dn.memoizedState,baseState:dn.baseState,baseQueue:dn.baseQueue,queue:dn.queue,next:null},bn===null?tn.memoizedState=bn=o:bn=bn.next=o}return bn}function es(o,a){return typeof a=="function"?a(o):a}function ep(o){var a=mo(),h=a.queue;if(h===null)throw Error(t(311));h.lastRenderedReducer=o;var v=dn,_=v.baseQueue,k=h.pending;if(k!==null){if(_!==null){var F=_.next;_.next=k.next,k.next=F}v.baseQueue=_=k,h.pending=null}if(_!==null){k=_.next,v=v.baseState;var G=F=null,Q=null,ge=k;do{var Pe=ge.lane;if((_a&Pe)===Pe)Q!==null&&(Q=Q.next={lane:0,action:ge.action,hasEagerState:ge.hasEagerState,eagerState:ge.eagerState,next:null}),v=ge.hasEagerState?ge.eagerState:o(v,ge.action);else{var je={lane:Pe,action:ge.action,hasEagerState:ge.hasEagerState,eagerState:ge.eagerState,next:null};Q===null?(G=Q=je,F=v):Q=Q.next=je,tn.lanes|=Pe,Ca|=Pe}ge=ge.next}while(ge!==null&&ge!==k);Q===null?F=v:Q.next=G,me(v,a.memoizedState)||(us=!0),a.memoizedState=v,a.baseState=F,a.baseQueue=Q,h.lastRenderedState=v}if(o=h.interleaved,o!==null){_=o;do k=_.lane,tn.lanes|=k,Ca|=k,_=_.next;while(_!==o)}else _===null&&(h.lanes=0);return[a.memoizedState,h.dispatch]}function vc(o){var a=mo(),h=a.queue;if(h===null)throw Error(t(311));h.lastRenderedReducer=o;var v=h.dispatch,_=h.pending,k=a.memoizedState;if(_!==null){h.pending=null;var F=_=_.next;do k=o(k,F.action),F=F.next;while(F!==_);me(k,a.memoizedState)||(us=!0),a.memoizedState=k,a.baseQueue===null&&(a.baseState=k),h.lastRenderedState=k}return[k,v]}function tf(){}function tp(o,a){var h=tn,v=mo(),_=a(),k=!me(v.memoizedState,_);if(k&&(v.memoizedState=_,us=!0),v=v.queue,gi(Hi.bind(null,h,v,o),[o]),v.getSnapshot!==a||k||bn!==null&&bn.memoizedState.tag&1){if(h.flags|=2048,yc(9,Ns.bind(null,h,v,_,a),void 0,null),An===null)throw Error(t(349));(_a&30)!==0||rp(h,a,_)}return _}function rp(o,a,h){o.flags|=16384,o={getSnapshot:a,value:h},a=tn.updateQueue,a===null?(a={lastEffect:null,stores:null},tn.updateQueue=a,a.stores=[o]):(h=a.stores,h===null?a.stores=[o]:h.push(o))}function Ns(o,a,h,v){a.value=h,a.getSnapshot=v,rf(a)&&np(o)}function Hi(o,a,h){return h(function(){rf(a)&&np(o)})}function rf(o){var a=o.getSnapshot;o=o.value;try{var h=a();return!me(o,h)}catch{return!0}}function np(o){var a=$i(o,1);a!==null&&Ho(a,o,1,-1)}function Tu(o){var a=mi();return typeof o=="function"&&(o=o()),a.memoizedState=a.baseState=o,o={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:es,lastRenderedState:o},a.queue=o,o=o.dispatch=Vg.bind(null,tn,o),[a.memoizedState,o]}function yc(o,a,h,v){return o={tag:o,create:a,destroy:h,deps:v,next:null},a=tn.updateQueue,a===null?(a={lastEffect:null,stores:null},tn.updateQueue=a,a.lastEffect=o.next=o):(h=a.lastEffect,h===null?a.lastEffect=o.next=o:(v=h.next,h.next=o,o.next=v,a.lastEffect=o)),o}function nf(){return mo().memoizedState}function Ru(o,a,h,v){var _=mi();tn.flags|=o,_.memoizedState=yc(1|a,h,void 0,v===void 0?null:v)}function xc(o,a,h,v){var _=mo();v=v===void 0?null:v;var k=void 0;if(dn!==null){var F=dn.memoizedState;if(k=F.destroy,v!==null&&Zh(v,F.deps)){_.memoizedState=yc(a,h,k,v);return}}tn.flags|=o,_.memoizedState=yc(1|a,h,k,v)}function sf(o,a){return Ru(8390656,8,o,a)}function gi(o,a){return xc(2048,8,o,a)}function zg(o,a){return xc(4,2,o,a)}function Bi(o,a){return xc(4,4,o,a)}function sp(o,a){if(typeof a=="function")return o=o(),a(o),function(){a(null)};if(a!=null)return o=o(),a.current=o,function(){a.current=null}}function op(o,a,h){return h=h!=null?h.concat([o]):null,xc(4,4,sp.bind(null,a,o),h)}function Au(){}function Hg(o,a){var h=mo();a=a===void 0?null:a;var v=h.memoizedState;return v!==null&&a!==null&&Zh(a,v[1])?v[0]:(h.memoizedState=[o,a],o)}function Bg(o,a){var h=mo();a=a===void 0?null:a;var v=h.memoizedState;return v!==null&&a!==null&&Zh(a,v[1])?v[0]:(o=o(),h.memoizedState=[o,a],o)}function Gg(o,a,h){return(_a&21)===0?(o.baseState&&(o.baseState=!1,us=!0),o.memoizedState=h):(me(h,a)||(h=nu(),tn.lanes|=h,Ca|=h,o.baseState=!0),a)}function Wg(o,a){var h=nr;nr=h!==0&&4>h?h:4,o(!0);var v=Qh.transition;Qh.transition={};try{o(!1),a()}finally{nr=h,Qh.transition=v}}function ip(){return mo().memoizedState}function A0(o,a,h){var v=Ta(o);if(h={lane:v,action:h,hasEagerState:!1,eagerState:null,next:null},ap(o))cs(a,h);else if(h=Yd(o,a,h,v),h!==null){var _=hs();Ho(h,o,v,_),Lo(h,a,v)}}function Vg(o,a,h){var v=Ta(o),_={lane:v,action:h,hasEagerState:!1,eagerState:null,next:null};if(ap(o))cs(a,_);else{var k=o.alternate;if(o.lanes===0&&(k===null||k.lanes===0)&&(k=a.lastRenderedReducer,k!==null))try{var F=a.lastRenderedState,G=k(F,h);if(_.hasEagerState=!0,_.eagerState=G,me(G,F)){var Q=a.interleaved;Q===null?(_.next=_,qh(a)):(_.next=Q.next,Q.next=_),a.interleaved=_;return}}catch{}finally{}h=Yd(o,a,_,v),h!==null&&(_=hs(),Ho(h,o,v,_),Lo(h,a,v))}}function ap(o){var a=o.alternate;return o===tn||a!==null&&a===tn}function cs(o,a){Nu=gc=!0;var h=o.pending;h===null?a.next=a:(a.next=h.next,h.next=a),o.pending=a}function Lo(o,a,h){if((h&4194240)!==0){var v=a.lanes;v&=o.pendingLanes,h|=v,a.lanes=h,Ja(o,h)}}var of={readContext:fo,useCallback:Zn,useContext:Zn,useEffect:Zn,useImperativeHandle:Zn,useInsertionEffect:Zn,useLayoutEffect:Zn,useMemo:Zn,useReducer:Zn,useRef:Zn,useState:Zn,useDebugValue:Zn,useDeferredValue:Zn,useTransition:Zn,useMutableSource:Zn,useSyncExternalStore:Zn,useId:Zn,unstable_isNewReconciler:!1},I0={readContext:fo,useCallback:function(o,a){return mi().memoizedState=[o,a===void 0?null:a],o},useContext:fo,useEffect:sf,useImperativeHandle:function(o,a,h){return h=h!=null?h.concat([o]):null,Ru(4194308,4,sp.bind(null,a,o),h)},useLayoutEffect:function(o,a){return Ru(4194308,4,o,a)},useInsertionEffect:function(o,a){return Ru(4,2,o,a)},useMemo:function(o,a){var h=mi();return a=a===void 0?null:a,o=o(),h.memoizedState=[o,a],o},useReducer:function(o,a,h){var v=mi();return a=h!==void 0?h(a):a,v.memoizedState=v.baseState=a,o={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:o,lastRenderedState:a},v.queue=o,o=o.dispatch=A0.bind(null,tn,o),[v.memoizedState,o]},useRef:function(o){var a=mi();return o={current:o},a.memoizedState=o},useState:Tu,useDebugValue:Au,useDeferredValue:function(o){return mi().memoizedState=o},useTransition:function(){var o=Tu(!1),a=o[0];return o=Wg.bind(null,o[1]),mi().memoizedState=o,[a,o]},useMutableSource:function(){},useSyncExternalStore:function(o,a,h){var v=tn,_=mi();if(Vr){if(h===void 0)throw Error(t(407));h=h()}else{if(h=a(),An===null)throw Error(t(349));(_a&30)!==0||rp(v,a,h)}_.memoizedState=h;var k={value:h,getSnapshot:a};return _.queue=k,sf(Hi.bind(null,v,k,o),[o]),v.flags|=2048,yc(9,Ns.bind(null,v,k,h,a),void 0,null),h},useId:function(){var o=mi(),a=An.identifierPrefix;if(Vr){var h=ui,v=ci;h=(v&~(1<<32-Mn(v)-1)).toString(32)+h,a=":"+a+"R"+h,h=fl++,0<h&&(a+="H"+h.toString(32)),a+=":"}else h=Yt++,a=":"+a+"r"+h.toString(32)+":";return o.memoizedState=a},unstable_isNewReconciler:!1},af={readContext:fo,useCallback:Hg,useContext:fo,useEffect:gi,useImperativeHandle:op,useInsertionEffect:zg,useLayoutEffect:Bi,useMemo:Bg,useReducer:ep,useRef:nf,useState:function(){return ep(es)},useDebugValue:Au,useDeferredValue:function(o){var a=mo();return Gg(a,dn.memoizedState,o)},useTransition:function(){var o=ep(es)[0],a=mo().memoizedState;return[o,a]},useMutableSource:tf,useSyncExternalStore:tp,useId:ip,unstable_isNewReconciler:!1},wc={readContext:fo,useCallback:Hg,useContext:fo,useEffect:gi,useImperativeHandle:op,useInsertionEffect:zg,useLayoutEffect:Bi,useMemo:Bg,useReducer:vc,useRef:nf,useState:function(){return vc(es)},useDebugValue:Au,useDeferredValue:function(o){var a=mo();return dn===null?a.memoizedState=o:Gg(a,dn.memoizedState,o)},useTransition:function(){var o=vc(es)[0],a=mo().memoizedState;return[o,a]},useMutableSource:tf,useSyncExternalStore:tp,useId:ip,unstable_isNewReconciler:!1};function go(o,a){if(o&&o.defaultProps){a=Y({},a),o=o.defaultProps;for(var h in o)a[h]===void 0&&(a[h]=o[h]);return a}return a}function lf(o,a,h,v){a=o.memoizedState,h=h(v,a),h=h==null?a:Y({},a,h),o.memoizedState=h,o.lanes===0&&(o.updateQueue.baseState=h)}var cf={isMounted:function(o){return(o=o._reactInternals)?zs(o)===o:!1},enqueueSetState:function(o,a,h){o=o._reactInternals;var v=hs(),_=Ta(o),k=Ui(v,_);k.payload=a,h!=null&&(k.callback=h),a=po(o,k,_),a!==null&&(Ho(a,o,_,v),Xd(a,o,_))},enqueueReplaceState:function(o,a,h){o=o._reactInternals;var v=hs(),_=Ta(o),k=Ui(v,_);k.tag=1,k.payload=a,h!=null&&(k.callback=h),a=po(o,k,_),a!==null&&(Ho(a,o,_,v),Xd(a,o,_))},enqueueForceUpdate:function(o,a){o=o._reactInternals;var h=hs(),v=Ta(o),_=Ui(h,v);_.tag=2,a!=null&&(_.callback=a),a=po(o,_,v),a!==null&&(Ho(a,o,v,h),Xd(a,o,v))}};function lp(o,a,h,v,_,k,F){return o=o.stateNode,typeof o.shouldComponentUpdate=="function"?o.shouldComponentUpdate(v,k,F):a.prototype&&a.prototype.isPureReactComponent?!Ye(h,v)||!Ye(_,k):!0}function pl(o,a,h){var v=!1,_=va,k=a.contextType;return typeof k=="object"&&k!==null?k=fo(k):(_=Cs(a)?ls:Jn.current,v=a.contextTypes,k=(v=v!=null)?dc(o,_):va),a=new a(h,k),o.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,a.updater=cf,o.stateNode=a,a._reactInternals=o,v&&(o=o.stateNode,o.__reactInternalMemoizedUnmaskedChildContext=_,o.__reactInternalMemoizedMaskedChildContext=k),a}function bc(o,a,h,v){o=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(h,v),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(h,v),a.state!==o&&cf.enqueueReplaceState(a,a.state,null)}function cp(o,a,h,v){var _=o.stateNode;_.props=h,_.state=o.memoizedState,_.refs={},Jd(o);var k=a.contextType;typeof k=="object"&&k!==null?_.context=fo(k):(k=Cs(a)?ls:Jn.current,_.context=dc(o,k)),_.state=o.memoizedState,k=a.getDerivedStateFromProps,typeof k=="function"&&(lf(o,a,k,h),_.state=o.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof _.getSnapshotBeforeUpdate=="function"||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(a=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),a!==_.state&&cf.enqueueReplaceState(_,_.state,null),pc(o,h,_,v),_.state=o.memoizedState),typeof _.componentDidMount=="function"&&(o.flags|=4194308)}function ml(o,a){try{var h="",v=a;do h+=q(v),v=v.return;while(v);var _=h}catch(k){_=`
Error generating stack: `+k.message+`
`+k.stack}return{value:o,source:a,stack:_,digest:null}}function uf(o,a,h){return{value:o,source:null,stack:h??null,digest:a??null}}function _c(o,a){try{console.error(a.value)}catch(h){setTimeout(function(){throw h})}}var qg=typeof WeakMap=="function"?WeakMap:Map;function Iu(o,a,h){h=Ui(-1,h),h.tag=3,h.payload={element:null};var v=a.value;return h.callback=function(){bf||(bf=!0,Cp=v),_c(o,a)},h}function df(o,a,h){h=Ui(-1,h),h.tag=3;var v=o.type.getDerivedStateFromError;if(typeof v=="function"){var _=a.value;h.payload=function(){return v(_)},h.callback=function(){_c(o,a)}}var k=o.stateNode;return k!==null&&typeof k.componentDidCatch=="function"&&(h.callback=function(){_c(o,a),typeof v!="function"&&(ka===null?ka=new Set([this]):ka.add(this));var F=a.stack;this.componentDidCatch(a.value,{componentStack:F!==null?F:""})}),h}function Pu(o,a,h){var v=o.pingCache;if(v===null){v=o.pingCache=new qg;var _=new Set;v.set(a,_)}else _=v.get(a),_===void 0&&(_=new Set,v.set(a,_));_.has(h)||(_.add(h),o=$0.bind(null,o,a,h),a.then(o,o))}function Kg(o){do{var a;if((a=o.tag===13)&&(a=o.memoizedState,a=a!==null?a.dehydrated!==null:!0),a)return o;o=o.return}while(o!==null);return null}function up(o,a,h,v,_){return(o.mode&1)===0?(o===a?o.flags|=65536:(o.flags|=128,h.flags|=131072,h.flags&=-52805,h.tag===1&&(h.alternate===null?h.tag=17:(a=Ui(-1,1),a.tag=2,po(h,a,1))),h.lanes|=1),o):(o.flags|=65536,o.lanes=_,o)}var ff=P.ReactCurrentOwner,us=!1;function Un(o,a,h,v){a.child=o===null?qd(a,null,h,v):ln(a,o.child,h,v)}function Yg(o,a,h,v,_){h=h.render;var k=a.ref;return wa(a,_),v=hl(o,a,h,v,k,_),h=ef(),o!==null&&!us?(a.updateQueue=o.updateQueue,a.flags&=-2053,o.lanes&=~_,Mo(o,a,_)):(Vr&&h&&wu(a),a.flags|=1,Un(o,a,v,_),a.child)}function dp(o,a,h,v,_){if(o===null){var k=h.type;return typeof k=="function"&&!Nf(k)&&k.defaultProps===void 0&&h.compare===null&&h.defaultProps===void 0?(a.tag=15,a.type=k,vi(o,a,k,v,_)):(o=Tf(h.type,null,v,a,a.mode,_),o.ref=a.ref,o.return=a,a.child=o)}if(k=o.child,(o.lanes&_)===0){var F=k.memoizedProps;if(h=h.compare,h=h!==null?h:Ye,h(F,v)&&o.ref===a.ref)return Mo(o,a,_)}return a.flags|=1,o=Bo(k,v),o.ref=a.ref,o.return=a,a.child=o}function vi(o,a,h,v,_){if(o!==null){var k=o.memoizedProps;if(Ye(k,v)&&o.ref===a.ref)if(us=!1,a.pendingProps=v=k,(o.lanes&_)!==0)(o.flags&131072)!==0&&(us=!0);else return a.lanes=o.lanes,Mo(o,a,_)}return pp(o,a,h,v,_)}function fp(o,a,h){var v=a.pendingProps,_=v.children,k=o!==null?o.memoizedState:null;if(v.mode==="hidden")if((a.mode&1)===0)a.memoizedState={baseLanes:0,cachePool:null,transitions:null},Mr(kc,Ks),Ks|=h;else{if((h&1073741824)===0)return o=k!==null?k.baseLanes|h:h,a.lanes=a.childLanes=1073741824,a.memoizedState={baseLanes:o,cachePool:null,transitions:null},a.updateQueue=null,Mr(kc,Ks),Ks|=o,null;a.memoizedState={baseLanes:0,cachePool:null,transitions:null},v=k!==null?k.baseLanes:h,Mr(kc,Ks),Ks|=v}else k!==null?(v=k.baseLanes|h,a.memoizedState=null):v=h,Mr(kc,Ks),Ks|=v;return Un(o,a,_,h),a.child}function hp(o,a){var h=a.ref;(o===null&&h!==null||o!==null&&o.ref!==h)&&(a.flags|=512,a.flags|=2097152)}function pp(o,a,h,v,_){var k=Cs(h)?ls:Jn.current;return k=dc(a,k),wa(a,_),h=hl(o,a,h,v,k,_),v=ef(),o!==null&&!us?(a.updateQueue=o.updateQueue,a.flags&=-2053,o.lanes&=~_,Mo(o,a,_)):(Vr&&v&&wu(a),a.flags|=1,Un(o,a,h,_),a.child)}function mp(o,a,h,v,_){if(Cs(h)){var k=!0;lo(a)}else k=!1;if(wa(a,_),a.stateNode===null)pf(o,a),pl(a,h,v),cp(a,h,v,_),v=!0;else if(o===null){var F=a.stateNode,G=a.memoizedProps;F.props=G;var Q=F.context,ge=h.contextType;typeof ge=="object"&&ge!==null?ge=fo(ge):(ge=Cs(h)?ls:Jn.current,ge=dc(a,ge));var Pe=h.getDerivedStateFromProps,je=typeof Pe=="function"||typeof F.getSnapshotBeforeUpdate=="function";je||typeof F.UNSAFE_componentWillReceiveProps!="function"&&typeof F.componentWillReceiveProps!="function"||(G!==v||Q!==ge)&&bc(a,F,v,ge),ho=!1;var Ie=a.memoizedState;F.state=Ie,pc(a,v,F,_),Q=a.memoizedState,G!==v||Ie!==Q||Ss.current||ho?(typeof Pe=="function"&&(lf(a,h,Pe,v),Q=a.memoizedState),(G=ho||lp(a,h,G,v,Ie,Q,ge))?(je||typeof F.UNSAFE_componentWillMount!="function"&&typeof F.componentWillMount!="function"||(typeof F.componentWillMount=="function"&&F.componentWillMount(),typeof F.UNSAFE_componentWillMount=="function"&&F.UNSAFE_componentWillMount()),typeof F.componentDidMount=="function"&&(a.flags|=4194308)):(typeof F.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=v,a.memoizedState=Q),F.props=v,F.state=Q,F.context=ge,v=G):(typeof F.componentDidMount=="function"&&(a.flags|=4194308),v=!1)}else{F=a.stateNode,$g(o,a),G=a.memoizedProps,ge=a.type===a.elementType?G:go(a.type,G),F.props=ge,je=a.pendingProps,Ie=F.context,Q=h.contextType,typeof Q=="object"&&Q!==null?Q=fo(Q):(Q=Cs(h)?ls:Jn.current,Q=dc(a,Q));var Je=h.getDerivedStateFromProps;(Pe=typeof Je=="function"||typeof F.getSnapshotBeforeUpdate=="function")||typeof F.UNSAFE_componentWillReceiveProps!="function"&&typeof F.componentWillReceiveProps!="function"||(G!==je||Ie!==Q)&&bc(a,F,v,Q),ho=!1,Ie=a.memoizedState,F.state=Ie,pc(a,v,F,_);var nt=a.memoizedState;G!==je||Ie!==nt||Ss.current||ho?(typeof Je=="function"&&(lf(a,h,Je,v),nt=a.memoizedState),(ge=ho||lp(a,h,ge,v,Ie,nt,Q)||!1)?(Pe||typeof F.UNSAFE_componentWillUpdate!="function"&&typeof F.componentWillUpdate!="function"||(typeof F.componentWillUpdate=="function"&&F.componentWillUpdate(v,nt,Q),typeof F.UNSAFE_componentWillUpdate=="function"&&F.UNSAFE_componentWillUpdate(v,nt,Q)),typeof F.componentDidUpdate=="function"&&(a.flags|=4),typeof F.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof F.componentDidUpdate!="function"||G===o.memoizedProps&&Ie===o.memoizedState||(a.flags|=4),typeof F.getSnapshotBeforeUpdate!="function"||G===o.memoizedProps&&Ie===o.memoizedState||(a.flags|=1024),a.memoizedProps=v,a.memoizedState=nt),F.props=v,F.state=nt,F.context=Q,v=ge):(typeof F.componentDidUpdate!="function"||G===o.memoizedProps&&Ie===o.memoizedState||(a.flags|=4),typeof F.getSnapshotBeforeUpdate!="function"||G===o.memoizedProps&&Ie===o.memoizedState||(a.flags|=1024),v=!1)}return gp(o,a,h,v,k,_)}function gp(o,a,h,v,_,k){hp(o,a);var F=(a.flags&128)!==0;if(!v&&!F)return _&&Fg(a,h,!1),Mo(o,a,k);v=a.stateNode,ff.current=a;var G=F&&typeof h.getDerivedStateFromError!="function"?null:v.render();return a.flags|=1,o!==null&&F?(a.child=ln(a,o.child,null,k),a.child=ln(a,null,G,k)):Un(o,a,G,k),a.memoizedState=v.state,_&&Fg(a,h,!0),a.child}function Jg(o){var a=o.stateNode;a.pendingContext?Ig(o,a.pendingContext,a.pendingContext!==a.context):a.context&&Ig(o,a.context,!1),Yh(o,a.containerInfo)}function yi(o,a,h,v,_){return fi(),hi(_),a.flags|=256,Un(o,a,h,v),a.child}var Fu={dehydrated:null,treeContext:null,retryLane:0};function ju(o){return{baseLanes:o,cachePool:null,transitions:null}}function hf(o,a,h){var v=a.pendingProps,_=Xr.current,k=!1,F=(a.flags&128)!==0,G;if((G=F)||(G=o!==null&&o.memoizedState===null?!1:(_&2)!==0),G?(k=!0,a.flags&=-129):(o===null||o.memoizedState!==null)&&(_|=1),Mr(Xr,_&1),o===null)return ks(a),o=a.memoizedState,o!==null&&(o=o.dehydrated,o!==null)?((a.mode&1)===0?a.lanes=1:o.data==="$!"?a.lanes=8:a.lanes=1073741824,null):(F=v.children,o=v.fallback,k?(v=a.mode,k=a.child,F={mode:"hidden",children:F},(v&1)===0&&k!==null?(k.childLanes=0,k.pendingProps=F):k=Rf(F,v,0,null),o=wl(o,v,h,null),k.return=a,o.return=a,k.sibling=o,a.child=k,a.child.memoizedState=ju(h),a.memoizedState=Fu,o):Ec(a,F));if(_=o.memoizedState,_!==null&&(G=_.dehydrated,G!==null))return Rt(o,a,F,v,G,_,h);if(k){k=v.fallback,F=a.mode,_=o.child,G=_.sibling;var Q={mode:"hidden",children:v.children};return(F&1)===0&&a.child!==_?(v=a.child,v.childLanes=0,v.pendingProps=Q,a.deletions=null):(v=Bo(_,Q),v.subtreeFlags=_.subtreeFlags&14680064),G!==null?k=Bo(G,k):(k=wl(k,F,h,null),k.flags|=2),k.return=a,v.return=a,v.sibling=k,a.child=v,v=k,k=a.child,F=o.child.memoizedState,F=F===null?ju(h):{baseLanes:F.baseLanes|h,cachePool:null,transitions:F.transitions},k.memoizedState=F,k.childLanes=o.childLanes&~h,a.memoizedState=Fu,v}return k=o.child,o=k.sibling,v=Bo(k,{mode:"visible",children:v.children}),(a.mode&1)===0&&(v.lanes=h),v.return=a,v.sibling=null,o!==null&&(h=a.deletions,h===null?(a.deletions=[o],a.flags|=16):h.push(o)),a.child=v,a.memoizedState=null,v}function Ec(o,a){return a=Rf({mode:"visible",children:a},o.mode,0,null),a.return=o,o.child=a}function Gi(o,a,h,v){return v!==null&&hi(v),ln(a,o.child,null,h),o=Ec(a,a.pendingProps.children),o.flags|=2,a.memoizedState=null,o}function Rt(o,a,h,v,_,k,F){if(h)return a.flags&256?(a.flags&=-257,v=uf(Error(t(422))),Gi(o,a,F,v)):a.memoizedState!==null?(a.child=o.child,a.flags|=128,null):(k=v.fallback,_=a.mode,v=Rf({mode:"visible",children:v.children},_,0,null),k=wl(k,_,F,null),k.flags|=2,v.return=a,k.return=a,v.sibling=k,a.child=v,(a.mode&1)!==0&&ln(a,o.child,null,F),a.child.memoizedState=ju(F),a.memoizedState=Fu,k);if((a.mode&1)===0)return Gi(o,a,F,null);if(_.data==="$!"){if(v=_.nextSibling&&_.nextSibling.dataset,v)var G=v.dgst;return v=G,k=Error(t(419)),v=uf(k,v,void 0),Gi(o,a,F,v)}if(G=(F&o.childLanes)!==0,us||G){if(v=An,v!==null){switch(F&-F){case 4:_=2;break;case 16:_=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:_=32;break;case 536870912:_=268435456;break;default:_=0}_=(_&(v.suspendedLanes|F))!==0?0:_,_!==0&&_!==k.retryLane&&(k.retryLane=_,$i(o,_),Ho(v,o,_,-1))}return Ip(),v=uf(Error(t(421))),Gi(o,a,F,v)}return _.data==="$?"?(a.flags|=128,a.child=o.child,a=U0.bind(null,o),_._reactRetry=a,null):(o=k.treeContext,Ws=ma(_.nextSibling),Qn=a,Vr=!0,Do=null,o!==null&&(co[uo++]=ci,co[uo++]=ui,co[uo++]=il,ci=o.id,ui=o.overflow,il=a),a=Ec(a,v.children),a.flags|=4096,a)}function Ou(o,a,h){o.lanes|=a;var v=o.alternate;v!==null&&(v.lanes|=a),$n(o.return,a,h)}function Du(o,a,h,v,_){var k=o.memoizedState;k===null?o.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:v,tail:h,tailMode:_}:(k.isBackwards=a,k.rendering=null,k.renderingStartTime=0,k.last=v,k.tail=h,k.tailMode=_)}function Ea(o,a,h){var v=a.pendingProps,_=v.revealOrder,k=v.tail;if(Un(o,a,v.children,h),v=Xr.current,(v&2)!==0)v=v&1|2,a.flags|=128;else{if(o!==null&&(o.flags&128)!==0)e:for(o=a.child;o!==null;){if(o.tag===13)o.memoizedState!==null&&Ou(o,h,a);else if(o.tag===19)Ou(o,h,a);else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===a)break e;for(;o.sibling===null;){if(o.return===null||o.return===a)break e;o=o.return}o.sibling.return=o.return,o=o.sibling}v&=1}if(Mr(Xr,v),(a.mode&1)===0)a.memoizedState=null;else switch(_){case"forwards":for(h=a.child,_=null;h!==null;)o=h.alternate,o!==null&&dl(o)===null&&(_=h),h=h.sibling;h=_,h===null?(_=a.child,a.child=null):(_=h.sibling,h.sibling=null),Du(a,!1,_,h,k);break;case"backwards":for(h=null,_=a.child,a.child=null;_!==null;){if(o=_.alternate,o!==null&&dl(o)===null){a.child=_;break}o=_.sibling,_.sibling=h,h=_,_=o}Du(a,!0,h,null,k);break;case"together":Du(a,!1,null,null,void 0);break;default:a.memoizedState=null}return a.child}function pf(o,a){(a.mode&1)===0&&o!==null&&(o.alternate=null,a.alternate=null,a.flags|=2)}function Mo(o,a,h){if(o!==null&&(a.dependencies=o.dependencies),Ca|=a.lanes,(h&a.childLanes)===0)return null;if(o!==null&&a.child!==o.child)throw Error(t(153));if(a.child!==null){for(o=a.child,h=Bo(o,o.pendingProps),a.child=h,h.return=a;o.sibling!==null;)o=o.sibling,h=h.sibling=Bo(o,o.pendingProps),h.return=a;h.sibling=null}return a.child}function Xg(o,a,h){switch(a.tag){case 3:Jg(a),fi();break;case 5:Jh(a);break;case 1:Cs(a.type)&&lo(a);break;case 4:Yh(a,a.stateNode.containerInfo);break;case 10:var v=a.type._context,_=a.memoizedProps.value;Mr(Eu,v._currentValue),v._currentValue=_;break;case 13:if(v=a.memoizedState,v!==null)return v.dehydrated!==null?(Mr(Xr,Xr.current&1),a.flags|=128,null):(h&a.child.childLanes)!==0?hf(o,a,h):(Mr(Xr,Xr.current&1),o=Mo(o,a,h),o!==null?o.sibling:null);Mr(Xr,Xr.current&1);break;case 19:if(v=(h&a.childLanes)!==0,(o.flags&128)!==0){if(v)return Ea(o,a,h);a.flags|=128}if(_=a.memoizedState,_!==null&&(_.rendering=null,_.tail=null,_.lastEffect=null),Mr(Xr,Xr.current),v)break;return null;case 22:case 23:return a.lanes=0,fp(o,a,h)}return Mo(o,a,h)}var zn,vp,Qg,yp;zn=function(o,a){for(var h=a.child;h!==null;){if(h.tag===5||h.tag===6)o.appendChild(h.stateNode);else if(h.tag!==4&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===a)break;for(;h.sibling===null;){if(h.return===null||h.return===a)return;h=h.return}h.sibling.return=h.return,h=h.sibling}},vp=function(){},Qg=function(o,a,h,v){var _=o.memoizedProps;if(_!==v){o=a.stateNode,zi(pi.current);var k=null;switch(h){case"input":_=Ae(o,_),v=Ae(o,v),k=[];break;case"select":_=Y({},_,{value:void 0}),v=Y({},v,{value:void 0}),k=[];break;case"textarea":_=Kr(o,_),v=Kr(o,v),k=[];break;default:typeof _.onClick!="function"&&typeof v.onClick=="function"&&(o.onclick=Md)}zr(h,v);var F;h=null;for(ge in _)if(!v.hasOwnProperty(ge)&&_.hasOwnProperty(ge)&&_[ge]!=null)if(ge==="style"){var G=_[ge];for(F in G)G.hasOwnProperty(F)&&(h||(h={}),h[F]="")}else ge!=="dangerouslySetInnerHTML"&&ge!=="children"&&ge!=="suppressContentEditableWarning"&&ge!=="suppressHydrationWarning"&&ge!=="autoFocus"&&(s.hasOwnProperty(ge)?k||(k=[]):(k=k||[]).push(ge,null));for(ge in v){var Q=v[ge];if(G=_!=null?_[ge]:void 0,v.hasOwnProperty(ge)&&Q!==G&&(Q!=null||G!=null))if(ge==="style")if(G){for(F in G)!G.hasOwnProperty(F)||Q&&Q.hasOwnProperty(F)||(h||(h={}),h[F]="");for(F in Q)Q.hasOwnProperty(F)&&G[F]!==Q[F]&&(h||(h={}),h[F]=Q[F])}else h||(k||(k=[]),k.push(ge,h)),h=Q;else ge==="dangerouslySetInnerHTML"?(Q=Q?Q.__html:void 0,G=G?G.__html:void 0,Q!=null&&G!==Q&&(k=k||[]).push(ge,Q)):ge==="children"?typeof Q!="string"&&typeof Q!="number"||(k=k||[]).push(ge,""+Q):ge!=="suppressContentEditableWarning"&&ge!=="suppressHydrationWarning"&&(s.hasOwnProperty(ge)?(Q!=null&&ge==="onScroll"&&Gr("scroll",o),k||G===Q||(k=[])):(k=k||[]).push(ge,Q))}h&&(k=k||[]).push("style",h);var ge=k;(a.updateQueue=ge)&&(a.flags|=4)}},yp=function(o,a,h,v){h!==v&&(a.flags|=4)};function Lu(o,a){if(!Vr)switch(o.tailMode){case"hidden":a=o.tail;for(var h=null;a!==null;)a.alternate!==null&&(h=a),a=a.sibling;h===null?o.tail=null:h.sibling=null;break;case"collapsed":h=o.tail;for(var v=null;h!==null;)h.alternate!==null&&(v=h),h=h.sibling;v===null?a||o.tail===null?o.tail=null:o.tail.sibling=null:v.sibling=null}}function Hn(o){var a=o.alternate!==null&&o.alternate.child===o.child,h=0,v=0;if(a)for(var _=o.child;_!==null;)h|=_.lanes|_.childLanes,v|=_.subtreeFlags&14680064,v|=_.flags&14680064,_.return=o,_=_.sibling;else for(_=o.child;_!==null;)h|=_.lanes|_.childLanes,v|=_.subtreeFlags,v|=_.flags,_.return=o,_=_.sibling;return o.subtreeFlags|=v,o.childLanes=h,a}function P0(o,a,h){var v=a.pendingProps;switch(ll(a),a.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Hn(a),null;case 1:return Cs(a.type)&&Hd(),Hn(a),null;case 3:return v=a.stateNode,ba(),Wr(Ss),Wr(Jn),Zd(),v.pendingContext&&(v.context=v.pendingContext,v.pendingContext=null),(o===null||o.child===null)&&(bu(a)?a.flags|=4:o===null||o.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,Do!==null&&(Tp(Do),Do=null))),vp(o,a),Hn(a),null;case 5:Qd(a);var _=zi(mc.current);if(h=a.type,o!==null&&a.stateNode!=null)Qg(o,a,h,v,_),o.ref!==a.ref&&(a.flags|=512,a.flags|=2097152);else{if(!v){if(a.stateNode===null)throw Error(t(166));return Hn(a),null}if(o=zi(pi.current),bu(a)){v=a.stateNode,h=a.type;var k=a.memoizedProps;switch(v[ai]=a,v[ga]=k,o=(a.mode&1)!==0,h){case"dialog":Gr("cancel",v),Gr("close",v);break;case"iframe":case"object":case"embed":Gr("load",v);break;case"video":case"audio":for(_=0;_<Oi.length;_++)Gr(Oi[_],v);break;case"source":Gr("error",v);break;case"img":case"image":case"link":Gr("error",v),Gr("load",v);break;case"details":Gr("toggle",v);break;case"input":ct(v,k),Gr("invalid",v);break;case"select":v._wrapperState={wasMultiple:!!k.multiple},Gr("invalid",v);break;case"textarea":_t(v,k),Gr("invalid",v)}zr(h,k),_=null;for(var F in k)if(k.hasOwnProperty(F)){var G=k[F];F==="children"?typeof G=="string"?v.textContent!==G&&(k.suppressHydrationWarning!==!0&&gu(v.textContent,G,o),_=["children",G]):typeof G=="number"&&v.textContent!==""+G&&(k.suppressHydrationWarning!==!0&&gu(v.textContent,G,o),_=["children",""+G]):s.hasOwnProperty(F)&&G!=null&&F==="onScroll"&&Gr("scroll",v)}switch(h){case"input":Be(v),sr(v,k,!0);break;case"textarea":Be(v),$e(v);break;case"select":case"option":break;default:typeof k.onClick=="function"&&(v.onclick=Md)}v=_,a.updateQueue=v,v!==null&&(a.flags|=4)}else{F=_.nodeType===9?_:_.ownerDocument,o==="http://www.w3.org/1999/xhtml"&&(o=Nt(h)),o==="http://www.w3.org/1999/xhtml"?h==="script"?(o=F.createElement("div"),o.innerHTML="<script><\/script>",o=o.removeChild(o.firstChild)):typeof v.is=="string"?o=F.createElement(h,{is:v.is}):(o=F.createElement(h),h==="select"&&(F=o,v.multiple?F.multiple=!0:v.size&&(F.size=v.size))):o=F.createElementNS(o,h),o[ai]=a,o[ga]=v,zn(o,a,!1,!1),a.stateNode=o;e:{switch(F=kr(h,v),h){case"dialog":Gr("cancel",o),Gr("close",o),_=v;break;case"iframe":case"object":case"embed":Gr("load",o),_=v;break;case"video":case"audio":for(_=0;_<Oi.length;_++)Gr(Oi[_],o);_=v;break;case"source":Gr("error",o),_=v;break;case"img":case"image":case"link":Gr("error",o),Gr("load",o),_=v;break;case"details":Gr("toggle",o),_=v;break;case"input":ct(o,v),_=Ae(o,v),Gr("invalid",o);break;case"option":_=v;break;case"select":o._wrapperState={wasMultiple:!!v.multiple},_=Y({},v,{value:void 0}),Gr("invalid",o);break;case"textarea":_t(o,v),_=Kr(o,v),Gr("invalid",o);break;default:_=v}zr(h,_),G=_;for(k in G)if(G.hasOwnProperty(k)){var Q=G[k];k==="style"?et(o,Q):k==="dangerouslySetInnerHTML"?(Q=Q?Q.__html:void 0,Q!=null&&Ut(o,Q)):k==="children"?typeof Q=="string"?(h!=="textarea"||Q!=="")&&Or(o,Q):typeof Q=="number"&&Or(o,""+Q):k!=="suppressContentEditableWarning"&&k!=="suppressHydrationWarning"&&k!=="autoFocus"&&(s.hasOwnProperty(k)?Q!=null&&k==="onScroll"&&Gr("scroll",o):Q!=null&&j(o,k,Q,F))}switch(h){case"input":Be(o),sr(o,v,!1);break;case"textarea":Be(o),$e(o);break;case"option":v.value!=null&&o.setAttribute("value",""+ye(v.value));break;case"select":o.multiple=!!v.multiple,k=v.value,k!=null?Kt(o,!!v.multiple,k,!1):v.defaultValue!=null&&Kt(o,!!v.multiple,v.defaultValue,!0);break;default:typeof _.onClick=="function"&&(o.onclick=Md)}switch(h){case"button":case"input":case"select":case"textarea":v=!!v.autoFocus;break e;case"img":v=!0;break e;default:v=!1}}v&&(a.flags|=4)}a.ref!==null&&(a.flags|=512,a.flags|=2097152)}return Hn(a),null;case 6:if(o&&a.stateNode!=null)yp(o,a,o.memoizedProps,v);else{if(typeof v!="string"&&a.stateNode===null)throw Error(t(166));if(h=zi(mc.current),zi(pi.current),bu(a)){if(v=a.stateNode,h=a.memoizedProps,v[ai]=a,(k=v.nodeValue!==h)&&(o=Qn,o!==null))switch(o.tag){case 3:gu(v.nodeValue,h,(o.mode&1)!==0);break;case 5:o.memoizedProps.suppressHydrationWarning!==!0&&gu(v.nodeValue,h,(o.mode&1)!==0)}k&&(a.flags|=4)}else v=(h.nodeType===9?h:h.ownerDocument).createTextNode(v),v[ai]=a,a.stateNode=v}return Hn(a),null;case 13:if(Wr(Xr),v=a.memoizedState,o===null||o.memoizedState!==null&&o.memoizedState.dehydrated!==null){if(Vr&&Ws!==null&&(a.mode&1)!==0&&(a.flags&128)===0)Wh(),fi(),a.flags|=98560,k=!1;else if(k=bu(a),v!==null&&v.dehydrated!==null){if(o===null){if(!k)throw Error(t(318));if(k=a.memoizedState,k=k!==null?k.dehydrated:null,!k)throw Error(t(317));k[ai]=a}else fi(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;Hn(a),k=!1}else Do!==null&&(Tp(Do),Do=null),k=!0;if(!k)return a.flags&65536?a:null}return(a.flags&128)!==0?(a.lanes=h,a):(v=v!==null,v!==(o!==null&&o.memoizedState!==null)&&v&&(a.child.flags|=8192,(a.mode&1)!==0&&(o===null||(Xr.current&1)!==0?_n===0&&(_n=3):Ip())),a.updateQueue!==null&&(a.flags|=4),Hn(a),null);case 4:return ba(),vp(o,a),o===null&&ha(a.stateNode.containerInfo),Hn(a),null;case 10:return Kd(a.type._context),Hn(a),null;case 17:return Cs(a.type)&&Hd(),Hn(a),null;case 19:if(Wr(Xr),k=a.memoizedState,k===null)return Hn(a),null;if(v=(a.flags&128)!==0,F=k.rendering,F===null)if(v)Lu(k,!1);else{if(_n!==0||o!==null&&(o.flags&128)!==0)for(o=a.child;o!==null;){if(F=dl(o),F!==null){for(a.flags|=128,Lu(k,!1),v=F.updateQueue,v!==null&&(a.updateQueue=v,a.flags|=4),a.subtreeFlags=0,v=h,h=a.child;h!==null;)k=h,o=v,k.flags&=14680066,F=k.alternate,F===null?(k.childLanes=0,k.lanes=o,k.child=null,k.subtreeFlags=0,k.memoizedProps=null,k.memoizedState=null,k.updateQueue=null,k.dependencies=null,k.stateNode=null):(k.childLanes=F.childLanes,k.lanes=F.lanes,k.child=F.child,k.subtreeFlags=0,k.deletions=null,k.memoizedProps=F.memoizedProps,k.memoizedState=F.memoizedState,k.updateQueue=F.updateQueue,k.type=F.type,o=F.dependencies,k.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),h=h.sibling;return Mr(Xr,Xr.current&1|2),a.child}o=o.sibling}k.tail!==null&&Ht()>gl&&(a.flags|=128,v=!0,Lu(k,!1),a.lanes=4194304)}else{if(!v)if(o=dl(F),o!==null){if(a.flags|=128,v=!0,h=o.updateQueue,h!==null&&(a.updateQueue=h,a.flags|=4),Lu(k,!0),k.tail===null&&k.tailMode==="hidden"&&!F.alternate&&!Vr)return Hn(a),null}else 2*Ht()-k.renderingStartTime>gl&&h!==1073741824&&(a.flags|=128,v=!0,Lu(k,!1),a.lanes=4194304);k.isBackwards?(F.sibling=a.child,a.child=F):(h=k.last,h!==null?h.sibling=F:a.child=F,k.last=F)}return k.tail!==null?(a=k.tail,k.rendering=a,k.tail=a.sibling,k.renderingStartTime=Ht(),a.sibling=null,h=Xr.current,Mr(Xr,v?h&1|2:h&1),a):(Hn(a),null);case 22:case 23:return Ap(),v=a.memoizedState!==null,o!==null&&o.memoizedState!==null!==v&&(a.flags|=8192),v&&(a.mode&1)!==0?(Ks&1073741824)!==0&&(Hn(a),a.subtreeFlags&6&&(a.flags|=8192)):Hn(a),null;case 24:return null;case 25:return null}throw Error(t(156,a.tag))}function F0(o,a){switch(ll(a),a.tag){case 1:return Cs(a.type)&&Hd(),o=a.flags,o&65536?(a.flags=o&-65537|128,a):null;case 3:return ba(),Wr(Ss),Wr(Jn),Zd(),o=a.flags,(o&65536)!==0&&(o&128)===0?(a.flags=o&-65537|128,a):null;case 5:return Qd(a),null;case 13:if(Wr(Xr),o=a.memoizedState,o!==null&&o.dehydrated!==null){if(a.alternate===null)throw Error(t(340));fi()}return o=a.flags,o&65536?(a.flags=o&-65537|128,a):null;case 19:return Wr(Xr),null;case 4:return ba(),null;case 10:return Kd(a.type._context),null;case 22:case 23:return Ap(),null;case 24:return null;default:return null}}var mf=!1,Qr=!1,ds=typeof WeakSet=="function"?WeakSet:Set,rt=null;function Sc(o,a){var h=o.ref;if(h!==null)if(typeof h=="function")try{h(null)}catch(v){rn(o,a,v)}else h.current=null}function Mu(o,a,h){try{h()}catch(v){rn(o,a,v)}}var Zg=!1;function j0(o,a){if(vu=Za,o=Ar(),uu(o)){if("selectionStart"in o)var h={start:o.selectionStart,end:o.selectionEnd};else e:{h=(h=o.ownerDocument)&&h.defaultView||window;var v=h.getSelection&&h.getSelection();if(v&&v.rangeCount!==0){h=v.anchorNode;var _=v.anchorOffset,k=v.focusNode;v=v.focusOffset;try{h.nodeType,k.nodeType}catch{h=null;break e}var F=0,G=-1,Q=-1,ge=0,Pe=0,je=o,Ie=null;t:for(;;){for(var Je;je!==h||_!==0&&je.nodeType!==3||(G=F+_),je!==k||v!==0&&je.nodeType!==3||(Q=F+v),je.nodeType===3&&(F+=je.nodeValue.length),(Je=je.firstChild)!==null;)Ie=je,je=Je;for(;;){if(je===o)break t;if(Ie===h&&++ge===_&&(G=F),Ie===k&&++Pe===v&&(Q=F),(Je=je.nextSibling)!==null)break;je=Ie,Ie=je.parentNode}je=Je}h=G===-1||Q===-1?null:{start:G,end:Q}}else h=null}h=h||{start:0,end:0}}else h=null;for(sl={focusedElem:o,selectionRange:h},Za=!1,rt=a;rt!==null;)if(a=rt,o=a.child,(a.subtreeFlags&1028)!==0&&o!==null)o.return=a,rt=o;else for(;rt!==null;){a=rt;try{var nt=a.alternate;if((a.flags&1024)!==0)switch(a.tag){case 0:case 11:case 15:break;case 1:if(nt!==null){var ot=nt.memoizedProps,fn=nt.memoizedState,fe=a.stateNode,re=fe.getSnapshotBeforeUpdate(a.elementType===a.type?ot:go(a.type,ot),fn);fe.__reactInternalSnapshotBeforeUpdate=re}break;case 3:var he=a.stateNode.containerInfo;he.nodeType===1?he.textContent="":he.nodeType===9&&he.documentElement&&he.removeChild(he.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(De){rn(a,a.return,De)}if(o=a.sibling,o!==null){o.return=a.return,rt=o;break}rt=a.return}return nt=Zg,Zg=!1,nt}function Wi(o,a,h){var v=a.updateQueue;if(v=v!==null?v.lastEffect:null,v!==null){var _=v=v.next;do{if((_.tag&o)===o){var k=_.destroy;_.destroy=void 0,k!==void 0&&Mu(a,h,k)}_=_.next}while(_!==v)}}function $u(o,a){if(a=a.updateQueue,a=a!==null?a.lastEffect:null,a!==null){var h=a=a.next;do{if((h.tag&o)===o){var v=h.create;h.destroy=v()}h=h.next}while(h!==a)}}function gf(o){var a=o.ref;if(a!==null){var h=o.stateNode;switch(o.tag){case 5:o=h;break;default:o=h}typeof a=="function"?a(o):a.current=o}}function ev(o){var a=o.alternate;a!==null&&(o.alternate=null,ev(a)),o.child=null,o.deletions=null,o.sibling=null,o.tag===5&&(a=o.stateNode,a!==null&&(delete a[ai],delete a[ga],delete a[Ud],delete a[D],delete a[cc])),o.stateNode=null,o.return=null,o.dependencies=null,o.memoizedProps=null,o.memoizedState=null,o.pendingProps=null,o.stateNode=null,o.updateQueue=null}function tv(o){return o.tag===5||o.tag===3||o.tag===4}function rv(o){e:for(;;){for(;o.sibling===null;){if(o.return===null||tv(o.return))return null;o=o.return}for(o.sibling.return=o.return,o=o.sibling;o.tag!==5&&o.tag!==6&&o.tag!==18;){if(o.flags&2||o.child===null||o.tag===4)continue e;o.child.return=o,o=o.child}if(!(o.flags&2))return o.stateNode}}function xp(o,a,h){var v=o.tag;if(v===5||v===6)o=o.stateNode,a?h.nodeType===8?h.parentNode.insertBefore(o,a):h.insertBefore(o,a):(h.nodeType===8?(a=h.parentNode,a.insertBefore(o,h)):(a=h,a.appendChild(o)),h=h._reactRootContainer,h!=null||a.onclick!==null||(a.onclick=Md));else if(v!==4&&(o=o.child,o!==null))for(xp(o,a,h),o=o.sibling;o!==null;)xp(o,a,h),o=o.sibling}function vf(o,a,h){var v=o.tag;if(v===5||v===6)o=o.stateNode,a?h.insertBefore(o,a):h.appendChild(o);else if(v!==4&&(o=o.child,o!==null))for(vf(o,a,h),o=o.sibling;o!==null;)vf(o,a,h),o=o.sibling}var Rn=null,$o=!1;function xi(o,a,h){for(h=h.child;h!==null;)wp(o,a,h),h=h.sibling}function wp(o,a,h){if(Ln&&typeof Ln.onCommitFiberUnmount=="function")try{Ln.onCommitFiberUnmount(ri,h)}catch{}switch(h.tag){case 5:Qr||Sc(h,a);case 6:var v=Rn,_=$o;Rn=null,xi(o,a,h),Rn=v,$o=_,Rn!==null&&($o?(o=Rn,h=h.stateNode,o.nodeType===8?o.parentNode.removeChild(h):o.removeChild(h)):Rn.removeChild(h.stateNode));break;case 18:Rn!==null&&($o?(o=Rn,h=h.stateNode,o.nodeType===8?Hh(o.parentNode,h):o.nodeType===1&&Hh(o,h),vr(o)):Hh(Rn,h.stateNode));break;case 4:v=Rn,_=$o,Rn=h.stateNode.containerInfo,$o=!0,xi(o,a,h),Rn=v,$o=_;break;case 0:case 11:case 14:case 15:if(!Qr&&(v=h.updateQueue,v!==null&&(v=v.lastEffect,v!==null))){_=v=v.next;do{var k=_,F=k.destroy;k=k.tag,F!==void 0&&((k&2)!==0||(k&4)!==0)&&Mu(h,a,F),_=_.next}while(_!==v)}xi(o,a,h);break;case 1:if(!Qr&&(Sc(h,a),v=h.stateNode,typeof v.componentWillUnmount=="function"))try{v.props=h.memoizedProps,v.state=h.memoizedState,v.componentWillUnmount()}catch(G){rn(h,a,G)}xi(o,a,h);break;case 21:xi(o,a,h);break;case 22:h.mode&1?(Qr=(v=Qr)||h.memoizedState!==null,xi(o,a,h),Qr=v):xi(o,a,h);break;default:xi(o,a,h)}}function Cc(o){var a=o.updateQueue;if(a!==null){o.updateQueue=null;var h=o.stateNode;h===null&&(h=o.stateNode=new ds),a.forEach(function(v){var _=z0.bind(null,o,v);h.has(v)||(h.add(v),v.then(_,_))})}}function qs(o,a){var h=a.deletions;if(h!==null)for(var v=0;v<h.length;v++){var _=h[v];try{var k=o,F=a,G=F;e:for(;G!==null;){switch(G.tag){case 5:Rn=G.stateNode,$o=!1;break e;case 3:Rn=G.stateNode.containerInfo,$o=!0;break e;case 4:Rn=G.stateNode.containerInfo,$o=!0;break e}G=G.return}if(Rn===null)throw Error(t(160));wp(k,F,_),Rn=null,$o=!1;var Q=_.alternate;Q!==null&&(Q.return=null),_.return=null}catch(ge){rn(_,a,ge)}}if(a.subtreeFlags&12854)for(a=a.child;a!==null;)bp(a,o),a=a.sibling}function bp(o,a){var h=o.alternate,v=o.flags;switch(o.tag){case 0:case 11:case 14:case 15:if(qs(a,o),Uo(o),v&4){try{Wi(3,o,o.return),$u(3,o)}catch(ot){rn(o,o.return,ot)}try{Wi(5,o,o.return)}catch(ot){rn(o,o.return,ot)}}break;case 1:qs(a,o),Uo(o),v&512&&h!==null&&Sc(h,h.return);break;case 5:if(qs(a,o),Uo(o),v&512&&h!==null&&Sc(h,h.return),o.flags&32){var _=o.stateNode;try{Or(_,"")}catch(ot){rn(o,o.return,ot)}}if(v&4&&(_=o.stateNode,_!=null)){var k=o.memoizedProps,F=h!==null?h.memoizedProps:k,G=o.type,Q=o.updateQueue;if(o.updateQueue=null,Q!==null)try{G==="input"&&k.type==="radio"&&k.name!=null&&Bt(_,k),kr(G,F);var ge=kr(G,k);for(F=0;F<Q.length;F+=2){var Pe=Q[F],je=Q[F+1];Pe==="style"?et(_,je):Pe==="dangerouslySetInnerHTML"?Ut(_,je):Pe==="children"?Or(_,je):j(_,Pe,je,ge)}switch(G){case"input":yt(_,k);break;case"textarea":Se(_,k);break;case"select":var Ie=_._wrapperState.wasMultiple;_._wrapperState.wasMultiple=!!k.multiple;var Je=k.value;Je!=null?Kt(_,!!k.multiple,Je,!1):Ie!==!!k.multiple&&(k.defaultValue!=null?Kt(_,!!k.multiple,k.defaultValue,!0):Kt(_,!!k.multiple,k.multiple?[]:"",!1))}_[ga]=k}catch(ot){rn(o,o.return,ot)}}break;case 6:if(qs(a,o),Uo(o),v&4){if(o.stateNode===null)throw Error(t(162));_=o.stateNode,k=o.memoizedProps;try{_.nodeValue=k}catch(ot){rn(o,o.return,ot)}}break;case 3:if(qs(a,o),Uo(o),v&4&&h!==null&&h.memoizedState.isDehydrated)try{vr(a.containerInfo)}catch(ot){rn(o,o.return,ot)}break;case 4:qs(a,o),Uo(o);break;case 13:qs(a,o),Uo(o),_=o.child,_.flags&8192&&(k=_.memoizedState!==null,_.stateNode.isHidden=k,!k||_.alternate!==null&&_.alternate.memoizedState!==null||(Sp=Ht())),v&4&&Cc(o);break;case 22:if(Pe=h!==null&&h.memoizedState!==null,o.mode&1?(Qr=(ge=Qr)||Pe,qs(a,o),Qr=ge):qs(a,o),Uo(o),v&8192){if(ge=o.memoizedState!==null,(o.stateNode.isHidden=ge)&&!Pe&&(o.mode&1)!==0)for(rt=o,Pe=o.child;Pe!==null;){for(je=rt=Pe;rt!==null;){switch(Ie=rt,Je=Ie.child,Ie.tag){case 0:case 11:case 14:case 15:Wi(4,Ie,Ie.return);break;case 1:Sc(Ie,Ie.return);var nt=Ie.stateNode;if(typeof nt.componentWillUnmount=="function"){v=Ie,h=Ie.return;try{a=v,nt.props=a.memoizedProps,nt.state=a.memoizedState,nt.componentWillUnmount()}catch(ot){rn(v,h,ot)}}break;case 5:Sc(Ie,Ie.return);break;case 22:if(Ie.memoizedState!==null){Sa(je);continue}}Je!==null?(Je.return=Ie,rt=Je):Sa(je)}Pe=Pe.sibling}e:for(Pe=null,je=o;;){if(je.tag===5){if(Pe===null){Pe=je;try{_=je.stateNode,ge?(k=_.style,typeof k.setProperty=="function"?k.setProperty("display","none","important"):k.display="none"):(G=je.stateNode,Q=je.memoizedProps.style,F=Q!=null&&Q.hasOwnProperty("display")?Q.display:null,G.style.display=Lt("display",F))}catch(ot){rn(o,o.return,ot)}}}else if(je.tag===6){if(Pe===null)try{je.stateNode.nodeValue=ge?"":je.memoizedProps}catch(ot){rn(o,o.return,ot)}}else if((je.tag!==22&&je.tag!==23||je.memoizedState===null||je===o)&&je.child!==null){je.child.return=je,je=je.child;continue}if(je===o)break e;for(;je.sibling===null;){if(je.return===null||je.return===o)break e;Pe===je&&(Pe=null),je=je.return}Pe===je&&(Pe=null),je.sibling.return=je.return,je=je.sibling}}break;case 19:qs(a,o),Uo(o),v&4&&Cc(o);break;case 21:break;default:qs(a,o),Uo(o)}}function Uo(o){var a=o.flags;if(a&2){try{e:{for(var h=o.return;h!==null;){if(tv(h)){var v=h;break e}h=h.return}throw Error(t(160))}switch(v.tag){case 5:var _=v.stateNode;v.flags&32&&(Or(_,""),v.flags&=-33);var k=rv(o);vf(o,k,_);break;case 3:case 4:var F=v.stateNode.containerInfo,G=rv(o);xp(o,G,F);break;default:throw Error(t(161))}}catch(Q){rn(o,o.return,Q)}o.flags&=-3}a&4096&&(o.flags&=-4097)}function yf(o,a,h){rt=o,_p(o)}function _p(o,a,h){for(var v=(o.mode&1)!==0;rt!==null;){var _=rt,k=_.child;if(_.tag===22&&v){var F=_.memoizedState!==null||mf;if(!F){var G=_.alternate,Q=G!==null&&G.memoizedState!==null||Qr;G=mf;var ge=Qr;if(mf=F,(Qr=Q)&&!ge)for(rt=_;rt!==null;)F=rt,Q=F.child,F.tag===22&&F.memoizedState!==null?nv(_):Q!==null?(Q.return=F,rt=Q):nv(_);for(;k!==null;)rt=k,_p(k),k=k.sibling;rt=_,mf=G,Qr=ge}zo(o)}else(_.subtreeFlags&8772)!==0&&k!==null?(k.return=_,rt=k):zo(o)}}function zo(o){for(;rt!==null;){var a=rt;if((a.flags&8772)!==0){var h=a.alternate;try{if((a.flags&8772)!==0)switch(a.tag){case 0:case 11:case 15:Qr||$u(5,a);break;case 1:var v=a.stateNode;if(a.flags&4&&!Qr)if(h===null)v.componentDidMount();else{var _=a.elementType===a.type?h.memoizedProps:go(a.type,h.memoizedProps);v.componentDidUpdate(_,h.memoizedState,v.__reactInternalSnapshotBeforeUpdate)}var k=a.updateQueue;k!==null&&Kh(a,k,v);break;case 3:var F=a.updateQueue;if(F!==null){if(h=null,a.child!==null)switch(a.child.tag){case 5:h=a.child.stateNode;break;case 1:h=a.child.stateNode}Kh(a,F,h)}break;case 5:var G=a.stateNode;if(h===null&&a.flags&4){h=G;var Q=a.memoizedProps;switch(a.type){case"button":case"input":case"select":case"textarea":Q.autoFocus&&h.focus();break;case"img":Q.src&&(h.src=Q.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(a.memoizedState===null){var ge=a.alternate;if(ge!==null){var Pe=ge.memoizedState;if(Pe!==null){var je=Pe.dehydrated;je!==null&&vr(je)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Qr||a.flags&512&&gf(a)}catch(Ie){rn(a,a.return,Ie)}}if(a===o){rt=null;break}if(h=a.sibling,h!==null){h.return=a.return,rt=h;break}rt=a.return}}function Sa(o){for(;rt!==null;){var a=rt;if(a===o){rt=null;break}var h=a.sibling;if(h!==null){h.return=a.return,rt=h;break}rt=a.return}}function nv(o){for(;rt!==null;){var a=rt;try{switch(a.tag){case 0:case 11:case 15:var h=a.return;try{$u(4,a)}catch(Q){rn(a,h,Q)}break;case 1:var v=a.stateNode;if(typeof v.componentDidMount=="function"){var _=a.return;try{v.componentDidMount()}catch(Q){rn(a,_,Q)}}var k=a.return;try{gf(a)}catch(Q){rn(a,k,Q)}break;case 5:var F=a.return;try{gf(a)}catch(Q){rn(a,F,Q)}}}catch(Q){rn(a,a.return,Q)}if(a===o){rt=null;break}var G=a.sibling;if(G!==null){G.return=a.return,rt=G;break}rt=a.return}}var sv=Math.ceil,xf=P.ReactCurrentDispatcher,Ep=P.ReactCurrentOwner,vo=P.ReactCurrentBatchConfig,mr=0,An=null,vn=null,Bn=0,Ks=0,kc=Es(0),_n=0,Uu=null,Ca=0,zu=0,wf=0,Hu=null,Ts=null,Sp=0,gl=1/0,Vi=null,bf=!1,Cp=null,ka=null,_f=!1,Na=null,fs=0,Bu=0,kp=null,Ef=-1,Gu=0;function hs(){return(mr&6)!==0?Ht():Ef!==-1?Ef:Ef=Ht()}function Ta(o){return(o.mode&1)===0?1:(mr&2)!==0&&Bn!==0?Bn&-Bn:Lg.transition!==null?(Gu===0&&(Gu=nu()),Gu):(o=nr,o!==0||(o=window.event,o=o===void 0?16:cg(o.type)),o)}function Ho(o,a,h,v){if(50<Bu)throw Bu=0,kp=null,Error(t(185));Ya(o,h,v),((mr&2)===0||o!==An)&&(o===An&&((mr&2)===0&&(zu|=h),_n===4&&Ra(o,Bn)),Rs(o,v),h===1&&mr===0&&(a.mode&1)===0&&(gl=Ht()+500,Bd&&ya()))}function Rs(o,a){var h=o.callbackNode;Eh(o,a);var v=ni(o,o===An?Bn:0);if(v===0)h!==null&&Oe(h),o.callbackNode=null,o.callbackPriority=0;else if(a=v&-v,o.callbackPriority!==a){if(h!=null&&Oe(h),a===1)o.tag===0?ol(ov.bind(null,o)):jg(ov.bind(null,o)),$d(function(){(mr&6)===0&&ya()}),h=null;else{switch(Io(v)){case 1:h=un;break;case 4:h=ws;break;case 16:h=os;break;case 536870912:h=Br;break;default:h=os}h=fv(h,Sf.bind(null,o))}o.callbackPriority=a,o.callbackNode=h}}function Sf(o,a){if(Ef=-1,Gu=0,(mr&6)!==0)throw Error(t(327));var h=o.callbackNode;if(Nc()&&o.callbackNode!==h)return null;var v=ni(o,o===An?Bn:0);if(v===0)return null;if((v&30)!==0||(v&o.expiredLanes)!==0||a)a=Cf(o,v);else{a=v;var _=mr;mr|=2;var k=av();(An!==o||Bn!==a)&&(Vi=null,gl=Ht()+500,yl(o,a));do try{L0();break}catch(G){iv(o,G)}while(!0);Mi(),xf.current=k,mr=_,vn!==null?a=0:(An=null,Bn=0,a=_n)}if(a!==0){if(a===2&&(_=Kl(o),_!==0&&(v=_,a=Np(o,_))),a===1)throw h=Uu,yl(o,0),Ra(o,v),Rs(o,Ht()),h;if(a===6)Ra(o,v);else{if(_=o.current.alternate,(v&30)===0&&!O0(_)&&(a=Cf(o,v),a===2&&(k=Kl(o),k!==0&&(v=k,a=Np(o,k))),a===1))throw h=Uu,yl(o,0),Ra(o,v),Rs(o,Ht()),h;switch(o.finishedWork=_,o.finishedLanes=v,a){case 0:case 1:throw Error(t(345));case 2:xl(o,Ts,Vi);break;case 3:if(Ra(o,v),(v&130023424)===v&&(a=Sp+500-Ht(),10<a)){if(ni(o,0)!==0)break;if(_=o.suspendedLanes,(_&v)!==v){hs(),o.pingedLanes|=o.suspendedLanes&_;break}o.timeoutHandle=pa(xl.bind(null,o,Ts,Vi),a);break}xl(o,Ts,Vi);break;case 4:if(Ra(o,v),(v&4194240)===v)break;for(a=o.eventTimes,_=-1;0<v;){var F=31-Mn(v);k=1<<F,F=a[F],F>_&&(_=F),v&=~k}if(v=_,v=Ht()-v,v=(120>v?120:480>v?480:1080>v?1080:1920>v?1920:3e3>v?3e3:4320>v?4320:1960*sv(v/1960))-v,10<v){o.timeoutHandle=pa(xl.bind(null,o,Ts,Vi),v);break}xl(o,Ts,Vi);break;case 5:xl(o,Ts,Vi);break;default:throw Error(t(329))}}}return Rs(o,Ht()),o.callbackNode===h?Sf.bind(null,o):null}function Np(o,a){var h=Hu;return o.current.memoizedState.isDehydrated&&(yl(o,a).flags|=256),o=Cf(o,a),o!==2&&(a=Ts,Ts=h,a!==null&&Tp(a)),o}function Tp(o){Ts===null?Ts=o:Ts.push.apply(Ts,o)}function O0(o){for(var a=o;;){if(a.flags&16384){var h=a.updateQueue;if(h!==null&&(h=h.stores,h!==null))for(var v=0;v<h.length;v++){var _=h[v],k=_.getSnapshot;_=_.value;try{if(!me(k(),_))return!1}catch{return!1}}}if(h=a.child,a.subtreeFlags&16384&&h!==null)h.return=a,a=h;else{if(a===o)break;for(;a.sibling===null;){if(a.return===null||a.return===o)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function Ra(o,a){for(a&=~wf,a&=~zu,o.suspendedLanes|=a,o.pingedLanes&=~a,o=o.expirationTimes;0<a;){var h=31-Mn(a),v=1<<h;o[h]=-1,a&=~v}}function ov(o){if((mr&6)!==0)throw Error(t(327));Nc();var a=ni(o,0);if((a&1)===0)return Rs(o,Ht()),null;var h=Cf(o,a);if(o.tag!==0&&h===2){var v=Kl(o);v!==0&&(a=v,h=Np(o,v))}if(h===1)throw h=Uu,yl(o,0),Ra(o,a),Rs(o,Ht()),h;if(h===6)throw Error(t(345));return o.finishedWork=o.current.alternate,o.finishedLanes=a,xl(o,Ts,Vi),Rs(o,Ht()),null}function Rp(o,a){var h=mr;mr|=1;try{return o(a)}finally{mr=h,mr===0&&(gl=Ht()+500,Bd&&ya())}}function vl(o){Na!==null&&Na.tag===0&&(mr&6)===0&&Nc();var a=mr;mr|=1;var h=vo.transition,v=nr;try{if(vo.transition=null,nr=1,o)return o()}finally{nr=v,vo.transition=h,mr=a,(mr&6)===0&&ya()}}function Ap(){Ks=kc.current,Wr(kc)}function yl(o,a){o.finishedWork=null,o.finishedLanes=0;var h=o.timeoutHandle;if(h!==-1&&(o.timeoutHandle=-1,xu(h)),vn!==null)for(h=vn.return;h!==null;){var v=h;switch(ll(v),v.tag){case 1:v=v.type.childContextTypes,v!=null&&Hd();break;case 3:ba(),Wr(Ss),Wr(Jn),Zd();break;case 5:Qd(v);break;case 4:ba();break;case 13:Wr(Xr);break;case 19:Wr(Xr);break;case 10:Kd(v.type._context);break;case 22:case 23:Ap()}h=h.return}if(An=o,vn=o=Bo(o.current,null),Bn=Ks=a,_n=0,Uu=null,wf=zu=Ca=0,Ts=Hu=null,ul!==null){for(a=0;a<ul.length;a++)if(h=ul[a],v=h.interleaved,v!==null){h.interleaved=null;var _=v.next,k=h.pending;if(k!==null){var F=k.next;k.next=_,v.next=F}h.pending=v}ul=null}return o}function iv(o,a){do{var h=vn;try{if(Mi(),ku.current=of,gc){for(var v=tn.memoizedState;v!==null;){var _=v.queue;_!==null&&(_.pending=null),v=v.next}gc=!1}if(_a=0,bn=dn=tn=null,Nu=!1,fl=0,Ep.current=null,h===null||h.return===null){_n=1,Uu=a,vn=null;break}e:{var k=o,F=h.return,G=h,Q=a;if(a=Bn,G.flags|=32768,Q!==null&&typeof Q=="object"&&typeof Q.then=="function"){var ge=Q,Pe=G,je=Pe.tag;if((Pe.mode&1)===0&&(je===0||je===11||je===15)){var Ie=Pe.alternate;Ie?(Pe.updateQueue=Ie.updateQueue,Pe.memoizedState=Ie.memoizedState,Pe.lanes=Ie.lanes):(Pe.updateQueue=null,Pe.memoizedState=null)}var Je=Kg(F);if(Je!==null){Je.flags&=-257,up(Je,F,G,k,a),Je.mode&1&&Pu(k,ge,a),a=Je,Q=ge;var nt=a.updateQueue;if(nt===null){var ot=new Set;ot.add(Q),a.updateQueue=ot}else nt.add(Q);break e}else{if((a&1)===0){Pu(k,ge,a),Ip();break e}Q=Error(t(426))}}else if(Vr&&G.mode&1){var fn=Kg(F);if(fn!==null){(fn.flags&65536)===0&&(fn.flags|=256),up(fn,F,G,k,a),hi(ml(Q,G));break e}}k=Q=ml(Q,G),_n!==4&&(_n=2),Hu===null?Hu=[k]:Hu.push(k),k=F;do{switch(k.tag){case 3:k.flags|=65536,a&=-a,k.lanes|=a;var fe=Iu(k,Q,a);Ug(k,fe);break e;case 1:G=Q;var re=k.type,he=k.stateNode;if((k.flags&128)===0&&(typeof re.getDerivedStateFromError=="function"||he!==null&&typeof he.componentDidCatch=="function"&&(ka===null||!ka.has(he)))){k.flags|=65536,a&=-a,k.lanes|=a;var De=df(k,G,a);Ug(k,De);break e}}k=k.return}while(k!==null)}cv(h)}catch(lt){a=lt,vn===h&&h!==null&&(vn=h=h.return);continue}break}while(!0)}function av(){var o=xf.current;return xf.current=of,o===null?of:o}function Ip(){(_n===0||_n===3||_n===2)&&(_n=4),An===null||(Ca&268435455)===0&&(zu&268435455)===0||Ra(An,Bn)}function Cf(o,a){var h=mr;mr|=2;var v=av();(An!==o||Bn!==a)&&(Vi=null,yl(o,a));do try{D0();break}catch(_){iv(o,_)}while(!0);if(Mi(),mr=h,xf.current=v,vn!==null)throw Error(t(261));return An=null,Bn=0,_n}function D0(){for(;vn!==null;)lv(vn)}function L0(){for(;vn!==null&&!Ze();)lv(vn)}function lv(o){var a=dv(o.alternate,o,Ks);o.memoizedProps=o.pendingProps,a===null?cv(o):vn=a,Ep.current=null}function cv(o){var a=o;do{var h=a.alternate;if(o=a.return,(a.flags&32768)===0){if(h=P0(h,a,Ks),h!==null){vn=h;return}}else{if(h=F0(h,a),h!==null){h.flags&=32767,vn=h;return}if(o!==null)o.flags|=32768,o.subtreeFlags=0,o.deletions=null;else{_n=6,vn=null;return}}if(a=a.sibling,a!==null){vn=a;return}vn=a=o}while(a!==null);_n===0&&(_n=5)}function xl(o,a,h){var v=nr,_=vo.transition;try{vo.transition=null,nr=1,M0(o,a,h,v)}finally{vo.transition=_,nr=v}return null}function M0(o,a,h,v){do Nc();while(Na!==null);if((mr&6)!==0)throw Error(t(327));h=o.finishedWork;var _=o.finishedLanes;if(h===null)return null;if(o.finishedWork=null,o.finishedLanes=0,h===o.current)throw Error(t(177));o.callbackNode=null,o.callbackPriority=0;var k=h.lanes|h.childLanes;if(vd(o,k),o===An&&(vn=An=null,Bn=0),(h.subtreeFlags&2064)===0&&(h.flags&2064)===0||_f||(_f=!0,fv(os,function(){return Nc(),null})),k=(h.flags&15990)!==0,(h.subtreeFlags&15990)!==0||k){k=vo.transition,vo.transition=null;var F=nr;nr=1;var G=mr;mr|=4,Ep.current=null,j0(o,h),bp(h,o),T0(sl),Za=!!vu,sl=vu=null,o.current=h,yf(h),Tr(),mr=G,nr=F,vo.transition=k}else o.current=h;if(_f&&(_f=!1,Na=o,fs=_),k=o.pendingLanes,k===0&&(ka=null),md(h.stateNode),Rs(o,Ht()),a!==null)for(v=o.onRecoverableError,h=0;h<a.length;h++)_=a[h],v(_.value,{componentStack:_.stack,digest:_.digest});if(bf)throw bf=!1,o=Cp,Cp=null,o;return(fs&1)!==0&&o.tag!==0&&Nc(),k=o.pendingLanes,(k&1)!==0?o===kp?Bu++:(Bu=0,kp=o):Bu=0,ya(),null}function Nc(){if(Na!==null){var o=Io(fs),a=vo.transition,h=nr;try{if(vo.transition=null,nr=16>o?16:o,Na===null)var v=!1;else{if(o=Na,Na=null,fs=0,(mr&6)!==0)throw Error(t(331));var _=mr;for(mr|=4,rt=o.current;rt!==null;){var k=rt,F=k.child;if((rt.flags&16)!==0){var G=k.deletions;if(G!==null){for(var Q=0;Q<G.length;Q++){var ge=G[Q];for(rt=ge;rt!==null;){var Pe=rt;switch(Pe.tag){case 0:case 11:case 15:Wi(8,Pe,k)}var je=Pe.child;if(je!==null)je.return=Pe,rt=je;else for(;rt!==null;){Pe=rt;var Ie=Pe.sibling,Je=Pe.return;if(ev(Pe),Pe===ge){rt=null;break}if(Ie!==null){Ie.return=Je,rt=Ie;break}rt=Je}}}var nt=k.alternate;if(nt!==null){var ot=nt.child;if(ot!==null){nt.child=null;do{var fn=ot.sibling;ot.sibling=null,ot=fn}while(ot!==null)}}rt=k}}if((k.subtreeFlags&2064)!==0&&F!==null)F.return=k,rt=F;else e:for(;rt!==null;){if(k=rt,(k.flags&2048)!==0)switch(k.tag){case 0:case 11:case 15:Wi(9,k,k.return)}var fe=k.sibling;if(fe!==null){fe.return=k.return,rt=fe;break e}rt=k.return}}var re=o.current;for(rt=re;rt!==null;){F=rt;var he=F.child;if((F.subtreeFlags&2064)!==0&&he!==null)he.return=F,rt=he;else e:for(F=re;rt!==null;){if(G=rt,(G.flags&2048)!==0)try{switch(G.tag){case 0:case 11:case 15:$u(9,G)}}catch(lt){rn(G,G.return,lt)}if(G===F){rt=null;break e}var De=G.sibling;if(De!==null){De.return=G.return,rt=De;break e}rt=G.return}}if(mr=_,ya(),Ln&&typeof Ln.onPostCommitFiberRoot=="function")try{Ln.onPostCommitFiberRoot(ri,o)}catch{}v=!0}return v}finally{nr=h,vo.transition=a}}return!1}function kf(o,a,h){a=ml(h,a),a=Iu(o,a,1),o=po(o,a,1),a=hs(),o!==null&&(Ya(o,1,a),Rs(o,a))}function rn(o,a,h){if(o.tag===3)kf(o,o,h);else for(;a!==null;){if(a.tag===3){kf(a,o,h);break}else if(a.tag===1){var v=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof v.componentDidCatch=="function"&&(ka===null||!ka.has(v))){o=ml(h,o),o=df(a,o,1),a=po(a,o,1),o=hs(),a!==null&&(Ya(a,1,o),Rs(a,o));break}}a=a.return}}function $0(o,a,h){var v=o.pingCache;v!==null&&v.delete(a),a=hs(),o.pingedLanes|=o.suspendedLanes&h,An===o&&(Bn&h)===h&&(_n===4||_n===3&&(Bn&130023424)===Bn&&500>Ht()-Sp?yl(o,0):wf|=h),Rs(o,a)}function uv(o,a){a===0&&((o.mode&1)===0?a=1:(a=Ao,Ao<<=1,(Ao&130023424)===0&&(Ao=4194304)));var h=hs();o=$i(o,a),o!==null&&(Ya(o,a,h),Rs(o,h))}function U0(o){var a=o.memoizedState,h=0;a!==null&&(h=a.retryLane),uv(o,h)}function z0(o,a){var h=0;switch(o.tag){case 13:var v=o.stateNode,_=o.memoizedState;_!==null&&(h=_.retryLane);break;case 19:v=o.stateNode;break;default:throw Error(t(314))}v!==null&&v.delete(a),uv(o,h)}var dv;dv=function(o,a,h){if(o!==null)if(o.memoizedProps!==a.pendingProps||Ss.current)us=!0;else{if((o.lanes&h)===0&&(a.flags&128)===0)return us=!1,Xg(o,a,h);us=(o.flags&131072)!==0}else us=!1,Vr&&(a.flags&1048576)!==0&&Og(a,Wd,a.index);switch(a.lanes=0,a.tag){case 2:var v=a.type;pf(o,a),o=a.pendingProps;var _=dc(a,Jn.current);wa(a,h),_=hl(null,a,v,o,_,h);var k=ef();return a.flags|=1,typeof _=="object"&&_!==null&&typeof _.render=="function"&&_.$$typeof===void 0?(a.tag=1,a.memoizedState=null,a.updateQueue=null,Cs(v)?(k=!0,lo(a)):k=!1,a.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,Jd(a),_.updater=cf,a.stateNode=_,_._reactInternals=a,cp(a,v,o,h),a=gp(null,a,v,!0,k,h)):(a.tag=0,Vr&&k&&wu(a),Un(null,a,_,h),a=a.child),a;case 16:v=a.elementType;e:{switch(pf(o,a),o=a.pendingProps,_=v._init,v=_(v._payload),a.type=v,_=a.tag=B0(v),o=go(v,o),_){case 0:a=pp(null,a,v,o,h);break e;case 1:a=mp(null,a,v,o,h);break e;case 11:a=Yg(null,a,v,o,h);break e;case 14:a=dp(null,a,v,go(v.type,o),h);break e}throw Error(t(306,v,""))}return a;case 0:return v=a.type,_=a.pendingProps,_=a.elementType===v?_:go(v,_),pp(o,a,v,_,h);case 1:return v=a.type,_=a.pendingProps,_=a.elementType===v?_:go(v,_),mp(o,a,v,_,h);case 3:e:{if(Jg(a),o===null)throw Error(t(387));v=a.pendingProps,k=a.memoizedState,_=k.element,$g(o,a),pc(a,v,null,h);var F=a.memoizedState;if(v=F.element,k.isDehydrated)if(k={element:v,isDehydrated:!1,cache:F.cache,pendingSuspenseBoundaries:F.pendingSuspenseBoundaries,transitions:F.transitions},a.updateQueue.baseState=k,a.memoizedState=k,a.flags&256){_=ml(Error(t(423)),a),a=yi(o,a,v,h,_);break e}else if(v!==_){_=ml(Error(t(424)),a),a=yi(o,a,v,h,_);break e}else for(Ws=ma(a.stateNode.containerInfo.firstChild),Qn=a,Vr=!0,Do=null,h=qd(a,null,v,h),a.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling;else{if(fi(),v===_){a=Mo(o,a,h);break e}Un(o,a,v,h)}a=a.child}return a;case 5:return Jh(a),o===null&&ks(a),v=a.type,_=a.pendingProps,k=o!==null?o.memoizedProps:null,F=_.children,yu(v,_)?F=null:k!==null&&yu(v,k)&&(a.flags|=32),hp(o,a),Un(o,a,F,h),a.child;case 6:return o===null&&ks(a),null;case 13:return hf(o,a,h);case 4:return Yh(a,a.stateNode.containerInfo),v=a.pendingProps,o===null?a.child=ln(a,null,v,h):Un(o,a,v,h),a.child;case 11:return v=a.type,_=a.pendingProps,_=a.elementType===v?_:go(v,_),Yg(o,a,v,_,h);case 7:return Un(o,a,a.pendingProps,h),a.child;case 8:return Un(o,a,a.pendingProps.children,h),a.child;case 12:return Un(o,a,a.pendingProps.children,h),a.child;case 10:e:{if(v=a.type._context,_=a.pendingProps,k=a.memoizedProps,F=_.value,Mr(Eu,v._currentValue),v._currentValue=F,k!==null)if(me(k.value,F)){if(k.children===_.children&&!Ss.current){a=Mo(o,a,h);break e}}else for(k=a.child,k!==null&&(k.return=a);k!==null;){var G=k.dependencies;if(G!==null){F=k.child;for(var Q=G.firstContext;Q!==null;){if(Q.context===v){if(k.tag===1){Q=Ui(-1,h&-h),Q.tag=2;var ge=k.updateQueue;if(ge!==null){ge=ge.shared;var Pe=ge.pending;Pe===null?Q.next=Q:(Q.next=Pe.next,Pe.next=Q),ge.pending=Q}}k.lanes|=h,Q=k.alternate,Q!==null&&(Q.lanes|=h),$n(k.return,h,a),G.lanes|=h;break}Q=Q.next}}else if(k.tag===10)F=k.type===a.type?null:k.child;else if(k.tag===18){if(F=k.return,F===null)throw Error(t(341));F.lanes|=h,G=F.alternate,G!==null&&(G.lanes|=h),$n(F,h,a),F=k.sibling}else F=k.child;if(F!==null)F.return=k;else for(F=k;F!==null;){if(F===a){F=null;break}if(k=F.sibling,k!==null){k.return=F.return,F=k;break}F=F.return}k=F}Un(o,a,_.children,h),a=a.child}return a;case 9:return _=a.type,v=a.pendingProps.children,wa(a,h),_=fo(_),v=v(_),a.flags|=1,Un(o,a,v,h),a.child;case 14:return v=a.type,_=go(v,a.pendingProps),_=go(v.type,_),dp(o,a,v,_,h);case 15:return vi(o,a,a.type,a.pendingProps,h);case 17:return v=a.type,_=a.pendingProps,_=a.elementType===v?_:go(v,_),pf(o,a),a.tag=1,Cs(v)?(o=!0,lo(a)):o=!1,wa(a,h),pl(a,v,_),cp(a,v,_,h),gp(null,a,v,!0,o,h);case 19:return Ea(o,a,h);case 22:return fp(o,a,h)}throw Error(t(156,a.tag))};function fv(o,a){return Z(o,a)}function H0(o,a,h,v){this.tag=o,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=v,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function yo(o,a,h,v){return new H0(o,a,h,v)}function Nf(o){return o=o.prototype,!(!o||!o.isReactComponent)}function B0(o){if(typeof o=="function")return Nf(o)?1:0;if(o!=null){if(o=o.$$typeof,o===ae)return 11;if(o===oe)return 14}return 2}function Bo(o,a){var h=o.alternate;return h===null?(h=yo(o.tag,a,o.key,o.mode),h.elementType=o.elementType,h.type=o.type,h.stateNode=o.stateNode,h.alternate=o,o.alternate=h):(h.pendingProps=a,h.type=o.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=o.flags&14680064,h.childLanes=o.childLanes,h.lanes=o.lanes,h.child=o.child,h.memoizedProps=o.memoizedProps,h.memoizedState=o.memoizedState,h.updateQueue=o.updateQueue,a=o.dependencies,h.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},h.sibling=o.sibling,h.index=o.index,h.ref=o.ref,h}function Tf(o,a,h,v,_,k){var F=2;if(v=o,typeof o=="function")Nf(o)&&(F=1);else if(typeof o=="string")F=5;else e:switch(o){case M:return wl(h.children,_,k,a);case V:F=8,_|=8;break;case X:return o=yo(12,h,a,_|2),o.elementType=X,o.lanes=k,o;case we:return o=yo(13,h,a,_),o.elementType=we,o.lanes=k,o;case ue:return o=yo(19,h,a,_),o.elementType=ue,o.lanes=k,o;case te:return Rf(h,_,k,a);default:if(typeof o=="object"&&o!==null)switch(o.$$typeof){case ie:F=10;break e;case J:F=9;break e;case ae:F=11;break e;case oe:F=14;break e;case pe:F=16,v=null;break e}throw Error(t(130,o==null?o:typeof o,""))}return a=yo(F,h,a,_),a.elementType=o,a.type=v,a.lanes=k,a}function wl(o,a,h,v){return o=yo(7,o,v,a),o.lanes=h,o}function Rf(o,a,h,v){return o=yo(22,o,v,a),o.elementType=te,o.lanes=h,o.stateNode={isHidden:!1},o}function Pp(o,a,h){return o=yo(6,o,null,a),o.lanes=h,o}function Fp(o,a,h){return a=yo(4,o.children!==null?o.children:[],o.key,a),a.lanes=h,a.stateNode={containerInfo:o.containerInfo,pendingChildren:null,implementation:o.implementation},a}function G0(o,a,h,v,_){this.tag=a,this.containerInfo=o,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ka(0),this.expirationTimes=Ka(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ka(0),this.identifierPrefix=v,this.onRecoverableError=_,this.mutableSourceEagerHydrationData=null}function jp(o,a,h,v,_,k,F,G,Q){return o=new G0(o,a,h,G,Q),a===1?(a=1,k===!0&&(a|=8)):a=0,k=yo(3,null,null,a),o.current=k,k.stateNode=o,k.memoizedState={element:v,isDehydrated:h,cache:null,transitions:null,pendingSuspenseBoundaries:null},Jd(k),o}function W0(o,a,h){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:W,key:v==null?null:""+v,children:o,containerInfo:a,implementation:h}}function hv(o){if(!o)return va;o=o._reactInternals;e:{if(zs(o)!==o||o.tag!==1)throw Error(t(170));var a=o;do{switch(a.tag){case 3:a=a.stateNode.context;break e;case 1:if(Cs(a.type)){a=a.stateNode.__reactInternalMemoizedMergedChildContext;break e}}a=a.return}while(a!==null);throw Error(t(171))}if(o.tag===1){var h=o.type;if(Cs(h))return Pg(o,h,a)}return a}function pv(o,a,h,v,_,k,F,G,Q){return o=jp(h,v,!0,o,_,k,F,G,Q),o.context=hv(null),h=o.current,v=hs(),_=Ta(h),k=Ui(v,_),k.callback=a??null,po(h,k,_),o.current.lanes=_,Ya(o,_,v),Rs(o,v),o}function Af(o,a,h,v){var _=a.current,k=hs(),F=Ta(_);return h=hv(h),a.context===null?a.context=h:a.pendingContext=h,a=Ui(k,F),a.payload={element:o},v=v===void 0?null:v,v!==null&&(a.callback=v),o=po(_,a,F),o!==null&&(Ho(o,_,F,k),Xd(o,_,F)),F}function If(o){if(o=o.current,!o.child)return null;switch(o.child.tag){case 5:return o.child.stateNode;default:return o.child.stateNode}}function mv(o,a){if(o=o.memoizedState,o!==null&&o.dehydrated!==null){var h=o.retryLane;o.retryLane=h!==0&&h<a?h:a}}function Op(o,a){mv(o,a),(o=o.alternate)&&mv(o,a)}function V0(){return null}var gv=typeof reportError=="function"?reportError:function(o){console.error(o)};function Pf(o){this._internalRoot=o}Wu.prototype.render=Pf.prototype.render=function(o){var a=this._internalRoot;if(a===null)throw Error(t(409));Af(o,a,null,null)},Wu.prototype.unmount=Pf.prototype.unmount=function(){var o=this._internalRoot;if(o!==null){this._internalRoot=null;var a=o.containerInfo;vl(function(){Af(null,o,null,null)}),a[Gs]=null}};function Wu(o){this._internalRoot=o}Wu.prototype.unstable_scheduleHydration=function(o){if(o){var a=ou();o={blockedOn:null,target:o,priority:a};for(var h=0;h<He.length&&a!==0&&a<He[h].priority;h++);He.splice(h,0,o),h===0&&st(o)}};function Dp(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11)}function Ff(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11&&(o.nodeType!==8||o.nodeValue!==" react-mount-point-unstable "))}function vv(){}function q0(o,a,h,v,_){if(_){if(typeof v=="function"){var k=v;v=function(){var ge=If(F);k.call(ge)}}var F=pv(a,v,o,0,null,!1,!1,"",vv);return o._reactRootContainer=F,o[Gs]=F.current,ha(o.nodeType===8?o.parentNode:o),vl(),F}for(;_=o.lastChild;)o.removeChild(_);if(typeof v=="function"){var G=v;v=function(){var ge=If(Q);G.call(ge)}}var Q=jp(o,0,!1,null,null,!1,!1,"",vv);return o._reactRootContainer=Q,o[Gs]=Q.current,ha(o.nodeType===8?o.parentNode:o),vl(function(){Af(a,Q,h,v)}),Q}function bl(o,a,h,v,_){var k=h._reactRootContainer;if(k){var F=k;if(typeof _=="function"){var G=_;_=function(){var Q=If(F);G.call(Q)}}Af(a,F,o,_)}else F=q0(h,a,o,_,v);return If(F)}su=function(o){switch(o.tag){case 3:var a=o.stateNode;if(a.current.memoizedState.isDehydrated){var h=oo(a.pendingLanes);h!==0&&(Ja(a,h|1),Rs(a,Ht()),(mr&6)===0&&(gl=Ht()+500,ya()))}break;case 13:vl(function(){var v=$i(o,1);if(v!==null){var _=hs();Ho(v,o,1,_)}}),Op(o,1)}},Xa=function(o){if(o.tag===13){var a=$i(o,134217728);if(a!==null){var h=hs();Ho(a,o,134217728,h)}Op(o,134217728)}},yd=function(o){if(o.tag===13){var a=Ta(o),h=$i(o,a);if(h!==null){var v=hs();Ho(h,o,a,v)}Op(o,a)}},ou=function(){return nr},iu=function(o,a){var h=nr;try{return nr=o,a()}finally{nr=h}},Yr=function(o,a,h){switch(a){case"input":if(yt(o,h),a=h.name,h.type==="radio"&&a!=null){for(h=o;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll("input[name="+JSON.stringify(""+a)+'][type="radio"]'),a=0;a<h.length;a++){var v=h[a];if(v!==o&&v.form===o.form){var _=zd(v);if(!_)throw Error(t(90));Ge(v),yt(v,_)}}}break;case"textarea":Se(o,h);break;case"select":a=h.value,a!=null&&Kt(o,!!h.multiple,a,!1)}},Nr=Rp,Dn=vl;var K0={usingClientEntryPoint:!1,Events:[Yn,Wt,zd,To,Ai,Rp]},Vu={findFiberByHostInstance:li,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Y0={bundleType:Vu.bundleType,version:Vu.version,rendererPackageName:Vu.rendererPackageName,rendererConfig:Vu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:P.ReactCurrentDispatcher,findHostInstanceByFiber:function(o){return o=qa(o),o===null?null:o.stateNode},findFiberByHostInstance:Vu.findFiberByHostInstance||V0,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var jf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!jf.isDisabled&&jf.supportsFiber)try{ri=jf.inject(Y0),Ln=jf}catch{}}return _o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=K0,_o.createPortal=function(o,a){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Dp(a))throw Error(t(200));return W0(o,a,null,h)},_o.createRoot=function(o,a){if(!Dp(o))throw Error(t(299));var h=!1,v="",_=gv;return a!=null&&(a.unstable_strictMode===!0&&(h=!0),a.identifierPrefix!==void 0&&(v=a.identifierPrefix),a.onRecoverableError!==void 0&&(_=a.onRecoverableError)),a=jp(o,1,!1,null,null,h,!1,v,_),o[Gs]=a.current,ha(o.nodeType===8?o.parentNode:o),new Pf(a)},_o.findDOMNode=function(o){if(o==null)return null;if(o.nodeType===1)return o;var a=o._reactInternals;if(a===void 0)throw typeof o.render=="function"?Error(t(188)):(o=Object.keys(o).join(","),Error(t(268,o)));return o=qa(a),o=o===null?null:o.stateNode,o},_o.flushSync=function(o){return vl(o)},_o.hydrate=function(o,a,h){if(!Ff(a))throw Error(t(200));return bl(null,o,a,!0,h)},_o.hydrateRoot=function(o,a,h){if(!Dp(o))throw Error(t(405));var v=h!=null&&h.hydratedSources||null,_=!1,k="",F=gv;if(h!=null&&(h.unstable_strictMode===!0&&(_=!0),h.identifierPrefix!==void 0&&(k=h.identifierPrefix),h.onRecoverableError!==void 0&&(F=h.onRecoverableError)),a=pv(a,null,o,1,h??null,_,!1,k,F),o[Gs]=a.current,ha(o),v)for(o=0;o<v.length;o++)h=v[o],_=h._getVersion,_=_(h._source),a.mutableSourceEagerHydrationData==null?a.mutableSourceEagerHydrationData=[h,_]:a.mutableSourceEagerHydrationData.push(h,_);return new Wu(a)},_o.render=function(o,a,h){if(!Ff(a))throw Error(t(200));return bl(null,o,a,!1,h)},_o.unmountComponentAtNode=function(o){if(!Ff(o))throw Error(t(40));return o._reactRootContainer?(vl(function(){bl(null,null,o,!1,function(){o._reactRootContainer=null,o[Gs]=null})}),!0):!1},_o.unstable_batchedUpdates=Rp,_o.unstable_renderSubtreeIntoContainer=function(o,a,h,v){if(!Ff(h))throw Error(t(200));if(o==null||o._reactInternals===void 0)throw Error(t(38));return bl(o,a,h,!1,v)},_o.version="18.3.1-next-f1338f8080-20240426",_o}var pS;function x1(){if(pS)return ux.exports;pS=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),ux.exports=zO(),ux.exports}var mS;function HO(){if(mS)return _v;mS=1;var r=x1();return _v.createRoot=r.createRoot,_v.hydrateRoot=r.hydrateRoot,_v}var BO=HO();const GO=Nb(BO);class WO{constructor(e){H(this,"logger");H(this,"changeListeners",new Set);var t;this.logger=e,(t=chrome==null?void 0:chrome.storage)!=null&&t.onChanged&&chrome.storage.onChanged.addListener(this.handleStorageChange.bind(this))}async getLocalItem(e){try{const t=await new Promise((n,s)=>{chrome.storage.local.get(e,i=>{chrome.runtime.lastError?s(new Error(chrome.runtime.lastError.message)):n(i)})});try{if(t[e]!==void 0){const n=JSON.parse(t[e]);return this.logger.debug(`Retrieved local item with key: ${e}`,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"getLocalItem"}),n}return null}catch{return this.logger.debug(`Local item with key: ${e} is not JSON, returning as is`,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"getLocalItem"}),t[e]}}catch(t){return this.logger.error(`Error retrieving local item with key: ${e}`,t,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"getLocalItem"}),null}}async setLocalItem(e,t){try{const n={[e]:JSON.stringify(t)};await new Promise((s,i)=>{chrome.storage.local.set(n,()=>{chrome.runtime.lastError?i(new Error(chrome.runtime.lastError.message)):s()})}),this.logger.debug(`Stored local item with key: ${e}`,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"setLocalItem"})}catch(n){throw this.logger.error(`Error storing local item with key: ${e}`,n,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"setLocalItem"}),n}}async removeLocalItem(e){try{await new Promise((t,n)=>{chrome.storage.local.remove(e,()=>{chrome.runtime.lastError?n(new Error(chrome.runtime.lastError.message)):t()})}),this.logger.debug(`Removed local item with key: ${e}`,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"removeLocalItem"})}catch(t){throw this.logger.error(`Error removing local item with key: ${e}`,t,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"removeLocalItem"}),t}}async clearLocal(){try{await new Promise((e,t)=>{chrome.storage.local.clear(()=>{chrome.runtime.lastError?t(new Error(chrome.runtime.lastError.message)):e()})}),this.logger.info("Cleared local storage",{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"clearLocal"})}catch(e){throw this.logger.error("Error clearing local storage",e,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"clearLocal"}),e}}async getAllKeys(){try{const e=await new Promise((n,s)=>{chrome.storage.local.get(null,i=>{chrome.runtime.lastError?s(new Error(chrome.runtime.lastError.message)):n(i)})}),t=Object.keys(e);return this.logger.debug(`Retrieved ${t.length} keys from storage`,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"getAllKeys"}),t}catch(e){return this.logger.error("Error getting all keys",e,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"getAllKeys"}),[]}}onChanged(e){this.changeListeners.add(e)}removeChangeListener(e){this.changeListeners.delete(e)}handleStorageChange(e,t){if((t==="local"||t==="session"||t==="sync")&&this.changeListeners.size>0){const n={};for(const[s,i]of Object.entries(e))try{n[s]={oldValue:i.oldValue?JSON.parse(i.oldValue):void 0,newValue:i.newValue?JSON.parse(i.newValue):void 0}}catch(c){this.logger.debug("Storage change value not JSON",{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"handleStorageChange",key:s,areaName:t,error:c}),n[s]={oldValue:i.oldValue,newValue:i.newValue}}this.changeListeners.forEach(s=>{try{s(n)}catch(i){this.logger.error("Error in storage change callback",i,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"handleStorageChange"})}})}}}class VO{constructor(e){H(this,"logger");H(this,"threadListeners",new Set);H(this,"currentThread",null);this.logger=e,this.initializeStorageListeners()}initializeStorageListeners(){var e,t,n;(t=(e=chrome==null?void 0:chrome.storage)==null?void 0:e.local)!=null&&t.onChanged&&chrome.storage.local.onChanged.addListener(s=>{Object.keys(s).some(c=>c.includes("threadId_window_")&&c.includes("_tab_")||c.includes("threadData_window_")&&c.includes("_tab_"))&&(this.logger.debug("Tab-specific thread data changed, triggering update",{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"initializeStorageListeners",changedKeys:Object.keys(s)}),this.handleThreadDataChange())}),(n=chrome==null?void 0:chrome.tabs)!=null&&n.onActivated&&chrome.tabs.onActivated.addListener(s=>{this.logger.debug("Tab activated, updating thread data",{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"initializeStorageListeners",tabId:s.tabId,windowId:s.windowId}),setTimeout(()=>{this.handleThreadDataChange()},100)})}async getCurrentTabInfo(){try{const[e]=await chrome.tabs.query({active:!0,currentWindow:!0});return!(e!=null&&e.id)||!(e!=null&&e.windowId)?(this.logger.warn("No active tab found",{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentTabInfo"}),null):{tabId:e.id,windowId:e.windowId}}catch(e){return this.logger.error("Error getting current tab info",e,{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentTabInfo"}),null}}async handleThreadDataChange(){var e;try{const t=await this.getCurrentTabInfo(),n=await this.getCurrentThread(),s=(n==null?void 0:n.threadId)||null,i=((e=this.currentThread)==null?void 0:e.threadId)||null;s!==i&&(this.logger.info("Notifying thread listeners for tab",{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"handleThreadDataChange",tabId:t==null?void 0:t.tabId,windowId:t==null?void 0:t.windowId,newThreadId:s,currentThreadId:i}),this.currentThread=n,this.notifyThreadListeners(n))}catch(t){this.logger.error("Error handling thread data change",t,{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"handleThreadDataChange"})}}async getCurrentThread(){const e=await this.getCurrentTabInfo();if(!e)return this.logger.warn("No tab info available for getting current thread",{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentThread"}),null;const{tabId:t,windowId:n}=e,s=`threadId_window_${n}_tab_${t}`,i=`threadData_window_${n}_tab_${t}`;return new Promise(c=>{chrome.storage.local.get([s,i],d=>{if(chrome.runtime.lastError){this.logger.error("Error getting thread data",chrome.runtime.lastError,{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentThread",tabId:t,windowId:n}),c(null);return}const p=d[s],m=d[i];if(!p||!m){this.logger.debug(`No thread data found for tab ${t} in window ${n}`,{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentThread",tabId:t,windowId:n,hasThreadId:!!p,hasThreadData:!!m}),c(null);return}try{const g=this.transformToEmailThread(p,m);this.logger.debug(`Retrieved thread data for tab ${t} in window ${n}`,{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentThread",tabId:t,windowId:n,threadId:p}),c(g)}catch(g){this.logger.error("Error transforming thread data",g,{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentThread",tabId:t,windowId:n}),c(null)}})})}async getCurrentThreadId(){const e=await this.getCurrentTabInfo();if(!e)return this.logger.warn("No tab info available for getting current thread ID",{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentThreadId"}),null;const{tabId:t,windowId:n}=e,s=`threadId_window_${n}_tab_${t}`;return new Promise(i=>{chrome.storage.local.get([s],c=>{if(chrome.runtime.lastError){this.logger.error("Error getting thread ID",chrome.runtime.lastError,{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentThreadId",tabId:t,windowId:n}),i(null);return}const d=c[s]||null;this.logger.debug(`Retrieved thread ID for tab ${t} in window ${n}`,{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentThreadId",tabId:t,windowId:n,threadId:d}),i(d)})})}getCurrentUserEmail(){return this.logger.debug("getCurrentUserEmail called for Chrome - not needed, backend handles filtering",{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentUserEmail"}),null}onThreadChanged(e){this.threadListeners.add(e)}removeThreadListener(e){this.threadListeners.delete(e)}notifyThreadListeners(e){this.threadListeners.forEach(t=>{try{t(e)}catch(n){this.logger.error("Error in thread change callback",n,{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"notifyThreadListeners"})}})}transformToEmailThread(e,t){var n;if(!t||!Array.isArray(t))return this.logger.warn("Invalid thread data format",{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"transformToEmailThread",threadId:e,threadData:t}),null;try{const s=t.map(c=>({from:c.from||"Unknown",timestamp:c.timestamp||new Date().toISOString(),subject:c.subject||"No Subject",body:c.body||"",html:c.html||c.body||""})),i=new Set;return t.forEach(c=>{c.from&&typeof c.from=="string"&&i.add(c.from),c.to&&Array.isArray(c.to)&&c.to.forEach(d=>{typeof d=="string"&&i.add(d)}),c.cc&&Array.isArray(c.cc)&&c.cc.forEach(d=>{typeof d=="string"&&i.add(d)}),c.bcc&&Array.isArray(c.bcc)&&c.bcc.forEach(d=>{typeof d=="string"&&i.add(d)})}),{threadId:e,messages:s,subject:((n=s[0])==null?void 0:n.subject)||"No Subject",participants:Array.from(i)}}catch(s){return this.logger.error("Error transforming email messages",s,{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"transformToEmailThread",threadId:e,threadData:t}),null}}}const qO="CandleLogsDB",KO=1,hx="logs";let $p=null;function YO(){return $p||($p=new Promise((r,e)=>{console.log("[Logger] Initializing IndexedDB...");const t=indexedDB.open(qO,KO);t.onupgradeneeded=n=>{console.log("[Logger] IndexedDB upgrade needed.");const s=n.target.result;if(!s.objectStoreNames.contains(hx)){console.log(`[Logger] Creating object store: ${hx}`);const i=s.createObjectStore(hx,{keyPath:"id",autoIncrement:!0});console.log("[Logger] Creating indexes: timestamp, level, chromeContext"),i.createIndex("timestamp","timestamp",{unique:!1}),i.createIndex("level","level",{unique:!1}),i.createIndex("chromeContext","chromeContext",{unique:!1})}},t.onsuccess=n=>{console.log("[Logger] IndexedDB initialized successfully."),r(n.target.result)},t.onerror=n=>{console.error("[Logger] IndexedDB initialization failed:",n.target.error),$p=null,e(n.target.error)},t.onblocked=()=>{console.warn("[Logger] IndexedDB initialization blocked. Close other tabs using the database.")}}),$p)}YO().catch(r=>console.error("[Logger] Initial DB connection failed:",r));const JO=r=>r!==null&&typeof r=="object"&&!Array.isArray(r),XO=r=>JO(r)?["id_token","access_token","refresh_token","expires_in","token_type"].every(t=>{switch(t){case"expires_in":return typeof r[t]=="number";default:return typeof r[t]=="string"}}):!1,w1=r=>({setHttpHandler(e){r.httpHandler=e},httpHandler(){return r.httpHandler},updateHttpClientConfig(e,t){var n;(n=r.httpHandler)==null||n.updateHttpClientConfig(e,t)},httpHandlerConfigs(){return r.httpHandler.httpHandlerConfigs()}}),b1=r=>({httpHandler:r.httpHandler()});var km;(function(r){r.HTTP="http",r.HTTPS="https"})(km||(km={}));var oy;(function(r){r.MD5="md5",r.CRC32="crc32",r.CRC32C="crc32c",r.SHA1="sha1",r.SHA256="sha256"})(oy||(oy={}));const Ew="__smithy_context";class Zo{constructor(e){H(this,"method");H(this,"protocol");H(this,"hostname");H(this,"port");H(this,"path");H(this,"query");H(this,"headers");H(this,"username");H(this,"password");H(this,"fragment");H(this,"body");this.method=e.method||"GET",this.hostname=e.hostname||"localhost",this.port=e.port,this.query=e.query||{},this.headers=e.headers||{},this.body=e.body,this.protocol=e.protocol?e.protocol.slice(-1)!==":"?`${e.protocol}:`:e.protocol:"https:",this.path=e.path?e.path.charAt(0)!=="/"?`/${e.path}`:e.path:"/",this.username=e.username,this.password=e.password,this.fragment=e.fragment}static clone(e){const t=new Zo({...e,headers:{...e.headers}});return t.query&&(t.query=QO(t.query)),t}static isInstance(e){if(!e)return!1;const t=e;return"method"in t&&"protocol"in t&&"hostname"in t&&"path"in t&&typeof t.query=="object"&&typeof t.headers=="object"}clone(){return Zo.clone(this)}}function QO(r){return Object.keys(r).reduce((e,t)=>{const n=r[t];return{...e,[t]:Array.isArray(n)?[...n]:n}},{})}class lh{constructor(e){H(this,"statusCode");H(this,"reason");H(this,"headers");H(this,"body");this.statusCode=e.statusCode,this.reason=e.reason,this.headers=e.headers||{},this.body=e.body}static isInstance(e){if(!e)return!1;const t=e;return typeof t.statusCode=="number"&&typeof t.headers=="object"}}const ZO=r=>e=>async t=>{if(!Zo.isInstance(t.request))return e(t);const{request:n}=t,{handlerProtocol:s=""}=r.requestHandler.metadata||{};if(s.indexOf("h2")>=0&&!n.headers[":authority"])delete n.headers.host,n.headers[":authority"]=n.hostname+(n.port?":"+n.port:"");else if(!n.headers.host){let i=n.hostname;n.port!=null&&(i+=`:${n.port}`),n.headers.host=i}return e(t)},e2={name:"hostHeaderMiddleware",step:"build",priority:"low",tags:["HOST"],override:!0},_1=r=>({applyToStack:e=>{e.add(ZO(r),e2)}}),t2=()=>(r,e)=>async t=>{var n,s;try{const i=await r(t),{clientName:c,commandName:d,logger:p,dynamoDbDocumentClientOptions:m={}}=e,{overrideInputFilterSensitiveLog:g,overrideOutputFilterSensitiveLog:x}=m,b=g??e.inputFilterSensitiveLog,E=x??e.outputFilterSensitiveLog,{$metadata:T,...S}=i.output;return(n=p==null?void 0:p.info)==null||n.call(p,{clientName:c,commandName:d,input:b(t.input),output:E(S),metadata:T}),i}catch(i){const{clientName:c,commandName:d,logger:p,dynamoDbDocumentClientOptions:m={}}=e,{overrideInputFilterSensitiveLog:g}=m,x=g??e.inputFilterSensitiveLog;throw(s=p==null?void 0:p.error)==null||s.call(p,{clientName:c,commandName:d,input:x(t.input),error:i,metadata:i.$metadata}),i}},r2={name:"loggerMiddleware",tags:["LOGGER"],step:"initialize",override:!0},E1=r=>({applyToStack:e=>{e.add(t2(),r2)}}),n2={step:"build",tags:["RECURSION_DETECTION"],name:"recursionDetectionMiddleware",override:!0,priority:"low"},s2=()=>r=>async e=>r(e),S1=r=>({applyToStack:e=>{e.add(s2(),n2)}}),dd=r=>r[Ew]||(r[Ew]={}),Qi=r=>{if(typeof r=="function")return r;const e=Promise.resolve(r);return()=>e},o2=(r,e)=>{if(!e||e.length===0)return r;const t=[];for(const n of e)for(const s of r)s.schemeId.split("#")[1]===n&&t.push(s);for(const n of r)t.find(({schemeId:s})=>s===n.schemeId)||t.push(n);return t};function i2(r){const e=new Map;for(const t of r)e.set(t.schemeId,t);return e}const a2=(r,e)=>(t,n)=>async s=>{var x;const i=r.httpAuthSchemeProvider(await e.httpAuthSchemeParametersProvider(r,n,s.input)),c=r.authSchemePreference?await r.authSchemePreference():[],d=o2(i,c),p=i2(r.httpAuthSchemes),m=dd(n),g=[];for(const b of d){const E=p.get(b.schemeId);if(!E){g.push(`HttpAuthScheme \`${b.schemeId}\` was not enabled for this service.`);continue}const T=E.identityProvider(await e.identityProviderConfigProvider(r));if(!T){g.push(`HttpAuthScheme \`${b.schemeId}\` did not have an IdentityProvider configured.`);continue}const{identityProperties:S={},signingProperties:N={}}=((x=b.propertiesExtractor)==null?void 0:x.call(b,r,n))||{};b.identityProperties=Object.assign(b.identityProperties||{},S),b.signingProperties=Object.assign(b.signingProperties||{},N),m.selectedHttpAuthScheme={httpAuthOption:b,identity:await T(b.identityProperties),signer:E.signer};break}if(!m.selectedHttpAuthScheme)throw new Error(g.join(`
`));return t(s)},l2={step:"serialize",tags:["HTTP_AUTH_SCHEME"],name:"httpAuthSchemeMiddleware",override:!0,relation:"before",toMiddleware:"endpointV2Middleware"},C1=(r,{httpAuthSchemeParametersProvider:e,identityProviderConfigProvider:t})=>({applyToStack:n=>{n.addRelativeTo(a2(r,{httpAuthSchemeParametersProvider:e,identityProviderConfigProvider:t}),l2)}}),c2={name:"serializerMiddleware"},u2=r=>e=>{throw e},d2=(r,e)=>{},f2=r=>(e,t)=>async n=>{if(!Zo.isInstance(n.request))return e(n);const i=dd(t).selectedHttpAuthScheme;if(!i)throw new Error("No HttpAuthScheme was selected: unable to sign request");const{httpAuthOption:{signingProperties:c={}},identity:d,signer:p}=i,m=await e({...n,request:await p.sign(n.request,d,c)}).catch((p.errorHandler||u2)(c));return(p.successHandler||d2)(m.response,c),m},h2={step:"finalizeRequest",tags:["HTTP_SIGNING"],name:"httpSigningMiddleware",aliases:["apiKeyMiddleware","tokenMiddleware","awsAuthMiddleware"],override:!0,relation:"after",toMiddleware:"retryMiddleware"},k1=r=>({applyToStack:e=>{e.addRelativeTo(f2(),h2)}}),wm=r=>{if(typeof r=="function")return r;const e=Promise.resolve(r);return()=>e},N1="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",gS=Object.entries(N1).reduce((r,[e,t])=>(r[t]=Number(e),r),{}),p2=N1.split(""),Zf=6,bm=8,m2=63,Ym=r=>{let e=r.length/4*3;r.slice(-2)==="=="?e-=2:r.slice(-1)==="="&&e--;const t=new ArrayBuffer(e),n=new DataView(t);for(let s=0;s<r.length;s+=4){let i=0,c=0;for(let m=s,g=s+3;m<=g;m++)if(r[m]!=="="){if(!(r[m]in gS))throw new TypeError(`Invalid character ${r[m]} in base64 string.`);i|=gS[r[m]]<<(g-m)*Zf,c+=Zf}else i>>=Zf;const d=s/4*3;i>>=c%bm;const p=Math.floor(c/bm);for(let m=0;m<p;m++){const g=(p-m-1)*bm;n.setUint8(d+m,(i&255<<g)>>g)}}return new Uint8Array(t)},id=r=>new TextEncoder().encode(r),Nm=r=>typeof r=="string"?id(r):ArrayBuffer.isView(r)?new Uint8Array(r.buffer,r.byteOffset,r.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(r),Uy=r=>{if(typeof r=="string")return r;if(typeof r!="object"||typeof r.byteOffset!="number"||typeof r.byteLength!="number")throw new Error("@smithy/util-utf8: toUtf8 encoder function only accepts string | Uint8Array.");return new TextDecoder("utf-8").decode(r)};function Tm(r){let e;typeof r=="string"?e=id(r):e=r;const t=typeof e=="object"&&typeof e.length=="number",n=typeof e=="object"&&typeof e.byteOffset=="number"&&typeof e.byteLength=="number";if(!t&&!n)throw new Error("@smithy/util-base64: toBase64 encoder function only accepts string | Uint8Array.");let s="";for(let i=0;i<e.length;i+=3){let c=0,d=0;for(let m=i,g=Math.min(i+3,e.length);m<g;m++)c|=e[m]<<(g-m-1)*bm,d+=bm;const p=Math.ceil(d/Zf);c<<=p*Zf-d;for(let m=1;m<=p;m++){const g=(p-m)*Zf;s+=p2[(c&m2<<g)>>g]}s+="==".slice(0,4-p)}return s}class nd extends Uint8Array{static fromString(e,t="utf-8"){if(typeof e=="string")return t==="base64"?nd.mutate(Ym(e)):nd.mutate(id(e));throw new Error(`Unsupported conversion from ${typeof e} to Uint8ArrayBlobAdapter.`)}static mutate(e){return Object.setPrototypeOf(e,nd.prototype),e}transformToString(e="utf-8"){return e==="base64"?Tm(this):Uy(this)}}const sd=r=>encodeURIComponent(r).replace(/[!'()*]/g,g2),g2=r=>`%${r.charCodeAt(0).toString(16).toUpperCase()}`;function v2(r){const e=[];for(let t of Object.keys(r).sort()){const n=r[t];if(t=sd(t),Array.isArray(n))for(let s=0,i=n.length;s<i;s++)e.push(`${t}=${sd(n[s])}`);else{let s=t;(n||typeof n=="string")&&(s+=`=${sd(n)}`),e.push(s)}}return e.join("&")}function vS(r,e){return new Request(r,e)}function y2(r=0){return new Promise((e,t)=>{r&&setTimeout(()=>{const n=new Error(`Request did not complete within ${r} ms`);n.name="TimeoutError",t(n)},r)})}const px={supported:void 0};class zy{constructor(e){H(this,"config");H(this,"configProvider");typeof e=="function"?this.configProvider=e().then(t=>t||{}):(this.config=e??{},this.configProvider=Promise.resolve(this.config)),px.supported===void 0&&(px.supported=typeof Request<"u"&&"keepalive"in vS("https://[::1]"))}static create(e){return typeof(e==null?void 0:e.handle)=="function"?e:new zy(e)}destroy(){}async handle(e,{abortSignal:t,requestTimeout:n}={}){var A;this.config||(this.config=await this.configProvider);const s=n??this.config.requestTimeout,i=this.config.keepAlive===!0,c=this.config.credentials;if(t!=null&&t.aborted){const j=new Error("Request aborted");return j.name="AbortError",Promise.reject(j)}let d=e.path;const p=v2(e.query||{});p&&(d+=`?${p}`),e.fragment&&(d+=`#${e.fragment}`);let m="";if(e.username!=null||e.password!=null){const j=e.username??"",P=e.password??"";m=`${j}:${P}@`}const{port:g,method:x}=e,b=`${e.protocol}//${m}${e.hostname}${g?`:${g}`:""}${d}`,E=x==="GET"||x==="HEAD"?void 0:e.body,T={body:E,headers:new Headers(e.headers),method:x,credentials:c};(A=this.config)!=null&&A.cache&&(T.cache=this.config.cache),E&&(T.duplex="half"),typeof AbortController<"u"&&(T.signal=t),px.supported&&(T.keepalive=i),typeof this.config.requestInit=="function"&&Object.assign(T,this.config.requestInit(e));let S=()=>{};const N=vS(b,T),R=[fetch(N).then(j=>{const P=j.headers,$={};for(const M of P.entries())$[M[0]]=M[1];return j.body!=null?{response:new lh({headers:$,reason:j.statusText,statusCode:j.status,body:j.body})}:j.blob().then(M=>({response:new lh({headers:$,reason:j.statusText,statusCode:j.status,body:M})}))}),y2(s)];return t&&R.push(new Promise((j,P)=>{const $=()=>{const W=new Error("Request aborted");W.name="AbortError",P(W)};if(typeof t.addEventListener=="function"){const W=t;W.addEventListener("abort",$,{once:!0}),S=()=>W.removeEventListener("abort",$)}else t.onabort=$})),Promise.race(R).finally(S)}updateHttpClientConfig(e,t){this.config=void 0,this.configProvider=this.configProvider.then(n=>(n[e]=t,n))}httpHandlerConfigs(){return this.config??{}}}const T1=async r=>{var e;return typeof Blob=="function"&&r instanceof Blob||((e=r.constructor)==null?void 0:e.name)==="Blob"?Blob.prototype.arrayBuffer!==void 0?new Uint8Array(await r.arrayBuffer()):x2(r):w2(r)};async function x2(r){const e=await b2(r),t=Ym(e);return new Uint8Array(t)}async function w2(r){const e=[],t=r.getReader();let n=!1,s=0;for(;!n;){const{done:d,value:p}=await t.read();p&&(e.push(p),s+=p.length),n=d}const i=new Uint8Array(s);let c=0;for(const d of e)i.set(d,c),c+=d.length;return i}function b2(r){return new Promise((e,t)=>{const n=new FileReader;n.onloadend=()=>{if(n.readyState!==2)return t(new Error("Reader aborted too early"));const s=n.result??"",i=s.indexOf(","),c=i>-1?i+1:s.length;e(s.substring(c))},n.onabort=()=>t(new Error("Read aborted")),n.onerror=()=>t(n.error),n.readAsDataURL(r)})}const R1={},Sw={};for(let r=0;r<256;r++){let e=r.toString(16).toLowerCase();e.length===1&&(e=`0${e}`),R1[r]=e,Sw[e]=r}function _2(r){if(r.length%2!==0)throw new Error("Hex encoded strings must have an even number length");const e=new Uint8Array(r.length/2);for(let t=0;t<r.length;t+=2){const n=r.slice(t,t+2).toLowerCase();if(n in Sw)e[t/2]=Sw[n];else throw new Error(`Cannot decode unrecognized sequence ${n} as hexadecimal`)}return e}function od(r){let e="";for(let t=0;t<r.byteLength;t++)e+=R1[r[t]];return e}const Cw=async(r=new Uint8Array,e)=>{if(r instanceof Uint8Array)return nd.mutate(r);if(!r)return nd.mutate(new Uint8Array);const t=e.streamCollector(r);return nd.mutate(await t)},Wv=r=>typeof r=="function"?r():r,A1=(r,e,t,n,s)=>({name:e,namespace:r,traits:t,input:n,output:s}),E2=r=>(e,t)=>async n=>{var x,b,E,T;const{response:s}=await e(n),{operationSchema:i}=dd(t),[,c,d,p,m,g]=i??[];try{const S=await r.protocol.deserializeResponse(A1(c,d,p,m,g),{...r,...t},s);return{response:s,output:S}}catch(S){if(Object.defineProperty(S,"$response",{value:s,enumerable:!1,writable:!1,configurable:!1}),!("$metadata"in S)){const N="Deserialization error: to see the raw response, inspect the hidden field {error}.$response on this object.";try{S.message+=`
  `+N}catch{!t.logger||((b=(x=t.logger)==null?void 0:x.constructor)==null?void 0:b.name)==="NoOpLogger"?console.warn(N):(T=(E=t.logger)==null?void 0:E.warn)==null||T.call(E,N)}typeof S.$responseBodyText<"u"&&S.$response&&(S.$response.body=S.$responseBodyText);try{if(lh.isInstance(s)){const{headers:R={}}=s,A=Object.entries(R);S.$metadata={httpStatusCode:s.statusCode,requestId:mx(/^x-[\w-]+-request-?id$/,A),extendedRequestId:mx(/^x-[\w-]+-id-2$/,A),cfId:mx(/^x-[\w-]+-cf-id$/,A)}}}catch{}}throw S}},mx=(r,e)=>(e.find(([t])=>t.match(r))||[void 0,void 0])[1],S2=r=>(e,t)=>async n=>{var b;const{operationSchema:s}=dd(t),[,i,c,d,p,m]=s??[],g=(b=t.endpointV2)!=null&&b.url&&r.urlParser?async()=>r.urlParser(t.endpointV2.url):r.endpoint,x=await r.protocol.serializeRequest(A1(i,c,d,p,m),n.input,{...r,...t,endpoint:g});return e({...n,request:x})},C2={name:"deserializerMiddleware",step:"deserialize",tags:["DESERIALIZER"],override:!0},k2={name:"serializerMiddleware",step:"serialize",tags:["SERIALIZER"],override:!0};function I1(r){return{applyToStack:e=>{e.add(S2(r),k2),e.add(E2(r),C2),r.protocol.setSerdeContext(r)}}}function am(r){if(typeof r=="object")return r;r=r|0;const e={};let t=0;for(const n of["httpLabel","idempotent","idempotencyToken","sensitive","httpPayload","httpResponseCode","httpQueryParams"])(r>>t++&1)===1&&(e[n]=1);return e}const yS={it:Symbol.for("@smithy/nor-struct-it")},Lc=class Lc{constructor(e,t){H(this,"ref");H(this,"memberName");H(this,"symbol",Lc.symbol);H(this,"name");H(this,"schema");H(this,"_isMemberSchema");H(this,"traits");H(this,"memberTraits");H(this,"normalizedTraits");this.ref=e,this.memberName=t;const n=[];let s=e,i=e;for(this._isMemberSchema=!1;gx(s);)n.push(s[1]),s=s[0],i=Wv(s),this._isMemberSchema=!0;if(n.length>0){this.memberTraits={};for(let c=n.length-1;c>=0;--c){const d=n[c];Object.assign(this.memberTraits,am(d))}}else this.memberTraits=0;if(i instanceof Lc){const c=this.memberTraits;Object.assign(this,i),this.memberTraits=Object.assign({},c,i.getMemberTraits(),this.getMemberTraits()),this.normalizedTraits=void 0,this.memberName=t??i.memberName;return}if(this.schema=Wv(i),N2(this.schema)?(this.name=`${this.schema[1]}#${this.schema[2]}`,this.traits=this.schema[3]):(this.name=this.memberName??String(i),this.traits=0),this._isMemberSchema&&!t)throw new Error(`@smithy/core/schema - NormalizedSchema member init ${this.getName(!0)} missing member name.`)}static[Symbol.hasInstance](e){const t=this.prototype.isPrototypeOf(e);return!t&&typeof e=="object"&&e!==null?e.symbol===this.symbol:t}static of(e){const t=Wv(e);if(t instanceof Lc)return t;if(gx(t)){const[n,s]=t;if(n instanceof Lc)return Object.assign(n.getMergedTraits(),am(s)),n;throw new Error(`@smithy/core/schema - may not init unwrapped member schema=${JSON.stringify(e,null,2)}.`)}return new Lc(t)}getSchema(){const e=this.schema;return Array.isArray(e)&&e[0]===0?e[4]:e}getName(e=!1){const{name:t}=this;return!e&&t&&t.includes("#")?t.split("#")[1]:t||void 0}getMemberName(){return this.memberName}isMemberSchema(){return this._isMemberSchema}isListSchema(){const e=this.getSchema();return typeof e=="number"?e>=64&&e<128:e[0]===1}isMapSchema(){const e=this.getSchema();return typeof e=="number"?e>=128&&e<=255:e[0]===2}isStructSchema(){const e=this.getSchema();if(typeof e!="object")return!1;const t=e[0];return t===3||t===-3||t===4}isUnionSchema(){const e=this.getSchema();return typeof e!="object"?!1:e[0]===4}isBlobSchema(){const e=this.getSchema();return e===21||e===42}isTimestampSchema(){const e=this.getSchema();return typeof e=="number"&&e>=4&&e<=7}isUnitSchema(){return this.getSchema()==="unit"}isDocumentSchema(){return this.getSchema()===15}isStringSchema(){return this.getSchema()===0}isBooleanSchema(){return this.getSchema()===2}isNumericSchema(){return this.getSchema()===1}isBigIntegerSchema(){return this.getSchema()===17}isBigDecimalSchema(){return this.getSchema()===19}isStreaming(){const{streaming:e}=this.getMergedTraits();return!!e||this.getSchema()===42}isIdempotencyToken(){return!!this.getMergedTraits().idempotencyToken}getMergedTraits(){return this.normalizedTraits??(this.normalizedTraits={...this.getOwnTraits(),...this.getMemberTraits()})}getMemberTraits(){return am(this.memberTraits)}getOwnTraits(){return am(this.traits)}getKeySchema(){const[e,t]=[this.isDocumentSchema(),this.isMapSchema()];if(!e&&!t)throw new Error(`@smithy/core/schema - cannot get key for non-map: ${this.getName(!0)}`);const n=this.getSchema(),s=e?15:n[4]??0;return Up([s,0],"key")}getValueSchema(){const e=this.getSchema(),[t,n,s]=[this.isDocumentSchema(),this.isMapSchema(),this.isListSchema()],i=typeof e=="number"?63&e:e&&typeof e=="object"&&(n||s)?e[3+e[0]]:t?15:void 0;if(i!=null)return Up([i,0],n?"value":"member");throw new Error(`@smithy/core/schema - ${this.getName(!0)} has no value member.`)}getMemberSchema(e){const t=this.getSchema();if(this.isStructSchema()&&t[4].includes(e)){const n=t[4].indexOf(e),s=t[5][n];return Up(gx(s)?s:[s,0],e)}if(this.isDocumentSchema())return Up([15,0],e);throw new Error(`@smithy/core/schema - ${this.getName(!0)} has no no member=${e}.`)}getMemberSchemas(){const e={};try{for(const[t,n]of this.structIterator())e[t]=n}catch{}return e}getEventStreamMember(){if(this.isStructSchema()){for(const[e,t]of this.structIterator())if(t.isStreaming()&&t.isStructSchema())return e}return""}*structIterator(){if(this.isUnitSchema())return;if(!this.isStructSchema())throw new Error("@smithy/core/schema - cannot iterate non-struct schema.");const e=this.getSchema(),t=e[4].length;let n=e[yS.it];if(n&&t===n.length){yield*n;return}n=Array(t);for(let s=0;s<t;++s){const i=e[4][s],c=Up([e[5][s],0],i);yield n[s]=[i,c]}e[yS.it]=n}};H(Lc,"symbol",Symbol.for("@smithy/nor"));let ko=Lc;function Up(r,e){if(r instanceof ko)return Object.assign(r,{memberName:e,_isMemberSchema:!0});const t=ko;return new t(r,e)}const gx=r=>Array.isArray(r)&&r.length===2,N2=r=>Array.isArray(r)&&r.length>=5,Da=class Da{constructor(e,t=new Map,n=new Map){H(this,"namespace");H(this,"schemas");H(this,"exceptions");this.namespace=e,this.schemas=t,this.exceptions=n}static for(e){return Da.registries.has(e)||Da.registries.set(e,new Da(e)),Da.registries.get(e)}register(e,t){const n=this.normalizeShapeId(e);Da.for(n.split("#")[0]).schemas.set(n,t)}getSchema(e){const t=this.normalizeShapeId(e);if(!this.schemas.has(t))throw new Error(`@smithy/core/schema - schema not found for ${t}`);return this.schemas.get(t)}registerError(e,t){const n=e,s=Da.for(n[1]);s.schemas.set(n[1]+"#"+n[2],n),s.exceptions.set(n,t)}getErrorCtor(e){const t=e;return Da.for(t[1]).exceptions.get(t)}getBaseException(){for(const e of this.exceptions.keys())if(Array.isArray(e)){const[,t,n]=e,s=t+"#"+n;if(s.startsWith("smithy.ts.sdk.synthetic.")&&s.endsWith("ServiceException"))return e}}find(e){return[...this.schemas.values()].find(e)}clear(){this.schemas.clear(),this.exceptions.clear()}normalizeShapeId(e){return e.includes("#")?e:this.namespace+"#"+e}};H(Da,"registries",new Map);let ut=Da;const kw=r=>{if(r!=null){if(typeof r=="string"){const e=parseFloat(r);if(!Number.isNaN(e))return String(e)!==String(r)&&D2.warn(O2(`Expected number but observed string: ${r}`)),e}if(typeof r=="number")return r;throw new TypeError(`Expected number, got ${typeof r}: ${r}`)}},T2=Math.ceil(2**127*(2-2**-23)),xS=r=>{const e=kw(r);if(e!==void 0&&!Number.isNaN(e)&&e!==1/0&&e!==-1/0&&Math.abs(e)>T2)throw new TypeError(`Expected 32-bit float, got ${r}`);return e},R2=r=>{if(r!=null){if(Number.isInteger(r)&&!Number.isNaN(r))return r;throw new TypeError(`Expected integer, got ${typeof r}: ${r}`)}},wS=r=>P1(r,16),bS=r=>P1(r,8),P1=(r,e)=>{const t=R2(r);if(t!==void 0&&A2(t,e)!==t)throw new TypeError(`Expected ${e}-bit integer, got ${r}`);return t},A2=(r,e)=>{switch(e){case 32:return Int32Array.of(r)[0];case 16:return Int16Array.of(r)[0];case 8:return Int8Array.of(r)[0]}},I2=r=>kw(typeof r=="string"?Hy(r):r),P2=r=>xS(typeof r=="string"?Hy(r):r),F2=/(-?(?:0|[1-9]\d*)(?:\.\d+)?(?:[eE][+-]?\d+)?)|(-?Infinity)|(NaN)/g,Hy=r=>{const e=r.match(F2);if(e===null||e[0].length!==r.length)throw new TypeError("Expected real number, got implicit NaN");return parseFloat(r)},iy=r=>wS(typeof r=="string"?Hy(r):r),j2=r=>bS(typeof r=="string"?Hy(r):r),O2=r=>String(new TypeError(r).stack||r).split(`
`).slice(0,5).filter(e=>!e.includes("stackTraceWarning")).join(`
`),D2={warn:console.warn},L2=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],Ab=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function M2(r){const e=r.getUTCFullYear(),t=r.getUTCMonth(),n=r.getUTCDay(),s=r.getUTCDate(),i=r.getUTCHours(),c=r.getUTCMinutes(),d=r.getUTCSeconds(),p=s<10?`0${s}`:`${s}`,m=i<10?`0${i}`:`${i}`,g=c<10?`0${c}`:`${c}`,x=d<10?`0${d}`:`${d}`;return`${L2[n]}, ${p} ${Ab[t]} ${e} ${m}:${g}:${x} GMT`}const $2=new RegExp(/^(\d{4})-(\d{2})-(\d{2})[tT](\d{2}):(\d{2}):(\d{2})(?:\.(\d+))?(([-+]\d{2}\:\d{2})|[zZ])$/),U2=r=>{if(r==null)return;if(typeof r!="string")throw new TypeError("RFC-3339 date-times must be expressed as strings");const e=$2.exec(r);if(!e)throw new TypeError("Invalid RFC-3339 date-time value");const[t,n,s,i,c,d,p,m,g]=e,x=iy(Rm(n)),b=zc(s,"month",1,12),E=zc(i,"day",1,31),T=Vv(x,b,E,{hours:c,minutes:d,seconds:p,fractionalMilliseconds:m});return g.toUpperCase()!="Z"&&T.setTime(T.getTime()-Z2(g)),T},z2=new RegExp(/^(?:Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d{2}) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d{1,2}):(\d{2}):(\d{2})(?:\.(\d+))? GMT$/),H2=new RegExp(/^(?:Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d{2})-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d{2}) (\d{1,2}):(\d{2}):(\d{2})(?:\.(\d+))? GMT$/),B2=new RegExp(/^(?:Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( [1-9]|\d{2}) (\d{1,2}):(\d{2}):(\d{2})(?:\.(\d+))? (\d{4})$/),G2=r=>{if(r==null)return;if(typeof r!="string")throw new TypeError("RFC-7231 date-times must be expressed as strings");let e=z2.exec(r);if(e){const[t,n,s,i,c,d,p,m]=e;return Vv(iy(Rm(i)),vx(s),zc(n,"day",1,31),{hours:c,minutes:d,seconds:p,fractionalMilliseconds:m})}if(e=H2.exec(r),e){const[t,n,s,i,c,d,p,m]=e;return K2(Vv(V2(i),vx(s),zc(n,"day",1,31),{hours:c,minutes:d,seconds:p,fractionalMilliseconds:m}))}if(e=B2.exec(r),e){const[t,n,s,i,c,d,p,m]=e;return Vv(iy(Rm(m)),vx(n),zc(s.trimLeft(),"day",1,31),{hours:i,minutes:c,seconds:d,fractionalMilliseconds:p})}throw new TypeError("Invalid RFC-7231 date-time value")},W2=r=>{if(r==null)return;let e;if(typeof r=="number")e=r;else if(typeof r=="string")e=I2(r);else if(typeof r=="object"&&r.tag===1)e=r.value;else throw new TypeError("Epoch timestamps must be expressed as floating point numbers or their string representation");if(Number.isNaN(e)||e===1/0||e===-1/0)throw new TypeError("Epoch timestamps must be valid, non-Infinite, non-NaN numerics");return new Date(Math.round(e*1e3))},Vv=(r,e,t,n)=>{const s=e-1;return J2(r,s,t),new Date(Date.UTC(r,s,t,zc(n.hours,"hour",0,23),zc(n.minutes,"minute",0,59),zc(n.seconds,"seconds",0,60),Q2(n.fractionalMilliseconds)))},V2=r=>{const e=new Date().getUTCFullYear(),t=Math.floor(e/100)*100+iy(Rm(r));return t<e?t+100:t},q2=50*365*24*60*60*1e3,K2=r=>r.getTime()-new Date().getTime()>q2?new Date(Date.UTC(r.getUTCFullYear()-100,r.getUTCMonth(),r.getUTCDate(),r.getUTCHours(),r.getUTCMinutes(),r.getUTCSeconds(),r.getUTCMilliseconds())):r,vx=r=>{const e=Ab.indexOf(r);if(e<0)throw new TypeError(`Invalid month: ${r}`);return e+1},Y2=[31,28,31,30,31,30,31,31,30,31,30,31],J2=(r,e,t)=>{let n=Y2[e];if(e===1&&X2(r)&&(n=29),t>n)throw new TypeError(`Invalid day for ${Ab[e]} in ${r}: ${t}`)},X2=r=>r%4===0&&(r%100!==0||r%400===0),zc=(r,e,t,n)=>{const s=j2(Rm(r));if(s<t||s>n)throw new TypeError(`${e} must be between ${t} and ${n}, inclusive`);return s},Q2=r=>r==null?0:P2("0."+r)*1e3,Z2=r=>{const e=r[0];let t=1;if(e=="+")t=1;else if(e=="-")t=-1;else throw new TypeError(`Offset direction, ${e}, must be "+" or "-"`);const n=Number(r.substring(1,3)),s=Number(r.substring(4,6));return t*(n*60+s)*60*1e3},Rm=r=>{let e=0;for(;e<r.length-1&&r.charAt(e)==="0";)e++;return e===0?r:r.slice(e)},_S=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),As=Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0")),F1=()=>{if(_S)return _S();const r=new Uint8Array(16);return crypto.getRandomValues(r),r[6]=r[6]&15|64,r[8]=r[8]&63|128,As[r[0]]+As[r[1]]+As[r[2]]+As[r[3]]+"-"+As[r[4]]+As[r[5]]+"-"+As[r[6]]+As[r[7]]+"-"+As[r[8]]+As[r[9]]+"-"+As[r[10]]+As[r[11]]+As[r[12]]+As[r[13]]+As[r[14]]+As[r[15]]},$c=function(e){return Object.assign(new String(e),{deserializeJSON(){return JSON.parse(String(e))},toString(){return String(e)},toJSON(){return String(e)}})};$c.from=r=>r&&typeof r=="object"&&(r instanceof $c||"deserializeJSON"in r)?r:typeof r=="string"||Object.getPrototypeOf(r)===String.prototype?$c(String(r)):$c(JSON.stringify(r));$c.fromObject=$c.from;const ES=/^-?\d*(\.\d+)?$/;class Ua{constructor(e,t){H(this,"string");H(this,"type");if(this.string=e,this.type=t,!ES.test(e))throw new Error('@smithy/core/serde - NumericValue must only contain [0-9], at most one decimal point ".", and an optional negation prefix "-".')}toString(){return this.string}static[Symbol.hasInstance](e){if(!e||typeof e!="object")return!1;const t=e;return Ua.prototype.isPrototypeOf(e)||t.type==="bigDecimal"&&ES.test(t.string)}}const eD="modulepreload",tD=function(r){return"/FileServer_Staging/dist-outlook-addin/"+r},SS={},Nw=function(e,t,n){let s=Promise.resolve();if(t&&t.length>0){let c=function(m){return Promise.all(m.map(g=>Promise.resolve(g).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),p=(d==null?void 0:d.nonce)||(d==null?void 0:d.getAttribute("nonce"));s=c(t.map(m=>{if(m=tD(m),m in SS)return;SS[m]=!0;const g=m.endsWith(".css"),x=g?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${m}"]${x}`))return;const b=document.createElement("link");if(b.rel=g?"stylesheet":eD,g||(b.as="script"),b.crossOrigin="",b.href=m,p&&b.setAttribute("nonce",p),document.head.appendChild(b),g)return new Promise((E,T)=>{b.addEventListener("load",E),b.addEventListener("error",()=>T(new Error(`Unable to preload CSS for ${m}`)))})}))}function i(c){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=c,window.dispatchEvent(d),!d.defaultPrevented)throw c}return s.then(c=>{for(const d of c||[])d.status==="rejected"&&i(d.reason);return e().catch(i)})};class rD{constructor(){H(this,"serdeContext")}setSerdeContext(e){this.serdeContext=e}}class nD extends rD{constructor(t){super();H(this,"options");this.options=t}getRequestType(){return Zo}getResponseType(){return lh}setSerdeContext(t){this.serdeContext=t,this.serializer.setSerdeContext(t),this.deserializer.setSerdeContext(t),this.getPayloadCodec()&&this.getPayloadCodec().setSerdeContext(t)}updateServiceEndpoint(t,n){if("url"in n){t.protocol=n.url.protocol,t.hostname=n.url.hostname,t.port=n.url.port?Number(n.url.port):void 0,t.path=n.url.pathname,t.fragment=n.url.hash||void 0,t.username=n.url.username||void 0,t.password=n.url.password||void 0,t.query||(t.query={});for(const[s,i]of n.url.searchParams.entries())t.query[s]=i;return t}else return t.protocol=n.protocol,t.hostname=n.hostname,t.port=n.port?Number(n.port):void 0,t.path=n.path,t.query={...n.query},t}setHostPrefix(t,n,s){var d,p;if((d=this.serdeContext)!=null&&d.disableHostPrefix)return;const i=ko.of(n.input),c=am(n.traits??{});if(c.endpoint){let m=(p=c.endpoint)==null?void 0:p[0];if(typeof m=="string"){const g=[...i.structIterator()].filter(([,x])=>x.getMergedTraits().hostLabel);for(const[x]of g){const b=s[x];if(typeof b!="string")throw new Error(`@smithy/core/schema - ${x} in input must be a string as hostLabel.`);m=m.replace(`{${x}}`,b)}t.hostname=m+t.hostname}}}deserializeMetadata(t){return{httpStatusCode:t.statusCode,requestId:t.headers["x-amzn-requestid"]??t.headers["x-amzn-request-id"]??t.headers["x-amz-request-id"],extendedRequestId:t.headers["x-amz-id-2"],cfId:t.headers["x-amz-cf-id"]}}async serializeEventStream({eventStream:t,requestSchema:n,initialRequest:s}){return(await this.loadEventStreamCapability()).serializeEventStream({eventStream:t,requestSchema:n,initialRequest:s})}async deserializeEventStream({response:t,responseSchema:n,initialResponseContainer:s}){return(await this.loadEventStreamCapability()).deserializeEventStream({response:t,responseSchema:n,initialResponseContainer:s})}async loadEventStreamCapability(){const{EventStreamSerde:t}=await Nw(async()=>{const{EventStreamSerde:n}=await import("./index.DS5eee3c.js");return{EventStreamSerde:n}},__vite__mapDeps([0,1]));return new t({marshaller:this.getEventStreamMarshaller(),serializer:this.serializer,deserializer:this.deserializer,serdeContext:this.serdeContext,defaultContentType:this.getDefaultContentType()})}getDefaultContentType(){throw new Error(`@smithy/core/protocols - ${this.constructor.name} getDefaultContentType() implementation missing.`)}async deserializeHttpMessage(t,n,s,i,c){return[]}getEventStreamMarshaller(){const t=this.serdeContext;if(!t.eventStreamMarshaller)throw new Error("@smithy/core - HttpProtocol: eventStreamMarshaller missing in serdeContext.");return t.eventStreamMarshaller}}class sD extends nD{async serializeRequest(e,t,n){const s=this.serializer,i={},c={},d=await n.endpoint(),p=ko.of(e==null?void 0:e.input),m=p.getSchema();let g;const x=new Zo({protocol:"",hostname:"",port:void 0,path:"/",fragment:void 0,query:i,headers:c,body:void 0});d&&(this.updateServiceEndpoint(x,d),this.setHostPrefix(x,e,t));const b={...t};if(t){const E=p.getEventStreamMember();if(E){if(b[E]){const T={};for(const[S,N]of p.structIterator())S!==E&&b[S]&&(s.write(N,b[S]),T[S]=s.flush());g=await this.serializeEventStream({eventStream:b[E],requestSchema:p,initialRequest:T})}}else s.write(m,b),g=s.flush()}return x.headers=c,x.query=i,x.body=g,x.method="POST",x}async deserializeResponse(e,t,n){const s=this.deserializer,i=ko.of(e.output),c={};if(n.statusCode>=300){const p=await Cw(n.body,t);throw p.byteLength>0&&Object.assign(c,await s.read(15,p)),await this.handleError(e,t,n,c,this.deserializeMetadata(n)),new Error("@smithy/core/protocols - RPC Protocol error handler failed to throw.")}for(const p in n.headers){const m=n.headers[p];delete n.headers[p],n.headers[p.toLowerCase()]=m}const d=i.getEventStreamMember();if(d)c[d]=await this.deserializeEventStream({response:n,responseSchema:i,initialResponseContainer:c});else{const p=await Cw(n.body,t);p.byteLength>0&&Object.assign(c,await s.read(i,p))}return c.$metadata=this.deserializeMetadata(n),c}}function j1(r,e){if(e.timestampFormat.useTrait&&r.isTimestampSchema()&&(r.getSchema()===5||r.getSchema()===6||r.getSchema()===7))return r.getSchema();const{httpLabel:t,httpPrefixHeaders:n,httpHeader:s,httpQuery:i}=r.getMergedTraits();return(e.httpBindings?typeof n=="string"||s?6:i||t?5:void 0:void 0)??e.timestampFormat.default}function oD(r,e,t){r.__smithy_context?r.__smithy_context.features||(r.__smithy_context.features={}):r.__smithy_context={features:{}},r.__smithy_context.features[e]=t}class O1{constructor(e){H(this,"authSchemes",new Map);for(const[t,n]of Object.entries(e))n!==void 0&&this.authSchemes.set(t,n)}getIdentityProvider(e){return this.authSchemes.get(e)}}class D1{async sign(e,t,n){return e}}const iD=r=>function(t){return L1(t)&&t.expiration.getTime()-Date.now()<r},aD=3e5,lD=iD(aD),L1=r=>r.expiration!==void 0,cD=(r,e,t)=>{if(r===void 0)return;const n=typeof r!="function"?async()=>Promise.resolve(r):r;let s,i,c,d=!1;const p=async m=>{i||(i=n(m));try{s=await i,c=!0,d=!1}finally{i=void 0}return s};return e===void 0?async m=>((!c||m!=null&&m.forceRefresh)&&(s=await p(m)),s):async m=>((!c||m!=null&&m.forceRefresh)&&(s=await p(m)),d?s:t(s)?(e(s)&&await p(m),s):(d=!0,s))},uD=void 0;function dD(r){return r===void 0?!0:typeof r=="string"&&r.length<=50}function M1(r){const e=wm(r.userAgentAppId??uD),{customUserAgent:t}=r;return Object.assign(r,{customUserAgent:typeof t=="string"?[[t]]:t,userAgentAppId:async()=>{var s,i;const n=await e();if(!dD(n)){const c=((i=(s=r.logger)==null?void 0:s.constructor)==null?void 0:i.name)==="NoOpLogger"||!r.logger?console:r.logger;typeof n!="string"?c==null||c.warn("userAgentAppId must be a string or undefined."):n.length>50&&(c==null||c.warn("The provided userAgentAppId exceeds the maximum length of 50 characters."))}return n}})}class $1{constructor({size:e,params:t}){H(this,"capacity");H(this,"data",new Map);H(this,"parameters",[]);this.capacity=e??50,t&&(this.parameters=t)}get(e,t){const n=this.hash(e);if(n===!1)return t();if(!this.data.has(n)){if(this.data.size>this.capacity+10){const s=this.data.keys();let i=0;for(;;){const{value:c,done:d}=s.next();if(this.data.delete(c),d||++i>10)break}}this.data.set(n,t())}return this.data.get(n)}size(){return this.data.size}hash(e){let t="";const{parameters:n}=this;if(n.length===0)return!1;for(const s of n){const i=String(e[s]??"");if(i.includes("|;"))return!1;t+=i+"|;"}return t}}const fD=new RegExp("^(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}$"),Ib=r=>fD.test(r)||r.startsWith("[")&&r.endsWith("]"),hD=new RegExp("^(?!.*-$)(?!-)[a-zA-Z0-9-]{1,63}$"),Jm=(r,e=!1)=>{if(!e)return hD.test(r);const t=r.split(".");for(const n of t)if(!Jm(n))return!1;return!0},ch={},Am="endpoints";function Vc(r){return typeof r!="object"||r==null?r:"ref"in r?`$${Vc(r.ref)}`:"fn"in r?`${r.fn}(${(r.argv||[]).map(Vc).join(", ")})`:JSON.stringify(r,null,2)}class ei extends Error{constructor(e){super(e),this.name="EndpointError"}}const pD=(r,e)=>r===e,mD=r=>{const e=r.split("."),t=[];for(const n of e){const s=n.indexOf("[");if(s!==-1){if(n.indexOf("]")!==n.length-1)throw new ei(`Path: '${r}' does not end with ']'`);const i=n.slice(s+1,-1);if(Number.isNaN(parseInt(i)))throw new ei(`Invalid array index: '${i}' in path: '${r}'`);s!==0&&t.push(n.slice(0,s)),t.push(i)}else t.push(n)}return t},U1=(r,e)=>mD(e).reduce((t,n)=>{if(typeof t!="object")throw new ei(`Index '${n}' in '${e}' not found in '${JSON.stringify(r)}'`);return Array.isArray(t)?t[parseInt(n)]:t[n]},r),gD=r=>r!=null,vD=r=>!r,yx={[km.HTTP]:80,[km.HTTPS]:443},yD=r=>{const e=(()=>{try{if(r instanceof URL)return r;if(typeof r=="object"&&"hostname"in r){const{hostname:b,port:E,protocol:T="",path:S="",query:N={}}=r,R=new URL(`${T}//${b}${E?`:${E}`:""}${S}`);return R.search=Object.entries(N).map(([A,j])=>`${A}=${j}`).join("&"),R}return new URL(r)}catch{return null}})();if(!e)return console.error(`Unable to parse ${JSON.stringify(r)} as a whatwg URL.`),null;const t=e.href,{host:n,hostname:s,pathname:i,protocol:c,search:d}=e;if(d)return null;const p=c.slice(0,-1);if(!Object.values(km).includes(p))return null;const m=Ib(s),g=t.includes(`${n}:${yx[p]}`)||typeof r=="string"&&r.includes(`${n}:${yx[p]}`),x=`${n}${g?`:${yx[p]}`:""}`;return{scheme:p,authority:x,path:i,normalizedPath:i.endsWith("/")?i:`${i}/`,isIp:m}},xD=(r,e)=>r===e,wD=(r,e,t,n)=>e>=t||r.length<t?null:n?r.substring(r.length-t,r.length-e):r.substring(e,t),bD=r=>encodeURIComponent(r).replace(/[!*'()]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),_D={booleanEquals:pD,getAttr:U1,isSet:gD,isValidHostLabel:Jm,not:vD,parseURL:yD,stringEquals:xD,substring:wD,uriEncode:bD},z1=(r,e)=>{const t=[],n={...e.endpointParams,...e.referenceRecord};let s=0;for(;s<r.length;){const i=r.indexOf("{",s);if(i===-1){t.push(r.slice(s));break}t.push(r.slice(s,i));const c=r.indexOf("}",i);if(c===-1){t.push(r.slice(i));break}r[i+1]==="{"&&r[c+1]==="}"&&(t.push(r.slice(i+1,c)),s=c+2);const d=r.substring(i+1,c);if(d.includes("#")){const[p,m]=d.split("#");t.push(U1(n[p],m))}else t.push(n[d]);s=c+1}return t.join("")},ED=({ref:r},e)=>({...e.endpointParams,...e.referenceRecord})[r],By=(r,e,t)=>{if(typeof r=="string")return z1(r,t);if(r.fn)return B1.callFunction(r,t);if(r.ref)return ED(r,t);throw new ei(`'${e}': ${String(r)} is not a string, function or reference.`)},H1=({fn:r,argv:e},t)=>{const n=e.map(i=>["boolean","number"].includes(typeof i)?i:B1.evaluateExpression(i,"arg",t)),s=r.split(".");return s[0]in ch&&s[1]!=null?ch[s[0]][s[1]](...n):_D[r](...n)},B1={evaluateExpression:By,callFunction:H1},SD=({assign:r,...e},t)=>{var s,i;if(r&&r in t.referenceRecord)throw new ei(`'${r}' is already defined in Reference Record.`);const n=H1(e,t);return(i=(s=t.logger)==null?void 0:s.debug)==null||i.call(s,`${Am} evaluateCondition: ${Vc(e)} = ${Vc(n)}`),{result:n===""?!0:!!n,...r!=null&&{toAssign:{name:r,value:n}}}},Pb=(r=[],e)=>{var n,s;const t={};for(const i of r){const{result:c,toAssign:d}=SD(i,{...e,referenceRecord:{...e.referenceRecord,...t}});if(!c)return{result:c};d&&(t[d.name]=d.value,(s=(n=e.logger)==null?void 0:n.debug)==null||s.call(n,`${Am} assign: ${d.name} := ${Vc(d.value)}`))}return{result:!0,referenceRecord:t}},CD=(r,e)=>Object.entries(r).reduce((t,[n,s])=>({...t,[n]:s.map(i=>{const c=By(i,"Header value entry",e);if(typeof c!="string")throw new ei(`Header '${n}' value '${c}' is not a string`);return c})}),{}),G1=(r,e)=>Object.entries(r).reduce((t,[n,s])=>({...t,[n]:V1.getEndpointProperty(s,e)}),{}),W1=(r,e)=>{if(Array.isArray(r))return r.map(t=>W1(t,e));switch(typeof r){case"string":return z1(r,e);case"object":if(r===null)throw new ei(`Unexpected endpoint property: ${r}`);return V1.getEndpointProperties(r,e);case"boolean":return r;default:throw new ei(`Unexpected endpoint property type: ${typeof r}`)}},V1={getEndpointProperty:W1,getEndpointProperties:G1},kD=(r,e)=>{const t=By(r,"Endpoint URL",e);if(typeof t=="string")try{return new URL(t)}catch(n){throw console.error(`Failed to construct URL with ${t}`,n),n}throw new ei(`Endpoint URL must be a string, got ${typeof t}`)},ND=(r,e)=>{var g,x;const{conditions:t,endpoint:n}=r,{result:s,referenceRecord:i}=Pb(t,e);if(!s)return;const c={...e,referenceRecord:{...e.referenceRecord,...i}},{url:d,properties:p,headers:m}=n;return(x=(g=e.logger)==null?void 0:g.debug)==null||x.call(g,`${Am} Resolving endpoint from template: ${Vc(n)}`),{...m!=null&&{headers:CD(m,c)},...p!=null&&{properties:G1(p,c)},url:kD(d,c)}},TD=(r,e)=>{const{conditions:t,error:n}=r,{result:s,referenceRecord:i}=Pb(t,e);if(s)throw new ei(By(n,"Error",{...e,referenceRecord:{...e.referenceRecord,...i}}))},q1=(r,e)=>{for(const t of r)if(t.type==="endpoint"){const n=ND(t,e);if(n)return n}else if(t.type==="error")TD(t,e);else if(t.type==="tree"){const n=K1.evaluateTreeRule(t,e);if(n)return n}else throw new ei(`Unknown endpoint rule: ${t}`);throw new ei("Rules evaluation failed")},RD=(r,e)=>{const{conditions:t,rules:n}=r,{result:s,referenceRecord:i}=Pb(t,e);if(s)return K1.evaluateRules(n,{...e,referenceRecord:{...e.referenceRecord,...i}})},K1={evaluateRules:q1,evaluateTreeRule:RD},Y1=(r,e)=>{var m,g,x,b;const{endpointParams:t,logger:n}=e,{parameters:s,rules:i}=r;(g=(m=e.logger)==null?void 0:m.debug)==null||g.call(m,`${Am} Initial EndpointParams: ${Vc(t)}`);const c=Object.entries(s).filter(([,E])=>E.default!=null).map(([E,T])=>[E,T.default]);if(c.length>0)for(const[E,T]of c)t[E]=t[E]??T;const d=Object.entries(s).filter(([,E])=>E.required).map(([E])=>E);for(const E of d)if(t[E]==null)throw new ei(`Missing required parameter: '${E}'`);const p=q1(i,{endpointParams:t,logger:n,referenceRecord:{}});return(b=(x=e.logger)==null?void 0:x.debug)==null||b.call(x,`${Am} Resolved endpoint: ${Vc(p)}`),p},J1=(r,e=!1)=>{if(e){for(const t of r.split("."))if(!J1(t))return!1;return!0}return!(!Jm(r)||r.length<3||r.length>63||r!==r.toLowerCase()||Ib(r))},CS=":",AD="/",ID=r=>{const e=r.split(CS);if(e.length<6)return null;const[t,n,s,i,c,...d]=e;if(t!=="arn"||n===""||s===""||d.join(CS)==="")return null;const p=d.map(m=>m.split(AD)).flat();return{partition:n,service:s,region:i,accountId:c,resourceId:p}},PD=[{id:"aws",outputs:{dnsSuffix:"amazonaws.com",dualStackDnsSuffix:"api.aws",implicitGlobalRegion:"us-east-1",name:"aws",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^(us|eu|ap|sa|ca|me|af|il|mx)\\-\\w+\\-\\d+$",regions:{"af-south-1":{description:"Africa (Cape Town)"},"ap-east-1":{description:"Asia Pacific (Hong Kong)"},"ap-east-2":{description:"Asia Pacific (Taipei)"},"ap-northeast-1":{description:"Asia Pacific (Tokyo)"},"ap-northeast-2":{description:"Asia Pacific (Seoul)"},"ap-northeast-3":{description:"Asia Pacific (Osaka)"},"ap-south-1":{description:"Asia Pacific (Mumbai)"},"ap-south-2":{description:"Asia Pacific (Hyderabad)"},"ap-southeast-1":{description:"Asia Pacific (Singapore)"},"ap-southeast-2":{description:"Asia Pacific (Sydney)"},"ap-southeast-3":{description:"Asia Pacific (Jakarta)"},"ap-southeast-4":{description:"Asia Pacific (Melbourne)"},"ap-southeast-5":{description:"Asia Pacific (Malaysia)"},"ap-southeast-6":{description:"Asia Pacific (New Zealand)"},"ap-southeast-7":{description:"Asia Pacific (Thailand)"},"aws-global":{description:"aws global region"},"ca-central-1":{description:"Canada (Central)"},"ca-west-1":{description:"Canada West (Calgary)"},"eu-central-1":{description:"Europe (Frankfurt)"},"eu-central-2":{description:"Europe (Zurich)"},"eu-north-1":{description:"Europe (Stockholm)"},"eu-south-1":{description:"Europe (Milan)"},"eu-south-2":{description:"Europe (Spain)"},"eu-west-1":{description:"Europe (Ireland)"},"eu-west-2":{description:"Europe (London)"},"eu-west-3":{description:"Europe (Paris)"},"il-central-1":{description:"Israel (Tel Aviv)"},"me-central-1":{description:"Middle East (UAE)"},"me-south-1":{description:"Middle East (Bahrain)"},"mx-central-1":{description:"Mexico (Central)"},"sa-east-1":{description:"South America (Sao Paulo)"},"us-east-1":{description:"US East (N. Virginia)"},"us-east-2":{description:"US East (Ohio)"},"us-west-1":{description:"US West (N. California)"},"us-west-2":{description:"US West (Oregon)"}}},{id:"aws-cn",outputs:{dnsSuffix:"amazonaws.com.cn",dualStackDnsSuffix:"api.amazonwebservices.com.cn",implicitGlobalRegion:"cn-northwest-1",name:"aws-cn",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^cn\\-\\w+\\-\\d+$",regions:{"aws-cn-global":{description:"aws-cn global region"},"cn-north-1":{description:"China (Beijing)"},"cn-northwest-1":{description:"China (Ningxia)"}}},{id:"aws-eusc",outputs:{dnsSuffix:"amazonaws.eu",dualStackDnsSuffix:"api.amazonwebservices.eu",implicitGlobalRegion:"eusc-de-east-1",name:"aws-eusc",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^eusc\\-(de)\\-\\w+\\-\\d+$",regions:{"eusc-de-east-1":{description:"AWS European Sovereign Cloud (Germany)"}}},{id:"aws-iso",outputs:{dnsSuffix:"c2s.ic.gov",dualStackDnsSuffix:"api.aws.ic.gov",implicitGlobalRegion:"us-iso-east-1",name:"aws-iso",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-iso\\-\\w+\\-\\d+$",regions:{"aws-iso-global":{description:"aws-iso global region"},"us-iso-east-1":{description:"US ISO East"},"us-iso-west-1":{description:"US ISO WEST"}}},{id:"aws-iso-b",outputs:{dnsSuffix:"sc2s.sgov.gov",dualStackDnsSuffix:"api.aws.scloud",implicitGlobalRegion:"us-isob-east-1",name:"aws-iso-b",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-isob\\-\\w+\\-\\d+$",regions:{"aws-iso-b-global":{description:"aws-iso-b global region"},"us-isob-east-1":{description:"US ISOB East (Ohio)"},"us-isob-west-1":{description:"US ISOB West"}}},{id:"aws-iso-e",outputs:{dnsSuffix:"cloud.adc-e.uk",dualStackDnsSuffix:"api.cloud-aws.adc-e.uk",implicitGlobalRegion:"eu-isoe-west-1",name:"aws-iso-e",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^eu\\-isoe\\-\\w+\\-\\d+$",regions:{"aws-iso-e-global":{description:"aws-iso-e global region"},"eu-isoe-west-1":{description:"EU ISOE West"}}},{id:"aws-iso-f",outputs:{dnsSuffix:"csp.hci.ic.gov",dualStackDnsSuffix:"api.aws.hci.ic.gov",implicitGlobalRegion:"us-isof-south-1",name:"aws-iso-f",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-isof\\-\\w+\\-\\d+$",regions:{"aws-iso-f-global":{description:"aws-iso-f global region"},"us-isof-east-1":{description:"US ISOF EAST"},"us-isof-south-1":{description:"US ISOF SOUTH"}}},{id:"aws-us-gov",outputs:{dnsSuffix:"amazonaws.com",dualStackDnsSuffix:"api.aws",implicitGlobalRegion:"us-gov-west-1",name:"aws-us-gov",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-gov\\-\\w+\\-\\d+$",regions:{"aws-us-gov-global":{description:"aws-us-gov global region"},"us-gov-east-1":{description:"AWS GovCloud (US-East)"},"us-gov-west-1":{description:"AWS GovCloud (US-West)"}}}],FD={partitions:PD};let jD=FD;const OD=r=>{const{partitions:e}=jD;for(const n of e){const{regions:s,outputs:i}=n;for(const[c,d]of Object.entries(s))if(c===r)return{...i,...d}}for(const n of e){const{regionRegex:s,outputs:i}=n;if(new RegExp(s).test(r))return{...i}}const t=e.find(n=>n.id==="aws");if(!t)throw new Error("Provided region was not found in the partition array or regex, and default partition with id 'aws' doesn't exist.");return{...t.outputs}},DD={isVirtualHostableS3Bucket:J1,parseArn:ID,partition:OD};ch.aws=DD;function LD(r){const e={};if(r=r.replace(/^\?/,""),r)for(const t of r.split("&")){let[n,s=null]=t.split("=");n=decodeURIComponent(n),s&&(s=decodeURIComponent(s)),n in e?Array.isArray(e[n])?e[n].push(s):e[n]=[e[n],s]:e[n]=s}return e}const Im=r=>{if(typeof r=="string")return Im(new URL(r));const{hostname:e,pathname:t,port:n,protocol:s,search:i}=r;let c;return i&&(c=LD(i)),{hostname:e,port:n?parseInt(n):void 0,protocol:s,path:t,query:c}};function MD(r,e,t){return r.$source||(r.$source={}),r.$source[e]=t,r}function Ia(r,e,t){r.__aws_sdk_context?r.__aws_sdk_context.features||(r.__aws_sdk_context.features={}):r.__aws_sdk_context={features:{}},r.__aws_sdk_context.features[e]=t}const kS=r=>{var e,t;return lh.isInstance(r)?((e=r.headers)==null?void 0:e.date)??((t=r.headers)==null?void 0:t.Date):void 0},X1=r=>new Date(Date.now()+r),$D=(r,e)=>Math.abs(X1(e).getTime()-r)>=3e5,NS=(r,e)=>{const t=Date.parse(r);return $D(t,e)?t-Date.now():e},_m=(r,e)=>{if(!e)throw new Error(`Property \`${r}\` is not resolved for AWS SDK SigV4Auth`);return e},UD=async r=>{var m,g,x;const e=_m("context",r.context),t=_m("config",r.config),n=(x=(g=(m=e.endpointV2)==null?void 0:m.properties)==null?void 0:g.authSchemes)==null?void 0:x[0],i=await _m("signer",t.signer)(n),c=r==null?void 0:r.signingRegion,d=r==null?void 0:r.signingRegionSet,p=r==null?void 0:r.signingName;return{config:t,signer:i,signingRegion:c,signingRegionSet:d,signingName:p}};class Q1{async sign(e,t,n){var x;if(!Zo.isInstance(e))throw new Error("The request is not an instance of `HttpRequest` and cannot be signed");const s=await UD(n),{config:i,signer:c}=s;let{signingRegion:d,signingName:p}=s;const m=n.context;if(((x=m==null?void 0:m.authSchemes)==null?void 0:x.length)??!1){const[b,E]=m.authSchemes;(b==null?void 0:b.name)==="sigv4a"&&(E==null?void 0:E.name)==="sigv4"&&(d=(E==null?void 0:E.signingRegion)??d,p=(E==null?void 0:E.signingName)??p)}return await c.sign(e,{signingDate:X1(i.systemClockOffset),signingRegion:d,signingService:p})}errorHandler(e){return t=>{const n=t.ServerTime??kS(t.$response);if(n){const s=_m("config",e.config),i=s.systemClockOffset;s.systemClockOffset=NS(n,s.systemClockOffset),s.systemClockOffset!==i&&t.$metadata&&(t.$metadata.clockSkewCorrected=!0)}throw t}}successHandler(e,t){const n=kS(e);if(n){const s=_m("config",t.config);s.systemClockOffset=NS(n,s.systemClockOffset)}}}const zD=(r,e,t)=>{let n,s,i,c=!1;const d=async()=>{s||(s=r());try{n=await s,i=!0,c=!1}finally{s=void 0}return n};return async p=>((!i||p!=null&&p.forceRefresh)&&(n=await d()),n)},HD="X-Amz-Algorithm",BD="X-Amz-Credential",Z1="X-Amz-Date",GD="X-Amz-SignedHeaders",WD="X-Amz-Expires",eN="X-Amz-Signature",tN="X-Amz-Security-Token",rN="authorization",nN=Z1.toLowerCase(),VD="date",qD=[rN,nN,VD],KD=eN.toLowerCase(),Tw="x-amz-content-sha256",YD=tN.toLowerCase(),JD={authorization:!0,"cache-control":!0,connection:!0,expect:!0,from:!0,"keep-alive":!0,"max-forwards":!0,pragma:!0,referer:!0,te:!0,trailer:!0,"transfer-encoding":!0,upgrade:!0,"user-agent":!0,"x-amzn-trace-id":!0},XD=/^proxy-/,QD=/^sec-/,xx="AWS4-HMAC-SHA256",ZD="AWS4-HMAC-SHA256-PAYLOAD",eL="UNSIGNED-PAYLOAD",tL=50,sN="aws4_request",rL=3600*24*7,Ev={},wx=[],bx=(r,e,t)=>`${r}/${e}/${t}/${sN}`,nL=async(r,e,t,n,s)=>{const i=await TS(r,e.secretAccessKey,e.accessKeyId),c=`${t}:${n}:${s}:${od(i)}:${e.sessionToken}`;if(c in Ev)return Ev[c];for(wx.push(c);wx.length>tL;)delete Ev[wx.shift()];let d=`AWS4${e.secretAccessKey}`;for(const p of[t,n,s,sN])d=await TS(r,d,p);return Ev[c]=d},TS=(r,e,t)=>{const n=new r(e);return n.update(Nm(t)),n.digest()},RS=({headers:r},e,t)=>{const n={};for(const s of Object.keys(r).sort()){if(r[s]==null)continue;const i=s.toLowerCase();(i in JD||e!=null&&e.has(i)||XD.test(i)||QD.test(i))&&(!t||t&&!t.has(i))||(n[i]=r[s].trim().replace(/\s+/g," "))}return n},sL=r=>typeof ArrayBuffer=="function"&&r instanceof ArrayBuffer||Object.prototype.toString.call(r)==="[object ArrayBuffer]",_x=async({headers:r,body:e},t)=>{for(const n of Object.keys(r))if(n.toLowerCase()===Tw)return r[n];if(e==null)return"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855";if(typeof e=="string"||ArrayBuffer.isView(e)||sL(e)){const n=new t;return n.update(Nm(e)),od(await n.digest())}return eL};class oL{format(e){const t=[];for(const i of Object.keys(e)){const c=id(i);t.push(Uint8Array.from([c.byteLength]),c,this.formatHeaderValue(e[i]))}const n=new Uint8Array(t.reduce((i,c)=>i+c.byteLength,0));let s=0;for(const i of t)n.set(i,s),s+=i.byteLength;return n}formatHeaderValue(e){switch(e.type){case"boolean":return Uint8Array.from([e.value?0:1]);case"byte":return Uint8Array.from([2,e.value]);case"short":const t=new DataView(new ArrayBuffer(3));return t.setUint8(0,3),t.setInt16(1,e.value,!1),new Uint8Array(t.buffer);case"integer":const n=new DataView(new ArrayBuffer(5));return n.setUint8(0,4),n.setInt32(1,e.value,!1),new Uint8Array(n.buffer);case"long":const s=new Uint8Array(9);return s[0]=5,s.set(e.value.bytes,1),s;case"binary":const i=new DataView(new ArrayBuffer(3+e.value.byteLength));i.setUint8(0,6),i.setUint16(1,e.value.byteLength,!1);const c=new Uint8Array(i.buffer);return c.set(e.value,3),c;case"string":const d=id(e.value),p=new DataView(new ArrayBuffer(3+d.byteLength));p.setUint8(0,7),p.setUint16(1,d.byteLength,!1);const m=new Uint8Array(p.buffer);return m.set(d,3),m;case"timestamp":const g=new Uint8Array(9);return g[0]=8,g.set(Fb.fromNumber(e.value.valueOf()).bytes,1),g;case"uuid":if(!iL.test(e.value))throw new Error(`Invalid UUID received: ${e.value}`);const x=new Uint8Array(17);return x[0]=9,x.set(_2(e.value.replace(/\-/g,"")),1),x}}}var AS;(function(r){r[r.boolTrue=0]="boolTrue",r[r.boolFalse=1]="boolFalse",r[r.byte=2]="byte",r[r.short=3]="short",r[r.integer=4]="integer",r[r.long=5]="long",r[r.byteArray=6]="byteArray",r[r.string=7]="string",r[r.timestamp=8]="timestamp",r[r.uuid=9]="uuid"})(AS||(AS={}));const iL=/^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$/;class Fb{constructor(e){H(this,"bytes");if(this.bytes=e,e.byteLength!==8)throw new Error("Int64 buffers must be exactly 8 bytes")}static fromNumber(e){if(e>9223372036854776e3||e<-9223372036854776e3)throw new Error(`${e} is too large (or, if negative, too small) to represent as an Int64`);const t=new Uint8Array(8);for(let n=7,s=Math.abs(Math.round(e));n>-1&&s>0;n--,s/=256)t[n]=s;return e<0&&IS(t),new Fb(t)}valueOf(){const e=this.bytes.slice(0),t=e[0]&128;return t&&IS(e),parseInt(od(e),16)*(t?-1:1)}toString(){return String(this.valueOf())}}function IS(r){for(let e=0;e<8;e++)r[e]^=255;for(let e=7;e>-1&&(r[e]++,r[e]===0);e--);}const aL=(r,e)=>{r=r.toLowerCase();for(const t of Object.keys(e))if(r===t.toLowerCase())return!0;return!1},lL=(r,e={})=>{var s,i;const{headers:t,query:n={}}=Zo.clone(r);for(const c of Object.keys(t)){const d=c.toLowerCase();(d.slice(0,6)==="x-amz-"&&!((s=e.unhoistableHeaders)!=null&&s.has(d))||(i=e.hoistableHeaders)!=null&&i.has(d))&&(n[c]=t[c],delete t[c])}return{...r,headers:t,query:n}},PS=r=>{r=Zo.clone(r);for(const e of Object.keys(r.headers))qD.indexOf(e.toLowerCase())>-1&&delete r.headers[e];return r},cL=({query:r={}})=>{const e=[],t={};for(const n of Object.keys(r)){if(n.toLowerCase()===KD)continue;const s=sd(n);e.push(s);const i=r[n];typeof i=="string"?t[s]=`${s}=${sd(i)}`:Array.isArray(i)&&(t[s]=i.slice(0).reduce((c,d)=>c.concat([`${s}=${sd(d)}`]),[]).sort().join("&"))}return e.sort().map(n=>t[n]).filter(n=>n).join("&")},uL=r=>dL(r).toISOString().replace(/\.\d{3}Z$/,"Z"),dL=r=>typeof r=="number"?new Date(r*1e3):typeof r=="string"?Number(r)?new Date(Number(r)*1e3):new Date(r):r;class fL{constructor({applyChecksum:e,credentials:t,region:n,service:s,sha256:i,uriEscapePath:c=!0}){H(this,"service");H(this,"regionProvider");H(this,"credentialProvider");H(this,"sha256");H(this,"uriEscapePath");H(this,"applyChecksum");this.service=s,this.sha256=i,this.uriEscapePath=c,this.applyChecksum=typeof e=="boolean"?e:!0,this.regionProvider=Qi(n),this.credentialProvider=Qi(t)}createCanonicalRequest(e,t,n){const s=Object.keys(t).sort();return`${e.method}
${this.getCanonicalPath(e)}
${cL(e)}
${s.map(i=>`${i}:${t[i]}`).join(`
`)}

${s.join(";")}
${n}`}async createStringToSign(e,t,n,s){const i=new this.sha256;i.update(Nm(n));const c=await i.digest();return`${s}
${e}
${t}
${od(c)}`}getCanonicalPath({path:e}){if(this.uriEscapePath){const t=[];for(const i of e.split("/"))(i==null?void 0:i.length)!==0&&i!=="."&&(i===".."?t.pop():t.push(i));const n=`${e!=null&&e.startsWith("/")?"/":""}${t.join("/")}${t.length>0&&(e!=null&&e.endsWith("/"))?"/":""}`;return sd(n).replace(/%2F/g,"/")}return e}validateResolvedCredentials(e){if(typeof e!="object"||typeof e.accessKeyId!="string"||typeof e.secretAccessKey!="string")throw new Error("Resolved credential object is not valid")}formatDate(e){const t=uL(e).replace(/[\-:]/g,"");return{longDate:t,shortDate:t.slice(0,8)}}getCanonicalHeaderList(e){return Object.keys(e).sort().join(";")}}class FS extends fL{constructor({applyChecksum:t,credentials:n,region:s,service:i,sha256:c,uriEscapePath:d=!0}){super({applyChecksum:t,credentials:n,region:s,service:i,sha256:c,uriEscapePath:d});H(this,"headerFormatter",new oL)}async presign(t,n={}){const{signingDate:s=new Date,expiresIn:i=3600,unsignableHeaders:c,unhoistableHeaders:d,signableHeaders:p,hoistableHeaders:m,signingRegion:g,signingService:x}=n,b=await this.credentialProvider();this.validateResolvedCredentials(b);const E=g??await this.regionProvider(),{longDate:T,shortDate:S}=this.formatDate(s);if(i>rL)return Promise.reject("Signature version 4 presigned URLs must have an expiration date less than one week in the future");const N=bx(S,E,x??this.service),R=lL(PS(t),{unhoistableHeaders:d,hoistableHeaders:m});b.sessionToken&&(R.query[tN]=b.sessionToken),R.query[HD]=xx,R.query[BD]=`${b.accessKeyId}/${N}`,R.query[Z1]=T,R.query[WD]=i.toString(10);const A=RS(R,c,p);return R.query[GD]=this.getCanonicalHeaderList(A),R.query[eN]=await this.getSignature(T,N,this.getSigningKey(b,E,S,x),this.createCanonicalRequest(R,A,await _x(t,this.sha256))),R}async sign(t,n){return typeof t=="string"?this.signString(t,n):t.headers&&t.payload?this.signEvent(t,n):t.message?this.signMessage(t,n):this.signRequest(t,n)}async signEvent({headers:t,payload:n},{signingDate:s=new Date,priorSignature:i,signingRegion:c,signingService:d}){const p=c??await this.regionProvider(),{shortDate:m,longDate:g}=this.formatDate(s),x=bx(m,p,d??this.service),b=await _x({headers:{},body:n},this.sha256),E=new this.sha256;E.update(t);const T=od(await E.digest()),S=[ZD,g,x,i,T,b].join(`
`);return this.signString(S,{signingDate:s,signingRegion:p,signingService:d})}async signMessage(t,{signingDate:n=new Date,signingRegion:s,signingService:i}){return this.signEvent({headers:this.headerFormatter.format(t.message.headers),payload:t.message.body},{signingDate:n,signingRegion:s,signingService:i,priorSignature:t.priorSignature}).then(d=>({message:t.message,signature:d}))}async signString(t,{signingDate:n=new Date,signingRegion:s,signingService:i}={}){const c=await this.credentialProvider();this.validateResolvedCredentials(c);const d=s??await this.regionProvider(),{shortDate:p}=this.formatDate(n),m=new this.sha256(await this.getSigningKey(c,d,p,i));return m.update(Nm(t)),od(await m.digest())}async signRequest(t,{signingDate:n=new Date,signableHeaders:s,unsignableHeaders:i,signingRegion:c,signingService:d}={}){const p=await this.credentialProvider();this.validateResolvedCredentials(p);const m=c??await this.regionProvider(),g=PS(t),{longDate:x,shortDate:b}=this.formatDate(n),E=bx(b,m,d??this.service);g.headers[nN]=x,p.sessionToken&&(g.headers[YD]=p.sessionToken);const T=await _x(g,this.sha256);!aL(Tw,g.headers)&&this.applyChecksum&&(g.headers[Tw]=T);const S=RS(g,i,s),N=await this.getSignature(x,E,this.getSigningKey(p,m,b,d),this.createCanonicalRequest(g,S,T));return g.headers[rN]=`${xx} Credential=${p.accessKeyId}/${E}, SignedHeaders=${this.getCanonicalHeaderList(S)}, Signature=${N}`,g}async getSignature(t,n,s,i){const c=await this.createStringToSign(t,n,i,xx),d=new this.sha256(await s);return d.update(Nm(c)),od(await d.digest())}getSigningKey(t,n,s,i){return nL(this.sha256,t,s,n,i||this.service)}}const oN=r=>{let e=r.credentials,t=!!r.credentials,n;Object.defineProperty(r,"credentials",{set(m){m&&m!==e&&m!==n&&(t=!0),e=m;const g=hL(r,{credentials:e,credentialDefaultProvider:r.credentialDefaultProvider}),x=pL(r,g);if(t&&!x.attributed){const b=typeof e=="object"&&e!==null;n=async E=>{const S=await x(E);return b&&(!S.$source||Object.keys(S.$source).length===0)?MD(S,"CREDENTIALS_CODE","e"):S},n.memoized=x.memoized,n.configBound=x.configBound,n.attributed=!0}else n=x},get(){return n},enumerable:!0,configurable:!0}),r.credentials=e;const{signingEscapePath:s=!0,systemClockOffset:i=r.systemClockOffset||0,sha256:c}=r;let d;return r.signer?d=wm(r.signer):r.regionInfoProvider?d=()=>wm(r.region)().then(async m=>[await r.regionInfoProvider(m,{useFipsEndpoint:await r.useFipsEndpoint(),useDualstackEndpoint:await r.useDualstackEndpoint()})||{},m]).then(([m,g])=>{const{signingRegion:x,signingService:b}=m;r.signingRegion=r.signingRegion||x||g,r.signingName=r.signingName||b||r.serviceId;const E={...r,credentials:r.credentials,region:r.signingRegion,service:r.signingName,sha256:c,uriEscapePath:s},T=r.signerConstructor||FS;return new T(E)}):d=async m=>{m=Object.assign({},{name:"sigv4",signingName:r.signingName||r.defaultSigningName,signingRegion:await wm(r.region)(),properties:{}},m);const g=m.signingRegion,x=m.signingName;r.signingRegion=r.signingRegion||g,r.signingName=r.signingName||x||r.serviceId;const b={...r,credentials:r.credentials,region:r.signingRegion,service:r.signingName,sha256:c,uriEscapePath:s},E=r.signerConstructor||FS;return new E(b)},Object.assign(r,{systemClockOffset:i,signingEscapePath:s,signer:d})};function hL(r,{credentials:e,credentialDefaultProvider:t}){let n;return e?e!=null&&e.memoized?n=e:n=cD(e,lD,L1):t?n=wm(t(Object.assign({},r,{parentClientConfig:r}))):n=async()=>{throw new Error("@aws-sdk/core::resolveAwsSdkSigV4Config - `credentials` not provided and no credentialDefaultProvider was configured.")},n.memoized=!0,n}function pL(r,e){if(e.configBound)return e;const t=async n=>e({...n,callerClientConfig:r});return t.memoized=e.memoized,t.configBound=!0,t}const jS=typeof TextEncoder=="function"?new TextEncoder:null,iN=r=>{if(typeof r=="string"){if(jS)return jS.encode(r).byteLength;let e=r.length;for(let t=e-1;t>=0;t--){const n=r.charCodeAt(t);n>127&&n<=2047?e++:n>2047&&n<=65535&&(e+=2),n>=56320&&n<=57343&&t--}return e}else{if(typeof r.byteLength=="number")return r.byteLength;if(typeof r.size=="number")return r.size}throw new Error(`Body Length computation failed for ${r}`)},Ku=(r,e)=>{const t=[];if(r&&t.push(r),e)for(const n of e)t.push(n);return t},Rc=(r,e)=>`${r||"anonymous"}${e&&e.length>0?` (a.k.a. ${e.join(",")})`:""}`,ay=()=>{let r=[],e=[],t=!1;const n=new Set,s=x=>x.sort((b,E)=>OS[E.step]-OS[b.step]||DS[E.priority||"normal"]-DS[b.priority||"normal"]),i=x=>{let b=!1;const E=T=>{const S=Ku(T.name,T.aliases);if(S.includes(x)){b=!0;for(const N of S)n.delete(N);return!1}return!0};return r=r.filter(E),e=e.filter(E),b},c=x=>{let b=!1;const E=T=>{if(T.middleware===x){b=!0;for(const S of Ku(T.name,T.aliases))n.delete(S);return!1}return!0};return r=r.filter(E),e=e.filter(E),b},d=x=>{var b;return r.forEach(E=>{x.add(E.middleware,{...E})}),e.forEach(E=>{x.addRelativeTo(E.middleware,{...E})}),(b=x.identifyOnResolve)==null||b.call(x,g.identifyOnResolve()),x},p=x=>{const b=[];return x.before.forEach(E=>{E.before.length===0&&E.after.length===0?b.push(E):b.push(...p(E))}),b.push(x),x.after.reverse().forEach(E=>{E.before.length===0&&E.after.length===0?b.push(E):b.push(...p(E))}),b},m=(x=!1)=>{const b=[],E=[],T={};return r.forEach(N=>{const R={...N,before:[],after:[]};for(const A of Ku(R.name,R.aliases))T[A]=R;b.push(R)}),e.forEach(N=>{const R={...N,before:[],after:[]};for(const A of Ku(R.name,R.aliases))T[A]=R;E.push(R)}),E.forEach(N=>{if(N.toMiddleware){const R=T[N.toMiddleware];if(R===void 0){if(x)return;throw new Error(`${N.toMiddleware} is not found when adding ${Rc(N.name,N.aliases)} middleware ${N.relation} ${N.toMiddleware}`)}N.relation==="after"&&R.after.push(N),N.relation==="before"&&R.before.push(N)}}),s(b).map(p).reduce((N,R)=>(N.push(...R),N),[])},g={add:(x,b={})=>{const{name:E,override:T,aliases:S}=b,N={step:"initialize",priority:"normal",middleware:x,...b},R=Ku(E,S);if(R.length>0){if(R.some(A=>n.has(A))){if(!T)throw new Error(`Duplicate middleware name '${Rc(E,S)}'`);for(const A of R){const j=r.findIndex($=>{var W;return $.name===A||((W=$.aliases)==null?void 0:W.some(M=>M===A))});if(j===-1)continue;const P=r[j];if(P.step!==N.step||N.priority!==P.priority)throw new Error(`"${Rc(P.name,P.aliases)}" middleware with ${P.priority} priority in ${P.step} step cannot be overridden by "${Rc(E,S)}" middleware with ${N.priority} priority in ${N.step} step.`);r.splice(j,1)}}for(const A of R)n.add(A)}r.push(N)},addRelativeTo:(x,b)=>{const{name:E,override:T,aliases:S}=b,N={middleware:x,...b},R=Ku(E,S);if(R.length>0){if(R.some(A=>n.has(A))){if(!T)throw new Error(`Duplicate middleware name '${Rc(E,S)}'`);for(const A of R){const j=e.findIndex($=>{var W;return $.name===A||((W=$.aliases)==null?void 0:W.some(M=>M===A))});if(j===-1)continue;const P=e[j];if(P.toMiddleware!==N.toMiddleware||P.relation!==N.relation)throw new Error(`"${Rc(P.name,P.aliases)}" middleware ${P.relation} "${P.toMiddleware}" middleware cannot be overridden by "${Rc(E,S)}" middleware ${N.relation} "${N.toMiddleware}" middleware.`);e.splice(j,1)}}for(const A of R)n.add(A)}e.push(N)},clone:()=>d(ay()),use:x=>{x.applyToStack(g)},remove:x=>typeof x=="string"?i(x):c(x),removeByTag:x=>{let b=!1;const E=T=>{const{tags:S,name:N,aliases:R}=T;if(S&&S.includes(x)){const A=Ku(N,R);for(const j of A)n.delete(j);return b=!0,!1}return!0};return r=r.filter(E),e=e.filter(E),b},concat:x=>{var E;const b=d(ay());return b.use(x),b.identifyOnResolve(t||b.identifyOnResolve()||(((E=x.identifyOnResolve)==null?void 0:E.call(x))??!1)),b},applyToStack:d,identify:()=>m(!0).map(x=>{const b=x.step??x.relation+" "+x.toMiddleware;return Rc(x.name,x.aliases)+" - "+b}),identifyOnResolve(x){return typeof x=="boolean"&&(t=x),t},resolve:(x,b)=>{for(const E of m().map(T=>T.middleware).reverse())x=E(x,b);return t&&console.log(g.identify()),x}};return g},OS={initialize:5,serialize:4,build:3,finalizeRequest:2,deserialize:1},DS={high:3,normal:2,low:1};class aN{constructor(e){H(this,"config");H(this,"middlewareStack",ay());H(this,"initConfig");H(this,"handlers");this.config=e;const{protocol:t,protocolSettings:n}=e;n&&typeof t=="function"&&(e.protocol=new t(n))}send(e,t,n){const s=typeof t!="function"?t:void 0,i=typeof t=="function"?t:n,c=s===void 0&&this.config.cacheMiddleware===!0;let d;if(c){this.handlers||(this.handlers=new WeakMap);const p=this.handlers;p.has(e.constructor)?d=p.get(e.constructor):(d=e.resolveMiddleware(this.middlewareStack,this.config,s),p.set(e.constructor,d))}else delete this.handlers,d=e.resolveMiddleware(this.middlewareStack,this.config,s);if(i)d(e).then(p=>i(null,p.output),p=>i(p)).catch(()=>{});else return d(e).then(p=>p.output)}destroy(){var e,t,n;(n=(t=(e=this.config)==null?void 0:e.requestHandler)==null?void 0:t.destroy)==null||n.call(t),delete this.handlers}}const Ex="***SensitiveInformation***";function Rw(r,e){if(e==null)return e;const t=ko.of(r);if(t.getMergedTraits().sensitive)return Ex;if(t.isListSchema()){if(!!t.getValueSchema().getMergedTraits().sensitive)return Ex}else if(t.isMapSchema()){if(!!t.getKeySchema().getMergedTraits().sensitive||!!t.getValueSchema().getMergedTraits().sensitive)return Ex}else if(t.isStructSchema()&&typeof e=="object"){const n=e,s={};for(const[i,c]of t.structIterator())n[i]!=null&&(s[i]=Rw(c,n[i]));return s}return e}class lN{constructor(){H(this,"middlewareStack",ay());H(this,"schema")}static classBuilder(){return new mL}resolveMiddlewareWithContext(e,t,n,{middlewareFn:s,clientName:i,commandName:c,inputFilterSensitiveLog:d,outputFilterSensitiveLog:p,smithyContext:m,additionalContext:g,CommandCtor:x}){for(const N of s.bind(this)(x,e,t,n))this.middlewareStack.use(N);const b=e.concat(this.middlewareStack),{logger:E}=t,T={logger:E,clientName:i,commandName:c,inputFilterSensitiveLog:d,outputFilterSensitiveLog:p,[Ew]:{commandInstance:this,...m},...g},{requestHandler:S}=t;return b.resolve(N=>S.handle(N.request,n||{}),T)}}class mL{constructor(){H(this,"_init",()=>{});H(this,"_ep",{});H(this,"_middlewareFn",()=>[]);H(this,"_commandName","");H(this,"_clientName","");H(this,"_additionalContext",{});H(this,"_smithyContext",{});H(this,"_inputFilterSensitiveLog");H(this,"_outputFilterSensitiveLog");H(this,"_serializer",null);H(this,"_deserializer",null);H(this,"_operationSchema")}init(e){this._init=e}ep(e){return this._ep=e,this}m(e){return this._middlewareFn=e,this}s(e,t,n={}){return this._smithyContext={service:e,operation:t,...n},this}c(e={}){return this._additionalContext=e,this}n(e,t){return this._clientName=e,this._commandName=t,this}f(e=n=>n,t=n=>n){return this._inputFilterSensitiveLog=e,this._outputFilterSensitiveLog=t,this}ser(e){return this._serializer=e,this}de(e){return this._deserializer=e,this}sc(e){return this._operationSchema=e,this._smithyContext.operationSchema=e,this}build(){const e=this;let t;return t=class extends lN{constructor(...[s]){super();H(this,"input");H(this,"serialize",e._serializer);H(this,"deserialize",e._deserializer);this.input=s??{},e._init(this),this.schema=e._operationSchema}static getEndpointParameterInstructions(){return e._ep}resolveMiddleware(s,i,c){const d=e._operationSchema,p=(d==null?void 0:d[4])??(d==null?void 0:d.input),m=(d==null?void 0:d[5])??(d==null?void 0:d.output);return this.resolveMiddlewareWithContext(s,i,c,{CommandCtor:t,middlewareFn:e._middlewareFn,clientName:e._clientName,commandName:e._commandName,inputFilterSensitiveLog:e._inputFilterSensitiveLog??(d?Rw.bind(null,p):g=>g),outputFilterSensitiveLog:e._outputFilterSensitiveLog??(d?Rw.bind(null,m):g=>g),smithyContext:e._smithyContext,additionalContext:e._additionalContext})}}}}class Yf extends Error{constructor(t){super(t.message);H(this,"$fault");H(this,"$response");H(this,"$retryable");H(this,"$metadata");Object.setPrototypeOf(this,Object.getPrototypeOf(this).constructor.prototype),this.name=t.name,this.$fault=t.$fault,this.$metadata=t.$metadata}static isInstance(t){if(!t)return!1;const n=t;return Yf.prototype.isPrototypeOf(n)||!!n.$fault&&!!n.$metadata&&(n.$fault==="client"||n.$fault==="server")}static[Symbol.hasInstance](t){if(!t)return!1;const n=t;return this===Yf?Yf.isInstance(t):Yf.isInstance(t)?n.name&&this.name?this.prototype.isPrototypeOf(t)||n.name===this.name:this.prototype.isPrototypeOf(t):!1}}const LS=(r,e={})=>{Object.entries(e).filter(([,n])=>n!==void 0).forEach(([n,s])=>{(r[n]==null||r[n]==="")&&(r[n]=s)});const t=r.message||r.Message||"UnknownError";return r.message=t,delete r.Message,r},cN=r=>{switch(r){case"standard":return{retryMode:"standard",connectionTimeout:3100};case"in-region":return{retryMode:"standard",connectionTimeout:1100};case"cross-region":return{retryMode:"standard",connectionTimeout:3100};case"mobile":return{retryMode:"standard",connectionTimeout:3e4};default:return{}}},gL=r=>{const e=[];for(const t in oy){const n=oy[t];r[n]!==void 0&&e.push({algorithmId:()=>n,checksumConstructor:()=>r[n]})}return{addChecksumAlgorithm(t){e.push(t)},checksumAlgorithms(){return e}}},vL=r=>{const e={};return r.checksumAlgorithms().forEach(t=>{e[t.algorithmId()]=t.checksumConstructor()}),e},yL=r=>({setRetryStrategy(e){r.retryStrategy=e},retryStrategy(){return r.retryStrategy}}),xL=r=>{const e={};return e.retryStrategy=r.retryStrategy(),e},uN=r=>Object.assign(gL(r),yL(r)),dN=r=>Object.assign(vL(r),xL(r));class jb{trace(){}debug(){}info(){}warn(){}error(){}}class wL{constructor(e=!1){H(this,"queryCompat");this.queryCompat=e}resolveRestContentType(e,t){const n=t.getMemberSchemas(),s=Object.values(n).find(i=>!!i.getMergedTraits().httpPayload);if(s){const i=s.getMergedTraits().mediaType;return i||(s.isStringSchema()?"text/plain":s.isBlobSchema()?"application/octet-stream":e)}else if(!t.isUnitSchema()&&Object.values(n).find(c=>{const{httpQuery:d,httpQueryParams:p,httpHeader:m,httpLabel:g,httpPrefixHeaders:x}=c.getMergedTraits();return!d&&!p&&!m&&!g&&x===void 0}))return e}async getErrorSchemaOrThrowBaseException(e,t,n,s,i,c){let d=t,p=e;e.includes("#")&&([d,p]=e.split("#"));const m={$metadata:i,$fault:n.statusCode<500?"client":"server"},g=ut.for(d);try{return{errorSchema:(c==null?void 0:c(g,p))??g.getSchema(e),errorMetadata:m}}catch{s.message=s.message??s.Message??"UnknownError";const b=ut.for("smithy.ts.sdk.synthetic."+d),E=b.getBaseException();if(E){const T=b.getErrorCtor(E)??Error;throw this.decorateServiceException(Object.assign(new T({name:p}),m),s)}throw this.decorateServiceException(Object.assign(new Error(p),m),s)}}decorateServiceException(e,t={}){if(this.queryCompat){const n=e.Message??t.Message,s=LS(e,t);n&&(s.message=n),s.Error={...s.Error,Type:s.Error.Type,Code:s.Error.Code,Message:s.Error.message??s.Error.Message??n};const i=s.$metadata.requestId;return i&&(s.RequestId=i),s}return LS(e,t)}setQueryCompatError(e,t){var s;const n=(s=t.headers)==null?void 0:s["x-amzn-query-error"];if(e!==void 0&&n!=null){const[i,c]=n.split(";"),d=Object.entries(e),p={Code:i,Type:c};Object.assign(e,p);for(const[m,g]of d)p[m==="message"?"Message":m]=g;delete p.__type,e.Error=p}}queryCompatOutput(e,t){e.Error&&(t.Error=e.Error),e.Type&&(t.Type=e.Type),e.Code&&(t.Code=e.Code)}findQueryCompatibleError(e,t){try{return e.getSchema(t)}catch{return e.find(s=>{var i;return((i=ko.of(s).getMergedTraits().awsQueryError)==null?void 0:i[0])===t})}}}class Ob{constructor(){H(this,"serdeContext")}setSerdeContext(e){this.serdeContext=e}}class bL{constructor(e,t){H(this,"from");H(this,"to");H(this,"keys");this.from=e,this.to=t,this.keys=new Set(Object.keys(this.from).filter(n=>n!=="__type"))}mark(e){this.keys.delete(e)}hasUnknown(){return this.keys.size===1&&Object.keys(this.to).length===0}writeUnknown(){if(this.hasUnknown()){const e=this.keys.values().next().value,t=this.from[e];this.to.$unknown=[e,t]}}}function _L(r,e,t){if(t!=null&&t.source){const n=t.source;if(typeof e=="number"&&(e>Number.MAX_SAFE_INTEGER||e<Number.MIN_SAFE_INTEGER||n!==String(e)))return n.includes(".")?new Ua(n,"bigDecimal"):BigInt(n)}return e}const EL=(r,e)=>Cw(r,e).then(t=>((e==null?void 0:e.utf8Encoder)??Uy)(t)),SL=(r,e)=>EL(r,e).then(t=>{if(t.length)try{return JSON.parse(t)}catch(n){throw(n==null?void 0:n.name)==="SyntaxError"&&Object.defineProperty(n,"$responseBodyText",{value:t}),n}return{}}),CL=(r,e)=>{const t=(i,c)=>Object.keys(i).find(d=>d.toLowerCase()===c.toLowerCase()),n=i=>{let c=i;return typeof c=="number"&&(c=c.toString()),c.indexOf(",")>=0&&(c=c.split(",")[0]),c.indexOf(":")>=0&&(c=c.split(":")[0]),c.indexOf("#")>=0&&(c=c.split("#")[1]),c},s=t(r.headers,"x-amzn-errortype");if(s!==void 0)return n(r.headers[s]);if(e&&typeof e=="object"){const i=t(e,"code");if(i&&e[i]!==void 0)return n(e[i]);if(e.__type!==void 0)return n(e.__type)}};class kL extends Ob{constructor(t){super();H(this,"settings");this.settings=t}async read(t,n){return this._read(t,typeof n=="string"?JSON.parse(n,_L):await SL(n,this.serdeContext))}readObject(t,n){return this._read(t,n)}_read(t,n){const s=n!==null&&typeof n=="object",i=ko.of(t);if(s){if(i.isStructSchema()){const d=n,p=i.isUnionSchema(),m={};let g;const{jsonName:x}=this.settings;x&&(g={});let b;p&&(b=new bL(d,m));for(const[E,T]of i.structIterator()){let S=E;x&&(S=T.getMergedTraits().jsonName??S,g[S]=E),p&&b.mark(S),d[S]!=null&&(m[E]=this._read(T,d[S]))}if(p)b.writeUnknown();else if(typeof d.__type=="string")for(const[E,T]of Object.entries(d)){const S=x?g[E]??E:E;S in m||(m[S]=T)}return m}if(Array.isArray(n)&&i.isListSchema()){const d=i.getValueSchema(),p=[],m=!!i.getMergedTraits().sparse;for(const g of n)(m||g!=null)&&p.push(this._read(d,g));return p}if(i.isMapSchema()){const d=i.getValueSchema(),p={},m=!!i.getMergedTraits().sparse;for(const[g,x]of Object.entries(n))(m||x!=null)&&(p[g]=this._read(d,x));return p}}if(i.isBlobSchema()&&typeof n=="string")return Ym(n);const c=i.getMergedTraits().mediaType;if(i.isStringSchema()&&typeof n=="string"&&c)return c==="application/json"||c.endsWith("+json")?$c.from(n):n;if(i.isTimestampSchema()&&n!=null)switch(j1(i,this.settings)){case 5:return U2(n);case 6:return G2(n);case 7:return W2(n);default:return console.warn("Missing timestamp format, parsing value with Date constructor:",n),new Date(n)}if(i.isBigIntegerSchema()&&(typeof n=="number"||typeof n=="string"))return BigInt(n);if(i.isBigDecimalSchema()&&n!=null){if(n instanceof Ua)return n;const d=n;return d.type==="bigDecimal"&&"string"in d?new Ua(d.string,d.type):new Ua(String(n),"bigDecimal")}if(i.isNumericSchema()&&typeof n=="string"){switch(n){case"Infinity":return 1/0;case"-Infinity":return-1/0;case"NaN":return NaN}return n}if(i.isDocumentSchema())if(s){const d=Array.isArray(n)?[]:{};for(const[p,m]of Object.entries(n))m instanceof Ua?d[p]=m:d[p]=this._read(i,m);return d}else return structuredClone(n);return n}}const MS="";class NL{constructor(){H(this,"values",new Map);H(this,"counter",0);H(this,"stage",0)}createReplacer(){if(this.stage===1)throw new Error("@aws-sdk/core/protocols - JsonReplacer already created.");if(this.stage===2)throw new Error("@aws-sdk/core/protocols - JsonReplacer exhausted.");return this.stage=1,(e,t)=>{if(t instanceof Ua){const n=`${MS+"nv"+this.counter++}_`+t.string;return this.values.set(`"${n}"`,t.string),n}if(typeof t=="bigint"){const n=t.toString(),s=`${MS+"b"+this.counter++}_`+n;return this.values.set(`"${s}"`,n),s}return t}}replaceInJson(e){if(this.stage===0)throw new Error("@aws-sdk/core/protocols - JsonReplacer not created yet.");if(this.stage===2)throw new Error("@aws-sdk/core/protocols - JsonReplacer exhausted.");if(this.stage=2,this.counter===0)return e;for(const[t,n]of this.values)e=e.replace(t,n);return e}}class TL extends Ob{constructor(t){super();H(this,"settings");H(this,"buffer");H(this,"useReplacer",!1);H(this,"rootSchema");this.settings=t}write(t,n){this.rootSchema=ko.of(t),this.buffer=this._write(this.rootSchema,n)}writeDiscriminatedDocument(t,n){this.write(t,n),typeof this.buffer=="object"&&(this.buffer.__type=ko.of(t).getName(!0))}flush(){const{rootSchema:t,useReplacer:n}=this;if(this.rootSchema=void 0,this.useReplacer=!1,t!=null&&t.isStructSchema()||t!=null&&t.isDocumentSchema()){if(!n)return JSON.stringify(this.buffer);const s=new NL;return s.replaceInJson(JSON.stringify(this.buffer,s.createReplacer(),0))}return this.buffer}_write(t,n,s){var d,p;const i=n!==null&&typeof n=="object",c=ko.of(t);if(i){if(c.isStructSchema()){const m=n,g={},{jsonName:x}=this.settings;let b;x&&(b={});for(const[E,T]of c.structIterator()){const S=this._write(T,m[E],c);if(S!==void 0){let N=E;x&&(N=T.getMergedTraits().jsonName??E,b[E]=N),g[N]=S}}if(c.isUnionSchema()&&Object.keys(g).length===0){const{$unknown:E}=m;if(Array.isArray(E)){const[T,S]=E;g[T]=this._write(15,S)}}else if(typeof m.__type=="string")for(const[E,T]of Object.entries(m)){const S=x?b[E]??E:E;S in g||(g[S]=this._write(15,T))}return g}if(Array.isArray(n)&&c.isListSchema()){const m=c.getValueSchema(),g=[],x=!!c.getMergedTraits().sparse;for(const b of n)(x||b!=null)&&g.push(this._write(m,b));return g}if(c.isMapSchema()){const m=c.getValueSchema(),g={},x=!!c.getMergedTraits().sparse;for(const[b,E]of Object.entries(n))(x||E!=null)&&(g[b]=this._write(m,E));return g}if(n instanceof Uint8Array&&(c.isBlobSchema()||c.isDocumentSchema()))return c===this.rootSchema?n:(((d=this.serdeContext)==null?void 0:d.base64Encoder)??Tm)(n);if(n instanceof Date&&(c.isTimestampSchema()||c.isDocumentSchema()))switch(j1(c,this.settings)){case 5:return n.toISOString().replace(".000Z","Z");case 6:return M2(n);case 7:return n.getTime()/1e3;default:return console.warn("Missing timestamp format, using epoch seconds",n),n.getTime()/1e3}n instanceof Ua&&(this.useReplacer=!0)}if(!(n===null&&(s!=null&&s.isStructSchema()))){if(c.isStringSchema()){if(typeof n>"u"&&c.isIdempotencyToken())return F1();const m=c.getMergedTraits().mediaType;return n!=null&&m&&(m==="application/json"||m.endsWith("+json"))?$c.from(n):n}if(typeof n=="number"&&c.isNumericSchema())return Math.abs(n)===1/0||isNaN(n)?String(n):n;if(typeof n=="string"&&c.isBlobSchema())return c===this.rootSchema?n:(((p=this.serdeContext)==null?void 0:p.base64Encoder)??Tm)(n);if(typeof n=="bigint"&&(this.useReplacer=!0),c.isDocumentSchema())if(i){const m=Array.isArray(n)?[]:{};for(const[g,x]of Object.entries(n))x instanceof Ua?(this.useReplacer=!0,m[g]=x):m[g]=this._write(c,x);return m}else return structuredClone(n);return n}}}class RL extends Ob{constructor(t){super();H(this,"settings");this.settings=t}createSerializer(){const t=new TL(this.settings);return t.setSerdeContext(this.serdeContext),t}createDeserializer(){const t=new kL(this.settings);return t.setSerdeContext(this.serdeContext),t}}class AL extends sD{constructor({defaultNamespace:t,serviceTarget:n,awsQueryCompatible:s,jsonCodec:i}){super({defaultNamespace:t});H(this,"serializer");H(this,"deserializer");H(this,"serviceTarget");H(this,"codec");H(this,"mixin");H(this,"awsQueryCompatible");this.serviceTarget=n,this.codec=i??new RL({timestampFormat:{useTrait:!0,default:7},jsonName:!1}),this.serializer=this.codec.createSerializer(),this.deserializer=this.codec.createDeserializer(),this.awsQueryCompatible=!!s,this.mixin=new wL(this.awsQueryCompatible)}async serializeRequest(t,n,s){const i=await super.serializeRequest(t,n,s);return i.path.endsWith("/")||(i.path+="/"),Object.assign(i.headers,{"content-type":`application/x-amz-json-${this.getJsonRpcVersion()}`,"x-amz-target":`${this.serviceTarget}.${t.name}`}),this.awsQueryCompatible&&(i.headers["x-amzn-query-mode"]="true"),(Wv(t.input)==="unit"||!i.body)&&(i.body="{}"),i}getPayloadCodec(){return this.codec}async handleError(t,n,s,i,c){this.awsQueryCompatible&&this.mixin.setQueryCompatError(i,s);const d=CL(s,i)??"Unknown",{errorSchema:p,errorMetadata:m}=await this.mixin.getErrorSchemaOrThrowBaseException(d,this.options.defaultNamespace,s,i,c,this.awsQueryCompatible?this.mixin.findQueryCompatibleError:void 0),g=ko.of(p),x=i.message??i.Message??"Unknown",b=ut.for(p[1]).getErrorCtor(p)??Error,E=new b(x),T={};for(const[S,N]of g.structIterator())i[S]!=null&&(T[S]=this.codec.createDeserializer().readObject(N,i[S]));throw this.awsQueryCompatible&&this.mixin.queryCompatOutput(i,T),this.mixin.decorateServiceException(Object.assign(E,m,{$fault:g.getMergedTraits().error,message:x},T),i)}}class fN extends AL{constructor({defaultNamespace:e,serviceTarget:t,awsQueryCompatible:n,jsonCodec:s}){super({defaultNamespace:e,serviceTarget:t,awsQueryCompatible:n,jsonCodec:s})}getShapeId(){return"aws.protocols#awsJson1_1"}getJsonRpcVersion(){return"1.1"}getDefaultContentType(){return"application/x-amz-json-1.1"}}const IL=/\d{12}\.ddb/;async function PL(r,e,t){var i,c,d,p,m,g,x;const n=t.request;if(((i=n==null?void 0:n.headers)==null?void 0:i["smithy-protocol"])==="rpc-v2-cbor"&&Ia(r,"PROTOCOL_RPC_V2_CBOR","M"),typeof e.retryStrategy=="function"){const b=await e.retryStrategy();typeof b.acquireInitialRetryToken=="function"?(d=(c=b.constructor)==null?void 0:c.name)!=null&&d.includes("Adaptive")?Ia(r,"RETRY_MODE_ADAPTIVE","F"):Ia(r,"RETRY_MODE_STANDARD","E"):Ia(r,"RETRY_MODE_LEGACY","D")}if(typeof e.accountIdEndpointMode=="function"){const b=r.endpointV2;switch(String((p=b==null?void 0:b.url)==null?void 0:p.hostname).match(IL)&&Ia(r,"ACCOUNT_ID_ENDPOINT","O"),await((m=e.accountIdEndpointMode)==null?void 0:m.call(e))){case"disabled":Ia(r,"ACCOUNT_ID_MODE_DISABLED","Q");break;case"preferred":Ia(r,"ACCOUNT_ID_MODE_PREFERRED","P");break;case"required":Ia(r,"ACCOUNT_ID_MODE_REQUIRED","R");break}}const s=(x=(g=r.__smithy_context)==null?void 0:g.selectedHttpAuthScheme)==null?void 0:x.identity;if(s!=null&&s.$source){const b=s;b.accountId&&Ia(r,"RESOLVED_ACCOUNT_ID","T");for(const[E,T]of Object.entries(b.$source??{}))Ia(r,E,T)}}const $S="user-agent",Sx="x-amz-user-agent",US=" ",Cx="/",FL=/[^!$%&'*+\-.^_`|~\w]/g,jL=/[^!$%&'*+\-.^_`|~\w#]/g,zS="-",OL=1024;function DL(r){let e="";for(const t in r){const n=r[t];if(e.length+n.length+1<=OL){e.length?e+=","+n:e+=n;continue}break}return e}const LL=r=>(e,t)=>async n=>{var E,T,S,N;const{request:s}=n;if(!Zo.isInstance(s))return e(n);const{headers:i}=s,c=((E=t==null?void 0:t.userAgent)==null?void 0:E.map(Sv))||[],d=(await r.defaultUserAgentProvider()).map(Sv);await PL(t,r,n);const p=t;d.push(`m/${DL(Object.assign({},(T=t.__smithy_context)==null?void 0:T.features,(S=p.__aws_sdk_context)==null?void 0:S.features))}`);const m=((N=r==null?void 0:r.customUserAgent)==null?void 0:N.map(Sv))||[],g=await r.userAgentAppId();g&&d.push(Sv(["app",`${g}`]));const x=[].concat([...d,...c,...m]).join(US),b=[...d.filter(R=>R.startsWith("aws-sdk-")),...m].join(US);return r.runtime!=="browser"?(b&&(i[Sx]=i[Sx]?`${i[$S]} ${b}`:b),i[$S]=x):i[Sx]=x,e({...n,request:s})},Sv=r=>{var c;const e=r[0].split(Cx).map(d=>d.replace(FL,zS)).join(Cx),t=(c=r[1])==null?void 0:c.replace(jL,zS),n=e.indexOf(Cx),s=e.substring(0,n);let i=e.substring(n+1);return s==="api"&&(i=i.toLowerCase()),[s,i,t].filter(d=>d&&d.length>0).reduce((d,p,m)=>{switch(m){case 0:return p;case 1:return`${d}/${p}`;default:return`${d}#${p}`}},"")},ML={name:"getUserAgentMiddleware",step:"build",priority:"low",tags:["SET_USER_AGENT","USER_AGENT"],override:!0},hN=r=>({applyToStack:e=>{e.add(LL(r),ML)}}),pN=!1,mN=!1,HS=new Set,$L=(r,e=Jm)=>{if(!HS.has(r)&&!e(r))if(r==="*")console.warn('@smithy/config-resolver WARN - Please use the caller region instead of "*". See "sigv4a" in https://github.com/aws/aws-sdk-js-v3/blob/main/supplemental-docs/CLIENTS.md.');else throw new Error(`Region not accepted: region="${r}" is not a valid hostname component.`);else HS.add(r)},gN=r=>typeof r=="string"&&(r.startsWith("fips-")||r.endsWith("-fips")),UL=r=>gN(r)?["fips-aws-global","aws-fips"].includes(r)?"us-east-1":r.replace(/fips-(dkr-|prod-)?|-fips/,""):r,vN=r=>{const{region:e,useFipsEndpoint:t}=r;if(!e)throw new Error("Region is missing");return Object.assign(r,{region:async()=>{const n=typeof e=="function"?await e():e,s=UL(n);return $L(s),s},useFipsEndpoint:async()=>{const n=typeof e=="string"?e:await e();return gN(n)?!0:typeof t!="function"?Promise.resolve(!!t):t()}})},BS="content-length";function zL(r){return e=>async t=>{const n=t.request;if(Zo.isInstance(n)){const{body:s,headers:i}=n;if(s&&Object.keys(i).map(c=>c.toLowerCase()).indexOf(BS)===-1)try{const c=r(s);n.headers={...n.headers,[BS]:String(c)}}catch{}}return e({...t,request:n})}}const HL={step:"build",tags:["SET_CONTENT_LENGTH","CONTENT_LENGTH"],name:"contentLengthMiddleware",override:!0},yN=r=>({applyToStack:e=>{e.add(zL(r.bodyLengthChecker),HL)}}),BL=async r=>{const e=(r==null?void 0:r.Bucket)||"";if(typeof r.Bucket=="string"&&(r.Bucket=e.replace(/#/g,encodeURIComponent("#")).replace(/\?/g,encodeURIComponent("?"))),KL(e)){if(r.ForcePathStyle===!0)throw new Error("Path-style addressing cannot be used with ARN buckets")}else(!qL(e)||e.indexOf(".")!==-1&&!String(r.Endpoint).startsWith("http:")||e.toLowerCase()!==e||e.length<3)&&(r.ForcePathStyle=!0);return r.DisableMultiRegionAccessPoints&&(r.disableMultiRegionAccessPoints=!0,r.DisableMRAP=!0),r},GL=/^[a-z0-9][a-z0-9\.\-]{1,61}[a-z0-9]$/,WL=/(\d+\.){3}\d+/,VL=/\.\./,qL=r=>GL.test(r)&&!WL.test(r)&&!VL.test(r),KL=r=>{const[e,t,n,,,s]=r.split(":"),i=e==="arn"&&r.split(":").length>=6,c=!!(i&&t&&n&&s);if(i&&!c)throw new Error(`Invalid ARN: ${r} was an invalid ARN.`);return c},YL=(r,e,t,n=!1)=>{const s=async()=>{let i;if(n){const c=t.clientContextParams;i=(c==null?void 0:c[r])??t[r]??t[e]}else i=t[r]??t[e];return typeof i=="function"?i():i};return r==="credentialScope"||e==="CredentialScope"?async()=>{const i=typeof t.credentials=="function"?await t.credentials():t.credentials;return(i==null?void 0:i.credentialScope)??(i==null?void 0:i.CredentialScope)}:r==="accountId"||e==="AccountId"?async()=>{const i=typeof t.credentials=="function"?await t.credentials():t.credentials;return(i==null?void 0:i.accountId)??(i==null?void 0:i.AccountId)}:r==="endpoint"||e==="endpoint"?async()=>{if(t.isCustomEndpoint===!1)return;const i=await s();if(i&&typeof i=="object"){if("url"in i)return i.url.href;if("hostname"in i){const{protocol:c,hostname:d,port:p,path:m}=i;return`${c}//${d}${p?":"+p:""}${m}`}}return i}:s},xN=async r=>{},wN=r=>typeof r=="object"?"url"in r?Im(r.url):r:Im(r),JL=async(r,e,t,n)=>{if(!t.isCustomEndpoint){let c;t.serviceConfiguredEndpoint?c=await t.serviceConfiguredEndpoint():c=await xN(t.serviceId),c&&(t.endpoint=()=>Promise.resolve(wN(c)),t.isCustomEndpoint=!0)}const s=await XL(r,e,t);if(typeof t.endpointProvider!="function")throw new Error("config.endpointProvider is not set.");return t.endpointProvider(s,n)},XL=async(r,e,t)=>{var i;const n={},s=((i=e==null?void 0:e.getEndpointParameterInstructions)==null?void 0:i.call(e))||{};for(const[c,d]of Object.entries(s))switch(d.type){case"staticContextParams":n[c]=d.value;break;case"contextParams":n[c]=r[d.name];break;case"clientContextParams":case"builtInParams":n[c]=await YL(d.name,c,t,d.type!=="builtInParams")();break;case"operationContextParams":n[c]=d.get(r);break;default:throw new Error("Unrecognized endpoint parameter instruction: "+JSON.stringify(d))}return Object.keys(s).length===0&&Object.assign(n,t),String(t.serviceId).toLowerCase()==="s3"&&await BL(n),n},QL=({config:r,instructions:e})=>(t,n)=>async s=>{var d,p,m;r.isCustomEndpoint&&oD(n,"ENDPOINT_OVERRIDE","N");const i=await JL(s.input,{getEndpointParameterInstructions(){return e}},{...r},n);n.endpointV2=i,n.authSchemes=(d=i.properties)==null?void 0:d.authSchemes;const c=(p=n.authSchemes)==null?void 0:p[0];if(c){n.signing_region=c.signingRegion,n.signing_service=c.signingName;const g=dd(n),x=(m=g==null?void 0:g.selectedHttpAuthScheme)==null?void 0:m.httpAuthOption;x&&(x.signingProperties=Object.assign(x.signingProperties||{},{signing_region:c.signingRegion,signingRegion:c.signingRegion,signing_service:c.signingName,signingName:c.signingName,signingRegionSet:c.signingRegionSet},c.properties))}return t({...s})},ZL={step:"serialize",tags:["ENDPOINT_PARAMETERS","ENDPOINT_V2","ENDPOINT"],name:"endpointV2Middleware",override:!0,relation:"before",toMiddleware:c2.name},eM=(r,e)=>({applyToStack:t=>{t.addRelativeTo(QL({config:r,instructions:e}),ZL)}}),bN=r=>{const e=r.tls??!0,{endpoint:t,useDualstackEndpoint:n,useFipsEndpoint:s}=r,i=t!=null?async()=>wN(await Qi(t)()):void 0,d=Object.assign(r,{endpoint:i,tls:e,isCustomEndpoint:!!t,useDualstackEndpoint:Qi(n??!1),useFipsEndpoint:Qi(s??!1)});let p;return d.serviceConfiguredEndpoint=async()=>(r.serviceId&&!p&&(p=xN(r.serviceId)),p),d};var uh;(function(r){r.STANDARD="standard",r.ADAPTIVE="adaptive"})(uh||(uh={}));const Pm=3,_N=uh.STANDARD,tM=["BandwidthLimitExceeded","EC2ThrottledException","LimitExceededException","PriorRequestNotComplete","ProvisionedThroughputExceededException","RequestLimitExceeded","RequestThrottled","RequestThrottledException","SlowDown","ThrottledException","Throttling","ThrottlingException","TooManyRequestsException","TransactionInProgressException"],rM=["TimeoutError","RequestTimeout","RequestTimeoutException"],nM=[500,502,503,504],sM=["ECONNRESET","ECONNREFUSED","EPIPE","ETIMEDOUT"],oM=["EHOSTUNREACH","ENETUNREACH","ENOTFOUND"],iM=r=>(r==null?void 0:r.$retryable)!==void 0,aM=r=>{var e;return(e=r.$metadata)==null?void 0:e.clockSkewCorrected},lM=r=>{const e=new Set(["Failed to fetch","NetworkError when attempting to fetch resource","The Internet connection appears to be offline","Load failed","Network request failed"]);return r&&r instanceof TypeError?e.has(r.message):!1},EN=r=>{var e,t;return((e=r.$metadata)==null?void 0:e.httpStatusCode)===429||tM.includes(r.name)||((t=r.$retryable)==null?void 0:t.throttling)==!0},Db=(r,e=0)=>{var t;return iM(r)||aM(r)||rM.includes(r.name)||sM.includes((r==null?void 0:r.code)||"")||oM.includes((r==null?void 0:r.code)||"")||nM.includes(((t=r.$metadata)==null?void 0:t.httpStatusCode)||0)||lM(r)||r.cause!==void 0&&e<=10&&Db(r.cause,e+1)},cM=r=>{var e;if(((e=r.$metadata)==null?void 0:e.httpStatusCode)!==void 0){const t=r.$metadata.httpStatusCode;return 500<=t&&t<=599&&!Db(r)}return!1},$y=class $y{constructor(e){H(this,"beta");H(this,"minCapacity");H(this,"minFillRate");H(this,"scaleConstant");H(this,"smooth");H(this,"currentCapacity",0);H(this,"enabled",!1);H(this,"lastMaxRate",0);H(this,"measuredTxRate",0);H(this,"requestCount",0);H(this,"fillRate");H(this,"lastThrottleTime");H(this,"lastTimestamp",0);H(this,"lastTxRateBucket");H(this,"maxCapacity");H(this,"timeWindow",0);this.beta=(e==null?void 0:e.beta)??.7,this.minCapacity=(e==null?void 0:e.minCapacity)??1,this.minFillRate=(e==null?void 0:e.minFillRate)??.5,this.scaleConstant=(e==null?void 0:e.scaleConstant)??.4,this.smooth=(e==null?void 0:e.smooth)??.8;const t=this.getCurrentTimeInSeconds();this.lastThrottleTime=t,this.lastTxRateBucket=Math.floor(this.getCurrentTimeInSeconds()),this.fillRate=this.minFillRate,this.maxCapacity=this.minCapacity}getCurrentTimeInSeconds(){return Date.now()/1e3}async getSendToken(){return this.acquireTokenBucket(1)}async acquireTokenBucket(e){if(this.enabled){if(this.refillTokenBucket(),e>this.currentCapacity){const t=(e-this.currentCapacity)/this.fillRate*1e3;await new Promise(n=>$y.setTimeoutFn(n,t))}this.currentCapacity=this.currentCapacity-e}}refillTokenBucket(){const e=this.getCurrentTimeInSeconds();if(!this.lastTimestamp){this.lastTimestamp=e;return}const t=(e-this.lastTimestamp)*this.fillRate;this.currentCapacity=Math.min(this.maxCapacity,this.currentCapacity+t),this.lastTimestamp=e}updateClientSendingRate(e){let t;if(this.updateMeasuredRate(),EN(e)){const s=this.enabled?Math.min(this.measuredTxRate,this.fillRate):this.measuredTxRate;this.lastMaxRate=s,this.calculateTimeWindow(),this.lastThrottleTime=this.getCurrentTimeInSeconds(),t=this.cubicThrottle(s),this.enableTokenBucket()}else this.calculateTimeWindow(),t=this.cubicSuccess(this.getCurrentTimeInSeconds());const n=Math.min(t,2*this.measuredTxRate);this.updateTokenBucketRate(n)}calculateTimeWindow(){this.timeWindow=this.getPrecise(Math.pow(this.lastMaxRate*(1-this.beta)/this.scaleConstant,1/3))}cubicThrottle(e){return this.getPrecise(e*this.beta)}cubicSuccess(e){return this.getPrecise(this.scaleConstant*Math.pow(e-this.lastThrottleTime-this.timeWindow,3)+this.lastMaxRate)}enableTokenBucket(){this.enabled=!0}updateTokenBucketRate(e){this.refillTokenBucket(),this.fillRate=Math.max(e,this.minFillRate),this.maxCapacity=Math.max(e,this.minCapacity),this.currentCapacity=Math.min(this.currentCapacity,this.maxCapacity)}updateMeasuredRate(){const e=this.getCurrentTimeInSeconds(),t=Math.floor(e*2)/2;if(this.requestCount++,t>this.lastTxRateBucket){const n=this.requestCount/(t-this.lastTxRateBucket);this.measuredTxRate=this.getPrecise(n*this.smooth+this.measuredTxRate*(1-this.smooth)),this.requestCount=0,this.lastTxRateBucket=t}}getPrecise(e){return parseFloat(e.toFixed(8))}};H($y,"setTimeoutFn",setTimeout);let Aw=$y;const Iw=100,SN=20*1e3,uM=500,GS=500,dM=5,fM=10,hM=1,pM="amz-sdk-invocation-id",mM="amz-sdk-request",gM=()=>{let r=Iw;return{computeNextBackoffDelay:n=>Math.floor(Math.min(SN,Math.random()*2**n*r)),setDelayBase:n=>{r=n}}},WS=({retryDelay:r,retryCount:e,retryCost:t})=>({getRetryCount:()=>e,getRetryDelay:()=>Math.min(SN,r),getRetryCost:()=>t});class CN{constructor(e){H(this,"maxAttempts");H(this,"mode",uh.STANDARD);H(this,"capacity",GS);H(this,"retryBackoffStrategy",gM());H(this,"maxAttemptsProvider");this.maxAttempts=e,this.maxAttemptsProvider=typeof e=="function"?e:async()=>e}async acquireInitialRetryToken(e){return WS({retryDelay:Iw,retryCount:0})}async refreshRetryTokenForRetry(e,t){const n=await this.getMaxAttempts();if(this.shouldRetry(e,t,n)){const s=t.errorType;this.retryBackoffStrategy.setDelayBase(s==="THROTTLING"?uM:Iw);const i=this.retryBackoffStrategy.computeNextBackoffDelay(e.getRetryCount()),c=t.retryAfterHint?Math.max(t.retryAfterHint.getTime()-Date.now()||0,i):i,d=this.getCapacityCost(s);return this.capacity-=d,WS({retryDelay:c,retryCount:e.getRetryCount()+1,retryCost:d})}throw new Error("No retry token available")}recordSuccess(e){this.capacity=Math.max(GS,this.capacity+(e.getRetryCost()??hM))}getCapacity(){return this.capacity}async getMaxAttempts(){try{return await this.maxAttemptsProvider()}catch{return console.warn(`Max attempts provider could not resolve. Using default of ${Pm}`),Pm}}shouldRetry(e,t,n){return e.getRetryCount()+1<n&&this.capacity>=this.getCapacityCost(t.errorType)&&this.isRetryableError(t.errorType)}getCapacityCost(e){return e==="TRANSIENT"?fM:dM}isRetryableError(e){return e==="THROTTLING"||e==="TRANSIENT"}}class vM{constructor(e,t){H(this,"maxAttemptsProvider");H(this,"rateLimiter");H(this,"standardRetryStrategy");H(this,"mode",uh.ADAPTIVE);this.maxAttemptsProvider=e;const{rateLimiter:n}=t??{};this.rateLimiter=n??new Aw,this.standardRetryStrategy=new CN(e)}async acquireInitialRetryToken(e){return await this.rateLimiter.getSendToken(),this.standardRetryStrategy.acquireInitialRetryToken(e)}async refreshRetryTokenForRetry(e,t){return this.rateLimiter.updateClientSendingRate(t),this.standardRetryStrategy.refreshRetryTokenForRetry(e,t)}recordSuccess(e){this.rateLimiter.updateClientSendingRate({}),this.standardRetryStrategy.recordSuccess(e)}}const yM=r=>r instanceof Error?r:r instanceof Object?Object.assign(new Error,r):typeof r=="string"?new Error(r):new Error(`AWS SDK error wrapper for ${r}`),kN=r=>{const{retryStrategy:e,retryMode:t,maxAttempts:n}=r,s=Qi(n??Pm);return Object.assign(r,{maxAttempts:s,retryStrategy:async()=>e||(await Qi(t)()===uh.ADAPTIVE?new vM(s):new CN(s))})},xM=r=>(r==null?void 0:r.body)instanceof ReadableStream,wM=r=>(e,t)=>async n=>{var c;let s=await r.retryStrategy();const i=await r.maxAttempts();if(bM(s)){s=s;let d=await s.acquireInitialRetryToken(t.partition_id),p=new Error,m=0,g=0;const{request:x}=n,b=Zo.isInstance(x);for(b&&(x.headers[pM]=F1());;)try{b&&(x.headers[mM]=`attempt=${m+1}; max=${i}`);const{response:E,output:T}=await e(n);return s.recordSuccess(d),T.$metadata.attempts=m+1,T.$metadata.totalRetryDelay=g,{response:E,output:T}}catch(E){const T=_M(E);if(p=yM(E),b&&xM(x))throw(c=t.logger instanceof jb?console:t.logger)==null||c.warn("An error was encountered in a non-retryable streaming request."),p;try{d=await s.refreshRetryTokenForRetry(d,T)}catch{throw p.$metadata||(p.$metadata={}),p.$metadata.attempts=m+1,p.$metadata.totalRetryDelay=g,p}m=d.getRetryCount();const S=d.getRetryDelay();g+=S,await new Promise(N=>setTimeout(N,S))}}else return s=s,s!=null&&s.mode&&(t.userAgent=[...t.userAgent||[],["cfg/retry-mode",s.mode]]),s.retry(e,n)},bM=r=>typeof r.acquireInitialRetryToken<"u"&&typeof r.refreshRetryTokenForRetry<"u"&&typeof r.recordSuccess<"u",_M=r=>{const e={error:r,errorType:EM(r)},t=CM(r.$response);return t&&(e.retryAfterHint=t),e},EM=r=>EN(r)?"THROTTLING":Db(r)?"TRANSIENT":cM(r)?"SERVER_ERROR":"CLIENT_ERROR",SM={name:"retryMiddleware",tags:["RETRY"],step:"finalizeRequest",priority:"high",override:!0},NN=r=>({applyToStack:e=>{e.add(wM(r),SM)}}),CM=r=>{if(!lh.isInstance(r))return;const e=Object.keys(r.headers).find(i=>i.toLowerCase()==="retry-after");if(!e)return;const t=r.headers[e],n=Number(t);return Number.isNaN(n)?new Date(t):new Date(n*1e3)},kM=async(r,e,t)=>({operation:dd(e).operation,region:await Qi(r.region)()||(()=>{throw new Error("expected `region` to be configured for `aws.auth#sigv4`")})()});function NM(r){return{schemeId:"aws.auth#sigv4",signingProperties:{name:"cognito-idp",region:r.region},propertiesExtractor:(e,t)=>({signingProperties:{config:e,context:t}})}}function br(r){return{schemeId:"smithy.api#noAuth"}}const TM=r=>{const e=[];switch(r.operation){case"AssociateSoftwareToken":{e.push(br());break}case"ChangePassword":{e.push(br());break}case"CompleteWebAuthnRegistration":{e.push(br());break}case"ConfirmDevice":{e.push(br());break}case"ConfirmForgotPassword":{e.push(br());break}case"ConfirmSignUp":{e.push(br());break}case"DeleteUser":{e.push(br());break}case"DeleteUserAttributes":{e.push(br());break}case"DeleteWebAuthnCredential":{e.push(br());break}case"ForgetDevice":{e.push(br());break}case"ForgotPassword":{e.push(br());break}case"GetDevice":{e.push(br());break}case"GetTokensFromRefreshToken":{e.push(br());break}case"GetUser":{e.push(br());break}case"GetUserAttributeVerificationCode":{e.push(br());break}case"GetUserAuthFactors":{e.push(br());break}case"GlobalSignOut":{e.push(br());break}case"InitiateAuth":{e.push(br());break}case"ListDevices":{e.push(br());break}case"ListWebAuthnCredentials":{e.push(br());break}case"ResendConfirmationCode":{e.push(br());break}case"RespondToAuthChallenge":{e.push(br());break}case"RevokeToken":{e.push(br());break}case"SetUserMFAPreference":{e.push(br());break}case"SetUserSettings":{e.push(br());break}case"SignUp":{e.push(br());break}case"StartWebAuthnRegistration":{e.push(br());break}case"UpdateAuthEventFeedback":{e.push(br());break}case"UpdateDeviceStatus":{e.push(br());break}case"UpdateUserAttributes":{e.push(br());break}case"VerifySoftwareToken":{e.push(br());break}case"VerifyUserAttribute":{e.push(br());break}default:e.push(NM(r))}return e},RM=r=>{const e=oN(r);return Object.assign(e,{authSchemePreference:Qi(r.authSchemePreference??[])})},AM=r=>Object.assign(r,{useDualstackEndpoint:r.useDualstackEndpoint??!1,useFipsEndpoint:r.useFipsEndpoint??!1,defaultSigningName:"cognito-idp"}),IM={UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}},PM="3.981.0",FM={version:PM},jM=r=>new TextEncoder().encode(r);var OM=typeof Buffer<"u"&&Buffer.from?function(r){return Buffer.from(r,"utf8")}:jM;function Fm(r){return r instanceof Uint8Array?r:typeof r=="string"?OM(r):ArrayBuffer.isView(r)?new Uint8Array(r.buffer,r.byteOffset,r.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(r)}function Pw(r){return typeof r=="string"?r.length===0:r.byteLength===0}var TN={name:"SHA-256"},VS={name:"HMAC",hash:TN},DM=new Uint8Array([227,176,196,66,152,252,28,20,154,251,244,200,153,111,185,36,39,174,65,228,100,155,147,76,164,149,153,27,120,82,184,85]);const LM={};function qv(){return typeof window<"u"?window:typeof self<"u"?self:LM}var MM=(function(){function r(e){this.toHash=new Uint8Array(0),this.secret=e,this.reset()}return r.prototype.update=function(e){if(!Pw(e)){var t=Fm(e),n=new Uint8Array(this.toHash.byteLength+t.byteLength);n.set(this.toHash,0),n.set(t,this.toHash.byteLength),this.toHash=n}},r.prototype.digest=function(){var e=this;return this.key?this.key.then(function(t){return qv().crypto.subtle.sign(VS,t,e.toHash).then(function(n){return new Uint8Array(n)})}):Pw(this.toHash)?Promise.resolve(DM):Promise.resolve().then(function(){return qv().crypto.subtle.digest(TN,e.toHash)}).then(function(t){return Promise.resolve(new Uint8Array(t))})},r.prototype.reset=function(){var e=this;this.toHash=new Uint8Array(0),this.secret&&this.secret!==void 0&&(this.key=new Promise(function(t,n){qv().crypto.subtle.importKey("raw",Fm(e.secret),VS,!1,["sign"]).then(t,n)}),this.key.catch(function(){}))},r})(),La=function(){return La=Object.assign||function(e){for(var t,n=1,s=arguments.length;n<s;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},La.apply(this,arguments)};function RN(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(r);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(r,n[s])&&(t[n[s]]=r[n[s]]);return t}function $M(r,e,t,n){function s(i){return i instanceof t?i:new t(function(c){c(i)})}return new(t||(t=Promise))(function(i,c){function d(g){try{m(n.next(g))}catch(x){c(x)}}function p(g){try{m(n.throw(g))}catch(x){c(x)}}function m(g){g.done?i(g.value):s(g.value).then(d,p)}m((n=n.apply(r,e||[])).next())})}function UM(r,e){var t={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,c=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return c.next=d(0),c.throw=d(1),c.return=d(2),typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function d(m){return function(g){return p([m,g])}}function p(m){if(n)throw new TypeError("Generator is already executing.");for(;c&&(c=0,m[0]&&(t=0)),t;)try{if(n=1,s&&(i=m[0]&2?s.return:m[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,m[1])).done)return i;switch(s=0,i&&(m=[m[0]&2,i.value]),m[0]){case 0:case 1:i=m;break;case 4:return t.label++,{value:m[1],done:!1};case 5:t.label++,s=m[1],m=[0];continue;case 7:m=t.ops.pop(),t.trys.pop();continue;default:if(i=t.trys,!(i=i.length>0&&i[i.length-1])&&(m[0]===6||m[0]===2)){t=0;continue}if(m[0]===3&&(!i||m[1]>i[0]&&m[1]<i[3])){t.label=m[1];break}if(m[0]===6&&t.label<i[1]){t.label=i[1],i=m;break}if(i&&t.label<i[2]){t.label=i[2],t.ops.push(m);break}i[2]&&t.ops.pop(),t.trys.pop();continue}m=e.call(r,t)}catch(g){m=[6,g],s=0}finally{n=i=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}}function zM(r,e,t){if(t||arguments.length===2)for(var n=0,s=e.length,i;n<s;n++)(i||!(n in e))&&(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return r.concat(i||Array.prototype.slice.call(e))}var bi=64,HM=32,BM=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),GM=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],WM=Math.pow(2,53)-1,Kv=(function(){function r(){this.state=Int32Array.from(GM),this.temp=new Int32Array(64),this.buffer=new Uint8Array(64),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}return r.prototype.update=function(e){if(this.finished)throw new Error("Attempted to update an already finished hash.");var t=0,n=e.byteLength;if(this.bytesHashed+=n,this.bytesHashed*8>WM)throw new Error("Cannot hash more than 2^53 - 1 bits");for(;n>0;)this.buffer[this.bufferLength++]=e[t++],n--,this.bufferLength===bi&&(this.hashBuffer(),this.bufferLength=0)},r.prototype.digest=function(){if(!this.finished){var e=this.bytesHashed*8,t=new DataView(this.buffer.buffer,this.buffer.byteOffset,this.buffer.byteLength),n=this.bufferLength;if(t.setUint8(this.bufferLength++,128),n%bi>=bi-8){for(var s=this.bufferLength;s<bi;s++)t.setUint8(s,0);this.hashBuffer(),this.bufferLength=0}for(var s=this.bufferLength;s<bi-8;s++)t.setUint8(s,0);t.setUint32(bi-8,Math.floor(e/4294967296),!0),t.setUint32(bi-4,e),this.hashBuffer(),this.finished=!0}for(var i=new Uint8Array(HM),s=0;s<8;s++)i[s*4]=this.state[s]>>>24&255,i[s*4+1]=this.state[s]>>>16&255,i[s*4+2]=this.state[s]>>>8&255,i[s*4+3]=this.state[s]>>>0&255;return i},r.prototype.hashBuffer=function(){for(var e=this,t=e.buffer,n=e.state,s=n[0],i=n[1],c=n[2],d=n[3],p=n[4],m=n[5],g=n[6],x=n[7],b=0;b<bi;b++){if(b<16)this.temp[b]=(t[b*4]&255)<<24|(t[b*4+1]&255)<<16|(t[b*4+2]&255)<<8|t[b*4+3]&255;else{var E=this.temp[b-2],T=(E>>>17|E<<15)^(E>>>19|E<<13)^E>>>10;E=this.temp[b-15];var S=(E>>>7|E<<25)^(E>>>18|E<<14)^E>>>3;this.temp[b]=(T+this.temp[b-7]|0)+(S+this.temp[b-16]|0)}var N=(((p>>>6|p<<26)^(p>>>11|p<<21)^(p>>>25|p<<7))+(p&m^~p&g)|0)+(x+(BM[b]+this.temp[b]|0)|0)|0,R=((s>>>2|s<<30)^(s>>>13|s<<19)^(s>>>22|s<<10))+(s&i^s&c^i&c)|0;x=g,g=m,m=p,p=d+N|0,d=c,c=i,i=s,s=N+R|0}n[0]+=s,n[1]+=i,n[2]+=c,n[3]+=d,n[4]+=p,n[5]+=m,n[6]+=g,n[7]+=x},r})(),VM=(function(){function r(e){this.secret=e,this.hash=new Kv,this.reset()}return r.prototype.update=function(e){if(!(Pw(e)||this.error))try{this.hash.update(Fm(e))}catch(t){this.error=t}},r.prototype.digestSync=function(){if(this.error)throw this.error;return this.outer?(this.outer.finished||this.outer.update(this.hash.digest()),this.outer.digest()):this.hash.digest()},r.prototype.digest=function(){return $M(this,void 0,void 0,function(){return UM(this,function(e){return[2,this.digestSync()]})})},r.prototype.reset=function(){if(this.hash=new Kv,this.secret){this.outer=new Kv;var e=qM(this.secret),t=new Uint8Array(bi);t.set(e);for(var n=0;n<bi;n++)e[n]^=54,t[n]^=92;this.hash.update(e),this.outer.update(t);for(var n=0;n<e.byteLength;n++)e[n]=0}},r})();function qM(r){var e=Fm(r);if(e.byteLength>bi){var t=new Kv;t.update(e),e=t.digest()}var n=new Uint8Array(bi);return n.set(e),n}var KM=["decrypt","digest","encrypt","exportKey","generateKey","importKey","sign","verify"];function YM(r){if(JM(r)&&typeof r.crypto.subtle=="object"){var e=r.crypto.subtle;return XM(e)}return!1}function JM(r){if(typeof r=="object"&&typeof r.crypto=="object"){var e=r.crypto.getRandomValues;return typeof e=="function"}return!1}function XM(r){return r&&KM.every(function(e){return typeof r[e]=="function"})}var AN=(function(){function r(e){YM(qv())?this.hash=new MM(e):this.hash=new VM(e)}return r.prototype.update=function(e,t){this.hash.update(Fm(e))},r.prototype.digest=function(){return this.hash.digest()},r.prototype.reset=function(){this.hash.reset()},r})();const IN=({serviceId:r,clientVersion:e})=>async t=>{var E,T,S;const n=typeof window<"u"?window.navigator:void 0,s=(n==null?void 0:n.userAgent)??"",i=((E=n==null?void 0:n.userAgentData)==null?void 0:E.platform)??qS.os(s)??"other",c=void 0,d=((T=n==null?void 0:n.userAgentData)==null?void 0:T.brands)??[],p=d[d.length-1],m=(p==null?void 0:p.brand)??qS.browser(s)??"unknown",g=(p==null?void 0:p.version)??"unknown",x=[["aws-sdk-js",e],["ua","2.1"],[`os/${i}`,c],["lang/js"],["md/browser",`${m}_${g}`]];r&&x.push([`api/${r}`,e]);const b=await((S=t==null?void 0:t.userAgentAppId)==null?void 0:S.call(t));return b&&x.push([`app/${b}`]),x},qS={os(r){if(/iPhone|iPad|iPod/.test(r))return"iOS";if(/Macintosh|Mac OS X/.test(r))return"macOS";if(/Windows NT/.test(r))return"Windows";if(/Android/.test(r))return"Android";if(/Linux/.test(r))return"Linux"},browser(r){if(/EdgiOS|EdgA|Edg\//.test(r))return"Microsoft Edge";if(/Firefox\//.test(r))return"Firefox";if(/Chrome\//.test(r))return"Chrome";if(/Safari\//.test(r))return"Safari"}},PN=r=>()=>Promise.reject(r),QM=["in-region","cross-region","mobile","standard","legacy"],FN=({defaultsMode:r}={})=>zD(async()=>{const e=typeof r=="function"?await r():r;switch(e==null?void 0:e.toLowerCase()){case"auto":return Promise.resolve(ZM()?"mobile":"standard");case"mobile":case"in-region":case"cross-region":case"standard":case"legacy":return Promise.resolve(e==null?void 0:e.toLocaleLowerCase());case void 0:return Promise.resolve("legacy");default:throw new Error(`Invalid parameter for "defaultsMode", expect ${QM.join(", ")}, got ${e}`)}}),ZM=()=>{var e;const r=window==null?void 0:window.navigator;if(r!=null&&r.connection){const{effectiveType:t,rtt:n,downlink:s}=r==null?void 0:r.connection;if(typeof t=="string"&&t!=="4g"||Number(n)>100||Number(s)<10)return!0}return((e=r==null?void 0:r.userAgentData)==null?void 0:e.mobile)||typeof(r==null?void 0:r.maxTouchPoints)=="number"&&(r==null?void 0:r.maxTouchPoints)>1},jN=(r,e=!1)=>{if(e){for(const t of r.split("."))if(!jN(t))return!1;return!0}return!(!Jm(r)||r.length<3||r.length>63||r!==r.toLowerCase()||Ib(r))},KS=":",e$="/",t$=r=>{const e=r.split(KS);if(e.length<6)return null;const[t,n,s,i,c,...d]=e;if(t!=="arn"||n===""||s===""||d.join(KS)==="")return null;const p=d.map(m=>m.split(e$)).flat();return{partition:n,service:s,region:i,accountId:c,resourceId:p}},r$=[{id:"aws",outputs:{dnsSuffix:"amazonaws.com",dualStackDnsSuffix:"api.aws",implicitGlobalRegion:"us-east-1",name:"aws",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^(us|eu|ap|sa|ca|me|af|il|mx)\\-\\w+\\-\\d+$",regions:{"af-south-1":{description:"Africa (Cape Town)"},"ap-east-1":{description:"Asia Pacific (Hong Kong)"},"ap-east-2":{description:"Asia Pacific (Taipei)"},"ap-northeast-1":{description:"Asia Pacific (Tokyo)"},"ap-northeast-2":{description:"Asia Pacific (Seoul)"},"ap-northeast-3":{description:"Asia Pacific (Osaka)"},"ap-south-1":{description:"Asia Pacific (Mumbai)"},"ap-south-2":{description:"Asia Pacific (Hyderabad)"},"ap-southeast-1":{description:"Asia Pacific (Singapore)"},"ap-southeast-2":{description:"Asia Pacific (Sydney)"},"ap-southeast-3":{description:"Asia Pacific (Jakarta)"},"ap-southeast-4":{description:"Asia Pacific (Melbourne)"},"ap-southeast-5":{description:"Asia Pacific (Malaysia)"},"ap-southeast-6":{description:"Asia Pacific (New Zealand)"},"ap-southeast-7":{description:"Asia Pacific (Thailand)"},"aws-global":{description:"aws global region"},"ca-central-1":{description:"Canada (Central)"},"ca-west-1":{description:"Canada West (Calgary)"},"eu-central-1":{description:"Europe (Frankfurt)"},"eu-central-2":{description:"Europe (Zurich)"},"eu-north-1":{description:"Europe (Stockholm)"},"eu-south-1":{description:"Europe (Milan)"},"eu-south-2":{description:"Europe (Spain)"},"eu-west-1":{description:"Europe (Ireland)"},"eu-west-2":{description:"Europe (London)"},"eu-west-3":{description:"Europe (Paris)"},"il-central-1":{description:"Israel (Tel Aviv)"},"me-central-1":{description:"Middle East (UAE)"},"me-south-1":{description:"Middle East (Bahrain)"},"mx-central-1":{description:"Mexico (Central)"},"sa-east-1":{description:"South America (Sao Paulo)"},"us-east-1":{description:"US East (N. Virginia)"},"us-east-2":{description:"US East (Ohio)"},"us-west-1":{description:"US West (N. California)"},"us-west-2":{description:"US West (Oregon)"}}},{id:"aws-cn",outputs:{dnsSuffix:"amazonaws.com.cn",dualStackDnsSuffix:"api.amazonwebservices.com.cn",implicitGlobalRegion:"cn-northwest-1",name:"aws-cn",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^cn\\-\\w+\\-\\d+$",regions:{"aws-cn-global":{description:"aws-cn global region"},"cn-north-1":{description:"China (Beijing)"},"cn-northwest-1":{description:"China (Ningxia)"}}},{id:"aws-eusc",outputs:{dnsSuffix:"amazonaws.eu",dualStackDnsSuffix:"api.amazonwebservices.eu",implicitGlobalRegion:"eusc-de-east-1",name:"aws-eusc",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^eusc\\-(de)\\-\\w+\\-\\d+$",regions:{"eusc-de-east-1":{description:"AWS European Sovereign Cloud (Germany)"}}},{id:"aws-iso",outputs:{dnsSuffix:"c2s.ic.gov",dualStackDnsSuffix:"api.aws.ic.gov",implicitGlobalRegion:"us-iso-east-1",name:"aws-iso",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-iso\\-\\w+\\-\\d+$",regions:{"aws-iso-global":{description:"aws-iso global region"},"us-iso-east-1":{description:"US ISO East"},"us-iso-west-1":{description:"US ISO WEST"}}},{id:"aws-iso-b",outputs:{dnsSuffix:"sc2s.sgov.gov",dualStackDnsSuffix:"api.aws.scloud",implicitGlobalRegion:"us-isob-east-1",name:"aws-iso-b",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-isob\\-\\w+\\-\\d+$",regions:{"aws-iso-b-global":{description:"aws-iso-b global region"},"us-isob-east-1":{description:"US ISOB East (Ohio)"},"us-isob-west-1":{description:"US ISOB West"}}},{id:"aws-iso-e",outputs:{dnsSuffix:"cloud.adc-e.uk",dualStackDnsSuffix:"api.cloud-aws.adc-e.uk",implicitGlobalRegion:"eu-isoe-west-1",name:"aws-iso-e",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^eu\\-isoe\\-\\w+\\-\\d+$",regions:{"aws-iso-e-global":{description:"aws-iso-e global region"},"eu-isoe-west-1":{description:"EU ISOE West"}}},{id:"aws-iso-f",outputs:{dnsSuffix:"csp.hci.ic.gov",dualStackDnsSuffix:"api.aws.hci.ic.gov",implicitGlobalRegion:"us-isof-south-1",name:"aws-iso-f",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-isof\\-\\w+\\-\\d+$",regions:{"aws-iso-f-global":{description:"aws-iso-f global region"},"us-isof-east-1":{description:"US ISOF EAST"},"us-isof-south-1":{description:"US ISOF SOUTH"}}},{id:"aws-us-gov",outputs:{dnsSuffix:"amazonaws.com",dualStackDnsSuffix:"api.aws",implicitGlobalRegion:"us-gov-west-1",name:"aws-us-gov",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-gov\\-\\w+\\-\\d+$",regions:{"aws-us-gov-global":{description:"aws-us-gov global region"},"us-gov-east-1":{description:"AWS GovCloud (US-East)"},"us-gov-west-1":{description:"AWS GovCloud (US-West)"}}}],n$={partitions:r$};let s$=n$;const o$=r=>{const{partitions:e}=s$;for(const n of e){const{regions:s,outputs:i}=n;for(const[c,d]of Object.entries(s))if(c===r)return{...i,...d}}for(const n of e){const{regionRegex:s,outputs:i}=n;if(new RegExp(s).test(r))return{...i}}const t=e.find(n=>n.id==="aws");if(!t)throw new Error("Provided region was not found in the partition array or regex, and default partition with id 'aws' doesn't exist.");return{...t.outputs}},Lb={isVirtualHostableS3Bucket:jN,parseArn:t$,partition:o$};ch.aws=Lb;const ON="required",Fs="fn",js="argv",mh="ref",YS=!0,JS="isSet",jm="booleanEquals",Lf="error",Pa="endpoint",Cl="tree",Mb="PartitionResult",$b="getAttr",zp="stringEquals",XS={[ON]:!1,type:"string"},QS={[ON]:!0,default:!1,type:"boolean"},ZS={[mh]:"Endpoint"},DN={[Fs]:jm,[js]:[{[mh]:"UseFIPS"},!0]},LN={[Fs]:jm,[js]:[{[mh]:"UseDualStack"},!0]},Pn={},lm={[mh]:"Region"},eC={[Fs]:$b,[js]:[{[mh]:Mb},"supportsFIPS"]},MN={[mh]:Mb},tC={[Fs]:jm,[js]:[!0,{[Fs]:$b,[js]:[MN,"supportsDualStack"]}]},rC=[DN],nC=[LN],sC=[lm],i$={parameters:{Region:XS,UseDualStack:QS,UseFIPS:QS,Endpoint:XS},rules:[{conditions:[{[Fs]:JS,[js]:[ZS]}],rules:[{conditions:rC,error:"Invalid Configuration: FIPS and custom endpoint are not supported",type:Lf},{conditions:nC,error:"Invalid Configuration: Dualstack and custom endpoint are not supported",type:Lf},{endpoint:{url:ZS,properties:Pn,headers:Pn},type:Pa}],type:Cl},{conditions:[{[Fs]:JS,[js]:sC}],rules:[{conditions:[{[Fs]:"aws.partition",[js]:sC,assign:Mb}],rules:[{conditions:[DN,LN],rules:[{conditions:[{[Fs]:jm,[js]:[YS,eC]},tC],rules:[{conditions:[{[Fs]:zp,[js]:[lm,"us-east-1"]}],endpoint:{url:"https://cognito-idp-fips.us-east-1.amazonaws.com",properties:Pn,headers:Pn},type:Pa},{conditions:[{[Fs]:zp,[js]:[lm,"us-east-2"]}],endpoint:{url:"https://cognito-idp-fips.us-east-2.amazonaws.com",properties:Pn,headers:Pn},type:Pa},{conditions:[{[Fs]:zp,[js]:[lm,"us-west-1"]}],endpoint:{url:"https://cognito-idp-fips.us-west-1.amazonaws.com",properties:Pn,headers:Pn},type:Pa},{conditions:[{[Fs]:zp,[js]:[lm,"us-west-2"]}],endpoint:{url:"https://cognito-idp-fips.us-west-2.amazonaws.com",properties:Pn,headers:Pn},type:Pa},{endpoint:{url:"https://cognito-idp-fips.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:Pn,headers:Pn},type:Pa}],type:Cl},{error:"FIPS and DualStack are enabled, but this partition does not support one or both",type:Lf}],type:Cl},{conditions:rC,rules:[{conditions:[{[Fs]:jm,[js]:[eC,YS]}],rules:[{endpoint:{url:"https://cognito-idp-fips.{Region}.{PartitionResult#dnsSuffix}",properties:Pn,headers:Pn},type:Pa}],type:Cl},{error:"FIPS is enabled but this partition does not support FIPS",type:Lf}],type:Cl},{conditions:nC,rules:[{conditions:[tC],rules:[{conditions:[{[Fs]:zp,[js]:["aws",{[Fs]:$b,[js]:[MN,"name"]}]}],endpoint:{url:"https://cognito-idp.{Region}.amazonaws.com",properties:Pn,headers:Pn},type:Pa},{endpoint:{url:"https://cognito-idp.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:Pn,headers:Pn},type:Pa}],type:Cl},{error:"DualStack is enabled but this partition does not support DualStack",type:Lf}],type:Cl},{endpoint:{url:"https://cognito-idp.{Region}.{PartitionResult#dnsSuffix}",properties:Pn,headers:Pn},type:Pa}],type:Cl}],type:Cl},{error:"Invalid Configuration: Missing Region",type:Lf}]},a$=i$,l$=new $1({size:50,params:["Endpoint","Region","UseDualStack","UseFIPS"]}),c$=(r,e={})=>l$.get(r,()=>Y1(a$,{endpointParams:r,logger:e.logger}));ch.aws=Lb;const u$=r=>({apiVersion:"2016-04-18",base64Decoder:(r==null?void 0:r.base64Decoder)??Ym,base64Encoder:(r==null?void 0:r.base64Encoder)??Tm,disableHostPrefix:(r==null?void 0:r.disableHostPrefix)??!1,endpointProvider:(r==null?void 0:r.endpointProvider)??c$,extensions:(r==null?void 0:r.extensions)??[],httpAuthSchemeProvider:(r==null?void 0:r.httpAuthSchemeProvider)??TM,httpAuthSchemes:(r==null?void 0:r.httpAuthSchemes)??[{schemeId:"aws.auth#sigv4",identityProvider:e=>e.getIdentityProvider("aws.auth#sigv4"),signer:new Q1},{schemeId:"smithy.api#noAuth",identityProvider:e=>e.getIdentityProvider("smithy.api#noAuth")||(async()=>({})),signer:new D1}],logger:(r==null?void 0:r.logger)??new jb,protocol:(r==null?void 0:r.protocol)??fN,protocolSettings:(r==null?void 0:r.protocolSettings)??{defaultNamespace:"com.amazonaws.cognitoidentityprovider",xmlNamespace:"http://cognito-idp.amazonaws.com/doc/2016-04-18/",version:"2016-04-18",serviceTarget:"AWSCognitoIdentityProviderService"},serviceId:(r==null?void 0:r.serviceId)??"Cognito Identity Provider",urlParser:(r==null?void 0:r.urlParser)??Im,utf8Decoder:(r==null?void 0:r.utf8Decoder)??id,utf8Encoder:(r==null?void 0:r.utf8Encoder)??Uy}),d$=r=>{const e=FN(r),t=()=>e().then(cN),n=u$(r);return{...n,...r,runtime:"browser",defaultsMode:e,bodyLengthChecker:(r==null?void 0:r.bodyLengthChecker)??iN,credentialDefaultProvider:(r==null?void 0:r.credentialDefaultProvider)??(s=>()=>Promise.reject(new Error("Credential is missing"))),defaultUserAgentProvider:(r==null?void 0:r.defaultUserAgentProvider)??IN({serviceId:n.serviceId,clientVersion:FM.version}),maxAttempts:(r==null?void 0:r.maxAttempts)??Pm,region:(r==null?void 0:r.region)??PN("Region is missing"),requestHandler:zy.create((r==null?void 0:r.requestHandler)??t),retryMode:(r==null?void 0:r.retryMode)??(async()=>(await t()).retryMode||_N),sha256:(r==null?void 0:r.sha256)??AN,streamCollector:(r==null?void 0:r.streamCollector)??T1,useDualstackEndpoint:(r==null?void 0:r.useDualstackEndpoint)??(()=>Promise.resolve(pN)),useFipsEndpoint:(r==null?void 0:r.useFipsEndpoint)??(()=>Promise.resolve(mN))}},$N=r=>({setRegion(e){r.region=e},region(){return r.region}}),UN=r=>({region:r.region()}),f$=r=>{const e=r.httpAuthSchemes;let t=r.httpAuthSchemeProvider,n=r.credentials;return{setHttpAuthScheme(s){const i=e.findIndex(c=>c.schemeId===s.schemeId);i===-1?e.push(s):e.splice(i,1,s)},httpAuthSchemes(){return e},setHttpAuthSchemeProvider(s){t=s},httpAuthSchemeProvider(){return t},setCredentials(s){n=s},credentials(){return n}}},h$=r=>({httpAuthSchemes:r.httpAuthSchemes(),httpAuthSchemeProvider:r.httpAuthSchemeProvider(),credentials:r.credentials()}),p$=(r,e)=>{const t=Object.assign($N(r),uN(r),w1(r),f$(r));return e.forEach(n=>n.configure(t)),Object.assign(r,UN(t),dN(t),b1(t),h$(t))};class Ub extends aN{constructor(...[t]){const n=d$(t||{});super(n);H(this,"config");this.initConfig=n;const s=AM(n),i=M1(s),c=kN(i),d=vN(c),p=d,m=bN(p),g=RM(m),x=p$(g,(t==null?void 0:t.extensions)||[]);this.config=x,this.middlewareStack.use(I1(this.config)),this.middlewareStack.use(hN(this.config)),this.middlewareStack.use(NN(this.config)),this.middlewareStack.use(yN(this.config)),this.middlewareStack.use(_1(this.config)),this.middlewareStack.use(E1(this.config)),this.middlewareStack.use(S1(this.config)),this.middlewareStack.use(C1(this.config,{httpAuthSchemeParametersProvider:kM,identityProviderConfigProvider:async b=>new O1({"aws.auth#sigv4":b.credentials})})),this.middlewareStack.use(k1(this.config))}destroy(){super.destroy()}}class pt extends Yf{constructor(e){super(e),Object.setPrototypeOf(this,pt.prototype)}}class zb extends pt{constructor(t){super({name:"InternalErrorException",$fault:"server",...t});H(this,"name","InternalErrorException");H(this,"$fault","server");Object.setPrototypeOf(this,zb.prototype)}}class Hb extends pt{constructor(t){super({name:"InvalidParameterException",$fault:"client",...t});H(this,"name","InvalidParameterException");H(this,"$fault","client");H(this,"reasonCode");Object.setPrototypeOf(this,Hb.prototype),this.reasonCode=t.reasonCode}}class Bb extends pt{constructor(t){super({name:"NotAuthorizedException",$fault:"client",...t});H(this,"name","NotAuthorizedException");H(this,"$fault","client");Object.setPrototypeOf(this,Bb.prototype)}}class Gb extends pt{constructor(t){super({name:"ResourceNotFoundException",$fault:"client",...t});H(this,"name","ResourceNotFoundException");H(this,"$fault","client");Object.setPrototypeOf(this,Gb.prototype)}}class Wb extends pt{constructor(t){super({name:"TooManyRequestsException",$fault:"client",...t});H(this,"name","TooManyRequestsException");H(this,"$fault","client");Object.setPrototypeOf(this,Wb.prototype)}}class Vb extends pt{constructor(t){super({name:"UserImportInProgressException",$fault:"client",...t});H(this,"name","UserImportInProgressException");H(this,"$fault","client");Object.setPrototypeOf(this,Vb.prototype)}}class qb extends pt{constructor(t){super({name:"UserNotFoundException",$fault:"client",...t});H(this,"name","UserNotFoundException");H(this,"$fault","client");Object.setPrototypeOf(this,qb.prototype)}}class Kb extends pt{constructor(t){super({name:"InvalidLambdaResponseException",$fault:"client",...t});H(this,"name","InvalidLambdaResponseException");H(this,"$fault","client");Object.setPrototypeOf(this,Kb.prototype)}}class Yb extends pt{constructor(t){super({name:"LimitExceededException",$fault:"client",...t});H(this,"name","LimitExceededException");H(this,"$fault","client");Object.setPrototypeOf(this,Yb.prototype)}}class Jb extends pt{constructor(t){super({name:"TooManyFailedAttemptsException",$fault:"client",...t});H(this,"name","TooManyFailedAttemptsException");H(this,"$fault","client");Object.setPrototypeOf(this,Jb.prototype)}}class Xb extends pt{constructor(t){super({name:"UnexpectedLambdaException",$fault:"client",...t});H(this,"name","UnexpectedLambdaException");H(this,"$fault","client");Object.setPrototypeOf(this,Xb.prototype)}}class Qb extends pt{constructor(t){super({name:"UserLambdaValidationException",$fault:"client",...t});H(this,"name","UserLambdaValidationException");H(this,"$fault","client");Object.setPrototypeOf(this,Qb.prototype)}}class Zb extends pt{constructor(t){super({name:"CodeDeliveryFailureException",$fault:"client",...t});H(this,"name","CodeDeliveryFailureException");H(this,"$fault","client");Object.setPrototypeOf(this,Zb.prototype)}}class e_ extends pt{constructor(t){super({name:"InvalidPasswordException",$fault:"client",...t});H(this,"name","InvalidPasswordException");H(this,"$fault","client");Object.setPrototypeOf(this,e_.prototype)}}class t_ extends pt{constructor(t){super({name:"InvalidSmsRoleAccessPolicyException",$fault:"client",...t});H(this,"name","InvalidSmsRoleAccessPolicyException");H(this,"$fault","client");Object.setPrototypeOf(this,t_.prototype)}}class r_ extends pt{constructor(t){super({name:"InvalidSmsRoleTrustRelationshipException",$fault:"client",...t});H(this,"name","InvalidSmsRoleTrustRelationshipException");H(this,"$fault","client");Object.setPrototypeOf(this,r_.prototype)}}class n_ extends pt{constructor(t){super({name:"PreconditionNotMetException",$fault:"client",...t});H(this,"name","PreconditionNotMetException");H(this,"$fault","client");Object.setPrototypeOf(this,n_.prototype)}}class s_ extends pt{constructor(t){super({name:"UnsupportedUserStateException",$fault:"client",...t});H(this,"name","UnsupportedUserStateException");H(this,"$fault","client");Object.setPrototypeOf(this,s_.prototype)}}class o_ extends pt{constructor(t){super({name:"UsernameExistsException",$fault:"client",...t});H(this,"name","UsernameExistsException");H(this,"$fault","client");Object.setPrototypeOf(this,o_.prototype)}}class i_ extends pt{constructor(t){super({name:"AliasExistsException",$fault:"client",...t});H(this,"name","AliasExistsException");H(this,"$fault","client");Object.setPrototypeOf(this,i_.prototype)}}class a_ extends pt{constructor(t){super({name:"InvalidUserPoolConfigurationException",$fault:"client",...t});H(this,"name","InvalidUserPoolConfigurationException");H(this,"$fault","client");Object.setPrototypeOf(this,a_.prototype)}}class l_ extends pt{constructor(t){super({name:"InvalidEmailRoleAccessPolicyException",$fault:"client",...t});H(this,"name","InvalidEmailRoleAccessPolicyException");H(this,"$fault","client");Object.setPrototypeOf(this,l_.prototype)}}class c_ extends pt{constructor(t){super({name:"MFAMethodNotFoundException",$fault:"client",...t});H(this,"name","MFAMethodNotFoundException");H(this,"$fault","client");Object.setPrototypeOf(this,c_.prototype)}}class u_ extends pt{constructor(t){super({name:"PasswordResetRequiredException",$fault:"client",...t});H(this,"name","PasswordResetRequiredException");H(this,"$fault","client");Object.setPrototypeOf(this,u_.prototype)}}class d_ extends pt{constructor(t){super({name:"UnsupportedOperationException",$fault:"client",...t});H(this,"name","UnsupportedOperationException");H(this,"$fault","client");Object.setPrototypeOf(this,d_.prototype)}}class f_ extends pt{constructor(t){super({name:"UserNotConfirmedException",$fault:"client",...t});H(this,"name","UserNotConfirmedException");H(this,"$fault","client");Object.setPrototypeOf(this,f_.prototype)}}class h_ extends pt{constructor(t){super({name:"UserPoolAddOnNotEnabledException",$fault:"client",...t});H(this,"name","UserPoolAddOnNotEnabledException");H(this,"$fault","client");Object.setPrototypeOf(this,h_.prototype)}}class p_ extends pt{constructor(t){super({name:"CodeMismatchException",$fault:"client",...t});H(this,"name","CodeMismatchException");H(this,"$fault","client");Object.setPrototypeOf(this,p_.prototype)}}class m_ extends pt{constructor(t){super({name:"ExpiredCodeException",$fault:"client",...t});H(this,"name","ExpiredCodeException");H(this,"$fault","client");Object.setPrototypeOf(this,m_.prototype)}}class g_ extends pt{constructor(t){super({name:"PasswordHistoryPolicyViolationException",$fault:"client",...t});H(this,"name","PasswordHistoryPolicyViolationException");H(this,"$fault","client");Object.setPrototypeOf(this,g_.prototype)}}class v_ extends pt{constructor(t){super({name:"SoftwareTokenMFANotFoundException",$fault:"client",...t});H(this,"name","SoftwareTokenMFANotFoundException");H(this,"$fault","client");Object.setPrototypeOf(this,v_.prototype)}}class y_ extends pt{constructor(t){super({name:"ConcurrentModificationException",$fault:"client",...t});H(this,"name","ConcurrentModificationException");H(this,"$fault","client");Object.setPrototypeOf(this,y_.prototype)}}class x_ extends pt{constructor(t){super({name:"ForbiddenException",$fault:"client",...t});H(this,"name","ForbiddenException");H(this,"$fault","client");Object.setPrototypeOf(this,x_.prototype)}}class w_ extends pt{constructor(t){super({name:"WebAuthnChallengeNotFoundException",$fault:"client",...t});H(this,"name","WebAuthnChallengeNotFoundException");H(this,"$fault","client");Object.setPrototypeOf(this,w_.prototype)}}class b_ extends pt{constructor(t){super({name:"WebAuthnClientMismatchException",$fault:"client",...t});H(this,"name","WebAuthnClientMismatchException");H(this,"$fault","client");Object.setPrototypeOf(this,b_.prototype)}}class __ extends pt{constructor(t){super({name:"WebAuthnCredentialNotSupportedException",$fault:"client",...t});H(this,"name","WebAuthnCredentialNotSupportedException");H(this,"$fault","client");Object.setPrototypeOf(this,__.prototype)}}class E_ extends pt{constructor(t){super({name:"WebAuthnNotEnabledException",$fault:"client",...t});H(this,"name","WebAuthnNotEnabledException");H(this,"$fault","client");Object.setPrototypeOf(this,E_.prototype)}}class S_ extends pt{constructor(t){super({name:"WebAuthnOriginNotAllowedException",$fault:"client",...t});H(this,"name","WebAuthnOriginNotAllowedException");H(this,"$fault","client");Object.setPrototypeOf(this,S_.prototype)}}class C_ extends pt{constructor(t){super({name:"WebAuthnRelyingPartyMismatchException",$fault:"client",...t});H(this,"name","WebAuthnRelyingPartyMismatchException");H(this,"$fault","client");Object.setPrototypeOf(this,C_.prototype)}}class k_ extends pt{constructor(t){super({name:"DeviceKeyExistsException",$fault:"client",...t});H(this,"name","DeviceKeyExistsException");H(this,"$fault","client");Object.setPrototypeOf(this,k_.prototype)}}class N_ extends pt{constructor(t){super({name:"GroupExistsException",$fault:"client",...t});H(this,"name","GroupExistsException");H(this,"$fault","client");Object.setPrototypeOf(this,N_.prototype)}}class T_ extends pt{constructor(t){super({name:"DuplicateProviderException",$fault:"client",...t});H(this,"name","DuplicateProviderException");H(this,"$fault","client");Object.setPrototypeOf(this,T_.prototype)}}class R_ extends pt{constructor(t){super({name:"ManagedLoginBrandingExistsException",$fault:"client",...t});H(this,"name","ManagedLoginBrandingExistsException");H(this,"$fault","client");Object.setPrototypeOf(this,R_.prototype)}}class A_ extends pt{constructor(t){super({name:"TermsExistsException",$fault:"client",...t});H(this,"name","TermsExistsException");H(this,"$fault","client");Object.setPrototypeOf(this,A_.prototype)}}class I_ extends pt{constructor(t){super({name:"FeatureUnavailableInTierException",$fault:"client",...t});H(this,"name","FeatureUnavailableInTierException");H(this,"$fault","client");Object.setPrototypeOf(this,I_.prototype)}}class P_ extends pt{constructor(t){super({name:"TierChangeNotAllowedException",$fault:"client",...t});H(this,"name","TierChangeNotAllowedException");H(this,"$fault","client");Object.setPrototypeOf(this,P_.prototype)}}class F_ extends pt{constructor(t){super({name:"UserPoolTaggingException",$fault:"client",...t});H(this,"name","UserPoolTaggingException");H(this,"$fault","client");Object.setPrototypeOf(this,F_.prototype)}}class j_ extends pt{constructor(t){super({name:"InvalidOAuthFlowException",$fault:"client",...t});H(this,"name","InvalidOAuthFlowException");H(this,"$fault","client");Object.setPrototypeOf(this,j_.prototype)}}class O_ extends pt{constructor(t){super({name:"ScopeDoesNotExistException",$fault:"client",...t});H(this,"name","ScopeDoesNotExistException");H(this,"$fault","client");Object.setPrototypeOf(this,O_.prototype)}}class D_ extends pt{constructor(t){super({name:"UnsupportedIdentityProviderException",$fault:"client",...t});H(this,"name","UnsupportedIdentityProviderException");H(this,"$fault","client");Object.setPrototypeOf(this,D_.prototype)}}class L_ extends pt{constructor(t){super({name:"RefreshTokenReuseException",$fault:"client",...t});H(this,"name","RefreshTokenReuseException");H(this,"$fault","client");Object.setPrototypeOf(this,L_.prototype)}}class M_ extends pt{constructor(t){super({name:"UnauthorizedException",$fault:"client",...t});H(this,"name","UnauthorizedException");H(this,"$fault","client");Object.setPrototypeOf(this,M_.prototype)}}class $_ extends pt{constructor(t){super({name:"UnsupportedTokenTypeException",$fault:"client",...t});H(this,"name","UnsupportedTokenTypeException");H(this,"$fault","client");Object.setPrototypeOf(this,$_.prototype)}}class U_ extends pt{constructor(t){super({name:"WebAuthnConfigurationMissingException",$fault:"client",...t});H(this,"name","WebAuthnConfigurationMissingException");H(this,"$fault","client");Object.setPrototypeOf(this,U_.prototype)}}class z_ extends pt{constructor(t){super({name:"EnableSoftwareTokenMFAException",$fault:"client",...t});H(this,"name","EnableSoftwareTokenMFAException");H(this,"$fault","client");Object.setPrototypeOf(this,z_.prototype)}}const m$="AvailableChallenges",g$="AliasExistsException",v$="AnalyticsEndpointId",y$="AuthFlow",x$="AnalyticsMetadata",w$="AnalyticsMetadataType",b$="AuthParameters",_$="AuthParametersType",E$="AuthenticationResult",S$="AuthenticationResultType",C$="AccessToken",k$="CodeDeliveryFailureException",N$="ClientId",T$="ClientIdType",R$="ClientMetadata",A$="CodeMismatchException",I$="ConcurrentModificationException",P$="ChallengeName",F$="ChallengeParameters",j$="DeviceGroupKey",O$="DeviceKey",D$="DeviceKeyExistsException",L$="DuplicateProviderException",M$="ExpiredCodeException",$$="EncodedData",U$="ExpiresIn",z$="EnableSoftwareTokenMFAException",H$="ForbiddenException",B$="FeatureUnavailableInTierException",G$="GroupExistsException",W$="IpAddress",V$="InitiateAuthRequest",q$="InitiateAuthResponse",K$="InitiateAuth",Y$="InternalErrorException",J$="InvalidEmailRoleAccessPolicyException",X$="InvalidLambdaResponseException",Q$="InvalidOAuthFlowException",Z$="InvalidParameterException",e4="InvalidPasswordException",t4="InvalidSmsRoleAccessPolicyException",r4="InvalidSmsRoleTrustRelationshipException",n4="IdToken",s4="InvalidUserPoolConfigurationException",o4="LimitExceededException",i4="MFAMethodNotFoundException",a4="ManagedLoginBrandingExistsException",l4="NotAuthorizedException",c4="NewDeviceMetadata",u4="NewDeviceMetadataType",d4="PasswordHistoryPolicyViolationException",f4="PreconditionNotMetException",h4="PasswordResetRequiredException",p4="ResourceNotFoundException",m4="RefreshToken",g4="RefreshTokenReuseException",zN="Session",v4="ScopeDoesNotExistException",y4="SessionType",x4="SoftwareTokenMFANotFoundException",w4="TierChangeNotAllowedException",b4="TermsExistsException",_4="TooManyFailedAttemptsException",E4="TooManyRequestsException",S4="TokenModelType",C4="TokenType",k4="UserContextDataType",N4="UserContextData",T4="UnauthorizedException",R4="UsernameExistsException",A4="UserImportInProgressException",I4="UnsupportedIdentityProviderException",P4="UnexpectedLambdaException",F4="UserLambdaValidationException",j4="UserNotConfirmedException",O4="UserNotFoundException",D4="UnsupportedOperationException",L4="UserPoolAddOnNotEnabledException",M4="UserPoolTaggingException",$4="UnsupportedTokenTypeException",U4="UnsupportedUserStateException",z4="WebAuthnClientMismatchException",H4="WebAuthnConfigurationMissingException",B4="WebAuthnChallengeNotFoundException",G4="WebAuthnCredentialNotSupportedException",W4="WebAuthnNotEnabledException",V4="WebAuthnOriginNotAllowedException",q4="WebAuthnRelyingPartyMismatchException",Ct="client",wt="error",kt="httpError",bt="message",K4="reasonCode",Y4="server",HN="smithy.ts.sdk.synthetic.com.amazonaws.cognitoidentityprovider",ke="com.amazonaws.cognitoidentityprovider";var J4=[0,ke,T$,8,0],BN=[0,ke,y4,8,0],kx=[0,ke,S4,8,0],X4=[-3,ke,g$,{[wt]:Ct,[kt]:400},[bt],[0]];ut.for(ke).registerError(X4,i_);var Q4=[3,ke,w$,0,[v$],[0]],Z4=[3,ke,S$,0,[C$,U$,C4,m4,n4,c4],[[()=>kx,0],1,0,[()=>kx,0],[()=>kx,0],()=>S3]],e3=[-3,ke,k$,{[wt]:Ct,[kt]:400},[bt],[0]];ut.for(ke).registerError(e3,Zb);var t3=[-3,ke,A$,{[wt]:Ct,[kt]:400},[bt],[0]];ut.for(ke).registerError(t3,p_);var r3=[-3,ke,I$,{[wt]:Ct,[kt]:400},[bt],[0]];ut.for(ke).registerError(r3,y_);var n3=[-3,ke,D$,{[wt]:Ct,[kt]:400},[bt],[0]];ut.for(ke).registerError(n3,k_);var s3=[-3,ke,L$,{[wt]:Ct,[kt]:400},[bt],[0]];ut.for(ke).registerError(s3,T_);var o3=[-3,ke,z$,{[wt]:Ct,[kt]:400},[bt],[0]];ut.for(ke).registerError(o3,z_);var i3=[-3,ke,M$,{[wt]:Ct,[kt]:400},[bt],[0]];ut.for(ke).registerError(i3,m_);var a3=[-3,ke,B$,{[wt]:Ct,[kt]:403},[bt],[0]];ut.for(ke).registerError(a3,I_);var l3=[-3,ke,H$,{[wt]:Ct,[kt]:403},[bt],[0]];ut.for(ke).registerError(l3,x_);var c3=[-3,ke,G$,{[wt]:Ct,[kt]:400},[bt],[0]];ut.for(ke).registerError(c3,N_);var u3=[3,ke,V$,0,[y$,N$,b$,R$,x$,N4,zN],[0,[()=>J4,0],[()=>oU,0],128,()=>Q4,[()=>B3,0],[()=>BN,0]],2],d3=[3,ke,q$,0,[P$,zN,F$,E$,m$],[0,[()=>BN,0],128,[()=>Z4,0],64]],f3=[-3,ke,Y$,{[wt]:Y4},[bt],[0]];ut.for(ke).registerError(f3,zb);var h3=[-3,ke,J$,{[wt]:Ct,[kt]:400},[bt],[0]];ut.for(ke).registerError(h3,l_);var p3=[-3,ke,X$,{[wt]:Ct,[kt]:400},[bt],[0]];ut.for(ke).registerError(p3,Kb);var m3=[-3,ke,Q$,{[wt]:Ct,[kt]:400},[bt],[0]];ut.for(ke).registerError(m3,j_);var g3=[-3,ke,Z$,{[wt]:Ct,[kt]:400},[bt,K4],[0,0]];ut.for(ke).registerError(g3,Hb);var v3=[-3,ke,e4,{[wt]:Ct,[kt]:400},[bt],[0]];ut.for(ke).registerError(v3,e_);var y3=[-3,ke,t4,{[wt]:Ct,[kt]:400},[bt],[0]];ut.for(ke).registerError(y3,t_);var x3=[-3,ke,r4,{[wt]:Ct,[kt]:400},[bt],[0]];ut.for(ke).registerError(x3,r_);var w3=[-3,ke,s4,{[wt]:Ct,[kt]:400},[bt],[0]];ut.for(ke).registerError(w3,a_);var b3=[-3,ke,o4,{[wt]:Ct,[kt]:400},[bt],[0]];ut.for(ke).registerError(b3,Yb);var _3=[-3,ke,a4,{[wt]:Ct,[kt]:400},[bt],[0]];ut.for(ke).registerError(_3,R_);var E3=[-3,ke,i4,{[wt]:Ct,[kt]:400},[bt],[0]];ut.for(ke).registerError(E3,c_);var S3=[3,ke,u4,0,[O$,j$],[0,0]],C3=[-3,ke,l4,{[wt]:Ct,[kt]:403},[bt],[0]];ut.for(ke).registerError(C3,Bb);var k3=[-3,ke,d4,{[wt]:Ct,[kt]:400},[bt],[0]];ut.for(ke).registerError(k3,g_);var N3=[-3,ke,h4,{[wt]:Ct,[kt]:400},[bt],[0]];ut.for(ke).registerError(N3,u_);var T3=[-3,ke,f4,{[wt]:Ct,[kt]:400},[bt],[0]];ut.for(ke).registerError(T3,n_);var R3=[-3,ke,g4,{[wt]:Ct,[kt]:400},[bt],[0]];ut.for(ke).registerError(R3,L_);var A3=[-3,ke,p4,{[wt]:Ct,[kt]:404},[bt],[0]];ut.for(ke).registerError(A3,Gb);var I3=[-3,ke,v4,{[wt]:Ct,[kt]:400},[bt],[0]];ut.for(ke).registerError(I3,O_);var P3=[-3,ke,x4,{[wt]:Ct,[kt]:400},[bt],[0]];ut.for(ke).registerError(P3,v_);var F3=[-3,ke,b4,{[wt]:Ct,[kt]:400},[bt],[0]];ut.for(ke).registerError(F3,A_);var j3=[-3,ke,w4,{[wt]:Ct,[kt]:403},[bt],[0]];ut.for(ke).registerError(j3,P_);var O3=[-3,ke,_4,{[wt]:Ct,[kt]:400},[bt],[0]];ut.for(ke).registerError(O3,Jb);var D3=[-3,ke,E4,{[wt]:Ct,[kt]:429},[bt],[0]];ut.for(ke).registerError(D3,Wb);var L3=[-3,ke,T4,{[wt]:Ct,[kt]:401},[bt],[0]];ut.for(ke).registerError(L3,M_);var M3=[-3,ke,P4,{[wt]:Ct,[kt]:400},[bt],[0]];ut.for(ke).registerError(M3,Xb);var $3=[-3,ke,I4,{[wt]:Ct,[kt]:400},[bt],[0]];ut.for(ke).registerError($3,D_);var U3=[-3,ke,D4,{[wt]:Ct,[kt]:400},[bt],[0]];ut.for(ke).registerError(U3,d_);var z3=[-3,ke,$4,{[wt]:Ct,[kt]:400},[bt],[0]];ut.for(ke).registerError(z3,$_);var H3=[-3,ke,U4,{[wt]:Ct,[kt]:400},[bt],[0]];ut.for(ke).registerError(H3,s_);var B3=[3,ke,k4,8,[W$,$$],[0,0]],G3=[-3,ke,A4,{[wt]:Ct,[kt]:400},[bt],[0]];ut.for(ke).registerError(G3,Vb);var W3=[-3,ke,F4,{[wt]:Ct,[kt]:400},[bt],[0]];ut.for(ke).registerError(W3,Qb);var V3=[-3,ke,R4,{[wt]:Ct,[kt]:400},[bt],[0]];ut.for(ke).registerError(V3,o_);var q3=[-3,ke,j4,{[wt]:Ct,[kt]:400},[bt],[0]];ut.for(ke).registerError(q3,f_);var K3=[-3,ke,O4,{[wt]:Ct,[kt]:404},[bt],[0]];ut.for(ke).registerError(K3,qb);var Y3=[-3,ke,L4,{[wt]:Ct,[kt]:400},[bt],[0]];ut.for(ke).registerError(Y3,h_);var J3=[-3,ke,M4,{[wt]:Ct,[kt]:400},[bt],[0]];ut.for(ke).registerError(J3,F_);var X3=[-3,ke,B4,{[wt]:Ct,[kt]:400},[bt],[0]];ut.for(ke).registerError(X3,w_);var Q3=[-3,ke,z4,{[wt]:Ct,[kt]:400},[bt],[0]];ut.for(ke).registerError(Q3,b_);var Z3=[-3,ke,H4,{[wt]:Ct,[kt]:400},[bt],[0]];ut.for(ke).registerError(Z3,U_);var eU=[-3,ke,G4,{[wt]:Ct,[kt]:400},[bt],[0]];ut.for(ke).registerError(eU,__);var tU=[-3,ke,W4,{[wt]:Ct,[kt]:400},[bt],[0]];ut.for(ke).registerError(tU,E_);var rU=[-3,ke,V4,{[wt]:Ct,[kt]:400},[bt],[0]];ut.for(ke).registerError(rU,S_);var nU=[-3,ke,q4,{[wt]:Ct,[kt]:400},[bt],[0]];ut.for(ke).registerError(nU,C_);var sU=[-3,HN,"CognitoIdentityProviderServiceException",0,[],[]];ut.for(HN).registerError(sU,pt);var oU=[2,ke,_$,8,0,0],iU=[9,ke,K$,0,()=>u3,()=>d3];class H_ extends lN.classBuilder().ep(IM).m(function(e,t,n,s){return[eM(n,e.getEndpointParameterInstructions())]}).s("AWSCognitoIdentityProviderService","InitiateAuth",{}).n("CognitoIdentityProviderClient","InitiateAuthCommand").sc(iU).build(){}const aU="0.0.0",GN="staging",lU="outlook-addin",cU="staging-outlook-app-id",uU="https://candle-ai.github.io/FileServer_Staging/dist-outlook-addin/manifest.xml",dU="https://appsforoffice.microsoft.com/lib/1/hosted/office.js",fU="https://candle-ai.github.io/FileServer_Staging/dist-outlook-addin/src/apps/outlook-addin/auth-dialog-pkce.html",hU=!0,Fw="https://candle-ai.github.io/FileServer_Staging/dist-outlook-addin/src/apps/outlook-addin/auth-dialog-pkce.html?callback=true",pU="https://candle-ai.github.io/FileServer_Staging/dist-outlook-addin/options",B_="https://candle-ai.github.io/FileServer_Staging/dist-outlook-addin/auth/gmail/callback",Cr="https://vixpby8nfc.execute-api.us-east-1.amazonaws.com/prod",mU="https://vixpby8nfc.execute-api.us-east-1.amazonaws.com/prod",WN="https://candle-ai.github.io/FileServer_Staging/dist-outlook-addin",VN="https://candle-565393026129-us-east-1.auth.us-east-1.amazoncognito.com",gh="22pj09tqppmia7sh207a3ufaq9",qN=r=>`${VN}/login?client_id=${gh}&response_type=code&scope=email+openid+profile&redirect_uri=${r}`,KN="https://candle-565393026129-us-east-1.auth.us-east-1.amazoncognito.com/oauth2/token",gU="https://candle-565393026129-us-east-1.auth.us-east-1.amazoncognito.com/oauth2/userInfo",eh="https://app.staging.trycandle.ai",YN="https://forms.gle/QFFz1rbFVmwJ96At6",vU="00db376f-0fb4-48b3-8844-c2cb1ba88920",JN="https://accounts.google.com/o/oauth2",XN="74023389454-6cal15ik3pu0p55rm5mr3go8kgro0gv8.apps.googleusercontent.com",G_=r=>`${JN}/auth?client_id=${XN}&redirect_uri=${r}&response_type=code&scope=https://www.googleapis.com/auth/gmail.readonly&access_type=offline&prompt=consent`,W_="https://vixpby8nfc.execute-api.us-east-1.amazonaws.com/prod/oauth/login/",jw="phc_RZCAfsv2zW9fB7Pdb8b50InaGRQJl7f8DPbD1lkxmZP",QN="https://us.i.posthog.com",yU="outlook",xU="staging",ZN={buildTime:"2026-02-20T10:04:54.403Z",environment:"staging",configSource:"outlook_config.tsx",authMethod:"PKCE"},wU=Object.freeze(Object.defineProperty({__proto__:null,API_BASE_URL:mU,API_SERVER:Cr,AUTH_DIALOG_URL:fU,AWS_CLIENT_ID:gh,AWS_COGNITO_DOMAIN:VN,AWS_LOGIN_PAGE_URI:qN,AWS_OAUTH_TOKEN_URI:KN,AWS_USERINFO_URI:gU,BASE_DOMAIN:WN,BUILD_ENV:xU,CONFIG_VERIFICATION:ZN,FEEDBACK_FORM:YN,GMAIL_INTEGRATION_CLIENT_ID:XN,GMAIL_INTEGRATION_DOMAIN:JN,GMAIL_INTEGRATION_PAGE_URI:G_,GMAIL_INTEGRATION_REDIRECT_URI:B_,INTEGRATION_AUTH_URL_PREFIX:W_,LOGIN_REDIRECT_URI:Fw,MANIFEST_URL:uU,MODE:GN,OFFICE_JS_CDN:dU,OUTLOOK_APP_ID:cU,OUTLOOK_CLIENT_ID:vU,PLATFORM:yU,POSTHOG_HOST:QN,POSTHOG_KEY:jw,POST_LOGIN_REDIRECT_URI:pU,SETTINGS_PAGE_URL:eh,TYPE:lU,USE_PKCE_AUTH:hU,VERSION:aU},Symbol.toStringTag,{value:"Module"})),td="src/platforms/helpers/chromeAuthUtils.ts",V_=r=>new Promise(e=>{chrome.storage.local.set({token:JSON.stringify(r)},()=>{e()})}),bU=()=>new Promise(r=>{chrome.storage.local.get("token",e=>{const t=e.token?JSON.parse(e.token):null;r(t)})}),_U=()=>new Promise(r=>{chrome.storage.local.set({token:null},()=>{r()})});async function EU(r,e,t){const n="refreshAuthToken",s=new Ub({region:"us-east-1"});try{t.info("Preparing for REFRESH_TOKEN_AUTH",{sourceFile:td,functionName:n}),t.debug("AuthFlow: REFRESH_TOKEN_AUTH",{sourceFile:td,functionName:n}),t.info("Refreshing auth token...",{sourceFile:td,functionName:n});const i=new H_({ClientId:gh,AuthFlow:"REFRESH_TOKEN_AUTH",AuthParameters:{REFRESH_TOKEN:r.refresh_token}}),d=(await s.send(i)).AuthenticationResult;if(!d)throw new Error("AuthenticationResult is missing in the response.");const{IdToken:p,AccessToken:m,RefreshToken:g,ExpiresIn:x,TokenType:b}=d;if(!p||!m||!x||!b)throw new Error("Missing required fields in AuthenticationResult.");const E={id_token:p,access_token:m,refresh_token:g||r.refresh_token,expires_in:x,token_type:b,fetched_at:e};return await V_(E),E}catch(i){throw t.error("Error refreshing auth token",i,{sourceFile:td,functionName:n}),new Error("Failed to refresh authentication token.")}}async function SU(r){const e="handleLoginFlow";try{r.info("Starting OAuth flow in popup...",{sourceFile:td,functionName:e});const t=qN(Fw);r.info("Auth URL",{sourceFile:td,functionName:e,authUrl:t});const n=await chrome.identity.launchWebAuthFlow({url:t,interactive:!0});if(!n)throw new Error("Authentication was cancelled or failed");const i=new URL(n).searchParams.get("code");if(!i)throw new Error("No authorization code received");const c={grant_type:"authorization_code",code:i,redirect_uri:Fw,client_id:gh},d=await fetch(KN,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(c).toString()});if(!d.ok)throw new Error(`Token exchange failed: ${d.statusText}`);const p=await d.json();if(!XO(p))throw new Error("Invalid token response format");const m={...p,fetched_at:Math.floor(Date.now())};return await V_(m),{success:!0}}catch(t){return r.error("Authentication failed",t,{sourceFile:td,functionName:e}),{success:!1,error:t instanceof Error?t.message:"Unknown error occurred"}}}class CU{constructor(e){H(this,"logger");H(this,"authListeners",new Set);this.logger=e}async login(){try{const e=await SU(this.logger);if(!e.success)throw new Error(e.error||"Login failed");const t=await this.getToken();if(!t)throw new Error("Token not found after login");return this.notifyAuthListeners(!0),t}catch(e){throw this.logger.error("Login failed",e,{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"login"}),e}}async logout(){var e;try{if(await this.deleteToken(),this.notifyAuthListeners(!1),(e=chrome==null?void 0:chrome.runtime)!=null&&e.sendMessage)try{await chrome.runtime.sendMessage({type:"USER_LOGGED_OUT"})}catch(t){this.logger.warn("Could not send logout message",{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"logout",error:t})}}catch(t){throw this.logger.error("Logout failed",t,{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"logout"}),t}}async getToken(){try{return await bU()}catch(e){return this.logger.error("Error getting auth token",e,{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"getToken"}),null}}async saveToken(e){try{const t={...e,fetched_at:Math.floor(Date.now())};await V_(t)}catch(t){throw this.logger.error("Error saving auth token",t,{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"saveToken"}),t}}async deleteToken(){try{await _U()}catch(e){throw this.logger.error("Error deleting auth token",e,{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"deleteToken"}),e}}isTokenValid(e){if(!e||!e.expires_in)return!1;const t=e;return t.fetched_at?Math.floor(Date.now())+6e4-t.fetched_at<t.expires_in*1e3:!1}async refreshToken(e){try{const t=e,n=Math.floor(Date.now())+6e4;return await EU(t,n,this.logger)}catch(t){throw this.logger.error("Error refreshing auth token",t,{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"refreshToken"}),t}}async isAuthenticated(){try{const e=await this.getToken();if(this.logger.debug("Checking authentication status",{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"isAuthenticated",token:e}),!e)return this.logger.debug("No token found - user is not authenticated",{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"isAuthenticated"}),!1;const t=this.isTokenValid(e);if(this.logger.debug("Authentication status checked",{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"isAuthenticated",isValid:t,token:e}),!t){this.logger.debug("Token is not valid - user is not authenticated",{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"isAuthenticated"});const n=await this.refreshToken(e);return this.logger.debug("Refreshed token",{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"isAuthenticated",refreshedToken:n}),this.isTokenValid(n)}return this.logger.debug("Token is valid - user is authenticated",{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"isAuthenticated"}),!0}catch(e){return this.logger.error("Error checking authentication status",e,{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"isAuthenticated"}),!1}}onAuthStateChanged(e){this.authListeners.add(e)}removeAuthStateListener(e){this.authListeners.delete(e)}notifyAuthListeners(e){this.logger.info("Notifying auth listeners",{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"notifyAuthListeners",isAuthenticated:e}),this.authListeners.forEach(t=>{try{t(e)}catch(n){this.logger.error("Error in auth state callback",n,{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"notifyAuthListeners"})}})}}class kU{constructor(e){H(this,"logger");H(this,"messageListeners",new Set);this.logger=e,this.setupMessageListeners()}setupMessageListeners(){var e;(e=chrome==null?void 0:chrome.runtime)!=null&&e.onMessage&&chrome.runtime.onMessage.addListener((t,n,s)=>{this.messageListeners.forEach(i=>{try{i(t)}catch(c){this.logger.error("Error in message callback",c,{sourceFile:"src/platforms/chrome/ChromeMessagingProvider.ts",sourceFunction:"setupMessageListeners"})}})})}async sendMessage(e){return new Promise((t,n)=>{var s;if(!((s=chrome==null?void 0:chrome.runtime)!=null&&s.sendMessage)){n(new Error("Chrome runtime not available"));return}chrome.runtime.sendMessage(e,i=>{var c;chrome.runtime.lastError?(this.logger.error("Error sending message",chrome.runtime.lastError,{sourceFile:"src/platforms/chrome/ChromeMessagingProvider.ts",sourceFunction:"sendMessage",message:e}),n(new Error(((c=chrome.runtime.lastError)==null?void 0:c.message)||"Unknown error"))):t(i)})})}onMessage(e){var n;const t=s=>{e(s)};this.messageListeners.add(t),(n=chrome==null?void 0:chrome.runtime)!=null&&n.onMessage&&chrome.runtime.onMessage.addListener(t)}removeMessageListener(e){this.messageListeners.forEach(t=>{var n;(n=chrome==null?void 0:chrome.runtime)!=null&&n.onMessage&&chrome.runtime.onMessage.removeListener(t)}),this.messageListeners.clear()}async sendTabMessage(e,t){return new Promise((n,s)=>{var i;if(!((i=chrome==null?void 0:chrome.tabs)!=null&&i.sendMessage)){s(new Error("Chrome tabs API not available"));return}chrome.tabs.sendMessage(e,t,c=>{var d;chrome.runtime.lastError?(this.logger.error("Error sending tab message",chrome.runtime.lastError,{sourceFile:"src/platforms/chrome/ChromeMessagingProvider.ts",sourceFunction:"sendTabMessage",message:t}),s(new Error(((d=chrome.runtime.lastError)==null?void 0:d.message)||"Unknown error"))):n(c)})})}}class NU{constructor(e){H(this,"logger");H(this,"eventListeners",new Map);H(this,"isInitialized",!1);this.logger=e}async initialize(){if(this.isInitialized){this.logger.info("Chrome platform already initialized",{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"initialize"});return}try{this.logger.info("Initializing Chrome platform...",{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"initialize"}),this.setupChromeEventListeners(),this.isInitialized=!0,this.logger.info("Chrome platform initialized successfully",{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"initialize"})}catch(e){throw this.logger.error("Failed to initialize Chrome platform",e,{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"initialize"}),e}}async cleanup(){try{this.logger.info("Cleaning up Chrome platform...",{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"cleanup"}),this.eventListeners.clear(),this.isInitialized=!1,this.logger.info("Chrome platform cleanup completed",{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"cleanup"})}catch(e){throw this.logger.error("Failed to cleanup Chrome platform",e,{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"cleanup"}),e}}async closeWindow(){try{typeof chrome<"u"&&chrome.sidePanel&&window.close(),this.logger.debug("Window close requested",{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"closeWindow"})}catch(e){throw this.logger.error("Failed to close window",e,{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"closeWindow"}),e}}onPlatformEvent(e,t){var n,s;switch(e){case"runtime.onInstalled":(n=chrome==null?void 0:chrome.runtime)!=null&&n.onInstalled&&chrome.runtime.onInstalled.addListener(t);break;case"runtime.onStartup":(s=chrome==null?void 0:chrome.runtime)!=null&&s.onStartup&&chrome.runtime.onStartup.addListener(t);break;default:this.logger.warn("Unknown platform event",{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"onPlatformEvent",event:e})}}setupChromeEventListeners(){var e,t,n;(e=chrome==null?void 0:chrome.runtime)!=null&&e.onStartup&&chrome.runtime.onStartup.addListener(()=>{this.emitPlatformEvent("startup")}),(t=chrome==null?void 0:chrome.runtime)!=null&&t.onSuspend&&chrome.runtime.onSuspend.addListener(()=>{this.emitPlatformEvent("suspend")}),(n=chrome==null?void 0:chrome.runtime)!=null&&n.onInstalled&&chrome.runtime.onInstalled.addListener(s=>{this.emitPlatformEvent("installed",s)})}emitPlatformEvent(e,...t){const n=this.eventListeners.get(e);n&&n.forEach(s=>{try{s(...t)}catch(i){this.logger.error(`Error in platform event callback for ${e}`,i,{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"emitPlatformEvent",event:e})}})}handleExtensionMessage(e,t,n){return this.logger.debug("Extension message received",{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"handleExtensionMessage",message:e,sender:t}),!0}handleContextMenuClick(e,t){this.logger.debug("Context menu clicked",{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"handleContextMenuClick",info:e,tab:t})}}const Ri=async r=>{try{return(await Vn.createServices()).storage}catch(e){return r.warn("Platform detection failed, falling back to Chrome storage",{sourceFile:"src/shared/lib/utils/storageUtils.tsx",error:e}),null}},TU=async r=>{const e=await Ri(r);e&&await e.clearLocal()},RU=async(r,e)=>{try{const t=await Vn.createServices();if(Vn.getCurrentPlatform()==="outlook"){r.debug("Token saving handled by OutlookAuthProvider",{sourceFile:"src/shared/lib/utils/storageUtils.tsx",sourceFunction:"saveAuthTokenPlatform"});return}const n=t.storage;n&&await n.setLocalItem("token",e)}catch(t){throw r.error("Failed to save auth token",t,{sourceFile:"src/shared/lib/utils/storageUtils.tsx",sourceFunction:"saveAuthTokenPlatform"}),t}},Om=async r=>{try{const e=await Vn.createServices();if(Vn.getCurrentPlatform()==="outlook"){const n=await e.auth.getToken();return n?(r.info("Auth token retrieved from auth provider",{sourceFile:"src/shared/lib/utils/storageUtils.tsx",sourceFunction:"getAuthTokenPlatform",authToken:n}),n):null}const t=e.storage;return t?await t.getLocalItem("token"):null}catch(e){return r.error("Failed to get auth token",e,{sourceFile:"src/shared/lib/utils/storageUtils.tsx",sourceFunction:"getAuthTokenPlatform"}),null}},Gy=async r=>{try{const e=await Vn.createServices();if(Vn.getCurrentPlatform()==="outlook"){await e.auth.logout();return}const t=e.storage;t&&await t.removeLocalItem("token")}catch(e){r.error("Failed to delete auth token",e,{sourceFile:"src/shared/lib/utils/storageUtils.tsx",sourceFunction:"deleteAuthTokenPlatform"})}},eT=async(r,e)=>{const t=await Ri(r);if(t){const n={...e};(!n.id||n.id==="")&&(n.id=String(Date.now())),await t.setLocalItem("configuration",n)}},ly=async r=>{const e=await Ri(r);return e?await e.getLocalItem("configuration")||{id:"",preferences:{theme:"",notificationsEnabled:!1,language:""},profile:{name:"",organization:"",role:""},templateConfiguration:{tags:[],fieldSubstitutions:{}},integrations:[]}:{id:"",preferences:{theme:"",notificationsEnabled:!1,language:""},profile:{name:"",organization:"",role:""},templateConfiguration:{tags:[],fieldSubstitutions:{}},integrations:[]}},AU=async(r,e)=>{const t=await Ri(r);t&&await t.setLocalItem("emailTemplates",e)},tT=async r=>{const e=await Ri(r);return e?await e.getLocalItem("emailTemplates")||[]:[]},Xm=async(r,e)=>{const t=await Ri(r);t&&await t.setLocalItem("integrations",e)},Qm=async r=>{const e=await Ri(r);return e?await e.getLocalItem("integrations")||[]:[]},IU=async(r,e)=>{const t=await Ri(r);t&&await t.setLocalItem("orgTemplates",e)},rT=async r=>{const e=await Ri(r);return e?await e.getLocalItem("orgTemplates")||[]:[]},PU=async(r,e)=>{const t=await Ri(r);if(t){const n=new Date().toISOString();await t.setLocalItem("gmailConnectionStatus",e),await t.setLocalItem("gmailConnectionStatusTimestamp",n),r.debug("Saved Gmail connection status to storage",{sourceFile:"src/shared/lib/utils/storageUtils.tsx",isConnected:e,timestamp:n})}},FU=async r=>{const e=await Ri(r);if(e){const t=await e.getLocalItem("gmailConnectionStatus"),n=await e.getLocalItem("gmailConnectionStatusTimestamp");return r.debug("Retrieved Gmail connection status from storage",{sourceFile:"src/shared/lib/utils/storageUtils.tsx",isConnected:t,timestamp:n}),{isConnected:t,timestamp:n}}return{isConnected:null,timestamp:null}},nT=async r=>{const e=await Ri(r);e&&(await e.removeLocalItem("clients"),await e.removeLocalItem("integrations"))},Zs="src/lib/utils/authUtils.tsx";async function sT(r,e,t,n){const s="withLock";if(r.current)return n.info(`${t} already in progress, waiting for completion...`,{sourceFile:Zs,functionName:s}),await r.current;r.current=e();try{return await r.current}finally{r.current=null}}const jU={current:null};async function Ow(r){return sT(jU,()=>OU(r),"Token validation",r)}async function OU(r){const e="performTokenValidation";let t=await Om(r);if(!t)throw new Error("No authentication token found.");const n=Math.floor(Date.now()),s=t.expires_in*1e3+(t.fetched_at||0);if(r.info("Token expiry check",{sourceFile:Zs,functionName:e,tokenExpiry:new Date(s).toISOString(),currentTime:new Date(n).toISOString(),timeUntilExpiry:s-n}),s-n<3e5)try{r.info("Token expired. Refreshing...",{sourceFile:Zs,functionName:e}),t=await oT(t,n,r),r.info("New token received",{sourceFile:Zs,functionName:e})}catch(i){throw r.error("Token refresh failed",i,{sourceFile:Zs,functionName:e}),await Gy(r),new Error("Unauthorized: Failed to refresh token.")}return t}const Nx=20,DU=500;function LU(r){return new Promise(e=>setTimeout(e,r))}function MU(r){var s;const e=r,t=(s=e==null?void 0:e.$metadata)==null?void 0:s.httpStatusCode;if(typeof t=="number")return t>=500||t===429||t===408;const n=["TimeoutError","NetworkError"];return typeof(e==null?void 0:e.name)=="string"&&n.includes(e.name),!0}async function oT(r,e,t){const n="refreshAuthToken",s=new Ub({region:"us-east-1"});for(let i=1;i<=Nx;i++)try{t.info(`Refreshing auth token (attempt ${i})...`,{sourceFile:Zs,functionName:n});const c=new H_({ClientId:gh,AuthFlow:"REFRESH_TOKEN_AUTH",AuthParameters:{REFRESH_TOKEN:r.refresh_token}}),p=(await s.send(c)).AuthenticationResult;if(!p)throw new Error("AuthenticationResult is missing in the response.");const{IdToken:m,AccessToken:g,RefreshToken:x,ExpiresIn:b,TokenType:E}=p;if(!m||!g||!b||!E)throw new Error("Missing required fields in AuthenticationResult.");const T={id_token:m,access_token:g,refresh_token:x||r.refresh_token,expires_in:b,token_type:E,fetched_at:e};return await RU(t,T),T}catch(c){const d=MU(c);if(t.error(`Error refreshing auth token (attempt ${i}/${Nx})`,c,{sourceFile:Zs,functionName:n,isTransient:d}),!d||i===Nx)throw await Gy(t),new Error("Failed to refresh authentication token.");const p=DU*2**(i-1);t.warn(`Transient error refreshing token  retrying in ${p}ms`,{sourceFile:Zs,functionName:n,attempt:i}),await LU(p)}throw new Error("Failed to refresh authentication token.")}const $U={current:null};async function UU(r){return sT($U,()=>zU(r),"Force token refresh",r)}async function zU(r){const e="performForceTokenRefresh",t=await Om(r);if(!t)throw new Error("No authentication token found.");const n=Math.floor(Date.now());r.info("Force refreshing token before opening options page",{sourceFile:Zs,functionName:e,currentTime:new Date(n).toISOString()});const s=await oT(t,n,r);return r.info("Token force refresh successful",{sourceFile:Zs,functionName:e}),s}async function $r(r,e={},t){const n="fetchWithAuth",s=Date.now(),i=Date.now();let c=await Ow(t);const d=Date.now()-i;e.headers={...e.headers,Authorization:`${c.id_token}`};const p=Date.now(),m=await fetch(r,e),g=Date.now()-p;if(t.info("fetchWithAuth completed",{sourceFile:Zs,functionName:n,url:r.pathname,status:m.status,tokenValidationMs:d,networkFetchMs:g,totalMs:Date.now()-s}),m.status===401)try{t.info("Received 401, getting fresh token...",{sourceFile:Zs,functionName:n});const x=Date.now();c=await Ow(t);const b=Date.now()-x;t.info("New token received for retry",{sourceFile:Zs,functionName:n,retryTokenMs:b}),e.headers&&typeof e.headers=="object"&&!Array.isArray(e.headers)&&(e.headers.Authorization=`${c.id_token}`);const E=Date.now(),T=await fetch(r,e),S=Date.now()-E;return t.info("fetchWithAuth retry completed",{sourceFile:Zs,functionName:n,url:r.pathname,status:T.status,retryTokenMs:b,retryFetchMs:S,totalMs:Date.now()-s}),T}catch(x){throw t.error("Token refresh failed",x,{sourceFile:Zs,functionName:n}),await Gy(t),new Error("Unauthorized: Failed to refresh token.")}return m}class HU{constructor(e){H(this,"logger");this.logger=e}getResourceURL(e){return chrome.runtime.getURL(e)}async queryTabs(e={}){return new Promise(t=>{chrome.tabs.query(e,n=>{t(n.map(s=>({id:s.id,url:s.url,active:s.active})))})})}async updateTab(e,t){return new Promise(n=>{chrome.tabs.update(e,t,()=>{n()})})}async reloadTab(e){return new Promise(t=>{chrome.tabs.reload(e,void 0,()=>{t()})})}async openOptionsPage(){return new Promise(async e=>{try{const t=await UU(this.logger);let n=eh;t!=null&&t.id_token&&(n+=`?token=${encodeURIComponent(t.id_token)}`),this.logger.info("Opening external options page",{sourceFile:"src/platforms/chrome/ChromeTabsProvider.ts",functionName:"openOptionsPage",url:eh,hasToken:!!(t!=null&&t.id_token)}),chrome.tabs.create({url:n},()=>{e()})}catch(t){this.logger.error("Failed to open options page",t,{sourceFile:"src/platforms/chrome/ChromeTabsProvider.ts",functionName:"openOptionsPage"}),chrome.tabs.create({url:eh},()=>{e()})}})}async openURL(e,t="_blank"){return new Promise(n=>{t==="_blank"?chrome.tabs.create({url:e},()=>{n()}):(window.open(e,t),n())})}}function Yv(r){const t=new DOMParser().parseFromString(r,"text/html"),n={white:"#ffffff",black:"#000000",red:"#e60000",orange:"#f90",yellow:"#ff0",green:"#008a00",blue:"#06c",purple:"#93f"};t.querySelectorAll("[class]").forEach(m=>{const g=m.classList,x={},b=[],E=m.getAttribute("style");E&&E.split(";").forEach(S=>{const[N,R]=S.split(":").map(A=>A.trim());N&&R&&(x[N]=R)});for(const S of["left","center","right","justify"]){const N=`ql-align-${S}`;if(g.contains(N)){const R=m.tagName.toLowerCase();R==="li"?S==="center"?(x["text-align"]="center",x["list-style-position"]="inside"):S==="right"?(x["text-align"]="right",x["list-style-position"]="inside"):S==="left"?x["text-align"]="left":S==="justify"&&(x["text-align"]="justify"):R==="ol"||R==="ul"?S==="center"?(x["margin-left"]="auto",x["margin-right"]="auto",x["padding-left"]="40px",x.width="fit-content"):S==="right"?(x["margin-left"]="auto",x["margin-right"]="0",x["padding-left"]="40px",x.width="fit-content"):S==="left"&&(x["margin-left"]="0",x["margin-right"]="auto"):x["text-align"]=S,b.push(N)}}g.contains("ql-font-serif")&&(x["font-family"]="Georgia, Times New Roman, serif",b.push("ql-font-serif")),g.contains("ql-font-monospace")&&(x["font-family"]="Monaco, Courier New, monospace",b.push("ql-font-monospace"));const T={"ql-size-small":"0.75em","ql-size-large":"1.5em","ql-size-huge":"2.5em"};for(const[S,N]of Object.entries(T))g.contains(S)&&(x["font-size"]=N,b.push(S));for(const[S,N]of Object.entries(n)){const R=`ql-color-${S}`;g.contains(R)&&(x.color=N,b.push(R))}for(const[S,N]of Object.entries(n)){const R=`ql-bg-${S}`;g.contains(R)&&(x["background-color"]=N,b.push(R))}if(Object.keys(x).length>0){const S=Object.entries(x).map(([N,R])=>`${N}: ${R}`).join("; ");m.setAttribute("style",S)}b.forEach(S=>{g.remove(S)}),g.length===0&&m.removeAttribute("class")});const i=t.createTreeWalker(t.body,NodeFilter.SHOW_TEXT,null),c=[];let d;for(;d=i.nextNode();)if(d.nodeValue&&d.nodeValue.includes("	")){const m=d.nodeValue.replace(/\t/g,"");c.push({node:d,newValue:m})}return c.forEach(({node:m,newValue:g})=>{m.nodeValue=g}),t.querySelectorAll("ul, ol").forEach(m=>{var E,T;const g=Array.from(m.children);if(g.length===0)return;const x=g.some(S=>S.getAttribute("data-list")==="bullet"),b=g.some(S=>S.getAttribute("data-list")==="ordered");if(x&&b){const S=t.createDocumentFragment();let N=null,R=null;g.forEach(A=>{const j=A.getAttribute("data-list")||"bullet";if(R!==j||!N){N=t.createElement(j==="ordered"?"ol":"ul");const P=m.getAttribute("style");P&&N.setAttribute("style",P);const $=m.getAttribute("class");$&&N.setAttribute("class",$),S.appendChild(N),R=j}N.appendChild(A.cloneNode(!0))}),(E=m.parentNode)==null||E.replaceChild(S,m)}else if(b&&m.tagName.toLowerCase()==="ul"){const S=t.createElement("ol");for(Array.from(m.attributes).forEach(N=>{S.setAttribute(N.name,N.value)});m.firstChild;)S.appendChild(m.firstChild);(T=m.parentNode)==null||T.replaceChild(S,m)}}),t.body.innerHTML}class BU{constructor(e){H(this,"logger");this.logger=e}async executeScript(e){var t;try{return(t=(await chrome.scripting.executeScript({target:e.target,func:e.func,args:e.args}))[0])==null?void 0:t.result}catch(n){throw this.logger.error("Error executing script",n,{sourceFile:"src/platforms/chrome/ChromeContentScriptProvider.ts",sourceFunction:"executeScript"}),n}}async insertContentIntoComposeBox(e){try{const t=Yv(e),s=(await chrome.tabs.query({active:!0,currentWindow:!0}))[0];if(!(s!=null&&s.id))throw new Error("No active tab found or tab ID is undefined");await chrome.scripting.executeScript({target:{tabId:s.id},func:i=>{function c(){return document.querySelector('div[role="textbox"][aria-label="Message Body"]')||document.querySelector('div[aria-label="Message body, press Alt+F10 to exit"]')}function d(x){var S;const b=window.getSelection();let E=null,T=0;if(b&&b.rangeCount>0&&(E=b.getRangeAt(0).cloneRange(),x.contains(E.startContainer)||x===E.startContainer)){const N=document.createTreeWalker(x,NodeFilter.SHOW_TEXT,null,!1);let R=0,A;for(;A=N.nextNode();)if(A===E.startContainer){R+=E.startOffset;break}else R+=((S=A.textContent)==null?void 0:S.length)||0;T=R}return{selection:b,range:E,offset:T}}function p(x,b){var E;try{const{selection:T,range:S,offset:N}=b;if(!T)return;if(S&&x.contains(S.startContainer)){T.removeAllRanges(),T.addRange(S);return}if(N>0){const A=document.createTreeWalker(x,NodeFilter.SHOW_TEXT,null,!1);let j=0,P;for(;P=A.nextNode();){const $=((E=P.textContent)==null?void 0:E.length)||0;if(j+$>=N){const W=document.createRange();W.setStart(P,N-j),W.collapse(!0),T.removeAllRanges(),T.addRange(W);return}j+=$}}const R=document.createRange();R.selectNodeContents(x),R.collapse(!1),T.removeAllRanges(),T.addRange(R)}catch(T){console.warn("Could not restore cursor position:",T)}}function m(x,b){document.execCommand("insertHTML",!1,b)}const g=c();if(!g)throw new Error("Compose box not found");try{const x=d(g);g.focus(),p(g,x),navigator.clipboard&&navigator.clipboard.writeText?navigator.clipboard.writeText(i).then(()=>{document.execCommand("paste")}).catch(()=>{m(g,i)}):m(g,i)}catch(x){throw new Error("Error during paste operation: "+x)}},args:[t]})}catch(t){throw this.logger.error("Error inserting content into compose box",t,{sourceFile:"src/platforms/chrome/ChromeContentScriptProvider.ts",sourceFunction:"insertContentIntoComposeBox"}),t}}}class GU{constructor(e){H(this,"logger");this.logger=e}async launchWebAuthFlow(e){try{const t=await chrome.identity.launchWebAuthFlow(e);if(!t)throw new Error("Authentication was cancelled or failed");return t}catch(t){throw this.logger.error("Error launching web auth flow",t,{sourceFile:"src/platforms/chrome/ChromeIdentityProvider.ts",sourceFunction:"launchWebAuthFlow"}),t}}async initiateOAuth(e,t){return this.launchWebAuthFlow({url:e,interactive:!0})}}const WU="CandleLogsDB",VU=1,rd="logs",qU=5e3,KU=500,oC={ERROR:1,WARN:2,INFO:3,DEBUG:4};let Hp=null;function Dw(){return Hp||(Hp=new Promise((r,e)=>{console.log("[Logger] Initializing IndexedDB...");const t=indexedDB.open(WU,VU);t.onupgradeneeded=n=>{console.log("[Logger] IndexedDB upgrade needed.");const s=n.target.result;if(!s.objectStoreNames.contains(rd)){console.log(`[Logger] Creating object store: ${rd}`);const i=s.createObjectStore(rd,{keyPath:"id",autoIncrement:!0});console.log("[Logger] Creating indexes: timestamp, level, chromeContext"),i.createIndex("timestamp","timestamp",{unique:!1}),i.createIndex("level","level",{unique:!1}),i.createIndex("chromeContext","chromeContext",{unique:!1})}},t.onsuccess=n=>{console.log("[Logger] IndexedDB initialized successfully."),r(n.target.result)},t.onerror=n=>{console.error("[Logger] IndexedDB initialization failed:",n.target.error),Hp=null,e(n.target.error)},t.onblocked=()=>{console.warn("[Logger] IndexedDB initialization blocked. Close other tabs using the database.")}}),Hp)}Dw().catch(r=>console.error("[Logger] Initial DB connection failed:",r));const Yo=class Yo{constructor(e){H(this,"context");H(this,"minLevel","INFO");this.context=e||"unknown"}async writeLog(e,t,n,s){if(oC[e]>oC[this.minLevel])return;const i=(n==null?void 0:n.sourceFile)||"unknown",c=n==null?void 0:n.sourceFunction;let d;s&&(s instanceof Error?d={name:s.name,message:s.message,stack:s.stack}:d=s);const{sourceFile:p,sourceFunction:m,...g}=n||{},x={...d?{error:d}:{},...g};{const T=[`[${e}] [${this.context}] [${i}${c?` (${c})`:""}]: ${t}`];switch(s&&T.push(s),Object.keys(g).length>0&&T.push(g),e){case"DEBUG":console.debug(...T);break;case"INFO":console.info(...T);break;case"WARN":console.warn(...T);break;case"ERROR":console.error(...T);break}}const b={timestamp:new Date().toISOString(),level:e,message:t,chromeContext:this.context,sourceFile:i,...c&&{sourceFunction:c},details:Object.keys(x).length>0?x:void 0};try{const T=(await Dw()).transaction(rd,"readwrite"),N=T.objectStore(rd).add(b);return new Promise((R,A)=>{N.onsuccess=()=>{R()},N.onerror=j=>{console.error("[Logger] Failed to write log to IndexedDB:",j.target.error,b),A(j.target.error)},T.onerror=j=>{console.error("[Logger] Transaction error writing log:",j.target.error,b),A(j.target.error)},T.onabort=j=>{console.warn("[Logger] Transaction aborted writing log:",j.target.error,b),A(new Error("Transaction aborted"))}})}catch(E){throw console.error("[Logger] Error obtaining DB or starting transaction:",E,b),E}}static async _cleanupOldLogs(){if(this._isCleaning){console.info("[Logger] Cleanup already in progress, skipping.");return}console.info("[Logger] Starting log cleanup check..."),this._isCleaning=!0;try{const t=(await Dw()).transaction(rd,"readwrite"),n=t.objectStore(rd),s=n.count(),i=await new Promise((m,g)=>{s.onsuccess=()=>m(s.result),s.onerror=x=>{console.error("[Logger] Failed to count logs for cleanup:",x.target.error),g(x.target.error)}});if(i<=this.MAX_LOG_ENTRIES){console.info(`[Logger] Log count (${i}) within limit (${this.MAX_LOG_ENTRIES}). No cleanup needed.`);return}let c=i-this.MAX_LOG_ENTRIES;console.warn(`[Logger] Log count (${i}) exceeds limit (${this.MAX_LOG_ENTRIES}). Deleting ${c} oldest logs.`);const d=n.openCursor();let p=0;await new Promise((m,g)=>{d.onsuccess=x=>{const b=x.target.result;if(b&&c>0){const E=b.delete();E.onsuccess=()=>{p++,c--,c>0?b.continue():m()},E.onerror=T=>{console.error("[Logger] Error deleting log entry during cleanup:",T.target.error,"Key:",b.primaryKey),b.continue()}}else m()},d.onerror=x=>{console.error("[Logger] Error opening cursor for cleanup:",x.target.error),g(x.target.error)}}),await new Promise((m,g)=>{t.oncomplete=()=>{console.info(`[Logger] Log cleanup finished. Deleted ${p} entries.`),m()},t.onerror=x=>{console.error("[Logger] Transaction error during cleanup:",x.target.error),g(x.target.error)},t.onabort=x=>{console.warn("[Logger] Transaction aborted during cleanup:",x.target.error),g(new Error("Cleanup transaction aborted"))}})}catch(e){console.error("[Logger] Error during log cleanup process:",e)}finally{this._isCleaning=!1,console.info("[Logger] Log cleanup check finished.")}}_triggerCleanupCheck(){if(Yo._writeCount++,Yo._writeCount>=Yo.CLEANUP_TRIGGER_COUNT&&!Yo._isCleaning){const e=Yo._writeCount;Yo._writeCount=0,console.info(`[Logger] Write count reached ${e}. Triggering background cleanup.`),Yo._cleanupOldLogs().catch(t=>{console.error("[Logger] Background cleanup process failed:",t)})}}async debug(e,t){try{await this.writeLog("DEBUG",e,t),this._triggerCleanupCheck()}catch{}}async info(e,t){try{await this.writeLog("INFO",e,t),this._triggerCleanupCheck()}catch{}}async warn(e,t){try{await this.writeLog("WARN",e,t),this._triggerCleanupCheck()}catch{}}async error(e,t,n){try{await this.writeLog("ERROR",e,n,t),this._triggerCleanupCheck()}catch{}}};H(Yo,"_writeCount",0),H(Yo,"_isCleaning",!1),H(Yo,"MAX_LOG_ENTRIES",qU),H(Yo,"CLEANUP_TRIGGER_COUNT",KU);let Lw=Yo;class YU{constructor(e){H(this,"logger");this.logger=new Lw(e)}async debug(e,t){return this.logger.debug(e,t)}async info(e,t){return this.logger.info(e,t)}async warn(e,t){return this.logger.warn(e,t)}async error(e,t,n){return this.logger.error(e,t,n)}setMinLevel(e){console.warn("[ChromeLoggingProvider] setMinLevel not yet implemented - using hardcoded INFO level")}getMinLevel(){return"INFO"}}function JU(r="unknown"){const e=new YU(r==="background"?"background":"options");return{storage:new WO(e),data:new VO(e),auth:new CU(e),messaging:new kU(e),lifecycle:new NU(e),tabs:new HU(e),contentScript:new BU(e),identity:new GU(e),logging:e}}class XU{constructor(e){H(this,"logger");H(this,"_changeListeners",[]);H(this,"onChanged",e=>{this.logger.warn("onChanged listener not fully supported with Office roaming settings. Callbacks will be stored but not automatically invoked.",{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"onChanged"}),this._changeListeners.push(e)});H(this,"removeChangeListener",e=>{this.logger.warn("removeChangeListener not fully supported with Office roaming settings.",{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"removeChangeListener"}),this._changeListeners=this._changeListeners.filter(t=>t!==e)});this.logger=e}async getLocalItem(e){var t;try{if(typeof localStorage<"u"){const n=localStorage.getItem(e);if(n){const s=JSON.parse(n);return this.logger.debug(`Retrieved local item with key: ${e}`,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"getLocalItem"}),s}}else if((t=Office==null?void 0:Office.context)!=null&&t.roamingSettings){const n=Office.context.roamingSettings.get(e);if(n){const s=JSON.parse(n);return this.logger.debug(`Retrieved item from roaming settings with key: ${e}`,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"getLocalItem"}),s}}return null}catch(n){return this.logger.error(`Error retrieving local item with key: ${e}`,n,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"getLocalItem"}),null}}async setLocalItem(e,t){var n;try{if(typeof localStorage<"u")localStorage.setItem(e,JSON.stringify(t)),this.logger.debug(`Stored local item with key: ${e}`,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"setLocalItem"}),this._notifyChangeListeners({[e]:{newValue:t}});else if((n=Office==null?void 0:Office.context)!=null&&n.roamingSettings)Office.context.roamingSettings.set(e,JSON.stringify(t)),await new Promise((s,i)=>{Office.context.roamingSettings.saveAsync(c=>{var d;c.status===Office.AsyncResultStatus.Succeeded?(this.logger.debug(`Stored item in roaming settings with key: ${e}`,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"setLocalItem"}),s()):i(new Error(((d=c.error)==null?void 0:d.message)||"Failed to save roaming settings"))})}),this._notifyChangeListeners({[e]:{newValue:t}});else throw new Error("No storage mechanism available")}catch(s){throw this.logger.error(`Error storing local item with key: ${e}`,s,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"setLocalItem"}),s}}async removeLocalItem(e){var t;try{const n=await this.getLocalItem(e);if(typeof localStorage<"u")localStorage.removeItem(e),this.logger.debug(`Removed local item with key: ${e}`,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"removeLocalItem"}),this._notifyChangeListeners({[e]:{oldValue:n,newValue:void 0}});else if((t=Office==null?void 0:Office.context)!=null&&t.roamingSettings)Office.context.roamingSettings.remove(e),await new Promise((s,i)=>{Office.context.roamingSettings.saveAsync(c=>{var d;c.status===Office.AsyncResultStatus.Succeeded?(this.logger.debug(`Removed item from roaming settings with key: ${e}`,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"removeLocalItem"}),s()):i(new Error(((d=c.error)==null?void 0:d.message)||"Failed to save roaming settings"))})}),this._notifyChangeListeners({[e]:{oldValue:n,newValue:void 0}});else throw new Error("No storage mechanism available")}catch(n){throw this.logger.error(`Error removing local item with key: ${e}`,n,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"removeLocalItem"}),n}}async clearLocal(){var e;try{if(typeof localStorage<"u")localStorage.clear(),this.logger.info("Cleared local storage",{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"clearLocal"}),this._notifyChangeListeners({});else if((e=Office==null?void 0:Office.context)!=null&&e.roamingSettings){const t=await this.getAllKeys(),n={};for(const s of t){const i=await this.getLocalItem(s);Office.context.roamingSettings.remove(s),n[s]={oldValue:i,newValue:void 0}}await new Promise((s,i)=>{Office.context.roamingSettings.saveAsync(c=>{var d;c.status===Office.AsyncResultStatus.Succeeded?(this.logger.info("Cleared all roaming settings",{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"clearLocal"}),s()):i(new Error(((d=c.error)==null?void 0:d.message)||"Failed to save roaming settings"))})}),this._notifyChangeListeners(n)}else throw new Error("No storage mechanism available")}catch(t){throw this.logger.error("Error clearing local storage",t,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"clearLocal"}),t}}async getAllKeys(){var e;try{if(typeof localStorage<"u"){const t=Object.keys(localStorage);return this.logger.debug(`Retrieved ${t.length} keys from storage`,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"getAllKeys"}),t}else if((e=Office==null?void 0:Office.context)!=null&&e.roamingSettings)return this.logger.warn("getAllKeys not fully supported with Office roaming settings",{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"getAllKeys"}),[];return[]}catch(t){return this.logger.error("Error getting all keys",t,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"getAllKeys"}),[]}}_notifyChangeListeners(e){this._changeListeners.forEach(t=>{try{t(e)}catch(n){this.logger.error("Error in storage change callback",n,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"_notifyChangeListeners"})}})}}class QU{constructor(e){H(this,"logger");H(this,"threadListeners",new Set);H(this,"currentThread",null);H(this,"lastKnownThreadId");H(this,"debounceTimer",null);this.logger=e,this.initializeOutlookListeners()}initializeOutlookListeners(){var e,t,n,s;(t=(e=Office==null?void 0:Office.context)==null?void 0:e.mailbox)!=null&&t.addHandlerAsync&&Office.context.mailbox.addHandlerAsync(Office.EventType.ItemChanged,this.debouncedHandleItemChanged.bind(this)),(s=(n=Office==null?void 0:Office.context)==null?void 0:n.mailbox)!=null&&s.item&&setTimeout(()=>this.handleItemChanged(),100)}debouncedHandleItemChanged(){this.debounceTimer&&clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout(()=>{this.handleItemChanged(),this.debounceTimer=null},50)}async handleItemChanged(){var e,t;try{const n=await this.getCurrentThread(),s=n==null?void 0:n.threadId,i=s!==((e=this.currentThread)==null?void 0:e.threadId);if(n&&this.currentThread&&!i){const c=JSON.stringify(this.currentThread.participants.sort()),d=JSON.stringify(n.participants.sort());if(c===d)return}i||!this.currentThread&&n?(this.logger.info("Thread changed or initialized",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"handleItemChanged",oldThreadId:(t=this.currentThread)==null?void 0:t.threadId,newThreadId:s}),this.currentThread=n,this.lastKnownThreadId=s,this.notifyThreadListeners(n)):n&&this.currentThread?this.hasThreadContentChanged(this.currentThread,n)?(this.logger.info("Thread content updated",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"handleItemChanged",threadId:s}),this.currentThread=n,this.notifyThreadListeners(n)):this.currentThread=n:this.logger.info("No meaningful thread change detected",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"handleItemChanged",hasNewThread:!!n,hasCurrentThread:!!this.currentThread})}catch(n){this.logger.error("Error handling item change",n,{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"handleItemChanged"})}}hasThreadContentChanged(e,t){var i,c;if(e.subject!==t.subject)return!0;if(e.messages.length!==t.messages.length)return t.messages.length>e.messages.length;const n=new Set(e.participants),s=new Set(t.participants);if(n.size!==s.size)return!0;for(const d of n)if(!s.has(d))return!0;for(let d=0;d<Math.min(e.messages.length,t.messages.length);d++){const p=e.messages[d],m=t.messages[d],g=((i=p.body)==null?void 0:i.trim())||"",x=((c=m.body)==null?void 0:c.trim())||"";if(g!==x&&g.length>0&&x.length>0||p.from!==m.from)return!0}return!1}shouldPreserveThreadHistory(e){var t,n,s;return!!(this.currentThread&&this.currentThread.threadId===e&&this.currentThread.messages.length>0&&((n=(t=Office==null?void 0:Office.context)==null?void 0:t.mailbox)!=null&&n.item)&&(Office.context.mailbox.item.itemType==="message"||(s=Office.context.mailbox.item.itemClass)!=null&&s.includes("IPM.Note")))}async getCurrentThread(){return new Promise(e=>{var t,n;if(!((n=(t=Office==null?void 0:Office.context)==null?void 0:t.mailbox)!=null&&n.item)){this.logger.info("No Office context or mailbox item available",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getCurrentThread"}),e(null);return}try{const s=Office.context.mailbox.item;this.logger.info("Getting current thread",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getCurrentThread",itemType:s.itemType,itemClass:s.itemClass,subject:s.subject,hasConversationId:!!s.conversationId,hasGetConversationIndexAsync:!!s.getConversationIndexAsync,hasCurrentThread:!!this.currentThread,lastKnownThreadId:this.lastKnownThreadId}),this.getThreadId(s).then(i=>{if(i)return this.getItemDetails(s,i);this.logger.warn("Could not determine thread ID",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getCurrentThread"}),e(null)}).then(i=>e(i||null)).catch(i=>{this.logger.error("Error getting current thread",i,{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getCurrentThread"}),e(null)})}catch(s){this.logger.error("Error in getCurrentThread",s,{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getCurrentThread"}),e(null)}})}normalizeSubject(e){return e?e.replace(/^((re|fw|fwd):\s*)+/i,"").trim():""}async getThreadId(e){return new Promise(t=>{if(e.conversationId){const n=e.conversationId;this.logger.info("Using conversationId as thread ID",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getThreadId",conversationId:n}),this.lastKnownThreadId=n,t(n);return}if(e.getConversationIndexAsync)e.getConversationIndexAsync(n=>{if(n.status===Office.AsyncResultStatus.Succeeded&&n.value)this.logger.info("Using conversation index as thread ID",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getThreadId",conversationIndex:n.value}),this.lastKnownThreadId=n.value,t(n.value);else{this.logger.info("getConversationIndexAsync failed, trying other methods",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getThreadId",error:n.error});const s=e.subject,i=this.currentThread?this.normalizeSubject(this.currentThread.subject):"",c=this.normalizeSubject(s);if(s&&this.currentThread&&i===c&&this.lastKnownThreadId){this.logger.info("Using cached thread ID based on normalized subject match (async failed)",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getThreadId",subject:s,cachedThreadId:this.lastKnownThreadId}),t(this.lastKnownThreadId);return}const d=e.itemId||this.lastKnownThreadId||"unknown";t(d)}});else{const n=e.subject,s=this.currentThread?this.normalizeSubject(this.currentThread.subject):"",i=this.normalizeSubject(n);if(n&&this.currentThread&&s===i&&this.lastKnownThreadId)this.logger.info("Using cached thread ID based on normalized subject match (no async method)",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getThreadId",subject:n,cachedThreadId:this.lastKnownThreadId}),t(this.lastKnownThreadId||null);else{const c=e.itemId||this.lastKnownThreadId||"unknown";this.logger.info("Using final fallback ID as thread ID",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getThreadId",fallbackId:c}),t(c)}}})}async getCurrentThreadId(){return new Promise(e=>{var n,s;if(!((s=(n=Office==null?void 0:Office.context)==null?void 0:n.mailbox)!=null&&s.item)){e(this.lastKnownThreadId||null);return}const t=Office.context.mailbox.item;this.getThreadId(t).then(e).catch(()=>e(this.lastKnownThreadId||null))})}onThreadChanged(e){this.threadListeners.add(e)}removeThreadListener(e){this.threadListeners.delete(e)}destroy(){this.debounceTimer&&(clearTimeout(this.debounceTimer),this.debounceTimer=null),this.threadListeners.clear()}notifyThreadListeners(e){this.threadListeners.forEach(t=>{try{t(e)}catch(n){this.logger.error("Error in thread change callback",n,{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"notifyThreadListeners"})}})}async getItemDetails(e,t){return new Promise(async n=>{var s;try{const i=e;let c="No Subject";if(typeof i.subject=="string")c=i.subject||"No Subject";else if(i.subject&&typeof i.subject.getAsync=="function")try{c=await new Promise((g,x)=>{i.subject.getAsync(b=>{b.status===Office.AsyncResultStatus.Succeeded?g(b.value):x(b.error)})})||"No Subject"}catch{}let d=this.extractParticipants(i);try{const m=await this.extractAsyncParticipants(i),g=new Set([...d,...m]);d=Array.from(g)}catch(m){this.logger.warn("Could not extract async participants",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getItemDetails",error:m})}const p={from:this.getFromAddress(i),timestamp:this.getTimestamp(i),subject:c,body:"",html:""};if(i.body&&i.body.getAsync)i.body.getAsync(Office.CoercionType.Html,m=>{var x;m.status===Office.AsyncResultStatus.Succeeded&&(p.html=m.value,p.body=this.stripHtml(m.value));const g=this.shouldPreserveThreadHistory(t)?[...((x=this.currentThread)==null?void 0:x.messages)||[],p]:[p];n({threadId:t,messages:g,subject:c,participants:d})});else{const m=this.shouldPreserveThreadHistory(t)?[...((s=this.currentThread)==null?void 0:s.messages)||[],p]:[p];n({threadId:t,messages:m,subject:c,participants:d})}}catch(i){this.logger.error("Error getting item details",i,{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getItemDetails",threadId:t}),n(null)}})}extractParticipants(e){const t=new Set;try{const n=this.getFromAddress(e);n&&n!=="Unknown"&&t.add(n),e.sender&&e.sender.emailAddress&&t.add(e.sender.emailAddress),e.to&&Array.isArray(e.to)&&e.to.forEach(s=>{s.emailAddress&&t.add(s.emailAddress)}),e.cc&&Array.isArray(e.cc)&&e.cc.forEach(s=>{s.emailAddress&&t.add(s.emailAddress)}),e.bcc&&Array.isArray(e.bcc)&&e.bcc.forEach(s=>{s.emailAddress&&t.add(s.emailAddress)})}catch(n){this.logger.warn("Error extracting participants",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"extractParticipants",error:n})}return Array.from(t)}async extractAsyncParticipants(e){const t=new Set;try{const n=[];e.to&&typeof e.to.getAsync=="function"&&n.push(this.getRecipientsAsync(e.to,"to")),e.cc&&typeof e.cc.getAsync=="function"&&n.push(this.getRecipientsAsync(e.cc,"cc")),e.bcc&&typeof e.bcc.getAsync=="function"&&n.push(this.getRecipientsAsync(e.bcc,"bcc")),(await Promise.allSettled(n)).forEach(i=>{i.status==="fulfilled"&&i.value.forEach(c=>t.add(c))})}catch(n){this.logger.warn("Error extracting async participants",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"extractAsyncParticipants",error:n})}return Array.from(t)}getRecipientsAsync(e,t){return new Promise(n=>{e.getAsync(s=>{if(s.status===Office.AsyncResultStatus.Succeeded){const i=s.value.map(c=>c.emailAddress).filter(c=>c);n(i)}else this.logger.warn(`Error getting ${t} recipients`,{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getRecipientsAsync",error:s.error}),n([])})})}getFromAddress(e){try{return e.from&&e.from.emailAddress?e.from.emailAddress:e.sender&&e.sender.emailAddress?e.sender.emailAddress:"Unknown"}catch(t){return this.logger.warn("Error getting from address",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getFromAddress",error:t}),"Unknown"}}getCurrentUserEmail(){var e,t,n;try{if((n=(t=(e=Office==null?void 0:Office.context)==null?void 0:e.mailbox)==null?void 0:t.userProfile)!=null&&n.emailAddress){const s=Office.context.mailbox.userProfile.emailAddress;return this.logger.info("Retrieved current user email from Outlook API",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getCurrentUserEmail",userEmail:s}),s}return this.logger.warn("userProfile.emailAddress not available",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getCurrentUserEmail"}),null}catch(s){return this.logger.error("Error getting current user email",s,{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getCurrentUserEmail"}),null}}getTimestamp(e){try{return e.dateTimeCreated?e.dateTimeCreated.toISOString():e.dateTimeModified?e.dateTimeModified.toISOString():new Date().toISOString()}catch(t){return this.logger.warn("Error getting timestamp",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getTimestamp",error:t}),new Date().toISOString()}}stripHtml(e){try{return e.replace(/<[^>]*>/g,"").trim()}catch(t){return this.logger.warn("Error stripping HTML",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"stripHtml",error:t}),e}}}const ZU=async(r,e,t)=>({operation:dd(e).operation,region:await Qi(r.region)()||(()=>{throw new Error("expected `region` to be configured for `aws.auth#sigv4`")})()});function e5(r){return{schemeId:"aws.auth#sigv4",signingProperties:{name:"cognito-identity",region:r.region},propertiesExtractor:(e,t)=>({signingProperties:{config:e,context:t}})}}function Cv(r){return{schemeId:"smithy.api#noAuth"}}const t5=r=>{const e=[];switch(r.operation){case"GetCredentialsForIdentity":{e.push(Cv());break}case"GetId":{e.push(Cv());break}case"GetOpenIdToken":{e.push(Cv());break}case"UnlinkIdentity":{e.push(Cv());break}default:e.push(e5(r))}return e},r5=r=>{const e=oN(r);return Object.assign(e,{authSchemePreference:Qi(r.authSchemePreference??[])})},n5=r=>Object.assign(r,{useDualstackEndpoint:r.useDualstackEndpoint??!1,useFipsEndpoint:r.useFipsEndpoint??!1,defaultSigningName:"cognito-identity"}),s5="3.981.0",o5={version:s5},iT="required",Os="fn",Ds="argv",vh="ref",iC=!0,aC="isSet",Dm="booleanEquals",Mf="error",Fa="endpoint",kl="tree",q_="PartitionResult",K_="getAttr",Bp="stringEquals",lC={[iT]:!1,type:"string"},cC={[iT]:!0,default:!1,type:"boolean"},uC={[vh]:"Endpoint"},aT={[Os]:Dm,[Ds]:[{[vh]:"UseFIPS"},!0]},lT={[Os]:Dm,[Ds]:[{[vh]:"UseDualStack"},!0]},Fn={},cm={[vh]:"Region"},dC={[Os]:K_,[Ds]:[{[vh]:q_},"supportsFIPS"]},cT={[vh]:q_},fC={[Os]:Dm,[Ds]:[!0,{[Os]:K_,[Ds]:[cT,"supportsDualStack"]}]},hC=[aT],pC=[lT],mC=[cm],i5={parameters:{Region:lC,UseDualStack:cC,UseFIPS:cC,Endpoint:lC},rules:[{conditions:[{[Os]:aC,[Ds]:[uC]}],rules:[{conditions:hC,error:"Invalid Configuration: FIPS and custom endpoint are not supported",type:Mf},{conditions:pC,error:"Invalid Configuration: Dualstack and custom endpoint are not supported",type:Mf},{endpoint:{url:uC,properties:Fn,headers:Fn},type:Fa}],type:kl},{conditions:[{[Os]:aC,[Ds]:mC}],rules:[{conditions:[{[Os]:"aws.partition",[Ds]:mC,assign:q_}],rules:[{conditions:[aT,lT],rules:[{conditions:[{[Os]:Dm,[Ds]:[iC,dC]},fC],rules:[{conditions:[{[Os]:Bp,[Ds]:[cm,"us-east-1"]}],endpoint:{url:"https://cognito-identity-fips.us-east-1.amazonaws.com",properties:Fn,headers:Fn},type:Fa},{conditions:[{[Os]:Bp,[Ds]:[cm,"us-east-2"]}],endpoint:{url:"https://cognito-identity-fips.us-east-2.amazonaws.com",properties:Fn,headers:Fn},type:Fa},{conditions:[{[Os]:Bp,[Ds]:[cm,"us-west-1"]}],endpoint:{url:"https://cognito-identity-fips.us-west-1.amazonaws.com",properties:Fn,headers:Fn},type:Fa},{conditions:[{[Os]:Bp,[Ds]:[cm,"us-west-2"]}],endpoint:{url:"https://cognito-identity-fips.us-west-2.amazonaws.com",properties:Fn,headers:Fn},type:Fa},{endpoint:{url:"https://cognito-identity-fips.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:Fn,headers:Fn},type:Fa}],type:kl},{error:"FIPS and DualStack are enabled, but this partition does not support one or both",type:Mf}],type:kl},{conditions:hC,rules:[{conditions:[{[Os]:Dm,[Ds]:[dC,iC]}],rules:[{endpoint:{url:"https://cognito-identity-fips.{Region}.{PartitionResult#dnsSuffix}",properties:Fn,headers:Fn},type:Fa}],type:kl},{error:"FIPS is enabled but this partition does not support FIPS",type:Mf}],type:kl},{conditions:pC,rules:[{conditions:[fC],rules:[{conditions:[{[Os]:Bp,[Ds]:["aws",{[Os]:K_,[Ds]:[cT,"name"]}]}],endpoint:{url:"https://cognito-identity.{Region}.amazonaws.com",properties:Fn,headers:Fn},type:Fa},{endpoint:{url:"https://cognito-identity.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:Fn,headers:Fn},type:Fa}],type:kl},{error:"DualStack is enabled but this partition does not support DualStack",type:Mf}],type:kl},{endpoint:{url:"https://cognito-identity.{Region}.{PartitionResult#dnsSuffix}",properties:Fn,headers:Fn},type:Fa}],type:kl}],type:kl},{error:"Invalid Configuration: Missing Region",type:Mf}]},a5=i5,l5=new $1({size:50,params:["Endpoint","Region","UseDualStack","UseFIPS"]}),c5=(r,e={})=>l5.get(r,()=>Y1(a5,{endpointParams:r,logger:e.logger}));ch.aws=Lb;const u5=r=>({apiVersion:"2014-06-30",base64Decoder:(r==null?void 0:r.base64Decoder)??Ym,base64Encoder:(r==null?void 0:r.base64Encoder)??Tm,disableHostPrefix:(r==null?void 0:r.disableHostPrefix)??!1,endpointProvider:(r==null?void 0:r.endpointProvider)??c5,extensions:(r==null?void 0:r.extensions)??[],httpAuthSchemeProvider:(r==null?void 0:r.httpAuthSchemeProvider)??t5,httpAuthSchemes:(r==null?void 0:r.httpAuthSchemes)??[{schemeId:"aws.auth#sigv4",identityProvider:e=>e.getIdentityProvider("aws.auth#sigv4"),signer:new Q1},{schemeId:"smithy.api#noAuth",identityProvider:e=>e.getIdentityProvider("smithy.api#noAuth")||(async()=>({})),signer:new D1}],logger:(r==null?void 0:r.logger)??new jb,protocol:(r==null?void 0:r.protocol)??fN,protocolSettings:(r==null?void 0:r.protocolSettings)??{defaultNamespace:"com.amazonaws.cognitoidentity",xmlNamespace:"http://cognito-identity.amazonaws.com/doc/2014-06-30/",version:"2014-06-30",serviceTarget:"AWSCognitoIdentityService"},serviceId:(r==null?void 0:r.serviceId)??"Cognito Identity",urlParser:(r==null?void 0:r.urlParser)??Im,utf8Decoder:(r==null?void 0:r.utf8Decoder)??id,utf8Encoder:(r==null?void 0:r.utf8Encoder)??Uy}),d5=r=>{const e=FN(r),t=()=>e().then(cN),n=u5(r);return{...n,...r,runtime:"browser",defaultsMode:e,bodyLengthChecker:(r==null?void 0:r.bodyLengthChecker)??iN,credentialDefaultProvider:(r==null?void 0:r.credentialDefaultProvider)??(s=>()=>Promise.reject(new Error("Credential is missing"))),defaultUserAgentProvider:(r==null?void 0:r.defaultUserAgentProvider)??IN({serviceId:n.serviceId,clientVersion:o5.version}),maxAttempts:(r==null?void 0:r.maxAttempts)??Pm,region:(r==null?void 0:r.region)??PN("Region is missing"),requestHandler:zy.create((r==null?void 0:r.requestHandler)??t),retryMode:(r==null?void 0:r.retryMode)??(async()=>(await t()).retryMode||_N),sha256:(r==null?void 0:r.sha256)??AN,streamCollector:(r==null?void 0:r.streamCollector)??T1,useDualstackEndpoint:(r==null?void 0:r.useDualstackEndpoint)??(()=>Promise.resolve(pN)),useFipsEndpoint:(r==null?void 0:r.useFipsEndpoint)??(()=>Promise.resolve(mN))}},f5=r=>{const e=r.httpAuthSchemes;let t=r.httpAuthSchemeProvider,n=r.credentials;return{setHttpAuthScheme(s){const i=e.findIndex(c=>c.schemeId===s.schemeId);i===-1?e.push(s):e.splice(i,1,s)},httpAuthSchemes(){return e},setHttpAuthSchemeProvider(s){t=s},httpAuthSchemeProvider(){return t},setCredentials(s){n=s},credentials(){return n}}},h5=r=>({httpAuthSchemes:r.httpAuthSchemes(),httpAuthSchemeProvider:r.httpAuthSchemeProvider(),credentials:r.credentials()}),p5=(r,e)=>{const t=Object.assign($N(r),uN(r),w1(r),f5(r));return e.forEach(n=>n.configure(t)),Object.assign(r,UN(t),dN(t),b1(t),h5(t))};class m5 extends aN{constructor(...[t]){const n=d5(t||{});super(n);H(this,"config");this.initConfig=n;const s=n5(n),i=M1(s),c=kN(i),d=vN(c),p=d,m=bN(p),g=r5(m),x=p5(g,(t==null?void 0:t.extensions)||[]);this.config=x,this.middlewareStack.use(I1(this.config)),this.middlewareStack.use(hN(this.config)),this.middlewareStack.use(NN(this.config)),this.middlewareStack.use(yN(this.config)),this.middlewareStack.use(_1(this.config)),this.middlewareStack.use(E1(this.config)),this.middlewareStack.use(S1(this.config)),this.middlewareStack.use(C1(this.config,{httpAuthSchemeParametersProvider:ZU,identityProviderConfigProvider:async b=>new O1({"aws.auth#sigv4":b.credentials})})),this.middlewareStack.use(k1(this.config))}destroy(){super.destroy()}}var uT=(r=>(r.Succeeded="succeeded",r.Failed="failed",r))(uT||{}),Mw=(r=>(r.DialogMessageReceived="dialogMessageReceived",r.DialogEventReceived="dialogEventReceived",r))(Mw||{});class dT{constructor(e){H(this,"logger");this.logger=e}async launchWebAuthFlow(e){return this.logger.warn("launchWebAuthFlow using basic window.open approach in Outlook context",{sourceFile:"src/platforms/outlook/OutlookIdentityProvider.ts",sourceFunction:"launchWebAuthFlow"}),this.initiateOAuth(e.url,"")}async initiateOAuth(e,t){var n;try{const s=window.Office;return(n=s==null?void 0:s.ui)!=null&&n.displayDialogAsync?(this.logger.info("Using Office.ui.displayDialogAsync for OAuth",{sourceFile:"src/platforms/outlook/OutlookIdentityProvider.ts",sourceFunction:"initiateOAuth"}),new Promise((i,c)=>{s.ui.displayDialogAsync(e,{height:60,width:60},d=>{var p;if(d.status===uT.Succeeded){const m=d.value;m.addEventHandler(Mw.DialogMessageReceived,g=>{m.close(),i(g.message||"")}),m.addEventHandler(Mw.DialogEventReceived,g=>{m.close(),g.error===12006?c(new Error("Authentication was cancelled by user")):c(new Error(`Authentication dialog failed with error: ${g.error}`))})}else c(new Error(`Failed to open authentication dialog: ${((p=d.error)==null?void 0:p.message)||"Unknown error"}`))})})):(this.logger.warn("Office.ui not available, using window.open fallback",{sourceFile:"src/platforms/outlook/OutlookIdentityProvider.ts",sourceFunction:"initiateOAuth"}),new Promise((i,c)=>{const d=window.open(e,"_blank","width=500,height=600,scrollbars=yes,resizable=yes");if(!d){c(new Error("Failed to open authentication window. Please check popup blockers."));return}const p=setInterval(()=>{try{if(d.closed){clearInterval(p),c(new Error("Authentication was cancelled by user"));return}try{const m=d.location.href;if(m&&m.includes("access_token=")){clearInterval(p),d.close(),i(m);return}}catch{}}catch{clearInterval(p),d==null||d.close(),c(new Error("Error during authentication process"))}},1e3);setTimeout(()=>{clearInterval(p),d.closed||d.close(),c(new Error("Authentication timeout - please try again"))},3e5)}))}catch(s){throw this.logger.error("Error initiating OAuth",s,{sourceFile:"src/platforms/outlook/OutlookIdentityProvider.ts",sourceFunction:"initiateOAuth"}),s}}}const g5=()=>{const r=window.location.hostname,e=window.location.pathname;return r==="localhost"?{environment:"local",DIALOG_URL:"https://localhost:5174/auth-dialog-pkce.html"}:e.includes("FileServer_Staging")?{environment:"staging",DIALOG_URL:"https://candle-ai.github.io/FileServer_Staging/dist-outlook-addin/src/apps/outlook-addin/auth-dialog-pkce.html"}:e.includes("FileServer_Prod")?{environment:"prod",DIALOG_URL:"https://candle-ai.github.io/FileServer_Prod/dist-outlook-addin/src/apps/outlook-addin/auth-dialog-pkce.html"}:{environment:"dev",DIALOG_URL:"https://candle-ai.github.io/FileServer/dist-outlook-addin/src/apps/outlook-addin/auth-dialog-pkce.html"}};async function v5(){const r=g5();return new Promise((e,t)=>{let n=!1;console.log(`Starting PKCE authentication in ${r.environment} environment with dialog:`,r.DIALOG_URL),Office.context.ui.displayDialogAsync(r.DIALOG_URL,{height:70,width:50,promptBeforeOpen:!1},s=>{if(s.status!==Office.AsyncResultStatus.Succeeded)return console.error("Failed to open auth dialog:",s.error),t(new Error(`Failed to open authentication dialog: ${s.error.message}`));const i=s.value;console.log("Auth dialog opened successfully"),i.addEventHandler(Office.EventType.DialogMessageReceived,c=>{try{if(!n&&"message"in c){let d;if(typeof c.message=="string")d=JSON.parse(c.message);else if(typeof c.message=="object")d=c.message;else{console.log("Unknown message type:",typeof c.message,c.message);return}if(console.log(`Received message from auth dialog (${r.environment}):`,d.type),d.type==="AUTH_SUCCESS"){if(console.log(`Authentication successful in ${r.environment} environment`),n=!0,i.close(),!d.tokens||!d.tokens.access_token){t(new Error("Invalid token response from authentication dialog"));return}const p={access_token:d.tokens.access_token,refresh_token:d.tokens.refresh_token,id_token:d.tokens.id_token,expires_in:d.tokens.expires_in,token_type:d.tokens.token_type,fetched_at:d.tokens.fetched_at};console.log(`Tokens received successfully in ${r.environment} environment`),e(p)}else d.type==="AUTH_ERROR"&&(console.log(`Authentication error in ${r.environment}:`,d.error),n=!0,i.close(),t(new Error(`Authentication failed: ${d.error}`)))}}catch(d){console.error("Error handling dialog message:",d),n||(n=!0,i.close(),t(new Error("Error processing authentication response")))}}),i.addEventHandler(Office.EventType.DialogEventReceived,c=>{if(console.log("Dialog event received:",c),!n&&"error"in c){const d=c.error;d===12006?(console.log("User cancelled authentication"),n=!0,t(new Error("Authentication cancelled by user"))):d===12005?console.log("Dialog navigation occurred (normal during OAuth)"):(console.error("Dialog error:",d),n=!0,t(new Error(`Authentication dialog error: ${d}`)))}}),setTimeout(()=>{n||(console.log(`Authentication timeout in ${r.environment} environment`),n=!0,i.close(),t(new Error("Authentication timeout - please try again")))},300*1e3)})})}const gC="us-east-1";class y5{constructor(e,t){H(this,"logger");H(this,"authListeners",new Set);H(this,"cachedToken",null);H(this,"cognitoClient");H(this,"identityProvider");H(this,"storageProvider");this.logger=e,this.storageProvider=t,this.cognitoClient=new m5({region:gC}),this.identityProvider=new dT(e)}async login(){try{const e=await v5();return this.logger.info("Token received",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"login",token:e}),this.cachedToken=e,await this.saveToken(e),this.notifyAuthListeners(!0),e}catch(e){throw this.logger.error("Login failed",e,{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"login"}),e}}async logout(){this.cachedToken=null,await this.deleteToken(),this.notifyAuthListeners(!1)}async getToken(){if(this.logger.debug("Getting token",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"getToken",hasCachedToken:!!this.cachedToken}),this.cachedToken)return this.logger.debug("Returning cached token",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"getToken"}),this.cachedToken;const e=await this.loadTokenFromStorage();return e?(this.logger.debug("Token loaded from storage, caching it",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"getToken"}),this.cachedToken=e,e):(this.logger.debug("No token found in cache or storage",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"getToken"}),null)}onAuthStateChanged(e){this.authListeners.add(e)}removeAuthStateListener(e){this.authListeners.delete(e)}notifyAuthListeners(e){this.authListeners.forEach(t=>{try{t(e)}catch(n){this.logger.error("Error in auth state callback",n,{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"notifyAuthListeners"})}})}async isAuthenticated(){console.log(" [OutlookAuthProvider] Checking authentication status"),this.logger.info("Checking authentication status",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"isAuthenticated"});const e=await this.getToken();if(!e)return console.log(" [OutlookAuthProvider] No token found"),this.logger.info("No token found - user is not authenticated",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"isAuthenticated"}),!1;const t=this.isTokenValid(e);if(console.log(" [OutlookAuthProvider] Token valid?",t),!t){console.log(" [OutlookAuthProvider] Token is expired or expiring soon, attempting refresh"),this.logger.info("Token is expired or expiring soon, attempting refresh",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"isAuthenticated",tokenExpiry:e.expires_in,fetchedAt:e.fetched_at});try{return console.log(" [OutlookAuthProvider] Calling refreshToken()..."),await this.refreshToken(e),console.log(" [OutlookAuthProvider] Token refreshed successfully!"),this.logger.info("Token refreshed successfully during authentication check",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"isAuthenticated"}),!0}catch(n){return console.error(" [OutlookAuthProvider] Token refresh failed:",n),this.logger.error("Token refresh failed during authentication check",n,{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"isAuthenticated"}),!1}}return this.logger.info("Authentication status checked - token is valid",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"isAuthenticated",hasToken:!!e,isValid:t,tokenExpiry:e.expires_in,fetchedAt:e.fetched_at}),!0}async validateToken(e){const t=await this.getToken();return t?this.isTokenValid(t):!1}isTokenValid(e){if(!e||!e.expires_in)return!1;const t=Math.floor(Date.now()),n=e.fetched_at||0,s=n+e.expires_in*1e3,i=s-t<3e5;return this.logger.debug("Token validation",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"isTokenValid",currentTime:t,fetchedAt:n,expiresIn:e.expires_in,tokenExpiry:s,isExpired:i,timeUntilExpiry:s-t}),!i}async refreshToken(e){console.log(" [OutlookAuthProvider.refreshToken] Starting token refresh using REFRESH_TOKEN_AUTH"),this.logger.info("Refreshing token using refresh_token",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"refreshToken"});try{const t=new Ub({region:gC}),n=new H_({ClientId:gh,AuthFlow:"REFRESH_TOKEN_AUTH",AuthParameters:{REFRESH_TOKEN:e.refresh_token}});console.log(" [OutlookAuthProvider.refreshToken] Sending refresh request to AWS Cognito"),this.logger.debug("Sending refresh token request to Cognito",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"refreshToken"});const s=await t.send(n);console.log(" [OutlookAuthProvider.refreshToken] Received response from Cognito");const i=s.AuthenticationResult;if(!i)throw new Error("AuthenticationResult is missing in the response.");const{IdToken:c,AccessToken:d,RefreshToken:p,ExpiresIn:m,TokenType:g}=i;if(!c||!d||!m||!g)throw new Error("Missing required fields in AuthenticationResult.");const x={id_token:c,access_token:d,refresh_token:p||e.refresh_token,expires_in:m,token_type:g,fetched_at:Math.floor(Date.now())};return this.logger.info("Token refreshed successfully",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"refreshToken",newExpiresIn:m}),this.cachedToken=x,await this.saveToken(x),this.notifyAuthListeners(!0),x}catch(t){return this.logger.error("Token refresh failed, falling back to full re-login",t,{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"refreshToken"}),this.login()}}async saveToken(e){await this.storageProvider.setLocalItem("token",e)}async loadTokenFromStorage(){this.logger.debug("Loading token from storage",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"loadTokenFromStorage"});try{const e=await this.storageProvider.getLocalItem("token");if(!e)return this.logger.debug("No token found in storage",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"loadTokenFromStorage"}),null;const t=e;return this.logger.debug("Token successfully loaded from storage",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"loadTokenFromStorage",hasToken:!!t,fetchedAt:t==null?void 0:t.fetched_at,expiresIn:t==null?void 0:t.expires_in}),t}catch(e){return this.logger.warn("Failed to load token from storage",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"loadTokenFromStorage",error:e}),null}}async deleteToken(){await this.storageProvider.removeLocalItem("token")}parseAccessTokenFromOAuthResponse(e){try{let t=e;e.includes("#")&&(t=e.split("#")[1]);const n=new URLSearchParams(t),s=n.get("access_token");if(!s)return this.logger.error("No access_token found in OAuth response",new Error("Missing access token"),{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"parseAccessTokenFromOAuthResponse",responseUrl:e,fragment:t}),null;const i=n.get("error");if(i){const c=n.get("error_description")||"Unknown OAuth error";throw new Error(`OAuth error: ${i} - ${c}`)}return s}catch(t){return this.logger.error("Failed to parse OAuth response",t,{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"parseAccessTokenFromOAuthResponse",responseUrl:e}),null}}}class x5{constructor(e){H(this,"logger");this.logger=e}async sendMessage(e){return this.logger.debug("Sending message in Outlook context",{sourceFile:"src/platforms/outlook/OutlookMessagingProvider.ts",sourceFunction:"sendMessage",message:e}),Promise.resolve(e)}onMessage(e){this.logger.debug("Registering message callback in Outlook context",{sourceFile:"src/platforms/outlook/OutlookMessagingProvider.ts",sourceFunction:"onMessage"})}removeMessageListener(e){this.logger.debug("Removing message listener in Outlook context",{sourceFile:"src/platforms/outlook/OutlookMessagingProvider.ts",sourceFunction:"removeMessageListener"})}async sendOfficeNotification(e){try{typeof Office<"u"&&Office.context&&Office.context.ui&&Office.context.ui.displayDialogAsync(`data:text/html,<html><body><p>${e}</p></body></html>`,{height:20,width:40},t=>{t.status===Office.AsyncResultStatus.Succeeded&&setTimeout(()=>t.value.close(),3e3)})}catch(t){this.logger.error("Error showing Office notification",t,{sourceFile:"src/platforms/outlook/OutlookMessagingProvider.ts",sourceFunction:"sendOfficeNotification"})}}}class w5{constructor(e){H(this,"logger");H(this,"eventListeners",new Map);H(this,"isInitialized",!1);this.logger=e}async initialize(){if(this.isInitialized){this.logger.info("Outlook platform already initialized",{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"initialize"});return}try{this.logger.info("Initializing Outlook platform...",{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"initialize"}),await this.waitForOfficeReady(),this.setupOutlookEventListeners();try{const e=JSON.stringify(ZN);localStorage.setItem("CONFIG_VERIFICATION",e),this.logger.info(`[Debug] Saved CONFIG_VERIFICATION='${e}' to localStorage.`,{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"initialize"})}catch(e){this.logger.warn("[Debug] Could not save CONFIG_VERIFICATION to localStorage.",e,{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"initialize"})}this.isInitialized=!0,this.logger.info("Outlook platform initialized successfully",{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"initialize"})}catch(e){throw this.logger.error("Failed to initialize Outlook platform",e,{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"initialize"}),e}}async cleanup(){try{this.logger.info("Cleaning up Outlook platform...",{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"cleanup"}),this.eventListeners.clear(),this.isInitialized=!1,this.logger.info("Outlook platform cleanup completed",{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"cleanup"})}catch(e){throw this.logger.error("Failed to cleanup Outlook platform",e,{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"cleanup"}),e}}async closeWindow(){this.logger.debug("Window close requested (no-op for Outlook)",{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"closeWindow"})}onPlatformEvent(e,t){this.eventListeners.has(e)||this.eventListeners.set(e,new Set),this.eventListeners.get(e).add(t)}async waitForOfficeReady(){return new Promise(e=>{typeof Office<"u"&&Office.onReady?Office.onReady(()=>{e()}):e()})}setupOutlookEventListeners(){var e;typeof Office<"u"&&Office.context&&(e=Office.context.mailbox)!=null&&e.addHandlerAsync&&Office.context.mailbox.addHandlerAsync(Office.EventType.ItemChanged,this.handleItemChanged.bind(this),t=>{t.status===Office.AsyncResultStatus.Failed&&this.logger.error("Failed to add item changed handler",t.error,{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"setupOutlookEventListeners"})})}handleItemChanged(){this.emitPlatformEvent("itemChanged")}emitPlatformEvent(e,...t){const n=this.eventListeners.get(e);n&&n.forEach(s=>{try{s(...t)}catch(i){this.logger.error(`Error in platform event callback for ${e}`,i,{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"emitPlatformEvent",event:e})}})}}class b5{constructor(e){H(this,"logger");this.logger=e}getResourceURL(e){return this.logger.debug("getResourceURL called in Outlook context",{sourceFile:"src/platforms/outlook/OutlookTabsProvider.ts",sourceFunction:"getResourceURL",path:e}),e.includes("options.html")?eh:""}async getCurrentTab(){return this.logger.debug("getCurrentTab called in Outlook context",{sourceFile:"src/platforms/outlook/OutlookTabsProvider.ts",sourceFunction:"getCurrentTab"}),{id:1,windowId:1,index:0,url:window.location.href,title:document.title||"Outlook Add-in",active:!0,highlighted:!0,pinned:!1,incognito:!1}}async createTab(e,t){return this.logger.debug("createTab called in Outlook context",{sourceFile:"src/platforms/outlook/OutlookTabsProvider.ts",sourceFunction:"createTab",url:e}),window.open(e,"_blank"),{id:Date.now(),windowId:1,index:0,url:e,title:"New Tab",active:!0,highlighted:!0,pinned:!1,incognito:!1}}async updateTab(e,t){this.logger.debug("updateTab called in Outlook context - this is a no-op",{sourceFile:"src/platforms/outlook/OutlookTabsProvider.ts",sourceFunction:"updateTab"})}async closeTab(e){this.logger.debug("closeTab called in Outlook context - this is a no-op",{sourceFile:"src/platforms/outlook/OutlookTabsProvider.ts",sourceFunction:"closeTab"})}onTabUpdated(e){this.logger.debug("onTabUpdated called in Outlook context - this is a no-op",{sourceFile:"src/platforms/outlook/OutlookTabsProvider.ts",sourceFunction:"onTabUpdated"})}removeTabUpdateListener(e){this.logger.debug("removeTabUpdateListener called in Outlook context - this is a no-op",{sourceFile:"src/platforms/outlook/OutlookTabsProvider.ts",sourceFunction:"removeTabUpdateListener"})}async openURL(e,t="_blank"){this.logger.debug("openURL called in Outlook context",{sourceFile:"src/platforms/outlook/OutlookTabsProvider.ts",sourceFunction:"openURL",url:e,target:t}),window.open(e,t)}async openOptionsPage(){this.logger.debug("openOptionsPage called in Outlook context",{sourceFile:"src/platforms/outlook/OutlookTabsProvider.ts",sourceFunction:"openOptionsPage"});const e=await Ow(this.logger);let t=eh;e!=null&&e.id_token&&(t+=`?token=${e.id_token}`),window.open(t,"_blank")}}const Tx=32*1024;class _5{constructor(e){H(this,"logger");this.logger=e}truncateHtmlForReplyForm(e){const n=new TextEncoder().encode(e);if(n.length<=Tx)return e;this.logger.warn("HTML content exceeds 32 KB limit for reply form, truncating",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"truncateHtmlForReplyForm",originalSize:n.length,maxSize:Tx});let i=new TextDecoder().decode(n.slice(0,Tx-100));const c=Math.max(i.lastIndexOf("</p>"),i.lastIndexOf("</div>"),i.lastIndexOf("</li>"),i.lastIndexOf("<br>"));return c>i.length/2&&(i=i.substring(0,c+(i.includes("</p>")?4:i.includes("</div>")?6:i.includes("</li>")?5:4))),i+='<p style="color: gray; font-style: italic;">[Content truncated due to size limit]</p>',i}detectItemMode(){var e,t;try{if(!((t=(e=Office==null?void 0:Office.context)==null?void 0:e.mailbox)!=null&&t.item))return"unknown";const n=Office.context.mailbox.item;if(!n.itemId)return this.logger.debug("Detected compose mode (no itemId)",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"detectItemMode"}),"compose";const s=n.to;return s&&typeof s.setAsync=="function"?(this.logger.debug("Detected compose mode (to.setAsync exists)",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"detectItemMode"}),"compose"):(this.logger.debug("Detected read mode",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"detectItemMode"}),"read")}catch(n){return this.logger.warn("Error detecting item mode",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"detectItemMode",error:n}),"unknown"}}async executeScript(e){throw this.logger.warn("Script execution not implemented for Outlook context",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"executeScript"}),new Error("Script execution not available in Outlook context")}async injectScript(e){this.logger.warn("Script injection not applicable in Outlook context",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"injectScript"})}async insertContentIntoComposeBox(e){var t;try{const n=Yv(e);if(typeof Office<"u"&&Office.context&&Office.context.mailbox){const s=this.detectItemMode();this.logger.debug("Inserting content into compose box",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"insertContentIntoComposeBox",mode:s}),s==="compose"?(t=Office.context.mailbox.item)==null||t.body.setSelectedDataAsync(n,{coercionType:Office.CoercionType.Html},i=>{i.status===Office.AsyncResultStatus.Failed?(this.logger.error("Failed to insert content using setSelectedDataAsync, falling back to reply-all",i.error,{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"insertContentIntoComposeBox"}),this.replyAllWithContent(e)):this.logger.info("Successfully inserted content at cursor position",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"insertContentIntoComposeBox"})}):(this.logger.info("In read mode - creating reply-all with content",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"insertContentIntoComposeBox"}),await this.replyAllWithContent(e))}else this.logger.warn("Office.js context not available",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"insertContentIntoComposeBox"})}catch(n){throw this.logger.error("Error inserting content into compose box",n,{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"insertContentIntoComposeBox"}),n}}async replyWithContent(e){try{const t=Yv(e),n=this.truncateHtmlForReplyForm(t);if(typeof Office<"u"&&Office.context&&Office.context.mailbox&&Office.context.mailbox.item){const s=Office.context.mailbox.item;if(typeof s.displayReplyFormAsync=="function")return new Promise((i,c)=>{s.displayReplyFormAsync(n,d=>{d.status===Office.AsyncResultStatus.Succeeded?(this.logger.info("Successfully displayed reply form with content (async)",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyWithContent"}),i()):(this.logger.error("Failed to display reply form (async)",d.error,{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyWithContent"}),c(d.error))})});s.displayReplyForm(n),this.logger.info("Successfully displayed reply form with content",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyWithContent"})}else this.logger.warn("Office.js context not available",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyWithContent"})}catch(t){throw this.logger.error("Error displaying reply form with content",t,{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyWithContent"}),t}}async replyAllWithContent(e){try{const t=Yv(e),n=this.truncateHtmlForReplyForm(t);if(this.logger.debug("Attempting to display reply all form",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyAllWithContent",contentLength:n.length,contentPreview:n.substring(0,200)}),typeof Office<"u"&&Office.context&&Office.context.mailbox&&Office.context.mailbox.item){const s=Office.context.mailbox.item;if(typeof s.displayReplyAllFormAsync=="function")return new Promise((i,c)=>{s.displayReplyAllFormAsync(n,d=>{d.status===Office.AsyncResultStatus.Succeeded?(this.logger.info("Successfully displayed reply all form with content (async)",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyAllWithContent"}),i()):(this.logger.error("Failed to display reply all form (async)",d.error,{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyAllWithContent"}),c(d.error))})});s.displayReplyAllForm(n),this.logger.info("Successfully displayed reply all form with content",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyAllWithContent"})}else this.logger.warn("Office.js context not available",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyAllWithContent"})}catch(t){throw this.logger.error("Error displaying reply all form with content",t,{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyAllWithContent"}),t}}}const vC={ERROR:1,WARN:2,INFO:3,DEBUG:4};class E5{constructor(e){H(this,"context");H(this,"minLevel");this.context=e||"unknown",this.minLevel="INFO"}shouldLog(e){return vC[e]<=vC[this.minLevel]}formatMessage(e,t,n){const s=(n==null?void 0:n.sourceFile)||"unknown",i=n==null?void 0:n.sourceFunction;return`[${e}] [Outlook:${this.context}] [${s}${i?` (${i})`:""}]: ${t}`}async debug(e,t){if(!this.shouldLog("DEBUG"))return;const n=this.formatMessage("DEBUG",e,t),{sourceFile:s,sourceFunction:i,...c}=t||{},d=[n];Object.keys(c).length>0&&d.push(c),console.debug(...d)}async info(e,t){if(!this.shouldLog("INFO"))return;const n=this.formatMessage("INFO",e,t),{sourceFile:s,sourceFunction:i,...c}=t||{},d=[n];Object.keys(c).length>0&&d.push(c),console.info(...d)}async warn(e,t){if(!this.shouldLog("WARN"))return;const n=this.formatMessage("WARN",e,t),{sourceFile:s,sourceFunction:i,...c}=t||{},d=[n];Object.keys(c).length>0&&d.push(c),console.warn(...d)}async error(e,t,n){if(!this.shouldLog("ERROR"))return;const s=this.formatMessage("ERROR",e,n),{sourceFile:i,sourceFunction:c,...d}=n||{},p=[s];t&&p.push(t),Object.keys(d).length>0&&p.push(d),console.error(...p)}setMinLevel(e){this.minLevel=e}getMinLevel(){return this.minLevel}getUnderlyingLogger(){return{context:this.context,minLevel:this.minLevel,writeLog:async(e,t,n,s)=>{switch(e){case"DEBUG":return this.debug(t,n);case"INFO":return this.info(t,n);case"WARN":return this.warn(t,n);case"ERROR":return this.error(t,s,n)}},_triggerCleanupCheck:()=>{},debug:(e,t)=>this.debug(e,t),info:(e,t)=>this.info(e,t),warn:(e,t)=>this.warn(e,t),error:(e,t,n)=>this.error(e,t,n)}}}function S5(){const r=new E5("background"),e=new XU(r);return{storage:e,data:new QU(r),auth:new y5(r,e),messaging:new x5(r),lifecycle:new w5(r),tabs:new b5(r),contentScript:new _5(r),identity:new dT(r),logging:r}}const Ps=class Ps{static async createServices(e){const t=e||Ps.detectPlatform();if(Ps.instance&&Ps.currentPlatform===t)return Ps.instance;let n;if(t==="chrome"){const s=Ps.detectExecutionContext();n=JU(s)}else if(t==="outlook")n=S5();else throw new Error(`Unsupported platform: ${t}`);return await n.lifecycle.initialize(),Ps.instance=n,Ps.currentPlatform=t,n}static detectPlatform(){if(typeof chrome<"u"&&chrome.runtime&&chrome.runtime.id)return"chrome";if(typeof Office<"u"&&Office.context)return"outlook";throw new Error("Unable to detect platform. Neither Chrome nor Office APIs available.")}static detectExecutionContext(){if(typeof chrome<"u"&&chrome.runtime&&chrome.runtime.id){if(typeof document>"u")return"background";try{if(typeof window<"u"&&window.location){const e=window.location.href;return e.includes("options.html")?"options":e.includes("popup.html")?"popup":"content"}}catch{return"content"}return"content"}return"unknown"}static getCurrentPlatform(){return Ps.currentPlatform}static async resetInstance(){Ps.instance&&(await Ps.instance.lifecycle.cleanup(),Ps.instance=null,Ps.currentPlatform=null)}};H(Ps,"instance",null),H(Ps,"currentPlatform",null);let Vn=Ps;const Y_=w.createContext({platform:"unassigned",services:null,isLoading:!0,error:null});function C5({children:r}){const[e,t]=w.useState("unassigned"),[n,s]=w.useState(null),[i,c]=w.useState(!0),[d,p]=w.useState(null),m=w.useCallback(async g=>{if(g!=null&&g.lifecycle)try{await g.lifecycle.cleanup()}catch(x){console.error("Error during platform cleanup",x,{sourceFile:"src/platforms/PlatformContext.tsx",sourceFunction:"cleanup"})}},[]);return w.useEffect(()=>{let g=null;async function x(){try{console.info("Initializing platform services...",{sourceFile:"src/platforms/PlatformContext.tsx",sourceFunction:"initializePlatform"});const b=await Vn.createServices();if(g=b,t(Vn.getCurrentPlatform()||"unassigned"),Vn.getCurrentPlatform()==="unassigned")throw new Error("Platform not supported");await b.lifecycle.initialize(),s(b),p(null),console.info("Platform services initialized successfully",{sourceFile:"src/platforms/PlatformContext.tsx",sourceFunction:"initializePlatform"})}catch(b){const E=b instanceof Error?b.message:"Unknown error occurred";console.error("Failed to initialize platform services",b,{sourceFile:"src/platforms/PlatformContext.tsx",sourceFunction:"initializePlatform"}),p(E)}finally{c(!1)}}return x(),()=>{g&&m(g)}},[m]),u.jsx(Y_.Provider,{value:{platform:e,services:n,isLoading:i,error:d},children:i?u.jsx("div",{className:"flex items-center justify-center h-full",children:u.jsx("div",{className:"text-sm text-gray-600",children:"Initializing platform..."})}):d?u.jsx("div",{className:"flex items-center justify-center h-full",children:u.jsxs("div",{className:"text-sm text-red-600",children:["Error: ",d]})}):r})}const fT=w.createContext(void 0),ra=()=>{const r=w.useContext(fT);if(r===void 0)throw console.error("useGmailConnection hook called outside of GmailConnectionProvider"),console.error("Component stack:",new Error().stack),new Error("useGmailConnection must be used within a GmailConnectionProvider. Check that the component using this hook is properly wrapped in the provider hierarchy.");return r},hr="src/lib/utils/cacheUtils.ts",k5=100,N5=1440*60*1e3,T5=100,R5=3600*1e3,A5=100,I5=1440*60*1e3,P5=100,F5=3600*1e3,j5=50,O5=1800*1e3,D5=3600*1e3*24,$t={EMAIL_SUMMARY:"cache_email_summary_",EMAIL_SUMMARY_INDEX:"cache_email_summary_index",DOCUMENTS:"cache_documents_",DOCUMENTS_INDEX:"cache_documents_index",PROJECT_DOCUMENTS:"cache_project_documents_",PROJECT_DOCUMENTS_INDEX:"cache_project_documents_index",NON_EXISTENT_CLIENT:"cache_non_existent_client_",NON_EXISTENT_CLIENT_INDEX:"cache_non_existent_client_index",CLIENT:"cache_client_",CLIENT_INDEX:"cache_client_index",GENERATED_RESPONSE:"cache_generated_response_",GENERATED_RESPONSE_INDEX:"cache_generated_response_index",FIRM_USERS:"firm_users"},L5=30*1e3,Lm=new Map;function M5(r){const e=r.toLowerCase(),t=Lm.get(e);return t?Date.now()-t.timestamp>L5?(Lm.delete(e),{inCache:!1}):{inCache:!0,errorType:t.errorType}:{inCache:!1}}function yC(r,e){const t=r.toLowerCase();Lm.set(t,{timestamp:Date.now(),errorType:e})}function hT(r){const e=r.toLowerCase();Lm.delete(e)}function $5(){Lm.clear()}async function ns(r){try{return(await Vn.createServices()).storage}catch(e){return r.warn("Platform detection failed, storage unavailable",{sourceFile:hr,error:e}),null}}async function Zm(r,e,t,n,s){try{const i=await r.getLocalItem(e)||[];if(i.length>=n){i.sort((d,p)=>d.timestamp-p.timestamp);const c=i.splice(0,i.length-n+1);for(const d of c)await r.removeLocalItem(d.key);await r.setLocalItem(e,i)}}catch(i){s.warn("Error managing cache size",{sourceFile:hr,error:i})}}async function eg(r,e,t,n,s){try{const i=await r.getLocalItem(e)||[],c=i.findIndex(d=>d.key===t);c!==-1&&i.splice(c,1),i.push({key:t,timestamp:n}),await r.setLocalItem(e,i)}catch(i){s.warn("Error updating cache index",{sourceFile:hr,error:i})}}async function pT(r){await Promise.all([H5(r),B5(r),V5(r),yT(r),Y5(r)])}async function U5(r,e,t,n){try{const s=await ns(n);if(!s)return;const i=`${$t.EMAIL_SUMMARY}${r}`,c=Date.now();await Zm(s,$t.EMAIL_SUMMARY_INDEX,$t.EMAIL_SUMMARY,k5,n);const d={summary:e,importantDetails:t,timestamp:c};await s.setLocalItem(i,d),await eg(s,$t.EMAIL_SUMMARY_INDEX,i,c,n),n.debug("Added to summary cache",{sourceFile:hr,functionName:"addToSummaryCache",threadId:r})}catch(s){n.warn("Error adding to summary cache",{sourceFile:hr,functionName:"addToSummaryCache",threadId:r,error:s})}}async function z5(r,e){try{const t=await ns(e);if(!t)return null;const n=`${$t.EMAIL_SUMMARY}${r}`,s=await t.getLocalItem(n);return s?Date.now()-s.timestamp>N5?(await t.removeLocalItem(n),null):s:null}catch(t){return e.warn("Error getting from summary cache",{sourceFile:hr,functionName:"getFromSummaryCache",threadId:r,error:t}),null}}async function H5(r){try{const e=await ns(r);if(!e)return;const t=await e.getLocalItem($t.EMAIL_SUMMARY_INDEX)||[];for(const n of t)await e.removeLocalItem(n.key);await e.removeLocalItem($t.EMAIL_SUMMARY_INDEX),r.debug("Summary cache cleared",{sourceFile:hr,functionName:"clearSummaryCache"})}catch(e){r.warn("Error clearing summary cache",{sourceFile:hr,functionName:"clearSummaryCache",error:e})}}async function mT(r,e,t){try{const n=await ns(t);if(!n)return;const s=`${$t.PROJECT_DOCUMENTS}${r}`,i=Date.now();await Zm(n,$t.PROJECT_DOCUMENTS_INDEX,$t.PROJECT_DOCUMENTS,T5,t);const c={documents:e,timestamp:i};await n.setLocalItem(s,c),await eg(n,$t.PROJECT_DOCUMENTS_INDEX,s,i,t),t.debug("Added to project document cache",{sourceFile:hr,functionName:"addToProjectDocumentCache",projectId:r})}catch(n){t.warn("Error adding to project document cache",{sourceFile:hr,functionName:"addToProjectDocumentCache",projectId:r,error:n})}}async function gT(r,e){try{const t=await ns(e);if(!t)return null;e.debug("Getting documents from project document cache",{sourceFile:hr,functionName:"getFromProjectDocumentCache",projectId:r});const n=`${$t.PROJECT_DOCUMENTS}${r}`,s=await t.getLocalItem(n);return s?Date.now()-s.timestamp>R5?(await t.removeLocalItem(n),null):s.documents:null}catch(t){return e.warn("Error getting from project document cache",{sourceFile:hr,functionName:"getFromProjectDocumentCache",projectId:r,error:t}),null}}async function B5(r){try{const e=await ns(r);if(!e)return;const t=await e.getLocalItem($t.DOCUMENTS_INDEX)||[];for(const n of t)await e.removeLocalItem(n.key);await e.removeLocalItem($t.DOCUMENTS_INDEX),r.debug("Document cache cleared",{sourceFile:hr,functionName:"clearDocumentCache"})}catch(e){r.warn("Error clearing document cache",{sourceFile:hr,functionName:"clearDocumentCache",error:e})}}async function G5(r,e){try{const t=await ns(e);if(!t)return;const n=r.toLowerCase(),s=`${$t.NON_EXISTENT_CLIENT}${n}`,i=Date.now();await Zm(t,$t.NON_EXISTENT_CLIENT_INDEX,$t.NON_EXISTENT_CLIENT,A5,e),await t.setLocalItem(s,i),await eg(t,$t.NON_EXISTENT_CLIENT_INDEX,s,i,e),e.debug("Added to non-existent client cache",{sourceFile:hr,functionName:"addToNonExistentClientCache",email:n})}catch(t){e.warn("Error adding to non-existent client cache",{sourceFile:hr,functionName:"addToNonExistentClientCache",email:r,error:t})}}async function W5(r,e){try{const t=await ns(e);if(!t)return!1;const n=r.toLowerCase(),s=`${$t.NON_EXISTENT_CLIENT}${n}`,i=await t.getLocalItem(s);return i?Date.now()-i>I5?(await t.removeLocalItem(s),!1):!0:!1}catch(t){return e.warn("Error checking non-existent client cache",{sourceFile:hr,functionName:"isInNonExistentClientCache",email:r,error:t}),!1}}async function V5(r){try{const e=await ns(r);if(!e)return;const t=await e.getLocalItem($t.NON_EXISTENT_CLIENT_INDEX)||[];for(const n of t)await e.removeLocalItem(n.key);await e.removeLocalItem($t.NON_EXISTENT_CLIENT_INDEX),r.debug("Non-existent client cache cleared",{sourceFile:hr,functionName:"clearNonExistentClientCache"})}catch(e){r.warn("Error clearing non-existent client cache",{sourceFile:hr,functionName:"clearNonExistentClientCache",error:e})}}async function q5(r,e,t){try{const n=await ns(t);if(!n)return;const s=r.toLowerCase(),i=`${$t.CLIENT}${s}`,c=Date.now();await Zm(n,$t.CLIENT_INDEX,$t.CLIENT,P5,t);const d={data:e,timestamp:c};await n.setLocalItem(i,d),await eg(n,$t.CLIENT_INDEX,i,c,t),t.debug("Added to client cache",{sourceFile:hr,functionName:"addToClientCache",clientEmail:s})}catch(n){t.warn("Error adding to client cache",{sourceFile:hr,functionName:"addToClientCache",clientEmail:r,error:n})}}async function vT(r,e){try{const t=await ns(e);if(!t)return null;const n=r.toLowerCase();e.debug("Getting client info from client cache",{sourceFile:hr,functionName:"getFromClientCache",clientEmail:n});const s=`${$t.CLIENT}${n}`,i=await t.getLocalItem(s);return i?Date.now()-i.timestamp>F5?(await t.removeLocalItem(s),null):i.data:null}catch(t){return e.warn("Error getting from client cache",{sourceFile:hr,functionName:"getFromClientCache",clientEmail:r,error:t}),null}}async function yT(r){try{const e=await ns(r);if(!e)return;const t=await e.getLocalItem($t.CLIENT_INDEX)||[];for(const n of t)await e.removeLocalItem(n.key);await e.removeLocalItem($t.CLIENT_INDEX),r.debug("Client cache cleared",{sourceFile:hr,functionName:"clearClientCache"})}catch(e){r.warn("Error clearing client cache",{sourceFile:hr,functionName:"clearClientCache",error:e})}}async function $w(r,e){try{const t=await ns(e);if(!t)return;const n=r.toLowerCase();hT(n);const s=`${$t.CLIENT}${n}`;await t.removeLocalItem(s);const i=await t.getLocalItem($t.CLIENT_INDEX)||[],c=i.filter(E=>E.key!==s);c.length!==i.length&&await t.setLocalItem($t.CLIENT_INDEX,c);const d=`${$t.NON_EXISTENT_CLIENT}${n}`;await t.removeLocalItem(d);const p=await t.getLocalItem($t.NON_EXISTENT_CLIENT_INDEX)||[],m=p.filter(E=>E.key!==d);m.length!==p.length&&await t.setLocalItem($t.NON_EXISTENT_CLIENT_INDEX,m);const g=`${$t.DOCUMENTS}${n}`;await t.removeLocalItem(g);const x=await t.getLocalItem($t.DOCUMENTS_INDEX)||[],b=x.filter(E=>E.key!==g);b.length!==x.length&&await t.setLocalItem($t.DOCUMENTS_INDEX,b),e.debug("Cleared all cached data for client email",{sourceFile:hr,functionName:"clearClientDataForEmail",clientEmail:n})}catch(t){e.warn("Error clearing client data for email",{sourceFile:hr,functionName:"clearClientDataForEmail",clientEmail:r,error:t})}}async function xC(r,e,t,n,s){try{const i=await ns(s);if(!i)return;const c=`${$t.GENERATED_RESPONSE}${r}`,d=Date.now();await Zm(i,$t.GENERATED_RESPONSE_INDEX,$t.GENERATED_RESPONSE,j5,s);const p={response:e,references:t,cmsData:n,timestamp:d};await i.setLocalItem(c,p),await eg(i,$t.GENERATED_RESPONSE_INDEX,c,d,s),s.debug("Added to generated response cache",{sourceFile:hr,functionName:"addToGeneratedResponseCache",cacheKey:r})}catch(i){s.warn("Error adding to generated response cache",{sourceFile:hr,functionName:"addToGeneratedResponseCache",cacheKey:r,error:i})}}async function K5(r,e){try{const t=await ns(e);if(!t)return null;e.debug("Getting generated response from cache",{sourceFile:hr,functionName:"getFromGeneratedResponseCache",cacheKey:r});const n=`${$t.GENERATED_RESPONSE}${r}`,s=await t.getLocalItem(n);return s?Date.now()-s.timestamp>O5?(await t.removeLocalItem(n),null):s:null}catch(t){return e.warn("Error getting from generated response cache",{sourceFile:hr,functionName:"getFromGeneratedResponseCache",cacheKey:r,error:t}),null}}async function xT(r,e){try{const t=await ns(e);if(!t)return;const n={users:r,timestamp:Date.now()};await t.setLocalItem($t.FIRM_USERS,n),e.debug("Added to firm users cache",{sourceFile:hr,functionName:"addToFirmUsersCache",count:r.length})}catch(t){e.warn("Error adding to firm users cache",{sourceFile:hr,functionName:"addToFirmUsersCache",error:t})}}async function wT(r){try{const e=await ns(r);if(!e)return null;const t=await e.getLocalItem($t.FIRM_USERS);return t?Date.now()-t.timestamp>D5?(await e.removeLocalItem($t.FIRM_USERS),null):t.users:null}catch(e){return r.warn("Error getting from firm users cache",{sourceFile:hr,functionName:"getFromFirmUsersCache",error:e}),null}}async function Y5(r){try{const e=await ns(r);if(!e)return;const t=await e.getLocalItem($t.GENERATED_RESPONSE_INDEX)||[];for(const n of t)await e.removeLocalItem(n.key);await e.removeLocalItem($t.GENERATED_RESPONSE_INDEX),r.debug("Generated response cache cleared",{sourceFile:hr,functionName:"clearGeneratedResponseCache"})}catch(e){r.warn("Error clearing generated response cache",{sourceFile:hr,functionName:"clearGeneratedResponseCache",error:e})}}function bT(r){var e,t,n="";if(typeof r=="string"||typeof r=="number")n+=r;else if(typeof r=="object")if(Array.isArray(r)){var s=r.length;for(e=0;e<s;e++)r[e]&&(t=bT(r[e]))&&(n&&(n+=" "),n+=t)}else for(t in r)r[t]&&(n&&(n+=" "),n+=t);return n}function _T(){for(var r,e,t=0,n="",s=arguments.length;t<s;t++)(r=arguments[t])&&(e=bT(r))&&(n&&(n+=" "),n+=e);return n}const J_="-",J5=r=>{const e=Q5(r),{conflictingClassGroups:t,conflictingClassGroupModifiers:n}=r;return{getClassGroupId:c=>{const d=c.split(J_);return d[0]===""&&d.length!==1&&d.shift(),ET(d,e)||X5(c)},getConflictingClassGroupIds:(c,d)=>{const p=t[c]||[];return d&&n[c]?[...p,...n[c]]:p}}},ET=(r,e)=>{var c;if(r.length===0)return e.classGroupId;const t=r[0],n=e.nextPart.get(t),s=n?ET(r.slice(1),n):void 0;if(s)return s;if(e.validators.length===0)return;const i=r.join(J_);return(c=e.validators.find(({validator:d})=>d(i)))==null?void 0:c.classGroupId},wC=/^\[(.+)\]$/,X5=r=>{if(wC.test(r)){const e=wC.exec(r)[1],t=e==null?void 0:e.substring(0,e.indexOf(":"));if(t)return"arbitrary.."+t}},Q5=r=>{const{theme:e,prefix:t}=r,n={nextPart:new Map,validators:[]};return e6(Object.entries(r.classGroups),t).forEach(([i,c])=>{Uw(c,n,i,e)}),n},Uw=(r,e,t,n)=>{r.forEach(s=>{if(typeof s=="string"){const i=s===""?e:bC(e,s);i.classGroupId=t;return}if(typeof s=="function"){if(Z5(s)){Uw(s(n),e,t,n);return}e.validators.push({validator:s,classGroupId:t});return}Object.entries(s).forEach(([i,c])=>{Uw(c,bC(e,i),t,n)})})},bC=(r,e)=>{let t=r;return e.split(J_).forEach(n=>{t.nextPart.has(n)||t.nextPart.set(n,{nextPart:new Map,validators:[]}),t=t.nextPart.get(n)}),t},Z5=r=>r.isThemeGetter,e6=(r,e)=>e?r.map(([t,n])=>{const s=n.map(i=>typeof i=="string"?e+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([c,d])=>[e+c,d])):i);return[t,s]}):r,t6=r=>{if(r<1)return{get:()=>{},set:()=>{}};let e=0,t=new Map,n=new Map;const s=(i,c)=>{t.set(i,c),e++,e>r&&(e=0,n=t,t=new Map)};return{get(i){let c=t.get(i);if(c!==void 0)return c;if((c=n.get(i))!==void 0)return s(i,c),c},set(i,c){t.has(i)?t.set(i,c):s(i,c)}}},ST="!",r6=r=>{const{separator:e,experimentalParseClassName:t}=r,n=e.length===1,s=e[0],i=e.length,c=d=>{const p=[];let m=0,g=0,x;for(let N=0;N<d.length;N++){let R=d[N];if(m===0){if(R===s&&(n||d.slice(N,N+i)===e)){p.push(d.slice(g,N)),g=N+i;continue}if(R==="/"){x=N;continue}}R==="["?m++:R==="]"&&m--}const b=p.length===0?d:d.substring(g),E=b.startsWith(ST),T=E?b.substring(1):b,S=x&&x>g?x-g:void 0;return{modifiers:p,hasImportantModifier:E,baseClassName:T,maybePostfixModifierPosition:S}};return t?d=>t({className:d,parseClassName:c}):c},n6=r=>{if(r.length<=1)return r;const e=[];let t=[];return r.forEach(n=>{n[0]==="["?(e.push(...t.sort(),n),t=[]):t.push(n)}),e.push(...t.sort()),e},s6=r=>({cache:t6(r.cacheSize),parseClassName:r6(r),...J5(r)}),o6=/\s+/,i6=(r,e)=>{const{parseClassName:t,getClassGroupId:n,getConflictingClassGroupIds:s}=e,i=[],c=r.trim().split(o6);let d="";for(let p=c.length-1;p>=0;p-=1){const m=c[p],{modifiers:g,hasImportantModifier:x,baseClassName:b,maybePostfixModifierPosition:E}=t(m);let T=!!E,S=n(T?b.substring(0,E):b);if(!S){if(!T){d=m+(d.length>0?" "+d:d);continue}if(S=n(b),!S){d=m+(d.length>0?" "+d:d);continue}T=!1}const N=n6(g).join(":"),R=x?N+ST:N,A=R+S;if(i.includes(A))continue;i.push(A);const j=s(S,T);for(let P=0;P<j.length;++P){const $=j[P];i.push(R+$)}d=m+(d.length>0?" "+d:d)}return d};function a6(){let r=0,e,t,n="";for(;r<arguments.length;)(e=arguments[r++])&&(t=CT(e))&&(n&&(n+=" "),n+=t);return n}const CT=r=>{if(typeof r=="string")return r;let e,t="";for(let n=0;n<r.length;n++)r[n]&&(e=CT(r[n]))&&(t&&(t+=" "),t+=e);return t};function l6(r,...e){let t,n,s,i=c;function c(p){const m=e.reduce((g,x)=>x(g),r());return t=s6(m),n=t.cache.get,s=t.cache.set,i=d,d(p)}function d(p){const m=n(p);if(m)return m;const g=i6(p,t);return s(p,g),g}return function(){return i(a6.apply(null,arguments))}}const nn=r=>{const e=t=>t[r]||[];return e.isThemeGetter=!0,e},kT=/^\[(?:([a-z-]+):)?(.+)\]$/i,c6=/^\d+\/\d+$/,u6=new Set(["px","full","screen"]),d6=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,f6=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,h6=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,p6=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,m6=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Nl=r=>th(r)||u6.has(r)||c6.test(r),Ac=r=>yh(r,"length",E6),th=r=>!!r&&!Number.isNaN(Number(r)),Rx=r=>yh(r,"number",th),Gp=r=>!!r&&Number.isInteger(Number(r)),g6=r=>r.endsWith("%")&&th(r.slice(0,-1)),Xt=r=>kT.test(r),Ic=r=>d6.test(r),v6=new Set(["length","size","percentage"]),y6=r=>yh(r,v6,NT),x6=r=>yh(r,"position",NT),w6=new Set(["image","url"]),b6=r=>yh(r,w6,C6),_6=r=>yh(r,"",S6),Wp=()=>!0,yh=(r,e,t)=>{const n=kT.exec(r);return n?n[1]?typeof e=="string"?n[1]===e:e.has(n[1]):t(n[2]):!1},E6=r=>f6.test(r)&&!h6.test(r),NT=()=>!1,S6=r=>p6.test(r),C6=r=>m6.test(r),k6=()=>{const r=nn("colors"),e=nn("spacing"),t=nn("blur"),n=nn("brightness"),s=nn("borderColor"),i=nn("borderRadius"),c=nn("borderSpacing"),d=nn("borderWidth"),p=nn("contrast"),m=nn("grayscale"),g=nn("hueRotate"),x=nn("invert"),b=nn("gap"),E=nn("gradientColorStops"),T=nn("gradientColorStopPositions"),S=nn("inset"),N=nn("margin"),R=nn("opacity"),A=nn("padding"),j=nn("saturate"),P=nn("scale"),$=nn("sepia"),W=nn("skew"),M=nn("space"),V=nn("translate"),X=()=>["auto","contain","none"],ie=()=>["auto","hidden","clip","visible","scroll"],J=()=>["auto",Xt,e],ae=()=>[Xt,e],we=()=>["",Nl,Ac],ue=()=>["auto",th,Xt],oe=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],pe=()=>["solid","dashed","dotted","double","none"],te=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],B=()=>["start","end","center","between","around","evenly","stretch"],z=()=>["","0",Xt],Y=()=>["auto","avoid","all","avoid-page","page","left","right","column"],O=()=>[th,Xt];return{cacheSize:500,separator:":",theme:{colors:[Wp],spacing:[Nl,Ac],blur:["none","",Ic,Xt],brightness:O(),borderColor:[r],borderRadius:["none","","full",Ic,Xt],borderSpacing:ae(),borderWidth:we(),contrast:O(),grayscale:z(),hueRotate:O(),invert:z(),gap:ae(),gradientColorStops:[r],gradientColorStopPositions:[g6,Ac],inset:J(),margin:J(),opacity:O(),padding:ae(),saturate:O(),scale:O(),sepia:z(),skew:O(),space:ae(),translate:ae()},classGroups:{aspect:[{aspect:["auto","square","video",Xt]}],container:["container"],columns:[{columns:[Ic]}],"break-after":[{"break-after":Y()}],"break-before":[{"break-before":Y()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...oe(),Xt]}],overflow:[{overflow:ie()}],"overflow-x":[{"overflow-x":ie()}],"overflow-y":[{"overflow-y":ie()}],overscroll:[{overscroll:X()}],"overscroll-x":[{"overscroll-x":X()}],"overscroll-y":[{"overscroll-y":X()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[S]}],"inset-x":[{"inset-x":[S]}],"inset-y":[{"inset-y":[S]}],start:[{start:[S]}],end:[{end:[S]}],top:[{top:[S]}],right:[{right:[S]}],bottom:[{bottom:[S]}],left:[{left:[S]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Gp,Xt]}],basis:[{basis:J()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Xt]}],grow:[{grow:z()}],shrink:[{shrink:z()}],order:[{order:["first","last","none",Gp,Xt]}],"grid-cols":[{"grid-cols":[Wp]}],"col-start-end":[{col:["auto",{span:["full",Gp,Xt]},Xt]}],"col-start":[{"col-start":ue()}],"col-end":[{"col-end":ue()}],"grid-rows":[{"grid-rows":[Wp]}],"row-start-end":[{row:["auto",{span:[Gp,Xt]},Xt]}],"row-start":[{"row-start":ue()}],"row-end":[{"row-end":ue()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Xt]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Xt]}],gap:[{gap:[b]}],"gap-x":[{"gap-x":[b]}],"gap-y":[{"gap-y":[b]}],"justify-content":[{justify:["normal",...B()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...B(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...B(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[A]}],px:[{px:[A]}],py:[{py:[A]}],ps:[{ps:[A]}],pe:[{pe:[A]}],pt:[{pt:[A]}],pr:[{pr:[A]}],pb:[{pb:[A]}],pl:[{pl:[A]}],m:[{m:[N]}],mx:[{mx:[N]}],my:[{my:[N]}],ms:[{ms:[N]}],me:[{me:[N]}],mt:[{mt:[N]}],mr:[{mr:[N]}],mb:[{mb:[N]}],ml:[{ml:[N]}],"space-x":[{"space-x":[M]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[M]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Xt,e]}],"min-w":[{"min-w":[Xt,e,"min","max","fit"]}],"max-w":[{"max-w":[Xt,e,"none","full","min","max","fit","prose",{screen:[Ic]},Ic]}],h:[{h:[Xt,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Xt,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Xt,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Xt,e,"auto","min","max","fit"]}],"font-size":[{text:["base",Ic,Ac]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Rx]}],"font-family":[{font:[Wp]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Xt]}],"line-clamp":[{"line-clamp":["none",th,Rx]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Nl,Xt]}],"list-image":[{"list-image":["none",Xt]}],"list-style-type":[{list:["none","disc","decimal",Xt]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[r]}],"placeholder-opacity":[{"placeholder-opacity":[R]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[r]}],"text-opacity":[{"text-opacity":[R]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...pe(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Nl,Ac]}],"underline-offset":[{"underline-offset":["auto",Nl,Xt]}],"text-decoration-color":[{decoration:[r]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:ae()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Xt]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Xt]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[R]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...oe(),x6]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",y6]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},b6]}],"bg-color":[{bg:[r]}],"gradient-from-pos":[{from:[T]}],"gradient-via-pos":[{via:[T]}],"gradient-to-pos":[{to:[T]}],"gradient-from":[{from:[E]}],"gradient-via":[{via:[E]}],"gradient-to":[{to:[E]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[d]}],"border-w-x":[{"border-x":[d]}],"border-w-y":[{"border-y":[d]}],"border-w-s":[{"border-s":[d]}],"border-w-e":[{"border-e":[d]}],"border-w-t":[{"border-t":[d]}],"border-w-r":[{"border-r":[d]}],"border-w-b":[{"border-b":[d]}],"border-w-l":[{"border-l":[d]}],"border-opacity":[{"border-opacity":[R]}],"border-style":[{border:[...pe(),"hidden"]}],"divide-x":[{"divide-x":[d]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[d]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[R]}],"divide-style":[{divide:pe()}],"border-color":[{border:[s]}],"border-color-x":[{"border-x":[s]}],"border-color-y":[{"border-y":[s]}],"border-color-s":[{"border-s":[s]}],"border-color-e":[{"border-e":[s]}],"border-color-t":[{"border-t":[s]}],"border-color-r":[{"border-r":[s]}],"border-color-b":[{"border-b":[s]}],"border-color-l":[{"border-l":[s]}],"divide-color":[{divide:[s]}],"outline-style":[{outline:["",...pe()]}],"outline-offset":[{"outline-offset":[Nl,Xt]}],"outline-w":[{outline:[Nl,Ac]}],"outline-color":[{outline:[r]}],"ring-w":[{ring:we()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[r]}],"ring-opacity":[{"ring-opacity":[R]}],"ring-offset-w":[{"ring-offset":[Nl,Ac]}],"ring-offset-color":[{"ring-offset":[r]}],shadow:[{shadow:["","inner","none",Ic,_6]}],"shadow-color":[{shadow:[Wp]}],opacity:[{opacity:[R]}],"mix-blend":[{"mix-blend":[...te(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":te()}],filter:[{filter:["","none"]}],blur:[{blur:[t]}],brightness:[{brightness:[n]}],contrast:[{contrast:[p]}],"drop-shadow":[{"drop-shadow":["","none",Ic,Xt]}],grayscale:[{grayscale:[m]}],"hue-rotate":[{"hue-rotate":[g]}],invert:[{invert:[x]}],saturate:[{saturate:[j]}],sepia:[{sepia:[$]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[t]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[p]}],"backdrop-grayscale":[{"backdrop-grayscale":[m]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[g]}],"backdrop-invert":[{"backdrop-invert":[x]}],"backdrop-opacity":[{"backdrop-opacity":[R]}],"backdrop-saturate":[{"backdrop-saturate":[j]}],"backdrop-sepia":[{"backdrop-sepia":[$]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[c]}],"border-spacing-x":[{"border-spacing-x":[c]}],"border-spacing-y":[{"border-spacing-y":[c]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Xt]}],duration:[{duration:O()}],ease:[{ease:["linear","in","out","in-out",Xt]}],delay:[{delay:O()}],animate:[{animate:["none","spin","ping","pulse","bounce",Xt]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[P]}],"scale-x":[{"scale-x":[P]}],"scale-y":[{"scale-y":[P]}],rotate:[{rotate:[Gp,Xt]}],"translate-x":[{"translate-x":[V]}],"translate-y":[{"translate-y":[V]}],"skew-x":[{"skew-x":[W]}],"skew-y":[{"skew-y":[W]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Xt]}],accent:[{accent:["auto",r]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Xt]}],"caret-color":[{caret:[r]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":ae()}],"scroll-mx":[{"scroll-mx":ae()}],"scroll-my":[{"scroll-my":ae()}],"scroll-ms":[{"scroll-ms":ae()}],"scroll-me":[{"scroll-me":ae()}],"scroll-mt":[{"scroll-mt":ae()}],"scroll-mr":[{"scroll-mr":ae()}],"scroll-mb":[{"scroll-mb":ae()}],"scroll-ml":[{"scroll-ml":ae()}],"scroll-p":[{"scroll-p":ae()}],"scroll-px":[{"scroll-px":ae()}],"scroll-py":[{"scroll-py":ae()}],"scroll-ps":[{"scroll-ps":ae()}],"scroll-pe":[{"scroll-pe":ae()}],"scroll-pt":[{"scroll-pt":ae()}],"scroll-pr":[{"scroll-pr":ae()}],"scroll-pb":[{"scroll-pb":ae()}],"scroll-pl":[{"scroll-pl":ae()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Xt]}],fill:[{fill:[r,"none"]}],"stroke-w":[{stroke:[Nl,Ac,Rx]}],stroke:[{stroke:[r,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},N6=l6(k6);function Rr(...r){return N6(_T(r))}async function Ax(r){let e;if(r instanceof File)e=await r.arrayBuffer();else if(r instanceof ArrayBuffer)e=r;else if(r instanceof Uint8Array)e=r.buffer;else throw new Error("Unsupported data type for checksum calculation");const t=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(t)).map(i=>i.toString(16).padStart(2,"0")).join("")}const Sr="src/lib/utils/serverUtils.tsx",Ix=new Map,$f=3,_C=1e3;function EC(r){if(r instanceof Error){const e=r.message.toLowerCase();return e.includes("timeout")||e.includes("network")||e.includes("failed to fetch")||e.includes("504")||e.includes("503")}return!1}function Wy(r){const e=["x-trace-id","x-request-id","x-correlation-id","x-amzn-request-id","x-amzn-requestid","x-amzn-trace-id","request-id","trace-id","correlation-id"];for(const t of e){const n=r.headers.get(t);if(n)return n}return null}new URL(Cr+"/email-template");const T6=new URL(Cr+"/email-templates"),R6=new URL(Cr+"/email/generate"),A6=new URL(Cr+"/email/generate_for_outlook"),I6=new URL(Cr+"/email/reformat"),P6=new URL(Cr+"/email/participants"),F6=new URL(Cr+"/email/participants_with_category");new URL(Cr+"/email/register");new URL(Cr+"/email/unregister");const j6=new URL(Cr+"/email/get_registration"),O6=new URL(Cr+"/email/summarization"),D6=new URL(Cr+"/email/description_summarization"),L6=new URL(Cr+"/email/summarization_for_outlook");new URL(Cr+"/integration");const M6=new URL(Cr+"/integrations"),$6=new URL(Cr+"/integrations/client"),U6=new URL(Cr+"/integrations/document"),z6=new URL(Cr+"/integrations/clients"),H6=new URL(Cr+"/integrations/project_documents"),B6=new URL(Cr+"/integrations/case_summary");new URL(Cr+"/integrations/uscis/case");const G6=new URL(Cr+"/integrations/user"),TT=new URL(Cr+"/integrations/users"),tg=new URL(Cr+"/integrations/write"),W6=new URL(Cr+"/integrations/projects"),V6=new URL(Cr+"/integrations/project");new URL(Cr+"/integrations/contacts");const q6=new URL(Cr+"/integrations/settings"),K6=new URL(Cr+"/email/generate_task_description");new URL(Cr+"/admin/users");new URL(Cr+"/admin/user");const Y6="CANDLE_ERROR_TOKEN_NOT_FOUND",J6="CANDLE_ERROR_TOKEN_REFRESH_FAILED";function Xc(r,e){const t={sourceFile:Sr};e.status===404?e.json().then(n=>{(n.error_code===Y6||n.error_code===J6)&&(r.warn("404 error, Gmail might be disconnected from server, checking...",{...t,data:n}),Vy(r).then(s=>{s||r.error("Gmail has been disconnected from server unexpectedly!",new Error("Gmail has been disconnected from server, syncing..."),{...t,data:n})}))}):r.warn("HTTP error! status: "+e.status,{...t,data:e})}async function X6(r){const e={sourceFile:Sr};r.debug("Starting to fetch response...",e);const t=await $r(T6,{method:"GET",headers:{"Content-Type":"application/json"}},r);if(r.debug("Response received:",{...e,data:t}),!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const n=t.headers.get("content-type");if(r.debug("Content-Type:",{...e,data:n}),n&&n.includes("application/json")){r.debug("Content-Type is JSON, parsing...",e);const s=await t.json();r.debug("Parsed JSON response:",{...e,data:s}),s.user_templates&&s.user_templates.length>0&&r.debug("First user template tags:",{...e,data:s.user_templates[0].tags}),s.org_templates&&s.org_templates.length>0&&r.debug("First org template tags:",{...e,data:s.org_templates[0].tags});const i=s.user_templates.map(d=>({...d,source:"SCOPE_USER"})),c=s.org_templates.map(d=>({...d,source:"SCOPE_TENANT"}));return r.debug("Enhanced user templates with source:",{...e,data:i}),r.debug("Enhanced org templates with source:",{...e,data:c}),{user_templates:i,org_templates:c}}else{r.debug("Content-Type is not JSON, handling as text...",e);const s=await t.text();throw r.error("Received non-JSON response:",s,e),new Error("Received non-JSON response from server")}}async function Q6(r,e,t,n,s,i=[],c,d=!1){const p={sourceFile:Sr};c.debug("Starting to fetch response...",p),d?c.info("Force refresh flag is TRUE - will bypass backend cache",{...p,forceRefresh:!0}):c.debug("Force refresh flag is FALSE - will use cache-first",{...p,forceRefresh:!1});const m=[{role:"user",content:"Here's some additional relevant context to help with your response:"+t},{role:"user",content:"This is the specific email in the thread to respond to:"+e}],g={WEB_SOURCES:{PUBLIC:i}};try{const x=await $r(R6,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email_thread_id:r,datasources:g,format_instruction:s+" "+n,additional_context:m,force_refresh:d})},c);if(c.debug("Response received:",{...p,data:x}),!x.ok)throw Xc(c,x),new Error(`HTTP error! status: ${x.status}`);const b=x.headers.get("content-type");c.debug("Content-Type:",{...p,data:b});let E;if(b&&b.includes("application/json"))c.debug("Content-Type is JSON, parsing...",p),E=await x.json();else{c.debug("Content-Type is not JSON, handling as text...",p);const $=await x.text();throw c.error("Received non-JSON response:",$,p),new Error("Received non-JSON response from server")}c.info("Parsed JSON response:",{...p,data:E});const T=E.response,S=E.references,N=E.cms_fields_used,R=E.cms_data;c.info("Result response:",{...p,data:T}),c.info("Result references:",{...p,data:S});const P=new DOMParser().parseFromString(T,"text/html").body.innerHTML;return c.debug("Extracted HTML body content:",{...p,data:P}),{response:P,references:S,cms_fields_used:N,cms_data:R}}catch(x){return c.error("Error caught:",x,p),{response:"error",references:[],cms_fields_used:[],cms_data:[]}}}async function Z6(r,e,t,n,s,i,c,d=!1){const p={sourceFile:Sr};c.debug("Starting to fetch response for Outlook...",p),d?c.info("Force refresh flag is TRUE - will bypass backend cache",{...p,forceRefresh:!0}):c.debug("Force refresh flag is FALSE - will use cache-first",{...p,forceRefresh:!1});const m=[{role:"user",content:"Here's some additional relevant context to help with your response:"+t}];try{const g=await $r(A6,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({thread_id:r,full_thread:e,email_participants:i,format_instruction:s+" "+n,additional_context:m,force_refresh:d})},c);if(c.debug("Response received:",{...p,data:g}),!g.ok)throw new Error(`HTTP error! status: ${g.status}`);const x=g.headers.get("content-type");c.debug("Content-Type:",{...p,data:x});let b;if(x&&x.includes("application/json"))c.debug("Content-Type is JSON, parsing...",p),b=await g.json();else{c.debug("Content-Type is not JSON, handling as text...",p);const P=await g.text();throw c.error("Received non-JSON response:",P,p),new Error("Received non-JSON response from server")}c.info("Parsed JSON response:",{...p,data:b});const E=b.response,T=b.references,S=b.cms_fields_used,N=b.cms_data;c.debug("Result response:",{...p,data:E}),c.debug("Result references:",{...p,data:T});const j=new DOMParser().parseFromString(E,"text/html").body.innerHTML;return c.debug("Extracted HTML body content:",{...p,data:j}),{response:j,references:T,cms_fields_used:S,cms_data:N}}catch(g){return c.error("Error caught:",g,p),{response:"error",references:[],cms_fields_used:[],cms_data:[]}}}async function e8(r,e,t){const n={sourceFile:Sr};t.debug("Starting to fetch response...",n);const s=await $r(I6,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({reformat_instruction:e,chat_history:[{content:"Here's the HTML Content. Respond with only the HTML content for the revised email response:"+r}]})},t);if(t.debug("Response received:",{...n,data:s}),!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const i=s.headers.get("content-type");if(t.debug("Content-Type:",{...n,data:i}),i&&i.includes("application/json")){t.debug("Content-Type is JSON, parsing...",n);const c=await s.json();t.debug("Parsed JSON response:",{...n,data:c});const d=c.replace(/^```html\s*/,"");t.debug("Cleaned data:",{...n,data:d});const g=new DOMParser().parseFromString(d,"text/html").body.innerHTML;return t.debug("Extracted HTML body content:",{...n,data:g}),g}else{t.debug("Content-Type is not JSON, handling as text...",n);const c=await s.text();throw t.error("Received non-JSON response:",c,n),new Error("Received non-JSON response from server")}}async function qc(r,e){const t={sourceFile:Sr};e.debug("Starting to list integrations...",t);const n=new URL(M6);n.searchParams.append("integration_scope",r);try{const s=await $r(n,{method:"GET",headers:{"Content-Type":"application/json"}},e);if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const i=s.headers.get("content-type");if(i&&i.includes("application/json")){const c=await s.json();e.debug("Integrations:",{...t,data:c.integrations});const d=c.integrations.map(p=>({integration_type:p.integration_type,tenantId_userId:p.tenantId_userId,scope:r}));return await Xm(e,d),d||[]}else throw new Error("Received non-JSON response from server")}catch(s){throw e.error("Error listing integrations:",s,t),s}}async function Vy(r){const e={sourceFile:Sr};r.debug("Starting to check if Gmail integration is connected...",e);try{const t=await $r(j6,{method:"GET",headers:{"Content-Type":"application/json"}},r);r.debug("Response received:",{...e,data:t});let n=!1;if(t.ok){const s=await t.json();r.debug("Parsed JSON response:",{...e,data:s}),n=s.is_registered===!0}return await PU(r,n),n}catch(t){r.error("Error checking Gmail connection status:",t,e);try{const n=await FU(r);if(n.isConnected!==null)return r.debug("Returning cached Gmail connection status due to error",{...e,cachedStatus:n.isConnected,cachedTimestamp:n.timestamp}),n.isConnected}catch(n){r.error("Error retrieving cached Gmail connection status:",n,e)}return!1}}async function t8(r,e){const t={sourceFile:Sr};try{const n=await $r(O6,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email_thread_id:r})},e);if(e.debug("Response received:",{...t,data:n}),!n.ok)throw Xc(e,n),new Error(`HTTP error! status: ${n.status}`);const s=n.headers.get("content-type");if(s&&s.includes("application/json")){const i=await n.json();if(!i||!i.message)throw new Error("Summary not found in response");let c=null;if(i.message.important_details)try{typeof i.message.important_details=="object"?(e.debug("Important details is already an object, using it directly...",t),c=i.message.important_details):typeof i.message.important_details=="string"&&(e.debug("Important details is a JSON string, parsing...",t),c=JSON.parse(i.message.important_details)),e.debug("Parsed important details:",{...t,data:c})}catch(d){e.error("Error parsing important details:",d,t),c=null}return{summary:i.message.summary,importantDetails:c,topicsDiscussed:i.message.topics_discussed,actionItems:i.message.action_items}}else throw new Error("Received non-JSON response from server")}catch(n){return e.error("Error caught:",n,t),{summary:"Error fetching email summary: "+n,importantDetails:null,topicsDiscussed:"",actionItems:""}}}async function SC(r,e,t){const n={sourceFile:Sr};try{const s=await $r(D6,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email_thread_id:r,email_thread_content:e})},t);if(t.debug("Response received:",{...n,data:s}),!s.ok)throw Xc(t,s),new Error(`HTTP error! status: ${s.status}`);const i=s.headers.get("content-type");if(i&&i.includes("application/json")){const c=await s.json();if(!c||!c.message)throw new Error("Summary not found in response");return{description:c.message}}else throw new Error("Received non-JSON response from server")}catch(s){return t.error("Error caught:",s,n),{description:""}}}async function r8(r,e){const t={sourceFile:Sr};try{const n=await $r(L6,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({full_thread:r})},e);if(e.debug("Response received:",{...t,data:n}),!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const s=n.headers.get("content-type");if(s&&s.includes("application/json")){const i=await n.json();if(!i||!i.message)throw new Error("Summary not found in response");let c=null;if(i.message.important_details)try{typeof i.message.important_details=="object"?(e.debug("Important details is already an object, using it directly...",t),c=i.message.important_details):typeof i.message.important_details=="string"&&(e.debug("Important details is a JSON string, parsing...",t),c=JSON.parse(i.message.important_details)),e.debug("Parsed important details:",{...t,data:c})}catch(d){e.error("Error parsing important details:",d,t),c=null}return{summary:i.message.summary,importantDetails:c,topicsDiscussed:i.message.topics_discussed,actionItems:i.message.action_items}}else throw new Error("Received non-JSON response from server")}catch(n){return e.error("Error caught:",n,t),{summary:"Error fetching email summary: "+n,importantDetails:null,topicsDiscussed:"",actionItems:""}}}async function X_(r,e,t,n=!1,s){const i={sourceFile:Sr,functionName:"getClientDataFromServer"},c=e.toLowerCase(),d=s!=null&&s.cursor?`:cursor_${s.cursor}`:"",p=`${r}:${c}${d}`,m=Ix.get(p);if(m)return t.debug("Returning existing in-flight request",{...i,clientEmail:e}),console.log(` [${r.toUpperCase()}] Deduplicating request for ${e} - returning in-flight promise`),m;const g=zw(r,e,t,n,s);return Ix.set(p,g),g.finally(()=>{Ix.delete(p)})}async function zw(r,e,t,n=!1,s,i=0){const c={sourceFile:Sr,functionName:"fetchClientDataInternal"},d=Date.now();if(console.group(` [${r.toUpperCase()}] getClientDataFromServer - ${e}${i>0?` (retry ${i})`:""}`),console.time("getClientDataFromServer:total"),console.log("Integration:",r),console.log("Client Email:",e),t.info("Starting client data fetch",{...c,clientEmail:e,integrationType:r,retryCount:i}),i===0){const S=M5(e);if(S.inCache)throw console.log(` Timeout cache hit: Email recently failed with ${S.errorType}`),console.timeEnd("getClientDataFromServer:total"),console.groupEnd(),t.info("Email in timeout cache, skipping API call to prevent retry storm",{...c,clientEmail:e,errorType:S.errorType,totalMs:Date.now()-d}),new Error(`Request recently failed (${S.errorType}) - try again later`)}console.time("getClientDataFromServer:nonExistentCacheCheck");const p=Date.now(),m=await W5(e,t),g=Date.now()-p;if(console.timeEnd("getClientDataFromServer:nonExistentCacheCheck"),m)throw console.log(" Non-existent cache hit: Email known to have no client data"),console.timeEnd("getClientDataFromServer:total"),console.groupEnd(),t.info("Email in non-existent cache, skipping API call",{...c,clientEmail:e,nonExistentCacheCheckMs:g,totalMs:Date.now()-d}),new Error("Client not found (cached)");console.time("getClientDataFromServer:clientCacheCheck");const x=Date.now(),b=s!=null&&s.cursor?null:await vT(e,t),E=Date.now()-x;if(console.timeEnd("getClientDataFromServer:clientCacheCheck"),b)return console.log(" Cache hit: Client data found in cache"),console.timeEnd("getClientDataFromServer:total"),console.groupEnd(),t.info("Client data found in cache",{...c,clientEmail:e,nonExistentCacheCheckMs:g,clientCacheCheckMs:E,totalMs:Date.now()-d}),b;const T=new URL($6);T.searchParams.append("integration_type",r),T.searchParams.append("client_email",e),T.searchParams.append("data_type","client_data"),s&&(T.searchParams.append("limit",String(s.limit||10)),s.cursor&&T.searchParams.append("cursor",s.cursor)),n&&T.searchParams.append("force_refresh","true");try{console.time("getClientDataFromServer:apiCall"),console.log(" Making API request to:",T.toString());const S=Date.now(),N=await $r(T,{method:"GET",headers:{"Content-Type":"application/json"}},t),R=Date.now()-S,A=Wy(N);if(console.timeEnd("getClientDataFromServer:apiCall"),console.log(" Response status:",N.status,`(${R}ms)`),console.log(" Trace ID:",A||"N/A"),N.status===504||N.status===503)if(console.error(` ${N.status} Gateway Timeout - API call took too long`),console.log("Request URL:",T.toString()),console.log("Time elapsed before timeout:",R,"ms"),console.log(" Trace ID for debugging:",A||"N/A"),i<$f){const P=_C*Math.pow(2,i);return console.log(` Retrying in ${P}ms (attempt ${i+1}/${$f})`),console.timeEnd("getClientDataFromServer:total"),console.groupEnd(),t.info("Retrying after timeout",{...c,clientEmail:e,status:N.status,retryCount:i+1,delayMs:P,traceId:A}),await new Promise($=>setTimeout($,P)),zw(r,e,t,n,s,i+1)}else yC(e,`${N.status}`),console.log(` Max retries (${$f}) exhausted, added to timeout cache`),t.warn("Max retries exhausted for timeout error, added to timeout cache",{...c,clientEmail:e,status:N.status,retryCount:i,traceId:A});if(t.info("API response received",{...c,clientEmail:e,status:N.status,apiMs:R,nonExistentCacheCheckMs:g,clientCacheCheckMs:E,traceId:A,retryCount:i}),!N.ok){if(N.status===404&&(await G5(e,t),Xc(t,N)),console.error(" API error:",N.status),console.timeEnd("getClientDataFromServer:total"),console.groupEnd(),N.status===400)try{const P=await N.json();if(P!=null&&P.error)throw new Error(`HTTP error! status: 400 - ${P.error}`)}catch(P){if(P instanceof Error&&P.message.startsWith("HTTP error!"))throw P}throw new Error(`HTTP error! status: ${N.status}`)}const j=N.headers.get("content-type");if(j&&j.includes("application/json")){console.time("getClientDataFromServer:parseJson");const P=Date.now(),$=await N.json(),W=Date.now()-P;console.timeEnd("getClientDataFromServer:parseJson");const M=$.requestId,V=$.traceId,X=M||A;M&&console.log(" Request ID (from body):",M),V&&console.log(" Trace ID (from body):",V);const ie={client_data:$.client_data||{},case_data:$.case_data||[],pagination:$.pagination||void 0};console.time("getClientDataFromServer:cacheWrite");const J=Date.now();s!=null&&s.cursor||await q5(e,ie,t);const ae=Date.now()-J;console.timeEnd("getClientDataFromServer:cacheWrite"),hT(e);const we=Date.now()-d;return console.log(" Client data fetch completed"),console.log(" Timing breakdown:",{nonExistentCacheCheck:`${g}ms`,clientCacheCheck:`${E}ms`,apiCall:`${R}ms`,parseJson:`${W}ms`,cacheWrite:`${ae}ms`,total:`${we}ms`}),console.timeEnd("getClientDataFromServer:total"),console.groupEnd(),t.info("Client data fetch completed",{...c,clientEmail:e,nonExistentCacheCheckMs:g,clientCacheCheckMs:E,apiMs:R,parseMs:W,cacheWriteMs:ae,totalMs:we,retryCount:i,requestId:X,traceId:V||A}),ie}else throw console.error(" Received non-JSON response"),console.timeEnd("getClientDataFromServer:total"),console.groupEnd(),new Error("Received non-JSON response from server")}catch(S){const N=Date.now()-d;if(i<$f&&EC(S)){const R=_C*Math.pow(2,i);return console.log(` Retrying after error in ${R}ms (attempt ${i+1}/${$f})`),console.timeEnd("getClientDataFromServer:total"),console.groupEnd(),t.info("Retrying after network error",{...c,clientEmail:e,error:S instanceof Error?S.message:String(S),retryCount:i+1,delayMs:R}),await new Promise(A=>setTimeout(A,R)),zw(r,e,t,n,s,i+1)}if(EC(S)){const R=S instanceof Error?S.message.includes("timeout")?"timeout":"network":"unknown";yC(e,R),console.log(` Max retries (${$f}) exhausted for ${R} error, added to timeout cache`),t.warn("Max retries exhausted for network error, added to timeout cache",{...c,clientEmail:e,errorType:R,retryCount:i})}throw console.error(" Client data fetch failed:",S instanceof Error?S.message:String(S)),console.log(" Timing at failure:",{nonExistentCacheCheck:`${g}ms`,clientCacheCheck:`${E}ms`,total:`${N}ms`}),console.timeEnd("getClientDataFromServer:total"),console.groupEnd(),t.info("Client data fetch failed",{...c,clientEmail:e,error:S instanceof Error?S.message:String(S),nonExistentCacheCheckMs:g,clientCacheCheckMs:E,totalMs:N,retryCount:i}),S}}async function RT(r,e,t){const n={sourceFile:Sr,functionName:"getDocumentListForProject"};t.debug("Starting to fetch project documents...",{...n,projectId:e});const s=new URL(H6);s.searchParams.append("integration_type",r),s.searchParams.append("project_id",e);try{const i=await $r(s,{method:"GET",headers:{"Content-Type":"application/json"}},t);if(t.debug("Response received:",{...n,data:i}),!i.ok){if(i.status===404)return Xc(t,i),{documents:[]};throw new Error(`HTTP error! status: ${i.status}`)}const c=i.headers.get("content-type");if(c&&c.includes("application/json")){const d=await i.json();return t.debug("Parsed JSON response:",{...n,data:d}),{documents:d.documents||[]}}else throw new Error("Received non-JSON response from server")}catch(i){throw t.debug("Error fetching project documents:",{...n,error:i}),i}}async function n8(r,e,t){const n={sourceFile:Sr,functionName:"getCaseSummaryForProject"};t.debug("Starting to fetch case summary...",{...n,projectId:e});const s=new URL(B6);s.searchParams.append("integration_type",r),s.searchParams.append("project_id",e);try{const i=await $r(s,{method:"GET",headers:{"Content-Type":"application/json"}},t);if(t.debug("Response received:",{...n,data:i}),!i.ok){if(i.status===404)return Xc(t,i),null;throw new Error(`HTTP error! status: ${i.status}`)}const c=i.headers.get("content-type");if(c&&c.includes("application/json")){const d=await i.json();return t.debug("Parsed JSON response:",{...n,data:d}),{caseFacts:d.caseFacts||"",supioLink:d.supioLink||"",statuteoflimitations:d.statuteoflimitations||{dateValue:"",doneDate:null},disbursementSheet:d.disbursementSheet||null,totalMeds:d.totalMeds||0,totalLiens:d.totalLiens||0}}else throw new Error("Received non-JSON response from server")}catch(i){return t.debug("Error fetching case summary:",{...n,error:i}),null}}async function s8(r,e){const t={sourceFile:Sr,functionName:"getEmailParticipantsFromServer"};e.debug("Starting to fetch response...",t);const n={email_thread_id:r};try{const s=await $r(P6,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)},e);if(e.debug("Response received:",{...t,data:s}),!s.ok)throw Xc(e,s),new Error(`HTTP error! status: ${s.status}`);const i=s.headers.get("content-type");if(i&&i.includes("application/json")){const c=await s.json();return e.debug("Parsed JSON response:",{...t,data:c}),c.email_participants}else throw new Error("Received non-JSON response from server")}catch(s){throw e.error("Error fetching email participants:",s,t),s}}async function AT(r,e){const t={sourceFile:Sr,functionName:"getEmailParticipantsFromServer"};e.debug("Starting to fetch response...",t);const n={email_thread_id:r};try{const s=await $r(F6,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)},e);if(e.debug("Response received:",{...t,data:s}),!s.ok)throw Xc(e,s),new Error(`HTTP error! status: ${s.status}`);const i=s.headers.get("content-type");if(i&&i.includes("application/json")){const c=await s.json();return e.debug("Parsed JSON response:",{...t,data:c}),c.email_details}else throw new Error("Received non-JSON response from server")}catch(s){throw e.error("Error fetching email participants:",s,t),s}}async function o8(r,e,t){const n={sourceFile:Sr,functionName:"getDocumentURLFromServer"};t.debug("Starting to fetch document data...",n);const s=new URL(U6);s.searchParams.append("integration_type",r),s.searchParams.append("document_id",e);try{const i=await $r(s,{method:"GET",headers:{"Content-Type":"application/json"}},t);if(t.debug("Response received:",{...n,data:i}),!i.ok)throw i.status===404?new Error("Document not found or integration not configured"):new Error(`HTTP error! status: ${i.status}`);const c=i.headers.get("content-type");if(c&&c.includes("application/json")){const d=await i.json();if(t.debug("Parsed JSON response:",{...n,data:d}),!d.url)throw new Error("Document URL not found in response");return{documentId:parseInt(e),url:d.url}}else throw new Error("Received non-JSON response from server")}catch(i){throw t.error("Error fetching document data:",i,n),i}}async function i8(r,e){const t={sourceFile:Sr,functionName:"getAllClientsFromServer"};r.debug("Starting to fetch all clients for project...",t);const n=new URL(z6);n.searchParams.append("integration_type",e);try{const s=await $r(n,{method:"GET",headers:{"Content-Type":"application/json"}},r);if(r.debug("Response received:",{...t,data:s}),!s.ok)throw s.status===400?new Error("Missing required parameters"):s.status===404?new Error("No integration found for the specified type"):new Error(`HTTP error! status: ${s.status}`);const i=s.headers.get("content-type");if(i&&i.includes("application/json")){const c=await s.json();return r.debug("Parsed JSON response:",{...t,data:c}),{clients:c}}else throw new Error("Received non-JSON response from server")}catch(s){throw r.error("Error fetching all clients:",s,t),s}}async function qy(r,e,t){var i,c;const n={sourceFile:Sr},s=Date.now();console.group(` [${r.toUpperCase()}] searchProjectsFromServer - "${e}"`),console.time("searchProjectsFromServer:total"),console.log("Integration:",r),console.log("Search Term:",e);try{t.info("Searching projects",{...n,integrationType:r,searchTerm:e});const d=new URL(W6);d.searchParams.append("integration_type",r),d.searchParams.append("search_term",e),d.searchParams.append("exclude_archived","true"),d.searchParams.append("limit","10"),console.time("searchProjectsFromServer:apiCall"),console.log(" Making API request to:",d.toString());const p=Date.now(),m=await $r(d,{method:"GET",headers:{"Content-Type":"application/json"}},t),g=Date.now()-p,x=Wy(m);if(console.timeEnd("searchProjectsFromServer:apiCall"),console.log(" Response status:",m.status,`(${g}ms)`),console.log(" Trace ID:",x||"N/A"),m.status===504&&(console.error(" 504 Gateway Timeout - API call took too long"),console.log("Request URL:",d.toString()),console.log("Time elapsed before timeout:",g,"ms"),console.log(" Trace ID for debugging:",x||"N/A")),!m.ok){if(m.status===404)return console.log(" No projects found (404)"),console.timeEnd("searchProjectsFromServer:total"),console.groupEnd(),t.debug("No projects found",{...n,traceId:x}),{projects:[],total:0,hasMore:!1};throw console.error(" API error:",m.status),console.timeEnd("searchProjectsFromServer:total"),console.groupEnd(),new Error(`Search failed: ${m.status}`)}const b=m.headers.get("content-type");if(b&&b.includes("application/json")){console.time("searchProjectsFromServer:parseJson");const E=await m.json();console.timeEnd("searchProjectsFromServer:parseJson");const T=Date.now()-s;return console.log(" Project search completed"),console.log(" Results:",((i=E.projects)==null?void 0:i.length)||0,"projects found"),console.log(" Timing breakdown:",{apiCall:`${g}ms`,total:`${T}ms`}),console.timeEnd("searchProjectsFromServer:total"),console.groupEnd(),t.info("Project search successful",{...n,resultCount:((c=E.projects)==null?void 0:c.length)||0}),E}else throw console.error(" Received non-JSON response"),console.timeEnd("searchProjectsFromServer:total"),console.groupEnd(),new Error("Received non-JSON response from server")}catch(d){const p=Date.now()-s;throw console.error(" Project search failed:",d instanceof Error?d.message:String(d)),console.log(" Timing at failure:",{total:`${p}ms`}),console.timeEnd("searchProjectsFromServer:total"),console.groupEnd(),t.error("Error searching projects",d,{...n,integrationType:r,searchTerm:e}),d}}async function a8(r,e,t){var i,c,d,p;const n={sourceFile:Sr},s=Date.now();console.group(` [${r.toUpperCase()}] getProjectDataById - ${e}`),console.time("getProjectDataById:total"),console.log("Integration:",r),console.log("Project ID:",e);try{t.info("Fetching project data by ID",{...n,integrationType:r,projectId:e});const m=new URL(V6);m.searchParams.append("integration_type",r),m.searchParams.append("project_id",e),console.time("getProjectDataById:apiCall"),console.log(" Making API request to:",m.toString());const g=Date.now(),x=await $r(m,{method:"GET",headers:{"Content-Type":"application/json"}},t),b=Date.now()-g,E=Wy(x);if(console.timeEnd("getProjectDataById:apiCall"),console.log(" Response status:",x.status,`(${b}ms)`),console.log(" Trace ID:",E||"N/A"),x.status===504&&(console.error(" 504 Gateway Timeout - API call took too long"),console.log("Request URL:",m.toString()),console.log("Time elapsed before timeout:",b,"ms"),console.log(" Trace ID for debugging:",E||"N/A")),!x.ok){if(x.status===404)return console.log(" Project not found (404)"),console.timeEnd("getProjectDataById:total"),console.groupEnd(),t.debug("Project not found",{...n,traceId:E}),{};throw console.error(" API error:",x.status),console.timeEnd("getProjectDataById:total"),console.groupEnd(),new Error(`Failed to fetch project: ${x.status}`)}const T=x.headers.get("content-type");if(T&&T.includes("application/json")){console.time("getProjectDataById:parseJson");const S=await x.json();console.timeEnd("getProjectDataById:parseJson");const N=S.project||{},R=Date.now()-s;return console.log(" Project data fetched successfully"),console.log(" Data includes:",{hasCalendarEntries:!!((i=N.case_data)!=null&&i.calendar_entries||N.calendar_entries),hasNotes:!!((c=N.case_data)!=null&&c.notes||N.notes),hasTasks:!!((d=N.case_data)!=null&&d.last_completed_task||(p=N.case_data)!=null&&p.next_upcoming_task)}),console.log(" Timing breakdown:",{apiCall:`${b}ms`,total:`${R}ms`}),console.timeEnd("getProjectDataById:total"),console.groupEnd(),t.info("Project data fetched successfully",{...n,projectId:e}),N}else throw console.error(" Received non-JSON response"),console.timeEnd("getProjectDataById:total"),console.groupEnd(),new Error("Received non-JSON response from server")}catch(m){const g=Date.now()-s;throw console.error(" Project data fetch failed:",m instanceof Error?m.message:String(m)),console.log(" Timing at failure:",{total:`${g}ms`}),console.timeEnd("getProjectDataById:total"),console.groupEnd(),t.error("Error fetching project by ID",m,{...n,integrationType:r,projectId:e}),m}}async function l8(r,e){const t={sourceFile:Sr,functionName:"getUserDataFromServer"},n=Date.now(),s=`getUserDataFromServer:${n}`;r.debug("Starting to fetch user data...",t);const i=new URL(G6);i.searchParams.append("integration_type",e);try{const c=Date.now(),d=await $r(i,{method:"GET",headers:{"Content-Type":"application/json"}},r),p=Wy(d);if(console.timeEnd("getUserDataFromServer:apiCall"),d.status===504&&console.error(" 504 Gateway Timeout - API call took too long"),r.debug("Response received:",{...t,data:d,traceId:p}),!d.ok)throw d.status===400?(console.error(" API error: 400 - Missing required parameters"),new Error("Missing required parameters")):d.status===404?(console.error(" API error: 404 - No integration found"),new Error("No integration found for the specified type")):(console.error(" API error:",d.status),new Error(`HTTP error! status: ${d.status}`));const m=d.headers.get("content-type");if(m&&m.includes("application/json")){console.time("getUserDataFromServer:parseJson");const g=await d.json();return console.timeEnd("getUserDataFromServer:parseJson"),console.timeEnd(s),console.groupEnd(),r.debug("Parsed JSON response:",{...t,data:g}),{id:g.id||null,name:g.name||null,rate:g.rate||0}}else throw console.error(" Received non-JSON response"),new Error("Received non-JSON response from server")}catch(c){const d=Date.now()-n;throw console.error(" User data fetch failed:",c instanceof Error?c.message:String(c)),console.log(" Timing at failure:",{total:`${d}ms`}),console.timeEnd(s),console.groupEnd(),r.error("Error fetching user data:",c,t),c}}async function c8(r,e,t){var i,c;const n={sourceFile:Sr,functionName:"searchFirmUsersFromServer"};t.debug("Starting to search firm users...",{...n,integrationType:r,searchTerm:e});const s=new URL(TT);s.searchParams.append("integration_type",r),s.searchParams.append("request_function","search_firm_users"),s.searchParams.append("search_term",e),s.searchParams.append("limit","10");try{const d=await $r(s,{method:"GET",headers:{"Content-Type":"application/json"}},t);if(t.debug("Response received:",{...n,status:d.status}),!d.ok){if(d.status===404)return t.debug("No users found",n),{users:[],total:0,hasMore:!1};throw new Error(`HTTP error! status: ${d.status}`)}const p=d.headers.get("content-type");if(p&&p.includes("application/json")){const m=await d.json();return t.debug("Parsed JSON response:",{...n,usersCount:((i=m.users)==null?void 0:i.length)||0}),{users:m.users||[],total:m.total||((c=m.users)==null?void 0:c.length)||0,hasMore:m.has_more||!1}}else throw new Error("Received non-JSON response from server")}catch(d){throw t.error("Error searching firm users:",d,n),d}}async function IT(r,e){var s;const t={sourceFile:Sr,functionName:"getFirmUsersFromServer"};e.debug("Starting to fetch firm users...",{...t,integrationType:r});const n=new URL(TT);n.searchParams.append("integration_type",r),n.searchParams.append("request_function","get_firm_users");try{const i=await $r(n,{method:"GET",headers:{"Content-Type":"application/json"}},e);if(e.debug("Response received:",{...t,status:i.status}),!i.ok)throw new Error(`HTTP error! status: ${i.status}`);const c=i.headers.get("content-type");if(c&&c.includes("application/json")){const d=await i.json();return e.debug("Parsed JSON response:",{...t,usersCount:((s=d.users)==null?void 0:s.length)||0}),d.users||[]}else throw new Error("Received non-JSON response from server")}catch(i){throw e.error("Error fetching firm users:",i,t),i}}async function cy(r,e,t,n,s,i,c,d,p,m,g,x,b,E,T,S){const N={sourceFile:Sr,functionName:"writeTimeEntryToServer"};S.debug("Starting to write time entry to server...",N);try{const R=await $r(tg,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_email:r,function:"write_time_entry_to_clio",integration_type:e,date:t,quantity:n,description:s,matter_id:i,write_time_entry:c,email_subject:d,email_body:p,sent_at:m,sender_email:g,recipient_emails:x,non_billable:b,no_charge:E,price:T})},S);if(S.debug("Response received:",{...N,data:R,sourceFile:Sr}),!R.ok)throw new Error(`HTTP error! status: ${R.status}`);const A=R.headers.get("content-type");if(A&&A.includes("application/json")){const j=await R.json();return S.debug("Parsed JSON response:",{...N,data:j}),j.message||"Time entry written successfully"}else throw new Error("Received non-JSON response from server")}catch(R){throw S.error("Error writing time entry:",R,{...N,sourceFile:Sr}),R}}async function u8(r){const e={sourceFile:Sr,functionName:"getIntegrationSettingsFromServer"};r.debug("Starting to fetch integration settings...",{...e});const t=new URL(q6);try{const n=await $r(t,{method:"GET",headers:{"Content-Type":"application/json"}},r);if(r.debug("Response received:",{...e,data:n}),!n.ok){if(n.status===404)return r.debug("No settings found, returning defaults",e),{};throw new Error(`HTTP error! status: ${n.status}`)}const s=n.headers.get("content-type");if(s&&s.includes("application/json")){const i=await n.json();return r.debug("Parsed JSON response:",{...e,data:i}),i.integration_settings||{}}else throw new Error("Received non-JSON response from server")}catch(n){return r.error("Error fetching integration settings:",n,e),{}}}async function d8(r,e,t){const n={sourceFile:Sr,functionName:"generateTaskDescriptionFromEmail"};t.debug("Starting to generate task description from email...",n);try{const s=await $r(K6,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({integration_type:r,email_content:e})},t);if(t.debug("Response received:",{...n,data:s}),!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const i=s.headers.get("content-type");if(i&&i.includes("application/json")){const c=await s.json();return t.debug("Parsed JSON response:",{...n,data:c}),{name:c.name||"",description:c.description||""}}else throw new Error("Received non-JSON response from server")}catch(s){throw t.error("Error generating task description:",s,n),s}}async function f8(r,e,t,n,s,i,c,d,p,m){const g={sourceFile:Sr,functionName:"createClioTask"};c.debug("Starting to create Clio task...",{...g,taskName:e,matterId:n,dueAt:s,priority:i,assigneeId:d,reminder:p,notificationFlags:m});try{const x={function:"write_task_to_clio",integration_type:r,name:e,description:t,matter_id:n,due_at:s,priority:i};d&&(x.assignee_id=d),p&&(x.reminder=p),m&&(x.notify_assignee=m.notifyAssignee,x.notify_completion=m.notifyCompletion);const b=await $r(tg,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(x)},c);if(c.debug("Response received:",{...g,data:b}),!b.ok)throw new Error(`HTTP error! status: ${b.status}`);const E=b.headers.get("content-type");if(E&&E.includes("application/json")){const T=await b.json();return c.debug("Parsed JSON response:",{...g,data:T}),{taskId:T.task_id||"",message:T.message||"Task created successfully"}}else throw new Error("Received non-JSON response from server")}catch(x){throw c.error("Error creating Clio task:",x,g),x}}async function h8(r,e,t,n,s,i,c){const d={sourceFile:Sr,functionName:"createClioNote"};try{const m=await $r(tg,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({function:"write_note_to_clio",integration_type:r,subject:e,detail:t,date:n,matter_id:s,contact_id:i})},c);if(!m.ok){const x=await m.json();throw new Error(x.message||`HTTP error! status: ${m.status}`)}const g=await m.json();return c.info("Note created successfully",{...d,noteId:g.note_id}),{noteId:g.note_id,message:g.message||"Note created successfully"}}catch(p){throw c.error("Error creating note",p,d),p}}async function p8(r,e){const t={sourceFile:Sr,functionName:"createContactInClio"};e.debug("Starting to create Clio contact...",{...t,email:r.email});try{const n=await $r(tg,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({function:"create_contact_in_clio",integration_type:"clio",first_name:r.firstName,last_name:r.lastName,email:r.email,phone_number:r.phoneNumber,contact_type:r.type,company_name:r.companyName})},e);if(e.debug("Response received:",{...t,data:n}),!n.ok){const c=(await n.json().catch(()=>({}))).error||`HTTP error! status: ${n.status}`;throw new Error(c)}const s=n.headers.get("content-type");if(s&&s.includes("application/json")){const i=await n.json();return e.debug("Parsed JSON response:",{...t,data:i}),{id:i.contact_id||i.id||"",message:i.message||"Contact created successfully"}}else throw new Error("Received non-JSON response from server")}catch(n){throw e.error("Error creating Clio contact:",n,t),n}}async function m8(r,e,t,n,s){const i={sourceFile:Sr,functionName:"linkContactToMatter"};s.debug("Starting to link contact to matter...",{...i,contactId:e,matterId:t,relationship:n});try{const c=await $r(tg,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({function:"link_contact_to_matter",integration_type:r,contact_id:e,matter_id:t,relationship:n})},s);if(s.debug("Response received:",{...i,data:c}),!c.ok){const m=(await c.json().catch(()=>({}))).error||`HTTP error! status: ${c.status}`;throw new Error(m)}const d=c.headers.get("content-type");if(d&&d.includes("application/json")){const p=await c.json();return s.debug("Parsed JSON response:",{...i,data:p}),{message:p.message||"Contact linked to matter successfully"}}else throw new Error("Received non-JSON response from server")}catch(c){throw s.error("Error linking contact to matter:",c,i),c}}function cn(){const r=w.useContext(Y_);if(!r)throw new Error("usePlatform must be used within a PlatformProvider");if(!r.services)throw new Error("Platform services are not available. Services may still be loading or failed to initialize.");return r}const Vl=()=>cn().services.storage,fd=()=>cn().services.data,PT=()=>cn().services.auth,g8=()=>cn().services.messaging,v8=()=>cn().services.tabs,y8=()=>cn().services.lifecycle,x8=()=>cn().services.logging,w8=({children:r})=>{const[e,t]=w.useState(!0),[n,s]=w.useState(!1),[i,c]=w.useState(!1),[d,p]=w.useState(null),[m,g]=w.useState("loading"),[x,b]=w.useState(null),[E,T]=w.useState(0),S=x8(),{platform:N}=cn(),R=Vl(),A=w.useCallback(async()=>{if(N!=="chrome"){t(!1),g("disconnected"),b(new Date);return}c(!0),g("loading"),p(null);try{const M=await Vy(S);t(M),g(M?"connected":"disconnected"),b(new Date),M&&(T(0),n||(s(!0),R&&R.setLocalItem("wasEverConnectedGmail",!0).catch(V=>{S.error("Failed to save wasEverConnected to storage",V,{sourceFile:"src/shared/contexts/GmailConnectionContext/GmailConnectionProvider.tsx"})}))),S.debug("Gmail connection status checked",{sourceFile:"src/shared/contexts/GmailConnectionContext/GmailConnectionProvider.tsx",connected:M,status:M?"connected":"disconnected"})}catch(M){const V=M instanceof Error?M.message:"Unknown error occurred";p(V),t(!1),g("error"),b(new Date),S.error("Error checking Gmail connection",M,{sourceFile:"src/shared/contexts/GmailConnectionContext/GmailConnectionProvider.tsx"})}finally{c(!1)}},[S,N,n,R]),j=w.useCallback(async()=>{try{T(ue=>ue+1),g("loading"),p(null);const{initiateIntegration:M,findIntegrationById:V}=await Nw(async()=>{const{initiateIntegration:ue,findIntegrationById:oe}=await Promise.resolve().then(()=>b9);return{initiateIntegration:ue,findIntegrationById:oe}},void 0),{GMAIL_INTEGRATION_PAGE_URI:X,GMAIL_INTEGRATION_REDIRECT_URI:ie}=await Nw(async()=>{const{GMAIL_INTEGRATION_PAGE_URI:ue,GMAIL_INTEGRATION_REDIRECT_URI:oe}=await Promise.resolve().then(()=>wU);return{GMAIL_INTEGRATION_PAGE_URI:ue,GMAIL_INTEGRATION_REDIRECT_URI:oe}},void 0),J=X(ie),ae=await V("gmail");if(!ae)throw new Error("Gmail integration not found");const we=await M(S,ae,J);return we?await A():g("disconnected"),we}catch(M){const V=M instanceof Error?M.message:"Failed to reconnect Gmail";throw p(V),g("error"),S.error("Failed to reconnect Gmail:",M,{sourceFile:"src/shared/contexts/GmailConnectionContext/GmailConnectionProvider.tsx",attemptNumber:E+1}),M}},[S,A,E]),P=w.useCallback(()=>{p(null),m==="error"&&g(e?"connected":"disconnected")},[m,e]),$=w.useCallback(async()=>{await A()},[A]);w.useEffect(()=>{if(N!=="chrome")return;const M=setInterval(()=>{A()},36e5);return()=>clearInterval(M)},[A,N]),w.useEffect(()=>{if(N!=="chrome")return;const V=(async()=>{try{const ie=(await Vn.createServices()).storage;if(ie.onChanged){const J=ae=>{if(ae.gmailConnectionStatus){const we=ae.gmailConnectionStatus.newValue;S.debug("Gmail connection status changed via storage",{sourceFile:"src/shared/contexts/GmailConnectionContext/GmailConnectionProvider.tsx",newStatus:we,oldStatus:ae.gmailConnectionStatus.oldValue}),we!==void 0&&(t(we),g(we?"connected":"disconnected"),b(new Date),we&&d&&p(null))}};return ie.onChanged(J),()=>{ie.removeChangeListener&&ie.removeChangeListener(J)}}}catch(X){S.error("Failed to set up Gmail connection storage listener:",X,{sourceFile:"src/shared/contexts/GmailConnectionContext/GmailConnectionProvider.tsx"})}})();return()=>{V.then(X=>X==null?void 0:X())}},[N,S,d]),w.useEffect(()=>{(async()=>{if(!(N!=="chrome"||!R))try{const V=await R.getLocalItem("wasEverConnectedGmail");V!==null&&(s(V),S.debug("Loaded wasEverConnected from storage",{sourceFile:"src/shared/contexts/GmailConnectionContext/GmailConnectionProvider.tsx",wasEverConnected:V}))}catch(V){S.error("Failed to load wasEverConnected from storage",V,{sourceFile:"src/shared/contexts/GmailConnectionContext/GmailConnectionProvider.tsx"})}})()},[N,R,S]),w.useEffect(()=>{A()},[A]);const W={isConnected:e,wasEverConnected:n,isLoading:i,error:d,status:m,lastChecked:x,reconnectAttempts:E,checkConnection:A,initiateReconnection:j,clearError:P,forceRefresh:$};return u.jsx(fT.Provider,{value:W,children:r})},FT=w.createContext(void 0),jT=()=>{const r=w.useContext(FT);if(!r)throw new Error("useActiveSection must be used within an ActiveSectionProvider");return r},b8=({children:r})=>{const[e,t]=w.useState("main");return u.jsx(FT.Provider,{value:{activeSection:e,setActiveSection:t},children:r})};var _e=typeof window<"u"?window:void 0,ys=typeof globalThis<"u"?globalThis:_e;typeof self>"u"&&(ys.self=ys),typeof File>"u"&&(ys.File=function(){});var OT=Array.prototype,CC=OT.forEach,kC=OT.indexOf,Xo=ys==null?void 0:ys.navigator,Ve=ys==null?void 0:ys.document,gs=ys==null?void 0:ys.location,Hw=ys==null?void 0:ys.fetch,Bw=ys!=null&&ys.XMLHttpRequest&&"withCredentials"in new ys.XMLHttpRequest?ys.XMLHttpRequest:void 0,NC=ys==null?void 0:ys.AbortController,So=Xo==null?void 0:Xo.userAgent,xt=_e??{},Fl={DEBUG:!1,LIB_VERSION:"1.343.2"};function TC(r,e,t,n,s,i,c){try{var d=r[i](c),p=d.value}catch(m){return void t(m)}d.done?e(p):Promise.resolve(p).then(n,s)}function Jf(r){return function(){var e=this,t=arguments;return new Promise((function(n,s){var i=r.apply(e,t);function c(p){TC(i,n,s,c,d,"next",p)}function d(p){TC(i,n,s,c,d,"throw",p)}c(void 0)}))}}function Qe(){return Qe=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)({}).hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},Qe.apply(null,arguments)}function DT(r,e){if(r==null)return{};var t={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(e.indexOf(n)!==-1)continue;t[n]=r[n]}return t}var _8=["amazonbot","amazonproductbot","app.hypefactors.com","applebot","archive.org_bot","awariobot","backlinksextendedbot","baiduspider","bingbot","bingpreview","chrome-lighthouse","dataforseobot","deepscan","duckduckbot","facebookexternal","facebookcatalog","http://yandex.com/bots","hubspot","ia_archiver","leikibot","linkedinbot","meta-externalagent","mj12bot","msnbot","nessus","petalbot","pinterest","prerender","rogerbot","screaming frog","sebot-wa","sitebulb","slackbot","slurp","trendictionbot","turnitin","twitterbot","vercel-screenshot","vercelbot","yahoo! slurp","yandexbot","zoombot","bot.htm","bot.php","(bot;","bot/","crawler","ahrefsbot","ahrefssiteaudit","semrushbot","siteauditbot","splitsignalbot","gptbot","oai-searchbot","chatgpt-user","perplexitybot","better uptime bot","sentryuptimebot","uptimerobot","headlesschrome","cypress","google-hoteladsverifier","adsbot-google","apis-google","duplexweb-google","feedfetcher-google","google favicon","google web preview","google-read-aloud","googlebot","googleother","google-cloudvertexbot","googleweblight","mediapartners-google","storebot-google","google-inspectiontool","bytespider"],RC=function(r,e){if(e===void 0&&(e=[]),!r)return!1;var t=r.toLowerCase();return _8.concat(e).some((n=>{var s=n.toLowerCase();return t.indexOf(s)!==-1}))},E8=["$snapshot","$pageview","$pageleave","$set","survey dismissed","survey sent","survey shown","$identify","$groupidentify","$create_alias","$$client_ingestion_warning","$web_experiment_applied","$feature_enrollment_update","$feature_flag_called"];function ur(r,e){return r.indexOf(e)!==-1}var Ky=function(r){return r.trim()},Gw=function(r){return r.replace(/^\$/,"")},S8=Array.isArray,LT=Object.prototype,MT=LT.hasOwnProperty,Yy=LT.toString,Fr=S8||function(r){return Yy.call(r)==="[object Array]"},Hc=r=>typeof r=="function",Gn=r=>r===Object(r)&&!Fr(r),Xf=r=>{if(Gn(r)){for(var e in r)if(MT.call(r,e))return!1;return!0}return!1},qe=r=>r===void 0,Wn=r=>Yy.call(r)=="[object String]",Ww=r=>Wn(r)&&r.trim().length===0,na=r=>r===null,fr=r=>qe(r)||na(r),zl=r=>Yy.call(r)=="[object Number]"&&r==r,qf=r=>zl(r)&&r>0,$l=r=>Yy.call(r)==="[object Boolean]",C8=r=>r instanceof FormData,k8=r=>ur(E8,r);function Vw(r){return r===null||typeof r!="object"}function uy(r,e){return Object.prototype.toString.call(r)==="[object "+e+"]"}function $T(r){return!qe(Event)&&(function(e,t){try{return e instanceof t}catch{return!1}})(r,Event)}var N8=[!0,"true",1,"1","yes"],Px=r=>ur(N8,r),T8=[!1,"false",0,"0","no"];function za(r,e,t,n,s){return e>t&&(n.warn("min cannot be greater than max."),e=t),zl(r)?r>t?(n.warn(" cannot be  greater than max: "+t+". Using max value instead."),t):r<e?(n.warn(" cannot be less than min: "+e+". Using min value instead."),e):r:(n.warn(" must be a number. using max or fallback. max: "+t+", fallback: "+s),za(s||t,e,t,n))}class R8{constructor(e){this.t={},this.i=e.i,this.o=za(e.bucketSize,0,100,e.h),this.m=za(e.refillRate,0,this.o,e.h),this.$=za(e.refillInterval,0,864e5,e.h)}S(e,t){var n=t-e.lastAccess,s=Math.floor(n/this.$);if(s>0){var i=s*this.m;e.tokens=Math.min(e.tokens+i,this.o),e.lastAccess=e.lastAccess+s*this.$}}consumeRateLimit(e){var t,n=Date.now(),s=String(e),i=this.t[s];return i?this.S(i,n):(i={tokens:this.o,lastAccess:n},this.t[s]=i),i.tokens===0||(i.tokens--,i.tokens===0&&((t=this.i)==null||t.call(this,e)),i.tokens===0)}stop(){this.t={}}}var Si="Mobile",dy="iOS",Ll="Android",Mm="Tablet",UT=Ll+" "+Mm,zT="iPad",HT="Apple",BT=HT+" Watch",$m="Safari",dh="BlackBerry",GT="Samsung",WT=GT+"Browser",VT=GT+" Internet",ad="Chrome",A8=ad+" OS",qT=ad+" "+dy,Q_="Internet Explorer",KT=Q_+" "+Si,Z_="Opera",I8=Z_+" Mini",eE="Edge",YT="Microsoft "+eE,rh="Firefox",JT=rh+" "+dy,Um="Nintendo",zm="PlayStation",nh="Xbox",XT=Ll+" "+Si,QT=Si+" "+$m,um="Windows",qw=um+" Phone",AC="Nokia",Kw="Ouya",ZT="Generic",P8=ZT+" "+Si.toLowerCase(),eR=ZT+" "+Mm.toLowerCase(),Yw="Konqueror",Qs="(\\d+(\\.\\d+)?)",Fx=new RegExp("Version/"+Qs),F8=new RegExp(nh,"i"),j8=new RegExp(zm+" \\w+","i"),O8=new RegExp(Um+" \\w+","i"),tE=new RegExp(dh+"|PlayBook|BB10","i"),D8={"NT3.51":"NT 3.11","NT4.0":"NT 4.0","5.0":"2000",5.1:"XP",5.2:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1",6.4:"10","10.0":"10"},kv,IC,jx,L8=(r,e)=>e&&ur(e,HT)||(function(t){return ur(t,$m)&&!ur(t,ad)&&!ur(t,Ll)})(r),tR=function(r,e){return e=e||"",ur(r," OPR/")&&ur(r,"Mini")?I8:ur(r," OPR/")?Z_:tE.test(r)?dh:ur(r,"IE"+Si)||ur(r,"WPDesktop")?KT:ur(r,WT)?VT:ur(r,eE)||ur(r,"Edg/")?YT:ur(r,"FBIOS")?"Facebook "+Si:ur(r,"UCWEB")||ur(r,"UCBrowser")?"UC Browser":ur(r,"CriOS")?qT:ur(r,"CrMo")||ur(r,ad)?ad:ur(r,Ll)&&ur(r,$m)?XT:ur(r,"FxiOS")?JT:ur(r.toLowerCase(),Yw.toLowerCase())?Yw:L8(r,e)?ur(r,Si)?QT:$m:ur(r,rh)?rh:ur(r,"MSIE")||ur(r,"Trident/")?Q_:ur(r,"Gecko")?rh:""},M8={[KT]:[new RegExp("rv:"+Qs)],[YT]:[new RegExp(eE+"?\\/"+Qs)],[ad]:[new RegExp("("+ad+"|CrMo)\\/"+Qs)],[qT]:[new RegExp("CriOS\\/"+Qs)],"UC Browser":[new RegExp("(UCBrowser|UCWEB)\\/"+Qs)],[$m]:[Fx],[QT]:[Fx],[Z_]:[new RegExp("(Opera|OPR)\\/"+Qs)],[rh]:[new RegExp(rh+"\\/"+Qs)],[JT]:[new RegExp("FxiOS\\/"+Qs)],[Yw]:[new RegExp("Konqueror[:/]?"+Qs,"i")],[dh]:[new RegExp(dh+" "+Qs),Fx],[XT]:[new RegExp("android\\s"+Qs,"i")],[VT]:[new RegExp(WT+"\\/"+Qs)],[Q_]:[new RegExp("(rv:|MSIE )"+Qs)],Mozilla:[new RegExp("rv:"+Qs)]},$8=function(r,e){var t=tR(r,e),n=M8[t];if(qe(n))return null;for(var s=0;s<n.length;s++){var i=n[s],c=r.match(i);if(c)return parseFloat(c[c.length-2])}return null},PC=[[new RegExp(nh+"; "+nh+" (.*?)[);]","i"),r=>[nh,r&&r[1]||""]],[new RegExp(Um,"i"),[Um,""]],[new RegExp(zm,"i"),[zm,""]],[tE,[dh,""]],[new RegExp(um,"i"),(r,e)=>{if(/Phone/.test(e)||/WPDesktop/.test(e))return[qw,""];if(new RegExp(Si).test(e)&&!/IEMobile\b/.test(e))return[um+" "+Si,""];var t=/Windows NT ([0-9.]+)/i.exec(e);if(t&&t[1]){var n=t[1],s=D8[n]||"";return/arm/i.test(e)&&(s="RT"),[um,s]}return[um,""]}],[/((iPhone|iPad|iPod).*?OS (\d+)_(\d+)_?(\d+)?|iPhone)/,r=>{if(r&&r[3]){var e=[r[3],r[4],r[5]||"0"];return[dy,e.join(".")]}return[dy,""]}],[/(watch.*\/(\d+\.\d+\.\d+)|watch os,(\d+\.\d+),)/i,r=>{var e="";return r&&r.length>=3&&(e=qe(r[2])?r[3]:r[2]),["watchOS",e]}],[new RegExp("("+Ll+" (\\d+)\\.(\\d+)\\.?(\\d+)?|"+Ll+")","i"),r=>{if(r&&r[2]){var e=[r[2],r[3],r[4]||"0"];return[Ll,e.join(".")]}return[Ll,""]}],[/Mac OS X (\d+)[_.](\d+)[_.]?(\d+)?/i,r=>{var e=["Mac OS X",""];if(r&&r[1]){var t=[r[1],r[2],r[3]||"0"];e[1]=t.join(".")}return e}],[/Mac/i,["Mac OS X",""]],[/CrOS/,[A8,""]],[/Linux|debian/i,["Linux",""]]],FC=function(r){return O8.test(r)?Um:j8.test(r)?zm:F8.test(r)?nh:new RegExp(Kw,"i").test(r)?Kw:new RegExp("("+qw+"|WPDesktop)","i").test(r)?qw:/iPad/.test(r)?zT:/iPod/.test(r)?"iPod Touch":/iPhone/.test(r)?"iPhone":/(watch)(?: ?os[,/]|\d,\d\/)[\d.]+/i.test(r)?BT:tE.test(r)?dh:/(kobo)\s(ereader|touch)/i.test(r)?"Kobo":new RegExp(AC,"i").test(r)?AC:/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i.test(r)||/(kf[a-z]+)( bui|\)).+silk\//i.test(r)?"Kindle Fire":/(Android|ZTE)/i.test(r)?new RegExp(Si).test(r)&&!/(9138B|TB782B|Nexus [97]|pixel c|HUAWEISHT|BTV|noble nook|smart ultra 6)/i.test(r)||/pixel[\daxl ]{1,6}/i.test(r)&&!/pixel c/i.test(r)||/(huaweimed-al00|tah-|APA|SM-G92|i980|zte|U304AA)/i.test(r)||/lmy47v/i.test(r)&&!/QTAQZ3/i.test(r)?Ll:UT:new RegExp("(pda|"+Si+")","i").test(r)?P8:new RegExp(Mm,"i").test(r)&&!new RegExp(Mm+" pc","i").test(r)?eR:""},U8=r=>r instanceof Error;function z8(r){var e=globalThis._posthogChunkIds;if(e){var t=Object.keys(e);return jx&&t.length===IC||(IC=t.length,jx=t.reduce(((n,s)=>{kv||(kv={});var i=kv[s];if(i)n[i[0]]=i[1];else for(var c=r(s),d=c.length-1;d>=0;d--){var p=c[d],m=p==null?void 0:p.filename,g=e[s];if(m&&g){n[m]=g,kv[s]=[m,g];break}}return n}),{})),jx}}class H8{constructor(e,t,n){n===void 0&&(n=[]),this.coercers=e,this.stackParser=t,this.modifiers=n}buildFromUnknown(e,t){t===void 0&&(t={});var n=t&&t.mechanism||{handled:!0,type:"generic"},s=this.buildCoercingContext(n,t,0).apply(e),i=this.buildParsingContext(t),c=this.parseStacktrace(s,i);return{$exception_list:this.convertToExceptionList(c,n),$exception_level:"error"}}modifyFrames(e){var t=this;return Jf((function*(){for(var n of e)n.stacktrace&&n.stacktrace.frames&&Fr(n.stacktrace.frames)&&(n.stacktrace.frames=yield t.applyModifiers(n.stacktrace.frames));return e}))()}coerceFallback(e){var t;return{type:"Error",value:"Unknown error",stack:(t=e.syntheticException)==null?void 0:t.stack,synthetic:!0}}parseStacktrace(e,t){var n,s;return e.cause!=null&&(n=this.parseStacktrace(e.cause,t)),e.stack!=""&&e.stack!=null&&(s=this.applyChunkIds(this.stackParser(e.stack,e.synthetic?t.skipFirstLines:0),t.chunkIdMap)),Qe({},e,{cause:n,stack:s})}applyChunkIds(e,t){return e.map((n=>(n.filename&&t&&(n.chunk_id=t[n.filename]),n)))}applyCoercers(e,t){for(var n of this.coercers)if(n.match(e))return n.coerce(e,t);return this.coerceFallback(t)}applyModifiers(e){var t=this;return Jf((function*(){var n=e;for(var s of t.modifiers)n=yield s(n);return n}))()}convertToExceptionList(e,t){var n,s,i,c={type:e.type,value:e.value,mechanism:{type:(n=t.type)!==null&&n!==void 0?n:"generic",handled:(s=t.handled)===null||s===void 0||s,synthetic:(i=e.synthetic)!==null&&i!==void 0&&i}};e.stack&&(c.stacktrace={type:"raw",frames:e.stack});var d=[c];return e.cause!=null&&d.push(...this.convertToExceptionList(e.cause,Qe({},t,{handled:!0}))),d}buildParsingContext(e){var t;return{chunkIdMap:z8(this.stackParser),skipFirstLines:(t=e.skipFirstLines)!==null&&t!==void 0?t:1}}buildCoercingContext(e,t,n){n===void 0&&(n=0);var s=(i,c)=>{if(c<=4){var d=this.buildCoercingContext(e,t,c);return this.applyCoercers(i,d)}};return Qe({},t,{syntheticException:n==0?t.syntheticException:void 0,mechanism:e,apply:i=>s(i,n),next:i=>s(i,n+1)})}}var fh="?";function Jw(r,e,t,n,s){var i={platform:r,filename:e,function:t==="<anonymous>"?fh:t,in_app:!0};return qe(n)||(i.lineno=n),qe(s)||(i.colno=s),i}var rR=(r,e)=>{var t=r.indexOf("safari-extension")!==-1,n=r.indexOf("safari-web-extension")!==-1;return t||n?[r.indexOf("@")!==-1?r.split("@")[0]:fh,t?"safari-extension:"+e:"safari-web-extension:"+e]:[r,e]},B8=/^\s*at (\S+?)(?::(\d+))(?::(\d+))\s*$/i,G8=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,W8=/\((\S*)(?::(\d+))(?::(\d+))\)/,V8=(r,e)=>{var t=B8.exec(r);if(t){var[,n,s,i]=t;return Jw(e,n,fh,+s,+i)}var c=G8.exec(r);if(c){if(c[2]&&c[2].indexOf("eval")===0){var d=W8.exec(c[2]);d&&(c[2]=d[1],c[3]=d[2],c[4]=d[3])}var[p,m]=rR(c[1]||fh,c[2]);return Jw(e,m,p,c[3]?+c[3]:void 0,c[4]?+c[4]:void 0)}},q8=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,K8=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,Y8=(r,e)=>{var t=q8.exec(r);if(t){if(t[3]&&t[3].indexOf(" > eval")>-1){var n=K8.exec(t[3]);n&&(t[1]=t[1]||"eval",t[3]=n[1],t[4]=n[2],t[5]="")}var s=t[3],i=t[1]||fh;return[i,s]=rR(i,s),Jw(e,s,i,t[4]?+t[4]:void 0,t[5]?+t[5]:void 0)}},jC=/\(error: (.*)\)/,OC=50;function J8(){return(function(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return function(s,i){i===void 0&&(i=0);for(var c=[],d=s.split(`
`),p=i;p<d.length;p++){var m=d[p];if(!(m.length>1024)){var g=jC.test(m)?m.replace(jC,"$1"):m;if(!g.match(/\S*Error: /)){for(var x of t){var b=x(g,r);if(b){c.push(b);break}}if(c.length>=OC)break}}}return(function(E){if(!E.length)return[];var T=Array.from(E);return T.reverse(),T.slice(0,OC).map((S=>{return Qe({},S,{filename:S.filename||(N=T,N[N.length-1]||{}).filename,function:S.function||fh});var N}))})(c)}})("web:javascript",V8,Y8)}class X8{match(e){return this.isDOMException(e)||this.isDOMError(e)}coerce(e,t){var n=Wn(e.stack);return{type:this.getType(e),value:this.getValue(e),stack:n?e.stack:void 0,cause:e.cause?t.next(e.cause):void 0,synthetic:!1}}getType(e){return this.isDOMError(e)?"DOMError":"DOMException"}getValue(e){var t=e.name||(this.isDOMError(e)?"DOMError":"DOMException");return e.message?t+": "+e.message:t}isDOMException(e){return uy(e,"DOMException")}isDOMError(e){return uy(e,"DOMError")}}class Q8{match(e){return(t=>t instanceof Error)(e)}coerce(e,t){return{type:this.getType(e),value:this.getMessage(e,t),stack:this.getStack(e),cause:e.cause?t.next(e.cause):void 0,synthetic:!1}}getType(e){return e.name||e.constructor.name}getMessage(e,t){var n=e.message;return n.error&&typeof n.error.message=="string"?String(n.error.message):String(n)}getStack(e){return e.stacktrace||e.stack||void 0}}class Z8{constructor(){}match(e){return uy(e,"ErrorEvent")&&e.error!=null}coerce(e,t){var n,s=t.apply(e.error);return s||{type:"ErrorEvent",value:e.message,stack:(n=t.syntheticException)==null?void 0:n.stack,synthetic:!0}}}var ez=/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/i;class tz{match(e){return typeof e=="string"}coerce(e,t){var n,[s,i]=this.getInfos(e);return{type:s??"Error",value:i??e,stack:(n=t.syntheticException)==null?void 0:n.stack,synthetic:!0}}getInfos(e){var t="Error",n=e,s=e.match(ez);return s&&(t=s[1],n=s[2]),[t,n]}}var rz=["fatal","error","warning","log","info","debug"];function nR(r,e){e===void 0&&(e=40);var t=Object.keys(r);if(t.sort(),!t.length)return"[object has no keys]";for(var n=t.length;n>0;n--){var s=t.slice(0,n).join(", ");if(!(s.length>e))return n===t.length||s.length<=e?s:s.slice(0,e)+"..."}return""}class nz{match(e){return typeof e=="object"&&e!==null}coerce(e,t){var n,s=this.getErrorPropertyFromObject(e);return s?t.apply(s):{type:this.getType(e),value:this.getValue(e),stack:(n=t.syntheticException)==null?void 0:n.stack,level:this.isSeverityLevel(e.level)?e.level:"error",synthetic:!0}}getType(e){return $T(e)?e.constructor.name:"Error"}getValue(e){if("name"in e&&typeof e.name=="string"){var t="'"+e.name+"' captured as exception";return"message"in e&&typeof e.message=="string"&&(t+=" with message: '"+e.message+"'"),t}if("message"in e&&typeof e.message=="string")return e.message;var n=this.getObjectClassName(e);return(n&&n!=="Object"?"'"+n+"'":"Object")+" captured as exception with keys: "+nR(e)}isSeverityLevel(e){return Wn(e)&&!Ww(e)&&rz.indexOf(e)>=0}getErrorPropertyFromObject(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var n=e[t];if(U8(n))return n}}getObjectClassName(e){try{var t=Object.getPrototypeOf(e);return t?t.constructor.name:void 0}catch{return}}}class sz{match(e){return $T(e)}coerce(e,t){var n,s=e.constructor.name;return{type:s,value:s+" captured as exception with keys: "+nR(e),stack:(n=t.syntheticException)==null?void 0:n.stack,synthetic:!0}}}class oz{match(e){return Vw(e)}coerce(e,t){var n;return{type:"Error",value:"Primitive value captured as exception: "+String(e),stack:(n=t.syntheticException)==null?void 0:n.stack,synthetic:!0}}}class iz{match(e){return uy(e,"PromiseRejectionEvent")}coerce(e,t){var n,s=this.getUnhandledRejectionReason(e);return Vw(s)?{type:"UnhandledRejection",value:"Non-Error promise rejection captured with value: "+String(s),stack:(n=t.syntheticException)==null?void 0:n.stack,synthetic:!0}:t.apply(s)}getUnhandledRejectionReason(e){if(Vw(e))return e;try{if("reason"in e)return e.reason;if("detail"in e&&"reason"in e.detail)return e.detail.reason}catch{}return e}}var sR=function(r,e){var{debugEnabled:t}=e===void 0?{}:e,n={k:function(s){if(_e&&(Fl.DEBUG||xt.POSTHOG_DEBUG||t)&&!qe(_e.console)&&_e.console){for(var i=("__rrweb_original__"in _e.console[s])?_e.console[s].__rrweb_original__:_e.console[s],c=arguments.length,d=new Array(c>1?c-1:0),p=1;p<c;p++)d[p-1]=arguments[p];i(r,...d)}},info:function(){for(var s=arguments.length,i=new Array(s),c=0;c<s;c++)i[c]=arguments[c];n.k("log",...i)},warn:function(){for(var s=arguments.length,i=new Array(s),c=0;c<s;c++)i[c]=arguments[c];n.k("warn",...i)},error:function(){for(var s=arguments.length,i=new Array(s),c=0;c<s;c++)i[c]=arguments[c];n.k("error",...i)},critical:function(){for(var s=arguments.length,i=new Array(s),c=0;c<s;c++)i[c]=arguments[c];console.error(r,...i)},uninitializedWarning:s=>{n.error("You must initialize PostHog before calling "+s)},createLogger:(s,i)=>sR(r+" "+s,i)};return n},Xe=sR("[PostHog.js]"),xn=Xe.createLogger,az=xn("[ExternalScriptsLoader]"),DC=(r,e,t)=>{if(r.config.disable_external_dependency_loading)return az.warn(e+" was requested but loading of external scripts is disabled."),t("Loading of external scripts is disabled");var n=Ve==null?void 0:Ve.querySelectorAll("script");if(n){for(var s,i=function(){if(n[c].src===e){var p=n[c];return p.__posthog_loading_callback_fired?{v:t()}:(p.addEventListener("load",(m=>{p.__posthog_loading_callback_fired=!0,t(void 0,m)})),p.onerror=m=>t(m),{v:void 0})}},c=0;c<n.length;c++)if(s=i())return s.v}var d=()=>{if(!Ve)return t("document not found");var p=Ve.createElement("script");if(p.type="text/javascript",p.crossOrigin="anonymous",p.src=e,p.onload=x=>{p.__posthog_loading_callback_fired=!0,t(void 0,x)},p.onerror=x=>t(x),r.config.prepare_external_dependency_script&&(p=r.config.prepare_external_dependency_script(p)),!p)return t("prepare_external_dependency_script returned null");if(r.config.external_scripts_inject_target==="head")Ve.head.appendChild(p);else{var m,g=Ve.querySelectorAll("body > script");g.length>0?(m=g[0].parentNode)==null||m.insertBefore(p,g[0]):Ve.body.appendChild(p)}};Ve!=null&&Ve.body?d():Ve==null||Ve.addEventListener("DOMContentLoaded",d)};xt.__PosthogExtensions__=xt.__PosthogExtensions__||{},xt.__PosthogExtensions__.loadExternalDependency=(r,e,t)=>{var n="/static/"+e+".js?v="+r.version;if(e==="remote-config"&&(n="/array/"+r.config.token+"/config.js"),e==="toolbar"){var s=3e5;n=n+"&t="+Math.floor(Date.now()/s)*s}var i=r.requestRouter.endpointFor("assets",n);DC(r,i,t)},xt.__PosthogExtensions__.loadSiteApp=(r,e,t)=>{var n=r.requestRouter.endpointFor("api",e);DC(r,n,t)};var fy={};function Bc(r,e,t){if(Fr(r)){if(CC&&r.forEach===CC)r.forEach(e,t);else if("length"in r&&r.length===+r.length){for(var n=0,s=r.length;n<s;n++)if(n in r&&e.call(t,r[n],n)===fy)return}}}function Zr(r,e,t){if(!fr(r)){if(Fr(r))return Bc(r,e,t);if(C8(r)){for(var n of r.entries())if(e.call(t,n[1],n[0])===fy)return}else for(var s in r)if(MT.call(r,s)&&e.call(t,r[s],s)===fy)return}}var kn=function(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return Bc(t,(function(s){for(var i in s)s[i]!==void 0&&(r[i]=s[i])})),r},xh=function(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return Bc(t,(function(s){Bc(s,(function(i){r.push(i)}))})),r};function Jv(r){for(var e=Object.keys(r),t=e.length,n=new Array(t);t--;)n[t]=[e[t],r[e[t]]];return n}var LC=function(r){try{return r()}catch{return}},lz=function(r){return function(){try{for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.apply(this,t)}catch(s){Xe.critical("Implementation error. Please turn on debug mode and open a ticket on https://app.posthog.com/home#panel=support%3Asupport%3A."),Xe.critical(s)}}},rE=function(r){var e={};return Zr(r,(function(t,n){(Wn(t)&&t.length>0||zl(t))&&(e[n]=t)})),e};function cz(r,e){return t=r,n=i=>Wn(i)&&!na(e)?i.slice(0,e):i,s=new Set,(function i(c,d){return c!==Object(c)?n?n(c,d):c:s.has(c)?void 0:(s.add(c),Fr(c)?(p=[],Bc(c,(m=>{p.push(i(m))}))):(p={},Zr(c,((m,g)=>{s.has(m)||(p[g]=i(m,g))}))),p);var p})(t);var t,n,s}var uz=["herokuapp.com","vercel.app","netlify.app"];function dz(r){var e=r==null?void 0:r.hostname;if(!Wn(e))return!1;var t=e.split(".").slice(-2).join(".");for(var n of uz)if(t===n)return!1;return!0}function oR(r,e){for(var t=0;t<r.length;t++)if(e(r[t]))return r[t]}function jn(r,e,t,n){var{capture:s=!1,passive:i=!0}=n??{};r==null||r.addEventListener(e,t,{capture:s,passive:i})}var iR="$people_distinct_id",dm="__alias",fm="__timers",MC="$autocapture_disabled_server_side",Xw="$heatmaps_enabled_server_side",$C="$exception_capture_enabled_server_side",Qw="$error_tracking_suppression_rules",UC="$error_tracking_capture_extension_exceptions",zC="$web_vitals_enabled_server_side",aR="$dead_clicks_enabled_server_side",HC="$product_tours_enabled_server_side",BC="$web_vitals_allowed_metrics",Ox="$session_recording_remote_config",hy="$sesid",lR="$session_is_sampled",Qf="$enabled_feature_flags",hm="$early_access_features",Zw="$feature_flag_details",pm="$stored_person_properties",ed="$stored_group_properties",eb="$surveys",py="$flag_call_reported",jl="$user_state",tb="$client_session_props",rb="$capture_rate_limit",nb="$initial_campaign_params",sb="$initial_referrer_info",my="$initial_person_info",gy="$epp",cR="__POSTHOG_TOOLBAR__",Vp="$posthog_cookieless",fz=[iR,dm,"__cmpns",fm,"$session_recording_enabled_server_side",Xw,hy,Qf,Qw,jl,hm,Zw,ed,pm,eb,py,tb,rb,nb,sb,gy,my,"$conversations_widget_session_id","$conversations_ticket_id","$conversations_widget_state","$conversations_user_traits"];function GC(r){return r instanceof Element&&(r.id===cR||!(r.closest==null||!r.closest(".toolbar-global-fade-container")))}function Jy(r){return!!r&&r.nodeType===1}function Gc(r,e){return!!r&&!!r.tagName&&r.tagName.toLowerCase()===e.toLowerCase()}function uR(r){return!!r&&r.nodeType===3}function dR(r){return!!r&&r.nodeType===11}function nE(r){return r?Ky(r).split(/\s+/):[]}function WC(r){var e=_e==null?void 0:_e.location.href;return!!(e&&r&&r.some((t=>e.match(t))))}function vy(r){var e="";switch(typeof r.className){case"string":e=r.className;break;case"object":e=(r.className&&"baseVal"in r.className?r.className.baseVal:null)||r.getAttribute("class")||"";break;default:e=""}return nE(e)}function fR(r){return fr(r)?null:Ky(r).split(/(\s+)/).filter((e=>Hm(e))).join("").replace(/[\r\n]/g," ").replace(/[ ]+/g," ").substring(0,255)}function rg(r){var e="";return ob(r)&&!vR(r)&&r.childNodes&&r.childNodes.length&&Zr(r.childNodes,(function(t){var n;uR(t)&&t.textContent&&(e+=(n=fR(t.textContent))!==null&&n!==void 0?n:"")})),Ky(e)}function hR(r){return qe(r.target)?r.srcElement||null:(e=r.target)!=null&&e.shadowRoot?r.composedPath()[0]||null:r.target||null;var e}var sE=["a","button","form","input","select","textarea","label"];function pR(r,e){if(qe(e))return!0;var t,n=function(i){if(e.some((c=>i.matches(c))))return{v:!0}};for(var s of r)if(t=n(s))return t.v;return!1}function mR(r){var e=r.parentNode;return!(!e||!Jy(e))&&e}var hz=["next","previous","prev",">","<"],VC=10,qC=[".ph-no-rageclick",".ph-no-capture"];function pz(r,e){if(!_e||oE(r))return!1;var t,n,s;if($l(e)?(t=!!e&&qC,n=void 0):(t=(s=e==null?void 0:e.css_selector_ignorelist)!==null&&s!==void 0?s:qC,n=e==null?void 0:e.content_ignorelist),t===!1)return!1;var{targetElementList:i}=gR(r,!1);return!(function(c,d){if(c===!1||qe(c))return!1;var p;if(c===!0)p=hz;else{if(!Fr(c))return!1;if(c.length>VC)return Xe.error("[PostHog] content_ignorelist array cannot exceed "+VC+" items. Use css_selector_ignorelist for more complex matching."),!1;p=c.map((m=>m.toLowerCase()))}return d.some((m=>{var{safeText:g,ariaLabel:x}=m;return p.some((b=>g.includes(b)||x.includes(b)))}))})(n,i.map((c=>{var d;return{safeText:rg(c).toLowerCase(),ariaLabel:((d=c.getAttribute("aria-label"))==null?void 0:d.toLowerCase().trim())||""}})))&&!pR(i,t)}var oE=r=>!r||Gc(r,"html")||!Jy(r),gR=(r,e)=>{if(!_e||oE(r))return{parentIsUsefulElement:!1,targetElementList:[]};for(var t=!1,n=[r],s=r;s.parentNode&&!Gc(s,"body");)if(dR(s.parentNode))n.push(s.parentNode.host),s=s.parentNode.host;else{var i=mR(s);if(!i)break;if(e||sE.indexOf(i.tagName.toLowerCase())>-1)t=!0;else{var c=_e.getComputedStyle(i);c&&c.getPropertyValue("cursor")==="pointer"&&(t=!0)}n.push(i),s=i}return{parentIsUsefulElement:t,targetElementList:n}};function mz(r,e,t,n,s){var i,c,d,p;if(t===void 0&&(t=void 0),!_e||oE(r)||(i=t)!=null&&i.url_allowlist&&!WC(t.url_allowlist)||(c=t)!=null&&c.url_ignorelist&&WC(t.url_ignorelist))return!1;if((d=t)!=null&&d.dom_event_allowlist){var m=t.dom_event_allowlist;if(m&&!m.some((T=>e.type===T)))return!1}var{parentIsUsefulElement:g,targetElementList:x}=gR(r,n);if(!(function(T,S){var N=S==null?void 0:S.element_allowlist;if(qe(N))return!0;var R,A=function(P){if(N.some(($=>P.tagName.toLowerCase()===$)))return{v:!0}};for(var j of T)if(R=A(j))return R.v;return!1})(x,t)||!pR(x,(p=t)==null?void 0:p.css_selector_allowlist))return!1;var b=_e.getComputedStyle(r);if(b&&b.getPropertyValue("cursor")==="pointer"&&e.type==="click")return!0;var E=r.tagName.toLowerCase();switch(E){case"html":return!1;case"form":return(s||["submit"]).indexOf(e.type)>=0;case"input":case"select":case"textarea":return(s||["change","click"]).indexOf(e.type)>=0;default:return g?(s||["click"]).indexOf(e.type)>=0:(s||["click"]).indexOf(e.type)>=0&&(sE.indexOf(E)>-1||r.getAttribute("contenteditable")==="true")}}function ob(r){for(var e=r;e.parentNode&&!Gc(e,"body");e=e.parentNode){var t=vy(e);if(ur(t,"ph-sensitive")||ur(t,"ph-no-capture"))return!1}if(ur(vy(r),"ph-include"))return!0;var n=r.type||"";if(Wn(n))switch(n.toLowerCase()){case"hidden":case"password":return!1}var s=r.name||r.id||"";return!(Wn(s)&&/^cc|cardnum|ccnum|creditcard|csc|cvc|cvv|exp|pass|pwd|routing|seccode|securitycode|securitynum|socialsec|socsec|ssn/i.test(s.replace(/[^a-zA-Z0-9]/g,"")))}function vR(r){return!!(Gc(r,"input")&&!["button","checkbox","submit","reset"].includes(r.type)||Gc(r,"select")||Gc(r,"textarea")||r.getAttribute("contenteditable")==="true")}var yR="(4[0-9]{12}(?:[0-9]{3})?)|(5[1-5][0-9]{14})|(6(?:011|5[0-9]{2})[0-9]{12})|(3[47][0-9]{13})|(3(?:0[0-5]|[68][0-9])[0-9]{11})|((?:2131|1800|35[0-9]{3})[0-9]{11})",gz=new RegExp("^(?:"+yR+")$"),vz=new RegExp(yR),xR="\\d{3}-?\\d{2}-?\\d{4}",yz=new RegExp("^("+xR+")$"),xz=new RegExp("("+xR+")");function Hm(r,e){return e===void 0&&(e=!0),!(fr(r)||Wn(r)&&(r=Ky(r),(e?gz:vz).test((r||"").replace(/[- ]/g,""))||(e?yz:xz).test(r)))}function wR(r){var e=rg(r);return Hm(e=(e+" "+bR(r)).trim())?e:""}function bR(r){var e="";return r&&r.childNodes&&r.childNodes.length&&Zr(r.childNodes,(function(t){var n;if(t&&((n=t.tagName)==null?void 0:n.toLowerCase())==="span")try{var s=rg(t);e=(e+" "+s).trim(),t.childNodes&&t.childNodes.length&&(e=(e+" "+bR(t)).trim())}catch(i){Xe.error("[AutoCapture]",i)}})),e}function wz(r){return(function(e){var t=e.map((n=>{var s,i,c="";if(n.tag_name&&(c+=n.tag_name),n.attr_class)for(var d of(n.attr_class.sort(),n.attr_class))c+="."+d.replace(/"/g,"");var p=Qe({},n.text?{text:n.text}:{},{"nth-child":(s=n.nth_child)!==null&&s!==void 0?s:0,"nth-of-type":(i=n.nth_of_type)!==null&&i!==void 0?i:0},n.href?{href:n.href}:{},n.attr_id?{attr_id:n.attr_id}:{},n.attributes),m={};return Jv(p).sort(((g,x)=>{var[b]=g,[E]=x;return b.localeCompare(E)})).forEach((g=>{var[x,b]=g;return m[KC(x.toString())]=KC(b.toString())})),c+=":",c+=Jv(m).map((g=>{var[x,b]=g;return x+'="'+b+'"'})).join("")}));return t.join(";")})((function(e){return e.map((t=>{var n,s,i={text:(n=t.$el_text)==null?void 0:n.slice(0,400),tag_name:t.tag_name,href:(s=t.attr__href)==null?void 0:s.slice(0,2048),attr_class:bz(t),attr_id:t.attr__id,nth_child:t.nth_child,nth_of_type:t.nth_of_type,attributes:{}};return Jv(t).filter((c=>{var[d]=c;return d.indexOf("attr__")===0})).forEach((c=>{var[d,p]=c;return i.attributes[d]=p})),i}))})(r))}function KC(r){return r.replace(/"|\\"/g,'\\"')}function bz(r){var e=r.attr__class;return e?Fr(e)?e:nE(e):void 0}class _R{constructor(e){this.disabled=e===!1;var t=Gn(e)?e:{};this.thresholdPx=t.threshold_px||30,this.timeoutMs=t.timeout_ms||1e3,this.clickCount=t.click_count||3,this.clicks=[]}isRageClick(e,t,n){if(this.disabled)return!1;var s=this.clicks[this.clicks.length-1];if(s&&Math.abs(e-s.x)+Math.abs(t-s.y)<this.thresholdPx&&n-s.timestamp<this.timeoutMs){if(this.clicks.push({x:e,y:t,timestamp:n}),this.clicks.length===this.clickCount)return!0}else this.clicks=[{x:e,y:t,timestamp:n}];return!1}}var yy=r=>{var e=Ve==null?void 0:Ve.createElement("a");return qe(e)?null:(e.href=r,e)},_z=function(r,e){var t,n;e===void 0&&(e="&");var s=[];return Zr(r,(function(i,c){qe(i)||qe(c)||c==="undefined"||(t=encodeURIComponent((d=>d instanceof File)(i)?i.name:i.toString()),n=encodeURIComponent(c),s[s.length]=n+"="+t)})),s.join(e)},xy=function(r,e){for(var t,n=((r.split("#")[0]||"").split(/\?(.*)/)[1]||"").replace(/^\?+/g,"").split("&"),s=0;s<n.length;s++){var i=n[s].split("=");if(i[0]===e){t=i;break}}if(!Fr(t)||t.length<2)return"";var c=t[1];try{c=decodeURIComponent(c)}catch{Xe.error("Skipping decoding for malformed query param: "+c)}return c.replace(/\+/g," ")},ng=function(r,e,t){if(!r||!e||!e.length)return r;for(var n=r.split("#"),s=n[0]||"",i=n[1],c=s.split("?"),d=c[1],p=c[0],m=(d||"").split("&"),g=[],x=0;x<m.length;x++){var b=m[x].split("=");Fr(b)&&(e.includes(b[0])?g.push(b[0]+"="+t):g.push(m[x]))}var E=p;return d!=null&&(E+="?"+g.join("&")),i!=null&&(E+="#"+i),E},wy=function(r,e){var t=r.match(new RegExp(e+"=([^&]*)"));return t?t[1]:null},Dx="$copy_autocapture",YC=xn("[AutoCapture]");function Lx(r,e){return e.length>r?e.slice(0,r)+"...":e}function Ez(r){if(r.previousElementSibling)return r.previousElementSibling;var e=r;do e=e.previousSibling;while(e&&!Jy(e));return e}function Sz(r,e,t,n){var s=r.tagName.toLowerCase(),i={tag_name:s};sE.indexOf(s)>-1&&!t&&(s.toLowerCase()==="a"||s.toLowerCase()==="button"?i.$el_text=Lx(1024,wR(r)):i.$el_text=Lx(1024,rg(r)));var c=vy(r);c.length>0&&(i.classes=c.filter((function(g){return g!==""}))),Zr(r.attributes,(function(g){var x;if((!vR(r)||["name","id","class","aria-label"].indexOf(g.name)!==-1)&&(n==null||!n.includes(g.name))&&!e&&Hm(g.value)&&(x=g.name,!Wn(x)||x.substring(0,10)!=="_ngcontent"&&x.substring(0,7)!=="_nghost")){var b=g.value;g.name==="class"&&(b=nE(b).join(" ")),i["attr__"+g.name]=Lx(1024,b)}}));for(var d=1,p=1,m=r;m=Ez(m);)d++,m.tagName===r.tagName&&p++;return i.nth_child=d,i.nth_of_type=p,i}function Cz(r,e){for(var t,n,{e:s,maskAllElementAttributes:i,maskAllText:c,elementAttributeIgnoreList:d,elementsChainAsString:p}=e,m=[r],g=r;g.parentNode&&!Gc(g,"body");)dR(g.parentNode)?(m.push(g.parentNode.host),g=g.parentNode.host):(m.push(g.parentNode),g=g.parentNode);var x,b=[],E={},T=!1,S=!1;if(Zr(m,(P=>{var $=ob(P);P.tagName.toLowerCase()==="a"&&(T=P.getAttribute("href"),T=$&&T&&Hm(T)&&T),ur(vy(P),"ph-no-capture")&&(S=!0),b.push(Sz(P,i,c,d));var W=(function(M){if(!ob(M))return{};var V={};return Zr(M.attributes,(function(X){if(X.name&&X.name.indexOf("data-ph-capture-attribute")===0){var ie=X.name.replace("data-ph-capture-attribute-",""),J=X.value;ie&&J&&Hm(J)&&(V[ie]=J)}})),V})(P);kn(E,W)})),S)return{props:{},explicitNoCapture:S};if(c||(r.tagName.toLowerCase()==="a"||r.tagName.toLowerCase()==="button"?b[0].$el_text=wR(r):b[0].$el_text=rg(r)),T){var N,R;b[0].attr__href=T;var A=(N=yy(T))==null?void 0:N.host,j=_e==null||(R=_e.location)==null?void 0:R.host;A&&j&&A!==j&&(x=T)}return{props:kn({$event_type:s.type,$ce_version:1},p?{}:{$elements:b},{$elements_chain:wz(b)},(t=b[0])!=null&&t.$el_text?{$el_text:(n=b[0])==null?void 0:n.$el_text}:{},x&&s.type==="click"?{$external_click_url:x}:{},E)}}class kz{constructor(e){this.P=!1,this.T=null,this.I=!1,this.instance=e,this.rageclicks=new _R(e.config.rageclick),this.C=null}get R(){var e,t,n=Gn(this.instance.config.autocapture)?this.instance.config.autocapture:{};return n.url_allowlist=(e=n.url_allowlist)==null?void 0:e.map((s=>new RegExp(s))),n.url_ignorelist=(t=n.url_ignorelist)==null?void 0:t.map((s=>new RegExp(s))),n}F(){if(this.isBrowserSupported()){if(_e&&Ve){var e=n=>{n=n||(_e==null?void 0:_e.event);try{this.O(n)}catch(s){YC.error("Failed to capture event",s)}};if(jn(Ve,"submit",e,{capture:!0}),jn(Ve,"change",e,{capture:!0}),jn(Ve,"click",e,{capture:!0}),this.R.capture_copied_text){var t=n=>{n=n||(_e==null?void 0:_e.event),this.O(n,Dx)};jn(Ve,"copy",t,{capture:!0}),jn(Ve,"cut",t,{capture:!0})}}}else YC.info("Disabling Automatic Event Collection because this browser is not supported")}startIfEnabled(){this.isEnabled&&!this.P&&(this.F(),this.P=!0)}onRemoteConfig(e){e.elementsChainAsString&&(this.I=e.elementsChainAsString),this.instance.persistence&&this.instance.persistence.register({[MC]:!!e.autocapture_opt_out}),this.T=!!e.autocapture_opt_out,this.startIfEnabled()}setElementSelectors(e){this.C=e}getElementSelectors(e){var t,n=[];return(t=this.C)==null||t.forEach((s=>{var i=Ve==null?void 0:Ve.querySelectorAll(s);i==null||i.forEach((c=>{e===c&&n.push(s)}))})),n}get isEnabled(){var e,t,n=(e=this.instance.persistence)==null?void 0:e.props[MC],s=this.T;if(na(s)&&!$l(n)&&!this.instance.M())return!1;var i=(t=this.T)!==null&&t!==void 0?t:!!n;return!!this.instance.config.autocapture&&!i}O(e,t){if(t===void 0&&(t="$autocapture"),this.isEnabled){var n,s=hR(e);uR(s)&&(s=s.parentNode||null),t==="$autocapture"&&e.type==="click"&&e instanceof MouseEvent&&this.instance.config.rageclick&&(n=this.rageclicks)!=null&&n.isRageClick(e.clientX,e.clientY,e.timeStamp||new Date().getTime())&&pz(s,this.instance.config.rageclick)&&this.O(e,"$rageclick");var i=t===Dx;if(s&&mz(s,e,this.R,i,i?["copy","cut"]:void 0)){var{props:c,explicitNoCapture:d}=Cz(s,{e,maskAllElementAttributes:this.instance.config.mask_all_element_attributes,maskAllText:this.instance.config.mask_all_text,elementAttributeIgnoreList:this.R.element_attribute_ignorelist,elementsChainAsString:this.I});if(d)return!1;var p=this.getElementSelectors(s);if(p&&p.length>0&&(c.$element_selectors=p),t===Dx){var m,g=fR(_e==null||(m=_e.getSelection())==null?void 0:m.toString()),x=e.type||"clipboard";if(!g)return!1;c.$selected_content=g,c.$copy_type=x}return this.instance.capture(t,c),!0}}}isBrowserSupported(){return Hc(Ve==null?void 0:Ve.querySelectorAll)}}Math.trunc||(Math.trunc=function(r){return r<0?Math.ceil(r):Math.floor(r)}),Number.isInteger||(Number.isInteger=function(r){return zl(r)&&isFinite(r)&&Math.floor(r)===r});var JC="0123456789abcdef";class by{constructor(e){if(this.bytes=e,e.length!==16)throw new TypeError("not 128-bit length")}static fromFieldsV7(e,t,n,s){if(!Number.isInteger(e)||!Number.isInteger(t)||!Number.isInteger(n)||!Number.isInteger(s)||e<0||t<0||n<0||s<0||e>0xffffffffffff||t>4095||n>1073741823||s>4294967295)throw new RangeError("invalid field value");var i=new Uint8Array(16);return i[0]=e/Math.pow(2,40),i[1]=e/Math.pow(2,32),i[2]=e/Math.pow(2,24),i[3]=e/Math.pow(2,16),i[4]=e/Math.pow(2,8),i[5]=e,i[6]=112|t>>>8,i[7]=t,i[8]=128|n>>>24,i[9]=n>>>16,i[10]=n>>>8,i[11]=n,i[12]=s>>>24,i[13]=s>>>16,i[14]=s>>>8,i[15]=s,new by(i)}toString(){for(var e="",t=0;t<this.bytes.length;t++)e=e+JC.charAt(this.bytes[t]>>>4)+JC.charAt(15&this.bytes[t]),t!==3&&t!==5&&t!==7&&t!==9||(e+="-");if(e.length!==36)throw new Error("Invalid UUIDv7 was generated");return e}clone(){return new by(this.bytes.slice(0))}equals(e){return this.compareTo(e)===0}compareTo(e){for(var t=0;t<16;t++){var n=this.bytes[t]-e.bytes[t];if(n!==0)return Math.sign(n)}return 0}}class Nz{constructor(){this.A=0,this.j=0,this.D=new Tz}generate(){var e=this.generateOrAbort();if(qe(e)){this.A=0;var t=this.generateOrAbort();if(qe(t))throw new Error("Could not generate UUID after timestamp reset");return t}return e}generateOrAbort(){var e=Date.now();if(e>this.A)this.A=e,this.L();else{if(!(e+1e4>this.A))return;this.j++,this.j>4398046511103&&(this.A++,this.L())}return by.fromFieldsV7(this.A,Math.trunc(this.j/Math.pow(2,30)),this.j&Math.pow(2,30)-1,this.D.nextUint32())}L(){this.j=1024*this.D.nextUint32()+(1023&this.D.nextUint32())}}var XC,ER=r=>{if(typeof UUIDV7_DENY_WEAK_RNG<"u"&&UUIDV7_DENY_WEAK_RNG)throw new Error("no cryptographically strong RNG available");for(var e=0;e<r.length;e++)r[e]=65536*Math.trunc(65536*Math.random())+Math.trunc(65536*Math.random());return r};_e&&!qe(_e.crypto)&&crypto.getRandomValues&&(ER=r=>crypto.getRandomValues(r));class Tz{constructor(){this.N=new Uint32Array(8),this.U=1/0}nextUint32(){return this.U>=this.N.length&&(ER(this.N),this.U=0),this.N[this.U++]}}var Uc=()=>Rz().toString(),Rz=()=>(XC||(XC=new Nz)).generate(),qp="",Az=/[a-z0-9][a-z0-9-]+\.[a-z]{2,}$/i;function Iz(r,e){if(e){var t=(function(s,i){if(i===void 0&&(i=Ve),qp)return qp;if(!i||["localhost","127.0.0.1"].includes(s))return"";for(var c=s.split("."),d=Math.min(c.length,8),p="dmn_chk_"+Uc();!qp&&d--;){var m=c.slice(d).join("."),g=p+"=1;domain=."+m+";path=/";i.cookie=g+";max-age=3",i.cookie.includes(p)&&(i.cookie=g+";max-age=0",qp=m)}return qp})(r);if(!t){var n=(s=>{var i=s.match(Az);return i?i[0]:""})(r);n!==t&&Xe.info("Warning: cookie subdomain discovery mismatch",n,t),t=n}return t?"; domain=."+t:""}return""}var Ma={H:()=>!!Ve,B:function(r){Xe.error("cookieStore error: "+r)},q:function(r){if(Ve){try{for(var e=r+"=",t=Ve.cookie.split(";").filter((i=>i.length)),n=0;n<t.length;n++){for(var s=t[n];s.charAt(0)==" ";)s=s.substring(1,s.length);if(s.indexOf(e)===0)return decodeURIComponent(s.substring(e.length,s.length))}}catch{}return null}},W:function(r){var e;try{e=JSON.parse(Ma.q(r))||{}}catch{}return e},G:function(r,e,t,n,s){if(Ve)try{var i="",c="",d=Iz(Ve.location.hostname,n);if(t){var p=new Date;p.setTime(p.getTime()+24*t*60*60*1e3),i="; expires="+p.toUTCString()}s&&(c="; secure");var m=r+"="+encodeURIComponent(JSON.stringify(e))+i+"; SameSite=Lax; path=/"+d+c;return m.length>3686.4&&Xe.warn("cookieStore warning: large cookie, len="+m.length),Ve.cookie=m,m}catch{return}},V:function(r,e){if(Ve!=null&&Ve.cookie)try{Ma.G(r,"",-1,e)}catch{return}}},Mx=null,pn={H:function(){if(!na(Mx))return Mx;var r=!0;if(qe(_e))r=!1;else try{var e="__mplssupport__";pn.G(e,"xyz"),pn.q(e)!=='"xyz"'&&(r=!1),pn.V(e)}catch{r=!1}return r||Xe.error("localStorage unsupported; falling back to cookie store"),Mx=r,r},B:function(r){Xe.error("localStorage error: "+r)},q:function(r){try{return _e==null?void 0:_e.localStorage.getItem(r)}catch(e){pn.B(e)}return null},W:function(r){try{return JSON.parse(pn.q(r))||{}}catch{}return null},G:function(r,e){try{_e==null||_e.localStorage.setItem(r,JSON.stringify(e))}catch(t){pn.B(t)}},V:function(r){try{_e==null||_e.localStorage.removeItem(r)}catch(e){pn.B(e)}}},Pz=["$device_id","distinct_id",hy,lR,gy,my],Nv={},Fz={H:function(){return!0},B:function(r){Xe.error("memoryStorage error: "+r)},q:function(r){return Nv[r]||null},W:function(r){return Nv[r]||null},G:function(r,e){Nv[r]=e},V:function(r){delete Nv[r]}},Yu=null,ps={H:function(){if(!na(Yu))return Yu;if(Yu=!0,qe(_e))Yu=!1;else try{var r="__support__";ps.G(r,"xyz"),ps.q(r)!=='"xyz"'&&(Yu=!1),ps.V(r)}catch{Yu=!1}return Yu},B:function(r){Xe.error("sessionStorage error: ",r)},q:function(r){try{return _e==null?void 0:_e.sessionStorage.getItem(r)}catch(e){ps.B(e)}return null},W:function(r){try{return JSON.parse(ps.q(r))||null}catch{}return null},G:function(r,e){try{_e==null||_e.sessionStorage.setItem(r,JSON.stringify(e))}catch(t){ps.B(t)}},V:function(r){try{_e==null||_e.sessionStorage.removeItem(r)}catch(e){ps.B(e)}}},Ol=(function(r){return r[r.PENDING=-1]="PENDING",r[r.DENIED=0]="DENIED",r[r.GRANTED=1]="GRANTED",r})({});class jz{constructor(e){this._instance=e}get R(){return this._instance.config}get consent(){return this.J()?Ol.DENIED:this.K}isOptedOut(){return this.R.cookieless_mode==="always"||this.consent===Ol.DENIED||this.consent===Ol.PENDING&&(this.R.opt_out_capturing_by_default||this.R.cookieless_mode==="on_reject")}isOptedIn(){return!this.isOptedOut()}isExplicitlyOptedOut(){return this.consent===Ol.DENIED}optInOut(e){this.Y.G(this.X,e?1:0,this.R.cookie_expiration,this.R.cross_subdomain_cookie,this.R.secure_cookie)}reset(){this.Y.V(this.X,this.R.cross_subdomain_cookie)}get X(){var{token:e,opt_out_capturing_cookie_prefix:t,consent_persistence_name:n}=this._instance.config;return n||(t?t+e:"__ph_opt_in_out_"+e)}get K(){var e=this.Y.q(this.X);return Px(e)?Ol.GRANTED:ur(T8,e)?Ol.DENIED:Ol.PENDING}get Y(){if(!this.Z){var e=this.R.opt_out_capturing_persistence_type;this.Z=e==="localStorage"?pn:Ma;var t=e==="localStorage"?Ma:pn;t.q(this.X)&&(this.Z.q(this.X)||this.optInOut(Px(t.q(this.X))),t.V(this.X,this.R.cross_subdomain_cookie))}return this.Z}J(){return!!this.R.respect_dnt&&!!oR([Xo==null?void 0:Xo.doNotTrack,Xo==null?void 0:Xo.msDoNotTrack,xt.doNotTrack],(e=>Px(e)))}}var Tv=xn("[Dead Clicks]"),Oz=()=>!0,Dz=r=>{var e,t=!((e=r.instance.persistence)==null||!e.get_property(aR)),n=r.instance.config.capture_dead_clicks;return $l(n)?n:!!Gn(n)||t};class SR{get lazyLoadedDeadClicksAutocapture(){return this.tt}constructor(e,t,n){this.instance=e,this.isEnabled=t,this.onCapture=n,this.startIfEnabled()}onRemoteConfig(e){this.instance.persistence&&this.instance.persistence.register({[aR]:e==null?void 0:e.captureDeadClicks}),this.startIfEnabled()}startIfEnabled(){this.isEnabled(this)&&this.it((()=>{this.et()}))}it(e){var t,n;(t=xt.__PosthogExtensions__)!=null&&t.initDeadClicksAutocapture&&e(),(n=xt.__PosthogExtensions__)==null||n.loadExternalDependency==null||n.loadExternalDependency(this.instance,"dead-clicks-autocapture",(s=>{s?Tv.error("failed to load script",s):e()}))}et(){var e;if(Ve){if(!this.tt&&(e=xt.__PosthogExtensions__)!=null&&e.initDeadClicksAutocapture){var t=Gn(this.instance.config.capture_dead_clicks)?this.instance.config.capture_dead_clicks:{};t.__onCapture=this.onCapture,this.tt=xt.__PosthogExtensions__.initDeadClicksAutocapture(this.instance,t),this.tt.start(Ve),Tv.info("starting...")}}else Tv.error("`document` not found. Cannot start.")}stop(){this.tt&&(this.tt.stop(),this.tt=void 0,Tv.info("stopping..."))}}var Kp=xn("[ExceptionAutocapture]");class Lz{constructor(e){var t,n,s;this.rt=()=>{var i;if(_e&&this.isEnabled&&(i=xt.__PosthogExtensions__)!=null&&i.errorWrappingFunctions){var c=xt.__PosthogExtensions__.errorWrappingFunctions.wrapOnError,d=xt.__PosthogExtensions__.errorWrappingFunctions.wrapUnhandledRejection,p=xt.__PosthogExtensions__.errorWrappingFunctions.wrapConsoleError;try{!this.st&&this.R.capture_unhandled_errors&&(this.st=c(this.captureException.bind(this))),!this.nt&&this.R.capture_unhandled_rejections&&(this.nt=d(this.captureException.bind(this))),!this.ot&&this.R.capture_console_errors&&(this.ot=p(this.captureException.bind(this)))}catch(m){Kp.error("failed to start",m),this.ut()}}},this._instance=e,this.ht=!((t=this._instance.persistence)==null||!t.props[$C]),this.dt=new R8({refillRate:(n=this._instance.config.error_tracking.__exceptionRateLimiterRefillRate)!==null&&n!==void 0?n:1,bucketSize:(s=this._instance.config.error_tracking.__exceptionRateLimiterBucketSize)!==null&&s!==void 0?s:10,refillInterval:1e4,h:Kp}),this.R=this.vt(),this.startIfEnabledOrStop()}vt(){var e=this._instance.config.capture_exceptions,t={capture_unhandled_errors:!1,capture_unhandled_rejections:!1,capture_console_errors:!1};return Gn(e)?t=Qe({},t,e):(qe(e)?this.ht:e)&&(t=Qe({},t,{capture_unhandled_errors:!0,capture_unhandled_rejections:!0})),t}get isEnabled(){return this.R.capture_console_errors||this.R.capture_unhandled_errors||this.R.capture_unhandled_rejections}startIfEnabledOrStop(){this.isEnabled?(Kp.info("enabled"),this.ut(),this.it(this.rt)):this.ut()}it(e){var t,n;(t=xt.__PosthogExtensions__)!=null&&t.errorWrappingFunctions&&e(),(n=xt.__PosthogExtensions__)==null||n.loadExternalDependency==null||n.loadExternalDependency(this._instance,"exception-autocapture",(s=>{if(s)return Kp.error("failed to load script",s);e()}))}ut(){var e,t,n;(e=this.st)==null||e.call(this),this.st=void 0,(t=this.nt)==null||t.call(this),this.nt=void 0,(n=this.ot)==null||n.call(this),this.ot=void 0}onRemoteConfig(e){var t=e.autocaptureExceptions;this.ht=!!t||!1,this._instance.persistence&&this._instance.persistence.register({[$C]:this.ht}),this.R=this.vt(),this.startIfEnabledOrStop()}onConfigChange(){this.R=this.vt()}captureException(e){var t,n,s=(t=e==null||(n=e.$exception_list)==null||(n=n[0])==null?void 0:n.type)!==null&&t!==void 0?t:"Exception";this.dt.consumeRateLimit(s)?Kp.info("Skipping exception capture because of client rate limiting.",{exception:s}):this._instance.exceptions.sendExceptionEvent(e)}}function QC(r,e,t){try{if(!(e in r))return()=>{};var n=r[e],s=t(n);return Hc(s)&&(s.prototype=s.prototype||{},Object.defineProperties(s,{__posthog_wrapped__:{enumerable:!1,value:!0}})),r[e]=s,()=>{r[e]=n}}catch{return()=>{}}}class Mz{constructor(e){var t;this._instance=e,this.ct=(_e==null||(t=_e.location)==null?void 0:t.pathname)||""}get isEnabled(){return this._instance.config.capture_pageview==="history_change"}startIfEnabled(){this.isEnabled&&(Xe.info("History API monitoring enabled, starting..."),this.monitorHistoryChanges())}stop(){this.ft&&this.ft(),this.ft=void 0,Xe.info("History API monitoring stopped")}monitorHistoryChanges(){var e,t;if(_e&&_e.history){var n=this;(e=_e.history.pushState)!=null&&e.__posthog_wrapped__||QC(_e.history,"pushState",(s=>function(i,c,d){s.call(this,i,c,d),n._t("pushState")})),(t=_e.history.replaceState)!=null&&t.__posthog_wrapped__||QC(_e.history,"replaceState",(s=>function(i,c,d){s.call(this,i,c,d),n._t("replaceState")})),this.bt()}}_t(e){try{var t,n=_e==null||(t=_e.location)==null?void 0:t.pathname;if(!n)return;n!==this.ct&&this.isEnabled&&this._instance.capture("$pageview",{navigation_type:e}),this.ct=n}catch(s){Xe.error("Error capturing "+e+" pageview",s)}}bt(){if(!this.ft){var e=()=>{this._t("popstate")};jn(_e,"popstate",e),this.ft=()=>{_e&&_e.removeEventListener("popstate",e)}}}}var $x=xn("[SegmentIntegration]");function $z(r,e){var t=r.config.segment;if(!t)return e();(function(n,s){var i=n.config.segment;if(!i)return s();var c=p=>{var m=()=>p.anonymousId()||Uc();n.config.get_device_id=m,p.id()&&(n.register({distinct_id:p.id(),$device_id:m()}),n.persistence.set_property(jl,"identified")),s()},d=i.user();"then"in d&&Hc(d.then)?d.then(c):c(d)})(r,(()=>{t.register((n=>{Promise&&Promise.resolve||$x.warn("This browser does not have Promise support, and can not use the segment integration");var s=(i,c)=>{if(!c)return i;i.event.userId||i.event.anonymousId===n.get_distinct_id()||($x.info("No userId set, resetting PostHog"),n.reset()),i.event.userId&&i.event.userId!==n.get_distinct_id()&&($x.info("UserId set, identifying with PostHog"),n.identify(i.event.userId));var d=n.calculateEventProperties(c,i.event.properties);return i.event.properties=Object.assign({},d,i.event.properties),i};return{name:"PostHog JS",type:"enrichment",version:"1.0.0",isLoaded:()=>!0,load:()=>Promise.resolve(),track:i=>s(i,i.event.event),page:i=>s(i,"$pageview"),identify:i=>s(i,"$identify"),screen:i=>s(i,"$screen")}})(r)).then((()=>{e()}))}))}var CR="posthog-js";function kR(r,e){var{organization:t,projectId:n,prefix:s,severityAllowList:i=["error"],sendExceptionsToPostHog:c=!0}=e===void 0?{}:e;return d=>{var p,m,g,x,b;if(!(i==="*"||i.includes(d.level))||!r.__loaded)return d;d.tags||(d.tags={});var E=r.requestRouter.endpointFor("ui","/project/"+r.config.token+"/person/"+r.get_distinct_id());d.tags["PostHog Person URL"]=E,r.sessionRecordingStarted()&&(d.tags["PostHog Recording URL"]=r.get_session_replay_url({withTimestamp:!0}));var T=((p=d.exception)==null?void 0:p.values)||[],S=T.map((R=>Qe({},R,{stacktrace:R.stacktrace?Qe({},R.stacktrace,{type:"raw",frames:(R.stacktrace.frames||[]).map((A=>Qe({},A,{platform:"web:javascript"})))}):void 0}))),N={$exception_message:((m=T[0])==null?void 0:m.value)||d.message,$exception_type:(g=T[0])==null?void 0:g.type,$exception_level:d.level,$exception_list:S,$sentry_event_id:d.event_id,$sentry_exception:d.exception,$sentry_exception_message:((x=T[0])==null?void 0:x.value)||d.message,$sentry_exception_type:(b=T[0])==null?void 0:b.type,$sentry_tags:d.tags};return t&&n&&(N.$sentry_url=(s||"https://sentry.io/organizations/")+t+"/issues/?project="+n+"&query="+d.event_id),c&&r.exceptions.sendExceptionEvent(N),d}}class Uz{constructor(e,t,n,s,i,c){this.name=CR,this.setupOnce=function(d){d(kR(e,{organization:t,projectId:n,prefix:s,severityAllowList:i,sendExceptionsToPostHog:c==null||c}))}}}var zz=_e!=null&&_e.location?wy(_e.location.hash,"__posthog")||wy(location.hash,"state"):null,ZC="_postHogToolbarParams",ek=xn("[Toolbar]"),Oc=(function(r){return r[r.UNINITIALIZED=0]="UNINITIALIZED",r[r.LOADING=1]="LOADING",r[r.LOADED=2]="LOADED",r})(Oc||{});class Hz{constructor(e){this.instance=e}yt(e){xt.ph_toolbar_state=e}wt(){var e;return(e=xt.ph_toolbar_state)!==null&&e!==void 0?e:Oc.UNINITIALIZED}maybeLoadToolbar(e,t,n){if(e===void 0&&(e=void 0),t===void 0&&(t=void 0),n===void 0&&(n=void 0),!_e||!Ve)return!1;e=e??_e.location,n=n??_e.history;try{if(!t){try{_e.localStorage.setItem("test","test"),_e.localStorage.removeItem("test")}catch{return!1}t=_e==null?void 0:_e.localStorage}var s,i=zz||wy(e.hash,"__posthog")||wy(e.hash,"state"),c=i?LC((()=>JSON.parse(atob(decodeURIComponent(i)))))||LC((()=>JSON.parse(decodeURIComponent(i)))):null;return c&&c.action==="ph_authorize"?((s=c).source="url",s&&Object.keys(s).length>0&&(c.desiredHash?e.hash=c.desiredHash:n?n.replaceState(n.state,"",e.pathname+e.search):e.hash="")):((s=JSON.parse(t.getItem(ZC)||"{}")).source="localstorage",delete s.userIntent),!(!s.token||this.instance.config.token!==s.token)&&(this.loadToolbar(s),!0)}catch{return!1}}xt(e){var t=xt.ph_load_toolbar||xt.ph_load_editor;!fr(t)&&Hc(t)?t(e,this.instance):ek.warn("No toolbar load function found")}loadToolbar(e){var t=!(Ve==null||!Ve.getElementById(cR));if(!_e||t)return!1;var n=this.instance.requestRouter.region==="custom"&&this.instance.config.advanced_disable_toolbar_metrics,s=Qe({token:this.instance.config.token},e,{apiURL:this.instance.requestRouter.endpointFor("ui")},n?{instrument:!1}:{});if(_e.localStorage.setItem(ZC,JSON.stringify(Qe({},s,{source:void 0}))),this.wt()===Oc.LOADED)this.xt(s);else if(this.wt()===Oc.UNINITIALIZED){var i;this.yt(Oc.LOADING),(i=xt.__PosthogExtensions__)==null||i.loadExternalDependency==null||i.loadExternalDependency(this.instance,"toolbar",(c=>{if(c)return ek.error("[Toolbar] Failed to load",c),void this.yt(Oc.UNINITIALIZED);this.yt(Oc.LOADED),this.xt(s)})),jn(_e,"turbolinks:load",(()=>{this.yt(Oc.UNINITIALIZED),this.loadToolbar(s)}))}return!0}Et(e){return this.loadToolbar(e)}maybeLoadEditor(e,t,n){return e===void 0&&(e=void 0),t===void 0&&(t=void 0),n===void 0&&(n=void 0),this.maybeLoadToolbar(e,t,n)}}var Bz=xn("[TracingHeaders]");class Gz{constructor(e){this.$t=void 0,this.St=void 0,this.rt=()=>{var t,n;qe(this.$t)&&((t=xt.__PosthogExtensions__)==null||(t=t.tracingHeadersPatchFns)==null||t._patchXHR(this._instance.config.__add_tracing_headers||[],this._instance.get_distinct_id(),this._instance.sessionManager)),qe(this.St)&&((n=xt.__PosthogExtensions__)==null||(n=n.tracingHeadersPatchFns)==null||n._patchFetch(this._instance.config.__add_tracing_headers||[],this._instance.get_distinct_id(),this._instance.sessionManager))},this._instance=e}it(e){var t,n;(t=xt.__PosthogExtensions__)!=null&&t.tracingHeadersPatchFns&&e(),(n=xt.__PosthogExtensions__)==null||n.loadExternalDependency==null||n.loadExternalDependency(this._instance,"tracing-headers",(s=>{if(s)return Bz.error("failed to load script",s);e()}))}startIfEnabledOrStop(){var e,t;this._instance.config.__add_tracing_headers?this.it(this.rt):((e=this.$t)==null||e.call(this),(t=this.St)==null||t.call(this),this.$t=void 0,this.St=void 0)}}var Rv="https?://(.*)",wh=["gclid","gclsrc","dclid","gbraid","wbraid","fbclid","msclkid","twclid","li_fat_id","igshid","ttclid","rdt_cid","epik","qclid","sccid","irclid","_kx"],Wz=xh(["utm_source","utm_medium","utm_campaign","utm_content","utm_term","gad_source","mc_cid"],wh),sg="<masked>",Vz=["li_fat_id"];function NR(r,e,t){if(!Ve)return{};var n,s=e?xh([],wh,t||[]):[],i=TR(ng(Ve.URL,s,sg),r),c=(n={},Zr(Vz,(function(d){var p=Ma.q(d);n[d]=p||null})),n);return kn(c,i)}function TR(r,e){var t=Wz.concat(e||[]),n={};return Zr(t,(function(s){var i=xy(r,s);n[s]=i||null})),n}function RR(r){var e=(function(i){return i?i.search(Rv+"google.([^/?]*)")===0?"google":i.search(Rv+"bing.com")===0?"bing":i.search(Rv+"yahoo.com")===0?"yahoo":i.search(Rv+"duckduckgo.com")===0?"duckduckgo":null:null})(r),t=e!="yahoo"?"q":"p",n={};if(!na(e)){n.$search_engine=e;var s=Ve?xy(Ve.referrer,t):"";s.length&&(n.ph_keyword=s)}return n}function tk(){return navigator.language||navigator.userLanguage}function AR(){return(Ve==null?void 0:Ve.referrer)||"$direct"}function IR(r,e){var t=r?xh([],wh,e||[]):[],n=gs==null?void 0:gs.href.substring(0,1e3);return{r:AR().substring(0,1e3),u:n?ng(n,t,sg):void 0}}function PR(r){var e,{r:t,u:n}=r,s={$referrer:t,$referring_domain:t==null?void 0:t=="$direct"?"$direct":(e=yy(t))==null?void 0:e.host};if(n){s.$current_url=n;var i=yy(n);s.$host=i==null?void 0:i.host,s.$pathname=i==null?void 0:i.pathname;var c=TR(n);kn(s,c)}if(t){var d=RR(t);kn(s,d)}return s}function FR(){try{return Intl.DateTimeFormat().resolvedOptions().timeZone}catch{return}}function qz(){try{return new Date().getTimezoneOffset()}catch{return}}function Kz(r,e){if(!So)return{};var t,n,s,i=r?xh([],wh,e||[]):[],[c,d]=(function(p){for(var m=0;m<PC.length;m++){var[g,x]=PC[m],b=g.exec(p),E=b&&(Hc(x)?x(b,p):x);if(E)return E}return["",""]})(So);return kn(rE({$os:c,$os_version:d,$browser:tR(So,navigator.vendor),$device:FC(So),$device_type:(n=So,s=FC(n),s===zT||s===UT||s==="Kobo"||s==="Kindle Fire"||s===eR?Mm:s===Um||s===nh||s===zm||s===Kw?"Console":s===BT?"Wearable":s?Si:"Desktop"),$timezone:FR(),$timezone_offset:qz()}),{$current_url:ng(gs==null?void 0:gs.href,i,sg),$host:gs==null?void 0:gs.host,$pathname:gs==null?void 0:gs.pathname,$raw_user_agent:So.length>1e3?So.substring(0,997)+"...":So,$browser_version:$8(So,navigator.vendor),$browser_language:tk(),$browser_language_prefix:(t=tk(),typeof t=="string"?t.split("-")[0]:void 0),$screen_height:_e==null?void 0:_e.screen.height,$screen_width:_e==null?void 0:_e.screen.width,$viewport_height:_e==null?void 0:_e.innerHeight,$viewport_width:_e==null?void 0:_e.innerWidth,$lib:"web",$lib_version:Fl.LIB_VERSION,$insert_id:Math.random().toString(36).substring(2,10)+Math.random().toString(36).substring(2,10),$time:Date.now()/1e3})}var Pc=xn("[Web Vitals]"),rk=9e5;class Yz{constructor(e){var t;this.kt=!1,this.P=!1,this.N={url:void 0,metrics:[],firstMetricTimestamp:void 0},this.Pt=()=>{clearTimeout(this.Tt),this.N.metrics.length!==0&&(this._instance.capture("$web_vitals",this.N.metrics.reduce(((n,s)=>Qe({},n,{["$web_vitals_"+s.name+"_event"]:Qe({},s),["$web_vitals_"+s.name+"_value"]:s.value})),{})),this.N={url:void 0,metrics:[],firstMetricTimestamp:void 0})},this.It=n=>{var s,i=(s=this._instance.sessionManager)==null?void 0:s.checkAndGetSessionAndWindowId(!0);if(qe(i))Pc.error("Could not read session ID. Dropping metrics!");else{this.N=this.N||{url:void 0,metrics:[],firstMetricTimestamp:void 0};var c=this.Ct();qe(c)||(fr(n==null?void 0:n.name)||fr(n==null?void 0:n.value)?Pc.error("Invalid metric received",n):this.Rt&&n.value>=this.Rt?Pc.error("Ignoring metric with value >= "+this.Rt,n):(this.N.url!==c&&(this.Pt(),this.Tt=setTimeout(this.Pt,this.flushToCaptureTimeoutMs)),qe(this.N.url)&&(this.N.url=c),this.N.firstMetricTimestamp=qe(this.N.firstMetricTimestamp)?Date.now():this.N.firstMetricTimestamp,n.attribution&&n.attribution.interactionTargetElement&&(n.attribution.interactionTargetElement=void 0),this.N.metrics.push(Qe({},n,{$current_url:c,$session_id:i.sessionId,$window_id:i.windowId,timestamp:Date.now()})),this.N.metrics.length===this.allowedMetrics.length&&this.Pt()))}},this.rt=()=>{if(!this.P){var n,s,i,c,d=xt.__PosthogExtensions__;qe(d)||qe(d.postHogWebVitalsCallbacks)||({onLCP:n,onCLS:s,onFCP:i,onINP:c}=d.postHogWebVitalsCallbacks),n&&s&&i&&c?(this.allowedMetrics.indexOf("LCP")>-1&&n(this.It.bind(this)),this.allowedMetrics.indexOf("CLS")>-1&&s(this.It.bind(this)),this.allowedMetrics.indexOf("FCP")>-1&&i(this.It.bind(this)),this.allowedMetrics.indexOf("INP")>-1&&c(this.It.bind(this)),this.P=!0):Pc.error("web vitals callbacks not loaded - not starting")}},this._instance=e,this.kt=!((t=this._instance.persistence)==null||!t.props[zC]),this.startIfEnabled()}get allowedMetrics(){var e,t,n=Gn(this._instance.config.capture_performance)?(e=this._instance.config.capture_performance)==null?void 0:e.web_vitals_allowed_metrics:void 0;return fr(n)?((t=this._instance.persistence)==null?void 0:t.props[BC])||["CLS","FCP","INP","LCP"]:n}get flushToCaptureTimeoutMs(){return(Gn(this._instance.config.capture_performance)?this._instance.config.capture_performance.web_vitals_delayed_flush_ms:void 0)||5e3}get useAttribution(){var e=Gn(this._instance.config.capture_performance)?this._instance.config.capture_performance.web_vitals_attribution:void 0;return e!=null&&e}get Rt(){var e=Gn(this._instance.config.capture_performance)&&zl(this._instance.config.capture_performance.__web_vitals_max_value)?this._instance.config.capture_performance.__web_vitals_max_value:rk;return 0<e&&e<=6e4?rk:e}get isEnabled(){var e=gs==null?void 0:gs.protocol;if(e!=="http:"&&e!=="https:")return Pc.info("Web Vitals are disabled on non-http/https protocols"),!1;var t=Gn(this._instance.config.capture_performance)?this._instance.config.capture_performance.web_vitals:$l(this._instance.config.capture_performance)?this._instance.config.capture_performance:void 0;return $l(t)?t:this.kt}startIfEnabled(){this.isEnabled&&!this.P&&(Pc.info("enabled, starting..."),this.it(this.rt))}onRemoteConfig(e){var t=Gn(e.capturePerformance)&&!!e.capturePerformance.web_vitals,n=Gn(e.capturePerformance)?e.capturePerformance.web_vitals_allowed_metrics:void 0;this._instance.persistence&&(this._instance.persistence.register({[zC]:t}),this._instance.persistence.register({[BC]:n})),this.kt=t,this.startIfEnabled()}it(e){var t,n;if((t=xt.__PosthogExtensions__)!=null&&t.postHogWebVitalsCallbacks)e();else{var s=this.useAttribution?"web-vitals-with-attribution":"web-vitals";(n=xt.__PosthogExtensions__)==null||n.loadExternalDependency==null||n.loadExternalDependency(this._instance,s,(i=>{i?Pc.error("failed to load script",i):e()}))}}Ct(){var e=_e?_e.location.href:void 0;if(e){var t=this._instance.config.mask_personal_data_properties,n=this._instance.config.custom_personal_data_properties,s=t?xh([],wh,n||[]):[];return ng(e,s,sg)}Pc.error("Could not determine current URL")}}var Jz=xn("[Heatmaps]");function nk(r){return Gn(r)&&"clientX"in r&&"clientY"in r&&zl(r.clientX)&&zl(r.clientY)}class Xz{constructor(e){var t;this.kt=!1,this.P=!1,this.Ft=null,this.instance=e,this.kt=!((t=this.instance.persistence)==null||!t.props[Xw]),this.rageclicks=new _R(e.config.rageclick)}get flushIntervalMilliseconds(){var e=5e3;return Gn(this.instance.config.capture_heatmaps)&&this.instance.config.capture_heatmaps.flush_interval_milliseconds&&(e=this.instance.config.capture_heatmaps.flush_interval_milliseconds),e}get isEnabled(){return fr(this.instance.config.capture_heatmaps)?fr(this.instance.config.enable_heatmaps)?this.kt:this.instance.config.enable_heatmaps:this.instance.config.capture_heatmaps!==!1}startIfEnabled(){if(this.isEnabled){if(this.P)return;Jz.info("starting..."),this.Ot(),this.Mt()}else{var e;clearInterval((e=this.Ft)!==null&&e!==void 0?e:void 0),this.At(),this.getAndClearBuffer()}}onRemoteConfig(e){var t=!!e.heatmaps;this.instance.persistence&&this.instance.persistence.register({[Xw]:t}),this.kt=t,this.startIfEnabled()}getAndClearBuffer(){var e=this.N;return this.N=void 0,e}jt(e){this.Dt(e.originalEvent,"deadclick")}Mt(){this.Ft&&clearInterval(this.Ft),this.Ft=(function(e){return(e==null?void 0:e.visibilityState)==="visible"})(Ve)?setInterval(this.Lt.bind(this),this.flushIntervalMilliseconds):null}Ot(){_e&&Ve&&(this.Nt=this.Lt.bind(this),jn(_e,"beforeunload",this.Nt),this.Ut=e=>this.Dt(e||(_e==null?void 0:_e.event)),jn(Ve,"click",this.Ut,{capture:!0}),this.zt=e=>this.Ht(e||(_e==null?void 0:_e.event)),jn(Ve,"mousemove",this.zt,{capture:!0}),this.Bt=new SR(this.instance,Oz,this.jt.bind(this)),this.Bt.startIfEnabled(),this.qt=this.Mt.bind(this),jn(Ve,"visibilitychange",this.qt),this.P=!0)}At(){var e;_e&&Ve&&(this.Nt&&_e.removeEventListener("beforeunload",this.Nt),this.Ut&&Ve.removeEventListener("click",this.Ut,{capture:!0}),this.zt&&Ve.removeEventListener("mousemove",this.zt,{capture:!0}),this.qt&&Ve.removeEventListener("visibilitychange",this.qt),clearTimeout(this.Wt),(e=this.Bt)==null||e.stop(),this.P=!1)}Gt(e,t){var n=this.instance.scrollManager.scrollY(),s=this.instance.scrollManager.scrollX(),i=this.instance.scrollManager.scrollElement(),c=(function(d,p,m){for(var g=d;g&&Jy(g)&&!Gc(g,"body");){if(g===m)return!1;if(ur(p,_e==null?void 0:_e.getComputedStyle(g).position))return!0;g=mR(g)}return!1})(hR(e),["fixed","sticky"],i);return{x:e.clientX+(c?0:s),y:e.clientY+(c?0:n),target_fixed:c,type:t}}Dt(e,t){var n;if(t===void 0&&(t="click"),!GC(e.target)&&nk(e)){var s=this.Gt(e,t);(n=this.rageclicks)!=null&&n.isRageClick(e.clientX,e.clientY,new Date().getTime())&&this.Vt(Qe({},s,{type:"rageclick"})),this.Vt(s)}}Ht(e){!GC(e.target)&&nk(e)&&(clearTimeout(this.Wt),this.Wt=setTimeout((()=>{this.Vt(this.Gt(e,"mousemove"))}),500))}Vt(e){if(_e){var t=_e.location.href,n=this.instance.config.mask_personal_data_properties,s=this.instance.config.custom_personal_data_properties,i=n?xh([],wh,s||[]):[],c=ng(t,i,sg);this.N=this.N||{},this.N[c]||(this.N[c]=[]),this.N[c].push(e)}}Lt(){this.N&&!Xf(this.N)&&this.instance.capture("$$heatmap",{$heatmap_data:this.getAndClearBuffer()})}}class sk{constructor(e){this.Jt=(t,n,s)=>{s&&(s.noSessionId||s.activityTimeout||s.sessionPastMaximumLength)&&(Xe.info("[PageViewManager] Session rotated, clearing pageview state",{sessionId:t,changeReason:s}),this.Kt=void 0,this._instance.scrollManager.resetContext())},this._instance=e,this.Yt()}Yt(){var e;this.Xt=(e=this._instance.sessionManager)==null?void 0:e.onSessionId(this.Jt)}destroy(){var e;(e=this.Xt)==null||e.call(this),this.Xt=void 0}doPageView(e,t){var n,s=this.Qt(e,t);return this.Kt={pathname:(n=_e==null?void 0:_e.location.pathname)!==null&&n!==void 0?n:"",pageViewId:t,timestamp:e},this._instance.scrollManager.resetContext(),s}doPageLeave(e){var t;return this.Qt(e,(t=this.Kt)==null?void 0:t.pageViewId)}doEvent(){var e;return{$pageview_id:(e=this.Kt)==null?void 0:e.pageViewId}}Qt(e,t){var n=this.Kt;if(!n)return{$pageview_id:t};var s={$pageview_id:t,$prev_pageview_id:n.pageViewId},i=this._instance.scrollManager.getContext();if(i&&!this._instance.config.disable_scroll_properties){var{maxScrollHeight:c,lastScrollY:d,maxScrollY:p,maxContentHeight:m,lastContentY:g,maxContentY:x}=i;if(!(qe(c)||qe(d)||qe(p)||qe(m)||qe(g)||qe(x))){c=Math.ceil(c),d=Math.ceil(d),p=Math.ceil(p),m=Math.ceil(m),g=Math.ceil(g),x=Math.ceil(x);var b=c<=1?1:za(d/c,0,1,Xe),E=c<=1?1:za(p/c,0,1,Xe),T=m<=1?1:za(g/m,0,1,Xe),S=m<=1?1:za(x/m,0,1,Xe);s=kn(s,{$prev_pageview_last_scroll:d,$prev_pageview_last_scroll_percentage:b,$prev_pageview_max_scroll:p,$prev_pageview_max_scroll_percentage:E,$prev_pageview_last_content:g,$prev_pageview_last_content_percentage:T,$prev_pageview_max_content:x,$prev_pageview_max_content_percentage:S})}}return n.pathname&&(s.$prev_pageview_pathname=n.pathname),n.timestamp&&(s.$prev_pageview_duration=(e.getTime()-n.timestamp.getTime())/1e3),s}}var Dl=(function(r){return r.GZipJS="gzip-js",r.Base64="base64",r})({}),Ci=Uint8Array,Co=Uint16Array,hh=Uint32Array,iE=new Ci([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),aE=new Ci([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),ok=new Ci([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),jR=function(r,e){for(var t=new Co(31),n=0;n<31;++n)t[n]=e+=1<<r[n-1];var s=new hh(t[30]);for(n=1;n<30;++n)for(var i=t[n];i<t[n+1];++i)s[i]=i-t[n]<<5|n;return[t,s]},OR=jR(iE,2),Qz=OR[0],ib=OR[1];Qz[28]=258,ib[258]=28;for(var ik=jR(aE,0)[1],DR=new Co(32768),an=0;an<32768;++an){var Ju=(43690&an)>>>1|(21845&an)<<1;Ju=(61680&(Ju=(52428&Ju)>>>2|(13107&Ju)<<2))>>>4|(3855&Ju)<<4,DR[an]=((65280&Ju)>>>8|(255&Ju)<<8)>>>1}var Em=function(r,e,t){for(var n=r.length,s=0,i=new Co(e);s<n;++s)++i[r[s]-1];var c,d=new Co(e);for(s=0;s<e;++s)d[s]=d[s-1]+i[s-1]<<1;for(c=new Co(n),s=0;s<n;++s)c[s]=DR[d[r[s]-1]++]>>>15-r[s];return c},ld=new Ci(288);for(an=0;an<144;++an)ld[an]=8;for(an=144;an<256;++an)ld[an]=9;for(an=256;an<280;++an)ld[an]=7;for(an=280;an<288;++an)ld[an]=8;var _y=new Ci(32);for(an=0;an<32;++an)_y[an]=5;var Zz=Em(ld,9),eH=Em(_y,5),LR=function(r){return(r/8>>0)+(7&r&&1)},MR=function(r,e,t){(t==null||t>r.length)&&(t=r.length);var n=new(r instanceof Co?Co:r instanceof hh?hh:Ci)(t-e);return n.set(r.subarray(e,t)),n},Tl=function(r,e,t){t<<=7&e;var n=e/8>>0;r[n]|=t,r[n+1]|=t>>>8},Yp=function(r,e,t){t<<=7&e;var n=e/8>>0;r[n]|=t,r[n+1]|=t>>>8,r[n+2]|=t>>>16},Ux=function(r,e){for(var t=[],n=0;n<r.length;++n)r[n]&&t.push({s:n,f:r[n]});var s=t.length,i=t.slice();if(!s)return[new Ci(0),0];if(s==1){var c=new Ci(t[0].s+1);return c[t[0].s]=1,[c,1]}t.sort((function($,W){return $.f-W.f})),t.push({s:-1,f:25001});var d=t[0],p=t[1],m=0,g=1,x=2;for(t[0]={s:-1,f:d.f+p.f,l:d,r:p};g!=s-1;)d=t[t[m].f<t[x].f?m++:x++],p=t[m!=g&&t[m].f<t[x].f?m++:x++],t[g++]={s:-1,f:d.f+p.f,l:d,r:p};var b=i[0].s;for(n=1;n<s;++n)i[n].s>b&&(b=i[n].s);var E=new Co(b+1),T=ab(t[g-1],E,0);if(T>e){n=0;var S=0,N=T-e,R=1<<N;for(i.sort((function($,W){return E[W.s]-E[$.s]||$.f-W.f}));n<s;++n){var A=i[n].s;if(!(E[A]>e))break;S+=R-(1<<T-E[A]),E[A]=e}for(S>>>=N;S>0;){var j=i[n].s;E[j]<e?S-=1<<e-E[j]++-1:++n}for(;n>=0&&S;--n){var P=i[n].s;E[P]==e&&(--E[P],++S)}T=e}return[new Ci(E),T]},ab=function(r,e,t){return r.s==-1?Math.max(ab(r.l,e,t+1),ab(r.r,e,t+1)):e[r.s]=t},ak=function(r){for(var e=r.length;e&&!r[--e];);for(var t=new Co(++e),n=0,s=r[0],i=1,c=function(p){t[n++]=p},d=1;d<=e;++d)if(r[d]==s&&d!=e)++i;else{if(!s&&i>2){for(;i>138;i-=138)c(32754);i>2&&(c(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(c(s),--i;i>6;i-=6)c(8304);i>2&&(c(i-3<<5|8208),i=0)}for(;i--;)c(s);i=1,s=r[d]}return[t.subarray(0,n),e]},Jp=function(r,e){for(var t=0,n=0;n<e.length;++n)t+=r[n]*e[n];return t},lb=function(r,e,t){var n=t.length,s=LR(e+2);r[s]=255&n,r[s+1]=n>>>8,r[s+2]=255^r[s],r[s+3]=255^r[s+1];for(var i=0;i<n;++i)r[s+i+4]=t[i];return 8*(s+4+n)},lk=function(r,e,t,n,s,i,c,d,p,m,g){Tl(e,g++,t),++s[256];for(var x=Ux(s,15),b=x[0],E=x[1],T=Ux(i,15),S=T[0],N=T[1],R=ak(b),A=R[0],j=R[1],P=ak(S),$=P[0],W=P[1],M=new Co(19),V=0;V<A.length;++V)M[31&A[V]]++;for(V=0;V<$.length;++V)M[31&$[V]]++;for(var X=Ux(M,7),ie=X[0],J=X[1],ae=19;ae>4&&!ie[ok[ae-1]];--ae);var we,ue,oe,pe,te=m+5<<3,B=Jp(s,ld)+Jp(i,_y)+c,z=Jp(s,b)+Jp(i,S)+c+14+3*ae+Jp(M,ie)+(2*M[16]+3*M[17]+7*M[18]);if(te<=B&&te<=z)return lb(e,g,r.subarray(p,p+m));if(Tl(e,g,1+(z<B)),g+=2,z<B){we=Em(b,E),ue=b,oe=Em(S,N),pe=S;var Y=Em(ie,J);for(Tl(e,g,j-257),Tl(e,g+5,W-1),Tl(e,g+10,ae-4),g+=14,V=0;V<ae;++V)Tl(e,g+3*V,ie[ok[V]]);g+=3*ae;for(var O=[A,$],U=0;U<2;++U){var ne=O[U];for(V=0;V<ne.length;++V){var Ee=31&ne[V];Tl(e,g,Y[Ee]),g+=ie[Ee],Ee>15&&(Tl(e,g,ne[V]>>>5&127),g+=ne[V]>>>12)}}}else we=Zz,ue=ld,oe=eH,pe=_y;for(V=0;V<d;++V)if(n[V]>255){Ee=n[V]>>>18&31,Yp(e,g,we[Ee+257]),g+=ue[Ee+257],Ee>7&&(Tl(e,g,n[V]>>>23&31),g+=iE[Ee]);var q=31&n[V];Yp(e,g,oe[q]),g+=pe[q],q>3&&(Yp(e,g,n[V]>>>5&8191),g+=aE[q])}else Yp(e,g,we[n[V]]),g+=ue[n[V]];return Yp(e,g,we[256]),g+ue[256]},tH=new hh([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),rH=(function(){for(var r=new hh(256),e=0;e<256;++e){for(var t=e,n=9;--n;)t=(1&t&&3988292384)^t>>>1;r[e]=t}return r})(),nH=function(r,e,t,n,s){return(function(i,c,d,p,m,g){var x=i.length,b=new Ci(p+x+5*(1+Math.floor(x/7e3))+m),E=b.subarray(p,b.length-m),T=0;if(!c||x<8)for(var S=0;S<=x;S+=65535){var N=S+65535;N<x?T=lb(E,T,i.subarray(S,N)):(E[S]=g,T=lb(E,T,i.subarray(S,x)))}else{for(var R=tH[c-1],A=R>>>13,j=8191&R,P=(1<<d)-1,$=new Co(32768),W=new Co(P+1),M=Math.ceil(d/3),V=2*M,X=function(yt){return(i[yt]^i[yt+1]<<M^i[yt+2]<<V)&P},ie=new hh(25e3),J=new Co(288),ae=new Co(32),we=0,ue=0,oe=(S=0,0),pe=0,te=0;S<x;++S){var B=X(S),z=32767&S,Y=W[B];if($[z]=Y,W[B]=z,pe<=S){var O=x-S;if((we>7e3||oe>24576)&&O>423){T=lk(i,E,0,ie,J,ae,ue,oe,te,S-te,T),oe=we=ue=0,te=S;for(var U=0;U<286;++U)J[U]=0;for(U=0;U<30;++U)ae[U]=0}var ne=2,Ee=0,q=j,le=z-Y&32767;if(O>2&&B==X(S-le))for(var xe=Math.min(A,O)-1,ye=Math.min(32767,S),de=Math.min(258,O);le<=ye&&--q&&z!=Y;){if(i[S+ne]==i[S+ne-le]){for(var Te=0;Te<de&&i[S+Te]==i[S+Te-le];++Te);if(Te>ne){if(ne=Te,Ee=le,Te>xe)break;var Be=Math.min(le,Te-2),Ge=0;for(U=0;U<Be;++U){var Me=S-le+U+32768&32767,Ae=Me-$[Me]+32768&32767;Ae>Ge&&(Ge=Ae,Y=Me)}}}le+=(z=Y)-(Y=$[z])+32768&32767}if(Ee){ie[oe++]=268435456|ib[ne]<<18|ik[Ee];var ct=31&ib[ne],Bt=31&ik[Ee];ue+=iE[ct]+aE[Bt],++J[257+ct],++ae[Bt],pe=S+ne,++we}else ie[oe++]=i[S],++J[i[S]]}}T=lk(i,E,g,ie,J,ae,ue,oe,te,S-te,T)}return MR(b,0,p+LR(T)+m)})(r,e.level==null?6:e.level,e.mem==null?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(r.length)))):12+e.mem,t,n,!0)},zx=function(r,e,t){for(;t;++e)r[e]=t,t>>>=8};function sH(r,e){e===void 0&&(e={});var t=(function(){var d=4294967295;return{p:function(p){for(var m=d,g=0;g<p.length;++g)m=rH[255&m^p[g]]^m>>>8;d=m},d:function(){return 4294967295^d}}})(),n=r.length;t.p(r);var s,i=nH(r,e,10+((s=e).filename&&s.filename.length+1||0),8),c=i.length;return(function(d,p){var m=p.filename;if(d[0]=31,d[1]=139,d[2]=8,d[8]=p.level<2?4:p.level==9?2:0,d[9]=3,p.mtime!=0&&zx(d,4,Math.floor(new Date(p.mtime||Date.now())/1e3)),m){d[3]=8;for(var g=0;g<=m.length;++g)d[g+10]=m.charCodeAt(g)}})(i,e),zx(i,c-8,t.d()),zx(i,c-4,n),i}var oH=function(r){var e,t,n,s,i="";for(e=t=0,n=(r=(r+"").replace(/\r\n/g,`
`).replace(/\r/g,`
`)).length,s=0;s<n;s++){var c=r.charCodeAt(s),d=null;c<128?t++:d=c>127&&c<2048?String.fromCharCode(c>>6|192,63&c|128):String.fromCharCode(c>>12|224,c>>6&63|128,63&c|128),na(d)||(t>e&&(i+=r.substring(e,t)),i+=d,e=t=s+1)}return t>e&&(i+=r.substring(e,r.length)),i},iH=!!Bw||!!Hw,ck="text/plain",Ey=function(r,e,t){var n;t===void 0&&(t=!0);var[s,i]=r.split("?"),c=Qe({},e),d=(n=i==null?void 0:i.split("&").map((m=>{var g,[x,b]=m.split("="),E=t&&(g=c[x])!==null&&g!==void 0?g:b;return delete c[x],x+"="+E})))!==null&&n!==void 0?n:[],p=_z(c);return p&&d.push(p),s+"?"+d.join("&")},mm=(r,e)=>JSON.stringify(r,((t,n)=>typeof n=="bigint"?n.toString():n),e),Hx=r=>{var{data:e,compression:t}=r;if(e){if(t===Dl.GZipJS){var n=sH((function(p,m){var g=p.length;if(typeof TextEncoder<"u")return new TextEncoder().encode(p);for(var x=new Ci(p.length+(p.length>>>1)),b=0,E=function(R){x[b++]=R},T=0;T<g;++T){if(b+5>x.length){var S=new Ci(b+8+(g-T<<1));S.set(x),x=S}var N=p.charCodeAt(T);N<128||m?E(N):N<2048?(E(192|N>>>6),E(128|63&N)):N>55295&&N<57344?(E(240|(N=65536+(1047552&N)|1023&p.charCodeAt(++T))>>>18),E(128|N>>>12&63),E(128|N>>>6&63),E(128|63&N)):(E(224|N>>>12),E(128|N>>>6&63),E(128|63&N))}return MR(x,0,b)})(mm(e)),{mtime:0}),s=new Blob([n],{type:ck});return{contentType:ck,body:s,estimatedSize:s.size}}if(t===Dl.Base64){var i=(function(p){var m,g,x,b,E,T="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",S=0,N=0,R="",A=[];if(!p)return p;p=oH(p);do m=(E=p.charCodeAt(S++)<<16|p.charCodeAt(S++)<<8|p.charCodeAt(S++))>>18&63,g=E>>12&63,x=E>>6&63,b=63&E,A[N++]=T.charAt(m)+T.charAt(g)+T.charAt(x)+T.charAt(b);while(S<p.length);switch(R=A.join(""),p.length%3){case 1:R=R.slice(0,-2)+"==";break;case 2:R=R.slice(0,-1)+"="}return R})(mm(e)),c=(p=>"data="+encodeURIComponent(typeof p=="string"?p:mm(p)))(i);return{contentType:"application/x-www-form-urlencoded",body:c,estimatedSize:new Blob([c]).size}}var d=mm(e);return{contentType:"application/json",body:d,estimatedSize:new Blob([d]).size}}},Xv=[];Hw&&Xv.push({transport:"fetch",method:r=>{var e,t,{contentType:n,body:s,estimatedSize:i}=(e=Hx(r))!==null&&e!==void 0?e:{},c=new Headers;Zr(r.headers,(function(g,x){c.append(x,g)})),n&&c.append("Content-Type",n);var d=r.url,p=null;if(NC){var m=new NC;p={signal:m.signal,timeout:setTimeout((()=>m.abort()),r.timeout)}}Hw(d,Qe({method:(r==null?void 0:r.method)||"GET",headers:c,keepalive:r.method==="POST"&&(i||0)<52428.8,body:s,signal:(t=p)==null?void 0:t.signal},r.fetchOptions)).then((g=>g.text().then((x=>{var b={statusCode:g.status,text:x};if(g.status===200)try{b.json=JSON.parse(x)}catch(E){Xe.error(E)}r.callback==null||r.callback(b)})))).catch((g=>{Xe.error(g),r.callback==null||r.callback({statusCode:0,text:g})})).finally((()=>p?clearTimeout(p.timeout):null))}}),Bw&&Xv.push({transport:"XHR",method:r=>{var e,t=new Bw;t.open(r.method||"GET",r.url,!0);var{contentType:n,body:s}=(e=Hx(r))!==null&&e!==void 0?e:{};Zr(r.headers,(function(i,c){t.setRequestHeader(c,i)})),n&&t.setRequestHeader("Content-Type",n),r.timeout&&(t.timeout=r.timeout),r.disableXHRCredentials||(t.withCredentials=!0),t.onreadystatechange=()=>{if(t.readyState===4){var i={statusCode:t.status,text:t.responseText};if(t.status===200)try{i.json=JSON.parse(t.responseText)}catch{}r.callback==null||r.callback(i)}},t.send(s)}}),Xo!=null&&Xo.sendBeacon&&Xv.push({transport:"sendBeacon",method:r=>{var e=Ey(r.url,{beacon:"1"});try{var t,{contentType:n,body:s}=(t=Hx(r))!==null&&t!==void 0?t:{},i=typeof s=="string"?new Blob([s],{type:n}):s;Xo.sendBeacon(e,i)}catch{}}});var Sy=function(r,e){if(!(function(t){try{new RegExp(t)}catch{return!1}return!0})(e))return!1;try{return new RegExp(e).test(r)}catch{return!1}};function uk(r,e,t){return mm({distinct_id:r,userPropertiesToSet:e,userPropertiesToSetOnce:t})}var $R={exact:(r,e)=>e.some((t=>r.some((n=>t===n)))),is_not:(r,e)=>e.every((t=>r.every((n=>t!==n)))),regex:(r,e)=>e.some((t=>r.some((n=>Sy(t,n))))),not_regex:(r,e)=>e.every((t=>r.every((n=>!Sy(t,n))))),icontains:(r,e)=>e.map(Av).some((t=>r.map(Av).some((n=>t.includes(n))))),not_icontains:(r,e)=>e.map(Av).every((t=>r.map(Av).every((n=>!t.includes(n))))),gt:(r,e)=>e.some((t=>{var n=parseFloat(t);return!isNaN(n)&&r.some((s=>n>parseFloat(s)))})),lt:(r,e)=>e.some((t=>{var n=parseFloat(t);return!isNaN(n)&&r.some((s=>n<parseFloat(s)))}))},Av=r=>r.toLowerCase();function UR(r,e){return!r||Object.entries(r).every((t=>{var[n,s]=t,i=e==null?void 0:e[n];if(qe(i)||na(i))return!1;var c=[String(i)],d=$R[s.operator];return!!d&&d(s.values,c)}))}var Bx=xn("[Error tracking]");class aH{constructor(e){var t,n;this.Zt=[],this.ti=new H8([new X8,new iz,new Z8,new Q8,new sz,new nz,new tz,new oz],J8()),this._instance=e,this.Zt=(t=(n=this._instance.persistence)==null?void 0:n.get_property(Qw))!==null&&t!==void 0?t:[]}onRemoteConfig(e){var t,n,s,i=(t=(n=e.errorTracking)==null?void 0:n.suppressionRules)!==null&&t!==void 0?t:[],c=(s=e.errorTracking)==null?void 0:s.captureExtensionExceptions;this.Zt=i,this._instance.persistence&&this._instance.persistence.register({[Qw]:this.Zt,[UC]:c})}get ii(){var e,t=!!this._instance.get_property(UC),n=this._instance.config.error_tracking.captureExtensionExceptions;return(e=n??t)!==null&&e!==void 0&&e}buildProperties(e,t){return this.ti.buildFromUnknown(e,{syntheticException:t==null?void 0:t.syntheticException,mechanism:{handled:t==null?void 0:t.handled}})}sendExceptionEvent(e){var t=e.$exception_list;if(this.ei(t)){if(this.ri(t))return void Bx.info("Skipping exception capture because a suppression rule matched");if(!this.ii&&this.si(t))return void Bx.info("Skipping exception capture because it was thrown by an extension");if(!this._instance.config.error_tracking.__capturePostHogExceptions&&this.ni(t))return void Bx.info("Skipping exception capture because it was thrown by the PostHog SDK")}return this._instance.capture("$exception",e,{_noTruncate:!0,_batchKey:"exceptionEvent"})}ri(e){if(e.length===0)return!1;var t=e.reduce(((n,s)=>{var{type:i,value:c}=s;return Wn(i)&&i.length>0&&n.$exception_types.push(i),Wn(c)&&c.length>0&&n.$exception_values.push(c),n}),{$exception_types:[],$exception_values:[]});return this.Zt.some((n=>{var s=n.values.map((i=>{var c,d=$R[i.operator],p=Fr(i.value)?i.value:[i.value],m=(c=t[i.key])!==null&&c!==void 0?c:[];return p.length>0&&d(p,m)}));return n.type==="OR"?s.some(Boolean):s.every(Boolean)}))}si(e){return e.flatMap((t=>{var n,s;return(n=(s=t.stacktrace)==null?void 0:s.frames)!==null&&n!==void 0?n:[]})).some((t=>t.filename&&t.filename.startsWith("chrome-extension://")))}ni(e){if(e.length>0){var t,n,s,i,c=(t=(n=e[0].stacktrace)==null?void 0:n.frames)!==null&&t!==void 0?t:[],d=c[c.length-1];return(s=d==null||(i=d.filename)==null?void 0:i.includes("posthog.com/static"))!==null&&s!==void 0&&s}return!1}ei(e){return!fr(e)&&Fr(e)}}var qo=xn("[FeatureFlags]"),Xp=xn("[FeatureFlags]",{debugEnabled:!0}),Gx="$active_feature_flags",Uf="$override_feature_flags",dk="$feature_flag_payloads",Qp="$override_feature_flag_payloads",fk="$feature_flag_request_id",hk="$feature_flag_evaluated_at",pk=r=>{var e={};for(var[t,n]of Jv(r||{}))n&&(e[t]=n);return e},lH=r=>{var e=r.flags;return e?(r.featureFlags=Object.fromEntries(Object.keys(e).map((t=>{var n;return[t,(n=e[t].variant)!==null&&n!==void 0?n:e[t].enabled]}))),r.featureFlagPayloads=Object.fromEntries(Object.keys(e).filter((t=>e[t].enabled)).filter((t=>{var n;return(n=e[t].metadata)==null?void 0:n.payload})).map((t=>{var n;return[t,(n=e[t].metadata)==null?void 0:n.payload]})))):qo.warn("Using an older version of the feature flags endpoint. Please upgrade your PostHog server to the latest version"),r},cH=(function(r){return r.FeatureFlags="feature_flags",r.Recordings="recordings",r})({});class uH{constructor(e){this.oi=!1,this.ai=!1,this.li=!1,this.ui=!1,this.hi=!1,this.di=!1,this.vi=!1,this.ci=!1,this._instance=e,this.featureFlagEventHandlers=[]}fi(){var e,t=(e=this._instance.config.evaluation_contexts)!==null&&e!==void 0?e:this._instance.config.evaluation_environments;return!this._instance.config.evaluation_environments||this._instance.config.evaluation_contexts||this.ci||(qo.warn("evaluation_environments is deprecated. Use evaluation_contexts instead. evaluation_environments will be removed in a future version."),this.ci=!0),t!=null&&t.length?t.filter((n=>{var s=n&&typeof n=="string"&&n.trim().length>0;return s||qo.error("Invalid evaluation context found:",n,"Expected non-empty string"),s})):[]}pi(){return this.fi().length>0}flags(){if(this._instance.config.__preview_remote_config)this.di=!0;else{var e=!this.gi&&(this._instance.config.advanced_disable_feature_flags||this._instance.config.advanced_disable_feature_flags_on_first_load);this.mi({disableFlags:e})}}get hasLoadedFlags(){return this.ai}getFlags(){return Object.keys(this.getFlagVariants())}getFlagsWithDetails(){var e=this._instance.get_property(Zw),t=this._instance.get_property(Uf),n=this._instance.get_property(Qp);if(!n&&!t)return e||{};var s=kn({},e||{}),i=[...new Set([...Object.keys(n||{}),...Object.keys(t||{})])];for(var c of i){var d,p,m=s[c],g=t==null?void 0:t[c],x=qe(g)?(d=m==null?void 0:m.enabled)!==null&&d!==void 0&&d:!!g,b=qe(g)?m.variant:typeof g=="string"?g:void 0,E=n==null?void 0:n[c],T=Qe({},m,{enabled:x,variant:x?b??(m==null?void 0:m.variant):void 0});x!==(m==null?void 0:m.enabled)&&(T.original_enabled=m==null?void 0:m.enabled),b!==(m==null?void 0:m.variant)&&(T.original_variant=m==null?void 0:m.variant),E&&(T.metadata=Qe({},m==null?void 0:m.metadata,{payload:E,original_payload:m==null||(p=m.metadata)==null?void 0:p.payload})),s[c]=T}return this.oi||(qo.warn(" Overriding feature flag details!",{flagDetails:e,overriddenPayloads:n,finalDetails:s}),this.oi=!0),s}getFlagVariants(){var e=this._instance.get_property(Qf),t=this._instance.get_property(Uf);if(!t)return e||{};for(var n=kn({},e),s=Object.keys(t),i=0;i<s.length;i++)n[s[i]]=t[s[i]];return this.oi||(qo.warn(" Overriding feature flags!",{enabledFlags:e,overriddenFlags:t,finalFlags:n}),this.oi=!0),n}getFlagPayloads(){var e=this._instance.get_property(dk),t=this._instance.get_property(Qp);if(!t)return e||{};for(var n=kn({},e||{}),s=Object.keys(t),i=0;i<s.length;i++)n[s[i]]=t[s[i]];return this.oi||(qo.warn(" Overriding feature flag payloads!",{flagPayloads:e,overriddenPayloads:t,finalPayloads:n}),this.oi=!0),n}reloadFeatureFlags(){this.ui||this._instance.config.advanced_disable_feature_flags||this.gi||(this._instance.bi.emit("featureFlagsReloading",!0),this.gi=setTimeout((()=>{this.mi()}),5))}yi(){clearTimeout(this.gi),this.gi=void 0}ensureFlagsLoaded(){this.ai||this.li||this.gi||this.reloadFeatureFlags()}setAnonymousDistinctId(e){this.$anon_distinct_id=e}setReloadingPaused(e){this.ui=e}mi(e){var t;if(this.yi(),!this._instance.M())if(this.li)this.hi=!0;else{var n=this._instance.config.token,s=this._instance.get_property("$device_id"),i={token:n,distinct_id:this._instance.get_distinct_id(),groups:this._instance.getGroups(),$anon_distinct_id:this.$anon_distinct_id,person_properties:Qe({},((t=this._instance.persistence)==null?void 0:t.get_initial_props())||{},this._instance.get_property(pm)||{}),group_properties:this._instance.get_property(ed)};na(s)||qe(s)||(i.$device_id=s),(e!=null&&e.disableFlags||this._instance.config.advanced_disable_feature_flags)&&(i.disable_flags=!0),this.pi()&&(i.evaluation_contexts=this.fi());var c=this._instance.config.__preview_remote_config,d=c?"/flags/?v=2":"/flags/?v=2&config=true",p=this._instance.config.advanced_only_evaluate_survey_feature_flags?"&only_evaluate_survey_feature_flags=true":"",m=this._instance.requestRouter.endpointFor("flags",d+p);c&&(i.timezone=FR()),this.li=!0,this._instance._send_request({method:"POST",url:m,data:i,compression:this._instance.config.disable_compression?void 0:Dl.Base64,timeout:this._instance.config.feature_flag_request_timeout_ms,callback:g=>{var x,b,E=!0;if(g.statusCode===200&&(this.hi||(this.$anon_distinct_id=void 0),E=!1),this.li=!1,this.di||(this.di=!0,this._instance.wi((b=g.json)!==null&&b!==void 0?b:{})),!i.disable_flags||this.hi)if(this.vi=!E,g.json&&(x=g.json.quotaLimited)!=null&&x.includes(cH.FeatureFlags))qo.warn("You have hit your feature flags quota limit, and will not be able to load feature flags until the quota is reset.  Please visit https://posthog.com/docs/billing/limits-alerts to learn more.");else{var T;i.disable_flags||this.receivedFeatureFlags((T=g.json)!==null&&T!==void 0?T:{},E),this.hi&&(this.hi=!1,this.mi())}}})}}getFeatureFlag(e,t){var n;if(t===void 0&&(t={}),this.ai||this.getFlags()&&this.getFlags().length>0){var s=this.getFeatureFlagResult(e,t);return(n=s==null?void 0:s.variant)!==null&&n!==void 0?n:s==null?void 0:s.enabled}qo.warn('getFeatureFlag for key "'+e+`" failed. Feature flags didn't load in time.`)}getFeatureFlagDetails(e){return this.getFlagsWithDetails()[e]}getFeatureFlagPayload(e){var t=this.getFeatureFlagResult(e,{send_event:!1});return t==null?void 0:t.payload}getFeatureFlagResult(e,t){if(t===void 0&&(t={}),this.ai||this.getFlags()&&this.getFlags().length>0){var n=this.getFlagVariants(),s=e in n,i=n[e],c=this.getFlagPayloads()[e],d=String(i),p=this._instance.get_property(fk)||void 0,m=this._instance.get_property(hk)||void 0,g=this._instance.get_property(py)||{};if((t.send_event||!("send_event"in t))&&(!(e in g)||!g[e].includes(d))){var x,b,E,T,S,N,R,A,j;Fr(g[e])?g[e].push(d):g[e]=[d],(x=this._instance.persistence)==null||x.register({[py]:g});var P=this.getFeatureFlagDetails(e),$={$feature_flag:e,$feature_flag_response:i,$feature_flag_payload:c||null,$feature_flag_request_id:p,$feature_flag_evaluated_at:m,$feature_flag_bootstrapped_response:((b=this._instance.config.bootstrap)==null||(b=b.featureFlags)==null?void 0:b[e])||null,$feature_flag_bootstrapped_payload:((E=this._instance.config.bootstrap)==null||(E=E.featureFlagPayloads)==null?void 0:E[e])||null,$used_bootstrap_value:!this.vi};qe(P==null||(T=P.metadata)==null?void 0:T.version)||($.$feature_flag_version=P.metadata.version);var W,M=(S=P==null||(N=P.reason)==null?void 0:N.description)!==null&&S!==void 0?S:P==null||(R=P.reason)==null?void 0:R.code;M&&($.$feature_flag_reason=M),P!=null&&(A=P.metadata)!=null&&A.id&&($.$feature_flag_id=P.metadata.id),qe(P==null?void 0:P.original_variant)&&qe(P==null?void 0:P.original_enabled)||($.$feature_flag_original_response=qe(P.original_variant)?P.original_enabled:P.original_variant),P!=null&&(j=P.metadata)!=null&&j.original_payload&&($.$feature_flag_original_payload=P==null||(W=P.metadata)==null?void 0:W.original_payload),this._instance.capture("$feature_flag_called",$)}if(s){var V=c;if(!qe(c))try{V=JSON.parse(c)}catch{}return{key:e,enabled:!!i,variant:typeof i=="string"?i:void 0,payload:V}}}else qo.warn('getFeatureFlagResult for key "'+e+`" failed. Feature flags didn't load in time.`)}getRemoteConfigPayload(e,t){var n=this._instance.config.token,s={distinct_id:this._instance.get_distinct_id(),token:n};this.pi()&&(s.evaluation_contexts=this.fi()),this._instance._send_request({method:"POST",url:this._instance.requestRouter.endpointFor("flags","/flags/?v=2&config=true"),data:s,compression:this._instance.config.disable_compression?void 0:Dl.Base64,timeout:this._instance.config.feature_flag_request_timeout_ms,callback:i=>{var c,d=(c=i.json)==null?void 0:c.featureFlagPayloads;t((d==null?void 0:d[e])||void 0)}})}isFeatureEnabled(e,t){if(t===void 0&&(t={}),this.ai||this.getFlags()&&this.getFlags().length>0){var n=this.getFeatureFlag(e,t);return qe(n)?void 0:!!n}qo.warn('isFeatureEnabled for key "'+e+`" failed. Feature flags didn't load in time.`)}addFeatureFlagsHandler(e){this.featureFlagEventHandlers.push(e)}removeFeatureFlagsHandler(e){this.featureFlagEventHandlers=this.featureFlagEventHandlers.filter((t=>t!==e))}receivedFeatureFlags(e,t){if(this._instance.persistence){this.ai=!0;var n=this.getFlagVariants(),s=this.getFlagPayloads(),i=this.getFlagsWithDetails();(function(c,d,p,m,g){p===void 0&&(p={}),m===void 0&&(m={}),g===void 0&&(g={});var x=lH(c),b=x.flags,E=x.featureFlags,T=x.featureFlagPayloads;if(E){var S=c.requestId,N=c.evaluatedAt;if(Fr(E)){qo.warn("v1 of the feature flags endpoint is deprecated. Please use the latest version.");var R={};if(E)for(var A=0;A<E.length;A++)R[E[A]]=!0;d&&d.register({[Gx]:E,[Qf]:R})}else{var j=E,P=T,$=b;if(c.errorsWhileComputingFlags)if(b){var W=new Set(Object.keys(b).filter((M=>{var V;return!((V=b[M])!=null&&V.failed)})));j=Qe({},p,Object.fromEntries(Object.entries(j).filter((M=>{var[V]=M;return W.has(V)})))),P=Qe({},m,Object.fromEntries(Object.entries(P||{}).filter((M=>{var[V]=M;return W.has(V)})))),$=Qe({},g,Object.fromEntries(Object.entries($||{}).filter((M=>{var[V]=M;return W.has(V)}))))}else j=Qe({},p,j),P=Qe({},m,P),$=Qe({},g,$);d&&d.register(Qe({[Gx]:Object.keys(pk(j)),[Qf]:j||{},[dk]:P||{},[Zw]:$||{}},S?{[fk]:S}:{},N?{[hk]:N}:{}))}}})(e,this._instance.persistence,n,s,i),this.xi(t)}}override(e,t){t===void 0&&(t=!1),qo.warn("override is deprecated. Please use overrideFeatureFlags instead."),this.overrideFeatureFlags({flags:e,suppressWarning:t})}overrideFeatureFlags(e){if(!this._instance.__loaded||!this._instance.persistence)return qo.uninitializedWarning("posthog.featureFlags.overrideFeatureFlags");if(e===!1)return this._instance.persistence.unregister(Uf),this._instance.persistence.unregister(Qp),this.xi(),Xp.info("All overrides cleared");if(e&&typeof e=="object"&&("flags"in e||"payloads"in e)){var t,n=e;if(this.oi=!!((t=n.suppressWarning)!==null&&t!==void 0&&t),"flags"in n){if(n.flags===!1)this._instance.persistence.unregister(Uf),Xp.info("Flag overrides cleared");else if(n.flags){if(Fr(n.flags)){for(var s={},i=0;i<n.flags.length;i++)s[n.flags[i]]=!0;this._instance.persistence.register({[Uf]:s})}else this._instance.persistence.register({[Uf]:n.flags});Xp.info("Flag overrides set",{flags:n.flags})}}return"payloads"in n&&(n.payloads===!1?(this._instance.persistence.unregister(Qp),Xp.info("Payload overrides cleared")):n.payloads&&(this._instance.persistence.register({[Qp]:n.payloads}),Xp.info("Payload overrides set",{payloads:n.payloads}))),void this.xi()}this.xi()}onFeatureFlags(e){if(this.addFeatureFlagsHandler(e),this.ai){var{flags:t,flagVariants:n}=this.Ei();e(t,n)}return()=>this.removeFeatureFlagsHandler(e)}updateEarlyAccessFeatureEnrollment(e,t,n){var s,i=(this._instance.get_property(hm)||[]).find((m=>m.flagKey===e)),c={["$feature_enrollment/"+e]:t},d={$feature_flag:e,$feature_enrollment:t,$set:c};i&&(d.$early_access_feature_name=i.name),n&&(d.$feature_enrollment_stage=n),this._instance.capture("$feature_enrollment_update",d),this.setPersonPropertiesForFlags(c,!1);var p=Qe({},this.getFlagVariants(),{[e]:t});(s=this._instance.persistence)==null||s.register({[Gx]:Object.keys(pk(p)),[Qf]:p}),this.xi()}getEarlyAccessFeatures(e,t,n){t===void 0&&(t=!1);var s=this._instance.get_property(hm),i=n?"&"+n.map((c=>"stage="+c)).join("&"):"";if(s&&!t)return e(s);this._instance._send_request({url:this._instance.requestRouter.endpointFor("api","/api/early_access_features/?token="+this._instance.config.token+i),method:"GET",callback:c=>{var d,p;if(c.json){var m=c.json.earlyAccessFeatures;return(d=this._instance.persistence)==null||d.unregister(hm),(p=this._instance.persistence)==null||p.register({[hm]:m}),e(m)}}})}Ei(){var e=this.getFlags(),t=this.getFlagVariants();return{flags:e.filter((n=>t[n])),flagVariants:Object.keys(t).filter((n=>t[n])).reduce(((n,s)=>(n[s]=t[s],n)),{})}}xi(e){var{flags:t,flagVariants:n}=this.Ei();this.featureFlagEventHandlers.forEach((s=>s(t,n,{errorsLoading:e})))}setPersonPropertiesForFlags(e,t){t===void 0&&(t=!0);var n=this._instance.get_property(pm)||{};this._instance.register({[pm]:Qe({},n,e)}),t&&this._instance.reloadFeatureFlags()}resetPersonPropertiesForFlags(){this._instance.unregister(pm)}setGroupPropertiesForFlags(e,t){t===void 0&&(t=!0);var n=this._instance.get_property(ed)||{};Object.keys(n).length!==0&&Object.keys(n).forEach((s=>{n[s]=Qe({},n[s],e[s]),delete e[s]})),this._instance.register({[ed]:Qe({},n,e)}),t&&this._instance.reloadFeatureFlags()}resetGroupPropertiesForFlags(e){if(e){var t=this._instance.get_property(ed)||{};this._instance.register({[ed]:Qe({},t,{[e]:{}})})}else this._instance.unregister(ed)}reset(){this.ai=!1,this.li=!1,this.ui=!1,this.hi=!1,this.di=!1,this.vi=!1,this.$anon_distinct_id=void 0,this.yi(),this.oi=!1}}var dH=["cookie","localstorage","localstorage+cookie","sessionstorage","memory"];class Wx{constructor(e,t){this.R=e,this.props={},this.$i=!1,this.Si=(n=>{var s="";return n.token&&(s=n.token.replace(/\+/g,"PL").replace(/\//g,"SL").replace(/=/g,"EQ")),n.persistence_name?"ph_"+n.persistence_name:"ph_"+s+"_posthog"})(e),this.Y=this.ki(e),this.load(),e.debug&&Xe.info("Persistence loaded",e.persistence,Qe({},this.props)),this.update_config(e,e,t),this.save()}isDisabled(){return!!this.Pi}ki(e){dH.indexOf(e.persistence.toLowerCase())===-1&&(Xe.critical("Unknown persistence type "+e.persistence+"; falling back to localStorage+cookie"),e.persistence="localStorage+cookie");var t=(function(s){s===void 0&&(s=[]);var i=[...Pz,...s];return Qe({},pn,{W:function(c){try{var d={};try{d=Ma.W(c)||{}}catch{}var p=kn(d,JSON.parse(pn.q(c)||"{}"));return pn.G(c,p),p}catch{}return null},G:function(c,d,p,m,g,x){try{pn.G(c,d,void 0,void 0,x);var b={};i.forEach((E=>{d[E]&&(b[E]=d[E])})),Object.keys(b).length&&Ma.G(c,b,p,m,g,x)}catch(E){pn.B(E)}},V:function(c,d){try{_e==null||_e.localStorage.removeItem(c),Ma.V(c,d)}catch(p){pn.B(p)}}})})(e.cookie_persisted_properties||[]),n=e.persistence.toLowerCase();return n==="localstorage"&&pn.H()?pn:n==="localstorage+cookie"&&t.H()?t:n==="sessionstorage"&&ps.H()?ps:n==="memory"?Fz:n==="cookie"?Ma:t.H()?t:Ma}properties(){var e={};return Zr(this.props,(function(t,n){if(n===Qf&&Gn(t))for(var s=Object.keys(t),i=0;i<s.length;i++)e["$feature/"+s[i]]=t[s[i]];else d=n,p=!1,(na(c=fz)?p:kC&&c.indexOf===kC?c.indexOf(d)!=-1:(Zr(c,(function(m){if(p||(p=m===d))return fy})),p))||(e[n]=t);var c,d,p})),e}load(){if(!this.Pi){var e=this.Y.W(this.Si);e&&(this.props=kn({},e))}}save(){this.Pi||this.Y.G(this.Si,this.props,this.Ti,this.Ii,this.Ci,this.R.debug)}remove(){this.Y.V(this.Si,!1),this.Y.V(this.Si,!0)}clear(){this.remove(),this.props={}}register_once(e,t,n){if(Gn(e)){qe(t)&&(t="None"),this.Ti=qe(n)?this.Ri:n;var s=!1;if(Zr(e,((i,c)=>{this.props.hasOwnProperty(c)&&this.props[c]!==t||(this.props[c]=i,s=!0)})),s)return this.save(),!0}return!1}register(e,t){if(Gn(e)){this.Ti=qe(t)?this.Ri:t;var n=!1;if(Zr(e,((s,i)=>{e.hasOwnProperty(i)&&this.props[i]!==s&&(this.props[i]=s,n=!0)})),n)return this.save(),!0}return!1}unregister(e){e in this.props&&(delete this.props[e],this.save())}update_campaign_params(){if(!this.$i){var e=NR(this.R.custom_campaign_params,this.R.mask_personal_data_properties,this.R.custom_personal_data_properties);Xf(rE(e))||this.register(e),this.$i=!0}}update_search_keyword(){var e;this.register((e=Ve==null?void 0:Ve.referrer)?RR(e):{})}update_referrer_info(){var e;this.register_once({$referrer:AR(),$referring_domain:Ve!=null&&Ve.referrer&&((e=yy(Ve.referrer))==null?void 0:e.host)||"$direct"},void 0)}set_initial_person_info(){this.props[nb]||this.props[sb]||this.register_once({[my]:IR(this.R.mask_personal_data_properties,this.R.custom_personal_data_properties)},void 0)}get_initial_props(){var e={};Zr([sb,nb],(c=>{var d=this.props[c];d&&Zr(d,(function(p,m){e["$initial_"+Gw(m)]=p}))}));var t,n,s=this.props[my];if(s){var i=(t=PR(s),n={},Zr(t,(function(c,d){n["$initial_"+Gw(d)]=c})),n);kn(e,i)}return e}safe_merge(e){return Zr(this.props,(function(t,n){n in e||(e[n]=t)})),e}update_config(e,t,n){if(this.Ri=this.Ti=e.cookie_expiration,this.set_disabled(e.disable_persistence||!!n),this.set_cross_subdomain(e.cross_subdomain_cookie),this.set_secure(e.secure_cookie),e.persistence!==t.persistence||!((c,d)=>{if(c.length!==d.length)return!1;var p=[...c].sort(),m=[...d].sort();return p.every(((g,x)=>g===m[x]))})(e.cookie_persisted_properties||[],t.cookie_persisted_properties||[])){var s=this.ki(e),i=this.props;this.clear(),this.Y=s,this.props=i,this.save()}}set_disabled(e){this.Pi=e,this.Pi?this.remove():this.save()}set_cross_subdomain(e){e!==this.Ii&&(this.Ii=e,this.remove(),this.save())}set_secure(e){e!==this.Ci&&(this.Ci=e,this.remove(),this.save())}set_event_timer(e,t){var n=this.props[fm]||{};n[e]=t,this.props[fm]=n,this.save()}remove_event_timer(e){var t=(this.props[fm]||{})[e];return qe(t)||(delete this.props[fm][e],this.save()),t}get_property(e){return this.props[e]}set_property(e,t){this.props[e]=t,this.save()}}var mk=xn("[Product Tours]"),Vx="ph_product_tours";class fH{constructor(e){this.Fi=null,this.Oi=null,this._instance=e}onRemoteConfig(e){this._instance.persistence&&this._instance.persistence.register({[HC]:!(e==null||!e.productTours)}),this.loadIfEnabled()}loadIfEnabled(){var e,t;this.Fi||(e=this._instance).config.disable_product_tours||(t=e.persistence)==null||!t.get_property(HC)||this.it((()=>this.Mi()))}it(e){var t,n;(t=xt.__PosthogExtensions__)!=null&&t.generateProductTours?e():(n=xt.__PosthogExtensions__)==null||n.loadExternalDependency==null||n.loadExternalDependency(this._instance,"product-tours",(s=>{s?mk.error("Could not load product tours script",s):e()}))}Mi(){var e;!this.Fi&&(e=xt.__PosthogExtensions__)!=null&&e.generateProductTours&&(this.Fi=xt.__PosthogExtensions__.generateProductTours(this._instance,!0))}getProductTours(e,t){if(t===void 0&&(t=!1),!Fr(this.Oi)||t){var n=this._instance.persistence;if(n){var s=n.props[Vx];if(Fr(s)&&!t)return this.Oi=s,void e(s,{isLoaded:!0})}this._instance._send_request({url:this._instance.requestRouter.endpointFor("api","/api/product_tours/?token="+this._instance.config.token),method:"GET",callback:i=>{var c=i.statusCode;if(c!==200||!i.json){var d="Product Tours API could not be loaded, status: "+c;return mk.error(d),void e([],{isLoaded:!1,error:d})}var p=Fr(i.json.product_tours)?i.json.product_tours:[];this.Oi=p,n&&n.register({[Vx]:p}),e(p,{isLoaded:!0})}})}else e(this.Oi,{isLoaded:!0})}getActiveProductTours(e){fr(this.Fi)?e([],{isLoaded:!1,error:"Product tours not loaded"}):this.Fi.getActiveProductTours(e)}showProductTour(e){var t;(t=this.Fi)==null||t.showTourById(e)}previewTour(e){this.Fi?this.Fi.previewTour(e):this.it((()=>{var t;this.Mi(),(t=this.Fi)==null||t.previewTour(e)}))}dismissProductTour(){var e;(e=this.Fi)==null||e.dismissTour("user_clicked_skip")}nextStep(){var e;(e=this.Fi)==null||e.nextStep()}previousStep(){var e;(e=this.Fi)==null||e.previousStep()}clearCache(){var e;this.Oi=null,(e=this._instance.persistence)==null||e.unregister(Vx)}resetTour(e){var t;(t=this.Fi)==null||t.resetTour(e)}resetAllTours(){var e;(e=this.Fi)==null||e.resetAllTours()}cancelPendingTour(e){var t;(t=this.Fi)==null||t.cancelPendingTour(e)}}var Zp=(function(r){return r.Activation="events",r.Cancellation="cancelEvents",r})({});(function(r){return r.Button="button",r.Tab="tab",r.Selector="selector",r})({});(function(r){return r.TopLeft="top_left",r.TopRight="top_right",r.TopCenter="top_center",r.MiddleLeft="middle_left",r.MiddleRight="middle_right",r.MiddleCenter="middle_center",r.Left="left",r.Center="center",r.Right="right",r.NextToTrigger="next_to_trigger",r})({});(function(r){return r.Top="top",r.Left="left",r.Right="right",r.Bottom="bottom",r})({});var qx=(function(r){return r.Popover="popover",r.API="api",r.Widget="widget",r.ExternalSurvey="external_survey",r})({});(function(r){return r.Open="open",r.MultipleChoice="multiple_choice",r.SingleChoice="single_choice",r.Rating="rating",r.Link="link",r})({});(function(r){return r.NextQuestion="next_question",r.End="end",r.ResponseBased="response_based",r.SpecificQuestion="specific_question",r})({});(function(r){return r.Once="once",r.Recurring="recurring",r.Always="always",r})({});var gm=(function(r){return r.SHOWN="survey shown",r.DISMISSED="survey dismissed",r.SENT="survey sent",r.ABANDONED="survey abandoned",r})({}),Kx=(function(r){return r.SURVEY_ID="$survey_id",r.SURVEY_NAME="$survey_name",r.SURVEY_RESPONSE="$survey_response",r.SURVEY_ITERATION="$survey_iteration",r.SURVEY_ITERATION_START_DATE="$survey_iteration_start_date",r.SURVEY_PARTIALLY_COMPLETED="$survey_partially_completed",r.SURVEY_SUBMISSION_ID="$survey_submission_id",r.SURVEY_QUESTIONS="$survey_questions",r.SURVEY_COMPLETED="$survey_completed",r.PRODUCT_TOUR_ID="$product_tour_id",r.SURVEY_LAST_SEEN_DATE="$survey_last_seen_date",r})({}),cb=(function(r){return r.Popover="popover",r.Inline="inline",r})({}),qr=xn("[Surveys]"),zR="seenSurvey_",hH=(r,e)=>{var t="$survey_"+e+"/"+r.id;return r.current_iteration&&r.current_iteration>0&&(t="$survey_"+e+"/"+r.id+"/"+r.current_iteration),t},gk=r=>((e,t)=>{var n=""+e+t.id;return t.current_iteration&&t.current_iteration>0&&(n=""+e+t.id+"_"+t.current_iteration),n})(zR,r),pH=[qx.Popover,qx.Widget,qx.API],mH={ignoreConditions:!1,ignoreDelay:!1,displayType:cb.Popover};class lE{constructor(){this.Ai={},this.Ai={}}on(e,t){return this.Ai[e]||(this.Ai[e]=[]),this.Ai[e].push(t),()=>{this.Ai[e]=this.Ai[e].filter((n=>n!==t))}}emit(e,t){for(var n of this.Ai[e]||[])n(t);for(var s of this.Ai["*"]||[])s(e,t)}}function zf(r,e,t){if(fr(r))return!1;switch(t){case"exact":return r===e;case"contains":var n=e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/_/g,".").replace(/%/g,".*");return new RegExp(n,"i").test(r);case"regex":try{return new RegExp(e).test(r)}catch{return!1}default:return!1}}class gH{constructor(e){this.ji=new lE,this.Di=(t,n)=>this.Li(t,n)&&this.Ni(t,n)&&this.Ui(t,n)&&this.zi(t,n),this.Li=(t,n)=>n==null||!n.event||(t==null?void 0:t.event)===(n==null?void 0:n.event),this._instance=e,this.Hi=new Set,this.Bi=new Set}init(){var e;if(!qe((e=this._instance)==null?void 0:e._addCaptureHook)){var t;(t=this._instance)==null||t._addCaptureHook(((n,s)=>{this.on(n,s)}))}}register(e){var t,n;if(!qe((t=this._instance)==null?void 0:t._addCaptureHook)&&(e.forEach((c=>{var d,p;(d=this.Bi)==null||d.add(c),(p=c.steps)==null||p.forEach((m=>{var g;(g=this.Hi)==null||g.add((m==null?void 0:m.event)||"")}))})),(n=this._instance)!=null&&n.autocapture)){var s,i=new Set;e.forEach((c=>{var d;(d=c.steps)==null||d.forEach((p=>{p!=null&&p.selector&&i.add(p==null?void 0:p.selector)}))})),(s=this._instance)==null||s.autocapture.setElementSelectors(i)}}on(e,t){var n;t!=null&&e.length!=0&&(this.Hi.has(e)||this.Hi.has(t==null?void 0:t.event))&&this.Bi&&((n=this.Bi)==null?void 0:n.size)>0&&this.Bi.forEach((s=>{this.qi(t,s)&&this.ji.emit("actionCaptured",s.name)}))}Wi(e){this.onAction("actionCaptured",(t=>e(t)))}qi(e,t){if((t==null?void 0:t.steps)==null)return!1;for(var n of t.steps)if(this.Di(e,n))return!0;return!1}onAction(e,t){return this.ji.on(e,t)}Ni(e,t){if(t!=null&&t.url){var n,s=e==null||(n=e.properties)==null?void 0:n.$current_url;if(!s||typeof s!="string"||!zf(s,t.url,t.url_matching||"contains"))return!1}return!0}Ui(e,t){return!!this.Gi(e,t)&&!!this.Vi(e,t)&&!!this.Ji(e,t)}Gi(e,t){var n;if(t==null||!t.href)return!0;var s=this.Ki(e);if(s.length>0)return s.some((d=>zf(d.href,t.href,t.href_matching||"exact")));var i,c=(e==null||(n=e.properties)==null?void 0:n.$elements_chain)||"";return!!c&&zf((i=c.match(/(?::|")href="(.*?)"/))?i[1]:"",t.href,t.href_matching||"exact")}Vi(e,t){var n;if(t==null||!t.text)return!0;var s=this.Ki(e);if(s.length>0)return s.some((m=>zf(m.text,t.text,t.text_matching||"exact")||zf(m.$el_text,t.text,t.text_matching||"exact")));var i,c,d,p=(e==null||(n=e.properties)==null?void 0:n.$elements_chain)||"";return!!p&&(i=(function(m){for(var g,x=[],b=/(?::|")text="(.*?)"/g;!fr(g=b.exec(m));)x.includes(g[1])||x.push(g[1]);return x})(p),c=t.text,d=t.text_matching||"exact",i.some((m=>zf(m,c,d))))}Ji(e,t){var n,s;if(t==null||!t.selector)return!0;var i=e==null||(n=e.properties)==null?void 0:n.$element_selectors;if(i!=null&&i.includes(t.selector))return!0;var c=(e==null||(s=e.properties)==null?void 0:s.$elements_chain)||"";if(t.selector_regex&&c)try{return new RegExp(t.selector_regex).test(c)}catch{return!1}return!1}Ki(e){var t;return(e==null||(t=e.properties)==null?void 0:t.$elements)==null?[]:e==null?void 0:e.properties.$elements}zi(e,t){return t==null||!t.properties||t.properties.length===0||UR(t.properties.reduce(((n,s)=>{var i=Fr(s.value)?s.value.map(String):s.value!=null?[String(s.value)]:[];return n[s.key]={values:i,operator:s.operator||"exact"},n}),{}),e==null?void 0:e.properties)}}class vH{constructor(e){this._instance=e,this.Yi=new Map,this.Xi=new Map,this.Qi=new Map}Zi(e,t){return!!e&&UR(e.propertyFilters,t==null?void 0:t.properties)}te(e,t){var n=new Map;return e.forEach((s=>{var i;(i=s.conditions)==null||(i=i[t])==null||(i=i.values)==null||i.forEach((c=>{if(c!=null&&c.name){var d=n.get(c.name)||[];d.push(s.id),n.set(c.name,d)}}))})),n}ie(e,t,n){var s=(n===Zp.Activation?this.Yi:this.Xi).get(e),i=[];return this.ee((c=>{i=c.filter((d=>s==null?void 0:s.includes(d.id)))})),i.filter((c=>{var d,p=(d=c.conditions)==null||(d=d[n])==null||(d=d.values)==null?void 0:d.find((m=>m.name===e));return this.Zi(p,t)}))}register(e){var t;qe((t=this._instance)==null?void 0:t._addCaptureHook)||(this.re(e),this.se(e))}se(e){var t=e.filter((n=>{var s,i;return((s=n.conditions)==null?void 0:s.actions)&&((i=n.conditions)==null||(i=i.actions)==null||(i=i.values)==null?void 0:i.length)>0}));t.length!==0&&(this.ne==null&&(this.ne=new gH(this._instance),this.ne.init(),this.ne.Wi((n=>{this.onAction(n)}))),t.forEach((n=>{var s,i,c,d,p;n.conditions&&(s=n.conditions)!=null&&s.actions&&(i=n.conditions)!=null&&(i=i.actions)!=null&&i.values&&((c=n.conditions)==null||(c=c.actions)==null||(c=c.values)==null?void 0:c.length)>0&&((d=this.ne)==null||d.register(n.conditions.actions.values),(p=n.conditions)==null||(p=p.actions)==null||(p=p.values)==null||p.forEach((m=>{if(m&&m.name){var g=this.Qi.get(m.name);g&&g.push(n.id),this.Qi.set(m.name,g||[n.id])}})))})))}re(e){var t,n=e.filter((i=>{var c,d;return((c=i.conditions)==null?void 0:c.events)&&((d=i.conditions)==null||(d=d.events)==null||(d=d.values)==null?void 0:d.length)>0})),s=e.filter((i=>{var c,d;return((c=i.conditions)==null?void 0:c.cancelEvents)&&((d=i.conditions)==null||(d=d.cancelEvents)==null||(d=d.values)==null?void 0:d.length)>0}));(n.length!==0||s.length!==0)&&((t=this._instance)==null||t._addCaptureHook(((i,c)=>{this.onEvent(i,c)})),this.Yi=this.te(e,Zp.Activation),this.Xi=this.te(e,Zp.Cancellation))}onEvent(e,t){var n,s=this.oe(),i=this.ae(),c=this.le(),d=((n=this._instance)==null||(n=n.persistence)==null?void 0:n.props[i])||[];if(c===e&&t&&d.length>0){var p,m;s.info("event matched, removing item from activated items",{event:e,eventPayload:t,existingActivatedItems:d});var g=(t==null||(p=t.properties)==null?void 0:p.$survey_id)||(t==null||(m=t.properties)==null?void 0:m.$product_tour_id);if(g){var x=d.indexOf(g);x>=0&&(d.splice(x,1),this.ue(d))}}else{if(this.Xi.has(e)){var b=this.ie(e,t,Zp.Cancellation);b.length>0&&(s.info("cancel event matched, cancelling items",{event:e,itemsToCancel:b.map((T=>T.id))}),b.forEach((T=>{var S=d.indexOf(T.id);S>=0&&d.splice(S,1),this.he(T.id)})),this.ue(d))}if(this.Yi.has(e)){s.info("event name matched",{event:e,eventPayload:t,items:this.Yi.get(e)});var E=this.ie(e,t,Zp.Activation);this.ue(d.concat(E.map((T=>T.id))||[]))}}}onAction(e){var t,n=this.ae(),s=((t=this._instance)==null||(t=t.persistence)==null?void 0:t.props[n])||[];this.Qi.has(e)&&this.ue(s.concat(this.Qi.get(e)||[]))}ue(e){var t,n=this.oe(),s=this.ae(),i=[...new Set(e)].filter((c=>!this.de(c)));n.info("updating activated items",{activatedItems:i}),(t=this._instance)==null||(t=t.persistence)==null||t.register({[s]:i})}getActivatedIds(){var e,t=this.ae(),n=(e=this._instance)==null||(e=e.persistence)==null?void 0:e.props[t];return n||[]}getEventToItemsMap(){return this.Yi}ve(){return this.ne}}class yH extends vH{constructor(e){super(e)}ae(){return"$surveys_activated"}le(){return gm.SHOWN}ee(e){var t;(t=this._instance)==null||t.getSurveys(e)}he(e){var t;(t=this._instance)==null||t.cancelPendingSurvey(e)}oe(){return qr}de(){return!1}getSurveys(){return this.getActivatedIds()}getEventToSurveys(){return this.getEventToItemsMap()}}class xH{constructor(e){this.ce=void 0,this._surveyManager=null,this.fe=!1,this.pe=[],this.ge=null,this._instance=e,this._surveyEventReceiver=null}onRemoteConfig(e){if(!this._instance.config.disable_surveys){var t=e.surveys;if(fr(t))return qr.warn("Flags not loaded yet. Not loading surveys.");var n=Fr(t);this.ce=n?t.length>0:t,qr.info("flags response received, isSurveysEnabled: "+this.ce),this.loadIfEnabled()}}reset(){localStorage.removeItem("lastSeenSurveyDate");for(var e=[],t=0;t<localStorage.length;t++){var n=localStorage.key(t);(n!=null&&n.startsWith(zR)||n!=null&&n.startsWith("inProgressSurvey_"))&&e.push(n)}e.forEach((s=>localStorage.removeItem(s)))}loadIfEnabled(){if(!this._surveyManager)if(this.fe)qr.info("Already initializing surveys, skipping...");else if(this._instance.config.disable_surveys)qr.info("Disabled. Not loading surveys.");else if(this._instance.config.cookieless_mode&&this._instance.consent.isOptedOut())qr.info("Not loading surveys in cookieless mode without consent.");else{var e=xt==null?void 0:xt.__PosthogExtensions__;if(e){if(!qe(this.ce)||this._instance.config.advanced_enable_surveys){var t=this.ce||this._instance.config.advanced_enable_surveys;this.fe=!0;try{var n=e.generateSurveys;if(n)return void this._e(n,t);var s=e.loadExternalDependency;if(!s)return void this.me("PostHog loadExternalDependency extension not found.");s(this._instance,"surveys",(i=>{i||!e.generateSurveys?this.me("Could not load surveys script",i):this._e(e.generateSurveys,t)}))}catch(i){throw this.me("Error initializing surveys",i),i}finally{this.fe=!1}}}else qr.error("PostHog Extensions not found.")}}_e(e,t){this._surveyManager=e(this._instance,t),this._surveyEventReceiver=new yH(this._instance),qr.info("Surveys loaded successfully"),this.be({isLoaded:!0})}me(e,t){qr.error(e,t),this.be({isLoaded:!1,error:e})}onSurveysLoaded(e){return this.pe.push(e),this._surveyManager&&this.be({isLoaded:!0}),()=>{this.pe=this.pe.filter((t=>t!==e))}}getSurveys(e,t){if(t===void 0&&(t=!1),this._instance.config.disable_surveys)return qr.info("Disabled. Not loading surveys."),e([]);var n,s=this._instance.get_property(eb);if(s&&!t)return e(s,{isLoaded:!0});typeof Promise<"u"&&this.ge?this.ge.then((i=>{var{surveys:c,context:d}=i;return e(c,d)})):(typeof Promise<"u"&&(this.ge=new Promise((i=>{n=i}))),this._instance._send_request({url:this._instance.requestRouter.endpointFor("api","/api/surveys/?token="+this._instance.config.token),method:"GET",timeout:this._instance.config.surveys_request_timeout_ms,callback:i=>{var c;this.ge=null;var d=i.statusCode;if(d!==200||!i.json){var p="Surveys API could not be loaded, status: "+d;qr.error(p);var m={isLoaded:!1,error:p};return e([],m),void(n==null||n({surveys:[],context:m}))}var g,x=i.json.surveys||[],b=x.filter((T=>(function(S){return!(!S.start_date||S.end_date)})(T)&&((function(S){var N;return!((N=S.conditions)==null||(N=N.events)==null||(N=N.values)==null||!N.length)})(T)||(function(S){var N;return!((N=S.conditions)==null||(N=N.actions)==null||(N=N.values)==null||!N.length)})(T))));b.length>0&&((g=this._surveyEventReceiver)==null||g.register(b)),(c=this._instance.persistence)==null||c.register({[eb]:x});var E={isLoaded:!0};e(x,E),n==null||n({surveys:x,context:E})}}))}be(e){for(var t of this.pe)try{if(!e.isLoaded)return t([],e);this.getSurveys(t)}catch(n){qr.error("Error in survey callback",n)}}getActiveMatchingSurveys(e,t){if(t===void 0&&(t=!1),!fr(this._surveyManager))return this._surveyManager.getActiveMatchingSurveys(e,t);qr.warn("init was not called")}ye(e){var t=null;return this.getSurveys((n=>{var s;t=(s=n.find((i=>i.id===e)))!==null&&s!==void 0?s:null})),t}we(e){if(fr(this._surveyManager))return{eligible:!1,reason:"SDK is not enabled or survey functionality is not yet loaded"};var t=typeof e=="string"?this.ye(e):e;return t?this._surveyManager.checkSurveyEligibility(t):{eligible:!1,reason:"Survey not found"}}canRenderSurvey(e){if(fr(this._surveyManager))return qr.warn("init was not called"),{visible:!1,disabledReason:"SDK is not enabled or survey functionality is not yet loaded"};var t=this.we(e);return{visible:t.eligible,disabledReason:t.reason}}canRenderSurveyAsync(e,t){return fr(this._surveyManager)?(qr.warn("init was not called"),Promise.resolve({visible:!1,disabledReason:"SDK is not enabled or survey functionality is not yet loaded"})):new Promise((n=>{this.getSurveys((s=>{var i,c=(i=s.find((p=>p.id===e)))!==null&&i!==void 0?i:null;if(c){var d=this.we(c);n({visible:d.eligible,disabledReason:d.reason})}else n({visible:!1,disabledReason:"Survey not found"})}),t)}))}renderSurvey(e,t,n){var s;if(fr(this._surveyManager))qr.warn("init was not called");else{var i=typeof e=="string"?this.ye(e):e;if(i!=null&&i.id)if(pH.includes(i.type)){var c=Ve==null?void 0:Ve.querySelector(t);if(c)return(s=i.appearance)!=null&&s.surveyPopupDelaySeconds?(qr.info("Rendering survey "+i.id+" with delay of "+i.appearance.surveyPopupDelaySeconds+" seconds"),void setTimeout((()=>{var d,p;qr.info("Rendering survey "+i.id+" with delay of "+((d=i.appearance)==null?void 0:d.surveyPopupDelaySeconds)+" seconds"),(p=this._surveyManager)==null||p.renderSurvey(i,c,n),qr.info("Survey "+i.id+" rendered")}),1e3*i.appearance.surveyPopupDelaySeconds)):void this._surveyManager.renderSurvey(i,c,n);qr.warn("Survey element not found")}else qr.warn("Surveys of type "+i.type+" cannot be rendered in the app");else qr.warn("Survey not found")}}displaySurvey(e,t){var n;if(fr(this._surveyManager))qr.warn("init was not called");else{var s=this.ye(e);if(s){var i=s;if((n=s.appearance)!=null&&n.surveyPopupDelaySeconds&&t.ignoreDelay&&(i=Qe({},s,{appearance:Qe({},s.appearance,{surveyPopupDelaySeconds:0})})),t.displayType!==cb.Popover&&t.initialResponses&&qr.warn("initialResponses is only supported for popover surveys. prefill will not be applied."),t.ignoreConditions===!1){var c=this.canRenderSurvey(s);if(!c.visible)return void qr.warn("Survey is not eligible to be displayed: ",c.disabledReason)}t.displayType!==cb.Inline?this._surveyManager.handlePopoverSurvey(i,t):this.renderSurvey(i,t.selector,t.properties)}else qr.warn("Survey not found")}}cancelPendingSurvey(e){fr(this._surveyManager)?qr.warn("init was not called"):this._surveyManager.cancelSurvey(e)}handlePageUnload(){var e;(e=this._surveyManager)==null||e.handlePageUnload()}}var Rl=xn("[Conversations]");class wH{constructor(e){this.xe=void 0,this._conversationsManager=null,this.Ee=!1,this.$e=null,this._instance=e}onRemoteConfig(e){if(!this._instance.config.disable_conversations){var t=e.conversations;fr(t)||($l(t)?this.xe=t:(this.xe=t.enabled,this.$e=t),this.loadIfEnabled())}}reset(){var e;(e=this._conversationsManager)==null||e.reset(),this._conversationsManager=null,this.xe=void 0,this.$e=null}loadIfEnabled(){if(!this._conversationsManager&&!this.Ee&&!(this._instance.config.disable_conversations||this._instance.config.cookieless_mode&&this._instance.consent.isOptedOut())){var e=xt==null?void 0:xt.__PosthogExtensions__;if(e&&!qe(this.xe)&&this.xe)if(this.$e&&this.$e.token){this.Ee=!0;try{var t=e.initConversations;if(t)return this.Se(t),void(this.Ee=!1);var n=e.loadExternalDependency;if(!n)return void this.ke("PostHog loadExternalDependency extension not found.");n(this._instance,"conversations",(s=>{s||!e.initConversations?this.ke("Could not load conversations script",s):this.Se(e.initConversations),this.Ee=!1}))}catch(s){this.ke("Error initializing conversations",s),this.Ee=!1}}else Rl.error("Conversations enabled but missing token in remote config.")}}Se(e){if(this.$e)try{this._conversationsManager=e(this.$e,this._instance),Rl.info("Conversations loaded successfully")}catch(t){this.ke("Error completing conversations initialization",t)}else Rl.error("Cannot complete initialization: remote config is null")}ke(e,t){Rl.error(e,t),this._conversationsManager=null,this.Ee=!1}show(){this._conversationsManager?this._conversationsManager.show():Rl.warn("Conversations not loaded yet.")}hide(){this._conversationsManager&&this._conversationsManager.hide()}isAvailable(){return this.xe===!0&&!na(this._conversationsManager)}isVisible(){var e,t;return(e=(t=this._conversationsManager)==null?void 0:t.isVisible())!==null&&e!==void 0&&e}sendMessage(e,t,n){var s=this;return Jf((function*(){return s._conversationsManager?s._conversationsManager.sendMessage(e,t,n):(Rl.warn("Conversations not available yet."),null)}))()}getMessages(e,t){var n=this;return Jf((function*(){return n._conversationsManager?n._conversationsManager.getMessages(e,t):(Rl.warn("Conversations not available yet."),null)}))()}markAsRead(e){var t=this;return Jf((function*(){return t._conversationsManager?t._conversationsManager.markAsRead(e):(Rl.warn("Conversations not available yet."),null)}))()}getTickets(e){var t=this;return Jf((function*(){return t._conversationsManager?t._conversationsManager.getTickets(e):(Rl.warn("Conversations not available yet."),null)}))()}getCurrentTicketId(){var e,t;return(e=(t=this._conversationsManager)==null?void 0:t.getCurrentTicketId())!==null&&e!==void 0?e:null}getWidgetSessionId(){var e,t;return(e=(t=this._conversationsManager)==null?void 0:t.getWidgetSessionId())!==null&&e!==void 0?e:null}}class bH{constructor(e){var t;this.Pe=!1,this.Te=!1,this._instance=e,this._instance&&(t=this._instance.config.logs)!=null&&t.captureConsoleLogs&&(this.Pe=!0)}onRemoteConfig(e){var t,n=(t=e.logs)==null?void 0:t.captureConsoleLogs;!fr(n)&&n&&(this.Pe=!0,this.loadIfEnabled())}reset(){}loadIfEnabled(){if(this.Pe&&!this.Te){var e=xn("[logs]"),t=xt==null?void 0:xt.__PosthogExtensions__;if(t){var n=t.loadExternalDependency;n?n(this._instance,"logs",(s=>{var i;s||(i=t.logs)==null||!i.initializeLogs?e.error("Could not load logs script",s):(t.logs.initializeLogs(this._instance),this.Te=!0)})):e.error("PostHog loadExternalDependency extension not found.")}else e.error("PostHog Extensions not found.")}}}var vk=xn("[RateLimiter]");class _H{constructor(e){this.serverLimits={},this.lastEventRateLimited=!1,this.checkForLimiting=t=>{var n=t.text;if(n&&n.length)try{(JSON.parse(n).quota_limited||[]).forEach((s=>{vk.info((s||"events")+" is quota limited."),this.serverLimits[s]=new Date().getTime()+6e4}))}catch(s){return void vk.warn('could not rate limit - continuing. Error: "'+(s==null?void 0:s.message)+'"',{text:n})}},this.instance=e,this.lastEventRateLimited=this.clientRateLimitContext(!0).isRateLimited}get captureEventsPerSecond(){var e;return((e=this.instance.config.rate_limiting)==null?void 0:e.events_per_second)||10}get captureEventsBurstLimit(){var e;return Math.max(((e=this.instance.config.rate_limiting)==null?void 0:e.events_burst_limit)||10*this.captureEventsPerSecond,this.captureEventsPerSecond)}clientRateLimitContext(e){var t,n,s;e===void 0&&(e=!1);var{captureEventsBurstLimit:i,captureEventsPerSecond:c}=this,d=new Date().getTime(),p=(t=(n=this.instance.persistence)==null?void 0:n.get_property(rb))!==null&&t!==void 0?t:{tokens:i,last:d};p.tokens+=(d-p.last)/1e3*c,p.last=d,p.tokens>i&&(p.tokens=i);var m=p.tokens<1;return m||e||(p.tokens=Math.max(0,p.tokens-1)),!m||this.lastEventRateLimited||e||this.instance.capture("$$client_ingestion_warning",{$$client_ingestion_warning_message:"posthog-js client rate limited. Config is set to "+c+" events per second and "+i+" events burst limit."},{skip_client_rate_limiting:!0}),this.lastEventRateLimited=m,(s=this.instance.persistence)==null||s.set_property(rb,p),{isRateLimited:m,remainingTokens:p.tokens}}isServerRateLimited(e){var t=this.serverLimits[e||"events"]||!1;return t!==!1&&new Date().getTime()<t}}var Xu=xn("[RemoteConfig]");class EH{constructor(e){this._instance=e}get remoteConfig(){var e;return(e=xt._POSTHOG_REMOTE_CONFIG)==null||(e=e[this._instance.config.token])==null?void 0:e.config}Ie(e){var t,n;(t=xt.__PosthogExtensions__)!=null&&t.loadExternalDependency?(n=xt.__PosthogExtensions__)==null||n.loadExternalDependency==null||n.loadExternalDependency(this._instance,"remote-config",(()=>e(this.remoteConfig))):(Xu.error("PostHog Extensions not found. Cannot load remote config."),e())}Ce(e){this._instance._send_request({method:"GET",url:this._instance.requestRouter.endpointFor("assets","/array/"+this._instance.config.token+"/config"),callback:t=>{e(t.json)}})}load(){try{if(this.remoteConfig)return Xu.info("Using preloaded remote config",this.remoteConfig),void this.wi(this.remoteConfig);if(this._instance.M())return void Xu.warn("Remote config is disabled. Falling back to local config.");this.Ie((e=>{if(!e)return Xu.info("No config found after loading remote JS config. Falling back to JSON."),void this.Ce((t=>{this.wi(t)}));this.wi(e)}))}catch(e){Xu.error("Error loading remote config",e)}}wi(e){e?this._instance.config.__preview_remote_config?(this._instance.wi(e),e.hasFeatureFlags!==!1&&this._instance.featureFlags.ensureFlagsLoaded()):Xu.info("__preview_remote_config is disabled. Logging config instead",e):Xu.error("Failed to fetch remote config from PostHog.")}}var ub=3e3;class SH{constructor(e,t){this.Re=!0,this.Fe=[],this.Oe=za((t==null?void 0:t.flush_interval_ms)||ub,250,5e3,Xe.createLogger("flush interval"),ub),this.Me=e}enqueue(e){this.Fe.push(e),this.Ae||this.je()}unload(){this.De();var e=this.Fe.length>0?this.Le():{},t=Object.values(e);[...t.filter((n=>n.url.indexOf("/e")===0)),...t.filter((n=>n.url.indexOf("/e")!==0))].map((n=>{this.Me(Qe({},n,{transport:"sendBeacon"}))}))}enable(){this.Re=!1,this.je()}je(){var e=this;this.Re||(this.Ae=setTimeout((()=>{if(this.De(),this.Fe.length>0){var t=this.Le(),n=function(){var i=t[s],c=new Date().getTime();i.data&&Fr(i.data)&&Zr(i.data,(d=>{d.offset=Math.abs(d.timestamp-c),delete d.timestamp})),e.Me(i)};for(var s in t)n()}}),this.Oe))}De(){clearTimeout(this.Ae),this.Ae=void 0}Le(){var e={};return Zr(this.Fe,(t=>{var n,s=t,i=(s?s.batchKey:null)||s.url;qe(e[i])&&(e[i]=Qe({},s,{data:[]})),(n=e[i].data)==null||n.push(s.data)})),this.Fe=[],e}}var CH=["retriesPerformedSoFar"];class kH{constructor(e){this.Ne=!1,this.Ue=3e3,this.Fe=[],this._instance=e,this.Fe=[],this.ze=!0,!qe(_e)&&"onLine"in _e.navigator&&(this.ze=_e.navigator.onLine,this.He=()=>{this.ze=!0,this.Lt()},this.Be=()=>{this.ze=!1},jn(_e,"online",this.He),jn(_e,"offline",this.Be))}get length(){return this.Fe.length}retriableRequest(e){var{retriesPerformedSoFar:t}=e,n=DT(e,CH);qf(t)&&(n.url=Ey(n.url,{retry_count:t})),this._instance._send_request(Qe({},n,{callback:s=>{s.statusCode!==200&&(s.statusCode<400||s.statusCode>=500)&&(t??0)<10?this.qe(Qe({retriesPerformedSoFar:t},n)):n.callback==null||n.callback(s)}}))}qe(e){var t=e.retriesPerformedSoFar||0;e.retriesPerformedSoFar=t+1;var n=(function(c){var d=3e3*Math.pow(2,c),p=d/2,m=Math.min(18e5,d),g=(Math.random()-.5)*(m-p);return Math.ceil(m+g)})(t),s=Date.now()+n;this.Fe.push({retryAt:s,requestOptions:e});var i="Enqueued failed request for retry in "+n;navigator.onLine||(i+=" (Browser is offline)"),Xe.warn(i),this.Ne||(this.Ne=!0,this.We())}We(){if(this.Ge&&clearTimeout(this.Ge),this.Fe.length===0)return this.Ne=!1,void(this.Ge=void 0);this.Ge=setTimeout((()=>{this.ze&&this.Fe.length>0&&this.Lt(),this.We()}),this.Ue)}Lt(){var e=Date.now(),t=[],n=this.Fe.filter((i=>i.retryAt<e||(t.push(i),!1)));if(this.Fe=t,n.length>0)for(var{requestOptions:s}of n)this.retriableRequest(s)}unload(){for(var{requestOptions:e}of(this.Ge&&(clearTimeout(this.Ge),this.Ge=void 0),this.Ne=!1,qe(_e)||(this.He&&(_e.removeEventListener("online",this.He),this.He=void 0),this.Be&&(_e.removeEventListener("offline",this.Be),this.Be=void 0)),this.Fe))try{this._instance._send_request(Qe({},e,{transport:"sendBeacon"}))}catch(t){Xe.error(t)}this.Fe=[]}}class NH{constructor(e){this.Ve=()=>{var t,n,s,i;this.Je||(this.Je={});var c=this.scrollElement(),d=this.scrollY(),p=c?Math.max(0,c.scrollHeight-c.clientHeight):0,m=d+((c==null?void 0:c.clientHeight)||0),g=(c==null?void 0:c.scrollHeight)||0;this.Je.lastScrollY=Math.ceil(d),this.Je.maxScrollY=Math.max(d,(t=this.Je.maxScrollY)!==null&&t!==void 0?t:0),this.Je.maxScrollHeight=Math.max(p,(n=this.Je.maxScrollHeight)!==null&&n!==void 0?n:0),this.Je.lastContentY=m,this.Je.maxContentY=Math.max(m,(s=this.Je.maxContentY)!==null&&s!==void 0?s:0),this.Je.maxContentHeight=Math.max(g,(i=this.Je.maxContentHeight)!==null&&i!==void 0?i:0)},this._instance=e}getContext(){return this.Je}resetContext(){var e=this.Je;return setTimeout(this.Ve,0),e}startMeasuringScrollPosition(){jn(_e,"scroll",this.Ve,{capture:!0}),jn(_e,"scrollend",this.Ve,{capture:!0}),jn(_e,"resize",this.Ve)}scrollElement(){if(!this._instance.config.scroll_root_selector)return _e==null?void 0:_e.document.documentElement;var e=Fr(this._instance.config.scroll_root_selector)?this._instance.config.scroll_root_selector:[this._instance.config.scroll_root_selector];for(var t of e){var n=_e==null?void 0:_e.document.querySelector(t);if(n)return n}}scrollY(){if(this._instance.config.scroll_root_selector){var e=this.scrollElement();return e&&e.scrollTop||0}return _e&&(_e.scrollY||_e.pageYOffset||_e.document.documentElement.scrollTop)||0}scrollX(){if(this._instance.config.scroll_root_selector){var e=this.scrollElement();return e&&e.scrollLeft||0}return _e&&(_e.scrollX||_e.pageXOffset||_e.document.documentElement.scrollLeft)||0}}var TH=r=>IR(r==null?void 0:r.config.mask_personal_data_properties,r==null?void 0:r.config.custom_personal_data_properties);class yk{constructor(e,t,n,s){this.Ke=i=>{var c=this.Ye();if(!c||c.sessionId!==i){var d={sessionId:i,props:this.Xe(this._instance)};this.Qe.register({[tb]:d})}},this._instance=e,this.Ze=t,this.Qe=n,this.Xe=s||TH,this.Ze.onSessionId(this.Ke)}Ye(){return this.Qe.props[tb]}getSetOnceProps(){var e,t=(e=this.Ye())==null?void 0:e.props;return t?"r"in t?PR(t):{$referring_domain:t.referringDomain,$pathname:t.initialPathName,utm_source:t.utm_source,utm_campaign:t.utm_campaign,utm_medium:t.utm_medium,utm_content:t.utm_content,utm_term:t.utm_term}:{}}getSessionProps(){var e={};return Zr(rE(this.getSetOnceProps()),((t,n)=>{n==="$current_url"&&(n="url"),e["$session_entry_"+Gw(n)]=t})),e}}var Yx=xn("[SessionId]");class xk{on(e,t){return this.tr.on(e,t)}constructor(e,t,n){var s;if(this.ir=[],this.er=void 0,this.tr=new lE,this.rr=(g,x)=>!(!qf(g)||!qf(x))&&Math.abs(g-x)>this.sessionTimeoutMs,!e.persistence)throw new Error("SessionIdManager requires a PostHogPersistence instance");if(e.config.cookieless_mode==="always")throw new Error('SessionIdManager cannot be used with cookieless_mode="always"');this.R=e.config,this.Qe=e.persistence,this.sr=void 0,this.nr=void 0,this._sessionStartTimestamp=null,this._sessionActivityTimestamp=null,this.ar=t||Uc,this.lr=n||Uc;var i=this.R.persistence_name||this.R.token,c=this.R.session_idle_timeout_seconds||1800;if(this._sessionTimeoutMs=1e3*za(c,60,36e3,Yx.createLogger("session_idle_timeout_seconds"),1800),e.register({$configured_session_timeout_ms:this._sessionTimeoutMs}),this.ur(),this.hr="ph_"+i+"_window_id",this.dr="ph_"+i+"_primary_window_exists",this.vr()){var d=ps.W(this.hr),p=ps.W(this.dr);d&&!p?this.sr=d:ps.V(this.hr),ps.G(this.dr,!0)}if((s=this.R.bootstrap)!=null&&s.sessionID)try{var m=(g=>{var x=g.replace(/-/g,"");if(x.length!==32)throw new Error("Not a valid UUID");if(x[12]!=="7")throw new Error("Not a UUIDv7");return parseInt(x.substring(0,12),16)})(this.R.bootstrap.sessionID);this.cr(this.R.bootstrap.sessionID,new Date().getTime(),m)}catch(g){Yx.error("Invalid sessionID in bootstrap",g)}this.pr()}get sessionTimeoutMs(){return this._sessionTimeoutMs}onSessionId(e){return qe(this.ir)&&(this.ir=[]),this.ir.push(e),this.nr&&e(this.nr,this.sr),()=>{this.ir=this.ir.filter((t=>t!==e))}}vr(){return this.R.persistence!=="memory"&&!this.Qe.Pi&&ps.H()}gr(e){e!==this.sr&&(this.sr=e,this.vr()&&ps.G(this.hr,e))}_r(){return this.sr?this.sr:this.vr()?ps.W(this.hr):null}cr(e,t,n){e===this.nr&&t===this._sessionActivityTimestamp&&n===this._sessionStartTimestamp||(this._sessionStartTimestamp=n,this._sessionActivityTimestamp=t,this.nr=e,this.Qe.register({[hy]:[t,e,n]}))}mr(){var e=this.Qe.props[hy];return Fr(e)&&e.length===2&&e.push(e[0]),e||[0,null,0]}resetSessionId(){this.cr(null,null,null)}destroy(){clearTimeout(this.br),this.br=void 0,this.er&&_e&&(_e.removeEventListener("beforeunload",this.er,{capture:!1}),this.er=void 0),this.ir=[]}pr(){this.er=()=>{this.vr()&&ps.V(this.dr)},jn(_e,"beforeunload",this.er,{capture:!1})}checkAndGetSessionAndWindowId(e,t){if(e===void 0&&(e=!1),t===void 0&&(t=null),this.R.cookieless_mode==="always")throw new Error('checkAndGetSessionAndWindowId should not be called with cookieless_mode="always"');var n=t||new Date().getTime(),[s,i,c]=this.mr(),d=this._r(),p=qf(c)&&Math.abs(n-c)>864e5,m=!1,g=!i,x=!g&&!e&&this.rr(n,s);g||x||p?(i=this.ar(),d=this.lr(),Yx.info("new session ID generated",{sessionId:i,windowId:d,changeReason:{noSessionId:g,activityTimeout:x,sessionPastMaximumLength:p}}),c=n,m=!0):d||(d=this.lr(),m=!0);var b=qf(s)&&e&&!p?s:n,E=qf(c)?c:new Date().getTime();return this.gr(d),this.cr(i,b,E),e||this.ur(),m&&this.ir.forEach((T=>T(i,d,m?{noSessionId:g,activityTimeout:x,sessionPastMaximumLength:p}:void 0))),{sessionId:i,windowId:d,sessionStartTimestamp:E,changeReason:m?{noSessionId:g,activityTimeout:x,sessionPastMaximumLength:p}:void 0,lastActivityTimestamp:s}}ur(){clearTimeout(this.br),this.br=setTimeout((()=>{var[e]=this.mr();if(this.rr(new Date().getTime(),e)){var t=this.nr;this.resetSessionId(),this.tr.emit("forcedIdleReset",{idleSessionId:t})}}),1.1*this.sessionTimeoutMs)}}var RH=["$set_once","$set"],Fc=xn("[SiteApps]");class AH{constructor(e){this._instance=e,this.yr=[],this.apps={}}get isEnabled(){return!!this._instance.config.opt_in_site_apps}wr(e,t){if(t){var n=this.globalsForEvent(t);this.yr.push(n),this.yr.length>1e3&&(this.yr=this.yr.slice(10))}}get siteAppLoaders(){var e;return(e=xt._POSTHOG_REMOTE_CONFIG)==null||(e=e[this._instance.config.token])==null?void 0:e.siteApps}init(){if(this.isEnabled){var e=this._instance._addCaptureHook(this.wr.bind(this));this.Er=()=>{e(),this.yr=[],this.Er=void 0}}}globalsForEvent(e){var t,n,s,i,c,d,p;if(!e)throw new Error("Event payload is required");var m={},g=this._instance.get_property("$groups")||[],x=this._instance.get_property("$stored_group_properties")||{};for(var[b,E]of Object.entries(x))m[b]={id:g[b],type:b,properties:E};var{$set_once:T,$set:S}=e;return{event:Qe({},DT(e,RH),{properties:Qe({},e.properties,S?{$set:Qe({},(t=(n=e.properties)==null?void 0:n.$set)!==null&&t!==void 0?t:{},S)}:{},T?{$set_once:Qe({},(s=(i=e.properties)==null?void 0:i.$set_once)!==null&&s!==void 0?s:{},T)}:{}),elements_chain:(c=(d=e.properties)==null?void 0:d.$elements_chain)!==null&&c!==void 0?c:"",distinct_id:(p=e.properties)==null?void 0:p.distinct_id}),person:{properties:this._instance.get_property("$stored_person_properties")},groups:m}}setupSiteApp(e){var t=this.apps[e.id],n=()=>{var d;!t.errored&&this.yr.length&&(Fc.info("Processing "+this.yr.length+" events for site app with id "+e.id),this.yr.forEach((p=>t.processEvent==null?void 0:t.processEvent(p))),t.processedBuffer=!0),Object.values(this.apps).every((p=>p.processedBuffer||p.errored))&&((d=this.Er)==null||d.call(this))},s=!1,i=d=>{t.errored=!d,t.loaded=!0,Fc.info("Site app with id "+e.id+" "+(d?"loaded":"errored")),s&&n()};try{var{processEvent:c}=e.init({posthog:this._instance,callback:d=>{i(d)}});c&&(t.processEvent=c),s=!0}catch(d){Fc.error("Error while initializing PostHog app with config id "+e.id,d),i(!1)}if(s&&t.loaded)try{n()}catch(d){Fc.error("Error while processing buffered events PostHog app with config id "+e.id,d),t.errored=!0}}$r(){var e=this.siteAppLoaders||[];for(var t of e)this.apps[t.id]={id:t.id,loaded:!1,errored:!1,processedBuffer:!1};for(var n of e)this.setupSiteApp(n)}Sr(e){if(Object.keys(this.apps).length!==0){var t=this.globalsForEvent(e);for(var n of Object.values(this.apps))try{n.processEvent==null||n.processEvent(t)}catch(s){Fc.error("Error while processing event "+e.event+" for site app "+n.id,s)}}}onRemoteConfig(e){var t,n,s,i=this;if((t=this.siteAppLoaders)!=null&&t.length)return this.isEnabled?(this.$r(),void this._instance.on("eventCaptured",(m=>this.Sr(m)))):void Fc.error('PostHog site apps are disabled. Enable the "opt_in_site_apps" config to proceed.');if((n=this.Er)==null||n.call(this),(s=e.siteApps)!=null&&s.length)if(this.isEnabled){var c=function(m){var g;xt["__$$ph_site_app_"+m]=i._instance,(g=xt.__PosthogExtensions__)==null||g.loadSiteApp==null||g.loadSiteApp(i._instance,p,(x=>{if(x)return Fc.error("Error while initializing PostHog app with config id "+m,x)}))};for(var{id:d,url:p}of e.siteApps)c(d)}else Fc.error('PostHog site apps are disabled. Enable the "opt_in_site_apps" config to proceed.')}}var HR=function(r,e){if(!r)return!1;var t=r.userAgent;if(t&&RC(t,e))return!0;try{var n=r==null?void 0:r.userAgentData;if(n!=null&&n.brands&&n.brands.some((s=>RC(s==null?void 0:s.brand,e))))return!0}catch{}return!!r.webdriver},vm=(function(r){return r.US="us",r.EU="eu",r.CUSTOM="custom",r})({}),wk="i.posthog.com";class IH{constructor(e){this.kr={},this.instance=e}get apiHost(){var e=this.instance.config.api_host.trim().replace(/\/$/,"");return e==="https://app.posthog.com"?"https://us.i.posthog.com":e}get flagsApiHost(){var e=this.instance.config.flags_api_host;return e?e.trim().replace(/\/$/,""):this.apiHost}get uiHost(){var e,t=(e=this.instance.config.ui_host)==null?void 0:e.replace(/\/$/,"");return t||(t=this.apiHost.replace("."+wk,".posthog.com")),t==="https://app.posthog.com"?"https://us.posthog.com":t}get region(){return this.kr[this.apiHost]||(/https:\/\/(app|us|us-assets)(\.i)?\.posthog\.com/i.test(this.apiHost)?this.kr[this.apiHost]=vm.US:/https:\/\/(eu|eu-assets)(\.i)?\.posthog\.com/i.test(this.apiHost)?this.kr[this.apiHost]=vm.EU:this.kr[this.apiHost]=vm.CUSTOM),this.kr[this.apiHost]}endpointFor(e,t){if(t===void 0&&(t=""),t&&(t=t[0]==="/"?t:"/"+t),e==="ui")return this.uiHost+t;if(e==="flags")return this.flagsApiHost+t;if(this.region===vm.CUSTOM)return this.apiHost+t;var n=wk+t;switch(e){case"assets":return"https://"+this.region+"-assets."+n;case"api":return"https://"+this.region+"."+n}}}var PH={icontains:(r,e)=>!!_e&&e.href.toLowerCase().indexOf(r.toLowerCase())>-1,not_icontains:(r,e)=>!!_e&&e.href.toLowerCase().indexOf(r.toLowerCase())===-1,regex:(r,e)=>!!_e&&Sy(e.href,r),not_regex:(r,e)=>!!_e&&!Sy(e.href,r),exact:(r,e)=>e.href===r,is_not:(r,e)=>e.href!==r};class Is{constructor(e){var t=this;this.getWebExperimentsAndEvaluateDisplayLogic=function(n){n===void 0&&(n=!1),t.getWebExperiments((s=>{Is.Pr("retrieved web experiments from the server"),t.Tr=new Map,s.forEach((i=>{if(i.feature_flag_key){var c;t.Tr&&(Is.Pr("setting flag key ",i.feature_flag_key," to web experiment ",i),(c=t.Tr)==null||c.set(i.feature_flag_key,i));var d=t._instance.getFeatureFlag(i.feature_flag_key);Wn(d)&&i.variants[d]&&t.Ir(i.name,d,i.variants[d].transforms)}else if(i.variants)for(var p in i.variants){var m=i.variants[p];Is.Cr(m)&&t.Ir(i.name,p,m.transforms)}}))}),n)},this._instance=e,this._instance.onFeatureFlags((n=>{this.onFeatureFlags(n)}))}onFeatureFlags(e){if(this._is_bot())Is.Pr("Refusing to render web experiment since the viewer is a likely bot");else if(!this._instance.config.disable_web_experiments){if(fr(this.Tr))return this.Tr=new Map,this.loadIfEnabled(),void this.previewWebExperiment();Is.Pr("applying feature flags",e),e.forEach((t=>{var n;if(this.Tr&&(n=this.Tr)!=null&&n.has(t)){var s,i=this._instance.getFeatureFlag(t),c=(s=this.Tr)==null?void 0:s.get(t);i&&c!=null&&c.variants[i]&&this.Ir(c.name,i,c.variants[i].transforms)}}))}}previewWebExperiment(){var e=Is.getWindowLocation();if(e!=null&&e.search){var t=xy(e==null?void 0:e.search,"__experiment_id"),n=xy(e==null?void 0:e.search,"__experiment_variant");t&&n&&(Is.Pr("previewing web experiments "+t+" && "+n),this.getWebExperiments((s=>{this.Rr(parseInt(t),n,s)}),!1,!0))}}loadIfEnabled(){this._instance.config.disable_web_experiments||this.getWebExperimentsAndEvaluateDisplayLogic()}getWebExperiments(e,t,n){if(this._instance.config.disable_web_experiments&&!n)return e([]);var s=this._instance.get_property("$web_experiments");if(s&&!t)return e(s);this._instance._send_request({url:this._instance.requestRouter.endpointFor("api","/api/web_experiments/?token="+this._instance.config.token),method:"GET",callback:i=>{if(i.statusCode!==200||!i.json)return e([]);var c=i.json.experiments||[];return e(c)}})}Rr(e,t,n){var s=n.filter((i=>i.id===e));s&&s.length>0&&(Is.Pr("Previewing web experiment ["+s[0].name+"] with variant ["+t+"]"),this.Ir(s[0].name,t,s[0].variants[t].transforms))}static Cr(e){return!fr(e.conditions)&&Is.Fr(e)&&Is.Or(e)}static Fr(e){var t;if(fr(e.conditions)||fr((t=e.conditions)==null?void 0:t.url))return!0;var n,s,i,c=Is.getWindowLocation();return!!c&&((n=e.conditions)==null||!n.url||PH[(s=(i=e.conditions)==null?void 0:i.urlMatchType)!==null&&s!==void 0?s:"icontains"](e.conditions.url,c))}static getWindowLocation(){return _e==null?void 0:_e.location}static Or(e){var t;if(fr(e.conditions)||fr((t=e.conditions)==null?void 0:t.utm))return!0;var n=NR();if(n.utm_source){var s,i,c,d,p,m,g,x,b=(s=e.conditions)==null||(s=s.utm)==null||!s.utm_campaign||((i=e.conditions)==null||(i=i.utm)==null?void 0:i.utm_campaign)==n.utm_campaign,E=(c=e.conditions)==null||(c=c.utm)==null||!c.utm_source||((d=e.conditions)==null||(d=d.utm)==null?void 0:d.utm_source)==n.utm_source,T=(p=e.conditions)==null||(p=p.utm)==null||!p.utm_medium||((m=e.conditions)==null||(m=m.utm)==null?void 0:m.utm_medium)==n.utm_medium,S=(g=e.conditions)==null||(g=g.utm)==null||!g.utm_term||((x=e.conditions)==null||(x=x.utm)==null?void 0:x.utm_term)==n.utm_term;return b&&T&&S&&E}return!1}static Pr(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];Xe.info("[WebExperiments] "+e,n)}Ir(e,t,n){this._is_bot()?Is.Pr("Refusing to render web experiment since the viewer is a likely bot"):t!=="control"?n.forEach((s=>{if(s.selector){var i;Is.Pr("applying transform of variant "+t+" for experiment "+e+" ",s);var c=(i=document)==null?void 0:i.querySelectorAll(s.selector);c==null||c.forEach((d=>{var p=d;s.html&&(p.innerHTML=s.html),s.css&&p.setAttribute("style",s.css)}))}})):Is.Pr("Control variants leave the page unmodified.")}_is_bot(){return Xo&&this._instance?HR(Xo,this._instance.config.custom_blocked_useragents):void 0}}var FH=xn("[PostHog ExternalIntegrations]"),jH={intercom:"intercom-integration",crispChat:"crisp-chat-integration"};class OH{constructor(e){this._instance=e}it(e,t){var n;(n=xt.__PosthogExtensions__)==null||n.loadExternalDependency==null||n.loadExternalDependency(this._instance,e,(s=>{if(s)return FH.error("failed to load script",s);t()}))}startIfEnabledOrStop(){var e=this,t=function(c){var d,p,m;!s||(d=xt.__PosthogExtensions__)!=null&&(d=d.integrations)!=null&&d[c]||e.it(jH[c],(()=>{var g;(g=xt.__PosthogExtensions__)==null||(g=g.integrations)==null||(g=g[c])==null||g.start(e._instance)})),!s&&(p=xt.__PosthogExtensions__)!=null&&(p=p.integrations)!=null&&p[c]&&((m=xt.__PosthogExtensions__)==null||(m=m.integrations)==null||(m=m[c])==null||m.stop())};for(var[n,s]of Object.entries((i=this._instance.config.integrations)!==null&&i!==void 0?i:{})){var i;t(n)}}}var db="[SessionRecording]",em=xn(db);class bk{get started(){var e;return!((e=this.Mr)==null||!e.isStarted)}get status(){return this.Mr?this.Mr.status:this.Ar&&!this.jr?"disabled":"lazy_loading"}constructor(e){if(this._forceAllowLocalhostNetworkCapture=!1,this.Ar=!1,this.Dr=void 0,this._instance=e,!this._instance.sessionManager)throw em.error("started without valid sessionManager"),new Error(db+" started without valid sessionManager. This is a bug.");if(this._instance.config.cookieless_mode==="always")throw new Error(db+' cannot be used with cookieless_mode="always"')}get jr(){var e,t=!((e=this._instance.get_property(Ox))==null||!e.enabled),n=!this._instance.config.disable_session_recording,s=this._instance.config.disable_session_recording||this._instance.consent.isOptedOut();return _e&&t&&n&&!s}startIfEnabledOrStop(e){var t;if(!this.jr||(t=this.Mr)==null||!t.isStarted){var n=!qe(Object.assign)&&!qe(Array.from);this.jr&&n?(this.Lr(e),em.info("starting")):this.stopRecording()}}Lr(e){var t,n,s;this.jr&&(xt!=null&&(t=xt.__PosthogExtensions__)!=null&&(t=t.rrweb)!=null&&t.record&&(n=xt.__PosthogExtensions__)!=null&&n.initSessionRecording?this.Nr(e):(s=xt.__PosthogExtensions__)==null||s.loadExternalDependency==null||s.loadExternalDependency(this._instance,this.Ur,(i=>{if(i)return em.error("could not load recorder",i);this.Nr(e)})))}stopRecording(){var e,t;(e=this.Dr)==null||e.call(this),this.Dr=void 0,(t=this.Mr)==null||t.stop()}zr(){var e;(e=this._instance.persistence)==null||e.unregister(lR)}Hr(e){if(this._instance.persistence){var t,n,s=this._instance.persistence,i=()=>{var c=e.sessionRecording===!1?void 0:e.sessionRecording,d=c==null?void 0:c.sampleRate,p=fr(d)?null:parseFloat(d);fr(p)&&this.zr();var m=c==null?void 0:c.minimumDurationMilliseconds;s.register({[Ox]:Qe({cache_timestamp:Date.now(),enabled:!!c},c,{networkPayloadCapture:Qe({capturePerformance:e.capturePerformance},c==null?void 0:c.networkPayloadCapture),canvasRecording:{enabled:c==null?void 0:c.recordCanvas,fps:c==null?void 0:c.canvasFps,quality:c==null?void 0:c.canvasQuality},sampleRate:p,minimumDurationMilliseconds:qe(m)?null:m,endpoint:c==null?void 0:c.endpoint,triggerMatchType:c==null?void 0:c.triggerMatchType,masking:c==null?void 0:c.masking,urlTriggers:c==null?void 0:c.urlTriggers})})};i(),(t=this.Dr)==null||t.call(this),this.Dr=(n=this._instance.sessionManager)==null?void 0:n.onSessionId(i)}}onRemoteConfig(e){"sessionRecording"in e?e.sessionRecording!==!1?(this.Hr(e),this.Ar=!0,this.startIfEnabledOrStop()):this.Ar=!0:em.info("skipping remote config with no sessionRecording",e)}log(e,t){var n;t===void 0&&(t="log"),(n=this.Mr)!=null&&n.log?this.Mr.log(e,t):em.warn("log called before recorder was ready")}get Ur(){var e,t,n=(e=this._instance)==null||(e=e.persistence)==null?void 0:e.get_property(Ox);return(n==null||(t=n.scriptConfig)==null?void 0:t.script)||"lazy-recorder"}Nr(e){var t,n;if((t=xt.__PosthogExtensions__)==null||!t.initSessionRecording)throw Error("Called on script loaded before session recording is available");this.Mr||(this.Mr=(n=xt.__PosthogExtensions__)==null?void 0:n.initSessionRecording(this._instance),this.Mr._forceAllowLocalhostNetworkCapture=this._forceAllowLocalhostNetworkCapture),this.Mr.start(e)}onRRwebEmit(e){var t;(t=this.Mr)==null||t.onRRwebEmit==null||t.onRRwebEmit(e)}overrideLinkedFlag(){var e,t;this.Mr||(t=this._instance.persistence)==null||t.register({$replay_override_linked_flag:!0}),(e=this.Mr)==null||e.overrideLinkedFlag()}overrideSampling(){var e,t;this.Mr||(t=this._instance.persistence)==null||t.register({$replay_override_sampling:!0}),(e=this.Mr)==null||e.overrideSampling()}overrideTrigger(e){var t,n;this.Mr||(n=this._instance.persistence)==null||n.register({[e==="url"?"$replay_override_url_trigger":"$replay_override_event_trigger"]:!0}),(t=this.Mr)==null||t.overrideTrigger(e)}get sdkDebugProperties(){var e;return((e=this.Mr)==null?void 0:e.sdkDebugProperties)||{$recording_status:this.status}}tryAddCustomEvent(e,t){var n;return!((n=this.Mr)==null||!n.tryAddCustomEvent(e,t))}}var Sm={},fb=()=>{},Kf="posthog",BR=!iH&&(So==null?void 0:So.indexOf("MSIE"))===-1&&(So==null?void 0:So.indexOf("Mozilla"))===-1,_k=r=>{var e;return Qe({api_host:"https://us.i.posthog.com",flags_api_host:null,ui_host:null,token:"",autocapture:!0,cross_subdomain_cookie:dz(Ve==null?void 0:Ve.location),persistence:"localStorage+cookie",persistence_name:"",cookie_persisted_properties:[],loaded:fb,save_campaign_params:!0,custom_campaign_params:[],custom_blocked_useragents:[],save_referrer:!0,capture_pageleave:"if_capture_pageview",defaults:r??"unset",__preview_deferred_init_extensions:!1,debug:gs&&Wn(gs==null?void 0:gs.search)&&gs.search.indexOf("__posthog_debug=true")!==-1||!1,cookie_expiration:365,upgrade:!1,disable_session_recording:!1,disable_persistence:!1,disable_web_experiments:!0,disable_surveys:!1,disable_surveys_automatic_display:!1,disable_conversations:!1,disable_product_tours:!0,disable_external_dependency_loading:!1,enable_recording_console_log:void 0,secure_cookie:(_e==null||(e=_e.location)==null?void 0:e.protocol)==="https:",ip:!1,opt_out_capturing_by_default:!1,opt_out_persistence_by_default:!1,opt_out_useragent_filter:!1,opt_out_capturing_persistence_type:"localStorage",consent_persistence_name:null,opt_out_capturing_cookie_prefix:null,opt_in_site_apps:!1,property_denylist:[],respect_dnt:!1,sanitize_properties:null,request_headers:{},request_batching:!0,properties_string_max_length:65535,mask_all_element_attributes:!1,mask_all_text:!1,mask_personal_data_properties:!1,custom_personal_data_properties:[],advanced_disable_flags:!1,advanced_disable_decide:!1,advanced_disable_feature_flags:!1,advanced_disable_feature_flags_on_first_load:!1,advanced_only_evaluate_survey_feature_flags:!1,advanced_enable_surveys:!1,advanced_disable_toolbar_metrics:!1,feature_flag_request_timeout_ms:3e3,surveys_request_timeout_ms:1e4,on_request_error:t=>{var n="Bad HTTP status: "+t.statusCode+" "+t.text;Xe.error(n)},get_device_id:t=>t,capture_performance:void 0,name:"posthog",bootstrap:{},disable_compression:!1,session_idle_timeout_seconds:1800,person_profiles:"identified_only",before_send:void 0,request_queue_config:{flush_interval_ms:ub},error_tracking:{},_onCapture:fb,__preview_eager_load_replay:!1},(t=>({rageclick:!(t&&t>="2025-11-30")||{content_ignorelist:!0},capture_pageview:!(t&&t>="2025-05-24")||"history_change",session_recording:t&&t>="2025-11-30"?{strictMinimumDuration:!0}:{},external_scripts_inject_target:t&&t>="2026-01-30"?"head":"body",internal_or_test_user_hostname:t&&t>="2026-01-30"?/^(localhost|127\.0\.0\.1)$/:void 0}))(r))},Ek=r=>{var e={};qe(r.process_person)||(e.person_profiles=r.process_person),qe(r.xhr_headers)||(e.request_headers=r.xhr_headers),qe(r.cookie_name)||(e.persistence_name=r.cookie_name),qe(r.disable_cookie)||(e.disable_persistence=r.disable_cookie),qe(r.store_google)||(e.save_campaign_params=r.store_google),qe(r.verbose)||(e.debug=r.verbose);var t=kn({},e,r);return Fr(r.property_blacklist)&&(qe(r.property_denylist)?t.property_denylist=r.property_blacklist:Fr(r.property_denylist)?t.property_denylist=[...r.property_blacklist,...r.property_denylist]:Xe.error("Invalid value for property_denylist config: "+r.property_denylist)),t};class DH{constructor(){this.__forceAllowLocalhost=!1}get Br(){return this.__forceAllowLocalhost}set Br(e){Xe.error("WebPerformanceObserver is deprecated and has no impact on network capture. Use `_forceAllowLocalhostNetworkCapture` on `posthog.sessionRecording`"),this.__forceAllowLocalhost=e}}class Xy{get decideEndpointWasHit(){var e,t;return(e=(t=this.featureFlags)==null?void 0:t.hasLoadedFlags)!==null&&e!==void 0&&e}get flagsEndpointWasHit(){var e,t;return(e=(t=this.featureFlags)==null?void 0:t.hasLoadedFlags)!==null&&e!==void 0&&e}constructor(){this.webPerformance=new DH,this.qr=!1,this.version=Fl.LIB_VERSION,this.bi=new lE,this._calculate_event_properties=this.calculateEventProperties.bind(this),this.config=_k(),this.SentryIntegration=Uz,this.sentryIntegration=e=>(function(t,n){var s=kR(t,n);return{name:CR,processEvent:i=>s(i)}})(this,e),this.__request_queue=[],this.__loaded=!1,this.analyticsDefaultEndpoint="/e/",this.Wr=!1,this.Gr=null,this.Vr=null,this.Jr=null,this.featureFlags=new uH(this),this.toolbar=new Hz(this),this.scrollManager=new NH(this),this.pageViewManager=new sk(this),this.surveys=new xH(this),this.conversations=new wH(this),this.logs=new bH(this),this.experiments=new Is(this),this.exceptions=new aH(this),this.rateLimiter=new _H(this),this.requestRouter=new IH(this),this.consent=new jz(this),this.externalIntegrations=new OH(this),this.people={set:(e,t,n)=>{var s=Wn(e)?{[e]:t}:e;this.setPersonProperties(s),n==null||n({})},set_once:(e,t,n)=>{var s=Wn(e)?{[e]:t}:e;this.setPersonProperties(void 0,s),n==null||n({})}},this.on("eventCaptured",(e=>Xe.info('send "'+(e==null?void 0:e.event)+'"',e)))}init(e,t,n){if(n&&n!==Kf){var s,i=(s=Sm[n])!==null&&s!==void 0?s:new Xy;return i._init(e,t,n),Sm[n]=i,Sm[Kf][n]=i,i}return this._init(e,t,n)}_init(e,t,n){var s;if(t===void 0&&(t={}),qe(e)||Ww(e))return Xe.critical("PostHog was initialized without a token. This likely indicates a misconfiguration. Please check the first argument passed to posthog.init()"),this;if(this.__loaded)return console.warn("[PostHog.js]","You have already initialized PostHog! Re-initializing is a no-op"),this;this.__loaded=!0,this.config={},t.debug=this.Kr(t.debug),this.Yr=t,this.Xr=[],t.person_profiles&&(this.Vr=t.person_profiles),this.set_config(kn({},_k(t.defaults),Ek(t),{name:n,token:e})),this.config.on_xhr_error&&Xe.error("on_xhr_error is deprecated. Use on_request_error instead"),this.compression=t.disable_compression?void 0:Dl.GZipJS;var i=this.Qr();this.persistence=new Wx(this.config,i),this.sessionPersistence=this.config.persistence==="sessionStorage"||this.config.persistence==="memory"?this.persistence:new Wx(Qe({},this.config,{persistence:"sessionStorage"}),i);var c=Qe({},this.persistence.props),d=Qe({},this.sessionPersistence.props);this.register({$initialization_time:new Date().toISOString()}),this.Zr=new SH((A=>this.ts(A)),this.config.request_queue_config),this.es=new kH(this),this.__request_queue=[];var p=this.config.cookieless_mode==="always"||this.config.cookieless_mode==="on_reject"&&this.consent.isExplicitlyOptedOut();if(p||(this.sessionManager=new xk(this),this.sessionPropsManager=new yk(this,this.sessionManager,this.persistence)),this.config.__preview_deferred_init_extensions?(Xe.info("Deferring extension initialization to improve startup performance"),setTimeout((()=>{this.rs(p)}),0)):(Xe.info("Initializing extensions synchronously"),this.rs(p)),Fl.DEBUG=Fl.DEBUG||this.config.debug,Fl.DEBUG&&Xe.info("Starting in debug mode",{this:this,config:t,thisC:Qe({},this.config),p:c,s:d}),((s=t.bootstrap)==null?void 0:s.distinctID)!==void 0){var m,g,x=this.config.get_device_id(Uc()),b=(m=t.bootstrap)!=null&&m.isIdentifiedID?x:t.bootstrap.distinctID;this.persistence.set_property(jl,(g=t.bootstrap)!=null&&g.isIdentifiedID?"identified":"anonymous"),this.register({distinct_id:t.bootstrap.distinctID,$device_id:b})}if(this.ss()){var E,T,S=Object.keys(((E=t.bootstrap)==null?void 0:E.featureFlags)||{}).filter((A=>{var j;return!((j=t.bootstrap)==null||(j=j.featureFlags)==null||!j[A])})).reduce(((A,j)=>{var P;return A[j]=((P=t.bootstrap)==null||(P=P.featureFlags)==null?void 0:P[j])||!1,A}),{}),N=Object.keys(((T=t.bootstrap)==null?void 0:T.featureFlagPayloads)||{}).filter((A=>S[A])).reduce(((A,j)=>{var P,$;return(P=t.bootstrap)!=null&&(P=P.featureFlagPayloads)!=null&&P[j]&&(A[j]=($=t.bootstrap)==null||($=$.featureFlagPayloads)==null?void 0:$[j]),A}),{});this.featureFlags.receivedFeatureFlags({featureFlags:S,featureFlagPayloads:N})}if(p)this.register_once({distinct_id:Vp,$device_id:null},"");else if(!this.get_distinct_id()){var R=this.config.get_device_id(Uc());this.register_once({distinct_id:R,$device_id:R},""),this.persistence.set_property(jl,"anonymous")}return jn(_e,"onpagehide"in self?"pagehide":"unload",this._handle_unload.bind(this),{passive:!1}),this.toolbar.maybeLoadToolbar(),t.segment?$z(this,(()=>this.ns())):this.ns(),Hc(this.config._onCapture)&&this.config._onCapture!==fb&&(Xe.warn("onCapture is deprecated. Please use `before_send` instead"),this.on("eventCaptured",(A=>this.config._onCapture(A.event,A)))),this.config.ip&&Xe.warn('The `ip` config option has NO EFFECT AT ALL and has been deprecated. Use a custom transformation or "Discard IP data" project setting instead. See https://posthog.com/tutorials/web-redact-properties#hiding-customer-ip-address for more information.'),this}rs(e){var t=performance.now();this.historyAutocapture=new Mz(this),this.historyAutocapture.startIfEnabled();var n=[];n.push((()=>{new Gz(this).startIfEnabledOrStop()})),n.push((()=>{var s;this.siteApps=new AH(this),(s=this.siteApps)==null||s.init()})),e||n.push((()=>{this.sessionRecording=new bk(this),this.sessionRecording.startIfEnabledOrStop()})),this.config.disable_scroll_properties||n.push((()=>{this.scrollManager.startMeasuringScrollPosition()})),n.push((()=>{this.autocapture=new kz(this),this.autocapture.startIfEnabled()})),n.push((()=>{this.surveys.loadIfEnabled()})),n.push((()=>{this.logs.loadIfEnabled()})),n.push((()=>{this.conversations.loadIfEnabled()})),n.push((()=>{this.productTours=new fH(this),this.productTours.loadIfEnabled()})),n.push((()=>{this.heatmaps=new Xz(this),this.heatmaps.startIfEnabled()})),n.push((()=>{this.webVitalsAutocapture=new Yz(this)})),n.push((()=>{this.exceptionObserver=new Lz(this),this.exceptionObserver.startIfEnabledOrStop()})),n.push((()=>{this.deadClicksAutocapture=new SR(this,Dz),this.deadClicksAutocapture.startIfEnabled()})),n.push((()=>{if(this.os){var s=this.os;this.os=void 0,this.wi(s)}})),this.ls(n,t)}ls(e,t){for(;e.length>0;){if(this.config.__preview_deferred_init_extensions&&performance.now()-t>=30&&e.length>0)return void setTimeout((()=>{this.ls(e,t)}),0);var n=e.shift();if(n)try{n()}catch(i){Xe.error("Error initializing extension:",i)}}var s=Math.round(performance.now()-t);this.register_for_session({$sdk_debug_extensions_init_method:this.config.__preview_deferred_init_extensions?"deferred":"synchronous",$sdk_debug_extensions_init_time_ms:s}),this.config.__preview_deferred_init_extensions&&Xe.info("PostHog extensions initialized ("+s+"ms)")}wi(e){var t,n,s,i,c,d,p,m,g;if(!Ve||!Ve.body)return Xe.info("document not ready yet, trying again in 500 milliseconds..."),void setTimeout((()=>{this.wi(e)}),500);this.config.__preview_deferred_init_extensions&&(this.os=e),this.compression=void 0,e.supportedCompression&&!this.config.disable_compression&&(this.compression=ur(e.supportedCompression,Dl.GZipJS)?Dl.GZipJS:ur(e.supportedCompression,Dl.Base64)?Dl.Base64:void 0),(t=e.analytics)!=null&&t.endpoint&&(this.analyticsDefaultEndpoint=e.analytics.endpoint),this.set_config({person_profiles:this.Vr?this.Vr:"identified_only"}),(n=this.siteApps)==null||n.onRemoteConfig(e),(s=this.sessionRecording)==null||s.onRemoteConfig(e),(i=this.autocapture)==null||i.onRemoteConfig(e),(c=this.heatmaps)==null||c.onRemoteConfig(e),this.surveys.onRemoteConfig(e),this.logs.onRemoteConfig(e),this.conversations.onRemoteConfig(e),(d=this.productTours)==null||d.onRemoteConfig(e),(p=this.webVitalsAutocapture)==null||p.onRemoteConfig(e),(m=this.exceptionObserver)==null||m.onRemoteConfig(e),this.exceptions.onRemoteConfig(e),(g=this.deadClicksAutocapture)==null||g.onRemoteConfig(e)}ns(){try{this.config.loaded(this)}catch(n){Xe.critical("`loaded` function failed",n)}if(this.us(),this.config.internal_or_test_user_hostname&&gs!=null&&gs.hostname){var e=gs.hostname,t=this.config.internal_or_test_user_hostname;(typeof t=="string"?e===t:t.test(e))&&this.setInternalOrTestUser()}this.config.capture_pageview&&setTimeout((()=>{(this.consent.isOptedIn()||this.config.cookieless_mode==="always")&&this.hs()}),1),new EH(this).load(),this.featureFlags.flags()}us(){var e;this.is_capturing()&&this.config.request_batching&&((e=this.Zr)==null||e.enable())}_dom_loaded(){this.is_capturing()&&Bc(this.__request_queue,(e=>this.ts(e))),this.__request_queue=[],this.us()}_handle_unload(){var e,t;this.surveys.handlePageUnload(),this.config.request_batching?(this.ds()&&this.capture("$pageleave"),(e=this.Zr)==null||e.unload(),(t=this.es)==null||t.unload()):this.ds()&&this.capture("$pageleave",null,{transport:"sendBeacon"})}_send_request(e){this.__loaded&&(BR?this.__request_queue.push(e):this.rateLimiter.isServerRateLimited(e.batchKey)||(e.transport=e.transport||this.config.api_transport,e.url=Ey(e.url,{ip:this.config.ip?1:0}),e.headers=Qe({},this.config.request_headers,e.headers),e.compression=e.compression==="best-available"?this.compression:e.compression,e.disableXHRCredentials=this.config.__preview_disable_xhr_credentials,this.config.__preview_disable_beacon&&(e.disableTransport=["sendBeacon"]),e.fetchOptions=e.fetchOptions||this.config.fetch_options,(t=>{var n,s,i,c=Qe({},t);c.timeout=c.timeout||6e4,c.url=Ey(c.url,{_:new Date().getTime().toString(),ver:Fl.LIB_VERSION,compression:c.compression});var d=(n=c.transport)!==null&&n!==void 0?n:"fetch",p=Xv.filter((g=>!c.disableTransport||!g.transport||!c.disableTransport.includes(g.transport))),m=(s=(i=oR(p,(g=>g.transport===d)))==null?void 0:i.method)!==null&&s!==void 0?s:p[0].method;if(!m)throw new Error("No available transport method");m(c)})(Qe({},e,{callback:t=>{var n,s;this.rateLimiter.checkForLimiting(t),t.statusCode>=400&&((n=(s=this.config).on_request_error)==null||n.call(s,t)),e.callback==null||e.callback(t)}}))))}ts(e){this.es?this.es.retriableRequest(e):this._send_request(e)}_execute_array(e){var t,n=[],s=[],i=[];Bc(e,(d=>{d&&(t=d[0],Fr(t)?i.push(d):Hc(d)?d.call(this):Fr(d)&&t==="alias"?n.push(d):Fr(d)&&t.indexOf("capture")!==-1&&Hc(this[t])?i.push(d):s.push(d))}));var c=function(d,p){Bc(d,(function(m){if(Fr(m[0])){var g=p;Zr(m,(function(x){g=g[x[0]].apply(g,x.slice(1))}))}else this[m[0]].apply(this,m.slice(1))}),p)};c(n,this),c(s,this),c(i,this)}ss(){var e,t;return((e=this.config.bootstrap)==null?void 0:e.featureFlags)&&Object.keys((t=this.config.bootstrap)==null?void 0:t.featureFlags).length>0||!1}push(e){this._execute_array([e])}capture(e,t,n){var s;if(this.__loaded&&this.persistence&&this.sessionPersistence&&this.Zr){if(this.is_capturing())if(!qe(e)&&Wn(e)){var i=!this.config.opt_out_useragent_filter&&this._is_bot();if(!(i&&!this.config.__preview_capture_bot_pageviews)){var c=n!=null&&n.skip_client_rate_limiting?void 0:this.rateLimiter.clientRateLimitContext();if(c==null||!c.isRateLimited){t!=null&&t.$current_url&&!Wn(t==null?void 0:t.$current_url)&&(Xe.error("Invalid `$current_url` property provided to `posthog.capture`. Input must be a string. Ignoring provided value."),t==null||delete t.$current_url),this.sessionPersistence.update_search_keyword(),this.config.save_campaign_params&&this.sessionPersistence.update_campaign_params(),this.config.save_referrer&&this.sessionPersistence.update_referrer_info(),(this.config.save_campaign_params||this.config.save_referrer)&&this.persistence.set_initial_person_info();var d=new Date,p=(n==null?void 0:n.timestamp)||d,m=Uc(),g={uuid:m,event:e,properties:this.calculateEventProperties(e,t||{},p,m)};e==="$pageview"&&this.config.__preview_capture_bot_pageviews&&i&&(g.event="$bot_pageview",g.properties.$browser_type="bot"),c&&(g.properties.$lib_rate_limit_remaining_tokens=c.remainingTokens),n!=null&&n.$set&&(g.$set=n==null?void 0:n.$set);var x,b=e!=="$groupidentify",E=this.vs(n==null?void 0:n.$set_once,b);if(E&&(g.$set_once=E),(g=cz(g,n!=null&&n._noTruncate?null:this.config.properties_string_max_length)).timestamp=p,qe(n==null?void 0:n.timestamp)||(g.properties.$event_time_override_provided=!0,g.properties.$event_time_override_system_time=d),e===gm.DISMISSED||e===gm.SENT){var T=t==null?void 0:t[Kx.SURVEY_ID],S=t==null?void 0:t[Kx.SURVEY_ITERATION];x={id:T,current_iteration:S},localStorage.getItem(gk(x))||localStorage.setItem(gk(x),"true"),g.$set=Qe({},g.$set,{[hH({id:T,current_iteration:S},e===gm.SENT?"responded":"dismissed")]:!0})}else e===gm.SHOWN&&(g.$set=Qe({},g.$set,{[Kx.SURVEY_LAST_SEEN_DATE]:new Date().toISOString()}));var N=Qe({},g.properties.$set,g.$set);if(Xf(N)||this.setPersonPropertiesForFlags(N),!fr(this.config.before_send)){var R=this.cs(g);if(!R)return;g=R}this.bi.emit("eventCaptured",g);var A={method:"POST",url:(s=n==null?void 0:n._url)!==null&&s!==void 0?s:this.requestRouter.endpointFor("api",this.analyticsDefaultEndpoint),data:g,compression:"best-available",batchKey:n==null?void 0:n._batchKey};return!this.config.request_batching||n&&(n==null||!n._batchKey)||n!=null&&n.send_instantly?this.ts(A):this.Zr.enqueue(A),g}Xe.critical("This capture call is ignored due to client rate limiting.")}}else Xe.error("No event name provided to posthog.capture")}else Xe.uninitializedWarning("posthog.capture")}_addCaptureHook(e){return this.on("eventCaptured",(t=>e(t.event,t)))}calculateEventProperties(e,t,n,s,i){if(n=n||new Date,!this.persistence||!this.sessionPersistence)return t;var c=i?void 0:this.persistence.remove_event_timer(e),d=Qe({},t);if(d.token=this.config.token,d.$config_defaults=this.config.defaults,(this.config.cookieless_mode=="always"||this.config.cookieless_mode=="on_reject"&&this.consent.isExplicitlyOptedOut())&&(d.$cookieless_mode=!0),e==="$snapshot"){var p=Qe({},this.persistence.properties(),this.sessionPersistence.properties());return d.distinct_id=p.distinct_id,(!Wn(d.distinct_id)&&!zl(d.distinct_id)||Ww(d.distinct_id))&&Xe.error("Invalid distinct_id for replay event. This indicates a bug in your implementation"),d}var m,g=Kz(this.config.mask_personal_data_properties,this.config.custom_personal_data_properties);if(this.sessionManager){var{sessionId:x,windowId:b}=this.sessionManager.checkAndGetSessionAndWindowId(i,n.getTime());d.$session_id=x,d.$window_id=b}this.sessionPropsManager&&kn(d,this.sessionPropsManager.getSessionProps());try{var E;this.sessionRecording&&kn(d,this.sessionRecording.sdkDebugProperties),d.$sdk_debug_retry_queue_size=(E=this.es)==null?void 0:E.length}catch(R){d.$sdk_debug_error_capturing_properties=String(R)}if(this.requestRouter.region===vm.CUSTOM&&(d.$lib_custom_api_host=this.config.api_host),m=e!=="$pageview"||i?e!=="$pageleave"||i?this.pageViewManager.doEvent():this.pageViewManager.doPageLeave(n):this.pageViewManager.doPageView(n,s),d=kn(d,m),e==="$pageview"&&Ve&&(d.title=Ve.title),!qe(c)){var T=n.getTime()-c;d.$duration=parseFloat((T/1e3).toFixed(3))}So&&this.config.opt_out_useragent_filter&&(d.$browser_type=this._is_bot()?"bot":"browser"),(d=kn({},g,this.persistence.properties(),this.sessionPersistence.properties(),d)).$is_identified=this._isIdentified(),Fr(this.config.property_denylist)?Zr(this.config.property_denylist,(function(R){delete d[R]})):Xe.error("Invalid value for property_denylist config: "+this.config.property_denylist+" or property_blacklist config: "+this.config.property_blacklist);var S=this.config.sanitize_properties;S&&(Xe.error("sanitize_properties is deprecated. Use before_send instead"),d=S(d,e));var N=this.fs();return d.$process_person_profile=N,N&&!i&&this.ps("_calculate_event_properties"),d}vs(e,t){var n;if(t===void 0&&(t=!0),!this.persistence||!this.fs()||this.qr)return e;var s=this.persistence.get_initial_props(),i=(n=this.sessionPropsManager)==null?void 0:n.getSetOnceProps(),c=kn({},s,i||{},e||{}),d=this.config.sanitize_properties;return d&&(Xe.error("sanitize_properties is deprecated. Use before_send instead"),c=d(c,"$set_once")),t&&(this.qr=!0),Xf(c)?void 0:c}register(e,t){var n;(n=this.persistence)==null||n.register(e,t)}register_once(e,t,n){var s;(s=this.persistence)==null||s.register_once(e,t,n)}register_for_session(e){var t;(t=this.sessionPersistence)==null||t.register(e)}unregister(e){var t;(t=this.persistence)==null||t.unregister(e)}unregister_for_session(e){var t;(t=this.sessionPersistence)==null||t.unregister(e)}gs(e,t){this.register({[e]:t})}getFeatureFlag(e,t){return this.featureFlags.getFeatureFlag(e,t)}getFeatureFlagPayload(e){return this.featureFlags.getFeatureFlagPayload(e)}getFeatureFlagResult(e,t){return this.featureFlags.getFeatureFlagResult(e,t)}isFeatureEnabled(e,t){return this.featureFlags.isFeatureEnabled(e,t)}reloadFeatureFlags(){this.featureFlags.reloadFeatureFlags()}updateFlags(e,t,n){var s=n!=null&&n.merge?this.featureFlags.getFlagVariants():{},i=n!=null&&n.merge?this.featureFlags.getFlagPayloads():{},c=Qe({},s,e),d=Qe({},i,t),p={};for(var[m,g]of Object.entries(c)){var x=typeof g=="string";p[m]={key:m,enabled:!!x||!!g,variant:x?g:void 0,reason:void 0,metadata:qe(d==null?void 0:d[m])?void 0:{id:0,version:void 0,description:void 0,payload:d[m]}}}this.featureFlags.receivedFeatureFlags({flags:p})}updateEarlyAccessFeatureEnrollment(e,t,n){this.featureFlags.updateEarlyAccessFeatureEnrollment(e,t,n)}getEarlyAccessFeatures(e,t,n){return t===void 0&&(t=!1),this.featureFlags.getEarlyAccessFeatures(e,t,n)}on(e,t){return this.bi.on(e,t)}onFeatureFlags(e){return this.featureFlags.onFeatureFlags(e)}onSurveysLoaded(e){return this.surveys.onSurveysLoaded(e)}onSessionId(e){var t,n;return(t=(n=this.sessionManager)==null?void 0:n.onSessionId(e))!==null&&t!==void 0?t:()=>{}}getSurveys(e,t){t===void 0&&(t=!1),this.surveys.getSurveys(e,t)}getActiveMatchingSurveys(e,t){t===void 0&&(t=!1),this.surveys.getActiveMatchingSurveys(e,t)}renderSurvey(e,t){this.surveys.renderSurvey(e,t)}displaySurvey(e,t){t===void 0&&(t=mH),this.surveys.displaySurvey(e,t)}cancelPendingSurvey(e){this.surveys.cancelPendingSurvey(e)}canRenderSurvey(e){return this.surveys.canRenderSurvey(e)}canRenderSurveyAsync(e,t){return t===void 0&&(t=!1),this.surveys.canRenderSurveyAsync(e,t)}identify(e,t,n){if(!this.__loaded||!this.persistence)return Xe.uninitializedWarning("posthog.identify");if(zl(e)&&(e=e.toString(),Xe.warn("The first argument to posthog.identify was a number, but it should be a string. It has been converted to a string.")),e)if(["distinct_id","distinctid"].includes(e.toLowerCase()))Xe.critical('The string "'+e+'" was set in posthog.identify which indicates an error. This ID should be unique to the user and not a hardcoded string.');else if(e!==Vp){if(this.ps("posthog.identify")){var s=this.get_distinct_id();if(this.register({$user_id:e}),!this.get_property("$device_id")){var i=s;this.register_once({$had_persisted_distinct_id:!0,$device_id:i},"")}e!==s&&e!==this.get_property(dm)&&(this.unregister(dm),this.register({distinct_id:e}));var c=(this.persistence.get_property(jl)||"anonymous")==="anonymous";e!==s&&c?(this.persistence.set_property(jl,"identified"),this.setPersonPropertiesForFlags(Qe({},n||{},t||{}),!1),this.capture("$identify",{distinct_id:e,$anon_distinct_id:s},{$set:t||{},$set_once:n||{}}),this.Jr=uk(e,t,n),this.featureFlags.setAnonymousDistinctId(s)):(t||n)&&this.setPersonProperties(t,n),e!==s&&(this.reloadFeatureFlags(),this.unregister(py))}}else Xe.critical('The string "'+Vp+'" was set in posthog.identify which indicates an error. This ID is only used as a sentinel value.');else Xe.error("Unique user id has not been set in posthog.identify")}setPersonProperties(e,t){if((e||t)&&this.ps("posthog.setPersonProperties")){var n=uk(this.get_distinct_id(),e,t);this.Jr!==n?(this.setPersonPropertiesForFlags(Qe({},t||{},e||{})),this.capture("$set",{$set:e||{},$set_once:t||{}}),this.Jr=n):Xe.info("A duplicate setPersonProperties call was made with the same properties. It has been ignored.")}}group(e,t,n){if(e&&t){var s=this.getGroups();s[e]!==t&&this.resetGroupPropertiesForFlags(e),this.register({$groups:Qe({},s,{[e]:t})}),n&&(this.capture("$groupidentify",{$group_type:e,$group_key:t,$group_set:n}),this.setGroupPropertiesForFlags({[e]:n})),s[e]===t||n||this.reloadFeatureFlags()}else Xe.error("posthog.group requires a group type and group key")}resetGroups(){this.register({$groups:{}}),this.resetGroupPropertiesForFlags(),this.reloadFeatureFlags()}setPersonPropertiesForFlags(e,t){t===void 0&&(t=!0),this.featureFlags.setPersonPropertiesForFlags(e,t)}resetPersonPropertiesForFlags(){this.featureFlags.resetPersonPropertiesForFlags()}setGroupPropertiesForFlags(e,t){t===void 0&&(t=!0),this.ps("posthog.setGroupPropertiesForFlags")&&this.featureFlags.setGroupPropertiesForFlags(e,t)}resetGroupPropertiesForFlags(e){this.featureFlags.resetGroupPropertiesForFlags(e)}reset(e){var t,n,s,i;if(Xe.info("reset"),!this.__loaded)return Xe.uninitializedWarning("posthog.reset");var c=this.get_property("$device_id");if(this.consent.reset(),(t=this.persistence)==null||t.clear(),(n=this.sessionPersistence)==null||n.clear(),this.surveys.reset(),this.featureFlags.reset(),(s=this.persistence)==null||s.set_property(jl,"anonymous"),(i=this.sessionManager)==null||i.resetSessionId(),this.Jr=null,this.config.cookieless_mode==="always")this.register_once({distinct_id:Vp,$device_id:null},"");else{var d=this.config.get_device_id(Uc());this.register_once({distinct_id:d,$device_id:e?d:c},"")}this.register({$last_posthog_reset:new Date().toISOString()},1)}get_distinct_id(){return this.get_property("distinct_id")}getGroups(){return this.get_property("$groups")||{}}get_session_id(){var e,t;return(e=(t=this.sessionManager)==null?void 0:t.checkAndGetSessionAndWindowId(!0).sessionId)!==null&&e!==void 0?e:""}get_session_replay_url(e){if(!this.sessionManager)return"";var{sessionId:t,sessionStartTimestamp:n}=this.sessionManager.checkAndGetSessionAndWindowId(!0),s=this.requestRouter.endpointFor("ui","/project/"+this.config.token+"/replay/"+t);if(e!=null&&e.withTimestamp&&n){var i,c=(i=e.timestampLookBack)!==null&&i!==void 0?i:10;if(!n)return s;s+="?t="+Math.max(Math.floor((new Date().getTime()-n)/1e3)-c,0)}return s}alias(e,t){return e===this.get_property(iR)?(Xe.critical("Attempting to create alias for existing People user - aborting."),-2):this.ps("posthog.alias")?(qe(t)&&(t=this.get_distinct_id()),e!==t?(this.gs(dm,e),this.capture("$create_alias",{alias:e,distinct_id:t})):(Xe.warn("alias matches current distinct_id - skipping api call."),this.identify(e),-1)):void 0}set_config(e){var t=Qe({},this.config);if(Gn(e)){var n,s,i,c,d,p,m;kn(this.config,Ek(e));var g=this.Qr();(n=this.persistence)==null||n.update_config(this.config,t,g),this.sessionPersistence=this.config.persistence==="sessionStorage"||this.config.persistence==="memory"?this.persistence:new Wx(Qe({},this.config,{persistence:"sessionStorage"}),g);var x=this.Kr(this.config.debug);$l(x)&&(this.config.debug=x),$l(this.config.debug)&&(this.config.debug?(Fl.DEBUG=!0,pn.H()&&pn.G("ph_debug","true"),Xe.info("set_config",{config:e,oldConfig:t,newConfig:Qe({},this.config)})):(Fl.DEBUG=!1,pn.H()&&pn.V("ph_debug"))),(s=this.exceptionObserver)==null||s.onConfigChange(),(i=this.sessionRecording)==null||i.startIfEnabledOrStop(),(c=this.autocapture)==null||c.startIfEnabled(),(d=this.heatmaps)==null||d.startIfEnabled(),(p=this.exceptionObserver)==null||p.startIfEnabledOrStop(),this.surveys.loadIfEnabled(),this._s(),(m=this.externalIntegrations)==null||m.startIfEnabledOrStop()}}startSessionRecording(e){var t=e===!0,n={sampling:t||!(e==null||!e.sampling),linked_flag:t||!(e==null||!e.linked_flag),url_trigger:t||!(e==null||!e.url_trigger),event_trigger:t||!(e==null||!e.event_trigger)};if(Object.values(n).some(Boolean)){var s,i,c,d,p;(s=this.sessionManager)==null||s.checkAndGetSessionAndWindowId(),n.sampling&&((i=this.sessionRecording)==null||i.overrideSampling()),n.linked_flag&&((c=this.sessionRecording)==null||c.overrideLinkedFlag()),n.url_trigger&&((d=this.sessionRecording)==null||d.overrideTrigger("url")),n.event_trigger&&((p=this.sessionRecording)==null||p.overrideTrigger("event"))}this.set_config({disable_session_recording:!1})}stopSessionRecording(){this.set_config({disable_session_recording:!0})}sessionRecordingStarted(){var e;return!((e=this.sessionRecording)==null||!e.started)}captureException(e,t){var n=new Error("PostHog syntheticException"),s=this.exceptions.buildProperties(e,{handled:!0,syntheticException:n});return this.exceptions.sendExceptionEvent(Qe({},s,t))}startExceptionAutocapture(e){this.set_config({capture_exceptions:e==null||e})}stopExceptionAutocapture(){this.set_config({capture_exceptions:!1})}loadToolbar(e){return this.toolbar.loadToolbar(e)}get_property(e){var t;return(t=this.persistence)==null?void 0:t.props[e]}getSessionProperty(e){var t;return(t=this.sessionPersistence)==null?void 0:t.props[e]}toString(){var e,t=(e=this.config.name)!==null&&e!==void 0?e:Kf;return t!==Kf&&(t=Kf+"."+t),t}_isIdentified(){var e,t;return((e=this.persistence)==null?void 0:e.get_property(jl))==="identified"||((t=this.sessionPersistence)==null?void 0:t.get_property(jl))==="identified"}fs(){var e,t;return!(this.config.person_profiles==="never"||this.config.person_profiles==="identified_only"&&!this._isIdentified()&&Xf(this.getGroups())&&((e=this.persistence)==null||(e=e.props)==null||!e[dm])&&((t=this.persistence)==null||(t=t.props)==null||!t[gy]))}ds(){return this.config.capture_pageleave===!0||this.config.capture_pageleave==="if_capture_pageview"&&(this.config.capture_pageview===!0||this.config.capture_pageview==="history_change")}createPersonProfile(){this.fs()||this.ps("posthog.createPersonProfile")&&this.setPersonProperties({},{})}setInternalOrTestUser(){this.ps("posthog.setInternalOrTestUser")&&this.setPersonProperties({$internal_or_test_user:!0})}ps(e){return this.config.person_profiles==="never"?(Xe.error(e+' was called, but process_person is set to "never". This call will be ignored.'),!1):(this.gs(gy,!0),!0)}Qr(){if(this.config.cookieless_mode==="always")return!0;var e=this.consent.isOptedOut(),t=this.config.opt_out_persistence_by_default||this.config.cookieless_mode==="on_reject";return this.config.disable_persistence||e&&!!t}_s(){var e,t,n,s,i=this.Qr();return((e=this.persistence)==null?void 0:e.Pi)!==i&&((n=this.persistence)==null||n.set_disabled(i)),((t=this.sessionPersistence)==null?void 0:t.Pi)!==i&&((s=this.sessionPersistence)==null||s.set_disabled(i)),i}opt_in_capturing(e){var t;if(this.config.cookieless_mode!=="always"){var n,s,i;this.config.cookieless_mode==="on_reject"&&this.consent.isExplicitlyOptedOut()&&(this.reset(!0),(n=this.sessionManager)==null||n.destroy(),(s=this.pageViewManager)==null||s.destroy(),this.sessionManager=new xk(this),this.pageViewManager=new sk(this),this.persistence&&(this.sessionPropsManager=new yk(this,this.sessionManager,this.persistence)),this.sessionRecording=new bk(this),this.sessionRecording.startIfEnabledOrStop()),this.consent.optInOut(!0),this._s(),this.us(),(t=this.sessionRecording)==null||t.startIfEnabledOrStop(),this.config.cookieless_mode=="on_reject"&&this.surveys.loadIfEnabled(),(qe(e==null?void 0:e.captureEventName)||e!=null&&e.captureEventName)&&this.capture((i=e==null?void 0:e.captureEventName)!==null&&i!==void 0?i:"$opt_in",e==null?void 0:e.captureProperties,{send_instantly:!0}),this.config.capture_pageview&&this.hs()}else Xe.warn('Consent opt in/out is not valid with cookieless_mode="always" and will be ignored')}opt_out_capturing(){var e,t,n;this.config.cookieless_mode!=="always"?(this.config.cookieless_mode==="on_reject"&&this.consent.isOptedIn()&&this.reset(!0),this.consent.optInOut(!1),this._s(),this.config.cookieless_mode==="on_reject"&&(this.register({distinct_id:Vp,$device_id:null}),(e=this.sessionManager)==null||e.destroy(),(t=this.pageViewManager)==null||t.destroy(),this.sessionManager=void 0,this.sessionPropsManager=void 0,(n=this.sessionRecording)==null||n.stopRecording(),this.sessionRecording=void 0,this.hs())):Xe.warn('Consent opt in/out is not valid with cookieless_mode="always" and will be ignored')}has_opted_in_capturing(){return this.consent.isOptedIn()}has_opted_out_capturing(){return this.consent.isOptedOut()}get_explicit_consent_status(){var e=this.consent.consent;return e===Ol.GRANTED?"granted":e===Ol.DENIED?"denied":"pending"}is_capturing(){return this.config.cookieless_mode==="always"||(this.config.cookieless_mode==="on_reject"?this.consent.isExplicitlyOptedOut()||this.consent.isOptedIn():!this.has_opted_out_capturing())}clear_opt_in_out_capturing(){this.consent.reset(),this._s()}_is_bot(){return Xo?HR(Xo,this.config.custom_blocked_useragents):void 0}hs(){Ve&&(Ve.visibilityState==="visible"?this.Wr||(this.Wr=!0,this.capture("$pageview",{title:Ve.title},{send_instantly:!0}),this.Gr&&(Ve.removeEventListener("visibilitychange",this.Gr),this.Gr=null)):this.Gr||(this.Gr=this.hs.bind(this),jn(Ve,"visibilitychange",this.Gr)))}debug(e){e===!1?(_e==null||_e.console.log("You've disabled debug mode."),this.set_config({debug:!1})):(_e==null||_e.console.log("You're now in debug mode. All calls to PostHog will be logged in your console.\nYou can disable this with `posthog.debug(false)`."),this.set_config({debug:!0}))}M(){var e,t,n,s,i,c,d,p=this.Yr||{};return"advanced_disable_flags"in p?!!p.advanced_disable_flags:this.config.advanced_disable_flags!==!1?!!this.config.advanced_disable_flags:this.config.advanced_disable_decide===!0?(Xe.warn("Config field 'advanced_disable_decide' is deprecated. Please use 'advanced_disable_flags' instead. The old field will be removed in a future major version."),!0):(n="advanced_disable_decide",s=!1,i=Xe,c=(t="advanced_disable_flags")in(e=p)&&!fr(e[t]),d=n in e&&!fr(e[n]),c?e[t]:d?(i&&i.warn("Config field '"+n+"' is deprecated. Please use '"+t+"' instead. The old field will be removed in a future major version."),e[n]):s)}cs(e){if(fr(this.config.before_send))return e;var t=Fr(this.config.before_send)?this.config.before_send:[this.config.before_send],n=e;for(var s of t){if(n=s(n),fr(n)){var i="Event '"+e.event+"' was rejected in beforeSend function";return k8(e.event)?Xe.warn(i+". This can cause unexpected behavior."):Xe.info(i),null}n.properties&&!Xf(n.properties)||Xe.warn("Event '"+e.event+"' has no properties after beforeSend function, this is likely an error.")}return n}getPageViewId(){var e;return(e=this.pageViewManager.Kt)==null?void 0:e.pageViewId}captureTraceFeedback(e,t){this.capture("$ai_feedback",{$ai_trace_id:String(e),$ai_feedback_text:t})}captureTraceMetric(e,t,n){this.capture("$ai_metric",{$ai_trace_id:String(e),$ai_metric_name:t,$ai_metric_value:String(n)})}Kr(e){var t=$l(e)&&!e,n=pn.H()&&pn.q("ph_debug")==="true";return!t&&(!!n||e)}}(function(r,e){for(var t=0;t<e.length;t++)r.prototype[e[t]]=lz(r.prototype[e[t]])})(Xy,["identify"]);var Sk,$a=(Sk=Sm[Kf]=new Xy,(function(){function r(){r.done||(r.done=!0,BR=!1,Zr(Sm,(function(e){e._dom_loaded()})))}Ve!=null&&Ve.addEventListener?Ve.readyState==="complete"?r():jn(Ve,"DOMContentLoaded",r,{capture:!1}):_e&&Xe.error("Browser doesn't support `document.addEventListener` so PostHog couldn't be initialized")})(),Sk),GR=w.createContext({client:$a,bootstrap:void 0});function WR(r,e,t){if(t===void 0&&(t=new WeakMap),r===e)return!0;if(typeof r!="object"||r===null||typeof e!="object"||e===null)return!1;if(t.has(r)&&t.get(r)===e)return!0;t.set(r,e);var n=Object.keys(r),s=Object.keys(e);if(n.length!==s.length)return!1;for(var i=0,c=n;i<c.length;i++){var d=c[i];if(!s.includes(d)||!WR(r[d],e[d],t))return!1}return!0}function LH(r){var e,t,n=r.children,s=r.client,i=r.apiKey,c=r.options,d=w.useRef(null),p=w.useMemo(function(){return s?(i&&console.warn("[PostHog.js] You have provided both `client` and `apiKey` to `PostHogProvider`. `apiKey` will be ignored in favour of `client`."),c&&console.warn("[PostHog.js] You have provided both `client` and `options` to `PostHogProvider`. `options` will be ignored in favour of `client`."),s):(i||console.warn("[PostHog.js] No `apiKey` or `client` were provided to `PostHogProvider`. Using default global `window.posthog` instance. You must initialize it manually. This is not recommended behavior."),$a)},[s,i,JSON.stringify(c)]);return w.useEffect(function(){if(!s){var m=d.current;m?(i!==m.apiKey&&console.warn("[PostHog.js] You have provided a different `apiKey` to `PostHogProvider` than the one that was already initialized. This is not supported by our provider and we'll keep using the previous key. If you need to toggle between API Keys you need to control the `client` yourself and pass it in as a prop rather than an `apiKey` prop."),c&&!WR(c,m.options)&&$a.set_config(c),d.current={apiKey:i,options:c??{}}):($a.__loaded&&console.warn("[PostHog.js] `posthog` was already loaded elsewhere. This may cause issues."),$a.init(i,c),d.current={apiKey:i,options:c??{}})}},[s,i,JSON.stringify(c)]),dr.createElement(GR.Provider,{value:{client:p,bootstrap:(e=c==null?void 0:c.bootstrap)!==null&&e!==void 0?e:(t=s==null?void 0:s.config)===null||t===void 0?void 0:t.bootstrap}},n)}var Jx=function(r){return typeof r=="function"},hb=function(r,e){return hb=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])},hb(r,e)};function MH(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");hb(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var $H={componentStack:null,exceptionEvent:null,error:null},UH={INVALID_FALLBACK:"[PostHog.js][PostHogErrorBoundary] Invalid fallback prop, provide a valid React element or a function that returns a valid React element."};(function(r){MH(e,r);function e(t){var n=r.call(this,t)||this;return n.state=$H,n}return e.prototype.componentDidCatch=function(t,n){var s=this.props.additionalProperties,i;Jx(s)?i=s(t):typeof s=="object"&&(i=s);var c=this.context.client,d=c.captureException(t,i),p=n.componentStack;this.setState({error:t,componentStack:p??null,exceptionEvent:d})},e.prototype.render=function(){var t=this.props,n=t.children,s=t.fallback,i=this.state;if(i.componentStack==null)return Jx(n)?n():n;var c=Jx(s)?dr.createElement(s,{error:i.error,componentStack:i.componentStack,exceptionEvent:i.exceptionEvent}):s;return dr.isValidElement(c)?c:(console.warn(UH.INVALID_FALLBACK),dr.createElement(dr.Fragment,null))},e.contextType=GR,e})(dr.Component);function Ur(){var e;const r=w.useContext(Y_);if(r.isLoading)return{debug:async()=>{},info:async()=>{},warn:async()=>{},error:async()=>{}};if(!((e=r.services)!=null&&e.logging))throw new Error("Logging provider not available. Make sure PlatformProvider is wrapping your component.");return r.services.logging}function Ck(r){try{const e=r.split(".")[1];return JSON.parse(atob(e.replace(/-/g,"+").replace(/_/g,"/"))).email??null}catch{return null}}const zH=({children:r})=>{const e=Vl(),t=Ur();return w.useEffect(()=>{if(typeof window>"u"||!jw){console.warn(" PostHog: Not initialized - missing or invalid key");return}(async()=>{const s=await Om(t),i=s!=null&&s.id_token?Ck(s.id_token):null;$a.init(jw,{api_host:QN,autocapture:!0,capture_pageview:!0,capture_pageleave:!0,capture_dead_clicks:!1,disable_session_recording:!0,loaded:c=>{i&&c.identify(i,{email:i}),console.log("PostHog: Initialized successfully")},debug:GN==="dev"})})()},[]),w.useEffect(()=>{var s;const n=i=>{"token"in i&&(i.token.newValue?Om(t).then(c=>{const d=c!=null&&c.id_token?Ck(c.id_token):null;d&&$a.identify(d,{email:d})}):$a.reset())};return(s=e==null?void 0:e.onChanged)==null||s.call(e,n),()=>{var i;(i=e==null?void 0:e.removeChangeListener)==null||i.call(e,n)}},[e,t]),u.jsx(LH,{client:$a,children:r})},on=w.forwardRef(({className:r,type:e,...t},n)=>u.jsx("input",{type:e,className:Rr("flex h-10 w-full rounded-md border border-neutral-200 bg-white px-3 py-2 text-base text-neutral-950 ring-offset-white file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-neutral-950 placeholder:text-neutral-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm dark:border-border dark:bg-card dark:text-gray-100 dark:ring-offset-neutral-950 dark:file:text-neutral-50 dark:placeholder:text-neutral-400 dark:focus-visible:ring-primary",r),ref:n,...t}));on.displayName="Input";const kk=r=>typeof r=="boolean"?`${r}`:r===0?"0":r,Nk=_T,cE=(r,e)=>t=>{var n;if((e==null?void 0:e.variants)==null)return Nk(r,t==null?void 0:t.class,t==null?void 0:t.className);const{variants:s,defaultVariants:i}=e,c=Object.keys(s).map(m=>{const g=t==null?void 0:t[m],x=i==null?void 0:i[m];if(g===null)return null;const b=kk(g)||kk(x);return s[m][b]}),d=t&&Object.entries(t).reduce((m,g)=>{let[x,b]=g;return b===void 0||(m[x]=b),m},{}),p=e==null||(n=e.compoundVariants)===null||n===void 0?void 0:n.reduce((m,g)=>{let{class:x,className:b,...E}=g;return Object.entries(E).every(T=>{let[S,N]=T;return Array.isArray(N)?N.includes({...i,...d}[S]):{...i,...d}[S]===N})?[...m,x,b]:m},[]);return Nk(r,c,p,t==null?void 0:t.class,t==null?void 0:t.className)},HH=cE("rounded-lg border border-neutral-200 bg-white text-neutral-950 shadow-sm dark:border-border dark:bg-card dark:text-card-foreground",{variants:{variant:{default:"",TemplateCard:"",ReferenceSourcesCard:"",IntegrationsCard:""}},defaultVariants:{variant:"default"}}),_i=w.forwardRef(({className:r,variant:e,...t},n)=>u.jsx("div",{ref:n,className:Rr(HH({variant:e,className:r})),...t}));_i.displayName="Card";const Ji=w.forwardRef(({className:r,cardVariant:e,...t},n)=>u.jsx("div",{ref:n,className:Rr(e==="TemplateCard"?"flex flex-col space-y-1 p-4":"flex flex-col space-y-1.5 p-6",r),...t}));Ji.displayName="CardHeader";const Xi=w.forwardRef(({className:r,...e},t)=>u.jsx("h3",{ref:t,className:Rr("font-semibold leading-none tracking-tight",r),...e}));Xi.displayName="CardTitle";const BH=w.forwardRef(({className:r,...e},t)=>u.jsx("p",{ref:t,className:Rr("text-sm text-neutral-500 dark:text-neutral-400",r),...e}));BH.displayName="CardDescription";const Ei=w.forwardRef(({className:r,cardVariant:e,...t},n)=>u.jsx("div",{ref:n,className:Rr(e==="TemplateCard"?"p-0 pt-0":"p-6 pt-0",r),...t}));Ei.displayName="CardContent";const GH=w.forwardRef(({className:r,...e},t)=>u.jsx("div",{ref:t,className:Rr("flex items-center p-6 pt-0",r),...e}));GH.displayName="CardFooter";function Tk(r,e){if(typeof r=="function")return r(e);r!=null&&(r.current=e)}function Qc(...r){return e=>{let t=!1;const n=r.map(s=>{const i=Tk(s,e);return!t&&typeof i=="function"&&(t=!0),i});if(t)return()=>{for(let s=0;s<n.length;s++){const i=n[s];typeof i=="function"?i():Tk(r[s],null)}}}}function On(...r){return w.useCallback(Qc(...r),r)}var WH=Symbol.for("react.lazy"),Cy=Rb[" use ".trim().toString()];function VH(r){return typeof r=="object"&&r!==null&&"then"in r}function VR(r){return r!=null&&typeof r=="object"&&"$$typeof"in r&&r.$$typeof===WH&&"_payload"in r&&VH(r._payload)}function qH(r){const e=YH(r),t=w.forwardRef((n,s)=>{let{children:i,...c}=n;VR(i)&&typeof Cy=="function"&&(i=Cy(i._payload));const d=w.Children.toArray(i),p=d.find(XH);if(p){const m=p.props.children,g=d.map(x=>x===p?w.Children.count(m)>1?w.Children.only(null):w.isValidElement(m)?m.props.children:null:x);return u.jsx(e,{...c,ref:s,children:w.isValidElement(m)?w.cloneElement(m,void 0,g):null})}return u.jsx(e,{...c,ref:s,children:i})});return t.displayName=`${r}.Slot`,t}var KH=qH("Slot");function YH(r){const e=w.forwardRef((t,n)=>{let{children:s,...i}=t;if(VR(s)&&typeof Cy=="function"&&(s=Cy(s._payload)),w.isValidElement(s)){const c=ZH(s),d=QH(i,s.props);return s.type!==w.Fragment&&(d.ref=n?Qc(n,c):c),w.cloneElement(s,d)}return w.Children.count(s)>1?w.Children.only(null):null});return e.displayName=`${r}.SlotClone`,e}var JH=Symbol("radix.slottable");function XH(r){return w.isValidElement(r)&&typeof r.type=="function"&&"__radixId"in r.type&&r.type.__radixId===JH}function QH(r,e){const t={...e};for(const n in e){const s=r[n],i=e[n];/^on[A-Z]/.test(n)?s&&i?t[n]=(...d)=>{const p=i(...d);return s(...d),p}:s&&(t[n]=s):n==="style"?t[n]={...s,...i}:n==="className"&&(t[n]=[s,i].filter(Boolean).join(" "))}return{...r,...t}}function ZH(r){var n,s;let e=(n=Object.getOwnPropertyDescriptor(r.props,"ref"))==null?void 0:n.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=(s=Object.getOwnPropertyDescriptor(r,"ref"))==null?void 0:s.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}const eB=cE("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-white transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 dark:ring-offset-neutral-950 dark:focus-visible:ring-primary",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90 dark:bg-primary dark:text-primary-foreground dark:hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90 dark:bg-destructive dark:text-destructive-foreground dark:hover:bg-destructive/90",outline:"border border-neutral-200 bg-background hover:bg-accent hover:text-accent-foreground dark:border-neutral-800 dark:bg-background dark:hover:bg-accent dark:hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80 dark:bg-secondary dark:text-secondary-foreground dark:hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent dark:hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline dark:text-primary"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),ze=w.forwardRef(({className:r,variant:e,size:t,asChild:n=!1,...s},i)=>{const c=n?KH:"button";return u.jsx(c,{className:Rr(eB({variant:e,size:t,className:r})),ref:i,...s})});ze.displayName="Button";/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tB=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),qR=(...r)=>r.filter((e,t,n)=>!!e&&n.indexOf(e)===t).join(" ");/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var rB={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nB=w.forwardRef(({color:r="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:n,className:s="",children:i,iconNode:c,...d},p)=>w.createElement("svg",{ref:p,...rB,width:e,height:e,stroke:r,strokeWidth:n?Number(t)*24/Number(e):t,className:qR("lucide",s),...d},[...c.map(([m,g])=>w.createElement(m,g)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rr=(r,e)=>{const t=w.forwardRef(({className:n,...s},i)=>w.createElement(nB,{ref:i,iconNode:e,className:qR(`lucide-${tB(r)}`,n),...s}));return t.displayName=`${r}`,t};/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KR=rr("ArrowDownToLine",[["path",{d:"M12 17V3",key:"1cwfxf"}],["path",{d:"m6 11 6 6 6-6",key:"12ii2o"}],["path",{d:"M19 21H5",key:"150jfl"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cm=rr("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sB=rr("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YR=rr("Briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xx=rr("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hf=rr("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oB=rr("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ms=rr("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qv=rr("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iv=rr("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bm=rr("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wc=rr("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iB=rr("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pv=rr("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aB=rr("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lB=rr("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ml=rr("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cB=rr("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uB=rr("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sh=rr("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dB=rr("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qx=rr("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fB=rr("Folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hB=rr("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pB=rr("ListTodo",[["rect",{x:"3",y:"5",width:"6",height:"6",rx:"1",key:"1defrl"}],["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zi=rr("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kc=rr("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mB=rr("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rk=rr("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gB=rr("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vB=rr("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yB=rr("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ak=rr("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xB=rr("Presentation",[["path",{d:"M2 3h20",key:"91anmk"}],["path",{d:"M21 3v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V3",key:"2k9sn8"}],["path",{d:"m7 21 5-5 5 5",key:"bip4we"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const No=rr("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eo=rr("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oh=rr("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ky=rr("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JR=rr("WifiOff",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ki=rr("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function At(r,e,{checkForDefaultPrevented:t=!0}={}){return function(s){if(r==null||r(s),t===!1||!s.defaultPrevented)return e==null?void 0:e(s)}}function wB(r,e){const t=w.createContext(e),n=i=>{const{children:c,...d}=i,p=w.useMemo(()=>d,Object.values(d));return u.jsx(t.Provider,{value:p,children:c})};n.displayName=r+"Provider";function s(i){const c=w.useContext(t);if(c)return c;if(e!==void 0)return e;throw new Error(`\`${i}\` must be used within \`${r}\``)}return[n,s]}function Wa(r,e=[]){let t=[];function n(i,c){const d=w.createContext(c),p=t.length;t=[...t,c];const m=x=>{var R;const{scope:b,children:E,...T}=x,S=((R=b==null?void 0:b[r])==null?void 0:R[p])||d,N=w.useMemo(()=>T,Object.values(T));return u.jsx(S.Provider,{value:N,children:E})};m.displayName=i+"Provider";function g(x,b){var S;const E=((S=b==null?void 0:b[r])==null?void 0:S[p])||d,T=w.useContext(E);if(T)return T;if(c!==void 0)return c;throw new Error(`\`${x}\` must be used within \`${i}\``)}return[m,g]}const s=()=>{const i=t.map(c=>w.createContext(c));return function(d){const p=(d==null?void 0:d[r])||i;return w.useMemo(()=>({[`__scope${r}`]:{...d,[r]:p}}),[d,p])}};return s.scopeName=r,[n,bB(s,...e)]}function bB(...r){const e=r[0];if(r.length===1)return e;const t=()=>{const n=r.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const c=n.reduce((d,{useScope:p,scopeName:m})=>{const x=p(i)[`__scope${m}`];return{...d,...x}},{});return w.useMemo(()=>({[`__scope${e.scopeName}`]:c}),[c])}};return t.scopeName=e.scopeName,t}var Hl=globalThis!=null&&globalThis.document?w.useLayoutEffect:()=>{},_B=Rb[" useInsertionEffect ".trim().toString()]||Hl;function Zc({prop:r,defaultProp:e,onChange:t=()=>{},caller:n}){const[s,i,c]=EB({defaultProp:e,onChange:t}),d=r!==void 0,p=d?r:s;{const g=w.useRef(r!==void 0);w.useEffect(()=>{const x=g.current;x!==d&&console.warn(`${n} is changing from ${x?"controlled":"uncontrolled"} to ${d?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),g.current=d},[d,n])}const m=w.useCallback(g=>{var x;if(d){const b=SB(g)?g(r):g;b!==r&&((x=c.current)==null||x.call(c,b))}else i(g)},[d,r,i,c]);return[p,m]}function EB({defaultProp:r,onChange:e}){const[t,n]=w.useState(r),s=w.useRef(t),i=w.useRef(e);return _B(()=>{i.current=e},[e]),w.useEffect(()=>{var c;s.current!==t&&((c=i.current)==null||c.call(i,t),s.current=t)},[t,s]),[t,n,i]}function SB(r){return typeof r=="function"}const CB=["top","right","bottom","left"],Yc=Math.min,Jo=Math.max,Ny=Math.round,Fv=Math.floor,Ba=r=>({x:r,y:r}),kB={left:"right",right:"left",bottom:"top",top:"bottom"},NB={start:"end",end:"start"};function pb(r,e,t){return Jo(r,Yc(e,t))}function Bl(r,e){return typeof r=="function"?r(e):r}function Gl(r){return r.split("-")[0]}function bh(r){return r.split("-")[1]}function uE(r){return r==="x"?"y":"x"}function dE(r){return r==="y"?"height":"width"}const TB=new Set(["top","bottom"]);function Ha(r){return TB.has(Gl(r))?"y":"x"}function fE(r){return uE(Ha(r))}function RB(r,e,t){t===void 0&&(t=!1);const n=bh(r),s=fE(r),i=dE(s);let c=s==="x"?n===(t?"end":"start")?"right":"left":n==="start"?"bottom":"top";return e.reference[i]>e.floating[i]&&(c=Ty(c)),[c,Ty(c)]}function AB(r){const e=Ty(r);return[mb(r),e,mb(e)]}function mb(r){return r.replace(/start|end/g,e=>NB[e])}const Ik=["left","right"],Pk=["right","left"],IB=["top","bottom"],PB=["bottom","top"];function FB(r,e,t){switch(r){case"top":case"bottom":return t?e?Pk:Ik:e?Ik:Pk;case"left":case"right":return e?IB:PB;default:return[]}}function jB(r,e,t,n){const s=bh(r);let i=FB(Gl(r),t==="start",n);return s&&(i=i.map(c=>c+"-"+s),e&&(i=i.concat(i.map(mb)))),i}function Ty(r){return r.replace(/left|right|bottom|top/g,e=>kB[e])}function OB(r){return{top:0,right:0,bottom:0,left:0,...r}}function XR(r){return typeof r!="number"?OB(r):{top:r,right:r,bottom:r,left:r}}function Ry(r){const{x:e,y:t,width:n,height:s}=r;return{width:n,height:s,top:t,left:e,right:e+n,bottom:t+s,x:e,y:t}}function Fk(r,e,t){let{reference:n,floating:s}=r;const i=Ha(e),c=fE(e),d=dE(c),p=Gl(e),m=i==="y",g=n.x+n.width/2-s.width/2,x=n.y+n.height/2-s.height/2,b=n[d]/2-s[d]/2;let E;switch(p){case"top":E={x:g,y:n.y-s.height};break;case"bottom":E={x:g,y:n.y+n.height};break;case"right":E={x:n.x+n.width,y:x};break;case"left":E={x:n.x-s.width,y:x};break;default:E={x:n.x,y:n.y}}switch(bh(e)){case"start":E[c]-=b*(t&&m?-1:1);break;case"end":E[c]+=b*(t&&m?-1:1);break}return E}async function DB(r,e){var t;e===void 0&&(e={});const{x:n,y:s,platform:i,rects:c,elements:d,strategy:p}=r,{boundary:m="clippingAncestors",rootBoundary:g="viewport",elementContext:x="floating",altBoundary:b=!1,padding:E=0}=Bl(e,r),T=XR(E),N=d[b?x==="floating"?"reference":"floating":x],R=Ry(await i.getClippingRect({element:(t=await(i.isElement==null?void 0:i.isElement(N)))==null||t?N:N.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(d.floating)),boundary:m,rootBoundary:g,strategy:p})),A=x==="floating"?{x:n,y:s,width:c.floating.width,height:c.floating.height}:c.reference,j=await(i.getOffsetParent==null?void 0:i.getOffsetParent(d.floating)),P=await(i.isElement==null?void 0:i.isElement(j))?await(i.getScale==null?void 0:i.getScale(j))||{x:1,y:1}:{x:1,y:1},$=Ry(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:d,rect:A,offsetParent:j,strategy:p}):A);return{top:(R.top-$.top+T.top)/P.y,bottom:($.bottom-R.bottom+T.bottom)/P.y,left:(R.left-$.left+T.left)/P.x,right:($.right-R.right+T.right)/P.x}}const LB=async(r,e,t)=>{const{placement:n="bottom",strategy:s="absolute",middleware:i=[],platform:c}=t,d=i.filter(Boolean),p=await(c.isRTL==null?void 0:c.isRTL(e));let m=await c.getElementRects({reference:r,floating:e,strategy:s}),{x:g,y:x}=Fk(m,n,p),b=n,E={},T=0;for(let N=0;N<d.length;N++){var S;const{name:R,fn:A}=d[N],{x:j,y:P,data:$,reset:W}=await A({x:g,y:x,initialPlacement:n,placement:b,strategy:s,middlewareData:E,rects:m,platform:{...c,detectOverflow:(S=c.detectOverflow)!=null?S:DB},elements:{reference:r,floating:e}});g=j??g,x=P??x,E={...E,[R]:{...E[R],...$}},W&&T<=50&&(T++,typeof W=="object"&&(W.placement&&(b=W.placement),W.rects&&(m=W.rects===!0?await c.getElementRects({reference:r,floating:e,strategy:s}):W.rects),{x:g,y:x}=Fk(m,b,p)),N=-1)}return{x:g,y:x,placement:b,strategy:s,middlewareData:E}},MB=r=>({name:"arrow",options:r,async fn(e){const{x:t,y:n,placement:s,rects:i,platform:c,elements:d,middlewareData:p}=e,{element:m,padding:g=0}=Bl(r,e)||{};if(m==null)return{};const x=XR(g),b={x:t,y:n},E=fE(s),T=dE(E),S=await c.getDimensions(m),N=E==="y",R=N?"top":"left",A=N?"bottom":"right",j=N?"clientHeight":"clientWidth",P=i.reference[T]+i.reference[E]-b[E]-i.floating[T],$=b[E]-i.reference[E],W=await(c.getOffsetParent==null?void 0:c.getOffsetParent(m));let M=W?W[j]:0;(!M||!await(c.isElement==null?void 0:c.isElement(W)))&&(M=d.floating[j]||i.floating[T]);const V=P/2-$/2,X=M/2-S[T]/2-1,ie=Yc(x[R],X),J=Yc(x[A],X),ae=ie,we=M-S[T]-J,ue=M/2-S[T]/2+V,oe=pb(ae,ue,we),pe=!p.arrow&&bh(s)!=null&&ue!==oe&&i.reference[T]/2-(ue<ae?ie:J)-S[T]/2<0,te=pe?ue<ae?ue-ae:ue-we:0;return{[E]:b[E]+te,data:{[E]:oe,centerOffset:ue-oe-te,...pe&&{alignmentOffset:te}},reset:pe}}}),$B=function(r){return r===void 0&&(r={}),{name:"flip",options:r,async fn(e){var t,n;const{placement:s,middlewareData:i,rects:c,initialPlacement:d,platform:p,elements:m}=e,{mainAxis:g=!0,crossAxis:x=!0,fallbackPlacements:b,fallbackStrategy:E="bestFit",fallbackAxisSideDirection:T="none",flipAlignment:S=!0,...N}=Bl(r,e);if((t=i.arrow)!=null&&t.alignmentOffset)return{};const R=Gl(s),A=Ha(d),j=Gl(d)===d,P=await(p.isRTL==null?void 0:p.isRTL(m.floating)),$=b||(j||!S?[Ty(d)]:AB(d)),W=T!=="none";!b&&W&&$.push(...jB(d,S,T,P));const M=[d,...$],V=await p.detectOverflow(e,N),X=[];let ie=((n=i.flip)==null?void 0:n.overflows)||[];if(g&&X.push(V[R]),x){const ue=RB(s,c,P);X.push(V[ue[0]],V[ue[1]])}if(ie=[...ie,{placement:s,overflows:X}],!X.every(ue=>ue<=0)){var J,ae;const ue=(((J=i.flip)==null?void 0:J.index)||0)+1,oe=M[ue];if(oe&&(!(x==="alignment"?A!==Ha(oe):!1)||ie.every(B=>Ha(B.placement)===A?B.overflows[0]>0:!0)))return{data:{index:ue,overflows:ie},reset:{placement:oe}};let pe=(ae=ie.filter(te=>te.overflows[0]<=0).sort((te,B)=>te.overflows[1]-B.overflows[1])[0])==null?void 0:ae.placement;if(!pe)switch(E){case"bestFit":{var we;const te=(we=ie.filter(B=>{if(W){const z=Ha(B.placement);return z===A||z==="y"}return!0}).map(B=>[B.placement,B.overflows.filter(z=>z>0).reduce((z,Y)=>z+Y,0)]).sort((B,z)=>B[1]-z[1])[0])==null?void 0:we[0];te&&(pe=te);break}case"initialPlacement":pe=d;break}if(s!==pe)return{reset:{placement:pe}}}return{}}}};function jk(r,e){return{top:r.top-e.height,right:r.right-e.width,bottom:r.bottom-e.height,left:r.left-e.width}}function Ok(r){return CB.some(e=>r[e]>=0)}const UB=function(r){return r===void 0&&(r={}),{name:"hide",options:r,async fn(e){const{rects:t,platform:n}=e,{strategy:s="referenceHidden",...i}=Bl(r,e);switch(s){case"referenceHidden":{const c=await n.detectOverflow(e,{...i,elementContext:"reference"}),d=jk(c,t.reference);return{data:{referenceHiddenOffsets:d,referenceHidden:Ok(d)}}}case"escaped":{const c=await n.detectOverflow(e,{...i,altBoundary:!0}),d=jk(c,t.floating);return{data:{escapedOffsets:d,escaped:Ok(d)}}}default:return{}}}}},QR=new Set(["left","top"]);async function zB(r,e){const{placement:t,platform:n,elements:s}=r,i=await(n.isRTL==null?void 0:n.isRTL(s.floating)),c=Gl(t),d=bh(t),p=Ha(t)==="y",m=QR.has(c)?-1:1,g=i&&p?-1:1,x=Bl(e,r);let{mainAxis:b,crossAxis:E,alignmentAxis:T}=typeof x=="number"?{mainAxis:x,crossAxis:0,alignmentAxis:null}:{mainAxis:x.mainAxis||0,crossAxis:x.crossAxis||0,alignmentAxis:x.alignmentAxis};return d&&typeof T=="number"&&(E=d==="end"?T*-1:T),p?{x:E*g,y:b*m}:{x:b*m,y:E*g}}const HB=function(r){return r===void 0&&(r=0),{name:"offset",options:r,async fn(e){var t,n;const{x:s,y:i,placement:c,middlewareData:d}=e,p=await zB(e,r);return c===((t=d.offset)==null?void 0:t.placement)&&(n=d.arrow)!=null&&n.alignmentOffset?{}:{x:s+p.x,y:i+p.y,data:{...p,placement:c}}}}},BB=function(r){return r===void 0&&(r={}),{name:"shift",options:r,async fn(e){const{x:t,y:n,placement:s,platform:i}=e,{mainAxis:c=!0,crossAxis:d=!1,limiter:p={fn:R=>{let{x:A,y:j}=R;return{x:A,y:j}}},...m}=Bl(r,e),g={x:t,y:n},x=await i.detectOverflow(e,m),b=Ha(Gl(s)),E=uE(b);let T=g[E],S=g[b];if(c){const R=E==="y"?"top":"left",A=E==="y"?"bottom":"right",j=T+x[R],P=T-x[A];T=pb(j,T,P)}if(d){const R=b==="y"?"top":"left",A=b==="y"?"bottom":"right",j=S+x[R],P=S-x[A];S=pb(j,S,P)}const N=p.fn({...e,[E]:T,[b]:S});return{...N,data:{x:N.x-t,y:N.y-n,enabled:{[E]:c,[b]:d}}}}}},GB=function(r){return r===void 0&&(r={}),{options:r,fn(e){const{x:t,y:n,placement:s,rects:i,middlewareData:c}=e,{offset:d=0,mainAxis:p=!0,crossAxis:m=!0}=Bl(r,e),g={x:t,y:n},x=Ha(s),b=uE(x);let E=g[b],T=g[x];const S=Bl(d,e),N=typeof S=="number"?{mainAxis:S,crossAxis:0}:{mainAxis:0,crossAxis:0,...S};if(p){const j=b==="y"?"height":"width",P=i.reference[b]-i.floating[j]+N.mainAxis,$=i.reference[b]+i.reference[j]-N.mainAxis;E<P?E=P:E>$&&(E=$)}if(m){var R,A;const j=b==="y"?"width":"height",P=QR.has(Gl(s)),$=i.reference[x]-i.floating[j]+(P&&((R=c.offset)==null?void 0:R[x])||0)+(P?0:N.crossAxis),W=i.reference[x]+i.reference[j]+(P?0:((A=c.offset)==null?void 0:A[x])||0)-(P?N.crossAxis:0);T<$?T=$:T>W&&(T=W)}return{[b]:E,[x]:T}}}},WB=function(r){return r===void 0&&(r={}),{name:"size",options:r,async fn(e){var t,n;const{placement:s,rects:i,platform:c,elements:d}=e,{apply:p=()=>{},...m}=Bl(r,e),g=await c.detectOverflow(e,m),x=Gl(s),b=bh(s),E=Ha(s)==="y",{width:T,height:S}=i.floating;let N,R;x==="top"||x==="bottom"?(N=x,R=b===(await(c.isRTL==null?void 0:c.isRTL(d.floating))?"start":"end")?"left":"right"):(R=x,N=b==="end"?"top":"bottom");const A=S-g.top-g.bottom,j=T-g.left-g.right,P=Yc(S-g[N],A),$=Yc(T-g[R],j),W=!e.middlewareData.shift;let M=P,V=$;if((t=e.middlewareData.shift)!=null&&t.enabled.x&&(V=j),(n=e.middlewareData.shift)!=null&&n.enabled.y&&(M=A),W&&!b){const ie=Jo(g.left,0),J=Jo(g.right,0),ae=Jo(g.top,0),we=Jo(g.bottom,0);E?V=T-2*(ie!==0||J!==0?ie+J:Jo(g.left,g.right)):M=S-2*(ae!==0||we!==0?ae+we:Jo(g.top,g.bottom))}await p({...e,availableWidth:V,availableHeight:M});const X=await c.getDimensions(d.floating);return T!==X.width||S!==X.height?{reset:{rects:!0}}:{}}}};function Qy(){return typeof window<"u"}function _h(r){return ZR(r)?(r.nodeName||"").toLowerCase():"#document"}function Qo(r){var e;return(r==null||(e=r.ownerDocument)==null?void 0:e.defaultView)||window}function Va(r){var e;return(e=(ZR(r)?r.ownerDocument:r.document)||window.document)==null?void 0:e.documentElement}function ZR(r){return Qy()?r instanceof Node||r instanceof Qo(r).Node:!1}function ea(r){return Qy()?r instanceof Element||r instanceof Qo(r).Element:!1}function Ga(r){return Qy()?r instanceof HTMLElement||r instanceof Qo(r).HTMLElement:!1}function Dk(r){return!Qy()||typeof ShadowRoot>"u"?!1:r instanceof ShadowRoot||r instanceof Qo(r).ShadowRoot}const VB=new Set(["inline","contents"]);function og(r){const{overflow:e,overflowX:t,overflowY:n,display:s}=ta(r);return/auto|scroll|overlay|hidden|clip/.test(e+n+t)&&!VB.has(s)}const qB=new Set(["table","td","th"]);function KB(r){return qB.has(_h(r))}const YB=[":popover-open",":modal"];function Zy(r){return YB.some(e=>{try{return r.matches(e)}catch{return!1}})}const JB=["transform","translate","scale","rotate","perspective"],XB=["transform","translate","scale","rotate","perspective","filter"],QB=["paint","layout","strict","content"];function hE(r){const e=pE(),t=ea(r)?ta(r):r;return JB.some(n=>t[n]?t[n]!=="none":!1)||(t.containerType?t.containerType!=="normal":!1)||!e&&(t.backdropFilter?t.backdropFilter!=="none":!1)||!e&&(t.filter?t.filter!=="none":!1)||XB.some(n=>(t.willChange||"").includes(n))||QB.some(n=>(t.contain||"").includes(n))}function ZB(r){let e=Jc(r);for(;Ga(e)&&!ph(e);){if(hE(e))return e;if(Zy(e))return null;e=Jc(e)}return null}function pE(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const eG=new Set(["html","body","#document"]);function ph(r){return eG.has(_h(r))}function ta(r){return Qo(r).getComputedStyle(r)}function e0(r){return ea(r)?{scrollLeft:r.scrollLeft,scrollTop:r.scrollTop}:{scrollLeft:r.scrollX,scrollTop:r.scrollY}}function Jc(r){if(_h(r)==="html")return r;const e=r.assignedSlot||r.parentNode||Dk(r)&&r.host||Va(r);return Dk(e)?e.host:e}function eA(r){const e=Jc(r);return ph(e)?r.ownerDocument?r.ownerDocument.body:r.body:Ga(e)&&og(e)?e:eA(e)}function Gm(r,e,t){var n;e===void 0&&(e=[]),t===void 0&&(t=!0);const s=eA(r),i=s===((n=r.ownerDocument)==null?void 0:n.body),c=Qo(s);if(i){const d=gb(c);return e.concat(c,c.visualViewport||[],og(s)?s:[],d&&t?Gm(d):[])}return e.concat(s,Gm(s,[],t))}function gb(r){return r.parent&&Object.getPrototypeOf(r.parent)?r.frameElement:null}function tA(r){const e=ta(r);let t=parseFloat(e.width)||0,n=parseFloat(e.height)||0;const s=Ga(r),i=s?r.offsetWidth:t,c=s?r.offsetHeight:n,d=Ny(t)!==i||Ny(n)!==c;return d&&(t=i,n=c),{width:t,height:n,$:d}}function mE(r){return ea(r)?r:r.contextElement}function ih(r){const e=mE(r);if(!Ga(e))return Ba(1);const t=e.getBoundingClientRect(),{width:n,height:s,$:i}=tA(e);let c=(i?Ny(t.width):t.width)/n,d=(i?Ny(t.height):t.height)/s;return(!c||!Number.isFinite(c))&&(c=1),(!d||!Number.isFinite(d))&&(d=1),{x:c,y:d}}const tG=Ba(0);function rA(r){const e=Qo(r);return!pE()||!e.visualViewport?tG:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function rG(r,e,t){return e===void 0&&(e=!1),!t||e&&t!==Qo(r)?!1:e}function cd(r,e,t,n){e===void 0&&(e=!1),t===void 0&&(t=!1);const s=r.getBoundingClientRect(),i=mE(r);let c=Ba(1);e&&(n?ea(n)&&(c=ih(n)):c=ih(r));const d=rG(i,t,n)?rA(i):Ba(0);let p=(s.left+d.x)/c.x,m=(s.top+d.y)/c.y,g=s.width/c.x,x=s.height/c.y;if(i){const b=Qo(i),E=n&&ea(n)?Qo(n):n;let T=b,S=gb(T);for(;S&&n&&E!==T;){const N=ih(S),R=S.getBoundingClientRect(),A=ta(S),j=R.left+(S.clientLeft+parseFloat(A.paddingLeft))*N.x,P=R.top+(S.clientTop+parseFloat(A.paddingTop))*N.y;p*=N.x,m*=N.y,g*=N.x,x*=N.y,p+=j,m+=P,T=Qo(S),S=gb(T)}}return Ry({width:g,height:x,x:p,y:m})}function t0(r,e){const t=e0(r).scrollLeft;return e?e.left+t:cd(Va(r)).left+t}function nA(r,e){const t=r.getBoundingClientRect(),n=t.left+e.scrollLeft-t0(r,t),s=t.top+e.scrollTop;return{x:n,y:s}}function nG(r){let{elements:e,rect:t,offsetParent:n,strategy:s}=r;const i=s==="fixed",c=Va(n),d=e?Zy(e.floating):!1;if(n===c||d&&i)return t;let p={scrollLeft:0,scrollTop:0},m=Ba(1);const g=Ba(0),x=Ga(n);if((x||!x&&!i)&&((_h(n)!=="body"||og(c))&&(p=e0(n)),Ga(n))){const E=cd(n);m=ih(n),g.x=E.x+n.clientLeft,g.y=E.y+n.clientTop}const b=c&&!x&&!i?nA(c,p):Ba(0);return{width:t.width*m.x,height:t.height*m.y,x:t.x*m.x-p.scrollLeft*m.x+g.x+b.x,y:t.y*m.y-p.scrollTop*m.y+g.y+b.y}}function sG(r){return Array.from(r.getClientRects())}function oG(r){const e=Va(r),t=e0(r),n=r.ownerDocument.body,s=Jo(e.scrollWidth,e.clientWidth,n.scrollWidth,n.clientWidth),i=Jo(e.scrollHeight,e.clientHeight,n.scrollHeight,n.clientHeight);let c=-t.scrollLeft+t0(r);const d=-t.scrollTop;return ta(n).direction==="rtl"&&(c+=Jo(e.clientWidth,n.clientWidth)-s),{width:s,height:i,x:c,y:d}}const Lk=25;function iG(r,e){const t=Qo(r),n=Va(r),s=t.visualViewport;let i=n.clientWidth,c=n.clientHeight,d=0,p=0;if(s){i=s.width,c=s.height;const g=pE();(!g||g&&e==="fixed")&&(d=s.offsetLeft,p=s.offsetTop)}const m=t0(n);if(m<=0){const g=n.ownerDocument,x=g.body,b=getComputedStyle(x),E=g.compatMode==="CSS1Compat"&&parseFloat(b.marginLeft)+parseFloat(b.marginRight)||0,T=Math.abs(n.clientWidth-x.clientWidth-E);T<=Lk&&(i-=T)}else m<=Lk&&(i+=m);return{width:i,height:c,x:d,y:p}}const aG=new Set(["absolute","fixed"]);function lG(r,e){const t=cd(r,!0,e==="fixed"),n=t.top+r.clientTop,s=t.left+r.clientLeft,i=Ga(r)?ih(r):Ba(1),c=r.clientWidth*i.x,d=r.clientHeight*i.y,p=s*i.x,m=n*i.y;return{width:c,height:d,x:p,y:m}}function Mk(r,e,t){let n;if(e==="viewport")n=iG(r,t);else if(e==="document")n=oG(Va(r));else if(ea(e))n=lG(e,t);else{const s=rA(r);n={x:e.x-s.x,y:e.y-s.y,width:e.width,height:e.height}}return Ry(n)}function sA(r,e){const t=Jc(r);return t===e||!ea(t)||ph(t)?!1:ta(t).position==="fixed"||sA(t,e)}function cG(r,e){const t=e.get(r);if(t)return t;let n=Gm(r,[],!1).filter(d=>ea(d)&&_h(d)!=="body"),s=null;const i=ta(r).position==="fixed";let c=i?Jc(r):r;for(;ea(c)&&!ph(c);){const d=ta(c),p=hE(c);!p&&d.position==="fixed"&&(s=null),(i?!p&&!s:!p&&d.position==="static"&&!!s&&aG.has(s.position)||og(c)&&!p&&sA(r,c))?n=n.filter(g=>g!==c):s=d,c=Jc(c)}return e.set(r,n),n}function uG(r){let{element:e,boundary:t,rootBoundary:n,strategy:s}=r;const c=[...t==="clippingAncestors"?Zy(e)?[]:cG(e,this._c):[].concat(t),n],d=c[0],p=c.reduce((m,g)=>{const x=Mk(e,g,s);return m.top=Jo(x.top,m.top),m.right=Yc(x.right,m.right),m.bottom=Yc(x.bottom,m.bottom),m.left=Jo(x.left,m.left),m},Mk(e,d,s));return{width:p.right-p.left,height:p.bottom-p.top,x:p.left,y:p.top}}function dG(r){const{width:e,height:t}=tA(r);return{width:e,height:t}}function fG(r,e,t){const n=Ga(e),s=Va(e),i=t==="fixed",c=cd(r,!0,i,e);let d={scrollLeft:0,scrollTop:0};const p=Ba(0);function m(){p.x=t0(s)}if(n||!n&&!i)if((_h(e)!=="body"||og(s))&&(d=e0(e)),n){const E=cd(e,!0,i,e);p.x=E.x+e.clientLeft,p.y=E.y+e.clientTop}else s&&m();i&&!n&&s&&m();const g=s&&!n&&!i?nA(s,d):Ba(0),x=c.left+d.scrollLeft-p.x-g.x,b=c.top+d.scrollTop-p.y-g.y;return{x,y:b,width:c.width,height:c.height}}function Zx(r){return ta(r).position==="static"}function $k(r,e){if(!Ga(r)||ta(r).position==="fixed")return null;if(e)return e(r);let t=r.offsetParent;return Va(r)===t&&(t=t.ownerDocument.body),t}function oA(r,e){const t=Qo(r);if(Zy(r))return t;if(!Ga(r)){let s=Jc(r);for(;s&&!ph(s);){if(ea(s)&&!Zx(s))return s;s=Jc(s)}return t}let n=$k(r,e);for(;n&&KB(n)&&Zx(n);)n=$k(n,e);return n&&ph(n)&&Zx(n)&&!hE(n)?t:n||ZB(r)||t}const hG=async function(r){const e=this.getOffsetParent||oA,t=this.getDimensions,n=await t(r.floating);return{reference:fG(r.reference,await e(r.floating),r.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function pG(r){return ta(r).direction==="rtl"}const mG={convertOffsetParentRelativeRectToViewportRelativeRect:nG,getDocumentElement:Va,getClippingRect:uG,getOffsetParent:oA,getElementRects:hG,getClientRects:sG,getDimensions:dG,getScale:ih,isElement:ea,isRTL:pG};function iA(r,e){return r.x===e.x&&r.y===e.y&&r.width===e.width&&r.height===e.height}function gG(r,e){let t=null,n;const s=Va(r);function i(){var d;clearTimeout(n),(d=t)==null||d.disconnect(),t=null}function c(d,p){d===void 0&&(d=!1),p===void 0&&(p=1),i();const m=r.getBoundingClientRect(),{left:g,top:x,width:b,height:E}=m;if(d||e(),!b||!E)return;const T=Fv(x),S=Fv(s.clientWidth-(g+b)),N=Fv(s.clientHeight-(x+E)),R=Fv(g),j={rootMargin:-T+"px "+-S+"px "+-N+"px "+-R+"px",threshold:Jo(0,Yc(1,p))||1};let P=!0;function $(W){const M=W[0].intersectionRatio;if(M!==p){if(!P)return c();M?c(!1,M):n=setTimeout(()=>{c(!1,1e-7)},1e3)}M===1&&!iA(m,r.getBoundingClientRect())&&c(),P=!1}try{t=new IntersectionObserver($,{...j,root:s.ownerDocument})}catch{t=new IntersectionObserver($,j)}t.observe(r)}return c(!0),i}function vG(r,e,t,n){n===void 0&&(n={});const{ancestorScroll:s=!0,ancestorResize:i=!0,elementResize:c=typeof ResizeObserver=="function",layoutShift:d=typeof IntersectionObserver=="function",animationFrame:p=!1}=n,m=mE(r),g=s||i?[...m?Gm(m):[],...Gm(e)]:[];g.forEach(R=>{s&&R.addEventListener("scroll",t,{passive:!0}),i&&R.addEventListener("resize",t)});const x=m&&d?gG(m,t):null;let b=-1,E=null;c&&(E=new ResizeObserver(R=>{let[A]=R;A&&A.target===m&&E&&(E.unobserve(e),cancelAnimationFrame(b),b=requestAnimationFrame(()=>{var j;(j=E)==null||j.observe(e)})),t()}),m&&!p&&E.observe(m),E.observe(e));let T,S=p?cd(r):null;p&&N();function N(){const R=cd(r);S&&!iA(S,R)&&t(),S=R,T=requestAnimationFrame(N)}return t(),()=>{var R;g.forEach(A=>{s&&A.removeEventListener("scroll",t),i&&A.removeEventListener("resize",t)}),x==null||x(),(R=E)==null||R.disconnect(),E=null,p&&cancelAnimationFrame(T)}}const yG=HB,xG=BB,wG=$B,bG=WB,_G=UB,Uk=MB,EG=GB,SG=(r,e,t)=>{const n=new Map,s={platform:mG,...t},i={...s.platform,_c:n};return LB(r,e,{...s,platform:i})};var gE=x1();const CG=Nb(gE);var kG=typeof document<"u",NG=function(){},Zv=kG?w.useLayoutEffect:NG;function Ay(r,e){if(r===e)return!0;if(typeof r!=typeof e)return!1;if(typeof r=="function"&&r.toString()===e.toString())return!0;let t,n,s;if(r&&e&&typeof r=="object"){if(Array.isArray(r)){if(t=r.length,t!==e.length)return!1;for(n=t;n--!==0;)if(!Ay(r[n],e[n]))return!1;return!0}if(s=Object.keys(r),t=s.length,t!==Object.keys(e).length)return!1;for(n=t;n--!==0;)if(!{}.hasOwnProperty.call(e,s[n]))return!1;for(n=t;n--!==0;){const i=s[n];if(!(i==="_owner"&&r.$$typeof)&&!Ay(r[i],e[i]))return!1}return!0}return r!==r&&e!==e}function aA(r){return typeof window>"u"?1:(r.ownerDocument.defaultView||window).devicePixelRatio||1}function zk(r,e){const t=aA(r);return Math.round(e*t)/t}function ew(r){const e=w.useRef(r);return Zv(()=>{e.current=r}),e}function TG(r){r===void 0&&(r={});const{placement:e="bottom",strategy:t="absolute",middleware:n=[],platform:s,elements:{reference:i,floating:c}={},transform:d=!0,whileElementsMounted:p,open:m}=r,[g,x]=w.useState({x:0,y:0,strategy:t,placement:e,middlewareData:{},isPositioned:!1}),[b,E]=w.useState(n);Ay(b,n)||E(n);const[T,S]=w.useState(null),[N,R]=w.useState(null),A=w.useCallback(B=>{B!==W.current&&(W.current=B,S(B))},[]),j=w.useCallback(B=>{B!==M.current&&(M.current=B,R(B))},[]),P=i||T,$=c||N,W=w.useRef(null),M=w.useRef(null),V=w.useRef(g),X=p!=null,ie=ew(p),J=ew(s),ae=ew(m),we=w.useCallback(()=>{if(!W.current||!M.current)return;const B={placement:e,strategy:t,middleware:b};J.current&&(B.platform=J.current),SG(W.current,M.current,B).then(z=>{const Y={...z,isPositioned:ae.current!==!1};ue.current&&!Ay(V.current,Y)&&(V.current=Y,gE.flushSync(()=>{x(Y)}))})},[b,e,t,J,ae]);Zv(()=>{m===!1&&V.current.isPositioned&&(V.current.isPositioned=!1,x(B=>({...B,isPositioned:!1})))},[m]);const ue=w.useRef(!1);Zv(()=>(ue.current=!0,()=>{ue.current=!1}),[]),Zv(()=>{if(P&&(W.current=P),$&&(M.current=$),P&&$){if(ie.current)return ie.current(P,$,we);we()}},[P,$,we,ie,X]);const oe=w.useMemo(()=>({reference:W,floating:M,setReference:A,setFloating:j}),[A,j]),pe=w.useMemo(()=>({reference:P,floating:$}),[P,$]),te=w.useMemo(()=>{const B={position:t,left:0,top:0};if(!pe.floating)return B;const z=zk(pe.floating,g.x),Y=zk(pe.floating,g.y);return d?{...B,transform:"translate("+z+"px, "+Y+"px)",...aA(pe.floating)>=1.5&&{willChange:"transform"}}:{position:t,left:z,top:Y}},[t,d,pe.floating,g.x,g.y]);return w.useMemo(()=>({...g,update:we,refs:oe,elements:pe,floatingStyles:te}),[g,we,oe,pe,te])}const RG=r=>{function e(t){return{}.hasOwnProperty.call(t,"current")}return{name:"arrow",options:r,fn(t){const{element:n,padding:s}=typeof r=="function"?r(t):r;return n&&e(n)?n.current!=null?Uk({element:n.current,padding:s}).fn(t):{}:n?Uk({element:n,padding:s}).fn(t):{}}}},AG=(r,e)=>({...yG(r),options:[r,e]}),IG=(r,e)=>({...xG(r),options:[r,e]}),PG=(r,e)=>({...EG(r),options:[r,e]}),FG=(r,e)=>({...wG(r),options:[r,e]}),jG=(r,e)=>({...bG(r),options:[r,e]}),OG=(r,e)=>({..._G(r),options:[r,e]}),DG=(r,e)=>({...RG(r),options:[r,e]});function LG(r){const e=MG(r),t=w.forwardRef((n,s)=>{const{children:i,...c}=n,d=w.Children.toArray(i),p=d.find(UG);if(p){const m=p.props.children,g=d.map(x=>x===p?w.Children.count(m)>1?w.Children.only(null):w.isValidElement(m)?m.props.children:null:x);return u.jsx(e,{...c,ref:s,children:w.isValidElement(m)?w.cloneElement(m,void 0,g):null})}return u.jsx(e,{...c,ref:s,children:i})});return t.displayName=`${r}.Slot`,t}function MG(r){const e=w.forwardRef((t,n)=>{const{children:s,...i}=t;if(w.isValidElement(s)){const c=HG(s),d=zG(i,s.props);return s.type!==w.Fragment&&(d.ref=n?Qc(n,c):c),w.cloneElement(s,d)}return w.Children.count(s)>1?w.Children.only(null):null});return e.displayName=`${r}.SlotClone`,e}var $G=Symbol("radix.slottable");function UG(r){return w.isValidElement(r)&&typeof r.type=="function"&&"__radixId"in r.type&&r.type.__radixId===$G}function zG(r,e){const t={...e};for(const n in e){const s=r[n],i=e[n];/^on[A-Z]/.test(n)?s&&i?t[n]=(...d)=>{const p=i(...d);return s(...d),p}:s&&(t[n]=s):n==="style"?t[n]={...s,...i}:n==="className"&&(t[n]=[s,i].filter(Boolean).join(" "))}return{...r,...t}}function HG(r){var n,s;let e=(n=Object.getOwnPropertyDescriptor(r.props,"ref"))==null?void 0:n.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=(s=Object.getOwnPropertyDescriptor(r,"ref"))==null?void 0:s.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}var BG=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],jr=BG.reduce((r,e)=>{const t=LG(`Primitive.${e}`),n=w.forwardRef((s,i)=>{const{asChild:c,...d}=s,p=c?t:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),u.jsx(p,{...d,ref:i})});return n.displayName=`Primitive.${e}`,{...r,[e]:n}},{});function lA(r,e){r&&gE.flushSync(()=>r.dispatchEvent(e))}var GG="Arrow",cA=w.forwardRef((r,e)=>{const{children:t,width:n=10,height:s=5,...i}=r;return u.jsx(jr.svg,{...i,ref:e,width:n,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:r.asChild?t:u.jsx("polygon",{points:"0,0 30,0 15,10"})})});cA.displayName=GG;var WG=cA;function Wl(r){const e=w.useRef(r);return w.useEffect(()=>{e.current=r}),w.useMemo(()=>(...t)=>{var n;return(n=e.current)==null?void 0:n.call(e,...t)},[])}function VG(r){const[e,t]=w.useState(void 0);return Hl(()=>{if(r){t({width:r.offsetWidth,height:r.offsetHeight});const n=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const i=s[0];let c,d;if("borderBoxSize"in i){const p=i.borderBoxSize,m=Array.isArray(p)?p[0]:p;c=m.inlineSize,d=m.blockSize}else c=r.offsetWidth,d=r.offsetHeight;t({width:c,height:d})});return n.observe(r,{box:"border-box"}),()=>n.unobserve(r)}else t(void 0)},[r]),e}var vE="Popper",[uA,r0]=Wa(vE),[qG,dA]=uA(vE),fA=r=>{const{__scopePopper:e,children:t}=r,[n,s]=w.useState(null);return u.jsx(qG,{scope:e,anchor:n,onAnchorChange:s,children:t})};fA.displayName=vE;var hA="PopperAnchor",pA=w.forwardRef((r,e)=>{const{__scopePopper:t,virtualRef:n,...s}=r,i=dA(hA,t),c=w.useRef(null),d=On(e,c),p=w.useRef(null);return w.useEffect(()=>{const m=p.current;p.current=(n==null?void 0:n.current)||c.current,m!==p.current&&i.onAnchorChange(p.current)}),n?null:u.jsx(jr.div,{...s,ref:d})});pA.displayName=hA;var yE="PopperContent",[KG,YG]=uA(yE),mA=w.forwardRef((r,e)=>{var xe,ye,de,Te,Be,Ge;const{__scopePopper:t,side:n="bottom",sideOffset:s=0,align:i="center",alignOffset:c=0,arrowPadding:d=0,avoidCollisions:p=!0,collisionBoundary:m=[],collisionPadding:g=0,sticky:x="partial",hideWhenDetached:b=!1,updatePositionStrategy:E="optimized",onPlaced:T,...S}=r,N=dA(yE,t),[R,A]=w.useState(null),j=On(e,Me=>A(Me)),[P,$]=w.useState(null),W=VG(P),M=(W==null?void 0:W.width)??0,V=(W==null?void 0:W.height)??0,X=n+(i!=="center"?"-"+i:""),ie=typeof g=="number"?g:{top:0,right:0,bottom:0,left:0,...g},J=Array.isArray(m)?m:[m],ae=J.length>0,we={padding:ie,boundary:J.filter(XG),altBoundary:ae},{refs:ue,floatingStyles:oe,placement:pe,isPositioned:te,middlewareData:B}=TG({strategy:"fixed",placement:X,whileElementsMounted:(...Me)=>vG(...Me,{animationFrame:E==="always"}),elements:{reference:N.anchor},middleware:[AG({mainAxis:s+V,alignmentAxis:c}),p&&IG({mainAxis:!0,crossAxis:!1,limiter:x==="partial"?PG():void 0,...we}),p&&FG({...we}),jG({...we,apply:({elements:Me,rects:Ae,availableWidth:ct,availableHeight:Bt})=>{const{width:yt,height:sr}=Ae.reference,Gt=Me.floating.style;Gt.setProperty("--radix-popper-available-width",`${ct}px`),Gt.setProperty("--radix-popper-available-height",`${Bt}px`),Gt.setProperty("--radix-popper-anchor-width",`${yt}px`),Gt.setProperty("--radix-popper-anchor-height",`${sr}px`)}}),P&&DG({element:P,padding:d}),QG({arrowWidth:M,arrowHeight:V}),b&&OG({strategy:"referenceHidden",...we})]}),[z,Y]=yA(pe),O=Wl(T);Hl(()=>{te&&(O==null||O())},[te,O]);const U=(xe=B.arrow)==null?void 0:xe.x,ne=(ye=B.arrow)==null?void 0:ye.y,Ee=((de=B.arrow)==null?void 0:de.centerOffset)!==0,[q,le]=w.useState();return Hl(()=>{R&&le(window.getComputedStyle(R).zIndex)},[R]),u.jsx("div",{ref:ue.setFloating,"data-radix-popper-content-wrapper":"",style:{...oe,transform:te?oe.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:q,"--radix-popper-transform-origin":[(Te=B.transformOrigin)==null?void 0:Te.x,(Be=B.transformOrigin)==null?void 0:Be.y].join(" "),...((Ge=B.hide)==null?void 0:Ge.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:r.dir,children:u.jsx(KG,{scope:t,placedSide:z,onArrowChange:$,arrowX:U,arrowY:ne,shouldHideArrow:Ee,children:u.jsx(jr.div,{"data-side":z,"data-align":Y,...S,ref:j,style:{...S.style,animation:te?void 0:"none"}})})})});mA.displayName=yE;var gA="PopperArrow",JG={top:"bottom",right:"left",bottom:"top",left:"right"},vA=w.forwardRef(function(e,t){const{__scopePopper:n,...s}=e,i=YG(gA,n),c=JG[i.placedSide];return u.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[c]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:u.jsx(WG,{...s,ref:t,style:{...s.style,display:"block"}})})});vA.displayName=gA;function XG(r){return r!==null}var QG=r=>({name:"transformOrigin",options:r,fn(e){var N,R,A;const{placement:t,rects:n,middlewareData:s}=e,c=((N=s.arrow)==null?void 0:N.centerOffset)!==0,d=c?0:r.arrowWidth,p=c?0:r.arrowHeight,[m,g]=yA(t),x={start:"0%",center:"50%",end:"100%"}[g],b=(((R=s.arrow)==null?void 0:R.x)??0)+d/2,E=(((A=s.arrow)==null?void 0:A.y)??0)+p/2;let T="",S="";return m==="bottom"?(T=c?x:`${b}px`,S=`${-p}px`):m==="top"?(T=c?x:`${b}px`,S=`${n.floating.height+p}px`):m==="right"?(T=`${-p}px`,S=c?x:`${E}px`):m==="left"&&(T=`${n.floating.width+p}px`,S=c?x:`${E}px`),{data:{x:T,y:S}}}});function yA(r){const[e,t="center"]=r.split("-");return[e,t]}var xA=fA,wA=pA,bA=mA,_A=vA,ZG="Portal",xE=w.forwardRef((r,e)=>{var d;const{container:t,...n}=r,[s,i]=w.useState(!1);Hl(()=>i(!0),[]);const c=t||s&&((d=globalThis==null?void 0:globalThis.document)==null?void 0:d.body);return c?CG.createPortal(u.jsx(jr.div,{...n,ref:e}),c):null});xE.displayName=ZG;function e7(r,e){return w.useReducer((t,n)=>e[t][n]??t,r)}var sa=r=>{const{present:e,children:t}=r,n=t7(e),s=typeof t=="function"?t({present:n.isPresent}):w.Children.only(t),i=On(n.ref,r7(s));return typeof t=="function"||n.isPresent?w.cloneElement(s,{ref:i}):null};sa.displayName="Presence";function t7(r){const[e,t]=w.useState(),n=w.useRef(null),s=w.useRef(r),i=w.useRef("none"),c=r?"mounted":"unmounted",[d,p]=e7(c,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return w.useEffect(()=>{const m=jv(n.current);i.current=d==="mounted"?m:"none"},[d]),Hl(()=>{const m=n.current,g=s.current;if(g!==r){const b=i.current,E=jv(m);r?p("MOUNT"):E==="none"||(m==null?void 0:m.display)==="none"?p("UNMOUNT"):p(g&&b!==E?"ANIMATION_OUT":"UNMOUNT"),s.current=r}},[r,p]),Hl(()=>{if(e){let m;const g=e.ownerDocument.defaultView??window,x=E=>{const S=jv(n.current).includes(CSS.escape(E.animationName));if(E.target===e&&S&&(p("ANIMATION_END"),!s.current)){const N=e.style.animationFillMode;e.style.animationFillMode="forwards",m=g.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=N)})}},b=E=>{E.target===e&&(i.current=jv(n.current))};return e.addEventListener("animationstart",b),e.addEventListener("animationcancel",x),e.addEventListener("animationend",x),()=>{g.clearTimeout(m),e.removeEventListener("animationstart",b),e.removeEventListener("animationcancel",x),e.removeEventListener("animationend",x)}}else p("ANIMATION_END")},[e,p]),{isPresent:["mounted","unmountSuspended"].includes(d),ref:w.useCallback(m=>{n.current=m?getComputedStyle(m):null,t(m)},[])}}function jv(r){return(r==null?void 0:r.animationName)||"none"}function r7(r){var n,s;let e=(n=Object.getOwnPropertyDescriptor(r.props,"ref"))==null?void 0:n.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=(s=Object.getOwnPropertyDescriptor(r,"ref"))==null?void 0:s.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}function n7(r,e=globalThis==null?void 0:globalThis.document){const t=Wl(r);w.useEffect(()=>{const n=s=>{s.key==="Escape"&&t(s)};return e.addEventListener("keydown",n,{capture:!0}),()=>e.removeEventListener("keydown",n,{capture:!0})},[t,e])}var s7="DismissableLayer",vb="dismissableLayer.update",o7="dismissableLayer.pointerDownOutside",i7="dismissableLayer.focusOutside",Hk,EA=w.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),n0=w.forwardRef((r,e)=>{const{disableOutsidePointerEvents:t=!1,onEscapeKeyDown:n,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:c,onDismiss:d,...p}=r,m=w.useContext(EA),[g,x]=w.useState(null),b=(g==null?void 0:g.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,E]=w.useState({}),T=On(e,M=>x(M)),S=Array.from(m.layers),[N]=[...m.layersWithOutsidePointerEventsDisabled].slice(-1),R=S.indexOf(N),A=g?S.indexOf(g):-1,j=m.layersWithOutsidePointerEventsDisabled.size>0,P=A>=R,$=c7(M=>{const V=M.target,X=[...m.branches].some(ie=>ie.contains(V));!P||X||(s==null||s(M),c==null||c(M),M.defaultPrevented||d==null||d())},b),W=u7(M=>{const V=M.target;[...m.branches].some(ie=>ie.contains(V))||(i==null||i(M),c==null||c(M),M.defaultPrevented||d==null||d())},b);return n7(M=>{A===m.layers.size-1&&(n==null||n(M),!M.defaultPrevented&&d&&(M.preventDefault(),d()))},b),w.useEffect(()=>{if(g)return t&&(m.layersWithOutsidePointerEventsDisabled.size===0&&(Hk=b.body.style.pointerEvents,b.body.style.pointerEvents="none"),m.layersWithOutsidePointerEventsDisabled.add(g)),m.layers.add(g),Bk(),()=>{t&&m.layersWithOutsidePointerEventsDisabled.size===1&&(b.body.style.pointerEvents=Hk)}},[g,b,t,m]),w.useEffect(()=>()=>{g&&(m.layers.delete(g),m.layersWithOutsidePointerEventsDisabled.delete(g),Bk())},[g,m]),w.useEffect(()=>{const M=()=>E({});return document.addEventListener(vb,M),()=>document.removeEventListener(vb,M)},[]),u.jsx(jr.div,{...p,ref:T,style:{pointerEvents:j?P?"auto":"none":void 0,...r.style},onFocusCapture:At(r.onFocusCapture,W.onFocusCapture),onBlurCapture:At(r.onBlurCapture,W.onBlurCapture),onPointerDownCapture:At(r.onPointerDownCapture,$.onPointerDownCapture)})});n0.displayName=s7;var a7="DismissableLayerBranch",l7=w.forwardRef((r,e)=>{const t=w.useContext(EA),n=w.useRef(null),s=On(e,n);return w.useEffect(()=>{const i=n.current;if(i)return t.branches.add(i),()=>{t.branches.delete(i)}},[t.branches]),u.jsx(jr.div,{...r,ref:s})});l7.displayName=a7;function c7(r,e=globalThis==null?void 0:globalThis.document){const t=Wl(r),n=w.useRef(!1),s=w.useRef(()=>{});return w.useEffect(()=>{const i=d=>{if(d.target&&!n.current){let p=function(){SA(o7,t,m,{discrete:!0})};const m={originalEvent:d};d.pointerType==="touch"?(e.removeEventListener("click",s.current),s.current=p,e.addEventListener("click",s.current,{once:!0})):p()}else e.removeEventListener("click",s.current);n.current=!1},c=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(c),e.removeEventListener("pointerdown",i),e.removeEventListener("click",s.current)}},[e,t]),{onPointerDownCapture:()=>n.current=!0}}function u7(r,e=globalThis==null?void 0:globalThis.document){const t=Wl(r),n=w.useRef(!1);return w.useEffect(()=>{const s=i=>{i.target&&!n.current&&SA(i7,t,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",s),()=>e.removeEventListener("focusin",s)},[e,t]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function Bk(){const r=new CustomEvent(vb);document.dispatchEvent(r)}function SA(r,e,t,{discrete:n}){const s=t.originalEvent.target,i=new CustomEvent(r,{bubbles:!1,cancelable:!0,detail:t});e&&s.addEventListener(r,e,{once:!0}),n?lA(s,i):s.dispatchEvent(i)}var tw,s0="HoverCard",[CA]=Wa(s0,[r0]),o0=r0(),[d7,wE]=CA(s0),kA=r=>{const{__scopeHoverCard:e,children:t,open:n,defaultOpen:s,onOpenChange:i,openDelay:c=700,closeDelay:d=300}=r,p=o0(e),m=w.useRef(0),g=w.useRef(0),x=w.useRef(!1),b=w.useRef(!1),[E,T]=Zc({prop:n,defaultProp:s??!1,onChange:i,caller:s0}),S=w.useCallback(()=>{clearTimeout(g.current),m.current=window.setTimeout(()=>T(!0),c)},[c,T]),N=w.useCallback(()=>{clearTimeout(m.current),!x.current&&!b.current&&(g.current=window.setTimeout(()=>T(!1),d))},[d,T]),R=w.useCallback(()=>T(!1),[T]);return w.useEffect(()=>()=>{clearTimeout(m.current),clearTimeout(g.current)},[]),u.jsx(d7,{scope:e,open:E,onOpenChange:T,onOpen:S,onClose:N,onDismiss:R,hasSelectionRef:x,isPointerDownOnContentRef:b,children:u.jsx(xA,{...p,children:t})})};kA.displayName=s0;var NA="HoverCardTrigger",TA=w.forwardRef((r,e)=>{const{__scopeHoverCard:t,...n}=r,s=wE(NA,t),i=o0(t);return u.jsx(wA,{asChild:!0,...i,children:u.jsx(jr.a,{"data-state":s.open?"open":"closed",...n,ref:e,onPointerEnter:At(r.onPointerEnter,Py(s.onOpen)),onPointerLeave:At(r.onPointerLeave,Py(s.onClose)),onFocus:At(r.onFocus,s.onOpen),onBlur:At(r.onBlur,s.onClose),onTouchStart:At(r.onTouchStart,c=>c.preventDefault())})})});TA.displayName=NA;var f7="HoverCardPortal",[PK,h7]=CA(f7,{forceMount:void 0}),Iy="HoverCardContent",RA=w.forwardRef((r,e)=>{const t=h7(Iy,r.__scopeHoverCard),{forceMount:n=t.forceMount,...s}=r,i=wE(Iy,r.__scopeHoverCard);return u.jsx(sa,{present:n||i.open,children:u.jsx(p7,{"data-state":i.open?"open":"closed",...s,onPointerEnter:At(r.onPointerEnter,Py(i.onOpen)),onPointerLeave:At(r.onPointerLeave,Py(i.onClose)),ref:e})})});RA.displayName=Iy;var p7=w.forwardRef((r,e)=>{const{__scopeHoverCard:t,onEscapeKeyDown:n,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:c,...d}=r,p=wE(Iy,t),m=o0(t),g=w.useRef(null),x=On(e,g),[b,E]=w.useState(!1);return w.useEffect(()=>{if(b){const T=document.body;return tw=T.style.userSelect||T.style.webkitUserSelect,T.style.userSelect="none",T.style.webkitUserSelect="none",()=>{T.style.userSelect=tw,T.style.webkitUserSelect=tw}}},[b]),w.useEffect(()=>{if(g.current){const T=()=>{E(!1),p.isPointerDownOnContentRef.current=!1,setTimeout(()=>{var N;((N=document.getSelection())==null?void 0:N.toString())!==""&&(p.hasSelectionRef.current=!0)})};return document.addEventListener("pointerup",T),()=>{document.removeEventListener("pointerup",T),p.hasSelectionRef.current=!1,p.isPointerDownOnContentRef.current=!1}}},[p.isPointerDownOnContentRef,p.hasSelectionRef]),w.useEffect(()=>{g.current&&g7(g.current).forEach(S=>S.setAttribute("tabindex","-1"))}),u.jsx(n0,{asChild:!0,disableOutsidePointerEvents:!1,onInteractOutside:c,onEscapeKeyDown:n,onPointerDownOutside:s,onFocusOutside:At(i,T=>{T.preventDefault()}),onDismiss:p.onDismiss,children:u.jsx(bA,{...m,...d,onPointerDown:At(d.onPointerDown,T=>{T.currentTarget.contains(T.target)&&E(!0),p.hasSelectionRef.current=!1,p.isPointerDownOnContentRef.current=!0}),ref:x,style:{...d.style,userSelect:b?"text":void 0,WebkitUserSelect:b?"text":void 0,"--radix-hover-card-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-hover-card-content-available-width":"var(--radix-popper-available-width)","--radix-hover-card-content-available-height":"var(--radix-popper-available-height)","--radix-hover-card-trigger-width":"var(--radix-popper-anchor-width)","--radix-hover-card-trigger-height":"var(--radix-popper-anchor-height)"}})})}),m7="HoverCardArrow",AA=w.forwardRef((r,e)=>{const{__scopeHoverCard:t,...n}=r,s=o0(t);return u.jsx(_A,{...s,...n,ref:e})});AA.displayName=m7;function Py(r){return e=>e.pointerType==="touch"?void 0:r()}function g7(r){const e=[],t=document.createTreeWalker(r,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP});for(;t.nextNode();)e.push(t.currentNode);return e}var v7=kA,y7=TA,x7=RA,w7=AA;const yb="src/lib/utils/emailUtils.tsx";async function IA(r,e){try{await(await Vn.createServices()).contentScript.insertContentIntoComposeBox(r)}catch(t){e.error("Error inserting content into compose box",t,{sourceFile:yb,functionName:"insertHtmlIntoComposeBox"}),b7(r,e)}}function b7(r,e){const t=r.replace(/<([^>]+)class="ql-align-([^"]+)"([^>]*)>/g,'<$1style="text-align: $2"$3>');chrome.tabs.query({active:!0,currentWindow:!0},n=>{const s=n[0];if(!(s!=null&&s.id)){e.error("No active tab found or tab ID is undefined",void 0,{sourceFile:yb,functionName:"insertHtmlIntoComposeBoxLegacy"});return}chrome.scripting.executeScript({target:{tabId:s.id},func:i=>{console.debug("Script executing in tab context");function c(){return document.querySelector('div[role="textbox"][aria-label="Message Body"]')||document.querySelector('div[aria-label="Message body, press Alt+F10 to exit"]')}function d(m,g){document.execCommand("insertHTML",!1,g),console.debug("Inserted using execCommand fallback")}const p=c();if(p)console.debug("found composeBox: ",p);else{console.error("Compose box not found");return}try{p.focus(),navigator.clipboard&&navigator.clipboard.writeText?navigator.clipboard.writeText(i).then(()=>{document.execCommand("paste"),console.debug("Pasted using Clipboard API")}).catch(m=>{console.warn("Clipboard API failed, using fallback:",m),d(p,i)}):d(p,i)}catch(m){console.error("Error during paste operation:",m)}},args:[t]}).catch(i=>{e.error("Error executing script",i,{sourceFile:yb,functionName:"insertHtmlIntoComposeBoxLegacy"})})})}const _7="src/lib/types/Template.ts",Gk=async(r,e)=>{const t="GetTemplateWithContentFromServerTemplate";try{const n=r.source;if(!n)throw new Error("Source value is undefined");const s={...r,source:n};return{id:s.template_id,timeStamp:Date.now(),title:s.templateName,description:s.templateDescription,tags:s.tags||[],source:s.source==="SCOPE_USER"?"personal":"org",content:s.templateBody}}catch(n){throw e.error("Error getting template content",n,{sourceFile:_7,functionName:t,templateId:r.template_id}),n}},Pl="src/lib/utils/templateUtils.tsx",Wk=async(r,e=!0)=>{const t="getAllTemplatesWithContent";try{const n=await X6(r);r.debug("Templates from server",{sourceFile:Pl,functionName:t,userCount:n.user_templates.length,orgCount:n.org_templates.length});const s=async g=>{const x="fetchPersonalTemplateWithErrorHandling";try{const b={...g,source:g.source||"SCOPE_USER"};return r.debug("Fetching personal template",{sourceFile:Pl,functionName:x,templateId:b.template_id,scope:b.source}),await Gk(b,r)}catch(b){return r.error("Failed to load personal template",b,{sourceFile:Pl,functionName:x,templateId:g.template_id}),null}},i=async g=>{const x="fetchOrgTemplateWithErrorHandling";try{const b={...g,source:g.source||"SCOPE_TENANT"};return r.debug("Fetching org template",{sourceFile:Pl,functionName:x,templateId:b.template_id,scope:b.source}),await Gk(b,r)}catch(b){return r.error("Failed to load org template",b,{sourceFile:Pl,functionName:x,templateId:g.template_id}),null}};let c=[];e&&(c=await Promise.all(n.user_templates.map(s)));const d=c.filter(Boolean),m=(await Promise.all(n.org_templates.map(i))).filter(Boolean);return r.info("Loaded templates",{sourceFile:Pl,functionName:t,personalLoaded:d.length,personalTotal:n.user_templates.length,orgLoaded:m.length,orgTotal:n.org_templates.length}),e&&await AU(r,d),await IU(r,m),[...d,...m]}catch(n){r.error("Error in getAllTemplatesWithContent",n,{sourceFile:Pl,functionName:t}),r.info("Falling back to cached templates from local storage",{sourceFile:Pl,functionName:t});const s=await tT(r),i=await rT(r);return[...s,...i]}},E7=async r=>{const e="getTemplatesFromLocalStorage";try{const[t,n]=await Promise.all([tT(r),rT(r)]);return[...t,...n]}catch(t){return r.error("Error getting templates from local storage",t,{sourceFile:Pl,functionName:e}),[]}};async function Vk(r,{signalType:e,signalValue:t}){localStorage.setItem(e,t);try{const s=(await Vn.createServices()).tabs;s.openOptionsPage?await s.openOptionsPage():r.error("Tabs provider does not support options page",new Error("Tabs provider does not support options page"),{sourceFile:"src/shared/lib/utils/optionsUtils.ts",sourceFunction:"openOrFocusOptionsPage"})}catch(n){r.error("Error opening options page",n,{sourceFile:"src/shared/lib/utils/optionsUtils.ts",sourceFunction:"openOrFocusOptionsPage"})}}const bE=({feature:r,description:e,benefits:t=[],className:n="",variant:s="card"})=>{const{isConnected:i,isLoading:c,error:d,status:p,initiateReconnection:m}=ra(),{platform:g}=cn();if(g!=="chrome"||i)return null;const x=async()=>{try{await m()}catch(T){console.error("Failed to reconnect Gmail:",T)}},b=()=>p==="loading"?u.jsx(No,{className:"h-5 w-5 text-blue-600 animate-spin"}):p==="error"?u.jsx(oh,{className:"h-5 w-5 text-red-600"}):u.jsx(Kc,{className:"h-5 w-5 text-amber-600"}),E=()=>p==="loading"?"Checking Gmail connection...":p==="error"?d||"Gmail connection error occurred":"Gmail connection required";return s==="banner"?u.jsxs("div",{className:`flex items-center justify-between bg-amber-50 border border-amber-200 px-4 py-3 rounded-lg ${n}`,children:[u.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[b(),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("p",{className:"text-sm font-medium text-amber-800",children:E()}),u.jsx("p",{className:"text-sm text-amber-700 mt-1",children:e||`Connect Gmail to access ${r} features.`})]})]}),u.jsx(ze,{onClick:x,disabled:c,variant:"outline",size:"sm",className:"bg-amber-100 border-amber-300 text-amber-800 hover:bg-amber-200 hover:border-amber-400 whitespace-nowrap ml-4",children:c?u.jsxs(u.Fragment,{children:[u.jsx(No,{className:"h-4 w-4 mr-2 animate-spin"}),"Connecting..."]}):"Connect Gmail"})]}):s==="inline"?u.jsxs("div",{className:`flex items-center gap-2 text-amber-700 ${n}`,children:[b(),u.jsx("span",{className:"text-sm",children:E()}),u.jsx(ze,{onClick:x,disabled:c,variant:"link",size:"sm",className:"h-auto p-0 text-amber-700 hover:text-amber-800",children:"Connect Gmail"})]}):u.jsx(_i,{className:`${n}`,children:u.jsx(Ei,{className:"p-6",children:u.jsxs("div",{className:"flex items-start gap-4",children:[u.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-amber-100 rounded-full flex items-center justify-center",children:b()}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("h3",{className:"text-base font-semibold text-gray-900 mb-2",children:"Gmail Connection Required"}),u.jsx("p",{className:"text-gray-600 mb-4",children:e||`To access ${r}, you need to connect your Gmail account first.`}),t.length>0&&u.jsxs("div",{className:"mb-4",children:[u.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"What you'll get with Gmail connected:"}),u.jsx("ul",{className:"text-sm text-gray-600 space-y-1",children:t.map((T,S)=>u.jsxs("li",{className:"flex items-start gap-2",children:[u.jsx(Wc,{className:"h-4 w-4 text-green-600 mt-0.5 flex-shrink-0"}),u.jsx("span",{children:T})]},S))})]}),d&&u.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-3 mb-4",children:u.jsx("p",{className:"text-sm text-red-800",children:d})}),u.jsx("div",{className:"flex items-center gap-3",children:u.jsx(ze,{onClick:x,disabled:c,className:"bg-blue-600 hover:bg-blue-700",children:c?u.jsxs(u.Fragment,{children:[u.jsx(No,{className:"h-4 w-4 mr-2 animate-spin"}),"Connecting..."]}):u.jsxs(u.Fragment,{children:[u.jsx(Kc,{className:"h-4 w-4 mr-2"}),"Connect Gmail"]})})})]})]})})})},Js="src/sidepanel/panels/TemplatesPanel.tsx",S7=({clientEmail:r,isAuthenticated:e})=>{const t=Ur(),{platform:n}=cn(),{isConnected:s}=ra(),[i,c]=w.useState(""),[d,p]=w.useState([]),[m,g]=w.useState(!1),[x,b]=w.useState([]),[E,T]=w.useState([]),[S,N]=w.useState("all"),[R,A]=w.useState([]),[j,P]=w.useState(!0),[$,W]=w.useState(!1),[M,V]=w.useState(null),X=w.useRef(null),ie=w.useRef(null);w.useEffect(()=>{function U(ne){m&&X.current&&!X.current.contains(ne.target)&&ie.current&&!ie.current.contains(ne.target)&&g(!1)}return document.addEventListener("mousedown",U),()=>{document.removeEventListener("mousedown",U)}},[m]),w.useEffect(()=>{function U(ne){M&&!ne.target.closest("[data-radix-hover-card-content]")&&V(null)}return M&&document.addEventListener("mousedown",U),()=>{document.removeEventListener("mousedown",U)}},[M]),w.useEffect(()=>{if(R.length>0){const U=R.filter(ne=>{var Ee,q,le,xe,ye;return(S==="all"||S==="org"&&ne.source==="org"||S==="personal"&&ne.source!=="org")&&(((Ee=ne.title)==null?void 0:Ee.toLowerCase().includes(i.toLowerCase()))||((q=ne.content)==null?void 0:q.toLowerCase().includes(i.toLowerCase()))||((le=ne.tags)==null?void 0:le.some(de=>de.toLowerCase().includes(i.toLowerCase())))||((xe=ne.description)==null?void 0:xe.toLowerCase().includes(i.toLowerCase())))&&(x.length===0||((ye=ne.tags)==null?void 0:ye.some(de=>x.includes(de))))});if(i.trim()){const ne=U.sort((Ee,q)=>{const le=i.toLowerCase(),xe=Te=>{var Be,Ge,Me,Ae;return(Be=Te.tags)!=null&&Be.some(ct=>ct.toLowerCase().includes(le))?1:(Ge=Te.title)!=null&&Ge.toLowerCase().includes(le)?2:(Me=Te.description)!=null&&Me.toLowerCase().includes(le)?3:(Ae=Te.content)!=null&&Ae.toLowerCase().includes(le)?4:5},ye=xe(Ee),de=xe(q);return ye!==de?ye-de:(Ee.title||"").localeCompare(q.title||"")});p(ne)}else p(U)}},[R,i,x,S]),w.useEffect(()=>{if(!e){t.debug("Skipping template loading - user not authenticated",{sourceFile:Js,isAuthenticated:e});return}const U=async()=>{P(!0);const ne="loadTemplatesDirectly";try{t.info("Loading templates directly from server (like options page)",{sourceFile:Js,functionName:ne});const Ee=await Wk(t,!0);if(Ee.length>0){t.info("Templates loaded successfully",{sourceFile:Js,functionName:ne,count:Ee.length}),A(Ee);const q=await ly(t);let le=[];q.id!==""&&(le=q.templateConfiguration.tags||[]);const xe=new Set(le);Ee.forEach(ye=>{ye.tags&&Array.isArray(ye.tags)&&ye.tags.forEach(de=>xe.add(de))}),T(Array.from(xe))}else t.info("No templates found!",{sourceFile:Js,functionName:ne}),A([])}catch(Ee){t.error("Error loading templates directly from server",Ee,{sourceFile:Js,functionName:ne});try{const q=await E7(t);t.info("Fallback to local storage successful",{sourceFile:Js,functionName:ne,count:q.length}),A(q)}catch(q){t.error("Fallback to local storage also failed",q,{sourceFile:Js,functionName:ne}),A([])}}finally{P(!1)}};t.info("TemplatesPanel initialized, loading templates directly from server",{sourceFile:Js,isAuthenticated:e}),U()},[t,e]);const J=w.useCallback(async()=>{if($)return;W(!0);const U="refreshTemplates";t.info("Starting template refresh from server",{sourceFile:Js,functionName:U});try{const ne=await ly(t);let Ee=[];ne.id!==""?(t.debug("configuration loaded from storage",{sourceFile:Js,functionName:U,config:ne}),Ee=ne.templateConfiguration.tags||[]):t.warn("No configuration found in storage",{sourceFile:Js,functionName:U}),t.info("Calling getAllTemplatesWithContent",{sourceFile:Js,functionName:U});const q=await Wk(t,!0);t.info("getAllTemplatesWithContent completed",{sourceFile:Js,functionName:U,templateCount:q.length});const le=new Set(Ee);q.forEach(ye=>{ye.tags&&Array.isArray(ye.tags)&&ye.tags.forEach(de=>le.add(de))});const xe=Array.from(le);t.info("Template refresh successful",{sourceFile:Js,functionName:U,templateCount:q.length,tagsCount:xe.length,templates:q.map(ye=>({title:ye.title,tags:ye.tags,source:ye.source}))}),T(xe),A(q)}catch(ne){t.error("Error refreshing templates from server",ne,{sourceFile:Js,functionName:U}),console.error("Template loading failed:",ne)}finally{W(!1)}},[$,t]),ae=()=>{g(!m)},we=U=>{b(ne=>ne.includes(U)?ne.filter(Ee=>Ee!==U):[...ne,U])},ue=U=>{V(ne=>ne===U?null:U)},[oe,pe]=w.useState(!1),te=w.useRef(null),B=w.useRef(null);w.useEffect(()=>{function U(ne){oe&&te.current&&!te.current.contains(ne.target)&&B.current&&!B.current.contains(ne.target)&&pe(!1)}return document.addEventListener("mousedown",U),()=>{document.removeEventListener("mousedown",U)}},[oe]);const z=()=>{pe(!oe)},Y=U=>{N(U),pe(!1)};return n==="chrome"&&!s?u.jsx("div",{className:"p-4",children:u.jsx(bE,{feature:"Templates",description:"Connect your Gmail account to access and insert email templates",benefits:["Access all your personal and organization templates","Insert template content directly into compose box","Search and filter templates by tags and content"]})}):u.jsxs("div",{className:"space-y-4 h-full",children:[u.jsxs("div",{className:"relative",children:[u.jsx(on,{type:"text",placeholder:"Search templates...",value:i,onChange:U=>c(U.target.value),className:"pl-10 pr-12"}),u.jsx(eo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:18}),u.jsx(ze,{ref:ie,variant:"outline",className:"absolute right-0 top-1/2 transform -translate-y-1/2",onClick:ae,children:u.jsx(Qx,{})}),m&&u.jsx("div",{ref:X,className:"absolute right-0 mt-2 w-48 bg-white dark:bg-card border dark:border-border rounded shadow-lg z-10",children:E.length>0?E.map(U=>u.jsxs("label",{className:"block px-4 py-2 hover:bg-gray-50 dark:hover:bg-muted cursor-pointer text-gray-900 dark:text-gray-200",children:[u.jsx("input",{type:"checkbox",className:"mr-2",checked:x.includes(U),onChange:()=>we(U)}),U]},U)):u.jsx("div",{className:"px-4 py-2 text-gray-500",children:"No tags available"})})]}),u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"relative",children:[u.jsxs(ze,{ref:B,variant:"outline",size:"sm",onClick:z,className:"flex items-center hover:bg-blue-50",children:[S==="all"&&u.jsxs(u.Fragment,{children:[u.jsx(Qx,{className:"mr-2 h-4 w-4"}),"All Templates (",d.length,")"]}),S==="personal"&&u.jsxs(u.Fragment,{children:[u.jsx(ky,{className:"mr-2 h-4 w-4"}),"Personal Only (",d.length,")"]}),S==="org"&&u.jsxs(u.Fragment,{children:[u.jsx(Xx,{className:"mr-2 h-4 w-4"}),"Org Only (",d.length,")"]})]}),oe&&u.jsxs("div",{ref:te,className:"absolute left-0 mt-1 w-40 bg-white dark:bg-card border dark:border-border rounded shadow-lg z-10",children:[S!=="all"&&u.jsxs("div",{className:"px-4 py-2 hover:bg-gray-50 dark:hover:bg-muted cursor-pointer flex items-center text-gray-900 dark:text-gray-200",onClick:()=>Y("all"),children:[u.jsx(Qx,{className:"mr-2 h-4 w-4"}),"All Templates"]}),S!=="personal"&&u.jsxs("div",{className:"px-4 py-2 hover:bg-gray-50 dark:hover:bg-muted cursor-pointer flex items-center text-gray-900 dark:text-gray-200",onClick:()=>Y("personal"),children:[u.jsx(ky,{className:"mr-2 h-4 w-4"}),"Personal Only"]}),S!=="org"&&R.filter(U=>U.source==="org").length>0&&u.jsxs("div",{className:"px-4 py-2 hover:bg-gray-50 dark:hover:bg-muted cursor-pointer flex items-center text-gray-900 dark:text-gray-200",onClick:()=>Y("org"),children:[u.jsx(Xx,{className:"mr-2 h-4 w-4"}),"Org Only"]})]})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(ze,{size:"icon",className:"rounded-lg bg-blue-600 text-white hover:bg-blue-700 hover:text-white dark:bg-blue-600 dark:text-white dark:hover:bg-blue-700 border border-blue-600 dark:border-blue-600",title:"Add Template",onClick:()=>{Vk(t,{signalType:"openCreateTemplate",signalValue:"true"})},children:u.jsx(iB,{className:"w-5 h-5"})}),u.jsx(ze,{variant:"outline",size:"icon",className:"rounded-lg hover:bg-blue-50",title:"Refresh Templates",onClick:J,disabled:$||j,children:u.jsx(No,{className:`w-5 h-5 ${$?"animate-spin":""}`})})]})]}),j?u.jsxs("div",{className:"flex justify-center items-center py-12",children:[u.jsx(Zi,{className:"h-8 w-8 animate-spin text-blue-600"}),u.jsx("span",{className:"ml-2 text-gray-600",children:"Loading templates..."})]}):u.jsxs("div",{className:"overflow-y-auto h-full pb-2",children:[d.map(U=>u.jsxs(_i,{className:"animate-fadeIn relative mb-2",children:[u.jsxs(Ji,{children:[u.jsx(Xi,{className:"text-sm flex items-center",children:U.title}),U.tags&&U.tags.length>0&&u.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:U.tags.map((ne,Ee)=>u.jsx("span",{className:"inline-block bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full",children:ne},Ee))})]}),u.jsxs(Ei,{children:[u.jsx("p",{className:"text-xs mb-2 overflow-hidden text-ellipsis max-h-[50px]",children:U.description}),u.jsxs("div",{className:"flex space-x-2",children:[u.jsx(ze,{className:"flex-1 text-xs py-1 bg-blue-600 text-white hover:bg-blue-700 hover:text-white dark:bg-blue-600 dark:text-white dark:hover:bg-blue-700 w-1/2 border border-blue-600 dark:border-blue-600",onClick:()=>{IA(U.content,t)},children:u.jsxs("span",{className:"flex items-center justify-center w-full",children:[u.jsx(KR,{className:"w-4 h-4 flex-shrink-0 mr-1 rotate-90"}),u.jsx("span",{className:"hide-text-when-narrow",children:"Insert"})]})}),u.jsxs(v7,{open:M===U.id?!0:void 0,onOpenChange:ne=>{!ne&&M===U.id&&V(null)},openDelay:0,closeDelay:100,children:[u.jsx(y7,{asChild:!0,children:u.jsx(ze,{variant:"outline",className:`text-xs py-1 bg-white dark:bg-card text-black dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-muted hover:text-blue-600 dark:hover:text-blue-400 w-1/4 ${M===U.id?"bg-gray-100 dark:bg-muted text-blue-600 dark:text-blue-400":""}`,onClick:ne=>{ne.preventDefault(),ue(U.id)},children:u.jsxs("span",{className:"flex items-center justify-center w-full",children:[u.jsx(cB,{className:"w-4 h-4 flex-shrink-0 mr-1"}),u.jsx("span",{className:"hide-text-when-narrow",children:"View"})]})})}),u.jsxs(x7,{className:"bg-white dark:bg-card border-2 mt-8 mr-8 border-gray-200 dark:border-border rounded-md text-gray-700 dark:text-gray-200 p-4 z-50 overflow-auto",align:"center",side:"top",style:{maxHeight:"40vh",maxWidth:"80vw",width:"auto",height:"auto",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.15)"},children:[u.jsx("div",{dangerouslySetInnerHTML:{__html:U.content}}),u.jsx(w7,{className:"fill-blue-500"})]})]}),U.source==="org"?u.jsx("div",{className:"w-1/4 flex items-center",title:"Organization templates can only be edited by an admin.",children:u.jsxs("span",{className:"text-xs py-1 px-2 bg-blue-100 text-blue-800 border border-blue-300 flex items-center justify-center w-full rounded-full",children:[u.jsx(Xx,{className:"w-4 h-4 flex-shrink-0 mr-1"}),u.jsx("span",{className:"hide-text-when-narrow",children:"Org"})]})}):u.jsx(ze,{variant:"outline",className:"text-xs py-1 bg-white dark:bg-card text-black dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-muted w-1/4",title:"Edit Template",onClick:()=>{Vk(t,{signalType:"editTemplateId",signalValue:U.id})},children:u.jsxs("span",{className:"flex items-center justify-center w-full",children:[u.jsx(vB,{className:"w-4 h-4 flex-shrink-0 mr-1"}),u.jsx("span",{className:"hide-text-when-narrow",children:"Edit"})]})})]})]})]},U.id)),d.length===0&&u.jsxs("div",{className:"mt-8 text-center text-gray-500",children:[u.jsx("p",{children:"No templates found matching your criteria."}),u.jsx("p",{className:"text-sm mt-2",children:"Try adjusting your filters or search terms."})]})]})]})},Mc=({src:r,width:e,height:t,alt:n,className:s})=>{const i=r.startsWith("/")?`${WN}${r}`:r;return u.jsx("img",{src:i,width:e,height:t,alt:n,className:s})},rw=({options:r,value:e,onChange:t})=>u.jsx("div",{className:"flex rounded-md shadow-sm",children:r.map(n=>u.jsx(ze,{variant:e===n?"default":"outline",className:`flex-1 text-xs ${e===n?"":"text-muted-foreground"}`,onClick:()=>t(n),children:n},n))});/*! @license DOMPurify 3.3.1 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.1/LICENSE */const{entries:PA,setPrototypeOf:qk,isFrozen:C7,getPrototypeOf:k7,getOwnPropertyDescriptor:N7}=Object;let{freeze:to,seal:Ti,create:xb}=Object,{apply:wb,construct:bb}=typeof Reflect<"u"&&Reflect;to||(to=function(e){return e});Ti||(Ti=function(e){return e});wb||(wb=function(e,t){for(var n=arguments.length,s=new Array(n>2?n-2:0),i=2;i<n;i++)s[i-2]=arguments[i];return e.apply(t,s)});bb||(bb=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];return new e(...n)});const Ov=ro(Array.prototype.forEach),T7=ro(Array.prototype.lastIndexOf),Kk=ro(Array.prototype.pop),tm=ro(Array.prototype.push),R7=ro(Array.prototype.splice),ey=ro(String.prototype.toLowerCase),nw=ro(String.prototype.toString),sw=ro(String.prototype.match),rm=ro(String.prototype.replace),A7=ro(String.prototype.indexOf),I7=ro(String.prototype.trim),Yi=ro(Object.prototype.hasOwnProperty),Xs=ro(RegExp.prototype.test),nm=P7(TypeError);function ro(r){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];return wb(r,e,n)}}function P7(r){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return bb(r,t)}}function ir(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ey;qk&&qk(r,null);let n=e.length;for(;n--;){let s=e[n];if(typeof s=="string"){const i=t(s);i!==s&&(C7(e)||(e[n]=i),s=i)}r[s]=!0}return r}function F7(r){for(let e=0;e<r.length;e++)Yi(r,e)||(r[e]=null);return r}function Oa(r){const e=xb(null);for(const[t,n]of PA(r))Yi(r,t)&&(Array.isArray(n)?e[t]=F7(n):n&&typeof n=="object"&&n.constructor===Object?e[t]=Oa(n):e[t]=n);return e}function sm(r,e){for(;r!==null;){const n=N7(r,e);if(n){if(n.get)return ro(n.get);if(typeof n.value=="function")return ro(n.value)}r=k7(r)}function t(){return null}return t}const Yk=to(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),ow=to(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),iw=to(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),j7=to(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),aw=to(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),O7=to(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Jk=to(["#text"]),Xk=to(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),lw=to(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Qk=to(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Dv=to(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),D7=Ti(/\{\{[\w\W]*|[\w\W]*\}\}/gm),L7=Ti(/<%[\w\W]*|[\w\W]*%>/gm),M7=Ti(/\$\{[\w\W]*/gm),$7=Ti(/^data-[\-\w.\u00B7-\uFFFF]+$/),U7=Ti(/^aria-[\-\w]+$/),FA=Ti(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),z7=Ti(/^(?:\w+script|data):/i),H7=Ti(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),jA=Ti(/^html$/i),B7=Ti(/^[a-z][.\w]*(-[.\w]+)+$/i);var Zk=Object.freeze({__proto__:null,ARIA_ATTR:U7,ATTR_WHITESPACE:H7,CUSTOM_ELEMENT:B7,DATA_ATTR:$7,DOCTYPE_NAME:jA,ERB_EXPR:L7,IS_ALLOWED_URI:FA,IS_SCRIPT_OR_DATA:z7,MUSTACHE_EXPR:D7,TMPLIT_EXPR:M7});const om={element:1,text:3,progressingInstruction:7,comment:8,document:9},G7=function(){return typeof window>"u"?null:window},W7=function(e,t){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let n=null;const s="data-tt-policy-suffix";t&&t.hasAttribute(s)&&(n=t.getAttribute(s));const i="dompurify"+(n?"#"+n:"");try{return e.createPolicy(i,{createHTML(c){return c},createScriptURL(c){return c}})}catch{return console.warn("TrustedTypes policy "+i+" could not be created."),null}},e1=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function OA(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:G7();const e=at=>OA(at);if(e.version="3.3.1",e.removed=[],!r||!r.document||r.document.nodeType!==om.document||!r.Element)return e.isSupported=!1,e;let{document:t}=r;const n=t,s=n.currentScript,{DocumentFragment:i,HTMLTemplateElement:c,Node:d,Element:p,NodeFilter:m,NamedNodeMap:g=r.NamedNodeMap||r.MozNamedAttrMap,HTMLFormElement:x,DOMParser:b,trustedTypes:E}=r,T=p.prototype,S=sm(T,"cloneNode"),N=sm(T,"remove"),R=sm(T,"nextSibling"),A=sm(T,"childNodes"),j=sm(T,"parentNode");if(typeof c=="function"){const at=t.createElement("template");at.content&&at.content.ownerDocument&&(t=at.content.ownerDocument)}let P,$="";const{implementation:W,createNodeIterator:M,createDocumentFragment:V,getElementsByTagName:X}=t,{importNode:ie}=n;let J=e1();e.isSupported=typeof PA=="function"&&typeof j=="function"&&W&&W.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:ae,ERB_EXPR:we,TMPLIT_EXPR:ue,DATA_ATTR:oe,ARIA_ATTR:pe,IS_SCRIPT_OR_DATA:te,ATTR_WHITESPACE:B,CUSTOM_ELEMENT:z}=Zk;let{IS_ALLOWED_URI:Y}=Zk,O=null;const U=ir({},[...Yk,...ow,...iw,...aw,...Jk]);let ne=null;const Ee=ir({},[...Xk,...lw,...Qk,...Dv]);let q=Object.seal(xb(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),le=null,xe=null;const ye=Object.seal(xb(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let de=!0,Te=!0,Be=!1,Ge=!0,Me=!1,Ae=!0,ct=!1,Bt=!1,yt=!1,sr=!1,Gt=!1,Zt=!1,Kt=!0,Kr=!1;const _t="user-content-";let Se=!0,$e=!1,Nt={},it=null;const dt=ir({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Ut=null;const Or=ir({},["audio","video","img","source","image","track"]);let Ke=null;const Pt=ir({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Lt="http://www.w3.org/1998/Math/MathML",et="http://www.w3.org/2000/svg",er="http://www.w3.org/1999/xhtml";let zr=er,kr=!1,wn=null;const Dr=ir({},[Lt,et,er],nw);let Yr=ir({},["mi","mo","mn","ms","mtext"]),Nn=ir({},["annotation-xml"]);const xs=ir({},["title","style","font","a","script"]);let Us=null;const To=["application/xhtml+xml","text/html"],Ai="text/html";let Nr=null,Dn=null;const ve=t.createElement("form"),Ue=function(Z){return Z instanceof RegExp||Z instanceof Function},ht=function(){let Z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Dn&&Dn===Z)){if((!Z||typeof Z!="object")&&(Z={}),Z=Oa(Z),Us=To.indexOf(Z.PARSER_MEDIA_TYPE)===-1?Ai:Z.PARSER_MEDIA_TYPE,Nr=Us==="application/xhtml+xml"?nw:ey,O=Yi(Z,"ALLOWED_TAGS")?ir({},Z.ALLOWED_TAGS,Nr):U,ne=Yi(Z,"ALLOWED_ATTR")?ir({},Z.ALLOWED_ATTR,Nr):Ee,wn=Yi(Z,"ALLOWED_NAMESPACES")?ir({},Z.ALLOWED_NAMESPACES,nw):Dr,Ke=Yi(Z,"ADD_URI_SAFE_ATTR")?ir(Oa(Pt),Z.ADD_URI_SAFE_ATTR,Nr):Pt,Ut=Yi(Z,"ADD_DATA_URI_TAGS")?ir(Oa(Or),Z.ADD_DATA_URI_TAGS,Nr):Or,it=Yi(Z,"FORBID_CONTENTS")?ir({},Z.FORBID_CONTENTS,Nr):dt,le=Yi(Z,"FORBID_TAGS")?ir({},Z.FORBID_TAGS,Nr):Oa({}),xe=Yi(Z,"FORBID_ATTR")?ir({},Z.FORBID_ATTR,Nr):Oa({}),Nt=Yi(Z,"USE_PROFILES")?Z.USE_PROFILES:!1,de=Z.ALLOW_ARIA_ATTR!==!1,Te=Z.ALLOW_DATA_ATTR!==!1,Be=Z.ALLOW_UNKNOWN_PROTOCOLS||!1,Ge=Z.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Me=Z.SAFE_FOR_TEMPLATES||!1,Ae=Z.SAFE_FOR_XML!==!1,ct=Z.WHOLE_DOCUMENT||!1,sr=Z.RETURN_DOM||!1,Gt=Z.RETURN_DOM_FRAGMENT||!1,Zt=Z.RETURN_TRUSTED_TYPE||!1,yt=Z.FORCE_BODY||!1,Kt=Z.SANITIZE_DOM!==!1,Kr=Z.SANITIZE_NAMED_PROPS||!1,Se=Z.KEEP_CONTENT!==!1,$e=Z.IN_PLACE||!1,Y=Z.ALLOWED_URI_REGEXP||FA,zr=Z.NAMESPACE||er,Yr=Z.MATHML_TEXT_INTEGRATION_POINTS||Yr,Nn=Z.HTML_INTEGRATION_POINTS||Nn,q=Z.CUSTOM_ELEMENT_HANDLING||{},Z.CUSTOM_ELEMENT_HANDLING&&Ue(Z.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(q.tagNameCheck=Z.CUSTOM_ELEMENT_HANDLING.tagNameCheck),Z.CUSTOM_ELEMENT_HANDLING&&Ue(Z.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(q.attributeNameCheck=Z.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),Z.CUSTOM_ELEMENT_HANDLING&&typeof Z.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(q.allowCustomizedBuiltInElements=Z.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Me&&(Te=!1),Gt&&(sr=!0),Nt&&(O=ir({},Jk),ne=[],Nt.html===!0&&(ir(O,Yk),ir(ne,Xk)),Nt.svg===!0&&(ir(O,ow),ir(ne,lw),ir(ne,Dv)),Nt.svgFilters===!0&&(ir(O,iw),ir(ne,lw),ir(ne,Dv)),Nt.mathMl===!0&&(ir(O,aw),ir(ne,Qk),ir(ne,Dv))),Z.ADD_TAGS&&(typeof Z.ADD_TAGS=="function"?ye.tagCheck=Z.ADD_TAGS:(O===U&&(O=Oa(O)),ir(O,Z.ADD_TAGS,Nr))),Z.ADD_ATTR&&(typeof Z.ADD_ATTR=="function"?ye.attributeCheck=Z.ADD_ATTR:(ne===Ee&&(ne=Oa(ne)),ir(ne,Z.ADD_ATTR,Nr))),Z.ADD_URI_SAFE_ATTR&&ir(Ke,Z.ADD_URI_SAFE_ATTR,Nr),Z.FORBID_CONTENTS&&(it===dt&&(it=Oa(it)),ir(it,Z.FORBID_CONTENTS,Nr)),Z.ADD_FORBID_CONTENTS&&(it===dt&&(it=Oa(it)),ir(it,Z.ADD_FORBID_CONTENTS,Nr)),Se&&(O["#text"]=!0),ct&&ir(O,["html","head","body"]),O.table&&(ir(O,["tbody"]),delete le.tbody),Z.TRUSTED_TYPES_POLICY){if(typeof Z.TRUSTED_TYPES_POLICY.createHTML!="function")throw nm('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof Z.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw nm('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');P=Z.TRUSTED_TYPES_POLICY,$=P.createHTML("")}else P===void 0&&(P=W7(E,s)),P!==null&&typeof $=="string"&&($=P.createHTML(""));to&&to(Z),Dn=Z}},It=ir({},[...ow,...iw,...j7]),zt=ir({},[...aw,...O7]),lr=function(Z){let Oe=j(Z);(!Oe||!Oe.tagName)&&(Oe={namespaceURI:zr,tagName:"template"});const Ze=ey(Z.tagName),Tr=ey(Oe.tagName);return wn[Z.namespaceURI]?Z.namespaceURI===et?Oe.namespaceURI===er?Ze==="svg":Oe.namespaceURI===Lt?Ze==="svg"&&(Tr==="annotation-xml"||Yr[Tr]):!!It[Ze]:Z.namespaceURI===Lt?Oe.namespaceURI===er?Ze==="math":Oe.namespaceURI===et?Ze==="math"&&Nn[Tr]:!!zt[Ze]:Z.namespaceURI===er?Oe.namespaceURI===et&&!Nn[Tr]||Oe.namespaceURI===Lt&&!Yr[Tr]?!1:!zt[Ze]&&(xs[Ze]||!It[Ze]):!!(Us==="application/xhtml+xml"&&wn[Z.namespaceURI]):!1},mt=function(Z){tm(e.removed,{element:Z});try{j(Z).removeChild(Z)}catch{N(Z)}},Tt=function(Z,Oe){try{tm(e.removed,{attribute:Oe.getAttributeNode(Z),from:Oe})}catch{tm(e.removed,{attribute:null,from:Oe})}if(Oe.removeAttribute(Z),Z==="is")if(sr||Gt)try{mt(Oe)}catch{}else try{Oe.setAttribute(Z,"")}catch{}},wr=function(Z){let Oe=null,Ze=null;if(yt)Z="<remove></remove>"+Z;else{const Hr=sw(Z,/^[\r\n\t ]+/);Ze=Hr&&Hr[0]}Us==="application/xhtml+xml"&&zr===er&&(Z='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+Z+"</body></html>");const Tr=P?P.createHTML(Z):Z;if(zr===er)try{Oe=new b().parseFromString(Tr,Us)}catch{}if(!Oe||!Oe.documentElement){Oe=W.createDocument(zr,"template",null);try{Oe.documentElement.innerHTML=kr?$:Tr}catch{}}const Ht=Oe.body||Oe.documentElement;return Z&&Ze&&Ht.insertBefore(t.createTextNode(Ze),Ht.childNodes[0]||null),zr===er?X.call(Oe,ct?"html":"body")[0]:ct?Oe.documentElement:Ht},en=function(Z){return M.call(Z.ownerDocument||Z,Z,m.SHOW_ELEMENT|m.SHOW_COMMENT|m.SHOW_TEXT|m.SHOW_PROCESSING_INSTRUCTION|m.SHOW_CDATA_SECTION,null)},Ro=function(Z){return Z instanceof x&&(typeof Z.nodeName!="string"||typeof Z.textContent!="string"||typeof Z.removeChild!="function"||!(Z.attributes instanceof g)||typeof Z.removeAttribute!="function"||typeof Z.setAttribute!="function"||typeof Z.namespaceURI!="string"||typeof Z.insertBefore!="function"||typeof Z.hasChildNodes!="function")},aa=function(Z){return typeof d=="function"&&Z instanceof d};function ss(at,Z,Oe){Ov(at,Ze=>{Ze.call(e,Z,Oe,Dn)})}const zs=function(Z){let Oe=null;if(ss(J.beforeSanitizeElements,Z,null),Ro(Z))return mt(Z),!0;const Ze=Nr(Z.nodeName);if(ss(J.uponSanitizeElement,Z,{tagName:Ze,allowedTags:O}),Ae&&Z.hasChildNodes()&&!aa(Z.firstElementChild)&&Xs(/<[/\w!]/g,Z.innerHTML)&&Xs(/<[/\w!]/g,Z.textContent)||Z.nodeType===om.progressingInstruction||Ae&&Z.nodeType===om.comment&&Xs(/<[/\w]/g,Z.data))return mt(Z),!0;if(!(ye.tagCheck instanceof Function&&ye.tagCheck(Ze))&&(!O[Ze]||le[Ze])){if(!le[Ze]&&la(Ze)&&(q.tagNameCheck instanceof RegExp&&Xs(q.tagNameCheck,Ze)||q.tagNameCheck instanceof Function&&q.tagNameCheck(Ze)))return!1;if(Se&&!it[Ze]){const Tr=j(Z)||Z.parentNode,Ht=A(Z)||Z.childNodes;if(Ht&&Tr){const Hr=Ht.length;for(let un=Hr-1;un>=0;--un){const ws=S(Ht[un],!0);ws.__removalCount=(Z.__removalCount||0)+1,Tr.insertBefore(ws,R(Z))}}}return mt(Z),!0}return Z instanceof p&&!lr(Z)||(Ze==="noscript"||Ze==="noembed"||Ze==="noframes")&&Xs(/<\/no(script|embed|frames)/i,Z.innerHTML)?(mt(Z),!0):(Me&&Z.nodeType===om.text&&(Oe=Z.textContent,Ov([ae,we,ue],Tr=>{Oe=rm(Oe,Tr," ")}),Z.textContent!==Oe&&(tm(e.removed,{element:Z.cloneNode()}),Z.textContent=Oe)),ss(J.afterSanitizeElements,Z,null),!1)},Ii=function(Z,Oe,Ze){if(Kt&&(Oe==="id"||Oe==="name")&&(Ze in t||Ze in ve))return!1;if(!(Te&&!xe[Oe]&&Xs(oe,Oe))){if(!(de&&Xs(pe,Oe))){if(!(ye.attributeCheck instanceof Function&&ye.attributeCheck(Oe,Z))){if(!ne[Oe]||xe[Oe]){if(!(la(Z)&&(q.tagNameCheck instanceof RegExp&&Xs(q.tagNameCheck,Z)||q.tagNameCheck instanceof Function&&q.tagNameCheck(Z))&&(q.attributeNameCheck instanceof RegExp&&Xs(q.attributeNameCheck,Oe)||q.attributeNameCheck instanceof Function&&q.attributeNameCheck(Oe,Z))||Oe==="is"&&q.allowCustomizedBuiltInElements&&(q.tagNameCheck instanceof RegExp&&Xs(q.tagNameCheck,Ze)||q.tagNameCheck instanceof Function&&q.tagNameCheck(Ze))))return!1}else if(!Ke[Oe]){if(!Xs(Y,rm(Ze,B,""))){if(!((Oe==="src"||Oe==="xlink:href"||Oe==="href")&&Z!=="script"&&A7(Ze,"data:")===0&&Ut[Z])){if(!(Be&&!Xs(te,rm(Ze,B,"")))){if(Ze)return!1}}}}}}}return!0},la=function(Z){return Z!=="annotation-xml"&&sw(Z,z)},ca=function(Z){ss(J.beforeSanitizeAttributes,Z,null);const{attributes:Oe}=Z;if(!Oe||Ro(Z))return;const Ze={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:ne,forceKeepAttr:void 0};let Tr=Oe.length;for(;Tr--;){const Ht=Oe[Tr],{name:Hr,namespaceURI:un,value:ws}=Ht,os=Nr(Hr),ti=ws;let Br=Hr==="value"?ti:I7(ti);if(Ze.attrName=os,Ze.attrValue=Br,Ze.keepAttr=!0,Ze.forceKeepAttr=void 0,ss(J.uponSanitizeAttribute,Z,Ze),Br=Ze.attrValue,Kr&&(os==="id"||os==="name")&&(Tt(Hr,Z),Br=_t+Br),Ae&&Xs(/((--!?|])>)|<\/(style|title|textarea)/i,Br)){Tt(Hr,Z);continue}if(os==="attributename"&&sw(Br,"href")){Tt(Hr,Z);continue}if(Ze.forceKeepAttr)continue;if(!Ze.keepAttr){Tt(Hr,Z);continue}if(!Ge&&Xs(/\/>/i,Br)){Tt(Hr,Z);continue}Me&&Ov([ae,we,ue],Ln=>{Br=rm(Br,Ln," ")});const ri=Nr(Z.nodeName);if(!Ii(ri,os,Br)){Tt(Hr,Z);continue}if(P&&typeof E=="object"&&typeof E.getAttributeType=="function"&&!un)switch(E.getAttributeType(ri,os)){case"TrustedHTML":{Br=P.createHTML(Br);break}case"TrustedScriptURL":{Br=P.createScriptURL(Br);break}}if(Br!==ti)try{un?Z.setAttributeNS(un,Hr,Br):Z.setAttribute(Hr,Br),Ro(Z)?mt(Z):Kk(e.removed)}catch{Tt(Hr,Z)}}ss(J.afterSanitizeAttributes,Z,null)},qa=function at(Z){let Oe=null;const Ze=en(Z);for(ss(J.beforeSanitizeShadowDOM,Z,null);Oe=Ze.nextNode();)ss(J.uponSanitizeShadowNode,Oe,null),zs(Oe),ca(Oe),Oe.content instanceof i&&at(Oe.content);ss(J.afterSanitizeShadowDOM,Z,null)};return e.sanitize=function(at){let Z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Oe=null,Ze=null,Tr=null,Ht=null;if(kr=!at,kr&&(at="<!-->"),typeof at!="string"&&!aa(at))if(typeof at.toString=="function"){if(at=at.toString(),typeof at!="string")throw nm("dirty is not a string, aborting")}else throw nm("toString is not a function");if(!e.isSupported)return at;if(Bt||ht(Z),e.removed=[],typeof at=="string"&&($e=!1),$e){if(at.nodeName){const ws=Nr(at.nodeName);if(!O[ws]||le[ws])throw nm("root node is forbidden and cannot be sanitized in-place")}}else if(at instanceof d)Oe=wr("<!---->"),Ze=Oe.ownerDocument.importNode(at,!0),Ze.nodeType===om.element&&Ze.nodeName==="BODY"||Ze.nodeName==="HTML"?Oe=Ze:Oe.appendChild(Ze);else{if(!sr&&!Me&&!ct&&at.indexOf("<")===-1)return P&&Zt?P.createHTML(at):at;if(Oe=wr(at),!Oe)return sr?null:Zt?$:""}Oe&&yt&&mt(Oe.firstChild);const Hr=en($e?at:Oe);for(;Tr=Hr.nextNode();)zs(Tr),ca(Tr),Tr.content instanceof i&&qa(Tr.content);if($e)return at;if(sr){if(Gt)for(Ht=V.call(Oe.ownerDocument);Oe.firstChild;)Ht.appendChild(Oe.firstChild);else Ht=Oe;return(ne.shadowroot||ne.shadowrootmode)&&(Ht=ie.call(n,Ht,!0)),Ht}let un=ct?Oe.outerHTML:Oe.innerHTML;return ct&&O["!doctype"]&&Oe.ownerDocument&&Oe.ownerDocument.doctype&&Oe.ownerDocument.doctype.name&&Xs(jA,Oe.ownerDocument.doctype.name)&&(un="<!DOCTYPE "+Oe.ownerDocument.doctype.name+`>
`+un),Me&&Ov([ae,we,ue],ws=>{un=rm(un,ws," ")}),P&&Zt?P.createHTML(un):un},e.setConfig=function(){let at=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ht(at),Bt=!0},e.clearConfig=function(){Dn=null,Bt=!1},e.isValidAttribute=function(at,Z,Oe){Dn||ht({});const Ze=Nr(at),Tr=Nr(Z);return Ii(Ze,Tr,Oe)},e.addHook=function(at,Z){typeof Z=="function"&&tm(J[at],Z)},e.removeHook=function(at,Z){if(Z!==void 0){const Oe=T7(J[at],Z);return Oe===-1?void 0:R7(J[at],Oe,1)[0]}return Kk(J[at])},e.removeHooks=function(at){J[at]=[]},e.removeAllHooks=function(){J=e1()},e}OA();const cw=r=>{var s;const e=r.replace(/^```html\s*/,""),t=document.createElement("div");return t.innerHTML=e.replace(/style="[^"]*"/g,""),(((s=t.textContent)==null?void 0:s.replace(/(\n{2,}|[ \t]+\n+|\n+[ \t]+)/g,`
`))||"").trim()},_b=r=>r.replace(/&quot;/g,'"').replace(/\\"/g,'"').replace(/\\n/g,`
`).replace(/\n{3,}/g,`

`).replace(/\\n/g,`
`).replace(/\\'/g,"'").replace(/\\"/g,'"').replace(/\\\\/g,"\\").replace(/```html/g,"").replace(/```/g,"").replace(/^"/,"").replace(/"$/,"").replace(/\u2019/g,"'").replace(/\u2018/g,"'").replace(/\u201A/g,"'").replace(/\u201B/g,"'"),V7=({htmlString:r})=>{const e=()=>{const t=_b(r);return{__html:new DOMParser().parseFromString(t,"text/html").body.innerHTML}};return u.jsx("div",{className:"rich-text-content text-gray-800 dark:text-gray-200",style:{fontSize:"14px",lineHeight:"1.6",fontFamily:"Arial, sans-serif"},dangerouslySetInnerHTML:e()})},DA=w.forwardRef(({value:r,onChange:e,className:t,...n},s)=>{const i=w.useRef(null);w.useImperativeHandle(s,()=>i.current);const c=()=>{const d=i.current;d&&(d.style.height="auto",d.style.height=`${d.scrollHeight}px`)};return w.useEffect(()=>{c()},[r]),u.jsx("textarea",{ref:i,value:r,onChange:d=>{e&&e(d)},className:`auto-resizing-textarea ${t||""}`,...n})});DA.displayName="AutoResizingTextarea";var q7=Rb[" useId ".trim().toString()]||(()=>{}),K7=0;function Ul(r){const[e,t]=w.useState(q7());return Hl(()=>{t(n=>n??String(K7++))},[r]),e?`radix-${e}`:""}var uw="focusScope.autoFocusOnMount",dw="focusScope.autoFocusOnUnmount",t1={bubbles:!1,cancelable:!0},Y7="FocusScope",_E=w.forwardRef((r,e)=>{const{loop:t=!1,trapped:n=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...c}=r,[d,p]=w.useState(null),m=Wl(s),g=Wl(i),x=w.useRef(null),b=On(e,S=>p(S)),E=w.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;w.useEffect(()=>{if(n){let S=function(j){if(E.paused||!d)return;const P=j.target;d.contains(P)?x.current=P:Dc(x.current,{select:!0})},N=function(j){if(E.paused||!d)return;const P=j.relatedTarget;P!==null&&(d.contains(P)||Dc(x.current,{select:!0}))},R=function(j){if(document.activeElement===document.body)for(const $ of j)$.removedNodes.length>0&&Dc(d)};document.addEventListener("focusin",S),document.addEventListener("focusout",N);const A=new MutationObserver(R);return d&&A.observe(d,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",S),document.removeEventListener("focusout",N),A.disconnect()}}},[n,d,E.paused]),w.useEffect(()=>{if(d){n1.add(E);const S=document.activeElement;if(!d.contains(S)){const R=new CustomEvent(uw,t1);d.addEventListener(uw,m),d.dispatchEvent(R),R.defaultPrevented||(J7(tW(LA(d)),{select:!0}),document.activeElement===S&&Dc(d))}return()=>{d.removeEventListener(uw,m),setTimeout(()=>{const R=new CustomEvent(dw,t1);d.addEventListener(dw,g),d.dispatchEvent(R),R.defaultPrevented||Dc(S??document.body,{select:!0}),d.removeEventListener(dw,g),n1.remove(E)},0)}}},[d,m,g,E]);const T=w.useCallback(S=>{if(!t&&!n||E.paused)return;const N=S.key==="Tab"&&!S.altKey&&!S.ctrlKey&&!S.metaKey,R=document.activeElement;if(N&&R){const A=S.currentTarget,[j,P]=X7(A);j&&P?!S.shiftKey&&R===P?(S.preventDefault(),t&&Dc(j,{select:!0})):S.shiftKey&&R===j&&(S.preventDefault(),t&&Dc(P,{select:!0})):R===A&&S.preventDefault()}},[t,n,E.paused]);return u.jsx(jr.div,{tabIndex:-1,...c,ref:b,onKeyDown:T})});_E.displayName=Y7;function J7(r,{select:e=!1}={}){const t=document.activeElement;for(const n of r)if(Dc(n,{select:e}),document.activeElement!==t)return}function X7(r){const e=LA(r),t=r1(e,r),n=r1(e.reverse(),r);return[t,n]}function LA(r){const e=[],t=document.createTreeWalker(r,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const s=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||s?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;t.nextNode();)e.push(t.currentNode);return e}function r1(r,e){for(const t of r)if(!Q7(t,{upTo:e}))return t}function Q7(r,{upTo:e}){if(getComputedStyle(r).visibility==="hidden")return!0;for(;r;){if(e!==void 0&&r===e)return!1;if(getComputedStyle(r).display==="none")return!0;r=r.parentElement}return!1}function Z7(r){return r instanceof HTMLInputElement&&"select"in r}function Dc(r,{select:e=!1}={}){if(r&&r.focus){const t=document.activeElement;r.focus({preventScroll:!0}),r!==t&&Z7(r)&&e&&r.select()}}var n1=eW();function eW(){let r=[];return{add(e){const t=r[0];e!==t&&(t==null||t.pause()),r=s1(r,e),r.unshift(e)},remove(e){var t;r=s1(r,e),(t=r[0])==null||t.resume()}}}function s1(r,e){const t=[...r],n=t.indexOf(e);return n!==-1&&t.splice(n,1),t}function tW(r){return r.filter(e=>e.tagName!=="A")}var fw=0;function MA(){w.useEffect(()=>{const r=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",r[0]??o1()),document.body.insertAdjacentElement("beforeend",r[1]??o1()),fw++,()=>{fw===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),fw--}},[])}function o1(){const r=document.createElement("span");return r.setAttribute("data-radix-focus-guard",""),r.tabIndex=0,r.style.outline="none",r.style.opacity="0",r.style.position="fixed",r.style.pointerEvents="none",r}var ty="right-scroll-bar-position",ry="width-before-scroll-bar",rW="with-scroll-bars-hidden",nW="--removed-body-scroll-bar-size";function hw(r,e){return typeof r=="function"?r(e):r&&(r.current=e),r}function sW(r,e){var t=w.useState(function(){return{value:r,callback:e,facade:{get current(){return t.value},set current(n){var s=t.value;s!==n&&(t.value=n,t.callback(n,s))}}}})[0];return t.callback=e,t.facade}var oW=typeof window<"u"?w.useLayoutEffect:w.useEffect,i1=new WeakMap;function iW(r,e){var t=sW(null,function(n){return r.forEach(function(s){return hw(s,n)})});return oW(function(){var n=i1.get(t);if(n){var s=new Set(n),i=new Set(r),c=t.current;s.forEach(function(d){i.has(d)||hw(d,null)}),i.forEach(function(d){s.has(d)||hw(d,c)})}i1.set(t,r)},[r]),t}function aW(r){return r}function lW(r,e){e===void 0&&(e=aW);var t=[],n=!1,s={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return t.length?t[t.length-1]:r},useMedium:function(i){var c=e(i,n);return t.push(c),function(){t=t.filter(function(d){return d!==c})}},assignSyncMedium:function(i){for(n=!0;t.length;){var c=t;t=[],c.forEach(i)}t={push:function(d){return i(d)},filter:function(){return t}}},assignMedium:function(i){n=!0;var c=[];if(t.length){var d=t;t=[],d.forEach(i),c=t}var p=function(){var g=c;c=[],g.forEach(i)},m=function(){return Promise.resolve().then(p)};m(),t={push:function(g){c.push(g),m()},filter:function(g){return c=c.filter(g),t}}}};return s}function cW(r){r===void 0&&(r={});var e=lW(null);return e.options=La({async:!0,ssr:!1},r),e}var $A=function(r){var e=r.sideCar,t=RN(r,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=e.read();if(!n)throw new Error("Sidecar medium not found");return w.createElement(n,La({},t))};$A.isSideCarExport=!0;function uW(r,e){return r.useMedium(e),$A}var UA=cW(),pw=function(){},i0=w.forwardRef(function(r,e){var t=w.useRef(null),n=w.useState({onScrollCapture:pw,onWheelCapture:pw,onTouchMoveCapture:pw}),s=n[0],i=n[1],c=r.forwardProps,d=r.children,p=r.className,m=r.removeScrollBar,g=r.enabled,x=r.shards,b=r.sideCar,E=r.noRelative,T=r.noIsolation,S=r.inert,N=r.allowPinchZoom,R=r.as,A=R===void 0?"div":R,j=r.gapMode,P=RN(r,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),$=b,W=iW([t,e]),M=La(La({},P),s);return w.createElement(w.Fragment,null,g&&w.createElement($,{sideCar:UA,removeScrollBar:m,shards:x,noRelative:E,noIsolation:T,inert:S,setCallbacks:i,allowPinchZoom:!!N,lockRef:t,gapMode:j}),c?w.cloneElement(w.Children.only(d),La(La({},M),{ref:W})):w.createElement(A,La({},M,{className:p,ref:W}),d))});i0.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};i0.classNames={fullWidth:ry,zeroRight:ty};var dW=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function fW(){if(!document)return null;var r=document.createElement("style");r.type="text/css";var e=dW();return e&&r.setAttribute("nonce",e),r}function hW(r,e){r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}function pW(r){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(r)}var mW=function(){var r=0,e=null;return{add:function(t){r==0&&(e=fW())&&(hW(e,t),pW(e)),r++},remove:function(){r--,!r&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},gW=function(){var r=mW();return function(e,t){w.useEffect(function(){return r.add(e),function(){r.remove()}},[e&&t])}},zA=function(){var r=gW(),e=function(t){var n=t.styles,s=t.dynamic;return r(n,s),null};return e},vW={left:0,top:0,right:0,gap:0},mw=function(r){return parseInt(r||"",10)||0},yW=function(r){var e=window.getComputedStyle(document.body),t=e[r==="padding"?"paddingLeft":"marginLeft"],n=e[r==="padding"?"paddingTop":"marginTop"],s=e[r==="padding"?"paddingRight":"marginRight"];return[mw(t),mw(n),mw(s)]},xW=function(r){if(r===void 0&&(r="margin"),typeof window>"u")return vW;var e=yW(r),t=document.documentElement.clientWidth,n=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,n-t+e[2]-e[0])}},wW=zA(),ah="data-scroll-locked",bW=function(r,e,t,n){var s=r.left,i=r.top,c=r.right,d=r.gap;return t===void 0&&(t="margin"),`
  .`.concat(rW,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(d,"px ").concat(n,`;
  }
  body[`).concat(ah,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(n,";"),t==="margin"&&`
    padding-left: `.concat(s,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(c,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(d,"px ").concat(n,`;
    `),t==="padding"&&"padding-right: ".concat(d,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(ty,` {
    right: `).concat(d,"px ").concat(n,`;
  }
  
  .`).concat(ry,` {
    margin-right: `).concat(d,"px ").concat(n,`;
  }
  
  .`).concat(ty," .").concat(ty,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(ry," .").concat(ry,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(ah,`] {
    `).concat(nW,": ").concat(d,`px;
  }
`)},a1=function(){var r=parseInt(document.body.getAttribute(ah)||"0",10);return isFinite(r)?r:0},_W=function(){w.useEffect(function(){return document.body.setAttribute(ah,(a1()+1).toString()),function(){var r=a1()-1;r<=0?document.body.removeAttribute(ah):document.body.setAttribute(ah,r.toString())}},[])},EW=function(r){var e=r.noRelative,t=r.noImportant,n=r.gapMode,s=n===void 0?"margin":n;_W();var i=w.useMemo(function(){return xW(s)},[s]);return w.createElement(wW,{styles:bW(i,!e,s,t?"":"!important")})},Eb=!1;if(typeof window<"u")try{var Lv=Object.defineProperty({},"passive",{get:function(){return Eb=!0,!0}});window.addEventListener("test",Lv,Lv),window.removeEventListener("test",Lv,Lv)}catch{Eb=!1}var Bf=Eb?{passive:!1}:!1,SW=function(r){return r.tagName==="TEXTAREA"},HA=function(r,e){if(!(r instanceof Element))return!1;var t=window.getComputedStyle(r);return t[e]!=="hidden"&&!(t.overflowY===t.overflowX&&!SW(r)&&t[e]==="visible")},CW=function(r){return HA(r,"overflowY")},kW=function(r){return HA(r,"overflowX")},l1=function(r,e){var t=e.ownerDocument,n=e;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var s=BA(r,n);if(s){var i=GA(r,n),c=i[1],d=i[2];if(c>d)return!0}n=n.parentNode}while(n&&n!==t.body);return!1},NW=function(r){var e=r.scrollTop,t=r.scrollHeight,n=r.clientHeight;return[e,t,n]},TW=function(r){var e=r.scrollLeft,t=r.scrollWidth,n=r.clientWidth;return[e,t,n]},BA=function(r,e){return r==="v"?CW(e):kW(e)},GA=function(r,e){return r==="v"?NW(e):TW(e)},RW=function(r,e){return r==="h"&&e==="rtl"?-1:1},AW=function(r,e,t,n,s){var i=RW(r,window.getComputedStyle(e).direction),c=i*n,d=t.target,p=e.contains(d),m=!1,g=c>0,x=0,b=0;do{if(!d)break;var E=GA(r,d),T=E[0],S=E[1],N=E[2],R=S-N-i*T;(T||R)&&BA(r,d)&&(x+=R,b+=T);var A=d.parentNode;d=A&&A.nodeType===Node.DOCUMENT_FRAGMENT_NODE?A.host:A}while(!p&&d!==document.body||p&&(e.contains(d)||e===d));return(g&&Math.abs(x)<1||!g&&Math.abs(b)<1)&&(m=!0),m},Mv=function(r){return"changedTouches"in r?[r.changedTouches[0].clientX,r.changedTouches[0].clientY]:[0,0]},c1=function(r){return[r.deltaX,r.deltaY]},u1=function(r){return r&&"current"in r?r.current:r},IW=function(r,e){return r[0]===e[0]&&r[1]===e[1]},PW=function(r){return`
  .block-interactivity-`.concat(r,` {pointer-events: none;}
  .allow-interactivity-`).concat(r,` {pointer-events: all;}
`)},FW=0,Gf=[];function jW(r){var e=w.useRef([]),t=w.useRef([0,0]),n=w.useRef(),s=w.useState(FW++)[0],i=w.useState(zA)[0],c=w.useRef(r);w.useEffect(function(){c.current=r},[r]),w.useEffect(function(){if(r.inert){document.body.classList.add("block-interactivity-".concat(s));var S=zM([r.lockRef.current],(r.shards||[]).map(u1),!0).filter(Boolean);return S.forEach(function(N){return N.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),S.forEach(function(N){return N.classList.remove("allow-interactivity-".concat(s))})}}},[r.inert,r.lockRef.current,r.shards]);var d=w.useCallback(function(S,N){if("touches"in S&&S.touches.length===2||S.type==="wheel"&&S.ctrlKey)return!c.current.allowPinchZoom;var R=Mv(S),A=t.current,j="deltaX"in S?S.deltaX:A[0]-R[0],P="deltaY"in S?S.deltaY:A[1]-R[1],$,W=S.target,M=Math.abs(j)>Math.abs(P)?"h":"v";if("touches"in S&&M==="h"&&W.type==="range")return!1;var V=window.getSelection(),X=V&&V.anchorNode,ie=X?X===W||X.contains(W):!1;if(ie)return!1;var J=l1(M,W);if(!J)return!0;if(J?$=M:($=M==="v"?"h":"v",J=l1(M,W)),!J)return!1;if(!n.current&&"changedTouches"in S&&(j||P)&&(n.current=$),!$)return!0;var ae=n.current||$;return AW(ae,N,S,ae==="h"?j:P)},[]),p=w.useCallback(function(S){var N=S;if(!(!Gf.length||Gf[Gf.length-1]!==i)){var R="deltaY"in N?c1(N):Mv(N),A=e.current.filter(function($){return $.name===N.type&&($.target===N.target||N.target===$.shadowParent)&&IW($.delta,R)})[0];if(A&&A.should){N.cancelable&&N.preventDefault();return}if(!A){var j=(c.current.shards||[]).map(u1).filter(Boolean).filter(function($){return $.contains(N.target)}),P=j.length>0?d(N,j[0]):!c.current.noIsolation;P&&N.cancelable&&N.preventDefault()}}},[]),m=w.useCallback(function(S,N,R,A){var j={name:S,delta:N,target:R,should:A,shadowParent:OW(R)};e.current.push(j),setTimeout(function(){e.current=e.current.filter(function(P){return P!==j})},1)},[]),g=w.useCallback(function(S){t.current=Mv(S),n.current=void 0},[]),x=w.useCallback(function(S){m(S.type,c1(S),S.target,d(S,r.lockRef.current))},[]),b=w.useCallback(function(S){m(S.type,Mv(S),S.target,d(S,r.lockRef.current))},[]);w.useEffect(function(){return Gf.push(i),r.setCallbacks({onScrollCapture:x,onWheelCapture:x,onTouchMoveCapture:b}),document.addEventListener("wheel",p,Bf),document.addEventListener("touchmove",p,Bf),document.addEventListener("touchstart",g,Bf),function(){Gf=Gf.filter(function(S){return S!==i}),document.removeEventListener("wheel",p,Bf),document.removeEventListener("touchmove",p,Bf),document.removeEventListener("touchstart",g,Bf)}},[]);var E=r.removeScrollBar,T=r.inert;return w.createElement(w.Fragment,null,T?w.createElement(i,{styles:PW(s)}):null,E?w.createElement(EW,{noRelative:r.noRelative,gapMode:r.gapMode}):null)}function OW(r){for(var e=null;r!==null;)r instanceof ShadowRoot&&(e=r.host,r=r.host),r=r.parentNode;return e}const DW=uW(UA,jW);var EE=w.forwardRef(function(r,e){return w.createElement(i0,La({},r,{ref:e,sideCar:DW}))});EE.classNames=i0.classNames;var LW=function(r){if(typeof document>"u")return null;var e=Array.isArray(r)?r[0]:r;return e.ownerDocument.body},Wf=new WeakMap,$v=new WeakMap,Uv={},gw=0,WA=function(r){return r&&(r.host||WA(r.parentNode))},MW=function(r,e){return e.map(function(t){if(r.contains(t))return t;var n=WA(t);return n&&r.contains(n)?n:(console.error("aria-hidden",t,"in not contained inside",r,". Doing nothing"),null)}).filter(function(t){return!!t})},$W=function(r,e,t,n){var s=MW(e,Array.isArray(r)?r:[r]);Uv[t]||(Uv[t]=new WeakMap);var i=Uv[t],c=[],d=new Set,p=new Set(s),m=function(x){!x||d.has(x)||(d.add(x),m(x.parentNode))};s.forEach(m);var g=function(x){!x||p.has(x)||Array.prototype.forEach.call(x.children,function(b){if(d.has(b))g(b);else try{var E=b.getAttribute(n),T=E!==null&&E!=="false",S=(Wf.get(b)||0)+1,N=(i.get(b)||0)+1;Wf.set(b,S),i.set(b,N),c.push(b),S===1&&T&&$v.set(b,!0),N===1&&b.setAttribute(t,"true"),T||b.setAttribute(n,"true")}catch(R){console.error("aria-hidden: cannot operate on ",b,R)}})};return g(e),d.clear(),gw++,function(){c.forEach(function(x){var b=Wf.get(x)-1,E=i.get(x)-1;Wf.set(x,b),i.set(x,E),b||($v.has(x)||x.removeAttribute(n),$v.delete(x)),E||x.removeAttribute(t)}),gw--,gw||(Wf=new WeakMap,Wf=new WeakMap,$v=new WeakMap,Uv={})}},VA=function(r,e,t){t===void 0&&(t="data-aria-hidden");var n=Array.from(Array.isArray(r)?r:[r]),s=LW(r);return s?(n.push.apply(n,Array.from(s.querySelectorAll("[aria-live], script"))),$W(n,s,t,"aria-hidden")):function(){return null}};function UW(r){const e=zW(r),t=w.forwardRef((n,s)=>{const{children:i,...c}=n,d=w.Children.toArray(i),p=d.find(BW);if(p){const m=p.props.children,g=d.map(x=>x===p?w.Children.count(m)>1?w.Children.only(null):w.isValidElement(m)?m.props.children:null:x);return u.jsx(e,{...c,ref:s,children:w.isValidElement(m)?w.cloneElement(m,void 0,g):null})}return u.jsx(e,{...c,ref:s,children:i})});return t.displayName=`${r}.Slot`,t}function zW(r){const e=w.forwardRef((t,n)=>{const{children:s,...i}=t;if(w.isValidElement(s)){const c=WW(s),d=GW(i,s.props);return s.type!==w.Fragment&&(d.ref=n?Qc(n,c):c),w.cloneElement(s,d)}return w.Children.count(s)>1?w.Children.only(null):null});return e.displayName=`${r}.SlotClone`,e}var HW=Symbol("radix.slottable");function BW(r){return w.isValidElement(r)&&typeof r.type=="function"&&"__radixId"in r.type&&r.type.__radixId===HW}function GW(r,e){const t={...e};for(const n in e){const s=r[n],i=e[n];/^on[A-Z]/.test(n)?s&&i?t[n]=(...d)=>{const p=i(...d);return s(...d),p}:s&&(t[n]=s):n==="style"?t[n]={...s,...i}:n==="className"&&(t[n]=[s,i].filter(Boolean).join(" "))}return{...r,...t}}function WW(r){var n,s;let e=(n=Object.getOwnPropertyDescriptor(r.props,"ref"))==null?void 0:n.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=(s=Object.getOwnPropertyDescriptor(r,"ref"))==null?void 0:s.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}var a0="Dialog",[qA]=Wa(a0),[VW,oa]=qA(a0),KA=r=>{const{__scopeDialog:e,children:t,open:n,defaultOpen:s,onOpenChange:i,modal:c=!0}=r,d=w.useRef(null),p=w.useRef(null),[m,g]=Zc({prop:n,defaultProp:s??!1,onChange:i,caller:a0});return u.jsx(VW,{scope:e,triggerRef:d,contentRef:p,contentId:Ul(),titleId:Ul(),descriptionId:Ul(),open:m,onOpenChange:g,onOpenToggle:w.useCallback(()=>g(x=>!x),[g]),modal:c,children:t})};KA.displayName=a0;var YA="DialogTrigger",qW=w.forwardRef((r,e)=>{const{__scopeDialog:t,...n}=r,s=oa(YA,t),i=On(e,s.triggerRef);return u.jsx(jr.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":kE(s.open),...n,ref:i,onClick:At(r.onClick,s.onOpenToggle)})});qW.displayName=YA;var SE="DialogPortal",[KW,JA]=qA(SE,{forceMount:void 0}),XA=r=>{const{__scopeDialog:e,forceMount:t,children:n,container:s}=r,i=oa(SE,e);return u.jsx(KW,{scope:e,forceMount:t,children:w.Children.map(n,c=>u.jsx(sa,{present:t||i.open,children:u.jsx(xE,{asChild:!0,container:s,children:c})}))})};XA.displayName=SE;var Fy="DialogOverlay",QA=w.forwardRef((r,e)=>{const t=JA(Fy,r.__scopeDialog),{forceMount:n=t.forceMount,...s}=r,i=oa(Fy,r.__scopeDialog);return i.modal?u.jsx(sa,{present:n||i.open,children:u.jsx(JW,{...s,ref:e})}):null});QA.displayName=Fy;var YW=UW("DialogOverlay.RemoveScroll"),JW=w.forwardRef((r,e)=>{const{__scopeDialog:t,...n}=r,s=oa(Fy,t);return u.jsx(EE,{as:YW,allowPinchZoom:!0,shards:[s.contentRef],children:u.jsx(jr.div,{"data-state":kE(s.open),...n,ref:e,style:{pointerEvents:"auto",...n.style}})})}),ud="DialogContent",ZA=w.forwardRef((r,e)=>{const t=JA(ud,r.__scopeDialog),{forceMount:n=t.forceMount,...s}=r,i=oa(ud,r.__scopeDialog);return u.jsx(sa,{present:n||i.open,children:i.modal?u.jsx(XW,{...s,ref:e}):u.jsx(QW,{...s,ref:e})})});ZA.displayName=ud;var XW=w.forwardRef((r,e)=>{const t=oa(ud,r.__scopeDialog),n=w.useRef(null),s=On(e,t.contentRef,n);return w.useEffect(()=>{const i=n.current;if(i)return VA(i)},[]),u.jsx(eI,{...r,ref:s,trapFocus:t.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:At(r.onCloseAutoFocus,i=>{var c;i.preventDefault(),(c=t.triggerRef.current)==null||c.focus()}),onPointerDownOutside:At(r.onPointerDownOutside,i=>{const c=i.detail.originalEvent,d=c.button===0&&c.ctrlKey===!0;(c.button===2||d)&&i.preventDefault()}),onFocusOutside:At(r.onFocusOutside,i=>i.preventDefault())})}),QW=w.forwardRef((r,e)=>{const t=oa(ud,r.__scopeDialog),n=w.useRef(!1),s=w.useRef(!1);return u.jsx(eI,{...r,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var c,d;(c=r.onCloseAutoFocus)==null||c.call(r,i),i.defaultPrevented||(n.current||(d=t.triggerRef.current)==null||d.focus(),i.preventDefault()),n.current=!1,s.current=!1},onInteractOutside:i=>{var p,m;(p=r.onInteractOutside)==null||p.call(r,i),i.defaultPrevented||(n.current=!0,i.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const c=i.target;((m=t.triggerRef.current)==null?void 0:m.contains(c))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&s.current&&i.preventDefault()}})}),eI=w.forwardRef((r,e)=>{const{__scopeDialog:t,trapFocus:n,onOpenAutoFocus:s,onCloseAutoFocus:i,...c}=r,d=oa(ud,t),p=w.useRef(null),m=On(e,p);return MA(),u.jsxs(u.Fragment,{children:[u.jsx(_E,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:s,onUnmountAutoFocus:i,children:u.jsx(n0,{role:"dialog",id:d.contentId,"aria-describedby":d.descriptionId,"aria-labelledby":d.titleId,"data-state":kE(d.open),...c,ref:m,onDismiss:()=>d.onOpenChange(!1)})}),u.jsxs(u.Fragment,{children:[u.jsx(ZW,{titleId:d.titleId}),u.jsx(t9,{contentRef:p,descriptionId:d.descriptionId})]})]})}),CE="DialogTitle",tI=w.forwardRef((r,e)=>{const{__scopeDialog:t,...n}=r,s=oa(CE,t);return u.jsx(jr.h2,{id:s.titleId,...n,ref:e})});tI.displayName=CE;var rI="DialogDescription",nI=w.forwardRef((r,e)=>{const{__scopeDialog:t,...n}=r,s=oa(rI,t);return u.jsx(jr.p,{id:s.descriptionId,...n,ref:e})});nI.displayName=rI;var sI="DialogClose",oI=w.forwardRef((r,e)=>{const{__scopeDialog:t,...n}=r,s=oa(sI,t);return u.jsx(jr.button,{type:"button",...n,ref:e,onClick:At(r.onClick,()=>s.onOpenChange(!1))})});oI.displayName=sI;function kE(r){return r?"open":"closed"}var iI="DialogTitleWarning",[FK,aI]=wB(iI,{contentName:ud,titleName:CE,docsSlug:"dialog"}),ZW=({titleId:r})=>{const e=aI(iI),t=`\`${e.contentName}\` requires a \`${e.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${e.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${e.docsSlug}`;return w.useEffect(()=>{r&&(document.getElementById(r)||console.error(t))},[t,r]),null},e9="DialogDescriptionWarning",t9=({contentRef:r,descriptionId:e})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${aI(e9).contentName}}.`;return w.useEffect(()=>{var i;const s=(i=r.current)==null?void 0:i.getAttribute("aria-describedby");e&&s&&(document.getElementById(e)||console.warn(n))},[n,r,e]),null},r9=KA,n9=XA,lI=QA,cI=ZA,uI=tI,dI=nI,s9=oI;const o9=r9,i9=n9,fI=w.forwardRef(({className:r,...e},t)=>u.jsx(lI,{ref:t,className:Rr("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",r),...e}));fI.displayName=lI.displayName;const hI=w.forwardRef(({className:r,children:e,...t},n)=>u.jsxs(i9,{children:[u.jsx(fI,{}),u.jsxs(cI,{ref:n,className:Rr("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",r),...t,children:[e,u.jsxs(s9,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[u.jsx(ki,{className:"h-4 w-4"}),u.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));hI.displayName=cI.displayName;const pI=({className:r,...e})=>u.jsx("div",{className:Rr("flex flex-col space-y-1.5 text-center sm:text-left",r),...e});pI.displayName="DialogHeader";const mI=({className:r,...e})=>u.jsx("div",{className:Rr("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",r),...e});mI.displayName="DialogFooter";const gI=w.forwardRef(({className:r,...e},t)=>u.jsx(uI,{ref:t,className:Rr("text-lg font-semibold leading-none tracking-tight",r),...e}));gI.displayName=uI.displayName;const vI=w.forwardRef(({className:r,...e},t)=>u.jsx(dI,{ref:t,className:Rr("text-sm text-muted-foreground",r),...e}));vI.displayName=dI.displayName;const a9=({isOpen:r,onClose:e,title:t="Gmail Connection Required",description:n="This feature requires an active Gmail connection. Please connect your Gmail account to continue.",actionText:s="the requested action"})=>{const[i,c]=w.useState(!1),{initiateReconnection:d,wasEverConnected:p}=ra(),m=async()=>{c(!0);try{await d(),e()}catch(g){console.error("Failed to reconnect Gmail:",g)}finally{c(!1)}};return u.jsx(o9,{open:r,onOpenChange:e,children:u.jsxs(hI,{className:"sm:max-w-md",children:[u.jsxs(pI,{children:[u.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[u.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:u.jsx(Kc,{className:"h-5 w-5 text-blue-600"})}),u.jsx(gI,{className:"text-lg font-semibold",children:t})]}),u.jsx(vI,{className:"text-sm text-gray-600 leading-relaxed",children:n})]}),u.jsx("div",{className:"bg-gray-50 rounded-lg p-4 my-4",children:u.jsxs("div",{className:"flex items-start gap-3",children:[u.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full mt-2 flex-shrink-0"}),u.jsxs("div",{className:"text-sm text-gray-700",children:[u.jsx("p",{className:"font-medium mb-1",children:"What happens next:"}),u.jsxs("p",{children:["You'll be redirected to Gmail's authorization page to ",p?"reconnect":"connect"," your account securely."]})]})]})}),u.jsxs(mI,{className:"flex gap-2 sm:gap-2",children:[u.jsx(ze,{variant:"outline",onClick:e,disabled:i,className:"flex-1",children:"Cancel"}),u.jsx(ze,{onClick:m,disabled:i,className:"flex-1 bg-blue-600 hover:bg-blue-700",children:i?u.jsxs(u.Fragment,{children:[u.jsx(No,{className:"h-4 w-4 mr-2 animate-spin"}),"Connecting..."]}):p?"Reconnect Gmail":"Connect Gmail"})]})]})})},sn="src/shared/components/sidepanel/panels/GenerateEmailDraftPanel.tsx",l9=()=>`The response should just be the email body with salutation at the beginning. Do not include a subject line in your response draft. 
    Do not add links to the references in your response draft. Do not add citation numbers in your response draft.
    Do not list the references in your response draft, since they will be added in a different section in the JSON response.
    Do not add a complimentary closing or a signature as this will be added later.`.trim(),c9=(r,e,t)=>{let n="";switch(r){case"Casual":n+="Keep the tone casual. ";break;case"Neutral":n+="Maintain a neutral tone. ";break;case"Formal":n+="Keep the tone formal. ";break}switch(e){case"Low":n+="Show low empathy. ";break;case"Neutral":n+="Maintain neutral empathy. ";break;case"High":n+="Show high empathy. ";break}switch(t){case"Simple":n+="Keep it simple amd use simple words. ";break;case"Neutral":n+="Maintain neutral complexity. ";break;case"Detailed":n+="Provide detailed information and you're free to use harder words. ";break}return n.trim()},u9=({clientEmail:r})=>{const e=Ur(),t=Vl(),n=fd(),s=cn().platform,{isConnected:i,wasEverConnected:c}=ra(),[d,p]=w.useState(!1),[m,g]=w.useState(!1),[x,b]=w.useState(""),E=w.useRef(null),[T,S]=w.useState(!0),[N,R]=w.useState(""),[A,j]=w.useState([]),[P,$]=w.useState(0),[W,M]=w.useState(""),[V,X]=w.useState(!1),[ie,J]=w.useState(!0),[ae,we]=w.useState(!0),[ue,oe]=w.useState(!0),[pe,te]=w.useState(null),[B,z]=w.useState(null),[Y,O]=w.useState([]),U=w.useRef(null),[ne,Ee]=w.useState(""),[q,le]=w.useState("Neutral"),[xe,ye]=w.useState("Neutral"),[de,Te]=w.useState("Neutral"),Be=w.useRef(null),[Ge,Me]=w.useState(!1),[Ae,ct]=w.useState(!1),[Bt,yt]=w.useState([]),[sr,Gt]=w.useState(!0),[Zt,Kt]=w.useState(!1),Kr="25dc68db26595a7485917129d6993f96",_t="c1c8e460f2105029b2b4563f9222161c",Se=["Analyzing email thread...","Pulling relevant information...","Structuring your response...","Preparing personalized reply...","Finalizing your draft..."],$e=w.useCallback(async Ke=>{const Pt="fetchFromStorageProvider";if(!t)return"";try{const Lt=await t.getLocalItem(Ke);return Lt&&e.debug("Loaded additional context from storage",{sourceFile:sn,functionName:Pt}),Lt||""}catch(Lt){return e.error("Error loading additional context from storage",Lt,{sourceFile:sn,functionName:Pt}),""}},[t,e]);w.useEffect(()=>{let Ke;const Pt=()=>{if(d){const Lt=Math.floor(Math.random()*2e3)+1e3;Ke=setTimeout(()=>{$(et=>(et+1)%Se.length),Pt()},Lt)}};return d&&Pt(),()=>{Ke&&clearTimeout(Ke)}},[d,Se.length]),w.useEffect(()=>{const Ke="useEffect[threadDataListener]";if(!n){e.debug("DataProvider not available yet",{sourceFile:sn,functionName:Ke});return}const Pt=async et=>{const er=et!==null&&et.threadId!==U.current;if(et){if(e.debug("Thread changed via platform abstraction",{sourceFile:sn,functionName:Ke,threadId:et.threadId,isThreadChanged:er}),z(et.threadId),console.log("Thread changed via platform abstraction",{sourceFile:sn,functionName:Ke,thread:et}),O(et.participants||[]),et.messages&&Array.isArray(et.messages)&&et.messages.length>0&&et.messages[0]&&typeof et.messages[0]=="object"){const kr=et.messages.map((Dr,Yr)=>({body:Dr.body||Dr.html||"",html:Dr.html||Dr.body||"",from:Dr.from||"",timestamp:Dr.timestamp||"",subject:Yr===0&&et.subject||""}));te(kr);const wn=kr.length>0?cw(kr[0].body):"";M(wn)}er&&(R(""),j([]),yt([]),g(!1),p(!1)),U.current=et.threadId;const zr=`additionalContext_${et.threadId}`;Ee(await $e(zr))}else{e.debug("Thread cleared via platform abstraction",{sourceFile:sn,functionName:Ke});const zr=U.current!==null;z(null),te(null),O([]),M(""),R(""),j([]),yt([]),g(!1),p(!1),zr&&(Ee(""),U.current=null)}};return n.onThreadChanged(Pt),(async()=>{try{const et=await n.getCurrentThread();await Pt(et)}catch(et){e.error("Error loading current thread",et,{sourceFile:sn,functionName:"loadCurrentThread"})}})(),()=>{n.removeThreadListener(Pt)}},[n,e]),w.useEffect(()=>{const Pt=setTimeout(async()=>{const Lt="useEffect[saveAdditionalContext]";if(!(!B||!t))try{const et=`additionalContext_${B}`;await t.setLocalItem(et,ne)}catch(et){e.error("Error saving additional context to storage",et,{sourceFile:sn,functionName:Lt,threadId:B})}},500);return()=>clearTimeout(Pt)},[ne,B,t,e]);const Nt=w.useCallback(async Ke=>{try{if(!B)return e.debug("No thread ID available for cache check",{sourceFile:sn,functionName:Ke}),!1;const Pt=it(B),Lt=await K5(Pt,e);return Lt?(e.debug("Found cached response for thread",{sourceFile:sn,functionName:Ke,cacheKey:Pt,threadId:B}),R(Lt.response),j(Lt.references),yt(Lt.cmsData),p(!1),g(!0),!0):(e.debug("No cached response found for thread",{sourceFile:sn,functionName:Ke,cacheKey:Pt,threadId:B}),!1)}catch(Pt){return e.warn("Error checking for cached response",{sourceFile:sn,functionName:Ke,error:Pt}),!1}},[B,e]);w.useEffect(()=>{const Pt=setTimeout(async()=>{const Lt="checkForCachedResponse";!B||N||d||await Nt(Lt)},500);return()=>clearTimeout(Pt)},[B,Nt,N,d]),w.useEffect(()=>{(async()=>{const Pt="checkCachedResponseOnReady";T||!B||!pe||N||d||(e.debug("Component ready, checking for cached response immediately",{sourceFile:sn,functionName:Pt,threadId:B,hasThreadData:!!pe,isLoading:T,hasResponse:!!N}),await Nt(Pt))})()},[T,B,pe,Nt,N,d,e]),w.useEffect(()=>{if(m&&E.current){const Ke=setTimeout(()=>{var Pt;(Pt=E.current)==null||Pt.focus()},100);return()=>clearTimeout(Ke)}},[m]),w.useEffect(()=>{const Ke=async()=>{try{if(!t)return;const et=await t.getLocalItem("useUscis");Me(et??!1),e.debug("uscisIsEnabled loaded from storage via platform abstraction",{sourceFile:sn,functionName:"initializeUscisState",uscisEnabled:et??!1})}catch(et){e.error("Error loading USCIS state",et,{sourceFile:sn,functionName:"initializeUscisState"})}},Pt=async()=>{try{if(!t)return;const et=await t.getLocalItem("useOregon");ct(et??!1),e.debug("oregonIsEnabled loaded from storage via platform abstraction",{sourceFile:sn,functionName:"initializeOregonState",oregonEnabled:et??!1})}catch(et){e.error("Error loading Oregon state",et,{sourceFile:sn,functionName:"initializeOregonState"})}},Lt=async et=>{try{et.useUscis!==void 0&&(Me(et.useUscis),e.debug("USCIS setting changed via platform abstraction",{sourceFile:sn,functionName:"handleStorageChange",useUscis:et.useUscis})),et.useOregon!==void 0&&(ct(et.useOregon),e.debug("Oregon setting changed via platform abstraction",{sourceFile:sn,functionName:"handleStorageChange",useOregon:et.useOregon}))}catch(er){e.error("Error handling storage changes",er,{sourceFile:sn,functionName:"handleStorageChange"})}};return Ke(),Pt(),t!=null&&t.onChanged&&t.onChanged(Lt),S(!1),()=>{t!=null&&t.removeChangeListener&&Lt&&t.removeChangeListener(Lt)}},[t,e]),w.useEffect(()=>{if(N&&Be.current){const Ke=Be.current,Lt=(Ke.scrollHeight-Ke.clientHeight)*.8;Ke.scrollTo({top:Lt,behavior:"smooth"}),e.debug("Scrolling to 90% of bottom after response generation",{sourceFile:sn,functionName:"useEffect[fullResponse]"})}},[N,e]);const it=Ke=>`response_${Ke}`,dt=async(Ke,Pt)=>{p(!0),R("Reformatting..."),g(!1);const Lt="regenerateResponse";try{if(!B){e.error("Thread ID is not set for regeneration",void 0,{sourceFile:sn,functionName:Lt}),p(!1);return}const et=it(B),er=await e8(Pt,Ke,e);R(er),p(!1),g(!0),await xC(et,er,[],[],e)}catch(et){e.error("Error regenerating response",et,{sourceFile:sn,functionName:Lt}),p(!1),g(!0)}},Ut=async()=>{if(s==="chrome"&&!i){Kt(!0);return}p(!0),g(!1);const Ke="handleGenerateResponse";try{const Pt=(pe==null?void 0:pe.map(Yr=>`From: ${Yr.from}
Timestamp: ${Yr.timestamp}
Body: ${cw(Yr.body)}

`).join(""))||"",Lt=[];if(Ge&&Lt.push(Kr),Ae&&Lt.push(_t),!B){e.error("Thread ID is not set",void 0,{sourceFile:sn,functionName:Ke}),p(!1);return}const et=c9(q,xe,de),er=l9(),zr=it(B);let kr;s==="outlook"?kr=await Z6(B,Pt,ne,et,er,Y,e):kr=await Q6(B,Pt,ne,et,er,Lt,e);const wn=kr.response,Dr=_b(wn);R(Dr),j(kr.references),yt(kr.cms_data||[]),p(!1),g(!0),await xC(zr,Dr,kr.references,kr.cms_data||[],e)}catch(Pt){e.error("Error generating response",Pt,{sourceFile:sn,functionName:Ke}),p(!1)}};return s==="chrome"&&!i?u.jsx("div",{className:"p-4",children:u.jsx(bE,{feature:"Email Composition",description:"Connect your Gmail account to generate personalized email responses",benefits:["Analyze email threads and context automatically","Generate contextually relevant responses","Insert generated content directly into compose box"]})}):u.jsxs("div",{className:"space-y-4 h-full overflow-y-auto overflow-x-hidden",ref:Be,children:[u.jsxs(_i,{className:"overflow-hidden shadow-sm mb-4",children:[u.jsx(Ji,{className:"p-3 border-b dark:border-border cursor-pointer",onClick:()=>we(!ae),children:u.jsxs("div",{className:"flex items-center justify-between w-full",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx(Xi,{className:"text-sm font-semibold pr-1",children:"Current Email"}),u.jsxs("div",{className:"relative group",children:[u.jsx(Mc,{src:"/icons/info-circled.svg",width:16,height:16,alt:"Info",className:"h-4 w-4 text-muted-foreground dark:brightness-0 dark:invert"}),u.jsx("div",{className:"absolute left-0 top-full mt-2 w-48 p-2 bg-white dark:bg-gray-800 text-black dark:text-white text-xs rounded shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-opacity z-50 border dark:border-border",children:"This is the email Candle AI is responding to."})]})]}),u.jsx(Mc,{src:"/icons/chevron-down.svg",width:20,height:20,alt:"Chevron down",className:`h-5 w-5 text-muted-foreground dark:brightness-0 dark:invert transition-transform duration-200 ${ae?"transform rotate-180":""}`})]})}),ae&&u.jsx(Ei,{className:"p-0.5",children:u.jsx("textarea",{value:T?"Loading...":pe?cw(pe[0].body):s==="chrome"&&!i?"Gmail disconnected. Connect Gmail to view email content.":"Please select an email thread",disabled:!0,className:"w-full border dark:border-border rounded p-4 min-h-[100px] text-xs bg-white dark:bg-card text-gray-900 dark:text-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400"})})]}),u.jsxs(_i,{className:"overflow-hidden shadow-sm mb-4",children:[u.jsx(Ji,{className:"p-3 border-b dark:border-border cursor-pointer",onClick:()=>J(!ie),children:u.jsxs("div",{className:"flex items-center justify-between w-full",children:[u.jsx(Xi,{className:"text-sm font-semibold",children:"Anything specific you want the response to include?"}),u.jsx(Mc,{src:"/icons/chevron-down.svg",width:20,height:20,alt:"Chevron down",className:`h-5 w-5 text-muted-foreground dark:brightness-0 dark:invert transition-transform duration-200 ${ie?"transform rotate-180":""}`})]})}),ie&&u.jsx(Ei,{className:"p-0.5",children:u.jsx("textarea",{className:"w-full border dark:border-border rounded p-4 min-h-[100px] text-sm bg-white dark:bg-card text-gray-900 dark:text-gray-200 placeholder:text-gray-400 dark:placeholder:text-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400",placeholder:`Examples: 'This client's visa is expiring soon. Suggest they renew it soon.'
'Respond in Spanish.'`,value:ne,onChange:Ke=>Ee(Ke.target.value)})})]}),u.jsxs(_i,{className:"overflow-hidden shadow-sm mb-4",children:[u.jsx(Ji,{className:"p-3 border-b dark:border-border cursor-pointer",onClick:()=>X(!V),children:u.jsxs("div",{className:"flex items-center justify-between w-full",children:[u.jsx(Xi,{className:"text-sm font-semibold",children:"Tone"}),u.jsx(Mc,{src:"/icons/chevron-down.svg",width:20,height:20,alt:"Chevron down",className:`h-5 w-5 text-muted-foreground dark:brightness-0 dark:invert transition-transform duration-200 ${V?"transform rotate-180":""}`})]})}),V&&u.jsxs(Ei,{className:"p-4 space-y-4",children:[u.jsxs("div",{className:"space-y-2",children:[u.jsx("p",{className:"text-xs font-semibold text-neutral-700 dark:text-gray-300",children:"Formality"}),u.jsx(rw,{options:["Casual","Neutral","Formal"],value:q,onChange:le})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("p",{className:"text-xs font-semibold text-neutral-700 dark:text-gray-300",children:"Empathy"}),u.jsx(rw,{options:["Low","Neutral","High"],value:xe,onChange:ye})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("p",{className:"text-xs font-semibold text-neutral-700 dark:text-gray-300",children:"Complexity"}),u.jsx(rw,{options:["Simple","Neutral","Detailed"],value:de,onChange:Te})]})]})]}),u.jsx(ze,{className:"w-full bg-blue-600 hover:bg-blue-700 text-white py-4 mt-2",onClick:Ut,disabled:d||!B&&s!=="chrome"||s==="chrome"&&!i&&!B,children:d?"Generating...":s==="chrome"&&!i?"Connect Gmail to Generate Response":B?"Generate Response":"Select a thread"}),d&&u.jsxs("div",{className:"flex flex-col items-center justify-center",children:[u.jsx(Zi,{className:"h-8 w-8 animate-spin text-blue-600"}),u.jsx("p",{className:"mt-2 text-sm text-gray-500",children:Se[P]})]}),u.jsxs("div",{className:"mb-24",children:[u.jsx(a9,{isOpen:Zt,onClose:()=>Kt(!1),title:"Gmail Connection Required",description:"Generate Response requires an active Gmail connection to analyze your email thread and create personalized responses.",actionText:"generate email responses"}),N&&!d&&u.jsxs(_i,{className:"animate-slide-fade-in mb-2 origin-top",children:[u.jsx(Ji,{className:"p-3 border-b dark:border-border cursor-pointer",children:u.jsxs(Xi,{className:"flex items-center py-0 my-0 text-sm font-semibold",children:[u.jsx(Mc,{src:"/icons/email-icon.svg",width:16,height:16,alt:"Generated Response",className:"h-4 w-4 text-muted-foreground dark:brightness-0 dark:invert mr-2"}),u.jsx("p",{className:"text-sm font-semibold",children:"Generated Response"}),u.jsxs(ze,{className:"ml-auto bg-blue-600 hover:bg-blue-700 text-white",size:"sm",onClick:()=>{IA(_b(N),e)},children:[u.jsx(KR,{className:"w-4 h-4 flex-shrink-0 mr-1 rotate-90"}),"Insert"]})]})}),u.jsx(Ei,{className:"p-6",children:u.jsx(V7,{htmlString:N})})]}),m&&u.jsx("div",{className:"animate-fadeIn mb-2",children:u.jsxs("div",{className:"rounded-lg border-2 border-neutral-200 dark:border-border bg-neutral-50/50 dark:bg-card/50 overflow-hidden transition-all duration-200 focus-within:!border-blue-500 dark:focus-within:!border-blue-400 focus-within:ring-2 focus-within:ring-blue-500/20 dark:focus-within:ring-blue-400/20 focus-within:bg-white dark:focus-within:bg-card",children:[u.jsx("div",{className:"p-3 bg-white dark:bg-card",children:u.jsx(DA,{ref:E,placeholder:"Customize this response",value:x,className:"text-sm w-full bg-transparent text-gray-900 dark:text-gray-200 !border-0 !ring-0 !outline-none focus:!border-0 focus:!ring-0 focus:!outline-none focus-visible:!ring-0 focus-visible:!ring-offset-0 focus-visible:!outline-none min-h-[40px] max-h-40 py-0 px-0 placeholder:text-neutral-400 dark:placeholder:text-gray-500 resize-none",onChange:Ke=>b(Ke.target.value),onKeyDown:Ke=>{Ke.key==="Enter"&&!Ke.shiftKey&&x.trim()&&(Ke.preventDefault(),dt(x,N),b(""))}})}),u.jsx("div",{className:"h-[1px] bg-neutral-200 dark:bg-border"}),u.jsxs("div",{className:"flex gap-0 bg-white dark:bg-card border-t dark:border-border",children:[u.jsx(ze,{onClick:()=>{dt("More empathetic",N)},variant:"ghost",className:"flex-1 rounded-none text-xs text-neutral-700 dark:text-gray-300 hover:bg-neutral-50 dark:hover:bg-muted py-2.5 h-auto font-normal",children:"More empathetic"}),u.jsx("div",{className:"w-[1px] bg-neutral-200 dark:bg-border my-1.5"}),u.jsx(ze,{onClick:()=>{dt("Make it shorter",N)},variant:"ghost",className:"flex-1 rounded-none text-xs text-neutral-700 dark:text-gray-300 hover:bg-neutral-50 dark:hover:bg-muted py-2.5 h-auto font-normal",children:"Make it shorter"}),u.jsx("div",{className:"w-[1px] bg-neutral-200 dark:bg-border my-1.5"}),u.jsx(ze,{onClick:()=>{x&&(dt(x,N),b(""))},disabled:!x.trim(),size:"icon",className:"h-auto w-12 rounded-none bg-blue-600 text-white hover:bg-blue-700 disabled:bg-blue-600/50 disabled:text-white/90 disabled:cursor-not-allowed transition-all duration-200",children:u.jsx(sB,{className:"h-4 w-4"})})]})]})})]})]})},d9=()=>{const[r,e]=w.useState(!1),t=Vl(),n=Ur(),s=PT();w.useEffect(()=>{n.info("LoginPanel component loaded",{sourceFile:"src/sidepanel/panels/LoginPanel.tsx"});const c=d=>{d.token&&(e(!1),n.info("Token detected in storage, auth state will be updated automatically",{sourceFile:"src/sidepanel/panels/LoginPanel.tsx"}))};return t!=null&&t.onChanged&&t.onChanged(c),()=>{t!=null&&t.removeChangeListener&&t.removeChangeListener(c)}},[t,n]);const i=async()=>{n.info("Login button clicked",{sourceFile:"src/sidepanel/panels/LoginPanel.tsx"}),e(!0);try{await s.login(),n.info("Login completed successfully",{sourceFile:"src/sidepanel/panels/LoginPanel.tsx"}),e(!1)}catch(c){n.error("Login failed",c,{sourceFile:"src/sidepanel/panels/LoginPanel.tsx"}),e(!1)}};return u.jsxs("div",{className:"flex flex-col items-center justify-center h-full px-6 bg-gradient-to-b from-blue-50/30 to-white dark:from-gray-900 dark:to-gray-950 animate-fade-in",children:[u.jsx("div",{className:"flex items-center justify-center max-w-md w-full mb-8",children:u.jsxs("svg",{width:"400",height:"200",viewBox:"0 0 400 300",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"w-full h-auto max-h-[200px] drop-shadow-lg",children:[u.jsxs("defs",{children:[u.jsxs("linearGradient",{id:"emailGradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[u.jsx("stop",{offset:"0%",style:{stopColor:"#EEF2FF",stopOpacity:1}}),u.jsx("stop",{offset:"100%",style:{stopColor:"#E0E7FF",stopOpacity:1}})]}),u.jsxs("linearGradient",{id:"glowGradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[u.jsx("stop",{offset:"0%",style:{stopColor:"#818CF8",stopOpacity:.6}}),u.jsx("stop",{offset:"100%",style:{stopColor:"#4F46E5",stopOpacity:.3}})]}),u.jsxs("filter",{id:"glow",children:[u.jsx("feGaussianBlur",{stdDeviation:"4",result:"coloredBlur"}),u.jsxs("feMerge",{children:[u.jsx("feMergeNode",{in:"coloredBlur"}),u.jsx("feMergeNode",{in:"SourceGraphic"})]})]})]}),u.jsx("circle",{cx:"200",cy:"150",r:"120",fill:"url(#glowGradient)",opacity:"0.3",className:"animate-pulse-slow"}),u.jsx("circle",{cx:"200",cy:"150",r:"80",fill:"url(#glowGradient)",opacity:"0.2",className:"animate-pulse-slow",style:{animationDelay:"0.5s"}}),u.jsxs("g",{className:"animate-float",children:[u.jsx("rect",{x:"100",y:"80",width:"200",height:"140",rx:"8",fill:"url(#emailGradient)",stroke:"#6366F1",strokeWidth:"2"}),u.jsx("line",{x1:"120",y1:"110",x2:"240",y2:"110",stroke:"#94A3B8",strokeWidth:"2",strokeLinecap:"round"}),u.jsx("line",{x1:"120",y1:"130",x2:"260",y2:"130",stroke:"#94A3B8",strokeWidth:"2",strokeLinecap:"round"}),u.jsx("line",{x1:"120",y1:"150",x2:"230",y2:"150",stroke:"#94A3B8",strokeWidth:"2",strokeLinecap:"round"}),u.jsx("line",{x1:"120",y1:"170",x2:"250",y2:"170",stroke:"#94A3B8",strokeWidth:"2",strokeLinecap:"round"}),u.jsx("line",{x1:"120",y1:"190",x2:"210",y2:"190",stroke:"#94A3B8",strokeWidth:"2",strokeLinecap:"round"})]}),u.jsxs("g",{className:"animate-sparkle",children:[u.jsx("circle",{cx:"80",cy:"60",r:"4",fill:"#818CF8",filter:"url(#glow)"}),u.jsx("path",{d:"M 80 50 L 82 58 L 90 60 L 82 62 L 80 70 L 78 62 L 70 60 L 78 58 Z",fill:"#818CF8",filter:"url(#glow)"})]}),u.jsxs("g",{className:"animate-sparkle",style:{animationDelay:"0.7s"},children:[u.jsx("circle",{cx:"320",cy:"80",r:"3",fill:"#4F46E5",filter:"url(#glow)"}),u.jsx("path",{d:"M 320 72 L 321.5 78 L 328 80 L 321.5 82 L 320 88 L 318.5 82 L 312 80 L 318.5 78 Z",fill:"#4F46E5",filter:"url(#glow)"})]}),u.jsxs("g",{className:"animate-sparkle",style:{animationDelay:"1.4s"},children:[u.jsx("circle",{cx:"310",cy:"230",r:"3.5",fill:"#818CF8",filter:"url(#glow)"}),u.jsx("path",{d:"M 310 221 L 311.8 227.5 L 319 230 L 311.8 232.5 L 310 239 L 308.2 232.5 L 301 230 L 308.2 227.5 Z",fill:"#818CF8",filter:"url(#glow)"})]}),u.jsxs("g",{className:"animate-sparkle",style:{animationDelay:"0.3s"},children:[u.jsx("circle",{cx:"90",cy:"240",r:"3",fill:"#6366F1",filter:"url(#glow)"}),u.jsx("path",{d:"M 90 233 L 91.5 238 L 97 240 L 91.5 242 L 90 247 L 88.5 242 L 83 240 L 88.5 238 Z",fill:"#6366F1",filter:"url(#glow)"})]}),u.jsxs("g",{className:"animate-sparkle",style:{animationDelay:"1s"},children:[u.jsx("circle",{cx:"320",cy:"150",r:"5",fill:"#4F46E5",filter:"url(#glow)"}),u.jsx("path",{d:"M 320 138 L 323 147 L 333 150 L 323 153 L 320 162 L 317 153 L 307 150 L 317 147 Z",fill:"#4F46E5",filter:"url(#glow)"})]}),u.jsx("circle",{cx:"85",cy:"150",r:"2.5",fill:"#818CF8",opacity:"0.6",className:"animate-sparkle"}),u.jsx("circle",{cx:"315",cy:"200",r:"2",fill:"#6366F1",opacity:"0.5",className:"animate-sparkle",style:{animationDelay:"0.5s"}}),u.jsx("circle",{cx:"280",cy:"70",r:"2",fill:"#4F46E5",opacity:"0.6",className:"animate-sparkle",style:{animationDelay:"1s"}})]})}),u.jsxs("div",{className:"text-center mb-6 space-y-3 animate-slide-up",children:[u.jsxs("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white leading-tight",children:["Legal emails,",u.jsx("br",{}),"effortlessly handled"]}),u.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 max-w-xs mx-auto",children:"AI-powered email assistant for legal professionals"})]}),u.jsx("div",{className:"w-full max-w-xs animate-slide-up",style:{animationDelay:"0.2s"},children:u.jsx(ze,{onClick:i,className:"w-full h-12 text-base font-medium shadow-lg hover:shadow-xl transition-all duration-200 hover:scale-[1.02] bg-blue-600 hover:bg-blue-700 dark:bg-blue-600 dark:hover:bg-blue-700",disabled:r,children:r?u.jsxs("span",{className:"flex items-center justify-center gap-2",children:[u.jsxs("svg",{className:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[u.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),u.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Logging in..."]}):"Get Started"})})]})},f9=[{available:!0,id:"gmail",name:"Gmail",description:"Connect your Gmail account to access your email",authMethod:"oauth",authUrl:G_(B_),logo:"/gmail.svg",homeUrl:"https://mail.google.com",isConnected:!1,category:"email"},{available:!0,id:"filevine",name:"Filevine",description:"Connect your Filevine account to access case status",authMethod:"custom",authUrl:"https://identity.filevine.com/",customAuthFields:[{id:"clientId",displayName:"Client ID",type:"text"},{id:"clientSecret",displayName:"Client Secret",type:"text"},{id:"PAT",displayName:"Personal Access Token",type:"text"},{id:"organizationId",displayName:"Organization ID",type:"text"},{id:"userId",displayName:"User ID",type:"text"}],logo:"/filevine.svg",homeUrl:"https://identity.filevine.com/",isConnected:!1,category:"case_management"},{available:!0,id:"clio",name:"Clio",description:"Connect your Clio account to access case status",authMethod:"server",authUrl:W_+"clio",logo:"/clio.svg",homeUrl:"https://app.clio.com",isConnected:!1,category:"case_management"},{available:!1,id:"drive",name:"Google Drive",description:"Connect your Google account to access files on Drive",authMethod:"oauth",authUrl:"/api/auth/google",logo:"/google.svg",homeUrl:"https://drive.google.com",isConnected:!1,category:"data_management"},{available:!1,id:"onedrive",name:"OneDrive",description:"Connect your Microsoft account to access files on OneDrive",authMethod:"oauth",authUrl:"/api/auth/onedrive",logo:"/onedrive.svg",homeUrl:"https://onedrive.live.com",isConnected:!1,category:"data_management"}],yI=[{available:!0,id:"inszoom",name:"INSZoom",description:"Connect your INSZoom account to access case status",authMethod:"custom",authUrl:"https://global.inszoom.com/",logo:"/inszoom.ico",customAuthFields:[{id:"auth_key",displayName:"Authorization Key",type:"text"},{id:"subscription_key",displayName:"Subscription Key",type:"text"},{id:"case_status_report",displayName:"Latest Case Status Report",type:"file"}],homeUrl:"https://global.inszoom.com",isConnected:!1,category:"case_management"},{available:!1,id:"drive",name:"Google Drive",description:"Connect your Google account to access files on Drive",authMethod:"oauth",authUrl:"/api/auth/google",logo:"/google.svg",homeUrl:"https://drive.google.com",isConnected:!1,category:"data_management"},{available:!1,id:"onedrive",name:"OneDrive",description:"Connect your Microsoft account to access files on OneDrive",authMethod:"oauth",authUrl:"/api/auth/onedrive",logo:"/onedrive.svg",homeUrl:"https://onedrive.live.com",isConnected:!1,category:"data_management"}],Er="src/lib/utils/integrationUtils.tsx";async function NE(r){const e=f9.find(n=>n.id===r);return e||yI.find(n=>n.id===r)||null}async function h9(r){return yI.find(e=>e.id===r)||null}async function xI(r,e,t,n,s){if(e.authMethod==="server")throw new Error("Integration is a server integration which shouldn't be initiated by the extension");r.info("Initiating integration process for integration:",{sourceFile:Er,integrationId:e});try{let i;if(s&&Object.keys(s).length>0){r.info("Starting file serialization process",{sourceFile:Er,fileCount:Object.keys(s).length});const d=100*1024*1024;for(const[p,m]of Object.entries(s))if(m.size>d){const g=`File "${m.name}" exceeds 100MB limit. File size: ${(m.size/1048576).toFixed(2)}MB`;throw r.error("File size validation failed",new Error(g),{sourceFile:Er,fieldId:p,fileName:m.name,fileSize:m.size,maxSize:d}),new Error(g)}i={};for(const[p,m]of Object.entries(s)){const g=await Ax(m);r.info("Original file checksum calculated",{sourceFile:Er,fieldId:p,fileName:m.name,fileSize:m.size,fileType:m.type,originalChecksum:g});const x=await m.arrayBuffer(),b=new Uint8Array(x),E=await Ax(x);r.info("ArrayBuffer checksum calculated",{sourceFile:Er,fieldId:p,fileName:m.name,bufferChecksum:E,bufferSize:x.byteLength,checksumMatch:g===E});let T="";const S=8192;for(let $=0;$<b.length;$+=S){const W=b.slice($,$+S);T+=String.fromCharCode(...W)}const N=btoa(T),R=atob(N),A=new ArrayBuffer(R.length),j=new Uint8Array(A);for(let $=0;$<R.length;$++)j[$]=R.charCodeAt($);const P=await Ax(A);i[p]={name:m.name,type:m.type,size:m.size,data:N},r.info("File serialization completed",{sourceFile:Er,fieldId:p,fileName:m.name,fileSize:m.size,base64Length:N.length,originalChecksum:g,bufferChecksum:E,decodedChecksum:P,allChecksumsMatch:g===E&&E===P})}r.info("All files serialized successfully",{sourceFile:Er,serializedFileCount:Object.keys(i).length})}const c=await Vn.createServices();if(c.messaging.sendMessage){const d=await c.messaging.sendMessage({type:"INITIATE_INTEGRATION",integration:e,authUrl:t,credentials:n,files:i});if(!d.success)throw new Error(d.error||"Integration failed");return r.info("Integration initiated successfully",{sourceFile:Er}),d.success}else{const d=await chrome.runtime.sendMessage({type:"INITIATE_INTEGRATION",integration:e,authUrl:t,credentials:n,files:i});if(!d.success)throw new Error(d.error||"Integration failed");return r.info("Integration initiated successfully",{sourceFile:Er}),d.success}}catch(i){throw r.error("Integration failed:",i,{sourceFile:Er}),i}}async function p9(r,e){try{const t=await Vn.createServices();if(t.messaging.sendMessage){const n=await t.messaging.sendMessage({type:"DISCONNECT_INTEGRATION",integration:e});if(!n.success)throw new Error(n.error||"Disconnection failed");return r.info("Integration disconnected successfully",{sourceFile:Er}),n.success}else{const n=await chrome.runtime.sendMessage({type:"DISCONNECT_INTEGRATION",integration:e});if(!n.success)throw new Error(n.error||"Disconnection failed");return r.info("Integration disconnected successfully",{sourceFile:Er}),n.success}}catch(t){throw r.error("Disconnection failed:",t,{sourceFile:Er}),t}}async function wI(r){const e="isCaseManagementSystemIntegrationConnected";try{r.debug("Starting CMS integration check",{sourceFile:Er,functionName:e});const t=await Qm(r);r.debug("Local integrations retrieved",{sourceFile:Er,functionName:e,count:t.length,integrations:t.map(m=>m.integration_type)});const n=t.some(m=>m.integration_type==="filevine"||m.integration_type==="clio"||m.integration_type==="inszoom");if(r.debug("Local CMS integration check result",{sourceFile:Er,functionName:e,isConnectedLocally:n}),n)return r.info("CMS integration found in local storage",{sourceFile:Er,functionName:e}),!0;const[s,i]=await Promise.all([qc("user",r).catch(()=>[]),qc("tenant",r).catch(()=>[])]),c=s.map(m=>({integration_type:m.integration_type,tenantId_userId:m.tenantId_userId,scope:"user"})),d=i.map(m=>({integration_type:m.integration_type,tenantId_userId:m.tenantId_userId,scope:"tenant"})),p=[...c,...d];return await Xm(r,p),p.some(m=>m.integration_type==="filevine"||m.integration_type==="clio"||m.integration_type==="inszoom");return r.info("Final CMS integration check result",{sourceFile:Er,functionName:e,isConnectedOnServer}),isConnectedOnServer}catch(t){return r.error("Failed to check if CMS integration is connected",t,{sourceFile:Er,functionName:e}),!1}}async function m9(r,e){try{if((await Qm(r)).some(m=>m.integration_type===e))return!0;const[s,i]=await Promise.all([qc("user",r).catch(()=>[]),qc("tenant",r).catch(()=>[])]),c=s.map(m=>({integration_type:m.integration_type,tenantId_userId:m.tenantId_userId,scope:"user"})),d=i.map(m=>({integration_type:m.integration_type,tenantId_userId:m.tenantId_userId,scope:"tenant"})),p=[...c,...d];return await Xm(r,p),p.some(m=>m.integration_type===e)||!1}catch(t){return r.warn("Failed to check if integration is connected:",{sourceFile:Er,integrationId:e,error:t}),!1}}async function bI(r){try{r.info("Refreshing integrations from server",{sourceFile:Er}),await nT(r);const[e,t]=await Promise.all([qc("user",r).catch(()=>[]),qc("tenant",r).catch(()=>[])]),n=e.map(c=>({integration_type:c.integration_type,tenantId_userId:c.tenantId_userId,scope:"user"})),s=t.map(c=>({integration_type:c.integration_type,tenantId_userId:c.tenantId_userId,scope:"tenant"})),i=[...n,...s];return await Xm(r,i),r.info("Refreshed integrations from server",{sourceFile:Er,userCount:n.length,tenantCount:s.length,totalCount:i.length}),!0}catch(e){return r.warn("Failed to refresh integrations:",{sourceFile:Er,error:e}),!1}}async function _I(r){try{const e=await Qm(r);if(e.length>0)return e;const[t,n]=await Promise.all([qc("user",r).catch(d=>(r.warn("Failed to fetch user integrations:",{sourceFile:Er,error:d}),[])),qc("tenant",r).catch(d=>(r.warn("Failed to fetch tenant integrations:",{sourceFile:Er,error:d}),[]))]),s=t.map(d=>({...d,scope:"user"})),i=n.map(d=>({...d,scope:"tenant"})),c=[...s,...i];return await Xm(r,c),r.info("Saved merged integrations to local storage",{sourceFile:Er,userCount:s.length,tenantCount:i.length,totalCount:c.length,integrations:c}),c}catch(e){return r.error("Failed to list integrations:",e,{sourceFile:Er}),[]}}async function g9(r,e){try{return(await Qm(r)).find(n=>n.integration_type===e)||null}catch(t){return r.error("Failed to get integration details:",t,{sourceFile:Er}),null}}async function v9(r,e){var i;const t=await ly(r),n=((i=t.integrations)==null?void 0:i.filter(c=>c.integration_type!==e.integration_type))||[];n.push(e);const s={...t,integrations:n};await eT(r,s)}async function y9(r,e){var i;const t=await ly(r),n=((i=t.integrations)==null?void 0:i.filter(c=>c.integration_type!==e))||[],s={...t,integrations:n};await eT(r,s)}async function x9(r,e){if(!e)throw new Error("Integration not found");if(e.authMethod!=="server")throw new Error("Integration is not a server integration");try{const t=await Om(r);if(!t)throw r.warn("Failed to get authentication token",{sourceFile:Er}),new Error("Authentication required. Please log in first.");const n=`${W_}${e.id}?token=${encodeURIComponent(t.id_token)}`;r.debug("Opening server auth page",{sourceFile:Er,integrationId:e.id}),window.open(n,"_blank")}catch(t){throw r.error("Failed to open server auth page:",t,{sourceFile:Er}),t}}async function w9(r){try{return await nT(r),await pT(r),!0}catch(e){return r.error("Failed to clear integration data:",e,{sourceFile:Er}),!1}}const b9=Object.freeze(Object.defineProperty({__proto__:null,clearIntegrationData:w9,disconnectIntegration:p9,findIntegrationById:NE,findOrgIntegrationById:h9,getIntegrationDetails:g9,initiateIntegration:xI,isCaseManagementSystemIntegrationConnected:wI,isIntegrationConnected:m9,listIntegrations:_I,openServerAuthPageForIntegration:x9,refreshIntegrations:bI,removeIntegrationDetails:y9,saveIntegrationDetails:v9},Symbol.toStringTag,{value:"Module"})),im="src/components/ui/DetailsTable.tsx",d1=r=>u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",width:"16",height:"16",...r,className:`inline-block w-4 h-4 ${r.className||""}`,children:[u.jsx("path",{d:"M11 3a1 1 0 100 2h2.586l-6.293 6.293a1 1 0 101.414 1.414L15 6.414V9a1 1 0 102 0V4a1 1 0 00-1-1h-5z"}),u.jsx("path",{d:"M5 5a2 2 0 00-2 2v8a2 2 0 002 2h8a2 2 0 002-2v-3a1 1 0 10-2 0v3H5V7h3a1 1 0 000-2H5z"})]}),eu=({details:r,linkableFields:e})=>{const t=Ur(),[n,s]=dr.useState(new Set),[i,c]=dr.useState(new Set),d=80;if(!r)return t.debug("No important details to render",{sourceFile:im}),null;if(Object.keys(r).length===0)return t.debug("No important details to render",{sourceFile:im}),null;const p=T=>{const S=document.createElement("textarea");S.value=T,S.style.position="fixed",S.style.opacity="0",document.body.appendChild(S),S.select();const N=document.execCommand("copy");return document.body.removeChild(S),N},m=(T,S)=>{navigator.clipboard.writeText(T).then(()=>{t.debug("Copied to clipboard",{sourceFile:im,copiedValue:T}),c(N=>new Set([...N,S])),setTimeout(()=>{c(N=>{const R=new Set(N);return R.delete(S),R})},2e3)}).catch(N=>{t.error("Failed to copy with navigator.clipboard.writeText",N,{sourceFile:im});try{p(T)&&(c(R=>new Set([...R,S])),setTimeout(()=>{c(R=>{const A=new Set(R);return A.delete(S),A})},2e3))}catch(R){t.error("Failed to copy with document.execCommand",R,{sourceFile:im})}})},g=T=>{const S=new Set(n);S.has(T)?S.delete(T):S.add(T),s(S)},x=T=>{if(!T)return"";try{return new Date(T).toLocaleDateString(void 0,{timeZone:"UTC"})}catch{return T}},b=T=>{try{const S=new URL(T);return S.protocol==="http:"||S.protocol==="https:"}catch{return!1}},E=T=>T.split(/(\[\[.*?\]\]|\(\(.*?\)\))/g).map((N,R)=>{if(N.startsWith("[[")&&N.endsWith("]]")){const A=N.slice(2,-2);return u.jsx("span",{className:"font-semibold",children:A},R)}else if(N.startsWith("((")&&N.endsWith("))")){const A=N.slice(2,-2);return/^\d{4}-\d{2}-\d{2}/.test(A)?u.jsx("span",{className:"text-base",children:x(A)},R):u.jsx("span",{className:"text-base",children:A},R)}return N});return u.jsx("div",{className:"p-1",children:u.jsx("table",{className:"w-full text-sm text-left text-gray-700 dark:text-gray-300 table-fixed",children:u.jsx("tbody",{children:Object.entries(r).map(([T,S],N)=>{let R;S===""||S===null||S===void 0?R="":typeof S=="string"||typeof S=="number"?R=String(S):R=JSON.stringify(S);const A=e==null?void 0:e.find(M=>M.field===T),j=b(R),P=R.length>d,$=n.has(N),W=P&&!$?R.substring(0,d)+"...":R;return u.jsxs("tr",{className:"bg-card",children:[u.jsx("td",{className:"py-4 px-3 whitespace-normal font-medium w-2/5 text-gray-800 dark:text-gray-200",children:A?u.jsxs("a",{href:A.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 dark:text-blue-400 hover:underline whitespace-normal hover:text-blue-800 dark:hover:text-blue-300 flex items-center gap-1",children:[T,u.jsx(d1,{})]}):T}),u.jsx("td",{className:`py-2 px-3 whitespace-pre-wrap break-words ${j?"":"hover:bg-gray-100 dark:hover:bg-muted"}`,style:j?{}:{cursor:`url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>') 10 10, copy`},onClick:()=>!j&&!P&&m(R,N),title:j?"Click to open link":P?"":"Click to copy",children:j?u.jsxs("a",{href:R,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 dark:text-blue-400 hover:underline break-words flex items-center gap-1",children:[E(R),u.jsx(d1,{className:"flex-shrink-0"})]}):u.jsxs("div",{children:[u.jsxs("div",{className:"relative",children:[u.jsx("span",{className:"break-words text-gray-700 dark:text-gray-300",onClick:()=>!P&&m(R,N),children:E(W)}),i.has(N)&&u.jsx("span",{className:"absolute -top-1 -right-1 bg-white dark:bg-gray-700 text-black dark:text-white text-xs px-2 py-1 rounded-full shadow-lg border border-gray-300 dark:border-gray-600",children:"Copied!"})]}),P&&u.jsx("div",{className:"mt-1",children:u.jsx("button",{onClick:M=>{M.stopPropagation(),g(N)},className:"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 underline text-sm",children:$?"show less":"show more"})})]})})]},N)})})})})},Cn="src/shared/components/sidepanel/mainPanelContent/EmailSummaryBox.tsx",_9=()=>{const[r,e]=w.useState(""),[t,n]=w.useState(null),[s,i]=w.useState(null),[c,d]=w.useState(!1),[p,m]=w.useState(!0),[g,x]=w.useState(!1),[b,E]=w.useState("summary"),[T,S]=w.useState(null),[N,R]=w.useState(null),[A,j]=w.useState(0),{platform:P}=cn(),$=fd(),W=Ur(),M=w.useRef(null),V=w.useRef(null),X=w.useRef(!1),ie=["Analyzing email content...","Extracting key information...","Identifying important details...","Generating summary...","Finalizing insights..."];w.useEffect(()=>{let te;const B=()=>{if(c){const z=Math.floor(Math.random()*1500)+500;te=setTimeout(()=>{j(Y=>(Y+1)%ie.length),B()},z)}};return c&&B(),()=>{te&&clearTimeout(te)}},[c,ie.length]);const J=w.useCallback(async te=>{if(X.current&&M.current===te){W.debug("Already loading summary for thread:",{threadId:te,sourceFile:Cn});return}M.current=te,d(!0),X.current=!0;try{const B=await t8(te,W);M.current===te?(W.debug("Summary response:",{summaryResponse:B,sourceFile:Cn}),e(B.summary),S(B.importantDetails),d(!1),X.current=!1):W.debug("Ignoring summary response for outdated thread:",{threadId:te,sourceFile:Cn})}catch(B){W.error("Error fetching email summary:",B,{sourceFile:Cn}),M.current===te&&(d(!1),X.current=!1)}},[W]),ae=w.useCallback(async(te,B)=>{if(X.current&&M.current===te){W.debug("Already loading summary for thread:",{threadId:te,sourceFile:Cn});return}M.current=te,d(!0),X.current=!0;const z=await z5(te,W);if(z){W.debug("Using cached summary for thread:",{threadId:te,sourceFile:Cn}),e(z.summary),S(z.importantDetails),d(!1),X.current=!1;return}try{if(!B){W.warn("No thread data found",{sourceFile:Cn,functionName:"fetchEmailSummaryForOutlook"}),d(!1),X.current=!1;return}const Y=await r8(B,W);M.current===te?(W.debug("Summary response:",{summaryResponse:Y,sourceFile:Cn}),await U5(te,Y.summary,Y.importantDetails,W),e(Y.summary),S(Y.importantDetails),d(!1),X.current=!1):W.debug("Ignoring summary response for outdated thread:",{threadId:te,sourceFile:Cn})}catch(Y){W.error("Error fetching email summary for Outlook:",Y,{sourceFile:Cn}),M.current===te&&(d(!1),X.current=!1,e("Error fetching email summary. Please try again."))}},[W]);w.useEffect(()=>{const te=async()=>{W.info("Checking if Gmail is connected",{sourceFile:Cn});const z=await Vy(W);W.info("Gmail connection check result",{connected:z,sourceFile:Cn}),m(z)},B=async()=>{try{const Y=(await Vn.createServices()).storage;if(Y.onChanged){const O=U=>{if(U.gmailConnectionStatus){const ne=U.gmailConnectionStatus.newValue;W.info("Gmail connection status changed via storage",{sourceFile:Cn,newStatus:ne,oldStatus:U.gmailConnectionStatus.oldValue}),m(!0)}};return Y.onChanged(O),()=>{Y.removeChangeListener&&Y.removeChangeListener(O)}}}catch(z){W.error("Failed to set up storage listener:",z,{sourceFile:Cn})}};if(P==="chrome"){const Y=(async()=>(await te(),await B()))();return()=>{Y.then(O=>O==null?void 0:O())}}else P==="outlook"&&(m(!1),console.log("Not calling checkGmailConnection for Outlook"))},[P,W]),w.useEffect(()=>{if($!=null&&$.onThreadChanged){const te=z=>{if(W.debug("Thread change received",{sourceFile:Cn,functionName:"handleThreadChange",hasThread:!!z,threadId:z==null?void 0:z.threadId,platform:P}),!z){W.debug("No thread provided, keeping current state",{sourceFile:Cn}),n(null),i(null);return}if(n(z.threadId||null),W.debug("Thread ID set",{sourceFile:Cn,threadId:z.threadId}),z.messages&&Array.isArray(z.messages)&&z.messages.length>0&&z.messages[0]&&typeof z.messages[0]=="object"){const Y=z.messages.map((O,U)=>({body:O.body||O.html||"",html:O.html||O.body||"",from:O.from||"",timestamp:O.timestamp||"",subject:U===0&&z.subject||""}));i(JSON.stringify(Y)),W.debug("Thread data converted and set",{sourceFile:Cn,messageCount:Y.length})}};return $.onThreadChanged(te),(async()=>{try{const z=await $.getCurrentThread();te(z)}catch(z){W.error("Error loading current thread",z,{sourceFile:Cn,functionName:"loadCurrentThread"})}})(),()=>{$.removeThreadListener&&$.removeThreadListener(te)}}},[$,P,W]),w.useEffect(()=>{t&&p&&P==="chrome"?(t!==M.current||!X.current)&&J(t):!p&&P==="chrome"?(e("Connect to Gmail to enable email summaries"),S(null),E("summary"),M.current=null,X.current=!1,d(!1)):!p&&P==="outlook"&&s&&t?(t!==M.current||!X.current)&&ae(t||"",s):(e("Select a thread to summarize"),S(null),E("summary"),M.current=null,X.current=!1,d(!1))},[t,p,J,ae,P,s]);const we=async()=>{try{x(!0);const te=G_(B_),B=await NE("gmail");if(!B){W.error("Gmail integration not found",new Error("Gmail integration not found"),{sourceFile:Cn});return}await xI(W,B,te)&&(m(!0),t&&J(t))}catch(te){W.error("Failed to connect to Gmail:",te,{sourceFile:Cn}),e("Failed to connect to Gmail. Please try again.")}finally{x(!1)}},ue=()=>T?u.jsx(eu,{details:T}):null,oe=()=>{b==="summary"&&V.current&&(R(V.current.offsetHeight),E("details"))},pe=T!==null&&Object.keys(T).length>0;return w.useEffect(()=>{pe||E("summary")},[pe]),w.useEffect(()=>{N&&document.documentElement.style.setProperty("--content-height",`${N}px`)},[N]),u.jsxs("div",{className:"w-full max-w-full min-h-[4rem] border rounded-lg shadow-md bg-white mx-2 mt-2 mb-6 overflow-hidden box-border border-b-0",title:"Email Summary",style:{maxWidth:"calc(100% - 1rem)"},children:[u.jsx("div",{className:"flex items-center justify-center p-2 border-b bg-gray-150 min-w-0",children:u.jsxs("div",{className:"flex items-center gap-1 bg-gray-150 p-1 rounded-full",children:[u.jsxs("button",{className:`px-3 py-1.5 rounded-full text-sm font-medium transition-colors whitespace-nowrap flex items-center gap-1.5 ${b==="summary"?"text-blue-700 border bg-white border-blue-200":"bg-gray-75 text-gray-600 hover:bg-gray-100 border border-gray-200"}`,onClick:()=>E("summary"),children:[u.jsx(Kc,{className:"w-3.5 h-3.5"}),"Summary"]}),pe&&u.jsxs("button",{className:`px-3 py-1.5 rounded-full text-sm font-medium transition-colors flex items-center gap-1.5 whitespace-nowrap ${b==="details"?"text-blue-700 border bg-white border-blue-200":"bg-gray-75 text-gray-600 hover:bg-gray-100 border border-gray-200"}`,onClick:oe,children:[u.jsx(Mc,{src:"/icons/info-circled.svg",width:14,height:14,alt:"Info",className:"w-3.5 h-3.5"}),"Key Points"]})]})}),u.jsx("div",{className:"w-full min-w-0",children:c?u.jsxs("div",{className:"w-full border rounded flex flex-col items-center justify-center bg-gray-50 p-4",children:[u.jsx(Zi,{className:"h-8 w-8 animate-spin text-blue-600"}),u.jsx("div",{className:"text-center text-sm text-gray-500",children:ie[A]})]}):!p&&P==="chrome"?u.jsxs("div",{className:"w-full p-4 flex flex-col items-center justify-center",children:[u.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Connect to Gmail to enable email summaries"}),u.jsx(ze,{onClick:we,className:"w-full bg-blue-600 hover:bg-blue-700 text-white py-4 mt-2",disabled:g,children:g?"Connecting...":"Connect Gmail"})]}):u.jsx("div",{className:"w-full min-w-0 overflow-hidden",children:b==="summary"?u.jsx("div",{ref:V,className:"p-3 text-sm text-gray-600 whitespace-pre-wrap break-words overflow-wrap-anywhere",children:r}):u.jsx("div",{className:"overflow-y-auto",children:ue()})})})]})};function f1(r){const e=E9(r),t=w.forwardRef((n,s)=>{const{children:i,...c}=n,d=w.Children.toArray(i),p=d.find(C9);if(p){const m=p.props.children,g=d.map(x=>x===p?w.Children.count(m)>1?w.Children.only(null):w.isValidElement(m)?m.props.children:null:x);return u.jsx(e,{...c,ref:s,children:w.isValidElement(m)?w.cloneElement(m,void 0,g):null})}return u.jsx(e,{...c,ref:s,children:i})});return t.displayName=`${r}.Slot`,t}function E9(r){const e=w.forwardRef((t,n)=>{const{children:s,...i}=t;if(w.isValidElement(s)){const c=N9(s),d=k9(i,s.props);return s.type!==w.Fragment&&(d.ref=n?Qc(n,c):c),w.cloneElement(s,d)}return w.Children.count(s)>1?w.Children.only(null):null});return e.displayName=`${r}.SlotClone`,e}var S9=Symbol("radix.slottable");function C9(r){return w.isValidElement(r)&&typeof r.type=="function"&&"__radixId"in r.type&&r.type.__radixId===S9}function k9(r,e){const t={...e};for(const n in e){const s=r[n],i=e[n];/^on[A-Z]/.test(n)?s&&i?t[n]=(...d)=>{const p=i(...d);return s(...d),p}:s&&(t[n]=s):n==="style"?t[n]={...s,...i}:n==="className"&&(t[n]=[s,i].filter(Boolean).join(" "))}return{...r,...t}}function N9(r){var n,s;let e=(n=Object.getOwnPropertyDescriptor(r.props,"ref"))==null?void 0:n.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=(s=Object.getOwnPropertyDescriptor(r,"ref"))==null?void 0:s.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}function TE(r){const e=r+"CollectionProvider",[t,n]=Wa(e),[s,i]=t(e,{collectionRef:{current:null},itemMap:new Map}),c=S=>{const{scope:N,children:R}=S,A=dr.useRef(null),j=dr.useRef(new Map).current;return u.jsx(s,{scope:N,itemMap:j,collectionRef:A,children:R})};c.displayName=e;const d=r+"CollectionSlot",p=f1(d),m=dr.forwardRef((S,N)=>{const{scope:R,children:A}=S,j=i(d,R),P=On(N,j.collectionRef);return u.jsx(p,{ref:P,children:A})});m.displayName=d;const g=r+"CollectionItemSlot",x="data-radix-collection-item",b=f1(g),E=dr.forwardRef((S,N)=>{const{scope:R,children:A,...j}=S,P=dr.useRef(null),$=On(N,P),W=i(g,R);return dr.useEffect(()=>(W.itemMap.set(P,{ref:P,...j}),()=>void W.itemMap.delete(P))),u.jsx(b,{[x]:"",ref:$,children:A})});E.displayName=g;function T(S){const N=i(r+"CollectionConsumer",S);return dr.useCallback(()=>{const A=N.collectionRef.current;if(!A)return[];const j=Array.from(A.querySelectorAll(`[${x}]`));return Array.from(N.itemMap.values()).sort((W,M)=>j.indexOf(W.ref.current)-j.indexOf(M.ref.current))},[N.collectionRef,N.itemMap])}return[{Provider:c,Slot:m,ItemSlot:E},T,n]}var T9=w.createContext(void 0);function l0(r){const e=w.useContext(T9);return r||e||"ltr"}var vw="rovingFocusGroup.onEntryFocus",R9={bubbles:!1,cancelable:!0},ig="RovingFocusGroup",[Sb,EI,A9]=TE(ig),[I9,c0]=Wa(ig,[A9]),[P9,F9]=I9(ig),SI=w.forwardRef((r,e)=>u.jsx(Sb.Provider,{scope:r.__scopeRovingFocusGroup,children:u.jsx(Sb.Slot,{scope:r.__scopeRovingFocusGroup,children:u.jsx(j9,{...r,ref:e})})}));SI.displayName=ig;var j9=w.forwardRef((r,e)=>{const{__scopeRovingFocusGroup:t,orientation:n,loop:s=!1,dir:i,currentTabStopId:c,defaultCurrentTabStopId:d,onCurrentTabStopIdChange:p,onEntryFocus:m,preventScrollOnEntryFocus:g=!1,...x}=r,b=w.useRef(null),E=On(e,b),T=l0(i),[S,N]=Zc({prop:c,defaultProp:d??null,onChange:p,caller:ig}),[R,A]=w.useState(!1),j=Wl(m),P=EI(t),$=w.useRef(!1),[W,M]=w.useState(0);return w.useEffect(()=>{const V=b.current;if(V)return V.addEventListener(vw,j),()=>V.removeEventListener(vw,j)},[j]),u.jsx(P9,{scope:t,orientation:n,dir:T,loop:s,currentTabStopId:S,onItemFocus:w.useCallback(V=>N(V),[N]),onItemShiftTab:w.useCallback(()=>A(!0),[]),onFocusableItemAdd:w.useCallback(()=>M(V=>V+1),[]),onFocusableItemRemove:w.useCallback(()=>M(V=>V-1),[]),children:u.jsx(jr.div,{tabIndex:R||W===0?-1:0,"data-orientation":n,...x,ref:E,style:{outline:"none",...r.style},onMouseDown:At(r.onMouseDown,()=>{$.current=!0}),onFocus:At(r.onFocus,V=>{const X=!$.current;if(V.target===V.currentTarget&&X&&!R){const ie=new CustomEvent(vw,R9);if(V.currentTarget.dispatchEvent(ie),!ie.defaultPrevented){const J=P().filter(pe=>pe.focusable),ae=J.find(pe=>pe.active),we=J.find(pe=>pe.id===S),oe=[ae,we,...J].filter(Boolean).map(pe=>pe.ref.current);NI(oe,g)}}$.current=!1}),onBlur:At(r.onBlur,()=>A(!1))})})}),CI="RovingFocusGroupItem",kI=w.forwardRef((r,e)=>{const{__scopeRovingFocusGroup:t,focusable:n=!0,active:s=!1,tabStopId:i,children:c,...d}=r,p=Ul(),m=i||p,g=F9(CI,t),x=g.currentTabStopId===m,b=EI(t),{onFocusableItemAdd:E,onFocusableItemRemove:T,currentTabStopId:S}=g;return w.useEffect(()=>{if(n)return E(),()=>T()},[n,E,T]),u.jsx(Sb.ItemSlot,{scope:t,id:m,focusable:n,active:s,children:u.jsx(jr.span,{tabIndex:x?0:-1,"data-orientation":g.orientation,...d,ref:e,onMouseDown:At(r.onMouseDown,N=>{n?g.onItemFocus(m):N.preventDefault()}),onFocus:At(r.onFocus,()=>g.onItemFocus(m)),onKeyDown:At(r.onKeyDown,N=>{if(N.key==="Tab"&&N.shiftKey){g.onItemShiftTab();return}if(N.target!==N.currentTarget)return;const R=L9(N,g.orientation,g.dir);if(R!==void 0){if(N.metaKey||N.ctrlKey||N.altKey||N.shiftKey)return;N.preventDefault();let j=b().filter(P=>P.focusable).map(P=>P.ref.current);if(R==="last")j.reverse();else if(R==="prev"||R==="next"){R==="prev"&&j.reverse();const P=j.indexOf(N.currentTarget);j=g.loop?M9(j,P+1):j.slice(P+1)}setTimeout(()=>NI(j))}}),children:typeof c=="function"?c({isCurrentTabStop:x,hasTabStop:S!=null}):c})})});kI.displayName=CI;var O9={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function D9(r,e){return e!=="rtl"?r:r==="ArrowLeft"?"ArrowRight":r==="ArrowRight"?"ArrowLeft":r}function L9(r,e,t){const n=D9(r.key,t);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return O9[n]}function NI(r,e=!1){const t=document.activeElement;for(const n of r)if(n===t||(n.focus({preventScroll:e}),document.activeElement!==t))return}function M9(r,e){return r.map((t,n)=>r[(e+n)%r.length])}var TI=SI,RI=kI,u0="Tabs",[$9]=Wa(u0,[c0]),AI=c0(),[U9,RE]=$9(u0),II=w.forwardRef((r,e)=>{const{__scopeTabs:t,value:n,onValueChange:s,defaultValue:i,orientation:c="horizontal",dir:d,activationMode:p="automatic",...m}=r,g=l0(d),[x,b]=Zc({prop:n,onChange:s,defaultProp:i??"",caller:u0});return u.jsx(U9,{scope:t,baseId:Ul(),value:x,onValueChange:b,orientation:c,dir:g,activationMode:p,children:u.jsx(jr.div,{dir:g,"data-orientation":c,...m,ref:e})})});II.displayName=u0;var PI="TabsList",FI=w.forwardRef((r,e)=>{const{__scopeTabs:t,loop:n=!0,...s}=r,i=RE(PI,t),c=AI(t);return u.jsx(TI,{asChild:!0,...c,orientation:i.orientation,dir:i.dir,loop:n,children:u.jsx(jr.div,{role:"tablist","aria-orientation":i.orientation,...s,ref:e})})});FI.displayName=PI;var jI="TabsTrigger",OI=w.forwardRef((r,e)=>{const{__scopeTabs:t,value:n,disabled:s=!1,...i}=r,c=RE(jI,t),d=AI(t),p=MI(c.baseId,n),m=$I(c.baseId,n),g=n===c.value;return u.jsx(RI,{asChild:!0,...d,focusable:!s,active:g,children:u.jsx(jr.button,{type:"button",role:"tab","aria-selected":g,"aria-controls":m,"data-state":g?"active":"inactive","data-disabled":s?"":void 0,disabled:s,id:p,...i,ref:e,onMouseDown:At(r.onMouseDown,x=>{!s&&x.button===0&&x.ctrlKey===!1?c.onValueChange(n):x.preventDefault()}),onKeyDown:At(r.onKeyDown,x=>{[" ","Enter"].includes(x.key)&&c.onValueChange(n)}),onFocus:At(r.onFocus,()=>{const x=c.activationMode!=="manual";!g&&!s&&x&&c.onValueChange(n)})})})});OI.displayName=jI;var DI="TabsContent",LI=w.forwardRef((r,e)=>{const{__scopeTabs:t,value:n,forceMount:s,children:i,...c}=r,d=RE(DI,t),p=MI(d.baseId,n),m=$I(d.baseId,n),g=n===d.value,x=w.useRef(g);return w.useEffect(()=>{const b=requestAnimationFrame(()=>x.current=!1);return()=>cancelAnimationFrame(b)},[]),u.jsx(sa,{present:s||g,children:({present:b})=>u.jsx(jr.div,{"data-state":g?"active":"inactive","data-orientation":d.orientation,role:"tabpanel","aria-labelledby":p,hidden:!b,id:m,tabIndex:0,...c,ref:e,style:{...r.style,animationDuration:x.current?"0s":void 0},children:b&&i})})});LI.displayName=DI;function MI(r,e){return`${r}-trigger-${e}`}function $I(r,e){return`${r}-content-${e}`}var z9=II,UI=FI,zI=OI,HI=LI;const H9=z9,BI=w.forwardRef(({className:r,...e},t)=>u.jsx(UI,{ref:t,className:Rr("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",r),...e}));BI.displayName=UI.displayName;const ny=w.forwardRef(({className:r,...e},t)=>u.jsx(zI,{ref:t,className:Rr("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm overflow-x-hidden",r),...e}));ny.displayName=zI.displayName;const sy=w.forwardRef(({className:r,...e},t)=>u.jsx(HI,{ref:t,className:Rr("ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",r),...e}));sy.displayName=HI.displayName;const B9="https://rubypowerslaw.filevineapp.com",Pr="src/sidepanel/panels/DocViewerPanel.tsx",GI=({documentId:r,documentName:e,onBack:t})=>{const n=Ur();n.info(`[DocViewerPanel] Initializing with documentId: ${r}, documentName: ${e}`,{sourceFile:Pr});const[s,i]=w.useState(null),[c,d]=w.useState(!0),[p,m]=w.useState(null),[g,x]=w.useState("other"),[b,E]=w.useState(!0),[T,S]=w.useState(!1),[N,R]=w.useState(0),[A,j]=w.useState(!1),P=w.useRef(null),$=w.useCallback(ae=>{n.info(`[DocViewerPanel] getDocumentType called with extension: ${ae}`,{sourceFile:Pr});const we=["jpg","jpeg","png","gif","bmp","webp","svg","tiff"],ue=["pdf"],oe=["doc","docx","xls","xlsx","ppt","pptx","odt","ods","odp","rtf"],pe=["txt","md","csv","json","xml","html","htm"];let te="other";return we.includes(ae)?te="image":ue.includes(ae)?te="pdf":oe.includes(ae)?te="office":pe.includes(ae)&&(te="text"),n.info(`[DocViewerPanel] Document type determined: ${te} for extension: ${ae}`,{sourceFile:Pr}),te},[n]);w.useEffect(()=>{(async()=>{var we;if(n.info(`[DocViewerPanel] Starting fetchDocumentUrl for documentId: ${r}`,{sourceFile:Pr}),!r){n.warn("[DocViewerPanel] No document ID provided",{sourceFile:Pr,error:"No document ID provided"}),m("No document ID provided"),d(!1);return}d(!0),m(null);try{n.info(`[DocViewerPanel] Fetching document URL from server for documentId: ${r}`,{sourceFile:Pr});const ue=await o8("filevine",r.toString(),n);if(n.info("[DocViewerPanel] Received document data:",{sourceFile:Pr,documentData:ue}),!ue.url){const te=new Error("Document URL not found in response");throw n.error("[DocViewerPanel] Document URL not found in response",te,{sourceFile:Pr}),te}n.info(`[DocViewerPanel] Setting document URL: ${ue.url}`,{sourceFile:Pr}),i(ue.url);const oe=((we=e.split(".").pop())==null?void 0:we.toLowerCase())||"";n.info(`[DocViewerPanel] Detected file extension: ${oe}`,{sourceFile:Pr});const pe=$(oe);n.info(`[DocViewerPanel] Determined document type: ${pe}`,{sourceFile:Pr}),x(pe)}catch(ue){n.error("[DocViewerPanel] Error fetching document URL:",ue,{sourceFile:Pr}),m("Failed to load document. Please try again later.")}finally{d(!1)}})()},[r,e,N,n,$]),w.useEffect(()=>(P.current&&(clearTimeout(P.current),P.current=null),j(!1),!c&&b&&g!=="image"&&(n.info("[DocViewerPanel] Setting loading timeout for document",{sourceFile:Pr}),P.current=setTimeout(()=>{n.info("[DocViewerPanel] Document loading is taking too long",{sourceFile:Pr}),j(!0)},1e4)),()=>{P.current&&(clearTimeout(P.current),P.current=null)}),[c,b,g,n]);const W=()=>{n.info("[DocViewerPanel] iframe loaded successfully",{sourceFile:Pr}),E(!1),S(!1),j(!1),P.current&&(clearTimeout(P.current),P.current=null)},M=ae=>{n.error("[DocViewerPanel] iframe error:",ae,{sourceFile:Pr}),E(!1),S(!0),j(!1),P.current&&(clearTimeout(P.current),P.current=null)},V=()=>{n.info("[DocViewerPanel] Retrying document load",{sourceFile:Pr}),E(!0),S(!1),j(!1),R(ae=>ae+1)},X=()=>{if(r){const ae=`${B9}/docwebviewer/view/${r}`;n.info(`[DocViewerPanel] Opening document in new tab with original URL: ${ae}`,{sourceFile:Pr}),window.open(ae,"_blank")}},ie=()=>{if(!s){n.warn("[DocViewerPanel] No document URL available for download",{sourceFile:Pr});return}try{n.info(`[DocViewerPanel] Starting download for: ${e}`,{sourceFile:Pr});const ae=new URL(s);ae.searchParams.set("response-content-disposition",`attachment; filename="${encodeURIComponent(e)}"`);const we=document.createElement("a");we.href=ae.toString(),we.download=e,we.target="_blank",we.rel="noopener noreferrer",document.body.appendChild(we),we.click(),setTimeout(()=>{document.body.removeChild(we)},100),n.info(`[DocViewerPanel] Download initiated for: ${e}`,{sourceFile:Pr})}catch(ae){n.error("[DocViewerPanel] Error downloading document:",ae,{sourceFile:Pr})}};if(c)return n.info("[DocViewerPanel] Rendering loading state",{sourceFile:Pr}),u.jsxs(_i,{className:"w-full h-full",children:[u.jsx(Ji,{className:"pb-4",children:u.jsxs("div",{className:"flex flex-row items-start gap-3",children:[u.jsx(ze,{variant:"ghost",size:"sm",onClick:t,className:"h-8 w-8 p-0 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors shrink-0 mt-0.5","aria-label":"Go back",title:"Go back",children:u.jsx(Cm,{className:"h-4 w-4"})}),u.jsx(Xi,{className:"text-base font-semibold leading-relaxed break-words flex-1 min-w-0",children:e})]})}),u.jsx(Ei,{className:"flex items-center justify-center h-[80vh]",children:u.jsxs("div",{className:"text-center",children:[u.jsx(Zi,{className:"h-8 w-8 animate-spin mx-auto mb-4 text-blue-600 dark:text-blue-400"}),u.jsx("p",{className:"dark:text-gray-200",children:"Loading document..."})]})})]});if(p)return n.info(`[DocViewerPanel] Rendering error state: ${p}`,{sourceFile:Pr}),u.jsxs(_i,{className:"w-full h-full",children:[u.jsx(Ji,{className:"pb-4",children:u.jsxs("div",{className:"flex flex-row items-start gap-3",children:[u.jsx(ze,{variant:"ghost",size:"sm",onClick:t,className:"h-8 w-8 p-0 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors shrink-0 mt-0.5","aria-label":"Go back",title:"Go back",children:u.jsx(Cm,{className:"h-4 w-4"})}),u.jsx(Xi,{className:"text-base font-semibold leading-relaxed break-words flex-1 min-w-0",children:e})]})}),u.jsx(Ei,{className:"flex items-center justify-center h-[80vh]",children:u.jsxs("div",{className:"text-center text-red-500",children:[u.jsx("p",{children:p}),u.jsxs(ze,{variant:"outline",className:"mt-4",onClick:V,children:[u.jsx(No,{className:"h-4 w-4 mr-2"}),"Retry"]})]})})]});const J=()=>{if(n.info(`[DocViewerPanel] renderDocumentViewer called with documentType: ${g}, documentUrl: ${s}`,{sourceFile:Pr}),!s)return n.info("[DocViewerPanel] No document URL available, returning null",{sourceFile:Pr}),null;const ae=`https://docs.google.com/viewer?url=${encodeURIComponent(s||"")}&embedded=true`;n.info(`[DocViewerPanel] Google Docs Viewer URL: ${ae}`,{sourceFile:Pr});const we=g==="pdf"?"PDF":g==="office"?"Office document":g==="text"?"Text document":g==="image"?"Image":"Document";return g==="image"?(n.info("[DocViewerPanel] Rendering image viewer",{sourceFile:Pr}),u.jsx("div",{className:"w-full h-full flex items-center justify-center overflow-auto",children:u.jsx("img",{src:s,alt:e,className:"max-w-full max-h-full object-contain",onLoad:()=>E(!1),onError:()=>{E(!1),S(!0)}})})):(n.info(`[DocViewerPanel] Rendering ${we} viewer with Google Docs for: ${e}`,{sourceFile:Pr}),u.jsxs("div",{className:"w-full h-full relative",children:[b&&u.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white dark:bg-gray-900 bg-opacity-80 dark:bg-opacity-80 z-10",children:u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 dark:border-gray-100 mx-auto mb-4"}),u.jsxs("p",{className:"dark:text-gray-200",children:["Loading ",we.toLowerCase(),"..."]}),u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-2",children:"This may take a moment for large files"}),A&&u.jsxs("div",{className:"mt-4 p-4 bg-yellow-50 border border-yellow-200 rounded-md",children:[u.jsx("p",{className:"text-amber-700 font-medium",children:"This is taking longer than expected."}),u.jsx("p",{className:"text-sm text-amber-600 mt-1",children:g==="office"?"Office documents can sometimes be slow to load in the viewer.":"This document might be large or complex."}),u.jsxs("div",{className:"mt-3 flex justify-center space-x-3",children:[u.jsxs(ze,{variant:"outline",size:"sm",onClick:V,children:[u.jsx(No,{className:"h-3 w-3 mr-1"}),"Retry"]}),u.jsx(ze,{variant:"default",size:"sm",onClick:X,children:"Open in new tab"})]})]})]})}),T&&u.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white dark:bg-gray-900 z-10",children:u.jsxs("div",{className:"text-center text-red-500 dark:text-red-400",children:[u.jsxs("p",{children:["Failed to load ",we.toLowerCase(),"."]}),u.jsx("p",{className:"text-sm mt-2 dark:text-gray-400",children:"The document might be too large or in an unsupported format."}),u.jsxs("div",{className:"mt-4 flex justify-center space-x-3",children:[u.jsxs(ze,{variant:"outline",onClick:V,children:[u.jsx(No,{className:"h-4 w-4 mr-2"}),"Retry"]}),u.jsx(ze,{variant:"default",onClick:X,children:"Open in new tab"})]})]})}),u.jsx("iframe",{src:ae,className:"w-full h-full border-none",title:e,sandbox:"allow-scripts allow-same-origin allow-forms allow-popups allow-popups-to-escape-sandbox",onLoad:W,onError:M})]}))};return n.info(`[DocViewerPanel] Rendering main component with documentType: ${g}`,{sourceFile:Pr}),u.jsxs(_i,{className:"w-full h-full",children:[u.jsxs(Ji,{className:"pb-4",children:[u.jsxs("div",{className:"flex flex-row items-start gap-3",children:[u.jsx(ze,{variant:"ghost",size:"sm",onClick:t,className:"h-8 w-8 p-0 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors shrink-0 mt-0.5","aria-label":"Go back",title:"Go back",children:u.jsx(Cm,{className:"h-4 w-4"})}),u.jsx(Xi,{className:"text-base font-semibold leading-relaxed break-words flex-1 min-w-0",children:e})]}),!c&&u.jsxs("div",{className:"flex gap-2 pl-8 pr-6",children:[u.jsxs(ze,{variant:"outline",size:"sm",onClick:ie,className:"h-9 px-4","aria-label":"Download file",children:[u.jsx(lB,{className:"h-4 w-4 mr-2"}),"Download"]}),u.jsxs(ze,{variant:"outline",size:"sm",onClick:X,className:"h-9 px-4","aria-label":"Open in new tab",children:[u.jsx(Ml,{className:"h-4 w-4 mr-2"}),"Open in new tab"]})]})]}),u.jsx(Ei,{className:"h-[80vh] overflow-hidden",children:J()})]})},Al="src/sidepanel/panels/ClientDocumentsPanel.tsx",G9="https://rubypowerslaw.filevineapp.com",W9=({clientEmail:r,projectId:e,documents:t,isLoading:n,error:s,goBack:i,initialSelectedDocument:c})=>{const d=Ur(),[p,m]=w.useState([]),[g,x]=w.useState(!1),[b,E]=w.useState(null),[T,S]=w.useState(""),[N,R]=w.useState(null),[A,j]=w.useState({contracts:!1,payments:!1,allDocuments:!0}),[P,$]=w.useState({});w.useEffect(()=>{const z={sourceFile:Al,functionName:"useEffect[fetchData]"};if(t&&t.length>0||n){t&&m(t);return}(async()=>{if(!e){E("No project ID provided. Please select a valid project.");return}x(!0),E(null);try{const O=await gT(e,d);if(O){d.debug("Using cached documents for project",{...z,data:{projectId:e}}),m(O),x(!1);return}d.debug("ClientDocumentsPanel: Fetching documents from server for project",{...z,data:{projectId:e}});const ne=(await RT("filevine",e,d)).documents.map(Ee=>({name:Ee.filename,url:`${G9}/docwebviewer/view/${Ee.documentId}`,documentId:Ee.documentId,folderName:Ee.folderName}));await mT(e,ne,d),m(ne)}catch(O){d.error("Error fetching documents:",O,z),E("Failed to load documents. Please try again later.")}finally{x(!1)}})()},[e,t,n,d]);const W=n!==void 0?n:g,M=s!==void 0?s:b,V=dr.useMemo(()=>{const z={sourceFile:Al,functionName:"useMemo[filteredDocuments]"};return d.debug("Computing filteredDocuments",z),p.filter(Y=>Y.name.toLowerCase().includes(T.toLowerCase()))},[p,T,d]),X=p.filter(z=>z.folderName&&z.folderName.toLowerCase().includes("contract")),ie=p.filter(z=>z.folderName&&z.folderName.toLowerCase().includes("payment")),J=z=>{var ne;const Y={sourceFile:Al,functionName:"isViewableDocument",data:{filename:z}},O=(ne=z.split(".").pop())==null?void 0:ne.toLowerCase(),U=["pdf","jpg","jpeg","png","gif","bmp","webp","doc","docx","xls","xlsx","ppt","pptx","odt","ods","odp","rtf","txt"];return d.debug(`File extension: ${O}`,Y),d.debug(`Viewable extensions: ${U}`,Y),U.includes(O||"")},ae=z=>{var O;const Y=((O=z.split(".").pop())==null?void 0:O.toLowerCase())||"";return["jpg","jpeg","png","gif","bmp","webp","svg","tiff"].includes(Y)?u.jsx(hB,{className:"h-4 w-4 text-purple-500 dark:text-purple-400"}):["xls","xlsx","csv","ods"].includes(Y)?u.jsx(uB,{className:"h-4 w-4 text-green-500 dark:text-green-400"}):["ppt","pptx","odp"].includes(Y)?u.jsx(xB,{className:"h-4 w-4 text-orange-500 dark:text-orange-400"}):["pdf","doc","docx","txt","rtf","odt"].includes(Y)?u.jsx(sh,{className:"h-4 w-4 text-blue-500 dark:text-blue-400"}):u.jsx(dB,{className:"h-4 w-4 text-gray-500 dark:text-gray-400"})},we=z=>{const Y={sourceFile:Al,functionName:"handleViewDocument",data:{docName:z.name,docId:z.documentId,url:z.url,folder:z.folderName}};d.debug("Handling view document",Y),z.documentId&&J(z.name)?(d.debug("Selected document",Y),R({name:z.name,documentId:z.documentId,url:z.url,folderName:z.folderName})):z.url&&(d.debug("Opening document URL",Y),window.open(z.url,"_blank"))},ue=z=>{j(Y=>({...Y,[z]:!Y[z]}))},oe=z=>{const Y={sourceFile:Al,functionName:"toggleFolder",data:{folderName:z}};d.debug("Toggling folder",Y),$(O=>({...O,[z]:!O[z]}))},pe=dr.useCallback(z=>{const Y={sourceFile:Al,functionName:"groupDocumentsByFolder"};d.debug("Running groupDocumentsByFolder",Y);const O={};return O["No Folder"]=[],z.forEach(U=>{const ne=U.folderName||"No Folder";O[ne]||(O[ne]=[]),O[ne].push(U)}),O["No Folder"].length===0&&delete O["No Folder"],O},[d]),te=dr.useMemo(()=>{const z={sourceFile:Al,functionName:"useMemo[groupedFilteredDocuments]"};return d.debug("Computing groupedFilteredDocuments",z),pe(V)},[V,pe,d]);w.useEffect(()=>{const z={sourceFile:Al,functionName:"useEffect[folderExpansion]"};if(d.debug("Running folder expansion initialization effect",z),V.length>0){const Y=Object.keys(te);d.debug(`Found folders: ${Y.join(", ")}`,z),$(O=>{const U={...O};let ne=!1;return Y.forEach(Ee=>{U[Ee]===void 0&&(U[Ee]=!1,ne=!0)}),ne?U:O})}},[te,V.length,d]),w.useEffect(()=>{const z={sourceFile:Al,functionName:"useEffect[initialSelectedDocument]"};c&&(d.debug("Setting initial selected document",{...z,document:c}),R({name:c.name,documentId:c.documentId,url:c.url}))},[c,d]);const B=()=>!W&&!M&&p.length===0?u.jsx("div",{className:"text-gray-500 dark:text-gray-400 text-center py-4",children:"No documents found for this client."}):!W&&!M&&p.length>0?u.jsxs("div",{className:"space-y-4",children:[X.length>0&&u.jsxs("div",{children:[u.jsxs("button",{onClick:()=>ue("contracts"),className:"flex items-center justify-between w-full py-2 text-left font-medium text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-md px-2",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx(sh,{className:"h-4 w-4 mr-2 text-blue-500 dark:text-blue-400"}),u.jsxs("span",{children:["Contracts (",X.length,")"]})]}),A.contracts?u.jsx(Iv,{className:"h-4 w-4"}):u.jsx(ms,{className:"h-4 w-4"})]}),A.contracts&&u.jsx("ul",{className:"ml-6 mt-2 space-y-1 text-sm",children:X.map(z=>u.jsxs("li",{className:"flex items-center gap-2 text-gray-600 dark:text-gray-400",children:[u.jsx("span",{className:"flex-shrink-0",children:ae(z.name)}),u.jsx("button",{onClick:()=>we(z),className:"text-blue-600 dark:text-blue-400 hover:underline hover:text-blue-800 dark:hover:text-blue-300 focus:outline-none text-left truncate min-w-0",title:z.name,children:z.name})]},z.documentId))})]}),ie.length>0&&u.jsxs("div",{children:[u.jsxs("button",{onClick:()=>ue("payments"),className:"flex items-center justify-between w-full py-2 text-left font-medium text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-md px-2",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx(aB,{className:"h-4 w-4 mr-2 text-green-500 dark:text-green-400"}),u.jsxs("span",{children:["Payments (",ie.length,")"]})]}),A.payments?u.jsx(Iv,{className:"h-4 w-4"}):u.jsx(ms,{className:"h-4 w-4"})]}),A.payments&&u.jsx("ul",{className:"ml-6 mt-2 space-y-1 text-sm",children:ie.map(z=>u.jsxs("li",{className:"flex items-center gap-2 text-gray-600 dark:text-gray-400",children:[u.jsx("span",{className:"flex-shrink-0",children:ae(z.name)}),u.jsx("button",{onClick:()=>we(z),className:"text-blue-600 dark:text-blue-400 hover:underline hover:text-blue-800 dark:hover:text-blue-300 focus:outline-none text-left truncate min-w-0",title:z.name,children:z.name})]},z.documentId))})]}),V.length>0&&u.jsxs("div",{children:[u.jsxs("button",{onClick:()=>ue("allDocuments"),className:"flex items-center justify-between w-full py-2 text-left font-medium text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-md px-2",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx(sh,{className:"h-4 w-4 mr-2 text-gray-500 dark:text-gray-400"}),u.jsxs("span",{children:["All Documents (",V.length,")"]})]}),A.allDocuments?u.jsx(Iv,{className:"h-4 w-4"}):u.jsx(ms,{className:"h-4 w-4"})]}),A.allDocuments&&u.jsx("div",{className:"ml-2 mt-2 space-y-2 text-sm",children:Object.entries(te).map(([z,Y])=>u.jsxs("div",{children:[u.jsxs("button",{onClick:()=>oe(z),className:"flex items-center justify-between w-full py-1 text-left font-medium text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-md px-1",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(fB,{className:"h-4 w-4 text-amber-500 dark:text-amber-400"}),u.jsxs("span",{children:[z," (",Y.length,")"]})]}),P[z]?u.jsx(Iv,{className:"h-4 w-4"}):u.jsx(ms,{className:"h-4 w-4"})]}),P[z]&&u.jsx("ul",{className:"ml-6 mt-1 space-y-1",children:Y.map(O=>u.jsxs("li",{className:"flex items-center gap-2 text-gray-600 dark:text-gray-400",children:[u.jsx("span",{className:"flex-shrink-0",children:ae(O.name)}),u.jsx("button",{onClick:()=>we(O),className:"text-blue-600 dark:text-blue-400 hover:underline hover:text-blue-800 dark:hover:text-blue-300 focus:outline-none text-left truncate min-w-0",title:O.name,children:O.name})]},O.documentId))})]},z))})]})]}):null;return u.jsx("div",{className:"flex flex-col h-full bg-background",children:u.jsx("div",{className:"flex-grow overflow-hidden",children:N?u.jsx(GI,{documentId:N.documentId,documentName:N.name,onBack:()=>R(null)}):W?u.jsxs(_i,{className:"w-full h-full",children:[u.jsx(Ji,{className:"pb-4",children:u.jsxs("div",{className:"flex flex-row items-start gap-3",children:[i&&u.jsx(ze,{variant:"ghost",size:"sm",onClick:i,className:"h-8 w-8 p-0 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors shrink-0 mt-0.5","aria-label":"Go back",title:"Go back",children:u.jsx(Cm,{className:"h-4 w-4"})}),u.jsx(Xi,{className:"text-base font-semibold leading-relaxed break-words flex-1 min-w-0",children:"Project Documents"})]})}),u.jsx(Ei,{className:"flex items-center justify-center h-[80vh]",children:u.jsxs("div",{className:"text-center",children:[u.jsx(Zi,{className:"h-8 w-8 animate-spin mx-auto mb-4 text-blue-600 dark:text-blue-400"}),u.jsx("p",{className:"dark:text-gray-200",children:"Loading documents..."})]})})]}):M?u.jsxs("div",{className:"text-red-600 bg-red-50 p-3 rounded-md",children:["Error: ",M]}):u.jsxs(_i,{className:"mb-4",children:[u.jsx(Ji,{className:"pb-2",children:u.jsxs("div",{className:"flex flex-row items-start gap-3",children:[i&&u.jsx(ze,{variant:"ghost",size:"sm",onClick:i,className:"h-8 w-8 p-0 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors shrink-0 mt-0.5","aria-label":"Go back",title:"Go back",children:u.jsx(Cm,{className:"h-4 w-4"})}),u.jsx(Xi,{className:"text-base font-semibold leading-relaxed break-words flex-1 min-w-0",children:"Project Documents"})]})}),u.jsxs(Ei,{className:"px-4 pt-2 pb-4",children:[u.jsxs("div",{className:"relative mb-4",children:[u.jsx(eo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),u.jsx(on,{type:"text",placeholder:"Search All Documents...",value:T,onChange:z=>S(z.target.value),className:"w-full pl-9 pr-4 py-2 h-9 text-sm border rounded-md"})]}),u.jsx("div",{className:"overflow-y-auto max-h-[80vh] pb-32",children:B()})]})]})})})};function V9(r){const e=q9(r),t=w.forwardRef((n,s)=>{const{children:i,...c}=n,d=w.Children.toArray(i),p=d.find(Y9);if(p){const m=p.props.children,g=d.map(x=>x===p?w.Children.count(m)>1?w.Children.only(null):w.isValidElement(m)?m.props.children:null:x);return u.jsx(e,{...c,ref:s,children:w.isValidElement(m)?w.cloneElement(m,void 0,g):null})}return u.jsx(e,{...c,ref:s,children:i})});return t.displayName=`${r}.Slot`,t}function q9(r){const e=w.forwardRef((t,n)=>{const{children:s,...i}=t;if(w.isValidElement(s)){const c=X9(s),d=J9(i,s.props);return s.type!==w.Fragment&&(d.ref=n?Qc(n,c):c),w.cloneElement(s,d)}return w.Children.count(s)>1?w.Children.only(null):null});return e.displayName=`${r}.SlotClone`,e}var K9=Symbol("radix.slottable");function Y9(r){return w.isValidElement(r)&&typeof r.type=="function"&&"__radixId"in r.type&&r.type.__radixId===K9}function J9(r,e){const t={...e};for(const n in e){const s=r[n],i=e[n];/^on[A-Z]/.test(n)?s&&i?t[n]=(...d)=>{const p=i(...d);return s(...d),p}:s&&(t[n]=s):n==="style"?t[n]={...s,...i}:n==="className"&&(t[n]=[s,i].filter(Boolean).join(" "))}return{...r,...t}}function X9(r){var n,s;let e=(n=Object.getOwnPropertyDescriptor(r.props,"ref"))==null?void 0:n.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=(s=Object.getOwnPropertyDescriptor(r,"ref"))==null?void 0:s.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}var Cb=["Enter"," "],Q9=["ArrowDown","PageUp","Home"],WI=["ArrowUp","PageDown","End"],Z9=[...Q9,...WI],eV={ltr:[...Cb,"ArrowRight"],rtl:[...Cb,"ArrowLeft"]},tV={ltr:["ArrowLeft"],rtl:["ArrowRight"]},ag="Menu",[Wm,rV,nV]=TE(ag),[hd,VI]=Wa(ag,[nV,r0,c0]),d0=r0(),qI=c0(),[sV,pd]=hd(ag),[oV,lg]=hd(ag),KI=r=>{const{__scopeMenu:e,open:t=!1,children:n,dir:s,onOpenChange:i,modal:c=!0}=r,d=d0(e),[p,m]=w.useState(null),g=w.useRef(!1),x=Wl(i),b=l0(s);return w.useEffect(()=>{const E=()=>{g.current=!0,document.addEventListener("pointerdown",T,{capture:!0,once:!0}),document.addEventListener("pointermove",T,{capture:!0,once:!0})},T=()=>g.current=!1;return document.addEventListener("keydown",E,{capture:!0}),()=>{document.removeEventListener("keydown",E,{capture:!0}),document.removeEventListener("pointerdown",T,{capture:!0}),document.removeEventListener("pointermove",T,{capture:!0})}},[]),u.jsx(xA,{...d,children:u.jsx(sV,{scope:e,open:t,onOpenChange:x,content:p,onContentChange:m,children:u.jsx(oV,{scope:e,onClose:w.useCallback(()=>x(!1),[x]),isUsingKeyboardRef:g,dir:b,modal:c,children:n})})})};KI.displayName=ag;var iV="MenuAnchor",AE=w.forwardRef((r,e)=>{const{__scopeMenu:t,...n}=r,s=d0(t);return u.jsx(wA,{...s,...n,ref:e})});AE.displayName=iV;var IE="MenuPortal",[aV,YI]=hd(IE,{forceMount:void 0}),JI=r=>{const{__scopeMenu:e,forceMount:t,children:n,container:s}=r,i=pd(IE,e);return u.jsx(aV,{scope:e,forceMount:t,children:u.jsx(sa,{present:t||i.open,children:u.jsx(xE,{asChild:!0,container:s,children:n})})})};JI.displayName=IE;var Ni="MenuContent",[lV,PE]=hd(Ni),XI=w.forwardRef((r,e)=>{const t=YI(Ni,r.__scopeMenu),{forceMount:n=t.forceMount,...s}=r,i=pd(Ni,r.__scopeMenu),c=lg(Ni,r.__scopeMenu);return u.jsx(Wm.Provider,{scope:r.__scopeMenu,children:u.jsx(sa,{present:n||i.open,children:u.jsx(Wm.Slot,{scope:r.__scopeMenu,children:c.modal?u.jsx(cV,{...s,ref:e}):u.jsx(uV,{...s,ref:e})})})})}),cV=w.forwardRef((r,e)=>{const t=pd(Ni,r.__scopeMenu),n=w.useRef(null),s=On(e,n);return w.useEffect(()=>{const i=n.current;if(i)return VA(i)},[]),u.jsx(FE,{...r,ref:s,trapFocus:t.open,disableOutsidePointerEvents:t.open,disableOutsideScroll:!0,onFocusOutside:At(r.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>t.onOpenChange(!1)})}),uV=w.forwardRef((r,e)=>{const t=pd(Ni,r.__scopeMenu);return u.jsx(FE,{...r,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>t.onOpenChange(!1)})}),dV=V9("MenuContent.ScrollLock"),FE=w.forwardRef((r,e)=>{const{__scopeMenu:t,loop:n=!1,trapFocus:s,onOpenAutoFocus:i,onCloseAutoFocus:c,disableOutsidePointerEvents:d,onEntryFocus:p,onEscapeKeyDown:m,onPointerDownOutside:g,onFocusOutside:x,onInteractOutside:b,onDismiss:E,disableOutsideScroll:T,...S}=r,N=pd(Ni,t),R=lg(Ni,t),A=d0(t),j=qI(t),P=rV(t),[$,W]=w.useState(null),M=w.useRef(null),V=On(e,M,N.onContentChange),X=w.useRef(0),ie=w.useRef(""),J=w.useRef(0),ae=w.useRef(null),we=w.useRef("right"),ue=w.useRef(0),oe=T?EE:w.Fragment,pe=T?{as:dV,allowPinchZoom:!0}:void 0,te=z=>{var xe,ye;const Y=ie.current+z,O=P().filter(de=>!de.disabled),U=document.activeElement,ne=(xe=O.find(de=>de.ref.current===U))==null?void 0:xe.textValue,Ee=O.map(de=>de.textValue),q=EV(Ee,Y,ne),le=(ye=O.find(de=>de.textValue===q))==null?void 0:ye.ref.current;(function de(Te){ie.current=Te,window.clearTimeout(X.current),Te!==""&&(X.current=window.setTimeout(()=>de(""),1e3))})(Y),le&&setTimeout(()=>le.focus())};w.useEffect(()=>()=>window.clearTimeout(X.current),[]),MA();const B=w.useCallback(z=>{var O,U;return we.current===((O=ae.current)==null?void 0:O.side)&&CV(z,(U=ae.current)==null?void 0:U.area)},[]);return u.jsx(lV,{scope:t,searchRef:ie,onItemEnter:w.useCallback(z=>{B(z)&&z.preventDefault()},[B]),onItemLeave:w.useCallback(z=>{var Y;B(z)||((Y=M.current)==null||Y.focus(),W(null))},[B]),onTriggerLeave:w.useCallback(z=>{B(z)&&z.preventDefault()},[B]),pointerGraceTimerRef:J,onPointerGraceIntentChange:w.useCallback(z=>{ae.current=z},[]),children:u.jsx(oe,{...pe,children:u.jsx(_E,{asChild:!0,trapped:s,onMountAutoFocus:At(i,z=>{var Y;z.preventDefault(),(Y=M.current)==null||Y.focus({preventScroll:!0})}),onUnmountAutoFocus:c,children:u.jsx(n0,{asChild:!0,disableOutsidePointerEvents:d,onEscapeKeyDown:m,onPointerDownOutside:g,onFocusOutside:x,onInteractOutside:b,onDismiss:E,children:u.jsx(TI,{asChild:!0,...j,dir:R.dir,orientation:"vertical",loop:n,currentTabStopId:$,onCurrentTabStopIdChange:W,onEntryFocus:At(p,z=>{R.isUsingKeyboardRef.current||z.preventDefault()}),preventScrollOnEntryFocus:!0,children:u.jsx(bA,{role:"menu","aria-orientation":"vertical","data-state":hP(N.open),"data-radix-menu-content":"",dir:R.dir,...A,...S,ref:V,style:{outline:"none",...S.style},onKeyDown:At(S.onKeyDown,z=>{const O=z.target.closest("[data-radix-menu-content]")===z.currentTarget,U=z.ctrlKey||z.altKey||z.metaKey,ne=z.key.length===1;O&&(z.key==="Tab"&&z.preventDefault(),!U&&ne&&te(z.key));const Ee=M.current;if(z.target!==Ee||!Z9.includes(z.key))return;z.preventDefault();const le=P().filter(xe=>!xe.disabled).map(xe=>xe.ref.current);WI.includes(z.key)&&le.reverse(),bV(le)}),onBlur:At(r.onBlur,z=>{z.currentTarget.contains(z.target)||(window.clearTimeout(X.current),ie.current="")}),onPointerMove:At(r.onPointerMove,Vm(z=>{const Y=z.target,O=ue.current!==z.clientX;if(z.currentTarget.contains(Y)&&O){const U=z.clientX>ue.current?"right":"left";we.current=U,ue.current=z.clientX}}))})})})})})})});XI.displayName=Ni;var fV="MenuGroup",jE=w.forwardRef((r,e)=>{const{__scopeMenu:t,...n}=r;return u.jsx(jr.div,{role:"group",...n,ref:e})});jE.displayName=fV;var hV="MenuLabel",QI=w.forwardRef((r,e)=>{const{__scopeMenu:t,...n}=r;return u.jsx(jr.div,{...n,ref:e})});QI.displayName=hV;var jy="MenuItem",h1="menu.itemSelect",f0=w.forwardRef((r,e)=>{const{disabled:t=!1,onSelect:n,...s}=r,i=w.useRef(null),c=lg(jy,r.__scopeMenu),d=PE(jy,r.__scopeMenu),p=On(e,i),m=w.useRef(!1),g=()=>{const x=i.current;if(!t&&x){const b=new CustomEvent(h1,{bubbles:!0,cancelable:!0});x.addEventListener(h1,E=>n==null?void 0:n(E),{once:!0}),lA(x,b),b.defaultPrevented?m.current=!1:c.onClose()}};return u.jsx(ZI,{...s,ref:p,disabled:t,onClick:At(r.onClick,g),onPointerDown:x=>{var b;(b=r.onPointerDown)==null||b.call(r,x),m.current=!0},onPointerUp:At(r.onPointerUp,x=>{var b;m.current||(b=x.currentTarget)==null||b.click()}),onKeyDown:At(r.onKeyDown,x=>{const b=d.searchRef.current!=="";t||b&&x.key===" "||Cb.includes(x.key)&&(x.currentTarget.click(),x.preventDefault())})})});f0.displayName=jy;var ZI=w.forwardRef((r,e)=>{const{__scopeMenu:t,disabled:n=!1,textValue:s,...i}=r,c=PE(jy,t),d=qI(t),p=w.useRef(null),m=On(e,p),[g,x]=w.useState(!1),[b,E]=w.useState("");return w.useEffect(()=>{const T=p.current;T&&E((T.textContent??"").trim())},[i.children]),u.jsx(Wm.ItemSlot,{scope:t,disabled:n,textValue:s??b,children:u.jsx(RI,{asChild:!0,...d,focusable:!n,children:u.jsx(jr.div,{role:"menuitem","data-highlighted":g?"":void 0,"aria-disabled":n||void 0,"data-disabled":n?"":void 0,...i,ref:m,onPointerMove:At(r.onPointerMove,Vm(T=>{n?c.onItemLeave(T):(c.onItemEnter(T),T.defaultPrevented||T.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:At(r.onPointerLeave,Vm(T=>c.onItemLeave(T))),onFocus:At(r.onFocus,()=>x(!0)),onBlur:At(r.onBlur,()=>x(!1))})})})}),pV="MenuCheckboxItem",eP=w.forwardRef((r,e)=>{const{checked:t=!1,onCheckedChange:n,...s}=r;return u.jsx(oP,{scope:r.__scopeMenu,checked:t,children:u.jsx(f0,{role:"menuitemcheckbox","aria-checked":Oy(t)?"mixed":t,...s,ref:e,"data-state":DE(t),onSelect:At(s.onSelect,()=>n==null?void 0:n(Oy(t)?!0:!t),{checkForDefaultPrevented:!1})})})});eP.displayName=pV;var tP="MenuRadioGroup",[mV,gV]=hd(tP,{value:void 0,onValueChange:()=>{}}),rP=w.forwardRef((r,e)=>{const{value:t,onValueChange:n,...s}=r,i=Wl(n);return u.jsx(mV,{scope:r.__scopeMenu,value:t,onValueChange:i,children:u.jsx(jE,{...s,ref:e})})});rP.displayName=tP;var nP="MenuRadioItem",sP=w.forwardRef((r,e)=>{const{value:t,...n}=r,s=gV(nP,r.__scopeMenu),i=t===s.value;return u.jsx(oP,{scope:r.__scopeMenu,checked:i,children:u.jsx(f0,{role:"menuitemradio","aria-checked":i,...n,ref:e,"data-state":DE(i),onSelect:At(n.onSelect,()=>{var c;return(c=s.onValueChange)==null?void 0:c.call(s,t)},{checkForDefaultPrevented:!1})})})});sP.displayName=nP;var OE="MenuItemIndicator",[oP,vV]=hd(OE,{checked:!1}),iP=w.forwardRef((r,e)=>{const{__scopeMenu:t,forceMount:n,...s}=r,i=vV(OE,t);return u.jsx(sa,{present:n||Oy(i.checked)||i.checked===!0,children:u.jsx(jr.span,{...s,ref:e,"data-state":DE(i.checked)})})});iP.displayName=OE;var yV="MenuSeparator",aP=w.forwardRef((r,e)=>{const{__scopeMenu:t,...n}=r;return u.jsx(jr.div,{role:"separator","aria-orientation":"horizontal",...n,ref:e})});aP.displayName=yV;var xV="MenuArrow",lP=w.forwardRef((r,e)=>{const{__scopeMenu:t,...n}=r,s=d0(t);return u.jsx(_A,{...s,...n,ref:e})});lP.displayName=xV;var wV="MenuSub",[jK,cP]=hd(wV),ym="MenuSubTrigger",uP=w.forwardRef((r,e)=>{const t=pd(ym,r.__scopeMenu),n=lg(ym,r.__scopeMenu),s=cP(ym,r.__scopeMenu),i=PE(ym,r.__scopeMenu),c=w.useRef(null),{pointerGraceTimerRef:d,onPointerGraceIntentChange:p}=i,m={__scopeMenu:r.__scopeMenu},g=w.useCallback(()=>{c.current&&window.clearTimeout(c.current),c.current=null},[]);return w.useEffect(()=>g,[g]),w.useEffect(()=>{const x=d.current;return()=>{window.clearTimeout(x),p(null)}},[d,p]),u.jsx(AE,{asChild:!0,...m,children:u.jsx(ZI,{id:s.triggerId,"aria-haspopup":"menu","aria-expanded":t.open,"aria-controls":s.contentId,"data-state":hP(t.open),...r,ref:Qc(e,s.onTriggerChange),onClick:x=>{var b;(b=r.onClick)==null||b.call(r,x),!(r.disabled||x.defaultPrevented)&&(x.currentTarget.focus(),t.open||t.onOpenChange(!0))},onPointerMove:At(r.onPointerMove,Vm(x=>{i.onItemEnter(x),!x.defaultPrevented&&!r.disabled&&!t.open&&!c.current&&(i.onPointerGraceIntentChange(null),c.current=window.setTimeout(()=>{t.onOpenChange(!0),g()},100))})),onPointerLeave:At(r.onPointerLeave,Vm(x=>{var E,T;g();const b=(E=t.content)==null?void 0:E.getBoundingClientRect();if(b){const S=(T=t.content)==null?void 0:T.dataset.side,N=S==="right",R=N?-5:5,A=b[N?"left":"right"],j=b[N?"right":"left"];i.onPointerGraceIntentChange({area:[{x:x.clientX+R,y:x.clientY},{x:A,y:b.top},{x:j,y:b.top},{x:j,y:b.bottom},{x:A,y:b.bottom}],side:S}),window.clearTimeout(d.current),d.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(x),x.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:At(r.onKeyDown,x=>{var E;const b=i.searchRef.current!=="";r.disabled||b&&x.key===" "||eV[n.dir].includes(x.key)&&(t.onOpenChange(!0),(E=t.content)==null||E.focus(),x.preventDefault())})})})});uP.displayName=ym;var dP="MenuSubContent",fP=w.forwardRef((r,e)=>{const t=YI(Ni,r.__scopeMenu),{forceMount:n=t.forceMount,...s}=r,i=pd(Ni,r.__scopeMenu),c=lg(Ni,r.__scopeMenu),d=cP(dP,r.__scopeMenu),p=w.useRef(null),m=On(e,p);return u.jsx(Wm.Provider,{scope:r.__scopeMenu,children:u.jsx(sa,{present:n||i.open,children:u.jsx(Wm.Slot,{scope:r.__scopeMenu,children:u.jsx(FE,{id:d.contentId,"aria-labelledby":d.triggerId,...s,ref:m,align:"start",side:c.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:g=>{var x;c.isUsingKeyboardRef.current&&((x=p.current)==null||x.focus()),g.preventDefault()},onCloseAutoFocus:g=>g.preventDefault(),onFocusOutside:At(r.onFocusOutside,g=>{g.target!==d.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:At(r.onEscapeKeyDown,g=>{c.onClose(),g.preventDefault()}),onKeyDown:At(r.onKeyDown,g=>{var E;const x=g.currentTarget.contains(g.target),b=tV[c.dir].includes(g.key);x&&b&&(i.onOpenChange(!1),(E=d.trigger)==null||E.focus(),g.preventDefault())})})})})})});fP.displayName=dP;function hP(r){return r?"open":"closed"}function Oy(r){return r==="indeterminate"}function DE(r){return Oy(r)?"indeterminate":r?"checked":"unchecked"}function bV(r){const e=document.activeElement;for(const t of r)if(t===e||(t.focus(),document.activeElement!==e))return}function _V(r,e){return r.map((t,n)=>r[(e+n)%r.length])}function EV(r,e,t){const s=e.length>1&&Array.from(e).every(m=>m===e[0])?e[0]:e,i=t?r.indexOf(t):-1;let c=_V(r,Math.max(i,0));s.length===1&&(c=c.filter(m=>m!==t));const p=c.find(m=>m.toLowerCase().startsWith(s.toLowerCase()));return p!==t?p:void 0}function SV(r,e){const{x:t,y:n}=r;let s=!1;for(let i=0,c=e.length-1;i<e.length;c=i++){const d=e[i],p=e[c],m=d.x,g=d.y,x=p.x,b=p.y;g>n!=b>n&&t<(x-m)*(n-g)/(b-g)+m&&(s=!s)}return s}function CV(r,e){if(!e)return!1;const t={x:r.clientX,y:r.clientY};return SV(t,e)}function Vm(r){return e=>e.pointerType==="mouse"?r(e):void 0}var kV=KI,NV=AE,TV=JI,RV=XI,AV=jE,IV=QI,PV=f0,FV=eP,jV=rP,OV=sP,DV=iP,LV=aP,MV=lP,$V=uP,UV=fP,h0="DropdownMenu",[zV]=Wa(h0,[VI]),no=VI(),[HV,pP]=zV(h0),mP=r=>{const{__scopeDropdownMenu:e,children:t,dir:n,open:s,defaultOpen:i,onOpenChange:c,modal:d=!0}=r,p=no(e),m=w.useRef(null),[g,x]=Zc({prop:s,defaultProp:i??!1,onChange:c,caller:h0});return u.jsx(HV,{scope:e,triggerId:Ul(),triggerRef:m,contentId:Ul(),open:g,onOpenChange:x,onOpenToggle:w.useCallback(()=>x(b=>!b),[x]),modal:d,children:u.jsx(kV,{...p,open:g,onOpenChange:x,dir:n,modal:d,children:t})})};mP.displayName=h0;var gP="DropdownMenuTrigger",vP=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,disabled:n=!1,...s}=r,i=pP(gP,t),c=no(t);return u.jsx(NV,{asChild:!0,...c,children:u.jsx(jr.button,{type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":n?"":void 0,disabled:n,...s,ref:Qc(e,i.triggerRef),onPointerDown:At(r.onPointerDown,d=>{!n&&d.button===0&&d.ctrlKey===!1&&(i.onOpenToggle(),i.open||d.preventDefault())}),onKeyDown:At(r.onKeyDown,d=>{n||(["Enter"," "].includes(d.key)&&i.onOpenToggle(),d.key==="ArrowDown"&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(d.key)&&d.preventDefault())})})})});vP.displayName=gP;var BV="DropdownMenuPortal",yP=r=>{const{__scopeDropdownMenu:e,...t}=r,n=no(e);return u.jsx(TV,{...n,...t})};yP.displayName=BV;var xP="DropdownMenuContent",wP=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=pP(xP,t),i=no(t),c=w.useRef(!1);return u.jsx(RV,{id:s.contentId,"aria-labelledby":s.triggerId,...i,...n,ref:e,onCloseAutoFocus:At(r.onCloseAutoFocus,d=>{var p;c.current||(p=s.triggerRef.current)==null||p.focus(),c.current=!1,d.preventDefault()}),onInteractOutside:At(r.onInteractOutside,d=>{const p=d.detail.originalEvent,m=p.button===0&&p.ctrlKey===!0,g=p.button===2||m;(!s.modal||g)&&(c.current=!0)}),style:{...r.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});wP.displayName=xP;var GV="DropdownMenuGroup",WV=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=no(t);return u.jsx(AV,{...s,...n,ref:e})});WV.displayName=GV;var VV="DropdownMenuLabel",bP=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=no(t);return u.jsx(IV,{...s,...n,ref:e})});bP.displayName=VV;var qV="DropdownMenuItem",_P=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=no(t);return u.jsx(PV,{...s,...n,ref:e})});_P.displayName=qV;var KV="DropdownMenuCheckboxItem",EP=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=no(t);return u.jsx(FV,{...s,...n,ref:e})});EP.displayName=KV;var YV="DropdownMenuRadioGroup",JV=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=no(t);return u.jsx(jV,{...s,...n,ref:e})});JV.displayName=YV;var XV="DropdownMenuRadioItem",SP=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=no(t);return u.jsx(OV,{...s,...n,ref:e})});SP.displayName=XV;var QV="DropdownMenuItemIndicator",CP=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=no(t);return u.jsx(DV,{...s,...n,ref:e})});CP.displayName=QV;var ZV="DropdownMenuSeparator",kP=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=no(t);return u.jsx(LV,{...s,...n,ref:e})});kP.displayName=ZV;var eq="DropdownMenuArrow",tq=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=no(t);return u.jsx(MV,{...s,...n,ref:e})});tq.displayName=eq;var rq="DropdownMenuSubTrigger",NP=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=no(t);return u.jsx($V,{...s,...n,ref:e})});NP.displayName=rq;var nq="DropdownMenuSubContent",TP=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=no(t);return u.jsx(UV,{...s,...n,ref:e,style:{...r.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});TP.displayName=nq;var sq=mP,oq=vP,iq=yP,RP=wP,AP=bP,IP=_P,PP=EP,FP=SP,jP=CP,OP=kP,DP=NP,LP=TP;const Ms=sq,$s=oq,aq=w.forwardRef(({className:r,inset:e,children:t,...n},s)=>u.jsxs(DP,{ref:s,className:Rr("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",e&&"pl-8",r),...n,children:[t,u.jsx(Qv,{className:"ml-auto h-4 w-4"})]}));aq.displayName=DP.displayName;const lq=w.forwardRef(({className:r,...e},t)=>u.jsx(LP,{ref:t,className:Rr("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in data-[side=bottom]:slide-in-from-top-1 data-[side=left]:slide-in-from-right-1 data-[side=right]:slide-in-from-left-1 data-[side=top]:slide-in-from-bottom-1",r),...e}));lq.displayName=LP.displayName;const vs=w.forwardRef(({className:r,sideOffset:e=4,...t},n)=>u.jsx(iq,{children:u.jsx(RP,{ref:n,sideOffset:e,className:Rr("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-white dark:bg-card p-1 text-neutral-950 dark:text-card-foreground shadow-md animate-in data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r),...t})}));vs.displayName=RP.displayName;const rs=w.forwardRef(({className:r,inset:e,...t},n)=>u.jsx(IP,{ref:n,className:Rr("relative flex cursor-pointer select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors hover:bg-neutral-100 dark:hover:bg-muted focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 dark:text-gray-200",e&&"pl-8",r),...t}));rs.displayName=IP.displayName;const cq=w.forwardRef(({className:r,children:e,checked:t,...n},s)=>u.jsxs(PP,{ref:s,className:Rr("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r),checked:t,...n,children:[u.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:u.jsx(jP,{children:u.jsx(oB,{className:"h-4 w-4"})})}),e]}));cq.displayName=PP.displayName;const uq=w.forwardRef(({className:r,children:e,...t},n)=>u.jsxs(FP,{ref:n,className:Rr("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r),...t,children:[u.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:u.jsx(jP,{children:u.jsx("div",{className:"h-2 w-2 rounded-full bg-current"})})}),e]}));uq.displayName=FP.displayName;const dq=w.forwardRef(({className:r,inset:e,...t},n)=>u.jsx(AP,{ref:n,className:Rr("px-2 py-1.5 text-sm font-semibold",e&&"pl-8",r),...t}));dq.displayName=AP.displayName;const Dy=w.forwardRef(({className:r,...e},t)=>u.jsx(OP,{ref:t,className:Rr("-mx-1 my-1 h-px bg-neutral-100",r),...e}));Dy.displayName=OP.displayName;const Ls=({rows:r=2})=>u.jsx("div",{className:"p-1",children:u.jsx("table",{className:"w-full text-sm text-left text-gray-600 dark:text-gray-300",children:u.jsx("tbody",{children:Array.from({length:r}).map((e,t)=>u.jsxs("tr",{className:"bg-card animate-pulse",children:[u.jsx("td",{className:"py-2 px-3 whitespace-normal font-medium w-1/3",children:u.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-3/4"})}),u.jsx("td",{className:"py-2 px-3",children:u.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-full"})})]},t))})})}),fq=({value:r,onChange:e,onSelect:t,suggestions:n,isLoading:s=!1,isValidating:i=!1,isValid:c=null,placeholder:d="Enter contact email",className:p="",disabled:m=!1})=>{const[g,x]=w.useState(0),b=w.useRef(null),E=w.useMemo(()=>{if(!r||r.length<2)return[];const P=r.toLowerCase();return n.filter($=>{var W;return $.email.toLowerCase().includes(P)||((W=$.name)==null?void 0:W.toLowerCase().includes(P))}).slice(0,6)},[r,n]),T=E.length>0&&r.length>=2;w.useEffect(()=>{x(0)},[E]);const S=P=>P.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),N=(P,$)=>{if(!$)return P;const W=S($),M=P.split(new RegExp(`(${W})`,"gi"));return u.jsx("span",{children:M.map((V,X)=>V.toLowerCase()===$.toLowerCase()?u.jsx("span",{className:"font-semibold text-blue-600 dark:text-blue-400",children:V},X):u.jsx("span",{children:V},X))})},R=P=>{if(!T){P.key==="Enter"&&(P.preventDefault(),t(r));return}switch(P.key){case"ArrowDown":P.preventDefault(),x($=>$<E.length-1?$+1:$);break;case"ArrowUp":P.preventDefault(),x($=>$>0?$-1:$);break;case"Enter":P.preventDefault(),E[g]?A(E[g].email):t(r);break}},A=P=>{e(P),t(P)},j=()=>i?u.jsx(Zi,{className:"w-4 h-4 animate-spin text-gray-400"}):c===!0?u.jsx(Wc,{className:"w-4 h-4 text-green-600"}):c===!1?u.jsx(Bm,{className:"w-4 h-4 text-red-600"}):null;return u.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[u.jsxs("div",{className:"relative w-full",children:[u.jsx(on,{ref:b,type:"email",value:r,onChange:P=>e(P.target.value),onKeyDown:R,placeholder:d,className:`pr-8 ${p} ${c===!1?"border-red-300 focus:ring-red-500":""}`,disabled:m}),u.jsx("div",{className:"absolute right-2 top-1/2 -translate-y-1/2 pointer-events-none",children:u.jsx(j,{})})]}),(T||s&&r.length>=2)&&u.jsx("div",{className:"w-full border border-gray-200 dark:border-gray-700 rounded-md max-h-[200px] overflow-y-auto bg-white dark:bg-gray-800",children:s?u.jsxs("div",{className:"flex items-center justify-center py-4",children:[u.jsx(Zi,{className:"h-4 w-4 animate-spin text-gray-400"}),u.jsx("span",{className:"ml-2 text-xs text-gray-500",children:"Loading contacts..."})]}):u.jsx("div",{className:"py-1",children:E.map((P,$)=>u.jsx("div",{onClick:W=>{W.preventDefault(),W.stopPropagation(),A(P.email)},onMouseEnter:()=>x($),className:`px-3 py-2 cursor-pointer transition-colors ${$===g?"bg-blue-50 dark:bg-blue-900/20":"hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:u.jsxs("div",{className:"flex flex-col w-full",children:[P.name&&u.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate",children:N(P.name,r)}),u.jsx("span",{className:`text-xs text-gray-600 dark:text-gray-400 truncate ${P.name?"":"text-sm font-medium text-gray-900 dark:text-gray-100"}`,children:N(P.email,r)})]})},P.email))})})]})},Qu="src/shared/hooks/useFilevineContacts.ts";let ja=null,zv=null;const hq=1800*1e3,Zu=1e4;let jc=null;function pq(r="filevine"){const[e,t]=w.useState(ja||[]),[n,s]=w.useState(!1),[i,c]=w.useState(null),d=Ur(),p=w.useCallback(async()=>{if(ja&&zv&&Date.now()-zv<hq)return ja.length>Zu&&(d.warn("Cached contacts exceed size limit, truncating",{sourceFile:Qu,actual:ja.length,limit:Zu}),ja=ja.slice(0,Zu)),d.debug("Using cached contacts",{sourceFile:Qu}),t(ja),ja;if(jc){d.debug("Waiting for existing fetch request",{sourceFile:Qu});try{const g=await jc;return t(g),g}catch(g){throw c(g instanceof Error?g:new Error("Failed to fetch contacts")),g}}return s(!0),c(null),jc=(async()=>{try{d.debug("Fetching all contacts from server",{sourceFile:Qu});const g=await i8(d,r),x=[];g.clients&&Object.entries(g.clients).forEach(([E,T])=>{var R;const S=Array.isArray(T)?T:[],N=S==null?void 0:S[0];if(N){const A=N.fullName||void 0,j=((R=N.personTypes)==null?void 0:R[0])||void 0;x.push({email:E,name:A,role:j})}else x.push({email:E,name:void 0,role:void 0})}),x.sort((E,T)=>{var R,A;const S=((R=E.name)==null?void 0:R.toLowerCase())||E.email.toLowerCase(),N=((A=T.name)==null?void 0:A.toLowerCase())||T.email.toLowerCase();return S.localeCompare(N)}),d.debug(`Fetched ${x.length} contacts`,{sourceFile:Qu,count:x.length});const b=x.length>Zu?x.slice(0,Zu):x;return x.length>Zu&&d.warn("Contact cache size exceeds limit, truncating",{sourceFile:Qu,actual:x.length,limit:Zu}),ja=b,zv=Date.now(),t(b),s(!1),b}catch(g){const x=g instanceof Error?g:new Error("Failed to fetch contacts");throw d.error("Error fetching contacts",x,{sourceFile:Qu}),c(x),s(!1),x}finally{jc=null}})(),jc},[r,d]);return{contacts:e,isLoading:n,error:i,loadContacts:p,refreshContacts:async()=>{if(jc)try{await jc}catch{}return ja=null,zv=null,jc=null,p()}}}const mq="src/sidepanel/panels/components/FilevineClientInfoBox.tsx",gq=({clientEmail:r,emailParticipants:e,emailParticipantClients:t,tempClientEmail:n,setTempClientEmail:s,setIsManuallySet:i,isManuallySet:c,selectedClientDetails:d,isLoading:p,ClientNavigation:m,setClientEmail:g,isValidClient:x,isTempEmailValid:b,isValidating:E,isProjectManuallySelected:T=!1})=>{const S=Ur(),{isConnected:N,initiateReconnection:R}=ra(),{platform:A}=cn(),[j,P]=dr.useState(!1),{contacts:$,isLoading:W,loadContacts:M}=pq("filevine");dr.useEffect(()=>{j&&$.length===0&&!W&&M()},[j,$.length,W,M]);const V=()=>u.jsx(Ls,{rows:2}),X=()=>u.jsxs("div",{className:"p-4 text-center",children:[u.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-3",children:u.jsx(Kc,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"})}),u.jsx("p",{className:"text-sm font-medium text-gray-800 mb-2",children:"Gmail disconnected"}),u.jsx("p",{className:"text-xs text-gray-600 mb-4",children:"Connect Gmail to view email insights"}),u.jsxs(ze,{onClick:async()=>{try{await R()}catch(ie){S.error("Failed to reconnect Gmail:",ie,{sourceFile:mq})}},size:"sm",className:"bg-blue-600 hover:bg-blue-700 text-white text-xs px-4 py-2",children:[u.jsx(No,{className:"h-3 w-3 mr-1"}),"Reconnect Gmail"]})]});return u.jsxs("div",{className:"w-full min-h-[4rem] border border-border/50 rounded-lg shadow-sm bg-card text-card-foreground",title:"Client Information",children:[u.jsxs("div",{className:"flex items-center justify-between p-2 border-b bg-muted",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(ky,{className:"w-3.5 h-3.5 text-slate-600 dark:text-gray-300"}),u.jsx("span",{className:"font-medium text-sm text-slate-800 dark:text-white",children:"CONTACT"})]}),u.jsxs(Ms,{open:j,onOpenChange:P,children:[u.jsx($s,{asChild:!0,children:u.jsx(ze,{variant:"ghost",size:"icon",className:"h-6 w-6",children:u.jsx(eo,{className:"h-4 w-4"})})}),u.jsx(vs,{align:"end",className:"p-3 w-80",children:u.jsx(fq,{value:n||"",onChange:ie=>s(ie),onSelect:ie=>{g(ie,!0),P(!1)},suggestions:$,isLoading:W,isValidating:E,isValid:b,placeholder:"Search contact by email or name",className:"h-9 text-sm"})})]})]}),p?V():T?u.jsxs("div",{className:"p-4 text-center",children:[u.jsx(eo,{className:"w-8 h-8 mx-auto mb-2 text-gray-400"}),u.jsx("div",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Project Manually Selected"}),u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Search for a contact to view full client information"})]}):u.jsxs(u.Fragment,{children:[t.length>0&&!c&&u.jsx(m,{}),c&&r&&u.jsx("div",{className:"px-3 py-2 bg-gray-50 dark:bg-gray-800 border-b dark:border-gray-700",children:u.jsxs("div",{className:"flex flex-col",children:[(()=>{const ie=$.find(J=>J.email===r);return ie!=null&&ie.name?u.jsxs(u.Fragment,{children:[u.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate",children:ie.name}),u.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-400 truncate",children:r})]}):u.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate",children:r})})(),u.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5",children:"(Manually set)"})]})}),E&&e.length>0&&t.length===0&&!c?u.jsx(Ls,{rows:2}):d&&Object.keys(d).length>0?u.jsx(eu,{details:d}):A==="chrome"&&!N?X():u.jsx("div",{className:"p-3 text-sm text-gray-600 dark:text-gray-400",children:u.jsx("p",{className:"mb-2",children:c&&r?`No contact information found for ${r}`:e.length>0&&t.length===0?`No contact information available for emails on the selected thread:
                        ${e.join(", ")}`:e.length>0?"No contact information available for the selected email ID":"Select a contact email thread to view contact information"})})]})]})};var p0="Collapsible",[vq,MP]=Wa(p0),[yq,LE]=vq(p0),$P=w.forwardRef((r,e)=>{const{__scopeCollapsible:t,open:n,defaultOpen:s,disabled:i,onOpenChange:c,...d}=r,[p,m]=Zc({prop:n,defaultProp:s??!1,onChange:c,caller:p0});return u.jsx(yq,{scope:t,disabled:i,contentId:Ul(),open:p,onOpenToggle:w.useCallback(()=>m(g=>!g),[m]),children:u.jsx(jr.div,{"data-state":$E(p),"data-disabled":i?"":void 0,...d,ref:e})})});$P.displayName=p0;var UP="CollapsibleTrigger",zP=w.forwardRef((r,e)=>{const{__scopeCollapsible:t,...n}=r,s=LE(UP,t);return u.jsx(jr.button,{type:"button","aria-controls":s.contentId,"aria-expanded":s.open||!1,"data-state":$E(s.open),"data-disabled":s.disabled?"":void 0,disabled:s.disabled,...n,ref:e,onClick:At(r.onClick,s.onOpenToggle)})});zP.displayName=UP;var ME="CollapsibleContent",HP=w.forwardRef((r,e)=>{const{forceMount:t,...n}=r,s=LE(ME,r.__scopeCollapsible);return u.jsx(sa,{present:t||s.open,children:({present:i})=>u.jsx(xq,{...n,ref:e,present:i})})});HP.displayName=ME;var xq=w.forwardRef((r,e)=>{const{__scopeCollapsible:t,present:n,children:s,...i}=r,c=LE(ME,t),[d,p]=w.useState(n),m=w.useRef(null),g=On(e,m),x=w.useRef(0),b=x.current,E=w.useRef(0),T=E.current,S=c.open||d,N=w.useRef(S),R=w.useRef(void 0);return w.useEffect(()=>{const A=requestAnimationFrame(()=>N.current=!1);return()=>cancelAnimationFrame(A)},[]),Hl(()=>{const A=m.current;if(A){R.current=R.current||{transitionDuration:A.style.transitionDuration,animationName:A.style.animationName},A.style.transitionDuration="0s",A.style.animationName="none";const j=A.getBoundingClientRect();x.current=j.height,E.current=j.width,N.current||(A.style.transitionDuration=R.current.transitionDuration,A.style.animationName=R.current.animationName),p(n)}},[c.open,n]),u.jsx(jr.div,{"data-state":$E(c.open),"data-disabled":c.disabled?"":void 0,id:c.contentId,hidden:!S,...i,ref:g,style:{"--radix-collapsible-content-height":b?`${b}px`:void 0,"--radix-collapsible-content-width":T?`${T}px`:void 0,...r.style},children:S&&s})});function $E(r){return r?"open":"closed"}var wq=$P,bq=zP,_q=HP,ia="Accordion",Eq=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[UE,Sq,Cq]=TE(ia),[m0]=Wa(ia,[Cq,MP]),zE=MP(),BP=dr.forwardRef((r,e)=>{const{type:t,...n}=r,s=n,i=n;return u.jsx(UE.Provider,{scope:r.__scopeAccordion,children:t==="multiple"?u.jsx(Rq,{...i,ref:e}):u.jsx(Tq,{...s,ref:e})})});BP.displayName=ia;var[GP,kq]=m0(ia),[WP,Nq]=m0(ia,{collapsible:!1}),Tq=dr.forwardRef((r,e)=>{const{value:t,defaultValue:n,onValueChange:s=()=>{},collapsible:i=!1,...c}=r,[d,p]=Zc({prop:t,defaultProp:n??"",onChange:s,caller:ia});return u.jsx(GP,{scope:r.__scopeAccordion,value:dr.useMemo(()=>d?[d]:[],[d]),onItemOpen:p,onItemClose:dr.useCallback(()=>i&&p(""),[i,p]),children:u.jsx(WP,{scope:r.__scopeAccordion,collapsible:i,children:u.jsx(VP,{...c,ref:e})})})}),Rq=dr.forwardRef((r,e)=>{const{value:t,defaultValue:n,onValueChange:s=()=>{},...i}=r,[c,d]=Zc({prop:t,defaultProp:n??[],onChange:s,caller:ia}),p=dr.useCallback(g=>d((x=[])=>[...x,g]),[d]),m=dr.useCallback(g=>d((x=[])=>x.filter(b=>b!==g)),[d]);return u.jsx(GP,{scope:r.__scopeAccordion,value:c,onItemOpen:p,onItemClose:m,children:u.jsx(WP,{scope:r.__scopeAccordion,collapsible:!0,children:u.jsx(VP,{...i,ref:e})})})}),[Aq,g0]=m0(ia),VP=dr.forwardRef((r,e)=>{const{__scopeAccordion:t,disabled:n,dir:s,orientation:i="vertical",...c}=r,d=dr.useRef(null),p=On(d,e),m=Sq(t),x=l0(s)==="ltr",b=At(r.onKeyDown,E=>{var V;if(!Eq.includes(E.key))return;const T=E.target,S=m().filter(X=>{var ie;return!((ie=X.ref.current)!=null&&ie.disabled)}),N=S.findIndex(X=>X.ref.current===T),R=S.length;if(N===-1)return;E.preventDefault();let A=N;const j=0,P=R-1,$=()=>{A=N+1,A>P&&(A=j)},W=()=>{A=N-1,A<j&&(A=P)};switch(E.key){case"Home":A=j;break;case"End":A=P;break;case"ArrowRight":i==="horizontal"&&(x?$():W());break;case"ArrowDown":i==="vertical"&&$();break;case"ArrowLeft":i==="horizontal"&&(x?W():$());break;case"ArrowUp":i==="vertical"&&W();break}const M=A%R;(V=S[M].ref.current)==null||V.focus()});return u.jsx(Aq,{scope:t,disabled:n,direction:s,orientation:i,children:u.jsx(UE.Slot,{scope:t,children:u.jsx(jr.div,{...c,"data-orientation":i,ref:p,onKeyDown:n?void 0:b})})})}),Ly="AccordionItem",[Iq,HE]=m0(Ly),qP=dr.forwardRef((r,e)=>{const{__scopeAccordion:t,value:n,...s}=r,i=g0(Ly,t),c=kq(Ly,t),d=zE(t),p=Ul(),m=n&&c.value.includes(n)||!1,g=i.disabled||r.disabled;return u.jsx(Iq,{scope:t,open:m,disabled:g,triggerId:p,children:u.jsx(wq,{"data-orientation":i.orientation,"data-state":ZP(m),...d,...s,ref:e,disabled:g,open:m,onOpenChange:x=>{x?c.onItemOpen(n):c.onItemClose(n)}})})});qP.displayName=Ly;var KP="AccordionHeader",YP=dr.forwardRef((r,e)=>{const{__scopeAccordion:t,...n}=r,s=g0(ia,t),i=HE(KP,t);return u.jsx(jr.h3,{"data-orientation":s.orientation,"data-state":ZP(i.open),"data-disabled":i.disabled?"":void 0,...n,ref:e})});YP.displayName=KP;var kb="AccordionTrigger",JP=dr.forwardRef((r,e)=>{const{__scopeAccordion:t,...n}=r,s=g0(ia,t),i=HE(kb,t),c=Nq(kb,t),d=zE(t);return u.jsx(UE.ItemSlot,{scope:t,children:u.jsx(bq,{"aria-disabled":i.open&&!c.collapsible||void 0,"data-orientation":s.orientation,id:i.triggerId,...d,...n,ref:e})})});JP.displayName=kb;var XP="AccordionContent",QP=dr.forwardRef((r,e)=>{const{__scopeAccordion:t,...n}=r,s=g0(ia,t),i=HE(XP,t),c=zE(t);return u.jsx(_q,{role:"region","aria-labelledby":i.triggerId,"data-orientation":s.orientation,...c,...n,ref:e,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...r.style}})});QP.displayName=XP;function ZP(r){return r?"open":"closed"}var Pq=BP,Fq=qP,jq=YP,eF=JP,tF=QP;const Oq=Pq,rF=w.forwardRef(({className:r,...e},t)=>u.jsx(Fq,{ref:t,className:Rr("border-b border-neutral-200 dark:border-border",r),...e}));rF.displayName="AccordionItem";const nF=w.forwardRef(({className:r,children:e,...t},n)=>u.jsx(jq,{className:"flex",children:u.jsxs(eF,{ref:n,className:Rr("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",r),...t,children:[e,u.jsx(ms,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})}));nF.displayName=eF.displayName;const sF=w.forwardRef(({className:r,children:e,...t},n)=>u.jsx(tF,{ref:n,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...t,children:u.jsx("div",{className:Rr("pb-4 pt-0",r),children:e})}));sF.displayName=tF.displayName;var xm={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */var Dq=xm.exports,p1;function Lq(){return p1||(p1=1,(function(r,e){(function(){var t,n="4.17.23",s=200,i="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",c="Expected a function",d="Invalid `variable` option passed into `_.template`",p="__lodash_hash_undefined__",m=500,g="__lodash_placeholder__",x=1,b=2,E=4,T=1,S=2,N=1,R=2,A=4,j=8,P=16,$=32,W=64,M=128,V=256,X=512,ie=30,J="...",ae=800,we=16,ue=1,oe=2,pe=3,te=1/0,B=9007199254740991,z=17976931348623157e292,Y=NaN,O=4294967295,U=O-1,ne=O>>>1,Ee=[["ary",M],["bind",N],["bindKey",R],["curry",j],["curryRight",P],["flip",X],["partial",$],["partialRight",W],["rearg",V]],q="[object Arguments]",le="[object Array]",xe="[object AsyncFunction]",ye="[object Boolean]",de="[object Date]",Te="[object DOMException]",Be="[object Error]",Ge="[object Function]",Me="[object GeneratorFunction]",Ae="[object Map]",ct="[object Number]",Bt="[object Null]",yt="[object Object]",sr="[object Promise]",Gt="[object Proxy]",Zt="[object RegExp]",Kt="[object Set]",Kr="[object String]",_t="[object Symbol]",Se="[object Undefined]",$e="[object WeakMap]",Nt="[object WeakSet]",it="[object ArrayBuffer]",dt="[object DataView]",Ut="[object Float32Array]",Or="[object Float64Array]",Ke="[object Int8Array]",Pt="[object Int16Array]",Lt="[object Int32Array]",et="[object Uint8Array]",er="[object Uint8ClampedArray]",zr="[object Uint16Array]",kr="[object Uint32Array]",wn=/\b__p \+= '';/g,Dr=/\b(__p \+=) '' \+/g,Yr=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Nn=/&(?:amp|lt|gt|quot|#39);/g,xs=/[&<>"']/g,Us=RegExp(Nn.source),To=RegExp(xs.source),Ai=/<%-([\s\S]+?)%>/g,Nr=/<%([\s\S]+?)%>/g,Dn=/<%=([\s\S]+?)%>/g,ve=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ue=/^\w*$/,ht=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,It=/[\\^$.*+?()[\]{}|]/g,zt=RegExp(It.source),lr=/^\s+/,mt=/\s/,Tt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,wr=/\{\n\/\* \[wrapped with (.+)\] \*/,en=/,? & /,Ro=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,aa=/[()=,{}\[\]\/\s]/,ss=/\\(\\)?/g,zs=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Ii=/\w*$/,la=/^[-+]0x[0-9a-f]+$/i,ca=/^0b[01]+$/i,qa=/^\[object .+?Constructor\]$/,at=/^0o[0-7]+$/i,Z=/^(?:0|[1-9]\d*)$/,Oe=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Ze=/($^)/,Tr=/['\n\r\u2028\u2029\\]/g,Ht="\\ud800-\\udfff",Hr="\\u0300-\\u036f",un="\\ufe20-\\ufe2f",ws="\\u20d0-\\u20ff",os=Hr+un+ws,ti="\\u2700-\\u27bf",Br="a-z\\xdf-\\xf6\\xf8-\\xff",ri="\\xac\\xb1\\xd7\\xf7",Ln="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",md="\\u2000-\\u206f",Mn=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",tu="A-Z\\xc0-\\xd6\\xd8-\\xde",ru="\\ufe0e\\ufe0f",ql=ri+Ln+md+Mn,so="[']",Ao="["+Ht+"]",oo="["+ql+"]",ni="["+os+"]",gd="\\d+",Eh="["+ti+"]",Kl="["+Br+"]",nu="[^"+Ht+ql+gd+ti+Br+tu+"]",Ka="\\ud83c[\\udffb-\\udfff]",Ya="(?:"+ni+"|"+Ka+")",vd="[^"+Ht+"]",Ja="(?:\\ud83c[\\udde6-\\uddff]){2}",nr="[\\ud800-\\udbff][\\udc00-\\udfff]",Io="["+tu+"]",su="\\u200d",Xa="(?:"+Kl+"|"+nu+")",yd="(?:"+Io+"|"+nu+")",ou="(?:"+so+"(?:d|ll|m|re|s|t|ve))?",iu="(?:"+so+"(?:D|LL|M|RE|S|T|VE))?",Yl=Ya+"?",Qa="["+ru+"]?",si="(?:"+su+"(?:"+[vd,Ja,nr].join("|")+")"+Qa+Yl+")*",Po="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Fo="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",be=Qa+Yl+si,Le="(?:"+[Eh,Ja,nr].join("|")+")"+be,He="(?:"+[vd+ni+"?",ni,Ja,nr,Ao].join("|")+")",Et=RegExp(so,"g"),Ft=RegExp(ni,"g"),gt=RegExp(Ka+"(?="+Ka+")|"+He+be,"g"),tt=RegExp([Io+"?"+Kl+"+"+ou+"(?="+[oo,Io,"$"].join("|")+")",yd+"+"+iu+"(?="+[oo,Io+Xa,"$"].join("|")+")",Io+"?"+Xa+"+"+ou,Io+"+"+iu,Fo,Po,gd,Le].join("|"),"g"),st=RegExp("["+su+Ht+os+ru+"]"),Tn=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,bs=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],xd=-1,qt={};qt[Ut]=qt[Or]=qt[Ke]=qt[Pt]=qt[Lt]=qt[et]=qt[er]=qt[zr]=qt[kr]=!0,qt[q]=qt[le]=qt[it]=qt[ye]=qt[dt]=qt[de]=qt[Be]=qt[Ge]=qt[Ae]=qt[ct]=qt[yt]=qt[Zt]=qt[Kt]=qt[Kr]=qt[$e]=!1;var vr={};vr[q]=vr[le]=vr[it]=vr[dt]=vr[ye]=vr[de]=vr[Ut]=vr[Or]=vr[Ke]=vr[Pt]=vr[Lt]=vr[Ae]=vr[ct]=vr[yt]=vr[Zt]=vr[Kt]=vr[Kr]=vr[_t]=vr[et]=vr[er]=vr[zr]=vr[kr]=!0,vr[Be]=vr[Ge]=vr[$e]=!1;var jo={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},Za={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},wd={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},au={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Sh=parseFloat,bd=parseInt,_d=typeof bv=="object"&&bv&&bv.Object===Object&&bv,cg=typeof self=="object"&&self&&self.Object===Object&&self,Jr=_d||cg||Function("return this")(),lu=e&&!e.nodeType&&e,oi=lu&&!0&&r&&!r.nodeType&&r,Ch=oi&&oi.exports===lu,Jl=Ch&&_d.process,is=(function(){try{var se=oi&&oi.require&&oi.require("util").types;return se||Jl&&Jl.binding&&Jl.binding("util")}catch{}})(),kh=is&&is.isArrayBuffer,_s=is&&is.isDate,el=is&&is.isMap,Ed=is&&is.isRegExp,Xl=is&&is.isSet,ug=is&&is.isTypedArray;function as(se,Ce,me){switch(me.length){case 0:return se.call(Ce);case 1:return se.call(Ce,me[0]);case 2:return se.call(Ce,me[0],me[1]);case 3:return se.call(Ce,me[0],me[1],me[2])}return se.apply(Ce,me)}function Nh(se,Ce,me,Ye){for(var Mt=-1,yr=se==null?0:se.length;++Mt<yr;){var mn=se[Mt];Ce(Ye,mn,me(mn),se)}return Ye}function qn(se,Ce){for(var me=-1,Ye=se==null?0:se.length;++me<Ye&&Ce(se[me],me,se)!==!1;);return se}function Sd(se,Ce){for(var me=se==null?0:se.length;me--&&Ce(se[me],me,se)!==!1;);return se}function Th(se,Ce){for(var me=-1,Ye=se==null?0:se.length;++me<Ye;)if(!Ce(se[me],me,se))return!1;return!0}function ua(se,Ce){for(var me=-1,Ye=se==null?0:se.length,Mt=0,yr=[];++me<Ye;){var mn=se[me];Ce(mn,me,se)&&(yr[Mt++]=mn)}return yr}function Cd(se,Ce){var me=se==null?0:se.length;return!!me&&Ql(se,Ce,0)>-1}function Rh(se,Ce,me){for(var Ye=-1,Mt=se==null?0:se.length;++Ye<Mt;)if(me(Ce,se[Ye]))return!0;return!1}function Lr(se,Ce){for(var me=-1,Ye=se==null?0:se.length,Mt=Array(Ye);++me<Ye;)Mt[me]=Ce(se[me],me,se);return Mt}function da(se,Ce){for(var me=-1,Ye=Ce.length,Mt=se.length;++me<Ye;)se[Mt+me]=Ce[me];return se}function Ah(se,Ce,me,Ye){var Mt=-1,yr=se==null?0:se.length;for(Ye&&yr&&(me=se[++Mt]);++Mt<yr;)me=Ce(me,se[Mt],Mt,se);return me}function v0(se,Ce,me,Ye){var Mt=se==null?0:se.length;for(Ye&&Mt&&(me=se[--Mt]);Mt--;)me=Ce(me,se[Mt],Mt,se);return me}function Ih(se,Ce){for(var me=-1,Ye=se==null?0:se.length;++me<Ye;)if(Ce(se[me],me,se))return!0;return!1}var y0=Fh("length");function dg(se){return se.split("")}function x0(se){return se.match(Ro)||[]}function fg(se,Ce,me){var Ye;return me(se,function(Mt,yr,mn){if(Ce(Mt,yr,mn))return Ye=yr,!1}),Ye}function kd(se,Ce,me,Ye){for(var Mt=se.length,yr=me+(Ye?1:-1);Ye?yr--:++yr<Mt;)if(Ce(se[yr],yr,se))return yr;return-1}function Ql(se,Ce,me){return Ce===Ce?Rd(se,Ce,me):kd(se,hg,me)}function Ph(se,Ce,me,Ye){for(var Mt=me-1,yr=se.length;++Mt<yr;)if(Ye(se[Mt],Ce))return Mt;return-1}function hg(se){return se!==se}function pg(se,Ce){var me=se==null?0:se.length;return me?jh(se,Ce)/me:Y}function Fh(se){return function(Ce){return Ce==null?t:Ce[se]}}function Nd(se){return function(Ce){return se==null?t:se[Ce]}}function mg(se,Ce,me,Ye,Mt){return Mt(se,function(yr,mn,Ar){me=Ye?(Ye=!1,yr):Ce(me,yr,mn,Ar)}),me}function w0(se,Ce){var me=se.length;for(se.sort(Ce);me--;)se[me]=se[me].value;return se}function jh(se,Ce){for(var me,Ye=-1,Mt=se.length;++Ye<Mt;){var yr=Ce(se[Ye]);yr!==t&&(me=me===t?yr:me+yr)}return me}function Oh(se,Ce){for(var me=-1,Ye=Array(se);++me<se;)Ye[me]=Ce(me);return Ye}function b0(se,Ce){return Lr(Ce,function(me){return[me,se[me]]})}function gg(se){return se&&se.slice(0,Ad(se)+1).replace(lr,"")}function Hs(se){return function(Ce){return se(Ce)}}function cu(se,Ce){return Lr(Ce,function(me){return se[me]})}function Pi(se,Ce){return se.has(Ce)}function vg(se,Ce){for(var me=-1,Ye=se.length;++me<Ye&&Ql(Ce,se[me],0)>-1;);return me}function Dh(se,Ce){for(var me=se.length;me--&&Ql(Ce,se[me],0)>-1;);return me}function yg(se,Ce){for(var me=se.length,Ye=0;me--;)se[me]===Ce&&++Ye;return Ye}var xg=Nd(jo),wg=Nd(Za);function bg(se){return"\\"+au[se]}function Zl(se,Ce){return se==null?t:se[Ce]}function ec(se){return st.test(se)}function _0(se){return Tn.test(se)}function E0(se){for(var Ce,me=[];!(Ce=se.next()).done;)me.push(Ce.value);return me}function Td(se){var Ce=-1,me=Array(se.size);return se.forEach(function(Ye,Mt){me[++Ce]=[Mt,Ye]}),me}function Lh(se,Ce){return function(me){return se(Ce(me))}}function io(se,Ce){for(var me=-1,Ye=se.length,Mt=0,yr=[];++me<Ye;){var mn=se[me];(mn===Ce||mn===g)&&(se[me]=g,yr[Mt++]=me)}return yr}function fa(se){var Ce=-1,me=Array(se.size);return se.forEach(function(Ye){me[++Ce]=Ye}),me}function S0(se){var Ce=-1,me=Array(se.size);return se.forEach(function(Ye){me[++Ce]=[Ye,Ye]}),me}function Rd(se,Ce,me){for(var Ye=me-1,Mt=se.length;++Ye<Mt;)if(se[Ye]===Ce)return Ye;return-1}function C0(se,Ce,me){for(var Ye=me+1;Ye--;)if(se[Ye]===Ce)return Ye;return Ye}function tl(se){return ec(se)?Eg(se):y0(se)}function Bs(se){return ec(se)?Sg(se):dg(se)}function Ad(se){for(var Ce=se.length;Ce--&&mt.test(se.charAt(Ce)););return Ce}var _g=Nd(wd);function Eg(se){for(var Ce=gt.lastIndex=0;gt.test(se);)++Ce;return Ce}function Sg(se){return se.match(gt)||[]}function k0(se){return se.match(tt)||[]}var N0=(function se(Ce){Ce=Ce==null?Jr:tc.defaults(Jr.Object(),Ce,tc.pick(Jr,bs));var me=Ce.Array,Ye=Ce.Date,Mt=Ce.Error,yr=Ce.Function,mn=Ce.Math,Ar=Ce.Object,uu=Ce.RegExp,T0=Ce.String,ao=Ce.TypeError,Fi=me.prototype,Mh=yr.prototype,ii=Ar.prototype,rc=Ce["__core-js_shared__"],du=Mh.toString,pr=ii.hasOwnProperty,nc=0,Id=(function(){var l=/[^.]+$/.exec(rc&&rc.keys&&rc.keys.IE_PROTO||"");return l?"Symbol(src)_1."+l:""})(),fu=ii.toString,Pd=du.call(Ar),Cg=Jr._,kg=uu("^"+du.call(pr).replace(It,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),hu=Ch?Ce.Buffer:t,ji=Ce.Symbol,pu=Ce.Uint8Array,$h=hu?hu.allocUnsafe:t,Oo=Lh(Ar.getPrototypeOf,Ar),Fd=Ar.create,jd=ii.propertyIsEnumerable,Od=Fi.splice,Ng=ji?ji.isConcatSpreadable:t,Oi=ji?ji.iterator:t,rl=ji?ji.toStringTag:t,mu=(function(){try{var l=Ea(Ar,"defineProperty");return l({},"",{}),l}catch{}})(),Tg=Ce.clearTimeout!==Jr.clearTimeout&&Ce.clearTimeout,Gr=Ye&&Ye.now!==Jr.Date.now&&Ye.now,Uh=Ce.setTimeout!==Jr.setTimeout&&Ce.setTimeout,nl=mn.ceil,ha=mn.floor,Dd=Ar.getOwnPropertySymbols,zh=hu?hu.isBuffer:t,sc=Ce.isFinite,Ld=Fi.join,oc=Lh(Ar.keys,Ar),gn=mn.max,Kn=mn.min,R0=Ye.now,Rg=Ce.parseInt,gu=mn.random,Md=Fi.reverse,vu=Ea(Ce,"DataView"),sl=Ea(Ce,"Map"),yu=Ea(Ce,"Promise"),pa=Ea(Ce,"Set"),xu=Ea(Ce,"WeakMap"),ic=Ea(Ar,"create"),$d=xu&&new xu,ac={},Hh=Sa(vu),ma=Sa(sl),Ag=Sa(yu),lc=Sa(pa),ai=Sa(xu),ga=ji?ji.prototype:t,Gs=ga?ga.valueOf:t,Ud=ga?ga.toString:t;function D(l){if(yn(l)&&!Vt(l)&&!(l instanceof Wt)){if(l instanceof Yn)return l;if(pr.call(l,"__wrapped__"))return sv(l)}return new Yn(l)}var cc=(function(){function l(){}return function(f){if(!hn(f))return{};if(Fd)return Fd(f);l.prototype=f;var y=new l;return l.prototype=t,y}})();function li(){}function Yn(l,f){this.__wrapped__=l,this.__actions__=[],this.__chain__=!!f,this.__index__=0,this.__values__=t}D.templateSettings={escape:Ai,evaluate:Nr,interpolate:Dn,variable:"",imports:{_:D}},D.prototype=li.prototype,D.prototype.constructor=D,Yn.prototype=cc(li.prototype),Yn.prototype.constructor=Yn;function Wt(l){this.__wrapped__=l,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=O,this.__views__=[]}function zd(){var l=new Wt(this.__wrapped__);return l.__actions__=cs(this.__actions__),l.__dir__=this.__dir__,l.__filtered__=this.__filtered__,l.__iteratees__=cs(this.__iteratees__),l.__takeCount__=this.__takeCount__,l.__views__=cs(this.__views__),l}function Bh(){if(this.__filtered__){var l=new Wt(this);l.__dir__=-1,l.__filtered__=!0}else l=this.clone(),l.__dir__*=-1;return l}function uc(){var l=this.__wrapped__.value(),f=this.__dir__,y=Vt(l),C=f<0,I=y?l.length:0,L=vp(0,I,this.__views__),K=L.start,ee=L.end,ce=ee-K,Ne=C?ee:K-1,Re=this.__iteratees__,Fe=Re.length,We=0,ft=Kn(ce,this.__takeCount__);if(!y||!C&&I==ce&&ft==ce)return yc(l,this.__actions__);var Ot=[];e:for(;ce--&&We<ft;){Ne+=f;for(var tr=-1,Dt=l[Ne];++tr<Fe;){var cr=Re[tr],gr=cr.iteratee,Wo=cr.type,Ys=gr(Dt);if(Wo==oe)Dt=Ys;else if(!Ys){if(Wo==ue)continue e;break e}}Ot[We++]=Dt}return Ot}Wt.prototype=cc(li.prototype),Wt.prototype.constructor=Wt;function Es(l){var f=-1,y=l==null?0:l.length;for(this.clear();++f<y;){var C=l[f];this.set(C[0],C[1])}}function Wr(){this.__data__=ic?ic(null):{},this.size=0}function Mr(l){var f=this.has(l)&&delete this.__data__[l];return this.size-=f?1:0,f}function va(l){var f=this.__data__;if(ic){var y=f[l];return y===p?t:y}return pr.call(f,l)?f[l]:t}function Jn(l){var f=this.__data__;return ic?f[l]!==t:pr.call(f,l)}function Ss(l,f){var y=this.__data__;return this.size+=this.has(l)?0:1,y[l]=ic&&f===t?p:f,this}Es.prototype.clear=Wr,Es.prototype.delete=Mr,Es.prototype.get=va,Es.prototype.has=Jn,Es.prototype.set=Ss;function ls(l){var f=-1,y=l==null?0:l.length;for(this.clear();++f<y;){var C=l[f];this.set(C[0],C[1])}}function dc(){this.__data__=[],this.size=0}function Cs(l){var f=this.__data__,y=Qn(f,l);if(y<0)return!1;var C=f.length-1;return y==C?f.pop():Od.call(f,y,1),--this.size,!0}function Hd(l){var f=this.__data__,y=Qn(f,l);return y<0?t:f[y][1]}function Ig(l){return Qn(this.__data__,l)>-1}function Pg(l,f){var y=this.__data__,C=Qn(y,l);return C<0?(++this.size,y.push([l,f])):y[C][1]=f,this}ls.prototype.clear=dc,ls.prototype.delete=Cs,ls.prototype.get=Hd,ls.prototype.has=Ig,ls.prototype.set=Pg;function lo(l){var f=-1,y=l==null?0:l.length;for(this.clear();++f<y;){var C=l[f];this.set(C[0],C[1])}}function Fg(){this.size=0,this.__data__={hash:new Es,map:new(sl||ls),string:new Es}}function Di(l){var f=Ou(this,l).delete(l);return this.size-=f?1:0,f}function Bd(l){return Ou(this,l).get(l)}function Gh(l){return Ou(this,l).has(l)}function jg(l,f){var y=Ou(this,l),C=y.size;return y.set(l,f),this.size+=y.size==C?0:1,this}lo.prototype.clear=Fg,lo.prototype.delete=Di,lo.prototype.get=Bd,lo.prototype.has=Gh,lo.prototype.set=jg;function ol(l){var f=-1,y=l==null?0:l.length;for(this.__data__=new lo;++f<y;)this.add(l[f])}function ya(l){return this.__data__.set(l,p),this}function fc(l){return this.__data__.has(l)}ol.prototype.add=ol.prototype.push=ya,ol.prototype.has=fc;function Xn(l){var f=this.__data__=new ls(l);this.size=f.size}function Gd(){this.__data__=new ls,this.size=0}function Wd(l){var f=this.__data__,y=f.delete(l);return this.size=f.size,y}function co(l){return this.__data__.get(l)}function uo(l){return this.__data__.has(l)}function il(l,f){var y=this.__data__;if(y instanceof ls){var C=y.__data__;if(!sl||C.length<s-1)return C.push([l,f]),this.size=++y.size,this;y=this.__data__=new lo(C)}return y.set(l,f),this.size=y.size,this}Xn.prototype.clear=Gd,Xn.prototype.delete=Wd,Xn.prototype.get=co,Xn.prototype.has=uo,Xn.prototype.set=il;function ci(l,f){var y=Vt(l),C=!y&&qu(l),I=!y&&!C&&Tc(l),L=!y&&!C&&!I&&Of(l),K=y||C||I||L,ee=K?Oh(l.length,T0):[],ce=ee.length;for(var Ne in l)(f||pr.call(l,Ne))&&!(K&&(Ne=="length"||I&&(Ne=="offset"||Ne=="parent")||L&&(Ne=="buffer"||Ne=="byteLength"||Ne=="byteOffset")||Qr(Ne,ce)))&&ee.push(Ne);return ee}function ui(l){var f=l.length;return f?l[gc(0,f-1)]:t}function al(l,f){return yf(cs(l),Li(f,0,l.length))}function Og(l){return yf(cs(l))}function wu(l,f,y){(y!==t&&!qi(l[f],y)||y===t&&!(f in l))&&di(l,f,y)}function ll(l,f,y){var C=l[f];(!(pr.call(l,f)&&qi(C,y))||y===t&&!(f in l))&&di(l,f,y)}function Qn(l,f){for(var y=l.length;y--;)if(qi(l[y][0],f))return y;return-1}function Ws(l,f,y,C){return hi(l,function(I,L,K){f(C,I,y(I),K)}),C}function Vr(l,f){return l&&Lo(f,ts(f),l)}function Do(l,f){return l&&Lo(f,wo(f),l)}function di(l,f,y){f=="__proto__"&&mu?mu(l,f,{configurable:!0,enumerable:!0,value:y,writable:!0}):l[f]=y}function Vd(l,f){for(var y=-1,C=f.length,I=me(C),L=l==null;++y<C;)I[y]=L?t:Z0(l,f[y]);return I}function Li(l,f,y){return l===l&&(y!==t&&(l=l<=y?l:y),f!==t&&(l=l>=f?l:f)),l}function ks(l,f,y,C,I,L){var K,ee=f&x,ce=f&b,Ne=f&E;if(y&&(K=I?y(l,C,I,L):y(l)),K!==t)return K;if(!hn(l))return l;var Re=Vt(l);if(Re){if(K=Lu(l),!ee)return cs(l,K)}else{var Fe=zn(l),We=Fe==Ge||Fe==Me;if(Tc(l))return op(l,ee);if(Fe==yt||Fe==q||We&&!I){if(K=ce||We?{}:Hn(l),!ee)return ce?I0(l,Do(K,l)):of(l,Vr(K,l))}else{if(!vr[Fe])return I?l:{};K=P0(l,Fe,ee)}}L||(L=new Xn);var ft=L.get(l);if(ft)return ft;L.set(l,K),VE(l)?l.forEach(function(Dt){K.add(ks(Dt,f,y,Dt,l,L))}):GE(l)&&l.forEach(function(Dt,cr){K.set(cr,ks(Dt,f,y,cr,l,L))});var Ot=Ne?ce?ju:Fu:ce?wo:ts,tr=Re?t:Ot(l);return qn(tr||l,function(Dt,cr){tr&&(cr=Dt,Dt=l[cr]),ll(K,cr,ks(Dt,f,y,cr,l,L))}),K}function Dg(l){var f=ts(l);return function(y){return bu(y,l,f)}}function bu(l,f,y){var C=y.length;if(l==null)return!C;for(l=Ar(l);C--;){var I=y[C],L=f[I],K=l[I];if(K===t&&!(I in l)||!L(K))return!1}return!0}function Wh(l,f,y){if(typeof l!="function")throw new ao(c);return Cc(function(){l.apply(t,y)},f)}function fi(l,f,y,C){var I=-1,L=Cd,K=!0,ee=l.length,ce=[],Ne=f.length;if(!ee)return ce;y&&(f=Lr(f,Hs(y))),C?(L=Rh,K=!1):f.length>=s&&(L=Pi,K=!1,f=new ol(f));e:for(;++I<ee;){var Re=l[I],Fe=y==null?Re:y(Re);if(Re=C||Re!==0?Re:0,K&&Fe===Fe){for(var We=Ne;We--;)if(f[We]===Fe)continue e;ce.push(Re)}else L(f,Fe,C)||ce.push(Re)}return ce}var hi=go(Vs),Lg=go(xa,!0);function _u(l,f){var y=!0;return hi(l,function(C,I,L){return y=!!f(C,I,L),y}),y}function cl(l,f,y){for(var C=-1,I=l.length;++C<I;){var L=l[C],K=f(L);if(K!=null&&(ee===t?K===K&&!Go(K):y(K,ee)))var ee=K,ce=L}return ce}function Mg(l,f,y,C){var I=l.length;for(y=Jt(y),y<0&&(y=-y>I?0:I+y),C=C===t||C>I?I:Jt(C),C<0&&(C+=I),C=y>C?0:KE(C);y<C;)l[y++]=f;return l}function Vh(l,f){var y=[];return hi(l,function(C,I,L){f(C,I,L)&&y.push(C)}),y}function ln(l,f,y,C,I){var L=-1,K=l.length;for(y||(y=mf),I||(I=[]);++L<K;){var ee=l[L];f>0&&y(ee)?f>1?ln(ee,f-1,y,C,I):da(I,ee):C||(I[I.length]=ee)}return I}var qd=lf(),Eu=lf(!0);function Vs(l,f){return l&&qd(l,f,ts)}function xa(l,f){return l&&Eu(l,f,ts)}function hc(l,f){return ua(f,function(y){return _l(l[y])})}function Mi(l,f){f=gi(f,l);for(var y=0,C=f.length;l!=null&&y<C;)l=l[zo(f[y++])];return y&&y==C?l:t}function Kd(l,f,y){var C=f(l);return Vt(l)?C:da(C,y(l))}function $n(l){return l==null?l===t?Se:Bt:rl&&rl in Ar(l)?pf(l):xp(l)}function wa(l,f){return l>f}function fo(l,f){return l!=null&&pr.call(l,f)}function ul(l,f){return l!=null&&f in Ar(l)}function qh(l,f,y){return l>=Kn(f,y)&&l<gn(f,y)}function Yd(l,f,y){for(var C=y?Rh:Cd,I=l[0].length,L=l.length,K=L,ee=me(L),ce=1/0,Ne=[];K--;){var Re=l[K];K&&f&&(Re=Lr(Re,Hs(f))),ce=Kn(Re.length,ce),ee[K]=!y&&(f||I>=120&&Re.length>=120)?new ol(K&&Re):t}Re=l[0];var Fe=-1,We=ee[0];e:for(;++Fe<I&&Ne.length<ce;){var ft=Re[Fe],Ot=f?f(ft):ft;if(ft=y||ft!==0?ft:0,!(We?Pi(We,Ot):C(Ne,Ot,y))){for(K=L;--K;){var tr=ee[K];if(!(tr?Pi(tr,Ot):C(l[K],Ot,y)))continue e}We&&We.push(Ot),Ne.push(ft)}}return Ne}function $i(l,f,y,C){return Vs(l,function(I,L,K){f(C,y(I),L,K)}),C}function ho(l,f,y){f=gi(f,l),l=Rn(l,f);var C=l==null?l:l[zo(fs(f))];return C==null?t:as(C,l,y)}function Jd(l){return yn(l)&&$n(l)==q}function $g(l){return yn(l)&&$n(l)==it}function Ui(l){return yn(l)&&$n(l)==de}function po(l,f,y,C,I){return l===f?!0:l==null||f==null||!yn(l)&&!yn(f)?l!==l&&f!==f:Xd(l,f,y,C,po,I)}function Xd(l,f,y,C,I,L){var K=Vt(l),ee=Vt(f),ce=K?le:zn(l),Ne=ee?le:zn(f);ce=ce==q?yt:ce,Ne=Ne==q?yt:Ne;var Re=ce==yt,Fe=Ne==yt,We=ce==Ne;if(We&&Tc(l)){if(!Tc(f))return!1;K=!0,Re=!1}if(We&&!Re)return L||(L=new Xn),K||Of(l)?mp(l,f,y,C,I,L):gp(l,f,ce,y,C,I,L);if(!(y&T)){var ft=Re&&pr.call(l,"__wrapped__"),Ot=Fe&&pr.call(f,"__wrapped__");if(ft||Ot){var tr=ft?l.value():l,Dt=Ot?f.value():f;return L||(L=new Xn),I(tr,Dt,y,C,L)}}return We?(L||(L=new Xn),Jg(l,f,y,C,I,L)):!1}function Ug(l){return yn(l)&&zn(l)==Ae}function pc(l,f,y,C){var I=y.length,L=I,K=!C;if(l==null)return!L;for(l=Ar(l);I--;){var ee=y[I];if(K&&ee[2]?ee[1]!==l[ee[0]]:!(ee[0]in l))return!1}for(;++I<L;){ee=y[I];var ce=ee[0],Ne=l[ce],Re=ee[1];if(K&&ee[2]){if(Ne===t&&!(ce in l))return!1}else{var Fe=new Xn;if(C)var We=C(Ne,Re,ce,l,f,Fe);if(!(We===t?po(Re,Ne,T|S,C,Fe):We))return!1}}return!0}function Kh(l){if(!hn(l)||Zg(l))return!1;var f=_l(l)?kg:qa;return f.test(Sa(l))}function Su(l){return yn(l)&&$n(l)==Zt}function pi(l){return yn(l)&&zn(l)==Kt}function Cu(l){return yn(l)&&yv(l.length)&&!!qt[$n(l)]}function mc(l){return typeof l=="function"?l:l==null?bo:typeof l=="object"?Vt(l)?Xr(l[0],l[1]):Qd(l):oS(l)}function zi(l){if(!Wi(l))return oc(l);var f=[];for(var y in Ar(l))pr.call(l,y)&&y!="constructor"&&f.push(y);return f}function Yh(l){if(!hn(l))return rv(l);var f=Wi(l),y=[];for(var C in l)C=="constructor"&&(f||!pr.call(l,C))||y.push(C);return y}function ba(l,f){return l<f}function Jh(l,f){var y=-1,C=xo(l)?me(l.length):[];return hi(l,function(I,L,K){C[++y]=f(I,L,K)}),C}function Qd(l){var f=Du(l);return f.length==1&&f[0][2]?gf(f[0][0],f[0][1]):function(y){return y===l||pc(y,l,f)}}function Xr(l,f){return rt(l)&&$u(f)?gf(zo(l),f):function(y){var C=Z0(y,l);return C===t&&C===f?ex(y,l):po(f,C,T|S)}}function dl(l,f,y,C,I){l!==f&&qd(f,function(L,K){if(I||(I=new Xn),hn(L))Xh(l,f,K,y,dl,C,I);else{var ee=C?C(xi(l,K),L,K+"",l,f,I):t;ee===t&&(ee=L),wu(l,K,ee)}},wo)}function Xh(l,f,y,C,I,L,K){var ee=xi(l,y),ce=xi(f,y),Ne=K.get(ce);if(Ne){wu(l,y,Ne);return}var Re=L?L(ee,ce,y+"",l,f,K):t,Fe=Re===t;if(Fe){var We=Vt(ce),ft=!We&&Tc(ce),Ot=!We&&!ft&&Of(ce);Re=ce,We||ft||Ot?Vt(ee)?Re=ee:En(ee)?Re=cs(ee):ft?(Fe=!1,Re=op(ce,!0)):Ot?(Fe=!1,Re=Wg(ce,!0)):Re=[]:Lp(ce)||qu(ce)?(Re=ee,qu(ee)?Re=YE(ee):(!hn(ee)||_l(ee))&&(Re=Hn(ce))):Fe=!1}Fe&&(K.set(ce,Re),I(Re,ce,C,L,K),K.delete(ce)),wu(l,y,Re)}function Zd(l,f){var y=l.length;if(y)return f+=f<0?y:0,Qr(f,y)?l[f]:t}function ku(l,f,y){f.length?f=Lr(f,function(L){return Vt(L)?function(K){return Mi(K,L.length===1?L[0]:L)}:L}):f=[bo];var C=-1;f=Lr(f,Hs(Rt()));var I=Jh(l,function(L,K,ee){var ce=Lr(f,function(Ne){return Ne(L)});return{criteria:ce,index:++C,value:L}});return w0(I,function(L,K){return A0(L,K,y)})}function Qh(l,f){return _a(l,f,function(y,C){return ex(l,C)})}function _a(l,f,y){for(var C=-1,I=f.length,L={};++C<I;){var K=f[C],ee=Mi(l,K);y(ee,K)&&hl(L,gi(K,l),ee)}return L}function tn(l){return function(f){return Mi(f,l)}}function dn(l,f,y,C){var I=C?Ph:Ql,L=-1,K=f.length,ee=l;for(l===f&&(f=cs(f)),y&&(ee=Lr(l,Hs(y)));++L<K;)for(var ce=0,Ne=f[L],Re=y?y(Ne):Ne;(ce=I(ee,Re,ce,C))>-1;)ee!==l&&Od.call(ee,ce,1),Od.call(l,ce,1);return l}function bn(l,f){for(var y=l?f.length:0,C=y-1;y--;){var I=f[y];if(y==C||I!==L){var L=I;Qr(I)?Od.call(l,I,1):rf(l,I)}}return l}function gc(l,f){return l+ha(gu()*(f-l+1))}function Nu(l,f,y,C){for(var I=-1,L=gn(nl((f-l)/(y||1)),0),K=me(L);L--;)K[C?L:++I]=l,l+=y;return K}function fl(l,f){var y="";if(!l||f<1||f>B)return y;do f%2&&(y+=l),f=ha(f/2),f&&(l+=l);while(f);return y}function Yt(l,f){return qs(vf(l,f,bo),l+"")}function Zn(l){return ui(Df(l))}function Zh(l,f){var y=Df(l);return yf(y,Li(f,0,y.length))}function hl(l,f,y,C){if(!hn(l))return l;f=gi(f,l);for(var I=-1,L=f.length,K=L-1,ee=l;ee!=null&&++I<L;){var ce=zo(f[I]),Ne=y;if(ce==="__proto__"||ce==="constructor"||ce==="prototype")return l;if(I!=K){var Re=ee[ce];Ne=C?C(Re,ce,ee):t,Ne===t&&(Ne=hn(Re)?Re:Qr(f[I+1])?[]:{})}ll(ee,ce,Ne),ee=ee[ce]}return l}var ef=$d?function(l,f){return $d.set(l,f),l}:bo,mi=mu?function(l,f){return mu(l,"toString",{configurable:!0,enumerable:!1,value:rx(f),writable:!0})}:bo;function mo(l){return yf(Df(l))}function es(l,f,y){var C=-1,I=l.length;f<0&&(f=-f>I?0:I+f),y=y>I?I:y,y<0&&(y+=I),I=f>y?0:y-f>>>0,f>>>=0;for(var L=me(I);++C<I;)L[C]=l[C+f];return L}function ep(l,f){var y;return hi(l,function(C,I,L){return y=f(C,I,L),!y}),!!y}function vc(l,f,y){var C=0,I=l==null?C:l.length;if(typeof f=="number"&&f===f&&I<=ne){for(;C<I;){var L=C+I>>>1,K=l[L];K!==null&&!Go(K)&&(y?K<=f:K<f)?C=L+1:I=L}return I}return tf(l,f,bo,y)}function tf(l,f,y,C){var I=0,L=l==null?0:l.length;if(L===0)return 0;f=y(f);for(var K=f!==f,ee=f===null,ce=Go(f),Ne=f===t;I<L;){var Re=ha((I+L)/2),Fe=y(l[Re]),We=Fe!==t,ft=Fe===null,Ot=Fe===Fe,tr=Go(Fe);if(K)var Dt=C||Ot;else Ne?Dt=Ot&&(C||We):ee?Dt=Ot&&We&&(C||!ft):ce?Dt=Ot&&We&&!ft&&(C||!tr):ft||tr?Dt=!1:Dt=C?Fe<=f:Fe<f;Dt?I=Re+1:L=Re}return Kn(L,U)}function tp(l,f){for(var y=-1,C=l.length,I=0,L=[];++y<C;){var K=l[y],ee=f?f(K):K;if(!y||!qi(ee,ce)){var ce=ee;L[I++]=K===0?0:K}}return L}function rp(l){return typeof l=="number"?l:Go(l)?Y:+l}function Ns(l){if(typeof l=="string")return l;if(Vt(l))return Lr(l,Ns)+"";if(Go(l))return Ud?Ud.call(l):"";var f=l+"";return f=="0"&&1/l==-te?"-0":f}function Hi(l,f,y){var C=-1,I=Cd,L=l.length,K=!0,ee=[],ce=ee;if(y)K=!1,I=Rh;else if(L>=s){var Ne=f?null:Yg(l);if(Ne)return fa(Ne);K=!1,I=Pi,ce=new ol}else ce=f?[]:ee;e:for(;++C<L;){var Re=l[C],Fe=f?f(Re):Re;if(Re=y||Re!==0?Re:0,K&&Fe===Fe){for(var We=ce.length;We--;)if(ce[We]===Fe)continue e;f&&ce.push(Fe),ee.push(Re)}else I(ce,Fe,y)||(ce!==ee&&ce.push(Fe),ee.push(Re))}return ee}function rf(l,f){f=gi(f,l);var y=-1,C=f.length;if(!C)return!0;for(var I=l==null||typeof l!="object"&&typeof l!="function";++y<C;){var L=f[y];if(typeof L=="string"){if(L==="__proto__"&&!pr.call(l,"__proto__"))return!1;if(L==="constructor"&&y+1<C&&typeof f[y+1]=="string"&&f[y+1]==="prototype"){if(I&&y===0)continue;return!1}}}var K=Rn(l,f);return K==null||delete K[zo(fs(f))]}function np(l,f,y,C){return hl(l,f,y(Mi(l,f)),C)}function Tu(l,f,y,C){for(var I=l.length,L=C?I:-1;(C?L--:++L<I)&&f(l[L],L,l););return y?es(l,C?0:L,C?L+1:I):es(l,C?L+1:0,C?I:L)}function yc(l,f){var y=l;return y instanceof Wt&&(y=y.value()),Ah(f,function(C,I){return I.func.apply(I.thisArg,da([C],I.args))},y)}function nf(l,f,y){var C=l.length;if(C<2)return C?Hi(l[0]):[];for(var I=-1,L=me(C);++I<C;)for(var K=l[I],ee=-1;++ee<C;)ee!=I&&(L[I]=fi(L[I]||K,l[ee],f,y));return Hi(ln(L,1),f,y)}function Ru(l,f,y){for(var C=-1,I=l.length,L=f.length,K={};++C<I;){var ee=C<L?f[C]:t;y(K,l[C],ee)}return K}function xc(l){return En(l)?l:[]}function sf(l){return typeof l=="function"?l:bo}function gi(l,f){return Vt(l)?l:rt(l,f)?[l]:_p(Ir(l))}var zg=Yt;function Bi(l,f,y){var C=l.length;return y=y===t?C:y,!f&&y>=C?l:es(l,f,y)}var sp=Tg||function(l){return Jr.clearTimeout(l)};function op(l,f){if(f)return l.slice();var y=l.length,C=$h?$h(y):new l.constructor(y);return l.copy(C),C}function Au(l){var f=new l.constructor(l.byteLength);return new pu(f).set(new pu(l)),f}function Hg(l,f){var y=f?Au(l.buffer):l.buffer;return new l.constructor(y,l.byteOffset,l.byteLength)}function Bg(l){var f=new l.constructor(l.source,Ii.exec(l));return f.lastIndex=l.lastIndex,f}function Gg(l){return Gs?Ar(Gs.call(l)):{}}function Wg(l,f){var y=f?Au(l.buffer):l.buffer;return new l.constructor(y,l.byteOffset,l.length)}function ip(l,f){if(l!==f){var y=l!==t,C=l===null,I=l===l,L=Go(l),K=f!==t,ee=f===null,ce=f===f,Ne=Go(f);if(!ee&&!Ne&&!L&&l>f||L&&K&&ce&&!ee&&!Ne||C&&K&&ce||!y&&ce||!I)return 1;if(!C&&!L&&!Ne&&l<f||Ne&&y&&I&&!C&&!L||ee&&y&&I||!K&&I||!ce)return-1}return 0}function A0(l,f,y){for(var C=-1,I=l.criteria,L=f.criteria,K=I.length,ee=y.length;++C<K;){var ce=ip(I[C],L[C]);if(ce){if(C>=ee)return ce;var Ne=y[C];return ce*(Ne=="desc"?-1:1)}}return l.index-f.index}function Vg(l,f,y,C){for(var I=-1,L=l.length,K=y.length,ee=-1,ce=f.length,Ne=gn(L-K,0),Re=me(ce+Ne),Fe=!C;++ee<ce;)Re[ee]=f[ee];for(;++I<K;)(Fe||I<L)&&(Re[y[I]]=l[I]);for(;Ne--;)Re[ee++]=l[I++];return Re}function ap(l,f,y,C){for(var I=-1,L=l.length,K=-1,ee=y.length,ce=-1,Ne=f.length,Re=gn(L-ee,0),Fe=me(Re+Ne),We=!C;++I<Re;)Fe[I]=l[I];for(var ft=I;++ce<Ne;)Fe[ft+ce]=f[ce];for(;++K<ee;)(We||I<L)&&(Fe[ft+y[K]]=l[I++]);return Fe}function cs(l,f){var y=-1,C=l.length;for(f||(f=me(C));++y<C;)f[y]=l[y];return f}function Lo(l,f,y,C){var I=!y;y||(y={});for(var L=-1,K=f.length;++L<K;){var ee=f[L],ce=C?C(y[ee],l[ee],ee,y,l):t;ce===t&&(ce=l[ee]),I?di(y,ee,ce):ll(y,ee,ce)}return y}function of(l,f){return Lo(l,Mo(l),f)}function I0(l,f){return Lo(l,Xg(l),f)}function af(l,f){return function(y,C){var I=Vt(y)?Nh:Ws,L=f?f():{};return I(y,l,Rt(C,2),L)}}function wc(l){return Yt(function(f,y){var C=-1,I=y.length,L=I>1?y[I-1]:t,K=I>2?y[2]:t;for(L=l.length>3&&typeof L=="function"?(I--,L):t,K&&ds(y[0],y[1],K)&&(L=I<3?t:L,I=1),f=Ar(f);++C<I;){var ee=y[C];ee&&l(f,ee,C,L)}return f})}function go(l,f){return function(y,C){if(y==null)return y;if(!xo(y))return l(y,C);for(var I=y.length,L=f?I:-1,K=Ar(y);(f?L--:++L<I)&&C(K[L],L,K)!==!1;);return y}}function lf(l){return function(f,y,C){for(var I=-1,L=Ar(f),K=C(f),ee=K.length;ee--;){var ce=K[l?ee:++I];if(y(L[ce],ce,L)===!1)break}return f}}function cf(l,f,y){var C=f&N,I=bc(l);function L(){var K=this&&this!==Jr&&this instanceof L?I:l;return K.apply(C?y:this,arguments)}return L}function lp(l){return function(f){f=Ir(f);var y=ec(f)?Bs(f):t,C=y?y[0]:f.charAt(0),I=y?Bi(y,1).join(""):f.slice(1);return C[l]()+I}}function pl(l){return function(f){return Ah(nS(rS(f).replace(Et,"")),l,"")}}function bc(l){return function(){var f=arguments;switch(f.length){case 0:return new l;case 1:return new l(f[0]);case 2:return new l(f[0],f[1]);case 3:return new l(f[0],f[1],f[2]);case 4:return new l(f[0],f[1],f[2],f[3]);case 5:return new l(f[0],f[1],f[2],f[3],f[4]);case 6:return new l(f[0],f[1],f[2],f[3],f[4],f[5]);case 7:return new l(f[0],f[1],f[2],f[3],f[4],f[5],f[6])}var y=cc(l.prototype),C=l.apply(y,f);return hn(C)?C:y}}function cp(l,f,y){var C=bc(l);function I(){for(var L=arguments.length,K=me(L),ee=L,ce=Gi(I);ee--;)K[ee]=arguments[ee];var Ne=L<3&&K[0]!==ce&&K[L-1]!==ce?[]:io(K,ce);if(L-=Ne.length,L<y)return us(l,f,_c,I.placeholder,t,K,Ne,t,t,y-L);var Re=this&&this!==Jr&&this instanceof I?C:l;return as(Re,this,K)}return I}function ml(l){return function(f,y,C){var I=Ar(f);if(!xo(f)){var L=Rt(y,3);f=ts(f),y=function(ee){return L(I[ee],ee,I)}}var K=l(f,y,C);return K>-1?I[L?f[K]:K]:t}}function uf(l){return yi(function(f){var y=f.length,C=y,I=Yn.prototype.thru;for(l&&f.reverse();C--;){var L=f[C];if(typeof L!="function")throw new ao(c);if(I&&!K&&Ec(L)=="wrapper")var K=new Yn([],!0)}for(C=K?C:y;++C<y;){L=f[C];var ee=Ec(L),ce=ee=="wrapper"?hf(L):t;ce&&Mu(ce[0])&&ce[1]==(M|j|$|V)&&!ce[4].length&&ce[9]==1?K=K[Ec(ce[0])].apply(K,ce[3]):K=L.length==1&&Mu(L)?K[ee]():K.thru(L)}return function(){var Ne=arguments,Re=Ne[0];if(K&&Ne.length==1&&Vt(Re))return K.plant(Re).value();for(var Fe=0,We=y?f[Fe].apply(this,Ne):Re;++Fe<y;)We=f[Fe].call(this,We);return We}})}function _c(l,f,y,C,I,L,K,ee,ce,Ne){var Re=f&M,Fe=f&N,We=f&R,ft=f&(j|P),Ot=f&X,tr=We?t:bc(l);function Dt(){for(var cr=arguments.length,gr=me(cr),Wo=cr;Wo--;)gr[Wo]=arguments[Wo];if(ft)var Ys=Gi(Dt),Vo=yg(gr,Ys);if(C&&(gr=Vg(gr,C,I,ft)),L&&(gr=ap(gr,L,K,ft)),cr-=Vo,ft&&cr<Ne){var Sn=io(gr,Ys);return us(l,f,_c,Dt.placeholder,y,gr,Sn,ee,ce,Ne-cr)}var Ki=Fe?y:this,Sl=We?Ki[l]:l;return cr=gr.length,ee?gr=$o(gr,ee):Ot&&cr>1&&gr.reverse(),Re&&ce<cr&&(gr.length=ce),this&&this!==Jr&&this instanceof Dt&&(Sl=tr||bc(Sl)),Sl.apply(Ki,gr)}return Dt}function qg(l,f){return function(y,C){return $i(y,l,f(C),{})}}function Iu(l,f){return function(y,C){var I;if(y===t&&C===t)return f;if(y!==t&&(I=y),C!==t){if(I===t)return C;typeof y=="string"||typeof C=="string"?(y=Ns(y),C=Ns(C)):(y=rp(y),C=rp(C)),I=l(y,C)}return I}}function df(l){return yi(function(f){return f=Lr(f,Hs(Rt())),Yt(function(y){var C=this;return l(f,function(I){return as(I,C,y)})})})}function Pu(l,f){f=f===t?" ":Ns(f);var y=f.length;if(y<2)return y?fl(f,l):f;var C=fl(f,nl(l/tl(f)));return ec(f)?Bi(Bs(C),0,l).join(""):C.slice(0,l)}function Kg(l,f,y,C){var I=f&N,L=bc(l);function K(){for(var ee=-1,ce=arguments.length,Ne=-1,Re=C.length,Fe=me(Re+ce),We=this&&this!==Jr&&this instanceof K?L:l;++Ne<Re;)Fe[Ne]=C[Ne];for(;ce--;)Fe[Ne++]=arguments[++ee];return as(We,I?y:this,Fe)}return K}function up(l){return function(f,y,C){return C&&typeof C!="number"&&ds(f,y,C)&&(y=C=t),f=El(f),y===t?(y=f,f=0):y=El(y),C=C===t?f<y?1:-1:El(C),Nu(f,y,C,l)}}function ff(l){return function(f,y){return typeof f=="string"&&typeof y=="string"||(f=wi(f),y=wi(y)),l(f,y)}}function us(l,f,y,C,I,L,K,ee,ce,Ne){var Re=f&j,Fe=Re?K:t,We=Re?t:K,ft=Re?L:t,Ot=Re?t:L;f|=Re?$:W,f&=~(Re?W:$),f&A||(f&=-4);var tr=[l,f,I,ft,Fe,Ot,We,ee,ce,Ne],Dt=y.apply(t,tr);return Mu(l)&&wp(Dt,tr),Dt.placeholder=C,bp(Dt,l,f)}function Un(l){var f=mn[l];return function(y,C){if(y=wi(y),C=C==null?0:Kn(Jt(C),292),C&&sc(y)){var I=(Ir(y)+"e").split("e"),L=f(I[0]+"e"+(+I[1]+C));return I=(Ir(L)+"e").split("e"),+(I[0]+"e"+(+I[1]-C))}return f(y)}}var Yg=pa&&1/fa(new pa([,-0]))[1]==te?function(l){return new pa(l)}:ox;function dp(l){return function(f){var y=zn(f);return y==Ae?Td(f):y==Kt?S0(f):b0(f,l(f))}}function vi(l,f,y,C,I,L,K,ee){var ce=f&R;if(!ce&&typeof l!="function")throw new ao(c);var Ne=C?C.length:0;if(Ne||(f&=-97,C=I=t),K=K===t?K:gn(Jt(K),0),ee=ee===t?ee:Jt(ee),Ne-=I?I.length:0,f&W){var Re=C,Fe=I;C=I=t}var We=ce?t:hf(l),ft=[l,f,y,C,I,Re,Fe,L,K,ee];if(We&&tv(ft,We),l=ft[0],f=ft[1],y=ft[2],C=ft[3],I=ft[4],ee=ft[9]=ft[9]===t?ce?0:l.length:gn(ft[9]-Ne,0),!ee&&f&(j|P)&&(f&=-25),!f||f==N)var Ot=cf(l,f,y);else f==j||f==P?Ot=cp(l,f,ee):(f==$||f==(N|$))&&!I.length?Ot=Kg(l,f,y,C):Ot=_c.apply(t,ft);var tr=We?ef:wp;return bp(tr(Ot,ft),l,f)}function fp(l,f,y,C){return l===t||qi(l,ii[y])&&!pr.call(C,y)?f:l}function hp(l,f,y,C,I,L){return hn(l)&&hn(f)&&(L.set(f,l),dl(l,f,t,hp,L),L.delete(f)),l}function pp(l){return Lp(l)?t:l}function mp(l,f,y,C,I,L){var K=y&T,ee=l.length,ce=f.length;if(ee!=ce&&!(K&&ce>ee))return!1;var Ne=L.get(l),Re=L.get(f);if(Ne&&Re)return Ne==f&&Re==l;var Fe=-1,We=!0,ft=y&S?new ol:t;for(L.set(l,f),L.set(f,l);++Fe<ee;){var Ot=l[Fe],tr=f[Fe];if(C)var Dt=K?C(tr,Ot,Fe,f,l,L):C(Ot,tr,Fe,l,f,L);if(Dt!==t){if(Dt)continue;We=!1;break}if(ft){if(!Ih(f,function(cr,gr){if(!Pi(ft,gr)&&(Ot===cr||I(Ot,cr,y,C,L)))return ft.push(gr)})){We=!1;break}}else if(!(Ot===tr||I(Ot,tr,y,C,L))){We=!1;break}}return L.delete(l),L.delete(f),We}function gp(l,f,y,C,I,L,K){switch(y){case dt:if(l.byteLength!=f.byteLength||l.byteOffset!=f.byteOffset)return!1;l=l.buffer,f=f.buffer;case it:return!(l.byteLength!=f.byteLength||!L(new pu(l),new pu(f)));case ye:case de:case ct:return qi(+l,+f);case Be:return l.name==f.name&&l.message==f.message;case Zt:case Kr:return l==f+"";case Ae:var ee=Td;case Kt:var ce=C&T;if(ee||(ee=fa),l.size!=f.size&&!ce)return!1;var Ne=K.get(l);if(Ne)return Ne==f;C|=S,K.set(l,f);var Re=mp(ee(l),ee(f),C,I,L,K);return K.delete(l),Re;case _t:if(Gs)return Gs.call(l)==Gs.call(f)}return!1}function Jg(l,f,y,C,I,L){var K=y&T,ee=Fu(l),ce=ee.length,Ne=Fu(f),Re=Ne.length;if(ce!=Re&&!K)return!1;for(var Fe=ce;Fe--;){var We=ee[Fe];if(!(K?We in f:pr.call(f,We)))return!1}var ft=L.get(l),Ot=L.get(f);if(ft&&Ot)return ft==f&&Ot==l;var tr=!0;L.set(l,f),L.set(f,l);for(var Dt=K;++Fe<ce;){We=ee[Fe];var cr=l[We],gr=f[We];if(C)var Wo=K?C(gr,cr,We,f,l,L):C(cr,gr,We,l,f,L);if(!(Wo===t?cr===gr||I(cr,gr,y,C,L):Wo)){tr=!1;break}Dt||(Dt=We=="constructor")}if(tr&&!Dt){var Ys=l.constructor,Vo=f.constructor;Ys!=Vo&&"constructor"in l&&"constructor"in f&&!(typeof Ys=="function"&&Ys instanceof Ys&&typeof Vo=="function"&&Vo instanceof Vo)&&(tr=!1)}return L.delete(l),L.delete(f),tr}function yi(l){return qs(vf(l,t,wf),l+"")}function Fu(l){return Kd(l,ts,Mo)}function ju(l){return Kd(l,wo,Xg)}var hf=$d?function(l){return $d.get(l)}:ox;function Ec(l){for(var f=l.name+"",y=ac[f],C=pr.call(ac,f)?y.length:0;C--;){var I=y[C],L=I.func;if(L==null||L==l)return I.name}return f}function Gi(l){var f=pr.call(D,"placeholder")?D:l;return f.placeholder}function Rt(){var l=D.iteratee||nx;return l=l===nx?mc:l,arguments.length?l(arguments[0],arguments[1]):l}function Ou(l,f){var y=l.__data__;return Sc(f)?y[typeof f=="string"?"string":"hash"]:y.map}function Du(l){for(var f=ts(l),y=f.length;y--;){var C=f[y],I=l[C];f[y]=[C,I,$u(I)]}return f}function Ea(l,f){var y=Zl(l,f);return Kh(y)?y:t}function pf(l){var f=pr.call(l,rl),y=l[rl];try{l[rl]=t;var C=!0}catch{}var I=fu.call(l);return C&&(f?l[rl]=y:delete l[rl]),I}var Mo=Dd?function(l){return l==null?[]:(l=Ar(l),ua(Dd(l),function(f){return jd.call(l,f)}))}:ix,Xg=Dd?function(l){for(var f=[];l;)da(f,Mo(l)),l=Oo(l);return f}:ix,zn=$n;(vu&&zn(new vu(new ArrayBuffer(1)))!=dt||sl&&zn(new sl)!=Ae||yu&&zn(yu.resolve())!=sr||pa&&zn(new pa)!=Kt||xu&&zn(new xu)!=$e)&&(zn=function(l){var f=$n(l),y=f==yt?l.constructor:t,C=y?Sa(y):"";if(C)switch(C){case Hh:return dt;case ma:return Ae;case Ag:return sr;case lc:return Kt;case ai:return $e}return f});function vp(l,f,y){for(var C=-1,I=y.length;++C<I;){var L=y[C],K=L.size;switch(L.type){case"drop":l+=K;break;case"dropRight":f-=K;break;case"take":f=Kn(f,l+K);break;case"takeRight":l=gn(l,f-K);break}}return{start:l,end:f}}function Qg(l){var f=l.match(wr);return f?f[1].split(en):[]}function yp(l,f,y){f=gi(f,l);for(var C=-1,I=f.length,L=!1;++C<I;){var K=zo(f[C]);if(!(L=l!=null&&y(l,K)))break;l=l[K]}return L||++C!=I?L:(I=l==null?0:l.length,!!I&&yv(I)&&Qr(K,I)&&(Vt(l)||qu(l)))}function Lu(l){var f=l.length,y=new l.constructor(f);return f&&typeof l[0]=="string"&&pr.call(l,"index")&&(y.index=l.index,y.input=l.input),y}function Hn(l){return typeof l.constructor=="function"&&!Wi(l)?cc(Oo(l)):{}}function P0(l,f,y){var C=l.constructor;switch(f){case it:return Au(l);case ye:case de:return new C(+l);case dt:return Hg(l,y);case Ut:case Or:case Ke:case Pt:case Lt:case et:case er:case zr:case kr:return Wg(l,y);case Ae:return new C;case ct:case Kr:return new C(l);case Zt:return Bg(l);case Kt:return new C;case _t:return Gg(l)}}function F0(l,f){var y=f.length;if(!y)return l;var C=y-1;return f[C]=(y>1?"& ":"")+f[C],f=f.join(y>2?", ":" "),l.replace(Tt,`{
/* [wrapped with `+f+`] */
`)}function mf(l){return Vt(l)||qu(l)||!!(Ng&&l&&l[Ng])}function Qr(l,f){var y=typeof l;return f=f??B,!!f&&(y=="number"||y!="symbol"&&Z.test(l))&&l>-1&&l%1==0&&l<f}function ds(l,f,y){if(!hn(y))return!1;var C=typeof f;return(C=="number"?xo(y)&&Qr(f,y.length):C=="string"&&f in y)?qi(y[f],l):!1}function rt(l,f){if(Vt(l))return!1;var y=typeof l;return y=="number"||y=="symbol"||y=="boolean"||l==null||Go(l)?!0:Ue.test(l)||!ve.test(l)||f!=null&&l in Ar(f)}function Sc(l){var f=typeof l;return f=="string"||f=="number"||f=="symbol"||f=="boolean"?l!=="__proto__":l===null}function Mu(l){var f=Ec(l),y=D[f];if(typeof y!="function"||!(f in Wt.prototype))return!1;if(l===y)return!0;var C=hf(y);return!!C&&l===C[0]}function Zg(l){return!!Id&&Id in l}var j0=rc?_l:ax;function Wi(l){var f=l&&l.constructor,y=typeof f=="function"&&f.prototype||ii;return l===y}function $u(l){return l===l&&!hn(l)}function gf(l,f){return function(y){return y==null?!1:y[l]===f&&(f!==t||l in Ar(y))}}function ev(l){var f=he(l,function(C){return y.size===m&&y.clear(),C}),y=f.cache;return f}function tv(l,f){var y=l[1],C=f[1],I=y|C,L=I<(N|R|M),K=C==M&&y==j||C==M&&y==V&&l[7].length<=f[8]||C==(M|V)&&f[7].length<=f[8]&&y==j;if(!(L||K))return l;C&N&&(l[2]=f[2],I|=y&N?0:A);var ee=f[3];if(ee){var ce=l[3];l[3]=ce?Vg(ce,ee,f[4]):ee,l[4]=ce?io(l[3],g):f[4]}return ee=f[5],ee&&(ce=l[5],l[5]=ce?ap(ce,ee,f[6]):ee,l[6]=ce?io(l[5],g):f[6]),ee=f[7],ee&&(l[7]=ee),C&M&&(l[8]=l[8]==null?f[8]:Kn(l[8],f[8])),l[9]==null&&(l[9]=f[9]),l[0]=f[0],l[1]=I,l}function rv(l){var f=[];if(l!=null)for(var y in Ar(l))f.push(y);return f}function xp(l){return fu.call(l)}function vf(l,f,y){return f=gn(f===t?l.length-1:f,0),function(){for(var C=arguments,I=-1,L=gn(C.length-f,0),K=me(L);++I<L;)K[I]=C[f+I];I=-1;for(var ee=me(f+1);++I<f;)ee[I]=C[I];return ee[f]=y(K),as(l,this,ee)}}function Rn(l,f){return f.length<2?l:Mi(l,es(f,0,-1))}function $o(l,f){for(var y=l.length,C=Kn(f.length,y),I=cs(l);C--;){var L=f[C];l[C]=Qr(L,y)?I[L]:t}return l}function xi(l,f){if(!(f==="constructor"&&typeof l[f]=="function")&&f!="__proto__")return l[f]}var wp=Uo(ef),Cc=Uh||function(l,f){return Jr.setTimeout(l,f)},qs=Uo(mi);function bp(l,f,y){var C=f+"";return qs(l,F0(C,nv(Qg(C),y)))}function Uo(l){var f=0,y=0;return function(){var C=R0(),I=we-(C-y);if(y=C,I>0){if(++f>=ae)return arguments[0]}else f=0;return l.apply(t,arguments)}}function yf(l,f){var y=-1,C=l.length,I=C-1;for(f=f===t?C:f;++y<f;){var L=gc(y,I),K=l[L];l[L]=l[y],l[y]=K}return l.length=f,l}var _p=ev(function(l){var f=[];return l.charCodeAt(0)===46&&f.push(""),l.replace(ht,function(y,C,I,L){f.push(I?L.replace(ss,"$1"):C||y)}),f});function zo(l){if(typeof l=="string"||Go(l))return l;var f=l+"";return f=="0"&&1/l==-te?"-0":f}function Sa(l){if(l!=null){try{return du.call(l)}catch{}try{return l+""}catch{}}return""}function nv(l,f){return qn(Ee,function(y){var C="_."+y[0];f&y[1]&&!Cd(l,C)&&l.push(C)}),l.sort()}function sv(l){if(l instanceof Wt)return l.clone();var f=new Yn(l.__wrapped__,l.__chain__);return f.__actions__=cs(l.__actions__),f.__index__=l.__index__,f.__values__=l.__values__,f}function xf(l,f,y){(y?ds(l,f,y):f===t)?f=1:f=gn(Jt(f),0);var C=l==null?0:l.length;if(!C||f<1)return[];for(var I=0,L=0,K=me(nl(C/f));I<C;)K[L++]=es(l,I,I+=f);return K}function Ep(l){for(var f=-1,y=l==null?0:l.length,C=0,I=[];++f<y;){var L=l[f];L&&(I[C++]=L)}return I}function vo(){var l=arguments.length;if(!l)return[];for(var f=me(l-1),y=arguments[0],C=l;C--;)f[C-1]=arguments[C];return da(Vt(y)?cs(y):[y],ln(f,1))}var mr=Yt(function(l,f){return En(l)?fi(l,ln(f,1,En,!0)):[]}),An=Yt(function(l,f){var y=fs(f);return En(y)&&(y=t),En(l)?fi(l,ln(f,1,En,!0),Rt(y,2)):[]}),vn=Yt(function(l,f){var y=fs(f);return En(y)&&(y=t),En(l)?fi(l,ln(f,1,En,!0),t,y):[]});function Bn(l,f,y){var C=l==null?0:l.length;return C?(f=y||f===t?1:Jt(f),es(l,f<0?0:f,C)):[]}function Ks(l,f,y){var C=l==null?0:l.length;return C?(f=y||f===t?1:Jt(f),f=C-f,es(l,0,f<0?0:f)):[]}function kc(l,f){return l&&l.length?Tu(l,Rt(f,3),!0,!0):[]}function _n(l,f){return l&&l.length?Tu(l,Rt(f,3),!0):[]}function Uu(l,f,y,C){var I=l==null?0:l.length;return I?(y&&typeof y!="number"&&ds(l,f,y)&&(y=0,C=I),Mg(l,f,y,C)):[]}function Ca(l,f,y){var C=l==null?0:l.length;if(!C)return-1;var I=y==null?0:Jt(y);return I<0&&(I=gn(C+I,0)),kd(l,Rt(f,3),I)}function zu(l,f,y){var C=l==null?0:l.length;if(!C)return-1;var I=C-1;return y!==t&&(I=Jt(y),I=y<0?gn(C+I,0):Kn(I,C-1)),kd(l,Rt(f,3),I,!0)}function wf(l){var f=l==null?0:l.length;return f?ln(l,1):[]}function Hu(l){var f=l==null?0:l.length;return f?ln(l,te):[]}function Ts(l,f){var y=l==null?0:l.length;return y?(f=f===t?1:Jt(f),ln(l,f)):[]}function Sp(l){for(var f=-1,y=l==null?0:l.length,C={};++f<y;){var I=l[f];C[I[0]]=I[1]}return C}function gl(l){return l&&l.length?l[0]:t}function Vi(l,f,y){var C=l==null?0:l.length;if(!C)return-1;var I=y==null?0:Jt(y);return I<0&&(I=gn(C+I,0)),Ql(l,f,I)}function bf(l){var f=l==null?0:l.length;return f?es(l,0,-1):[]}var Cp=Yt(function(l){var f=Lr(l,xc);return f.length&&f[0]===l[0]?Yd(f):[]}),ka=Yt(function(l){var f=fs(l),y=Lr(l,xc);return f===fs(y)?f=t:y.pop(),y.length&&y[0]===l[0]?Yd(y,Rt(f,2)):[]}),_f=Yt(function(l){var f=fs(l),y=Lr(l,xc);return f=typeof f=="function"?f:t,f&&y.pop(),y.length&&y[0]===l[0]?Yd(y,t,f):[]});function Na(l,f){return l==null?"":Ld.call(l,f)}function fs(l){var f=l==null?0:l.length;return f?l[f-1]:t}function Bu(l,f,y){var C=l==null?0:l.length;if(!C)return-1;var I=C;return y!==t&&(I=Jt(y),I=I<0?gn(C+I,0):Kn(I,C-1)),f===f?C0(l,f,I):kd(l,hg,I,!0)}function kp(l,f){return l&&l.length?Zd(l,Jt(f)):t}var Ef=Yt(Gu);function Gu(l,f){return l&&l.length&&f&&f.length?dn(l,f):l}function hs(l,f,y){return l&&l.length&&f&&f.length?dn(l,f,Rt(y,2)):l}function Ta(l,f,y){return l&&l.length&&f&&f.length?dn(l,f,t,y):l}var Ho=yi(function(l,f){var y=l==null?0:l.length,C=Vd(l,f);return bn(l,Lr(f,function(I){return Qr(I,y)?+I:I}).sort(ip)),C});function Rs(l,f){var y=[];if(!(l&&l.length))return y;var C=-1,I=[],L=l.length;for(f=Rt(f,3);++C<L;){var K=l[C];f(K,C,l)&&(y.push(K),I.push(C))}return bn(l,I),y}function Sf(l){return l==null?l:Md.call(l)}function Np(l,f,y){var C=l==null?0:l.length;return C?(y&&typeof y!="number"&&ds(l,f,y)?(f=0,y=C):(f=f==null?0:Jt(f),y=y===t?C:Jt(y)),es(l,f,y)):[]}function Tp(l,f){return vc(l,f)}function O0(l,f,y){return tf(l,f,Rt(y,2))}function Ra(l,f){var y=l==null?0:l.length;if(y){var C=vc(l,f);if(C<y&&qi(l[C],f))return C}return-1}function ov(l,f){return vc(l,f,!0)}function Rp(l,f,y){return tf(l,f,Rt(y,2),!0)}function vl(l,f){var y=l==null?0:l.length;if(y){var C=vc(l,f,!0)-1;if(qi(l[C],f))return C}return-1}function Ap(l){return l&&l.length?tp(l):[]}function yl(l,f){return l&&l.length?tp(l,Rt(f,2)):[]}function iv(l){var f=l==null?0:l.length;return f?es(l,1,f):[]}function av(l,f,y){return l&&l.length?(f=y||f===t?1:Jt(f),es(l,0,f<0?0:f)):[]}function Ip(l,f,y){var C=l==null?0:l.length;return C?(f=y||f===t?1:Jt(f),f=C-f,es(l,f<0?0:f,C)):[]}function Cf(l,f){return l&&l.length?Tu(l,Rt(f,3),!1,!0):[]}function D0(l,f){return l&&l.length?Tu(l,Rt(f,3)):[]}var L0=Yt(function(l){return Hi(ln(l,1,En,!0))}),lv=Yt(function(l){var f=fs(l);return En(f)&&(f=t),Hi(ln(l,1,En,!0),Rt(f,2))}),cv=Yt(function(l){var f=fs(l);return f=typeof f=="function"?f:t,Hi(ln(l,1,En,!0),t,f)});function xl(l){return l&&l.length?Hi(l):[]}function M0(l,f){return l&&l.length?Hi(l,Rt(f,2)):[]}function Nc(l,f){return f=typeof f=="function"?f:t,l&&l.length?Hi(l,t,f):[]}function kf(l){if(!(l&&l.length))return[];var f=0;return l=ua(l,function(y){if(En(y))return f=gn(y.length,f),!0}),Oh(f,function(y){return Lr(l,Fh(y))})}function rn(l,f){if(!(l&&l.length))return[];var y=kf(l);return f==null?y:Lr(y,function(C){return as(f,t,C)})}var $0=Yt(function(l,f){return En(l)?fi(l,f):[]}),uv=Yt(function(l){return nf(ua(l,En))}),U0=Yt(function(l){var f=fs(l);return En(f)&&(f=t),nf(ua(l,En),Rt(f,2))}),z0=Yt(function(l){var f=fs(l);return f=typeof f=="function"?f:t,nf(ua(l,En),t,f)}),dv=Yt(kf);function fv(l,f){return Ru(l||[],f||[],ll)}function H0(l,f){return Ru(l||[],f||[],hl)}var yo=Yt(function(l){var f=l.length,y=f>1?l[f-1]:t;return y=typeof y=="function"?(l.pop(),y):t,rn(l,y)});function Nf(l){var f=D(l);return f.__chain__=!0,f}function B0(l,f){return f(l),l}function Bo(l,f){return f(l)}var Tf=yi(function(l){var f=l.length,y=f?l[0]:0,C=this.__wrapped__,I=function(L){return Vd(L,l)};return f>1||this.__actions__.length||!(C instanceof Wt)||!Qr(y)?this.thru(I):(C=C.slice(y,+y+(f?1:0)),C.__actions__.push({func:Bo,args:[I],thisArg:t}),new Yn(C,this.__chain__).thru(function(L){return f&&!L.length&&L.push(t),L}))});function wl(){return Nf(this)}function Rf(){return new Yn(this.value(),this.__chain__)}function Pp(){this.__values__===t&&(this.__values__=qE(this.value()));var l=this.__index__>=this.__values__.length,f=l?t:this.__values__[this.__index__++];return{done:l,value:f}}function Fp(){return this}function G0(l){for(var f,y=this;y instanceof li;){var C=sv(y);C.__index__=0,C.__values__=t,f?I.__wrapped__=C:f=C;var I=C;y=y.__wrapped__}return I.__wrapped__=l,f}function jp(){var l=this.__wrapped__;if(l instanceof Wt){var f=l;return this.__actions__.length&&(f=new Wt(this)),f=f.reverse(),f.__actions__.push({func:Bo,args:[Sf],thisArg:t}),new Yn(f,this.__chain__)}return this.thru(Sf)}function W0(){return yc(this.__wrapped__,this.__actions__)}var hv=af(function(l,f,y){pr.call(l,y)?++l[y]:di(l,y,1)});function pv(l,f,y){var C=Vt(l)?Th:_u;return y&&ds(l,f,y)&&(f=t),C(l,Rt(f,3))}function Af(l,f){var y=Vt(l)?ua:Vh;return y(l,Rt(f,3))}var If=ml(Ca),mv=ml(zu);function Op(l,f){return ln(bl(l,f),1)}function V0(l,f){return ln(bl(l,f),te)}function gv(l,f,y){return y=y===t?1:Jt(y),ln(bl(l,f),y)}function Pf(l,f){var y=Vt(l)?qn:hi;return y(l,Rt(f,3))}function Wu(l,f){var y=Vt(l)?Sd:Lg;return y(l,Rt(f,3))}var Dp=af(function(l,f,y){pr.call(l,y)?l[y].push(f):di(l,y,[f])});function Ff(l,f,y,C){l=xo(l)?l:Df(l),y=y&&!C?Jt(y):0;var I=l.length;return y<0&&(y=gn(I+y,0)),xv(l)?y<=I&&l.indexOf(f,y)>-1:!!I&&Ql(l,f,y)>-1}var vv=Yt(function(l,f,y){var C=-1,I=typeof f=="function",L=xo(l)?me(l.length):[];return hi(l,function(K){L[++C]=I?as(f,K,y):ho(K,f,y)}),L}),q0=af(function(l,f,y){di(l,y,f)});function bl(l,f){var y=Vt(l)?Lr:Jh;return y(l,Rt(f,3))}function K0(l,f,y,C){return l==null?[]:(Vt(f)||(f=f==null?[]:[f]),y=C?t:y,Vt(y)||(y=y==null?[]:[y]),ku(l,f,y))}var Vu=af(function(l,f,y){l[y?0:1].push(f)},function(){return[[],[]]});function Y0(l,f,y){var C=Vt(l)?Ah:mg,I=arguments.length<3;return C(l,Rt(f,4),y,I,hi)}function jf(l,f,y){var C=Vt(l)?v0:mg,I=arguments.length<3;return C(l,Rt(f,4),y,I,Lg)}function o(l,f){var y=Vt(l)?ua:Vh;return y(l,De(Rt(f,3)))}function a(l){var f=Vt(l)?ui:Zn;return f(l)}function h(l,f,y){(y?ds(l,f,y):f===t)?f=1:f=Jt(f);var C=Vt(l)?al:Zh;return C(l,f)}function v(l){var f=Vt(l)?Og:mo;return f(l)}function _(l){if(l==null)return 0;if(xo(l))return xv(l)?tl(l):l.length;var f=zn(l);return f==Ae||f==Kt?l.size:zi(l).length}function k(l,f,y){var C=Vt(l)?Ih:ep;return y&&ds(l,f,y)&&(f=t),C(l,Rt(f,3))}var F=Yt(function(l,f){if(l==null)return[];var y=f.length;return y>1&&ds(l,f[0],f[1])?f=[]:y>2&&ds(f[0],f[1],f[2])&&(f=[f[0]]),ku(l,ln(f,1),[])}),G=Gr||function(){return Jr.Date.now()};function Q(l,f){if(typeof f!="function")throw new ao(c);return l=Jt(l),function(){if(--l<1)return f.apply(this,arguments)}}function ge(l,f,y){return f=y?t:f,f=l&&f==null?l.length:f,vi(l,M,t,t,t,t,f)}function Pe(l,f){var y;if(typeof f!="function")throw new ao(c);return l=Jt(l),function(){return--l>0&&(y=f.apply(this,arguments)),l<=1&&(f=t),y}}var je=Yt(function(l,f,y){var C=N;if(y.length){var I=io(y,Gi(je));C|=$}return vi(l,C,f,y,I)}),Ie=Yt(function(l,f,y){var C=N|R;if(y.length){var I=io(y,Gi(Ie));C|=$}return vi(f,C,l,y,I)});function Je(l,f,y){f=y?t:f;var C=vi(l,j,t,t,t,t,t,f);return C.placeholder=Je.placeholder,C}function nt(l,f,y){f=y?t:f;var C=vi(l,P,t,t,t,t,t,f);return C.placeholder=nt.placeholder,C}function ot(l,f,y){var C,I,L,K,ee,ce,Ne=0,Re=!1,Fe=!1,We=!0;if(typeof l!="function")throw new ao(c);f=wi(f)||0,hn(y)&&(Re=!!y.leading,Fe="maxWait"in y,L=Fe?gn(wi(y.maxWait)||0,f):L,We="trailing"in y?!!y.trailing:We);function ft(Sn){var Ki=C,Sl=I;return C=I=t,Ne=Sn,K=l.apply(Sl,Ki),K}function Ot(Sn){return Ne=Sn,ee=Cc(cr,f),Re?ft(Sn):K}function tr(Sn){var Ki=Sn-ce,Sl=Sn-Ne,iS=f-Ki;return Fe?Kn(iS,L-Sl):iS}function Dt(Sn){var Ki=Sn-ce,Sl=Sn-Ne;return ce===t||Ki>=f||Ki<0||Fe&&Sl>=L}function cr(){var Sn=G();if(Dt(Sn))return gr(Sn);ee=Cc(cr,tr(Sn))}function gr(Sn){return ee=t,We&&C?ft(Sn):(C=I=t,K)}function Wo(){ee!==t&&sp(ee),Ne=0,C=ce=I=ee=t}function Ys(){return ee===t?K:gr(G())}function Vo(){var Sn=G(),Ki=Dt(Sn);if(C=arguments,I=this,ce=Sn,Ki){if(ee===t)return Ot(ce);if(Fe)return sp(ee),ee=Cc(cr,f),ft(ce)}return ee===t&&(ee=Cc(cr,f)),K}return Vo.cancel=Wo,Vo.flush=Ys,Vo}var fn=Yt(function(l,f){return Wh(l,1,f)}),fe=Yt(function(l,f,y){return Wh(l,wi(f)||0,y)});function re(l){return vi(l,X)}function he(l,f){if(typeof l!="function"||f!=null&&typeof f!="function")throw new ao(c);var y=function(){var C=arguments,I=f?f.apply(this,C):C[0],L=y.cache;if(L.has(I))return L.get(I);var K=l.apply(this,C);return y.cache=L.set(I,K)||L,K};return y.cache=new(he.Cache||lo),y}he.Cache=lo;function De(l){if(typeof l!="function")throw new ao(c);return function(){var f=arguments;switch(f.length){case 0:return!l.call(this);case 1:return!l.call(this,f[0]);case 2:return!l.call(this,f[0],f[1]);case 3:return!l.call(this,f[0],f[1],f[2])}return!l.apply(this,f)}}function lt(l){return Pe(2,l)}var St=zg(function(l,f){f=f.length==1&&Vt(f[0])?Lr(f[0],Hs(Rt())):Lr(ln(f,1),Hs(Rt()));var y=f.length;return Yt(function(C){for(var I=-1,L=Kn(C.length,y);++I<L;)C[I]=f[I].call(this,C[I]);return as(l,this,C)})}),vt=Yt(function(l,f){var y=io(f,Gi(vt));return vi(l,$,t,f,y)}),jt=Yt(function(l,f){var y=io(f,Gi(jt));return vi(l,W,t,f,y)}),In=yi(function(l,f){return vi(l,V,t,t,t,f)});function xr(l,f){if(typeof l!="function")throw new ao(c);return f=f===t?f:Jt(f),Yt(l,f)}function Aa(l,f){if(typeof l!="function")throw new ao(c);return f=f==null?0:gn(Jt(f),0),Yt(function(y){var C=y[f],I=Bi(y,0,f);return C&&da(I,C),as(l,this,I)})}function J0(l,f,y){var C=!0,I=!0;if(typeof l!="function")throw new ao(c);return hn(y)&&(C="leading"in y?!!y.leading:C,I="trailing"in y?!!y.trailing:I),ot(l,f,{leading:C,maxWait:f,trailing:I})}function uF(l){return ge(l,1)}function dF(l,f){return vt(sf(f),l)}function fF(){if(!arguments.length)return[];var l=arguments[0];return Vt(l)?l:[l]}function hF(l){return ks(l,E)}function pF(l,f){return f=typeof f=="function"?f:t,ks(l,E,f)}function mF(l){return ks(l,x|E)}function gF(l,f){return f=typeof f=="function"?f:t,ks(l,x|E,f)}function vF(l,f){return f==null||bu(l,f,ts(f))}function qi(l,f){return l===f||l!==l&&f!==f}var yF=ff(wa),xF=ff(function(l,f){return l>=f}),qu=Jd((function(){return arguments})())?Jd:function(l){return yn(l)&&pr.call(l,"callee")&&!jd.call(l,"callee")},Vt=me.isArray,wF=kh?Hs(kh):$g;function xo(l){return l!=null&&yv(l.length)&&!_l(l)}function En(l){return yn(l)&&xo(l)}function bF(l){return l===!0||l===!1||yn(l)&&$n(l)==ye}var Tc=zh||ax,_F=_s?Hs(_s):Ui;function EF(l){return yn(l)&&l.nodeType===1&&!Lp(l)}function SF(l){if(l==null)return!0;if(xo(l)&&(Vt(l)||typeof l=="string"||typeof l.splice=="function"||Tc(l)||Of(l)||qu(l)))return!l.length;var f=zn(l);if(f==Ae||f==Kt)return!l.size;if(Wi(l))return!zi(l).length;for(var y in l)if(pr.call(l,y))return!1;return!0}function CF(l,f){return po(l,f)}function kF(l,f,y){y=typeof y=="function"?y:t;var C=y?y(l,f):t;return C===t?po(l,f,t,y):!!C}function X0(l){if(!yn(l))return!1;var f=$n(l);return f==Be||f==Te||typeof l.message=="string"&&typeof l.name=="string"&&!Lp(l)}function NF(l){return typeof l=="number"&&sc(l)}function _l(l){if(!hn(l))return!1;var f=$n(l);return f==Ge||f==Me||f==xe||f==Gt}function BE(l){return typeof l=="number"&&l==Jt(l)}function yv(l){return typeof l=="number"&&l>-1&&l%1==0&&l<=B}function hn(l){var f=typeof l;return l!=null&&(f=="object"||f=="function")}function yn(l){return l!=null&&typeof l=="object"}var GE=el?Hs(el):Ug;function TF(l,f){return l===f||pc(l,f,Du(f))}function RF(l,f,y){return y=typeof y=="function"?y:t,pc(l,f,Du(f),y)}function AF(l){return WE(l)&&l!=+l}function IF(l){if(j0(l))throw new Mt(i);return Kh(l)}function PF(l){return l===null}function FF(l){return l==null}function WE(l){return typeof l=="number"||yn(l)&&$n(l)==ct}function Lp(l){if(!yn(l)||$n(l)!=yt)return!1;var f=Oo(l);if(f===null)return!0;var y=pr.call(f,"constructor")&&f.constructor;return typeof y=="function"&&y instanceof y&&du.call(y)==Pd}var Q0=Ed?Hs(Ed):Su;function jF(l){return BE(l)&&l>=-B&&l<=B}var VE=Xl?Hs(Xl):pi;function xv(l){return typeof l=="string"||!Vt(l)&&yn(l)&&$n(l)==Kr}function Go(l){return typeof l=="symbol"||yn(l)&&$n(l)==_t}var Of=ug?Hs(ug):Cu;function OF(l){return l===t}function DF(l){return yn(l)&&zn(l)==$e}function LF(l){return yn(l)&&$n(l)==Nt}var MF=ff(ba),$F=ff(function(l,f){return l<=f});function qE(l){if(!l)return[];if(xo(l))return xv(l)?Bs(l):cs(l);if(Oi&&l[Oi])return E0(l[Oi]());var f=zn(l),y=f==Ae?Td:f==Kt?fa:Df;return y(l)}function El(l){if(!l)return l===0?l:0;if(l=wi(l),l===te||l===-te){var f=l<0?-1:1;return f*z}return l===l?l:0}function Jt(l){var f=El(l),y=f%1;return f===f?y?f-y:f:0}function KE(l){return l?Li(Jt(l),0,O):0}function wi(l){if(typeof l=="number")return l;if(Go(l))return Y;if(hn(l)){var f=typeof l.valueOf=="function"?l.valueOf():l;l=hn(f)?f+"":f}if(typeof l!="string")return l===0?l:+l;l=gg(l);var y=ca.test(l);return y||at.test(l)?bd(l.slice(2),y?2:8):la.test(l)?Y:+l}function YE(l){return Lo(l,wo(l))}function UF(l){return l?Li(Jt(l),-B,B):l===0?l:0}function Ir(l){return l==null?"":Ns(l)}var zF=wc(function(l,f){if(Wi(f)||xo(f)){Lo(f,ts(f),l);return}for(var y in f)pr.call(f,y)&&ll(l,y,f[y])}),JE=wc(function(l,f){Lo(f,wo(f),l)}),wv=wc(function(l,f,y,C){Lo(f,wo(f),l,C)}),HF=wc(function(l,f,y,C){Lo(f,ts(f),l,C)}),BF=yi(Vd);function GF(l,f){var y=cc(l);return f==null?y:Vr(y,f)}var WF=Yt(function(l,f){l=Ar(l);var y=-1,C=f.length,I=C>2?f[2]:t;for(I&&ds(f[0],f[1],I)&&(C=1);++y<C;)for(var L=f[y],K=wo(L),ee=-1,ce=K.length;++ee<ce;){var Ne=K[ee],Re=l[Ne];(Re===t||qi(Re,ii[Ne])&&!pr.call(l,Ne))&&(l[Ne]=L[Ne])}return l}),VF=Yt(function(l){return l.push(t,hp),as(XE,t,l)});function qF(l,f){return fg(l,Rt(f,3),Vs)}function KF(l,f){return fg(l,Rt(f,3),xa)}function YF(l,f){return l==null?l:qd(l,Rt(f,3),wo)}function JF(l,f){return l==null?l:Eu(l,Rt(f,3),wo)}function XF(l,f){return l&&Vs(l,Rt(f,3))}function QF(l,f){return l&&xa(l,Rt(f,3))}function ZF(l){return l==null?[]:hc(l,ts(l))}function ej(l){return l==null?[]:hc(l,wo(l))}function Z0(l,f,y){var C=l==null?t:Mi(l,f);return C===t?y:C}function tj(l,f){return l!=null&&yp(l,f,fo)}function ex(l,f){return l!=null&&yp(l,f,ul)}var rj=qg(function(l,f,y){f!=null&&typeof f.toString!="function"&&(f=fu.call(f)),l[f]=y},rx(bo)),nj=qg(function(l,f,y){f!=null&&typeof f.toString!="function"&&(f=fu.call(f)),pr.call(l,f)?l[f].push(y):l[f]=[y]},Rt),sj=Yt(ho);function ts(l){return xo(l)?ci(l):zi(l)}function wo(l){return xo(l)?ci(l,!0):Yh(l)}function oj(l,f){var y={};return f=Rt(f,3),Vs(l,function(C,I,L){di(y,f(C,I,L),C)}),y}function ij(l,f){var y={};return f=Rt(f,3),Vs(l,function(C,I,L){di(y,I,f(C,I,L))}),y}var aj=wc(function(l,f,y){dl(l,f,y)}),XE=wc(function(l,f,y,C){dl(l,f,y,C)}),lj=yi(function(l,f){var y={};if(l==null)return y;var C=!1;f=Lr(f,function(L){return L=gi(L,l),C||(C=L.length>1),L}),Lo(l,ju(l),y),C&&(y=ks(y,x|b|E,pp));for(var I=f.length;I--;)rf(y,f[I]);return y});function cj(l,f){return QE(l,De(Rt(f)))}var uj=yi(function(l,f){return l==null?{}:Qh(l,f)});function QE(l,f){if(l==null)return{};var y=Lr(ju(l),function(C){return[C]});return f=Rt(f),_a(l,y,function(C,I){return f(C,I[0])})}function dj(l,f,y){f=gi(f,l);var C=-1,I=f.length;for(I||(I=1,l=t);++C<I;){var L=l==null?t:l[zo(f[C])];L===t&&(C=I,L=y),l=_l(L)?L.call(l):L}return l}function fj(l,f,y){return l==null?l:hl(l,f,y)}function hj(l,f,y,C){return C=typeof C=="function"?C:t,l==null?l:hl(l,f,y,C)}var ZE=dp(ts),eS=dp(wo);function pj(l,f,y){var C=Vt(l),I=C||Tc(l)||Of(l);if(f=Rt(f,4),y==null){var L=l&&l.constructor;I?y=C?new L:[]:hn(l)?y=_l(L)?cc(Oo(l)):{}:y={}}return(I?qn:Vs)(l,function(K,ee,ce){return f(y,K,ee,ce)}),y}function mj(l,f){return l==null?!0:rf(l,f)}function gj(l,f,y){return l==null?l:np(l,f,sf(y))}function vj(l,f,y,C){return C=typeof C=="function"?C:t,l==null?l:np(l,f,sf(y),C)}function Df(l){return l==null?[]:cu(l,ts(l))}function yj(l){return l==null?[]:cu(l,wo(l))}function xj(l,f,y){return y===t&&(y=f,f=t),y!==t&&(y=wi(y),y=y===y?y:0),f!==t&&(f=wi(f),f=f===f?f:0),Li(wi(l),f,y)}function wj(l,f,y){return f=El(f),y===t?(y=f,f=0):y=El(y),l=wi(l),qh(l,f,y)}function bj(l,f,y){if(y&&typeof y!="boolean"&&ds(l,f,y)&&(f=y=t),y===t&&(typeof f=="boolean"?(y=f,f=t):typeof l=="boolean"&&(y=l,l=t)),l===t&&f===t?(l=0,f=1):(l=El(l),f===t?(f=l,l=0):f=El(f)),l>f){var C=l;l=f,f=C}if(y||l%1||f%1){var I=gu();return Kn(l+I*(f-l+Sh("1e-"+((I+"").length-1))),f)}return gc(l,f)}var _j=pl(function(l,f,y){return f=f.toLowerCase(),l+(y?tS(f):f)});function tS(l){return tx(Ir(l).toLowerCase())}function rS(l){return l=Ir(l),l&&l.replace(Oe,xg).replace(Ft,"")}function Ej(l,f,y){l=Ir(l),f=Ns(f);var C=l.length;y=y===t?C:Li(Jt(y),0,C);var I=y;return y-=f.length,y>=0&&l.slice(y,I)==f}function Sj(l){return l=Ir(l),l&&To.test(l)?l.replace(xs,wg):l}function Cj(l){return l=Ir(l),l&&zt.test(l)?l.replace(It,"\\$&"):l}var kj=pl(function(l,f,y){return l+(y?"-":"")+f.toLowerCase()}),Nj=pl(function(l,f,y){return l+(y?" ":"")+f.toLowerCase()}),Tj=lp("toLowerCase");function Rj(l,f,y){l=Ir(l),f=Jt(f);var C=f?tl(l):0;if(!f||C>=f)return l;var I=(f-C)/2;return Pu(ha(I),y)+l+Pu(nl(I),y)}function Aj(l,f,y){l=Ir(l),f=Jt(f);var C=f?tl(l):0;return f&&C<f?l+Pu(f-C,y):l}function Ij(l,f,y){l=Ir(l),f=Jt(f);var C=f?tl(l):0;return f&&C<f?Pu(f-C,y)+l:l}function Pj(l,f,y){return y||f==null?f=0:f&&(f=+f),Rg(Ir(l).replace(lr,""),f||0)}function Fj(l,f,y){return(y?ds(l,f,y):f===t)?f=1:f=Jt(f),fl(Ir(l),f)}function jj(){var l=arguments,f=Ir(l[0]);return l.length<3?f:f.replace(l[1],l[2])}var Oj=pl(function(l,f,y){return l+(y?"_":"")+f.toLowerCase()});function Dj(l,f,y){return y&&typeof y!="number"&&ds(l,f,y)&&(f=y=t),y=y===t?O:y>>>0,y?(l=Ir(l),l&&(typeof f=="string"||f!=null&&!Q0(f))&&(f=Ns(f),!f&&ec(l))?Bi(Bs(l),0,y):l.split(f,y)):[]}var Lj=pl(function(l,f,y){return l+(y?" ":"")+tx(f)});function Mj(l,f,y){return l=Ir(l),y=y==null?0:Li(Jt(y),0,l.length),f=Ns(f),l.slice(y,y+f.length)==f}function $j(l,f,y){var C=D.templateSettings;y&&ds(l,f,y)&&(f=t),l=Ir(l),f=wv({},f,C,fp);var I=wv({},f.imports,C.imports,fp),L=ts(I),K=cu(I,L),ee,ce,Ne=0,Re=f.interpolate||Ze,Fe="__p += '",We=uu((f.escape||Ze).source+"|"+Re.source+"|"+(Re===Dn?zs:Ze).source+"|"+(f.evaluate||Ze).source+"|$","g"),ft="//# sourceURL="+(pr.call(f,"sourceURL")?(f.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++xd+"]")+`
`;l.replace(We,function(Dt,cr,gr,Wo,Ys,Vo){return gr||(gr=Wo),Fe+=l.slice(Ne,Vo).replace(Tr,bg),cr&&(ee=!0,Fe+=`' +
__e(`+cr+`) +
'`),Ys&&(ce=!0,Fe+=`';
`+Ys+`;
__p += '`),gr&&(Fe+=`' +
((__t = (`+gr+`)) == null ? '' : __t) +
'`),Ne=Vo+Dt.length,Dt}),Fe+=`';
`;var Ot=pr.call(f,"variable")&&f.variable;if(!Ot)Fe=`with (obj) {
`+Fe+`
}
`;else if(aa.test(Ot))throw new Mt(d);Fe=(ce?Fe.replace(wn,""):Fe).replace(Dr,"$1").replace(Yr,"$1;"),Fe="function("+(Ot||"obj")+`) {
`+(Ot?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(ee?", __e = _.escape":"")+(ce?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+Fe+`return __p
}`;var tr=sS(function(){return yr(L,ft+"return "+Fe).apply(t,K)});if(tr.source=Fe,X0(tr))throw tr;return tr}function Uj(l){return Ir(l).toLowerCase()}function zj(l){return Ir(l).toUpperCase()}function Hj(l,f,y){if(l=Ir(l),l&&(y||f===t))return gg(l);if(!l||!(f=Ns(f)))return l;var C=Bs(l),I=Bs(f),L=vg(C,I),K=Dh(C,I)+1;return Bi(C,L,K).join("")}function Bj(l,f,y){if(l=Ir(l),l&&(y||f===t))return l.slice(0,Ad(l)+1);if(!l||!(f=Ns(f)))return l;var C=Bs(l),I=Dh(C,Bs(f))+1;return Bi(C,0,I).join("")}function Gj(l,f,y){if(l=Ir(l),l&&(y||f===t))return l.replace(lr,"");if(!l||!(f=Ns(f)))return l;var C=Bs(l),I=vg(C,Bs(f));return Bi(C,I).join("")}function Wj(l,f){var y=ie,C=J;if(hn(f)){var I="separator"in f?f.separator:I;y="length"in f?Jt(f.length):y,C="omission"in f?Ns(f.omission):C}l=Ir(l);var L=l.length;if(ec(l)){var K=Bs(l);L=K.length}if(y>=L)return l;var ee=y-tl(C);if(ee<1)return C;var ce=K?Bi(K,0,ee).join(""):l.slice(0,ee);if(I===t)return ce+C;if(K&&(ee+=ce.length-ee),Q0(I)){if(l.slice(ee).search(I)){var Ne,Re=ce;for(I.global||(I=uu(I.source,Ir(Ii.exec(I))+"g")),I.lastIndex=0;Ne=I.exec(Re);)var Fe=Ne.index;ce=ce.slice(0,Fe===t?ee:Fe)}}else if(l.indexOf(Ns(I),ee)!=ee){var We=ce.lastIndexOf(I);We>-1&&(ce=ce.slice(0,We))}return ce+C}function Vj(l){return l=Ir(l),l&&Us.test(l)?l.replace(Nn,_g):l}var qj=pl(function(l,f,y){return l+(y?" ":"")+f.toUpperCase()}),tx=lp("toUpperCase");function nS(l,f,y){return l=Ir(l),f=y?t:f,f===t?_0(l)?k0(l):x0(l):l.match(f)||[]}var sS=Yt(function(l,f){try{return as(l,t,f)}catch(y){return X0(y)?y:new Mt(y)}}),Kj=yi(function(l,f){return qn(f,function(y){y=zo(y),di(l,y,je(l[y],l))}),l});function Yj(l){var f=l==null?0:l.length,y=Rt();return l=f?Lr(l,function(C){if(typeof C[1]!="function")throw new ao(c);return[y(C[0]),C[1]]}):[],Yt(function(C){for(var I=-1;++I<f;){var L=l[I];if(as(L[0],this,C))return as(L[1],this,C)}})}function Jj(l){return Dg(ks(l,x))}function rx(l){return function(){return l}}function Xj(l,f){return l==null||l!==l?f:l}var Qj=uf(),Zj=uf(!0);function bo(l){return l}function nx(l){return mc(typeof l=="function"?l:ks(l,x))}function eO(l){return Qd(ks(l,x))}function tO(l,f){return Xr(l,ks(f,x))}var rO=Yt(function(l,f){return function(y){return ho(y,l,f)}}),nO=Yt(function(l,f){return function(y){return ho(l,y,f)}});function sx(l,f,y){var C=ts(f),I=hc(f,C);y==null&&!(hn(f)&&(I.length||!C.length))&&(y=f,f=l,l=this,I=hc(f,ts(f)));var L=!(hn(y)&&"chain"in y)||!!y.chain,K=_l(l);return qn(I,function(ee){var ce=f[ee];l[ee]=ce,K&&(l.prototype[ee]=function(){var Ne=this.__chain__;if(L||Ne){var Re=l(this.__wrapped__),Fe=Re.__actions__=cs(this.__actions__);return Fe.push({func:ce,args:arguments,thisArg:l}),Re.__chain__=Ne,Re}return ce.apply(l,da([this.value()],arguments))})}),l}function sO(){return Jr._===this&&(Jr._=Cg),this}function ox(){}function oO(l){return l=Jt(l),Yt(function(f){return Zd(f,l)})}var iO=df(Lr),aO=df(Th),lO=df(Ih);function oS(l){return rt(l)?Fh(zo(l)):tn(l)}function cO(l){return function(f){return l==null?t:Mi(l,f)}}var uO=up(),dO=up(!0);function ix(){return[]}function ax(){return!1}function fO(){return{}}function hO(){return""}function pO(){return!0}function mO(l,f){if(l=Jt(l),l<1||l>B)return[];var y=O,C=Kn(l,O);f=Rt(f),l-=O;for(var I=Oh(C,f);++y<l;)f(y);return I}function gO(l){return Vt(l)?Lr(l,zo):Go(l)?[l]:cs(_p(Ir(l)))}function vO(l){var f=++nc;return Ir(l)+f}var yO=Iu(function(l,f){return l+f},0),xO=Un("ceil"),wO=Iu(function(l,f){return l/f},1),bO=Un("floor");function _O(l){return l&&l.length?cl(l,bo,wa):t}function EO(l,f){return l&&l.length?cl(l,Rt(f,2),wa):t}function SO(l){return pg(l,bo)}function CO(l,f){return pg(l,Rt(f,2))}function kO(l){return l&&l.length?cl(l,bo,ba):t}function NO(l,f){return l&&l.length?cl(l,Rt(f,2),ba):t}var TO=Iu(function(l,f){return l*f},1),RO=Un("round"),AO=Iu(function(l,f){return l-f},0);function IO(l){return l&&l.length?jh(l,bo):0}function PO(l,f){return l&&l.length?jh(l,Rt(f,2)):0}return D.after=Q,D.ary=ge,D.assign=zF,D.assignIn=JE,D.assignInWith=wv,D.assignWith=HF,D.at=BF,D.before=Pe,D.bind=je,D.bindAll=Kj,D.bindKey=Ie,D.castArray=fF,D.chain=Nf,D.chunk=xf,D.compact=Ep,D.concat=vo,D.cond=Yj,D.conforms=Jj,D.constant=rx,D.countBy=hv,D.create=GF,D.curry=Je,D.curryRight=nt,D.debounce=ot,D.defaults=WF,D.defaultsDeep=VF,D.defer=fn,D.delay=fe,D.difference=mr,D.differenceBy=An,D.differenceWith=vn,D.drop=Bn,D.dropRight=Ks,D.dropRightWhile=kc,D.dropWhile=_n,D.fill=Uu,D.filter=Af,D.flatMap=Op,D.flatMapDeep=V0,D.flatMapDepth=gv,D.flatten=wf,D.flattenDeep=Hu,D.flattenDepth=Ts,D.flip=re,D.flow=Qj,D.flowRight=Zj,D.fromPairs=Sp,D.functions=ZF,D.functionsIn=ej,D.groupBy=Dp,D.initial=bf,D.intersection=Cp,D.intersectionBy=ka,D.intersectionWith=_f,D.invert=rj,D.invertBy=nj,D.invokeMap=vv,D.iteratee=nx,D.keyBy=q0,D.keys=ts,D.keysIn=wo,D.map=bl,D.mapKeys=oj,D.mapValues=ij,D.matches=eO,D.matchesProperty=tO,D.memoize=he,D.merge=aj,D.mergeWith=XE,D.method=rO,D.methodOf=nO,D.mixin=sx,D.negate=De,D.nthArg=oO,D.omit=lj,D.omitBy=cj,D.once=lt,D.orderBy=K0,D.over=iO,D.overArgs=St,D.overEvery=aO,D.overSome=lO,D.partial=vt,D.partialRight=jt,D.partition=Vu,D.pick=uj,D.pickBy=QE,D.property=oS,D.propertyOf=cO,D.pull=Ef,D.pullAll=Gu,D.pullAllBy=hs,D.pullAllWith=Ta,D.pullAt=Ho,D.range=uO,D.rangeRight=dO,D.rearg=In,D.reject=o,D.remove=Rs,D.rest=xr,D.reverse=Sf,D.sampleSize=h,D.set=fj,D.setWith=hj,D.shuffle=v,D.slice=Np,D.sortBy=F,D.sortedUniq=Ap,D.sortedUniqBy=yl,D.split=Dj,D.spread=Aa,D.tail=iv,D.take=av,D.takeRight=Ip,D.takeRightWhile=Cf,D.takeWhile=D0,D.tap=B0,D.throttle=J0,D.thru=Bo,D.toArray=qE,D.toPairs=ZE,D.toPairsIn=eS,D.toPath=gO,D.toPlainObject=YE,D.transform=pj,D.unary=uF,D.union=L0,D.unionBy=lv,D.unionWith=cv,D.uniq=xl,D.uniqBy=M0,D.uniqWith=Nc,D.unset=mj,D.unzip=kf,D.unzipWith=rn,D.update=gj,D.updateWith=vj,D.values=Df,D.valuesIn=yj,D.without=$0,D.words=nS,D.wrap=dF,D.xor=uv,D.xorBy=U0,D.xorWith=z0,D.zip=dv,D.zipObject=fv,D.zipObjectDeep=H0,D.zipWith=yo,D.entries=ZE,D.entriesIn=eS,D.extend=JE,D.extendWith=wv,sx(D,D),D.add=yO,D.attempt=sS,D.camelCase=_j,D.capitalize=tS,D.ceil=xO,D.clamp=xj,D.clone=hF,D.cloneDeep=mF,D.cloneDeepWith=gF,D.cloneWith=pF,D.conformsTo=vF,D.deburr=rS,D.defaultTo=Xj,D.divide=wO,D.endsWith=Ej,D.eq=qi,D.escape=Sj,D.escapeRegExp=Cj,D.every=pv,D.find=If,D.findIndex=Ca,D.findKey=qF,D.findLast=mv,D.findLastIndex=zu,D.findLastKey=KF,D.floor=bO,D.forEach=Pf,D.forEachRight=Wu,D.forIn=YF,D.forInRight=JF,D.forOwn=XF,D.forOwnRight=QF,D.get=Z0,D.gt=yF,D.gte=xF,D.has=tj,D.hasIn=ex,D.head=gl,D.identity=bo,D.includes=Ff,D.indexOf=Vi,D.inRange=wj,D.invoke=sj,D.isArguments=qu,D.isArray=Vt,D.isArrayBuffer=wF,D.isArrayLike=xo,D.isArrayLikeObject=En,D.isBoolean=bF,D.isBuffer=Tc,D.isDate=_F,D.isElement=EF,D.isEmpty=SF,D.isEqual=CF,D.isEqualWith=kF,D.isError=X0,D.isFinite=NF,D.isFunction=_l,D.isInteger=BE,D.isLength=yv,D.isMap=GE,D.isMatch=TF,D.isMatchWith=RF,D.isNaN=AF,D.isNative=IF,D.isNil=FF,D.isNull=PF,D.isNumber=WE,D.isObject=hn,D.isObjectLike=yn,D.isPlainObject=Lp,D.isRegExp=Q0,D.isSafeInteger=jF,D.isSet=VE,D.isString=xv,D.isSymbol=Go,D.isTypedArray=Of,D.isUndefined=OF,D.isWeakMap=DF,D.isWeakSet=LF,D.join=Na,D.kebabCase=kj,D.last=fs,D.lastIndexOf=Bu,D.lowerCase=Nj,D.lowerFirst=Tj,D.lt=MF,D.lte=$F,D.max=_O,D.maxBy=EO,D.mean=SO,D.meanBy=CO,D.min=kO,D.minBy=NO,D.stubArray=ix,D.stubFalse=ax,D.stubObject=fO,D.stubString=hO,D.stubTrue=pO,D.multiply=TO,D.nth=kp,D.noConflict=sO,D.noop=ox,D.now=G,D.pad=Rj,D.padEnd=Aj,D.padStart=Ij,D.parseInt=Pj,D.random=bj,D.reduce=Y0,D.reduceRight=jf,D.repeat=Fj,D.replace=jj,D.result=dj,D.round=RO,D.runInContext=se,D.sample=a,D.size=_,D.snakeCase=Oj,D.some=k,D.sortedIndex=Tp,D.sortedIndexBy=O0,D.sortedIndexOf=Ra,D.sortedLastIndex=ov,D.sortedLastIndexBy=Rp,D.sortedLastIndexOf=vl,D.startCase=Lj,D.startsWith=Mj,D.subtract=AO,D.sum=IO,D.sumBy=PO,D.template=$j,D.times=mO,D.toFinite=El,D.toInteger=Jt,D.toLength=KE,D.toLower=Uj,D.toNumber=wi,D.toSafeInteger=UF,D.toString=Ir,D.toUpper=zj,D.trim=Hj,D.trimEnd=Bj,D.trimStart=Gj,D.truncate=Wj,D.unescape=Vj,D.uniqueId=vO,D.upperCase=qj,D.upperFirst=tx,D.each=Pf,D.eachRight=Wu,D.first=gl,sx(D,(function(){var l={};return Vs(D,function(f,y){pr.call(D.prototype,y)||(l[y]=f)}),l})(),{chain:!1}),D.VERSION=n,qn(["bind","bindKey","curry","curryRight","partial","partialRight"],function(l){D[l].placeholder=D}),qn(["drop","take"],function(l,f){Wt.prototype[l]=function(y){y=y===t?1:gn(Jt(y),0);var C=this.__filtered__&&!f?new Wt(this):this.clone();return C.__filtered__?C.__takeCount__=Kn(y,C.__takeCount__):C.__views__.push({size:Kn(y,O),type:l+(C.__dir__<0?"Right":"")}),C},Wt.prototype[l+"Right"]=function(y){return this.reverse()[l](y).reverse()}}),qn(["filter","map","takeWhile"],function(l,f){var y=f+1,C=y==ue||y==pe;Wt.prototype[l]=function(I){var L=this.clone();return L.__iteratees__.push({iteratee:Rt(I,3),type:y}),L.__filtered__=L.__filtered__||C,L}}),qn(["head","last"],function(l,f){var y="take"+(f?"Right":"");Wt.prototype[l]=function(){return this[y](1).value()[0]}}),qn(["initial","tail"],function(l,f){var y="drop"+(f?"":"Right");Wt.prototype[l]=function(){return this.__filtered__?new Wt(this):this[y](1)}}),Wt.prototype.compact=function(){return this.filter(bo)},Wt.prototype.find=function(l){return this.filter(l).head()},Wt.prototype.findLast=function(l){return this.reverse().find(l)},Wt.prototype.invokeMap=Yt(function(l,f){return typeof l=="function"?new Wt(this):this.map(function(y){return ho(y,l,f)})}),Wt.prototype.reject=function(l){return this.filter(De(Rt(l)))},Wt.prototype.slice=function(l,f){l=Jt(l);var y=this;return y.__filtered__&&(l>0||f<0)?new Wt(y):(l<0?y=y.takeRight(-l):l&&(y=y.drop(l)),f!==t&&(f=Jt(f),y=f<0?y.dropRight(-f):y.take(f-l)),y)},Wt.prototype.takeRightWhile=function(l){return this.reverse().takeWhile(l).reverse()},Wt.prototype.toArray=function(){return this.take(O)},Vs(Wt.prototype,function(l,f){var y=/^(?:filter|find|map|reject)|While$/.test(f),C=/^(?:head|last)$/.test(f),I=D[C?"take"+(f=="last"?"Right":""):f],L=C||/^find/.test(f);I&&(D.prototype[f]=function(){var K=this.__wrapped__,ee=C?[1]:arguments,ce=K instanceof Wt,Ne=ee[0],Re=ce||Vt(K),Fe=function(cr){var gr=I.apply(D,da([cr],ee));return C&&We?gr[0]:gr};Re&&y&&typeof Ne=="function"&&Ne.length!=1&&(ce=Re=!1);var We=this.__chain__,ft=!!this.__actions__.length,Ot=L&&!We,tr=ce&&!ft;if(!L&&Re){K=tr?K:new Wt(this);var Dt=l.apply(K,ee);return Dt.__actions__.push({func:Bo,args:[Fe],thisArg:t}),new Yn(Dt,We)}return Ot&&tr?l.apply(this,ee):(Dt=this.thru(Fe),Ot?C?Dt.value()[0]:Dt.value():Dt)})}),qn(["pop","push","shift","sort","splice","unshift"],function(l){var f=Fi[l],y=/^(?:push|sort|unshift)$/.test(l)?"tap":"thru",C=/^(?:pop|shift)$/.test(l);D.prototype[l]=function(){var I=arguments;if(C&&!this.__chain__){var L=this.value();return f.apply(Vt(L)?L:[],I)}return this[y](function(K){return f.apply(Vt(K)?K:[],I)})}}),Vs(Wt.prototype,function(l,f){var y=D[f];if(y){var C=y.name+"";pr.call(ac,C)||(ac[C]=[]),ac[C].push({name:f,func:y})}}),ac[_c(t,R).name]=[{name:"wrapper",func:t}],Wt.prototype.clone=zd,Wt.prototype.reverse=Bh,Wt.prototype.value=uc,D.prototype.at=Tf,D.prototype.chain=wl,D.prototype.commit=Rf,D.prototype.next=Pp,D.prototype.plant=G0,D.prototype.reverse=jp,D.prototype.toJSON=D.prototype.valueOf=D.prototype.value=W0,D.prototype.first=D.prototype.head,Oi&&(D.prototype[Oi]=Fp),D}),tc=N0();oi?((oi.exports=tc)._=tc,lu._=tc):Jr._=tc}).call(Dq)})(xm,xm.exports)),xm.exports}var My=Lq();const Hv="src/shared/components/sidepanel/panels/components/FilevineCaseInfoBox.tsx",Mq=({caseSummaryData:r,isCaseSummaryLoading:e,caseSummaryError:t,caseDetails:n,onDocumentView:s})=>{if(e)return u.jsxs("div",{className:"space-y-2",children:[u.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded animate-pulse"}),u.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded animate-pulse"}),u.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded animate-pulse"})]});if(t)return u.jsx("div",{className:"text-sm text-red-600 dark:text-red-400",children:t});if(!r)return null;const i={};return r.caseFacts&&(i["Case Facts"]=r.caseFacts),r.supioLink&&(i["Supio Link"]=r.supioLink),n.incidentDate&&(i["Incident Date"]=new Date(n.incidentDate).toLocaleDateString(void 0,{timeZone:"UTC"})),r.statuteoflimitations&&r.statuteoflimitations.dateValue&&(i["Statute of Limitations (SOL)"]=new Date(r.statuteoflimitations.dateValue).toLocaleDateString(void 0,{timeZone:"UTC"})),r.totalMeds>0&&(i["Total Meds"]=`$${r.totalMeds.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`),r.totalLiens>0&&(i["Total Liens"]=`$${r.totalLiens.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`),u.jsxs("div",{className:"space-y-3",children:[u.jsx(eu,{details:i}),r.disbursementSheet&&u.jsx("div",{className:"px-3 pb-2",children:u.jsx("table",{className:"w-full text-sm text-left text-gray-700 dark:text-gray-300",children:u.jsx("tbody",{children:u.jsxs("tr",{className:"bg-card",children:[u.jsx("td",{className:"py-4 px-3 whitespace-normal font-medium w-1/3 text-gray-800 dark:text-gray-200",children:"Disbursement Sheet"}),u.jsx("td",{className:"py-2 px-3",children:u.jsxs("button",{onClick:()=>{s&&r.disbursementSheet&&s({name:r.disbursementSheet.filename,documentId:r.disbursementSheet.documentId,url:""})},className:"text-blue-600 dark:text-blue-400 hover:underline inline-flex items-center gap-1 cursor-pointer focus:outline-none",children:[u.jsx(sh,{className:"w-3 h-3"}),r.disbursementSheet.filename]})})]})})})})]})},$q=({clientEmail:r,selectedCaseDetails:e,casesForCurrentClient:t,currentCaseIndex:n,caseDetails:s,nextCase:i,prevCase:c,isLoading:d,setCurrentCaseIndex:p,isValidating:m=!1,handleSectionClick:g,projectId:x,onDocumentView:b,onProjectManuallySelected:E,onResetToEmailProject:T,isProjectManuallySelected:S=!1})=>{const N=Ur(),[R,A]=w.useState(""),[j,P]=w.useState(!1),[$,W]=w.useState(null),[M,V]=w.useState(!1),[X,ie]=w.useState(null),[J,ae]=w.useState(""),[we,ue]=w.useState([]),[oe,pe]=w.useState(!1),[te,B]=w.useState(!1),[z,Y]=w.useState(null),O=w.useMemo(()=>{if(!R.trim())return t;const de=R.toLowerCase();return t.filter(Te=>String(Te.projectName||"").toLowerCase().includes(de))},[t,R]),U=w.useMemo(()=>My.debounce(async de=>{if(!de.trim()||de.length<2){ue([]),Y(null);return}pe(!0),Y(null);try{const Te=await qy("filevine",de,N);ue(Te.projects||[]),Te.projects.length===0&&Y(`No projects found for "${de}"`)}catch(Te){N.error("Project search failed",Te,{sourceFile:Hv}),Y("Failed to search projects. Please try again."),ue([])}finally{pe(!1)}},400),[N]),ne=de=>{var Te,Be,Ge;try{const Me={projectId:{native:((Te=de.projectId)==null?void 0:Te.native)||null,partner:((Be=de.projectId)==null?void 0:Be.partner)||null},projectName:de.projectName||"",projectTypeCode:de.projectTypeCode||"",projectTypeName:de.projectTypeName||"",phaseName:de.phaseName||"",phaseDate:de.phaseDate||"",firstPrimaryName:de.firstPrimaryName||"",firstPrimaryUsername:de.firstPrimaryUsername||"",hashtags:Array.isArray(de.hashtags)?de.hashtags.join(", "):"",projectEmailAddress:de.projectEmailAddress||"",projectUrl:de.projectUrl||"",incidentDate:de.incidentDate||""};N.info("Project manually selected via search",{projectId:(Ge=Me.projectId)==null?void 0:Ge.native,projectName:Me.projectName,sourceFile:Hv}),E&&E(Me),B(!1),ae(""),ue([]),Y(null)}catch(Me){N.error("Failed to select project",Me,{sourceFile:Hv})}},Ee=de=>{P(de),de||A("")},q=async()=>{if(!(!x||$)){V(!0),ie(null);try{const de=await n8("filevine",x,N);W(de)}catch(de){N.error("Error fetching case summary",de,{sourceFile:Hv}),ie("Failed to load case summary data")}finally{V(!1)}}};w.useEffect(()=>{W(null),ie(null)},[x]);const le=()=>u.jsx(Ls,{rows:2}),xe=()=>g?u.jsxs(ze,{variant:"ghost",className:"justify-between w-full text-sm px-0 hover:bg-transparent",onClick:()=>g("Project Documents"),children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx(sh,{className:"h-4 w-4 mr-2 text-blue-500 dark:text-blue-400"}),u.jsx("span",{className:"text-blue-500 dark:text-blue-400",children:"Project Documents"})]}),u.jsx(Mc,{src:"/icons/chevron-right.svg",width:16,height:16,alt:"Chevron right",className:"h-4 w-4"})]}):null,ye=de=>{if(p)p(de);else if(de>n)for(let Te=n;Te<de;Te++)i();else if(de<n)for(let Te=n;Te>de;Te--)c()};return u.jsxs("div",{className:"w-full min-h-[4rem] border border-border/50 rounded-lg shadow-sm bg-card text-card-foreground",title:"Case Information",children:[u.jsxs("div",{className:"flex items-center justify-between p-2 border-b bg-muted",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(YR,{className:"w-3.5 h-3.5 text-slate-600 dark:text-gray-300"}),u.jsx("span",{className:"font-medium text-sm text-slate-800 dark:text-white",children:"PROJECTS"})]}),u.jsxs("div",{className:"flex items-center gap-1",children:[S&&T&&u.jsx(ze,{variant:"ghost",size:"icon",className:"h-8 w-8",title:"Reset to email-based project",onClick:T,children:u.jsx(No,{className:"h-4 w-4"})}),u.jsxs(Ms,{open:te,onOpenChange:B,children:[u.jsx($s,{asChild:!0,children:u.jsx(ze,{variant:"ghost",size:"icon",className:"h-8 w-8",title:"Search all projects",onClick:de=>{de.stopPropagation(),B(!te)},children:u.jsx(eo,{className:"h-4 w-4"})})}),u.jsxs(vs,{align:"end",className:"w-[320px] p-0",children:[u.jsxs("div",{className:"p-3 border-b border-gray-200 dark:border-gray-700",children:[u.jsx("div",{className:"text-sm font-medium mb-2 text-gray-800 dark:text-gray-200",children:"Search All Projects"}),u.jsxs("div",{className:"relative",children:[u.jsx(eo,{className:"absolute left-2 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),u.jsx(on,{placeholder:"Search by project or client name...",value:J,onChange:de=>{const Te=de.target.value;ae(Te),U(Te)},className:"pl-8 pr-8 h-9 text-sm",autoFocus:!0,onClick:de=>de.stopPropagation(),onKeyDown:de=>de.stopPropagation()}),J&&u.jsx("button",{onClick:de=>{de.stopPropagation(),ae(""),ue([]),Y(null)},className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:u.jsx(ki,{className:"w-4 h-4"})})]})]}),u.jsx("div",{className:"max-h-[300px] overflow-y-auto",children:oe?u.jsxs("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 flex items-center gap-2",children:[u.jsx("div",{className:"w-4 h-4 border-2 border-gray-300 border-t-gray-600 rounded-full animate-spin"}),"Searching..."]}):z&&we.length===0?u.jsx("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:z}):we.length>0?we.map(de=>u.jsxs(rs,{className:"flex flex-col items-start p-3 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-800",onClick:()=>ne(de),children:[u.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-gray-100",children:de.projectName}),u.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5",children:[de.phaseName,"  Client: ",de.clientName]})]},de.projectId.native)):J.trim()&&!oe?u.jsxs("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:['No projects found for "',J,'"']}):u.jsx("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:"Type at least 2 characters to search projects..."})})]})]})]})]}),d?le():e&&Object.keys(e).length>0?u.jsxs(u.Fragment,{children:[t.length>0&&u.jsxs("div",{className:"flex items-center px-3 py-1 bg-gray-50 dark:bg-gray-800 border-b dark:border-gray-700 gap-2",children:[u.jsxs("div",{className:"flex-1 min-w-0 flex items-center",children:[t.length>1&&u.jsxs(Ms,{open:j,onOpenChange:Ee,children:[u.jsx($s,{asChild:!0,children:u.jsxs(ze,{variant:"ghost",size:"sm",className:"h-8 text-xs text-gray-600 dark:text-gray-300 flex items-center gap-1 px-2 max-w-full",children:[u.jsx("span",{className:"truncate",title:e.Title||"",children:e.Title||"Case"}),u.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400 flex-shrink-0",children:["(",n+1,"/",t.length,")"]}),u.jsx(ms,{className:"w-3 h-3 ml-1 flex-shrink-0"})]})}),u.jsxs(vs,{align:"start",className:"w-[280px] p-0",children:[u.jsxs("div",{className:"p-2 border-b border-gray-200 dark:border-gray-700",children:[u.jsxs("div",{className:"relative",children:[u.jsx(eo,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),u.jsx(on,{placeholder:"Search projects...",value:R,onChange:de=>A(de.target.value),className:"pl-8 pr-8 h-8 text-xs",autoFocus:!0,onClick:de=>de.stopPropagation(),onKeyDown:de=>de.stopPropagation()}),R&&u.jsx("button",{onClick:de=>{de.stopPropagation(),A("")},className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:u.jsx(ki,{className:"w-4 h-4"})})]}),R&&u.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:["Showing ",O.length," of ",t.length]})]}),u.jsx("div",{className:"max-h-[200px] overflow-y-auto",children:O.length>0?O.map((de,Te)=>{const Be=t.findIndex(Ge=>Ge===de);return u.jsx(rs,{className:`text-xs truncate ${Be===n?"bg-gray-100 dark:bg-gray-700 font-medium":""}`,onClick:()=>ye(Be),children:String(de.projectName||`Case ${Be+1}`)},Be)}):u.jsxs("div",{className:"p-3 text-xs text-center text-gray-500 dark:text-gray-400",children:['No projects match "',R,'"']})})]})]}),t.length===1&&u.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-300 px-2 truncate",title:e.Title||"",children:e.Title||"Case"})]}),s.projectUrl&&u.jsxs("a",{href:s.projectUrl,target:"_blank",rel:"noopener noreferrer",className:"h-8 text-xs text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 border border-blue-200 dark:border-blue-800 px-3 flex-shrink-0 rounded-md inline-flex items-center gap-1 no-underline hover:no-underline",children:[u.jsx(Ml,{className:"w-3 h-3"}),"View"]})]}),u.jsx("div",{className:"break-words overflow-hidden",children:u.jsx(eu,{details:e})}),u.jsx("div",{className:"px-3 border-t",children:xe()}),s.projectTypeCode&&s.projectTypeCode!=="IM"&&u.jsx("div",{className:"border-t",children:u.jsx(Oq,{type:"single",collapsible:!0,onValueChange:de=>{de==="view-more"&&q()},children:u.jsxs(rF,{value:"view-more",className:"border-0",children:[u.jsx(nF,{className:"px-3 py-2 hover:no-underline text-sm font-medium",children:"View More"}),u.jsx(sF,{className:"px-3 pb-2",children:u.jsx(Mq,{caseSummaryData:$,isCaseSummaryLoading:M,caseSummaryError:X,caseDetails:s,onDocumentView:b})})]})},x)})]}):m?u.jsx(Ls,{rows:2}):u.jsx("div",{className:"p-3 text-sm text-gray-600 dark:text-gray-400",children:r?u.jsx(u.Fragment,{children:u.jsx("p",{className:"mb-2",children:"Select a client email thread to view project information"})}):"Select a client email thread to view case information"})]})},ar="src/sidepanel/mainPanelContent/FilevineInsights.tsx",Uq="https://rubypowerslaw.filevineapp.com",zq=({toggleSection:r,clientEmail:e,setClientEmail:t,setProjectId:n,setDocuments:s,setIsDocumentsLoading:i,setDocumentsError:c,onDocumentView:d,tempClientEmail:p,setTempClientEmail:m,emailParticipants:g,emailParticipantClients:x,currentClientIndex:b,setCurrentClientIndex:E,currentCaseIndex:T,casesForCurrentClient:S,setCasesForCurrentClient:N,isManuallySet:R,setIsManuallySet:A,isProjectManuallySelected:j,setIsProjectManuallySelected:P,isValidClient:$,isTempEmailValid:W,nextCase:M,prevCase:V,handleSetCurrentCaseIndex:X,ClientNavigation:ie,onClientDataValidated:J,isValidating:ae,refreshTrigger:we,integrationSettings:ue})=>{const[oe,pe]=w.useState(!1),[te,B]=w.useState({}),[z,Y]=w.useState({}),[O,U]=w.useState({}),[ne,Ee]=w.useState(!1),[q,le]=w.useState(void 0),[xe,ye]=w.useState([]),[de,Te]=w.useState(!1),[Be,Ge]=w.useState(null),Me=w.useRef({}),Ae=Ur(),ct=w.useCallback(Se=>{if(!Se||!Se.client_data)return!1;const $e=Se.client_data;return $e&&typeof $e=="object"&&Object.keys($e).length>0},[]),Bt=w.useCallback(Se=>{Ae.info("selectClientDetails called",{sourceFile:ar,hasDetails:!!Se,detailsKeys:Se?Object.keys(Se):[]});const $e=it=>{const dt=it.replace(/\D/g,"");return dt.length===10?`(${dt.slice(0,3)}) ${dt.slice(3,6)}-${dt.slice(6)}`:it};Ae.debug("Client details received for formatting",{sourceFile:ar,caseNames:Se.caseNames});const Nt={Name:Se.fullName||"",Phone:$e(Se.phoneNumber||""),Address:Se.fullAddress||""};Ae.info("Client details formatted and set",{sourceFile:ar,selectedDetails:Nt,originalDetails:Se}),Y(Nt)},[Ae]),yt=w.useCallback(Se=>{Ae.info("selectCaseDetails called",{sourceFile:ar,hasDetails:!!Se,detailsKeys:Se?Object.keys(Se):[]});let $e="";if(Se.projectName){const dt=Se.projectName.match(/(\d{2}-\d{3})/);dt&&dt[1]&&($e=dt[1])}Ae.debug("Case details received for formatting",{sourceFile:ar});const it=(Se.projectTypeCode||"")==="IM"?{Title:Se.projectName||"","Internal Case ID":$e,"Assigned To":Se.firstPrimaryName||"",Phase:Se.phaseName||"",Tags:Se.hashtags||"","Filevine Email":Se.projectEmailAddress||""}:{Title:Se.projectName||"","Assigned To":Se.firstPrimaryName||"",Phase:Se.phaseName||"",Tags:Se.hashtags||"","Filevine Email":Se.projectEmailAddress||""};Ae.info("Case details formatted and set",{sourceFile:ar,selectedDetails:it,originalDetails:Se}),U(it)},[Ae]),sr=w.useCallback(async Se=>{if(Me.current[Se]){Ae.debug("Using cached client data",{sourceFile:ar,email:Se});return}try{Ae.debug("Fetching client data",{sourceFile:ar,email:Se});const $e=await X_("filevine",Se,Ae);Me.current[Se]=$e}catch($e){throw $e instanceof Error&&($e.message.includes("Client not found")||$e.message.includes("(cached)"))?Ae.debug("Client not found for email (including cached)",{sourceFile:ar,email:Se}):Ae.error(`Error fetching client data for ${Se}`,$e,{sourceFile:ar}),$e}},[Ae]),Gt=w.useCallback(async()=>{if(Ae.info("fetchClientData called",{sourceFile:ar,clientEmail:e,isFilevineConnected:oe,hasClientEmail:!!e}),!e||!oe){Ae.info("fetchClientData early return",{sourceFile:ar,reason:e?"filevine not connected":"no client email",clientEmail:e,isFilevineConnected:oe});return}try{if(Ee(!0),Ae.info("fetchClientData starting data fetch",{sourceFile:ar,clientEmail:e,isLoading:!0}),!Me.current[e])try{await sr(e)}catch(Ut){Ut instanceof Error&&Ut.message.includes("(cached)")?Ae.debug("Using cached knowledge that this client doesn't exist",{sourceFile:ar,clientEmail:e}):Ae.error("Error fetching client data",Ut,{sourceFile:ar}),B({}),N([]),Y({}),U({}),Ee(!1);return}const Se=Me.current[e];if(!Se){B({}),N([]),Y({}),U({}),Ee(!1),J(e,!1);return}const $e=ct(Se);if(J(e,$e),!$e){Ae.debug("Client data exists but is not valid",{sourceFile:ar,clientEmail:e}),B({}),N([]),Y({}),U({}),Ee(!1);return}const Nt=Se.client_data;Bt(Nt);const it=Se.case_data||[];N(it);const dt=it.length>0?Object.entries(it[0]).reduce((Ut,[Or,Ke])=>(Ut[Or]=String(Ke),Ut),{}):{};B(dt),yt(dt)}catch(Se){Ae.error("Error processing client data",Se,{sourceFile:ar}),B({}),N([]),e&&J(e,!1)}finally{Ee(!1)}},[e,oe,sr,Ae,Bt,yt,N,J,ct]);w.useEffect(()=>{Ae.info("FilevineInsights component initialized",{sourceFile:ar,clientEmail:e,emailParticipants:g.length,currentClientIndex:b,currentCaseIndex:T,casesForCurrentClient:S.length}),(async()=>{try{pe(!0)}catch($e){Ae.error("Error checking Filevine connection",$e,{sourceFile:ar}),pe(!1)}})()},[Ae,S.length,T,b,e,g.length]),w.useEffect(()=>{ae&&g.length>0&&(Me.current={},Ae.debug("Cleared component-level client data cache for refresh",{sourceFile:ar}))},[ae,g.length,Ae]),w.useEffect(()=>{const Se=async()=>{if(oe){Ae.info("Validating all email participants",{sourceFile:ar,participantCount:g.length});for(const $e of g)try{await sr($e);const Nt=Me.current[$e],it=ct(Nt);J($e,it),Ae.debug("Participant validation result",{sourceFile:ar,email:$e,hasValidData:it})}catch(Nt){Ae.debug("Participant validation failed",{sourceFile:ar,email:$e,error:Nt}),J($e,!1)}}};g.length>0&&oe&&Se()},[g,oe,sr,ct,J,Ae,we]),w.useEffect(()=>{if(j){Ae.debug("Skipping fetchClientData because project was manually selected",{sourceFile:ar,clientEmail:e,isProjectManuallySelected:j});return}e&&oe&&(Gt(),m(e),R&&!g.includes(e.toLowerCase())&&Ae.debug("Manually set email not in participants, validating separately",{sourceFile:ar,clientEmail:e}))},[e,oe,Gt,m,R,j,g,Ae]),w.useEffect(()=>{(!e||g.length===0&&!R)&&(m(null),Y({}),U({}))},[e,g.length,R,m,Y,U]),w.useEffect(()=>{var Se;if(S.length>0&&T<S.length){const $e=S[T],Nt=$e?Object.entries($e).reduce((dt,[Ut,Or])=>(dt[Ut]=String(Or),dt),{}):{};B(Nt),yt(Nt);const it=(Se=$e==null?void 0:$e.projectId)!=null&&Se.native?String($e.projectId.native):void 0;le(it),n&&it&&n(it)}},[T,S,yt,n]);const Zt=w.useCallback(async()=>{var Nt;if(!oe||S.length===0)return;const Se=S[T],$e=((Nt=Se==null?void 0:Se.projectId)==null?void 0:Nt.native)||(Se==null?void 0:Se.projectId);if(!$e){Ae.debug("No project ID found for current case",{sourceFile:ar,currentCaseIndex:T});const it="No project ID available. Cannot fetch documents.";Ge(it),c&&c(it);return}Te(!0),i&&i(!0),Ge(null),c&&c(null);try{const it=await gT(String($e),Ae);if(it){Ae.debug("Using cached documents for project",{sourceFile:ar,projectId:$e}),ye(it),s&&s(it),Te(!1),i&&i(!1);return}const Ut=(await RT("filevine",String($e),Ae)).documents.map(Or=>({name:Or.filename,url:`${Uq}/docwebviewer/view/${Or.documentId}`,documentId:Or.documentId,folderName:Or.folderName}));await mT(String($e),Ut,Ae),ye(Ut),s&&s(Ut)}catch(it){Ae.error("Error fetching documents",it,{sourceFile:ar});const dt="Failed to load documents. Please try again later.";Ge(dt),c&&c(dt)}finally{Te(!1),i&&i(!1)}},[oe,S,T,s,i,c,Ae]),Kt=Se=>{var $e;try{const Nt=(($e=Se.projectId)==null?void 0:$e.native)||Se.projectId;Ae.info("Project manually selected via search",{projectId:Nt,projectName:Se.projectName,sourceFile:ar}),B(Se),yt(Se),N([Se]),t(""),Y({}),P(!0),le(Nt),n&&Nt&&n(Nt)}catch(Nt){Ae.error("Failed to set manually selected project",Nt,{sourceFile:ar})}},Kr=()=>{try{if(Ae.info("Resetting to email-based project",{sourceFile:ar}),P(!1),x.length>0){const Se=x[0];t(Se),Ae.debug("Restored client email",{sourceFile:ar,clientEmail:Se})}}catch(Se){Ae.error("Failed to reset to email-based project",Se,{sourceFile:ar})}};if(!oe)return null;const _t=Se=>{Ae.debug(`[FilevineInfoBox] handleSectionClick called with section: "${Se}"`,{sourceFile:ar,functionName:"handleSectionClick",data:{section:Se}}),r?(Ae.debug(`[FilevineInfoBox] Calling toggleSection with section: "${Se}"`,{sourceFile:ar,functionName:"handleSectionClick",data:{section:Se}}),r(Se),Se.toLowerCase()==="project documents"?(Ae.debug('[FilevineInfoBox] Section is "project documents", calling fetchMatterDocuments',{sourceFile:ar,functionName:"handleSectionClick",data:{section:Se}}),Zt()):Ae.debug('[FilevineInfoBox] Section is not "project documents", not calling fetchMatterDocuments',{sourceFile:ar,functionName:"handleSectionClick",data:{section:Se}})):Ae.warn("[FilevineInfoBox] toggleSection is not defined. Cannot navigate.",{sourceFile:ar,functionName:"handleSectionClick",data:{section:Se}})};return u.jsxs("div",{className:"space-y-4 overflow-y-auto h-full mt-0",children:[u.jsx(gq,{clientEmail:e,emailParticipants:g,emailParticipantClients:x,currentClientIndex:b,setCurrentClientIndex:E,setClientEmail:t,isManuallySet:R,selectedClientDetails:z,isLoading:ne,ClientNavigation:ie,tempClientEmail:p,setTempClientEmail:m,setIsManuallySet:A,isValidClient:$,isTempEmailValid:W,isValidating:ae,isProjectManuallySelected:j}),u.jsx($q,{clientEmail:e,selectedCaseDetails:O,casesForCurrentClient:S,currentCaseIndex:T,caseDetails:te,nextCase:M,prevCase:V,isLoading:ne,setCurrentCaseIndex:X,isValidating:ae,handleSectionClick:_t,projectId:q,onDocumentView:d,onProjectManuallySelected:Kt,onResetToEmailProject:Kr,isProjectManuallySelected:j}),u.jsx("div",{className:"h-8"})]})},Hq=cE("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),qm=w.forwardRef(({className:r,variant:e,...t},n)=>u.jsx("div",{ref:n,role:"alert",className:Rr(Hq({variant:e}),r),...t}));qm.displayName="Alert";const Bq=w.forwardRef(({className:r,...e},t)=>u.jsx("h5",{ref:t,className:Rr("mb-1 font-medium leading-none tracking-tight",r),...e}));Bq.displayName="AlertTitle";const Km=w.forwardRef(({className:r,...e},t)=>u.jsx("div",{ref:t,className:Rr("text-sm [&_p]:leading-relaxed",r),...e}));Km.displayName="AlertDescription";const Bv="src/shared/components/sidepanel/panels/components/ClioContactCreation.tsx",m1=r=>{if(!r||r.trim()==="")return!0;if(!/^[\d\s+().-]+$/.test(r))return!1;const t=r.replace(/\D/g,"");return t.length>=7&&t.length<=15},Gq=({emailParticipants:r,emailParticipantClients:e,getClientNameFromCache:t,onContactsCreated:n})=>{const s=Ur(),[i,c]=w.useState([]),[d,p]=w.useState(!1),[m,g]=w.useState(!1),[x,b]=w.useState([]),[E,T]=w.useState({}),[S,N]=w.useState([]),[R,A]=w.useState(!1),[j,P]=w.useState(null),[$,W]=w.useState(!1),M=w.useCallback(ue=>{const oe=ue.toLowerCase();return e.some(pe=>pe.toLowerCase()===oe)},[e]);w.useEffect(()=>{const ue=r.map((oe,pe)=>{const te=M(oe);let B="";if(te){const z=t(oe);z&&(B=z)}return B||(B=oe.split("@")[0].split(".").map(Y=>Y.charAt(0).toUpperCase()+Y.slice(1).toLowerCase()).join(" ")),{id:`participant-${pe}`,name:B,email:oe,inClio:te}});c(ue),s.debug("Participants initialized with Clio status",{sourceFile:Bv,totalParticipants:ue.length,inClio:ue.filter(oe=>oe.inClio).length,notInClio:ue.filter(oe=>!oe.inClio).length})},[r,e,s,M,t]);const V=i.some(ue=>!ue.inClio),X=()=>{p(!0),g(!1);const ue={};i.forEach(oe=>{if(!oe.inClio){const pe=oe.name.split(" ");ue[oe.id]={firstName:pe[0]||"",lastName:pe.slice(1).join(" ")||"",email:oe.email,phoneNumber:"",type:"person",companyName:""}}}),T(ue)},ie=()=>{p(!1),b([]),P(null)},J=ue=>{b(oe=>oe.includes(ue)?oe.filter(pe=>pe!==ue):[...oe,ue])},ae=(ue,oe,pe)=>{T(te=>({...te,[ue]:{...te[ue],[oe]:pe}}))},we=async()=>{var ue,oe,pe;A(!0),P(null);for(const te of x){const B=E[te];if(!B){P({type:"validation",message:"Contact data is missing. Please try again."}),A(!1);return}if(B.type==="person"){if(!((ue=B.firstName)!=null&&ue.trim())||!((oe=B.lastName)!=null&&oe.trim())){P({type:"validation",message:"First and Last name is required for person contacts."}),A(!1);return}}else if(B.type==="company"&&!((pe=B.companyName)!=null&&pe.trim())){P({type:"validation",message:"Company name is required for company contacts."}),A(!1);return}if(B!=null&&B.phoneNumber&&!m1(B.phoneNumber)){P({type:"validation",message:"Invalid phone number. Please enter 7-15 digits with optional formatting (+, -, spaces, parentheses)."}),A(!1);return}}try{const te=[];for(const z of x){const Y=i.find(U=>U.id===z),O=E[z];if(!(!Y||!O))try{const U=await p8(O,s),ne=O.type==="company"?O.companyName||"":`${O.firstName||""} ${O.lastName||""}`.trim();te.push({id:U.id,name:ne||Y.name,email:Y.email}),s.info("Contact created successfully in Clio",{sourceFile:Bv,email:Y.email})}catch(U){if(s.error("Error creating contact in Clio",U,{sourceFile:Bv,email:Y.email}),U instanceof Error&&(U.message.includes("duplicate")||U.message.includes("already exists")?P({type:"duplicate",message:"A contact with this email already exists in Clio."}):U.message.includes("permission")?P({type:"permission",message:"You do not have permission to create contacts in Clio. Contact your admin."}):P({type:"network",message:"Something went wrong. Please try again."})),te.length>0){const ne=[...S,...te];N(ne),c(q=>q.map(le=>{const xe=te.find(ye=>ye.email.toLowerCase()===le.email.toLowerCase());return xe?{...le,inClio:!0,name:xe.name}:le}));const Ee=te.map(q=>{var le;return(le=i.find(xe=>xe.email.toLowerCase()===q.email.toLowerCase()))==null?void 0:le.id}).filter(Boolean);b(q=>q.filter(le=>!Ee.includes(le))),n&&n(ne)}A(!1);return}}W(!0);const B=[...S,...te];N(B),p(!1),b([]),A(!1),c(z=>z.map(Y=>{const O=te.find(U=>U.email.toLowerCase()===Y.email.toLowerCase());return O?{...Y,inClio:!0,name:O.name}:Y})),n&&n(B)}catch(te){s.error("Unexpected error in contact creation flow",te,{sourceFile:Bv}),P({type:"network",message:"Something went wrong. Please try again."}),A(!1)}};return i.length===0||!V&&S.length===0?null:u.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700",children:u.jsxs("div",{className:"p-4",children:[!$&&u.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 border border-gray-300 dark:border-gray-600 rounded-md p-4",children:[u.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:"Some email participants are not contacts in Clio."}),V&&!d&&u.jsxs("div",{className:"flex items-center gap-3 mt-3",children:[u.jsx(ze,{onClick:X,size:"sm",className:"h-9",children:"Add to Clio"}),u.jsx("button",{onClick:()=>g(!m),className:"text-sm text-blue-600 dark:text-blue-400 hover:underline",children:"How this works"})]}),m&&u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-3 leading-relaxed",children:"Create a Clio contact from email participants so Candle can show client and matter context."}),d&&u.jsxs("div",{className:"mt-4 border-t dark:border-gray-700 pt-4",children:[u.jsx("h4",{className:"text-sm font-semibold text-gray-800 dark:text-gray-200 mb-1",children:"Add contact to Clio"}),u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-4",children:"Select people on this email thread"}),j&&u.jsx("div",{role:"alert","aria-live":"assertive",className:"mb-4",children:u.jsx("div",{className:"flex items-start bg-red-50 dark:bg-red-950/30 border border-red-200 dark:border-red-800 text-red-900 dark:text-red-100 rounded-md p-3",children:u.jsxs("div",{className:"flex-1",children:[u.jsx("p",{className:"text-sm",children:j.message}),j.type==="network"&&u.jsx("div",{className:"mt-2",children:u.jsx(ze,{onClick:we,size:"sm",variant:"destructive",className:"h-7 text-xs",children:"Retry"})})]})})}),u.jsx("div",{className:"space-y-2 mb-4",children:i.map(ue=>u.jsxs("div",{className:`flex items-center gap-3 p-3 border dark:border-gray-600 rounded-md ${ue.inClio?"bg-gray-50 dark:bg-gray-800 opacity-60":"bg-white dark:bg-gray-900"}`,children:[u.jsx("input",{type:"checkbox",checked:x.includes(ue.id),onChange:()=>J(ue.id),disabled:ue.inClio,className:"h-4 w-4 text-blue-600"}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate",children:ue.name}),u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:ue.email})]}),u.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${ue.inClio?"bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-400 border border-green-300 dark:border-green-800":"bg-orange-100 dark:bg-orange-900/30 text-orange-800 dark:text-orange-400 border border-orange-300 dark:border-orange-800"}`,children:ue.inClio?"In Clio":"Not in Clio"})]},ue.id))}),x.length>0&&u.jsx("div",{className:"border-t dark:border-gray-700 pt-4 space-y-4",children:x.map(ue=>{const oe=i.find(te=>te.id===ue),pe=E[ue]||{};return oe?u.jsxs("div",{className:"space-y-3",children:[u.jsx("div",{className:"text-sm font-semibold text-gray-800 dark:text-gray-200",children:oe.name}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Contact type"}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{onClick:()=>ae(ue,"type","person"),className:`flex-1 px-3 py-2 text-sm border rounded transition-colors ${pe.type==="person"?"bg-blue-600 dark:bg-blue-700 text-white border-blue-600 dark:border-blue-700":"bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 border-gray-300 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:"Person"}),u.jsx("button",{onClick:()=>ae(ue,"type","company"),className:`flex-1 px-3 py-2 text-sm border rounded transition-colors ${pe.type==="company"?"bg-blue-600 dark:bg-blue-700 text-white border-blue-600 dark:border-blue-700":"bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 border-gray-300 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:"Company"})]})]}),pe.type==="person"?u.jsxs(u.Fragment,{children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"First name"}),u.jsx(on,{type:"text",value:pe.firstName||"",onChange:te=>ae(ue,"firstName",te.target.value),className:"h-9 text-sm"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Last name"}),u.jsx(on,{type:"text",value:pe.lastName||"",onChange:te=>ae(ue,"lastName",te.target.value),className:"h-9 text-sm"})]})]}):u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Company name"}),u.jsx(on,{type:"text",value:pe.companyName||"",onChange:te=>ae(ue,"companyName",te.target.value),className:"h-9 text-sm"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Phone number (optional)"}),u.jsx(on,{type:"tel",value:pe.phoneNumber||"",onChange:te=>ae(ue,"phoneNumber",te.target.value),placeholder:"+1 (555) 123-4567",className:"h-9 text-sm"}),pe.phoneNumber&&!m1(pe.phoneNumber)&&u.jsx("p",{className:"text-xs text-red-600 dark:text-red-400 mt-1",children:"Please enter a valid phone number (7-15 digits)"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Email"}),u.jsx(on,{type:"text",value:pe.email||"",readOnly:!0,disabled:!0,className:"h-9 text-sm"})]})]},ue):null})}),u.jsxs("div",{className:"flex gap-2 mt-4 pt-4 border-t dark:border-gray-700",children:[u.jsx(ze,{onClick:we,disabled:x.length===0||R,size:"sm",className:"h-9",children:R?"Creating...":"Create contact"}),u.jsx(ze,{onClick:ie,variant:"outline",size:"sm",className:"h-9",children:"Cancel"})]})]})]}),$&&u.jsxs("div",{className:"bg-green-50 dark:bg-green-900/30 border border-green-200 dark:border-green-700 rounded-md p-4",children:[u.jsx("h4",{className:"text-sm font-semibold text-green-900 dark:text-green-100 mb-2",children:"This contact has been added in Clio"}),u.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mb-2",children:"Clio may take a few minutes to show updates."}),u.jsx("div",{className:"space-y-2",children:S.map(ue=>u.jsxs("div",{className:"flex items-center justify-between p-2 bg-white dark:bg-gray-800 rounded-md border border-gray-200 dark:border-gray-600",children:[u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate",children:ue.name}),u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:ue.email})]}),u.jsx("span",{className:"px-2 py-1 text-xs bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-400 border border-green-300 dark:border-green-800 rounded-full",children:"In Clio"})]},ue.id))}),u.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-3",children:"Go to the Matter section below to link this contact to a matter."}),V&&u.jsx(ze,{onClick:()=>{W(!1),p(!0)},size:"sm",variant:"outline",className:"h-8 text-xs mt-3",children:"Add more contacts"})]})]})})},Wq=({clientEmail:r,emailParticipants:e,emailParticipantClients:t,currentClientIndex:n,setCurrentClientIndex:s,setClientEmail:i,isManuallySet:c,selectedClientDetails:d,linkableFields:p,isLoading:m,ClientNavigation:g,handleSectionClick:x,tempClientEmail:b,setTempClientEmail:E,setIsManuallySet:T,isValidClient:S,isTempEmailValid:N,showClientDocumentsButton:R,isValidating:A,fetchError:j=!1,hasTransientError:P=!1,onContactsCreated:$,getClientNameFromCache:W,isClientDataValidationComplete:M})=>{var we;Ur();const V=()=>u.jsx(Ls,{rows:2}),X=(we=p.find(ue=>ue.field==="Name"))==null?void 0:we.url,ie=()=>u.jsxs("div",{className:"flex items-center px-3 py-1 bg-gray-50 dark:bg-gray-800 border-b dark:border-gray-700 gap-2",children:[u.jsx("div",{className:"flex-1 min-w-0 flex items-center",children:u.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-300 truncate",title:b||"",children:[b," (Manually set)"]})}),X&&u.jsxs("a",{href:X,target:"_blank",rel:"noopener noreferrer",className:"h-8 text-xs text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 border border-blue-200 dark:border-blue-800 px-3 flex-shrink-0 rounded-md inline-flex items-center gap-1 no-underline hover:no-underline",children:[u.jsx(Ml,{className:"w-3 h-3"}),"View"]})]}),J=()=>u.jsx(eu,{details:d}),ae=()=>{let ue="Select a client email thread to view client information";return c&&r?ue=`No client information found for ${r}`:e.length>0&&(t.length===0?ue=`No client information available for emails on the selected thread: ${e.join(", ")}`:ue="No client information available for the selected email ID"),u.jsx("div",{className:"p-3 text-sm text-gray-600 dark:text-gray-400",children:u.jsx("p",{className:"mb-2",children:ue})})};return u.jsxs("div",{className:"w-full min-h-[4rem] border border-border/50 rounded-lg shadow-sm bg-card text-card-foreground",title:"Client Information",children:[u.jsxs("div",{className:"flex items-center justify-between p-2 border-b bg-muted",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(ky,{className:"w-3.5 h-3.5 text-slate-600 dark:text-gray-300"}),u.jsx("span",{className:"font-medium text-sm text-slate-800 dark:text-white",children:"CONTACT"})]}),u.jsxs(Ms,{children:[u.jsx($s,{asChild:!0,children:u.jsx(ze,{variant:"ghost",size:"icon",className:"h-6 w-6 hidden",children:u.jsx(eo,{className:"h-4 w-4"})})}),u.jsx(vs,{align:"end",className:"p-2",children:u.jsx("div",{className:"flex flex-col gap-2 w-64",children:u.jsxs("div",{className:"flex gap-2 items-center",children:[u.jsx(on,{type:"email",value:b||"",onChange:ue=>E(ue.target.value),placeholder:"Set client email",className:`flex-1 px-2 py-1 h-8 text-xs ${N===!1?"border-red-300 focus:ring-red-500":""}`}),u.jsx(ze,{variant:"outline",size:"sm",className:`h-8 text-xs px-2 ${N===!1?"bg-red-50 hover:bg-red-100":""}`,onClick:()=>{i(b||""),T(!0)},disabled:!b,title:N===!1?"Warning: This email is not recognized as a valid client in Clio":"Set email as current client",children:"Search"})]})})})]})]}),m?V():j?u.jsxs(qm,{variant:"destructive",className:"m-2",children:[u.jsx(Bm,{className:"h-4 w-4"}),u.jsx(Km,{className:"ml-2",children:"Failed to fetch contact data. Please refresh to try again."})]}):u.jsxs(u.Fragment,{children:[t.length>0&&!c&&u.jsx(g,{clientUrl:X}),c&&r&&u.jsx(ie,{}),d&&Object.keys(d).length>0?u.jsx(J,{}):A&&!c?u.jsx(Ls,{rows:2}):P&&!c?u.jsx("div",{className:"flex justify-center p-2",children:u.jsxs(qm,{variant:"default",className:"w-full border-amber-200 bg-amber-50 dark:border-amber-800 dark:bg-amber-950",children:[u.jsx(Bm,{className:"h-4 w-4 text-amber-600 dark:text-amber-400"}),u.jsx(Km,{className:"ml-2 text-amber-800 dark:text-amber-200",children:"Request timed out. Please try again later."})]})}):u.jsx(ae,{})]}),M&&!c&&e.length!==t.length&&W&&u.jsx(Gq,{emailParticipants:e,emailParticipantClients:t,getClientNameFromCache:W,onContactsCreated:$})]})},Gv="src/shared/components/sidepanel/panels/components/ClioMatterLinking.tsx",yw=({createdContacts:r,onMatterLinked:e})=>{const t=Ur(),[n,s]=w.useState(!1),[i,c]=w.useState(""),[d,p]=w.useState(!1),[m,g]=w.useState(null),[x,b]=w.useState([]),[E,T]=w.useState([]),[S,N]=w.useState({}),[R,A]=w.useState(!1),[j,P]=w.useState(null),[$,W]=w.useState(null),[M,V]=w.useState(!1),X=()=>{s(!0),P(null),T(r.map(oe=>oe.id))},ie=()=>{s(!1),c(""),p(!1),g(null),P(null),N({})},J=async oe=>{if(c(oe),p(!0),!oe){g(null),b([]);return}if(oe.length<3){b([]);return}V(!0);try{const te=((await qy("clio",oe,t)).projects||[]).map(B=>{var z;return{id:String(((z=B.projectId)==null?void 0:z.native)||""),name:B.projectName||"",status:B.isArchived?"closed":"open",description:B.projectName||""}});b(te)}catch(pe){t.error("Error searching matters",pe,{sourceFile:Gv,searchQuery:oe})}finally{V(!1)}},ae=oe=>{g(oe),c(oe.name),p(!1)},we=oe=>{T(pe=>pe.includes(oe)?pe.filter(te=>te!==oe):[...pe,oe])},ue=async()=>{if(m){A(!0),P(null);try{const oe=[];for(const pe of E){const te=S[pe]||"Related Contact";try{await m8("clio",pe,m.id,te,t),oe.push(pe),t.info("Contact linked to matter successfully",{sourceFile:Gv})}catch(B){t.error("Error linking contact to matter",B,{sourceFile:Gv}),B instanceof Error&&(B.message.includes("permission")?P({type:"permission",message:"You do not have permission to modify matters in Clio. Contact your admin."}):P({type:"network",message:"Something went wrong. Please try again."})),oe.length>0&&(T(z=>z.filter(Y=>!oe.includes(Y))),e&&e(m.id)),A(!1);return}}W(m),s(!1),A(!1),e&&e(m.id)}catch(oe){t.error("Unexpected error in matter linking flow",oe,{sourceFile:Gv}),P({type:"network",message:"Something went wrong. Please try again."}),A(!1)}}};return u.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700",children:u.jsxs("div",{className:"p-2",children:[!n&&!$&&u.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 border border-gray-300 dark:border-gray-600 rounded-md p-4",children:[u.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:"Link the created contact(s) to a matter as related contacts."}),u.jsx(ze,{onClick:X,size:"sm",className:"h-9",children:"Add to a matter"})]}),n&&u.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 border border-gray-300 dark:border-gray-600 rounded-md p-4",children:[u.jsx("h4",{className:"text-sm font-semibold text-gray-800 dark:text-gray-200 mb-1",children:"Link matter as a related contact"}),u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-4",children:"Add as a related contact in Clio"}),j&&u.jsx("div",{role:"alert","aria-live":"assertive",className:"mb-4",children:u.jsx("div",{className:"flex items-start bg-red-50 dark:bg-red-950/30 border border-red-200 dark:border-red-800 text-red-900 dark:text-red-100 rounded-md p-3",children:u.jsxs("div",{className:"flex-1",children:[u.jsx("p",{className:"text-sm",children:j.message}),j.type==="network"&&u.jsx("div",{className:"mt-2",children:u.jsx(ze,{onClick:ue,size:"sm",variant:"destructive",className:"h-7 text-xs",children:"Retry"})})]})})}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Matter"}),u.jsx(on,{type:"text",placeholder:"Search matters...",value:i,onChange:oe=>J(oe.target.value),onFocus:()=>p(!0),className:"h-9 text-sm"}),d&&i&&x.length>0&&u.jsx("div",{className:"mt-1 max-h-48 overflow-y-auto border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 shadow-lg",children:x.map(oe=>u.jsxs("div",{onClick:()=>ae(oe),className:"flex items-center justify-between p-3 hover:bg-gray-50 dark:hover:bg-gray-700 cursor-pointer border-b dark:border-gray-600 last:border-b-0",children:[u.jsx("div",{className:"text-sm text-gray-900 dark:text-gray-100 flex-1 truncate",children:oe.name}),u.jsx("span",{className:`ml-2 px-2 py-1 text-xs rounded-full ${oe.status==="open"?"bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-400 border border-blue-300 dark:border-blue-800":"bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-300 border border-gray-300 dark:border-gray-700"}`,children:oe.status==="open"?"Open":"Closed"})]},oe.id))}),M&&u.jsx("div",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400",children:"Searching matters..."})]}),m&&u.jsx(u.Fragment,{children:u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Related contact(s) to add"}),r.map(oe=>u.jsxs("div",{className:"mb-4",children:[u.jsxs("div",{className:"flex items-center gap-3 p-3 border dark:border-gray-600 rounded-md bg-white dark:bg-gray-800",children:[u.jsx("input",{type:"checkbox",checked:E.includes(oe.id),onChange:()=>we(oe.id),className:"h-4 w-4 text-blue-600"}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate",children:oe.name}),u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:oe.email})]})]}),E.includes(oe.id)&&u.jsxs("div",{className:"mt-2",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Relationship"}),u.jsx(on,{type:"text",placeholder:"e.g., Opposing Counsel, Co-Counsel, Employee",value:S[oe.id]||"",onChange:pe=>N(te=>({...te,[oe.id]:pe.target.value})),className:"h-9 text-sm"})]})]},oe.id))]})}),u.jsxs("div",{className:"flex gap-2 pt-4 border-t dark:border-gray-700",children:[u.jsx(ze,{onClick:ue,disabled:!m||E.length===0||R,size:"sm",className:"h-9",children:R?"Saving...":"Save"}),u.jsx(ze,{onClick:ie,variant:"outline",size:"sm",className:"h-9",children:"Back"})]})]}),$&&!n&&u.jsxs("div",{className:"bg-green-50 dark:bg-green-900/30 border border-green-200 dark:border-green-700 rounded-md p-4",children:[u.jsx("h4",{className:"text-sm font-semibold text-green-900 dark:text-green-100 mb-3",children:"Added to matter"}),u.jsx("div",{className:"mb-3 p-3 bg-white dark:bg-gray-800 rounded-md border border-gray-200 dark:border-gray-600",children:u.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:$.name})}),u.jsx("div",{className:"space-y-2 mb-3",children:r.filter(oe=>E.includes(oe.id)).map(oe=>u.jsxs("div",{className:"flex items-center justify-between p-2 bg-white dark:bg-gray-800 rounded-md border border-gray-200 dark:border-gray-600",children:[u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate",children:oe.name}),u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:S[oe.id]||"Related contact"})]}),u.jsxs("a",{href:`https://app.clio.com/nc#/contacts/${oe.id}`,target:"_blank",rel:"noopener noreferrer",className:"h-7 text-xs text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 border border-blue-200 dark:border-blue-800 px-2 flex-shrink-0 rounded-md inline-flex items-center gap-1 no-underline hover:no-underline ml-2",children:[u.jsx(Ml,{className:"w-3 h-3"}),"View"]})]},oe.id))}),u.jsx("div",{className:"flex gap-2",children:u.jsx(ze,{onClick:()=>{W(null),s(!0),g(null),c(""),N({})},variant:"outline",size:"sm",className:"h-9 whitespace-nowrap",children:"Link another matter"})})]})]})})},Il="src/shared/components/sidepanel/panels/components/ClioCaseInfoBox.tsx",Vq=({clientEmail:r,selectedCaseDetails:e,casesForCurrentClient:t,currentCaseIndex:n,linkableFields:s,nextCase:i,prevCase:c,isLoading:d,isManuallySet:p,setCurrentCaseIndex:m,calendarEntries:g=[],isValidating:x=!1,caseUrl:b,matterId:E,onMatterManuallySelected:T,fetchError:S=!1,hasTransientError:N=!1,userData:R,createdContacts:A=[],onMatterLinked:j,pageSize:P=5,currentPage:$=1,totalMatters:W,onNavigateToPage:M,allMatterSummaries:V=[],isLoadingMatterDetails:X=!1,matterDetailError:ie=!1})=>{var Po,Fo;const J=Ur(),ae=fd(),[we,ue]=w.useState(!1),[oe,pe]=w.useState(!1),[te,B]=w.useState(!1),[z,Y]=w.useState(!1),[O,U]=w.useState(""),[ne,Ee]=w.useState(!1),q=w.useRef(!1),[le,xe]=w.useState(""),[ye,de]=w.useState([]),[Te,Be]=w.useState(!1),[Ge,Me]=w.useState(!1),[Ae,ct]=w.useState(null),[Bt,yt]=w.useState(null),sr=w.useMemo(()=>{if(V.length>0&&E){const be=V.findIndex(Le=>Le.id===E);if(be!==-1)return be+1}return($-1)*P+n+1},[V,E,$,P,n]),[Gt,Zt]=w.useState(!1),[Kt,Kr]=w.useState(""),[_t,Se]=w.useState(""),[$e,Nt]=w.useState(new Date().toISOString().split("T")[0]),[it,dt]=w.useState("Normal"),[Ut,Or]=w.useState(!1),[Ke,Pt]=w.useState(!1),[Lt,et]=w.useState(!1),er=w.useRef(!1),zr=w.useRef(null),kr=w.useRef(!1),[wn,Dr]=w.useState(null),[Yr,Nn]=w.useState(null),[xs,Us]=w.useState(!0),[To,Ai]=w.useState(!1),[Nr,Dn]=w.useState(""),[ve,Ue]=w.useState([]),[ht,It]=w.useState(!1),[zt,lr]=w.useState(!1),[mt,Tt]=w.useState(null),[wr,en]=w.useState(""),[Ro,aa]=w.useState(""),[ss,zs]=w.useState(!1),[Ii,la]=w.useState(1),[ca,qa]=w.useState("Days"),[at]=w.useState("Email"),[Z,Oe]=w.useState(!1),[Ze,Tr]=w.useState(!0),[Ht,Hr]=w.useState(!0),[un,ws]=w.useState(!0),[os,ti]=w.useState(!1),[Br,ri]=w.useState(""),[Ln,md]=w.useState(""),[Mn,tu]=w.useState(new Date().toISOString().split("T")[0]),[ru,ql]=w.useState(!1),[so,Ao]=w.useState(null),oo=()=>{Kr(""),Se(""),Nt(new Date().toISOString().split("T")[0]),dt("Normal"),en((R==null?void 0:R.id)||""),aa((R==null?void 0:R.name)||""),Dn(""),Ue([]),Tt(null),zs(!1),la(1),qa("Days"),er.current=!1,Dr(null),Us(!0),Tr(!0),Hr(!0)},ni=()=>{ri(""),md(""),tu(new Date().toISOString().split("T")[0]),Ao(null)};w.useEffect(()=>{Nn(null)},[E]),w.useEffect(()=>{if(!wn)return;const be=setTimeout(()=>Dr(null),5e3);return()=>clearTimeout(be)},[wn]),w.useEffect(()=>{if(!so)return;const be=setTimeout(()=>Ao(null),5e3);return()=>clearTimeout(be)},[so]),w.useEffect(()=>{const be=!!(wr&&(R!=null&&R.id)&&wr!==R.id);ws(!be)},[wr,R]),w.useEffect(()=>{A&&A.length>0?Ai(!0):Ai(!1)},[A]),w.useEffect(()=>{E||(oo(),Zt(!1)),Gt||(er.current=!1)},[Gt,E]),w.useEffect(()=>{Gt&&R&&!wr&&(en(R.id),aa(R.name))},[Gt,R,wr]);const gd=w.useMemo(()=>My.debounce(async be=>{if(!be.trim()||be.length<2){Ue([]),Tt(null);return}It(!0),Tt(null);try{const Le=await wT(J),He=be.toLowerCase();if(Le){const Et=Le.filter(Ft=>Ft.name.toLowerCase().includes(He)).sort((Ft,gt)=>{const tt=Ft.name.toLowerCase().startsWith(He),st=gt.name.toLowerCase().startsWith(He);return tt!==st?tt?-1:1:Ft.name.localeCompare(gt.name)});Ue(Et),Et.length===0&&Tt(`No users found for "${be}"`)}else{kr.current||(kr.current=!0,IT("clio",J).then(Ft=>xT(Ft.map(({id:gt,name:tt})=>({id:gt,name:tt})),J)).catch(Ft=>J.error("Failed to refresh firm users cache",Ft,{sourceFile:Il})).finally(()=>{kr.current=!1}));const Et=await c8("clio",be,J);Ue((Et.users||[]).map(({id:Ft,name:gt})=>({id:Ft,name:gt}))),(Et.users||[]).length===0&&Tt(`No users found for "${be}"`)}}catch(Le){J.error("Assignee search failed",Le,{sourceFile:Il}),Tt("Failed to search users. Please try again."),Ue([])}finally{It(!1)}},400),[J]);w.useEffect(()=>{const be=async Le=>{if(!Le){oo(),Zt(!1);return}if(Le.threadId!=zr.current){oo(),Zt(!1),zr.current=String(Le.threadId),Nn(null);return}};return ae&&(ae.onThreadChanged(be),ae.getCurrentThread().then(Le=>{be(Le)}).catch(Le=>{J.error("Error getting initial thread",Le,{sourceFile:"ClioCaseInfoBox.tsx"})})),()=>{ae==null||ae.removeThreadListener(be)}},[ae,J]),w.useEffect(()=>{(async()=>{var Le;if(Gt&&!er.current){er.current=!0,Or(!0);try{const He=await ae.getCurrentThread();if(He&&((Le=He==null?void 0:He.messages)==null?void 0:Le.length)>0){const Et=He.messages[He.messages.length-1].subject,Ft=He.messages[He.messages.length-1].body,gt="Subject: "+Et+`
Body: `+Ft,tt=await d8("clio",gt,J);Kr(tt.name),Se(tt.description)}}catch(He){J.error("Failed to generate task description",He,{sourceFile:Il})}finally{Or(!1)}}})()},[Gt,ae,J]);const Eh=async()=>{var He;Dr(null);const be=[];if(Kt.trim()||be.push("Task Name"),_t.trim()||be.push("Task Description"),E||be.push("Matter"),wr||be.push("Assign To"),(!$e||!/^\d{4}-\d{2}-\d{2}$/.test($e)||Number.isNaN(Date.parse($e)))&&be.push("Date"),be.length>0){Dr({type:"error",text:`Please fill in the following fields: ${be.join(", ")}`});return}Pt(!0);try{const Et=$e?new Date($e).toISOString():null;let Ft=_t;if(xs){const st=await ae.getCurrentThread();if(!st||((He=st==null?void 0:st.messages)==null?void 0:He.length)<1){Dr({type:"error",text:"Something went wrong. Please try again"});return}const Tn=st.messages[st.messages.length-1].body;Ft=_t+`

Referenced Email Below

`+Tn}await f8("clio",Kt,Ft,E,Et,it,J,wr||void 0,ss?{value:Ii,unit:ca,method:at,assigneeId:wr||void 0}:void 0,un?void 0:{notifyAssignee:Ze,notifyCompletion:Ht}),oo(),Zt(!1),Dr({type:"success",text:"Task created successfully!"}),Nn({name:Kt,description:_t,due_at:$e,priority:it})}catch(Et){J.error("Failed to create task",Et,{sourceFile:Il}),Dr({type:"error",text:"Failed to create task. Please try again."})}finally{Pt(!1)}},Kl=async()=>{ql(!0),Ao(null);const be=[];if(Br.trim()||be.push("Subject"),Ln.trim()||be.push("Note"),E||be.push("Matter"),(!Mn||!/^\d{4}-\d{2}-\d{2}$/.test(Mn)||Number.isNaN(Date.parse(Mn)))&&be.push("Date"),be.length>0){Ao({type:"error",text:`Please fill in: ${be.join(", ")}`}),ql(!1);return}try{const He=await h8("clio",Br,Ln,Mn,E,null,J);J.info("Note created successfully",{sourceFile:Il,noteId:He.noteId}),ni(),ti(!1),Ao({type:"success",text:"Note created successfully!"})}catch(He){J.error("Error creating note",He,{sourceFile:Il}),Ao({type:"error",text:He instanceof Error?He.message:"Failed to create note"})}finally{ql(!1)}};w.useMemo(()=>{if(!O.trim())return t;const be=O.toLowerCase();return t.filter(Le=>String(Le.description||"").toLowerCase().includes(be))},[t,O]);const nu=be=>{if(Ee(be),q.current){be&&(q.current=!1);return}const Le=Bt||E;if(be&&V.length>0&&Le){const He=V.findIndex(Et=>Et.id===Le);if(He!==-1){const Et=Math.floor(He/P)+1;Et!==$&&M&&M(Et)}}be||U("")},Ka=w.useMemo(()=>My.debounce(async be=>{if(!be.trim()||be.length<2){de([]),ct(null);return}Be(!0),ct(null);try{const Le=await qy("clio",be,J);de(Le.projects||[]),Le.projects.length===0&&ct(`No matters found for "${be}"`)}catch(Le){J.error("Matter search failed",Le,{sourceFile:Il}),ct("Failed to search matters. Please try again."),de([])}finally{Be(!1)}},400),[J]),Ya=be=>{var Le,He;try{const Et={id:((He=(Le=be.projectId)==null?void 0:Le.native)==null?void 0:He.toString())||"",description:be.projectName||"",practice_area:be.projectTypeName||"",matter_stage:be.phaseName||"",status:be.isArchived?"Closed":"Open",client_name:be.clientName||"",responsible_attorney:be.firstPrimaryName||"",url:be.projectUrl||"",name:be.projectName||""};J.info("Matter manually selected via search",{matterId:Et.id,matterName:Et.description,sourceFile:Il}),T&&T(Et),Me(!1),xe(""),de([]),ct(null)}catch(Et){J.error("Failed to select matter",Et,{sourceFile:Il})}},vd=()=>u.jsx(Ls,{rows:2}),Ja=be=>{if(yt(null),m)m(be);else if(be>n)for(let Le=n;Le<be;Le++)i();else if(be<n)for(let Le=n;Le>be;Le--)c()},nr=be=>{try{const Le=be.split("T")[0];if(!Le)return be;const[He,Et,Ft]=Le.split("-").map(Number);return isNaN(He)||isNaN(Et)||isNaN(Ft)||Et<1||Et>12?be:`${["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][Et-1]} ${Ft}, ${He}`}catch{return be}},Io=be=>{try{const Le=be.split("T")[1];if(!Le)return"";const He=Le.split(/[Z+-]/)[0],[Et,Ft]=He.split(":").map(Number);if(isNaN(Et)||isNaN(Ft))return"";const gt=Et>=12?"PM":"AM",tt=Et%12||12,st=Ft.toString().padStart(2,"0");return`${tt}:${st} ${gt}`}catch{return""}},su=be=>be?(new DOMParser().parseFromString(be,"text/html").body.textContent||"").length>200:!1,Xa=be=>{const Le=["a","b","br","div","em","i","li","ol","p","s","strong","u","ul"],He=["href","rel","type","target"],Ft=new DOMParser().parseFromString(be,"text/html"),gt=Ft.body.getElementsByTagName("*");for(let tt=gt.length-1;tt>=0;tt--){const st=gt[tt];Le.includes(st.tagName.toLowerCase())?Array.from(st.attributes).forEach(bs=>{He.includes(bs.name.toLowerCase())||st.removeAttribute(bs.name)}):st.replaceWith(document.createTextNode(st.textContent||""))}return Ft.body.innerHTML},yd=()=>{if(!t.length||n>=t.length)return[];const be=t[n],Le=String(be.id||"");return Le?g.filter(He=>{var Ft;return String(((Ft=He.matter)==null?void 0:Ft.id)||He.case_id||"")===Le}):[]},ou=be=>{const Le=String(be.start_at||be.date||"");if(!Le)return!1;try{return new Date(Le)>=new Date}catch{return!1}},iu=()=>{const Le=yd().filter(ou).sort((He,Et)=>{const Ft=new Date(String(He.start_at||He.date||"")),gt=new Date(String(Et.start_at||Et.date||""));return Ft.getTime()-gt.getTime()});return Le.length>0?[Le[0]]:Le},Yl=()=>{const be=iu(),Le=t.length>0&&n<t.length?t[n]:null,He=Le==null?void 0:Le.id,Et=He?`https://app.clio.com/nc/#/matters/${He}/calendar`:null;return u.jsxs("div",{className:"border-t bg-card",children:[u.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800",children:[u.jsxs("div",{className:"flex items-center gap-2 cursor-pointer flex-1 hover:opacity-80 transition-opacity",onClick:()=>ue(!we),children:[u.jsx(Hf,{className:"w-4 h-4 text-slate-600 dark:text-gray-300"}),u.jsx("span",{className:"font-medium text-sm text-slate-800 dark:text-white",children:"Next Event"}),be.length>0&&!d&&(we?u.jsx(Qv,{className:"w-4 h-4 text-gray-400"}):u.jsx(ms,{className:"w-4 h-4 text-gray-400"}))]}),Et&&u.jsxs("a",{href:Et,target:"_blank",rel:"noopener noreferrer",className:"h-7 text-xs text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 border border-blue-200 dark:border-blue-800 px-2 flex-shrink-0 rounded-md inline-flex items-center gap-1 no-underline hover:no-underline",onClick:Ft=>Ft.stopPropagation(),children:[u.jsx(Ml,{className:"w-3 h-3"}),"View all"]})]}),!we&&u.jsx(u.Fragment,{children:d?u.jsx(Ls,{rows:2}):be.length>0?u.jsx("div",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:be.map((Ft,gt)=>{const tt=String(Ft.start_at||Ft.date||""),st=String(Ft.end_at||""),Tn=String(Ft.summary||Ft.title||"Calendar Event"),bs=String(Ft.location||"");return u.jsxs("div",{className:"p-3 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:[u.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-gray-100 mb-1",children:Tn}),u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"space-y-1",children:[u.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600 dark:text-gray-400",children:[u.jsx(Hf,{className:"w-3 h-3"}),u.jsx("span",{children:nr(tt)})]}),bs&&u.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600 dark:text-gray-400",children:[u.jsx(mB,{className:"w-3 h-3"}),u.jsx("span",{children:bs})]})]}),u.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600 dark:text-gray-400",children:[u.jsx(Pv,{className:"w-3 h-3"}),u.jsxs("span",{children:[Io(tt),st&&` - ${Io(st)}`]})]})]})]},gt)})}):u.jsx("div",{className:"p-3 text-sm text-gray-600 dark:text-gray-400",children:r&&t.length>0?u.jsx(u.Fragment,{children:u.jsx("p",{className:"mb-2",children:"No upcoming calendar entries found for this case"})}):"Select a client email thread to view calendar entries"})})]})},Qa=()=>{const be=t.length>0&&n<t.length?t[n]:null,Le=be==null?void 0:be.last_completed_task,He=be==null?void 0:be.next_upcoming_task,Et=Le||He,Ft=be==null?void 0:be.id,gt=Ft?`https://app.clio.com/nc/#/matters/${Ft}/tasks`:null;return u.jsxs("div",{className:"border-t bg-card",children:[u.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800",children:[u.jsxs("div",{className:"flex items-center gap-2 cursor-pointer flex-1 hover:opacity-80 transition-opacity",onClick:()=>pe(!oe),children:[u.jsx(pB,{className:"w-4 h-4 text-slate-600 dark:text-gray-300"}),u.jsx("span",{className:"font-medium text-sm text-slate-800 dark:text-white",children:"Tasks"}),(Et||Gt)&&!d&&(oe?u.jsx(Qv,{className:"w-4 h-4 text-gray-400"}):u.jsx(ms,{className:"w-4 h-4 text-gray-400"}))]}),u.jsxs("div",{className:"flex items-center gap-2",children:[E&&(Gt?u.jsxs(ze,{variant:"ghost",size:"sm",className:"h-7 text-xs text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 px-2",onClick:tt=>{tt.stopPropagation(),Zt(!1),oo()},children:[u.jsx(Rk,{className:"w-3 h-3 mr-1"}),"Remove"]}):u.jsxs(ze,{variant:"ghost",size:"sm",className:"h-7 text-xs text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 px-2",onClick:tt=>{tt.stopPropagation(),Zt(!0)},children:[u.jsx(Ak,{className:"w-3 h-3 mr-1"}),"Add Task"]})),gt&&u.jsxs("a",{href:gt,target:"_blank",rel:"noopener noreferrer",className:"h-7 text-xs text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 border border-blue-200 dark:border-blue-800 px-2 flex-shrink-0 rounded-md inline-flex items-center gap-1 no-underline hover:no-underline",onClick:tt=>tt.stopPropagation(),children:[u.jsx(Ml,{className:"w-3 h-3"}),"View all"]})]})]}),!oe&&u.jsxs(u.Fragment,{children:[Gt&&u.jsx("div",{className:"p-3 border-b border-gray-200 dark:border-gray-700 bg-gray-50/50 dark:bg-gray-800/50",children:u.jsxs("div",{className:"space-y-3",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Task Name"}),u.jsx(on,{disabled:Ut,placeholder:Ut?"Generating task name...":"Enter task name...",value:Kt,onChange:tt=>Kr(tt.target.value),className:"h-8 text-sm"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Task Description"}),u.jsx("textarea",{placeholder:Ut?"Generating task description...":"Enter task description...",value:_t,onChange:tt=>Se(tt.target.value),disabled:Ut,className:`w-full min-h-[80px] px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 resize-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${Ut?"opacity-60 cursor-not-allowed":""}`}),Ut&&u.jsxs("div",{className:"flex items-center gap-2 mt-1 text-xs text-gray-500 dark:text-gray-400",children:[u.jsx("div",{className:"w-3 h-3 border-2 border-gray-300 border-t-blue-600 rounded-full animate-spin"}),"Generating task from email..."]})]}),u.jsxs("div",{className:"flex gap-3",children:[u.jsxs("div",{className:"flex-1",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Due At"}),u.jsx(on,{type:"date",value:$e,onChange:tt=>Nt(tt.target.value),className:"h-8 text-sm"})]}),u.jsxs("div",{className:"flex-1",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Priority"}),u.jsxs(Ms,{open:Lt,onOpenChange:et,children:[u.jsx($s,{asChild:!0,children:u.jsxs(ze,{variant:"outline",className:"w-full h-8 text-sm justify-between font-normal",children:[u.jsx("span",{children:it}),u.jsx(ms,{className:"w-3 h-3 ml-2 flex-shrink-0"})]})}),u.jsx(vs,{align:"start",className:"w-[140px]",children:["High","Normal","Low"].map(tt=>u.jsx(rs,{className:`cursor-pointer ${it===tt?"bg-gray-100 dark:bg-gray-700":""}`,onClick:()=>{dt(tt),et(!1)},children:tt},tt))})]})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Assign To"}),u.jsxs(Ms,{open:zt,onOpenChange:lr,children:[u.jsx($s,{asChild:!0,children:u.jsxs(ze,{variant:"outline",className:"w-full h-8 text-sm justify-between font-normal",children:[u.jsx("span",{className:"truncate",children:Ro||"Select assignee"}),u.jsx(ms,{className:"w-3 h-3 ml-2 flex-shrink-0"})]})}),u.jsxs(vs,{align:"start",className:"w-[320px] p-0",children:[u.jsxs("div",{className:"p-3 border-b border-gray-200 dark:border-gray-700",children:[u.jsx("div",{className:"text-sm font-medium mb-2 text-gray-800 dark:text-gray-200",children:"Search Users"}),u.jsxs("div",{className:"relative",children:[u.jsx(eo,{className:"absolute left-2 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),u.jsx(on,{placeholder:"Search by name...",value:Nr,onChange:tt=>{const st=tt.target.value;Dn(st),gd(st)},className:"pl-8 pr-8 h-9 text-sm",autoFocus:!0,onClick:tt=>tt.stopPropagation(),onKeyDown:tt=>tt.stopPropagation()}),Nr&&u.jsx("button",{onClick:tt=>{tt.stopPropagation(),Dn(""),Ue([]),Tt(null)},className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:u.jsx(ki,{className:"w-4 h-4"})})]})]}),u.jsx("div",{className:"max-h-[300px] overflow-y-auto",children:ht?u.jsxs("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 flex items-center gap-2",children:[u.jsx("div",{className:"w-4 h-4 border-2 border-gray-300 border-t-gray-600 rounded-full animate-spin"}),"Searching..."]}):mt&&ve.length===0?u.jsx("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:mt}):ve.length>0?ve.map(tt=>u.jsx(rs,{className:"flex flex-col items-start p-3 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-800",onClick:()=>{en(tt.id),aa(tt.name),lr(!1),Dn(""),Ue([])},children:u.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-gray-100",children:tt.name})},tt.id)):Nr.trim()&&!ht?u.jsxs("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:['No users found for "',Nr,'"']}):u.jsx("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:Ro?u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Currently assigned to: ",Ro]}),u.jsx("div",{className:"text-xs",children:"Type at least 2 characters to search for other users..."})]}):"Type at least 2 characters to search users..."})})]})]})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("input",{type:"checkbox",id:"hasReminder",checked:ss,onChange:tt=>zs(tt.target.checked),className:"cursor-pointer"}),u.jsx("label",{htmlFor:"hasReminder",className:"text-xs font-medium text-gray-700 dark:text-gray-300 cursor-pointer",children:"Add Reminder"})]}),ss&&u.jsxs("div",{className:"pl-5 space-y-2 border-l-2 border-gray-200 dark:border-gray-600",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Remind"}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx(on,{type:"number",min:"1",value:Ii,onChange:tt=>la(Math.max(1,parseInt(tt.target.value)||1)),className:"h-8 text-sm w-20"}),u.jsxs(Ms,{open:Z,onOpenChange:Oe,children:[u.jsx($s,{asChild:!0,children:u.jsxs(ze,{variant:"outline",className:"flex-1 h-8 text-sm justify-between font-normal",children:[u.jsx("span",{children:ca}),u.jsx(ms,{className:"w-3 h-3 ml-2 flex-shrink-0"})]})}),u.jsx(vs,{align:"start",className:"w-[140px]",children:["Minutes","Hours","Days","Weeks"].map(tt=>u.jsx(rs,{className:`cursor-pointer ${ca===tt?"bg-gray-100 dark:bg-gray-700":""}`,onClick:()=>{qa(tt),Oe(!1)},children:tt},tt))})]})]}),u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"before due date"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Delivery Method"}),u.jsx("div",{className:"w-full h-8 px-3 text-sm flex items-center border border-input rounded-md bg-gray-50 dark:bg-gray-800 text-gray-700 dark:text-gray-300",children:"Email"})]})]})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("input",{type:"checkbox",id:"appendEmailToDescription",checked:xs,onChange:tt=>Us(tt.target.checked),className:"cursor-pointer"}),u.jsx("label",{htmlFor:"appendEmailToDescription",className:"text-xs text-gray-700 dark:text-gray-300 cursor-pointer",children:"Append email to Description"})]}),!un&&u.jsxs("div",{className:"space-y-2 pt-2 border-t border-gray-200 dark:border-gray-700",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("input",{type:"checkbox",id:"notifyAssignee",checked:Ze,onChange:tt=>Tr(tt.target.checked),className:"cursor-pointer"}),u.jsx("label",{htmlFor:"notifyAssignee",className:"text-xs text-gray-700 dark:text-gray-300 cursor-pointer",children:"Notify assignee when task is assigned"})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("input",{type:"checkbox",id:"notifyCompletion",checked:Ht,onChange:tt=>Hr(tt.target.checked),className:"cursor-pointer"}),u.jsx("label",{htmlFor:"notifyCompletion",className:"text-xs text-gray-700 dark:text-gray-300 cursor-pointer",children:"Notify me when task is completed"})]})]}),u.jsx(ze,{onClick:Eh,disabled:Ke,className:"w-full h-8 text-sm",children:Ke?"Creating task in Clio...":"Create Task"})]})}),wn&&u.jsx("div",{className:`p-2 rounded-md text-sm ${wn.type==="success"?"bg-green-50 dark:bg-green-900/20 text-green-700 dark:text-green-400 border border-green-200 dark:border-green-800":"bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-400 border border-red-200 dark:border-red-800"}`,children:wn.text}),Yr&&u.jsx("div",{className:"p-3 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:u.jsxs("div",{className:"flex items-start gap-2 mb-2",children:[u.jsx(Pv,{className:"w-4 h-4 text-blue-600 dark:text-blue-400 mt-0.5 flex-shrink-0"}),u.jsxs("div",{className:"flex-1",children:[u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 font-medium mb-1",children:"Newly Created Task"}),u.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-gray-100 mb-1",children:String(Yr.name||"Untitled Task")}),u.jsxs("div",{className:"space-y-1",children:[!!Yr.due_at&&u.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600 dark:text-gray-400",children:[u.jsx(Hf,{className:"w-3 h-3"}),u.jsxs("span",{children:["Due: ",nr(String(Yr.due_at))]})]}),!!Yr.priority&&u.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600 dark:text-gray-400",children:[u.jsx("span",{className:"font-medium",children:"Priority:"}),u.jsx("span",{children:String(Yr.priority)})]})]})]})]})}),d?u.jsx(Ls,{rows:2}):Et?u.jsxs("div",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:[Le&&u.jsx("div",{className:"p-3 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:u.jsxs("div",{className:"flex items-start gap-2 mb-2",children:[u.jsx(Wc,{className:"w-4 h-4 text-green-600 dark:text-green-400 mt-0.5 flex-shrink-0"}),u.jsxs("div",{className:"flex-1",children:[u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 font-medium mb-1",children:"Last Completed Task"}),u.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-gray-100 mb-1",children:String(Le.name||"Untitled Task")}),!!Le.completed_at&&u.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600 dark:text-gray-400",children:[u.jsx(Hf,{className:"w-3 h-3"}),u.jsxs("span",{children:["Completed: ",nr(String(Le.completed_at))]})]})]})]})}),He&&u.jsx("div",{className:"p-3 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:u.jsxs("div",{className:"flex items-start gap-2 mb-2",children:[u.jsx(Pv,{className:"w-4 h-4 text-blue-600 dark:text-blue-400 mt-0.5 flex-shrink-0"}),u.jsxs("div",{className:"flex-1",children:[u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 font-medium mb-1",children:"Next Upcoming Task"}),u.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-gray-100 mb-1",children:String(He.name||"Untitled Task")}),u.jsxs("div",{className:"space-y-1",children:[!!He.due_at&&u.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600 dark:text-gray-400",children:[u.jsx(Hf,{className:"w-3 h-3"}),u.jsxs("span",{children:["Due: ",nr(String(He.due_at))]})]}),!!He.priority&&u.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600 dark:text-gray-400",children:[u.jsx("span",{className:"font-medium",children:"Priority:"}),u.jsx("span",{children:String(He.priority)})]})]})]})]})})]}):!Gt&&!Yr?u.jsx("div",{className:"p-3 text-sm text-gray-600 dark:text-gray-400",children:r&&t.length>0?u.jsx(u.Fragment,{children:u.jsx("p",{className:"mb-2",children:"No tasks found for this matter"})}):"Select a client email thread to view tasks"}):null]})]})},si=()=>{const be=t.length>0&&n<t.length?t[n]:null,Le=be==null?void 0:be.most_recent_note,He=Le&&Le.detail,Et=be==null?void 0:be.id,Ft=Et?`https://app.clio.com/nc/#/matters/${Et}/notes`:null;return u.jsxs("div",{className:"border-t bg-card",children:[u.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800",children:[u.jsxs("div",{className:"flex items-center gap-2 cursor-pointer flex-1 hover:opacity-80 transition-opacity",onClick:()=>B(!te),children:[u.jsx(sh,{className:"w-4 h-4 text-slate-600 dark:text-gray-300"}),u.jsx("span",{className:"font-medium text-sm text-slate-800 dark:text-white",children:"Latest Note"}),!!He&&!d&&u.jsx(u.Fragment,{children:te?u.jsx(Qv,{className:"w-4 h-4 text-gray-400"}):u.jsx(ms,{className:"w-4 h-4 text-gray-400"})})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[Et&&(os?u.jsxs(ze,{variant:"ghost",size:"sm",className:"h-7 text-xs text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 px-2",onClick:gt=>{gt.stopPropagation(),ti(!1),ni()},children:[u.jsx(Rk,{className:"w-3 h-3 mr-1"}),"Remove"]}):u.jsxs(ze,{variant:"ghost",size:"sm",className:"h-7 text-xs text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 px-2",onClick:gt=>{gt.stopPropagation(),ti(!0)},children:[u.jsx(Ak,{className:"w-3 h-3 mr-1"}),"Add Note"]})),Ft&&u.jsxs("a",{href:Ft,target:"_blank",rel:"noopener noreferrer",className:"h-7 text-xs text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 border border-blue-200 dark:border-blue-800 px-2 flex-shrink-0 rounded-md inline-flex items-center gap-1 no-underline hover:no-underline",onClick:gt=>gt.stopPropagation(),children:[u.jsx(Ml,{className:"w-3 h-3"}),"View all"]})]})]}),os&&u.jsx("div",{className:"bg-gray-50/50 dark:bg-gray-800/30 p-3 border-b border-gray-200 dark:border-gray-700",children:u.jsxs("div",{className:"space-y-3",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Subject"}),u.jsx(on,{type:"text",value:Br,onChange:gt=>ri(gt.target.value),placeholder:"Enter note subject...",className:"h-9 text-sm"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Note"}),u.jsx("textarea",{value:Ln,onChange:gt=>md(gt.target.value),placeholder:"Enter note details...",className:"w-full min-h-[80px] px-3 py-2 text-sm border rounded-md resize-y dark:bg-gray-800 dark:border-gray-600 dark:text-gray-100",rows:3})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Date"}),u.jsx(on,{type:"date",value:Mn,onChange:gt=>tu(gt.target.value),className:"h-9 text-sm"})]}),u.jsx(ze,{onClick:Kl,disabled:ru,className:"w-full h-9",children:ru?"Creating note in Clio...":"Create Note"})]})}),so&&u.jsx("div",{className:`p-2 rounded-md text-sm ${so.type==="success"?"bg-green-50 dark:bg-green-900/20 text-green-700 dark:text-green-400 border border-green-200 dark:border-green-800":"bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-400 border border-red-200 dark:border-red-800"}`,children:so.text}),!te&&u.jsx(u.Fragment,{children:d?u.jsx(Ls,{rows:1}):He?u.jsx("div",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:u.jsxs("div",{className:"p-3 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:[u.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-gray-100 mb-2",children:String(Le.subject||"Note")}),u.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600 dark:text-gray-400 mb-2",children:[u.jsx(Hf,{className:"w-3 h-3"}),u.jsx("span",{children:nr(String(Le.created_at))}),(()=>{const gt=Io(String(Le.created_at||""));return gt?u.jsxs(u.Fragment,{children:[u.jsx("span",{children:""}),u.jsx(Pv,{className:"w-3 h-3"}),u.jsx("span",{children:gt})]}):null})()]}),u.jsx("div",{className:"text-sm text-gray-700 dark:text-gray-300",children:(()=>{const gt=String(Le.detail||""),tt=su(gt);return z||!tt?u.jsx("div",{className:"prose prose-sm max-w-none dark:prose-invert",dangerouslySetInnerHTML:{__html:Xa(gt)}}):u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"line-clamp-3 prose prose-sm max-w-none dark:prose-invert",dangerouslySetInnerHTML:{__html:Xa(gt)}}),u.jsx("button",{onClick:st=>{st.stopPropagation(),Y(!0)},className:"text-blue-600 dark:text-blue-400 hover:underline mt-1 text-xs font-medium",children:"Expand"})]})})()}),z&&u.jsx("button",{onClick:gt=>{gt.stopPropagation(),Y(!1)},className:"text-blue-600 dark:text-blue-400 hover:underline mt-2 text-xs font-medium",children:"Show less"})]})}):u.jsx("div",{className:"p-3 text-sm text-gray-600 dark:text-gray-400",children:r&&t.length>0?"No notes found for this matter":"Select a client email thread to view matter notes"})})]})};return u.jsxs("div",{className:"w-full min-h-[4rem] border border-border/50 rounded-lg shadow-sm bg-card text-card-foreground",title:"Matters and Calendar Information",children:[u.jsxs("div",{className:"flex items-center justify-between p-2 border-b bg-muted",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(YR,{className:"w-3.5 h-3.5 text-slate-600 dark:text-gray-300"}),u.jsx("span",{className:"font-medium text-sm text-slate-800 dark:text-white",children:"MATTERS"})]}),u.jsxs(Ms,{open:Ge,onOpenChange:Me,children:[u.jsx($s,{asChild:!0,children:u.jsx(ze,{variant:"ghost",size:"icon",className:"h-8 w-8 hidden",title:"Search all matters",children:u.jsx(eo,{className:"h-4 w-4"})})}),u.jsxs(vs,{align:"end",className:"w-[320px] p-0",children:[u.jsxs("div",{className:"p-3 border-b border-gray-200 dark:border-gray-700",children:[u.jsx("div",{className:"text-sm font-medium mb-2 text-gray-800 dark:text-gray-200",children:"Search All Matters"}),u.jsxs("div",{className:"relative",children:[u.jsx(eo,{className:"absolute left-2 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),u.jsx(on,{placeholder:"Search by matter or client name...",value:le,onChange:be=>{const Le=be.target.value;xe(Le),Ka(Le)},className:"pl-8 pr-8 h-9 text-sm",autoFocus:!0,onClick:be=>be.stopPropagation(),onKeyDown:be=>be.stopPropagation()}),le&&u.jsx("button",{onClick:be=>{be.stopPropagation(),xe(""),de([]),ct(null)},className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:u.jsx(ki,{className:"w-4 h-4"})})]})]}),u.jsx("div",{className:"max-h-[300px] overflow-y-auto",children:Te?u.jsxs("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 flex items-center gap-2",children:[u.jsx("div",{className:"w-4 h-4 border-2 border-gray-300 border-t-gray-600 rounded-full animate-spin"}),"Searching..."]}):Ae&&ye.length===0?u.jsx("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:Ae}):ye.length>0?ye.map(be=>u.jsxs(rs,{className:"flex flex-col items-start p-3 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-800",onClick:()=>Ya(be),children:[u.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-gray-100",children:be.projectName}),u.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5",children:[be.phaseName,"  Client: ",be.clientName]})]},be.projectId.native)):le.trim()&&!Te?u.jsxs("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:['No matters found for "',le,'"']}):u.jsx("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:"Type at least 2 characters to search matters..."})})]})]})]}),d?vd():S?u.jsxs(qm,{variant:"destructive",className:"m-2",children:[u.jsx(Bm,{className:"h-4 w-4"}),u.jsx(Km,{className:"ml-2",children:"Failed to fetch matter data. Please refresh to try again."})]}):e&&Object.keys(e).length>0?u.jsxs(u.Fragment,{children:[t.length>0&&u.jsxs("div",{className:"flex items-center px-3 py-1 bg-gray-50 dark:bg-gray-800 border-b dark:border-gray-700 gap-2",children:[u.jsx("div",{className:"flex-1 min-w-0 flex items-center",children:(()=>{const be=W??t.length,Le=be>P,He=Le?Math.ceil(be/P):1,Et=($-1)*P+1,Ft=Math.min($*P,be),gt=(()=>{if(!O.trim())return t;const st=O.toLowerCase();return V.length>0&&O.length>=2?V.filter(Tn=>(Tn.description||"").toLowerCase().includes(st)):t.filter(Tn=>String(Tn.description||"").toLowerCase().includes(st))})(),tt=()=>{if(He<=5)return Array.from({length:He},(Tn,bs)=>bs+1);const st=[];return $<=3?st.push(1,2,3,"...",He):$>=He-2?st.push(1,"...",He-2,He-1,He):st.push(1,"...",$,"...",He),st};return u.jsx(u.Fragment,{children:t.length>1||Le?u.jsxs(Ms,{open:ne,onOpenChange:nu,children:[u.jsx($s,{asChild:!0,children:u.jsxs(ze,{variant:"ghost",size:"sm",className:"h-auto text-left text-gray-600 dark:text-gray-300 flex flex-col items-start gap-0 px-2 py-1 max-w-full overflow-hidden",children:[u.jsx("span",{className:"text-sm truncate font-medium w-full",title:e.Title||"",children:e.Title||"Case"}),u.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400 flex items-center gap-1",children:[sr," of ",be," matters in Clio",u.jsx(ms,{className:"w-3 h-3"})]})]})}),u.jsxs(vs,{align:"start",className:"w-[320px] p-0",children:[u.jsx("div",{className:"p-2 border-b border-gray-200 dark:border-gray-700",children:u.jsxs("div",{className:"relative",children:[u.jsx(eo,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),u.jsx(on,{placeholder:"Search matters...",value:O,onChange:st=>U(st.target.value),className:"pl-8 pr-8 h-8 text-xs",autoFocus:!0,onClick:st=>st.stopPropagation(),onKeyDown:st=>st.stopPropagation()}),O&&u.jsx("button",{onClick:st=>{st.stopPropagation(),U("")},className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:u.jsx(ki,{className:"w-4 h-4"})})]})}),!O.trim()&&$===1&&u.jsx("div",{className:"px-3 py-1.5 text-xs text-gray-500 dark:text-gray-400 border-b border-gray-100 dark:border-gray-700",children:"Sorted by: last opened in Clio"}),O.trim()&&V.length>0&&O.length>=2&&u.jsxs("div",{className:"px-3 py-1.5 text-xs text-gray-500 dark:text-gray-400 border-b border-gray-100 dark:border-gray-700",children:["Searching all ",be," matters"]}),u.jsx("div",{className:"max-h-[250px] overflow-y-auto",children:gt.length>0?gt.map(st=>{const Tn=O.length>=2&&V.length>0,bs=t.indexOf(st),xd=bs!==-1,qt=String(st.id||""),vr=Bt?qt===Bt:xd&&bs===n,jo=String(st.description||"Case"),Za=vr?"bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400 font-medium":"";return Tn?u.jsx("button",{type:"button",className:`relative flex w-full cursor-pointer select-none items-center rounded-sm text-sm outline-none transition-colors hover:bg-neutral-100 dark:hover:bg-muted dark:text-gray-200 py-2.5 px-3 truncate text-left ${Za}`,onClick:()=>{if(T&&qt){yt(qt);const wd=V.findIndex(au=>au.id===qt);if(wd!==-1&&M){const au=Math.floor(wd/P)+1;M(au)}T({id:qt,description:String(st.description||""),name:String(st.name||"")},{preservePagination:!0}),Ee(!1),U("")}},children:jo},qt||jo):u.jsx(rs,{className:`text-sm py-2.5 px-3 truncate ${Za}`,onClick:()=>{T&&qt?(yt(qt),Ee(!1),T({id:qt,description:String(st.description||""),name:String(st.name||"")},{preservePagination:!0})):xd&&Ja(bs)},children:jo},qt||jo)}):u.jsxs("div",{className:"p-3 text-xs text-center text-gray-500 dark:text-gray-400",children:["No matters match ",O,""]})}),Le&&!(O.trim()&&V.length>0&&O.length>=2)&&u.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 px-3 py-2",onPointerDown:st=>{st.preventDefault(),st.stopPropagation()},onClick:st=>st.stopPropagation(),children:[u.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mb-2",children:["Showing ",Et,"-",Ft," of ",be," matters"]}),u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("button",{onClick:()=>{q.current=!0,M==null||M($-1)},disabled:$<=1,className:"text-xs px-2 py-1 text-gray-600 dark:text-gray-400 border border-gray-300 dark:border-gray-600 rounded hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-40 disabled:cursor-not-allowed",children:" Newer"}),u.jsx("div",{className:"flex items-center gap-1",children:tt().map((st,Tn)=>st==="..."?u.jsx("span",{className:"text-xs text-gray-400 px-1",children:""},`ellipsis-${Tn}`):u.jsx("button",{disabled:st===$,className:`text-xs w-6 h-6 rounded flex items-center justify-center ${st===$?"bg-blue-600 text-white font-medium":"text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700"} disabled:cursor-not-allowed`,onClick:()=>{typeof st=="number"&&(q.current=!0,M==null||M(st))},children:st},st))}),u.jsx("button",{onClick:()=>{q.current=!0,M==null||M($+1)},disabled:$>=He,className:"text-xs px-2 py-1 text-gray-600 dark:text-gray-400 border border-gray-300 dark:border-gray-600 rounded hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-40 disabled:cursor-not-allowed",children:"Older "})]})]})]})]}):u.jsxs("div",{className:"flex flex-col px-2 py-1 overflow-hidden",children:[u.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-300 truncate font-medium w-full",title:e.Title||"",children:e.Title||"Case"}),!p&&u.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[sr," of ",be," matters in Clio"]})]})})})()}),((Po=s.find(be=>be.field==="Title"))==null?void 0:Po.url)&&u.jsxs("a",{href:(Fo=s.find(be=>be.field==="Title"))==null?void 0:Fo.url,target:"_blank",rel:"noopener noreferrer",className:"h-8 text-xs text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 border border-blue-200 dark:border-blue-800 px-3 flex-shrink-0 rounded-md inline-flex items-center gap-1 no-underline hover:no-underline",children:[u.jsx(Ml,{className:"w-3 h-3"}),"View"]})]}),To&&!p&&u.jsx(yw,{createdContacts:A,onMatterLinked:j}),ie&&u.jsxs(qm,{variant:"destructive",className:"m-2",children:[u.jsx(Bm,{className:"h-4 w-4"}),u.jsx(Km,{className:"ml-2",children:"Failed to load matter details. Previous details shown below."})]}),X?u.jsx(Ls,{rows:5}):u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"break-words",children:u.jsx(eu,{details:e})}),si(),Yl(),Qa()]})]}):x?u.jsx(Ls,{rows:2}):u.jsx("div",{className:"p-3 text-sm text-gray-600 dark:text-gray-400",children:r?u.jsxs(u.Fragment,{children:[u.jsx("p",{className:"mb-2",children:"Select a client email thread to view matter information"}),To&&!p&&u.jsx(yw,{createdContacts:A,onMatterLinked:j})]}):u.jsxs(u.Fragment,{children:[To&&!p&&u.jsx(yw,{createdContacts:A,onMatterLinked:j}),!To&&"Select a client email thread to view case information"]})})]})},xw="src/shared/components/sidepanel/panels/components/UnifiedSearch.tsx",qq=({onMatterSelected:r})=>{const e=Ur(),t=w.useRef(null),[n,s]=w.useState(""),[i,c]=w.useState([]),[d,p]=w.useState(!1),[m,g]=w.useState(!1),[x,b]=w.useState(null);w.useEffect(()=>{const S=N=>{t.current&&!t.current.contains(N.target)&&g(!1)};return document.addEventListener("mousedown",S),()=>{document.removeEventListener("mousedown",S)}},[]);const E=w.useMemo(()=>My.debounce(async S=>{if(!S.trim()||S.length<2){c([]),b(null);return}p(!0),b(null);try{const N=await qy("clio",S,e);c(N.projects||[]),N.projects.length===0&&b(`No matters found for "${S}"`)}catch(N){e.error("Matter search failed",N,{sourceFile:xw}),b("Failed to search matters. Please try again."),c([])}finally{p(!1)}},400),[e]),T=S=>{var N,R;try{e.info("Matter selected via unified search",{matterId:(R=(N=S.projectId)==null?void 0:N.native)==null?void 0:R.toString(),matterName:S.projectName,sourceFile:xw}),r(S),g(!1),s(""),c([]),b(null)}catch(A){e.error("Failed to select matter",A,{sourceFile:xw})}};return u.jsxs("div",{ref:t,className:"w-full mb-3 p-1",children:[u.jsxs("div",{className:"relative",children:[u.jsx(eo,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400 pointer-events-none z-10"}),u.jsx(on,{placeholder:"Search clients and matters...",value:n,onChange:S=>{const N=S.target.value;s(N),g(!0),E(N)},onFocus:()=>g(!0),className:"pl-10 pr-10 h-10 text-sm border border-border/50 rounded-lg shadow-sm bg-card"}),n&&u.jsx("button",{onClick:S=>{S.stopPropagation(),s(""),c([]),b(null),g(!1)},className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 z-10",children:u.jsx(ki,{className:"w-4 h-4"})})]}),m&&(n.length>=2||d||i.length>0)&&u.jsx("div",{className:"relative",children:u.jsx("div",{className:"absolute top-2 left-0 right-0 z-50 w-full max-w-full border border-border/50 rounded-lg shadow-lg bg-card",children:u.jsx("div",{className:"max-h-[300px] overflow-y-auto",children:d?u.jsxs("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 flex items-center gap-2",children:[u.jsx("div",{className:"w-4 h-4 border-2 border-gray-300 border-t-gray-600 rounded-full animate-spin"}),"Searching..."]}):x&&i.length===0?u.jsx("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:x}):i.length>0?i.map(S=>u.jsxs("div",{className:"flex flex-col items-start p-3 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-800 border-b border-gray-100 dark:border-gray-700 last:border-b-0",onClick:()=>T(S),children:[u.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-gray-100",children:S.projectName}),u.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5",children:[S.phaseName,"  Client: ",S.clientName]})]},S.projectId.native)):n.trim()&&!d?u.jsxs("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:['No matters found for "',n,'"']}):u.jsx("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:"Type at least 2 characters to search clients and matters..."})})})})]})},Eo="src/shared/hooks/useParticipantValidation.ts",Kq=0,ww=1,g1=2e3,v1=3e4;function Yq(r){const e=r.message.toLowerCase();return e.includes("client not found")||e.includes("404")||e.includes("not found")}function Jq(r){const e=r.message.toLowerCase();return e.includes("timed out")||e.includes("timeout")||e.includes("504")||e.includes("503")||e.includes("network")||e.includes("failed to fetch")}function Xq({emailParticipants:r,getClientDetailsForEmail:e,clientDataCache:t,isValidClientData:n,onClientDataValidated:s,refreshTrigger:i,onTransientError:c,onValidationComplete:d}){const p=Ur(),m=w.useRef(null),g=w.useRef(new Set),x=w.useCallback(async(N,R)=>{var M;if(R.aborted)return;const A=N.toLowerCase();if(g.current.has(A)){p.debug("Skipping duplicate in-flight validation",{sourceFile:Eo,email:N});return}g.current.add(A);let j,P,$=!1;const W=e(N);try{if(await Promise.race([W,new Promise((ie,J)=>{j=setTimeout(()=>{$=!0,J(new Error(`Request timed out after ${v1}ms`))},v1),P=()=>{clearTimeout(j),J(new DOMException("Aborted","AbortError"))},R.addEventListener("abort",P,{once:!0})})]),R.aborted)return;const V=(M=t.current)==null?void 0:M[N],X=V?n(V):!1;s(N,X),p.debug("Participant validation result",{sourceFile:Eo,email:N,hasValidData:X})}catch(V){if(R.aborted)return;V instanceof Error?Yq(V)?(p.debug("Participant not found in system",{sourceFile:Eo,email:N,error:V.message}),s(N,!1)):Jq(V)?(p.warn("Participant validation timed out or network error - marking as pending",{sourceFile:Eo,email:N,error:V.message}),s(N,!1),c==null||c(N,V),$&&W.then(()=>{var J;if(R.aborted)return;const X=(J=t.current)==null?void 0:J[N];(X?n(X):!1)&&(p.info("Request succeeded after timeout - updating validation",{sourceFile:Eo,email:N}),console.log(` [Late Success] Data loaded after timeout for ${N}`),s(N,!0))}).catch(X=>{R.aborted||p.debug("Request failed after timeout",{sourceFile:Eo,email:N,error:X instanceof Error?X.message:String(X)})})):(p.error("Participant validation failed with unexpected error",V,{sourceFile:Eo,email:N}),s(N,!1)):(p.error("Participant validation failed with non-Error",new Error(String(V)),{sourceFile:Eo,email:N}),s(N,!1))}finally{j!==void 0&&clearTimeout(j),P&&R.removeEventListener("abort",P),g.current.delete(A)}},[e,t,n,s,c,p]),b=w.useCallback(async(N,R)=>{await Promise.all(N.map(A=>x(A,R)))},[x]),E=(N,R)=>new Promise((A,j)=>{if(R.aborted)return j(new DOMException("Aborted","AbortError"));const P=()=>{clearTimeout($),j(new DOMException("Aborted","AbortError"))},$=setTimeout(()=>{R.removeEventListener("abort",P),A()},N);R.addEventListener("abort",P,{once:!0})}),T=w.useMemo(()=>[...r].sort().join(","),[r]),S=w.useRef(Kq);w.useEffect(()=>{var $;if(r.length===0)return;($=m.current)==null||$.abort();const N=new AbortController;m.current=N;const R=g.current,A=i>S.current,j=t.current;return A&&j&&(Object.keys(j).forEach(W=>{delete j[W]}),yT(p),$5(),R.clear(),p.debug("Cleared all cache tiers for refresh",{sourceFile:Eo,refreshTrigger:i})),S.current=i,(async()=>{const{signal:W}=N;p.info("Validating all email participants (rate-limited)",{sourceFile:Eo,participantCount:r.length,batchSize:ww,batchDelayMs:g1});const M=[];for(let V=0;V<r.length;V+=ww)M.push(r.slice(V,V+ww));for(let V=0;V<M.length;V++){if(W.aborted){p.debug("Validation aborted",{sourceFile:Eo});return}const X=M[V];if(p.debug("Processing validation batch",{sourceFile:Eo,batchIndex:V+1,totalBatches:M.length,batchEmails:X}),await b(X,W),V<M.length-1&&!W.aborted)try{await E(g1,W)}catch(ie){if(ie instanceof DOMException&&ie.name==="AbortError"){p.debug("Validation delay aborted",{sourceFile:Eo});return}throw ie}}p.info("Completed validating all participants",{sourceFile:Eo,participantCount:r.length}),d==null||d()})(),()=>{N.abort(),R.clear()}},[T,b,p,i,t,d])}const oF=w.createContext(void 0),Qq=({children:r})=>{const[e,t]=w.useState(0),[n,s]=w.useState(!1),i=w.useRef(null),[c,d]=w.useState(!0),p=w.useRef(new Map),m=Vl(),g=async R=>{try{return await m.getLocalItem(`elapsedTime_${R}`)??0}catch(A){return console.warn("Failed to read from storage, using in-memory storage:",A),p.current.get(R)??0}},x=async(R,A)=>{try{await m.setLocalItem(`elapsedTime_${R}`,A)}catch(j){console.warn("Failed to write to storage, using in-memory storage:",j),p.current.set(R,A)}},b=()=>{i.current!==null&&(window.clearInterval(i.current),i.current=null)},E=async R=>{!n&&c&&(s(!0),b(),g(R).then(A=>{t(A)}),i.current=window.setInterval(()=>{t(A=>{const j=A+1;return x(R,j),j})},1e3))},T=async R=>{if(n){s(!1),b();const A=await g(R);x(R,A)}},S=R=>{x(R,0),t(0)},N=async R=>await g(R);return w.useEffect(()=>()=>{b()},[]),u.jsx(oF.Provider,{value:{elapsedTime:e,isTimerRunning:n,startTimer:E,stopTimer:T,resetTimer:S,getElapsedTimeForThread:N,setShouldStartTimer:d,setElapsedTime:t},children:r})},iF=()=>{const r=w.useContext(oF);if(!r)throw new Error("useTimer must be used within a TimerProvider");return r},bw=r=>{const e=Math.floor(r/3600),t=Math.floor(r%3600/60),n=r%60,s=i=>String(i).padStart(2,"0");return`${s(e)}:${s(t)}:${s(n)}`},Zq=({userData:r,clientEmail:e,fileToMatterChecked:t,casesForCurrentClient:n,selectedCase:s,onSave:i,onCancel:c})=>{const d=Ur(),p=fd(),{platform:m}=cn(),{elapsedTime:g,stopTimer:x,resetTimer:b}=iF(),[E,T]=w.useState(new Date().toISOString().slice(0,10)),[S,N]=w.useState(bw(g)),[R,A]=w.useState(""),[j,P]=w.useState(s||n[0]||{}),$=t,[W,M]=w.useState((r==null?void 0:r.rate)||null),[V,X]=w.useState(!1),[ie,J]=w.useState("Failed to save time entry. Please try again."),[ae,we]=w.useState(!1),[ue,oe]=w.useState(!1),[pe,te]=w.useState(!1),[B,z]=w.useState(!1),Y=dr.useRef(null),[O,U]=w.useState(!1),ne=async()=>{if(te(!0),!(j!=null&&j.id)){te(!1),z(!0),J("Please select a matter to file the time entry.");return}const q=/^(\d{1,2}):([0-5]\d):([0-5]\d)$/,le=S.trim().match(q);if(!le){te(!1),z(!0),J("Please enter a valid duration in HH:MM:SS format.");return}const[,xe,ye,de]=le,Te=Number(xe)*3600+Number(ye)*60+Number(de);if(!E||!/^\d{4}-\d{2}-\d{2}$/.test(E)||Number.isNaN(Date.parse(E))){te(!1),z(!0),J("Please select a valid date (YYYY-MM-DD).");return}if(!Y.current){te(!1),z(!0),J("Unable to retrieve email thread information.");return}m==="chrome"&&AT(Y.current,d).then(async Ge=>{if(Ge.length!=0)try{const Me=Ge[Ge.length-1],Ae=Me.to.concat(Me.cc),ct=Me.from,Bt=Me.subject||"",yt=Me.body||"",sr=Me.date||"",Gt=Ae,Zt=R.trim().replace(/[<>]/g,"").substring(0,5e3),Kt=await cy(e,"clio",E,Te,Zt,j==null?void 0:j.id,$,Bt,yt,sr,ct,Gt,ae,ue,W,d);d.info("Time entry successfully written to server",{sourceFile:"TimeEntryModal.tsx",message:Kt}),J("New email log and time entry created successfully."),te(!1),z(!1),Y.current&&(await x(Y.current),b(Y.current)),i()}catch(Me){d.error("Error writing time entry to server",{error:Me},{sourceFile:"TimeEntryModal.tsx"}),te(!1),z(!0),J("Something went wrong. Please try again.")}}).catch(Ge=>{d.error("Error fetching email details from server",{error:Ge},{sourceFile:"TimeEntryModal.tsx"}),te(!1),z(!0),J("Something went wrong. Please try again.")}),m==="outlook"&&p.getCurrentThread().then(async Ge=>{if(Ge===null){te(!1),z(!0),J("Unable to retrieve email details. Please try again.");return}const Me=Ge.messages[Ge.messages.length-1].from,Ae=Ge.subject||"",ct=Ge.messages[Ge.messages.length-1].body||"",Bt=Ge.messages[Ge.messages.length-1].timestamp||"",yt=Ge.participants.filter((Zt=>Zt!==Me)),sr=R.trim().replace(/[<>]/g,"").substring(0,5e3),Gt=await cy(e,"clio",E,Te,sr,j==null?void 0:j.id,$,Ae,ct,Bt,Me,yt,ae,ue,W,d);d.info("Time entry successfully written to server",{sourceFile:"InsightsTimer.tsx",message:Gt}),J("New email log and time entry created successfully."),te(!1),z(!1),Y.current&&(await x(Y.current),b(Y.current)),i()}).catch(Ge=>{d.error("Error writing time entry to server",{error:Ge},{sourceFile:"TimeEntryModal.tsx"}),te(!1),z(!0),J("Something went wrong. Please try again.")})},Ee=q=>{let le="";const xe=(q==null?void 0:q.messages)||[];let ye=xe;return xe.length>3&&(ye=xe.slice(-3)),ye.forEach((de,Te)=>{le+=`Email ${Te} Subject: ${de.subject||""}
Email ${Te} Body: ${de.body||""}

`}),le};return w.useEffect(()=>{const q=async()=>{p==null||p.getCurrentThread().then(xe=>{U(!0);const ye=(xe==null?void 0:xe.threadId)||null;if(!ye){U(!1);return}if(m==="outlook"){const de=Ee(xe);SC(ye,de,d).then((Te=>{A(Te.description),U(!1)})).catch(Te=>{d.error("Error generating email description summary",Te,{sourceFile:"TimeEntryModal.tsx"}),U(!1)})}m==="chrome"&&SC(ye,null,d).then(de=>{A(de.description),U(!1)}).catch(de=>{d.error("Error generating email description summary",de,{sourceFile:"TimeEntryModal.tsx"}),U(!1)})})},le=()=>{p==null||p.getCurrentThread().then(xe=>{Y.current=(xe==null?void 0:xe.threadId)||null})};q(),le()},[$,p,d]),w.useEffect(()=>{var q,le,xe,ye;(ye=(xe=(le=(q=j==null?void 0:j.raw_data)==null?void 0:q.custom_rate)==null?void 0:le.rates)==null?void 0:xe[0])!=null&&ye.rate?M(j.raw_data.custom_rate.rates[0].rate):M((r==null?void 0:r.rate)||0)},[j,r]),u.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 dark:bg-opacity-70 z-50 p-4 overflow-y-auto",onClick:c,children:u.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-lg w-full max-w-lg p-6 my-auto max-h-[90vh] overflow-y-auto",onClick:q=>q.stopPropagation(),children:[u.jsxs("div",{className:"flex justify-between items-center mb-4",children:[u.jsxs("h2",{className:"text-lg font-semibold text-blue-600 dark:text-blue-400",children:["Review Time Entry"," "]}),u.jsx("button",{className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",onClick:c,children:u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),B&&u.jsx("div",{role:"alert","aria-live":"assertive",className:"mb-4",children:u.jsxs("div",{className:"flex items-start bg-red-50 dark:bg-red-950/30 border border-red-200 dark:border-red-800 text-red-900 dark:text-red-100 rounded-md p-3",children:[u.jsx("svg",{className:"w-5 h-5 flex-shrink-0",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:u.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.72-1.36 3.485 0l6.518 11.588c.75 1.334-.213 2.995-1.742 2.995H3.481c-1.529 0-2.492-1.661-1.742-2.995L8.257 3.1zM10 8a1 1 0 10-0 2 1 1 0 000-2zm0 4a1 1 0 01-.993-.883L9 11V9a1 1 0 012 0v2a1 1 0 01-.883.993L10 12z",clipRule:"evenodd"})}),u.jsxs("div",{className:"ml-3 flex-1",children:[u.jsx("p",{className:"font-medium",children:"Error"}),u.jsx("p",{className:"mt-1 text-sm",children:ie})]})]})}),u.jsx("p",{className:"mb-4",children:"Review and edit details before saving."}),u.jsxs("div",{className:"flex gap-4 mb-4 w-full",children:[u.jsxs("div",{className:"shrink-0",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Date"}),u.jsx("input",{type:"date",value:E,onChange:q=>T(q.target.value),className:"mt-1 block border border-gray-300 dark:border-gray-600 text-gray-600 dark:text-gray-300 bg-white dark:bg-gray-800 rounded-md shadow-sm px-3 py-2 text-sm focus:ring-blue-500 focus:border-blue-500 h-[38px]"})]}),u.jsxs("div",{className:"shrink-0",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Duration"}),u.jsx("input",{type:"text",value:S,onChange:q=>{const le=q.target.value,xe=/^(\d{0,2})(:\d{0,2}){0,2}$/;le.length<=8&&/^[0-9:]*$/.test(le)&&xe.test(le)&&N(le)},onBlur:q=>{const le=q.target.value.trim(),xe=/^(\d{1,2}):([0-5]\d):([0-5]\d)$/;if(xe.test(le)){const[,ye,de,Te]=le.match(xe),Be=Number(ye)*3600+Number(de)*60+Number(Te);N(bw(Be))}else N(bw(g))},className:"mt-1 block border border-gray-300 dark:border-gray-600 text-gray-600 dark:text-gray-300 bg-white dark:bg-gray-800 rounded-md shadow-sm px-3 py-2 text-sm focus:ring-blue-500 focus:border-blue-500 h-[38px]",style:{width:"10ch"},"aria-label":"Duration (HH:MM:SS)"})]})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Description"}),u.jsx("textarea",{disabled:O,value:O?"Generating AI description...":R,onChange:q=>A(q.target.value),className:"mt-1 block w-full border border-gray-300 dark:border-gray-600 text-gray-600 dark:text-gray-300 bg-white dark:bg-gray-800 rounded-md shadow-sm px-3 py-2 text-sm focus:ring-blue-500 focus:border-blue-500",rows:3})]}),u.jsx("div",{className:"bg-gray-50 dark:bg-gray-800/50 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm p-4",children:u.jsxs("div",{className:"flex justify-between items-center mb-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-900 dark:text-gray-100",children:"Billed By"}),u.jsx("p",{className:"mt-1 text-sm font-medium text-gray-900 dark:text-gray-100",children:"Rate"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm text-gray-700 dark:text-gray-300 text-right",children:(r==null?void 0:r.name)||"Unknown"}),u.jsxs("div",{className:"flex items-center justify-end gap-2",children:[u.jsx("input",{value:W??0,onChange:q=>M(Number(q.target.value)||0),onBlur:()=>X(!1),className:V?"mt-1 text-sm text-right text-gray-700 dark:text-gray-300 border border-gray-200 dark:border-gray-600 rounded bg-white dark:bg-gray-800 inline-block":"mt-1 text-sm text-right text-gray-700 dark:text-gray-300 border border-transparent rounded bg-transparent inline-block","aria-label":"Rate",disabled:!V,style:{width:`${Math.max(String(W??0).length,1)+1}ch`}}),u.jsx("button",{type:"button",className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300","aria-label":"Edit rate",onClick:()=>X(!V),children:u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536M4 20h4.586a1 1 0 00.707-.293l9.414-9.414a1 1 0 000-1.414L15.121 4.88a1 1 0 00-1.414 0L4 14.586V20z"})})})]})]})]})}),u.jsxs("div",{className:"mb-4 mt-5",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Matter"}),u.jsxs(Ms,{children:[u.jsx($s,{asChild:!0,children:u.jsxs(ze,{variant:"ghost",size:"sm",className:"mt-1 h-[38px] text-sm text-gray-600 dark:text-gray-300 flex items-center gap-1 px-3 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm w-full justify-between",children:[u.jsx("span",{className:"truncate",title:String((j==null?void 0:j.description)||"Select a matter"),children:String((j==null?void 0:j.description)||"Select a matter")}),u.jsx(ms,{className:"w-4 h-4 ml-1 flex-shrink-0"})]})}),u.jsx(vs,{align:"start",className:"w-full max-h-[200px] overflow-y-auto",style:{width:"var(--radix-dropdown-menu-trigger-width)"},children:n.map((q,le)=>u.jsx(rs,{className:"text-sm truncate max-w-full",onClick:()=>P(q),title:String((q==null?void 0:q.description)||`Case ${le+1}`),children:String((q==null?void 0:q.description)||`Case ${le+1}`)},le))})]})]}),u.jsxs("div",{className:"mb-4 bg-blue-50 dark:bg-blue-950/30 p-3 rounded-md",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx("input",{type:"checkbox",id:"fileToMatter",checked:ae,onChange:q=>we(q.target.checked),className:"cursor-pointer"}),u.jsx("label",{htmlFor:"fileToMatter",className:"ml-2 text-sm font-medium text-blue-600 dark:text-blue-400",children:"Non-billable"})]}),ae&&u.jsxs("div",{className:"flex items-center",children:[u.jsx("input",{type:"checkbox",id:"billEntry",checked:ue,onChange:q=>oe(q.target.checked),className:"cursor-pointer"}),u.jsx("label",{htmlFor:"billEntry",className:"ml-2 text-sm font-medium text-blue-600 dark:text-blue-400",children:"Show this entry on the bill"})]})]}),u.jsxs("div",{className:"flex flex-col gap-3",children:[u.jsx(ze,{className:"w-full p-2",disabled:pe,onClick:ne,children:pe?"Saving...":"Save Time Entry"}),u.jsx("button",{className:"w-full p-2 bg-transparent text-white hover:cursor-pointer hover:bg-transparent shadow-none border-none",disabled:pe,onClick:c,children:"Cancel"})]})]})})},eK=r=>{const e=Math.floor(r/3600),t=Math.floor(r%3600/60),n=r%60,s=i=>String(i).padStart(2,"0");return`${s(e)}:${s(t)}:${s(n)}`},tK=({userData:r,clientEmail:e,emailParticipantClients:t,currentCaseIndex:n,casesForCurrentClient:s})=>{const i=Ur(),{elapsedTime:c,isTimerRunning:d,startTimer:p,stopTimer:m,resetTimer:g,setShouldStartTimer:x,setElapsedTime:b}=iF(),E=fd(),{platform:T}=cn(),[S,N]=w.useState(s[0]||null),[R,A]=w.useState(!0),[j,P]=w.useState(!1),[$,W]=w.useState(!1),M=dr.useRef(null),[V,X]=w.useState(s||null),ie=new Date().toISOString().slice(0,10),J="",[ae,we]=w.useState("Failed to save time entry. Please try again."),[ue,oe]=w.useState(!1),[pe,te]=w.useState(!1),B=async()=>{if(oe(!0),!ie||!/^\d{4}-\d{2}-\d{2}$/.test(ie)||Number.isNaN(Date.parse(ie))){oe(!1),te(!0),we("Please select a valid date (YYYY-MM-DD).");return}if(M.current===null){oe(!1),te(!0),we("Unable to retrieve email details. Please try again.");return}T==="chrome"&&AT(M.current,i).then(async U=>{if(U.length<1){oe(!1),te(!0),we("Unable to retrieve email details. Please try again.");return}try{const ne=U[U.length-1],Ee=ne.to.concat(ne.cc),q=ne.from,le=ne.subject||"",xe=ne.body||"",ye=ne.date||"",de=Ee,Te=J.trim().replace(/[<>]/g,"").substring(0,5e3),Be=await cy(e,"clio",ie,c,Te,S==null?void 0:S.id,R,le,xe,ye,q,de,null,null,null,i);i.info("Time entry successfully written to server",{sourceFile:"InsightsTimer.tsx",message:Be}),we("New email log created successfully."),oe(!1),te(!1),W(!0),M.current&&(await m(M.current),g(M.current))}catch(ne){i.error("Error writing time entry to server",ne,{sourceFile:"InsightsTimer.tsx"}),oe(!1),te(!0),we("Something went wrong. Please try again.")}}).catch(U=>{i.error("Error fetching email details from server",U,{sourceFile:"InsightsTimer.tsx"}),oe(!1),te(!0),we("Something went wrong. Please try again.")}),T==="outlook"&&E.getCurrentThread().then(async U=>{if(U===null||!U.messages||U.messages.length===0){oe(!1),te(!0),we("Unable to retrieve email details. Please try again.");return}const ne=U.messages[U.messages.length-1].from,Ee=U.subject||"",q=U.messages[U.messages.length-1].body||"",le=U.messages[U.messages.length-1].timestamp||"",xe=U.participants.filter((Te=>Te!==ne)),ye=J.trim().replace(/[<>]/g,"").substring(0,5e3),de=await cy(e,"clio",ie,c,ye,S==null?void 0:S.id,R,Ee,q,le,ne,xe,null,null,null,i);i.info("Time entry successfully written to server",{sourceFile:"InsightsTimer.tsx",message:de}),we("New email log created successfully."),oe(!1),te(!1),W(!0),M.current&&(await m(M.current),g(M.current))}).catch(U=>{oe(!1),te(!0),we("Something went wrong. Please try again."),i.error("Error getting current thread",U,{sourceFile:"InsightsTimer.tsx"})})},z=async()=>{P(!1),W(!0),te(!1),we("Successfully wrote email log and time entry"),M.current&&(await m(M.current),g(M.current))},Y=async()=>{P(!1),x(!0),M.current&&await m(M.current)};return w.useEffect(()=>{if(!d)return;(()=>{E==null||E.getCurrentThread().then(U=>{M.current=(U==null?void 0:U.threadId)||null})})()},[d,E]),w.useEffect(()=>{X(s),N(s[n]||null),W(!1),P(!1)},[n,s,r]),w.useEffect(()=>{let O=!0;const U=async ye=>{if(!O)return;const de=(ye==null?void 0:ye.threadId)||null;if(!de){M.current&&document.visibilityState==="visible"&&(await m(M.current),b(0),i.info("Thread cleared - stopping timer",{sourceFile:"InsightsTimer.tsx"})),M.current=null;return}de!==M.current&&(i.info("Thread changed - starting timer",{sourceFile:"InsightsTimer.tsx",oldThreadId:M.current,newThreadId:de}),M.current&&await m(M.current),M.current=de,x(!0),document.visibilityState==="visible"&&p(de))};E&&(E.onThreadChanged(U),E.getCurrentThread().then(ye=>{U(ye)}).catch(ye=>{i.error("Error getting initial thread",ye,{sourceFile:"InsightsTimer.tsx"})}));const ne=async()=>{M.current&&await m(M.current)},Ee=async()=>{try{if(!E)return;const ye=await E.getCurrentThread(),de=(ye==null?void 0:ye.threadId)||null;if(!de||d&&M.current===de)return;M.current=de,p(de)}catch(ye){i.error("Error starting timer on visibility/focus",ye,{sourceFile:"InsightsTimer.tsx"})}},q=()=>{document.visibilityState==="hidden"?ne():document.visibilityState==="visible"&&Ee()},le=()=>Ee(),xe=()=>ne();return document.addEventListener("visibilitychange",q),window.addEventListener("focus",le),window.addEventListener("blur",xe),document.visibilityState==="visible"&&Ee(),()=>{O=!1,E&&E.removeThreadListener(U),document.removeEventListener("visibilitychange",q),window.removeEventListener("focus",le),window.removeEventListener("blur",xe)}},[E,p,m,x,i]),w.useEffect(()=>{if($||pe){const O=setTimeout(()=>{W(!1),te(!1)},5e3);return()=>clearTimeout(O)}},[$,pe]),u.jsxs(u.Fragment,{children:[j&&u.jsx(Zq,{userData:r,clientEmail:e,emailParticipantClients:t,fileToMatterChecked:R,casesForCurrentClient:V,selectedCase:S,onSave:z,onCancel:Y}),u.jsxs("div",{className:"flex flex-col gap-3 p-2 border rounded-md bg-blue-50 dark:bg-gray-800 border-blue-500 dark:border-gray-600 shadow-sm",children:[u.jsx("h2",{className:"text-sm font-semibold text-gray-700 dark:text-gray-200",children:"File email log"}),u.jsxs("div",{className:"flex items-center gap-1.5 overflow-hidden",children:[u.jsxs("button",{type:"button",onClick:async()=>{M.current&&(d?(x(!1),await m(M.current)):(x(!0),p(M.current)))},className:"flex items-center justify-start gap-1.5 w-[110px] h-[34px] px-2 rounded-md bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors border border-gray-200 dark:border-gray-600 overflow-hidden flex-shrink-0",children:[u.jsx("div",{className:"w-4 h-4 flex items-center justify-center flex-shrink-0",children:d?u.jsx(gB,{className:"w-4 h-4 text-green-700 dark:text-green-400"}):u.jsx(yB,{className:"w-4 h-4 text-gray-700 dark:text-gray-300"})}),u.jsx("span",{className:`text-base font-semibold ${d?"text-green-700 dark:text-green-400":"text-gray-700 dark:text-gray-300"} whitespace-nowrap w-[70px] text-center flex-shrink-0`,children:eK(c)})]}),u.jsxs("label",{className:"flex items-center gap-1 text-xs text-gray-600 dark:text-gray-400 flex-shrink min-w-0",children:[u.jsx("input",{type:"checkbox",id:"fileToMatter",checked:R,onChange:O=>A(O.target.checked),className:"cursor-pointer flex-shrink-0"}),u.jsx("span",{className:"truncate",children:"Add time entry"})]}),u.jsx("div",{className:"min-w-0 flex-1",children:u.jsx(ze,{disabled:ue,onClick:async()=>{if(M.current){if(R){P(!0),x(!1),await m(M.current);return}oe(!0),x(!1),await m(M.current),B()}},size:"sm",className:"h-8 text-xs px-1.5 w-full flex items-center justify-center",children:u.jsx("span",{className:"truncate",children:ue?"Saving...":"Save"})})})]}),u.jsx("div",{className:"min-w-0",children:u.jsx("div",{className:"flex items-center gap-2 w-full min-w-0",children:u.jsxs(Ms,{children:[u.jsx($s,{asChild:!0,children:u.jsxs(ze,{variant:"ghost",size:"sm",className:"h-8 text-xs text-gray-600 dark:text-gray-300 flex items-center gap-1 px-2 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md w-full justify-between min-w-0",children:[u.jsx("span",{className:"truncate",title:String((S==null?void 0:S.description)||"Select a matter"),style:{maxWidth:"24ch",display:"inline-block"},children:String((S==null?void 0:S.description)||"Select a matter")}),u.jsx(ms,{className:"w-3 h-3 ml-1"})]})}),u.jsx(vs,{align:"start",className:"w-full max-h-[200px] overflow-y-auto",style:{width:"100%"},children:V.map((O,U)=>u.jsx(rs,{className:"text-xs truncate max-w-full",onClick:()=>N(O),title:String((O==null?void 0:O.description)||`Case ${U+1}`),children:String((O==null?void 0:O.description)||`Case ${U+1}`)},U))})]})})})]}),$&&u.jsx("div",{role:"success","aria-live":"assertive",className:"mt-3",children:u.jsx("div",{className:"flex items-start border rounded-md p-3 border-green-200 dark:border-green-700 text-green-900 dark:text-green-100 bg-green-50 dark:bg-green-900",children:u.jsx("div",{className:"ml-3 flex-1",children:u.jsx("p",{className:"mt-1 text-sm",children:ae})})})}),pe&&u.jsx("div",{role:"alert","aria-live":"assertive",className:"mt-3",children:u.jsx("div",{className:"flex items-start border rounded-md p-3 border-red-200 dark:border-red-700 text-red-900 dark:text-red-100 bg-red-50 dark:bg-red-900",children:u.jsx("div",{className:"ml-3 flex-1",children:u.jsx("p",{className:"mt-1 text-sm",children:ae})})})})]})},Qt="src/sidepanel/panels/ClioInsights.tsx",rK=({clientEmail:r,setClientEmail:e,tempClientEmail:t,setTempClientEmail:n,emailParticipants:s,emailParticipantClients:i,currentClientIndex:c,setCurrentClientIndex:d,currentCaseIndex:p,casesForCurrentClient:m,setCasesForCurrentClient:g,isManuallySet:x,setIsManuallySet:b,isProjectManuallySelected:E,setIsProjectManuallySelected:T,isValidClient:S,isTempEmailValid:N,nextCase:R,prevCase:A,handleSetCurrentCaseIndex:j,ClientNavigation:P,onClientDataValidated:$,onTransientError:W,isValidating:M,refreshTrigger:V,integrationSettings:X,hasTransientError:ie})=>{const J=Ur(),{platform:ae}=cn(),we=Vl(),ue=w.useRef(r);ue.current=r;const oe=ve=>ve!==ue.current,[pe]=w.useState(!0),[te,B]=w.useState({}),[z,Y]=w.useState({}),[O,U]=w.useState({}),[ne,Ee]=w.useState({}),[q,le]=w.useState([]),[xe,ye]=w.useState(!1),[de,Te]=w.useState(null),[Be,Ge]=w.useState(null),[Me,Ae]=w.useState(!1),[ct,Bt]=w.useState([]),[yt,sr]=w.useState(!1),Gt=5,[Zt,Kt]=w.useState(1),[Kr,_t]=w.useState(0),[Se,$e]=w.useState(!1),[Nt,it]=w.useState(!1),dt=w.useRef(new Map),[Ut,Or]=w.useState([]),Ke=w.useRef({}),Pt=w.useCallback(ve=>{const Ue=typeof ve=="string"?parseFloat(ve):ve;return isNaN(Ue)?"$0.00":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Ue)},[]),Lt=w.useCallback(ve=>{if(!ve||!ve.client_data||!Array.isArray(ve.client_data)||ve.client_data.length===0)return!1;const Ue=ve.client_data[0];return Ue&&typeof Ue=="object"&&Object.keys(Ue).length>0},[]),et=w.useCallback(ve=>{if(J.info("selectClientDetails called",{sourceFile:Qt,hasDetails:!!ve,detailsKeys:ve?Object.keys(ve):[]}),!ve){J.warn("selectClientDetails called with undefined details",{sourceFile:Qt}),Y({}),U({}),B({}),Ee({});return}J.info("Client details received for formatting",{sourceFile:Qt,clientDetails:ve});const Ue=mt=>{const Tt=mt.replace(/\D/g,"");return Tt.length===10?`(${Tt.slice(0,3)}) ${Tt.slice(3,6)}-${Tt.slice(6)}`:mt};let ht="";if(ve.primary_phone_number)ht=ve.primary_phone_number;else if(ve.phone_numbers)try{const mt=JSON.parse(ve.phone_numbers);Array.isArray(mt)&&mt.length>0&&(ht=mt[0].number||"")}catch{const mt=ve.phone_numbers;Array.isArray(mt)&&mt.length>0&&(ht=mt[0].number||"")}else ve.phones&&Array.isArray(ve.phones)&&(ht=ve.phones[0]||"");let It="";if(ve.primary_email_address)It=ve.primary_email_address;else if(ve.email_addresses)try{const mt=JSON.parse(ve.email_addresses);Array.isArray(mt)&&mt.length>0&&(It=mt[0].address||"")}catch{const mt=ve.email_addresses;Array.isArray(mt)&&mt.length>0&&(It=mt[0].address||"")}else ve.emails&&Array.isArray(ve.emails)&&(It=ve.emails[0]||"");let zt="";try{let mt=[];ve.addresses&&(typeof ve.addresses=="string"?mt=JSON.parse(ve.addresses):mt=ve.addresses);const Tt=mt[0];Tt&&(zt=`${Tt.street?`${Tt.street}, `:""}${Tt.city?`${Tt.city}, `:""}${Tt.province?`${Tt.province}, `:""}${Tt.country?`${Tt.country} `:""}${Tt.postal_code?`${Tt.postal_code}`:""}`.trim())}catch{J.warn("Error formatting address",{sourceFile:Qt})}const lr={Name:ve.name||"",Email:It||"",Phone:Ue(ht),Address:zt||""};J.info("Client details formatted and set",{sourceFile:Qt,selectedDetails:lr,originalDetails:ve}),Y(ve),U(lr)},[J,Pt]),er=w.useCallback(ve=>{J.info("selectCaseDetails called",{sourceFile:Qt,hasDetails:!!ve,detailsKeys:ve?Object.keys(ve):[]}),J.info("Case details received for formatting",{sourceFile:Qt,caseNames:ve});const Ue={"Matter Number":ve.name||"",Title:ve.description||"","Maildrop Address":ve.maildrop_address||"","Practice Area":ve.practice_area||"",Status:ve.status||"",Stage:ve.matter_stage||"","Assigned To":ve.responsible_attorney||"","Rate Type":ve.custom_rate||"","Outstanding Balance":Pt(ve.outstanding_balance||ve.balance_outstanding||ve.balance||0)};J.info("Case details formatted and set",{sourceFile:Qt,selectedDetails:Ue,originalDetails:ve}),Ee(Ue)},[J,Pt]),zr=w.useCallback(async(ve,Ue)=>{J.info("Matter manually selected",{sourceFile:Qt,matterId:ve.id,matterName:ve.description}),Ue!=null&&Ue.preservePagination||(e(""),b(!0)),T(!0),Ue!=null&&Ue.preservePagination||(Kt(1),_t(1),dt.current.clear()),$e(!0),it(!1);try{const ht=await a8("clio",ve.id,J);if(ht&&Object.keys(ht).length>0){const It=ht.case_data||ht,zt=ht.client_data||{};J.info("Complete matter data fetched successfully",{sourceFile:Qt,matterId:ve.id,hasCalendarEntries:!!It.calendar_entries,hasLastCompletedTask:!!It.last_completed_task,hasNextUpcomingTask:!!It.next_upcoming_task,hasClientData:!!zt&&Object.keys(zt).length>0});const lr={};if(Object.entries(It).forEach(([wr,en])=>{lr[wr]=String(en??"")}),B(lr),er(lr),zt&&Object.keys(zt).length>0){et(zt);let wr="";if(zt.primary_email_address)wr=String(zt.primary_email_address);else if(zt.email_addresses)try{const en=JSON.parse(String(zt.email_addresses));Array.isArray(en)&&en.length>0&&(wr=en[0].address||"")}catch{const en=zt.email_addresses;Array.isArray(en)&&en.length>0&&(wr=en[0].address||"")}else zt.emails&&Array.isArray(zt.emails)&&(wr=String(zt.emails[0]||""));wr&&n(wr)}const mt=String(It.id||ve.id||""),Tt=(It.calendar_entries||[]).map(wr=>({...wr,case_id:mt}));le(Tt),Ue!=null&&Ue.preservePagination||(g([It]),j(0))}else{J.warn("Failed to fetch complete matter data, using basic data",{sourceFile:Qt,matterId:ve.id});const It={};Object.entries(ve).forEach(([zt,lr])=>{It[zt]=String(lr??"")}),B(It),er(It),le([]),Ue!=null&&Ue.preservePagination||(g([ve]),j(0))}}catch(ht){J.error("Error fetching complete matter data",ht,{sourceFile:Qt,matterId:ve.id}),it(!0);const It={};Object.entries(ve).forEach(([zt,lr])=>{It[zt]=String(lr??"")}),B(It),er(It),le([]),Ue!=null&&Ue.preservePagination||(g([ve]),j(0))}finally{$e(!1)}},[J,e,n,b,T,g,j,er,et,le]),kr=w.useCallback(async ve=>{if(Ke.current[ve]){const ht=Ke.current[ve];if("pagination"in ht&&ht.pagination!=null){console.log(` [Cache L1] Component cache HIT for ${ve}`),J.debug("Using cached client data (component cache)",{sourceFile:Qt,email:ve});return}console.log(` [Cache L1] Stale pre-pagination data for ${ve}, refetching`),delete Ke.current[ve]}console.log(` [Cache L2] Checking browser storage for ${ve}...`);const Ue=await vT(ve,J);if(Ue){if("pagination"in Ue&&Ue.pagination!=null){console.log(` [Cache L2] Browser storage HIT - SALVAGED data for ${ve}`),J.debug("Using cached client data (browser storage - salvaged)",{sourceFile:Qt,email:ve}),Ke.current[ve]=Ue;return}console.log(` [Cache L2] Stale pre-pagination data for ${ve}, clearing and refetching`),await $w(ve,J)}console.log(` [Cache L2] Browser storage MISS for ${ve}`);try{console.log(` [Cache L3] Fetching from SERVER for ${ve}...`),J.debug("Fetching client data from server",{sourceFile:Qt,email:ve});const ht=await X_("clio",ve,J,!1,{limit:Gt});Ke.current[ve]=ht}catch(ht){throw ht instanceof Error&&ht.message.includes("Client not found")?J.debug("Client not found for email",{sourceFile:Qt,email:ve}):J.error(`Error fetching client data for ${ve}`,ht,{sourceFile:Qt}),ht}},[J]),wn=w.useCallback(async()=>{J.info("fetchUserData called",{sourceFile:Qt,clientEmail:r});try{const ve=await l8(J,"clio");Ge(ve)}catch(ve){J.error("Error processing user data",ve,{sourceFile:Qt})}},[]),Dr=w.useCallback(async()=>{var ve;if(J.info("fetchClientData called",{sourceFile:Qt,clientEmail:r,hasClientEmail:!!r}),!r){J.info("fetchClientData early return",{sourceFile:Qt,reason:r?"clio not connected":"no client email",clientEmail:r});return}dt.current.clear(),Kt(1),_t(0),Or([]),j(0);try{if(ye(!0),Te(null),J.info("fetchClientData starting data fetch",{sourceFile:Qt,clientEmail:r,isLoading:!0}),!Ke.current[r])try{if(await kr(r),oe(r))return}catch(Tt){Tt instanceof Error&&Tt.message.includes("(cached)")?J.debug("Using cached knowledge that this client doesn't exist",{sourceFile:Qt,clientEmail:r}):Tt instanceof Error&&Tt.message.includes("Client not found")?J.debug("Client not found",{sourceFile:Qt,clientEmail:r}):(J.error("Error fetching client data",Tt,{sourceFile:Qt}),Te("both")),B({}),g([]),le([]),U({}),Ee({}),Y({}),ye(!1);return}const Ue=Ke.current[r];if(Ue!=null&&Ue.pagination?(_t(Ue.pagination.total_matters),Ue.pagination.matter_summaries&&Or(Ue.pagination.matter_summaries),dt.current.set(1,Ue.case_data||[])):(_t(((ve=Ue==null?void 0:Ue.case_data)==null?void 0:ve.length)??0),Or([])),!Ue){B({}),g([]),le([]),U({}),Ee({}),Y({}),ye(!1),$(r,!1);return}const ht=Lt(Ue);if($(r,ht),!ht){J.debug("Client data exists but is not valid",{sourceFile:Qt,clientEmail:r}),B({}),g([]),le([]),U({}),Ee({}),Y({}),ye(!1);return}if(oe(r))return;const It=Ue.client_data[0];J.debug("Client data received",{sourceFile:Qt,clientDataAsRecord:It}),et(It);const zt=Ue.case_data||[];g(zt),j(0);const lr=zt.flatMap(Tt=>{const wr=String(Tt.id||"");return(Tt.calendar_entries||[]).map(Ro=>({...Ro,case_id:wr}))});le(lr);const mt=zt.length>0?Object.entries(zt[0]).reduce((Tt,[wr,en])=>(Tt[wr]=String(en),Tt),{}):{};B(mt),er(mt)}catch(Ue){J.error("Error processing client data",Ue,{sourceFile:Qt}),Te("both"),B({}),g([]),le([]),r&&$(r,!1)}finally{ye(!1)}},[r,kr,J,et,er,g,$,Lt,j]),Yr=w.useCallback(ve=>{if(ve===Zt||ve<1)return;const Ue=Ut.length>0?Ut.length:Kr,ht=Math.ceil(Ue/Gt);if(!(ve>ht)){if(ve===1&&dt.current.get(1))g(dt.current.get(1));else{const It=(ve-1)*Gt,lr=Ut.slice(It,It+Gt).map(mt=>({id:mt.id,description:mt.description,display_number:mt.display_number}));g(lr)}Kt(ve),j(0),_t(Ut.length)}},[Zt,Ut,Kr,g,j]);w.useEffect(()=>{const ve=async()=>{if(!await wT(J))try{const It=(await IT("clio",J)).map(({id:zt,name:lr})=>({id:zt,name:lr}));await xT(It,J)}catch(ht){J.error("Error fetching firm users",ht,{sourceFile:Qt})}};wn(),ve()},[]),w.useEffect(()=>{(async()=>{var Ue,ht,It,zt;if(X&&X.clio){const lr=((ht=(Ue=X==null?void 0:X.clio)==null?void 0:Ue.timeTracking)==null?void 0:ht.enabled)||!1;Ae(lr);return}try{const lr=await we.getLocalItem("integrationSettings");if(lr&&lr.clio){const mt=((zt=(It=lr==null?void 0:lr.clio)==null?void 0:It.timeTracking)==null?void 0:zt.enabled)||!1;Ae(mt)}else Ae(!1)}catch(lr){J.error("Failed to fetch integration settings from storage",lr,{sourceFile:Qt}),Ae(!1)}})()},[X]),w.useEffect(()=>{V>0&&(J.info("Clearing component cache due to refresh trigger",{sourceFile:Qt,refreshTrigger:V}),Ke.current={},Promise.all(s.map(ve=>$w(ve,J))),sr(!1),r&&Dr())},[V]),w.useEffect(()=>{sr(!1),s.length===0&&Bt([])},[s]);const Nn=w.useCallback(()=>{J.info("All participant validations complete",{sourceFile:Qt,participantCount:s.length}),sr(!0)},[J,s.length]);Xq({emailParticipants:s,getClientDetailsForEmail:kr,clientDataCache:Ke,isValidClientData:Lt,onClientDataValidated:$,refreshTrigger:V,onTransientError:W,onValidationComplete:Nn}),w.useEffect(()=>{J.info("useEffect: client email or connection changed",{sourceFile:Qt,clientEmail:r,willFetchData:!!r}),r&&(J.info("Triggering fetchClientData from useEffect",{sourceFile:Qt,clientEmail:r}),Dr(),n(r),x&&!s.includes(r.toLowerCase())&&J.debug("Manually set email not in participants, validating separately",{sourceFile:Qt,clientEmail:r}))},[r,Dr,n,x,s,J]),w.useEffect(()=>{!x&&(!r||s.length===0)&&(n(null),U({}),Ee({}),le([]))},[r,s.length,x,n,U,Ee]),w.useEffect(()=>{if(J.info("useEffect: case index changed",{sourceFile:Qt,currentCaseIndex:p,casesCount:m.length,willUpdateCaseDetails:m.length>0&&p<m.length}),m.length>0&&p<m.length){const ve=m[p];J.info("Updating case details for index",{sourceFile:Qt,currentCaseIndex:p,caseData:ve?Object.keys(ve):null});const Ue=ve?Object.entries(ve).reduce((ht,[It,zt])=>(ht[It]=String(zt),ht),{}):{};B(Ue),er(Ue),J.info("Case details updated",{sourceFile:Qt,formattedCaseData:Ue})}},[p,m,er,J]);const xs=w.useCallback(ve=>{J.info("Contacts created, storing for matter linking",{sourceFile:Qt,contactCount:ve.length}),Bt(ve)},[J]),Us=w.useCallback(ve=>{J.info("Contact linked to matter successfully",{sourceFile:Qt})},[J]),To=w.useCallback(async ve=>{var ht,It;ye(!0);const Ue={id:((It=(ht=ve.projectId)==null?void 0:ht.native)==null?void 0:It.toString())||"",description:ve.projectName||"",practice_area:ve.projectTypeName||"",matter_stage:ve.phaseName||"",status:ve.isArchived?"Closed":"Open",client_name:ve.clientName||"",responsible_attorney:ve.firstPrimaryName||"",url:ve.projectUrl||"",name:ve.projectName||""};await zr(Ue).then(()=>{ye(!1)})},[zr]),Ai=w.useCallback(ve=>{const Ue=Ke.current[ve]?Ke.current[ve]:Ke.current[ve.toLowerCase()];if(Ue!=null&&Ue.client_data&&Array.isArray(Ue.client_data)&&Ue.client_data.length>0){const ht=Ue.client_data[0];return String(ht.name||"")}return null},[]),Nr=(de==="client"||de==="both")&&!xe,Dn=(de==="matter"||de==="both")&&!xe;return pe?u.jsxs("div",{className:"relative h-full",children:[u.jsxs("div",{className:"space-y-4 overflow-y-auto h-full mt-0 pb-32",children:[u.jsx(qq,{onMatterSelected:To}),u.jsx(Wq,{clientEmail:r,emailParticipants:s,emailParticipantClients:i,currentClientIndex:c,setCurrentClientIndex:d,setClientEmail:e,isManuallySet:x,selectedClientDetails:O,linkableFields:[{field:"Name",url:z.url||""}].filter(ve=>ve.url),isLoading:xe,ClientNavigation:P,handleSectionClick:()=>{},tempClientEmail:t||"",setTempClientEmail:n,setIsManuallySet:b,isValidClient:S||!1,isTempEmailValid:N||!1,showClientDocumentsButton:!1,isValidating:M,fetchError:Nr,hasTransientError:ie,onContactsCreated:xs,getClientNameFromCache:Ai,isClientDataValidationComplete:yt}),u.jsx(Vq,{clientEmail:r,selectedCaseDetails:ne,casesForCurrentClient:m,currentCaseIndex:p,linkableFields:[{field:"Title",url:te.url||""}].filter(ve=>ve.url),nextCase:R,prevCase:A,isLoading:xe,isManuallySet:x,setCurrentCaseIndex:j,calendarEntries:q,isValidating:M,matterId:te.id||"",onMatterManuallySelected:zr,fetchError:Dn,userData:Be,createdContacts:ct,onMatterLinked:Us,pageSize:Gt,currentPage:Zt,totalMatters:Kr,onNavigateToPage:Yr,allMatterSummaries:Ut,isLoadingMatterDetails:Se,matterDetailError:Nt})]}),Me&&u.jsx("div",{className:"fixed bottom-5 left-4 right-4 z-10 shadow-[0_-4px_12px_rgba(0,0,0,0.1)]",children:u.jsx(tK,{userData:Be,clientEmail:r,emailParticipantClients:i,currentCaseIndex:p,casesForCurrentClient:m})})]}):(J.info("ClioInsights not rendering - Clio not connected",{sourceFile:Qt,isClioConnected:pe}),null)},nK=({clientEmail:r,emailParticipants:e,emailParticipantClients:t,currentClientIndex:n,setCurrentClientIndex:s,setClientEmail:i,isManuallySet:c,selectedClientDetails:d,isLoading:p,ClientNavigation:m,handleSectionClick:g,tempClientEmail:x,setTempClientEmail:b,setIsManuallySet:E,isValidClient:T,isTempEmailValid:S,isValidating:N})=>{const R=()=>u.jsx(Ls,{rows:2});return u.jsxs("div",{className:"w-full min-h-[4rem] border border-border/50 rounded-lg shadow-sm bg-card text-card-foreground",title:"Client Information",children:[u.jsxs("div",{className:"flex items-center justify-between p-2 border-b bg-muted",children:[u.jsx("div",{className:"flex items-center gap-2",children:u.jsx("a",{href:"https://global.inszoom.com/CorpAttorney/aty_dashboard.aspx?phn_msg=False&QLogin=Y",target:"_blank",rel:"noopener noreferrer",className:"font-medium text-sm ml-2 hover:opacity-80 text-blue-700 dark:text-blue-400 underline underline-offset-4 decoration-blue-700 dark:decoration-blue-400 transition-opacity cursor-pointer",children:"CLIENT"})}),u.jsxs(Ms,{children:[u.jsx($s,{asChild:!0,children:u.jsx(ze,{variant:"ghost",size:"icon",className:"h-6 w-6",children:u.jsx(eo,{className:"h-4 w-4"})})}),u.jsx(vs,{align:"end",className:"p-2",children:u.jsx("div",{className:"flex flex-col gap-2 w-64",children:u.jsxs("div",{className:"flex gap-2 items-center",children:[u.jsx(on,{type:"email",value:x||"",onChange:A=>b(A.target.value),placeholder:"Set client email",className:`flex-1 px-2 py-1 h-8 text-xs ${S===!1?"border-red-300 focus:ring-red-500":""}`}),u.jsx(ze,{variant:"outline",size:"sm",className:`h-8 text-xs px-2 ${S===!1?"bg-red-50 hover:bg-red-100":""}`,onClick:()=>{i(x||"",!0)},disabled:!x,title:S===!1?"Warning: This email is not recognized as a valid client in INSZoom":"Set email as current client",children:"Search"})]})})})]})]}),p?R():u.jsxs(u.Fragment,{children:[t.length>1&&!c&&u.jsx(m,{}),c&&r&&u.jsx("div",{className:"px-3 py-1 bg-gray-50 dark:bg-gray-800 border-b dark:border-gray-700",children:u.jsxs("span",{className:"text-xs text-gray-600 dark:text-gray-300 truncate max-w-[200px]",title:r||"",children:[r," (Manually set)"]})}),N&&e.length>0&&t.length===0&&!c?u.jsx(Ls,{rows:2}):d&&Object.keys(d).length>0?u.jsx(eu,{details:d}):u.jsx("div",{className:"p-3 text-sm text-gray-600 dark:text-gray-400",children:u.jsx("p",{className:"mb-2",children:c&&r?`No client information found for ${r}`:e.length>0&&t.length===0?`No client information available for emails on the selected thread:
                      ${e.join(", ")}`:e.length>0?"No client information available for the selected email ID":"Select a clientemail thread to view client information"})})]})]})},sK=({clientEmail:r,selectedCaseDetails:e,casesForCurrentClient:t,currentCaseIndex:n,caseDetails:s,nextCase:i,prevCase:c,isLoading:d,setCurrentCaseIndex:p,isValidating:m=!1})=>{const[g,x]=w.useState(""),[b,E]=w.useState(!1),T=w.useMemo(()=>{if(!g.trim())return t;const A=g.toLowerCase();return t.filter(j=>{var $;return String(j.projectName||(($=j.Data)==null?void 0:$.CaseDescription)||"").toLowerCase().includes(A)})},[t,g]),S=A=>{E(A),A||x("")},N=()=>u.jsx(Ls,{rows:2}),R=A=>{if(p)p(A);else if(A>n)for(let j=n;j<A;j++)i();else if(A<n)for(let j=n;j>A;j--)c()};return u.jsxs("div",{className:"w-full min-h-[4rem] border border-border/50 rounded-lg shadow-sm bg-card text-card-foreground",title:"Case Information",children:[u.jsx("div",{className:"flex items-center justify-between p-2 border-b bg-muted",children:u.jsx("div",{className:"flex items-center gap-2",children:u.jsx("a",{href:"https://global.inszoom.com/CorpAttorney/aty_dashboard.aspx?phn_msg=False&QLogin=Y",target:"_blank",rel:"noopener noreferrer",className:"font-medium text-sm ml-2 hover:opacity-80 text-blue-700 dark:text-blue-400 underline underline-offset-4 decoration-blue-700 dark:decoration-blue-400 transition-opacity cursor-pointer",children:"CASES"})})}),d?N():e&&Object.keys(e).length>0?u.jsxs(u.Fragment,{children:[t.length>1&&u.jsx("div",{className:"flex justify-between items-center px-3 py-1 bg-gray-50 dark:bg-gray-800 border-b dark:border-gray-700",children:u.jsx("div",{className:"flex-1 flex items-center",children:u.jsxs(Ms,{open:b,onOpenChange:S,children:[u.jsx($s,{asChild:!0,children:u.jsxs(ze,{variant:"ghost",size:"sm",className:"h-8 text-sm text-gray-600 dark:text-gray-300 flex items-center gap-1 px-2",children:[u.jsx("span",{className:"truncate max-w-[180px]",title:e.Title||e["Case Description"]||"",children:e.Title||e["Case Description"]||"Case"}),u.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["(",n+1,"/",t.length,")"]}),u.jsx(ms,{className:"w-3 h-3 ml-1"})]})}),u.jsxs(vs,{align:"start",className:"w-[280px] p-0",children:[u.jsxs("div",{className:"p-2 border-b border-gray-200 dark:border-gray-700",children:[u.jsxs("div",{className:"relative",children:[u.jsx(eo,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),u.jsx(on,{placeholder:"Search cases...",value:g,onChange:A=>x(A.target.value),className:"pl-8 pr-8 h-8 text-xs",autoFocus:!0,onClick:A=>A.stopPropagation(),onKeyDown:A=>A.stopPropagation()}),g&&u.jsx("button",{onClick:A=>{A.stopPropagation(),x("")},className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:u.jsx(ki,{className:"w-4 h-4"})})]}),g&&u.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:["Showing ",T.length," of ",t.length]})]}),u.jsx("div",{className:"max-h-[200px] overflow-y-auto",children:T.length>0?T.map((A,j)=>{var W;const P=t.findIndex(M=>M===A),$=String(A.projectName||((W=A.Data)==null?void 0:W.CaseDescription)||`Case ${P+1}`);return u.jsx(rs,{className:`text-xs truncate ${P===n?"bg-gray-100 dark:bg-gray-700 font-medium":""}`,onClick:()=>R(P),title:$,children:$},P)}):u.jsxs("div",{className:"p-3 text-xs text-center text-gray-500 dark:text-gray-400",children:['No cases match "',g,'"']})})]})]})})}),u.jsx("div",{className:"break-words overflow-hidden",children:u.jsx(eu,{details:e,linkableFields:[{field:"Title",url:s.projectUrl}]})})]}):m?u.jsx(Ls,{rows:2}):u.jsx("div",{className:"p-3 text-sm text-gray-600 dark:text-gray-400",children:r?u.jsx(u.Fragment,{children:u.jsx("p",{className:"mb-2",children:"Select a client email thread to view case information"})}):"Select a client email thread to view case information"})]})},_r="src/sidepanel/panels/InsZoomInsights.tsx",Ko=r=>{if(!r)return"";try{return new Date(r).toLocaleDateString(void 0,{timeZone:"UTC"})}catch{return r}},y1=r=>{if(console.log("caseData",r),!r||Object.keys(r).length===0)return{};const e=n=>n.replace(/([a-z])([A-Z])/g,"$1 $2");return Object.entries(r).reduce((n,[s,i])=>{if(i!==null&&typeof i=="object"&&!Array.isArray(i)){let c=Object.entries(i);if(s==="report_fields")return console.log("formatting report_fields",c),Object.fromEntries(c),c.filter(([x,b])=>x!=="i797_valid_from"&&x!=="i797_valid_to"&&b!==null&&b!==void 0).forEach(([x,b])=>{let E=x.replace(/_/g," ").replace(/\b\w/g,S=>S.toUpperCase()).replace(/I797/g,"I-797").replace(/H Or L/g,"H/L"),T=String(b);T.includes(" 00:00:00")&&(T=Ko(T.split(" ")[0])),n[E]=T}),console.log("promoted report_fields to top level",Object.keys(n)),n;s==="MilestoneCompletedDate"&&(c=c.sort(([,x],[,b])=>{const E=new Date(String(x)),T=new Date(String(b)),S=!isNaN(E.getTime()),N=!isNaN(T.getTime());return S&&N?T.getTime()-E.getTime():S&&!N?-1:!S&&N?1:0}));const d=[],p=[];c.forEach(([x,b])=>{const E=new Date(String(b));!isNaN(E.getTime())?d.push([x,b]):p.push([x,b])});const m=d.map(([x,b])=>`[[${e(x)}]]:
    ((${b}))
`).join(`
`),g=p.length>0?`
[[Not Completed:]]
${p.map(([x])=>`  - ${e(x)}`).join(`
`)}
`:"";n[s]=m+g}else{const c=i!=null?String(i):"";c.includes(`
`)?n[s]=`
  ${c.replace(/\n/g,`
  `)}`:n[s]=c}return n},{})},oK=({clientEmail:r,setClientEmail:e,tempClientEmail:t,setTempClientEmail:n,emailParticipants:s,emailParticipantClients:i,currentClientIndex:c,setCurrentClientIndex:d,currentCaseIndex:p,casesForCurrentClient:m,setCasesForCurrentClient:g,isManuallySet:x,setIsManuallySet:b,isProjectManuallySelected:E,setIsProjectManuallySelected:T,isValidClient:S,isTempEmailValid:N,nextCase:R,prevCase:A,handleSetCurrentCaseIndex:j,ClientNavigation:P,onClientDataValidated:$,isValidating:W,refreshTrigger:M,integrationSettings:V})=>{const X=Ur(),[ie]=w.useState(!0),[J,ae]=w.useState({}),[we,ue]=w.useState({}),[oe,pe]=w.useState({}),[te,B]=w.useState(!1),z=w.useRef({}),Y=w.useCallback(q=>{if(!q||!q.client_data)return!1;const le=q.client_data;return le&&typeof le=="object"&&Object.keys(le).length>0},[]),O=w.useCallback(async(q,le=!1)=>{if(X.info("getClientDetailsForEmail called",{sourceFile:_r,email:q,hasCachedData:!!z.current[q],forceRefresh:le}),le&&z.current[q]&&(X.info("Force refresh requested - clearing component cache",{sourceFile:_r,email:q}),delete z.current[q]),z.current[q]&&!le){X.info("Using cached client data",{sourceFile:_r,email:q}),X.debug("Using cached client data",{sourceFile:_r,email:q});return}try{X.info("Starting client data fetch from server",{sourceFile:_r,email:q,forceRefresh:le}),X.debug("Fetching client data",{sourceFile:_r,email:q,forceRefresh:le});const xe=await X_("inszoom",q,X,le);if(xe&&xe.client_data&&xe.client_data.Data){const ye=xe.client_data.Data;let de="",Te="",Be="",Ge="";ye.ArrivalAndDepartureDetails&&typeof ye.ArrivalAndDepartureDetails=="object"&&ye.ArrivalAndDepartureDetails!==null&&"ImmigrantStatusOnI94"in ye.ArrivalAndDepartureDetails&&(de=String(ye.ArrivalAndDepartureDetails.ImmigrantStatusOnI94||""),Te=Ko(String(ye.ArrivalAndDepartureDetails.I94ValidFrom||"")),Be=Ko(String(ye.ArrivalAndDepartureDetails.DateOfExpiration||"")),Ge=String(ye.ArrivalAndDepartureDetails.I94Number||""));const Me={...xe.client_data,FirstName:String(ye.FirstName||""),LastName:String(ye.LastName||""),Email:String(ye.Email||q),FileNumber:String(ye.FileNumber||""),Category:String(ye.Category||""),ImmigrantStatusOnI94:de,I94ValidFrom:Te,I94ValidTo:Be,I94Number:Ge,...ye.report_fields&&{report_fields:ye.report_fields}};z.current[q]={client_data:Me,case_data:xe.case_data||[],timestamp:Date.now()}}else z.current[q]={client_data:xe.client_data,case_data:[],timestamp:Date.now()}}catch(xe){throw xe instanceof Error&&(xe.message.includes("Client not found")||xe.message.includes("(cached)"))?X.debug("Client not found for email (including cached)",{sourceFile:_r,email:q}):X.error(`Error fetching client data for ${q}`,xe,{sourceFile:_r}),xe}},[X]),U=w.useCallback(q=>{X.info("selectClientDetails called",{sourceFile:_r,hasDetails:!!q,detailsKeys:q?Object.keys(q):[]}),X.debug("Client details received for formatting",{sourceFile:_r,details:q});const le=q.FirstName&&q.LastName?`${q.FirstName} ${q.LastName}`:q.fullName||"";let xe="";if(q.visa_details&&typeof q.visa_details=="object"&&q.visa_details!==null){const Be=q.visa_details;Be.Data&&Array.isArray(Be.Data)&&(xe=Be.Data.map(Me=>{const Ae=String(Me.VisaType||""),ct=Ko(String(Me.IssuanceDate||"")),Bt=Ko(String(Me.ExpirationDate||""));return`[[${Ae}]]:
${ct} - ${Bt}
`}).join(`
`))}let ye="";if(q.passport_details&&typeof q.passport_details=="object"&&q.passport_details!==null){const Be=q.passport_details;Be.Data&&Array.isArray(Be.Data)&&(ye=Be.Data.map(Me=>{const Ae=String(Me.PassportNo||""),ct=String(Me.PassportType||""),Bt=String(Me.PassportIssuingCountry||""),yt=Ko(String(Me.PassportIssuanceDate||"")),sr=Ko(String(Me.PassportExpirationDate||""));return`[[${Bt} (${ct})]]
${Ae} :
${yt} - ${sr}
`}).join(`
`))}let de="";if(q.report_fields&&typeof q.report_fields=="object"&&q.report_fields!==null){const Be=q.report_fields,Ge=Be.priority_date_1||"",Me=Be.priority_date_1_country||"",Ae=Be.priority_date_2||"",ct=Be.priority_date_2_country||"",Bt=[];if(Ge||Me){const yt=`${Ge}${Me?` [${Me}]`:""}`;Bt.push(yt)}if(Ae||ct){const yt=`${Ae}${ct?` [${ct}]`:""}`;Bt.push(yt)}Bt.length>0&&(de=Bt.join(`
`))}const Te={Name:le,"Immigration Status":q.ImmigrantStatusOnI94||"","I-94 Number":q.I94Number||"","I-94 Validity":`${q.I94ValidFrom} - ${q.I94ValidTo}`||""};if(q.report_fields&&typeof q.report_fields=="object"&&q.report_fields!==null){const Be=q.report_fields,Ge=Be.i797_status||"";Te["I-797 Status"]=Ge;const Me=Be.i797_valid_from||"",Ae=Be.i797_valid_to||"";if(Me&&Me.trim()!==""||Ae&&Ae.trim()!==""){const ct=Me?Ko(Me.split(" ")[0]):"",Bt=Ae?Ko(Ae.split(" ")[0]):"";Te["I-797 Validity"]=`${ct} - ${Bt}`}else Te["I-797 Validity"]=""}else Te["I-797 Status"]="",Te["I-797 Validity"]="";if(Te["Passport Details"]=ye,Te["Visa Details"]=xe,q.report_fields&&typeof q.report_fields=="object"&&q.report_fields!==null){const Ge=q.report_fields.h_or_l_max_out_date||"";Ge&&Ge.includes(" 00:00:00")?Te["H/L Maxout Date"]=Ko(Ge.split(" ")[0]):Te["H/L Maxout Date"]=Ge}else Te["H/L Maxout Date"]="";if(Te["Priority Dates"]=de,q.report_fields&&typeof q.report_fields=="object"&&q.report_fields!==null){const Ge=q.report_fields.maxout_date_applicability_notes||"";Te["Maxout Date Applicability and Notes"]=Ge}else Te["Maxout Date Applicability and Notes"]="";X.info("Client details formatted and set",{sourceFile:_r,selectedDetails:Te,originalDetails:q}),ue(Te)},[X]),ne=w.useCallback(q=>{X.info("selectCaseDetails called",{sourceFile:_r,hasDetails:!!q,details:q||[]});const le={"Case Description":q.CaseDescription||q.projectName||"","Case Manager":q.WorkingCaseManagers_names||"","Case Status":q.CaseStatus||"","Opened Date":Ko(q.CaseOpenedDate)||"","Date Filed":Ko(q.DateSentToGovt)||""};le["Last Step Completed"]=q["Last Step Completed"]||"",le["Last Step Completed Date"]=Ko(q["Last Step Completed Date"])||"",le["Receipt Number"]=q["Receipt Number"]||"",le["Case Main Receipt Status"]=q["Case Main Receipt Status"]||"",X.info("Case details formatted and set",{sourceFile:_r,selectedDetails:le,originalDetails:q}),pe(le)},[X]),Ee=w.useCallback(async(q=!1)=>{if(X.info("fetchClientData called",{sourceFile:_r,clientEmail:r,isINSZoomConnected:ie,hasClientEmail:!!r,forceRefresh:q}),!r||!ie){X.info("fetchClientData early return",{sourceFile:_r,reason:r?"INSZoom not connected":"no client email",clientEmail:r,isINSZoomConnected:ie});return}try{if(B(!0),X.info("fetchClientData starting data fetch",{sourceFile:_r,clientEmail:r,isLoading:!0,forceRefresh:q}),q||!z.current[r]||z.current[r].timestamp<Date.now()-1e3*60*60*24)try{await O(r,q)}catch(Be){Be instanceof Error&&Be.message.includes("(cached)")?X.debug("Using cached knowledge that this client doesn't exist",{sourceFile:_r,clientEmail:r}):X.error("Error fetching client data",Be,{sourceFile:_r}),ae({}),g([]),ue({}),pe({}),B(!1);return}const le=z.current[r];if(!le){ae({}),g([]),ue({}),pe({}),B(!1),$(r,!1);return}const xe=Y(le);if($(r,xe),!xe){X.debug("Client data exists but is not valid",{sourceFile:_r,clientEmail:r}),ae({}),g([]),ue({}),pe({}),B(!1);return}const ye=le.client_data;U(ye);const Te=(le.case_data||[]).sort((Be,Ge)=>{const Me=Be.Data||Be,Ae=Ge.Data||Ge,ct=Me.CaseOpenedDate,Bt=Ae.CaseOpenedDate;if(!ct&&!Bt)return 0;if(!ct)return 1;if(!Bt)return-1;const yt=new Date(ct),sr=new Date(Bt),Gt=!isNaN(yt.getTime()),Zt=!isNaN(sr.getTime());return!Gt&&!Zt?0:Gt?Zt?sr.getTime()-yt.getTime():-1:1});if(g(Te),Te.length>0){const Be=Te[0].Data||Te[0],Ge=y1(Be);ae(Ge),ne(Ge)}else ae({}),ne({})}catch(le){X.error("Error processing client data",le,{sourceFile:_r}),ae({}),g([]),r&&$(r,!1)}finally{B(!1)}},[r,ie,O,X,U,ne,g,$,Y]);return w.useEffect(()=>{W&&s.length>0&&(z.current={},X.debug("Cleared component-level client data cache for refresh",{sourceFile:_r}))},[W,s.length,X]),w.useEffect(()=>{const q=async()=>{if(ie){X.info("Validating all email participants",{sourceFile:_r,participantCount:s.length});for(const le of s)try{await O(le);const xe=z.current[le],ye=Y(xe);$(le,ye),X.debug("Participant validation result",{sourceFile:_r,email:le,hasValidData:ye})}catch(xe){X.debug("Participant validation failed",{sourceFile:_r,email:le,error:xe}),$(le,!1)}}};s.length>0&&ie&&q()},[s,ie,O,Y,$,X,M]),w.useEffect(()=>{X.info("useEffect: client email or connection changed",{sourceFile:_r,clientEmail:r,isINSZoomConnected:ie,willFetchData:!!(r&&ie)}),r&&ie&&(X.info("Triggering fetchClientData from useEffect",{sourceFile:_r,clientEmail:r,isManuallySet:x}),Ee(x),n(r),x&&!s.includes(r.toLowerCase())&&X.debug("Manually set email not in participants, validating separately",{sourceFile:_r,clientEmail:r}))},[r,ie,Ee,n,x,s,X]),w.useEffect(()=>{(!r||s.length===0&&!x)&&(n(null),ue({}),pe({}))},[r,s.length,x,n,ue,pe]),w.useEffect(()=>{if(X.info("useEffect: case index changed",{sourceFile:_r,currentCaseIndex:p,casesCount:m.length,willUpdateCaseDetails:m.length>0&&p<m.length}),m.length>0&&p<m.length){const q=m[p];X.info("Updating case details for index",{sourceFile:_r,currentCaseIndex:p,caseData:q?Object.keys(q):null});const le=q.Data||q,xe=y1(le);ae(xe),ne(xe),X.info("Case details updated",{sourceFile:_r,formattedCaseData:Object.keys(xe)})}},[p,m,ne,X]),ie?(X.info("INSZoomInsights rendering components",{sourceFile:_r,clientEmail:r,selectedClientDetails:Object.keys(we),selectedCaseDetails:Object.keys(oe),isLoading:te}),u.jsxs("div",{className:"space-y-4 overflow-y-auto h-full mt-0",children:[u.jsx(nK,{clientEmail:r,emailParticipants:s,emailParticipantClients:i,currentClientIndex:c,setCurrentClientIndex:d,setClientEmail:e,isManuallySet:x,selectedClientDetails:we,isLoading:te,ClientNavigation:P,handleSectionClick:()=>{},tempClientEmail:t,setTempClientEmail:n,setIsManuallySet:b,isValidClient:S,isTempEmailValid:N,isValidating:W}),u.jsx(sK,{clientEmail:r,selectedCaseDetails:oe,casesForCurrentClient:m,currentCaseIndex:p,caseDetails:J,nextCase:R,prevCase:A,isLoading:te,setCurrentCaseIndex:j,isValidating:W})]})):(X.info("INSZoomInsights not rendering - INSZoom not connected",{sourceFile:_r,isINSZoomConnected:ie}),null)},iK=/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;function aK(r){return r.filter(e=>e&&e.trim().length>0&&iK.test(e.trim())).map(e=>e.trim().toLowerCase())}function lK(r,e){if(!e)return r;const t=e.toLowerCase(),n=t.split("@")[1];return n?["gmail.com","googlemail.com","outlook.com","hotmail.com","live.com","yahoo.com","ymail.com","aol.com","icloud.com","me.com","mac.com","protonmail.com","proton.me","mail.com","zoho.com","gmx.com","gmx.net","trycandle.ai"].includes(n)?r.filter(c=>c.toLowerCase()!==t):r.filter(c=>c.toLowerCase().split("@")[1]!==n):r}const aF={rawParticipants:[],sanitizedParticipants:[],emailsWithValidData:new Set,validatedEmails:new Set,selectedClient:"",currentClientIndex:0,isValidating:!1,isManuallySet:!1,isProjectManuallySelected:!1,refreshTrigger:0,integrationSettings:{},hasTransientError:!1};function cK(r,e){var t,n;switch(e.type){case"SET_RAW_PARTICIPANTS":{const s=aK(e.participants);return console.log(" [Reducer] SET_RAW_PARTICIPANTS:",{rawCount:((t=e.participants)==null?void 0:t.length)??0,sanitizedCount:s.length,raw:e.participants,sanitized:s,filtered:(n=e.participants)==null?void 0:n.filter(i=>!s.includes(i.toLowerCase().trim()))}),JSON.stringify(s)===JSON.stringify(r.sanitizedParticipants)?(console.log(" [Reducer] Participants unchanged, skipping update"),r):{...r,rawParticipants:e.participants,sanitizedParticipants:s,isValidating:s.length>0}}case"MARK_EMAIL_VALIDATED":{const s=new Set(r.validatedEmails);s.add(e.email.toLowerCase());const i=new Set(r.emailsWithValidData),c=e.email.toLowerCase(),d=r.selectedClient&&c===r.selectedClient.toLowerCase();e.isValid?i.add(c):(!r.isValidating||!d)&&i.delete(c);const p=r.sanitizedParticipants.length>0&&s.size>=r.sanitizedParticipants.length;return p&&d&&!e.isValid&&i.delete(c),{...r,validatedEmails:s,emailsWithValidData:i,isValidating:!p}}case"SELECT_CLIENT":return{...r,selectedClient:e.email,currentClientIndex:e.index,isManuallySet:e.isManual};case"SET_MANUALLY_SET":return{...r,isManuallySet:e.value};case"SET_PROJECT_MANUALLY_SELECTED":return{...r,isProjectManuallySelected:e.value};case"START_VALIDATION":return{...r,isValidating:!0};case"COMPLETE_VALIDATION":return{...r,isValidating:!1};case"RESET_STATE":return{...aF,refreshTrigger:r.refreshTrigger,hasTransientError:!1};case"REFRESH_DATA":{const s=new Set;return r.selectedClient&&s.add(r.selectedClient.toLowerCase()),{...r,emailsWithValidData:s,validatedEmails:new Set,isValidating:!0,isManuallySet:!1,isProjectManuallySelected:!1,refreshTrigger:r.refreshTrigger+1,hasTransientError:!1}}case"SET_INTEGRATION_SETTINGS":return{...r,integrationSettings:e.settings};case"SET_TRANSIENT_ERROR":return{...r,hasTransientError:e.hasError};default:return r}}function uK({platform:r,dataProvider:e,isIntegrationConnected:t}){const n=Ur(),[s,i]=w.useReducer(cK,aF),c=w.useRef(!1),d=w.useRef(0),p=Vl();w.useEffect(()=>{(async()=>{try{const V=await u8(n);Object.keys(V).length>0&&await p.setLocalItem("integrationSettings",V),i({type:"SET_INTEGRATION_SETTINGS",settings:V})}catch(V){n.error("Failed to fetch integration settings",V,{sourceFile:"src/shared/hooks/useEmailParticipants.ts"})}})()},[n]);const m=s.sanitizedParticipants.filter(M=>s.emailsWithValidData.has(M.toLowerCase())),g=w.useCallback((M,V)=>{n.info("Client data validation result received",{sourceFile:"useEmailParticipants.ts",email:M,isValid:V}),i({type:"MARK_EMAIL_VALIDATED",email:M,isValid:V})},[n]),x=w.useCallback((M,V,X=!1)=>{i({type:"SELECT_CLIENT",email:M,index:V,isManual:X})},[]),b=w.useCallback(M=>{i({type:"SET_MANUALLY_SET",value:M})},[]),E=w.useCallback(M=>{i({type:"SET_PROJECT_MANUALLY_SELECTED",value:M})},[]),T=w.useCallback((M,V)=>{n.warn("Transient error during validation - user should try again later",{sourceFile:"useEmailParticipants.ts",email:M,error:V.message}),i({type:"SET_TRANSIENT_ERROR",hasError:!0})},[n]),S=w.useCallback(()=>{n.debug("Resetting participant state",{sourceFile:"useEmailParticipants.ts"}),i({type:"RESET_STATE"})},[n]),N=w.useCallback(async()=>{const M=Date.now();if(M-d.current<50){n.debug("Debouncing fetchParticipants call",{sourceFile:"useEmailParticipants.ts"});return}d.current=M;try{if(r==="chrome"){const X=await e.getCurrentThreadId();if(X){n.info("Getting participants for Chrome",{sourceFile:"useEmailParticipants.ts",threadId:X}),console.log(` [Participants] Fetching for thread: ${X}`);try{const ie=await s8(X,n);console.log(` [Participants] Server returned ${(ie==null?void 0:ie.length)??0} participants:`,ie),n.info("Received participants from server",{sourceFile:"useEmailParticipants.ts",threadId:X,participantCount:(ie==null?void 0:ie.length)??0,participants:ie==null?void 0:ie.slice(0,5)}),(!ie||ie.length===0)&&(console.warn(` [Participants] No participants returned for thread ${X}`),n.warn("No participants returned from server",{sourceFile:"useEmailParticipants.ts",threadId:X})),i({type:"SET_RAW_PARTICIPANTS",participants:ie||[]})}catch(ie){console.error(` [Participants] Error fetching for thread ${X}:`,ie),n.error("Error fetching participants for Chrome",ie,{sourceFile:"useEmailParticipants.ts",threadId:X}),S()}}else console.warn(" [Participants] No threadId found for Chrome"),n.debug("No threadId found for Chrome",{sourceFile:"useEmailParticipants.ts"}),S()}else if(r==="outlook"){n.debug("Getting participants for Outlook",{sourceFile:"useEmailParticipants.ts"});try{const X=await e.getCurrentThread();if(X){let ie=X.participants;const J=e.getCurrentUserEmail();if(J){const ae=ie.length;ie=lK(ie,J),n.debug("Applied domain filtering for Outlook participants",{sourceFile:"useEmailParticipants.ts",userEmail:J,originalCount:ae,filteredCount:ie.length})}else n.warn("Could not get user email, skipping domain filtering",{sourceFile:"useEmailParticipants.ts"});i({type:"SET_RAW_PARTICIPANTS",participants:ie})}else n.debug("No thread found for Outlook",{sourceFile:"useEmailParticipants.ts"}),S()}catch(X){n.error("Error fetching participants for Outlook",X,{sourceFile:"useEmailParticipants.ts"}),S()}}}catch(X){n.error("Error in fetchParticipants",X,{sourceFile:"useEmailParticipants.ts"}),S()}},[r,e,n,S]),R=w.useCallback(async()=>{if(!(s.isValidating||s.sanitizedParticipants.length===0)){n.info("Starting participant data refresh",{sourceFile:"useEmailParticipants.ts",participantCount:s.sanitizedParticipants.length});try{await Promise.all(s.sanitizedParticipants.map(M=>$w(M,n))),i({type:"REFRESH_DATA"}),n.info("Participant data refresh initiated",{sourceFile:"useEmailParticipants.ts"})}catch(M){n.error("Error refreshing participant data",M,{sourceFile:"useEmailParticipants.ts"})}}},[s.isValidating,s.sanitizedParticipants,n]),A=m.length>0,j=m[0]??"",P=s.selectedClient?m.includes(s.selectedClient):!0,$=A&&!s.selectedClient&&!s.isManuallySet&&!s.isProjectManuallySelected,W=!s.isValidating&&s.selectedClient&&!P&&!s.isManuallySet&&!s.isProjectManuallySelected;return w.useEffect(()=>{$?(n.info("Auto-selecting first validated client",{sourceFile:"useEmailParticipants.ts",selectedClient:j}),i({type:"SELECT_CLIENT",email:j,index:0,isManual:!1})):W&&(n.info("Current client no longer valid, clearing",{sourceFile:"useEmailParticipants.ts",clientEmail:s.selectedClient}),i({type:"SELECT_CLIENT",email:"",index:0,isManual:!1}))},[$,W,j,s.selectedClient,n]),w.useEffect(()=>{if(e!=null&&e.onThreadChanged){const M=V=>{V?(n.debug("Thread changed",{sourceFile:"useEmailParticipants.ts",newThreadId:V.threadId}),i({type:"RESET_STATE"}),N()):(n.info("Thread cleared",{sourceFile:"useEmailParticipants.ts"}),i({type:"RESET_STATE"}))};return e.onThreadChanged(M),()=>{e.removeThreadListener&&e.removeThreadListener(M)}}},[e,N,n]),w.useEffect(()=>{t&&!c.current&&(c.current=!0,N())},[t,N]),{validClients:m,selectedClient:s.selectedClient,currentClientIndex:s.currentClientIndex,sanitizedParticipants:s.sanitizedParticipants,isValidating:s.isValidating,isManuallySet:s.isManuallySet,isProjectManuallySelected:s.isProjectManuallySelected,refreshTrigger:s.refreshTrigger,integrationSettings:s.integrationSettings,hasTransientError:s.hasTransientError,selectClient:x,setManuallySet:b,setProjectManuallySelected:E,handleClientDataValidated:g,handleTransientError:T,refresh:R,resetState:S}}function dK({toggleSection:r,clientEmail:e,setClientEmail:t,setProjectId:n,setDocuments:s,setIsDocumentsLoading:i,setDocumentsError:c,onDocumentView:d}){const p=Ur(),m=cn().platform,g=fd();Vl();const{isConnected:x}=ra(),[b,E]=w.useState([]),[T,S]=w.useState(null),[N,R]=w.useState(!0),[A,j]=w.useState(0),[P,$]=w.useState([]),[W,M]=w.useState(null),[V,X]=w.useState(null),[ie,J]=w.useState(!1),[ae,we]=w.useState(!1),[ue,oe]=w.useState(!1),pe=ie||ae||ue,{validClients:te,selectedClient:B,currentClientIndex:z,sanitizedParticipants:Y,isValidating:O,isManuallySet:U,isProjectManuallySelected:ne,refreshTrigger:Ee,integrationSettings:q,hasTransientError:le,selectClient:xe,setManuallySet:ye,setProjectManuallySelected:de,handleClientDataValidated:Te,handleTransientError:Be,refresh:Ge}=uK({platform:m,dataProvider:g,isIntegrationConnected:pe});w.useEffect(()=>{t(B)},[B,t]),w.useEffect(()=>{(async()=>{await bI(p)})()},[p]);const Me=w.useCallback(()=>{if(A<P.length-1){const _t=A+1;j(_t)}},[A,P.length]),Ae=w.useCallback(()=>{if(A>0){const _t=A-1;j(_t)}},[A]),ct=w.useRef(P.length);ct.current=P.length;const Bt=w.useCallback(_t=>{_t>=0&&_t<ct.current&&j(_t)},[]);w.useEffect(()=>{j(0)},[B]);const yt=w.useCallback(({className:_t="",clientUrl:Se})=>u.jsxs("div",{className:`flex items-center px-3 py-1 bg-gray-50 dark:bg-gray-800 border-b dark:border-gray-700 gap-2 ${_t}`,children:[u.jsx("div",{className:"flex-1 min-w-0 flex items-center",children:u.jsxs(Ms,{children:[u.jsx($s,{asChild:!0,children:u.jsxs(ze,{variant:"ghost",size:"sm",className:"h-8 text-sm text-gray-600 dark:text-gray-300 flex items-center gap-1 px-2 max-w-full",children:[u.jsx("span",{className:"truncate",title:B||"",children:B||"No client"}),u.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400 flex-shrink-0",children:["(",z+1,"/",te.length,")"]}),u.jsx(ms,{className:"w-3 h-3 ml-1 flex-shrink-0"})]})}),u.jsx(vs,{align:"start",className:"max-h-[200px] overflow-y-auto",children:te.map(($e,Nt)=>u.jsx(rs,{className:`text-xs ${Nt===z?"bg-gray-100 dark:bg-gray-700 font-medium":""}`,onClick:()=>{xe($e,Nt,!1)},children:$e},$e))})]})}),Se&&u.jsxs("a",{href:Se,target:"_blank",rel:"noopener noreferrer",className:"h-8 text-xs text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 border border-blue-200 dark:border-blue-800 px-3 flex-shrink-0 rounded-md inline-flex items-center gap-1 no-underline hover:no-underline",children:[u.jsx(Ml,{className:"w-3 h-3"}),"View"]})]}),[B,z,te,xe]);w.useEffect(()=>{(async()=>{try{const Se=await _I(p),$e=Se.some(dt=>dt.integration_type==="filevine"),Nt=Se.some(dt=>dt.integration_type==="clio"),it=Se.some(dt=>dt.integration_type==="inszoom");J($e),we(Nt),oe(it)}catch(Se){p.error("Error checking integration connections",Se,{sourceFile:"src/shared/components/sidepanel/panels/IsngitsPanel.tsx"})}})()},[p]),w.useEffect(()=>{(async()=>{try{const Se=await Qm(p);E(Se||[]);const $e=(Se==null?void 0:Se.some(Ut=>Ut.integration_type.toLowerCase()==="filevine"))||!1,Nt=(Se==null?void 0:Se.some(Ut=>Ut.integration_type.toLowerCase()==="clio"))||!1,it=(Se==null?void 0:Se.some(Ut=>Ut.integration_type.toLowerCase()==="inszoom"))||!1;let dt=null;if($e?dt="filevine":Nt?dt="clio":it&&(dt="inszoom"),dt){const Ut=await NE(dt);S(Ut)}else S(null)}catch(Se){p.error("Error fetching integrations:",Se,{sourceFile:"src/shared/components/sidepanel/panels/IsngitsPanel.tsx"})}finally{R(!1)}})()},[p]);const sr=b.some(_t=>_t.integration_type.toLowerCase()==="filevine"),Gt=b.some(_t=>_t.integration_type.toLowerCase()==="clio"),Zt=b.some(_t=>_t.integration_type.toLowerCase()==="inszoom");w.useEffect(()=>{X(W?!0:null)},[W]);const Kt={clientEmail:B,setClientEmail:(_t,Se)=>{if(!_t)xe("",0,!1);else{const $e=te.indexOf(_t),Nt=Se===!0?!0:$e<0;xe(_t,$e>=0?$e:0,Nt)}},tempClientEmail:W,setTempClientEmail:M,emailParticipants:Y,emailParticipantClients:te,currentClientIndex:z,setCurrentClientIndex:_t=>{const Se=te[_t];Se?xe(Se,_t,!1):(p.warn("Invalid client index",{sourceFile:"src/shared/components/sidepanel/panels/IsngitsPanel.tsx",index:_t,availableClients:te.length}),xe("",0,!1))},currentCaseIndex:A,casesForCurrentClient:P,setCasesForCurrentClient:$,isManuallySet:U,setIsManuallySet:_t=>{ye(_t)},isProjectManuallySelected:ne,setIsProjectManuallySelected:de,isValidClient:B?!0:null,isTempEmailValid:V,nextCase:Me,prevCase:Ae,handleSetCurrentCaseIndex:Bt,ClientNavigation:yt,onClientDataValidated:Te,onTransientError:Be,isValidating:O,refreshTrigger:Ee,integrationSettings:q,hasTransientError:le},Kr=m==="chrome"&&!x;return u.jsx("div",{className:"h-full",children:Kr?u.jsx("div",{className:"p-4",children:u.jsx(bE,{feature:"Insights",description:"Connect your Gmail account to view client insights and case information",benefits:["Automatically identify clients from email participants","View relevant case information and documents","Access client details from your case management system"]})}):N?u.jsxs("div",{className:"flex flex-col items-center justify-center h-full",children:[u.jsx(Zi,{className:"h-8 w-8 animate-spin text-blue-600"}),u.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"Loading integrations..."})]}):u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"flex items-center mb-1",children:u.jsx("span",{className:"font-small text-xs text-slate-800 dark:text-gray-400",children:"Data provided by"})}),u.jsxs("div",{className:"flex items-center justify-between mb-2",children:[T&&u.jsxs("a",{href:T.homeUrl,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 hover:opacity-80 text-blue-700 dark:text-blue-400 underline underline-offset-4 decoration-blue-700 dark:decoration-blue-400 transition-opacity cursor-pointer",children:[u.jsx(Mc,{src:T.logo,width:20,height:20,alt:T.name,className:"h-5 w-auto dark:brightness-0 dark:invert"}),u.jsx("span",{className:"font-small text-xs text-slate-800 dark:text-gray-300",children:T.name})]}),u.jsx(ze,{size:"icon",variant:"outline",onClick:Ge,disabled:O||Y.length===0,className:"flex items-center h-6 w-6 mr-4",title:O?"Refreshing...":Y.length===0?"No participants to refresh":"Refresh participant data",children:u.jsx(No,{className:`h-3 w-3 ${O?"animate-spin":""}`})})]}),sr&&u.jsx(zq,{toggleSection:r,setDocuments:s,setIsDocumentsLoading:i,setDocumentsError:c,setProjectId:n,onDocumentView:d,...Kt}),Gt&&u.jsx(rK,{...Kt}),Zt&&u.jsx(oK,{...Kt})]})})}const fK={showEmailSummary:!1,showInsightsTab:!0,showComposeTab:!0,showTemplatesTab:!0},hK=()=>fK,pK=r=>hK()[r],mK=({className:r=""})=>{const[e,t]=w.useState(!1),{isConnected:n,wasEverConnected:s,isLoading:i,error:c,status:d,reconnectAttempts:p,initiateReconnection:m,clearError:g}=ra(),{platform:x}=cn();if(x!=="chrome"||n&&d!=="error"||e)return null;const b=async()=>{try{await m()}catch(j){console.error("Failed to reconnect Gmail:",j)}},E=()=>{t(!0),c&&g()},T=()=>d==="error"?"bg-red-50 border-red-200":s?"bg-yellow-50 border-yellow-200":"bg-blue-50 border-blue-200",S=()=>d==="error"?u.jsx(oh,{className:"h-4 w-4 text-red-600 flex-shrink-0"}):s?u.jsx(oh,{className:"h-4 w-4 text-yellow-600 flex-shrink-0"}):u.jsx(oh,{className:"h-4 w-4 text-blue-600 flex-shrink-0"}),N=()=>d==="error"?c||"Gmail connection error occurred":s?"Gmail connection lost. Some features may not work properly.":"Gmail connection required to access all features.",R=()=>d==="error"?"text-red-800":s?"text-yellow-800":"text-blue-800",A=()=>d==="error"?"bg-red-100 border-red-300 text-red-800 hover:bg-red-200 hover:border-red-400":s?"bg-yellow-100 border-yellow-300 text-yellow-800 hover:bg-yellow-200 hover:border-yellow-400":"bg-blue-100 border-blue-300 text-blue-800 hover:bg-blue-200 hover:border-blue-400";return u.jsxs("div",{className:`flex items-center justify-between ${T()} px-4 py-3 ${r}`,role:"alert","aria-live":"polite","aria-atomic":"true",children:[u.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[S(),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("p",{className:`text-sm ${R()} font-medium`,children:N()}),p>0&&u.jsxs("p",{className:`text-xs ${R()} opacity-75 mt-1`,children:["Reconnect attempts: ",p]})]})]}),u.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[u.jsx(ze,{onClick:b,disabled:i,variant:"outline",size:"sm",className:`${A()} text-xs px-3 py-1 h-auto whitespace-nowrap`,"aria-label":i?"Connecting to Gmail...":s?"Reconnect Gmail account":"Connect Gmail account",children:i?u.jsxs(u.Fragment,{children:[u.jsx(No,{className:"h-3 w-3 mr-1 animate-spin","aria-hidden":"true"}),"Connecting..."]}):s?"Reconnect Gmail":"Connect Gmail"}),u.jsx(ze,{onClick:E,variant:"ghost",size:"sm",className:`${d==="error"?"text-red-600 hover:text-red-800 hover:bg-red-100":s?"text-yellow-600 hover:text-yellow-800 hover:bg-yellow-100":"text-blue-600 hover:text-blue-800 hover:bg-blue-100"} p-1 h-auto`,"aria-label":"Dismiss Gmail connection banner",children:u.jsx(ki,{className:"h-4 w-4","aria-hidden":"true"})})]})]})},lF=w.createContext(void 0),cF=()=>{const r=w.useContext(lF);if(r===void 0)throw new Error("useToast must be used within a ToastProvider");return r},gK=({children:r})=>{const[e,t]=w.useState([]),n=w.useCallback(d=>{const p=Math.random().toString(36).substr(2,9),m={...d,id:p};t(x=>[...x,m]);const g=d.duration??5e3;return g>0&&setTimeout(()=>{t(x=>x.filter(b=>b.id!==p))},g),p},[]),s=w.useCallback(d=>{t(p=>p.filter(m=>m.id!==d))},[]),i=w.useCallback(()=>{t([])},[]),c={toasts:e,addToast:n,removeToast:s,clearAll:i};return u.jsxs(lF.Provider,{value:c,children:[r,u.jsx(vK,{})]})},vK=()=>{const{toasts:r,removeToast:e}=cF();return r.length===0?null:u.jsx("div",{className:"fixed top-4 right-4 z-50 flex flex-col gap-2 max-w-sm",children:r.map(t=>u.jsx(yK,{toast:t,onRemove:e},t.id))})},yK=({toast:r,onRemove:e})=>{const t=s=>{switch(s){case"success":return u.jsx(Wc,{className:"h-5 w-5 text-green-600"});case"error":return u.jsx(oh,{className:"h-5 w-5 text-red-600"});case"warning":return u.jsx(JR,{className:"h-5 w-5 text-amber-600"});case"info":return u.jsx(Kc,{className:"h-5 w-5 text-blue-600"});default:return null}},n=s=>{switch(s){case"success":return"bg-green-50 border-green-200";case"error":return"bg-red-50 border-red-200";case"warning":return"bg-amber-50 border-amber-200";case"info":return"bg-blue-50 border-blue-200";default:return"bg-gray-50 border-gray-200"}};return u.jsxs("div",{className:`flex items-start gap-3 p-4 rounded-lg border shadow-lg animate-in slide-in-from-right-full ${n(r.type)}`,children:[t(r.type),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("p",{className:"text-sm font-medium text-gray-900",children:r.title}),r.description&&u.jsx("p",{className:"text-sm text-gray-600 mt-1",children:r.description}),r.action&&u.jsx(ze,{onClick:r.action.onClick,variant:"outline",size:"sm",className:"mt-2 h-7 text-xs",children:r.action.label})]}),u.jsx(ze,{onClick:()=>e(r.id),variant:"ghost",size:"sm",className:"p-1 h-auto",children:u.jsx(ki,{className:"h-4 w-4"})})]})},xK=()=>{const{addToast:r}=cF(),e=w.useCallback(()=>{r({type:"success",title:"Gmail Connected",description:"Successfully connected to Gmail. All features are now available.",duration:4e3})},[r]),t=w.useCallback(c=>{r({type:"warning",title:"Gmail Connection Lost",description:"Some features may not work properly until you reconnect.",duration:0,action:c?{label:"Reconnect",onClick:c}:void 0})},[r]),n=w.useCallback((c,d)=>{r({type:"error",title:"Gmail Connection Error",description:c,duration:0,action:d?{label:"Retry",onClick:d}:void 0})},[r]),s=w.useCallback(()=>{r({type:"success",title:"Gmail Reconnected",description:"Successfully reconnected to Gmail.",duration:3e3})},[r]),i=w.useCallback(c=>{r({type:"error",title:"Reconnection Failed",description:"Failed to reconnect to Gmail. Please try again.",duration:0,action:c?{label:"Try Again",onClick:c}:void 0})},[r]);return{showConnectionSuccess:e,showConnectionLost:t,showConnectionError:n,showReconnectionSuccess:s,showReconnectionFailed:i}},wK=()=>{const{status:r,error:e,isConnected:t,initiateReconnection:n}=ra(),{platform:s}=cn(),{showConnectionSuccess:i,showConnectionLost:c,showConnectionError:d,showReconnectionSuccess:p,showReconnectionFailed:m}=xK(),g=w.useRef("loading"),x=w.useRef(!0),b=w.useRef(!1);return w.useEffect(()=>{if(s!=="chrome")return;const E=g.current,T=x.current,S=b.current;if(!(!S&&r==="loading")){if(!S){b.current=!0,g.current=r,x.current=t;return}if(E!==r||T!==t)switch(r){case"connected":(E==="disconnected"||E==="error"||!T)&&(E==="loading"?p():i());break;case"disconnected":T&&E==="connected"&&c(()=>{n().catch(R=>{console.error("Failed to reconnect from toast:",R)})});break;case"error":d(e||"Unknown connection error occurred",()=>{n().catch(R=>{console.error("Failed to reconnect from toast:",R),m(()=>{n().catch(console.error)})})});break}g.current=r,x.current=t}},[r,e,t,s,n,i,c,d,p,m]),null},bK=({activeSection:r,toggleSection:e})=>{const t=Ur();t.debug(`[MainPanelContent] Rendering with activeSection: "${r}"`,{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx",functionName:"MainPanelContent",data:{activeSection:r}});const n=PT(),s=Vl(),{platform:i}=cn(),{isConnected:c,wasEverConnected:d}=ra(),p=i==="chrome"&&!c&&d,[m,g]=w.useState(""),[x,b]=w.useState(""),[E,T]=w.useState([]),[S,N]=w.useState(!1),[R,A]=w.useState(null),[j,P]=w.useState(null),[$,W]=w.useState("compose"),[M,V]=w.useState(!1),[X,ie]=w.useState(!1),[J,ae]=w.useState(!1),we=w.useRef(!1),ue=w.useRef(!1),oe=w.useRef(null),pe=w.useCallback(async()=>{try{t.info("Checking authentication status...",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"});const Y=await(n==null?void 0:n.isAuthenticated());return t.info("Authentication status checked",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx",authenticated:Y}),Y||!1}catch(Y){return t.error("Failed to check auth status",Y,{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"}),!1}},[n,t]);w.useEffect(()=>{t.info("MainPanelContent component loaded",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"});const Y=async()=>{const U=await pe();ie(!0),ae(U),U?(t.info("Valid token found. User is authenticated.",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"}),r==="login"&&e("main")):(t.info("No valid token found. Show login page.",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"}),e("login"))},O=U=>{U.token&&(t.info("Token detected in storage, auth state will be updated automatically",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"}),Y(),Vy(t))};return s!=null&&s.onChanged&&s.onChanged(O),Y(),()=>{s!=null&&s.removeChangeListener&&s.removeChangeListener(O)}},[n,s,e,t,pe,r]),w.useEffect(()=>{t.info("MainPanelContent component loaded",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"})},[s,t]),w.useEffect(()=>{if(!X||!J||ue.current){t.debug("Skipping CMS integration check - auth not ready, not authenticated, or already checked",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx",isAuthChecked:X,isAuthenticated:J,hasRunInitialCheck:ue.current});return}ue.current=!0;const Y=async()=>{try{t.info("Checking Case Management System connection status",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"});const U=await wI(t);t.info("Case Management System connection status result",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx",connected:U}),V(U),we.current||(U?(t.info("CMS connected, setting active tab to insights",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"}),W("insights")):(t.info("CMS not connected, setting active tab to compose",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"}),W("compose")),we.current=!0)}catch(U){t.error("Error checking Case Management System connection",U,{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"}),V(!1),we.current||(W("compose"),we.current=!0)}},O=U=>{if(!U.integrations)return;t.info("Integrations changed via storage, rechecking CMS connection",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx",oldValue:U.integrations.oldValue,newValue:U.integrations.newValue});const ne=U.integrations.newValue;if(!Array.isArray(ne))return;const Ee=["inszoom","filevine","clio"];ne.some(le=>Ee.includes(le.integration_type))&&(t.info("CMS integration found",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx",newValue:U.integrations.newValue}),V(!0))};return Y(),s!=null&&s.onChanged&&s.onChanged(O),()=>{s!=null&&s.removeChangeListener&&s.removeChangeListener(O)}},[X,J,t,s]);const te=Y=>{W(Y),e(Y==="login"?"login":"main")},B=()=>{t.debug("[MainPanelContent] goBack called. Setting activeSection to null.",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx",functionName:"goBack"}),e("main"),P(null)},z=Y=>{t.debug("[MainPanelContent] handleDocumentView called",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx",functionName:"handleDocumentView",data:{document:Y}}),P(Y),e("Project Documents")};return w.useEffect(()=>{r==="Project Documents"&&oe.current&&(oe.current.scrollTop=0)},[r]),u.jsxs(gK,{children:[u.jsx(wK,{}),u.jsxs("div",{ref:oe,className:`flex flex-col h-full relative ${r==="login"||r==="Project Documents"?"overflow-hidden":"overflow-y-auto"}`,children:[r!=="login"&&u.jsx(mK,{className:"flex-shrink-0"}),u.jsxs("div",{className:"flex flex-col",children:[pK("showEmailSummary")&&u.jsx("div",{className:"flex-shrink-0 border-b-2 border-gray-300",children:u.jsx(_9,{})}),u.jsx("div",{className:"flex-grow flex flex-col",children:p?u.jsx("div",{className:"flex-grow"}):u.jsxs(H9,{defaultValue:M?"insights":"compose",value:$,onValueChange:te,className:"w-full flex flex-col",children:[u.jsxs(BI,{className:`grid ${M?"grid-cols-3":"grid-cols-2"} w-full bg-white dark:bg-card border-b dark:border-border p-0 h-auto flex-shrink-0`,children:[M&&u.jsx(ny,{value:"insights",className:"m-2 mb-0 text-gray-600 dark:text-gray-200 data-[state=active]:text-blue-600 dark:data-[state=active]:text-blue-400 data-[state=active]:bg-white dark:data-[state=active]:bg-muted data-[state=active]:shadow-sm data-[state=active]:font-medium border-gray-200 dark:border-border data-[state=active]:border-b-2 data-[state=active]:border-b-blue-600 dark:data-[state=active]:border-b-blue-400",children:"Insights"}),u.jsx(ny,{value:"compose",className:"m-2 mb-0 text-gray-600 dark:text-gray-200 data-[state=active]:text-blue-600 dark:data-[state=active]:text-blue-400 data-[state=active]:bg-white dark:data-[state=active]:bg-muted data-[state=active]:shadow-sm data-[state=active]:font-medium border-gray-200 dark:border-border data-[state=active]:border-b-2 data-[state=active]:border-b-blue-600 dark:data-[state=active]:border-b-blue-400",children:"Compose"}),u.jsx(ny,{value:"templates",className:"m-2 mb-0 text-gray-600 dark:text-gray-200 data-[state=active]:text-blue-600 dark:data-[state=active]:text-blue-400 data-[state=active]:bg-white dark:data-[state=active]:bg-muted data-[state=active]:shadow-sm data-[state=active]:font-medium border-gray-200 dark:border-border data-[state=active]:border-b-2 data-[state=active]:border-b-blue-600 dark:data-[state=active]:border-b-blue-400",children:"Templates"})]}),u.jsxs("div",{className:"flex-grow mb-0",children:[M&&u.jsx(sy,{forceMount:!0,value:"insights",className:`p-4 ${$==="insights"?"block":"hidden"}`,children:u.jsx(dK,{toggleSection:e,clientEmail:m,setClientEmail:g,setProjectId:b,setDocuments:T,setIsDocumentsLoading:N,setDocumentsError:A,onDocumentView:z})}),u.jsx(sy,{forceMount:!0,value:"compose",className:`p-4 ${$==="compose"?"block":"hidden"}`,children:u.jsx(u9,{clientEmail:m})}),u.jsx(sy,{forceMount:!0,value:"templates",className:`p-4 ${$==="templates"?"block":"hidden"}`,children:u.jsx(S7,{clientEmail:m,isAuthenticated:J})})]})]})})]})," ",r==="login"&&u.jsx("div",{className:"fixed inset-0 bg-white dark:bg-gray-950 z-50",children:u.jsx(d9,{})}),r==="Project Documents"&&(t.debug('[MainPanelContent] activeSection is "Project Documents". Rendering overlay.',{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx",functionName:"MainPanelContent.render",data:{activeSection:r,selectedDocumentToView:j}}),u.jsx("div",{className:"absolute inset-0 bg-white dark:bg-gray-950 z-10",children:j?u.jsx(GI,{documentId:j.documentId,documentName:j.name,onBack:B}):u.jsx(W9,{clientEmail:m,projectId:x,documents:E,isLoading:S,error:R,goBack:B})}))]})]})},_K=()=>{var x;const[r,e]=w.useState(null),t=Ur(),{platform:n}=cn(),s=fd(),{isConnected:i}=ra();if(w.useEffect(()=>{var S,N;if(n!=="chrome")return;const b=async()=>{var R;try{if((R=chrome==null?void 0:chrome.tabs)!=null&&R.query){const[A]=await chrome.tabs.query({active:!0,currentWindow:!0});if(A!=null&&A.id&&(A!=null&&A.windowId)){let j;try{const P=await(s==null?void 0:s.getCurrentThread());j=P==null?void 0:P.subject}catch(P){t.debug("Could not get email thread subject",{sourceFile:"src/shared/components/sidepanel/TabIndicator.tsx",sourceFunction:"getCurrentTabInfo",error:P})}e({tabId:A.id,windowId:A.windowId,title:A.title,url:A.url,emailSubject:j}),t.debug("Updated tab info in indicator",{sourceFile:"src/shared/components/sidepanel/TabIndicator.tsx",sourceFunction:"getCurrentTabInfo",tabId:A.id,windowId:A.windowId,title:A.title,emailSubject:j})}}}catch(A){t.error("Error getting current tab info",A,{sourceFile:"src/shared/components/sidepanel/TabIndicator.tsx",sourceFunction:"getCurrentTabInfo"})}};b();const E=[];if((S=chrome==null?void 0:chrome.tabs)!=null&&S.onActivated){const R=A=>{t.debug("Tab activated in indicator",{sourceFile:"src/shared/components/sidepanel/TabIndicator.tsx",sourceFunction:"handleTabActivated",tabId:A.tabId,windowId:A.windowId}),setTimeout(b,200)};chrome.tabs.onActivated.addListener(R),E.push(()=>{var A,j;(j=(A=chrome==null?void 0:chrome.tabs)==null?void 0:A.onActivated)!=null&&j.removeListener&&chrome.tabs.onActivated.removeListener(R)})}if((N=chrome==null?void 0:chrome.tabs)!=null&&N.onUpdated){const R=(A,j,P)=>{var $;j.url&&P.active&&P.windowId&&(t.debug("Tab URL updated, refreshing tab indicator",{sourceFile:"src/shared/components/sidepanel/TabIndicator.tsx",sourceFunction:"handleTabUpdated",tabId:A,newUrl:j.url}),setTimeout(b,300)),j.status==="complete"&&P.active&&(($=P.url)!=null&&$.includes("mail.google.com"))&&setTimeout(b,500)};chrome.tabs.onUpdated.addListener(R),E.push(()=>{var A,j;(j=(A=chrome==null?void 0:chrome.tabs)==null?void 0:A.onUpdated)!=null&&j.removeListener&&chrome.tabs.onUpdated.removeListener(R)})}if(s!=null&&s.onThreadChanged){const R=()=>{t.debug("Thread data changed, updating tab indicator",{sourceFile:"src/shared/components/sidepanel/TabIndicator.tsx",sourceFunction:"handleThreadChanged"}),setTimeout(b,100)};s.onThreadChanged(R),E.push(()=>{s.removeThreadListener&&s.removeThreadListener(R)})}const T=setInterval(()=>{b()},3e3);return E.push(()=>{clearInterval(T)}),()=>{E.forEach(R=>R())}},[n,t,s]),n!=="chrome"||!r||!i)return null;const c=()=>{var b;return r.emailSubject&&r.emailSubject!=="No Subject"?r.emailSubject.length>50?`${r.emailSubject.substring(0,50)}...`:r.emailSubject:(b=r.url)!=null&&b.includes("mail.google.com")?"Open an email to begin":r.title?r.title.length>30?`${r.title.substring(0,30)}...`:r.title:"No content available"},d=()=>{var b;return r.emailSubject&&r.emailSubject!=="No Subject"?"border-green-400 bg-green-50 dark:border-green-500 dark:bg-green-950":(b=r.url)!=null&&b.includes("mail.google.com")?"border-yellow-400 bg-yellow-50 dark:border-yellow-500 dark:bg-yellow-950":"border-blue-400 bg-blue-50 dark:border-blue-500 dark:bg-blue-950"},p=()=>{var b;return r.emailSubject&&r.emailSubject!=="No Subject"?"bg-green-400 dark:bg-green-500":(b=r.url)!=null&&b.includes("mail.google.com")?"bg-yellow-400 dark:bg-yellow-500":"bg-blue-400 dark:bg-blue-500"},m=()=>{var b;return r.emailSubject&&r.emailSubject!=="No Subject"?"text-green-800 dark:text-green-200":(b=r.url)!=null&&b.includes("mail.google.com")?"text-yellow-800 dark:text-yellow-200":"text-blue-800 dark:text-blue-200"},g=()=>{var b;return r.emailSubject&&r.emailSubject!=="No Subject"?"text-green-600 dark:text-green-300":(b=r.url)!=null&&b.includes("mail.google.com")?"text-yellow-600 dark:text-yellow-300":"text-blue-600 dark:text-blue-300"};return u.jsx("div",{className:`border-l-4 p-3 mb-4 rounded-r-md ${d()}`,children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"flex-shrink-0",children:u.jsx("div",{className:`w-2 h-2 rounded-full animate-pulse ${p()}`})}),u.jsxs("div",{className:"ml-3 flex-1 min-w-0",children:[u.jsx("p",{className:`text-sm font-medium ${m()}`,children:r.emailSubject&&r.emailSubject!=="No Subject"?"Email Opened":(x=r.url)!=null&&x.includes("mail.google.com")?"No Email Selected":"Active Tab"}),u.jsx("p",{className:`text-sm ${g()} truncate`,title:r.emailSubject||r.title,children:c()})]})]})})},EK=()=>{const{activeSection:r,setActiveSection:e}=jT(),t=g8(),n=y8(),s=Ur(),{platform:i}=cn(),c=d=>{if(s.debug(`toggleSection called with section: "${d}"`,{sourceFile:"src/shared/components/sidepanel/SidePanelContent.tsx",section:d,currentActiveSection:r}),r===d){s.debug(`toggleSection called with section: "${d}" but activeSection is already ${r}`,{sourceFile:"src/shared/components/sidepanel/SidePanelContent.tsx",section:d,currentActiveSection:r});return}else s.debug(`toggleSection called with section: "${d}" changing activeSection from ${r}`,{sourceFile:"src/shared/components/sidepanel/SidePanelContent.tsx",section:d,currentActiveSection:r}),e(d)};return w.useEffect(()=>{if(t!=null&&t.onMessage){const d=async p=>{if(p.type==="USER_LOGGED_OUT"&&(s.info("Received logout notification in sidepanel",{sourceFile:"src/shared/components/sidepanel/SidePanelContent.tsx"}),n!=null&&n.closeWindow))try{await n.closeWindow()}catch(m){s.error("Failed to close window",m,{sourceFile:"src/shared/components/sidepanel/SidePanelContent.tsx"})}};return t.onMessage(d),()=>{t.removeMessageListener&&t.removeMessageListener(d)}}},[t,n,s]),w.useEffect(()=>{if(i==="chrome"&&(t!=null&&t.sendMessage))return t.sendMessage({type:"SIDE_PANEL_MOUNTED"}).catch(()=>{}),()=>{t.sendMessage&&t.sendMessage({type:"SIDE_PANEL_UNMOUNTED"}).catch(()=>{})}},[i,t]),u.jsxs("div",{className:"flex flex-col h-full",children:[r!=="login"&&r!=="Project Documents"&&u.jsx(_K,{}),u.jsx("div",{className:"flex-grow min-h-0",children:u.jsx(bK,{activeSection:r,toggleSection:c})})]})},SK=()=>u.jsx(Qq,{children:u.jsx(EK,{})}),CK=({variant:r})=>{const e=`logo ${r?`logo--${r}`:""}`;return u.jsx("div",{className:e,children:"candle"})},kK=({className:r="",variant:e="badge",showLastChecked:t=!1,hideInLogin:n=!1})=>{const[s,i]=w.useState(!1),{isConnected:c,isLoading:d,error:p,status:m,lastChecked:g,reconnectAttempts:x,wasEverConnected:b,initiateReconnection:E,clearError:T,forceRefresh:S}=ra(),{platform:N}=cn();if(N!=="chrome"||n)return null;const R=M=>{switch(M){case"connected":return u.jsx(Wc,{className:"h-4 w-4 text-green-600"});case"disconnected":return u.jsx(JR,{className:"h-4 w-4 text-amber-600"});case"loading":return u.jsx(Zi,{className:"h-4 w-4 animate-spin text-blue-600"});case"error":return u.jsx(oh,{className:"h-4 w-4 text-red-600"});default:return u.jsx(Kc,{className:"h-4 w-4 text-gray-400"})}},A=M=>{switch(M){case"connected":return"bg-green-50 border-green-200 text-green-800";case"disconnected":return"bg-amber-50 border-amber-200 text-amber-800";case"loading":return"bg-blue-50 border-blue-200 text-blue-800";case"error":return"bg-red-50 border-red-200 text-red-800";default:return"bg-gray-50 border-gray-200 text-gray-600"}},j=M=>{switch(M){case"connected":return"Gmail Connected";case"disconnected":return"Gmail Disconnected";case"loading":return"Checking Connection...";case"error":return"Connection Error";default:return"Unknown Status"}},P=async()=>{try{await E(),i(!1)}catch(M){console.error("Failed to reconnect Gmail:",M)}},$=async()=>{try{await S()}catch(M){console.error("Failed to refresh connection status:",M)}},W=M=>{if(!M)return"Never checked";const X=new Date().getTime()-M.getTime(),ie=Math.floor(X/6e4),J=Math.floor(X%6e4/1e3);return ie<1?`${J}s ago`:ie<60?`${ie}m ago`:`${Math.floor(ie/60)}h ago`};return e==="minimal"?u.jsxs("div",{className:`flex items-center gap-1 ${r}`,title:j(m),children:[u.jsx("div",{className:"cursor-pointer",title:j(m),"aria-label":j(m),children:R(m)}),!c&&!d&&u.jsx(ze,{onClick:P,variant:"ghost",size:"sm",className:"h-6 px-2 text-xs",disabled:d,title:b?"Reconnect to Gmail":"Connect to Gmail",children:b?"Reconnect":"Connect"})]}):e==="full"?u.jsxs("div",{className:`flex items-center justify-between p-3 rounded-lg border ${A(m)} ${r}`,children:[u.jsxs("div",{className:"flex items-center gap-3",children:[R(m),u.jsxs("div",{className:"flex-1",children:[u.jsx("p",{className:"text-sm font-medium",children:j(m)}),p&&u.jsx("p",{className:"text-xs mt-1 opacity-80",children:p}),t&&g&&u.jsxs("p",{className:"text-xs mt-1 opacity-60",children:["Last checked: ",W(g)]})]})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[!c&&!d&&u.jsx(ze,{onClick:P,variant:"outline",size:"sm",className:"text-xs",disabled:d,children:d?u.jsxs(u.Fragment,{children:[u.jsx(Zi,{className:"h-3 w-3 mr-1 animate-spin"}),"Connecting..."]}):b?"Reconnect Gmail":"Connect Gmail"}),u.jsx(ze,{onClick:$,variant:"ghost",size:"sm",className:"p-1",disabled:d,children:u.jsx(No,{className:`h-3 w-3 ${d?"animate-spin":""}`})}),p&&u.jsx(ze,{onClick:T,variant:"ghost",size:"sm",className:"p-1",children:u.jsx(ki,{className:"h-3 w-3"})})]})]}):u.jsxs(Ms,{open:s,onOpenChange:i,children:[u.jsx($s,{asChild:!0,children:u.jsxs(ze,{variant:"ghost",size:"sm",className:`h-8 px-2 flex items-center gap-2 ${A(m)} border hover:opacity-80 ${r}`,"aria-label":`Gmail connection status: ${j(m)}`,"aria-expanded":s,"aria-haspopup":"menu",children:[R(m),u.jsx("span",{className:"text-xs font-medium",children:j(m)})]})}),u.jsxs(vs,{align:"end",className:"w-80",children:[u.jsxs("div",{className:"p-3",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[R(m),u.jsx("span",{className:"font-medium text-sm",children:j(m)})]}),p&&u.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-2 mb-3",children:u.jsx("p",{className:"text-xs text-red-800",children:p})}),u.jsxs("div",{className:"text-xs text-gray-600 mb-3",children:[u.jsxs("p",{children:["Last checked: ",W(g)]}),x>0&&u.jsxs("p",{children:["Reconnect attempts: ",x]})]}),m==="connected"&&u.jsx("div",{className:"bg-green-50 border border-green-200 rounded-md p-2 mb-3",children:u.jsx("p",{className:"text-xs text-green-800",children:"Gmail is connected and working properly. All features are available."})}),m==="disconnected"&&u.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-md p-2 mb-3",children:u.jsx("p",{className:"text-xs text-amber-800",children:b?'Gmail connection lost. Some features may not work properly. Click "Reconnect Gmail" to restore connection.':'Gmail connection required. Some features may not work properly. Click "Connect Gmail" to enable all features.'})})]}),u.jsx(Dy,{}),u.jsxs("div",{className:"p-2",children:[u.jsx(rs,{asChild:!0,children:u.jsxs(ze,{onClick:$,variant:"ghost",size:"sm",className:"w-full justify-start",disabled:d,children:[u.jsx(No,{className:`h-4 w-4 mr-2 ${d?"animate-spin":""}`}),"Refresh Status"]})}),!c&&u.jsx(rs,{asChild:!0,children:u.jsx(ze,{onClick:P,variant:"ghost",size:"sm",className:"w-full justify-start",disabled:d,children:d?u.jsxs(u.Fragment,{children:[u.jsx(Zi,{className:"h-4 w-4 mr-2 animate-spin"}),"Connecting..."]}):u.jsxs(u.Fragment,{children:[u.jsx(Kc,{className:"h-4 w-4 mr-2"}),b?"Reconnect Gmail":"Connect Gmail"]})})}),p&&u.jsx(rs,{asChild:!0,children:u.jsxs(ze,{onClick:T,variant:"ghost",size:"sm",className:"w-full justify-start",children:[u.jsx(ki,{className:"h-4 w-4 mr-2"}),"Clear Error"]})})]})]})]})},NK=({className:r="",variant:e="badge",hideInLogin:t=!1})=>{const{platform:n}=cn();if(n!=="outlook"||t)return null;const s="Outlook Connected";return e==="minimal"?u.jsx("div",{className:`flex items-center gap-1 ${r}`,title:s,children:u.jsx("div",{className:"cursor-pointer",title:s,"aria-label":s,children:u.jsx(Wc,{className:"h-4 w-4 text-green-600"})})}):e==="full"?u.jsx("div",{className:`flex items-center justify-between p-3 rounded-lg border bg-green-50 border-green-200 text-green-800 ${r}`,children:u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx(Wc,{className:"h-4 w-4 text-green-600"}),u.jsx("div",{className:"flex-1",children:u.jsx("p",{className:"text-sm font-medium",children:s})})]})}):u.jsxs("div",{className:`h-8 px-2 flex items-center gap-2 bg-green-50 border-green-200 text-green-800 border rounded ${r}`,children:[u.jsx(Wc,{className:"h-4 w-4 text-green-600"}),u.jsx("span",{className:"text-xs font-medium",children:s})]})},Vf="src/shared/components/sidepanel/mainPanelContent/panelHeader.tsx",TK=r=>u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",width:"18",height:"18",...r,children:[u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),RK=({className:r})=>{const{activeSection:e,setActiveSection:t}=jT(),n=v8(),s=Ur(),i=async()=>{if(n!=null&&n.openOptionsPage)try{await n.openOptionsPage()}catch(p){s.error("Failed to open options page",p,{sourceFile:Vf})}else s.warn("Options page opening not available on this platform",{sourceFile:Vf})},c=async()=>{if(n!=null&&n.openURL)try{await n.openURL(YN,"_blank")}catch(p){s.error("Failed to open feedback form",p,{sourceFile:Vf})}else s.warn("openURL not available on this platform",{sourceFile:Vf})},d=async()=>{s.info("Logout initiated",{sourceFile:Vf});try{await Gy(s),await TU(s),await pT(s),t("login")}catch(p){s.error("Failed to logout",p,{sourceFile:Vf})}};return u.jsxs("div",{className:`relative flex items-center justify-between px-3 py-2 bg-blue-600 border-b border-gray-200 text-gray-100 ${r}`,children:[u.jsxs("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2",children:[u.jsx(kK,{variant:"minimal",className:"text-white border-white/20 hover:bg-white/10",hideInLogin:e==="login"}),u.jsx(NK,{variant:"minimal",className:"text-white border-white/20 hover:bg-white/10",hideInLogin:e==="login"})]}),u.jsx("div",{className:"flex-1 flex justify-center",children:u.jsx(CK,{variant:"panel"})}),u.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:u.jsxs(Ms,{children:[u.jsx($s,{asChild:!0,children:u.jsx("button",{className:"p-1 rounded hover:bg-white/10 transition-colors",children:u.jsx(TK,{className:"text-white"})})}),u.jsxs(vs,{align:"end",side:"bottom",sideOffset:5,children:[u.jsx(rs,{onClick:i,children:"Configure"}),u.jsx(Dy,{}),u.jsx(rs,{onClick:c,children:"Feedback"}),u.jsx(Dy,{}),u.jsx(rs,{onClick:d,children:"Logout"})]})]})})]})};function _w(){try{const r=Office.context.officeTheme;if(console.log(" Outlook Theme Detection:",r),r){const e=r.bodyBackgroundColor;if(console.log(" Background Color:",e),e){const t=e.replace("#",""),n=parseInt(t.substring(0,2),16),s=parseInt(t.substring(2,4),16),i=parseInt(t.substring(4,6),16),c=(n+s+i)/3;console.log(` Brightness: ${c} (R:${n}, G:${s}, B:${i})`),c<128?(console.log(" Dark mode detected - applying dark class"),document.documentElement.classList.add("dark")):(console.log(" Light mode detected - removing dark class"),document.documentElement.classList.remove("dark")),console.log(" HTML classes:",document.documentElement.className)}}else console.warn(" Office theme not available")}catch(r){console.error(" Error detecting Outlook theme:",r)}}Office.onReady(()=>{_w(),Office.context.mailbox&&Office.context.mailbox.addHandlerAsync(Office.EventType.OfficeThemeChanged,r=>{console.log(" Office theme changed event triggered"),_w()},r=>{r.status===Office.AsyncResultStatus.Succeeded?console.log(" Office theme change listener added successfully"):console.warn(" Failed to add Office theme change listener:",r.error)}),window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>{console.log(" System color scheme changed:",e.matches?"dark":"light"),_w()}),GO.createRoot(document.getElementById("root")).render(u.jsx(dr.StrictMode,{children:u.jsx(C5,{children:u.jsx(w8,{children:u.jsx(b8,{children:u.jsx(zH,{children:u.jsxs("div",{className:"sidepanel-container",children:[u.jsx(RK,{className:"sticky top-0 z-50 border-b-0"}),u.jsx(SK,{})]})})})})})}))});export{id as f,Uy as t};
