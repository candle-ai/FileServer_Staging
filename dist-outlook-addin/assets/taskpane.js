const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index.DS5eee3c.js","assets/modulepreload-polyfill.B5Qt9EMX.js"])))=>i.map(i=>d[i]);
var H2=Object.defineProperty;var B2=(r,e,t)=>e in r?H2(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var H=(r,e,t)=>B2(r,typeof e!="symbol"?e+"":e,t);import"./modulepreload-polyfill.B5Qt9EMX.js";function G2(r,e){for(var t=0;t<e.length;t++){const n=e[t];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in r)){const i=Object.getOwnPropertyDescriptor(n,s);i&&Object.defineProperty(r,s,i.get?i:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}))}var Cv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ib(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var px={exports:{}},Up={},mx={exports:{}},dr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hE;function W2(){if(hE)return dr;hE=1;var r=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),c=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),x=Symbol.iterator;function b(O){return O===null||typeof O!="object"?null:(O=x&&O[x]||O["@@iterator"],typeof O=="function"?O:null)}var S={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},T=Object.assign,E={};function C(O,$,ae){this.props=O,this.context=$,this.refs=E,this.updater=ae||S}C.prototype.isReactComponent={},C.prototype.setState=function(O,$){if(typeof O!="object"&&typeof O!="function"&&O!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,O,$,"setState")},C.prototype.forceUpdate=function(O){this.updater.enqueueForceUpdate(this,O,"forceUpdate")};function R(){}R.prototype=C.prototype;function A(O,$,ae){this.props=O,this.context=$,this.refs=E,this.updater=ae||S}var F=A.prototype=new R;F.constructor=A,T(F,C.prototype),F.isPureReactComponent=!0;var P=Array.isArray,L=Object.prototype.hasOwnProperty,G={current:null},U={key:!0,ref:!0,__self:!0,__source:!0};function V(O,$,ae){var be,ie={},K=null,de=null;if($!=null)for(be in $.ref!==void 0&&(de=$.ref),$.key!==void 0&&(K=""+$.key),$)L.call($,be)&&!U.hasOwnProperty(be)&&(ie[be]=$[be]);var ge=arguments.length-2;if(ge===1)ie.children=ae;else if(1<ge){for(var se=Array(ge),Te=0;Te<ge;Te++)se[Te]=arguments[Te+2];ie.children=se}if(O&&O.defaultProps)for(be in ge=O.defaultProps,ge)ie[be]===void 0&&(ie[be]=ge[be]);return{$$typeof:r,type:O,key:K,ref:de,props:ie,_owner:G.current}}function Q(O,$){return{$$typeof:r,type:O.type,key:$,ref:O.ref,props:O.props,_owner:O._owner}}function fe(O){return typeof O=="object"&&O!==null&&O.$$typeof===r}function B(O){var $={"=":"=0",":":"=2"};return"$"+O.replace(/[=:]/g,function(ae){return $[ae]})}var ee=/\/+/g;function ve(O,$){return typeof O=="object"&&O!==null&&O.key!=null?B(""+O.key):$.toString(36)}function ce(O,$,ae,be,ie){var K=typeof O;(K==="undefined"||K==="boolean")&&(O=null);var de=!1;if(O===null)de=!0;else switch(K){case"string":case"number":de=!0;break;case"object":switch(O.$$typeof){case r:case e:de=!0}}if(de)return de=O,ie=ie(de),O=be===""?"."+ve(de,0):be,P(ie)?(ae="",O!=null&&(ae=O.replace(ee,"$&/")+"/"),ce(ie,$,ae,"",function(Te){return Te})):ie!=null&&(fe(ie)&&(ie=Q(ie,ae+(!ie.key||de&&de.key===ie.key?"":(""+ie.key).replace(ee,"$&/")+"/")+O)),$.push(ie)),1;if(de=0,be=be===""?".":be+":",P(O))for(var ge=0;ge<O.length;ge++){K=O[ge];var se=be+ve(K,ge);de+=ce(K,$,ae,se,ie)}else if(se=b(O),typeof se=="function")for(O=se.call(O),ge=0;!(K=O.next()).done;)K=K.value,se=be+ve(K,ge++),de+=ce(K,$,ae,se,ie);else if(K==="object")throw $=String(O),Error("Objects are not valid as a React child (found: "+($==="[object Object]"?"object with keys {"+Object.keys(O).join(", ")+"}":$)+"). If you meant to render a collection of children, use an array instead.");return de}function ne(O,$,ae){if(O==null)return O;var be=[],ie=0;return ce(O,be,"","",function(K){return $.call(ae,K,ie++)}),be}function xe(O){if(O._status===-1){var $=O._result;$=$(),$.then(function(ae){(O._status===0||O._status===-1)&&(O._status=1,O._result=ae)},function(ae){(O._status===0||O._status===-1)&&(O._status=2,O._result=ae)}),O._status===-1&&(O._status=0,O._result=$)}if(O._status===1)return O._result.default;throw O._result}var J={current:null},X={transition:null},z={ReactCurrentDispatcher:J,ReactCurrentBatchConfig:X,ReactCurrentOwner:G};function q(){throw Error("act(...) is not supported in production builds of React.")}return dr.Children={map:ne,forEach:function(O,$,ae){ne(O,function(){$.apply(this,arguments)},ae)},count:function(O){var $=0;return ne(O,function(){$++}),$},toArray:function(O){return ne(O,function($){return $})||[]},only:function(O){if(!fe(O))throw Error("React.Children.only expected to receive a single React element child.");return O}},dr.Component=C,dr.Fragment=t,dr.Profiler=s,dr.PureComponent=A,dr.StrictMode=n,dr.Suspense=p,dr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=z,dr.act=q,dr.cloneElement=function(O,$,ae){if(O==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+O+".");var be=T({},O.props),ie=O.key,K=O.ref,de=O._owner;if($!=null){if($.ref!==void 0&&(K=$.ref,de=G.current),$.key!==void 0&&(ie=""+$.key),O.type&&O.type.defaultProps)var ge=O.type.defaultProps;for(se in $)L.call($,se)&&!U.hasOwnProperty(se)&&(be[se]=$[se]===void 0&&ge!==void 0?ge[se]:$[se])}var se=arguments.length-2;if(se===1)be.children=ae;else if(1<se){ge=Array(se);for(var Te=0;Te<se;Te++)ge[Te]=arguments[Te+2];be.children=ge}return{$$typeof:r,type:O.type,key:ie,ref:K,props:be,_owner:de}},dr.createContext=function(O){return O={$$typeof:c,_currentValue:O,_currentValue2:O,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},O.Provider={$$typeof:i,_context:O},O.Consumer=O},dr.createElement=V,dr.createFactory=function(O){var $=V.bind(null,O);return $.type=O,$},dr.createRef=function(){return{current:null}},dr.forwardRef=function(O){return{$$typeof:d,render:O}},dr.isValidElement=fe,dr.lazy=function(O){return{$$typeof:g,_payload:{_status:-1,_result:O},_init:xe}},dr.memo=function(O,$){return{$$typeof:m,type:O,compare:$===void 0?null:$}},dr.startTransition=function(O){var $=X.transition;X.transition={};try{O()}finally{X.transition=$}},dr.unstable_act=q,dr.useCallback=function(O,$){return J.current.useCallback(O,$)},dr.useContext=function(O){return J.current.useContext(O)},dr.useDebugValue=function(){},dr.useDeferredValue=function(O){return J.current.useDeferredValue(O)},dr.useEffect=function(O,$){return J.current.useEffect(O,$)},dr.useId=function(){return J.current.useId()},dr.useImperativeHandle=function(O,$,ae){return J.current.useImperativeHandle(O,$,ae)},dr.useInsertionEffect=function(O,$){return J.current.useInsertionEffect(O,$)},dr.useLayoutEffect=function(O,$){return J.current.useLayoutEffect(O,$)},dr.useMemo=function(O,$){return J.current.useMemo(O,$)},dr.useReducer=function(O,$,ae){return J.current.useReducer(O,$,ae)},dr.useRef=function(O){return J.current.useRef(O)},dr.useState=function(O){return J.current.useState(O)},dr.useSyncExternalStore=function(O,$,ae){return J.current.useSyncExternalStore(O,$,ae)},dr.useTransition=function(){return J.current.useTransition()},dr.version="18.3.1",dr}var pE;function Pb(){return pE||(pE=1,mx.exports=W2()),mx.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mE;function V2(){if(mE)return Up;mE=1;var r=Pb(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function c(d,p,m){var g,x={},b=null,S=null;m!==void 0&&(b=""+m),p.key!==void 0&&(b=""+p.key),p.ref!==void 0&&(S=p.ref);for(g in p)n.call(p,g)&&!i.hasOwnProperty(g)&&(x[g]=p[g]);if(d&&d.defaultProps)for(g in p=d.defaultProps,p)x[g]===void 0&&(x[g]=p[g]);return{$$typeof:e,type:d,key:b,ref:S,props:x,_owner:s.current}}return Up.Fragment=t,Up.jsx=c,Up.jsxs=c,Up}var gE;function q2(){return gE||(gE=1,px.exports=V2()),px.exports}var u=q2(),w=Pb();const gr=Ib(w),jb=G2({__proto__:null,default:gr},[w]);var kv={},gx={exports:{}},Po={},vx={exports:{}},yx={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vE;function K2(){return vE||(vE=1,(function(r){function e(X,z){var q=X.length;X.push(z);e:for(;0<q;){var O=q-1>>>1,$=X[O];if(0<s($,z))X[O]=z,X[q]=$,q=O;else break e}}function t(X){return X.length===0?null:X[0]}function n(X){if(X.length===0)return null;var z=X[0],q=X.pop();if(q!==z){X[0]=q;e:for(var O=0,$=X.length,ae=$>>>1;O<ae;){var be=2*(O+1)-1,ie=X[be],K=be+1,de=X[K];if(0>s(ie,q))K<$&&0>s(de,ie)?(X[O]=de,X[K]=q,O=K):(X[O]=ie,X[be]=q,O=be);else if(K<$&&0>s(de,q))X[O]=de,X[K]=q,O=K;else break e}}return z}function s(X,z){var q=X.sortIndex-z.sortIndex;return q!==0?q:X.id-z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;r.unstable_now=function(){return i.now()}}else{var c=Date,d=c.now();r.unstable_now=function(){return c.now()-d}}var p=[],m=[],g=1,x=null,b=3,S=!1,T=!1,E=!1,C=typeof setTimeout=="function"?setTimeout:null,R=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function F(X){for(var z=t(m);z!==null;){if(z.callback===null)n(m);else if(z.startTime<=X)n(m),z.sortIndex=z.expirationTime,e(p,z);else break;z=t(m)}}function P(X){if(E=!1,F(X),!T)if(t(p)!==null)T=!0,xe(L);else{var z=t(m);z!==null&&J(P,z.startTime-X)}}function L(X,z){T=!1,E&&(E=!1,R(V),V=-1),S=!0;var q=b;try{for(F(z),x=t(p);x!==null&&(!(x.expirationTime>z)||X&&!B());){var O=x.callback;if(typeof O=="function"){x.callback=null,b=x.priorityLevel;var $=O(x.expirationTime<=z);z=r.unstable_now(),typeof $=="function"?x.callback=$:x===t(p)&&n(p),F(z)}else n(p);x=t(p)}if(x!==null)var ae=!0;else{var be=t(m);be!==null&&J(P,be.startTime-z),ae=!1}return ae}finally{x=null,b=q,S=!1}}var G=!1,U=null,V=-1,Q=5,fe=-1;function B(){return!(r.unstable_now()-fe<Q)}function ee(){if(U!==null){var X=r.unstable_now();fe=X;var z=!0;try{z=U(!0,X)}finally{z?ve():(G=!1,U=null)}}else G=!1}var ve;if(typeof A=="function")ve=function(){A(ee)};else if(typeof MessageChannel<"u"){var ce=new MessageChannel,ne=ce.port2;ce.port1.onmessage=ee,ve=function(){ne.postMessage(null)}}else ve=function(){C(ee,0)};function xe(X){U=X,G||(G=!0,ve())}function J(X,z){V=C(function(){X(r.unstable_now())},z)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(X){X.callback=null},r.unstable_continueExecution=function(){T||S||(T=!0,xe(L))},r.unstable_forceFrameRate=function(X){0>X||125<X?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Q=0<X?Math.floor(1e3/X):5},r.unstable_getCurrentPriorityLevel=function(){return b},r.unstable_getFirstCallbackNode=function(){return t(p)},r.unstable_next=function(X){switch(b){case 1:case 2:case 3:var z=3;break;default:z=b}var q=b;b=z;try{return X()}finally{b=q}},r.unstable_pauseExecution=function(){},r.unstable_requestPaint=function(){},r.unstable_runWithPriority=function(X,z){switch(X){case 1:case 2:case 3:case 4:case 5:break;default:X=3}var q=b;b=X;try{return z()}finally{b=q}},r.unstable_scheduleCallback=function(X,z,q){var O=r.unstable_now();switch(typeof q=="object"&&q!==null?(q=q.delay,q=typeof q=="number"&&0<q?O+q:O):q=O,X){case 1:var $=-1;break;case 2:$=250;break;case 5:$=1073741823;break;case 4:$=1e4;break;default:$=5e3}return $=q+$,X={id:g++,callback:z,priorityLevel:X,startTime:q,expirationTime:$,sortIndex:-1},q>O?(X.sortIndex=q,e(m,X),t(p)===null&&X===t(m)&&(E?(R(V),V=-1):E=!0,J(P,q-O))):(X.sortIndex=$,e(p,X),T||S||(T=!0,xe(L))),X},r.unstable_shouldYield=B,r.unstable_wrapCallback=function(X){var z=b;return function(){var q=b;b=z;try{return X.apply(this,arguments)}finally{b=q}}}})(yx)),yx}var yE;function Y2(){return yE||(yE=1,vx.exports=K2()),vx.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xE;function J2(){if(xE)return Po;xE=1;var r=Pb(),e=Y2();function t(o){for(var a="https://reactjs.org/docs/error-decoder.html?invariant="+o,h=1;h<arguments.length;h++)a+="&args[]="+encodeURIComponent(arguments[h]);return"Minified React error #"+o+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,s={};function i(o,a){c(o,a),c(o+"Capture",a)}function c(o,a){for(s[o]=a,o=0;o<a.length;o++)n.add(a[o])}var d=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),p=Object.prototype.hasOwnProperty,m=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,g={},x={};function b(o){return p.call(x,o)?!0:p.call(g,o)?!1:m.test(o)?x[o]=!0:(g[o]=!0,!1)}function S(o,a,h,v){if(h!==null&&h.type===0)return!1;switch(typeof a){case"function":case"symbol":return!0;case"boolean":return v?!1:h!==null?!h.acceptsBooleans:(o=o.toLowerCase().slice(0,5),o!=="data-"&&o!=="aria-");default:return!1}}function T(o,a,h,v){if(a===null||typeof a>"u"||S(o,a,h,v))return!0;if(v)return!1;if(h!==null)switch(h.type){case 3:return!a;case 4:return a===!1;case 5:return isNaN(a);case 6:return isNaN(a)||1>a}return!1}function E(o,a,h,v,_,N,j){this.acceptsBooleans=a===2||a===3||a===4,this.attributeName=v,this.attributeNamespace=_,this.mustUseProperty=h,this.propertyName=o,this.type=a,this.sanitizeURL=N,this.removeEmptyString=j}var C={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(o){C[o]=new E(o,0,!1,o,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(o){var a=o[0];C[a]=new E(a,1,!1,o[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(o){C[o]=new E(o,2,!1,o.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(o){C[o]=new E(o,2,!1,o,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(o){C[o]=new E(o,3,!1,o.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(o){C[o]=new E(o,3,!0,o,null,!1,!1)}),["capture","download"].forEach(function(o){C[o]=new E(o,4,!1,o,null,!1,!1)}),["cols","rows","size","span"].forEach(function(o){C[o]=new E(o,6,!1,o,null,!1,!1)}),["rowSpan","start"].forEach(function(o){C[o]=new E(o,5,!1,o.toLowerCase(),null,!1,!1)});var R=/[\-:]([a-z])/g;function A(o){return o[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(o){var a=o.replace(R,A);C[a]=new E(a,1,!1,o,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(o){var a=o.replace(R,A);C[a]=new E(a,1,!1,o,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(o){var a=o.replace(R,A);C[a]=new E(a,1,!1,o,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(o){C[o]=new E(o,1,!1,o.toLowerCase(),null,!1,!1)}),C.xlinkHref=new E("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(o){C[o]=new E(o,1,!1,o.toLowerCase(),null,!0,!0)});function F(o,a,h,v){var _=C.hasOwnProperty(a)?C[a]:null;(_!==null?_.type!==0:v||!(2<a.length)||a[0]!=="o"&&a[0]!=="O"||a[1]!=="n"&&a[1]!=="N")&&(T(a,h,_,v)&&(h=null),v||_===null?b(a)&&(h===null?o.removeAttribute(a):o.setAttribute(a,""+h)):_.mustUseProperty?o[_.propertyName]=h===null?_.type===3?!1:"":h:(a=_.attributeName,v=_.attributeNamespace,h===null?o.removeAttribute(a):(_=_.type,h=_===3||_===4&&h===!0?"":""+h,v?o.setAttributeNS(v,a,h):o.setAttribute(a,h))))}var P=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,L=Symbol.for("react.element"),G=Symbol.for("react.portal"),U=Symbol.for("react.fragment"),V=Symbol.for("react.strict_mode"),Q=Symbol.for("react.profiler"),fe=Symbol.for("react.provider"),B=Symbol.for("react.context"),ee=Symbol.for("react.forward_ref"),ve=Symbol.for("react.suspense"),ce=Symbol.for("react.suspense_list"),ne=Symbol.for("react.memo"),xe=Symbol.for("react.lazy"),J=Symbol.for("react.offscreen"),X=Symbol.iterator;function z(o){return o===null||typeof o!="object"?null:(o=X&&o[X]||o["@@iterator"],typeof o=="function"?o:null)}var q=Object.assign,O;function $(o){if(O===void 0)try{throw Error()}catch(h){var a=h.stack.trim().match(/\n( *(at )?)/);O=a&&a[1]||""}return`
`+O+o}var ae=!1;function be(o,a){if(!o||ae)return"";ae=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(a)if(a=function(){throw Error()},Object.defineProperty(a.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(a,[])}catch(we){var v=we}Reflect.construct(o,[],a)}else{try{a.call()}catch(we){v=we}o.call(a.prototype)}else{try{throw Error()}catch(we){v=we}o()}}catch(we){if(we&&v&&typeof we.stack=="string"){for(var _=we.stack.split(`
`),N=v.stack.split(`
`),j=_.length-1,W=N.length-1;1<=j&&0<=W&&_[j]!==N[W];)W--;for(;1<=j&&0<=W;j--,W--)if(_[j]!==N[W]){if(j!==1||W!==1)do if(j--,W--,0>W||_[j]!==N[W]){var Z=`
`+_[j].replace(" at new "," at ");return o.displayName&&Z.includes("<anonymous>")&&(Z=Z.replace("<anonymous>",o.displayName)),Z}while(1<=j&&0<=W);break}}}finally{ae=!1,Error.prepareStackTrace=h}return(o=o?o.displayName||o.name:"")?$(o):""}function ie(o){switch(o.tag){case 5:return $(o.type);case 16:return $("Lazy");case 13:return $("Suspense");case 19:return $("SuspenseList");case 0:case 2:case 15:return o=be(o.type,!1),o;case 11:return o=be(o.type.render,!1),o;case 1:return o=be(o.type,!0),o;default:return""}}function K(o){if(o==null)return null;if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o;switch(o){case U:return"Fragment";case G:return"Portal";case Q:return"Profiler";case V:return"StrictMode";case ve:return"Suspense";case ce:return"SuspenseList"}if(typeof o=="object")switch(o.$$typeof){case B:return(o.displayName||"Context")+".Consumer";case fe:return(o._context.displayName||"Context")+".Provider";case ee:var a=o.render;return o=o.displayName,o||(o=a.displayName||a.name||"",o=o!==""?"ForwardRef("+o+")":"ForwardRef"),o;case ne:return a=o.displayName||null,a!==null?a:K(o.type)||"Memo";case xe:a=o._payload,o=o._init;try{return K(o(a))}catch{}}return null}function de(o){var a=o.type;switch(o.tag){case 24:return"Cache";case 9:return(a.displayName||"Context")+".Consumer";case 10:return(a._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return o=a.render,o=o.displayName||o.name||"",a.displayName||(o!==""?"ForwardRef("+o+")":"ForwardRef");case 7:return"Fragment";case 5:return a;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return K(a);case 8:return a===V?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a}return null}function ge(o){switch(typeof o){case"boolean":case"number":case"string":case"undefined":return o;case"object":return o;default:return""}}function se(o){var a=o.type;return(o=o.nodeName)&&o.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function Te(o){var a=se(o)?"checked":"value",h=Object.getOwnPropertyDescriptor(o.constructor.prototype,a),v=""+o[a];if(!o.hasOwnProperty(a)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var _=h.get,N=h.set;return Object.defineProperty(o,a,{configurable:!0,get:function(){return _.call(this)},set:function(j){v=""+j,N.call(this,j)}}),Object.defineProperty(o,a,{enumerable:h.enumerable}),{getValue:function(){return v},setValue:function(j){v=""+j},stopTracking:function(){o._valueTracker=null,delete o[a]}}}}function qe(o){o._valueTracker||(o._valueTracker=Te(o))}function ze(o){if(!o)return!1;var a=o._valueTracker;if(!a)return!0;var h=a.getValue(),v="";return o&&(v=se(o)?o.checked?"true":"false":o.value),o=v,o!==h?(a.setValue(o),!0):!1}function Be(o){if(o=o||(typeof document<"u"?document:void 0),typeof o>"u")return null;try{return o.activeElement||o.body}catch{return o.body}}function Ce(o,a){var h=a.checked;return q({},a,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:h??o._wrapperState.initialChecked})}function vt(o,a){var h=a.defaultValue==null?"":a.defaultValue,v=a.checked!=null?a.checked:a.defaultChecked;h=ge(a.value!=null?a.value:h),o._wrapperState={initialChecked:v,initialValue:h,controlled:a.type==="checkbox"||a.type==="radio"?a.checked!=null:a.value!=null}}function kt(o,a){a=a.checked,a!=null&&F(o,"checked",a,!1)}function yt(o,a){kt(o,a);var h=ge(a.value),v=a.type;if(h!=null)v==="number"?(h===0&&o.value===""||o.value!=h)&&(o.value=""+h):o.value!==""+h&&(o.value=""+h);else if(v==="submit"||v==="reset"){o.removeAttribute("value");return}a.hasOwnProperty("value")?It(o,a.type,h):a.hasOwnProperty("defaultValue")&&It(o,a.type,ge(a.defaultValue)),a.checked==null&&a.defaultChecked!=null&&(o.defaultChecked=!!a.defaultChecked)}function At(o,a,h){if(a.hasOwnProperty("value")||a.hasOwnProperty("defaultValue")){var v=a.type;if(!(v!=="submit"&&v!=="reset"||a.value!==void 0&&a.value!==null))return;a=""+o._wrapperState.initialValue,h||a===o.value||(o.value=a),o.defaultValue=a}h=o.name,h!==""&&(o.name=""),o.defaultChecked=!!o._wrapperState.initialChecked,h!==""&&(o.name=h)}function It(o,a,h){(a!=="number"||Be(o.ownerDocument)!==o)&&(h==null?o.defaultValue=""+o._wrapperState.initialValue:o.defaultValue!==""+h&&(o.defaultValue=""+h))}var Yt=Array.isArray;function Xt(o,a,h,v){if(o=o.options,a){a={};for(var _=0;_<h.length;_++)a["$"+h[_]]=!0;for(h=0;h<o.length;h++)_=a.hasOwnProperty("$"+o[h].value),o[h].selected!==_&&(o[h].selected=_),_&&v&&(o[h].defaultSelected=!0)}else{for(h=""+ge(h),a=null,_=0;_<o.length;_++){if(o[_].value===h){o[_].selected=!0,v&&(o[_].defaultSelected=!0);return}a!==null||o[_].disabled||(a=o[_])}a!==null&&(a.selected=!0)}}function Or(o,a){if(a.dangerouslySetInnerHTML!=null)throw Error(t(91));return q({},a,{value:void 0,defaultValue:void 0,children:""+o._wrapperState.initialValue})}function vr(o,a){var h=a.value;if(h==null){if(h=a.children,a=a.defaultValue,h!=null){if(a!=null)throw Error(t(92));if(Yt(h)){if(1<h.length)throw Error(t(93));h=h[0]}a=h}a==null&&(a=""),h=a}o._wrapperState={initialValue:ge(h)}}function dn(o,a){var h=ge(a.value),v=ge(a.defaultValue);h!=null&&(h=""+h,h!==o.value&&(o.value=h),a.defaultValue==null&&o.defaultValue!==h&&(o.defaultValue=h)),v!=null&&(o.defaultValue=""+v)}function _e(o){var a=o.textContent;a===o._wrapperState.initialValue&&a!==""&&a!==null&&(o.value=a)}function Fe(o){switch(o){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function nt(o,a){return o==null||o==="http://www.w3.org/1999/xhtml"?Fe(a):o==="http://www.w3.org/2000/svg"&&a==="foreignObject"?"http://www.w3.org/1999/xhtml":o}var ft,Ut=(function(o){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(a,h,v,_){MSApp.execUnsafeLocalFunction(function(){return o(a,h,v,_)})}:o})(function(o,a){if(o.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in o)o.innerHTML=a;else{for(ft=ft||document.createElement("div"),ft.innerHTML="<svg>"+a.valueOf().toString()+"</svg>",a=ft.firstChild;o.firstChild;)o.removeChild(o.firstChild);for(;a.firstChild;)o.appendChild(a.firstChild)}});function Ue(o,a){if(a){var h=o.firstChild;if(h&&h===o.lastChild&&h.nodeType===3){h.nodeValue=a;return}}o.textContent=a}var He={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Mt=["Webkit","ms","Moz","O"];Object.keys(He).forEach(function(o){Mt.forEach(function(a){a=a+o.charAt(0).toUpperCase()+o.substring(1),He[a]=He[o]})});function Ie(o,a,h){return a==null||typeof a=="boolean"||a===""?"":h||typeof a!="number"||a===0||He.hasOwnProperty(o)&&He[o]?(""+a).trim():a+"px"}function St(o,a){o=o.style;for(var h in a)if(a.hasOwnProperty(h)){var v=h.indexOf("--")===0,_=Ie(h,a[h],v);h==="float"&&(h="cssFloat"),v?o.setProperty(h,_):o[h]=_}}var ht=q({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ge(o,a){if(a){if(ht[o]&&(a.children!=null||a.dangerouslySetInnerHTML!=null))throw Error(t(137,o));if(a.dangerouslySetInnerHTML!=null){if(a.children!=null)throw Error(t(60));if(typeof a.dangerouslySetInnerHTML!="object"||!("__html"in a.dangerouslySetInnerHTML))throw Error(t(61))}if(a.style!=null&&typeof a.style!="object")throw Error(t(62))}}function cr(o,a){if(o.indexOf("-")===-1)return typeof a.is=="string";switch(o){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var zt=null;function yr(o){return o=o.target||o.srcElement||window,o.correspondingUseElement&&(o=o.correspondingUseElement),o.nodeType===3?o.parentNode:o}var tr=null,ar=null,Jn=null;function ls(o){if(o=Zn(o)){if(typeof tr!="function")throw Error(t(280));var a=o.stateNode;a&&(a=Bd(a),tr(o.stateNode,o.type,a))}}function qs(o){ar?Jn?Jn.push(o):Jn=[o]:ar=o}function ho(){if(ar){var o=ar,a=Jn;if(Jn=ar=null,ls(o),a)for(o=0;o<a.length;o++)ls(a[o])}}function Er(o,a){return o(a)}function vn(){}var Lo=!1;function cs(o,a,h){if(Lo)return o(a,h);Lo=!0;try{return Er(o,a,h)}finally{Lo=!1,(ar!==null||Jn!==null)&&(vn(),ho())}}function he(o,a){var h=o.stateNode;if(h===null)return null;var v=Bd(h);if(v===null)return null;h=v[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(v=!v.disabled)||(o=o.type,v=!(o==="button"||o==="input"||o==="select"||o==="textarea")),o=!v;break e;default:o=!1}if(o)return null;if(h&&typeof h!="function")throw Error(t(231,a,typeof h));return h}var Ke=!1;if(d)try{var _t={};Object.defineProperty(_t,"passive",{get:function(){Ke=!0}}),window.addEventListener("test",_t,_t),window.removeEventListener("test",_t,_t)}catch{Ke=!1}function pt(o,a,h,v,_,N,j,W,Z){var we=Array.prototype.slice.call(arguments,3);try{a.apply(h,we)}catch(je){this.onError(je)}}var tt=!1,ut=null,lt=!1,Jt=null,Mn={onError:function(o){tt=!0,ut=o}};function Wr(o,a,h,v,_,N,j,W,Z){tt=!1,ut=null,pt.apply(Mn,arguments)}function rr(o,a,h,v,_,N,j,W,Z){if(Wr.apply(this,arguments),tt){if(tt){var we=ut;tt=!1,ut=null}else throw Error(t(198));lt||(lt=!0,Jt=we)}}function $n(o){var a=o,h=o;if(o.alternate)for(;a.return;)a=a.return;else{o=a;do a=o,(a.flags&4098)!==0&&(h=a.return),o=a.return;while(o)}return a.tag===3?h:null}function po(o){if(o.tag===13){var a=o.memoizedState;if(a===null&&(o=o.alternate,o!==null&&(a=o.memoizedState)),a!==null)return a.dehydrated}return null}function ui(o){if($n(o)!==o)throw Error(t(188))}function fa(o){var a=o.alternate;if(!a){if(a=$n(o),a===null)throw Error(t(188));return a!==o?null:o}for(var h=o,v=a;;){var _=h.return;if(_===null)break;var N=_.alternate;if(N===null){if(v=_.return,v!==null){h=v;continue}break}if(_.child===N.child){for(N=_.child;N;){if(N===h)return ui(_),o;if(N===v)return ui(_),a;N=N.sibling}throw Error(t(188))}if(h.return!==v.return)h=_,v=N;else{for(var j=!1,W=_.child;W;){if(W===h){j=!0,h=_,v=N;break}if(W===v){j=!0,v=_,h=N;break}W=W.sibling}if(!j){for(W=N.child;W;){if(W===h){j=!0,h=N,v=_;break}if(W===v){j=!0,v=N,h=_;break}W=W.sibling}if(!j)throw Error(t(189))}}if(h.alternate!==v)throw Error(t(190))}if(h.tag!==3)throw Error(t(188));return h.stateNode.current===h?o:a}function Qa(o){return o=fa(o),o!==null?mt(o):null}function mt(o){if(o.tag===5||o.tag===6)return o;for(o=o.child;o!==null;){var a=mt(o);if(a!==null)return a;o=o.sibling}return null}var te=e.unstable_scheduleCallback,Le=e.unstable_cancelCallback,st=e.unstable_shouldYield,jr=e.unstable_requestPaint,qt=e.unstable_now,Vr=e.unstable_getCurrentPriorityLevel,fn=e.unstable_ImmediatePriority,ks=e.unstable_UserBlockingPriority,us=e.unstable_NormalPriority,di=e.unstable_LowPriority,qr=e.unstable_IdlePriority,fi=null,Un=null;function vd(o){if(Un&&typeof Un.onCommitFiberRoot=="function")try{Un.onCommitFiberRoot(fi,o,void 0,(o.current.flags&128)===128)}catch{}}var zn=Math.clz32?Math.clz32:Jl,nu=Math.log,su=Math.LN2;function Jl(o){return o>>>=0,o===0?32:31-(nu(o)/su|0)|0}var mo=64,Mo=4194304;function go(o){switch(o&-o){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return o&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return o}}function hi(o,a){var h=o.pendingLanes;if(h===0)return 0;var v=0,_=o.suspendedLanes,N=o.pingedLanes,j=h&268435455;if(j!==0){var W=j&~_;W!==0?v=go(W):(N&=j,N!==0&&(v=go(N)))}else j=h&~_,j!==0?v=go(j):N!==0&&(v=go(N));if(v===0)return 0;if(a!==0&&a!==v&&(a&_)===0&&(_=v&-v,N=a&-a,_>=N||_===16&&(N&4194240)!==0))return a;if((v&4)!==0&&(v|=h&16),a=o.entangledLanes,a!==0)for(o=o.entanglements,a&=v;0<a;)h=31-zn(a),_=1<<h,v|=o[h],a&=~_;return v}function yd(o,a){switch(o){case 1:case 2:case 4:return a+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ch(o,a){for(var h=o.suspendedLanes,v=o.pingedLanes,_=o.expirationTimes,N=o.pendingLanes;0<N;){var j=31-zn(N),W=1<<j,Z=_[j];Z===-1?((W&h)===0||(W&v)!==0)&&(_[j]=yd(W,a)):Z<=a&&(o.expiredLanes|=W),N&=~W}}function Xl(o){return o=o.pendingLanes&-1073741825,o!==0?o:o&1073741824?1073741824:0}function ou(){var o=mo;return mo<<=1,(mo&4194240)===0&&(mo=64),o}function Za(o){for(var a=[],h=0;31>h;h++)a.push(o);return a}function el(o,a,h){o.pendingLanes|=a,a!==536870912&&(o.suspendedLanes=0,o.pingedLanes=0),o=o.eventTimes,a=31-zn(a),o[a]=h}function xd(o,a){var h=o.pendingLanes&~a;o.pendingLanes=a,o.suspendedLanes=0,o.pingedLanes=0,o.expiredLanes&=a,o.mutableReadLanes&=a,o.entangledLanes&=a,a=o.entanglements;var v=o.eventTimes;for(o=o.expirationTimes;0<h;){var _=31-zn(h),N=1<<_;a[_]=0,v[_]=-1,o[_]=-1,h&=~N}}function tl(o,a){var h=o.entangledLanes|=a;for(o=o.entanglements;h;){var v=31-zn(h),_=1<<v;_&a|o[v]&a&&(o[v]|=a),h&=~_}}var ur=0;function $o(o){return o&=-o,1<o?4<o?(o&268435455)!==0?16:536870912:4:1}var iu,rl,wd,au,lu,Ql=!1,nl=[],pi=null,Uo=null,zo=null,Se=new Map,$e=new Map,Ve=[],Pt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function $t(o,a){switch(o){case"focusin":case"focusout":pi=null;break;case"dragenter":case"dragleave":Uo=null;break;case"mouseover":case"mouseout":zo=null;break;case"pointerover":case"pointerout":Se.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":$e.delete(a.pointerId)}}function Et(o,a,h,v,_,N){return o===null||o.nativeEvent!==N?(o={blockedOn:a,domEventName:h,eventSystemFlags:v,nativeEvent:N,targetContainers:[_]},a!==null&&(a=Zn(a),a!==null&&rl(a)),o):(o.eventSystemFlags|=v,a=o.targetContainers,_!==null&&a.indexOf(_)===-1&&a.push(_),o)}function ot(o,a,h,v,_){switch(a){case"focusin":return pi=Et(pi,o,a,h,v,_),!0;case"dragenter":return Uo=Et(Uo,o,a,h,v,_),!0;case"mouseover":return zo=Et(zo,o,a,h,v,_),!0;case"pointerover":var N=_.pointerId;return Se.set(N,Et(Se.get(N)||null,o,a,h,v,_)),!0;case"gotpointercapture":return N=_.pointerId,$e.set(N,Et($e.get(N)||null,o,a,h,v,_)),!0}return!1}function ct(o){var a=yi(o.target);if(a!==null){var h=$n(a);if(h!==null){if(a=h.tag,a===13){if(a=po(h),a!==null){o.blockedOn=a,lu(o.priority,function(){wd(h)});return}}else if(a===3&&h.stateNode.current.memoizedState.isDehydrated){o.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}o.blockedOn=null}function An(o){if(o.blockedOn!==null)return!1;for(var a=o.targetContainers;0<a.length;){var h=Ed(o.domEventName,o.eventSystemFlags,a[0],o.nativeEvent);if(h===null){h=o.nativeEvent;var v=new h.constructor(h.type,h);zt=v,h.target.dispatchEvent(v),zt=null}else return a=Zn(h),a!==null&&rl(a),o.blockedOn=h,!1;a.shift()}return!0}function Ns(o,a,h){An(o)&&h.delete(a)}function bd(){Ql=!1,pi!==null&&An(pi)&&(pi=null),Uo!==null&&An(Uo)&&(Uo=null),zo!==null&&An(zo)&&(zo=null),Se.forEach(Ns),$e.forEach(Ns)}function er(o,a){o.blockedOn===a&&(o.blockedOn=null,Ql||(Ql=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,bd)))}function Cr(o){function a(_){return er(_,o)}if(0<nl.length){er(nl[0],o);for(var h=1;h<nl.length;h++){var v=nl[h];v.blockedOn===o&&(v.blockedOn=null)}}for(pi!==null&&er(pi,o),Uo!==null&&er(Uo,o),zo!==null&&er(zo,o),Se.forEach(a),$e.forEach(a),h=0;h<Ve.length;h++)v=Ve[h],v.blockedOn===o&&(v.blockedOn=null);for(;0<Ve.length&&(h=Ve[0],h.blockedOn===null);)ct(h),h.blockedOn===null&&Ve.shift()}var Ho=P.ReactCurrentBatchConfig,sl=!0;function _d(o,a,h,v){var _=ur,N=Ho.transition;Ho.transition=null;try{ur=1,kh(o,a,h,v)}finally{ur=_,Ho.transition=N}}function cu(o,a,h,v){var _=ur,N=Ho.transition;Ho.transition=null;try{ur=4,kh(o,a,h,v)}finally{ur=_,Ho.transition=N}}function kh(o,a,h,v){if(sl){var _=Ed(o,a,h,v);if(_===null)Bh(o,a,v,Sd,h),$t(o,v);else if(ot(_,o,a,h,v))v.stopPropagation();else if($t(o,v),a&4&&-1<Pt.indexOf(o)){for(;_!==null;){var N=Zn(_);if(N!==null&&iu(N),N=Ed(o,a,h,v),N===null&&Bh(o,a,v,Sd,h),N===_)break;_=N}_!==null&&v.stopPropagation()}else Bh(o,a,v,null,h)}}var Sd=null;function Ed(o,a,h,v){if(Sd=null,o=yr(v),o=yi(o),o!==null)if(a=$n(o),a===null)o=null;else if(h=a.tag,h===13){if(o=po(a),o!==null)return o;o=null}else if(h===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;o=null}else a!==o&&(o=null);return Sd=o,null}function hg(o){switch(o){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Vr()){case fn:return 1;case ks:return 4;case us:case di:return 16;case qr:return 536870912;default:return 16}default:return 16}}var Qr=null,uu=null,mi=null;function Nh(){if(mi)return mi;var o,a=uu,h=a.length,v,_="value"in Qr?Qr.value:Qr.textContent,N=_.length;for(o=0;o<h&&a[o]===_[o];o++);var j=h-o;for(v=1;v<=j&&a[h-v]===_[N-v];v++);return mi=_.slice(o,1<v?1-v:void 0)}function Zl(o){var a=o.keyCode;return"charCode"in o?(o=o.charCode,o===0&&a===13&&(o=13)):o=a,o===10&&(o=13),32<=o||o===13?o:0}function ds(){return!0}function Th(){return!1}function Ts(o){function a(h,v,_,N,j){this._reactName=h,this._targetInst=_,this.type=v,this.nativeEvent=N,this.target=j,this.currentTarget=null;for(var W in o)o.hasOwnProperty(W)&&(h=o[W],this[W]=h?h(N):N[W]);return this.isDefaultPrevented=(N.defaultPrevented!=null?N.defaultPrevented:N.returnValue===!1)?ds:Th,this.isPropagationStopped=Th,this}return q(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=ds)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=ds)},persist:function(){},isPersistent:ds}),a}var ol={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(o){return o.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Cd=Ts(ol),ec=q({},ol,{view:0,detail:0}),pg=Ts(ec),fs,Rh,Xn,kd=q({},ec,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Fh,button:0,buttons:0,relatedTarget:function(o){return o.relatedTarget===void 0?o.fromElement===o.srcElement?o.toElement:o.fromElement:o.relatedTarget},movementX:function(o){return"movementX"in o?o.movementX:(o!==Xn&&(Xn&&o.type==="mousemove"?(fs=o.screenX-Xn.screenX,Rh=o.screenY-Xn.screenY):Rh=fs=0,Xn=o),fs)},movementY:function(o){return"movementY"in o?o.movementY:Rh}}),Ah=Ts(kd),ha=q({},kd,{dataTransfer:0}),Nd=Ts(ha),Ih=q({},ec,{relatedTarget:0}),Hr=Ts(Ih),pa=q({},ol,{animationName:0,elapsedTime:0,pseudoElement:0}),Ph=Ts(pa),S0=q({},ol,{clipboardData:function(o){return"clipboardData"in o?o.clipboardData:window.clipboardData}}),jh=Ts(S0),E0=q({},ol,{data:0}),mg=Ts(E0),C0={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},gg={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Td={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function tc(o){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(o):(o=Td[o])?!!a[o]:!1}function Fh(){return tc}var vg=q({},ec,{key:function(o){if(o.key){var a=C0[o.key]||o.key;if(a!=="Unidentified")return a}return o.type==="keypress"?(o=Zl(o),o===13?"Enter":String.fromCharCode(o)):o.type==="keydown"||o.type==="keyup"?gg[o.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Fh,charCode:function(o){return o.type==="keypress"?Zl(o):0},keyCode:function(o){return o.type==="keydown"||o.type==="keyup"?o.keyCode:0},which:function(o){return o.type==="keypress"?Zl(o):o.type==="keydown"||o.type==="keyup"?o.keyCode:0}}),yg=Ts(vg),Oh=q({},kd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Rd=Ts(Oh),xg=q({},ec,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Fh}),k0=Ts(xg),Dh=q({},ol,{propertyName:0,elapsedTime:0,pseudoElement:0}),Lh=Ts(Dh),N0=q({},kd,{deltaX:function(o){return"deltaX"in o?o.deltaX:"wheelDeltaX"in o?-o.wheelDeltaX:0},deltaY:function(o){return"deltaY"in o?o.deltaY:"wheelDeltaY"in o?-o.wheelDeltaY:"wheelDelta"in o?-o.wheelDelta:0},deltaZ:0,deltaMode:0}),wg=Ts(N0),Ks=[9,13,27,32],du=d&&"CompositionEvent"in window,Ui=null;d&&"documentMode"in document&&(Ui=document.documentMode);var bg=d&&"TextEvent"in window&&!Ui,Mh=d&&(!du||Ui&&8<Ui&&11>=Ui),_g=" ",Sg=!1;function Eg(o,a){switch(o){case"keyup":return Ks.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Cg(o){return o=o.detail,typeof o=="object"&&"data"in o?o.data:null}var rc=!1;function nc(o,a){switch(o){case"compositionend":return Cg(a);case"keypress":return a.which!==32?null:(Sg=!0,_g);case"textInput":return o=a.data,o===_g&&Sg?null:o;default:return null}}function T0(o,a){if(rc)return o==="compositionend"||!du&&Eg(o,a)?(o=Nh(),mi=uu=Qr=null,rc=!1,o):null;switch(o){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return Mh&&a.locale!=="ko"?null:a.data;default:return null}}var R0={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ad(o){var a=o&&o.nodeName&&o.nodeName.toLowerCase();return a==="input"?!!R0[o.type]:a==="textarea"}function $h(o,a,h,v){qs(v),a=$d(a,"onChange"),0<a.length&&(h=new Cd("onChange","change",null,h,v),o.push({event:h,listeners:a}))}var vo=null,ma=null;function A0(o){Pg(o,0)}function Id(o){var a=Qt(o);if(ze(a))return o}function I0(o,a){if(o==="change")return a}var il=!1;if(d){var Ys;if(d){var Pd="oninput"in document;if(!Pd){var kg=document.createElement("div");kg.setAttribute("oninput","return;"),Pd=typeof kg.oninput=="function"}Ys=Pd}else Ys=!1;il=Ys&&(!document.documentMode||9<document.documentMode)}function Ng(){vo&&(vo.detachEvent("onpropertychange",Tg),ma=vo=null)}function Tg(o){if(o.propertyName==="value"&&Id(ma)){var a=[];$h(a,ma,o,yr(o)),cs(A0,a)}}function P0(o,a,h){o==="focusin"?(Ng(),vo=a,ma=h,vo.attachEvent("onpropertychange",Tg)):o==="focusout"&&Ng()}function j0(o){if(o==="selectionchange"||o==="keyup"||o==="keydown")return Id(ma)}function sc(o,a){if(o==="click")return Id(a)}function le(o,a){if(o==="input"||o==="change")return Id(a)}function ke(o,a){return o===a&&(o!==0||1/o===1/a)||o!==o&&a!==a}var ye=typeof Object.is=="function"?Object.is:ke;function Qe(o,a){if(ye(o,a))return!0;if(typeof o!="object"||o===null||typeof a!="object"||a===null)return!1;var h=Object.keys(o),v=Object.keys(a);if(h.length!==v.length)return!1;for(v=0;v<h.length;v++){var _=h[v];if(!p.call(a,_)||!ye(o[_],a[_]))return!1}return!0}function Wt(o){for(;o&&o.firstChild;)o=o.firstChild;return o}function kr(o,a){var h=Wt(o);o=0;for(var v;h;){if(h.nodeType===3){if(v=o+h.textContent.length,o<=a&&v>=a)return{node:h,offset:a-o};o=v}e:{for(;h;){if(h.nextSibling){h=h.nextSibling;break e}h=h.parentNode}h=void 0}h=Wt(h)}}function yn(o,a){return o&&a?o===a?!0:o&&o.nodeType===3?!1:a&&a.nodeType===3?yn(o,a.parentNode):"contains"in o?o.contains(a):o.compareDocumentPosition?!!(o.compareDocumentPosition(a)&16):!1:!1}function Dr(){for(var o=window,a=Be();a instanceof o.HTMLIFrameElement;){try{var h=typeof a.contentWindow.location.href=="string"}catch{h=!1}if(h)o=a.contentWindow;else break;a=Be(o.document)}return a}function fu(o){var a=o&&o.nodeName&&o.nodeName.toLowerCase();return a&&(a==="input"&&(o.type==="text"||o.type==="search"||o.type==="tel"||o.type==="url"||o.type==="password")||a==="textarea"||o.contentEditable==="true")}function F0(o){var a=Dr(),h=o.focusedElem,v=o.selectionRange;if(a!==h&&h&&h.ownerDocument&&yn(h.ownerDocument.documentElement,h)){if(v!==null&&fu(h)){if(a=v.start,o=v.end,o===void 0&&(o=a),"selectionStart"in h)h.selectionStart=a,h.selectionEnd=Math.min(o,h.value.length);else if(o=(a=h.ownerDocument||document)&&a.defaultView||window,o.getSelection){o=o.getSelection();var _=h.textContent.length,N=Math.min(v.start,_);v=v.end===void 0?N:Math.min(v.end,_),!o.extend&&N>v&&(_=v,v=N,N=_),_=kr(h,N);var j=kr(h,v);_&&j&&(o.rangeCount!==1||o.anchorNode!==_.node||o.anchorOffset!==_.offset||o.focusNode!==j.node||o.focusOffset!==j.offset)&&(a=a.createRange(),a.setStart(_.node,_.offset),o.removeAllRanges(),N>v?(o.addRange(a),o.extend(j.node,j.offset)):(a.setEnd(j.node,j.offset),o.addRange(a)))}}for(a=[],o=h;o=o.parentNode;)o.nodeType===1&&a.push({element:o,left:o.scrollLeft,top:o.scrollTop});for(typeof h.focus=="function"&&h.focus(),h=0;h<a.length;h++)o=a[h],o.element.scrollLeft=o.left,o.element.scrollTop=o.top}}var yo=d&&"documentMode"in document&&11>=document.documentMode,zi=null,Uh=null,gi=null,oc=!1;function hu(o,a,h){var v=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;oc||zi==null||zi!==Be(v)||(v=zi,"selectionStart"in v&&fu(v)?v={start:v.selectionStart,end:v.selectionEnd}:(v=(v.ownerDocument&&v.ownerDocument.defaultView||window).getSelection(),v={anchorNode:v.anchorNode,anchorOffset:v.anchorOffset,focusNode:v.focusNode,focusOffset:v.focusOffset}),gi&&Qe(gi,v)||(gi=v,v=$d(Uh,"onSelect"),0<v.length&&(a=new Cd("onSelect","select",null,a,h),o.push({event:a,listeners:v}),a.target=zi)))}function br(o,a){var h={};return h[o.toLowerCase()]=a.toLowerCase(),h["Webkit"+o]="webkit"+a,h["Moz"+o]="moz"+a,h}var ic={animationend:br("Animation","AnimationEnd"),animationiteration:br("Animation","AnimationIteration"),animationstart:br("Animation","AnimationStart"),transitionend:br("Transition","TransitionEnd")},jd={},pu={};d&&(pu=document.createElement("div").style,"AnimationEvent"in window||(delete ic.animationend.animation,delete ic.animationiteration.animation,delete ic.animationstart.animation),"TransitionEvent"in window||delete ic.transitionend.transition);function Fd(o){if(jd[o])return jd[o];if(!ic[o])return o;var a=ic[o],h;for(h in a)if(a.hasOwnProperty(h)&&h in pu)return jd[o]=a[h];return o}var Rg=Fd("animationend"),Ag=Fd("animationiteration"),mu=Fd("animationstart"),Hi=Fd("transitionend"),gu=new Map,zh="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Bo(o,a){gu.set(o,a),i(a,[o])}for(var Od=0;Od<zh.length;Od++){var Dd=zh[Od],Ld=Dd.toLowerCase(),Ig=Dd[0].toUpperCase()+Dd.slice(1);Bo(Ld,"on"+Ig)}Bo(Rg,"onAnimationEnd"),Bo(Ag,"onAnimationIteration"),Bo(mu,"onAnimationStart"),Bo("dblclick","onDoubleClick"),Bo("focusin","onFocus"),Bo("focusout","onBlur"),Bo(Hi,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),i("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),i("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),i("onBeforeInput",["compositionend","keypress","textInput","paste"]),i("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Bi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),al=new Set("cancel close invalid load scroll toggle".split(" ").concat(Bi));function vu(o,a,h){var v=o.type||"unknown-event";o.currentTarget=h,rr(v,a,void 0,o),o.currentTarget=null}function Pg(o,a){a=(a&4)!==0;for(var h=0;h<o.length;h++){var v=o[h],_=v.event;v=v.listeners;e:{var N=void 0;if(a)for(var j=v.length-1;0<=j;j--){var W=v[j],Z=W.instance,we=W.currentTarget;if(W=W.listener,Z!==N&&_.isPropagationStopped())break e;vu(_,W,we),N=Z}else for(j=0;j<v.length;j++){if(W=v[j],Z=W.instance,we=W.currentTarget,W=W.listener,Z!==N&&_.isPropagationStopped())break e;vu(_,W,we),N=Z}}}if(lt)throw o=Jt,lt=!1,Jt=null,o}function Kr(o,a){var h=a[Hd];h===void 0&&(h=a[Hd]=new Set);var v=o+"__bubble";h.has(v)||(Md(a,o,2,!1),h.add(v))}function Hh(o,a,h){var v=0;a&&(v|=4),Md(h,o,v,a)}var ll="_reactListening"+Math.random().toString(36).slice(2);function ga(o){if(!o[ll]){o[ll]=!0,n.forEach(function(h){h!=="selectionchange"&&(al.has(h)||Hh(h,!1,o),Hh(h,!0,o))});var a=o.nodeType===9?o:o.ownerDocument;a===null||a[ll]||(a[ll]=!0,Hh("selectionchange",!1,a))}}function Md(o,a,h,v){switch(hg(a)){case 1:var _=_d;break;case 4:_=cu;break;default:_=kh}h=_.bind(null,a,h,o),_=void 0,!Ke||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(_=!0),v?_!==void 0?o.addEventListener(a,h,{capture:!0,passive:_}):o.addEventListener(a,h,!0):_!==void 0?o.addEventListener(a,h,{passive:_}):o.addEventListener(a,h,!1)}function Bh(o,a,h,v,_){var N=v;if((a&1)===0&&(a&2)===0&&v!==null)e:for(;;){if(v===null)return;var j=v.tag;if(j===3||j===4){var W=v.stateNode.containerInfo;if(W===_||W.nodeType===8&&W.parentNode===_)break;if(j===4)for(j=v.return;j!==null;){var Z=j.tag;if((Z===3||Z===4)&&(Z=j.stateNode.containerInfo,Z===_||Z.nodeType===8&&Z.parentNode===_))return;j=j.return}for(;W!==null;){if(j=yi(W),j===null)return;if(Z=j.tag,Z===5||Z===6){v=N=j;continue e}W=W.parentNode}}v=v.return}cs(function(){var we=N,je=yr(h),De=[];e:{var Pe=gu.get(o);if(Pe!==void 0){var Ze=Cd,at=o;switch(o){case"keypress":if(Zl(h)===0)break e;case"keydown":case"keyup":Ze=yg;break;case"focusin":at="focus",Ze=Hr;break;case"focusout":at="blur",Ze=Hr;break;case"beforeblur":case"afterblur":Ze=Hr;break;case"click":if(h.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ze=Ah;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ze=Nd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ze=k0;break;case Rg:case Ag:case mu:Ze=Ph;break;case Hi:Ze=Lh;break;case"scroll":Ze=pg;break;case"wheel":Ze=wg;break;case"copy":case"cut":case"paste":Ze=jh;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ze=Rd}var dt=(a&4)!==0,pn=!dt&&o==="scroll",pe=dt?Pe!==null?Pe+"Capture":null:Pe;dt=[];for(var oe=we,me;oe!==null;){me=oe;var Me=me.stateNode;if(me.tag===5&&Me!==null&&(me=Me,pe!==null&&(Me=he(oe,pe),Me!=null&&dt.push(ac(oe,Me,me)))),pn)break;oe=oe.return}0<dt.length&&(Pe=new Ze(Pe,at,null,h,je),De.push({event:Pe,listeners:dt}))}}if((a&7)===0){e:{if(Pe=o==="mouseover"||o==="pointerover",Ze=o==="mouseout"||o==="pointerout",Pe&&h!==zt&&(at=h.relatedTarget||h.fromElement)&&(yi(at)||at[Js]))break e;if((Ze||Pe)&&(Pe=je.window===je?je:(Pe=je.ownerDocument)?Pe.defaultView||Pe.parentWindow:window,Ze?(at=h.relatedTarget||h.toElement,Ze=we,at=at?yi(at):null,at!==null&&(pn=$n(at),at!==pn||at.tag!==5&&at.tag!==6)&&(at=null)):(Ze=null,at=we),Ze!==at)){if(dt=Ah,Me="onMouseLeave",pe="onMouseEnter",oe="mouse",(o==="pointerout"||o==="pointerover")&&(dt=Rd,Me="onPointerLeave",pe="onPointerEnter",oe="pointer"),pn=Ze==null?Pe:Qt(Ze),me=at==null?Pe:Qt(at),Pe=new dt(Me,oe+"leave",Ze,h,je),Pe.target=pn,Pe.relatedTarget=me,Me=null,yi(je)===we&&(dt=new dt(pe,oe+"enter",at,h,je),dt.target=me,dt.relatedTarget=pn,Me=dt),pn=Me,Ze&&at)t:{for(dt=Ze,pe=at,oe=0,me=dt;me;me=lc(me))oe++;for(me=0,Me=pe;Me;Me=lc(Me))me++;for(;0<oe-me;)dt=lc(dt),oe--;for(;0<me-oe;)pe=lc(pe),me--;for(;oe--;){if(dt===pe||pe!==null&&dt===pe.alternate)break t;dt=lc(dt),pe=lc(pe)}dt=null}else dt=null;Ze!==null&&xn(De,Pe,Ze,dt,!1),at!==null&&pn!==null&&xn(De,pn,at,dt,!0)}}e:{if(Pe=we?Qt(we):window,Ze=Pe.nodeName&&Pe.nodeName.toLowerCase(),Ze==="select"||Ze==="input"&&Pe.type==="file")var gt=I0;else if(Ad(Pe))if(il)gt=le;else{gt=j0;var jt=P0}else(Ze=Pe.nodeName)&&Ze.toLowerCase()==="input"&&(Pe.type==="checkbox"||Pe.type==="radio")&&(gt=sc);if(gt&&(gt=gt(o,we))){$h(De,gt,h,je);break e}jt&&jt(o,Pe,we),o==="focusout"&&(jt=Pe._wrapperState)&&jt.controlled&&Pe.type==="number"&&It(Pe,"number",Pe.value)}switch(jt=we?Qt(we):window,o){case"focusin":(Ad(jt)||jt.contentEditable==="true")&&(zi=jt,Uh=we,gi=null);break;case"focusout":gi=Uh=zi=null;break;case"mousedown":oc=!0;break;case"contextmenu":case"mouseup":case"dragend":oc=!1,hu(De,h,je);break;case"selectionchange":if(yo)break;case"keydown":case"keyup":hu(De,h,je)}var Ct;if(du)e:{switch(o){case"compositionstart":var Ht="onCompositionStart";break e;case"compositionend":Ht="onCompositionEnd";break e;case"compositionupdate":Ht="onCompositionUpdate";break e}Ht=void 0}else rc?Eg(o,h)&&(Ht="onCompositionEnd"):o==="keydown"&&h.keyCode===229&&(Ht="onCompositionStart");Ht&&(Mh&&h.locale!=="ko"&&(rc||Ht!=="onCompositionStart"?Ht==="onCompositionEnd"&&rc&&(Ct=Nh()):(Qr=je,uu="value"in Qr?Qr.value:Qr.textContent,rc=!0)),jt=$d(we,Ht),0<jt.length&&(Ht=new mg(Ht,o,null,h,je),De.push({event:Ht,listeners:jt}),Ct?Ht.data=Ct:(Ct=Cg(h),Ct!==null&&(Ht.data=Ct)))),(Ct=bg?nc(o,h):T0(o,h))&&(we=$d(we,"onBeforeInput"),0<we.length&&(je=new mg("onBeforeInput","beforeinput",null,h,je),De.push({event:je,listeners:we}),je.data=Ct))}Pg(De,a)})}function ac(o,a,h){return{instance:o,listener:a,currentTarget:h}}function $d(o,a){for(var h=a+"Capture",v=[];o!==null;){var _=o,N=_.stateNode;_.tag===5&&N!==null&&(_=N,N=he(o,h),N!=null&&v.unshift(ac(o,N,_)),N=he(o,a),N!=null&&v.push(ac(o,N,_))),o=o.return}return v}function lc(o){if(o===null)return null;do o=o.return;while(o&&o.tag!==5);return o||null}function xn(o,a,h,v,_){for(var N=a._reactName,j=[];h!==null&&h!==v;){var W=h,Z=W.alternate,we=W.stateNode;if(Z!==null&&Z===v)break;W.tag===5&&we!==null&&(W=we,_?(Z=he(h,N),Z!=null&&j.unshift(ac(h,Z,W))):_||(Z=he(h,N),Z!=null&&j.push(ac(h,Z,W)))),h=h.return}j.length!==0&&o.push({event:a,listeners:j})}var Qn=/\r\n?/g,O0=/\u0000|\uFFFD/g;function jg(o){return(typeof o=="string"?o:""+o).replace(Qn,`
`).replace(O0,"")}function yu(o,a,h){if(a=jg(a),jg(o)!==a&&h)throw Error(t(425))}function Ud(){}var xu=null,cl=null;function wu(o,a){return o==="textarea"||o==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var va=typeof setTimeout=="function"?setTimeout:void 0,bu=typeof clearTimeout=="function"?clearTimeout:void 0,cc=typeof Promise=="function"?Promise:void 0,zd=typeof queueMicrotask=="function"?queueMicrotask:typeof cc<"u"?function(o){return cc.resolve(null).then(o).catch(uc)}:va;function uc(o){setTimeout(function(){throw o})}function Gh(o,a){var h=a,v=0;do{var _=h.nextSibling;if(o.removeChild(h),_&&_.nodeType===8)if(h=_.data,h==="/$"){if(v===0){o.removeChild(_),Cr(a);return}v--}else h!=="$"&&h!=="$?"&&h!=="$!"||v++;h=_}while(h);Cr(a)}function ya(o){for(;o!=null;o=o.nextSibling){var a=o.nodeType;if(a===1||a===3)break;if(a===8){if(a=o.data,a==="$"||a==="$!"||a==="$?")break;if(a==="/$")return null}}return o}function Fg(o){o=o.previousSibling;for(var a=0;o;){if(o.nodeType===8){var h=o.data;if(h==="$"||h==="$!"||h==="$?"){if(a===0)return o;a--}else h==="/$"&&a++}o=o.previousSibling}return null}var dc=Math.random().toString(36).slice(2),vi="__reactFiber$"+dc,xa="__reactProps$"+dc,Js="__reactContainer$"+dc,Hd="__reactEvents$"+dc,D="__reactListeners$"+dc,fc="__reactHandles$"+dc;function yi(o){var a=o[vi];if(a)return a;for(var h=o.parentNode;h;){if(a=h[Js]||h[vi]){if(h=a.alternate,a.child!==null||h!==null&&h.child!==null)for(o=Fg(o);o!==null;){if(h=o[vi])return h;o=Fg(o)}return a}o=h,h=o.parentNode}return null}function Zn(o){return o=o[vi]||o[Js],!o||o.tag!==5&&o.tag!==6&&o.tag!==13&&o.tag!==3?null:o}function Qt(o){if(o.tag===5||o.tag===6)return o.stateNode;throw Error(t(33))}function Bd(o){return o[xa]||null}var Wh=[],hc=-1;function Rs(o){return{current:o}}function Yr(o){0>hc||(o.current=Wh[hc],Wh[hc]=null,hc--)}function Br(o,a){hc++,Wh[hc]=o.current,o.current=a}var wa={},es=Rs(wa),As=Rs(!1),hs=wa;function pc(o,a){var h=o.type.contextTypes;if(!h)return wa;var v=o.stateNode;if(v&&v.__reactInternalMemoizedUnmaskedChildContext===a)return v.__reactInternalMemoizedMaskedChildContext;var _={},N;for(N in h)_[N]=a[N];return v&&(o=o.stateNode,o.__reactInternalMemoizedUnmaskedChildContext=a,o.__reactInternalMemoizedMaskedChildContext=_),_}function Is(o){return o=o.childContextTypes,o!=null}function Gd(){Yr(As),Yr(es)}function Og(o,a,h){if(es.current!==wa)throw Error(t(168));Br(es,a),Br(As,h)}function Dg(o,a,h){var v=o.stateNode;if(a=a.childContextTypes,typeof v.getChildContext!="function")return h;v=v.getChildContext();for(var _ in v)if(!(_ in a))throw Error(t(108,de(o)||"Unknown",_));return q({},h,v)}function xo(o){return o=(o=o.stateNode)&&o.__reactInternalMemoizedMergedChildContext||wa,hs=es.current,Br(es,o),Br(As,As.current),!0}function Lg(o,a,h){var v=o.stateNode;if(!v)throw Error(t(169));h?(o=Dg(o,a,hs),v.__reactInternalMemoizedMergedChildContext=o,Yr(As),Yr(es),Br(es,o)):Yr(As),Br(As,h)}var Gi=null,Wd=!1,Vh=!1;function Mg(o){Gi===null?Gi=[o]:Gi.push(o)}function ul(o){Wd=!0,Mg(o)}function ba(){if(!Vh&&Gi!==null){Vh=!0;var o=0,a=ur;try{var h=Gi;for(ur=1;o<h.length;o++){var v=h[o];do v=v(!0);while(v!==null)}Gi=null,Wd=!1}catch(_){throw Gi!==null&&(Gi=Gi.slice(o+1)),te(fn,ba),_}finally{ur=a,Vh=!1}}return null}var mc=[],ts=0,Vd=null,qd=0,wo=[],bo=0,dl=null,xi=1,wi="";function fl(o,a){mc[ts++]=qd,mc[ts++]=Vd,Vd=o,qd=a}function $g(o,a,h){wo[bo++]=xi,wo[bo++]=wi,wo[bo++]=dl,dl=o;var v=xi;o=wi;var _=32-zn(v)-1;v&=~(1<<_),h+=1;var N=32-zn(a)+_;if(30<N){var j=_-_%5;N=(v&(1<<j)-1).toString(32),v>>=j,_-=j,xi=1<<32-zn(a)+_|h<<_|v,wi=N+o}else xi=1<<N|h<<_|v,wi=o}function _u(o){o.return!==null&&(fl(o,1),$g(o,1,0))}function hl(o){for(;o===Vd;)Vd=mc[--ts],mc[ts]=null,qd=mc[--ts],mc[ts]=null;for(;o===dl;)dl=wo[--bo],wo[bo]=null,wi=wo[--bo],wo[bo]=null,xi=wo[--bo],wo[bo]=null}var rs=null,Xs=null,Jr=!1,Go=null;function bi(o,a){var h=To(5,null,null,0);h.elementType="DELETED",h.stateNode=a,h.return=o,a=o.deletions,a===null?(o.deletions=[h],o.flags|=16):a.push(h)}function Kd(o,a){switch(o.tag){case 5:var h=o.type;return a=a.nodeType!==1||h.toLowerCase()!==a.nodeName.toLowerCase()?null:a,a!==null?(o.stateNode=a,rs=o,Xs=ya(a.firstChild),!0):!1;case 6:return a=o.pendingProps===""||a.nodeType!==3?null:a,a!==null?(o.stateNode=a,rs=o,Xs=null,!0):!1;case 13:return a=a.nodeType!==8?null:a,a!==null?(h=dl!==null?{id:xi,overflow:wi}:null,o.memoizedState={dehydrated:a,treeContext:h,retryLane:1073741824},h=To(18,null,null,0),h.stateNode=a,h.return=o,o.child=h,rs=o,Xs=null,!0):!1;default:return!1}}function Wi(o){return(o.mode&1)!==0&&(o.flags&128)===0}function Ps(o){if(Jr){var a=Xs;if(a){var h=a;if(!Kd(o,a)){if(Wi(o))throw Error(t(418));a=ya(h.nextSibling);var v=rs;a&&Kd(o,a)?bi(v,h):(o.flags=o.flags&-4097|2,Jr=!1,rs=o)}}else{if(Wi(o))throw Error(t(418));o.flags=o.flags&-4097|2,Jr=!1,rs=o}}}function Ug(o){for(o=o.return;o!==null&&o.tag!==5&&o.tag!==3&&o.tag!==13;)o=o.return;rs=o}function Su(o){if(o!==rs)return!1;if(!Jr)return Ug(o),Jr=!0,!1;var a;if((a=o.tag!==3)&&!(a=o.tag!==5)&&(a=o.type,a=a!=="head"&&a!=="body"&&!wu(o.type,o.memoizedProps)),a&&(a=Xs)){if(Wi(o))throw qh(),Error(t(418));for(;a;)bi(o,a),a=ya(a.nextSibling)}if(Ug(o),o.tag===13){if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(t(317));e:{for(o=o.nextSibling,a=0;o;){if(o.nodeType===8){var h=o.data;if(h==="/$"){if(a===0){Xs=ya(o.nextSibling);break e}a--}else h!=="$"&&h!=="$!"&&h!=="$?"||a++}o=o.nextSibling}Xs=null}}else Xs=rs?ya(o.stateNode.nextSibling):null;return!0}function qh(){for(var o=Xs;o;)o=ya(o.nextSibling)}function _i(){Xs=rs=null,Jr=!1}function Si(o){Go===null?Go=[o]:Go.push(o)}var zg=P.ReactCurrentBatchConfig;function Eu(o,a,h){if(o=h.ref,o!==null&&typeof o!="function"&&typeof o!="object"){if(h._owner){if(h=h._owner,h){if(h.tag!==1)throw Error(t(309));var v=h.stateNode}if(!v)throw Error(t(147,o));var _=v,N=""+o;return a!==null&&a.ref!==null&&typeof a.ref=="function"&&a.ref._stringRef===N?a.ref:(a=function(j){var W=_.refs;j===null?delete W[N]:W[N]=j},a._stringRef=N,a)}if(typeof o!="string")throw Error(t(284));if(!h._owner)throw Error(t(290,o))}return o}function pl(o,a){throw o=Object.prototype.toString.call(a),Error(t(31,o==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":o))}function Hg(o){var a=o._init;return a(o._payload)}function Kh(o){function a(pe,oe){if(o){var me=pe.deletions;me===null?(pe.deletions=[oe],pe.flags|=16):me.push(oe)}}function h(pe,oe){if(!o)return null;for(;oe!==null;)a(pe,oe),oe=oe.sibling;return null}function v(pe,oe){for(pe=new Map;oe!==null;)oe.key!==null?pe.set(oe.key,oe):pe.set(oe.index,oe),oe=oe.sibling;return pe}function _(pe,oe){return pe=Xo(pe,oe),pe.index=0,pe.sibling=null,pe}function N(pe,oe,me){return pe.index=me,o?(me=pe.alternate,me!==null?(me=me.index,me<oe?(pe.flags|=2,oe):me):(pe.flags|=2,oe)):(pe.flags|=1048576,oe)}function j(pe){return o&&pe.alternate===null&&(pe.flags|=2),pe}function W(pe,oe,me,Me){return oe===null||oe.tag!==6?(oe=Fp(me,pe.mode,Me),oe.return=pe,oe):(oe=_(oe,me),oe.return=pe,oe)}function Z(pe,oe,me,Me){var gt=me.type;return gt===U?je(pe,oe,me.props.children,Me,me.key):oe!==null&&(oe.elementType===gt||typeof gt=="object"&&gt!==null&&gt.$$typeof===xe&&Hg(gt)===oe.type)?(Me=_(oe,me.props),Me.ref=Eu(pe,oe,me),Me.return=pe,Me):(Me=Af(me.type,me.key,me.props,null,pe.mode,Me),Me.ref=Eu(pe,oe,me),Me.return=pe,Me)}function we(pe,oe,me,Me){return oe===null||oe.tag!==4||oe.stateNode.containerInfo!==me.containerInfo||oe.stateNode.implementation!==me.implementation?(oe=Op(me,pe.mode,Me),oe.return=pe,oe):(oe=_(oe,me.children||[]),oe.return=pe,oe)}function je(pe,oe,me,Me,gt){return oe===null||oe.tag!==7?(oe=Cl(me,pe.mode,Me,gt),oe.return=pe,oe):(oe=_(oe,me),oe.return=pe,oe)}function De(pe,oe,me){if(typeof oe=="string"&&oe!==""||typeof oe=="number")return oe=Fp(""+oe,pe.mode,me),oe.return=pe,oe;if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case L:return me=Af(oe.type,oe.key,oe.props,null,pe.mode,me),me.ref=Eu(pe,null,oe),me.return=pe,me;case G:return oe=Op(oe,pe.mode,me),oe.return=pe,oe;case xe:var Me=oe._init;return De(pe,Me(oe._payload),me)}if(Yt(oe)||z(oe))return oe=Cl(oe,pe.mode,me,null),oe.return=pe,oe;pl(pe,oe)}return null}function Pe(pe,oe,me,Me){var gt=oe!==null?oe.key:null;if(typeof me=="string"&&me!==""||typeof me=="number")return gt!==null?null:W(pe,oe,""+me,Me);if(typeof me=="object"&&me!==null){switch(me.$$typeof){case L:return me.key===gt?Z(pe,oe,me,Me):null;case G:return me.key===gt?we(pe,oe,me,Me):null;case xe:return gt=me._init,Pe(pe,oe,gt(me._payload),Me)}if(Yt(me)||z(me))return gt!==null?null:je(pe,oe,me,Me,null);pl(pe,me)}return null}function Ze(pe,oe,me,Me,gt){if(typeof Me=="string"&&Me!==""||typeof Me=="number")return pe=pe.get(me)||null,W(oe,pe,""+Me,gt);if(typeof Me=="object"&&Me!==null){switch(Me.$$typeof){case L:return pe=pe.get(Me.key===null?me:Me.key)||null,Z(oe,pe,Me,gt);case G:return pe=pe.get(Me.key===null?me:Me.key)||null,we(oe,pe,Me,gt);case xe:var jt=Me._init;return Ze(pe,oe,me,jt(Me._payload),gt)}if(Yt(Me)||z(Me))return pe=pe.get(me)||null,je(oe,pe,Me,gt,null);pl(oe,Me)}return null}function at(pe,oe,me,Me){for(var gt=null,jt=null,Ct=oe,Ht=oe=0,jn=null;Ct!==null&&Ht<me.length;Ht++){Ct.index>Ht?(jn=Ct,Ct=null):jn=Ct.sibling;var Nr=Pe(pe,Ct,me[Ht],Me);if(Nr===null){Ct===null&&(Ct=jn);break}o&&Ct&&Nr.alternate===null&&a(pe,Ct),oe=N(Nr,oe,Ht),jt===null?gt=Nr:jt.sibling=Nr,jt=Nr,Ct=jn}if(Ht===me.length)return h(pe,Ct),Jr&&fl(pe,Ht),gt;if(Ct===null){for(;Ht<me.length;Ht++)Ct=De(pe,me[Ht],Me),Ct!==null&&(oe=N(Ct,oe,Ht),jt===null?gt=Ct:jt.sibling=Ct,jt=Ct);return Jr&&fl(pe,Ht),gt}for(Ct=v(pe,Ct);Ht<me.length;Ht++)jn=Ze(Ct,pe,Ht,me[Ht],Me),jn!==null&&(o&&jn.alternate!==null&&Ct.delete(jn.key===null?Ht:jn.key),oe=N(jn,oe,Ht),jt===null?gt=jn:jt.sibling=jn,jt=jn);return o&&Ct.forEach(function(ja){return a(pe,ja)}),Jr&&fl(pe,Ht),gt}function dt(pe,oe,me,Me){var gt=z(me);if(typeof gt!="function")throw Error(t(150));if(me=gt.call(me),me==null)throw Error(t(151));for(var jt=gt=null,Ct=oe,Ht=oe=0,jn=null,Nr=me.next();Ct!==null&&!Nr.done;Ht++,Nr=me.next()){Ct.index>Ht?(jn=Ct,Ct=null):jn=Ct.sibling;var ja=Pe(pe,Ct,Nr.value,Me);if(ja===null){Ct===null&&(Ct=jn);break}o&&Ct&&ja.alternate===null&&a(pe,Ct),oe=N(ja,oe,Ht),jt===null?gt=ja:jt.sibling=ja,jt=ja,Ct=jn}if(Nr.done)return h(pe,Ct),Jr&&fl(pe,Ht),gt;if(Ct===null){for(;!Nr.done;Ht++,Nr=me.next())Nr=De(pe,Nr.value,Me),Nr!==null&&(oe=N(Nr,oe,Ht),jt===null?gt=Nr:jt.sibling=Nr,jt=Nr);return Jr&&fl(pe,Ht),gt}for(Ct=v(pe,Ct);!Nr.done;Ht++,Nr=me.next())Nr=Ze(Ct,pe,Ht,Nr.value,Me),Nr!==null&&(o&&Nr.alternate!==null&&Ct.delete(Nr.key===null?Ht:Nr.key),oe=N(Nr,oe,Ht),jt===null?gt=Nr:jt.sibling=Nr,jt=Nr);return o&&Ct.forEach(function(rx){return a(pe,rx)}),Jr&&fl(pe,Ht),gt}function pn(pe,oe,me,Me){if(typeof me=="object"&&me!==null&&me.type===U&&me.key===null&&(me=me.props.children),typeof me=="object"&&me!==null){switch(me.$$typeof){case L:e:{for(var gt=me.key,jt=oe;jt!==null;){if(jt.key===gt){if(gt=me.type,gt===U){if(jt.tag===7){h(pe,jt.sibling),oe=_(jt,me.props.children),oe.return=pe,pe=oe;break e}}else if(jt.elementType===gt||typeof gt=="object"&&gt!==null&&gt.$$typeof===xe&&Hg(gt)===jt.type){h(pe,jt.sibling),oe=_(jt,me.props),oe.ref=Eu(pe,jt,me),oe.return=pe,pe=oe;break e}h(pe,jt);break}else a(pe,jt);jt=jt.sibling}me.type===U?(oe=Cl(me.props.children,pe.mode,Me,me.key),oe.return=pe,pe=oe):(Me=Af(me.type,me.key,me.props,null,pe.mode,Me),Me.ref=Eu(pe,oe,me),Me.return=pe,pe=Me)}return j(pe);case G:e:{for(jt=me.key;oe!==null;){if(oe.key===jt)if(oe.tag===4&&oe.stateNode.containerInfo===me.containerInfo&&oe.stateNode.implementation===me.implementation){h(pe,oe.sibling),oe=_(oe,me.children||[]),oe.return=pe,pe=oe;break e}else{h(pe,oe);break}else a(pe,oe);oe=oe.sibling}oe=Op(me,pe.mode,Me),oe.return=pe,pe=oe}return j(pe);case xe:return jt=me._init,pn(pe,oe,jt(me._payload),Me)}if(Yt(me))return at(pe,oe,me,Me);if(z(me))return dt(pe,oe,me,Me);pl(pe,me)}return typeof me=="string"&&me!==""||typeof me=="number"?(me=""+me,oe!==null&&oe.tag===6?(h(pe,oe.sibling),oe=_(oe,me),oe.return=pe,pe=oe):(h(pe,oe),oe=Fp(me,pe.mode,Me),oe.return=pe,pe=oe),j(pe)):h(pe,oe)}return pn}var cn=Kh(!0),Yd=Kh(!1),Cu=Rs(null),Qs=null,_a=null,gc=null;function Vi(){gc=_a=Qs=null}function Jd(o){var a=Cu.current;Yr(Cu),o._currentValue=a}function Hn(o,a,h){for(;o!==null;){var v=o.alternate;if((o.childLanes&a)!==a?(o.childLanes|=a,v!==null&&(v.childLanes|=a)):v!==null&&(v.childLanes&a)!==a&&(v.childLanes|=a),o===h)break;o=o.return}}function Sa(o,a){Qs=o,gc=_a=null,o=o.dependencies,o!==null&&o.firstContext!==null&&((o.lanes&a)!==0&&(ms=!0),o.firstContext=null)}function _o(o){var a=o._currentValue;if(gc!==o)if(o={context:o,memoizedValue:a,next:null},_a===null){if(Qs===null)throw Error(t(308));_a=o,Qs.dependencies={lanes:0,firstContext:o}}else _a=_a.next=o;return a}var ml=null;function Yh(o){ml===null?ml=[o]:ml.push(o)}function Xd(o,a,h,v){var _=a.interleaved;return _===null?(h.next=h,Yh(a)):(h.next=_.next,_.next=h),a.interleaved=h,qi(o,v)}function qi(o,a){o.lanes|=a;var h=o.alternate;for(h!==null&&(h.lanes|=a),h=o,o=o.return;o!==null;)o.childLanes|=a,h=o.alternate,h!==null&&(h.childLanes|=a),h=o,o=o.return;return h.tag===3?h.stateNode:null}var So=!1;function Qd(o){o.updateQueue={baseState:o.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Bg(o,a){o=o.updateQueue,a.updateQueue===o&&(a.updateQueue={baseState:o.baseState,firstBaseUpdate:o.firstBaseUpdate,lastBaseUpdate:o.lastBaseUpdate,shared:o.shared,effects:o.effects})}function Ki(o,a){return{eventTime:o,lane:a,tag:0,payload:null,callback:null,next:null}}function Eo(o,a,h){var v=o.updateQueue;if(v===null)return null;if(v=v.shared,(_r&2)!==0){var _=v.pending;return _===null?a.next=a:(a.next=_.next,_.next=a),v.pending=a,qi(o,h)}return _=v.interleaved,_===null?(a.next=a,Yh(v)):(a.next=_.next,_.next=a),v.interleaved=a,qi(o,h)}function Zd(o,a,h){if(a=a.updateQueue,a!==null&&(a=a.shared,(h&4194240)!==0)){var v=a.lanes;v&=o.pendingLanes,h|=v,a.lanes=h,tl(o,h)}}function Gg(o,a){var h=o.updateQueue,v=o.alternate;if(v!==null&&(v=v.updateQueue,h===v)){var _=null,N=null;if(h=h.firstBaseUpdate,h!==null){do{var j={eventTime:h.eventTime,lane:h.lane,tag:h.tag,payload:h.payload,callback:h.callback,next:null};N===null?_=N=j:N=N.next=j,h=h.next}while(h!==null);N===null?_=N=a:N=N.next=a}else _=N=a;h={baseState:v.baseState,firstBaseUpdate:_,lastBaseUpdate:N,shared:v.shared,effects:v.effects},o.updateQueue=h;return}o=h.lastBaseUpdate,o===null?h.firstBaseUpdate=a:o.next=a,h.lastBaseUpdate=a}function vc(o,a,h,v){var _=o.updateQueue;So=!1;var N=_.firstBaseUpdate,j=_.lastBaseUpdate,W=_.shared.pending;if(W!==null){_.shared.pending=null;var Z=W,we=Z.next;Z.next=null,j===null?N=we:j.next=we,j=Z;var je=o.alternate;je!==null&&(je=je.updateQueue,W=je.lastBaseUpdate,W!==j&&(W===null?je.firstBaseUpdate=we:W.next=we,je.lastBaseUpdate=Z))}if(N!==null){var De=_.baseState;j=0,je=we=Z=null,W=N;do{var Pe=W.lane,Ze=W.eventTime;if((v&Pe)===Pe){je!==null&&(je=je.next={eventTime:Ze,lane:0,tag:W.tag,payload:W.payload,callback:W.callback,next:null});e:{var at=o,dt=W;switch(Pe=a,Ze=h,dt.tag){case 1:if(at=dt.payload,typeof at=="function"){De=at.call(Ze,De,Pe);break e}De=at;break e;case 3:at.flags=at.flags&-65537|128;case 0:if(at=dt.payload,Pe=typeof at=="function"?at.call(Ze,De,Pe):at,Pe==null)break e;De=q({},De,Pe);break e;case 2:So=!0}}W.callback!==null&&W.lane!==0&&(o.flags|=64,Pe=_.effects,Pe===null?_.effects=[W]:Pe.push(W))}else Ze={eventTime:Ze,lane:Pe,tag:W.tag,payload:W.payload,callback:W.callback,next:null},je===null?(we=je=Ze,Z=De):je=je.next=Ze,j|=Pe;if(W=W.next,W===null){if(W=_.shared.pending,W===null)break;Pe=W,W=Pe.next,Pe.next=null,_.lastBaseUpdate=Pe,_.shared.pending=null}}while(!0);if(je===null&&(Z=De),_.baseState=Z,_.firstBaseUpdate=we,_.lastBaseUpdate=je,a=_.shared.interleaved,a!==null){_=a;do j|=_.lane,_=_.next;while(_!==a)}else N===null&&(_.shared.lanes=0);Ta|=j,o.lanes=j,o.memoizedState=De}}function Jh(o,a,h){if(o=a.effects,a.effects=null,o!==null)for(a=0;a<o.length;a++){var v=o[a],_=v.callback;if(_!==null){if(v.callback=null,v=h,typeof _!="function")throw Error(t(191,_));_.call(v)}}}var ku={},Ei=Rs(ku),Nu=Rs(ku),yc=Rs(ku);function Yi(o){if(o===ku)throw Error(t(174));return o}function Xh(o,a){switch(Br(yc,a),Br(Nu,o),Br(Ei,ku),o=a.nodeType,o){case 9:case 11:a=(a=a.documentElement)?a.namespaceURI:nt(null,"");break;default:o=o===8?a.parentNode:a,a=o.namespaceURI||null,o=o.tagName,a=nt(a,o)}Yr(Ei),Br(Ei,a)}function Ea(){Yr(Ei),Yr(Nu),Yr(yc)}function Qh(o){Yi(yc.current);var a=Yi(Ei.current),h=nt(a,o.type);a!==h&&(Br(Nu,o),Br(Ei,h))}function ef(o){Nu.current===o&&(Yr(Ei),Yr(Nu))}var Zr=Rs(0);function gl(o){for(var a=o;a!==null;){if(a.tag===13){var h=a.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||h.data==="$?"||h.data==="$!"))return a}else if(a.tag===19&&a.memoizedProps.revealOrder!==void 0){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===o)break;for(;a.sibling===null;){if(a.return===null||a.return===o)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var Zh=[];function tf(){for(var o=0;o<Zh.length;o++)Zh[o]._workInProgressVersionPrimary=null;Zh.length=0}var Tu=P.ReactCurrentDispatcher,ep=P.ReactCurrentBatchConfig,Ca=0,rn=null,hn=null,Sn=null,xc=!1,Ru=!1,vl=0,nr=0;function ns(){throw Error(t(321))}function tp(o,a){if(a===null)return!1;for(var h=0;h<a.length&&h<o.length;h++)if(!ye(o[h],a[h]))return!1;return!0}function yl(o,a,h,v,_,N){if(Ca=N,rn=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,Tu.current=o===null||o.memoizedState===null?L0:cf,o=h(v,_),Ru){N=0;do{if(Ru=!1,vl=0,25<=N)throw Error(t(301));N+=1,Sn=hn=null,a.updateQueue=null,Tu.current=Sc,o=h(v,_)}while(Ru)}if(Tu.current=lf,a=hn!==null&&hn.next!==null,Ca=0,Sn=hn=rn=null,xc=!1,a)throw Error(t(300));return o}function rf(){var o=vl!==0;return vl=0,o}function Ci(){var o={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Sn===null?rn.memoizedState=Sn=o:Sn=Sn.next=o,Sn}function Co(){if(hn===null){var o=rn.alternate;o=o!==null?o.memoizedState:null}else o=hn.next;var a=Sn===null?rn.memoizedState:Sn.next;if(a!==null)Sn=a,hn=o;else{if(o===null)throw Error(t(310));hn=o,o={memoizedState:hn.memoizedState,baseState:hn.baseState,baseQueue:hn.baseQueue,queue:hn.queue,next:null},Sn===null?rn.memoizedState=Sn=o:Sn=Sn.next=o}return Sn}function ss(o,a){return typeof a=="function"?a(o):a}function rp(o){var a=Co(),h=a.queue;if(h===null)throw Error(t(311));h.lastRenderedReducer=o;var v=hn,_=v.baseQueue,N=h.pending;if(N!==null){if(_!==null){var j=_.next;_.next=N.next,N.next=j}v.baseQueue=_=N,h.pending=null}if(_!==null){N=_.next,v=v.baseState;var W=j=null,Z=null,we=N;do{var je=we.lane;if((Ca&je)===je)Z!==null&&(Z=Z.next={lane:0,action:we.action,hasEagerState:we.hasEagerState,eagerState:we.eagerState,next:null}),v=we.hasEagerState?we.eagerState:o(v,we.action);else{var De={lane:je,action:we.action,hasEagerState:we.hasEagerState,eagerState:we.eagerState,next:null};Z===null?(W=Z=De,j=v):Z=Z.next=De,rn.lanes|=je,Ta|=je}we=we.next}while(we!==null&&we!==N);Z===null?j=v:Z.next=W,ye(v,a.memoizedState)||(ms=!0),a.memoizedState=v,a.baseState=j,a.baseQueue=Z,h.lastRenderedState=v}if(o=h.interleaved,o!==null){_=o;do N=_.lane,rn.lanes|=N,Ta|=N,_=_.next;while(_!==o)}else _===null&&(h.lanes=0);return[a.memoizedState,h.dispatch]}function wc(o){var a=Co(),h=a.queue;if(h===null)throw Error(t(311));h.lastRenderedReducer=o;var v=h.dispatch,_=h.pending,N=a.memoizedState;if(_!==null){h.pending=null;var j=_=_.next;do N=o(N,j.action),j=j.next;while(j!==_);ye(N,a.memoizedState)||(ms=!0),a.memoizedState=N,a.baseQueue===null&&(a.baseState=N),h.lastRenderedState=N}return[N,v]}function nf(){}function np(o,a){var h=rn,v=Co(),_=a(),N=!ye(v.memoizedState,_);if(N&&(v.memoizedState=_,ms=!0),v=v.queue,ki(Ji.bind(null,h,v,o),[o]),v.getSnapshot!==a||N||Sn!==null&&Sn.memoizedState.tag&1){if(h.flags|=2048,bc(9,js.bind(null,h,v,_,a),void 0,null),Pn===null)throw Error(t(349));(Ca&30)!==0||sp(h,a,_)}return _}function sp(o,a,h){o.flags|=16384,o={getSnapshot:a,value:h},a=rn.updateQueue,a===null?(a={lastEffect:null,stores:null},rn.updateQueue=a,a.stores=[o]):(h=a.stores,h===null?a.stores=[o]:h.push(o))}function js(o,a,h,v){a.value=h,a.getSnapshot=v,sf(a)&&op(o)}function Ji(o,a,h){return h(function(){sf(a)&&op(o)})}function sf(o){var a=o.getSnapshot;o=o.value;try{var h=a();return!ye(o,h)}catch{return!0}}function op(o){var a=qi(o,1);a!==null&&Jo(a,o,1,-1)}function Au(o){var a=Ci();return typeof o=="function"&&(o=o()),a.memoizedState=a.baseState=o,o={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ss,lastRenderedState:o},a.queue=o,o=o.dispatch=Jg.bind(null,rn,o),[a.memoizedState,o]}function bc(o,a,h,v){return o={tag:o,create:a,destroy:h,deps:v,next:null},a=rn.updateQueue,a===null?(a={lastEffect:null,stores:null},rn.updateQueue=a,a.lastEffect=o.next=o):(h=a.lastEffect,h===null?a.lastEffect=o.next=o:(v=h.next,h.next=o,o.next=v,a.lastEffect=o)),o}function of(){return Co().memoizedState}function Iu(o,a,h,v){var _=Ci();rn.flags|=o,_.memoizedState=bc(1|a,h,void 0,v===void 0?null:v)}function _c(o,a,h,v){var _=Co();v=v===void 0?null:v;var N=void 0;if(hn!==null){var j=hn.memoizedState;if(N=j.destroy,v!==null&&tp(v,j.deps)){_.memoizedState=bc(a,h,N,v);return}}rn.flags|=o,_.memoizedState=bc(1|a,h,N,v)}function af(o,a){return Iu(8390656,8,o,a)}function ki(o,a){return _c(2048,8,o,a)}function Wg(o,a){return _c(4,2,o,a)}function Xi(o,a){return _c(4,4,o,a)}function ip(o,a){if(typeof a=="function")return o=o(),a(o),function(){a(null)};if(a!=null)return o=o(),a.current=o,function(){a.current=null}}function ap(o,a,h){return h=h!=null?h.concat([o]):null,_c(4,4,ip.bind(null,a,o),h)}function Pu(){}function Vg(o,a){var h=Co();a=a===void 0?null:a;var v=h.memoizedState;return v!==null&&a!==null&&tp(a,v[1])?v[0]:(h.memoizedState=[o,a],o)}function qg(o,a){var h=Co();a=a===void 0?null:a;var v=h.memoizedState;return v!==null&&a!==null&&tp(a,v[1])?v[0]:(o=o(),h.memoizedState=[o,a],o)}function Kg(o,a,h){return(Ca&21)===0?(o.baseState&&(o.baseState=!1,ms=!0),o.memoizedState=h):(ye(h,a)||(h=ou(),rn.lanes|=h,Ta|=h,o.baseState=!0),a)}function Yg(o,a){var h=ur;ur=h!==0&&4>h?h:4,o(!0);var v=ep.transition;ep.transition={};try{o(!1),a()}finally{ur=h,ep.transition=v}}function lp(){return Co().memoizedState}function D0(o,a,h){var v=Ia(o);if(h={lane:v,action:h,hasEagerState:!1,eagerState:null,next:null},cp(o))ps(a,h);else if(h=Xd(o,a,h,v),h!==null){var _=ys();Jo(h,o,v,_),Wo(h,a,v)}}function Jg(o,a,h){var v=Ia(o),_={lane:v,action:h,hasEagerState:!1,eagerState:null,next:null};if(cp(o))ps(a,_);else{var N=o.alternate;if(o.lanes===0&&(N===null||N.lanes===0)&&(N=a.lastRenderedReducer,N!==null))try{var j=a.lastRenderedState,W=N(j,h);if(_.hasEagerState=!0,_.eagerState=W,ye(W,j)){var Z=a.interleaved;Z===null?(_.next=_,Yh(a)):(_.next=Z.next,Z.next=_),a.interleaved=_;return}}catch{}finally{}h=Xd(o,a,_,v),h!==null&&(_=ys(),Jo(h,o,v,_),Wo(h,a,v))}}function cp(o){var a=o.alternate;return o===rn||a!==null&&a===rn}function ps(o,a){Ru=xc=!0;var h=o.pending;h===null?a.next=a:(a.next=h.next,h.next=a),o.pending=a}function Wo(o,a,h){if((h&4194240)!==0){var v=a.lanes;v&=o.pendingLanes,h|=v,a.lanes=h,tl(o,h)}}var lf={readContext:_o,useCallback:ns,useContext:ns,useEffect:ns,useImperativeHandle:ns,useInsertionEffect:ns,useLayoutEffect:ns,useMemo:ns,useReducer:ns,useRef:ns,useState:ns,useDebugValue:ns,useDeferredValue:ns,useTransition:ns,useMutableSource:ns,useSyncExternalStore:ns,useId:ns,unstable_isNewReconciler:!1},L0={readContext:_o,useCallback:function(o,a){return Ci().memoizedState=[o,a===void 0?null:a],o},useContext:_o,useEffect:af,useImperativeHandle:function(o,a,h){return h=h!=null?h.concat([o]):null,Iu(4194308,4,ip.bind(null,a,o),h)},useLayoutEffect:function(o,a){return Iu(4194308,4,o,a)},useInsertionEffect:function(o,a){return Iu(4,2,o,a)},useMemo:function(o,a){var h=Ci();return a=a===void 0?null:a,o=o(),h.memoizedState=[o,a],o},useReducer:function(o,a,h){var v=Ci();return a=h!==void 0?h(a):a,v.memoizedState=v.baseState=a,o={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:o,lastRenderedState:a},v.queue=o,o=o.dispatch=D0.bind(null,rn,o),[v.memoizedState,o]},useRef:function(o){var a=Ci();return o={current:o},a.memoizedState=o},useState:Au,useDebugValue:Pu,useDeferredValue:function(o){return Ci().memoizedState=o},useTransition:function(){var o=Au(!1),a=o[0];return o=Yg.bind(null,o[1]),Ci().memoizedState=o,[a,o]},useMutableSource:function(){},useSyncExternalStore:function(o,a,h){var v=rn,_=Ci();if(Jr){if(h===void 0)throw Error(t(407));h=h()}else{if(h=a(),Pn===null)throw Error(t(349));(Ca&30)!==0||sp(v,a,h)}_.memoizedState=h;var N={value:h,getSnapshot:a};return _.queue=N,af(Ji.bind(null,v,N,o),[o]),v.flags|=2048,bc(9,js.bind(null,v,N,h,a),void 0,null),h},useId:function(){var o=Ci(),a=Pn.identifierPrefix;if(Jr){var h=wi,v=xi;h=(v&~(1<<32-zn(v)-1)).toString(32)+h,a=":"+a+"R"+h,h=vl++,0<h&&(a+="H"+h.toString(32)),a+=":"}else h=nr++,a=":"+a+"r"+h.toString(32)+":";return o.memoizedState=a},unstable_isNewReconciler:!1},cf={readContext:_o,useCallback:Vg,useContext:_o,useEffect:ki,useImperativeHandle:ap,useInsertionEffect:Wg,useLayoutEffect:Xi,useMemo:qg,useReducer:rp,useRef:of,useState:function(){return rp(ss)},useDebugValue:Pu,useDeferredValue:function(o){var a=Co();return Kg(a,hn.memoizedState,o)},useTransition:function(){var o=rp(ss)[0],a=Co().memoizedState;return[o,a]},useMutableSource:nf,useSyncExternalStore:np,useId:lp,unstable_isNewReconciler:!1},Sc={readContext:_o,useCallback:Vg,useContext:_o,useEffect:ki,useImperativeHandle:ap,useInsertionEffect:Wg,useLayoutEffect:Xi,useMemo:qg,useReducer:wc,useRef:of,useState:function(){return wc(ss)},useDebugValue:Pu,useDeferredValue:function(o){var a=Co();return hn===null?a.memoizedState=o:Kg(a,hn.memoizedState,o)},useTransition:function(){var o=wc(ss)[0],a=Co().memoizedState;return[o,a]},useMutableSource:nf,useSyncExternalStore:np,useId:lp,unstable_isNewReconciler:!1};function ko(o,a){if(o&&o.defaultProps){a=q({},a),o=o.defaultProps;for(var h in o)a[h]===void 0&&(a[h]=o[h]);return a}return a}function uf(o,a,h,v){a=o.memoizedState,h=h(v,a),h=h==null?a:q({},a,h),o.memoizedState=h,o.lanes===0&&(o.updateQueue.baseState=h)}var df={isMounted:function(o){return(o=o._reactInternals)?$n(o)===o:!1},enqueueSetState:function(o,a,h){o=o._reactInternals;var v=ys(),_=Ia(o),N=Ki(v,_);N.payload=a,h!=null&&(N.callback=h),a=Eo(o,N,_),a!==null&&(Jo(a,o,_,v),Zd(a,o,_))},enqueueReplaceState:function(o,a,h){o=o._reactInternals;var v=ys(),_=Ia(o),N=Ki(v,_);N.tag=1,N.payload=a,h!=null&&(N.callback=h),a=Eo(o,N,_),a!==null&&(Jo(a,o,_,v),Zd(a,o,_))},enqueueForceUpdate:function(o,a){o=o._reactInternals;var h=ys(),v=Ia(o),_=Ki(h,v);_.tag=2,a!=null&&(_.callback=a),a=Eo(o,_,v),a!==null&&(Jo(a,o,v,h),Zd(a,o,v))}};function up(o,a,h,v,_,N,j){return o=o.stateNode,typeof o.shouldComponentUpdate=="function"?o.shouldComponentUpdate(v,N,j):a.prototype&&a.prototype.isPureReactComponent?!Qe(h,v)||!Qe(_,N):!0}function xl(o,a,h){var v=!1,_=wa,N=a.contextType;return typeof N=="object"&&N!==null?N=_o(N):(_=Is(a)?hs:es.current,v=a.contextTypes,N=(v=v!=null)?pc(o,_):wa),a=new a(h,N),o.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,a.updater=df,o.stateNode=a,a._reactInternals=o,v&&(o=o.stateNode,o.__reactInternalMemoizedUnmaskedChildContext=_,o.__reactInternalMemoizedMaskedChildContext=N),a}function Ec(o,a,h,v){o=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(h,v),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(h,v),a.state!==o&&df.enqueueReplaceState(a,a.state,null)}function dp(o,a,h,v){var _=o.stateNode;_.props=h,_.state=o.memoizedState,_.refs={},Qd(o);var N=a.contextType;typeof N=="object"&&N!==null?_.context=_o(N):(N=Is(a)?hs:es.current,_.context=pc(o,N)),_.state=o.memoizedState,N=a.getDerivedStateFromProps,typeof N=="function"&&(uf(o,a,N,h),_.state=o.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof _.getSnapshotBeforeUpdate=="function"||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(a=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),a!==_.state&&df.enqueueReplaceState(_,_.state,null),vc(o,h,_,v),_.state=o.memoizedState),typeof _.componentDidMount=="function"&&(o.flags|=4194308)}function wl(o,a){try{var h="",v=a;do h+=ie(v),v=v.return;while(v);var _=h}catch(N){_=`
Error generating stack: `+N.message+`
`+N.stack}return{value:o,source:a,stack:_,digest:null}}function ff(o,a,h){return{value:o,source:null,stack:h??null,digest:a??null}}function Cc(o,a){try{console.error(a.value)}catch(h){setTimeout(function(){throw h})}}var Xg=typeof WeakMap=="function"?WeakMap:Map;function ju(o,a,h){h=Ki(-1,h),h.tag=3,h.payload={element:null};var v=a.value;return h.callback=function(){Sf||(Sf=!0,Np=v),Cc(o,a)},h}function hf(o,a,h){h=Ki(-1,h),h.tag=3;var v=o.type.getDerivedStateFromError;if(typeof v=="function"){var _=a.value;h.payload=function(){return v(_)},h.callback=function(){Cc(o,a)}}var N=o.stateNode;return N!==null&&typeof N.componentDidCatch=="function"&&(h.callback=function(){Cc(o,a),typeof v!="function"&&(Ra===null?Ra=new Set([this]):Ra.add(this));var j=a.stack;this.componentDidCatch(a.value,{componentStack:j!==null?j:""})}),h}function Fu(o,a,h){var v=o.pingCache;if(v===null){v=o.pingCache=new Xg;var _=new Set;v.set(a,_)}else _=v.get(a),_===void 0&&(_=new Set,v.set(a,_));_.has(h)||(_.add(h),o=W0.bind(null,o,a,h),a.then(o,o))}function Qg(o){do{var a;if((a=o.tag===13)&&(a=o.memoizedState,a=a!==null?a.dehydrated!==null:!0),a)return o;o=o.return}while(o!==null);return null}function fp(o,a,h,v,_){return(o.mode&1)===0?(o===a?o.flags|=65536:(o.flags|=128,h.flags|=131072,h.flags&=-52805,h.tag===1&&(h.alternate===null?h.tag=17:(a=Ki(-1,1),a.tag=2,Eo(h,a,1))),h.lanes|=1),o):(o.flags|=65536,o.lanes=_,o)}var pf=P.ReactCurrentOwner,ms=!1;function Bn(o,a,h,v){a.child=o===null?Yd(a,null,h,v):cn(a,o.child,h,v)}function Zg(o,a,h,v,_){h=h.render;var N=a.ref;return Sa(a,_),v=yl(o,a,h,v,N,_),h=rf(),o!==null&&!ms?(a.updateQueue=o.updateQueue,a.flags&=-2053,o.lanes&=~_,Vo(o,a,_)):(Jr&&h&&_u(a),a.flags|=1,Bn(o,a,v,_),a.child)}function hp(o,a,h,v,_){if(o===null){var N=h.type;return typeof N=="function"&&!Rf(N)&&N.defaultProps===void 0&&h.compare===null&&h.defaultProps===void 0?(a.tag=15,a.type=N,Ni(o,a,N,v,_)):(o=Af(h.type,null,v,a,a.mode,_),o.ref=a.ref,o.return=a,a.child=o)}if(N=o.child,(o.lanes&_)===0){var j=N.memoizedProps;if(h=h.compare,h=h!==null?h:Qe,h(j,v)&&o.ref===a.ref)return Vo(o,a,_)}return a.flags|=1,o=Xo(N,v),o.ref=a.ref,o.return=a,a.child=o}function Ni(o,a,h,v,_){if(o!==null){var N=o.memoizedProps;if(Qe(N,v)&&o.ref===a.ref)if(ms=!1,a.pendingProps=v=N,(o.lanes&_)!==0)(o.flags&131072)!==0&&(ms=!0);else return a.lanes=o.lanes,Vo(o,a,_)}return gp(o,a,h,v,_)}function pp(o,a,h){var v=a.pendingProps,_=v.children,N=o!==null?o.memoizedState:null;if(v.mode==="hidden")if((a.mode&1)===0)a.memoizedState={baseLanes:0,cachePool:null,transitions:null},Br(Rc,eo),eo|=h;else{if((h&1073741824)===0)return o=N!==null?N.baseLanes|h:h,a.lanes=a.childLanes=1073741824,a.memoizedState={baseLanes:o,cachePool:null,transitions:null},a.updateQueue=null,Br(Rc,eo),eo|=o,null;a.memoizedState={baseLanes:0,cachePool:null,transitions:null},v=N!==null?N.baseLanes:h,Br(Rc,eo),eo|=v}else N!==null?(v=N.baseLanes|h,a.memoizedState=null):v=h,Br(Rc,eo),eo|=v;return Bn(o,a,_,h),a.child}function mp(o,a){var h=a.ref;(o===null&&h!==null||o!==null&&o.ref!==h)&&(a.flags|=512,a.flags|=2097152)}function gp(o,a,h,v,_){var N=Is(h)?hs:es.current;return N=pc(a,N),Sa(a,_),h=yl(o,a,h,v,N,_),v=rf(),o!==null&&!ms?(a.updateQueue=o.updateQueue,a.flags&=-2053,o.lanes&=~_,Vo(o,a,_)):(Jr&&v&&_u(a),a.flags|=1,Bn(o,a,h,_),a.child)}function vp(o,a,h,v,_){if(Is(h)){var N=!0;xo(a)}else N=!1;if(Sa(a,_),a.stateNode===null)gf(o,a),xl(a,h,v),dp(a,h,v,_),v=!0;else if(o===null){var j=a.stateNode,W=a.memoizedProps;j.props=W;var Z=j.context,we=h.contextType;typeof we=="object"&&we!==null?we=_o(we):(we=Is(h)?hs:es.current,we=pc(a,we));var je=h.getDerivedStateFromProps,De=typeof je=="function"||typeof j.getSnapshotBeforeUpdate=="function";De||typeof j.UNSAFE_componentWillReceiveProps!="function"&&typeof j.componentWillReceiveProps!="function"||(W!==v||Z!==we)&&Ec(a,j,v,we),So=!1;var Pe=a.memoizedState;j.state=Pe,vc(a,v,j,_),Z=a.memoizedState,W!==v||Pe!==Z||As.current||So?(typeof je=="function"&&(uf(a,h,je,v),Z=a.memoizedState),(W=So||up(a,h,W,v,Pe,Z,we))?(De||typeof j.UNSAFE_componentWillMount!="function"&&typeof j.componentWillMount!="function"||(typeof j.componentWillMount=="function"&&j.componentWillMount(),typeof j.UNSAFE_componentWillMount=="function"&&j.UNSAFE_componentWillMount()),typeof j.componentDidMount=="function"&&(a.flags|=4194308)):(typeof j.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=v,a.memoizedState=Z),j.props=v,j.state=Z,j.context=we,v=W):(typeof j.componentDidMount=="function"&&(a.flags|=4194308),v=!1)}else{j=a.stateNode,Bg(o,a),W=a.memoizedProps,we=a.type===a.elementType?W:ko(a.type,W),j.props=we,De=a.pendingProps,Pe=j.context,Z=h.contextType,typeof Z=="object"&&Z!==null?Z=_o(Z):(Z=Is(h)?hs:es.current,Z=pc(a,Z));var Ze=h.getDerivedStateFromProps;(je=typeof Ze=="function"||typeof j.getSnapshotBeforeUpdate=="function")||typeof j.UNSAFE_componentWillReceiveProps!="function"&&typeof j.componentWillReceiveProps!="function"||(W!==De||Pe!==Z)&&Ec(a,j,v,Z),So=!1,Pe=a.memoizedState,j.state=Pe,vc(a,v,j,_);var at=a.memoizedState;W!==De||Pe!==at||As.current||So?(typeof Ze=="function"&&(uf(a,h,Ze,v),at=a.memoizedState),(we=So||up(a,h,we,v,Pe,at,Z)||!1)?(je||typeof j.UNSAFE_componentWillUpdate!="function"&&typeof j.componentWillUpdate!="function"||(typeof j.componentWillUpdate=="function"&&j.componentWillUpdate(v,at,Z),typeof j.UNSAFE_componentWillUpdate=="function"&&j.UNSAFE_componentWillUpdate(v,at,Z)),typeof j.componentDidUpdate=="function"&&(a.flags|=4),typeof j.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof j.componentDidUpdate!="function"||W===o.memoizedProps&&Pe===o.memoizedState||(a.flags|=4),typeof j.getSnapshotBeforeUpdate!="function"||W===o.memoizedProps&&Pe===o.memoizedState||(a.flags|=1024),a.memoizedProps=v,a.memoizedState=at),j.props=v,j.state=at,j.context=Z,v=we):(typeof j.componentDidUpdate!="function"||W===o.memoizedProps&&Pe===o.memoizedState||(a.flags|=4),typeof j.getSnapshotBeforeUpdate!="function"||W===o.memoizedProps&&Pe===o.memoizedState||(a.flags|=1024),v=!1)}return yp(o,a,h,v,N,_)}function yp(o,a,h,v,_,N){mp(o,a);var j=(a.flags&128)!==0;if(!v&&!j)return _&&Lg(a,h,!1),Vo(o,a,N);v=a.stateNode,pf.current=a;var W=j&&typeof h.getDerivedStateFromError!="function"?null:v.render();return a.flags|=1,o!==null&&j?(a.child=cn(a,o.child,null,N),a.child=cn(a,null,W,N)):Bn(o,a,W,N),a.memoizedState=v.state,_&&Lg(a,h,!0),a.child}function ev(o){var a=o.stateNode;a.pendingContext?Og(o,a.pendingContext,a.pendingContext!==a.context):a.context&&Og(o,a.context,!1),Xh(o,a.containerInfo)}function Ti(o,a,h,v,_){return _i(),Si(_),a.flags|=256,Bn(o,a,h,v),a.child}var Ou={dehydrated:null,treeContext:null,retryLane:0};function Du(o){return{baseLanes:o,cachePool:null,transitions:null}}function mf(o,a,h){var v=a.pendingProps,_=Zr.current,N=!1,j=(a.flags&128)!==0,W;if((W=j)||(W=o!==null&&o.memoizedState===null?!1:(_&2)!==0),W?(N=!0,a.flags&=-129):(o===null||o.memoizedState!==null)&&(_|=1),Br(Zr,_&1),o===null)return Ps(a),o=a.memoizedState,o!==null&&(o=o.dehydrated,o!==null)?((a.mode&1)===0?a.lanes=1:o.data==="$!"?a.lanes=8:a.lanes=1073741824,null):(j=v.children,o=v.fallback,N?(v=a.mode,N=a.child,j={mode:"hidden",children:j},(v&1)===0&&N!==null?(N.childLanes=0,N.pendingProps=j):N=If(j,v,0,null),o=Cl(o,v,h,null),N.return=a,o.return=a,N.sibling=o,a.child=N,a.child.memoizedState=Du(h),a.memoizedState=Ou,o):kc(a,j));if(_=o.memoizedState,_!==null&&(W=_.dehydrated,W!==null))return Dt(o,a,j,v,W,_,h);if(N){N=v.fallback,j=a.mode,_=o.child,W=_.sibling;var Z={mode:"hidden",children:v.children};return(j&1)===0&&a.child!==_?(v=a.child,v.childLanes=0,v.pendingProps=Z,a.deletions=null):(v=Xo(_,Z),v.subtreeFlags=_.subtreeFlags&14680064),W!==null?N=Xo(W,N):(N=Cl(N,j,h,null),N.flags|=2),N.return=a,v.return=a,v.sibling=N,a.child=v,v=N,N=a.child,j=o.child.memoizedState,j=j===null?Du(h):{baseLanes:j.baseLanes|h,cachePool:null,transitions:j.transitions},N.memoizedState=j,N.childLanes=o.childLanes&~h,a.memoizedState=Ou,v}return N=o.child,o=N.sibling,v=Xo(N,{mode:"visible",children:v.children}),(a.mode&1)===0&&(v.lanes=h),v.return=a,v.sibling=null,o!==null&&(h=a.deletions,h===null?(a.deletions=[o],a.flags|=16):h.push(o)),a.child=v,a.memoizedState=null,v}function kc(o,a){return a=If({mode:"visible",children:a},o.mode,0,null),a.return=o,o.child=a}function Qi(o,a,h,v){return v!==null&&Si(v),cn(a,o.child,null,h),o=kc(a,a.pendingProps.children),o.flags|=2,a.memoizedState=null,o}function Dt(o,a,h,v,_,N,j){if(h)return a.flags&256?(a.flags&=-257,v=ff(Error(t(422))),Qi(o,a,j,v)):a.memoizedState!==null?(a.child=o.child,a.flags|=128,null):(N=v.fallback,_=a.mode,v=If({mode:"visible",children:v.children},_,0,null),N=Cl(N,_,j,null),N.flags|=2,v.return=a,N.return=a,v.sibling=N,a.child=v,(a.mode&1)!==0&&cn(a,o.child,null,j),a.child.memoizedState=Du(j),a.memoizedState=Ou,N);if((a.mode&1)===0)return Qi(o,a,j,null);if(_.data==="$!"){if(v=_.nextSibling&&_.nextSibling.dataset,v)var W=v.dgst;return v=W,N=Error(t(419)),v=ff(N,v,void 0),Qi(o,a,j,v)}if(W=(j&o.childLanes)!==0,ms||W){if(v=Pn,v!==null){switch(j&-j){case 4:_=2;break;case 16:_=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:_=32;break;case 536870912:_=268435456;break;default:_=0}_=(_&(v.suspendedLanes|j))!==0?0:_,_!==0&&_!==N.retryLane&&(N.retryLane=_,qi(o,_),Jo(v,o,_,-1))}return jp(),v=ff(Error(t(421))),Qi(o,a,j,v)}return _.data==="$?"?(a.flags|=128,a.child=o.child,a=V0.bind(null,o),_._reactRetry=a,null):(o=N.treeContext,Xs=ya(_.nextSibling),rs=a,Jr=!0,Go=null,o!==null&&(wo[bo++]=xi,wo[bo++]=wi,wo[bo++]=dl,xi=o.id,wi=o.overflow,dl=a),a=kc(a,v.children),a.flags|=4096,a)}function Lu(o,a,h){o.lanes|=a;var v=o.alternate;v!==null&&(v.lanes|=a),Hn(o.return,a,h)}function Mu(o,a,h,v,_){var N=o.memoizedState;N===null?o.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:v,tail:h,tailMode:_}:(N.isBackwards=a,N.rendering=null,N.renderingStartTime=0,N.last=v,N.tail=h,N.tailMode=_)}function ka(o,a,h){var v=a.pendingProps,_=v.revealOrder,N=v.tail;if(Bn(o,a,v.children,h),v=Zr.current,(v&2)!==0)v=v&1|2,a.flags|=128;else{if(o!==null&&(o.flags&128)!==0)e:for(o=a.child;o!==null;){if(o.tag===13)o.memoizedState!==null&&Lu(o,h,a);else if(o.tag===19)Lu(o,h,a);else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===a)break e;for(;o.sibling===null;){if(o.return===null||o.return===a)break e;o=o.return}o.sibling.return=o.return,o=o.sibling}v&=1}if(Br(Zr,v),(a.mode&1)===0)a.memoizedState=null;else switch(_){case"forwards":for(h=a.child,_=null;h!==null;)o=h.alternate,o!==null&&gl(o)===null&&(_=h),h=h.sibling;h=_,h===null?(_=a.child,a.child=null):(_=h.sibling,h.sibling=null),Mu(a,!1,_,h,N);break;case"backwards":for(h=null,_=a.child,a.child=null;_!==null;){if(o=_.alternate,o!==null&&gl(o)===null){a.child=_;break}o=_.sibling,_.sibling=h,h=_,_=o}Mu(a,!0,h,null,N);break;case"together":Mu(a,!1,null,null,void 0);break;default:a.memoizedState=null}return a.child}function gf(o,a){(a.mode&1)===0&&o!==null&&(o.alternate=null,a.alternate=null,a.flags|=2)}function Vo(o,a,h){if(o!==null&&(a.dependencies=o.dependencies),Ta|=a.lanes,(h&a.childLanes)===0)return null;if(o!==null&&a.child!==o.child)throw Error(t(153));if(a.child!==null){for(o=a.child,h=Xo(o,o.pendingProps),a.child=h,h.return=a;o.sibling!==null;)o=o.sibling,h=h.sibling=Xo(o,o.pendingProps),h.return=a;h.sibling=null}return a.child}function tv(o,a,h){switch(a.tag){case 3:ev(a),_i();break;case 5:Qh(a);break;case 1:Is(a.type)&&xo(a);break;case 4:Xh(a,a.stateNode.containerInfo);break;case 10:var v=a.type._context,_=a.memoizedProps.value;Br(Cu,v._currentValue),v._currentValue=_;break;case 13:if(v=a.memoizedState,v!==null)return v.dehydrated!==null?(Br(Zr,Zr.current&1),a.flags|=128,null):(h&a.child.childLanes)!==0?mf(o,a,h):(Br(Zr,Zr.current&1),o=Vo(o,a,h),o!==null?o.sibling:null);Br(Zr,Zr.current&1);break;case 19:if(v=(h&a.childLanes)!==0,(o.flags&128)!==0){if(v)return ka(o,a,h);a.flags|=128}if(_=a.memoizedState,_!==null&&(_.rendering=null,_.tail=null,_.lastEffect=null),Br(Zr,Zr.current),v)break;return null;case 22:case 23:return a.lanes=0,pp(o,a,h)}return Vo(o,a,h)}var Gn,xp,rv,wp;Gn=function(o,a){for(var h=a.child;h!==null;){if(h.tag===5||h.tag===6)o.appendChild(h.stateNode);else if(h.tag!==4&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===a)break;for(;h.sibling===null;){if(h.return===null||h.return===a)return;h=h.return}h.sibling.return=h.return,h=h.sibling}},xp=function(){},rv=function(o,a,h,v){var _=o.memoizedProps;if(_!==v){o=a.stateNode,Yi(Ei.current);var N=null;switch(h){case"input":_=Ce(o,_),v=Ce(o,v),N=[];break;case"select":_=q({},_,{value:void 0}),v=q({},v,{value:void 0}),N=[];break;case"textarea":_=Or(o,_),v=Or(o,v),N=[];break;default:typeof _.onClick!="function"&&typeof v.onClick=="function"&&(o.onclick=Ud)}Ge(h,v);var j;h=null;for(we in _)if(!v.hasOwnProperty(we)&&_.hasOwnProperty(we)&&_[we]!=null)if(we==="style"){var W=_[we];for(j in W)W.hasOwnProperty(j)&&(h||(h={}),h[j]="")}else we!=="dangerouslySetInnerHTML"&&we!=="children"&&we!=="suppressContentEditableWarning"&&we!=="suppressHydrationWarning"&&we!=="autoFocus"&&(s.hasOwnProperty(we)?N||(N=[]):(N=N||[]).push(we,null));for(we in v){var Z=v[we];if(W=_!=null?_[we]:void 0,v.hasOwnProperty(we)&&Z!==W&&(Z!=null||W!=null))if(we==="style")if(W){for(j in W)!W.hasOwnProperty(j)||Z&&Z.hasOwnProperty(j)||(h||(h={}),h[j]="");for(j in Z)Z.hasOwnProperty(j)&&W[j]!==Z[j]&&(h||(h={}),h[j]=Z[j])}else h||(N||(N=[]),N.push(we,h)),h=Z;else we==="dangerouslySetInnerHTML"?(Z=Z?Z.__html:void 0,W=W?W.__html:void 0,Z!=null&&W!==Z&&(N=N||[]).push(we,Z)):we==="children"?typeof Z!="string"&&typeof Z!="number"||(N=N||[]).push(we,""+Z):we!=="suppressContentEditableWarning"&&we!=="suppressHydrationWarning"&&(s.hasOwnProperty(we)?(Z!=null&&we==="onScroll"&&Kr("scroll",o),N||W===Z||(N=[])):(N=N||[]).push(we,Z))}h&&(N=N||[]).push("style",h);var we=N;(a.updateQueue=we)&&(a.flags|=4)}},wp=function(o,a,h,v){h!==v&&(a.flags|=4)};function $u(o,a){if(!Jr)switch(o.tailMode){case"hidden":a=o.tail;for(var h=null;a!==null;)a.alternate!==null&&(h=a),a=a.sibling;h===null?o.tail=null:h.sibling=null;break;case"collapsed":h=o.tail;for(var v=null;h!==null;)h.alternate!==null&&(v=h),h=h.sibling;v===null?a||o.tail===null?o.tail=null:o.tail.sibling=null:v.sibling=null}}function Wn(o){var a=o.alternate!==null&&o.alternate.child===o.child,h=0,v=0;if(a)for(var _=o.child;_!==null;)h|=_.lanes|_.childLanes,v|=_.subtreeFlags&14680064,v|=_.flags&14680064,_.return=o,_=_.sibling;else for(_=o.child;_!==null;)h|=_.lanes|_.childLanes,v|=_.subtreeFlags,v|=_.flags,_.return=o,_=_.sibling;return o.subtreeFlags|=v,o.childLanes=h,a}function M0(o,a,h){var v=a.pendingProps;switch(hl(a),a.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Wn(a),null;case 1:return Is(a.type)&&Gd(),Wn(a),null;case 3:return v=a.stateNode,Ea(),Yr(As),Yr(es),tf(),v.pendingContext&&(v.context=v.pendingContext,v.pendingContext=null),(o===null||o.child===null)&&(Su(a)?a.flags|=4:o===null||o.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,Go!==null&&(Ap(Go),Go=null))),xp(o,a),Wn(a),null;case 5:ef(a);var _=Yi(yc.current);if(h=a.type,o!==null&&a.stateNode!=null)rv(o,a,h,v,_),o.ref!==a.ref&&(a.flags|=512,a.flags|=2097152);else{if(!v){if(a.stateNode===null)throw Error(t(166));return Wn(a),null}if(o=Yi(Ei.current),Su(a)){v=a.stateNode,h=a.type;var N=a.memoizedProps;switch(v[vi]=a,v[xa]=N,o=(a.mode&1)!==0,h){case"dialog":Kr("cancel",v),Kr("close",v);break;case"iframe":case"object":case"embed":Kr("load",v);break;case"video":case"audio":for(_=0;_<Bi.length;_++)Kr(Bi[_],v);break;case"source":Kr("error",v);break;case"img":case"image":case"link":Kr("error",v),Kr("load",v);break;case"details":Kr("toggle",v);break;case"input":vt(v,N),Kr("invalid",v);break;case"select":v._wrapperState={wasMultiple:!!N.multiple},Kr("invalid",v);break;case"textarea":vr(v,N),Kr("invalid",v)}Ge(h,N),_=null;for(var j in N)if(N.hasOwnProperty(j)){var W=N[j];j==="children"?typeof W=="string"?v.textContent!==W&&(N.suppressHydrationWarning!==!0&&yu(v.textContent,W,o),_=["children",W]):typeof W=="number"&&v.textContent!==""+W&&(N.suppressHydrationWarning!==!0&&yu(v.textContent,W,o),_=["children",""+W]):s.hasOwnProperty(j)&&W!=null&&j==="onScroll"&&Kr("scroll",v)}switch(h){case"input":qe(v),At(v,N,!0);break;case"textarea":qe(v),_e(v);break;case"select":case"option":break;default:typeof N.onClick=="function"&&(v.onclick=Ud)}v=_,a.updateQueue=v,v!==null&&(a.flags|=4)}else{j=_.nodeType===9?_:_.ownerDocument,o==="http://www.w3.org/1999/xhtml"&&(o=Fe(h)),o==="http://www.w3.org/1999/xhtml"?h==="script"?(o=j.createElement("div"),o.innerHTML="<script><\/script>",o=o.removeChild(o.firstChild)):typeof v.is=="string"?o=j.createElement(h,{is:v.is}):(o=j.createElement(h),h==="select"&&(j=o,v.multiple?j.multiple=!0:v.size&&(j.size=v.size))):o=j.createElementNS(o,h),o[vi]=a,o[xa]=v,Gn(o,a,!1,!1),a.stateNode=o;e:{switch(j=cr(h,v),h){case"dialog":Kr("cancel",o),Kr("close",o),_=v;break;case"iframe":case"object":case"embed":Kr("load",o),_=v;break;case"video":case"audio":for(_=0;_<Bi.length;_++)Kr(Bi[_],o);_=v;break;case"source":Kr("error",o),_=v;break;case"img":case"image":case"link":Kr("error",o),Kr("load",o),_=v;break;case"details":Kr("toggle",o),_=v;break;case"input":vt(o,v),_=Ce(o,v),Kr("invalid",o);break;case"option":_=v;break;case"select":o._wrapperState={wasMultiple:!!v.multiple},_=q({},v,{value:void 0}),Kr("invalid",o);break;case"textarea":vr(o,v),_=Or(o,v),Kr("invalid",o);break;default:_=v}Ge(h,_),W=_;for(N in W)if(W.hasOwnProperty(N)){var Z=W[N];N==="style"?St(o,Z):N==="dangerouslySetInnerHTML"?(Z=Z?Z.__html:void 0,Z!=null&&Ut(o,Z)):N==="children"?typeof Z=="string"?(h!=="textarea"||Z!=="")&&Ue(o,Z):typeof Z=="number"&&Ue(o,""+Z):N!=="suppressContentEditableWarning"&&N!=="suppressHydrationWarning"&&N!=="autoFocus"&&(s.hasOwnProperty(N)?Z!=null&&N==="onScroll"&&Kr("scroll",o):Z!=null&&F(o,N,Z,j))}switch(h){case"input":qe(o),At(o,v,!1);break;case"textarea":qe(o),_e(o);break;case"option":v.value!=null&&o.setAttribute("value",""+ge(v.value));break;case"select":o.multiple=!!v.multiple,N=v.value,N!=null?Xt(o,!!v.multiple,N,!1):v.defaultValue!=null&&Xt(o,!!v.multiple,v.defaultValue,!0);break;default:typeof _.onClick=="function"&&(o.onclick=Ud)}switch(h){case"button":case"input":case"select":case"textarea":v=!!v.autoFocus;break e;case"img":v=!0;break e;default:v=!1}}v&&(a.flags|=4)}a.ref!==null&&(a.flags|=512,a.flags|=2097152)}return Wn(a),null;case 6:if(o&&a.stateNode!=null)wp(o,a,o.memoizedProps,v);else{if(typeof v!="string"&&a.stateNode===null)throw Error(t(166));if(h=Yi(yc.current),Yi(Ei.current),Su(a)){if(v=a.stateNode,h=a.memoizedProps,v[vi]=a,(N=v.nodeValue!==h)&&(o=rs,o!==null))switch(o.tag){case 3:yu(v.nodeValue,h,(o.mode&1)!==0);break;case 5:o.memoizedProps.suppressHydrationWarning!==!0&&yu(v.nodeValue,h,(o.mode&1)!==0)}N&&(a.flags|=4)}else v=(h.nodeType===9?h:h.ownerDocument).createTextNode(v),v[vi]=a,a.stateNode=v}return Wn(a),null;case 13:if(Yr(Zr),v=a.memoizedState,o===null||o.memoizedState!==null&&o.memoizedState.dehydrated!==null){if(Jr&&Xs!==null&&(a.mode&1)!==0&&(a.flags&128)===0)qh(),_i(),a.flags|=98560,N=!1;else if(N=Su(a),v!==null&&v.dehydrated!==null){if(o===null){if(!N)throw Error(t(318));if(N=a.memoizedState,N=N!==null?N.dehydrated:null,!N)throw Error(t(317));N[vi]=a}else _i(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;Wn(a),N=!1}else Go!==null&&(Ap(Go),Go=null),N=!0;if(!N)return a.flags&65536?a:null}return(a.flags&128)!==0?(a.lanes=h,a):(v=v!==null,v!==(o!==null&&o.memoizedState!==null)&&v&&(a.child.flags|=8192,(a.mode&1)!==0&&(o===null||(Zr.current&1)!==0?En===0&&(En=3):jp())),a.updateQueue!==null&&(a.flags|=4),Wn(a),null);case 4:return Ea(),xp(o,a),o===null&&ga(a.stateNode.containerInfo),Wn(a),null;case 10:return Jd(a.type._context),Wn(a),null;case 17:return Is(a.type)&&Gd(),Wn(a),null;case 19:if(Yr(Zr),N=a.memoizedState,N===null)return Wn(a),null;if(v=(a.flags&128)!==0,j=N.rendering,j===null)if(v)$u(N,!1);else{if(En!==0||o!==null&&(o.flags&128)!==0)for(o=a.child;o!==null;){if(j=gl(o),j!==null){for(a.flags|=128,$u(N,!1),v=j.updateQueue,v!==null&&(a.updateQueue=v,a.flags|=4),a.subtreeFlags=0,v=h,h=a.child;h!==null;)N=h,o=v,N.flags&=14680066,j=N.alternate,j===null?(N.childLanes=0,N.lanes=o,N.child=null,N.subtreeFlags=0,N.memoizedProps=null,N.memoizedState=null,N.updateQueue=null,N.dependencies=null,N.stateNode=null):(N.childLanes=j.childLanes,N.lanes=j.lanes,N.child=j.child,N.subtreeFlags=0,N.deletions=null,N.memoizedProps=j.memoizedProps,N.memoizedState=j.memoizedState,N.updateQueue=j.updateQueue,N.type=j.type,o=j.dependencies,N.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),h=h.sibling;return Br(Zr,Zr.current&1|2),a.child}o=o.sibling}N.tail!==null&&qt()>bl&&(a.flags|=128,v=!0,$u(N,!1),a.lanes=4194304)}else{if(!v)if(o=gl(j),o!==null){if(a.flags|=128,v=!0,h=o.updateQueue,h!==null&&(a.updateQueue=h,a.flags|=4),$u(N,!0),N.tail===null&&N.tailMode==="hidden"&&!j.alternate&&!Jr)return Wn(a),null}else 2*qt()-N.renderingStartTime>bl&&h!==1073741824&&(a.flags|=128,v=!0,$u(N,!1),a.lanes=4194304);N.isBackwards?(j.sibling=a.child,a.child=j):(h=N.last,h!==null?h.sibling=j:a.child=j,N.last=j)}return N.tail!==null?(a=N.tail,N.rendering=a,N.tail=a.sibling,N.renderingStartTime=qt(),a.sibling=null,h=Zr.current,Br(Zr,v?h&1|2:h&1),a):(Wn(a),null);case 22:case 23:return Pp(),v=a.memoizedState!==null,o!==null&&o.memoizedState!==null!==v&&(a.flags|=8192),v&&(a.mode&1)!==0?(eo&1073741824)!==0&&(Wn(a),a.subtreeFlags&6&&(a.flags|=8192)):Wn(a),null;case 24:return null;case 25:return null}throw Error(t(156,a.tag))}function $0(o,a){switch(hl(a),a.tag){case 1:return Is(a.type)&&Gd(),o=a.flags,o&65536?(a.flags=o&-65537|128,a):null;case 3:return Ea(),Yr(As),Yr(es),tf(),o=a.flags,(o&65536)!==0&&(o&128)===0?(a.flags=o&-65537|128,a):null;case 5:return ef(a),null;case 13:if(Yr(Zr),o=a.memoizedState,o!==null&&o.dehydrated!==null){if(a.alternate===null)throw Error(t(340));_i()}return o=a.flags,o&65536?(a.flags=o&-65537|128,a):null;case 19:return Yr(Zr),null;case 4:return Ea(),null;case 10:return Jd(a.type._context),null;case 22:case 23:return Pp(),null;case 24:return null;default:return null}}var vf=!1,en=!1,gs=typeof WeakSet=="function"?WeakSet:Set,it=null;function Nc(o,a){var h=o.ref;if(h!==null)if(typeof h=="function")try{h(null)}catch(v){nn(o,a,v)}else h.current=null}function Uu(o,a,h){try{h()}catch(v){nn(o,a,v)}}var nv=!1;function U0(o,a){if(xu=sl,o=Dr(),fu(o)){if("selectionStart"in o)var h={start:o.selectionStart,end:o.selectionEnd};else e:{h=(h=o.ownerDocument)&&h.defaultView||window;var v=h.getSelection&&h.getSelection();if(v&&v.rangeCount!==0){h=v.anchorNode;var _=v.anchorOffset,N=v.focusNode;v=v.focusOffset;try{h.nodeType,N.nodeType}catch{h=null;break e}var j=0,W=-1,Z=-1,we=0,je=0,De=o,Pe=null;t:for(;;){for(var Ze;De!==h||_!==0&&De.nodeType!==3||(W=j+_),De!==N||v!==0&&De.nodeType!==3||(Z=j+v),De.nodeType===3&&(j+=De.nodeValue.length),(Ze=De.firstChild)!==null;)Pe=De,De=Ze;for(;;){if(De===o)break t;if(Pe===h&&++we===_&&(W=j),Pe===N&&++je===v&&(Z=j),(Ze=De.nextSibling)!==null)break;De=Pe,Pe=De.parentNode}De=Ze}h=W===-1||Z===-1?null:{start:W,end:Z}}else h=null}h=h||{start:0,end:0}}else h=null;for(cl={focusedElem:o,selectionRange:h},sl=!1,it=a;it!==null;)if(a=it,o=a.child,(a.subtreeFlags&1028)!==0&&o!==null)o.return=a,it=o;else for(;it!==null;){a=it;try{var at=a.alternate;if((a.flags&1024)!==0)switch(a.tag){case 0:case 11:case 15:break;case 1:if(at!==null){var dt=at.memoizedProps,pn=at.memoizedState,pe=a.stateNode,oe=pe.getSnapshotBeforeUpdate(a.elementType===a.type?dt:ko(a.type,dt),pn);pe.__reactInternalSnapshotBeforeUpdate=oe}break;case 3:var me=a.stateNode.containerInfo;me.nodeType===1?me.textContent="":me.nodeType===9&&me.documentElement&&me.removeChild(me.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(Me){nn(a,a.return,Me)}if(o=a.sibling,o!==null){o.return=a.return,it=o;break}it=a.return}return at=nv,nv=!1,at}function Zi(o,a,h){var v=a.updateQueue;if(v=v!==null?v.lastEffect:null,v!==null){var _=v=v.next;do{if((_.tag&o)===o){var N=_.destroy;_.destroy=void 0,N!==void 0&&Uu(a,h,N)}_=_.next}while(_!==v)}}function zu(o,a){if(a=a.updateQueue,a=a!==null?a.lastEffect:null,a!==null){var h=a=a.next;do{if((h.tag&o)===o){var v=h.create;h.destroy=v()}h=h.next}while(h!==a)}}function yf(o){var a=o.ref;if(a!==null){var h=o.stateNode;switch(o.tag){case 5:o=h;break;default:o=h}typeof a=="function"?a(o):a.current=o}}function sv(o){var a=o.alternate;a!==null&&(o.alternate=null,sv(a)),o.child=null,o.deletions=null,o.sibling=null,o.tag===5&&(a=o.stateNode,a!==null&&(delete a[vi],delete a[xa],delete a[Hd],delete a[D],delete a[fc])),o.stateNode=null,o.return=null,o.dependencies=null,o.memoizedProps=null,o.memoizedState=null,o.pendingProps=null,o.stateNode=null,o.updateQueue=null}function ov(o){return o.tag===5||o.tag===3||o.tag===4}function iv(o){e:for(;;){for(;o.sibling===null;){if(o.return===null||ov(o.return))return null;o=o.return}for(o.sibling.return=o.return,o=o.sibling;o.tag!==5&&o.tag!==6&&o.tag!==18;){if(o.flags&2||o.child===null||o.tag===4)continue e;o.child.return=o,o=o.child}if(!(o.flags&2))return o.stateNode}}function bp(o,a,h){var v=o.tag;if(v===5||v===6)o=o.stateNode,a?h.nodeType===8?h.parentNode.insertBefore(o,a):h.insertBefore(o,a):(h.nodeType===8?(a=h.parentNode,a.insertBefore(o,h)):(a=h,a.appendChild(o)),h=h._reactRootContainer,h!=null||a.onclick!==null||(a.onclick=Ud));else if(v!==4&&(o=o.child,o!==null))for(bp(o,a,h),o=o.sibling;o!==null;)bp(o,a,h),o=o.sibling}function xf(o,a,h){var v=o.tag;if(v===5||v===6)o=o.stateNode,a?h.insertBefore(o,a):h.appendChild(o);else if(v!==4&&(o=o.child,o!==null))for(xf(o,a,h),o=o.sibling;o!==null;)xf(o,a,h),o=o.sibling}var In=null,qo=!1;function Ri(o,a,h){for(h=h.child;h!==null;)_p(o,a,h),h=h.sibling}function _p(o,a,h){if(Un&&typeof Un.onCommitFiberUnmount=="function")try{Un.onCommitFiberUnmount(fi,h)}catch{}switch(h.tag){case 5:en||Nc(h,a);case 6:var v=In,_=qo;In=null,Ri(o,a,h),In=v,qo=_,In!==null&&(qo?(o=In,h=h.stateNode,o.nodeType===8?o.parentNode.removeChild(h):o.removeChild(h)):In.removeChild(h.stateNode));break;case 18:In!==null&&(qo?(o=In,h=h.stateNode,o.nodeType===8?Gh(o.parentNode,h):o.nodeType===1&&Gh(o,h),Cr(o)):Gh(In,h.stateNode));break;case 4:v=In,_=qo,In=h.stateNode.containerInfo,qo=!0,Ri(o,a,h),In=v,qo=_;break;case 0:case 11:case 14:case 15:if(!en&&(v=h.updateQueue,v!==null&&(v=v.lastEffect,v!==null))){_=v=v.next;do{var N=_,j=N.destroy;N=N.tag,j!==void 0&&((N&2)!==0||(N&4)!==0)&&Uu(h,a,j),_=_.next}while(_!==v)}Ri(o,a,h);break;case 1:if(!en&&(Nc(h,a),v=h.stateNode,typeof v.componentWillUnmount=="function"))try{v.props=h.memoizedProps,v.state=h.memoizedState,v.componentWillUnmount()}catch(W){nn(h,a,W)}Ri(o,a,h);break;case 21:Ri(o,a,h);break;case 22:h.mode&1?(en=(v=en)||h.memoizedState!==null,Ri(o,a,h),en=v):Ri(o,a,h);break;default:Ri(o,a,h)}}function Tc(o){var a=o.updateQueue;if(a!==null){o.updateQueue=null;var h=o.stateNode;h===null&&(h=o.stateNode=new gs),a.forEach(function(v){var _=q0.bind(null,o,v);h.has(v)||(h.add(v),v.then(_,_))})}}function Zs(o,a){var h=a.deletions;if(h!==null)for(var v=0;v<h.length;v++){var _=h[v];try{var N=o,j=a,W=j;e:for(;W!==null;){switch(W.tag){case 5:In=W.stateNode,qo=!1;break e;case 3:In=W.stateNode.containerInfo,qo=!0;break e;case 4:In=W.stateNode.containerInfo,qo=!0;break e}W=W.return}if(In===null)throw Error(t(160));_p(N,j,_),In=null,qo=!1;var Z=_.alternate;Z!==null&&(Z.return=null),_.return=null}catch(we){nn(_,a,we)}}if(a.subtreeFlags&12854)for(a=a.child;a!==null;)Sp(a,o),a=a.sibling}function Sp(o,a){var h=o.alternate,v=o.flags;switch(o.tag){case 0:case 11:case 14:case 15:if(Zs(a,o),Ko(o),v&4){try{Zi(3,o,o.return),zu(3,o)}catch(dt){nn(o,o.return,dt)}try{Zi(5,o,o.return)}catch(dt){nn(o,o.return,dt)}}break;case 1:Zs(a,o),Ko(o),v&512&&h!==null&&Nc(h,h.return);break;case 5:if(Zs(a,o),Ko(o),v&512&&h!==null&&Nc(h,h.return),o.flags&32){var _=o.stateNode;try{Ue(_,"")}catch(dt){nn(o,o.return,dt)}}if(v&4&&(_=o.stateNode,_!=null)){var N=o.memoizedProps,j=h!==null?h.memoizedProps:N,W=o.type,Z=o.updateQueue;if(o.updateQueue=null,Z!==null)try{W==="input"&&N.type==="radio"&&N.name!=null&&kt(_,N),cr(W,j);var we=cr(W,N);for(j=0;j<Z.length;j+=2){var je=Z[j],De=Z[j+1];je==="style"?St(_,De):je==="dangerouslySetInnerHTML"?Ut(_,De):je==="children"?Ue(_,De):F(_,je,De,we)}switch(W){case"input":yt(_,N);break;case"textarea":dn(_,N);break;case"select":var Pe=_._wrapperState.wasMultiple;_._wrapperState.wasMultiple=!!N.multiple;var Ze=N.value;Ze!=null?Xt(_,!!N.multiple,Ze,!1):Pe!==!!N.multiple&&(N.defaultValue!=null?Xt(_,!!N.multiple,N.defaultValue,!0):Xt(_,!!N.multiple,N.multiple?[]:"",!1))}_[xa]=N}catch(dt){nn(o,o.return,dt)}}break;case 6:if(Zs(a,o),Ko(o),v&4){if(o.stateNode===null)throw Error(t(162));_=o.stateNode,N=o.memoizedProps;try{_.nodeValue=N}catch(dt){nn(o,o.return,dt)}}break;case 3:if(Zs(a,o),Ko(o),v&4&&h!==null&&h.memoizedState.isDehydrated)try{Cr(a.containerInfo)}catch(dt){nn(o,o.return,dt)}break;case 4:Zs(a,o),Ko(o);break;case 13:Zs(a,o),Ko(o),_=o.child,_.flags&8192&&(N=_.memoizedState!==null,_.stateNode.isHidden=N,!N||_.alternate!==null&&_.alternate.memoizedState!==null||(kp=qt())),v&4&&Tc(o);break;case 22:if(je=h!==null&&h.memoizedState!==null,o.mode&1?(en=(we=en)||je,Zs(a,o),en=we):Zs(a,o),Ko(o),v&8192){if(we=o.memoizedState!==null,(o.stateNode.isHidden=we)&&!je&&(o.mode&1)!==0)for(it=o,je=o.child;je!==null;){for(De=it=je;it!==null;){switch(Pe=it,Ze=Pe.child,Pe.tag){case 0:case 11:case 14:case 15:Zi(4,Pe,Pe.return);break;case 1:Nc(Pe,Pe.return);var at=Pe.stateNode;if(typeof at.componentWillUnmount=="function"){v=Pe,h=Pe.return;try{a=v,at.props=a.memoizedProps,at.state=a.memoizedState,at.componentWillUnmount()}catch(dt){nn(v,h,dt)}}break;case 5:Nc(Pe,Pe.return);break;case 22:if(Pe.memoizedState!==null){Na(De);continue}}Ze!==null?(Ze.return=Pe,it=Ze):Na(De)}je=je.sibling}e:for(je=null,De=o;;){if(De.tag===5){if(je===null){je=De;try{_=De.stateNode,we?(N=_.style,typeof N.setProperty=="function"?N.setProperty("display","none","important"):N.display="none"):(W=De.stateNode,Z=De.memoizedProps.style,j=Z!=null&&Z.hasOwnProperty("display")?Z.display:null,W.style.display=Ie("display",j))}catch(dt){nn(o,o.return,dt)}}}else if(De.tag===6){if(je===null)try{De.stateNode.nodeValue=we?"":De.memoizedProps}catch(dt){nn(o,o.return,dt)}}else if((De.tag!==22&&De.tag!==23||De.memoizedState===null||De===o)&&De.child!==null){De.child.return=De,De=De.child;continue}if(De===o)break e;for(;De.sibling===null;){if(De.return===null||De.return===o)break e;je===De&&(je=null),De=De.return}je===De&&(je=null),De.sibling.return=De.return,De=De.sibling}}break;case 19:Zs(a,o),Ko(o),v&4&&Tc(o);break;case 21:break;default:Zs(a,o),Ko(o)}}function Ko(o){var a=o.flags;if(a&2){try{e:{for(var h=o.return;h!==null;){if(ov(h)){var v=h;break e}h=h.return}throw Error(t(160))}switch(v.tag){case 5:var _=v.stateNode;v.flags&32&&(Ue(_,""),v.flags&=-33);var N=iv(o);xf(o,N,_);break;case 3:case 4:var j=v.stateNode.containerInfo,W=iv(o);bp(o,W,j);break;default:throw Error(t(161))}}catch(Z){nn(o,o.return,Z)}o.flags&=-3}a&4096&&(o.flags&=-4097)}function wf(o,a,h){it=o,Ep(o)}function Ep(o,a,h){for(var v=(o.mode&1)!==0;it!==null;){var _=it,N=_.child;if(_.tag===22&&v){var j=_.memoizedState!==null||vf;if(!j){var W=_.alternate,Z=W!==null&&W.memoizedState!==null||en;W=vf;var we=en;if(vf=j,(en=Z)&&!we)for(it=_;it!==null;)j=it,Z=j.child,j.tag===22&&j.memoizedState!==null?av(_):Z!==null?(Z.return=j,it=Z):av(_);for(;N!==null;)it=N,Ep(N),N=N.sibling;it=_,vf=W,en=we}Yo(o)}else(_.subtreeFlags&8772)!==0&&N!==null?(N.return=_,it=N):Yo(o)}}function Yo(o){for(;it!==null;){var a=it;if((a.flags&8772)!==0){var h=a.alternate;try{if((a.flags&8772)!==0)switch(a.tag){case 0:case 11:case 15:en||zu(5,a);break;case 1:var v=a.stateNode;if(a.flags&4&&!en)if(h===null)v.componentDidMount();else{var _=a.elementType===a.type?h.memoizedProps:ko(a.type,h.memoizedProps);v.componentDidUpdate(_,h.memoizedState,v.__reactInternalSnapshotBeforeUpdate)}var N=a.updateQueue;N!==null&&Jh(a,N,v);break;case 3:var j=a.updateQueue;if(j!==null){if(h=null,a.child!==null)switch(a.child.tag){case 5:h=a.child.stateNode;break;case 1:h=a.child.stateNode}Jh(a,j,h)}break;case 5:var W=a.stateNode;if(h===null&&a.flags&4){h=W;var Z=a.memoizedProps;switch(a.type){case"button":case"input":case"select":case"textarea":Z.autoFocus&&h.focus();break;case"img":Z.src&&(h.src=Z.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(a.memoizedState===null){var we=a.alternate;if(we!==null){var je=we.memoizedState;if(je!==null){var De=je.dehydrated;De!==null&&Cr(De)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}en||a.flags&512&&yf(a)}catch(Pe){nn(a,a.return,Pe)}}if(a===o){it=null;break}if(h=a.sibling,h!==null){h.return=a.return,it=h;break}it=a.return}}function Na(o){for(;it!==null;){var a=it;if(a===o){it=null;break}var h=a.sibling;if(h!==null){h.return=a.return,it=h;break}it=a.return}}function av(o){for(;it!==null;){var a=it;try{switch(a.tag){case 0:case 11:case 15:var h=a.return;try{zu(4,a)}catch(Z){nn(a,h,Z)}break;case 1:var v=a.stateNode;if(typeof v.componentDidMount=="function"){var _=a.return;try{v.componentDidMount()}catch(Z){nn(a,_,Z)}}var N=a.return;try{yf(a)}catch(Z){nn(a,N,Z)}break;case 5:var j=a.return;try{yf(a)}catch(Z){nn(a,j,Z)}}}catch(Z){nn(a,a.return,Z)}if(a===o){it=null;break}var W=a.sibling;if(W!==null){W.return=a.return,it=W;break}it=a.return}}var lv=Math.ceil,bf=P.ReactCurrentDispatcher,Cp=P.ReactCurrentOwner,No=P.ReactCurrentBatchConfig,_r=0,Pn=null,wn=null,Vn=0,eo=0,Rc=Rs(0),En=0,Hu=null,Ta=0,Bu=0,_f=0,Gu=null,Fs=null,kp=0,bl=1/0,ea=null,Sf=!1,Np=null,Ra=null,Ef=!1,Aa=null,vs=0,Wu=0,Tp=null,Cf=-1,Vu=0;function ys(){return(_r&6)!==0?qt():Cf!==-1?Cf:Cf=qt()}function Ia(o){return(o.mode&1)===0?1:(_r&2)!==0&&Vn!==0?Vn&-Vn:zg.transition!==null?(Vu===0&&(Vu=ou()),Vu):(o=ur,o!==0||(o=window.event,o=o===void 0?16:hg(o.type)),o)}function Jo(o,a,h,v){if(50<Wu)throw Wu=0,Tp=null,Error(t(185));el(o,h,v),((_r&2)===0||o!==Pn)&&(o===Pn&&((_r&2)===0&&(Bu|=h),En===4&&Pa(o,Vn)),Os(o,v),h===1&&_r===0&&(a.mode&1)===0&&(bl=qt()+500,Wd&&ba()))}function Os(o,a){var h=o.callbackNode;Ch(o,a);var v=hi(o,o===Pn?Vn:0);if(v===0)h!==null&&Le(h),o.callbackNode=null,o.callbackPriority=0;else if(a=v&-v,o.callbackPriority!==a){if(h!=null&&Le(h),a===1)o.tag===0?ul(cv.bind(null,o)):Mg(cv.bind(null,o)),zd(function(){(_r&6)===0&&ba()}),h=null;else{switch($o(v)){case 1:h=fn;break;case 4:h=ks;break;case 16:h=us;break;case 536870912:h=qr;break;default:h=us}h=gv(h,kf.bind(null,o))}o.callbackPriority=a,o.callbackNode=h}}function kf(o,a){if(Cf=-1,Vu=0,(_r&6)!==0)throw Error(t(327));var h=o.callbackNode;if(Ac()&&o.callbackNode!==h)return null;var v=hi(o,o===Pn?Vn:0);if(v===0)return null;if((v&30)!==0||(v&o.expiredLanes)!==0||a)a=Nf(o,v);else{a=v;var _=_r;_r|=2;var N=dv();(Pn!==o||Vn!==a)&&(ea=null,bl=qt()+500,Sl(o,a));do try{B0();break}catch(W){uv(o,W)}while(!0);Vi(),bf.current=N,_r=_,wn!==null?a=0:(Pn=null,Vn=0,a=En)}if(a!==0){if(a===2&&(_=Xl(o),_!==0&&(v=_,a=Rp(o,_))),a===1)throw h=Hu,Sl(o,0),Pa(o,v),Os(o,qt()),h;if(a===6)Pa(o,v);else{if(_=o.current.alternate,(v&30)===0&&!z0(_)&&(a=Nf(o,v),a===2&&(N=Xl(o),N!==0&&(v=N,a=Rp(o,N))),a===1))throw h=Hu,Sl(o,0),Pa(o,v),Os(o,qt()),h;switch(o.finishedWork=_,o.finishedLanes=v,a){case 0:case 1:throw Error(t(345));case 2:El(o,Fs,ea);break;case 3:if(Pa(o,v),(v&130023424)===v&&(a=kp+500-qt(),10<a)){if(hi(o,0)!==0)break;if(_=o.suspendedLanes,(_&v)!==v){ys(),o.pingedLanes|=o.suspendedLanes&_;break}o.timeoutHandle=va(El.bind(null,o,Fs,ea),a);break}El(o,Fs,ea);break;case 4:if(Pa(o,v),(v&4194240)===v)break;for(a=o.eventTimes,_=-1;0<v;){var j=31-zn(v);N=1<<j,j=a[j],j>_&&(_=j),v&=~N}if(v=_,v=qt()-v,v=(120>v?120:480>v?480:1080>v?1080:1920>v?1920:3e3>v?3e3:4320>v?4320:1960*lv(v/1960))-v,10<v){o.timeoutHandle=va(El.bind(null,o,Fs,ea),v);break}El(o,Fs,ea);break;case 5:El(o,Fs,ea);break;default:throw Error(t(329))}}}return Os(o,qt()),o.callbackNode===h?kf.bind(null,o):null}function Rp(o,a){var h=Gu;return o.current.memoizedState.isDehydrated&&(Sl(o,a).flags|=256),o=Nf(o,a),o!==2&&(a=Fs,Fs=h,a!==null&&Ap(a)),o}function Ap(o){Fs===null?Fs=o:Fs.push.apply(Fs,o)}function z0(o){for(var a=o;;){if(a.flags&16384){var h=a.updateQueue;if(h!==null&&(h=h.stores,h!==null))for(var v=0;v<h.length;v++){var _=h[v],N=_.getSnapshot;_=_.value;try{if(!ye(N(),_))return!1}catch{return!1}}}if(h=a.child,a.subtreeFlags&16384&&h!==null)h.return=a,a=h;else{if(a===o)break;for(;a.sibling===null;){if(a.return===null||a.return===o)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function Pa(o,a){for(a&=~_f,a&=~Bu,o.suspendedLanes|=a,o.pingedLanes&=~a,o=o.expirationTimes;0<a;){var h=31-zn(a),v=1<<h;o[h]=-1,a&=~v}}function cv(o){if((_r&6)!==0)throw Error(t(327));Ac();var a=hi(o,0);if((a&1)===0)return Os(o,qt()),null;var h=Nf(o,a);if(o.tag!==0&&h===2){var v=Xl(o);v!==0&&(a=v,h=Rp(o,v))}if(h===1)throw h=Hu,Sl(o,0),Pa(o,a),Os(o,qt()),h;if(h===6)throw Error(t(345));return o.finishedWork=o.current.alternate,o.finishedLanes=a,El(o,Fs,ea),Os(o,qt()),null}function Ip(o,a){var h=_r;_r|=1;try{return o(a)}finally{_r=h,_r===0&&(bl=qt()+500,Wd&&ba())}}function _l(o){Aa!==null&&Aa.tag===0&&(_r&6)===0&&Ac();var a=_r;_r|=1;var h=No.transition,v=ur;try{if(No.transition=null,ur=1,o)return o()}finally{ur=v,No.transition=h,_r=a,(_r&6)===0&&ba()}}function Pp(){eo=Rc.current,Yr(Rc)}function Sl(o,a){o.finishedWork=null,o.finishedLanes=0;var h=o.timeoutHandle;if(h!==-1&&(o.timeoutHandle=-1,bu(h)),wn!==null)for(h=wn.return;h!==null;){var v=h;switch(hl(v),v.tag){case 1:v=v.type.childContextTypes,v!=null&&Gd();break;case 3:Ea(),Yr(As),Yr(es),tf();break;case 5:ef(v);break;case 4:Ea();break;case 13:Yr(Zr);break;case 19:Yr(Zr);break;case 10:Jd(v.type._context);break;case 22:case 23:Pp()}h=h.return}if(Pn=o,wn=o=Xo(o.current,null),Vn=eo=a,En=0,Hu=null,_f=Bu=Ta=0,Fs=Gu=null,ml!==null){for(a=0;a<ml.length;a++)if(h=ml[a],v=h.interleaved,v!==null){h.interleaved=null;var _=v.next,N=h.pending;if(N!==null){var j=N.next;N.next=_,v.next=j}h.pending=v}ml=null}return o}function uv(o,a){do{var h=wn;try{if(Vi(),Tu.current=lf,xc){for(var v=rn.memoizedState;v!==null;){var _=v.queue;_!==null&&(_.pending=null),v=v.next}xc=!1}if(Ca=0,Sn=hn=rn=null,Ru=!1,vl=0,Cp.current=null,h===null||h.return===null){En=1,Hu=a,wn=null;break}e:{var N=o,j=h.return,W=h,Z=a;if(a=Vn,W.flags|=32768,Z!==null&&typeof Z=="object"&&typeof Z.then=="function"){var we=Z,je=W,De=je.tag;if((je.mode&1)===0&&(De===0||De===11||De===15)){var Pe=je.alternate;Pe?(je.updateQueue=Pe.updateQueue,je.memoizedState=Pe.memoizedState,je.lanes=Pe.lanes):(je.updateQueue=null,je.memoizedState=null)}var Ze=Qg(j);if(Ze!==null){Ze.flags&=-257,fp(Ze,j,W,N,a),Ze.mode&1&&Fu(N,we,a),a=Ze,Z=we;var at=a.updateQueue;if(at===null){var dt=new Set;dt.add(Z),a.updateQueue=dt}else at.add(Z);break e}else{if((a&1)===0){Fu(N,we,a),jp();break e}Z=Error(t(426))}}else if(Jr&&W.mode&1){var pn=Qg(j);if(pn!==null){(pn.flags&65536)===0&&(pn.flags|=256),fp(pn,j,W,N,a),Si(wl(Z,W));break e}}N=Z=wl(Z,W),En!==4&&(En=2),Gu===null?Gu=[N]:Gu.push(N),N=j;do{switch(N.tag){case 3:N.flags|=65536,a&=-a,N.lanes|=a;var pe=ju(N,Z,a);Gg(N,pe);break e;case 1:W=Z;var oe=N.type,me=N.stateNode;if((N.flags&128)===0&&(typeof oe.getDerivedStateFromError=="function"||me!==null&&typeof me.componentDidCatch=="function"&&(Ra===null||!Ra.has(me)))){N.flags|=65536,a&=-a,N.lanes|=a;var Me=hf(N,W,a);Gg(N,Me);break e}}N=N.return}while(N!==null)}hv(h)}catch(gt){a=gt,wn===h&&h!==null&&(wn=h=h.return);continue}break}while(!0)}function dv(){var o=bf.current;return bf.current=lf,o===null?lf:o}function jp(){(En===0||En===3||En===2)&&(En=4),Pn===null||(Ta&268435455)===0&&(Bu&268435455)===0||Pa(Pn,Vn)}function Nf(o,a){var h=_r;_r|=2;var v=dv();(Pn!==o||Vn!==a)&&(ea=null,Sl(o,a));do try{H0();break}catch(_){uv(o,_)}while(!0);if(Vi(),_r=h,bf.current=v,wn!==null)throw Error(t(261));return Pn=null,Vn=0,En}function H0(){for(;wn!==null;)fv(wn)}function B0(){for(;wn!==null&&!st();)fv(wn)}function fv(o){var a=mv(o.alternate,o,eo);o.memoizedProps=o.pendingProps,a===null?hv(o):wn=a,Cp.current=null}function hv(o){var a=o;do{var h=a.alternate;if(o=a.return,(a.flags&32768)===0){if(h=M0(h,a,eo),h!==null){wn=h;return}}else{if(h=$0(h,a),h!==null){h.flags&=32767,wn=h;return}if(o!==null)o.flags|=32768,o.subtreeFlags=0,o.deletions=null;else{En=6,wn=null;return}}if(a=a.sibling,a!==null){wn=a;return}wn=a=o}while(a!==null);En===0&&(En=5)}function El(o,a,h){var v=ur,_=No.transition;try{No.transition=null,ur=1,G0(o,a,h,v)}finally{No.transition=_,ur=v}return null}function G0(o,a,h,v){do Ac();while(Aa!==null);if((_r&6)!==0)throw Error(t(327));h=o.finishedWork;var _=o.finishedLanes;if(h===null)return null;if(o.finishedWork=null,o.finishedLanes=0,h===o.current)throw Error(t(177));o.callbackNode=null,o.callbackPriority=0;var N=h.lanes|h.childLanes;if(xd(o,N),o===Pn&&(wn=Pn=null,Vn=0),(h.subtreeFlags&2064)===0&&(h.flags&2064)===0||Ef||(Ef=!0,gv(us,function(){return Ac(),null})),N=(h.flags&15990)!==0,(h.subtreeFlags&15990)!==0||N){N=No.transition,No.transition=null;var j=ur;ur=1;var W=_r;_r|=4,Cp.current=null,U0(o,h),Sp(h,o),F0(cl),sl=!!xu,cl=xu=null,o.current=h,wf(h),jr(),_r=W,ur=j,No.transition=N}else o.current=h;if(Ef&&(Ef=!1,Aa=o,vs=_),N=o.pendingLanes,N===0&&(Ra=null),vd(h.stateNode),Os(o,qt()),a!==null)for(v=o.onRecoverableError,h=0;h<a.length;h++)_=a[h],v(_.value,{componentStack:_.stack,digest:_.digest});if(Sf)throw Sf=!1,o=Np,Np=null,o;return(vs&1)!==0&&o.tag!==0&&Ac(),N=o.pendingLanes,(N&1)!==0?o===Tp?Wu++:(Wu=0,Tp=o):Wu=0,ba(),null}function Ac(){if(Aa!==null){var o=$o(vs),a=No.transition,h=ur;try{if(No.transition=null,ur=16>o?16:o,Aa===null)var v=!1;else{if(o=Aa,Aa=null,vs=0,(_r&6)!==0)throw Error(t(331));var _=_r;for(_r|=4,it=o.current;it!==null;){var N=it,j=N.child;if((it.flags&16)!==0){var W=N.deletions;if(W!==null){for(var Z=0;Z<W.length;Z++){var we=W[Z];for(it=we;it!==null;){var je=it;switch(je.tag){case 0:case 11:case 15:Zi(8,je,N)}var De=je.child;if(De!==null)De.return=je,it=De;else for(;it!==null;){je=it;var Pe=je.sibling,Ze=je.return;if(sv(je),je===we){it=null;break}if(Pe!==null){Pe.return=Ze,it=Pe;break}it=Ze}}}var at=N.alternate;if(at!==null){var dt=at.child;if(dt!==null){at.child=null;do{var pn=dt.sibling;dt.sibling=null,dt=pn}while(dt!==null)}}it=N}}if((N.subtreeFlags&2064)!==0&&j!==null)j.return=N,it=j;else e:for(;it!==null;){if(N=it,(N.flags&2048)!==0)switch(N.tag){case 0:case 11:case 15:Zi(9,N,N.return)}var pe=N.sibling;if(pe!==null){pe.return=N.return,it=pe;break e}it=N.return}}var oe=o.current;for(it=oe;it!==null;){j=it;var me=j.child;if((j.subtreeFlags&2064)!==0&&me!==null)me.return=j,it=me;else e:for(j=oe;it!==null;){if(W=it,(W.flags&2048)!==0)try{switch(W.tag){case 0:case 11:case 15:zu(9,W)}}catch(gt){nn(W,W.return,gt)}if(W===j){it=null;break e}var Me=W.sibling;if(Me!==null){Me.return=W.return,it=Me;break e}it=W.return}}if(_r=_,ba(),Un&&typeof Un.onPostCommitFiberRoot=="function")try{Un.onPostCommitFiberRoot(fi,o)}catch{}v=!0}return v}finally{ur=h,No.transition=a}}return!1}function Tf(o,a,h){a=wl(h,a),a=ju(o,a,1),o=Eo(o,a,1),a=ys(),o!==null&&(el(o,1,a),Os(o,a))}function nn(o,a,h){if(o.tag===3)Tf(o,o,h);else for(;a!==null;){if(a.tag===3){Tf(a,o,h);break}else if(a.tag===1){var v=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof v.componentDidCatch=="function"&&(Ra===null||!Ra.has(v))){o=wl(h,o),o=hf(a,o,1),a=Eo(a,o,1),o=ys(),a!==null&&(el(a,1,o),Os(a,o));break}}a=a.return}}function W0(o,a,h){var v=o.pingCache;v!==null&&v.delete(a),a=ys(),o.pingedLanes|=o.suspendedLanes&h,Pn===o&&(Vn&h)===h&&(En===4||En===3&&(Vn&130023424)===Vn&&500>qt()-kp?Sl(o,0):_f|=h),Os(o,a)}function pv(o,a){a===0&&((o.mode&1)===0?a=1:(a=Mo,Mo<<=1,(Mo&130023424)===0&&(Mo=4194304)));var h=ys();o=qi(o,a),o!==null&&(el(o,a,h),Os(o,h))}function V0(o){var a=o.memoizedState,h=0;a!==null&&(h=a.retryLane),pv(o,h)}function q0(o,a){var h=0;switch(o.tag){case 13:var v=o.stateNode,_=o.memoizedState;_!==null&&(h=_.retryLane);break;case 19:v=o.stateNode;break;default:throw Error(t(314))}v!==null&&v.delete(a),pv(o,h)}var mv;mv=function(o,a,h){if(o!==null)if(o.memoizedProps!==a.pendingProps||As.current)ms=!0;else{if((o.lanes&h)===0&&(a.flags&128)===0)return ms=!1,tv(o,a,h);ms=(o.flags&131072)!==0}else ms=!1,Jr&&(a.flags&1048576)!==0&&$g(a,qd,a.index);switch(a.lanes=0,a.tag){case 2:var v=a.type;gf(o,a),o=a.pendingProps;var _=pc(a,es.current);Sa(a,h),_=yl(null,a,v,o,_,h);var N=rf();return a.flags|=1,typeof _=="object"&&_!==null&&typeof _.render=="function"&&_.$$typeof===void 0?(a.tag=1,a.memoizedState=null,a.updateQueue=null,Is(v)?(N=!0,xo(a)):N=!1,a.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,Qd(a),_.updater=df,a.stateNode=_,_._reactInternals=a,dp(a,v,o,h),a=yp(null,a,v,!0,N,h)):(a.tag=0,Jr&&N&&_u(a),Bn(null,a,_,h),a=a.child),a;case 16:v=a.elementType;e:{switch(gf(o,a),o=a.pendingProps,_=v._init,v=_(v._payload),a.type=v,_=a.tag=Y0(v),o=ko(v,o),_){case 0:a=gp(null,a,v,o,h);break e;case 1:a=vp(null,a,v,o,h);break e;case 11:a=Zg(null,a,v,o,h);break e;case 14:a=hp(null,a,v,ko(v.type,o),h);break e}throw Error(t(306,v,""))}return a;case 0:return v=a.type,_=a.pendingProps,_=a.elementType===v?_:ko(v,_),gp(o,a,v,_,h);case 1:return v=a.type,_=a.pendingProps,_=a.elementType===v?_:ko(v,_),vp(o,a,v,_,h);case 3:e:{if(ev(a),o===null)throw Error(t(387));v=a.pendingProps,N=a.memoizedState,_=N.element,Bg(o,a),vc(a,v,null,h);var j=a.memoizedState;if(v=j.element,N.isDehydrated)if(N={element:v,isDehydrated:!1,cache:j.cache,pendingSuspenseBoundaries:j.pendingSuspenseBoundaries,transitions:j.transitions},a.updateQueue.baseState=N,a.memoizedState=N,a.flags&256){_=wl(Error(t(423)),a),a=Ti(o,a,v,h,_);break e}else if(v!==_){_=wl(Error(t(424)),a),a=Ti(o,a,v,h,_);break e}else for(Xs=ya(a.stateNode.containerInfo.firstChild),rs=a,Jr=!0,Go=null,h=Yd(a,null,v,h),a.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling;else{if(_i(),v===_){a=Vo(o,a,h);break e}Bn(o,a,v,h)}a=a.child}return a;case 5:return Qh(a),o===null&&Ps(a),v=a.type,_=a.pendingProps,N=o!==null?o.memoizedProps:null,j=_.children,wu(v,_)?j=null:N!==null&&wu(v,N)&&(a.flags|=32),mp(o,a),Bn(o,a,j,h),a.child;case 6:return o===null&&Ps(a),null;case 13:return mf(o,a,h);case 4:return Xh(a,a.stateNode.containerInfo),v=a.pendingProps,o===null?a.child=cn(a,null,v,h):Bn(o,a,v,h),a.child;case 11:return v=a.type,_=a.pendingProps,_=a.elementType===v?_:ko(v,_),Zg(o,a,v,_,h);case 7:return Bn(o,a,a.pendingProps,h),a.child;case 8:return Bn(o,a,a.pendingProps.children,h),a.child;case 12:return Bn(o,a,a.pendingProps.children,h),a.child;case 10:e:{if(v=a.type._context,_=a.pendingProps,N=a.memoizedProps,j=_.value,Br(Cu,v._currentValue),v._currentValue=j,N!==null)if(ye(N.value,j)){if(N.children===_.children&&!As.current){a=Vo(o,a,h);break e}}else for(N=a.child,N!==null&&(N.return=a);N!==null;){var W=N.dependencies;if(W!==null){j=N.child;for(var Z=W.firstContext;Z!==null;){if(Z.context===v){if(N.tag===1){Z=Ki(-1,h&-h),Z.tag=2;var we=N.updateQueue;if(we!==null){we=we.shared;var je=we.pending;je===null?Z.next=Z:(Z.next=je.next,je.next=Z),we.pending=Z}}N.lanes|=h,Z=N.alternate,Z!==null&&(Z.lanes|=h),Hn(N.return,h,a),W.lanes|=h;break}Z=Z.next}}else if(N.tag===10)j=N.type===a.type?null:N.child;else if(N.tag===18){if(j=N.return,j===null)throw Error(t(341));j.lanes|=h,W=j.alternate,W!==null&&(W.lanes|=h),Hn(j,h,a),j=N.sibling}else j=N.child;if(j!==null)j.return=N;else for(j=N;j!==null;){if(j===a){j=null;break}if(N=j.sibling,N!==null){N.return=j.return,j=N;break}j=j.return}N=j}Bn(o,a,_.children,h),a=a.child}return a;case 9:return _=a.type,v=a.pendingProps.children,Sa(a,h),_=_o(_),v=v(_),a.flags|=1,Bn(o,a,v,h),a.child;case 14:return v=a.type,_=ko(v,a.pendingProps),_=ko(v.type,_),hp(o,a,v,_,h);case 15:return Ni(o,a,a.type,a.pendingProps,h);case 17:return v=a.type,_=a.pendingProps,_=a.elementType===v?_:ko(v,_),gf(o,a),a.tag=1,Is(v)?(o=!0,xo(a)):o=!1,Sa(a,h),xl(a,v,_),dp(a,v,_,h),yp(null,a,v,!0,o,h);case 19:return ka(o,a,h);case 22:return pp(o,a,h)}throw Error(t(156,a.tag))};function gv(o,a){return te(o,a)}function K0(o,a,h,v){this.tag=o,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=v,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function To(o,a,h,v){return new K0(o,a,h,v)}function Rf(o){return o=o.prototype,!(!o||!o.isReactComponent)}function Y0(o){if(typeof o=="function")return Rf(o)?1:0;if(o!=null){if(o=o.$$typeof,o===ee)return 11;if(o===ne)return 14}return 2}function Xo(o,a){var h=o.alternate;return h===null?(h=To(o.tag,a,o.key,o.mode),h.elementType=o.elementType,h.type=o.type,h.stateNode=o.stateNode,h.alternate=o,o.alternate=h):(h.pendingProps=a,h.type=o.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=o.flags&14680064,h.childLanes=o.childLanes,h.lanes=o.lanes,h.child=o.child,h.memoizedProps=o.memoizedProps,h.memoizedState=o.memoizedState,h.updateQueue=o.updateQueue,a=o.dependencies,h.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},h.sibling=o.sibling,h.index=o.index,h.ref=o.ref,h}function Af(o,a,h,v,_,N){var j=2;if(v=o,typeof o=="function")Rf(o)&&(j=1);else if(typeof o=="string")j=5;else e:switch(o){case U:return Cl(h.children,_,N,a);case V:j=8,_|=8;break;case Q:return o=To(12,h,a,_|2),o.elementType=Q,o.lanes=N,o;case ve:return o=To(13,h,a,_),o.elementType=ve,o.lanes=N,o;case ce:return o=To(19,h,a,_),o.elementType=ce,o.lanes=N,o;case J:return If(h,_,N,a);default:if(typeof o=="object"&&o!==null)switch(o.$$typeof){case fe:j=10;break e;case B:j=9;break e;case ee:j=11;break e;case ne:j=14;break e;case xe:j=16,v=null;break e}throw Error(t(130,o==null?o:typeof o,""))}return a=To(j,h,a,_),a.elementType=o,a.type=v,a.lanes=N,a}function Cl(o,a,h,v){return o=To(7,o,v,a),o.lanes=h,o}function If(o,a,h,v){return o=To(22,o,v,a),o.elementType=J,o.lanes=h,o.stateNode={isHidden:!1},o}function Fp(o,a,h){return o=To(6,o,null,a),o.lanes=h,o}function Op(o,a,h){return a=To(4,o.children!==null?o.children:[],o.key,a),a.lanes=h,a.stateNode={containerInfo:o.containerInfo,pendingChildren:null,implementation:o.implementation},a}function J0(o,a,h,v,_){this.tag=a,this.containerInfo=o,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Za(0),this.expirationTimes=Za(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Za(0),this.identifierPrefix=v,this.onRecoverableError=_,this.mutableSourceEagerHydrationData=null}function Dp(o,a,h,v,_,N,j,W,Z){return o=new J0(o,a,h,W,Z),a===1?(a=1,N===!0&&(a|=8)):a=0,N=To(3,null,null,a),o.current=N,N.stateNode=o,N.memoizedState={element:v,isDehydrated:h,cache:null,transitions:null,pendingSuspenseBoundaries:null},Qd(N),o}function X0(o,a,h){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:G,key:v==null?null:""+v,children:o,containerInfo:a,implementation:h}}function vv(o){if(!o)return wa;o=o._reactInternals;e:{if($n(o)!==o||o.tag!==1)throw Error(t(170));var a=o;do{switch(a.tag){case 3:a=a.stateNode.context;break e;case 1:if(Is(a.type)){a=a.stateNode.__reactInternalMemoizedMergedChildContext;break e}}a=a.return}while(a!==null);throw Error(t(171))}if(o.tag===1){var h=o.type;if(Is(h))return Dg(o,h,a)}return a}function yv(o,a,h,v,_,N,j,W,Z){return o=Dp(h,v,!0,o,_,N,j,W,Z),o.context=vv(null),h=o.current,v=ys(),_=Ia(h),N=Ki(v,_),N.callback=a??null,Eo(h,N,_),o.current.lanes=_,el(o,_,v),Os(o,v),o}function Pf(o,a,h,v){var _=a.current,N=ys(),j=Ia(_);return h=vv(h),a.context===null?a.context=h:a.pendingContext=h,a=Ki(N,j),a.payload={element:o},v=v===void 0?null:v,v!==null&&(a.callback=v),o=Eo(_,a,j),o!==null&&(Jo(o,_,j,N),Zd(o,_,j)),j}function jf(o){if(o=o.current,!o.child)return null;switch(o.child.tag){case 5:return o.child.stateNode;default:return o.child.stateNode}}function xv(o,a){if(o=o.memoizedState,o!==null&&o.dehydrated!==null){var h=o.retryLane;o.retryLane=h!==0&&h<a?h:a}}function Lp(o,a){xv(o,a),(o=o.alternate)&&xv(o,a)}function Q0(){return null}var wv=typeof reportError=="function"?reportError:function(o){console.error(o)};function Ff(o){this._internalRoot=o}qu.prototype.render=Ff.prototype.render=function(o){var a=this._internalRoot;if(a===null)throw Error(t(409));Pf(o,a,null,null)},qu.prototype.unmount=Ff.prototype.unmount=function(){var o=this._internalRoot;if(o!==null){this._internalRoot=null;var a=o.containerInfo;_l(function(){Pf(null,o,null,null)}),a[Js]=null}};function qu(o){this._internalRoot=o}qu.prototype.unstable_scheduleHydration=function(o){if(o){var a=au();o={blockedOn:null,target:o,priority:a};for(var h=0;h<Ve.length&&a!==0&&a<Ve[h].priority;h++);Ve.splice(h,0,o),h===0&&ct(o)}};function Mp(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11)}function Of(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11&&(o.nodeType!==8||o.nodeValue!==" react-mount-point-unstable "))}function bv(){}function Z0(o,a,h,v,_){if(_){if(typeof v=="function"){var N=v;v=function(){var we=jf(j);N.call(we)}}var j=yv(a,v,o,0,null,!1,!1,"",bv);return o._reactRootContainer=j,o[Js]=j.current,ga(o.nodeType===8?o.parentNode:o),_l(),j}for(;_=o.lastChild;)o.removeChild(_);if(typeof v=="function"){var W=v;v=function(){var we=jf(Z);W.call(we)}}var Z=Dp(o,0,!1,null,null,!1,!1,"",bv);return o._reactRootContainer=Z,o[Js]=Z.current,ga(o.nodeType===8?o.parentNode:o),_l(function(){Pf(a,Z,h,v)}),Z}function kl(o,a,h,v,_){var N=h._reactRootContainer;if(N){var j=N;if(typeof _=="function"){var W=_;_=function(){var Z=jf(j);W.call(Z)}}Pf(a,j,o,_)}else j=Z0(h,a,o,_,v);return jf(j)}iu=function(o){switch(o.tag){case 3:var a=o.stateNode;if(a.current.memoizedState.isDehydrated){var h=go(a.pendingLanes);h!==0&&(tl(a,h|1),Os(a,qt()),(_r&6)===0&&(bl=qt()+500,ba()))}break;case 13:_l(function(){var v=qi(o,1);if(v!==null){var _=ys();Jo(v,o,1,_)}}),Lp(o,1)}},rl=function(o){if(o.tag===13){var a=qi(o,134217728);if(a!==null){var h=ys();Jo(a,o,134217728,h)}Lp(o,134217728)}},wd=function(o){if(o.tag===13){var a=Ia(o),h=qi(o,a);if(h!==null){var v=ys();Jo(h,o,a,v)}Lp(o,a)}},au=function(){return ur},lu=function(o,a){var h=ur;try{return ur=o,a()}finally{ur=h}},tr=function(o,a,h){switch(a){case"input":if(yt(o,h),a=h.name,h.type==="radio"&&a!=null){for(h=o;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll("input[name="+JSON.stringify(""+a)+'][type="radio"]'),a=0;a<h.length;a++){var v=h[a];if(v!==o&&v.form===o.form){var _=Bd(v);if(!_)throw Error(t(90));ze(v),yt(v,_)}}}break;case"textarea":dn(o,h);break;case"select":a=h.value,a!=null&&Xt(o,!!h.multiple,a,!1)}},Er=Ip,vn=_l;var ex={usingClientEntryPoint:!1,Events:[Zn,Qt,Bd,qs,ho,Ip]},Ku={findFiberByHostInstance:yi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},tx={bundleType:Ku.bundleType,version:Ku.version,rendererPackageName:Ku.rendererPackageName,rendererConfig:Ku.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:P.ReactCurrentDispatcher,findHostInstanceByFiber:function(o){return o=Qa(o),o===null?null:o.stateNode},findFiberByHostInstance:Ku.findFiberByHostInstance||Q0,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Df=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Df.isDisabled&&Df.supportsFiber)try{fi=Df.inject(tx),Un=Df}catch{}}return Po.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ex,Po.createPortal=function(o,a){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Mp(a))throw Error(t(200));return X0(o,a,null,h)},Po.createRoot=function(o,a){if(!Mp(o))throw Error(t(299));var h=!1,v="",_=wv;return a!=null&&(a.unstable_strictMode===!0&&(h=!0),a.identifierPrefix!==void 0&&(v=a.identifierPrefix),a.onRecoverableError!==void 0&&(_=a.onRecoverableError)),a=Dp(o,1,!1,null,null,h,!1,v,_),o[Js]=a.current,ga(o.nodeType===8?o.parentNode:o),new Ff(a)},Po.findDOMNode=function(o){if(o==null)return null;if(o.nodeType===1)return o;var a=o._reactInternals;if(a===void 0)throw typeof o.render=="function"?Error(t(188)):(o=Object.keys(o).join(","),Error(t(268,o)));return o=Qa(a),o=o===null?null:o.stateNode,o},Po.flushSync=function(o){return _l(o)},Po.hydrate=function(o,a,h){if(!Of(a))throw Error(t(200));return kl(null,o,a,!0,h)},Po.hydrateRoot=function(o,a,h){if(!Mp(o))throw Error(t(405));var v=h!=null&&h.hydratedSources||null,_=!1,N="",j=wv;if(h!=null&&(h.unstable_strictMode===!0&&(_=!0),h.identifierPrefix!==void 0&&(N=h.identifierPrefix),h.onRecoverableError!==void 0&&(j=h.onRecoverableError)),a=yv(a,null,o,1,h??null,_,!1,N,j),o[Js]=a.current,ga(o),v)for(o=0;o<v.length;o++)h=v[o],_=h._getVersion,_=_(h._source),a.mutableSourceEagerHydrationData==null?a.mutableSourceEagerHydrationData=[h,_]:a.mutableSourceEagerHydrationData.push(h,_);return new qu(a)},Po.render=function(o,a,h){if(!Of(a))throw Error(t(200));return kl(null,o,a,!1,h)},Po.unmountComponentAtNode=function(o){if(!Of(o))throw Error(t(40));return o._reactRootContainer?(_l(function(){kl(null,null,o,!1,function(){o._reactRootContainer=null,o[Js]=null})}),!0):!1},Po.unstable_batchedUpdates=Ip,Po.unstable_renderSubtreeIntoContainer=function(o,a,h,v){if(!Of(h))throw Error(t(200));if(o==null||o._reactInternals===void 0)throw Error(t(38));return kl(o,a,h,!1,v)},Po.version="18.3.1-next-f1338f8080-20240426",Po}var wE;function CN(){if(wE)return gx.exports;wE=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),gx.exports=J2(),gx.exports}var bE;function X2(){if(bE)return kv;bE=1;var r=CN();return kv.createRoot=r.createRoot,kv.hydrateRoot=r.hydrateRoot,kv}var Q2=X2();const Z2=Ib(Q2);class eO{constructor(e){H(this,"logger");H(this,"changeListeners",new Set);var t;this.logger=e,(t=chrome==null?void 0:chrome.storage)!=null&&t.onChanged&&chrome.storage.onChanged.addListener(this.handleStorageChange.bind(this))}async getLocalItem(e){try{const t=await new Promise((n,s)=>{chrome.storage.local.get(e,i=>{chrome.runtime.lastError?s(new Error(chrome.runtime.lastError.message)):n(i)})});try{if(t[e]!==void 0){const n=JSON.parse(t[e]);return this.logger.debug(`Retrieved local item with key: ${e}`,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"getLocalItem"}),n}return null}catch{return this.logger.debug(`Local item with key: ${e} is not JSON, returning as is`,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"getLocalItem"}),t[e]}}catch(t){return this.logger.error(`Error retrieving local item with key: ${e}`,t,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"getLocalItem"}),null}}async setLocalItem(e,t){try{const n={[e]:JSON.stringify(t)};await new Promise((s,i)=>{chrome.storage.local.set(n,()=>{chrome.runtime.lastError?i(new Error(chrome.runtime.lastError.message)):s()})}),this.logger.debug(`Stored local item with key: ${e}`,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"setLocalItem"})}catch(n){throw this.logger.error(`Error storing local item with key: ${e}`,n,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"setLocalItem"}),n}}async removeLocalItem(e){try{await new Promise((t,n)=>{chrome.storage.local.remove(e,()=>{chrome.runtime.lastError?n(new Error(chrome.runtime.lastError.message)):t()})}),this.logger.debug(`Removed local item with key: ${e}`,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"removeLocalItem"})}catch(t){throw this.logger.error(`Error removing local item with key: ${e}`,t,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"removeLocalItem"}),t}}async clearLocal(){try{await new Promise((e,t)=>{chrome.storage.local.clear(()=>{chrome.runtime.lastError?t(new Error(chrome.runtime.lastError.message)):e()})}),this.logger.info("Cleared local storage",{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"clearLocal"})}catch(e){throw this.logger.error("Error clearing local storage",e,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"clearLocal"}),e}}async getAllKeys(){try{const e=await new Promise((n,s)=>{chrome.storage.local.get(null,i=>{chrome.runtime.lastError?s(new Error(chrome.runtime.lastError.message)):n(i)})}),t=Object.keys(e);return this.logger.debug(`Retrieved ${t.length} keys from storage`,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"getAllKeys"}),t}catch(e){return this.logger.error("Error getting all keys",e,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"getAllKeys"}),[]}}onChanged(e){this.changeListeners.add(e)}removeChangeListener(e){this.changeListeners.delete(e)}handleStorageChange(e,t){if((t==="local"||t==="session"||t==="sync")&&this.changeListeners.size>0){const n={};for(const[s,i]of Object.entries(e))try{n[s]={oldValue:i.oldValue?JSON.parse(i.oldValue):void 0,newValue:i.newValue?JSON.parse(i.newValue):void 0}}catch(c){this.logger.debug("Storage change value not JSON",{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"handleStorageChange",key:s,areaName:t,error:c}),n[s]={oldValue:i.oldValue,newValue:i.newValue}}this.changeListeners.forEach(s=>{try{s(n)}catch(i){this.logger.error("Error in storage change callback",i,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"handleStorageChange"})}})}}}class tO{constructor(e){H(this,"logger");H(this,"threadListeners",new Set);H(this,"currentThread",null);this.logger=e,this.initializeStorageListeners()}initializeStorageListeners(){var e,t,n;(t=(e=chrome==null?void 0:chrome.storage)==null?void 0:e.local)!=null&&t.onChanged&&chrome.storage.local.onChanged.addListener(s=>{Object.keys(s).some(c=>c.includes("threadId_window_")&&c.includes("_tab_")||c.includes("threadData_window_")&&c.includes("_tab_"))&&(this.logger.debug("Tab-specific thread data changed, triggering update",{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"initializeStorageListeners",changedKeys:Object.keys(s)}),this.handleThreadDataChange())}),(n=chrome==null?void 0:chrome.tabs)!=null&&n.onActivated&&chrome.tabs.onActivated.addListener(s=>{this.logger.debug("Tab activated, updating thread data",{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"initializeStorageListeners",tabId:s.tabId,windowId:s.windowId}),setTimeout(()=>{this.handleThreadDataChange()},100)})}async getCurrentTabInfo(){try{const[e]=await chrome.tabs.query({active:!0,currentWindow:!0});return!(e!=null&&e.id)||!(e!=null&&e.windowId)?(this.logger.warn("No active tab found",{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentTabInfo"}),null):{tabId:e.id,windowId:e.windowId}}catch(e){return this.logger.error("Error getting current tab info",e,{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentTabInfo"}),null}}async handleThreadDataChange(){var e;try{const t=await this.getCurrentTabInfo(),n=await this.getCurrentThread(),s=(n==null?void 0:n.threadId)||null,i=((e=this.currentThread)==null?void 0:e.threadId)||null;s!==i&&(this.logger.info("Notifying thread listeners for tab",{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"handleThreadDataChange",tabId:t==null?void 0:t.tabId,windowId:t==null?void 0:t.windowId,newThreadId:s,currentThreadId:i}),this.currentThread=n,this.notifyThreadListeners(n))}catch(t){this.logger.error("Error handling thread data change",t,{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"handleThreadDataChange"})}}async getCurrentThread(){const e=await this.getCurrentTabInfo();if(!e)return this.logger.warn("No tab info available for getting current thread",{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentThread"}),null;const{tabId:t,windowId:n}=e,s=`threadId_window_${n}_tab_${t}`,i=`threadData_window_${n}_tab_${t}`;return new Promise(c=>{chrome.storage.local.get([s,i],d=>{if(chrome.runtime.lastError){this.logger.error("Error getting thread data",chrome.runtime.lastError,{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentThread",tabId:t,windowId:n}),c(null);return}const p=d[s],m=d[i];if(!p||!m){this.logger.debug(`No thread data found for tab ${t} in window ${n}`,{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentThread",tabId:t,windowId:n,hasThreadId:!!p,hasThreadData:!!m}),c(null);return}try{const g=this.transformToEmailThread(p,m);this.logger.debug(`Retrieved thread data for tab ${t} in window ${n}`,{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentThread",tabId:t,windowId:n,threadId:p}),c(g)}catch(g){this.logger.error("Error transforming thread data",g,{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentThread",tabId:t,windowId:n}),c(null)}})})}async getCurrentThreadId(){const e=await this.getCurrentTabInfo();if(!e)return this.logger.warn("No tab info available for getting current thread ID",{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentThreadId"}),null;const{tabId:t,windowId:n}=e,s=`threadId_window_${n}_tab_${t}`;return new Promise(i=>{chrome.storage.local.get([s],c=>{if(chrome.runtime.lastError){this.logger.error("Error getting thread ID",chrome.runtime.lastError,{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentThreadId",tabId:t,windowId:n}),i(null);return}const d=c[s]||null;this.logger.debug(`Retrieved thread ID for tab ${t} in window ${n}`,{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentThreadId",tabId:t,windowId:n,threadId:d}),i(d)})})}getCurrentUserEmail(){return this.logger.debug("getCurrentUserEmail called for Chrome - not needed, backend handles filtering",{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentUserEmail"}),null}onThreadChanged(e){this.threadListeners.add(e)}removeThreadListener(e){this.threadListeners.delete(e)}notifyThreadListeners(e){this.threadListeners.forEach(t=>{try{t(e)}catch(n){this.logger.error("Error in thread change callback",n,{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"notifyThreadListeners"})}})}transformToEmailThread(e,t){var n;if(!t||!Array.isArray(t))return this.logger.warn("Invalid thread data format",{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"transformToEmailThread",threadId:e,threadData:t}),null;try{const s=t.map(c=>({from:c.from||"Unknown",timestamp:c.timestamp||new Date().toISOString(),subject:c.subject||"No Subject",body:c.body||"",html:c.html||c.body||""})),i=new Set;return t.forEach(c=>{c.from&&typeof c.from=="string"&&i.add(c.from),c.to&&Array.isArray(c.to)&&c.to.forEach(d=>{typeof d=="string"&&i.add(d)}),c.cc&&Array.isArray(c.cc)&&c.cc.forEach(d=>{typeof d=="string"&&i.add(d)}),c.bcc&&Array.isArray(c.bcc)&&c.bcc.forEach(d=>{typeof d=="string"&&i.add(d)})}),{threadId:e,messages:s,subject:((n=s[0])==null?void 0:n.subject)||"No Subject",participants:Array.from(i)}}catch(s){return this.logger.error("Error transforming email messages",s,{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"transformToEmailThread",threadId:e,threadData:t}),null}}}const rO="CandleLogsDB",nO=1,xx="logs";let zp=null;function sO(){return zp||(zp=new Promise((r,e)=>{console.log("[Logger] Initializing IndexedDB...");const t=indexedDB.open(rO,nO);t.onupgradeneeded=n=>{console.log("[Logger] IndexedDB upgrade needed.");const s=n.target.result;if(!s.objectStoreNames.contains(xx)){console.log(`[Logger] Creating object store: ${xx}`);const i=s.createObjectStore(xx,{keyPath:"id",autoIncrement:!0});console.log("[Logger] Creating indexes: timestamp, level, chromeContext"),i.createIndex("timestamp","timestamp",{unique:!1}),i.createIndex("level","level",{unique:!1}),i.createIndex("chromeContext","chromeContext",{unique:!1})}},t.onsuccess=n=>{console.log("[Logger] IndexedDB initialized successfully."),r(n.target.result)},t.onerror=n=>{console.error("[Logger] IndexedDB initialization failed:",n.target.error),zp=null,e(n.target.error)},t.onblocked=()=>{console.warn("[Logger] IndexedDB initialization blocked. Close other tabs using the database.")}}),zp)}sO().catch(r=>console.error("[Logger] Initial DB connection failed:",r));const oO=r=>r!==null&&typeof r=="object"&&!Array.isArray(r),iO=r=>oO(r)?["id_token","access_token","refresh_token","expires_in","token_type"].every(t=>{switch(t){case"expires_in":return typeof r[t]=="number";default:return typeof r[t]=="string"}}):!1,kN=r=>({setHttpHandler(e){r.httpHandler=e},httpHandler(){return r.httpHandler},updateHttpClientConfig(e,t){var n;(n=r.httpHandler)==null||n.updateHttpClientConfig(e,t)},httpHandlerConfigs(){return r.httpHandler.httpHandlerConfigs()}}),NN=r=>({httpHandler:r.httpHandler()});var Rm;(function(r){r.HTTP="http",r.HTTPS="https"})(Rm||(Rm={}));var uy;(function(r){r.MD5="md5",r.CRC32="crc32",r.CRC32C="crc32c",r.SHA1="sha1",r.SHA256="sha256"})(uy||(uy={}));const Nw="__smithy_context";class li{constructor(e){H(this,"method");H(this,"protocol");H(this,"hostname");H(this,"port");H(this,"path");H(this,"query");H(this,"headers");H(this,"username");H(this,"password");H(this,"fragment");H(this,"body");this.method=e.method||"GET",this.hostname=e.hostname||"localhost",this.port=e.port,this.query=e.query||{},this.headers=e.headers||{},this.body=e.body,this.protocol=e.protocol?e.protocol.slice(-1)!==":"?`${e.protocol}:`:e.protocol:"https:",this.path=e.path?e.path.charAt(0)!=="/"?`/${e.path}`:e.path:"/",this.username=e.username,this.password=e.password,this.fragment=e.fragment}static clone(e){const t=new li({...e,headers:{...e.headers}});return t.query&&(t.query=aO(t.query)),t}static isInstance(e){if(!e)return!1;const t=e;return"method"in t&&"protocol"in t&&"hostname"in t&&"path"in t&&typeof t.query=="object"&&typeof t.headers=="object"}clone(){return li.clone(this)}}function aO(r){return Object.keys(r).reduce((e,t)=>{const n=r[t];return{...e,[t]:Array.isArray(n)?[...n]:n}},{})}class uh{constructor(e){H(this,"statusCode");H(this,"reason");H(this,"headers");H(this,"body");this.statusCode=e.statusCode,this.reason=e.reason,this.headers=e.headers||{},this.body=e.body}static isInstance(e){if(!e)return!1;const t=e;return typeof t.statusCode=="number"&&typeof t.headers=="object"}}const lO=r=>e=>async t=>{if(!li.isInstance(t.request))return e(t);const{request:n}=t,{handlerProtocol:s=""}=r.requestHandler.metadata||{};if(s.indexOf("h2")>=0&&!n.headers[":authority"])delete n.headers.host,n.headers[":authority"]=n.hostname+(n.port?":"+n.port:"");else if(!n.headers.host){let i=n.hostname;n.port!=null&&(i+=`:${n.port}`),n.headers.host=i}return e(t)},cO={name:"hostHeaderMiddleware",step:"build",priority:"low",tags:["HOST"],override:!0},TN=r=>({applyToStack:e=>{e.add(lO(r),cO)}}),uO=()=>(r,e)=>async t=>{var n,s;try{const i=await r(t),{clientName:c,commandName:d,logger:p,dynamoDbDocumentClientOptions:m={}}=e,{overrideInputFilterSensitiveLog:g,overrideOutputFilterSensitiveLog:x}=m,b=g??e.inputFilterSensitiveLog,S=x??e.outputFilterSensitiveLog,{$metadata:T,...E}=i.output;return(n=p==null?void 0:p.info)==null||n.call(p,{clientName:c,commandName:d,input:b(t.input),output:S(E),metadata:T}),i}catch(i){const{clientName:c,commandName:d,logger:p,dynamoDbDocumentClientOptions:m={}}=e,{overrideInputFilterSensitiveLog:g}=m,x=g??e.inputFilterSensitiveLog;throw(s=p==null?void 0:p.error)==null||s.call(p,{clientName:c,commandName:d,input:x(t.input),error:i,metadata:i.$metadata}),i}},dO={name:"loggerMiddleware",tags:["LOGGER"],step:"initialize",override:!0},RN=r=>({applyToStack:e=>{e.add(uO(),dO)}}),fO={step:"build",tags:["RECURSION_DETECTION"],name:"recursionDetectionMiddleware",override:!0,priority:"low"},hO=()=>r=>async e=>r(e),AN=r=>({applyToStack:e=>{e.add(hO(),fO)}}),pd=r=>r[Nw]||(r[Nw]={}),sa=r=>{if(typeof r=="function")return r;const e=Promise.resolve(r);return()=>e},pO=(r,e)=>{if(!e||e.length===0)return r;const t=[];for(const n of e)for(const s of r)s.schemeId.split("#")[1]===n&&t.push(s);for(const n of r)t.find(({schemeId:s})=>s===n.schemeId)||t.push(n);return t};function mO(r){const e=new Map;for(const t of r)e.set(t.schemeId,t);return e}const gO=(r,e)=>(t,n)=>async s=>{var x;const i=r.httpAuthSchemeProvider(await e.httpAuthSchemeParametersProvider(r,n,s.input)),c=r.authSchemePreference?await r.authSchemePreference():[],d=pO(i,c),p=mO(r.httpAuthSchemes),m=pd(n),g=[];for(const b of d){const S=p.get(b.schemeId);if(!S){g.push(`HttpAuthScheme \`${b.schemeId}\` was not enabled for this service.`);continue}const T=S.identityProvider(await e.identityProviderConfigProvider(r));if(!T){g.push(`HttpAuthScheme \`${b.schemeId}\` did not have an IdentityProvider configured.`);continue}const{identityProperties:E={},signingProperties:C={}}=((x=b.propertiesExtractor)==null?void 0:x.call(b,r,n))||{};b.identityProperties=Object.assign(b.identityProperties||{},E),b.signingProperties=Object.assign(b.signingProperties||{},C),m.selectedHttpAuthScheme={httpAuthOption:b,identity:await T(b.identityProperties),signer:S.signer};break}if(!m.selectedHttpAuthScheme)throw new Error(g.join(`
`));return t(s)},vO={step:"serialize",tags:["HTTP_AUTH_SCHEME"],name:"httpAuthSchemeMiddleware",override:!0,relation:"before",toMiddleware:"endpointV2Middleware"},IN=(r,{httpAuthSchemeParametersProvider:e,identityProviderConfigProvider:t})=>({applyToStack:n=>{n.addRelativeTo(gO(r,{httpAuthSchemeParametersProvider:e,identityProviderConfigProvider:t}),vO)}}),yO={name:"serializerMiddleware"},xO=r=>e=>{throw e},wO=(r,e)=>{},bO=r=>(e,t)=>async n=>{if(!li.isInstance(n.request))return e(n);const i=pd(t).selectedHttpAuthScheme;if(!i)throw new Error("No HttpAuthScheme was selected: unable to sign request");const{httpAuthOption:{signingProperties:c={}},identity:d,signer:p}=i,m=await e({...n,request:await p.sign(n.request,d,c)}).catch((p.errorHandler||xO)(c));return(p.successHandler||wO)(m.response,c),m},_O={step:"finalizeRequest",tags:["HTTP_SIGNING"],name:"httpSigningMiddleware",aliases:["apiKeyMiddleware","tokenMiddleware","awsAuthMiddleware"],override:!0,relation:"after",toMiddleware:"retryMiddleware"},PN=r=>({applyToStack:e=>{e.addRelativeTo(bO(),_O)}}),Sm=r=>{if(typeof r=="function")return r;const e=Promise.resolve(r);return()=>e},jN="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",_E=Object.entries(jN).reduce((r,[e,t])=>(r[t]=Number(e),r),{}),SO=jN.split(""),th=6,Em=8,EO=63,Zm=r=>{let e=r.length/4*3;r.slice(-2)==="=="?e-=2:r.slice(-1)==="="&&e--;const t=new ArrayBuffer(e),n=new DataView(t);for(let s=0;s<r.length;s+=4){let i=0,c=0;for(let m=s,g=s+3;m<=g;m++)if(r[m]!=="="){if(!(r[m]in _E))throw new TypeError(`Invalid character ${r[m]} in base64 string.`);i|=_E[r[m]]<<(g-m)*th,c+=th}else i>>=th;const d=s/4*3;i>>=c%Em;const p=Math.floor(c/Em);for(let m=0;m<p;m++){const g=(p-m-1)*Em;n.setUint8(d+m,(i&255<<g)>>g)}}return new Uint8Array(t)},cd=r=>new TextEncoder().encode(r),Am=r=>typeof r=="string"?cd(r):ArrayBuffer.isView(r)?new Uint8Array(r.buffer,r.byteOffset,r.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(r),Wy=r=>{if(typeof r=="string")return r;if(typeof r!="object"||typeof r.byteOffset!="number"||typeof r.byteLength!="number")throw new Error("@smithy/util-utf8: toUtf8 encoder function only accepts string | Uint8Array.");return new TextDecoder("utf-8").decode(r)};function Im(r){let e;typeof r=="string"?e=cd(r):e=r;const t=typeof e=="object"&&typeof e.length=="number",n=typeof e=="object"&&typeof e.byteOffset=="number"&&typeof e.byteLength=="number";if(!t&&!n)throw new Error("@smithy/util-base64: toBase64 encoder function only accepts string | Uint8Array.");let s="";for(let i=0;i<e.length;i+=3){let c=0,d=0;for(let m=i,g=Math.min(i+3,e.length);m<g;m++)c|=e[m]<<(g-m-1)*Em,d+=Em;const p=Math.ceil(d/th);c<<=p*th-d;for(let m=1;m<=p;m++){const g=(p-m)*th;s+=SO[(c&EO<<g)>>g]}s+="==".slice(0,4-p)}return s}class od extends Uint8Array{static fromString(e,t="utf-8"){if(typeof e=="string")return t==="base64"?od.mutate(Zm(e)):od.mutate(cd(e));throw new Error(`Unsupported conversion from ${typeof e} to Uint8ArrayBlobAdapter.`)}static mutate(e){return Object.setPrototypeOf(e,od.prototype),e}transformToString(e="utf-8"){return e==="base64"?Im(this):Wy(this)}}const id=r=>encodeURIComponent(r).replace(/[!'()*]/g,CO),CO=r=>`%${r.charCodeAt(0).toString(16).toUpperCase()}`;function kO(r){const e=[];for(let t of Object.keys(r).sort()){const n=r[t];if(t=id(t),Array.isArray(n))for(let s=0,i=n.length;s<i;s++)e.push(`${t}=${id(n[s])}`);else{let s=t;(n||typeof n=="string")&&(s+=`=${id(n)}`),e.push(s)}}return e.join("&")}function SE(r,e){return new Request(r,e)}function NO(r=0){return new Promise((e,t)=>{r&&setTimeout(()=>{const n=new Error(`Request did not complete within ${r} ms`);n.name="TimeoutError",t(n)},r)})}const wx={supported:void 0};class Vy{constructor(e){H(this,"config");H(this,"configProvider");typeof e=="function"?this.configProvider=e().then(t=>t||{}):(this.config=e??{},this.configProvider=Promise.resolve(this.config)),wx.supported===void 0&&(wx.supported=typeof Request<"u"&&"keepalive"in SE("https://[::1]"))}static create(e){return typeof(e==null?void 0:e.handle)=="function"?e:new Vy(e)}destroy(){}async handle(e,{abortSignal:t,requestTimeout:n}={}){var A;this.config||(this.config=await this.configProvider);const s=n??this.config.requestTimeout,i=this.config.keepAlive===!0,c=this.config.credentials;if(t!=null&&t.aborted){const F=new Error("Request aborted");return F.name="AbortError",Promise.reject(F)}let d=e.path;const p=kO(e.query||{});p&&(d+=`?${p}`),e.fragment&&(d+=`#${e.fragment}`);let m="";if(e.username!=null||e.password!=null){const F=e.username??"",P=e.password??"";m=`${F}:${P}@`}const{port:g,method:x}=e,b=`${e.protocol}//${m}${e.hostname}${g?`:${g}`:""}${d}`,S=x==="GET"||x==="HEAD"?void 0:e.body,T={body:S,headers:new Headers(e.headers),method:x,credentials:c};(A=this.config)!=null&&A.cache&&(T.cache=this.config.cache),S&&(T.duplex="half"),typeof AbortController<"u"&&(T.signal=t),wx.supported&&(T.keepalive=i),typeof this.config.requestInit=="function"&&Object.assign(T,this.config.requestInit(e));let E=()=>{};const C=SE(b,T),R=[fetch(C).then(F=>{const P=F.headers,L={};for(const U of P.entries())L[U[0]]=U[1];return F.body!=null?{response:new uh({headers:L,reason:F.statusText,statusCode:F.status,body:F.body})}:F.blob().then(U=>({response:new uh({headers:L,reason:F.statusText,statusCode:F.status,body:U})}))}),NO(s)];return t&&R.push(new Promise((F,P)=>{const L=()=>{const G=new Error("Request aborted");G.name="AbortError",P(G)};if(typeof t.addEventListener=="function"){const G=t;G.addEventListener("abort",L,{once:!0}),E=()=>G.removeEventListener("abort",L)}else t.onabort=L})),Promise.race(R).finally(E)}updateHttpClientConfig(e,t){this.config=void 0,this.configProvider=this.configProvider.then(n=>(n[e]=t,n))}httpHandlerConfigs(){return this.config??{}}}const FN=async r=>{var e;return typeof Blob=="function"&&r instanceof Blob||((e=r.constructor)==null?void 0:e.name)==="Blob"?Blob.prototype.arrayBuffer!==void 0?new Uint8Array(await r.arrayBuffer()):TO(r):RO(r)};async function TO(r){const e=await AO(r),t=Zm(e);return new Uint8Array(t)}async function RO(r){const e=[],t=r.getReader();let n=!1,s=0;for(;!n;){const{done:d,value:p}=await t.read();p&&(e.push(p),s+=p.length),n=d}const i=new Uint8Array(s);let c=0;for(const d of e)i.set(d,c),c+=d.length;return i}function AO(r){return new Promise((e,t)=>{const n=new FileReader;n.onloadend=()=>{if(n.readyState!==2)return t(new Error("Reader aborted too early"));const s=n.result??"",i=s.indexOf(","),c=i>-1?i+1:s.length;e(s.substring(c))},n.onabort=()=>t(new Error("Read aborted")),n.onerror=()=>t(n.error),n.readAsDataURL(r)})}const ON={},Tw={};for(let r=0;r<256;r++){let e=r.toString(16).toLowerCase();e.length===1&&(e=`0${e}`),ON[r]=e,Tw[e]=r}function IO(r){if(r.length%2!==0)throw new Error("Hex encoded strings must have an even number length");const e=new Uint8Array(r.length/2);for(let t=0;t<r.length;t+=2){const n=r.slice(t,t+2).toLowerCase();if(n in Tw)e[t/2]=Tw[n];else throw new Error(`Cannot decode unrecognized sequence ${n} as hexadecimal`)}return e}function ad(r){let e="";for(let t=0;t<r.byteLength;t++)e+=ON[r[t]];return e}const Rw=async(r=new Uint8Array,e)=>{if(r instanceof Uint8Array)return od.mutate(r);if(!r)return od.mutate(new Uint8Array);const t=e.streamCollector(r);return od.mutate(await t)},Yv=r=>typeof r=="function"?r():r,DN=(r,e,t,n,s)=>({name:e,namespace:r,traits:t,input:n,output:s}),PO=r=>(e,t)=>async n=>{var x,b,S,T;const{response:s}=await e(n),{operationSchema:i}=pd(t),[,c,d,p,m,g]=i??[];try{const E=await r.protocol.deserializeResponse(DN(c,d,p,m,g),{...r,...t},s);return{response:s,output:E}}catch(E){if(Object.defineProperty(E,"$response",{value:s,enumerable:!1,writable:!1,configurable:!1}),!("$metadata"in E)){const C="Deserialization error: to see the raw response, inspect the hidden field {error}.$response on this object.";try{E.message+=`
  `+C}catch{!t.logger||((b=(x=t.logger)==null?void 0:x.constructor)==null?void 0:b.name)==="NoOpLogger"?console.warn(C):(T=(S=t.logger)==null?void 0:S.warn)==null||T.call(S,C)}typeof E.$responseBodyText<"u"&&E.$response&&(E.$response.body=E.$responseBodyText);try{if(uh.isInstance(s)){const{headers:R={}}=s,A=Object.entries(R);E.$metadata={httpStatusCode:s.statusCode,requestId:bx(/^x-[\w-]+-request-?id$/,A),extendedRequestId:bx(/^x-[\w-]+-id-2$/,A),cfId:bx(/^x-[\w-]+-cf-id$/,A)}}}catch{}}throw E}},bx=(r,e)=>(e.find(([t])=>t.match(r))||[void 0,void 0])[1],jO=r=>(e,t)=>async n=>{var b;const{operationSchema:s}=pd(t),[,i,c,d,p,m]=s??[],g=(b=t.endpointV2)!=null&&b.url&&r.urlParser?async()=>r.urlParser(t.endpointV2.url):r.endpoint,x=await r.protocol.serializeRequest(DN(i,c,d,p,m),n.input,{...r,...t,endpoint:g});return e({...n,request:x})},FO={name:"deserializerMiddleware",step:"deserialize",tags:["DESERIALIZER"],override:!0},OO={name:"serializerMiddleware",step:"serialize",tags:["SERIALIZER"],override:!0};function LN(r){return{applyToStack:e=>{e.add(jO(r),OO),e.add(PO(r),FO),r.protocol.setSerdeContext(r)}}}function um(r){if(typeof r=="object")return r;r=r|0;const e={};let t=0;for(const n of["httpLabel","idempotent","idempotencyToken","sensitive","httpPayload","httpResponseCode","httpQueryParams"])(r>>t++&1)===1&&(e[n]=1);return e}const EE={it:Symbol.for("@smithy/nor-struct-it")},Uc=class Uc{constructor(e,t){H(this,"ref");H(this,"memberName");H(this,"symbol",Uc.symbol);H(this,"name");H(this,"schema");H(this,"_isMemberSchema");H(this,"traits");H(this,"memberTraits");H(this,"normalizedTraits");this.ref=e,this.memberName=t;const n=[];let s=e,i=e;for(this._isMemberSchema=!1;_x(s);)n.push(s[1]),s=s[0],i=Yv(s),this._isMemberSchema=!0;if(n.length>0){this.memberTraits={};for(let c=n.length-1;c>=0;--c){const d=n[c];Object.assign(this.memberTraits,um(d))}}else this.memberTraits=0;if(i instanceof Uc){const c=this.memberTraits;Object.assign(this,i),this.memberTraits=Object.assign({},c,i.getMemberTraits(),this.getMemberTraits()),this.normalizedTraits=void 0,this.memberName=t??i.memberName;return}if(this.schema=Yv(i),DO(this.schema)?(this.name=`${this.schema[1]}#${this.schema[2]}`,this.traits=this.schema[3]):(this.name=this.memberName??String(i),this.traits=0),this._isMemberSchema&&!t)throw new Error(`@smithy/core/schema - NormalizedSchema member init ${this.getName(!0)} missing member name.`)}static[Symbol.hasInstance](e){const t=this.prototype.isPrototypeOf(e);return!t&&typeof e=="object"&&e!==null?e.symbol===this.symbol:t}static of(e){const t=Yv(e);if(t instanceof Uc)return t;if(_x(t)){const[n,s]=t;if(n instanceof Uc)return Object.assign(n.getMergedTraits(),um(s)),n;throw new Error(`@smithy/core/schema - may not init unwrapped member schema=${JSON.stringify(e,null,2)}.`)}return new Uc(t)}getSchema(){const e=this.schema;return Array.isArray(e)&&e[0]===0?e[4]:e}getName(e=!1){const{name:t}=this;return!e&&t&&t.includes("#")?t.split("#")[1]:t||void 0}getMemberName(){return this.memberName}isMemberSchema(){return this._isMemberSchema}isListSchema(){const e=this.getSchema();return typeof e=="number"?e>=64&&e<128:e[0]===1}isMapSchema(){const e=this.getSchema();return typeof e=="number"?e>=128&&e<=255:e[0]===2}isStructSchema(){const e=this.getSchema();if(typeof e!="object")return!1;const t=e[0];return t===3||t===-3||t===4}isUnionSchema(){const e=this.getSchema();return typeof e!="object"?!1:e[0]===4}isBlobSchema(){const e=this.getSchema();return e===21||e===42}isTimestampSchema(){const e=this.getSchema();return typeof e=="number"&&e>=4&&e<=7}isUnitSchema(){return this.getSchema()==="unit"}isDocumentSchema(){return this.getSchema()===15}isStringSchema(){return this.getSchema()===0}isBooleanSchema(){return this.getSchema()===2}isNumericSchema(){return this.getSchema()===1}isBigIntegerSchema(){return this.getSchema()===17}isBigDecimalSchema(){return this.getSchema()===19}isStreaming(){const{streaming:e}=this.getMergedTraits();return!!e||this.getSchema()===42}isIdempotencyToken(){return!!this.getMergedTraits().idempotencyToken}getMergedTraits(){return this.normalizedTraits??(this.normalizedTraits={...this.getOwnTraits(),...this.getMemberTraits()})}getMemberTraits(){return um(this.memberTraits)}getOwnTraits(){return um(this.traits)}getKeySchema(){const[e,t]=[this.isDocumentSchema(),this.isMapSchema()];if(!e&&!t)throw new Error(`@smithy/core/schema - cannot get key for non-map: ${this.getName(!0)}`);const n=this.getSchema(),s=e?15:n[4]??0;return Hp([s,0],"key")}getValueSchema(){const e=this.getSchema(),[t,n,s]=[this.isDocumentSchema(),this.isMapSchema(),this.isListSchema()],i=typeof e=="number"?63&e:e&&typeof e=="object"&&(n||s)?e[3+e[0]]:t?15:void 0;if(i!=null)return Hp([i,0],n?"value":"member");throw new Error(`@smithy/core/schema - ${this.getName(!0)} has no value member.`)}getMemberSchema(e){const t=this.getSchema();if(this.isStructSchema()&&t[4].includes(e)){const n=t[4].indexOf(e),s=t[5][n];return Hp(_x(s)?s:[s,0],e)}if(this.isDocumentSchema())return Hp([15,0],e);throw new Error(`@smithy/core/schema - ${this.getName(!0)} has no no member=${e}.`)}getMemberSchemas(){const e={};try{for(const[t,n]of this.structIterator())e[t]=n}catch{}return e}getEventStreamMember(){if(this.isStructSchema()){for(const[e,t]of this.structIterator())if(t.isStreaming()&&t.isStructSchema())return e}return""}*structIterator(){if(this.isUnitSchema())return;if(!this.isStructSchema())throw new Error("@smithy/core/schema - cannot iterate non-struct schema.");const e=this.getSchema(),t=e[4].length;let n=e[EE.it];if(n&&t===n.length){yield*n;return}n=Array(t);for(let s=0;s<t;++s){const i=e[4][s],c=Hp([e[5][s],0],i);yield n[s]=[i,c]}e[EE.it]=n}};H(Uc,"symbol",Symbol.for("@smithy/nor"));let Oo=Uc;function Hp(r,e){if(r instanceof Oo)return Object.assign(r,{memberName:e,_isMemberSchema:!0});const t=Oo;return new t(r,e)}const _x=r=>Array.isArray(r)&&r.length===2,DO=r=>Array.isArray(r)&&r.length>=5,$a=class $a{constructor(e,t=new Map,n=new Map){H(this,"namespace");H(this,"schemas");H(this,"exceptions");this.namespace=e,this.schemas=t,this.exceptions=n}static for(e){return $a.registries.has(e)||$a.registries.set(e,new $a(e)),$a.registries.get(e)}register(e,t){const n=this.normalizeShapeId(e);$a.for(n.split("#")[0]).schemas.set(n,t)}getSchema(e){const t=this.normalizeShapeId(e);if(!this.schemas.has(t))throw new Error(`@smithy/core/schema - schema not found for ${t}`);return this.schemas.get(t)}registerError(e,t){const n=e,s=$a.for(n[1]);s.schemas.set(n[1]+"#"+n[2],n),s.exceptions.set(n,t)}getErrorCtor(e){const t=e;return $a.for(t[1]).exceptions.get(t)}getBaseException(){for(const e of this.exceptions.keys())if(Array.isArray(e)){const[,t,n]=e,s=t+"#"+n;if(s.startsWith("smithy.ts.sdk.synthetic.")&&s.endsWith("ServiceException"))return e}}find(e){return[...this.schemas.values()].find(e)}clear(){this.schemas.clear(),this.exceptions.clear()}normalizeShapeId(e){return e.includes("#")?e:this.namespace+"#"+e}};H($a,"registries",new Map);let xt=$a;const Aw=r=>{if(r!=null){if(typeof r=="string"){const e=parseFloat(r);if(!Number.isNaN(e))return String(e)!==String(r)&&WO.warn(GO(`Expected number but observed string: ${r}`)),e}if(typeof r=="number")return r;throw new TypeError(`Expected number, got ${typeof r}: ${r}`)}},LO=Math.ceil(2**127*(2-2**-23)),CE=r=>{const e=Aw(r);if(e!==void 0&&!Number.isNaN(e)&&e!==1/0&&e!==-1/0&&Math.abs(e)>LO)throw new TypeError(`Expected 32-bit float, got ${r}`);return e},MO=r=>{if(r!=null){if(Number.isInteger(r)&&!Number.isNaN(r))return r;throw new TypeError(`Expected integer, got ${typeof r}: ${r}`)}},kE=r=>MN(r,16),NE=r=>MN(r,8),MN=(r,e)=>{const t=MO(r);if(t!==void 0&&$O(t,e)!==t)throw new TypeError(`Expected ${e}-bit integer, got ${r}`);return t},$O=(r,e)=>{switch(e){case 32:return Int32Array.of(r)[0];case 16:return Int16Array.of(r)[0];case 8:return Int8Array.of(r)[0]}},UO=r=>Aw(typeof r=="string"?qy(r):r),zO=r=>CE(typeof r=="string"?qy(r):r),HO=/(-?(?:0|[1-9]\d*)(?:\.\d+)?(?:[eE][+-]?\d+)?)|(-?Infinity)|(NaN)/g,qy=r=>{const e=r.match(HO);if(e===null||e[0].length!==r.length)throw new TypeError("Expected real number, got implicit NaN");return parseFloat(r)},dy=r=>kE(typeof r=="string"?qy(r):r),BO=r=>NE(typeof r=="string"?qy(r):r),GO=r=>String(new TypeError(r).stack||r).split(`
`).slice(0,5).filter(e=>!e.includes("stackTraceWarning")).join(`
`),WO={warn:console.warn},VO=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],Fb=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function qO(r){const e=r.getUTCFullYear(),t=r.getUTCMonth(),n=r.getUTCDay(),s=r.getUTCDate(),i=r.getUTCHours(),c=r.getUTCMinutes(),d=r.getUTCSeconds(),p=s<10?`0${s}`:`${s}`,m=i<10?`0${i}`:`${i}`,g=c<10?`0${c}`:`${c}`,x=d<10?`0${d}`:`${d}`;return`${VO[n]}, ${p} ${Fb[t]} ${e} ${m}:${g}:${x} GMT`}const KO=new RegExp(/^(\d{4})-(\d{2})-(\d{2})[tT](\d{2}):(\d{2}):(\d{2})(?:\.(\d+))?(([-+]\d{2}\:\d{2})|[zZ])$/),YO=r=>{if(r==null)return;if(typeof r!="string")throw new TypeError("RFC-3339 date-times must be expressed as strings");const e=KO.exec(r);if(!e)throw new TypeError("Invalid RFC-3339 date-time value");const[t,n,s,i,c,d,p,m,g]=e,x=dy(Pm(n)),b=Bc(s,"month",1,12),S=Bc(i,"day",1,31),T=Jv(x,b,S,{hours:c,minutes:d,seconds:p,fractionalMilliseconds:m});return g.toUpperCase()!="Z"&&T.setTime(T.getTime()-lD(g)),T},JO=new RegExp(/^(?:Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d{2}) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d{1,2}):(\d{2}):(\d{2})(?:\.(\d+))? GMT$/),XO=new RegExp(/^(?:Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d{2})-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d{2}) (\d{1,2}):(\d{2}):(\d{2})(?:\.(\d+))? GMT$/),QO=new RegExp(/^(?:Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( [1-9]|\d{2}) (\d{1,2}):(\d{2}):(\d{2})(?:\.(\d+))? (\d{4})$/),ZO=r=>{if(r==null)return;if(typeof r!="string")throw new TypeError("RFC-7231 date-times must be expressed as strings");let e=JO.exec(r);if(e){const[t,n,s,i,c,d,p,m]=e;return Jv(dy(Pm(i)),Sx(s),Bc(n,"day",1,31),{hours:c,minutes:d,seconds:p,fractionalMilliseconds:m})}if(e=XO.exec(r),e){const[t,n,s,i,c,d,p,m]=e;return nD(Jv(tD(i),Sx(s),Bc(n,"day",1,31),{hours:c,minutes:d,seconds:p,fractionalMilliseconds:m}))}if(e=QO.exec(r),e){const[t,n,s,i,c,d,p,m]=e;return Jv(dy(Pm(m)),Sx(n),Bc(s.trimLeft(),"day",1,31),{hours:i,minutes:c,seconds:d,fractionalMilliseconds:p})}throw new TypeError("Invalid RFC-7231 date-time value")},eD=r=>{if(r==null)return;let e;if(typeof r=="number")e=r;else if(typeof r=="string")e=UO(r);else if(typeof r=="object"&&r.tag===1)e=r.value;else throw new TypeError("Epoch timestamps must be expressed as floating point numbers or their string representation");if(Number.isNaN(e)||e===1/0||e===-1/0)throw new TypeError("Epoch timestamps must be valid, non-Infinite, non-NaN numerics");return new Date(Math.round(e*1e3))},Jv=(r,e,t,n)=>{const s=e-1;return oD(r,s,t),new Date(Date.UTC(r,s,t,Bc(n.hours,"hour",0,23),Bc(n.minutes,"minute",0,59),Bc(n.seconds,"seconds",0,60),aD(n.fractionalMilliseconds)))},tD=r=>{const e=new Date().getUTCFullYear(),t=Math.floor(e/100)*100+dy(Pm(r));return t<e?t+100:t},rD=50*365*24*60*60*1e3,nD=r=>r.getTime()-new Date().getTime()>rD?new Date(Date.UTC(r.getUTCFullYear()-100,r.getUTCMonth(),r.getUTCDate(),r.getUTCHours(),r.getUTCMinutes(),r.getUTCSeconds(),r.getUTCMilliseconds())):r,Sx=r=>{const e=Fb.indexOf(r);if(e<0)throw new TypeError(`Invalid month: ${r}`);return e+1},sD=[31,28,31,30,31,30,31,31,30,31,30,31],oD=(r,e,t)=>{let n=sD[e];if(e===1&&iD(r)&&(n=29),t>n)throw new TypeError(`Invalid day for ${Fb[e]} in ${r}: ${t}`)},iD=r=>r%4===0&&(r%100!==0||r%400===0),Bc=(r,e,t,n)=>{const s=BO(Pm(r));if(s<t||s>n)throw new TypeError(`${e} must be between ${t} and ${n}, inclusive`);return s},aD=r=>r==null?0:zO("0."+r)*1e3,lD=r=>{const e=r[0];let t=1;if(e=="+")t=1;else if(e=="-")t=-1;else throw new TypeError(`Offset direction, ${e}, must be "+" or "-"`);const n=Number(r.substring(1,3)),s=Number(r.substring(4,6));return t*(n*60+s)*60*1e3},Pm=r=>{let e=0;for(;e<r.length-1&&r.charAt(e)==="0";)e++;return e===0?r:r.slice(e)},TE=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Ds=Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0")),$N=()=>{if(TE)return TE();const r=new Uint8Array(16);return crypto.getRandomValues(r),r[6]=r[6]&15|64,r[8]=r[8]&63|128,Ds[r[0]]+Ds[r[1]]+Ds[r[2]]+Ds[r[3]]+"-"+Ds[r[4]]+Ds[r[5]]+"-"+Ds[r[6]]+Ds[r[7]]+"-"+Ds[r[8]]+Ds[r[9]]+"-"+Ds[r[10]]+Ds[r[11]]+Ds[r[12]]+Ds[r[13]]+Ds[r[14]]+Ds[r[15]]},zc=function(e){return Object.assign(new String(e),{deserializeJSON(){return JSON.parse(String(e))},toString(){return String(e)},toJSON(){return String(e)}})};zc.from=r=>r&&typeof r=="object"&&(r instanceof zc||"deserializeJSON"in r)?r:typeof r=="string"||Object.getPrototypeOf(r)===String.prototype?zc(String(r)):zc(JSON.stringify(r));zc.fromObject=zc.from;const RE=/^-?\d*(\.\d+)?$/;class Ga{constructor(e,t){H(this,"string");H(this,"type");if(this.string=e,this.type=t,!RE.test(e))throw new Error('@smithy/core/serde - NumericValue must only contain [0-9], at most one decimal point ".", and an optional negation prefix "-".')}toString(){return this.string}static[Symbol.hasInstance](e){if(!e||typeof e!="object")return!1;const t=e;return Ga.prototype.isPrototypeOf(e)||t.type==="bigDecimal"&&RE.test(t.string)}}const cD="modulepreload",uD=function(r){return"/FileServer_Staging/dist-outlook-addin/"+r},AE={},Iw=function(e,t,n){let s=Promise.resolve();if(t&&t.length>0){let c=function(m){return Promise.all(m.map(g=>Promise.resolve(g).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),p=(d==null?void 0:d.nonce)||(d==null?void 0:d.getAttribute("nonce"));s=c(t.map(m=>{if(m=uD(m),m in AE)return;AE[m]=!0;const g=m.endsWith(".css"),x=g?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${m}"]${x}`))return;const b=document.createElement("link");if(b.rel=g?"stylesheet":cD,g||(b.as="script"),b.crossOrigin="",b.href=m,p&&b.setAttribute("nonce",p),document.head.appendChild(b),g)return new Promise((S,T)=>{b.addEventListener("load",S),b.addEventListener("error",()=>T(new Error(`Unable to preload CSS for ${m}`)))})}))}function i(c){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=c,window.dispatchEvent(d),!d.defaultPrevented)throw c}return s.then(c=>{for(const d of c||[])d.status==="rejected"&&i(d.reason);return e().catch(i)})};class dD{constructor(){H(this,"serdeContext")}setSerdeContext(e){this.serdeContext=e}}class fD extends dD{constructor(t){super();H(this,"options");this.options=t}getRequestType(){return li}getResponseType(){return uh}setSerdeContext(t){this.serdeContext=t,this.serializer.setSerdeContext(t),this.deserializer.setSerdeContext(t),this.getPayloadCodec()&&this.getPayloadCodec().setSerdeContext(t)}updateServiceEndpoint(t,n){if("url"in n){t.protocol=n.url.protocol,t.hostname=n.url.hostname,t.port=n.url.port?Number(n.url.port):void 0,t.path=n.url.pathname,t.fragment=n.url.hash||void 0,t.username=n.url.username||void 0,t.password=n.url.password||void 0,t.query||(t.query={});for(const[s,i]of n.url.searchParams.entries())t.query[s]=i;return t}else return t.protocol=n.protocol,t.hostname=n.hostname,t.port=n.port?Number(n.port):void 0,t.path=n.path,t.query={...n.query},t}setHostPrefix(t,n,s){var d,p;if((d=this.serdeContext)!=null&&d.disableHostPrefix)return;const i=Oo.of(n.input),c=um(n.traits??{});if(c.endpoint){let m=(p=c.endpoint)==null?void 0:p[0];if(typeof m=="string"){const g=[...i.structIterator()].filter(([,x])=>x.getMergedTraits().hostLabel);for(const[x]of g){const b=s[x];if(typeof b!="string")throw new Error(`@smithy/core/schema - ${x} in input must be a string as hostLabel.`);m=m.replace(`{${x}}`,b)}t.hostname=m+t.hostname}}}deserializeMetadata(t){return{httpStatusCode:t.statusCode,requestId:t.headers["x-amzn-requestid"]??t.headers["x-amzn-request-id"]??t.headers["x-amz-request-id"],extendedRequestId:t.headers["x-amz-id-2"],cfId:t.headers["x-amz-cf-id"]}}async serializeEventStream({eventStream:t,requestSchema:n,initialRequest:s}){return(await this.loadEventStreamCapability()).serializeEventStream({eventStream:t,requestSchema:n,initialRequest:s})}async deserializeEventStream({response:t,responseSchema:n,initialResponseContainer:s}){return(await this.loadEventStreamCapability()).deserializeEventStream({response:t,responseSchema:n,initialResponseContainer:s})}async loadEventStreamCapability(){const{EventStreamSerde:t}=await Iw(async()=>{const{EventStreamSerde:n}=await import("./index.DS5eee3c.js");return{EventStreamSerde:n}},__vite__mapDeps([0,1]));return new t({marshaller:this.getEventStreamMarshaller(),serializer:this.serializer,deserializer:this.deserializer,serdeContext:this.serdeContext,defaultContentType:this.getDefaultContentType()})}getDefaultContentType(){throw new Error(`@smithy/core/protocols - ${this.constructor.name} getDefaultContentType() implementation missing.`)}async deserializeHttpMessage(t,n,s,i,c){return[]}getEventStreamMarshaller(){const t=this.serdeContext;if(!t.eventStreamMarshaller)throw new Error("@smithy/core - HttpProtocol: eventStreamMarshaller missing in serdeContext.");return t.eventStreamMarshaller}}class hD extends fD{async serializeRequest(e,t,n){const s=this.serializer,i={},c={},d=await n.endpoint(),p=Oo.of(e==null?void 0:e.input),m=p.getSchema();let g;const x=new li({protocol:"",hostname:"",port:void 0,path:"/",fragment:void 0,query:i,headers:c,body:void 0});d&&(this.updateServiceEndpoint(x,d),this.setHostPrefix(x,e,t));const b={...t};if(t){const S=p.getEventStreamMember();if(S){if(b[S]){const T={};for(const[E,C]of p.structIterator())E!==S&&b[E]&&(s.write(C,b[E]),T[E]=s.flush());g=await this.serializeEventStream({eventStream:b[S],requestSchema:p,initialRequest:T})}}else s.write(m,b),g=s.flush()}return x.headers=c,x.query=i,x.body=g,x.method="POST",x}async deserializeResponse(e,t,n){const s=this.deserializer,i=Oo.of(e.output),c={};if(n.statusCode>=300){const p=await Rw(n.body,t);throw p.byteLength>0&&Object.assign(c,await s.read(15,p)),await this.handleError(e,t,n,c,this.deserializeMetadata(n)),new Error("@smithy/core/protocols - RPC Protocol error handler failed to throw.")}for(const p in n.headers){const m=n.headers[p];delete n.headers[p],n.headers[p.toLowerCase()]=m}const d=i.getEventStreamMember();if(d)c[d]=await this.deserializeEventStream({response:n,responseSchema:i,initialResponseContainer:c});else{const p=await Rw(n.body,t);p.byteLength>0&&Object.assign(c,await s.read(i,p))}return c.$metadata=this.deserializeMetadata(n),c}}function UN(r,e){if(e.timestampFormat.useTrait&&r.isTimestampSchema()&&(r.getSchema()===5||r.getSchema()===6||r.getSchema()===7))return r.getSchema();const{httpLabel:t,httpPrefixHeaders:n,httpHeader:s,httpQuery:i}=r.getMergedTraits();return(e.httpBindings?typeof n=="string"||s?6:i||t?5:void 0:void 0)??e.timestampFormat.default}function pD(r,e,t){r.__smithy_context?r.__smithy_context.features||(r.__smithy_context.features={}):r.__smithy_context={features:{}},r.__smithy_context.features[e]=t}class zN{constructor(e){H(this,"authSchemes",new Map);for(const[t,n]of Object.entries(e))n!==void 0&&this.authSchemes.set(t,n)}getIdentityProvider(e){return this.authSchemes.get(e)}}class HN{async sign(e,t,n){return e}}const mD=r=>function(t){return BN(t)&&t.expiration.getTime()-Date.now()<r},gD=3e5,vD=mD(gD),BN=r=>r.expiration!==void 0,yD=(r,e,t)=>{if(r===void 0)return;const n=typeof r!="function"?async()=>Promise.resolve(r):r;let s,i,c,d=!1;const p=async m=>{i||(i=n(m));try{s=await i,c=!0,d=!1}finally{i=void 0}return s};return e===void 0?async m=>((!c||m!=null&&m.forceRefresh)&&(s=await p(m)),s):async m=>((!c||m!=null&&m.forceRefresh)&&(s=await p(m)),d?s:t(s)?(e(s)&&await p(m),s):(d=!0,s))},xD=void 0;function wD(r){return r===void 0?!0:typeof r=="string"&&r.length<=50}function GN(r){const e=Sm(r.userAgentAppId??xD),{customUserAgent:t}=r;return Object.assign(r,{customUserAgent:typeof t=="string"?[[t]]:t,userAgentAppId:async()=>{var s,i;const n=await e();if(!wD(n)){const c=((i=(s=r.logger)==null?void 0:s.constructor)==null?void 0:i.name)==="NoOpLogger"||!r.logger?console:r.logger;typeof n!="string"?c==null||c.warn("userAgentAppId must be a string or undefined."):n.length>50&&(c==null||c.warn("The provided userAgentAppId exceeds the maximum length of 50 characters."))}return n}})}class WN{constructor({size:e,params:t}){H(this,"capacity");H(this,"data",new Map);H(this,"parameters",[]);this.capacity=e??50,t&&(this.parameters=t)}get(e,t){const n=this.hash(e);if(n===!1)return t();if(!this.data.has(n)){if(this.data.size>this.capacity+10){const s=this.data.keys();let i=0;for(;;){const{value:c,done:d}=s.next();if(this.data.delete(c),d||++i>10)break}}this.data.set(n,t())}return this.data.get(n)}size(){return this.data.size}hash(e){let t="";const{parameters:n}=this;if(n.length===0)return!1;for(const s of n){const i=String(e[s]??"");if(i.includes("|;"))return!1;t+=i+"|;"}return t}}const bD=new RegExp("^(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}$"),Ob=r=>bD.test(r)||r.startsWith("[")&&r.endsWith("]"),_D=new RegExp("^(?!.*-$)(?!-)[a-zA-Z0-9-]{1,63}$"),eg=(r,e=!1)=>{if(!e)return _D.test(r);const t=r.split(".");for(const n of t)if(!eg(n))return!1;return!0},dh={},jm="endpoints";function Kc(r){return typeof r!="object"||r==null?r:"ref"in r?`$${Kc(r.ref)}`:"fn"in r?`${r.fn}(${(r.argv||[]).map(Kc).join(", ")})`:JSON.stringify(r,null,2)}class ci extends Error{constructor(e){super(e),this.name="EndpointError"}}const SD=(r,e)=>r===e,ED=r=>{const e=r.split("."),t=[];for(const n of e){const s=n.indexOf("[");if(s!==-1){if(n.indexOf("]")!==n.length-1)throw new ci(`Path: '${r}' does not end with ']'`);const i=n.slice(s+1,-1);if(Number.isNaN(parseInt(i)))throw new ci(`Invalid array index: '${i}' in path: '${r}'`);s!==0&&t.push(n.slice(0,s)),t.push(i)}else t.push(n)}return t},VN=(r,e)=>ED(e).reduce((t,n)=>{if(typeof t!="object")throw new ci(`Index '${n}' in '${e}' not found in '${JSON.stringify(r)}'`);return Array.isArray(t)?t[parseInt(n)]:t[n]},r),CD=r=>r!=null,kD=r=>!r,Ex={[Rm.HTTP]:80,[Rm.HTTPS]:443},ND=r=>{const e=(()=>{try{if(r instanceof URL)return r;if(typeof r=="object"&&"hostname"in r){const{hostname:b,port:S,protocol:T="",path:E="",query:C={}}=r,R=new URL(`${T}//${b}${S?`:${S}`:""}${E}`);return R.search=Object.entries(C).map(([A,F])=>`${A}=${F}`).join("&"),R}return new URL(r)}catch{return null}})();if(!e)return console.error(`Unable to parse ${JSON.stringify(r)} as a whatwg URL.`),null;const t=e.href,{host:n,hostname:s,pathname:i,protocol:c,search:d}=e;if(d)return null;const p=c.slice(0,-1);if(!Object.values(Rm).includes(p))return null;const m=Ob(s),g=t.includes(`${n}:${Ex[p]}`)||typeof r=="string"&&r.includes(`${n}:${Ex[p]}`),x=`${n}${g?`:${Ex[p]}`:""}`;return{scheme:p,authority:x,path:i,normalizedPath:i.endsWith("/")?i:`${i}/`,isIp:m}},TD=(r,e)=>r===e,RD=(r,e,t,n)=>e>=t||r.length<t?null:n?r.substring(r.length-t,r.length-e):r.substring(e,t),AD=r=>encodeURIComponent(r).replace(/[!*'()]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),ID={booleanEquals:SD,getAttr:VN,isSet:CD,isValidHostLabel:eg,not:kD,parseURL:ND,stringEquals:TD,substring:RD,uriEncode:AD},qN=(r,e)=>{const t=[],n={...e.endpointParams,...e.referenceRecord};let s=0;for(;s<r.length;){const i=r.indexOf("{",s);if(i===-1){t.push(r.slice(s));break}t.push(r.slice(s,i));const c=r.indexOf("}",i);if(c===-1){t.push(r.slice(i));break}r[i+1]==="{"&&r[c+1]==="}"&&(t.push(r.slice(i+1,c)),s=c+2);const d=r.substring(i+1,c);if(d.includes("#")){const[p,m]=d.split("#");t.push(VN(n[p],m))}else t.push(n[d]);s=c+1}return t.join("")},PD=({ref:r},e)=>({...e.endpointParams,...e.referenceRecord})[r],Ky=(r,e,t)=>{if(typeof r=="string")return qN(r,t);if(r.fn)return YN.callFunction(r,t);if(r.ref)return PD(r,t);throw new ci(`'${e}': ${String(r)} is not a string, function or reference.`)},KN=({fn:r,argv:e},t)=>{const n=e.map(i=>["boolean","number"].includes(typeof i)?i:YN.evaluateExpression(i,"arg",t)),s=r.split(".");return s[0]in dh&&s[1]!=null?dh[s[0]][s[1]](...n):ID[r](...n)},YN={evaluateExpression:Ky,callFunction:KN},jD=({assign:r,...e},t)=>{var s,i;if(r&&r in t.referenceRecord)throw new ci(`'${r}' is already defined in Reference Record.`);const n=KN(e,t);return(i=(s=t.logger)==null?void 0:s.debug)==null||i.call(s,`${jm} evaluateCondition: ${Kc(e)} = ${Kc(n)}`),{result:n===""?!0:!!n,...r!=null&&{toAssign:{name:r,value:n}}}},Db=(r=[],e)=>{var n,s;const t={};for(const i of r){const{result:c,toAssign:d}=jD(i,{...e,referenceRecord:{...e.referenceRecord,...t}});if(!c)return{result:c};d&&(t[d.name]=d.value,(s=(n=e.logger)==null?void 0:n.debug)==null||s.call(n,`${jm} assign: ${d.name} := ${Kc(d.value)}`))}return{result:!0,referenceRecord:t}},FD=(r,e)=>Object.entries(r).reduce((t,[n,s])=>({...t,[n]:s.map(i=>{const c=Ky(i,"Header value entry",e);if(typeof c!="string")throw new ci(`Header '${n}' value '${c}' is not a string`);return c})}),{}),JN=(r,e)=>Object.entries(r).reduce((t,[n,s])=>({...t,[n]:QN.getEndpointProperty(s,e)}),{}),XN=(r,e)=>{if(Array.isArray(r))return r.map(t=>XN(t,e));switch(typeof r){case"string":return qN(r,e);case"object":if(r===null)throw new ci(`Unexpected endpoint property: ${r}`);return QN.getEndpointProperties(r,e);case"boolean":return r;default:throw new ci(`Unexpected endpoint property type: ${typeof r}`)}},QN={getEndpointProperty:XN,getEndpointProperties:JN},OD=(r,e)=>{const t=Ky(r,"Endpoint URL",e);if(typeof t=="string")try{return new URL(t)}catch(n){throw console.error(`Failed to construct URL with ${t}`,n),n}throw new ci(`Endpoint URL must be a string, got ${typeof t}`)},DD=(r,e)=>{var g,x;const{conditions:t,endpoint:n}=r,{result:s,referenceRecord:i}=Db(t,e);if(!s)return;const c={...e,referenceRecord:{...e.referenceRecord,...i}},{url:d,properties:p,headers:m}=n;return(x=(g=e.logger)==null?void 0:g.debug)==null||x.call(g,`${jm} Resolving endpoint from template: ${Kc(n)}`),{...m!=null&&{headers:FD(m,c)},...p!=null&&{properties:JN(p,c)},url:OD(d,c)}},LD=(r,e)=>{const{conditions:t,error:n}=r,{result:s,referenceRecord:i}=Db(t,e);if(s)throw new ci(Ky(n,"Error",{...e,referenceRecord:{...e.referenceRecord,...i}}))},ZN=(r,e)=>{for(const t of r)if(t.type==="endpoint"){const n=DD(t,e);if(n)return n}else if(t.type==="error")LD(t,e);else if(t.type==="tree"){const n=e1.evaluateTreeRule(t,e);if(n)return n}else throw new ci(`Unknown endpoint rule: ${t}`);throw new ci("Rules evaluation failed")},MD=(r,e)=>{const{conditions:t,rules:n}=r,{result:s,referenceRecord:i}=Db(t,e);if(s)return e1.evaluateRules(n,{...e,referenceRecord:{...e.referenceRecord,...i}})},e1={evaluateRules:ZN,evaluateTreeRule:MD},t1=(r,e)=>{var m,g,x,b;const{endpointParams:t,logger:n}=e,{parameters:s,rules:i}=r;(g=(m=e.logger)==null?void 0:m.debug)==null||g.call(m,`${jm} Initial EndpointParams: ${Kc(t)}`);const c=Object.entries(s).filter(([,S])=>S.default!=null).map(([S,T])=>[S,T.default]);if(c.length>0)for(const[S,T]of c)t[S]=t[S]??T;const d=Object.entries(s).filter(([,S])=>S.required).map(([S])=>S);for(const S of d)if(t[S]==null)throw new ci(`Missing required parameter: '${S}'`);const p=ZN(i,{endpointParams:t,logger:n,referenceRecord:{}});return(b=(x=e.logger)==null?void 0:x.debug)==null||b.call(x,`${jm} Resolved endpoint: ${Kc(p)}`),p},r1=(r,e=!1)=>{if(e){for(const t of r.split("."))if(!r1(t))return!1;return!0}return!(!eg(r)||r.length<3||r.length>63||r!==r.toLowerCase()||Ob(r))},IE=":",$D="/",UD=r=>{const e=r.split(IE);if(e.length<6)return null;const[t,n,s,i,c,...d]=e;if(t!=="arn"||n===""||s===""||d.join(IE)==="")return null;const p=d.map(m=>m.split($D)).flat();return{partition:n,service:s,region:i,accountId:c,resourceId:p}},zD=[{id:"aws",outputs:{dnsSuffix:"amazonaws.com",dualStackDnsSuffix:"api.aws",implicitGlobalRegion:"us-east-1",name:"aws",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^(us|eu|ap|sa|ca|me|af|il|mx)\\-\\w+\\-\\d+$",regions:{"af-south-1":{description:"Africa (Cape Town)"},"ap-east-1":{description:"Asia Pacific (Hong Kong)"},"ap-east-2":{description:"Asia Pacific (Taipei)"},"ap-northeast-1":{description:"Asia Pacific (Tokyo)"},"ap-northeast-2":{description:"Asia Pacific (Seoul)"},"ap-northeast-3":{description:"Asia Pacific (Osaka)"},"ap-south-1":{description:"Asia Pacific (Mumbai)"},"ap-south-2":{description:"Asia Pacific (Hyderabad)"},"ap-southeast-1":{description:"Asia Pacific (Singapore)"},"ap-southeast-2":{description:"Asia Pacific (Sydney)"},"ap-southeast-3":{description:"Asia Pacific (Jakarta)"},"ap-southeast-4":{description:"Asia Pacific (Melbourne)"},"ap-southeast-5":{description:"Asia Pacific (Malaysia)"},"ap-southeast-6":{description:"Asia Pacific (New Zealand)"},"ap-southeast-7":{description:"Asia Pacific (Thailand)"},"aws-global":{description:"aws global region"},"ca-central-1":{description:"Canada (Central)"},"ca-west-1":{description:"Canada West (Calgary)"},"eu-central-1":{description:"Europe (Frankfurt)"},"eu-central-2":{description:"Europe (Zurich)"},"eu-north-1":{description:"Europe (Stockholm)"},"eu-south-1":{description:"Europe (Milan)"},"eu-south-2":{description:"Europe (Spain)"},"eu-west-1":{description:"Europe (Ireland)"},"eu-west-2":{description:"Europe (London)"},"eu-west-3":{description:"Europe (Paris)"},"il-central-1":{description:"Israel (Tel Aviv)"},"me-central-1":{description:"Middle East (UAE)"},"me-south-1":{description:"Middle East (Bahrain)"},"mx-central-1":{description:"Mexico (Central)"},"sa-east-1":{description:"South America (Sao Paulo)"},"us-east-1":{description:"US East (N. Virginia)"},"us-east-2":{description:"US East (Ohio)"},"us-west-1":{description:"US West (N. California)"},"us-west-2":{description:"US West (Oregon)"}}},{id:"aws-cn",outputs:{dnsSuffix:"amazonaws.com.cn",dualStackDnsSuffix:"api.amazonwebservices.com.cn",implicitGlobalRegion:"cn-northwest-1",name:"aws-cn",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^cn\\-\\w+\\-\\d+$",regions:{"aws-cn-global":{description:"aws-cn global region"},"cn-north-1":{description:"China (Beijing)"},"cn-northwest-1":{description:"China (Ningxia)"}}},{id:"aws-eusc",outputs:{dnsSuffix:"amazonaws.eu",dualStackDnsSuffix:"api.amazonwebservices.eu",implicitGlobalRegion:"eusc-de-east-1",name:"aws-eusc",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^eusc\\-(de)\\-\\w+\\-\\d+$",regions:{"eusc-de-east-1":{description:"AWS European Sovereign Cloud (Germany)"}}},{id:"aws-iso",outputs:{dnsSuffix:"c2s.ic.gov",dualStackDnsSuffix:"api.aws.ic.gov",implicitGlobalRegion:"us-iso-east-1",name:"aws-iso",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-iso\\-\\w+\\-\\d+$",regions:{"aws-iso-global":{description:"aws-iso global region"},"us-iso-east-1":{description:"US ISO East"},"us-iso-west-1":{description:"US ISO WEST"}}},{id:"aws-iso-b",outputs:{dnsSuffix:"sc2s.sgov.gov",dualStackDnsSuffix:"api.aws.scloud",implicitGlobalRegion:"us-isob-east-1",name:"aws-iso-b",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-isob\\-\\w+\\-\\d+$",regions:{"aws-iso-b-global":{description:"aws-iso-b global region"},"us-isob-east-1":{description:"US ISOB East (Ohio)"},"us-isob-west-1":{description:"US ISOB West"}}},{id:"aws-iso-e",outputs:{dnsSuffix:"cloud.adc-e.uk",dualStackDnsSuffix:"api.cloud-aws.adc-e.uk",implicitGlobalRegion:"eu-isoe-west-1",name:"aws-iso-e",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^eu\\-isoe\\-\\w+\\-\\d+$",regions:{"aws-iso-e-global":{description:"aws-iso-e global region"},"eu-isoe-west-1":{description:"EU ISOE West"}}},{id:"aws-iso-f",outputs:{dnsSuffix:"csp.hci.ic.gov",dualStackDnsSuffix:"api.aws.hci.ic.gov",implicitGlobalRegion:"us-isof-south-1",name:"aws-iso-f",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-isof\\-\\w+\\-\\d+$",regions:{"aws-iso-f-global":{description:"aws-iso-f global region"},"us-isof-east-1":{description:"US ISOF EAST"},"us-isof-south-1":{description:"US ISOF SOUTH"}}},{id:"aws-us-gov",outputs:{dnsSuffix:"amazonaws.com",dualStackDnsSuffix:"api.aws",implicitGlobalRegion:"us-gov-west-1",name:"aws-us-gov",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-gov\\-\\w+\\-\\d+$",regions:{"aws-us-gov-global":{description:"aws-us-gov global region"},"us-gov-east-1":{description:"AWS GovCloud (US-East)"},"us-gov-west-1":{description:"AWS GovCloud (US-West)"}}}],HD={partitions:zD};let BD=HD;const GD=r=>{const{partitions:e}=BD;for(const n of e){const{regions:s,outputs:i}=n;for(const[c,d]of Object.entries(s))if(c===r)return{...i,...d}}for(const n of e){const{regionRegex:s,outputs:i}=n;if(new RegExp(s).test(r))return{...i}}const t=e.find(n=>n.id==="aws");if(!t)throw new Error("Provided region was not found in the partition array or regex, and default partition with id 'aws' doesn't exist.");return{...t.outputs}},WD={isVirtualHostableS3Bucket:r1,parseArn:UD,partition:GD};dh.aws=WD;function VD(r){const e={};if(r=r.replace(/^\?/,""),r)for(const t of r.split("&")){let[n,s=null]=t.split("=");n=decodeURIComponent(n),s&&(s=decodeURIComponent(s)),n in e?Array.isArray(e[n])?e[n].push(s):e[n]=[e[n],s]:e[n]=s}return e}const Fm=r=>{if(typeof r=="string")return Fm(new URL(r));const{hostname:e,pathname:t,port:n,protocol:s,search:i}=r;let c;return i&&(c=VD(i)),{hostname:e,port:n?parseInt(n):void 0,protocol:s,path:t,query:c}};function qD(r,e,t){return r.$source||(r.$source={}),r.$source[e]=t,r}function Fa(r,e,t){r.__aws_sdk_context?r.__aws_sdk_context.features||(r.__aws_sdk_context.features={}):r.__aws_sdk_context={features:{}},r.__aws_sdk_context.features[e]=t}const PE=r=>{var e,t;return uh.isInstance(r)?((e=r.headers)==null?void 0:e.date)??((t=r.headers)==null?void 0:t.Date):void 0},n1=r=>new Date(Date.now()+r),KD=(r,e)=>Math.abs(n1(e).getTime()-r)>=3e5,jE=(r,e)=>{const t=Date.parse(r);return KD(t,e)?t-Date.now():e},Cm=(r,e)=>{if(!e)throw new Error(`Property \`${r}\` is not resolved for AWS SDK SigV4Auth`);return e},YD=async r=>{var m,g,x;const e=Cm("context",r.context),t=Cm("config",r.config),n=(x=(g=(m=e.endpointV2)==null?void 0:m.properties)==null?void 0:g.authSchemes)==null?void 0:x[0],i=await Cm("signer",t.signer)(n),c=r==null?void 0:r.signingRegion,d=r==null?void 0:r.signingRegionSet,p=r==null?void 0:r.signingName;return{config:t,signer:i,signingRegion:c,signingRegionSet:d,signingName:p}};class s1{async sign(e,t,n){var x;if(!li.isInstance(e))throw new Error("The request is not an instance of `HttpRequest` and cannot be signed");const s=await YD(n),{config:i,signer:c}=s;let{signingRegion:d,signingName:p}=s;const m=n.context;if(((x=m==null?void 0:m.authSchemes)==null?void 0:x.length)??!1){const[b,S]=m.authSchemes;(b==null?void 0:b.name)==="sigv4a"&&(S==null?void 0:S.name)==="sigv4"&&(d=(S==null?void 0:S.signingRegion)??d,p=(S==null?void 0:S.signingName)??p)}return await c.sign(e,{signingDate:n1(i.systemClockOffset),signingRegion:d,signingService:p})}errorHandler(e){return t=>{const n=t.ServerTime??PE(t.$response);if(n){const s=Cm("config",e.config),i=s.systemClockOffset;s.systemClockOffset=jE(n,s.systemClockOffset),s.systemClockOffset!==i&&t.$metadata&&(t.$metadata.clockSkewCorrected=!0)}throw t}}successHandler(e,t){const n=PE(e);if(n){const s=Cm("config",t.config);s.systemClockOffset=jE(n,s.systemClockOffset)}}}const JD=(r,e,t)=>{let n,s,i,c=!1;const d=async()=>{s||(s=r());try{n=await s,i=!0,c=!1}finally{s=void 0}return n};return async p=>((!i||p!=null&&p.forceRefresh)&&(n=await d()),n)},XD="X-Amz-Algorithm",QD="X-Amz-Credential",o1="X-Amz-Date",ZD="X-Amz-SignedHeaders",eL="X-Amz-Expires",i1="X-Amz-Signature",a1="X-Amz-Security-Token",l1="authorization",c1=o1.toLowerCase(),tL="date",rL=[l1,c1,tL],nL=i1.toLowerCase(),Pw="x-amz-content-sha256",sL=a1.toLowerCase(),oL={authorization:!0,"cache-control":!0,connection:!0,expect:!0,from:!0,"keep-alive":!0,"max-forwards":!0,pragma:!0,referer:!0,te:!0,trailer:!0,"transfer-encoding":!0,upgrade:!0,"user-agent":!0,"x-amzn-trace-id":!0},iL=/^proxy-/,aL=/^sec-/,Cx="AWS4-HMAC-SHA256",lL="AWS4-HMAC-SHA256-PAYLOAD",cL="UNSIGNED-PAYLOAD",uL=50,u1="aws4_request",dL=3600*24*7,Nv={},kx=[],Nx=(r,e,t)=>`${r}/${e}/${t}/${u1}`,fL=async(r,e,t,n,s)=>{const i=await FE(r,e.secretAccessKey,e.accessKeyId),c=`${t}:${n}:${s}:${ad(i)}:${e.sessionToken}`;if(c in Nv)return Nv[c];for(kx.push(c);kx.length>uL;)delete Nv[kx.shift()];let d=`AWS4${e.secretAccessKey}`;for(const p of[t,n,s,u1])d=await FE(r,d,p);return Nv[c]=d},FE=(r,e,t)=>{const n=new r(e);return n.update(Am(t)),n.digest()},OE=({headers:r},e,t)=>{const n={};for(const s of Object.keys(r).sort()){if(r[s]==null)continue;const i=s.toLowerCase();(i in oL||e!=null&&e.has(i)||iL.test(i)||aL.test(i))&&(!t||t&&!t.has(i))||(n[i]=r[s].trim().replace(/\s+/g," "))}return n},hL=r=>typeof ArrayBuffer=="function"&&r instanceof ArrayBuffer||Object.prototype.toString.call(r)==="[object ArrayBuffer]",Tx=async({headers:r,body:e},t)=>{for(const n of Object.keys(r))if(n.toLowerCase()===Pw)return r[n];if(e==null)return"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855";if(typeof e=="string"||ArrayBuffer.isView(e)||hL(e)){const n=new t;return n.update(Am(e)),ad(await n.digest())}return cL};class pL{format(e){const t=[];for(const i of Object.keys(e)){const c=cd(i);t.push(Uint8Array.from([c.byteLength]),c,this.formatHeaderValue(e[i]))}const n=new Uint8Array(t.reduce((i,c)=>i+c.byteLength,0));let s=0;for(const i of t)n.set(i,s),s+=i.byteLength;return n}formatHeaderValue(e){switch(e.type){case"boolean":return Uint8Array.from([e.value?0:1]);case"byte":return Uint8Array.from([2,e.value]);case"short":const t=new DataView(new ArrayBuffer(3));return t.setUint8(0,3),t.setInt16(1,e.value,!1),new Uint8Array(t.buffer);case"integer":const n=new DataView(new ArrayBuffer(5));return n.setUint8(0,4),n.setInt32(1,e.value,!1),new Uint8Array(n.buffer);case"long":const s=new Uint8Array(9);return s[0]=5,s.set(e.value.bytes,1),s;case"binary":const i=new DataView(new ArrayBuffer(3+e.value.byteLength));i.setUint8(0,6),i.setUint16(1,e.value.byteLength,!1);const c=new Uint8Array(i.buffer);return c.set(e.value,3),c;case"string":const d=cd(e.value),p=new DataView(new ArrayBuffer(3+d.byteLength));p.setUint8(0,7),p.setUint16(1,d.byteLength,!1);const m=new Uint8Array(p.buffer);return m.set(d,3),m;case"timestamp":const g=new Uint8Array(9);return g[0]=8,g.set(Lb.fromNumber(e.value.valueOf()).bytes,1),g;case"uuid":if(!mL.test(e.value))throw new Error(`Invalid UUID received: ${e.value}`);const x=new Uint8Array(17);return x[0]=9,x.set(IO(e.value.replace(/\-/g,"")),1),x}}}var DE;(function(r){r[r.boolTrue=0]="boolTrue",r[r.boolFalse=1]="boolFalse",r[r.byte=2]="byte",r[r.short=3]="short",r[r.integer=4]="integer",r[r.long=5]="long",r[r.byteArray=6]="byteArray",r[r.string=7]="string",r[r.timestamp=8]="timestamp",r[r.uuid=9]="uuid"})(DE||(DE={}));const mL=/^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$/;class Lb{constructor(e){H(this,"bytes");if(this.bytes=e,e.byteLength!==8)throw new Error("Int64 buffers must be exactly 8 bytes")}static fromNumber(e){if(e>9223372036854776e3||e<-9223372036854776e3)throw new Error(`${e} is too large (or, if negative, too small) to represent as an Int64`);const t=new Uint8Array(8);for(let n=7,s=Math.abs(Math.round(e));n>-1&&s>0;n--,s/=256)t[n]=s;return e<0&&LE(t),new Lb(t)}valueOf(){const e=this.bytes.slice(0),t=e[0]&128;return t&&LE(e),parseInt(ad(e),16)*(t?-1:1)}toString(){return String(this.valueOf())}}function LE(r){for(let e=0;e<8;e++)r[e]^=255;for(let e=7;e>-1&&(r[e]++,r[e]===0);e--);}const gL=(r,e)=>{r=r.toLowerCase();for(const t of Object.keys(e))if(r===t.toLowerCase())return!0;return!1},vL=(r,e={})=>{var s,i;const{headers:t,query:n={}}=li.clone(r);for(const c of Object.keys(t)){const d=c.toLowerCase();(d.slice(0,6)==="x-amz-"&&!((s=e.unhoistableHeaders)!=null&&s.has(d))||(i=e.hoistableHeaders)!=null&&i.has(d))&&(n[c]=t[c],delete t[c])}return{...r,headers:t,query:n}},ME=r=>{r=li.clone(r);for(const e of Object.keys(r.headers))rL.indexOf(e.toLowerCase())>-1&&delete r.headers[e];return r},yL=({query:r={}})=>{const e=[],t={};for(const n of Object.keys(r)){if(n.toLowerCase()===nL)continue;const s=id(n);e.push(s);const i=r[n];typeof i=="string"?t[s]=`${s}=${id(i)}`:Array.isArray(i)&&(t[s]=i.slice(0).reduce((c,d)=>c.concat([`${s}=${id(d)}`]),[]).sort().join("&"))}return e.sort().map(n=>t[n]).filter(n=>n).join("&")},xL=r=>wL(r).toISOString().replace(/\.\d{3}Z$/,"Z"),wL=r=>typeof r=="number"?new Date(r*1e3):typeof r=="string"?Number(r)?new Date(Number(r)*1e3):new Date(r):r;class bL{constructor({applyChecksum:e,credentials:t,region:n,service:s,sha256:i,uriEscapePath:c=!0}){H(this,"service");H(this,"regionProvider");H(this,"credentialProvider");H(this,"sha256");H(this,"uriEscapePath");H(this,"applyChecksum");this.service=s,this.sha256=i,this.uriEscapePath=c,this.applyChecksum=typeof e=="boolean"?e:!0,this.regionProvider=sa(n),this.credentialProvider=sa(t)}createCanonicalRequest(e,t,n){const s=Object.keys(t).sort();return`${e.method}
${this.getCanonicalPath(e)}
${yL(e)}
${s.map(i=>`${i}:${t[i]}`).join(`
`)}

${s.join(";")}
${n}`}async createStringToSign(e,t,n,s){const i=new this.sha256;i.update(Am(n));const c=await i.digest();return`${s}
${e}
${t}
${ad(c)}`}getCanonicalPath({path:e}){if(this.uriEscapePath){const t=[];for(const i of e.split("/"))(i==null?void 0:i.length)!==0&&i!=="."&&(i===".."?t.pop():t.push(i));const n=`${e!=null&&e.startsWith("/")?"/":""}${t.join("/")}${t.length>0&&(e!=null&&e.endsWith("/"))?"/":""}`;return id(n).replace(/%2F/g,"/")}return e}validateResolvedCredentials(e){if(typeof e!="object"||typeof e.accessKeyId!="string"||typeof e.secretAccessKey!="string")throw new Error("Resolved credential object is not valid")}formatDate(e){const t=xL(e).replace(/[\-:]/g,"");return{longDate:t,shortDate:t.slice(0,8)}}getCanonicalHeaderList(e){return Object.keys(e).sort().join(";")}}class $E extends bL{constructor({applyChecksum:t,credentials:n,region:s,service:i,sha256:c,uriEscapePath:d=!0}){super({applyChecksum:t,credentials:n,region:s,service:i,sha256:c,uriEscapePath:d});H(this,"headerFormatter",new pL)}async presign(t,n={}){const{signingDate:s=new Date,expiresIn:i=3600,unsignableHeaders:c,unhoistableHeaders:d,signableHeaders:p,hoistableHeaders:m,signingRegion:g,signingService:x}=n,b=await this.credentialProvider();this.validateResolvedCredentials(b);const S=g??await this.regionProvider(),{longDate:T,shortDate:E}=this.formatDate(s);if(i>dL)return Promise.reject("Signature version 4 presigned URLs must have an expiration date less than one week in the future");const C=Nx(E,S,x??this.service),R=vL(ME(t),{unhoistableHeaders:d,hoistableHeaders:m});b.sessionToken&&(R.query[a1]=b.sessionToken),R.query[XD]=Cx,R.query[QD]=`${b.accessKeyId}/${C}`,R.query[o1]=T,R.query[eL]=i.toString(10);const A=OE(R,c,p);return R.query[ZD]=this.getCanonicalHeaderList(A),R.query[i1]=await this.getSignature(T,C,this.getSigningKey(b,S,E,x),this.createCanonicalRequest(R,A,await Tx(t,this.sha256))),R}async sign(t,n){return typeof t=="string"?this.signString(t,n):t.headers&&t.payload?this.signEvent(t,n):t.message?this.signMessage(t,n):this.signRequest(t,n)}async signEvent({headers:t,payload:n},{signingDate:s=new Date,priorSignature:i,signingRegion:c,signingService:d}){const p=c??await this.regionProvider(),{shortDate:m,longDate:g}=this.formatDate(s),x=Nx(m,p,d??this.service),b=await Tx({headers:{},body:n},this.sha256),S=new this.sha256;S.update(t);const T=ad(await S.digest()),E=[lL,g,x,i,T,b].join(`
`);return this.signString(E,{signingDate:s,signingRegion:p,signingService:d})}async signMessage(t,{signingDate:n=new Date,signingRegion:s,signingService:i}){return this.signEvent({headers:this.headerFormatter.format(t.message.headers),payload:t.message.body},{signingDate:n,signingRegion:s,signingService:i,priorSignature:t.priorSignature}).then(d=>({message:t.message,signature:d}))}async signString(t,{signingDate:n=new Date,signingRegion:s,signingService:i}={}){const c=await this.credentialProvider();this.validateResolvedCredentials(c);const d=s??await this.regionProvider(),{shortDate:p}=this.formatDate(n),m=new this.sha256(await this.getSigningKey(c,d,p,i));return m.update(Am(t)),ad(await m.digest())}async signRequest(t,{signingDate:n=new Date,signableHeaders:s,unsignableHeaders:i,signingRegion:c,signingService:d}={}){const p=await this.credentialProvider();this.validateResolvedCredentials(p);const m=c??await this.regionProvider(),g=ME(t),{longDate:x,shortDate:b}=this.formatDate(n),S=Nx(b,m,d??this.service);g.headers[c1]=x,p.sessionToken&&(g.headers[sL]=p.sessionToken);const T=await Tx(g,this.sha256);!gL(Pw,g.headers)&&this.applyChecksum&&(g.headers[Pw]=T);const E=OE(g,i,s),C=await this.getSignature(x,S,this.getSigningKey(p,m,b,d),this.createCanonicalRequest(g,E,T));return g.headers[l1]=`${Cx} Credential=${p.accessKeyId}/${S}, SignedHeaders=${this.getCanonicalHeaderList(E)}, Signature=${C}`,g}async getSignature(t,n,s,i){const c=await this.createStringToSign(t,n,i,Cx),d=new this.sha256(await s);return d.update(Am(c)),ad(await d.digest())}getSigningKey(t,n,s,i){return fL(this.sha256,t,s,n,i||this.service)}}const d1=r=>{let e=r.credentials,t=!!r.credentials,n;Object.defineProperty(r,"credentials",{set(m){m&&m!==e&&m!==n&&(t=!0),e=m;const g=_L(r,{credentials:e,credentialDefaultProvider:r.credentialDefaultProvider}),x=SL(r,g);if(t&&!x.attributed){const b=typeof e=="object"&&e!==null;n=async S=>{const E=await x(S);return b&&(!E.$source||Object.keys(E.$source).length===0)?qD(E,"CREDENTIALS_CODE","e"):E},n.memoized=x.memoized,n.configBound=x.configBound,n.attributed=!0}else n=x},get(){return n},enumerable:!0,configurable:!0}),r.credentials=e;const{signingEscapePath:s=!0,systemClockOffset:i=r.systemClockOffset||0,sha256:c}=r;let d;return r.signer?d=Sm(r.signer):r.regionInfoProvider?d=()=>Sm(r.region)().then(async m=>[await r.regionInfoProvider(m,{useFipsEndpoint:await r.useFipsEndpoint(),useDualstackEndpoint:await r.useDualstackEndpoint()})||{},m]).then(([m,g])=>{const{signingRegion:x,signingService:b}=m;r.signingRegion=r.signingRegion||x||g,r.signingName=r.signingName||b||r.serviceId;const S={...r,credentials:r.credentials,region:r.signingRegion,service:r.signingName,sha256:c,uriEscapePath:s},T=r.signerConstructor||$E;return new T(S)}):d=async m=>{m=Object.assign({},{name:"sigv4",signingName:r.signingName||r.defaultSigningName,signingRegion:await Sm(r.region)(),properties:{}},m);const g=m.signingRegion,x=m.signingName;r.signingRegion=r.signingRegion||g,r.signingName=r.signingName||x||r.serviceId;const b={...r,credentials:r.credentials,region:r.signingRegion,service:r.signingName,sha256:c,uriEscapePath:s},S=r.signerConstructor||$E;return new S(b)},Object.assign(r,{systemClockOffset:i,signingEscapePath:s,signer:d})};function _L(r,{credentials:e,credentialDefaultProvider:t}){let n;return e?e!=null&&e.memoized?n=e:n=yD(e,vD,BN):t?n=Sm(t(Object.assign({},r,{parentClientConfig:r}))):n=async()=>{throw new Error("@aws-sdk/core::resolveAwsSdkSigV4Config - `credentials` not provided and no credentialDefaultProvider was configured.")},n.memoized=!0,n}function SL(r,e){if(e.configBound)return e;const t=async n=>e({...n,callerClientConfig:r});return t.memoized=e.memoized,t.configBound=!0,t}const UE=typeof TextEncoder=="function"?new TextEncoder:null,f1=r=>{if(typeof r=="string"){if(UE)return UE.encode(r).byteLength;let e=r.length;for(let t=e-1;t>=0;t--){const n=r.charCodeAt(t);n>127&&n<=2047?e++:n>2047&&n<=65535&&(e+=2),n>=56320&&n<=57343&&t--}return e}else{if(typeof r.byteLength=="number")return r.byteLength;if(typeof r.size=="number")return r.size}throw new Error(`Body Length computation failed for ${r}`)},Ju=(r,e)=>{const t=[];if(r&&t.push(r),e)for(const n of e)t.push(n);return t},Pc=(r,e)=>`${r||"anonymous"}${e&&e.length>0?` (a.k.a. ${e.join(",")})`:""}`,fy=()=>{let r=[],e=[],t=!1;const n=new Set,s=x=>x.sort((b,S)=>zE[S.step]-zE[b.step]||HE[S.priority||"normal"]-HE[b.priority||"normal"]),i=x=>{let b=!1;const S=T=>{const E=Ju(T.name,T.aliases);if(E.includes(x)){b=!0;for(const C of E)n.delete(C);return!1}return!0};return r=r.filter(S),e=e.filter(S),b},c=x=>{let b=!1;const S=T=>{if(T.middleware===x){b=!0;for(const E of Ju(T.name,T.aliases))n.delete(E);return!1}return!0};return r=r.filter(S),e=e.filter(S),b},d=x=>{var b;return r.forEach(S=>{x.add(S.middleware,{...S})}),e.forEach(S=>{x.addRelativeTo(S.middleware,{...S})}),(b=x.identifyOnResolve)==null||b.call(x,g.identifyOnResolve()),x},p=x=>{const b=[];return x.before.forEach(S=>{S.before.length===0&&S.after.length===0?b.push(S):b.push(...p(S))}),b.push(x),x.after.reverse().forEach(S=>{S.before.length===0&&S.after.length===0?b.push(S):b.push(...p(S))}),b},m=(x=!1)=>{const b=[],S=[],T={};return r.forEach(C=>{const R={...C,before:[],after:[]};for(const A of Ju(R.name,R.aliases))T[A]=R;b.push(R)}),e.forEach(C=>{const R={...C,before:[],after:[]};for(const A of Ju(R.name,R.aliases))T[A]=R;S.push(R)}),S.forEach(C=>{if(C.toMiddleware){const R=T[C.toMiddleware];if(R===void 0){if(x)return;throw new Error(`${C.toMiddleware} is not found when adding ${Pc(C.name,C.aliases)} middleware ${C.relation} ${C.toMiddleware}`)}C.relation==="after"&&R.after.push(C),C.relation==="before"&&R.before.push(C)}}),s(b).map(p).reduce((C,R)=>(C.push(...R),C),[])},g={add:(x,b={})=>{const{name:S,override:T,aliases:E}=b,C={step:"initialize",priority:"normal",middleware:x,...b},R=Ju(S,E);if(R.length>0){if(R.some(A=>n.has(A))){if(!T)throw new Error(`Duplicate middleware name '${Pc(S,E)}'`);for(const A of R){const F=r.findIndex(L=>{var G;return L.name===A||((G=L.aliases)==null?void 0:G.some(U=>U===A))});if(F===-1)continue;const P=r[F];if(P.step!==C.step||C.priority!==P.priority)throw new Error(`"${Pc(P.name,P.aliases)}" middleware with ${P.priority} priority in ${P.step} step cannot be overridden by "${Pc(S,E)}" middleware with ${C.priority} priority in ${C.step} step.`);r.splice(F,1)}}for(const A of R)n.add(A)}r.push(C)},addRelativeTo:(x,b)=>{const{name:S,override:T,aliases:E}=b,C={middleware:x,...b},R=Ju(S,E);if(R.length>0){if(R.some(A=>n.has(A))){if(!T)throw new Error(`Duplicate middleware name '${Pc(S,E)}'`);for(const A of R){const F=e.findIndex(L=>{var G;return L.name===A||((G=L.aliases)==null?void 0:G.some(U=>U===A))});if(F===-1)continue;const P=e[F];if(P.toMiddleware!==C.toMiddleware||P.relation!==C.relation)throw new Error(`"${Pc(P.name,P.aliases)}" middleware ${P.relation} "${P.toMiddleware}" middleware cannot be overridden by "${Pc(S,E)}" middleware ${C.relation} "${C.toMiddleware}" middleware.`);e.splice(F,1)}}for(const A of R)n.add(A)}e.push(C)},clone:()=>d(fy()),use:x=>{x.applyToStack(g)},remove:x=>typeof x=="string"?i(x):c(x),removeByTag:x=>{let b=!1;const S=T=>{const{tags:E,name:C,aliases:R}=T;if(E&&E.includes(x)){const A=Ju(C,R);for(const F of A)n.delete(F);return b=!0,!1}return!0};return r=r.filter(S),e=e.filter(S),b},concat:x=>{var S;const b=d(fy());return b.use(x),b.identifyOnResolve(t||b.identifyOnResolve()||(((S=x.identifyOnResolve)==null?void 0:S.call(x))??!1)),b},applyToStack:d,identify:()=>m(!0).map(x=>{const b=x.step??x.relation+" "+x.toMiddleware;return Pc(x.name,x.aliases)+" - "+b}),identifyOnResolve(x){return typeof x=="boolean"&&(t=x),t},resolve:(x,b)=>{for(const S of m().map(T=>T.middleware).reverse())x=S(x,b);return t&&console.log(g.identify()),x}};return g},zE={initialize:5,serialize:4,build:3,finalizeRequest:2,deserialize:1},HE={high:3,normal:2,low:1};class h1{constructor(e){H(this,"config");H(this,"middlewareStack",fy());H(this,"initConfig");H(this,"handlers");this.config=e;const{protocol:t,protocolSettings:n}=e;n&&typeof t=="function"&&(e.protocol=new t(n))}send(e,t,n){const s=typeof t!="function"?t:void 0,i=typeof t=="function"?t:n,c=s===void 0&&this.config.cacheMiddleware===!0;let d;if(c){this.handlers||(this.handlers=new WeakMap);const p=this.handlers;p.has(e.constructor)?d=p.get(e.constructor):(d=e.resolveMiddleware(this.middlewareStack,this.config,s),p.set(e.constructor,d))}else delete this.handlers,d=e.resolveMiddleware(this.middlewareStack,this.config,s);if(i)d(e).then(p=>i(null,p.output),p=>i(p)).catch(()=>{});else return d(e).then(p=>p.output)}destroy(){var e,t,n;(n=(t=(e=this.config)==null?void 0:e.requestHandler)==null?void 0:t.destroy)==null||n.call(t),delete this.handlers}}const Rx="***SensitiveInformation***";function jw(r,e){if(e==null)return e;const t=Oo.of(r);if(t.getMergedTraits().sensitive)return Rx;if(t.isListSchema()){if(!!t.getValueSchema().getMergedTraits().sensitive)return Rx}else if(t.isMapSchema()){if(!!t.getKeySchema().getMergedTraits().sensitive||!!t.getValueSchema().getMergedTraits().sensitive)return Rx}else if(t.isStructSchema()&&typeof e=="object"){const n=e,s={};for(const[i,c]of t.structIterator())n[i]!=null&&(s[i]=jw(c,n[i]));return s}return e}class p1{constructor(){H(this,"middlewareStack",fy());H(this,"schema")}static classBuilder(){return new EL}resolveMiddlewareWithContext(e,t,n,{middlewareFn:s,clientName:i,commandName:c,inputFilterSensitiveLog:d,outputFilterSensitiveLog:p,smithyContext:m,additionalContext:g,CommandCtor:x}){for(const C of s.bind(this)(x,e,t,n))this.middlewareStack.use(C);const b=e.concat(this.middlewareStack),{logger:S}=t,T={logger:S,clientName:i,commandName:c,inputFilterSensitiveLog:d,outputFilterSensitiveLog:p,[Nw]:{commandInstance:this,...m},...g},{requestHandler:E}=t;return b.resolve(C=>E.handle(C.request,n||{}),T)}}class EL{constructor(){H(this,"_init",()=>{});H(this,"_ep",{});H(this,"_middlewareFn",()=>[]);H(this,"_commandName","");H(this,"_clientName","");H(this,"_additionalContext",{});H(this,"_smithyContext",{});H(this,"_inputFilterSensitiveLog");H(this,"_outputFilterSensitiveLog");H(this,"_serializer",null);H(this,"_deserializer",null);H(this,"_operationSchema")}init(e){this._init=e}ep(e){return this._ep=e,this}m(e){return this._middlewareFn=e,this}s(e,t,n={}){return this._smithyContext={service:e,operation:t,...n},this}c(e={}){return this._additionalContext=e,this}n(e,t){return this._clientName=e,this._commandName=t,this}f(e=n=>n,t=n=>n){return this._inputFilterSensitiveLog=e,this._outputFilterSensitiveLog=t,this}ser(e){return this._serializer=e,this}de(e){return this._deserializer=e,this}sc(e){return this._operationSchema=e,this._smithyContext.operationSchema=e,this}build(){const e=this;let t;return t=class extends p1{constructor(...[s]){super();H(this,"input");H(this,"serialize",e._serializer);H(this,"deserialize",e._deserializer);this.input=s??{},e._init(this),this.schema=e._operationSchema}static getEndpointParameterInstructions(){return e._ep}resolveMiddleware(s,i,c){const d=e._operationSchema,p=(d==null?void 0:d[4])??(d==null?void 0:d.input),m=(d==null?void 0:d[5])??(d==null?void 0:d.output);return this.resolveMiddlewareWithContext(s,i,c,{CommandCtor:t,middlewareFn:e._middlewareFn,clientName:e._clientName,commandName:e._commandName,inputFilterSensitiveLog:e._inputFilterSensitiveLog??(d?jw.bind(null,p):g=>g),outputFilterSensitiveLog:e._outputFilterSensitiveLog??(d?jw.bind(null,m):g=>g),smithyContext:e._smithyContext,additionalContext:e._additionalContext})}}}}class Xf extends Error{constructor(t){super(t.message);H(this,"$fault");H(this,"$response");H(this,"$retryable");H(this,"$metadata");Object.setPrototypeOf(this,Object.getPrototypeOf(this).constructor.prototype),this.name=t.name,this.$fault=t.$fault,this.$metadata=t.$metadata}static isInstance(t){if(!t)return!1;const n=t;return Xf.prototype.isPrototypeOf(n)||!!n.$fault&&!!n.$metadata&&(n.$fault==="client"||n.$fault==="server")}static[Symbol.hasInstance](t){if(!t)return!1;const n=t;return this===Xf?Xf.isInstance(t):Xf.isInstance(t)?n.name&&this.name?this.prototype.isPrototypeOf(t)||n.name===this.name:this.prototype.isPrototypeOf(t):!1}}const BE=(r,e={})=>{Object.entries(e).filter(([,n])=>n!==void 0).forEach(([n,s])=>{(r[n]==null||r[n]==="")&&(r[n]=s)});const t=r.message||r.Message||"UnknownError";return r.message=t,delete r.Message,r},m1=r=>{switch(r){case"standard":return{retryMode:"standard",connectionTimeout:3100};case"in-region":return{retryMode:"standard",connectionTimeout:1100};case"cross-region":return{retryMode:"standard",connectionTimeout:3100};case"mobile":return{retryMode:"standard",connectionTimeout:3e4};default:return{}}},CL=r=>{const e=[];for(const t in uy){const n=uy[t];r[n]!==void 0&&e.push({algorithmId:()=>n,checksumConstructor:()=>r[n]})}return{addChecksumAlgorithm(t){e.push(t)},checksumAlgorithms(){return e}}},kL=r=>{const e={};return r.checksumAlgorithms().forEach(t=>{e[t.algorithmId()]=t.checksumConstructor()}),e},NL=r=>({setRetryStrategy(e){r.retryStrategy=e},retryStrategy(){return r.retryStrategy}}),TL=r=>{const e={};return e.retryStrategy=r.retryStrategy(),e},g1=r=>Object.assign(CL(r),NL(r)),v1=r=>Object.assign(kL(r),TL(r));class Mb{trace(){}debug(){}info(){}warn(){}error(){}}class RL{constructor(e=!1){H(this,"queryCompat");this.queryCompat=e}resolveRestContentType(e,t){const n=t.getMemberSchemas(),s=Object.values(n).find(i=>!!i.getMergedTraits().httpPayload);if(s){const i=s.getMergedTraits().mediaType;return i||(s.isStringSchema()?"text/plain":s.isBlobSchema()?"application/octet-stream":e)}else if(!t.isUnitSchema()&&Object.values(n).find(c=>{const{httpQuery:d,httpQueryParams:p,httpHeader:m,httpLabel:g,httpPrefixHeaders:x}=c.getMergedTraits();return!d&&!p&&!m&&!g&&x===void 0}))return e}async getErrorSchemaOrThrowBaseException(e,t,n,s,i,c){let d=t,p=e;e.includes("#")&&([d,p]=e.split("#"));const m={$metadata:i,$fault:n.statusCode<500?"client":"server"},g=xt.for(d);try{return{errorSchema:(c==null?void 0:c(g,p))??g.getSchema(e),errorMetadata:m}}catch{s.message=s.message??s.Message??"UnknownError";const b=xt.for("smithy.ts.sdk.synthetic."+d),S=b.getBaseException();if(S){const T=b.getErrorCtor(S)??Error;throw this.decorateServiceException(Object.assign(new T({name:p}),m),s)}throw this.decorateServiceException(Object.assign(new Error(p),m),s)}}decorateServiceException(e,t={}){if(this.queryCompat){const n=e.Message??t.Message,s=BE(e,t);n&&(s.message=n),s.Error={...s.Error,Type:s.Error.Type,Code:s.Error.Code,Message:s.Error.message??s.Error.Message??n};const i=s.$metadata.requestId;return i&&(s.RequestId=i),s}return BE(e,t)}setQueryCompatError(e,t){var s;const n=(s=t.headers)==null?void 0:s["x-amzn-query-error"];if(e!==void 0&&n!=null){const[i,c]=n.split(";"),d=Object.entries(e),p={Code:i,Type:c};Object.assign(e,p);for(const[m,g]of d)p[m==="message"?"Message":m]=g;delete p.__type,e.Error=p}}queryCompatOutput(e,t){e.Error&&(t.Error=e.Error),e.Type&&(t.Type=e.Type),e.Code&&(t.Code=e.Code)}findQueryCompatibleError(e,t){try{return e.getSchema(t)}catch{return e.find(s=>{var i;return((i=Oo.of(s).getMergedTraits().awsQueryError)==null?void 0:i[0])===t})}}}class $b{constructor(){H(this,"serdeContext")}setSerdeContext(e){this.serdeContext=e}}class AL{constructor(e,t){H(this,"from");H(this,"to");H(this,"keys");this.from=e,this.to=t,this.keys=new Set(Object.keys(this.from).filter(n=>n!=="__type"))}mark(e){this.keys.delete(e)}hasUnknown(){return this.keys.size===1&&Object.keys(this.to).length===0}writeUnknown(){if(this.hasUnknown()){const e=this.keys.values().next().value,t=this.from[e];this.to.$unknown=[e,t]}}}function IL(r,e,t){if(t!=null&&t.source){const n=t.source;if(typeof e=="number"&&(e>Number.MAX_SAFE_INTEGER||e<Number.MIN_SAFE_INTEGER||n!==String(e)))return n.includes(".")?new Ga(n,"bigDecimal"):BigInt(n)}return e}const PL=(r,e)=>Rw(r,e).then(t=>((e==null?void 0:e.utf8Encoder)??Wy)(t)),jL=(r,e)=>PL(r,e).then(t=>{if(t.length)try{return JSON.parse(t)}catch(n){throw(n==null?void 0:n.name)==="SyntaxError"&&Object.defineProperty(n,"$responseBodyText",{value:t}),n}return{}}),FL=(r,e)=>{const t=(i,c)=>Object.keys(i).find(d=>d.toLowerCase()===c.toLowerCase()),n=i=>{let c=i;return typeof c=="number"&&(c=c.toString()),c.indexOf(",")>=0&&(c=c.split(",")[0]),c.indexOf(":")>=0&&(c=c.split(":")[0]),c.indexOf("#")>=0&&(c=c.split("#")[1]),c},s=t(r.headers,"x-amzn-errortype");if(s!==void 0)return n(r.headers[s]);if(e&&typeof e=="object"){const i=t(e,"code");if(i&&e[i]!==void 0)return n(e[i]);if(e.__type!==void 0)return n(e.__type)}};class OL extends $b{constructor(t){super();H(this,"settings");this.settings=t}async read(t,n){return this._read(t,typeof n=="string"?JSON.parse(n,IL):await jL(n,this.serdeContext))}readObject(t,n){return this._read(t,n)}_read(t,n){const s=n!==null&&typeof n=="object",i=Oo.of(t);if(s){if(i.isStructSchema()){const d=n,p=i.isUnionSchema(),m={};let g;const{jsonName:x}=this.settings;x&&(g={});let b;p&&(b=new AL(d,m));for(const[S,T]of i.structIterator()){let E=S;x&&(E=T.getMergedTraits().jsonName??E,g[E]=S),p&&b.mark(E),d[E]!=null&&(m[S]=this._read(T,d[E]))}if(p)b.writeUnknown();else if(typeof d.__type=="string")for(const[S,T]of Object.entries(d)){const E=x?g[S]??S:S;E in m||(m[E]=T)}return m}if(Array.isArray(n)&&i.isListSchema()){const d=i.getValueSchema(),p=[],m=!!i.getMergedTraits().sparse;for(const g of n)(m||g!=null)&&p.push(this._read(d,g));return p}if(i.isMapSchema()){const d=i.getValueSchema(),p={},m=!!i.getMergedTraits().sparse;for(const[g,x]of Object.entries(n))(m||x!=null)&&(p[g]=this._read(d,x));return p}}if(i.isBlobSchema()&&typeof n=="string")return Zm(n);const c=i.getMergedTraits().mediaType;if(i.isStringSchema()&&typeof n=="string"&&c)return c==="application/json"||c.endsWith("+json")?zc.from(n):n;if(i.isTimestampSchema()&&n!=null)switch(UN(i,this.settings)){case 5:return YO(n);case 6:return ZO(n);case 7:return eD(n);default:return console.warn("Missing timestamp format, parsing value with Date constructor:",n),new Date(n)}if(i.isBigIntegerSchema()&&(typeof n=="number"||typeof n=="string"))return BigInt(n);if(i.isBigDecimalSchema()&&n!=null){if(n instanceof Ga)return n;const d=n;return d.type==="bigDecimal"&&"string"in d?new Ga(d.string,d.type):new Ga(String(n),"bigDecimal")}if(i.isNumericSchema()&&typeof n=="string"){switch(n){case"Infinity":return 1/0;case"-Infinity":return-1/0;case"NaN":return NaN}return n}if(i.isDocumentSchema())if(s){const d=Array.isArray(n)?[]:{};for(const[p,m]of Object.entries(n))m instanceof Ga?d[p]=m:d[p]=this._read(i,m);return d}else return structuredClone(n);return n}}const GE="";class DL{constructor(){H(this,"values",new Map);H(this,"counter",0);H(this,"stage",0)}createReplacer(){if(this.stage===1)throw new Error("@aws-sdk/core/protocols - JsonReplacer already created.");if(this.stage===2)throw new Error("@aws-sdk/core/protocols - JsonReplacer exhausted.");return this.stage=1,(e,t)=>{if(t instanceof Ga){const n=`${GE+"nv"+this.counter++}_`+t.string;return this.values.set(`"${n}"`,t.string),n}if(typeof t=="bigint"){const n=t.toString(),s=`${GE+"b"+this.counter++}_`+n;return this.values.set(`"${s}"`,n),s}return t}}replaceInJson(e){if(this.stage===0)throw new Error("@aws-sdk/core/protocols - JsonReplacer not created yet.");if(this.stage===2)throw new Error("@aws-sdk/core/protocols - JsonReplacer exhausted.");if(this.stage=2,this.counter===0)return e;for(const[t,n]of this.values)e=e.replace(t,n);return e}}class LL extends $b{constructor(t){super();H(this,"settings");H(this,"buffer");H(this,"useReplacer",!1);H(this,"rootSchema");this.settings=t}write(t,n){this.rootSchema=Oo.of(t),this.buffer=this._write(this.rootSchema,n)}writeDiscriminatedDocument(t,n){this.write(t,n),typeof this.buffer=="object"&&(this.buffer.__type=Oo.of(t).getName(!0))}flush(){const{rootSchema:t,useReplacer:n}=this;if(this.rootSchema=void 0,this.useReplacer=!1,t!=null&&t.isStructSchema()||t!=null&&t.isDocumentSchema()){if(!n)return JSON.stringify(this.buffer);const s=new DL;return s.replaceInJson(JSON.stringify(this.buffer,s.createReplacer(),0))}return this.buffer}_write(t,n,s){var d,p;const i=n!==null&&typeof n=="object",c=Oo.of(t);if(i){if(c.isStructSchema()){const m=n,g={},{jsonName:x}=this.settings;let b;x&&(b={});for(const[S,T]of c.structIterator()){const E=this._write(T,m[S],c);if(E!==void 0){let C=S;x&&(C=T.getMergedTraits().jsonName??S,b[S]=C),g[C]=E}}if(c.isUnionSchema()&&Object.keys(g).length===0){const{$unknown:S}=m;if(Array.isArray(S)){const[T,E]=S;g[T]=this._write(15,E)}}else if(typeof m.__type=="string")for(const[S,T]of Object.entries(m)){const E=x?b[S]??S:S;E in g||(g[E]=this._write(15,T))}return g}if(Array.isArray(n)&&c.isListSchema()){const m=c.getValueSchema(),g=[],x=!!c.getMergedTraits().sparse;for(const b of n)(x||b!=null)&&g.push(this._write(m,b));return g}if(c.isMapSchema()){const m=c.getValueSchema(),g={},x=!!c.getMergedTraits().sparse;for(const[b,S]of Object.entries(n))(x||S!=null)&&(g[b]=this._write(m,S));return g}if(n instanceof Uint8Array&&(c.isBlobSchema()||c.isDocumentSchema()))return c===this.rootSchema?n:(((d=this.serdeContext)==null?void 0:d.base64Encoder)??Im)(n);if(n instanceof Date&&(c.isTimestampSchema()||c.isDocumentSchema()))switch(UN(c,this.settings)){case 5:return n.toISOString().replace(".000Z","Z");case 6:return qO(n);case 7:return n.getTime()/1e3;default:return console.warn("Missing timestamp format, using epoch seconds",n),n.getTime()/1e3}n instanceof Ga&&(this.useReplacer=!0)}if(!(n===null&&(s!=null&&s.isStructSchema()))){if(c.isStringSchema()){if(typeof n>"u"&&c.isIdempotencyToken())return $N();const m=c.getMergedTraits().mediaType;return n!=null&&m&&(m==="application/json"||m.endsWith("+json"))?zc.from(n):n}if(typeof n=="number"&&c.isNumericSchema())return Math.abs(n)===1/0||isNaN(n)?String(n):n;if(typeof n=="string"&&c.isBlobSchema())return c===this.rootSchema?n:(((p=this.serdeContext)==null?void 0:p.base64Encoder)??Im)(n);if(typeof n=="bigint"&&(this.useReplacer=!0),c.isDocumentSchema())if(i){const m=Array.isArray(n)?[]:{};for(const[g,x]of Object.entries(n))x instanceof Ga?(this.useReplacer=!0,m[g]=x):m[g]=this._write(c,x);return m}else return structuredClone(n);return n}}}class ML extends $b{constructor(t){super();H(this,"settings");this.settings=t}createSerializer(){const t=new LL(this.settings);return t.setSerdeContext(this.serdeContext),t}createDeserializer(){const t=new OL(this.settings);return t.setSerdeContext(this.serdeContext),t}}class $L extends hD{constructor({defaultNamespace:t,serviceTarget:n,awsQueryCompatible:s,jsonCodec:i}){super({defaultNamespace:t});H(this,"serializer");H(this,"deserializer");H(this,"serviceTarget");H(this,"codec");H(this,"mixin");H(this,"awsQueryCompatible");this.serviceTarget=n,this.codec=i??new ML({timestampFormat:{useTrait:!0,default:7},jsonName:!1}),this.serializer=this.codec.createSerializer(),this.deserializer=this.codec.createDeserializer(),this.awsQueryCompatible=!!s,this.mixin=new RL(this.awsQueryCompatible)}async serializeRequest(t,n,s){const i=await super.serializeRequest(t,n,s);return i.path.endsWith("/")||(i.path+="/"),Object.assign(i.headers,{"content-type":`application/x-amz-json-${this.getJsonRpcVersion()}`,"x-amz-target":`${this.serviceTarget}.${t.name}`}),this.awsQueryCompatible&&(i.headers["x-amzn-query-mode"]="true"),(Yv(t.input)==="unit"||!i.body)&&(i.body="{}"),i}getPayloadCodec(){return this.codec}async handleError(t,n,s,i,c){this.awsQueryCompatible&&this.mixin.setQueryCompatError(i,s);const d=FL(s,i)??"Unknown",{errorSchema:p,errorMetadata:m}=await this.mixin.getErrorSchemaOrThrowBaseException(d,this.options.defaultNamespace,s,i,c,this.awsQueryCompatible?this.mixin.findQueryCompatibleError:void 0),g=Oo.of(p),x=i.message??i.Message??"Unknown",b=xt.for(p[1]).getErrorCtor(p)??Error,S=new b(x),T={};for(const[E,C]of g.structIterator())i[E]!=null&&(T[E]=this.codec.createDeserializer().readObject(C,i[E]));throw this.awsQueryCompatible&&this.mixin.queryCompatOutput(i,T),this.mixin.decorateServiceException(Object.assign(S,m,{$fault:g.getMergedTraits().error,message:x},T),i)}}class y1 extends $L{constructor({defaultNamespace:e,serviceTarget:t,awsQueryCompatible:n,jsonCodec:s}){super({defaultNamespace:e,serviceTarget:t,awsQueryCompatible:n,jsonCodec:s})}getShapeId(){return"aws.protocols#awsJson1_1"}getJsonRpcVersion(){return"1.1"}getDefaultContentType(){return"application/x-amz-json-1.1"}}const UL=/\d{12}\.ddb/;async function zL(r,e,t){var i,c,d,p,m,g,x;const n=t.request;if(((i=n==null?void 0:n.headers)==null?void 0:i["smithy-protocol"])==="rpc-v2-cbor"&&Fa(r,"PROTOCOL_RPC_V2_CBOR","M"),typeof e.retryStrategy=="function"){const b=await e.retryStrategy();typeof b.acquireInitialRetryToken=="function"?(d=(c=b.constructor)==null?void 0:c.name)!=null&&d.includes("Adaptive")?Fa(r,"RETRY_MODE_ADAPTIVE","F"):Fa(r,"RETRY_MODE_STANDARD","E"):Fa(r,"RETRY_MODE_LEGACY","D")}if(typeof e.accountIdEndpointMode=="function"){const b=r.endpointV2;switch(String((p=b==null?void 0:b.url)==null?void 0:p.hostname).match(UL)&&Fa(r,"ACCOUNT_ID_ENDPOINT","O"),await((m=e.accountIdEndpointMode)==null?void 0:m.call(e))){case"disabled":Fa(r,"ACCOUNT_ID_MODE_DISABLED","Q");break;case"preferred":Fa(r,"ACCOUNT_ID_MODE_PREFERRED","P");break;case"required":Fa(r,"ACCOUNT_ID_MODE_REQUIRED","R");break}}const s=(x=(g=r.__smithy_context)==null?void 0:g.selectedHttpAuthScheme)==null?void 0:x.identity;if(s!=null&&s.$source){const b=s;b.accountId&&Fa(r,"RESOLVED_ACCOUNT_ID","T");for(const[S,T]of Object.entries(b.$source??{}))Fa(r,S,T)}}const WE="user-agent",Ax="x-amz-user-agent",VE=" ",Ix="/",HL=/[^!$%&'*+\-.^_`|~\w]/g,BL=/[^!$%&'*+\-.^_`|~\w#]/g,qE="-",GL=1024;function WL(r){let e="";for(const t in r){const n=r[t];if(e.length+n.length+1<=GL){e.length?e+=","+n:e+=n;continue}break}return e}const VL=r=>(e,t)=>async n=>{var S,T,E,C;const{request:s}=n;if(!li.isInstance(s))return e(n);const{headers:i}=s,c=((S=t==null?void 0:t.userAgent)==null?void 0:S.map(Tv))||[],d=(await r.defaultUserAgentProvider()).map(Tv);await zL(t,r,n);const p=t;d.push(`m/${WL(Object.assign({},(T=t.__smithy_context)==null?void 0:T.features,(E=p.__aws_sdk_context)==null?void 0:E.features))}`);const m=((C=r==null?void 0:r.customUserAgent)==null?void 0:C.map(Tv))||[],g=await r.userAgentAppId();g&&d.push(Tv(["app",`${g}`]));const x=[].concat([...d,...c,...m]).join(VE),b=[...d.filter(R=>R.startsWith("aws-sdk-")),...m].join(VE);return r.runtime!=="browser"?(b&&(i[Ax]=i[Ax]?`${i[WE]} ${b}`:b),i[WE]=x):i[Ax]=x,e({...n,request:s})},Tv=r=>{var c;const e=r[0].split(Ix).map(d=>d.replace(HL,qE)).join(Ix),t=(c=r[1])==null?void 0:c.replace(BL,qE),n=e.indexOf(Ix),s=e.substring(0,n);let i=e.substring(n+1);return s==="api"&&(i=i.toLowerCase()),[s,i,t].filter(d=>d&&d.length>0).reduce((d,p,m)=>{switch(m){case 0:return p;case 1:return`${d}/${p}`;default:return`${d}#${p}`}},"")},qL={name:"getUserAgentMiddleware",step:"build",priority:"low",tags:["SET_USER_AGENT","USER_AGENT"],override:!0},x1=r=>({applyToStack:e=>{e.add(VL(r),qL)}}),w1=!1,b1=!1,KE=new Set,KL=(r,e=eg)=>{if(!KE.has(r)&&!e(r))if(r==="*")console.warn('@smithy/config-resolver WARN - Please use the caller region instead of "*". See "sigv4a" in https://github.com/aws/aws-sdk-js-v3/blob/main/supplemental-docs/CLIENTS.md.');else throw new Error(`Region not accepted: region="${r}" is not a valid hostname component.`);else KE.add(r)},_1=r=>typeof r=="string"&&(r.startsWith("fips-")||r.endsWith("-fips")),YL=r=>_1(r)?["fips-aws-global","aws-fips"].includes(r)?"us-east-1":r.replace(/fips-(dkr-|prod-)?|-fips/,""):r,S1=r=>{const{region:e,useFipsEndpoint:t}=r;if(!e)throw new Error("Region is missing");return Object.assign(r,{region:async()=>{const n=typeof e=="function"?await e():e,s=YL(n);return KL(s),s},useFipsEndpoint:async()=>{const n=typeof e=="string"?e:await e();return _1(n)?!0:typeof t!="function"?Promise.resolve(!!t):t()}})},YE="content-length";function JL(r){return e=>async t=>{const n=t.request;if(li.isInstance(n)){const{body:s,headers:i}=n;if(s&&Object.keys(i).map(c=>c.toLowerCase()).indexOf(YE)===-1)try{const c=r(s);n.headers={...n.headers,[YE]:String(c)}}catch{}}return e({...t,request:n})}}const XL={step:"build",tags:["SET_CONTENT_LENGTH","CONTENT_LENGTH"],name:"contentLengthMiddleware",override:!0},E1=r=>({applyToStack:e=>{e.add(JL(r.bodyLengthChecker),XL)}}),QL=async r=>{const e=(r==null?void 0:r.Bucket)||"";if(typeof r.Bucket=="string"&&(r.Bucket=e.replace(/#/g,encodeURIComponent("#")).replace(/\?/g,encodeURIComponent("?"))),nM(e)){if(r.ForcePathStyle===!0)throw new Error("Path-style addressing cannot be used with ARN buckets")}else(!rM(e)||e.indexOf(".")!==-1&&!String(r.Endpoint).startsWith("http:")||e.toLowerCase()!==e||e.length<3)&&(r.ForcePathStyle=!0);return r.DisableMultiRegionAccessPoints&&(r.disableMultiRegionAccessPoints=!0,r.DisableMRAP=!0),r},ZL=/^[a-z0-9][a-z0-9\.\-]{1,61}[a-z0-9]$/,eM=/(\d+\.){3}\d+/,tM=/\.\./,rM=r=>ZL.test(r)&&!eM.test(r)&&!tM.test(r),nM=r=>{const[e,t,n,,,s]=r.split(":"),i=e==="arn"&&r.split(":").length>=6,c=!!(i&&t&&n&&s);if(i&&!c)throw new Error(`Invalid ARN: ${r} was an invalid ARN.`);return c},sM=(r,e,t,n=!1)=>{const s=async()=>{let i;if(n){const c=t.clientContextParams;i=(c==null?void 0:c[r])??t[r]??t[e]}else i=t[r]??t[e];return typeof i=="function"?i():i};return r==="credentialScope"||e==="CredentialScope"?async()=>{const i=typeof t.credentials=="function"?await t.credentials():t.credentials;return(i==null?void 0:i.credentialScope)??(i==null?void 0:i.CredentialScope)}:r==="accountId"||e==="AccountId"?async()=>{const i=typeof t.credentials=="function"?await t.credentials():t.credentials;return(i==null?void 0:i.accountId)??(i==null?void 0:i.AccountId)}:r==="endpoint"||e==="endpoint"?async()=>{if(t.isCustomEndpoint===!1)return;const i=await s();if(i&&typeof i=="object"){if("url"in i)return i.url.href;if("hostname"in i){const{protocol:c,hostname:d,port:p,path:m}=i;return`${c}//${d}${p?":"+p:""}${m}`}}return i}:s},C1=async r=>{},k1=r=>typeof r=="object"?"url"in r?Fm(r.url):r:Fm(r),oM=async(r,e,t,n)=>{if(!t.isCustomEndpoint){let c;t.serviceConfiguredEndpoint?c=await t.serviceConfiguredEndpoint():c=await C1(t.serviceId),c&&(t.endpoint=()=>Promise.resolve(k1(c)),t.isCustomEndpoint=!0)}const s=await iM(r,e,t);if(typeof t.endpointProvider!="function")throw new Error("config.endpointProvider is not set.");return t.endpointProvider(s,n)},iM=async(r,e,t)=>{var i;const n={},s=((i=e==null?void 0:e.getEndpointParameterInstructions)==null?void 0:i.call(e))||{};for(const[c,d]of Object.entries(s))switch(d.type){case"staticContextParams":n[c]=d.value;break;case"contextParams":n[c]=r[d.name];break;case"clientContextParams":case"builtInParams":n[c]=await sM(d.name,c,t,d.type!=="builtInParams")();break;case"operationContextParams":n[c]=d.get(r);break;default:throw new Error("Unrecognized endpoint parameter instruction: "+JSON.stringify(d))}return Object.keys(s).length===0&&Object.assign(n,t),String(t.serviceId).toLowerCase()==="s3"&&await QL(n),n},aM=({config:r,instructions:e})=>(t,n)=>async s=>{var d,p,m;r.isCustomEndpoint&&pD(n,"ENDPOINT_OVERRIDE","N");const i=await oM(s.input,{getEndpointParameterInstructions(){return e}},{...r},n);n.endpointV2=i,n.authSchemes=(d=i.properties)==null?void 0:d.authSchemes;const c=(p=n.authSchemes)==null?void 0:p[0];if(c){n.signing_region=c.signingRegion,n.signing_service=c.signingName;const g=pd(n),x=(m=g==null?void 0:g.selectedHttpAuthScheme)==null?void 0:m.httpAuthOption;x&&(x.signingProperties=Object.assign(x.signingProperties||{},{signing_region:c.signingRegion,signingRegion:c.signingRegion,signing_service:c.signingName,signingName:c.signingName,signingRegionSet:c.signingRegionSet},c.properties))}return t({...s})},lM={step:"serialize",tags:["ENDPOINT_PARAMETERS","ENDPOINT_V2","ENDPOINT"],name:"endpointV2Middleware",override:!0,relation:"before",toMiddleware:yO.name},cM=(r,e)=>({applyToStack:t=>{t.addRelativeTo(aM({config:r,instructions:e}),lM)}}),N1=r=>{const e=r.tls??!0,{endpoint:t,useDualstackEndpoint:n,useFipsEndpoint:s}=r,i=t!=null?async()=>k1(await sa(t)()):void 0,d=Object.assign(r,{endpoint:i,tls:e,isCustomEndpoint:!!t,useDualstackEndpoint:sa(n??!1),useFipsEndpoint:sa(s??!1)});let p;return d.serviceConfiguredEndpoint=async()=>(r.serviceId&&!p&&(p=C1(r.serviceId)),p),d};var fh;(function(r){r.STANDARD="standard",r.ADAPTIVE="adaptive"})(fh||(fh={}));const Om=3,T1=fh.STANDARD,uM=["BandwidthLimitExceeded","EC2ThrottledException","LimitExceededException","PriorRequestNotComplete","ProvisionedThroughputExceededException","RequestLimitExceeded","RequestThrottled","RequestThrottledException","SlowDown","ThrottledException","Throttling","ThrottlingException","TooManyRequestsException","TransactionInProgressException"],dM=["TimeoutError","RequestTimeout","RequestTimeoutException"],fM=[500,502,503,504],hM=["ECONNRESET","ECONNREFUSED","EPIPE","ETIMEDOUT"],pM=["EHOSTUNREACH","ENETUNREACH","ENOTFOUND"],mM=r=>(r==null?void 0:r.$retryable)!==void 0,gM=r=>{var e;return(e=r.$metadata)==null?void 0:e.clockSkewCorrected},vM=r=>{const e=new Set(["Failed to fetch","NetworkError when attempting to fetch resource","The Internet connection appears to be offline","Load failed","Network request failed"]);return r&&r instanceof TypeError?e.has(r.message):!1},R1=r=>{var e,t;return((e=r.$metadata)==null?void 0:e.httpStatusCode)===429||uM.includes(r.name)||((t=r.$retryable)==null?void 0:t.throttling)==!0},Ub=(r,e=0)=>{var t;return mM(r)||gM(r)||dM.includes(r.name)||hM.includes((r==null?void 0:r.code)||"")||pM.includes((r==null?void 0:r.code)||"")||fM.includes(((t=r.$metadata)==null?void 0:t.httpStatusCode)||0)||vM(r)||r.cause!==void 0&&e<=10&&Ub(r.cause,e+1)},yM=r=>{var e;if(((e=r.$metadata)==null?void 0:e.httpStatusCode)!==void 0){const t=r.$metadata.httpStatusCode;return 500<=t&&t<=599&&!Ub(r)}return!1},Gy=class Gy{constructor(e){H(this,"beta");H(this,"minCapacity");H(this,"minFillRate");H(this,"scaleConstant");H(this,"smooth");H(this,"currentCapacity",0);H(this,"enabled",!1);H(this,"lastMaxRate",0);H(this,"measuredTxRate",0);H(this,"requestCount",0);H(this,"fillRate");H(this,"lastThrottleTime");H(this,"lastTimestamp",0);H(this,"lastTxRateBucket");H(this,"maxCapacity");H(this,"timeWindow",0);this.beta=(e==null?void 0:e.beta)??.7,this.minCapacity=(e==null?void 0:e.minCapacity)??1,this.minFillRate=(e==null?void 0:e.minFillRate)??.5,this.scaleConstant=(e==null?void 0:e.scaleConstant)??.4,this.smooth=(e==null?void 0:e.smooth)??.8;const t=this.getCurrentTimeInSeconds();this.lastThrottleTime=t,this.lastTxRateBucket=Math.floor(this.getCurrentTimeInSeconds()),this.fillRate=this.minFillRate,this.maxCapacity=this.minCapacity}getCurrentTimeInSeconds(){return Date.now()/1e3}async getSendToken(){return this.acquireTokenBucket(1)}async acquireTokenBucket(e){if(this.enabled){if(this.refillTokenBucket(),e>this.currentCapacity){const t=(e-this.currentCapacity)/this.fillRate*1e3;await new Promise(n=>Gy.setTimeoutFn(n,t))}this.currentCapacity=this.currentCapacity-e}}refillTokenBucket(){const e=this.getCurrentTimeInSeconds();if(!this.lastTimestamp){this.lastTimestamp=e;return}const t=(e-this.lastTimestamp)*this.fillRate;this.currentCapacity=Math.min(this.maxCapacity,this.currentCapacity+t),this.lastTimestamp=e}updateClientSendingRate(e){let t;if(this.updateMeasuredRate(),R1(e)){const s=this.enabled?Math.min(this.measuredTxRate,this.fillRate):this.measuredTxRate;this.lastMaxRate=s,this.calculateTimeWindow(),this.lastThrottleTime=this.getCurrentTimeInSeconds(),t=this.cubicThrottle(s),this.enableTokenBucket()}else this.calculateTimeWindow(),t=this.cubicSuccess(this.getCurrentTimeInSeconds());const n=Math.min(t,2*this.measuredTxRate);this.updateTokenBucketRate(n)}calculateTimeWindow(){this.timeWindow=this.getPrecise(Math.pow(this.lastMaxRate*(1-this.beta)/this.scaleConstant,1/3))}cubicThrottle(e){return this.getPrecise(e*this.beta)}cubicSuccess(e){return this.getPrecise(this.scaleConstant*Math.pow(e-this.lastThrottleTime-this.timeWindow,3)+this.lastMaxRate)}enableTokenBucket(){this.enabled=!0}updateTokenBucketRate(e){this.refillTokenBucket(),this.fillRate=Math.max(e,this.minFillRate),this.maxCapacity=Math.max(e,this.minCapacity),this.currentCapacity=Math.min(this.currentCapacity,this.maxCapacity)}updateMeasuredRate(){const e=this.getCurrentTimeInSeconds(),t=Math.floor(e*2)/2;if(this.requestCount++,t>this.lastTxRateBucket){const n=this.requestCount/(t-this.lastTxRateBucket);this.measuredTxRate=this.getPrecise(n*this.smooth+this.measuredTxRate*(1-this.smooth)),this.requestCount=0,this.lastTxRateBucket=t}}getPrecise(e){return parseFloat(e.toFixed(8))}};H(Gy,"setTimeoutFn",setTimeout);let Fw=Gy;const Ow=100,A1=20*1e3,xM=500,JE=500,wM=5,bM=10,_M=1,SM="amz-sdk-invocation-id",EM="amz-sdk-request",CM=()=>{let r=Ow;return{computeNextBackoffDelay:n=>Math.floor(Math.min(A1,Math.random()*2**n*r)),setDelayBase:n=>{r=n}}},XE=({retryDelay:r,retryCount:e,retryCost:t})=>({getRetryCount:()=>e,getRetryDelay:()=>Math.min(A1,r),getRetryCost:()=>t});class I1{constructor(e){H(this,"maxAttempts");H(this,"mode",fh.STANDARD);H(this,"capacity",JE);H(this,"retryBackoffStrategy",CM());H(this,"maxAttemptsProvider");this.maxAttempts=e,this.maxAttemptsProvider=typeof e=="function"?e:async()=>e}async acquireInitialRetryToken(e){return XE({retryDelay:Ow,retryCount:0})}async refreshRetryTokenForRetry(e,t){const n=await this.getMaxAttempts();if(this.shouldRetry(e,t,n)){const s=t.errorType;this.retryBackoffStrategy.setDelayBase(s==="THROTTLING"?xM:Ow);const i=this.retryBackoffStrategy.computeNextBackoffDelay(e.getRetryCount()),c=t.retryAfterHint?Math.max(t.retryAfterHint.getTime()-Date.now()||0,i):i,d=this.getCapacityCost(s);return this.capacity-=d,XE({retryDelay:c,retryCount:e.getRetryCount()+1,retryCost:d})}throw new Error("No retry token available")}recordSuccess(e){this.capacity=Math.max(JE,this.capacity+(e.getRetryCost()??_M))}getCapacity(){return this.capacity}async getMaxAttempts(){try{return await this.maxAttemptsProvider()}catch{return console.warn(`Max attempts provider could not resolve. Using default of ${Om}`),Om}}shouldRetry(e,t,n){return e.getRetryCount()+1<n&&this.capacity>=this.getCapacityCost(t.errorType)&&this.isRetryableError(t.errorType)}getCapacityCost(e){return e==="TRANSIENT"?bM:wM}isRetryableError(e){return e==="THROTTLING"||e==="TRANSIENT"}}class kM{constructor(e,t){H(this,"maxAttemptsProvider");H(this,"rateLimiter");H(this,"standardRetryStrategy");H(this,"mode",fh.ADAPTIVE);this.maxAttemptsProvider=e;const{rateLimiter:n}=t??{};this.rateLimiter=n??new Fw,this.standardRetryStrategy=new I1(e)}async acquireInitialRetryToken(e){return await this.rateLimiter.getSendToken(),this.standardRetryStrategy.acquireInitialRetryToken(e)}async refreshRetryTokenForRetry(e,t){return this.rateLimiter.updateClientSendingRate(t),this.standardRetryStrategy.refreshRetryTokenForRetry(e,t)}recordSuccess(e){this.rateLimiter.updateClientSendingRate({}),this.standardRetryStrategy.recordSuccess(e)}}const NM=r=>r instanceof Error?r:r instanceof Object?Object.assign(new Error,r):typeof r=="string"?new Error(r):new Error(`AWS SDK error wrapper for ${r}`),P1=r=>{const{retryStrategy:e,retryMode:t,maxAttempts:n}=r,s=sa(n??Om);return Object.assign(r,{maxAttempts:s,retryStrategy:async()=>e||(await sa(t)()===fh.ADAPTIVE?new kM(s):new I1(s))})},TM=r=>(r==null?void 0:r.body)instanceof ReadableStream,RM=r=>(e,t)=>async n=>{var c;let s=await r.retryStrategy();const i=await r.maxAttempts();if(AM(s)){s=s;let d=await s.acquireInitialRetryToken(t.partition_id),p=new Error,m=0,g=0;const{request:x}=n,b=li.isInstance(x);for(b&&(x.headers[SM]=$N());;)try{b&&(x.headers[EM]=`attempt=${m+1}; max=${i}`);const{response:S,output:T}=await e(n);return s.recordSuccess(d),T.$metadata.attempts=m+1,T.$metadata.totalRetryDelay=g,{response:S,output:T}}catch(S){const T=IM(S);if(p=NM(S),b&&TM(x))throw(c=t.logger instanceof Mb?console:t.logger)==null||c.warn("An error was encountered in a non-retryable streaming request."),p;try{d=await s.refreshRetryTokenForRetry(d,T)}catch{throw p.$metadata||(p.$metadata={}),p.$metadata.attempts=m+1,p.$metadata.totalRetryDelay=g,p}m=d.getRetryCount();const E=d.getRetryDelay();g+=E,await new Promise(C=>setTimeout(C,E))}}else return s=s,s!=null&&s.mode&&(t.userAgent=[...t.userAgent||[],["cfg/retry-mode",s.mode]]),s.retry(e,n)},AM=r=>typeof r.acquireInitialRetryToken<"u"&&typeof r.refreshRetryTokenForRetry<"u"&&typeof r.recordSuccess<"u",IM=r=>{const e={error:r,errorType:PM(r)},t=FM(r.$response);return t&&(e.retryAfterHint=t),e},PM=r=>R1(r)?"THROTTLING":Ub(r)?"TRANSIENT":yM(r)?"SERVER_ERROR":"CLIENT_ERROR",jM={name:"retryMiddleware",tags:["RETRY"],step:"finalizeRequest",priority:"high",override:!0},j1=r=>({applyToStack:e=>{e.add(RM(r),jM)}}),FM=r=>{if(!uh.isInstance(r))return;const e=Object.keys(r.headers).find(i=>i.toLowerCase()==="retry-after");if(!e)return;const t=r.headers[e],n=Number(t);return Number.isNaN(n)?new Date(t):new Date(n*1e3)},OM=async(r,e,t)=>({operation:pd(e).operation,region:await sa(r.region)()||(()=>{throw new Error("expected `region` to be configured for `aws.auth#sigv4`")})()});function DM(r){return{schemeId:"aws.auth#sigv4",signingProperties:{name:"cognito-idp",region:r.region},propertiesExtractor:(e,t)=>({signingProperties:{config:e,context:t}})}}function Rr(r){return{schemeId:"smithy.api#noAuth"}}const LM=r=>{const e=[];switch(r.operation){case"AssociateSoftwareToken":{e.push(Rr());break}case"ChangePassword":{e.push(Rr());break}case"CompleteWebAuthnRegistration":{e.push(Rr());break}case"ConfirmDevice":{e.push(Rr());break}case"ConfirmForgotPassword":{e.push(Rr());break}case"ConfirmSignUp":{e.push(Rr());break}case"DeleteUser":{e.push(Rr());break}case"DeleteUserAttributes":{e.push(Rr());break}case"DeleteWebAuthnCredential":{e.push(Rr());break}case"ForgetDevice":{e.push(Rr());break}case"ForgotPassword":{e.push(Rr());break}case"GetDevice":{e.push(Rr());break}case"GetTokensFromRefreshToken":{e.push(Rr());break}case"GetUser":{e.push(Rr());break}case"GetUserAttributeVerificationCode":{e.push(Rr());break}case"GetUserAuthFactors":{e.push(Rr());break}case"GlobalSignOut":{e.push(Rr());break}case"InitiateAuth":{e.push(Rr());break}case"ListDevices":{e.push(Rr());break}case"ListWebAuthnCredentials":{e.push(Rr());break}case"ResendConfirmationCode":{e.push(Rr());break}case"RespondToAuthChallenge":{e.push(Rr());break}case"RevokeToken":{e.push(Rr());break}case"SetUserMFAPreference":{e.push(Rr());break}case"SetUserSettings":{e.push(Rr());break}case"SignUp":{e.push(Rr());break}case"StartWebAuthnRegistration":{e.push(Rr());break}case"UpdateAuthEventFeedback":{e.push(Rr());break}case"UpdateDeviceStatus":{e.push(Rr());break}case"UpdateUserAttributes":{e.push(Rr());break}case"VerifySoftwareToken":{e.push(Rr());break}case"VerifyUserAttribute":{e.push(Rr());break}default:e.push(DM(r))}return e},MM=r=>{const e=d1(r);return Object.assign(e,{authSchemePreference:sa(r.authSchemePreference??[])})},$M=r=>Object.assign(r,{useDualstackEndpoint:r.useDualstackEndpoint??!1,useFipsEndpoint:r.useFipsEndpoint??!1,defaultSigningName:"cognito-idp"}),UM={UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}},zM="3.981.0",HM={version:zM},BM=r=>new TextEncoder().encode(r);var GM=typeof Buffer<"u"&&Buffer.from?function(r){return Buffer.from(r,"utf8")}:BM;function Dm(r){return r instanceof Uint8Array?r:typeof r=="string"?GM(r):ArrayBuffer.isView(r)?new Uint8Array(r.buffer,r.byteOffset,r.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(r)}function Dw(r){return typeof r=="string"?r.length===0:r.byteLength===0}var F1={name:"SHA-256"},QE={name:"HMAC",hash:F1},WM=new Uint8Array([227,176,196,66,152,252,28,20,154,251,244,200,153,111,185,36,39,174,65,228,100,155,147,76,164,149,153,27,120,82,184,85]);const VM={};function Xv(){return typeof window<"u"?window:typeof self<"u"?self:VM}var qM=(function(){function r(e){this.toHash=new Uint8Array(0),this.secret=e,this.reset()}return r.prototype.update=function(e){if(!Dw(e)){var t=Dm(e),n=new Uint8Array(this.toHash.byteLength+t.byteLength);n.set(this.toHash,0),n.set(t,this.toHash.byteLength),this.toHash=n}},r.prototype.digest=function(){var e=this;return this.key?this.key.then(function(t){return Xv().crypto.subtle.sign(QE,t,e.toHash).then(function(n){return new Uint8Array(n)})}):Dw(this.toHash)?Promise.resolve(WM):Promise.resolve().then(function(){return Xv().crypto.subtle.digest(F1,e.toHash)}).then(function(t){return Promise.resolve(new Uint8Array(t))})},r.prototype.reset=function(){var e=this;this.toHash=new Uint8Array(0),this.secret&&this.secret!==void 0&&(this.key=new Promise(function(t,n){Xv().crypto.subtle.importKey("raw",Dm(e.secret),QE,!1,["sign"]).then(t,n)}),this.key.catch(function(){}))},r})(),Ua=function(){return Ua=Object.assign||function(e){for(var t,n=1,s=arguments.length;n<s;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},Ua.apply(this,arguments)};function O1(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(r);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(r,n[s])&&(t[n[s]]=r[n[s]]);return t}function KM(r,e,t,n){function s(i){return i instanceof t?i:new t(function(c){c(i)})}return new(t||(t=Promise))(function(i,c){function d(g){try{m(n.next(g))}catch(x){c(x)}}function p(g){try{m(n.throw(g))}catch(x){c(x)}}function m(g){g.done?i(g.value):s(g.value).then(d,p)}m((n=n.apply(r,e||[])).next())})}function YM(r,e){var t={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,c=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return c.next=d(0),c.throw=d(1),c.return=d(2),typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function d(m){return function(g){return p([m,g])}}function p(m){if(n)throw new TypeError("Generator is already executing.");for(;c&&(c=0,m[0]&&(t=0)),t;)try{if(n=1,s&&(i=m[0]&2?s.return:m[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,m[1])).done)return i;switch(s=0,i&&(m=[m[0]&2,i.value]),m[0]){case 0:case 1:i=m;break;case 4:return t.label++,{value:m[1],done:!1};case 5:t.label++,s=m[1],m=[0];continue;case 7:m=t.ops.pop(),t.trys.pop();continue;default:if(i=t.trys,!(i=i.length>0&&i[i.length-1])&&(m[0]===6||m[0]===2)){t=0;continue}if(m[0]===3&&(!i||m[1]>i[0]&&m[1]<i[3])){t.label=m[1];break}if(m[0]===6&&t.label<i[1]){t.label=i[1],i=m;break}if(i&&t.label<i[2]){t.label=i[2],t.ops.push(m);break}i[2]&&t.ops.pop(),t.trys.pop();continue}m=e.call(r,t)}catch(g){m=[6,g],s=0}finally{n=i=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}}function JM(r,e,t){if(t||arguments.length===2)for(var n=0,s=e.length,i;n<s;n++)(i||!(n in e))&&(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return r.concat(i||Array.prototype.slice.call(e))}var Ii=64,XM=32,QM=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),ZM=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],e$=Math.pow(2,53)-1,Qv=(function(){function r(){this.state=Int32Array.from(ZM),this.temp=new Int32Array(64),this.buffer=new Uint8Array(64),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}return r.prototype.update=function(e){if(this.finished)throw new Error("Attempted to update an already finished hash.");var t=0,n=e.byteLength;if(this.bytesHashed+=n,this.bytesHashed*8>e$)throw new Error("Cannot hash more than 2^53 - 1 bits");for(;n>0;)this.buffer[this.bufferLength++]=e[t++],n--,this.bufferLength===Ii&&(this.hashBuffer(),this.bufferLength=0)},r.prototype.digest=function(){if(!this.finished){var e=this.bytesHashed*8,t=new DataView(this.buffer.buffer,this.buffer.byteOffset,this.buffer.byteLength),n=this.bufferLength;if(t.setUint8(this.bufferLength++,128),n%Ii>=Ii-8){for(var s=this.bufferLength;s<Ii;s++)t.setUint8(s,0);this.hashBuffer(),this.bufferLength=0}for(var s=this.bufferLength;s<Ii-8;s++)t.setUint8(s,0);t.setUint32(Ii-8,Math.floor(e/4294967296),!0),t.setUint32(Ii-4,e),this.hashBuffer(),this.finished=!0}for(var i=new Uint8Array(XM),s=0;s<8;s++)i[s*4]=this.state[s]>>>24&255,i[s*4+1]=this.state[s]>>>16&255,i[s*4+2]=this.state[s]>>>8&255,i[s*4+3]=this.state[s]>>>0&255;return i},r.prototype.hashBuffer=function(){for(var e=this,t=e.buffer,n=e.state,s=n[0],i=n[1],c=n[2],d=n[3],p=n[4],m=n[5],g=n[6],x=n[7],b=0;b<Ii;b++){if(b<16)this.temp[b]=(t[b*4]&255)<<24|(t[b*4+1]&255)<<16|(t[b*4+2]&255)<<8|t[b*4+3]&255;else{var S=this.temp[b-2],T=(S>>>17|S<<15)^(S>>>19|S<<13)^S>>>10;S=this.temp[b-15];var E=(S>>>7|S<<25)^(S>>>18|S<<14)^S>>>3;this.temp[b]=(T+this.temp[b-7]|0)+(E+this.temp[b-16]|0)}var C=(((p>>>6|p<<26)^(p>>>11|p<<21)^(p>>>25|p<<7))+(p&m^~p&g)|0)+(x+(QM[b]+this.temp[b]|0)|0)|0,R=((s>>>2|s<<30)^(s>>>13|s<<19)^(s>>>22|s<<10))+(s&i^s&c^i&c)|0;x=g,g=m,m=p,p=d+C|0,d=c,c=i,i=s,s=C+R|0}n[0]+=s,n[1]+=i,n[2]+=c,n[3]+=d,n[4]+=p,n[5]+=m,n[6]+=g,n[7]+=x},r})(),t$=(function(){function r(e){this.secret=e,this.hash=new Qv,this.reset()}return r.prototype.update=function(e){if(!(Dw(e)||this.error))try{this.hash.update(Dm(e))}catch(t){this.error=t}},r.prototype.digestSync=function(){if(this.error)throw this.error;return this.outer?(this.outer.finished||this.outer.update(this.hash.digest()),this.outer.digest()):this.hash.digest()},r.prototype.digest=function(){return KM(this,void 0,void 0,function(){return YM(this,function(e){return[2,this.digestSync()]})})},r.prototype.reset=function(){if(this.hash=new Qv,this.secret){this.outer=new Qv;var e=r$(this.secret),t=new Uint8Array(Ii);t.set(e);for(var n=0;n<Ii;n++)e[n]^=54,t[n]^=92;this.hash.update(e),this.outer.update(t);for(var n=0;n<e.byteLength;n++)e[n]=0}},r})();function r$(r){var e=Dm(r);if(e.byteLength>Ii){var t=new Qv;t.update(e),e=t.digest()}var n=new Uint8Array(Ii);return n.set(e),n}var n$=["decrypt","digest","encrypt","exportKey","generateKey","importKey","sign","verify"];function s$(r){if(o$(r)&&typeof r.crypto.subtle=="object"){var e=r.crypto.subtle;return i$(e)}return!1}function o$(r){if(typeof r=="object"&&typeof r.crypto=="object"){var e=r.crypto.getRandomValues;return typeof e=="function"}return!1}function i$(r){return r&&n$.every(function(e){return typeof r[e]=="function"})}var D1=(function(){function r(e){s$(Xv())?this.hash=new qM(e):this.hash=new t$(e)}return r.prototype.update=function(e,t){this.hash.update(Dm(e))},r.prototype.digest=function(){return this.hash.digest()},r.prototype.reset=function(){this.hash.reset()},r})();const L1=({serviceId:r,clientVersion:e})=>async t=>{var S,T,E;const n=typeof window<"u"?window.navigator:void 0,s=(n==null?void 0:n.userAgent)??"",i=((S=n==null?void 0:n.userAgentData)==null?void 0:S.platform)??ZE.os(s)??"other",c=void 0,d=((T=n==null?void 0:n.userAgentData)==null?void 0:T.brands)??[],p=d[d.length-1],m=(p==null?void 0:p.brand)??ZE.browser(s)??"unknown",g=(p==null?void 0:p.version)??"unknown",x=[["aws-sdk-js",e],["ua","2.1"],[`os/${i}`,c],["lang/js"],["md/browser",`${m}_${g}`]];r&&x.push([`api/${r}`,e]);const b=await((E=t==null?void 0:t.userAgentAppId)==null?void 0:E.call(t));return b&&x.push([`app/${b}`]),x},ZE={os(r){if(/iPhone|iPad|iPod/.test(r))return"iOS";if(/Macintosh|Mac OS X/.test(r))return"macOS";if(/Windows NT/.test(r))return"Windows";if(/Android/.test(r))return"Android";if(/Linux/.test(r))return"Linux"},browser(r){if(/EdgiOS|EdgA|Edg\//.test(r))return"Microsoft Edge";if(/Firefox\//.test(r))return"Firefox";if(/Chrome\//.test(r))return"Chrome";if(/Safari\//.test(r))return"Safari"}},M1=r=>()=>Promise.reject(r),a$=["in-region","cross-region","mobile","standard","legacy"],$1=({defaultsMode:r}={})=>JD(async()=>{const e=typeof r=="function"?await r():r;switch(e==null?void 0:e.toLowerCase()){case"auto":return Promise.resolve(l$()?"mobile":"standard");case"mobile":case"in-region":case"cross-region":case"standard":case"legacy":return Promise.resolve(e==null?void 0:e.toLocaleLowerCase());case void 0:return Promise.resolve("legacy");default:throw new Error(`Invalid parameter for "defaultsMode", expect ${a$.join(", ")}, got ${e}`)}}),l$=()=>{var e;const r=window==null?void 0:window.navigator;if(r!=null&&r.connection){const{effectiveType:t,rtt:n,downlink:s}=r==null?void 0:r.connection;if(typeof t=="string"&&t!=="4g"||Number(n)>100||Number(s)<10)return!0}return((e=r==null?void 0:r.userAgentData)==null?void 0:e.mobile)||typeof(r==null?void 0:r.maxTouchPoints)=="number"&&(r==null?void 0:r.maxTouchPoints)>1},U1=(r,e=!1)=>{if(e){for(const t of r.split("."))if(!U1(t))return!1;return!0}return!(!eg(r)||r.length<3||r.length>63||r!==r.toLowerCase()||Ob(r))},eC=":",c$="/",u$=r=>{const e=r.split(eC);if(e.length<6)return null;const[t,n,s,i,c,...d]=e;if(t!=="arn"||n===""||s===""||d.join(eC)==="")return null;const p=d.map(m=>m.split(c$)).flat();return{partition:n,service:s,region:i,accountId:c,resourceId:p}},d$=[{id:"aws",outputs:{dnsSuffix:"amazonaws.com",dualStackDnsSuffix:"api.aws",implicitGlobalRegion:"us-east-1",name:"aws",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^(us|eu|ap|sa|ca|me|af|il|mx)\\-\\w+\\-\\d+$",regions:{"af-south-1":{description:"Africa (Cape Town)"},"ap-east-1":{description:"Asia Pacific (Hong Kong)"},"ap-east-2":{description:"Asia Pacific (Taipei)"},"ap-northeast-1":{description:"Asia Pacific (Tokyo)"},"ap-northeast-2":{description:"Asia Pacific (Seoul)"},"ap-northeast-3":{description:"Asia Pacific (Osaka)"},"ap-south-1":{description:"Asia Pacific (Mumbai)"},"ap-south-2":{description:"Asia Pacific (Hyderabad)"},"ap-southeast-1":{description:"Asia Pacific (Singapore)"},"ap-southeast-2":{description:"Asia Pacific (Sydney)"},"ap-southeast-3":{description:"Asia Pacific (Jakarta)"},"ap-southeast-4":{description:"Asia Pacific (Melbourne)"},"ap-southeast-5":{description:"Asia Pacific (Malaysia)"},"ap-southeast-6":{description:"Asia Pacific (New Zealand)"},"ap-southeast-7":{description:"Asia Pacific (Thailand)"},"aws-global":{description:"aws global region"},"ca-central-1":{description:"Canada (Central)"},"ca-west-1":{description:"Canada West (Calgary)"},"eu-central-1":{description:"Europe (Frankfurt)"},"eu-central-2":{description:"Europe (Zurich)"},"eu-north-1":{description:"Europe (Stockholm)"},"eu-south-1":{description:"Europe (Milan)"},"eu-south-2":{description:"Europe (Spain)"},"eu-west-1":{description:"Europe (Ireland)"},"eu-west-2":{description:"Europe (London)"},"eu-west-3":{description:"Europe (Paris)"},"il-central-1":{description:"Israel (Tel Aviv)"},"me-central-1":{description:"Middle East (UAE)"},"me-south-1":{description:"Middle East (Bahrain)"},"mx-central-1":{description:"Mexico (Central)"},"sa-east-1":{description:"South America (Sao Paulo)"},"us-east-1":{description:"US East (N. Virginia)"},"us-east-2":{description:"US East (Ohio)"},"us-west-1":{description:"US West (N. California)"},"us-west-2":{description:"US West (Oregon)"}}},{id:"aws-cn",outputs:{dnsSuffix:"amazonaws.com.cn",dualStackDnsSuffix:"api.amazonwebservices.com.cn",implicitGlobalRegion:"cn-northwest-1",name:"aws-cn",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^cn\\-\\w+\\-\\d+$",regions:{"aws-cn-global":{description:"aws-cn global region"},"cn-north-1":{description:"China (Beijing)"},"cn-northwest-1":{description:"China (Ningxia)"}}},{id:"aws-eusc",outputs:{dnsSuffix:"amazonaws.eu",dualStackDnsSuffix:"api.amazonwebservices.eu",implicitGlobalRegion:"eusc-de-east-1",name:"aws-eusc",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^eusc\\-(de)\\-\\w+\\-\\d+$",regions:{"eusc-de-east-1":{description:"AWS European Sovereign Cloud (Germany)"}}},{id:"aws-iso",outputs:{dnsSuffix:"c2s.ic.gov",dualStackDnsSuffix:"api.aws.ic.gov",implicitGlobalRegion:"us-iso-east-1",name:"aws-iso",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-iso\\-\\w+\\-\\d+$",regions:{"aws-iso-global":{description:"aws-iso global region"},"us-iso-east-1":{description:"US ISO East"},"us-iso-west-1":{description:"US ISO WEST"}}},{id:"aws-iso-b",outputs:{dnsSuffix:"sc2s.sgov.gov",dualStackDnsSuffix:"api.aws.scloud",implicitGlobalRegion:"us-isob-east-1",name:"aws-iso-b",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-isob\\-\\w+\\-\\d+$",regions:{"aws-iso-b-global":{description:"aws-iso-b global region"},"us-isob-east-1":{description:"US ISOB East (Ohio)"},"us-isob-west-1":{description:"US ISOB West"}}},{id:"aws-iso-e",outputs:{dnsSuffix:"cloud.adc-e.uk",dualStackDnsSuffix:"api.cloud-aws.adc-e.uk",implicitGlobalRegion:"eu-isoe-west-1",name:"aws-iso-e",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^eu\\-isoe\\-\\w+\\-\\d+$",regions:{"aws-iso-e-global":{description:"aws-iso-e global region"},"eu-isoe-west-1":{description:"EU ISOE West"}}},{id:"aws-iso-f",outputs:{dnsSuffix:"csp.hci.ic.gov",dualStackDnsSuffix:"api.aws.hci.ic.gov",implicitGlobalRegion:"us-isof-south-1",name:"aws-iso-f",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-isof\\-\\w+\\-\\d+$",regions:{"aws-iso-f-global":{description:"aws-iso-f global region"},"us-isof-east-1":{description:"US ISOF EAST"},"us-isof-south-1":{description:"US ISOF SOUTH"}}},{id:"aws-us-gov",outputs:{dnsSuffix:"amazonaws.com",dualStackDnsSuffix:"api.aws",implicitGlobalRegion:"us-gov-west-1",name:"aws-us-gov",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-gov\\-\\w+\\-\\d+$",regions:{"aws-us-gov-global":{description:"aws-us-gov global region"},"us-gov-east-1":{description:"AWS GovCloud (US-East)"},"us-gov-west-1":{description:"AWS GovCloud (US-West)"}}}],f$={partitions:d$};let h$=f$;const p$=r=>{const{partitions:e}=h$;for(const n of e){const{regions:s,outputs:i}=n;for(const[c,d]of Object.entries(s))if(c===r)return{...i,...d}}for(const n of e){const{regionRegex:s,outputs:i}=n;if(new RegExp(s).test(r))return{...i}}const t=e.find(n=>n.id==="aws");if(!t)throw new Error("Provided region was not found in the partition array or regex, and default partition with id 'aws' doesn't exist.");return{...t.outputs}},zb={isVirtualHostableS3Bucket:U1,parseArn:u$,partition:p$};dh.aws=zb;const z1="required",Us="fn",zs="argv",vh="ref",tC=!0,rC="isSet",Lm="booleanEquals",$f="error",Oa="endpoint",Al="tree",Hb="PartitionResult",Bb="getAttr",Bp="stringEquals",nC={[z1]:!1,type:"string"},sC={[z1]:!0,default:!1,type:"boolean"},oC={[vh]:"Endpoint"},H1={[Us]:Lm,[zs]:[{[vh]:"UseFIPS"},!0]},B1={[Us]:Lm,[zs]:[{[vh]:"UseDualStack"},!0]},Fn={},dm={[vh]:"Region"},iC={[Us]:Bb,[zs]:[{[vh]:Hb},"supportsFIPS"]},G1={[vh]:Hb},aC={[Us]:Lm,[zs]:[!0,{[Us]:Bb,[zs]:[G1,"supportsDualStack"]}]},lC=[H1],cC=[B1],uC=[dm],m$={parameters:{Region:nC,UseDualStack:sC,UseFIPS:sC,Endpoint:nC},rules:[{conditions:[{[Us]:rC,[zs]:[oC]}],rules:[{conditions:lC,error:"Invalid Configuration: FIPS and custom endpoint are not supported",type:$f},{conditions:cC,error:"Invalid Configuration: Dualstack and custom endpoint are not supported",type:$f},{endpoint:{url:oC,properties:Fn,headers:Fn},type:Oa}],type:Al},{conditions:[{[Us]:rC,[zs]:uC}],rules:[{conditions:[{[Us]:"aws.partition",[zs]:uC,assign:Hb}],rules:[{conditions:[H1,B1],rules:[{conditions:[{[Us]:Lm,[zs]:[tC,iC]},aC],rules:[{conditions:[{[Us]:Bp,[zs]:[dm,"us-east-1"]}],endpoint:{url:"https://cognito-idp-fips.us-east-1.amazonaws.com",properties:Fn,headers:Fn},type:Oa},{conditions:[{[Us]:Bp,[zs]:[dm,"us-east-2"]}],endpoint:{url:"https://cognito-idp-fips.us-east-2.amazonaws.com",properties:Fn,headers:Fn},type:Oa},{conditions:[{[Us]:Bp,[zs]:[dm,"us-west-1"]}],endpoint:{url:"https://cognito-idp-fips.us-west-1.amazonaws.com",properties:Fn,headers:Fn},type:Oa},{conditions:[{[Us]:Bp,[zs]:[dm,"us-west-2"]}],endpoint:{url:"https://cognito-idp-fips.us-west-2.amazonaws.com",properties:Fn,headers:Fn},type:Oa},{endpoint:{url:"https://cognito-idp-fips.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:Fn,headers:Fn},type:Oa}],type:Al},{error:"FIPS and DualStack are enabled, but this partition does not support one or both",type:$f}],type:Al},{conditions:lC,rules:[{conditions:[{[Us]:Lm,[zs]:[iC,tC]}],rules:[{endpoint:{url:"https://cognito-idp-fips.{Region}.{PartitionResult#dnsSuffix}",properties:Fn,headers:Fn},type:Oa}],type:Al},{error:"FIPS is enabled but this partition does not support FIPS",type:$f}],type:Al},{conditions:cC,rules:[{conditions:[aC],rules:[{conditions:[{[Us]:Bp,[zs]:["aws",{[Us]:Bb,[zs]:[G1,"name"]}]}],endpoint:{url:"https://cognito-idp.{Region}.amazonaws.com",properties:Fn,headers:Fn},type:Oa},{endpoint:{url:"https://cognito-idp.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:Fn,headers:Fn},type:Oa}],type:Al},{error:"DualStack is enabled but this partition does not support DualStack",type:$f}],type:Al},{endpoint:{url:"https://cognito-idp.{Region}.{PartitionResult#dnsSuffix}",properties:Fn,headers:Fn},type:Oa}],type:Al}],type:Al},{error:"Invalid Configuration: Missing Region",type:$f}]},g$=m$,v$=new WN({size:50,params:["Endpoint","Region","UseDualStack","UseFIPS"]}),y$=(r,e={})=>v$.get(r,()=>t1(g$,{endpointParams:r,logger:e.logger}));dh.aws=zb;const x$=r=>({apiVersion:"2016-04-18",base64Decoder:(r==null?void 0:r.base64Decoder)??Zm,base64Encoder:(r==null?void 0:r.base64Encoder)??Im,disableHostPrefix:(r==null?void 0:r.disableHostPrefix)??!1,endpointProvider:(r==null?void 0:r.endpointProvider)??y$,extensions:(r==null?void 0:r.extensions)??[],httpAuthSchemeProvider:(r==null?void 0:r.httpAuthSchemeProvider)??LM,httpAuthSchemes:(r==null?void 0:r.httpAuthSchemes)??[{schemeId:"aws.auth#sigv4",identityProvider:e=>e.getIdentityProvider("aws.auth#sigv4"),signer:new s1},{schemeId:"smithy.api#noAuth",identityProvider:e=>e.getIdentityProvider("smithy.api#noAuth")||(async()=>({})),signer:new HN}],logger:(r==null?void 0:r.logger)??new Mb,protocol:(r==null?void 0:r.protocol)??y1,protocolSettings:(r==null?void 0:r.protocolSettings)??{defaultNamespace:"com.amazonaws.cognitoidentityprovider",xmlNamespace:"http://cognito-idp.amazonaws.com/doc/2016-04-18/",version:"2016-04-18",serviceTarget:"AWSCognitoIdentityProviderService"},serviceId:(r==null?void 0:r.serviceId)??"Cognito Identity Provider",urlParser:(r==null?void 0:r.urlParser)??Fm,utf8Decoder:(r==null?void 0:r.utf8Decoder)??cd,utf8Encoder:(r==null?void 0:r.utf8Encoder)??Wy}),w$=r=>{const e=$1(r),t=()=>e().then(m1),n=x$(r);return{...n,...r,runtime:"browser",defaultsMode:e,bodyLengthChecker:(r==null?void 0:r.bodyLengthChecker)??f1,credentialDefaultProvider:(r==null?void 0:r.credentialDefaultProvider)??(s=>()=>Promise.reject(new Error("Credential is missing"))),defaultUserAgentProvider:(r==null?void 0:r.defaultUserAgentProvider)??L1({serviceId:n.serviceId,clientVersion:HM.version}),maxAttempts:(r==null?void 0:r.maxAttempts)??Om,region:(r==null?void 0:r.region)??M1("Region is missing"),requestHandler:Vy.create((r==null?void 0:r.requestHandler)??t),retryMode:(r==null?void 0:r.retryMode)??(async()=>(await t()).retryMode||T1),sha256:(r==null?void 0:r.sha256)??D1,streamCollector:(r==null?void 0:r.streamCollector)??FN,useDualstackEndpoint:(r==null?void 0:r.useDualstackEndpoint)??(()=>Promise.resolve(w1)),useFipsEndpoint:(r==null?void 0:r.useFipsEndpoint)??(()=>Promise.resolve(b1))}},W1=r=>({setRegion(e){r.region=e},region(){return r.region}}),V1=r=>({region:r.region()}),b$=r=>{const e=r.httpAuthSchemes;let t=r.httpAuthSchemeProvider,n=r.credentials;return{setHttpAuthScheme(s){const i=e.findIndex(c=>c.schemeId===s.schemeId);i===-1?e.push(s):e.splice(i,1,s)},httpAuthSchemes(){return e},setHttpAuthSchemeProvider(s){t=s},httpAuthSchemeProvider(){return t},setCredentials(s){n=s},credentials(){return n}}},_$=r=>({httpAuthSchemes:r.httpAuthSchemes(),httpAuthSchemeProvider:r.httpAuthSchemeProvider(),credentials:r.credentials()}),S$=(r,e)=>{const t=Object.assign(W1(r),g1(r),kN(r),b$(r));return e.forEach(n=>n.configure(t)),Object.assign(r,V1(t),v1(t),NN(t),_$(t))};class Gb extends h1{constructor(...[t]){const n=w$(t||{});super(n);H(this,"config");this.initConfig=n;const s=$M(n),i=GN(s),c=P1(i),d=S1(c),p=d,m=N1(p),g=MM(m),x=S$(g,(t==null?void 0:t.extensions)||[]);this.config=x,this.middlewareStack.use(LN(this.config)),this.middlewareStack.use(x1(this.config)),this.middlewareStack.use(j1(this.config)),this.middlewareStack.use(E1(this.config)),this.middlewareStack.use(TN(this.config)),this.middlewareStack.use(RN(this.config)),this.middlewareStack.use(AN(this.config)),this.middlewareStack.use(IN(this.config,{httpAuthSchemeParametersProvider:OM,identityProviderConfigProvider:async b=>new zN({"aws.auth#sigv4":b.credentials})})),this.middlewareStack.use(PN(this.config))}destroy(){super.destroy()}}class bt extends Xf{constructor(e){super(e),Object.setPrototypeOf(this,bt.prototype)}}class Wb extends bt{constructor(t){super({name:"InternalErrorException",$fault:"server",...t});H(this,"name","InternalErrorException");H(this,"$fault","server");Object.setPrototypeOf(this,Wb.prototype)}}class Vb extends bt{constructor(t){super({name:"InvalidParameterException",$fault:"client",...t});H(this,"name","InvalidParameterException");H(this,"$fault","client");H(this,"reasonCode");Object.setPrototypeOf(this,Vb.prototype),this.reasonCode=t.reasonCode}}class qb extends bt{constructor(t){super({name:"NotAuthorizedException",$fault:"client",...t});H(this,"name","NotAuthorizedException");H(this,"$fault","client");Object.setPrototypeOf(this,qb.prototype)}}class Kb extends bt{constructor(t){super({name:"ResourceNotFoundException",$fault:"client",...t});H(this,"name","ResourceNotFoundException");H(this,"$fault","client");Object.setPrototypeOf(this,Kb.prototype)}}class Yb extends bt{constructor(t){super({name:"TooManyRequestsException",$fault:"client",...t});H(this,"name","TooManyRequestsException");H(this,"$fault","client");Object.setPrototypeOf(this,Yb.prototype)}}class Jb extends bt{constructor(t){super({name:"UserImportInProgressException",$fault:"client",...t});H(this,"name","UserImportInProgressException");H(this,"$fault","client");Object.setPrototypeOf(this,Jb.prototype)}}class Xb extends bt{constructor(t){super({name:"UserNotFoundException",$fault:"client",...t});H(this,"name","UserNotFoundException");H(this,"$fault","client");Object.setPrototypeOf(this,Xb.prototype)}}class Qb extends bt{constructor(t){super({name:"InvalidLambdaResponseException",$fault:"client",...t});H(this,"name","InvalidLambdaResponseException");H(this,"$fault","client");Object.setPrototypeOf(this,Qb.prototype)}}class Zb extends bt{constructor(t){super({name:"LimitExceededException",$fault:"client",...t});H(this,"name","LimitExceededException");H(this,"$fault","client");Object.setPrototypeOf(this,Zb.prototype)}}class e_ extends bt{constructor(t){super({name:"TooManyFailedAttemptsException",$fault:"client",...t});H(this,"name","TooManyFailedAttemptsException");H(this,"$fault","client");Object.setPrototypeOf(this,e_.prototype)}}class t_ extends bt{constructor(t){super({name:"UnexpectedLambdaException",$fault:"client",...t});H(this,"name","UnexpectedLambdaException");H(this,"$fault","client");Object.setPrototypeOf(this,t_.prototype)}}class r_ extends bt{constructor(t){super({name:"UserLambdaValidationException",$fault:"client",...t});H(this,"name","UserLambdaValidationException");H(this,"$fault","client");Object.setPrototypeOf(this,r_.prototype)}}class n_ extends bt{constructor(t){super({name:"CodeDeliveryFailureException",$fault:"client",...t});H(this,"name","CodeDeliveryFailureException");H(this,"$fault","client");Object.setPrototypeOf(this,n_.prototype)}}class s_ extends bt{constructor(t){super({name:"InvalidPasswordException",$fault:"client",...t});H(this,"name","InvalidPasswordException");H(this,"$fault","client");Object.setPrototypeOf(this,s_.prototype)}}class o_ extends bt{constructor(t){super({name:"InvalidSmsRoleAccessPolicyException",$fault:"client",...t});H(this,"name","InvalidSmsRoleAccessPolicyException");H(this,"$fault","client");Object.setPrototypeOf(this,o_.prototype)}}class i_ extends bt{constructor(t){super({name:"InvalidSmsRoleTrustRelationshipException",$fault:"client",...t});H(this,"name","InvalidSmsRoleTrustRelationshipException");H(this,"$fault","client");Object.setPrototypeOf(this,i_.prototype)}}class a_ extends bt{constructor(t){super({name:"PreconditionNotMetException",$fault:"client",...t});H(this,"name","PreconditionNotMetException");H(this,"$fault","client");Object.setPrototypeOf(this,a_.prototype)}}class l_ extends bt{constructor(t){super({name:"UnsupportedUserStateException",$fault:"client",...t});H(this,"name","UnsupportedUserStateException");H(this,"$fault","client");Object.setPrototypeOf(this,l_.prototype)}}class c_ extends bt{constructor(t){super({name:"UsernameExistsException",$fault:"client",...t});H(this,"name","UsernameExistsException");H(this,"$fault","client");Object.setPrototypeOf(this,c_.prototype)}}class u_ extends bt{constructor(t){super({name:"AliasExistsException",$fault:"client",...t});H(this,"name","AliasExistsException");H(this,"$fault","client");Object.setPrototypeOf(this,u_.prototype)}}class d_ extends bt{constructor(t){super({name:"InvalidUserPoolConfigurationException",$fault:"client",...t});H(this,"name","InvalidUserPoolConfigurationException");H(this,"$fault","client");Object.setPrototypeOf(this,d_.prototype)}}class f_ extends bt{constructor(t){super({name:"InvalidEmailRoleAccessPolicyException",$fault:"client",...t});H(this,"name","InvalidEmailRoleAccessPolicyException");H(this,"$fault","client");Object.setPrototypeOf(this,f_.prototype)}}class h_ extends bt{constructor(t){super({name:"MFAMethodNotFoundException",$fault:"client",...t});H(this,"name","MFAMethodNotFoundException");H(this,"$fault","client");Object.setPrototypeOf(this,h_.prototype)}}class p_ extends bt{constructor(t){super({name:"PasswordResetRequiredException",$fault:"client",...t});H(this,"name","PasswordResetRequiredException");H(this,"$fault","client");Object.setPrototypeOf(this,p_.prototype)}}class m_ extends bt{constructor(t){super({name:"UnsupportedOperationException",$fault:"client",...t});H(this,"name","UnsupportedOperationException");H(this,"$fault","client");Object.setPrototypeOf(this,m_.prototype)}}class g_ extends bt{constructor(t){super({name:"UserNotConfirmedException",$fault:"client",...t});H(this,"name","UserNotConfirmedException");H(this,"$fault","client");Object.setPrototypeOf(this,g_.prototype)}}class v_ extends bt{constructor(t){super({name:"UserPoolAddOnNotEnabledException",$fault:"client",...t});H(this,"name","UserPoolAddOnNotEnabledException");H(this,"$fault","client");Object.setPrototypeOf(this,v_.prototype)}}class y_ extends bt{constructor(t){super({name:"CodeMismatchException",$fault:"client",...t});H(this,"name","CodeMismatchException");H(this,"$fault","client");Object.setPrototypeOf(this,y_.prototype)}}class x_ extends bt{constructor(t){super({name:"ExpiredCodeException",$fault:"client",...t});H(this,"name","ExpiredCodeException");H(this,"$fault","client");Object.setPrototypeOf(this,x_.prototype)}}class w_ extends bt{constructor(t){super({name:"PasswordHistoryPolicyViolationException",$fault:"client",...t});H(this,"name","PasswordHistoryPolicyViolationException");H(this,"$fault","client");Object.setPrototypeOf(this,w_.prototype)}}class b_ extends bt{constructor(t){super({name:"SoftwareTokenMFANotFoundException",$fault:"client",...t});H(this,"name","SoftwareTokenMFANotFoundException");H(this,"$fault","client");Object.setPrototypeOf(this,b_.prototype)}}class __ extends bt{constructor(t){super({name:"ConcurrentModificationException",$fault:"client",...t});H(this,"name","ConcurrentModificationException");H(this,"$fault","client");Object.setPrototypeOf(this,__.prototype)}}class S_ extends bt{constructor(t){super({name:"ForbiddenException",$fault:"client",...t});H(this,"name","ForbiddenException");H(this,"$fault","client");Object.setPrototypeOf(this,S_.prototype)}}class E_ extends bt{constructor(t){super({name:"WebAuthnChallengeNotFoundException",$fault:"client",...t});H(this,"name","WebAuthnChallengeNotFoundException");H(this,"$fault","client");Object.setPrototypeOf(this,E_.prototype)}}class C_ extends bt{constructor(t){super({name:"WebAuthnClientMismatchException",$fault:"client",...t});H(this,"name","WebAuthnClientMismatchException");H(this,"$fault","client");Object.setPrototypeOf(this,C_.prototype)}}class k_ extends bt{constructor(t){super({name:"WebAuthnCredentialNotSupportedException",$fault:"client",...t});H(this,"name","WebAuthnCredentialNotSupportedException");H(this,"$fault","client");Object.setPrototypeOf(this,k_.prototype)}}class N_ extends bt{constructor(t){super({name:"WebAuthnNotEnabledException",$fault:"client",...t});H(this,"name","WebAuthnNotEnabledException");H(this,"$fault","client");Object.setPrototypeOf(this,N_.prototype)}}class T_ extends bt{constructor(t){super({name:"WebAuthnOriginNotAllowedException",$fault:"client",...t});H(this,"name","WebAuthnOriginNotAllowedException");H(this,"$fault","client");Object.setPrototypeOf(this,T_.prototype)}}class R_ extends bt{constructor(t){super({name:"WebAuthnRelyingPartyMismatchException",$fault:"client",...t});H(this,"name","WebAuthnRelyingPartyMismatchException");H(this,"$fault","client");Object.setPrototypeOf(this,R_.prototype)}}class A_ extends bt{constructor(t){super({name:"DeviceKeyExistsException",$fault:"client",...t});H(this,"name","DeviceKeyExistsException");H(this,"$fault","client");Object.setPrototypeOf(this,A_.prototype)}}class I_ extends bt{constructor(t){super({name:"GroupExistsException",$fault:"client",...t});H(this,"name","GroupExistsException");H(this,"$fault","client");Object.setPrototypeOf(this,I_.prototype)}}class P_ extends bt{constructor(t){super({name:"DuplicateProviderException",$fault:"client",...t});H(this,"name","DuplicateProviderException");H(this,"$fault","client");Object.setPrototypeOf(this,P_.prototype)}}class j_ extends bt{constructor(t){super({name:"ManagedLoginBrandingExistsException",$fault:"client",...t});H(this,"name","ManagedLoginBrandingExistsException");H(this,"$fault","client");Object.setPrototypeOf(this,j_.prototype)}}class F_ extends bt{constructor(t){super({name:"TermsExistsException",$fault:"client",...t});H(this,"name","TermsExistsException");H(this,"$fault","client");Object.setPrototypeOf(this,F_.prototype)}}class O_ extends bt{constructor(t){super({name:"FeatureUnavailableInTierException",$fault:"client",...t});H(this,"name","FeatureUnavailableInTierException");H(this,"$fault","client");Object.setPrototypeOf(this,O_.prototype)}}class D_ extends bt{constructor(t){super({name:"TierChangeNotAllowedException",$fault:"client",...t});H(this,"name","TierChangeNotAllowedException");H(this,"$fault","client");Object.setPrototypeOf(this,D_.prototype)}}class L_ extends bt{constructor(t){super({name:"UserPoolTaggingException",$fault:"client",...t});H(this,"name","UserPoolTaggingException");H(this,"$fault","client");Object.setPrototypeOf(this,L_.prototype)}}class M_ extends bt{constructor(t){super({name:"InvalidOAuthFlowException",$fault:"client",...t});H(this,"name","InvalidOAuthFlowException");H(this,"$fault","client");Object.setPrototypeOf(this,M_.prototype)}}class $_ extends bt{constructor(t){super({name:"ScopeDoesNotExistException",$fault:"client",...t});H(this,"name","ScopeDoesNotExistException");H(this,"$fault","client");Object.setPrototypeOf(this,$_.prototype)}}class U_ extends bt{constructor(t){super({name:"UnsupportedIdentityProviderException",$fault:"client",...t});H(this,"name","UnsupportedIdentityProviderException");H(this,"$fault","client");Object.setPrototypeOf(this,U_.prototype)}}class z_ extends bt{constructor(t){super({name:"RefreshTokenReuseException",$fault:"client",...t});H(this,"name","RefreshTokenReuseException");H(this,"$fault","client");Object.setPrototypeOf(this,z_.prototype)}}class H_ extends bt{constructor(t){super({name:"UnauthorizedException",$fault:"client",...t});H(this,"name","UnauthorizedException");H(this,"$fault","client");Object.setPrototypeOf(this,H_.prototype)}}class B_ extends bt{constructor(t){super({name:"UnsupportedTokenTypeException",$fault:"client",...t});H(this,"name","UnsupportedTokenTypeException");H(this,"$fault","client");Object.setPrototypeOf(this,B_.prototype)}}class G_ extends bt{constructor(t){super({name:"WebAuthnConfigurationMissingException",$fault:"client",...t});H(this,"name","WebAuthnConfigurationMissingException");H(this,"$fault","client");Object.setPrototypeOf(this,G_.prototype)}}class W_ extends bt{constructor(t){super({name:"EnableSoftwareTokenMFAException",$fault:"client",...t});H(this,"name","EnableSoftwareTokenMFAException");H(this,"$fault","client");Object.setPrototypeOf(this,W_.prototype)}}const E$="AvailableChallenges",C$="AliasExistsException",k$="AnalyticsEndpointId",N$="AuthFlow",T$="AnalyticsMetadata",R$="AnalyticsMetadataType",A$="AuthParameters",I$="AuthParametersType",P$="AuthenticationResult",j$="AuthenticationResultType",F$="AccessToken",O$="CodeDeliveryFailureException",D$="ClientId",L$="ClientIdType",M$="ClientMetadata",$$="CodeMismatchException",U$="ConcurrentModificationException",z$="ChallengeName",H$="ChallengeParameters",B$="DeviceGroupKey",G$="DeviceKey",W$="DeviceKeyExistsException",V$="DuplicateProviderException",q$="ExpiredCodeException",K$="EncodedData",Y$="ExpiresIn",J$="EnableSoftwareTokenMFAException",X$="ForbiddenException",Q$="FeatureUnavailableInTierException",Z$="GroupExistsException",e4="IpAddress",t4="InitiateAuthRequest",r4="InitiateAuthResponse",n4="InitiateAuth",s4="InternalErrorException",o4="InvalidEmailRoleAccessPolicyException",i4="InvalidLambdaResponseException",a4="InvalidOAuthFlowException",l4="InvalidParameterException",c4="InvalidPasswordException",u4="InvalidSmsRoleAccessPolicyException",d4="InvalidSmsRoleTrustRelationshipException",f4="IdToken",h4="InvalidUserPoolConfigurationException",p4="LimitExceededException",m4="MFAMethodNotFoundException",g4="ManagedLoginBrandingExistsException",v4="NotAuthorizedException",y4="NewDeviceMetadata",x4="NewDeviceMetadataType",w4="PasswordHistoryPolicyViolationException",b4="PreconditionNotMetException",_4="PasswordResetRequiredException",S4="ResourceNotFoundException",E4="RefreshToken",C4="RefreshTokenReuseException",q1="Session",k4="ScopeDoesNotExistException",N4="SessionType",T4="SoftwareTokenMFANotFoundException",R4="TierChangeNotAllowedException",A4="TermsExistsException",I4="TooManyFailedAttemptsException",P4="TooManyRequestsException",j4="TokenModelType",F4="TokenType",O4="UserContextDataType",D4="UserContextData",L4="UnauthorizedException",M4="UsernameExistsException",$4="UserImportInProgressException",U4="UnsupportedIdentityProviderException",z4="UnexpectedLambdaException",H4="UserLambdaValidationException",B4="UserNotConfirmedException",G4="UserNotFoundException",W4="UnsupportedOperationException",V4="UserPoolAddOnNotEnabledException",q4="UserPoolTaggingException",K4="UnsupportedTokenTypeException",Y4="UnsupportedUserStateException",J4="WebAuthnClientMismatchException",X4="WebAuthnConfigurationMissingException",Q4="WebAuthnChallengeNotFoundException",Z4="WebAuthnCredentialNotSupportedException",e3="WebAuthnNotEnabledException",t3="WebAuthnOriginNotAllowedException",r3="WebAuthnRelyingPartyMismatchException",Ft="client",Tt="error",Ot="httpError",Rt="message",n3="reasonCode",s3="server",K1="smithy.ts.sdk.synthetic.com.amazonaws.cognitoidentityprovider",Ne="com.amazonaws.cognitoidentityprovider";var o3=[0,Ne,L$,8,0],Y1=[0,Ne,N4,8,0],Px=[0,Ne,j4,8,0],i3=[-3,Ne,C$,{[Tt]:Ft,[Ot]:400},[Rt],[0]];xt.for(Ne).registerError(i3,u_);var a3=[3,Ne,R$,0,[k$],[0]],l3=[3,Ne,j$,0,[F$,Y$,F4,E4,f4,y4],[[()=>Px,0],1,0,[()=>Px,0],[()=>Px,0],()=>j3]],c3=[-3,Ne,O$,{[Tt]:Ft,[Ot]:400},[Rt],[0]];xt.for(Ne).registerError(c3,n_);var u3=[-3,Ne,$$,{[Tt]:Ft,[Ot]:400},[Rt],[0]];xt.for(Ne).registerError(u3,y_);var d3=[-3,Ne,U$,{[Tt]:Ft,[Ot]:400},[Rt],[0]];xt.for(Ne).registerError(d3,__);var f3=[-3,Ne,W$,{[Tt]:Ft,[Ot]:400},[Rt],[0]];xt.for(Ne).registerError(f3,A_);var h3=[-3,Ne,V$,{[Tt]:Ft,[Ot]:400},[Rt],[0]];xt.for(Ne).registerError(h3,P_);var p3=[-3,Ne,J$,{[Tt]:Ft,[Ot]:400},[Rt],[0]];xt.for(Ne).registerError(p3,W_);var m3=[-3,Ne,q$,{[Tt]:Ft,[Ot]:400},[Rt],[0]];xt.for(Ne).registerError(m3,x_);var g3=[-3,Ne,Q$,{[Tt]:Ft,[Ot]:403},[Rt],[0]];xt.for(Ne).registerError(g3,O_);var v3=[-3,Ne,X$,{[Tt]:Ft,[Ot]:403},[Rt],[0]];xt.for(Ne).registerError(v3,S_);var y3=[-3,Ne,Z$,{[Tt]:Ft,[Ot]:400},[Rt],[0]];xt.for(Ne).registerError(y3,I_);var x3=[3,Ne,t4,0,[N$,D$,A$,M$,T$,D4,q1],[0,[()=>o3,0],[()=>pU,0],128,()=>a3,[()=>Q3,0],[()=>Y1,0]],2],w3=[3,Ne,r4,0,[z$,q1,H$,P$,E$],[0,[()=>Y1,0],128,[()=>l3,0],64]],b3=[-3,Ne,s4,{[Tt]:s3},[Rt],[0]];xt.for(Ne).registerError(b3,Wb);var _3=[-3,Ne,o4,{[Tt]:Ft,[Ot]:400},[Rt],[0]];xt.for(Ne).registerError(_3,f_);var S3=[-3,Ne,i4,{[Tt]:Ft,[Ot]:400},[Rt],[0]];xt.for(Ne).registerError(S3,Qb);var E3=[-3,Ne,a4,{[Tt]:Ft,[Ot]:400},[Rt],[0]];xt.for(Ne).registerError(E3,M_);var C3=[-3,Ne,l4,{[Tt]:Ft,[Ot]:400},[Rt,n3],[0,0]];xt.for(Ne).registerError(C3,Vb);var k3=[-3,Ne,c4,{[Tt]:Ft,[Ot]:400},[Rt],[0]];xt.for(Ne).registerError(k3,s_);var N3=[-3,Ne,u4,{[Tt]:Ft,[Ot]:400},[Rt],[0]];xt.for(Ne).registerError(N3,o_);var T3=[-3,Ne,d4,{[Tt]:Ft,[Ot]:400},[Rt],[0]];xt.for(Ne).registerError(T3,i_);var R3=[-3,Ne,h4,{[Tt]:Ft,[Ot]:400},[Rt],[0]];xt.for(Ne).registerError(R3,d_);var A3=[-3,Ne,p4,{[Tt]:Ft,[Ot]:400},[Rt],[0]];xt.for(Ne).registerError(A3,Zb);var I3=[-3,Ne,g4,{[Tt]:Ft,[Ot]:400},[Rt],[0]];xt.for(Ne).registerError(I3,j_);var P3=[-3,Ne,m4,{[Tt]:Ft,[Ot]:400},[Rt],[0]];xt.for(Ne).registerError(P3,h_);var j3=[3,Ne,x4,0,[G$,B$],[0,0]],F3=[-3,Ne,v4,{[Tt]:Ft,[Ot]:403},[Rt],[0]];xt.for(Ne).registerError(F3,qb);var O3=[-3,Ne,w4,{[Tt]:Ft,[Ot]:400},[Rt],[0]];xt.for(Ne).registerError(O3,w_);var D3=[-3,Ne,_4,{[Tt]:Ft,[Ot]:400},[Rt],[0]];xt.for(Ne).registerError(D3,p_);var L3=[-3,Ne,b4,{[Tt]:Ft,[Ot]:400},[Rt],[0]];xt.for(Ne).registerError(L3,a_);var M3=[-3,Ne,C4,{[Tt]:Ft,[Ot]:400},[Rt],[0]];xt.for(Ne).registerError(M3,z_);var $3=[-3,Ne,S4,{[Tt]:Ft,[Ot]:404},[Rt],[0]];xt.for(Ne).registerError($3,Kb);var U3=[-3,Ne,k4,{[Tt]:Ft,[Ot]:400},[Rt],[0]];xt.for(Ne).registerError(U3,$_);var z3=[-3,Ne,T4,{[Tt]:Ft,[Ot]:400},[Rt],[0]];xt.for(Ne).registerError(z3,b_);var H3=[-3,Ne,A4,{[Tt]:Ft,[Ot]:400},[Rt],[0]];xt.for(Ne).registerError(H3,F_);var B3=[-3,Ne,R4,{[Tt]:Ft,[Ot]:403},[Rt],[0]];xt.for(Ne).registerError(B3,D_);var G3=[-3,Ne,I4,{[Tt]:Ft,[Ot]:400},[Rt],[0]];xt.for(Ne).registerError(G3,e_);var W3=[-3,Ne,P4,{[Tt]:Ft,[Ot]:429},[Rt],[0]];xt.for(Ne).registerError(W3,Yb);var V3=[-3,Ne,L4,{[Tt]:Ft,[Ot]:401},[Rt],[0]];xt.for(Ne).registerError(V3,H_);var q3=[-3,Ne,z4,{[Tt]:Ft,[Ot]:400},[Rt],[0]];xt.for(Ne).registerError(q3,t_);var K3=[-3,Ne,U4,{[Tt]:Ft,[Ot]:400},[Rt],[0]];xt.for(Ne).registerError(K3,U_);var Y3=[-3,Ne,W4,{[Tt]:Ft,[Ot]:400},[Rt],[0]];xt.for(Ne).registerError(Y3,m_);var J3=[-3,Ne,K4,{[Tt]:Ft,[Ot]:400},[Rt],[0]];xt.for(Ne).registerError(J3,B_);var X3=[-3,Ne,Y4,{[Tt]:Ft,[Ot]:400},[Rt],[0]];xt.for(Ne).registerError(X3,l_);var Q3=[3,Ne,O4,8,[e4,K$],[0,0]],Z3=[-3,Ne,$4,{[Tt]:Ft,[Ot]:400},[Rt],[0]];xt.for(Ne).registerError(Z3,Jb);var eU=[-3,Ne,H4,{[Tt]:Ft,[Ot]:400},[Rt],[0]];xt.for(Ne).registerError(eU,r_);var tU=[-3,Ne,M4,{[Tt]:Ft,[Ot]:400},[Rt],[0]];xt.for(Ne).registerError(tU,c_);var rU=[-3,Ne,B4,{[Tt]:Ft,[Ot]:400},[Rt],[0]];xt.for(Ne).registerError(rU,g_);var nU=[-3,Ne,G4,{[Tt]:Ft,[Ot]:404},[Rt],[0]];xt.for(Ne).registerError(nU,Xb);var sU=[-3,Ne,V4,{[Tt]:Ft,[Ot]:400},[Rt],[0]];xt.for(Ne).registerError(sU,v_);var oU=[-3,Ne,q4,{[Tt]:Ft,[Ot]:400},[Rt],[0]];xt.for(Ne).registerError(oU,L_);var iU=[-3,Ne,Q4,{[Tt]:Ft,[Ot]:400},[Rt],[0]];xt.for(Ne).registerError(iU,E_);var aU=[-3,Ne,J4,{[Tt]:Ft,[Ot]:400},[Rt],[0]];xt.for(Ne).registerError(aU,C_);var lU=[-3,Ne,X4,{[Tt]:Ft,[Ot]:400},[Rt],[0]];xt.for(Ne).registerError(lU,G_);var cU=[-3,Ne,Z4,{[Tt]:Ft,[Ot]:400},[Rt],[0]];xt.for(Ne).registerError(cU,k_);var uU=[-3,Ne,e3,{[Tt]:Ft,[Ot]:400},[Rt],[0]];xt.for(Ne).registerError(uU,N_);var dU=[-3,Ne,t3,{[Tt]:Ft,[Ot]:400},[Rt],[0]];xt.for(Ne).registerError(dU,T_);var fU=[-3,Ne,r3,{[Tt]:Ft,[Ot]:400},[Rt],[0]];xt.for(Ne).registerError(fU,R_);var hU=[-3,K1,"CognitoIdentityProviderServiceException",0,[],[]];xt.for(K1).registerError(hU,bt);var pU=[2,Ne,I$,8,0,0],mU=[9,Ne,n4,0,()=>x3,()=>w3];class V_ extends p1.classBuilder().ep(UM).m(function(e,t,n,s){return[cM(n,e.getEndpointParameterInstructions())]}).s("AWSCognitoIdentityProviderService","InitiateAuth",{}).n("CognitoIdentityProviderClient","InitiateAuthCommand").sc(mU).build(){}const gU="0.0.0",J1="staging",vU="outlook-addin",yU="staging-outlook-app-id",xU="https://candle-ai.github.io/FileServer_Staging/dist-outlook-addin/manifest.xml",wU="https://appsforoffice.microsoft.com/lib/1/hosted/office.js",bU="https://candle-ai.github.io/FileServer_Staging/dist-outlook-addin/src/apps/outlook-addin/auth-dialog-pkce.html",_U=!0,Lw="https://candle-ai.github.io/FileServer_Staging/dist-outlook-addin/src/apps/outlook-addin/auth-dialog-pkce.html?callback=true",SU="https://candle-ai.github.io/FileServer_Staging/dist-outlook-addin/options",q_="https://candle-ai.github.io/FileServer_Staging/dist-outlook-addin/auth/gmail/callback",Pr="https://vixpby8nfc.execute-api.us-east-1.amazonaws.com/prod",EU="https://vixpby8nfc.execute-api.us-east-1.amazonaws.com/prod",X1="https://candle-ai.github.io/FileServer_Staging/dist-outlook-addin",Q1="https://candle-565393026129-us-east-1.auth.us-east-1.amazoncognito.com",yh="22pj09tqppmia7sh207a3ufaq9",Z1=r=>`${Q1}/login?client_id=${yh}&response_type=code&scope=email+openid+profile&redirect_uri=${r}`,eT="https://candle-565393026129-us-east-1.auth.us-east-1.amazoncognito.com/oauth2/token",CU="https://candle-565393026129-us-east-1.auth.us-east-1.amazoncognito.com/oauth2/userInfo",rh="https://app.staging.trycandle.ai",tT="https://forms.gle/QFFz1rbFVmwJ96At6",kU="00db376f-0fb4-48b3-8844-c2cb1ba88920",rT="https://accounts.google.com/o/oauth2",nT="74023389454-6cal15ik3pu0p55rm5mr3go8kgro0gv8.apps.googleusercontent.com",K_=r=>`${rT}/auth?client_id=${nT}&redirect_uri=${r}&response_type=code&scope=https://www.googleapis.com/auth/gmail.readonly&access_type=offline&prompt=consent`,Y_="https://vixpby8nfc.execute-api.us-east-1.amazonaws.com/prod/oauth/login/",Mw="phc_RZCAfsv2zW9fB7Pdb8b50InaGRQJl7f8DPbD1lkxmZP",sT="https://us.i.posthog.com",NU="outlook",TU="staging",oT={buildTime:"2026-02-25T12:54:38.602Z",environment:"staging",configSource:"outlook_config.tsx",authMethod:"PKCE"},RU=Object.freeze(Object.defineProperty({__proto__:null,API_BASE_URL:EU,API_SERVER:Pr,AUTH_DIALOG_URL:bU,AWS_CLIENT_ID:yh,AWS_COGNITO_DOMAIN:Q1,AWS_LOGIN_PAGE_URI:Z1,AWS_OAUTH_TOKEN_URI:eT,AWS_USERINFO_URI:CU,BASE_DOMAIN:X1,BUILD_ENV:TU,CONFIG_VERIFICATION:oT,FEEDBACK_FORM:tT,GMAIL_INTEGRATION_CLIENT_ID:nT,GMAIL_INTEGRATION_DOMAIN:rT,GMAIL_INTEGRATION_PAGE_URI:K_,GMAIL_INTEGRATION_REDIRECT_URI:q_,INTEGRATION_AUTH_URL_PREFIX:Y_,LOGIN_REDIRECT_URI:Lw,MANIFEST_URL:xU,MODE:J1,OFFICE_JS_CDN:wU,OUTLOOK_APP_ID:yU,OUTLOOK_CLIENT_ID:kU,PLATFORM:NU,POSTHOG_HOST:sT,POSTHOG_KEY:Mw,POST_LOGIN_REDIRECT_URI:SU,SETTINGS_PAGE_URL:rh,TYPE:vU,USE_PKCE_AUTH:_U,VERSION:gU},Symbol.toStringTag,{value:"Module"})),nd="src/platforms/helpers/chromeAuthUtils.ts",J_=r=>new Promise(e=>{chrome.storage.local.set({token:JSON.stringify(r)},()=>{e()})}),AU=()=>new Promise(r=>{chrome.storage.local.get("token",e=>{const t=e.token?JSON.parse(e.token):null;r(t)})}),IU=()=>new Promise(r=>{chrome.storage.local.set({token:null},()=>{r()})});async function PU(r,e,t){const n="refreshAuthToken",s=new Gb({region:"us-east-1"});try{t.info("Preparing for REFRESH_TOKEN_AUTH",{sourceFile:nd,functionName:n}),t.debug("AuthFlow: REFRESH_TOKEN_AUTH",{sourceFile:nd,functionName:n}),t.info("Refreshing auth token...",{sourceFile:nd,functionName:n});const i=new V_({ClientId:yh,AuthFlow:"REFRESH_TOKEN_AUTH",AuthParameters:{REFRESH_TOKEN:r.refresh_token}}),d=(await s.send(i)).AuthenticationResult;if(!d)throw new Error("AuthenticationResult is missing in the response.");const{IdToken:p,AccessToken:m,RefreshToken:g,ExpiresIn:x,TokenType:b}=d;if(!p||!m||!x||!b)throw new Error("Missing required fields in AuthenticationResult.");const S={id_token:p,access_token:m,refresh_token:g||r.refresh_token,expires_in:x,token_type:b,fetched_at:e};return await J_(S),S}catch(i){throw t.error("Error refreshing auth token",i,{sourceFile:nd,functionName:n}),new Error("Failed to refresh authentication token.")}}async function jU(r){const e="handleLoginFlow";try{r.info("Starting OAuth flow in popup...",{sourceFile:nd,functionName:e});const t=Z1(Lw);r.info("Auth URL",{sourceFile:nd,functionName:e,authUrl:t});const n=await chrome.identity.launchWebAuthFlow({url:t,interactive:!0});if(!n)throw new Error("Authentication was cancelled or failed");const i=new URL(n).searchParams.get("code");if(!i)throw new Error("No authorization code received");const c={grant_type:"authorization_code",code:i,redirect_uri:Lw,client_id:yh},d=await fetch(eT,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(c).toString()});if(!d.ok)throw new Error(`Token exchange failed: ${d.statusText}`);const p=await d.json();if(!iO(p))throw new Error("Invalid token response format");const m={...p,fetched_at:Math.floor(Date.now())};return await J_(m),{success:!0}}catch(t){return r.error("Authentication failed",t,{sourceFile:nd,functionName:e}),{success:!1,error:t instanceof Error?t.message:"Unknown error occurred"}}}class FU{constructor(e){H(this,"logger");H(this,"authListeners",new Set);this.logger=e}async login(){try{const e=await jU(this.logger);if(!e.success)throw new Error(e.error||"Login failed");const t=await this.getToken();if(!t)throw new Error("Token not found after login");return this.notifyAuthListeners(!0),t}catch(e){throw this.logger.error("Login failed",e,{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"login"}),e}}async logout(){var e;try{if(await this.deleteToken(),this.notifyAuthListeners(!1),(e=chrome==null?void 0:chrome.runtime)!=null&&e.sendMessage)try{await chrome.runtime.sendMessage({type:"USER_LOGGED_OUT"})}catch(t){this.logger.warn("Could not send logout message",{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"logout",error:t})}}catch(t){throw this.logger.error("Logout failed",t,{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"logout"}),t}}async getToken(){try{return await AU()}catch(e){return this.logger.error("Error getting auth token",e,{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"getToken"}),null}}async saveToken(e){try{const t={...e,fetched_at:Math.floor(Date.now())};await J_(t)}catch(t){throw this.logger.error("Error saving auth token",t,{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"saveToken"}),t}}async deleteToken(){try{await IU()}catch(e){throw this.logger.error("Error deleting auth token",e,{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"deleteToken"}),e}}isTokenValid(e){if(!e||!e.expires_in)return!1;const t=e;return t.fetched_at?Math.floor(Date.now())+6e4-t.fetched_at<t.expires_in*1e3:!1}async refreshToken(e){try{const t=e,n=Math.floor(Date.now())+6e4;return await PU(t,n,this.logger)}catch(t){throw this.logger.error("Error refreshing auth token",t,{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"refreshToken"}),t}}async isAuthenticated(){try{const e=await this.getToken();if(this.logger.debug("Checking authentication status",{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"isAuthenticated",token:e}),!e)return this.logger.debug("No token found - user is not authenticated",{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"isAuthenticated"}),!1;const t=this.isTokenValid(e);if(this.logger.debug("Authentication status checked",{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"isAuthenticated",isValid:t,token:e}),!t){this.logger.debug("Token is not valid - user is not authenticated",{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"isAuthenticated"});const n=await this.refreshToken(e);return this.logger.debug("Refreshed token",{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"isAuthenticated",refreshedToken:n}),this.isTokenValid(n)}return this.logger.debug("Token is valid - user is authenticated",{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"isAuthenticated"}),!0}catch(e){return this.logger.error("Error checking authentication status",e,{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"isAuthenticated"}),!1}}onAuthStateChanged(e){this.authListeners.add(e)}removeAuthStateListener(e){this.authListeners.delete(e)}notifyAuthListeners(e){this.logger.info("Notifying auth listeners",{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"notifyAuthListeners",isAuthenticated:e}),this.authListeners.forEach(t=>{try{t(e)}catch(n){this.logger.error("Error in auth state callback",n,{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"notifyAuthListeners"})}})}}class OU{constructor(e){H(this,"logger");H(this,"messageListeners",new Set);this.logger=e,this.setupMessageListeners()}setupMessageListeners(){var e;(e=chrome==null?void 0:chrome.runtime)!=null&&e.onMessage&&chrome.runtime.onMessage.addListener((t,n,s)=>{this.messageListeners.forEach(i=>{try{i(t)}catch(c){this.logger.error("Error in message callback",c,{sourceFile:"src/platforms/chrome/ChromeMessagingProvider.ts",sourceFunction:"setupMessageListeners"})}})})}async sendMessage(e){return new Promise((t,n)=>{var s;if(!((s=chrome==null?void 0:chrome.runtime)!=null&&s.sendMessage)){n(new Error("Chrome runtime not available"));return}chrome.runtime.sendMessage(e,i=>{var c;chrome.runtime.lastError?(this.logger.error("Error sending message",chrome.runtime.lastError,{sourceFile:"src/platforms/chrome/ChromeMessagingProvider.ts",sourceFunction:"sendMessage",message:e}),n(new Error(((c=chrome.runtime.lastError)==null?void 0:c.message)||"Unknown error"))):t(i)})})}onMessage(e){var n;const t=s=>{e(s)};this.messageListeners.add(t),(n=chrome==null?void 0:chrome.runtime)!=null&&n.onMessage&&chrome.runtime.onMessage.addListener(t)}removeMessageListener(e){this.messageListeners.forEach(t=>{var n;(n=chrome==null?void 0:chrome.runtime)!=null&&n.onMessage&&chrome.runtime.onMessage.removeListener(t)}),this.messageListeners.clear()}async sendTabMessage(e,t){return new Promise((n,s)=>{var i;if(!((i=chrome==null?void 0:chrome.tabs)!=null&&i.sendMessage)){s(new Error("Chrome tabs API not available"));return}chrome.tabs.sendMessage(e,t,c=>{var d;chrome.runtime.lastError?(this.logger.error("Error sending tab message",chrome.runtime.lastError,{sourceFile:"src/platforms/chrome/ChromeMessagingProvider.ts",sourceFunction:"sendTabMessage",message:t}),s(new Error(((d=chrome.runtime.lastError)==null?void 0:d.message)||"Unknown error"))):n(c)})})}}class DU{constructor(e){H(this,"logger");H(this,"eventListeners",new Map);H(this,"isInitialized",!1);this.logger=e}async initialize(){if(this.isInitialized){this.logger.info("Chrome platform already initialized",{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"initialize"});return}try{this.logger.info("Initializing Chrome platform...",{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"initialize"}),this.setupChromeEventListeners(),this.isInitialized=!0,this.logger.info("Chrome platform initialized successfully",{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"initialize"})}catch(e){throw this.logger.error("Failed to initialize Chrome platform",e,{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"initialize"}),e}}async cleanup(){try{this.logger.info("Cleaning up Chrome platform...",{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"cleanup"}),this.eventListeners.clear(),this.isInitialized=!1,this.logger.info("Chrome platform cleanup completed",{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"cleanup"})}catch(e){throw this.logger.error("Failed to cleanup Chrome platform",e,{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"cleanup"}),e}}async closeWindow(){try{typeof chrome<"u"&&chrome.sidePanel&&window.close(),this.logger.debug("Window close requested",{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"closeWindow"})}catch(e){throw this.logger.error("Failed to close window",e,{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"closeWindow"}),e}}onPlatformEvent(e,t){var n,s;switch(e){case"runtime.onInstalled":(n=chrome==null?void 0:chrome.runtime)!=null&&n.onInstalled&&chrome.runtime.onInstalled.addListener(t);break;case"runtime.onStartup":(s=chrome==null?void 0:chrome.runtime)!=null&&s.onStartup&&chrome.runtime.onStartup.addListener(t);break;default:this.logger.warn("Unknown platform event",{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"onPlatformEvent",event:e})}}setupChromeEventListeners(){var e,t,n;(e=chrome==null?void 0:chrome.runtime)!=null&&e.onStartup&&chrome.runtime.onStartup.addListener(()=>{this.emitPlatformEvent("startup")}),(t=chrome==null?void 0:chrome.runtime)!=null&&t.onSuspend&&chrome.runtime.onSuspend.addListener(()=>{this.emitPlatformEvent("suspend")}),(n=chrome==null?void 0:chrome.runtime)!=null&&n.onInstalled&&chrome.runtime.onInstalled.addListener(s=>{this.emitPlatformEvent("installed",s)})}emitPlatformEvent(e,...t){const n=this.eventListeners.get(e);n&&n.forEach(s=>{try{s(...t)}catch(i){this.logger.error(`Error in platform event callback for ${e}`,i,{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"emitPlatformEvent",event:e})}})}handleExtensionMessage(e,t,n){return this.logger.debug("Extension message received",{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"handleExtensionMessage",message:e,sender:t}),!0}handleContextMenuClick(e,t){this.logger.debug("Context menu clicked",{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"handleContextMenuClick",info:e,tab:t})}}const Mi=async r=>{try{return(await Yn.createServices()).storage}catch(e){return r.warn("Platform detection failed, falling back to Chrome storage",{sourceFile:"src/shared/lib/utils/storageUtils.tsx",error:e}),null}},LU=async r=>{const e=await Mi(r);e&&await e.clearLocal()},MU=async(r,e)=>{try{const t=await Yn.createServices();if(Yn.getCurrentPlatform()==="outlook"){r.debug("Token saving handled by OutlookAuthProvider",{sourceFile:"src/shared/lib/utils/storageUtils.tsx",sourceFunction:"saveAuthTokenPlatform"});return}const n=t.storage;n&&await n.setLocalItem("token",e)}catch(t){throw r.error("Failed to save auth token",t,{sourceFile:"src/shared/lib/utils/storageUtils.tsx",sourceFunction:"saveAuthTokenPlatform"}),t}},Mm=async r=>{try{const e=await Yn.createServices();if(Yn.getCurrentPlatform()==="outlook"){const n=await e.auth.getToken();return n?(r.info("Auth token retrieved from auth provider",{sourceFile:"src/shared/lib/utils/storageUtils.tsx",sourceFunction:"getAuthTokenPlatform",authToken:n}),n):null}const t=e.storage;return t?await t.getLocalItem("token"):null}catch(e){return r.error("Failed to get auth token",e,{sourceFile:"src/shared/lib/utils/storageUtils.tsx",sourceFunction:"getAuthTokenPlatform"}),null}},Yy=async r=>{try{const e=await Yn.createServices();if(Yn.getCurrentPlatform()==="outlook"){await e.auth.logout();return}const t=e.storage;t&&await t.removeLocalItem("token")}catch(e){r.error("Failed to delete auth token",e,{sourceFile:"src/shared/lib/utils/storageUtils.tsx",sourceFunction:"deleteAuthTokenPlatform"})}},iT=async(r,e)=>{const t=await Mi(r);if(t){const n={...e};(!n.id||n.id==="")&&(n.id=String(Date.now())),await t.setLocalItem("configuration",n)}},hy=async r=>{const e=await Mi(r);return e?await e.getLocalItem("configuration")||{id:"",preferences:{theme:"",notificationsEnabled:!1,language:""},profile:{name:"",organization:"",role:""},templateConfiguration:{tags:[],fieldSubstitutions:{}},integrations:[]}:{id:"",preferences:{theme:"",notificationsEnabled:!1,language:""},profile:{name:"",organization:"",role:""},templateConfiguration:{tags:[],fieldSubstitutions:{}},integrations:[]}},$U=async(r,e)=>{const t=await Mi(r);t&&await t.setLocalItem("emailTemplates",e)},aT=async r=>{const e=await Mi(r);return e?await e.getLocalItem("emailTemplates")||[]:[]},tg=async(r,e)=>{const t=await Mi(r);t&&await t.setLocalItem("integrations",e)},rg=async r=>{const e=await Mi(r);return e?await e.getLocalItem("integrations")||[]:[]},UU=async(r,e)=>{const t=await Mi(r);t&&await t.setLocalItem("orgTemplates",e)},lT=async r=>{const e=await Mi(r);return e?await e.getLocalItem("orgTemplates")||[]:[]},zU=async(r,e)=>{const t=await Mi(r);if(t){const n=new Date().toISOString();await t.setLocalItem("gmailConnectionStatus",e),await t.setLocalItem("gmailConnectionStatusTimestamp",n),r.debug("Saved Gmail connection status to storage",{sourceFile:"src/shared/lib/utils/storageUtils.tsx",isConnected:e,timestamp:n})}},HU=async r=>{const e=await Mi(r);if(e){const t=await e.getLocalItem("gmailConnectionStatus"),n=await e.getLocalItem("gmailConnectionStatusTimestamp");return r.debug("Retrieved Gmail connection status from storage",{sourceFile:"src/shared/lib/utils/storageUtils.tsx",isConnected:t,timestamp:n}),{isConnected:t,timestamp:n}}return{isConnected:null,timestamp:null}},cT=async r=>{const e=await Mi(r);e&&(await e.removeLocalItem("clients"),await e.removeLocalItem("integrations"))},oo="src/lib/utils/authUtils.tsx";async function uT(r,e,t,n){const s="withLock";if(r.current)return n.info(`${t} already in progress, waiting for completion...`,{sourceFile:oo,functionName:s}),await r.current;r.current=e();try{return await r.current}finally{r.current=null}}const BU={current:null};async function $w(r){return uT(BU,()=>GU(r),"Token validation",r)}async function GU(r){const e="performTokenValidation";let t=await Mm(r);if(!t)throw new Error("No authentication token found.");const n=Math.floor(Date.now()),s=t.expires_in*1e3+(t.fetched_at||0);if(r.info("Token expiry check",{sourceFile:oo,functionName:e,tokenExpiry:new Date(s).toISOString(),currentTime:new Date(n).toISOString(),timeUntilExpiry:s-n}),s-n<3e5)try{r.info("Token expired. Refreshing...",{sourceFile:oo,functionName:e}),t=await dT(t,n,r),r.info("New token received",{sourceFile:oo,functionName:e})}catch(i){throw r.error("Token refresh failed",i,{sourceFile:oo,functionName:e}),await Yy(r),new Error("Unauthorized: Failed to refresh token.")}return t}const jx=20,WU=500;function VU(r){return new Promise(e=>setTimeout(e,r))}function qU(r){var s;const e=r,t=(s=e==null?void 0:e.$metadata)==null?void 0:s.httpStatusCode;if(typeof t=="number")return t>=500||t===429||t===408;const n=["TimeoutError","NetworkError"];return typeof(e==null?void 0:e.name)=="string"&&n.includes(e.name),!0}async function dT(r,e,t){const n="refreshAuthToken",s=new Gb({region:"us-east-1"});for(let i=1;i<=jx;i++)try{t.info(`Refreshing auth token (attempt ${i})...`,{sourceFile:oo,functionName:n});const c=new V_({ClientId:yh,AuthFlow:"REFRESH_TOKEN_AUTH",AuthParameters:{REFRESH_TOKEN:r.refresh_token}}),p=(await s.send(c)).AuthenticationResult;if(!p)throw new Error("AuthenticationResult is missing in the response.");const{IdToken:m,AccessToken:g,RefreshToken:x,ExpiresIn:b,TokenType:S}=p;if(!m||!g||!b||!S)throw new Error("Missing required fields in AuthenticationResult.");const T={id_token:m,access_token:g,refresh_token:x||r.refresh_token,expires_in:b,token_type:S,fetched_at:e};return await MU(t,T),T}catch(c){const d=qU(c);if(t.error(`Error refreshing auth token (attempt ${i}/${jx})`,c,{sourceFile:oo,functionName:n,isTransient:d}),!d||i===jx)throw await Yy(t),new Error("Failed to refresh authentication token.");const p=WU*2**(i-1);t.warn(`Transient error refreshing token  retrying in ${p}ms`,{sourceFile:oo,functionName:n,attempt:i}),await VU(p)}throw new Error("Failed to refresh authentication token.")}const KU={current:null};async function YU(r){return uT(KU,()=>JU(r),"Force token refresh",r)}async function JU(r){const e="performForceTokenRefresh",t=await Mm(r);if(!t)throw new Error("No authentication token found.");const n=Math.floor(Date.now());r.info("Force refreshing token before opening options page",{sourceFile:oo,functionName:e,currentTime:new Date(n).toISOString()});const s=await dT(t,n,r);return r.info("Token force refresh successful",{sourceFile:oo,functionName:e}),s}async function Gr(r,e={},t){const n="fetchWithAuth",s=Date.now(),i=Date.now();let c=await $w(t);const d=Date.now()-i;e.headers={...e.headers,Authorization:`${c.id_token}`};const p=Date.now(),m=await fetch(r,e),g=Date.now()-p;if(t.info("fetchWithAuth completed",{sourceFile:oo,functionName:n,url:r.pathname,status:m.status,tokenValidationMs:d,networkFetchMs:g,totalMs:Date.now()-s}),m.status===401)try{t.info("Received 401, getting fresh token...",{sourceFile:oo,functionName:n});const x=Date.now();c=await $w(t);const b=Date.now()-x;t.info("New token received for retry",{sourceFile:oo,functionName:n,retryTokenMs:b}),e.headers&&typeof e.headers=="object"&&!Array.isArray(e.headers)&&(e.headers.Authorization=`${c.id_token}`);const S=Date.now(),T=await fetch(r,e),E=Date.now()-S;return t.info("fetchWithAuth retry completed",{sourceFile:oo,functionName:n,url:r.pathname,status:T.status,retryTokenMs:b,retryFetchMs:E,totalMs:Date.now()-s}),T}catch(x){throw t.error("Token refresh failed",x,{sourceFile:oo,functionName:n}),await Yy(t),new Error("Unauthorized: Failed to refresh token.")}return m}class XU{constructor(e){H(this,"logger");this.logger=e}getResourceURL(e){return chrome.runtime.getURL(e)}async queryTabs(e={}){return new Promise(t=>{chrome.tabs.query(e,n=>{t(n.map(s=>({id:s.id,url:s.url,active:s.active})))})})}async updateTab(e,t){return new Promise(n=>{chrome.tabs.update(e,t,()=>{n()})})}async reloadTab(e){return new Promise(t=>{chrome.tabs.reload(e,void 0,()=>{t()})})}async openOptionsPage(){return new Promise(async e=>{try{const t=await YU(this.logger);let n=rh;t!=null&&t.id_token&&(n+=`?token=${encodeURIComponent(t.id_token)}`),this.logger.info("Opening external options page",{sourceFile:"src/platforms/chrome/ChromeTabsProvider.ts",functionName:"openOptionsPage",url:rh,hasToken:!!(t!=null&&t.id_token)}),chrome.tabs.create({url:n},()=>{e()})}catch(t){this.logger.error("Failed to open options page",t,{sourceFile:"src/platforms/chrome/ChromeTabsProvider.ts",functionName:"openOptionsPage"}),chrome.tabs.create({url:rh},()=>{e()})}})}async openURL(e,t="_blank"){return new Promise(n=>{t==="_blank"?chrome.tabs.create({url:e},()=>{n()}):(window.open(e,t),n())})}}function Zv(r){const t=new DOMParser().parseFromString(r,"text/html"),n={white:"#ffffff",black:"#000000",red:"#e60000",orange:"#f90",yellow:"#ff0",green:"#008a00",blue:"#06c",purple:"#93f"};t.querySelectorAll("[class]").forEach(m=>{const g=m.classList,x={},b=[],S=m.getAttribute("style");S&&S.split(";").forEach(E=>{const[C,R]=E.split(":").map(A=>A.trim());C&&R&&(x[C]=R)});for(const E of["left","center","right","justify"]){const C=`ql-align-${E}`;if(g.contains(C)){const R=m.tagName.toLowerCase();R==="li"?E==="center"?(x["text-align"]="center",x["list-style-position"]="inside"):E==="right"?(x["text-align"]="right",x["list-style-position"]="inside"):E==="left"?x["text-align"]="left":E==="justify"&&(x["text-align"]="justify"):R==="ol"||R==="ul"?E==="center"?(x["margin-left"]="auto",x["margin-right"]="auto",x["padding-left"]="40px",x.width="fit-content"):E==="right"?(x["margin-left"]="auto",x["margin-right"]="0",x["padding-left"]="40px",x.width="fit-content"):E==="left"&&(x["margin-left"]="0",x["margin-right"]="auto"):x["text-align"]=E,b.push(C)}}g.contains("ql-font-serif")&&(x["font-family"]="Georgia, Times New Roman, serif",b.push("ql-font-serif")),g.contains("ql-font-monospace")&&(x["font-family"]="Monaco, Courier New, monospace",b.push("ql-font-monospace"));const T={"ql-size-small":"0.75em","ql-size-large":"1.5em","ql-size-huge":"2.5em"};for(const[E,C]of Object.entries(T))g.contains(E)&&(x["font-size"]=C,b.push(E));for(const[E,C]of Object.entries(n)){const R=`ql-color-${E}`;g.contains(R)&&(x.color=C,b.push(R))}for(const[E,C]of Object.entries(n)){const R=`ql-bg-${E}`;g.contains(R)&&(x["background-color"]=C,b.push(R))}if(Object.keys(x).length>0){const E=Object.entries(x).map(([C,R])=>`${C}: ${R}`).join("; ");m.setAttribute("style",E)}b.forEach(E=>{g.remove(E)}),g.length===0&&m.removeAttribute("class")});const i=t.createTreeWalker(t.body,NodeFilter.SHOW_TEXT,null),c=[];let d;for(;d=i.nextNode();)if(d.nodeValue&&d.nodeValue.includes("	")){const m=d.nodeValue.replace(/\t/g,"");c.push({node:d,newValue:m})}return c.forEach(({node:m,newValue:g})=>{m.nodeValue=g}),t.querySelectorAll("ul, ol").forEach(m=>{var S,T;const g=Array.from(m.children);if(g.length===0)return;const x=g.some(E=>E.getAttribute("data-list")==="bullet"),b=g.some(E=>E.getAttribute("data-list")==="ordered");if(x&&b){const E=t.createDocumentFragment();let C=null,R=null;g.forEach(A=>{const F=A.getAttribute("data-list")||"bullet";if(R!==F||!C){C=t.createElement(F==="ordered"?"ol":"ul");const P=m.getAttribute("style");P&&C.setAttribute("style",P);const L=m.getAttribute("class");L&&C.setAttribute("class",L),E.appendChild(C),R=F}C.appendChild(A.cloneNode(!0))}),(S=m.parentNode)==null||S.replaceChild(E,m)}else if(b&&m.tagName.toLowerCase()==="ul"){const E=t.createElement("ol");for(Array.from(m.attributes).forEach(C=>{E.setAttribute(C.name,C.value)});m.firstChild;)E.appendChild(m.firstChild);(T=m.parentNode)==null||T.replaceChild(E,m)}}),t.body.innerHTML}class QU{constructor(e){H(this,"logger");this.logger=e}async executeScript(e){var t;try{return(t=(await chrome.scripting.executeScript({target:e.target,func:e.func,args:e.args}))[0])==null?void 0:t.result}catch(n){throw this.logger.error("Error executing script",n,{sourceFile:"src/platforms/chrome/ChromeContentScriptProvider.ts",sourceFunction:"executeScript"}),n}}async insertContentIntoComposeBox(e){try{const t=Zv(e),s=(await chrome.tabs.query({active:!0,currentWindow:!0}))[0];if(!(s!=null&&s.id))throw new Error("No active tab found or tab ID is undefined");await chrome.scripting.executeScript({target:{tabId:s.id},func:i=>{function c(){return document.querySelector('div[role="textbox"][aria-label="Message Body"]')||document.querySelector('div[aria-label="Message body, press Alt+F10 to exit"]')}function d(x){var E;const b=window.getSelection();let S=null,T=0;if(b&&b.rangeCount>0&&(S=b.getRangeAt(0).cloneRange(),x.contains(S.startContainer)||x===S.startContainer)){const C=document.createTreeWalker(x,NodeFilter.SHOW_TEXT,null,!1);let R=0,A;for(;A=C.nextNode();)if(A===S.startContainer){R+=S.startOffset;break}else R+=((E=A.textContent)==null?void 0:E.length)||0;T=R}return{selection:b,range:S,offset:T}}function p(x,b){var S;try{const{selection:T,range:E,offset:C}=b;if(!T)return;if(E&&x.contains(E.startContainer)){T.removeAllRanges(),T.addRange(E);return}if(C>0){const A=document.createTreeWalker(x,NodeFilter.SHOW_TEXT,null,!1);let F=0,P;for(;P=A.nextNode();){const L=((S=P.textContent)==null?void 0:S.length)||0;if(F+L>=C){const G=document.createRange();G.setStart(P,C-F),G.collapse(!0),T.removeAllRanges(),T.addRange(G);return}F+=L}}const R=document.createRange();R.selectNodeContents(x),R.collapse(!1),T.removeAllRanges(),T.addRange(R)}catch(T){console.warn("Could not restore cursor position:",T)}}function m(x,b){document.execCommand("insertHTML",!1,b)}const g=c();if(!g)throw new Error("Compose box not found");try{const x=d(g);g.focus(),p(g,x),navigator.clipboard&&navigator.clipboard.writeText?navigator.clipboard.writeText(i).then(()=>{document.execCommand("paste")}).catch(()=>{m(g,i)}):m(g,i)}catch(x){throw new Error("Error during paste operation: "+x)}},args:[t]})}catch(t){throw this.logger.error("Error inserting content into compose box",t,{sourceFile:"src/platforms/chrome/ChromeContentScriptProvider.ts",sourceFunction:"insertContentIntoComposeBox"}),t}}}class ZU{constructor(e){H(this,"logger");this.logger=e}async launchWebAuthFlow(e){try{const t=await chrome.identity.launchWebAuthFlow(e);if(!t)throw new Error("Authentication was cancelled or failed");return t}catch(t){throw this.logger.error("Error launching web auth flow",t,{sourceFile:"src/platforms/chrome/ChromeIdentityProvider.ts",sourceFunction:"launchWebAuthFlow"}),t}}async initiateOAuth(e,t){return this.launchWebAuthFlow({url:e,interactive:!0})}}const e5="CandleLogsDB",t5=1,sd="logs",r5=5e3,n5=500,dC={ERROR:1,WARN:2,INFO:3,DEBUG:4};let Gp=null;function Uw(){return Gp||(Gp=new Promise((r,e)=>{console.log("[Logger] Initializing IndexedDB...");const t=indexedDB.open(e5,t5);t.onupgradeneeded=n=>{console.log("[Logger] IndexedDB upgrade needed.");const s=n.target.result;if(!s.objectStoreNames.contains(sd)){console.log(`[Logger] Creating object store: ${sd}`);const i=s.createObjectStore(sd,{keyPath:"id",autoIncrement:!0});console.log("[Logger] Creating indexes: timestamp, level, chromeContext"),i.createIndex("timestamp","timestamp",{unique:!1}),i.createIndex("level","level",{unique:!1}),i.createIndex("chromeContext","chromeContext",{unique:!1})}},t.onsuccess=n=>{console.log("[Logger] IndexedDB initialized successfully."),r(n.target.result)},t.onerror=n=>{console.error("[Logger] IndexedDB initialization failed:",n.target.error),Gp=null,e(n.target.error)},t.onblocked=()=>{console.warn("[Logger] IndexedDB initialization blocked. Close other tabs using the database.")}}),Gp)}Uw().catch(r=>console.error("[Logger] Initial DB connection failed:",r));const ni=class ni{constructor(e){H(this,"context");H(this,"minLevel","INFO");this.context=e||"unknown"}async writeLog(e,t,n,s){if(dC[e]>dC[this.minLevel])return;const i=(n==null?void 0:n.sourceFile)||"unknown",c=n==null?void 0:n.sourceFunction;let d;s&&(s instanceof Error?d={name:s.name,message:s.message,stack:s.stack}:d=s);const{sourceFile:p,sourceFunction:m,...g}=n||{},x={...d?{error:d}:{},...g};{const T=[`[${e}] [${this.context}] [${i}${c?` (${c})`:""}]: ${t}`];switch(s&&T.push(s),Object.keys(g).length>0&&T.push(g),e){case"DEBUG":console.debug(...T);break;case"INFO":console.info(...T);break;case"WARN":console.warn(...T);break;case"ERROR":console.error(...T);break}}const b={timestamp:new Date().toISOString(),level:e,message:t,chromeContext:this.context,sourceFile:i,...c&&{sourceFunction:c},details:Object.keys(x).length>0?x:void 0};try{const T=(await Uw()).transaction(sd,"readwrite"),C=T.objectStore(sd).add(b);return new Promise((R,A)=>{C.onsuccess=()=>{R()},C.onerror=F=>{console.error("[Logger] Failed to write log to IndexedDB:",F.target.error,b),A(F.target.error)},T.onerror=F=>{console.error("[Logger] Transaction error writing log:",F.target.error,b),A(F.target.error)},T.onabort=F=>{console.warn("[Logger] Transaction aborted writing log:",F.target.error,b),A(new Error("Transaction aborted"))}})}catch(S){throw console.error("[Logger] Error obtaining DB or starting transaction:",S,b),S}}static async _cleanupOldLogs(){if(this._isCleaning){console.info("[Logger] Cleanup already in progress, skipping.");return}console.info("[Logger] Starting log cleanup check..."),this._isCleaning=!0;try{const t=(await Uw()).transaction(sd,"readwrite"),n=t.objectStore(sd),s=n.count(),i=await new Promise((m,g)=>{s.onsuccess=()=>m(s.result),s.onerror=x=>{console.error("[Logger] Failed to count logs for cleanup:",x.target.error),g(x.target.error)}});if(i<=this.MAX_LOG_ENTRIES){console.info(`[Logger] Log count (${i}) within limit (${this.MAX_LOG_ENTRIES}). No cleanup needed.`);return}let c=i-this.MAX_LOG_ENTRIES;console.warn(`[Logger] Log count (${i}) exceeds limit (${this.MAX_LOG_ENTRIES}). Deleting ${c} oldest logs.`);const d=n.openCursor();let p=0;await new Promise((m,g)=>{d.onsuccess=x=>{const b=x.target.result;if(b&&c>0){const S=b.delete();S.onsuccess=()=>{p++,c--,c>0?b.continue():m()},S.onerror=T=>{console.error("[Logger] Error deleting log entry during cleanup:",T.target.error,"Key:",b.primaryKey),b.continue()}}else m()},d.onerror=x=>{console.error("[Logger] Error opening cursor for cleanup:",x.target.error),g(x.target.error)}}),await new Promise((m,g)=>{t.oncomplete=()=>{console.info(`[Logger] Log cleanup finished. Deleted ${p} entries.`),m()},t.onerror=x=>{console.error("[Logger] Transaction error during cleanup:",x.target.error),g(x.target.error)},t.onabort=x=>{console.warn("[Logger] Transaction aborted during cleanup:",x.target.error),g(new Error("Cleanup transaction aborted"))}})}catch(e){console.error("[Logger] Error during log cleanup process:",e)}finally{this._isCleaning=!1,console.info("[Logger] Log cleanup check finished.")}}_triggerCleanupCheck(){if(ni._writeCount++,ni._writeCount>=ni.CLEANUP_TRIGGER_COUNT&&!ni._isCleaning){const e=ni._writeCount;ni._writeCount=0,console.info(`[Logger] Write count reached ${e}. Triggering background cleanup.`),ni._cleanupOldLogs().catch(t=>{console.error("[Logger] Background cleanup process failed:",t)})}}async debug(e,t){try{await this.writeLog("DEBUG",e,t),this._triggerCleanupCheck()}catch{}}async info(e,t){try{await this.writeLog("INFO",e,t),this._triggerCleanupCheck()}catch{}}async warn(e,t){try{await this.writeLog("WARN",e,t),this._triggerCleanupCheck()}catch{}}async error(e,t,n){try{await this.writeLog("ERROR",e,n,t),this._triggerCleanupCheck()}catch{}}};H(ni,"_writeCount",0),H(ni,"_isCleaning",!1),H(ni,"MAX_LOG_ENTRIES",r5),H(ni,"CLEANUP_TRIGGER_COUNT",n5);let zw=ni;class s5{constructor(e){H(this,"logger");this.logger=new zw(e)}async debug(e,t){return this.logger.debug(e,t)}async info(e,t){return this.logger.info(e,t)}async warn(e,t){return this.logger.warn(e,t)}async error(e,t,n){return this.logger.error(e,t,n)}setMinLevel(e){console.warn("[ChromeLoggingProvider] setMinLevel not yet implemented - using hardcoded INFO level")}getMinLevel(){return"INFO"}}function o5(r="unknown"){const e=new s5(r==="background"?"background":"options");return{storage:new eO(e),data:new tO(e),auth:new FU(e),messaging:new OU(e),lifecycle:new DU(e),tabs:new XU(e),contentScript:new QU(e),identity:new ZU(e),logging:e}}class i5{constructor(e){H(this,"logger");H(this,"_changeListeners",[]);H(this,"onChanged",e=>{this.logger.warn("onChanged listener not fully supported with Office roaming settings. Callbacks will be stored but not automatically invoked.",{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"onChanged"}),this._changeListeners.push(e)});H(this,"removeChangeListener",e=>{this.logger.warn("removeChangeListener not fully supported with Office roaming settings.",{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"removeChangeListener"}),this._changeListeners=this._changeListeners.filter(t=>t!==e)});this.logger=e}async getLocalItem(e){var t;try{if(typeof localStorage<"u"){const n=localStorage.getItem(e);if(n){const s=JSON.parse(n);return this.logger.debug(`Retrieved local item with key: ${e}`,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"getLocalItem"}),s}}else if((t=Office==null?void 0:Office.context)!=null&&t.roamingSettings){const n=Office.context.roamingSettings.get(e);if(n){const s=JSON.parse(n);return this.logger.debug(`Retrieved item from roaming settings with key: ${e}`,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"getLocalItem"}),s}}return null}catch(n){return this.logger.error(`Error retrieving local item with key: ${e}`,n,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"getLocalItem"}),null}}async setLocalItem(e,t){var n;try{if(typeof localStorage<"u")localStorage.setItem(e,JSON.stringify(t)),this.logger.debug(`Stored local item with key: ${e}`,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"setLocalItem"}),this._notifyChangeListeners({[e]:{newValue:t}});else if((n=Office==null?void 0:Office.context)!=null&&n.roamingSettings)Office.context.roamingSettings.set(e,JSON.stringify(t)),await new Promise((s,i)=>{Office.context.roamingSettings.saveAsync(c=>{var d;c.status===Office.AsyncResultStatus.Succeeded?(this.logger.debug(`Stored item in roaming settings with key: ${e}`,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"setLocalItem"}),s()):i(new Error(((d=c.error)==null?void 0:d.message)||"Failed to save roaming settings"))})}),this._notifyChangeListeners({[e]:{newValue:t}});else throw new Error("No storage mechanism available")}catch(s){throw this.logger.error(`Error storing local item with key: ${e}`,s,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"setLocalItem"}),s}}async removeLocalItem(e){var t;try{const n=await this.getLocalItem(e);if(typeof localStorage<"u")localStorage.removeItem(e),this.logger.debug(`Removed local item with key: ${e}`,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"removeLocalItem"}),this._notifyChangeListeners({[e]:{oldValue:n,newValue:void 0}});else if((t=Office==null?void 0:Office.context)!=null&&t.roamingSettings)Office.context.roamingSettings.remove(e),await new Promise((s,i)=>{Office.context.roamingSettings.saveAsync(c=>{var d;c.status===Office.AsyncResultStatus.Succeeded?(this.logger.debug(`Removed item from roaming settings with key: ${e}`,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"removeLocalItem"}),s()):i(new Error(((d=c.error)==null?void 0:d.message)||"Failed to save roaming settings"))})}),this._notifyChangeListeners({[e]:{oldValue:n,newValue:void 0}});else throw new Error("No storage mechanism available")}catch(n){throw this.logger.error(`Error removing local item with key: ${e}`,n,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"removeLocalItem"}),n}}async clearLocal(){var e;try{if(typeof localStorage<"u")localStorage.clear(),this.logger.info("Cleared local storage",{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"clearLocal"}),this._notifyChangeListeners({});else if((e=Office==null?void 0:Office.context)!=null&&e.roamingSettings){const t=await this.getAllKeys(),n={};for(const s of t){const i=await this.getLocalItem(s);Office.context.roamingSettings.remove(s),n[s]={oldValue:i,newValue:void 0}}await new Promise((s,i)=>{Office.context.roamingSettings.saveAsync(c=>{var d;c.status===Office.AsyncResultStatus.Succeeded?(this.logger.info("Cleared all roaming settings",{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"clearLocal"}),s()):i(new Error(((d=c.error)==null?void 0:d.message)||"Failed to save roaming settings"))})}),this._notifyChangeListeners(n)}else throw new Error("No storage mechanism available")}catch(t){throw this.logger.error("Error clearing local storage",t,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"clearLocal"}),t}}async getAllKeys(){var e;try{if(typeof localStorage<"u"){const t=Object.keys(localStorage);return this.logger.debug(`Retrieved ${t.length} keys from storage`,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"getAllKeys"}),t}else if((e=Office==null?void 0:Office.context)!=null&&e.roamingSettings)return this.logger.warn("getAllKeys not fully supported with Office roaming settings",{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"getAllKeys"}),[];return[]}catch(t){return this.logger.error("Error getting all keys",t,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"getAllKeys"}),[]}}_notifyChangeListeners(e){this._changeListeners.forEach(t=>{try{t(e)}catch(n){this.logger.error("Error in storage change callback",n,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"_notifyChangeListeners"})}})}}class a5{constructor(e){H(this,"logger");H(this,"threadListeners",new Set);H(this,"currentThread",null);H(this,"lastKnownThreadId");H(this,"debounceTimer",null);this.logger=e,this.initializeOutlookListeners()}initializeOutlookListeners(){var e,t,n,s;(t=(e=Office==null?void 0:Office.context)==null?void 0:e.mailbox)!=null&&t.addHandlerAsync&&Office.context.mailbox.addHandlerAsync(Office.EventType.ItemChanged,this.debouncedHandleItemChanged.bind(this)),(s=(n=Office==null?void 0:Office.context)==null?void 0:n.mailbox)!=null&&s.item&&setTimeout(()=>this.handleItemChanged(),100)}debouncedHandleItemChanged(){this.debounceTimer&&clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout(()=>{this.handleItemChanged(),this.debounceTimer=null},50)}async handleItemChanged(){var e,t;try{const n=await this.getCurrentThread(),s=n==null?void 0:n.threadId,i=s!==((e=this.currentThread)==null?void 0:e.threadId);if(n&&this.currentThread&&!i){const c=JSON.stringify(this.currentThread.participants.sort()),d=JSON.stringify(n.participants.sort());if(c===d)return}i||!this.currentThread&&n?(this.logger.info("Thread changed or initialized",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"handleItemChanged",oldThreadId:(t=this.currentThread)==null?void 0:t.threadId,newThreadId:s}),this.currentThread=n,this.lastKnownThreadId=s,this.notifyThreadListeners(n)):n&&this.currentThread?this.hasThreadContentChanged(this.currentThread,n)?(this.logger.info("Thread content updated",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"handleItemChanged",threadId:s}),this.currentThread=n,this.notifyThreadListeners(n)):this.currentThread=n:this.logger.info("No meaningful thread change detected",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"handleItemChanged",hasNewThread:!!n,hasCurrentThread:!!this.currentThread})}catch(n){this.logger.error("Error handling item change",n,{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"handleItemChanged"})}}hasThreadContentChanged(e,t){var i,c;if(e.subject!==t.subject)return!0;if(e.messages.length!==t.messages.length)return t.messages.length>e.messages.length;const n=new Set(e.participants),s=new Set(t.participants);if(n.size!==s.size)return!0;for(const d of n)if(!s.has(d))return!0;for(let d=0;d<Math.min(e.messages.length,t.messages.length);d++){const p=e.messages[d],m=t.messages[d],g=((i=p.body)==null?void 0:i.trim())||"",x=((c=m.body)==null?void 0:c.trim())||"";if(g!==x&&g.length>0&&x.length>0||p.from!==m.from)return!0}return!1}shouldPreserveThreadHistory(e){var t,n,s;return!!(this.currentThread&&this.currentThread.threadId===e&&this.currentThread.messages.length>0&&((n=(t=Office==null?void 0:Office.context)==null?void 0:t.mailbox)!=null&&n.item)&&(Office.context.mailbox.item.itemType==="message"||(s=Office.context.mailbox.item.itemClass)!=null&&s.includes("IPM.Note")))}async getCurrentThread(){return new Promise(e=>{var t,n;if(!((n=(t=Office==null?void 0:Office.context)==null?void 0:t.mailbox)!=null&&n.item)){this.logger.info("No Office context or mailbox item available",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getCurrentThread"}),e(null);return}try{const s=Office.context.mailbox.item;this.logger.info("Getting current thread",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getCurrentThread",itemType:s.itemType,itemClass:s.itemClass,subject:s.subject,hasConversationId:!!s.conversationId,hasGetConversationIndexAsync:!!s.getConversationIndexAsync,hasCurrentThread:!!this.currentThread,lastKnownThreadId:this.lastKnownThreadId}),this.getThreadId(s).then(i=>{if(i)return this.getItemDetails(s,i);this.logger.warn("Could not determine thread ID",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getCurrentThread"}),e(null)}).then(i=>e(i||null)).catch(i=>{this.logger.error("Error getting current thread",i,{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getCurrentThread"}),e(null)})}catch(s){this.logger.error("Error in getCurrentThread",s,{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getCurrentThread"}),e(null)}})}normalizeSubject(e){return e?e.replace(/^((re|fw|fwd):\s*)+/i,"").trim():""}async getThreadId(e){return new Promise(t=>{if(e.conversationId){const n=e.conversationId;this.logger.info("Using conversationId as thread ID",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getThreadId",conversationId:n}),this.lastKnownThreadId=n,t(n);return}if(e.getConversationIndexAsync)e.getConversationIndexAsync(n=>{if(n.status===Office.AsyncResultStatus.Succeeded&&n.value)this.logger.info("Using conversation index as thread ID",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getThreadId",conversationIndex:n.value}),this.lastKnownThreadId=n.value,t(n.value);else{this.logger.info("getConversationIndexAsync failed, trying other methods",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getThreadId",error:n.error});const s=e.subject,i=this.currentThread?this.normalizeSubject(this.currentThread.subject):"",c=this.normalizeSubject(s);if(s&&this.currentThread&&i===c&&this.lastKnownThreadId){this.logger.info("Using cached thread ID based on normalized subject match (async failed)",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getThreadId",subject:s,cachedThreadId:this.lastKnownThreadId}),t(this.lastKnownThreadId);return}const d=e.itemId||this.lastKnownThreadId||"unknown";t(d)}});else{const n=e.subject,s=this.currentThread?this.normalizeSubject(this.currentThread.subject):"",i=this.normalizeSubject(n);if(n&&this.currentThread&&s===i&&this.lastKnownThreadId)this.logger.info("Using cached thread ID based on normalized subject match (no async method)",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getThreadId",subject:n,cachedThreadId:this.lastKnownThreadId}),t(this.lastKnownThreadId||null);else{const c=e.itemId||this.lastKnownThreadId||"unknown";this.logger.info("Using final fallback ID as thread ID",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getThreadId",fallbackId:c}),t(c)}}})}async getCurrentThreadId(){return new Promise(e=>{var n,s;if(!((s=(n=Office==null?void 0:Office.context)==null?void 0:n.mailbox)!=null&&s.item)){e(this.lastKnownThreadId||null);return}const t=Office.context.mailbox.item;this.getThreadId(t).then(e).catch(()=>e(this.lastKnownThreadId||null))})}onThreadChanged(e){this.threadListeners.add(e)}removeThreadListener(e){this.threadListeners.delete(e)}destroy(){this.debounceTimer&&(clearTimeout(this.debounceTimer),this.debounceTimer=null),this.threadListeners.clear()}notifyThreadListeners(e){this.threadListeners.forEach(t=>{try{t(e)}catch(n){this.logger.error("Error in thread change callback",n,{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"notifyThreadListeners"})}})}async getItemDetails(e,t){return new Promise(async n=>{var s;try{const i=e;let c="No Subject";if(typeof i.subject=="string")c=i.subject||"No Subject";else if(i.subject&&typeof i.subject.getAsync=="function")try{c=await new Promise((g,x)=>{i.subject.getAsync(b=>{b.status===Office.AsyncResultStatus.Succeeded?g(b.value):x(b.error)})})||"No Subject"}catch{}let d=this.extractParticipants(i);try{const m=await this.extractAsyncParticipants(i),g=new Set([...d,...m]);d=Array.from(g)}catch(m){this.logger.warn("Could not extract async participants",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getItemDetails",error:m})}const p={from:this.getFromAddress(i),timestamp:this.getTimestamp(i),subject:c,body:"",html:""};if(i.body&&i.body.getAsync)i.body.getAsync(Office.CoercionType.Html,m=>{var x;m.status===Office.AsyncResultStatus.Succeeded&&(p.html=m.value,p.body=this.stripHtml(m.value));const g=this.shouldPreserveThreadHistory(t)?[...((x=this.currentThread)==null?void 0:x.messages)||[],p]:[p];n({threadId:t,messages:g,subject:c,participants:d})});else{const m=this.shouldPreserveThreadHistory(t)?[...((s=this.currentThread)==null?void 0:s.messages)||[],p]:[p];n({threadId:t,messages:m,subject:c,participants:d})}}catch(i){this.logger.error("Error getting item details",i,{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getItemDetails",threadId:t}),n(null)}})}extractParticipants(e){const t=new Set;try{const n=this.getFromAddress(e);n&&n!=="Unknown"&&t.add(n),e.sender&&e.sender.emailAddress&&t.add(e.sender.emailAddress),e.to&&Array.isArray(e.to)&&e.to.forEach(s=>{s.emailAddress&&t.add(s.emailAddress)}),e.cc&&Array.isArray(e.cc)&&e.cc.forEach(s=>{s.emailAddress&&t.add(s.emailAddress)}),e.bcc&&Array.isArray(e.bcc)&&e.bcc.forEach(s=>{s.emailAddress&&t.add(s.emailAddress)})}catch(n){this.logger.warn("Error extracting participants",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"extractParticipants",error:n})}return Array.from(t)}async extractAsyncParticipants(e){const t=new Set;try{const n=[];e.to&&typeof e.to.getAsync=="function"&&n.push(this.getRecipientsAsync(e.to,"to")),e.cc&&typeof e.cc.getAsync=="function"&&n.push(this.getRecipientsAsync(e.cc,"cc")),e.bcc&&typeof e.bcc.getAsync=="function"&&n.push(this.getRecipientsAsync(e.bcc,"bcc")),(await Promise.allSettled(n)).forEach(i=>{i.status==="fulfilled"&&i.value.forEach(c=>t.add(c))})}catch(n){this.logger.warn("Error extracting async participants",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"extractAsyncParticipants",error:n})}return Array.from(t)}getRecipientsAsync(e,t){return new Promise(n=>{e.getAsync(s=>{if(s.status===Office.AsyncResultStatus.Succeeded){const i=s.value.map(c=>c.emailAddress).filter(c=>c);n(i)}else this.logger.warn(`Error getting ${t} recipients`,{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getRecipientsAsync",error:s.error}),n([])})})}getFromAddress(e){try{return e.from&&e.from.emailAddress?e.from.emailAddress:e.sender&&e.sender.emailAddress?e.sender.emailAddress:"Unknown"}catch(t){return this.logger.warn("Error getting from address",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getFromAddress",error:t}),"Unknown"}}getCurrentUserEmail(){var e,t,n;try{if((n=(t=(e=Office==null?void 0:Office.context)==null?void 0:e.mailbox)==null?void 0:t.userProfile)!=null&&n.emailAddress){const s=Office.context.mailbox.userProfile.emailAddress;return this.logger.info("Retrieved current user email from Outlook API",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getCurrentUserEmail",userEmail:s}),s}return this.logger.warn("userProfile.emailAddress not available",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getCurrentUserEmail"}),null}catch(s){return this.logger.error("Error getting current user email",s,{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getCurrentUserEmail"}),null}}getTimestamp(e){try{return e.dateTimeCreated?e.dateTimeCreated.toISOString():e.dateTimeModified?e.dateTimeModified.toISOString():new Date().toISOString()}catch(t){return this.logger.warn("Error getting timestamp",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getTimestamp",error:t}),new Date().toISOString()}}stripHtml(e){try{return e.replace(/<[^>]*>/g,"").trim()}catch(t){return this.logger.warn("Error stripping HTML",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"stripHtml",error:t}),e}}}const l5=async(r,e,t)=>({operation:pd(e).operation,region:await sa(r.region)()||(()=>{throw new Error("expected `region` to be configured for `aws.auth#sigv4`")})()});function c5(r){return{schemeId:"aws.auth#sigv4",signingProperties:{name:"cognito-identity",region:r.region},propertiesExtractor:(e,t)=>({signingProperties:{config:e,context:t}})}}function Rv(r){return{schemeId:"smithy.api#noAuth"}}const u5=r=>{const e=[];switch(r.operation){case"GetCredentialsForIdentity":{e.push(Rv());break}case"GetId":{e.push(Rv());break}case"GetOpenIdToken":{e.push(Rv());break}case"UnlinkIdentity":{e.push(Rv());break}default:e.push(c5(r))}return e},d5=r=>{const e=d1(r);return Object.assign(e,{authSchemePreference:sa(r.authSchemePreference??[])})},f5=r=>Object.assign(r,{useDualstackEndpoint:r.useDualstackEndpoint??!1,useFipsEndpoint:r.useFipsEndpoint??!1,defaultSigningName:"cognito-identity"}),h5="3.981.0",p5={version:h5},fT="required",Hs="fn",Bs="argv",xh="ref",fC=!0,hC="isSet",$m="booleanEquals",Uf="error",Da="endpoint",Il="tree",X_="PartitionResult",Q_="getAttr",Wp="stringEquals",pC={[fT]:!1,type:"string"},mC={[fT]:!0,default:!1,type:"boolean"},gC={[xh]:"Endpoint"},hT={[Hs]:$m,[Bs]:[{[xh]:"UseFIPS"},!0]},pT={[Hs]:$m,[Bs]:[{[xh]:"UseDualStack"},!0]},On={},fm={[xh]:"Region"},vC={[Hs]:Q_,[Bs]:[{[xh]:X_},"supportsFIPS"]},mT={[xh]:X_},yC={[Hs]:$m,[Bs]:[!0,{[Hs]:Q_,[Bs]:[mT,"supportsDualStack"]}]},xC=[hT],wC=[pT],bC=[fm],m5={parameters:{Region:pC,UseDualStack:mC,UseFIPS:mC,Endpoint:pC},rules:[{conditions:[{[Hs]:hC,[Bs]:[gC]}],rules:[{conditions:xC,error:"Invalid Configuration: FIPS and custom endpoint are not supported",type:Uf},{conditions:wC,error:"Invalid Configuration: Dualstack and custom endpoint are not supported",type:Uf},{endpoint:{url:gC,properties:On,headers:On},type:Da}],type:Il},{conditions:[{[Hs]:hC,[Bs]:bC}],rules:[{conditions:[{[Hs]:"aws.partition",[Bs]:bC,assign:X_}],rules:[{conditions:[hT,pT],rules:[{conditions:[{[Hs]:$m,[Bs]:[fC,vC]},yC],rules:[{conditions:[{[Hs]:Wp,[Bs]:[fm,"us-east-1"]}],endpoint:{url:"https://cognito-identity-fips.us-east-1.amazonaws.com",properties:On,headers:On},type:Da},{conditions:[{[Hs]:Wp,[Bs]:[fm,"us-east-2"]}],endpoint:{url:"https://cognito-identity-fips.us-east-2.amazonaws.com",properties:On,headers:On},type:Da},{conditions:[{[Hs]:Wp,[Bs]:[fm,"us-west-1"]}],endpoint:{url:"https://cognito-identity-fips.us-west-1.amazonaws.com",properties:On,headers:On},type:Da},{conditions:[{[Hs]:Wp,[Bs]:[fm,"us-west-2"]}],endpoint:{url:"https://cognito-identity-fips.us-west-2.amazonaws.com",properties:On,headers:On},type:Da},{endpoint:{url:"https://cognito-identity-fips.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:On,headers:On},type:Da}],type:Il},{error:"FIPS and DualStack are enabled, but this partition does not support one or both",type:Uf}],type:Il},{conditions:xC,rules:[{conditions:[{[Hs]:$m,[Bs]:[vC,fC]}],rules:[{endpoint:{url:"https://cognito-identity-fips.{Region}.{PartitionResult#dnsSuffix}",properties:On,headers:On},type:Da}],type:Il},{error:"FIPS is enabled but this partition does not support FIPS",type:Uf}],type:Il},{conditions:wC,rules:[{conditions:[yC],rules:[{conditions:[{[Hs]:Wp,[Bs]:["aws",{[Hs]:Q_,[Bs]:[mT,"name"]}]}],endpoint:{url:"https://cognito-identity.{Region}.amazonaws.com",properties:On,headers:On},type:Da},{endpoint:{url:"https://cognito-identity.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:On,headers:On},type:Da}],type:Il},{error:"DualStack is enabled but this partition does not support DualStack",type:Uf}],type:Il},{endpoint:{url:"https://cognito-identity.{Region}.{PartitionResult#dnsSuffix}",properties:On,headers:On},type:Da}],type:Il}],type:Il},{error:"Invalid Configuration: Missing Region",type:Uf}]},g5=m5,v5=new WN({size:50,params:["Endpoint","Region","UseDualStack","UseFIPS"]}),y5=(r,e={})=>v5.get(r,()=>t1(g5,{endpointParams:r,logger:e.logger}));dh.aws=zb;const x5=r=>({apiVersion:"2014-06-30",base64Decoder:(r==null?void 0:r.base64Decoder)??Zm,base64Encoder:(r==null?void 0:r.base64Encoder)??Im,disableHostPrefix:(r==null?void 0:r.disableHostPrefix)??!1,endpointProvider:(r==null?void 0:r.endpointProvider)??y5,extensions:(r==null?void 0:r.extensions)??[],httpAuthSchemeProvider:(r==null?void 0:r.httpAuthSchemeProvider)??u5,httpAuthSchemes:(r==null?void 0:r.httpAuthSchemes)??[{schemeId:"aws.auth#sigv4",identityProvider:e=>e.getIdentityProvider("aws.auth#sigv4"),signer:new s1},{schemeId:"smithy.api#noAuth",identityProvider:e=>e.getIdentityProvider("smithy.api#noAuth")||(async()=>({})),signer:new HN}],logger:(r==null?void 0:r.logger)??new Mb,protocol:(r==null?void 0:r.protocol)??y1,protocolSettings:(r==null?void 0:r.protocolSettings)??{defaultNamespace:"com.amazonaws.cognitoidentity",xmlNamespace:"http://cognito-identity.amazonaws.com/doc/2014-06-30/",version:"2014-06-30",serviceTarget:"AWSCognitoIdentityService"},serviceId:(r==null?void 0:r.serviceId)??"Cognito Identity",urlParser:(r==null?void 0:r.urlParser)??Fm,utf8Decoder:(r==null?void 0:r.utf8Decoder)??cd,utf8Encoder:(r==null?void 0:r.utf8Encoder)??Wy}),w5=r=>{const e=$1(r),t=()=>e().then(m1),n=x5(r);return{...n,...r,runtime:"browser",defaultsMode:e,bodyLengthChecker:(r==null?void 0:r.bodyLengthChecker)??f1,credentialDefaultProvider:(r==null?void 0:r.credentialDefaultProvider)??(s=>()=>Promise.reject(new Error("Credential is missing"))),defaultUserAgentProvider:(r==null?void 0:r.defaultUserAgentProvider)??L1({serviceId:n.serviceId,clientVersion:p5.version}),maxAttempts:(r==null?void 0:r.maxAttempts)??Om,region:(r==null?void 0:r.region)??M1("Region is missing"),requestHandler:Vy.create((r==null?void 0:r.requestHandler)??t),retryMode:(r==null?void 0:r.retryMode)??(async()=>(await t()).retryMode||T1),sha256:(r==null?void 0:r.sha256)??D1,streamCollector:(r==null?void 0:r.streamCollector)??FN,useDualstackEndpoint:(r==null?void 0:r.useDualstackEndpoint)??(()=>Promise.resolve(w1)),useFipsEndpoint:(r==null?void 0:r.useFipsEndpoint)??(()=>Promise.resolve(b1))}},b5=r=>{const e=r.httpAuthSchemes;let t=r.httpAuthSchemeProvider,n=r.credentials;return{setHttpAuthScheme(s){const i=e.findIndex(c=>c.schemeId===s.schemeId);i===-1?e.push(s):e.splice(i,1,s)},httpAuthSchemes(){return e},setHttpAuthSchemeProvider(s){t=s},httpAuthSchemeProvider(){return t},setCredentials(s){n=s},credentials(){return n}}},_5=r=>({httpAuthSchemes:r.httpAuthSchemes(),httpAuthSchemeProvider:r.httpAuthSchemeProvider(),credentials:r.credentials()}),S5=(r,e)=>{const t=Object.assign(W1(r),g1(r),kN(r),b5(r));return e.forEach(n=>n.configure(t)),Object.assign(r,V1(t),v1(t),NN(t),_5(t))};class E5 extends h1{constructor(...[t]){const n=w5(t||{});super(n);H(this,"config");this.initConfig=n;const s=f5(n),i=GN(s),c=P1(i),d=S1(c),p=d,m=N1(p),g=d5(m),x=S5(g,(t==null?void 0:t.extensions)||[]);this.config=x,this.middlewareStack.use(LN(this.config)),this.middlewareStack.use(x1(this.config)),this.middlewareStack.use(j1(this.config)),this.middlewareStack.use(E1(this.config)),this.middlewareStack.use(TN(this.config)),this.middlewareStack.use(RN(this.config)),this.middlewareStack.use(AN(this.config)),this.middlewareStack.use(IN(this.config,{httpAuthSchemeParametersProvider:l5,identityProviderConfigProvider:async b=>new zN({"aws.auth#sigv4":b.credentials})})),this.middlewareStack.use(PN(this.config))}destroy(){super.destroy()}}var gT=(r=>(r.Succeeded="succeeded",r.Failed="failed",r))(gT||{}),Hw=(r=>(r.DialogMessageReceived="dialogMessageReceived",r.DialogEventReceived="dialogEventReceived",r))(Hw||{});class vT{constructor(e){H(this,"logger");this.logger=e}async launchWebAuthFlow(e){return this.logger.warn("launchWebAuthFlow using basic window.open approach in Outlook context",{sourceFile:"src/platforms/outlook/OutlookIdentityProvider.ts",sourceFunction:"launchWebAuthFlow"}),this.initiateOAuth(e.url,"")}async initiateOAuth(e,t){var n;try{const s=window.Office;return(n=s==null?void 0:s.ui)!=null&&n.displayDialogAsync?(this.logger.info("Using Office.ui.displayDialogAsync for OAuth",{sourceFile:"src/platforms/outlook/OutlookIdentityProvider.ts",sourceFunction:"initiateOAuth"}),new Promise((i,c)=>{s.ui.displayDialogAsync(e,{height:60,width:60},d=>{var p;if(d.status===gT.Succeeded){const m=d.value;m.addEventHandler(Hw.DialogMessageReceived,g=>{m.close(),i(g.message||"")}),m.addEventHandler(Hw.DialogEventReceived,g=>{m.close(),g.error===12006?c(new Error("Authentication was cancelled by user")):c(new Error(`Authentication dialog failed with error: ${g.error}`))})}else c(new Error(`Failed to open authentication dialog: ${((p=d.error)==null?void 0:p.message)||"Unknown error"}`))})})):(this.logger.warn("Office.ui not available, using window.open fallback",{sourceFile:"src/platforms/outlook/OutlookIdentityProvider.ts",sourceFunction:"initiateOAuth"}),new Promise((i,c)=>{const d=window.open(e,"_blank","width=500,height=600,scrollbars=yes,resizable=yes");if(!d){c(new Error("Failed to open authentication window. Please check popup blockers."));return}const p=setInterval(()=>{try{if(d.closed){clearInterval(p),c(new Error("Authentication was cancelled by user"));return}try{const m=d.location.href;if(m&&m.includes("access_token=")){clearInterval(p),d.close(),i(m);return}}catch{}}catch{clearInterval(p),d==null||d.close(),c(new Error("Error during authentication process"))}},1e3);setTimeout(()=>{clearInterval(p),d.closed||d.close(),c(new Error("Authentication timeout - please try again"))},3e5)}))}catch(s){throw this.logger.error("Error initiating OAuth",s,{sourceFile:"src/platforms/outlook/OutlookIdentityProvider.ts",sourceFunction:"initiateOAuth"}),s}}}const C5=()=>{const r=window.location.hostname,e=window.location.pathname;return r==="localhost"?{environment:"local",DIALOG_URL:"https://localhost:5174/auth-dialog-pkce.html"}:e.includes("FileServer_Staging")?{environment:"staging",DIALOG_URL:"https://candle-ai.github.io/FileServer_Staging/dist-outlook-addin/src/apps/outlook-addin/auth-dialog-pkce.html"}:e.includes("FileServer_Prod")?{environment:"prod",DIALOG_URL:"https://candle-ai.github.io/FileServer_Prod/dist-outlook-addin/src/apps/outlook-addin/auth-dialog-pkce.html"}:{environment:"dev",DIALOG_URL:"https://candle-ai.github.io/FileServer/dist-outlook-addin/src/apps/outlook-addin/auth-dialog-pkce.html"}};async function k5(){const r=C5();return new Promise((e,t)=>{let n=!1;console.log(`Starting PKCE authentication in ${r.environment} environment with dialog:`,r.DIALOG_URL),Office.context.ui.displayDialogAsync(r.DIALOG_URL,{height:70,width:50,promptBeforeOpen:!1},s=>{if(s.status!==Office.AsyncResultStatus.Succeeded)return console.error("Failed to open auth dialog:",s.error),t(new Error(`Failed to open authentication dialog: ${s.error.message}`));const i=s.value;console.log("Auth dialog opened successfully"),i.addEventHandler(Office.EventType.DialogMessageReceived,c=>{try{if(!n&&"message"in c){let d;if(typeof c.message=="string")d=JSON.parse(c.message);else if(typeof c.message=="object")d=c.message;else{console.log("Unknown message type:",typeof c.message,c.message);return}if(console.log(`Received message from auth dialog (${r.environment}):`,d.type),d.type==="AUTH_SUCCESS"){if(console.log(`Authentication successful in ${r.environment} environment`),n=!0,i.close(),!d.tokens||!d.tokens.access_token){t(new Error("Invalid token response from authentication dialog"));return}const p={access_token:d.tokens.access_token,refresh_token:d.tokens.refresh_token,id_token:d.tokens.id_token,expires_in:d.tokens.expires_in,token_type:d.tokens.token_type,fetched_at:d.tokens.fetched_at};console.log(`Tokens received successfully in ${r.environment} environment`),e(p)}else d.type==="AUTH_ERROR"&&(console.log(`Authentication error in ${r.environment}:`,d.error),n=!0,i.close(),t(new Error(`Authentication failed: ${d.error}`)))}}catch(d){console.error("Error handling dialog message:",d),n||(n=!0,i.close(),t(new Error("Error processing authentication response")))}}),i.addEventHandler(Office.EventType.DialogEventReceived,c=>{if(console.log("Dialog event received:",c),!n&&"error"in c){const d=c.error;d===12006?(console.log("User cancelled authentication"),n=!0,t(new Error("Authentication cancelled by user"))):d===12005?console.log("Dialog navigation occurred (normal during OAuth)"):(console.error("Dialog error:",d),n=!0,t(new Error(`Authentication dialog error: ${d}`)))}}),setTimeout(()=>{n||(console.log(`Authentication timeout in ${r.environment} environment`),n=!0,i.close(),t(new Error("Authentication timeout - please try again")))},300*1e3)})})}const _C="us-east-1";class N5{constructor(e,t){H(this,"logger");H(this,"authListeners",new Set);H(this,"cachedToken",null);H(this,"cognitoClient");H(this,"identityProvider");H(this,"storageProvider");this.logger=e,this.storageProvider=t,this.cognitoClient=new E5({region:_C}),this.identityProvider=new vT(e)}async login(){try{const e=await k5();return this.logger.info("Token received",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"login",token:e}),this.cachedToken=e,await this.saveToken(e),this.notifyAuthListeners(!0),e}catch(e){throw this.logger.error("Login failed",e,{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"login"}),e}}async logout(){this.cachedToken=null,await this.deleteToken(),this.notifyAuthListeners(!1)}async getToken(){if(this.logger.debug("Getting token",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"getToken",hasCachedToken:!!this.cachedToken}),this.cachedToken)return this.logger.debug("Returning cached token",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"getToken"}),this.cachedToken;const e=await this.loadTokenFromStorage();return e?(this.logger.debug("Token loaded from storage, caching it",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"getToken"}),this.cachedToken=e,e):(this.logger.debug("No token found in cache or storage",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"getToken"}),null)}onAuthStateChanged(e){this.authListeners.add(e)}removeAuthStateListener(e){this.authListeners.delete(e)}notifyAuthListeners(e){this.authListeners.forEach(t=>{try{t(e)}catch(n){this.logger.error("Error in auth state callback",n,{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"notifyAuthListeners"})}})}async isAuthenticated(){console.log(" [OutlookAuthProvider] Checking authentication status"),this.logger.info("Checking authentication status",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"isAuthenticated"});const e=await this.getToken();if(!e)return console.log(" [OutlookAuthProvider] No token found"),this.logger.info("No token found - user is not authenticated",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"isAuthenticated"}),!1;const t=this.isTokenValid(e);if(console.log(" [OutlookAuthProvider] Token valid?",t),!t){console.log(" [OutlookAuthProvider] Token is expired or expiring soon, attempting refresh"),this.logger.info("Token is expired or expiring soon, attempting refresh",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"isAuthenticated",tokenExpiry:e.expires_in,fetchedAt:e.fetched_at});try{return console.log(" [OutlookAuthProvider] Calling refreshToken()..."),await this.refreshToken(e),console.log(" [OutlookAuthProvider] Token refreshed successfully!"),this.logger.info("Token refreshed successfully during authentication check",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"isAuthenticated"}),!0}catch(n){return console.error(" [OutlookAuthProvider] Token refresh failed:",n),this.logger.error("Token refresh failed during authentication check",n,{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"isAuthenticated"}),!1}}return this.logger.info("Authentication status checked - token is valid",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"isAuthenticated",hasToken:!!e,isValid:t,tokenExpiry:e.expires_in,fetchedAt:e.fetched_at}),!0}async validateToken(e){const t=await this.getToken();return t?this.isTokenValid(t):!1}isTokenValid(e){if(!e||!e.expires_in)return!1;const t=Math.floor(Date.now()),n=e.fetched_at||0,s=n+e.expires_in*1e3,i=s-t<3e5;return this.logger.debug("Token validation",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"isTokenValid",currentTime:t,fetchedAt:n,expiresIn:e.expires_in,tokenExpiry:s,isExpired:i,timeUntilExpiry:s-t}),!i}async refreshToken(e){console.log(" [OutlookAuthProvider.refreshToken] Starting token refresh using REFRESH_TOKEN_AUTH"),this.logger.info("Refreshing token using refresh_token",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"refreshToken"});try{const t=new Gb({region:_C}),n=new V_({ClientId:yh,AuthFlow:"REFRESH_TOKEN_AUTH",AuthParameters:{REFRESH_TOKEN:e.refresh_token}});console.log(" [OutlookAuthProvider.refreshToken] Sending refresh request to AWS Cognito"),this.logger.debug("Sending refresh token request to Cognito",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"refreshToken"});const s=await t.send(n);console.log(" [OutlookAuthProvider.refreshToken] Received response from Cognito");const i=s.AuthenticationResult;if(!i)throw new Error("AuthenticationResult is missing in the response.");const{IdToken:c,AccessToken:d,RefreshToken:p,ExpiresIn:m,TokenType:g}=i;if(!c||!d||!m||!g)throw new Error("Missing required fields in AuthenticationResult.");const x={id_token:c,access_token:d,refresh_token:p||e.refresh_token,expires_in:m,token_type:g,fetched_at:Math.floor(Date.now())};return this.logger.info("Token refreshed successfully",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"refreshToken",newExpiresIn:m}),this.cachedToken=x,await this.saveToken(x),this.notifyAuthListeners(!0),x}catch(t){return this.logger.error("Token refresh failed, falling back to full re-login",t,{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"refreshToken"}),this.login()}}async saveToken(e){await this.storageProvider.setLocalItem("token",e)}async loadTokenFromStorage(){this.logger.debug("Loading token from storage",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"loadTokenFromStorage"});try{const e=await this.storageProvider.getLocalItem("token");if(!e)return this.logger.debug("No token found in storage",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"loadTokenFromStorage"}),null;const t=e;return this.logger.debug("Token successfully loaded from storage",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"loadTokenFromStorage",hasToken:!!t,fetchedAt:t==null?void 0:t.fetched_at,expiresIn:t==null?void 0:t.expires_in}),t}catch(e){return this.logger.warn("Failed to load token from storage",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"loadTokenFromStorage",error:e}),null}}async deleteToken(){await this.storageProvider.removeLocalItem("token")}parseAccessTokenFromOAuthResponse(e){try{let t=e;e.includes("#")&&(t=e.split("#")[1]);const n=new URLSearchParams(t),s=n.get("access_token");if(!s)return this.logger.error("No access_token found in OAuth response",new Error("Missing access token"),{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"parseAccessTokenFromOAuthResponse",responseUrl:e,fragment:t}),null;const i=n.get("error");if(i){const c=n.get("error_description")||"Unknown OAuth error";throw new Error(`OAuth error: ${i} - ${c}`)}return s}catch(t){return this.logger.error("Failed to parse OAuth response",t,{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"parseAccessTokenFromOAuthResponse",responseUrl:e}),null}}}class T5{constructor(e){H(this,"logger");this.logger=e}async sendMessage(e){return this.logger.debug("Sending message in Outlook context",{sourceFile:"src/platforms/outlook/OutlookMessagingProvider.ts",sourceFunction:"sendMessage",message:e}),Promise.resolve(e)}onMessage(e){this.logger.debug("Registering message callback in Outlook context",{sourceFile:"src/platforms/outlook/OutlookMessagingProvider.ts",sourceFunction:"onMessage"})}removeMessageListener(e){this.logger.debug("Removing message listener in Outlook context",{sourceFile:"src/platforms/outlook/OutlookMessagingProvider.ts",sourceFunction:"removeMessageListener"})}async sendOfficeNotification(e){try{typeof Office<"u"&&Office.context&&Office.context.ui&&Office.context.ui.displayDialogAsync(`data:text/html,<html><body><p>${e}</p></body></html>`,{height:20,width:40},t=>{t.status===Office.AsyncResultStatus.Succeeded&&setTimeout(()=>t.value.close(),3e3)})}catch(t){this.logger.error("Error showing Office notification",t,{sourceFile:"src/platforms/outlook/OutlookMessagingProvider.ts",sourceFunction:"sendOfficeNotification"})}}}class R5{constructor(e){H(this,"logger");H(this,"eventListeners",new Map);H(this,"isInitialized",!1);this.logger=e}async initialize(){if(this.isInitialized){this.logger.info("Outlook platform already initialized",{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"initialize"});return}try{this.logger.info("Initializing Outlook platform...",{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"initialize"}),await this.waitForOfficeReady(),this.setupOutlookEventListeners();try{const e=JSON.stringify(oT);localStorage.setItem("CONFIG_VERIFICATION",e),this.logger.info(`[Debug] Saved CONFIG_VERIFICATION='${e}' to localStorage.`,{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"initialize"})}catch(e){this.logger.warn("[Debug] Could not save CONFIG_VERIFICATION to localStorage.",e,{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"initialize"})}this.isInitialized=!0,this.logger.info("Outlook platform initialized successfully",{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"initialize"})}catch(e){throw this.logger.error("Failed to initialize Outlook platform",e,{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"initialize"}),e}}async cleanup(){try{this.logger.info("Cleaning up Outlook platform...",{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"cleanup"}),this.eventListeners.clear(),this.isInitialized=!1,this.logger.info("Outlook platform cleanup completed",{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"cleanup"})}catch(e){throw this.logger.error("Failed to cleanup Outlook platform",e,{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"cleanup"}),e}}async closeWindow(){this.logger.debug("Window close requested (no-op for Outlook)",{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"closeWindow"})}onPlatformEvent(e,t){this.eventListeners.has(e)||this.eventListeners.set(e,new Set),this.eventListeners.get(e).add(t)}async waitForOfficeReady(){return new Promise(e=>{typeof Office<"u"&&Office.onReady?Office.onReady(()=>{e()}):e()})}setupOutlookEventListeners(){var e;typeof Office<"u"&&Office.context&&(e=Office.context.mailbox)!=null&&e.addHandlerAsync&&Office.context.mailbox.addHandlerAsync(Office.EventType.ItemChanged,this.handleItemChanged.bind(this),t=>{t.status===Office.AsyncResultStatus.Failed&&this.logger.error("Failed to add item changed handler",t.error,{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"setupOutlookEventListeners"})})}handleItemChanged(){this.emitPlatformEvent("itemChanged")}emitPlatformEvent(e,...t){const n=this.eventListeners.get(e);n&&n.forEach(s=>{try{s(...t)}catch(i){this.logger.error(`Error in platform event callback for ${e}`,i,{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"emitPlatformEvent",event:e})}})}}class A5{constructor(e){H(this,"logger");this.logger=e}getResourceURL(e){return this.logger.debug("getResourceURL called in Outlook context",{sourceFile:"src/platforms/outlook/OutlookTabsProvider.ts",sourceFunction:"getResourceURL",path:e}),e.includes("options.html")?rh:""}async getCurrentTab(){return this.logger.debug("getCurrentTab called in Outlook context",{sourceFile:"src/platforms/outlook/OutlookTabsProvider.ts",sourceFunction:"getCurrentTab"}),{id:1,windowId:1,index:0,url:window.location.href,title:document.title||"Outlook Add-in",active:!0,highlighted:!0,pinned:!1,incognito:!1}}async createTab(e,t){return this.logger.debug("createTab called in Outlook context",{sourceFile:"src/platforms/outlook/OutlookTabsProvider.ts",sourceFunction:"createTab",url:e}),window.open(e,"_blank"),{id:Date.now(),windowId:1,index:0,url:e,title:"New Tab",active:!0,highlighted:!0,pinned:!1,incognito:!1}}async updateTab(e,t){this.logger.debug("updateTab called in Outlook context - this is a no-op",{sourceFile:"src/platforms/outlook/OutlookTabsProvider.ts",sourceFunction:"updateTab"})}async closeTab(e){this.logger.debug("closeTab called in Outlook context - this is a no-op",{sourceFile:"src/platforms/outlook/OutlookTabsProvider.ts",sourceFunction:"closeTab"})}onTabUpdated(e){this.logger.debug("onTabUpdated called in Outlook context - this is a no-op",{sourceFile:"src/platforms/outlook/OutlookTabsProvider.ts",sourceFunction:"onTabUpdated"})}removeTabUpdateListener(e){this.logger.debug("removeTabUpdateListener called in Outlook context - this is a no-op",{sourceFile:"src/platforms/outlook/OutlookTabsProvider.ts",sourceFunction:"removeTabUpdateListener"})}async openURL(e,t="_blank"){this.logger.debug("openURL called in Outlook context",{sourceFile:"src/platforms/outlook/OutlookTabsProvider.ts",sourceFunction:"openURL",url:e,target:t}),window.open(e,t)}async openOptionsPage(){this.logger.debug("openOptionsPage called in Outlook context",{sourceFile:"src/platforms/outlook/OutlookTabsProvider.ts",sourceFunction:"openOptionsPage"});const e=await $w(this.logger);let t=rh;e!=null&&e.id_token&&(t+=`?token=${e.id_token}`),window.open(t,"_blank")}}const Fx=32*1024;class I5{constructor(e){H(this,"logger");this.logger=e}truncateHtmlForReplyForm(e){const n=new TextEncoder().encode(e);if(n.length<=Fx)return e;this.logger.warn("HTML content exceeds 32 KB limit for reply form, truncating",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"truncateHtmlForReplyForm",originalSize:n.length,maxSize:Fx});let i=new TextDecoder().decode(n.slice(0,Fx-100));const c=Math.max(i.lastIndexOf("</p>"),i.lastIndexOf("</div>"),i.lastIndexOf("</li>"),i.lastIndexOf("<br>"));return c>i.length/2&&(i=i.substring(0,c+(i.includes("</p>")?4:i.includes("</div>")?6:i.includes("</li>")?5:4))),i+='<p style="color: gray; font-style: italic;">[Content truncated due to size limit]</p>',i}detectItemMode(){var e,t;try{if(!((t=(e=Office==null?void 0:Office.context)==null?void 0:e.mailbox)!=null&&t.item))return"unknown";const n=Office.context.mailbox.item;if(!n.itemId)return this.logger.debug("Detected compose mode (no itemId)",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"detectItemMode"}),"compose";const s=n.to;return s&&typeof s.setAsync=="function"?(this.logger.debug("Detected compose mode (to.setAsync exists)",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"detectItemMode"}),"compose"):(this.logger.debug("Detected read mode",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"detectItemMode"}),"read")}catch(n){return this.logger.warn("Error detecting item mode",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"detectItemMode",error:n}),"unknown"}}async executeScript(e){throw this.logger.warn("Script execution not implemented for Outlook context",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"executeScript"}),new Error("Script execution not available in Outlook context")}async injectScript(e){this.logger.warn("Script injection not applicable in Outlook context",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"injectScript"})}async insertContentIntoComposeBox(e){var t;try{const n=Zv(e);if(typeof Office<"u"&&Office.context&&Office.context.mailbox){const s=this.detectItemMode();this.logger.debug("Inserting content into compose box",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"insertContentIntoComposeBox",mode:s}),s==="compose"?(t=Office.context.mailbox.item)==null||t.body.setSelectedDataAsync(n,{coercionType:Office.CoercionType.Html},i=>{i.status===Office.AsyncResultStatus.Failed?(this.logger.error("Failed to insert content using setSelectedDataAsync, falling back to reply-all",i.error,{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"insertContentIntoComposeBox"}),this.replyAllWithContent(e)):this.logger.info("Successfully inserted content at cursor position",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"insertContentIntoComposeBox"})}):(this.logger.info("In read mode - creating reply-all with content",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"insertContentIntoComposeBox"}),await this.replyAllWithContent(e))}else this.logger.warn("Office.js context not available",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"insertContentIntoComposeBox"})}catch(n){throw this.logger.error("Error inserting content into compose box",n,{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"insertContentIntoComposeBox"}),n}}async replyWithContent(e){try{const t=Zv(e),n=this.truncateHtmlForReplyForm(t);if(typeof Office<"u"&&Office.context&&Office.context.mailbox&&Office.context.mailbox.item){const s=Office.context.mailbox.item;if(typeof s.displayReplyFormAsync=="function")return new Promise((i,c)=>{s.displayReplyFormAsync(n,d=>{d.status===Office.AsyncResultStatus.Succeeded?(this.logger.info("Successfully displayed reply form with content (async)",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyWithContent"}),i()):(this.logger.error("Failed to display reply form (async)",d.error,{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyWithContent"}),c(d.error))})});s.displayReplyForm(n),this.logger.info("Successfully displayed reply form with content",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyWithContent"})}else this.logger.warn("Office.js context not available",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyWithContent"})}catch(t){throw this.logger.error("Error displaying reply form with content",t,{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyWithContent"}),t}}async replyAllWithContent(e){try{const t=Zv(e),n=this.truncateHtmlForReplyForm(t);if(this.logger.debug("Attempting to display reply all form",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyAllWithContent",contentLength:n.length,contentPreview:n.substring(0,200)}),typeof Office<"u"&&Office.context&&Office.context.mailbox&&Office.context.mailbox.item){const s=Office.context.mailbox.item;if(typeof s.displayReplyAllFormAsync=="function")return new Promise((i,c)=>{s.displayReplyAllFormAsync(n,d=>{d.status===Office.AsyncResultStatus.Succeeded?(this.logger.info("Successfully displayed reply all form with content (async)",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyAllWithContent"}),i()):(this.logger.error("Failed to display reply all form (async)",d.error,{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyAllWithContent"}),c(d.error))})});s.displayReplyAllForm(n),this.logger.info("Successfully displayed reply all form with content",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyAllWithContent"})}else this.logger.warn("Office.js context not available",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyAllWithContent"})}catch(t){throw this.logger.error("Error displaying reply all form with content",t,{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyAllWithContent"}),t}}}const SC={ERROR:1,WARN:2,INFO:3,DEBUG:4};class P5{constructor(e){H(this,"context");H(this,"minLevel");this.context=e||"unknown",this.minLevel="INFO"}shouldLog(e){return SC[e]<=SC[this.minLevel]}formatMessage(e,t,n){const s=(n==null?void 0:n.sourceFile)||"unknown",i=n==null?void 0:n.sourceFunction;return`[${e}] [Outlook:${this.context}] [${s}${i?` (${i})`:""}]: ${t}`}async debug(e,t){if(!this.shouldLog("DEBUG"))return;const n=this.formatMessage("DEBUG",e,t),{sourceFile:s,sourceFunction:i,...c}=t||{},d=[n];Object.keys(c).length>0&&d.push(c),console.debug(...d)}async info(e,t){if(!this.shouldLog("INFO"))return;const n=this.formatMessage("INFO",e,t),{sourceFile:s,sourceFunction:i,...c}=t||{},d=[n];Object.keys(c).length>0&&d.push(c),console.info(...d)}async warn(e,t){if(!this.shouldLog("WARN"))return;const n=this.formatMessage("WARN",e,t),{sourceFile:s,sourceFunction:i,...c}=t||{},d=[n];Object.keys(c).length>0&&d.push(c),console.warn(...d)}async error(e,t,n){if(!this.shouldLog("ERROR"))return;const s=this.formatMessage("ERROR",e,n),{sourceFile:i,sourceFunction:c,...d}=n||{},p=[s];t&&p.push(t),Object.keys(d).length>0&&p.push(d),console.error(...p)}setMinLevel(e){this.minLevel=e}getMinLevel(){return this.minLevel}getUnderlyingLogger(){return{context:this.context,minLevel:this.minLevel,writeLog:async(e,t,n,s)=>{switch(e){case"DEBUG":return this.debug(t,n);case"INFO":return this.info(t,n);case"WARN":return this.warn(t,n);case"ERROR":return this.error(t,s,n)}},_triggerCleanupCheck:()=>{},debug:(e,t)=>this.debug(e,t),info:(e,t)=>this.info(e,t),warn:(e,t)=>this.warn(e,t),error:(e,t,n)=>this.error(e,t,n)}}}function j5(){const r=new P5("background"),e=new i5(r);return{storage:e,data:new a5(r),auth:new N5(r,e),messaging:new T5(r),lifecycle:new R5(r),tabs:new A5(r),contentScript:new I5(r),identity:new vT(r),logging:r}}const $s=class $s{static async createServices(e){const t=e||$s.detectPlatform();if($s.instance&&$s.currentPlatform===t)return $s.instance;let n;if(t==="chrome"){const s=$s.detectExecutionContext();n=o5(s)}else if(t==="outlook")n=j5();else throw new Error(`Unsupported platform: ${t}`);return await n.lifecycle.initialize(),$s.instance=n,$s.currentPlatform=t,n}static detectPlatform(){if(typeof chrome<"u"&&chrome.runtime&&chrome.runtime.id)return"chrome";if(typeof Office<"u"&&Office.context)return"outlook";throw new Error("Unable to detect platform. Neither Chrome nor Office APIs available.")}static detectExecutionContext(){if(typeof chrome<"u"&&chrome.runtime&&chrome.runtime.id){if(typeof document>"u")return"background";try{if(typeof window<"u"&&window.location){const e=window.location.href;return e.includes("options.html")?"options":e.includes("popup.html")?"popup":"content"}}catch{return"content"}return"content"}return"unknown"}static getCurrentPlatform(){return $s.currentPlatform}static async resetInstance(){$s.instance&&(await $s.instance.lifecycle.cleanup(),$s.instance=null,$s.currentPlatform=null)}};H($s,"instance",null),H($s,"currentPlatform",null);let Yn=$s;const Z_=w.createContext({platform:"unassigned",services:null,isLoading:!0,error:null});function F5({children:r}){const[e,t]=w.useState("unassigned"),[n,s]=w.useState(null),[i,c]=w.useState(!0),[d,p]=w.useState(null),m=w.useCallback(async g=>{if(g!=null&&g.lifecycle)try{await g.lifecycle.cleanup()}catch(x){console.error("Error during platform cleanup",x,{sourceFile:"src/platforms/PlatformContext.tsx",sourceFunction:"cleanup"})}},[]);return w.useEffect(()=>{let g=null;async function x(){try{console.info("Initializing platform services...",{sourceFile:"src/platforms/PlatformContext.tsx",sourceFunction:"initializePlatform"});const b=await Yn.createServices();if(g=b,t(Yn.getCurrentPlatform()||"unassigned"),Yn.getCurrentPlatform()==="unassigned")throw new Error("Platform not supported");await b.lifecycle.initialize(),s(b),p(null),console.info("Platform services initialized successfully",{sourceFile:"src/platforms/PlatformContext.tsx",sourceFunction:"initializePlatform"})}catch(b){const S=b instanceof Error?b.message:"Unknown error occurred";console.error("Failed to initialize platform services",b,{sourceFile:"src/platforms/PlatformContext.tsx",sourceFunction:"initializePlatform"}),p(S)}finally{c(!1)}}return x(),()=>{g&&m(g)}},[m]),u.jsx(Z_.Provider,{value:{platform:e,services:n,isLoading:i,error:d},children:i?u.jsx("div",{className:"flex items-center justify-center h-full",children:u.jsx("div",{className:"text-sm text-gray-600",children:"Initializing platform..."})}):d?u.jsx("div",{className:"flex items-center justify-center h-full",children:u.jsxs("div",{className:"text-sm text-red-600",children:["Error: ",d]})}):r})}const yT=w.createContext(void 0),$i=()=>{const r=w.useContext(yT);if(r===void 0)throw console.error("useGmailConnection hook called outside of GmailConnectionProvider"),console.error("Component stack:",new Error().stack),new Error("useGmailConnection must be used within a GmailConnectionProvider. Check that the component using this hook is properly wrapped in the provider hierarchy.");return r},wr="src/lib/utils/cacheUtils.ts",O5=100,D5=1440*60*1e3,L5=100,M5=3600*1e3,$5=100,U5=1440*60*1e3,z5=100,H5=3600*1e3,B5=50,G5=1800*1e3,W5=3600*1e3*24,Vt={EMAIL_SUMMARY:"cache_email_summary_",EMAIL_SUMMARY_INDEX:"cache_email_summary_index",DOCUMENTS:"cache_documents_",DOCUMENTS_INDEX:"cache_documents_index",PROJECT_DOCUMENTS:"cache_project_documents_",PROJECT_DOCUMENTS_INDEX:"cache_project_documents_index",NON_EXISTENT_CLIENT:"cache_non_existent_client_",NON_EXISTENT_CLIENT_INDEX:"cache_non_existent_client_index",CLIENT:"cache_client_",CLIENT_INDEX:"cache_client_index",GENERATED_RESPONSE:"cache_generated_response_",GENERATED_RESPONSE_INDEX:"cache_generated_response_index",FIRM_USERS:"firm_users"},V5=30*1e3,Um=new Map;function q5(r){const e=r.toLowerCase(),t=Um.get(e);return t?Date.now()-t.timestamp>V5?(Um.delete(e),{inCache:!1}):{inCache:!0,errorType:t.errorType}:{inCache:!1}}function EC(r,e){const t=r.toLowerCase();Um.set(t,{timestamp:Date.now(),errorType:e})}function xT(r){const e=r.toLowerCase();Um.delete(e)}function K5(){Um.clear()}async function as(r){try{return(await Yn.createServices()).storage}catch(e){return r.warn("Platform detection failed, storage unavailable",{sourceFile:wr,error:e}),null}}async function ng(r,e,t,n,s){try{const i=await r.getLocalItem(e)||[];if(i.length>=n){i.sort((d,p)=>d.timestamp-p.timestamp);const c=i.splice(0,i.length-n+1);for(const d of c)await r.removeLocalItem(d.key);await r.setLocalItem(e,i)}}catch(i){s.warn("Error managing cache size",{sourceFile:wr,error:i})}}async function sg(r,e,t,n,s){try{const i=await r.getLocalItem(e)||[],c=i.findIndex(d=>d.key===t);c!==-1&&i.splice(c,1),i.push({key:t,timestamp:n}),await r.setLocalItem(e,i)}catch(i){s.warn("Error updating cache index",{sourceFile:wr,error:i})}}async function wT(r){await Promise.all([X5(r),Q5(r),t6(r),ET(r),n6(r)])}async function Y5(r,e,t,n){try{const s=await as(n);if(!s)return;const i=`${Vt.EMAIL_SUMMARY}${r}`,c=Date.now();await ng(s,Vt.EMAIL_SUMMARY_INDEX,Vt.EMAIL_SUMMARY,O5,n);const d={summary:e,importantDetails:t,timestamp:c};await s.setLocalItem(i,d),await sg(s,Vt.EMAIL_SUMMARY_INDEX,i,c,n),n.debug("Added to summary cache",{sourceFile:wr,functionName:"addToSummaryCache",threadId:r})}catch(s){n.warn("Error adding to summary cache",{sourceFile:wr,functionName:"addToSummaryCache",threadId:r,error:s})}}async function J5(r,e){try{const t=await as(e);if(!t)return null;const n=`${Vt.EMAIL_SUMMARY}${r}`,s=await t.getLocalItem(n);return s?Date.now()-s.timestamp>D5?(await t.removeLocalItem(n),null):s:null}catch(t){return e.warn("Error getting from summary cache",{sourceFile:wr,functionName:"getFromSummaryCache",threadId:r,error:t}),null}}async function X5(r){try{const e=await as(r);if(!e)return;const t=await e.getLocalItem(Vt.EMAIL_SUMMARY_INDEX)||[];for(const n of t)await e.removeLocalItem(n.key);await e.removeLocalItem(Vt.EMAIL_SUMMARY_INDEX),r.debug("Summary cache cleared",{sourceFile:wr,functionName:"clearSummaryCache"})}catch(e){r.warn("Error clearing summary cache",{sourceFile:wr,functionName:"clearSummaryCache",error:e})}}async function bT(r,e,t){try{const n=await as(t);if(!n)return;const s=`${Vt.PROJECT_DOCUMENTS}${r}`,i=Date.now();await ng(n,Vt.PROJECT_DOCUMENTS_INDEX,Vt.PROJECT_DOCUMENTS,L5,t);const c={documents:e,timestamp:i};await n.setLocalItem(s,c),await sg(n,Vt.PROJECT_DOCUMENTS_INDEX,s,i,t),t.debug("Added to project document cache",{sourceFile:wr,functionName:"addToProjectDocumentCache",projectId:r})}catch(n){t.warn("Error adding to project document cache",{sourceFile:wr,functionName:"addToProjectDocumentCache",projectId:r,error:n})}}async function _T(r,e){try{const t=await as(e);if(!t)return null;e.debug("Getting documents from project document cache",{sourceFile:wr,functionName:"getFromProjectDocumentCache",projectId:r});const n=`${Vt.PROJECT_DOCUMENTS}${r}`,s=await t.getLocalItem(n);return s?Date.now()-s.timestamp>M5?(await t.removeLocalItem(n),null):s.documents:null}catch(t){return e.warn("Error getting from project document cache",{sourceFile:wr,functionName:"getFromProjectDocumentCache",projectId:r,error:t}),null}}async function Q5(r){try{const e=await as(r);if(!e)return;const t=await e.getLocalItem(Vt.DOCUMENTS_INDEX)||[];for(const n of t)await e.removeLocalItem(n.key);await e.removeLocalItem(Vt.DOCUMENTS_INDEX),r.debug("Document cache cleared",{sourceFile:wr,functionName:"clearDocumentCache"})}catch(e){r.warn("Error clearing document cache",{sourceFile:wr,functionName:"clearDocumentCache",error:e})}}async function Z5(r,e){try{const t=await as(e);if(!t)return;const n=r.toLowerCase(),s=`${Vt.NON_EXISTENT_CLIENT}${n}`,i=Date.now();await ng(t,Vt.NON_EXISTENT_CLIENT_INDEX,Vt.NON_EXISTENT_CLIENT,$5,e),await t.setLocalItem(s,i),await sg(t,Vt.NON_EXISTENT_CLIENT_INDEX,s,i,e),e.debug("Added to non-existent client cache",{sourceFile:wr,functionName:"addToNonExistentClientCache",email:n})}catch(t){e.warn("Error adding to non-existent client cache",{sourceFile:wr,functionName:"addToNonExistentClientCache",email:r,error:t})}}async function e6(r,e){try{const t=await as(e);if(!t)return!1;const n=r.toLowerCase(),s=`${Vt.NON_EXISTENT_CLIENT}${n}`,i=await t.getLocalItem(s);return i?Date.now()-i>U5?(await t.removeLocalItem(s),!1):!0:!1}catch(t){return e.warn("Error checking non-existent client cache",{sourceFile:wr,functionName:"isInNonExistentClientCache",email:r,error:t}),!1}}async function t6(r){try{const e=await as(r);if(!e)return;const t=await e.getLocalItem(Vt.NON_EXISTENT_CLIENT_INDEX)||[];for(const n of t)await e.removeLocalItem(n.key);await e.removeLocalItem(Vt.NON_EXISTENT_CLIENT_INDEX),r.debug("Non-existent client cache cleared",{sourceFile:wr,functionName:"clearNonExistentClientCache"})}catch(e){r.warn("Error clearing non-existent client cache",{sourceFile:wr,functionName:"clearNonExistentClientCache",error:e})}}async function ST(r,e,t){try{const n=await as(t);if(!n)return;const s=r.toLowerCase(),i=`${Vt.CLIENT}${s}`,c=Date.now();await ng(n,Vt.CLIENT_INDEX,Vt.CLIENT,z5,t);const d={data:e,timestamp:c};await n.setLocalItem(i,d),await sg(n,Vt.CLIENT_INDEX,i,c,t),t.debug("Added to client cache",{sourceFile:wr,functionName:"addToClientCache",clientEmail:s})}catch(n){t.warn("Error adding to client cache",{sourceFile:wr,functionName:"addToClientCache",clientEmail:r,error:n})}}async function zm(r,e){try{const t=await as(e);if(!t)return null;const n=r.toLowerCase();e.debug("Getting client info from client cache",{sourceFile:wr,functionName:"getFromClientCache",clientEmail:n});const s=`${Vt.CLIENT}${n}`,i=await t.getLocalItem(s);return i?Date.now()-i.timestamp>H5?(await t.removeLocalItem(s),null):i.data:null}catch(t){return e.warn("Error getting from client cache",{sourceFile:wr,functionName:"getFromClientCache",clientEmail:r,error:t}),null}}async function ET(r){try{const e=await as(r);if(!e)return;const t=await e.getLocalItem(Vt.CLIENT_INDEX)||[];for(const n of t)await e.removeLocalItem(n.key);await e.removeLocalItem(Vt.CLIENT_INDEX),r.debug("Client cache cleared",{sourceFile:wr,functionName:"clearClientCache"})}catch(e){r.warn("Error clearing client cache",{sourceFile:wr,functionName:"clearClientCache",error:e})}}async function Bw(r,e){try{const t=await as(e);if(!t)return;const n=r.toLowerCase();xT(n);const s=`${Vt.CLIENT}${n}`;await t.removeLocalItem(s);const i=await t.getLocalItem(Vt.CLIENT_INDEX)||[],c=i.filter(S=>S.key!==s);c.length!==i.length&&await t.setLocalItem(Vt.CLIENT_INDEX,c);const d=`${Vt.NON_EXISTENT_CLIENT}${n}`;await t.removeLocalItem(d);const p=await t.getLocalItem(Vt.NON_EXISTENT_CLIENT_INDEX)||[],m=p.filter(S=>S.key!==d);m.length!==p.length&&await t.setLocalItem(Vt.NON_EXISTENT_CLIENT_INDEX,m);const g=`${Vt.DOCUMENTS}${n}`;await t.removeLocalItem(g);const x=await t.getLocalItem(Vt.DOCUMENTS_INDEX)||[],b=x.filter(S=>S.key!==g);b.length!==x.length&&await t.setLocalItem(Vt.DOCUMENTS_INDEX,b),e.debug("Cleared all cached data for client email",{sourceFile:wr,functionName:"clearClientDataForEmail",clientEmail:n})}catch(t){e.warn("Error clearing client data for email",{sourceFile:wr,functionName:"clearClientDataForEmail",clientEmail:r,error:t})}}async function CC(r,e,t,n,s,i,c){try{const d=await as(s);if(!d)return;const p=`${Vt.GENERATED_RESPONSE}${r}`,m=Date.now();await ng(d,Vt.GENERATED_RESPONSE_INDEX,Vt.GENERATED_RESPONSE,B5,s);const g={response:e,references:t,cmsData:n,rawCmsData:i,refreshed:c,timestamp:m};await d.setLocalItem(p,g),await sg(d,Vt.GENERATED_RESPONSE_INDEX,p,m,s),s.debug("Added to generated response cache",{sourceFile:wr,functionName:"addToGeneratedResponseCache",cacheKey:r})}catch(d){s.warn("Error adding to generated response cache",{sourceFile:wr,functionName:"addToGeneratedResponseCache",cacheKey:r,error:d})}}async function r6(r,e){try{const t=await as(e);if(!t)return null;e.debug("Getting generated response from cache",{sourceFile:wr,functionName:"getFromGeneratedResponseCache",cacheKey:r});const n=`${Vt.GENERATED_RESPONSE}${r}`,s=await t.getLocalItem(n);return s?Date.now()-s.timestamp>G5?(await t.removeLocalItem(n),null):s:null}catch(t){return e.warn("Error getting from generated response cache",{sourceFile:wr,functionName:"getFromGeneratedResponseCache",cacheKey:r,error:t}),null}}async function CT(r,e){try{const t=await as(e);if(!t)return;const n={users:r,timestamp:Date.now()};await t.setLocalItem(Vt.FIRM_USERS,n),e.debug("Added to firm users cache",{sourceFile:wr,functionName:"addToFirmUsersCache",count:r.length})}catch(t){e.warn("Error adding to firm users cache",{sourceFile:wr,functionName:"addToFirmUsersCache",error:t})}}async function kT(r){try{const e=await as(r);if(!e)return null;const t=await e.getLocalItem(Vt.FIRM_USERS);return t?Date.now()-t.timestamp>W5?(await e.removeLocalItem(Vt.FIRM_USERS),null):t.users:null}catch(e){return r.warn("Error getting from firm users cache",{sourceFile:wr,functionName:"getFromFirmUsersCache",error:e}),null}}async function n6(r){try{const e=await as(r);if(!e)return;const t=await e.getLocalItem(Vt.GENERATED_RESPONSE_INDEX)||[];for(const n of t)await e.removeLocalItem(n.key);await e.removeLocalItem(Vt.GENERATED_RESPONSE_INDEX),r.debug("Generated response cache cleared",{sourceFile:wr,functionName:"clearGeneratedResponseCache"})}catch(e){r.warn("Error clearing generated response cache",{sourceFile:wr,functionName:"clearGeneratedResponseCache",error:e})}}function NT(r){var e,t,n="";if(typeof r=="string"||typeof r=="number")n+=r;else if(typeof r=="object")if(Array.isArray(r)){var s=r.length;for(e=0;e<s;e++)r[e]&&(t=NT(r[e]))&&(n&&(n+=" "),n+=t)}else for(t in r)r[t]&&(n&&(n+=" "),n+=t);return n}function TT(){for(var r,e,t=0,n="",s=arguments.length;t<s;t++)(r=arguments[t])&&(e=NT(r))&&(n&&(n+=" "),n+=e);return n}const eS="-",s6=r=>{const e=i6(r),{conflictingClassGroups:t,conflictingClassGroupModifiers:n}=r;return{getClassGroupId:c=>{const d=c.split(eS);return d[0]===""&&d.length!==1&&d.shift(),RT(d,e)||o6(c)},getConflictingClassGroupIds:(c,d)=>{const p=t[c]||[];return d&&n[c]?[...p,...n[c]]:p}}},RT=(r,e)=>{var c;if(r.length===0)return e.classGroupId;const t=r[0],n=e.nextPart.get(t),s=n?RT(r.slice(1),n):void 0;if(s)return s;if(e.validators.length===0)return;const i=r.join(eS);return(c=e.validators.find(({validator:d})=>d(i)))==null?void 0:c.classGroupId},kC=/^\[(.+)\]$/,o6=r=>{if(kC.test(r)){const e=kC.exec(r)[1],t=e==null?void 0:e.substring(0,e.indexOf(":"));if(t)return"arbitrary.."+t}},i6=r=>{const{theme:e,prefix:t}=r,n={nextPart:new Map,validators:[]};return l6(Object.entries(r.classGroups),t).forEach(([i,c])=>{Gw(c,n,i,e)}),n},Gw=(r,e,t,n)=>{r.forEach(s=>{if(typeof s=="string"){const i=s===""?e:NC(e,s);i.classGroupId=t;return}if(typeof s=="function"){if(a6(s)){Gw(s(n),e,t,n);return}e.validators.push({validator:s,classGroupId:t});return}Object.entries(s).forEach(([i,c])=>{Gw(c,NC(e,i),t,n)})})},NC=(r,e)=>{let t=r;return e.split(eS).forEach(n=>{t.nextPart.has(n)||t.nextPart.set(n,{nextPart:new Map,validators:[]}),t=t.nextPart.get(n)}),t},a6=r=>r.isThemeGetter,l6=(r,e)=>e?r.map(([t,n])=>{const s=n.map(i=>typeof i=="string"?e+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([c,d])=>[e+c,d])):i);return[t,s]}):r,c6=r=>{if(r<1)return{get:()=>{},set:()=>{}};let e=0,t=new Map,n=new Map;const s=(i,c)=>{t.set(i,c),e++,e>r&&(e=0,n=t,t=new Map)};return{get(i){let c=t.get(i);if(c!==void 0)return c;if((c=n.get(i))!==void 0)return s(i,c),c},set(i,c){t.has(i)?t.set(i,c):s(i,c)}}},AT="!",u6=r=>{const{separator:e,experimentalParseClassName:t}=r,n=e.length===1,s=e[0],i=e.length,c=d=>{const p=[];let m=0,g=0,x;for(let C=0;C<d.length;C++){let R=d[C];if(m===0){if(R===s&&(n||d.slice(C,C+i)===e)){p.push(d.slice(g,C)),g=C+i;continue}if(R==="/"){x=C;continue}}R==="["?m++:R==="]"&&m--}const b=p.length===0?d:d.substring(g),S=b.startsWith(AT),T=S?b.substring(1):b,E=x&&x>g?x-g:void 0;return{modifiers:p,hasImportantModifier:S,baseClassName:T,maybePostfixModifierPosition:E}};return t?d=>t({className:d,parseClassName:c}):c},d6=r=>{if(r.length<=1)return r;const e=[];let t=[];return r.forEach(n=>{n[0]==="["?(e.push(...t.sort(),n),t=[]):t.push(n)}),e.push(...t.sort()),e},f6=r=>({cache:c6(r.cacheSize),parseClassName:u6(r),...s6(r)}),h6=/\s+/,p6=(r,e)=>{const{parseClassName:t,getClassGroupId:n,getConflictingClassGroupIds:s}=e,i=[],c=r.trim().split(h6);let d="";for(let p=c.length-1;p>=0;p-=1){const m=c[p],{modifiers:g,hasImportantModifier:x,baseClassName:b,maybePostfixModifierPosition:S}=t(m);let T=!!S,E=n(T?b.substring(0,S):b);if(!E){if(!T){d=m+(d.length>0?" "+d:d);continue}if(E=n(b),!E){d=m+(d.length>0?" "+d:d);continue}T=!1}const C=d6(g).join(":"),R=x?C+AT:C,A=R+E;if(i.includes(A))continue;i.push(A);const F=s(E,T);for(let P=0;P<F.length;++P){const L=F[P];i.push(R+L)}d=m+(d.length>0?" "+d:d)}return d};function m6(){let r=0,e,t,n="";for(;r<arguments.length;)(e=arguments[r++])&&(t=IT(e))&&(n&&(n+=" "),n+=t);return n}const IT=r=>{if(typeof r=="string")return r;let e,t="";for(let n=0;n<r.length;n++)r[n]&&(e=IT(r[n]))&&(t&&(t+=" "),t+=e);return t};function g6(r,...e){let t,n,s,i=c;function c(p){const m=e.reduce((g,x)=>x(g),r());return t=f6(m),n=t.cache.get,s=t.cache.set,i=d,d(p)}function d(p){const m=n(p);if(m)return m;const g=p6(p,t);return s(p,g),g}return function(){return i(m6.apply(null,arguments))}}const sn=r=>{const e=t=>t[r]||[];return e.isThemeGetter=!0,e},PT=/^\[(?:([a-z-]+):)?(.+)\]$/i,v6=/^\d+\/\d+$/,y6=new Set(["px","full","screen"]),x6=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,w6=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,b6=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,_6=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,S6=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Pl=r=>nh(r)||y6.has(r)||v6.test(r),jc=r=>wh(r,"length",I6),nh=r=>!!r&&!Number.isNaN(Number(r)),Ox=r=>wh(r,"number",nh),Vp=r=>!!r&&Number.isInteger(Number(r)),E6=r=>r.endsWith("%")&&nh(r.slice(0,-1)),or=r=>PT.test(r),Fc=r=>x6.test(r),C6=new Set(["length","size","percentage"]),k6=r=>wh(r,C6,jT),N6=r=>wh(r,"position",jT),T6=new Set(["image","url"]),R6=r=>wh(r,T6,j6),A6=r=>wh(r,"",P6),qp=()=>!0,wh=(r,e,t)=>{const n=PT.exec(r);return n?n[1]?typeof e=="string"?n[1]===e:e.has(n[1]):t(n[2]):!1},I6=r=>w6.test(r)&&!b6.test(r),jT=()=>!1,P6=r=>_6.test(r),j6=r=>S6.test(r),F6=()=>{const r=sn("colors"),e=sn("spacing"),t=sn("blur"),n=sn("brightness"),s=sn("borderColor"),i=sn("borderRadius"),c=sn("borderSpacing"),d=sn("borderWidth"),p=sn("contrast"),m=sn("grayscale"),g=sn("hueRotate"),x=sn("invert"),b=sn("gap"),S=sn("gradientColorStops"),T=sn("gradientColorStopPositions"),E=sn("inset"),C=sn("margin"),R=sn("opacity"),A=sn("padding"),F=sn("saturate"),P=sn("scale"),L=sn("sepia"),G=sn("skew"),U=sn("space"),V=sn("translate"),Q=()=>["auto","contain","none"],fe=()=>["auto","hidden","clip","visible","scroll"],B=()=>["auto",or,e],ee=()=>[or,e],ve=()=>["",Pl,jc],ce=()=>["auto",nh,or],ne=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],xe=()=>["solid","dashed","dotted","double","none"],J=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],X=()=>["start","end","center","between","around","evenly","stretch"],z=()=>["","0",or],q=()=>["auto","avoid","all","avoid-page","page","left","right","column"],O=()=>[nh,or];return{cacheSize:500,separator:":",theme:{colors:[qp],spacing:[Pl,jc],blur:["none","",Fc,or],brightness:O(),borderColor:[r],borderRadius:["none","","full",Fc,or],borderSpacing:ee(),borderWidth:ve(),contrast:O(),grayscale:z(),hueRotate:O(),invert:z(),gap:ee(),gradientColorStops:[r],gradientColorStopPositions:[E6,jc],inset:B(),margin:B(),opacity:O(),padding:ee(),saturate:O(),scale:O(),sepia:z(),skew:O(),space:ee(),translate:ee()},classGroups:{aspect:[{aspect:["auto","square","video",or]}],container:["container"],columns:[{columns:[Fc]}],"break-after":[{"break-after":q()}],"break-before":[{"break-before":q()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...ne(),or]}],overflow:[{overflow:fe()}],"overflow-x":[{"overflow-x":fe()}],"overflow-y":[{"overflow-y":fe()}],overscroll:[{overscroll:Q()}],"overscroll-x":[{"overscroll-x":Q()}],"overscroll-y":[{"overscroll-y":Q()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[E]}],"inset-x":[{"inset-x":[E]}],"inset-y":[{"inset-y":[E]}],start:[{start:[E]}],end:[{end:[E]}],top:[{top:[E]}],right:[{right:[E]}],bottom:[{bottom:[E]}],left:[{left:[E]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Vp,or]}],basis:[{basis:B()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",or]}],grow:[{grow:z()}],shrink:[{shrink:z()}],order:[{order:["first","last","none",Vp,or]}],"grid-cols":[{"grid-cols":[qp]}],"col-start-end":[{col:["auto",{span:["full",Vp,or]},or]}],"col-start":[{"col-start":ce()}],"col-end":[{"col-end":ce()}],"grid-rows":[{"grid-rows":[qp]}],"row-start-end":[{row:["auto",{span:[Vp,or]},or]}],"row-start":[{"row-start":ce()}],"row-end":[{"row-end":ce()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",or]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",or]}],gap:[{gap:[b]}],"gap-x":[{"gap-x":[b]}],"gap-y":[{"gap-y":[b]}],"justify-content":[{justify:["normal",...X()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...X(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...X(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[A]}],px:[{px:[A]}],py:[{py:[A]}],ps:[{ps:[A]}],pe:[{pe:[A]}],pt:[{pt:[A]}],pr:[{pr:[A]}],pb:[{pb:[A]}],pl:[{pl:[A]}],m:[{m:[C]}],mx:[{mx:[C]}],my:[{my:[C]}],ms:[{ms:[C]}],me:[{me:[C]}],mt:[{mt:[C]}],mr:[{mr:[C]}],mb:[{mb:[C]}],ml:[{ml:[C]}],"space-x":[{"space-x":[U]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[U]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",or,e]}],"min-w":[{"min-w":[or,e,"min","max","fit"]}],"max-w":[{"max-w":[or,e,"none","full","min","max","fit","prose",{screen:[Fc]},Fc]}],h:[{h:[or,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[or,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[or,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[or,e,"auto","min","max","fit"]}],"font-size":[{text:["base",Fc,jc]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Ox]}],"font-family":[{font:[qp]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",or]}],"line-clamp":[{"line-clamp":["none",nh,Ox]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Pl,or]}],"list-image":[{"list-image":["none",or]}],"list-style-type":[{list:["none","disc","decimal",or]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[r]}],"placeholder-opacity":[{"placeholder-opacity":[R]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[r]}],"text-opacity":[{"text-opacity":[R]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...xe(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Pl,jc]}],"underline-offset":[{"underline-offset":["auto",Pl,or]}],"text-decoration-color":[{decoration:[r]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:ee()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",or]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",or]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[R]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...ne(),N6]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",k6]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},R6]}],"bg-color":[{bg:[r]}],"gradient-from-pos":[{from:[T]}],"gradient-via-pos":[{via:[T]}],"gradient-to-pos":[{to:[T]}],"gradient-from":[{from:[S]}],"gradient-via":[{via:[S]}],"gradient-to":[{to:[S]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[d]}],"border-w-x":[{"border-x":[d]}],"border-w-y":[{"border-y":[d]}],"border-w-s":[{"border-s":[d]}],"border-w-e":[{"border-e":[d]}],"border-w-t":[{"border-t":[d]}],"border-w-r":[{"border-r":[d]}],"border-w-b":[{"border-b":[d]}],"border-w-l":[{"border-l":[d]}],"border-opacity":[{"border-opacity":[R]}],"border-style":[{border:[...xe(),"hidden"]}],"divide-x":[{"divide-x":[d]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[d]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[R]}],"divide-style":[{divide:xe()}],"border-color":[{border:[s]}],"border-color-x":[{"border-x":[s]}],"border-color-y":[{"border-y":[s]}],"border-color-s":[{"border-s":[s]}],"border-color-e":[{"border-e":[s]}],"border-color-t":[{"border-t":[s]}],"border-color-r":[{"border-r":[s]}],"border-color-b":[{"border-b":[s]}],"border-color-l":[{"border-l":[s]}],"divide-color":[{divide:[s]}],"outline-style":[{outline:["",...xe()]}],"outline-offset":[{"outline-offset":[Pl,or]}],"outline-w":[{outline:[Pl,jc]}],"outline-color":[{outline:[r]}],"ring-w":[{ring:ve()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[r]}],"ring-opacity":[{"ring-opacity":[R]}],"ring-offset-w":[{"ring-offset":[Pl,jc]}],"ring-offset-color":[{"ring-offset":[r]}],shadow:[{shadow:["","inner","none",Fc,A6]}],"shadow-color":[{shadow:[qp]}],opacity:[{opacity:[R]}],"mix-blend":[{"mix-blend":[...J(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":J()}],filter:[{filter:["","none"]}],blur:[{blur:[t]}],brightness:[{brightness:[n]}],contrast:[{contrast:[p]}],"drop-shadow":[{"drop-shadow":["","none",Fc,or]}],grayscale:[{grayscale:[m]}],"hue-rotate":[{"hue-rotate":[g]}],invert:[{invert:[x]}],saturate:[{saturate:[F]}],sepia:[{sepia:[L]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[t]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[p]}],"backdrop-grayscale":[{"backdrop-grayscale":[m]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[g]}],"backdrop-invert":[{"backdrop-invert":[x]}],"backdrop-opacity":[{"backdrop-opacity":[R]}],"backdrop-saturate":[{"backdrop-saturate":[F]}],"backdrop-sepia":[{"backdrop-sepia":[L]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[c]}],"border-spacing-x":[{"border-spacing-x":[c]}],"border-spacing-y":[{"border-spacing-y":[c]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",or]}],duration:[{duration:O()}],ease:[{ease:["linear","in","out","in-out",or]}],delay:[{delay:O()}],animate:[{animate:["none","spin","ping","pulse","bounce",or]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[P]}],"scale-x":[{"scale-x":[P]}],"scale-y":[{"scale-y":[P]}],rotate:[{rotate:[Vp,or]}],"translate-x":[{"translate-x":[V]}],"translate-y":[{"translate-y":[V]}],"skew-x":[{"skew-x":[G]}],"skew-y":[{"skew-y":[G]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",or]}],accent:[{accent:["auto",r]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",or]}],"caret-color":[{caret:[r]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":ee()}],"scroll-mx":[{"scroll-mx":ee()}],"scroll-my":[{"scroll-my":ee()}],"scroll-ms":[{"scroll-ms":ee()}],"scroll-me":[{"scroll-me":ee()}],"scroll-mt":[{"scroll-mt":ee()}],"scroll-mr":[{"scroll-mr":ee()}],"scroll-mb":[{"scroll-mb":ee()}],"scroll-ml":[{"scroll-ml":ee()}],"scroll-p":[{"scroll-p":ee()}],"scroll-px":[{"scroll-px":ee()}],"scroll-py":[{"scroll-py":ee()}],"scroll-ps":[{"scroll-ps":ee()}],"scroll-pe":[{"scroll-pe":ee()}],"scroll-pt":[{"scroll-pt":ee()}],"scroll-pr":[{"scroll-pr":ee()}],"scroll-pb":[{"scroll-pb":ee()}],"scroll-pl":[{"scroll-pl":ee()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",or]}],fill:[{fill:[r,"none"]}],"stroke-w":[{stroke:[Pl,jc,Ox]}],stroke:[{stroke:[r,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},O6=g6(F6);function Fr(...r){return O6(TT(r))}async function Dx(r){let e;if(r instanceof File)e=await r.arrayBuffer();else if(r instanceof ArrayBuffer)e=r;else if(r instanceof Uint8Array)e=r.buffer;else throw new Error("Unsupported data type for checksum calculation");const t=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(t)).map(i=>i.toString(16).padStart(2,"0")).join("")}const Tr="src/lib/utils/serverUtils.tsx",Lx=new Map,zf=3,TC=1e3;function RC(r){if(r instanceof Error){const e=r.message.toLowerCase();return e.includes("timeout")||e.includes("network")||e.includes("failed to fetch")||e.includes("504")||e.includes("503")}return!1}function Jy(r){const e=["x-trace-id","x-request-id","x-correlation-id","x-amzn-request-id","x-amzn-requestid","x-amzn-trace-id","request-id","trace-id","correlation-id"];for(const t of e){const n=r.headers.get(t);if(n)return n}return null}new URL(Pr+"/email-template");const D6=new URL(Pr+"/email-templates"),L6=new URL(Pr+"/email/generate"),M6=new URL(Pr+"/email/generate_for_outlook"),$6=new URL(Pr+"/email/reformat"),U6=new URL(Pr+"/email/participants"),z6=new URL(Pr+"/email/participants_with_category");new URL(Pr+"/email/register");new URL(Pr+"/email/unregister");const H6=new URL(Pr+"/email/get_registration"),B6=new URL(Pr+"/email/summarization"),G6=new URL(Pr+"/email/description_summarization"),W6=new URL(Pr+"/email/summarization_for_outlook");new URL(Pr+"/integration");const V6=new URL(Pr+"/integrations"),q6=new URL(Pr+"/integrations/client"),K6=new URL(Pr+"/integrations/document"),Y6=new URL(Pr+"/integrations/clients"),J6=new URL(Pr+"/integrations/project_documents"),X6=new URL(Pr+"/integrations/case_summary");new URL(Pr+"/integrations/uscis/case");const Q6=new URL(Pr+"/integrations/user"),FT=new URL(Pr+"/integrations/users"),og=new URL(Pr+"/integrations/write"),Z6=new URL(Pr+"/integrations/projects"),e8=new URL(Pr+"/integrations/project");new URL(Pr+"/integrations/contacts");const t8=new URL(Pr+"/integrations/settings"),r8=new URL(Pr+"/email/generate_task_description");new URL(Pr+"/admin/users");new URL(Pr+"/admin/user");const n8="CANDLE_ERROR_TOKEN_NOT_FOUND",s8="CANDLE_ERROR_TOKEN_REFRESH_FAILED";function Zc(r,e){const t={sourceFile:Tr};e.status===404?e.json().then(n=>{(n.error_code===n8||n.error_code===s8)&&(r.warn("404 error, Gmail might be disconnected from server, checking...",{...t,data:n}),Xy(r).then(s=>{s||r.error("Gmail has been disconnected from server unexpectedly!",new Error("Gmail has been disconnected from server, syncing..."),{...t,data:n})}))}):r.warn("HTTP error! status: "+e.status,{...t,data:e})}async function o8(r){const e={sourceFile:Tr};r.debug("Starting to fetch response...",e);const t=await Gr(D6,{method:"GET",headers:{"Content-Type":"application/json"}},r);if(r.debug("Response received:",{...e,data:t}),!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const n=t.headers.get("content-type");if(r.debug("Content-Type:",{...e,data:n}),n&&n.includes("application/json")){r.debug("Content-Type is JSON, parsing...",e);const s=await t.json();r.debug("Parsed JSON response:",{...e,data:s}),s.user_templates&&s.user_templates.length>0&&r.debug("First user template tags:",{...e,data:s.user_templates[0].tags}),s.org_templates&&s.org_templates.length>0&&r.debug("First org template tags:",{...e,data:s.org_templates[0].tags});const i=s.user_templates.map(d=>({...d,source:"SCOPE_USER"})),c=s.org_templates.map(d=>({...d,source:"SCOPE_TENANT"}));return r.debug("Enhanced user templates with source:",{...e,data:i}),r.debug("Enhanced org templates with source:",{...e,data:c}),{user_templates:i,org_templates:c}}else{r.debug("Content-Type is not JSON, handling as text...",e);const s=await t.text();throw r.error("Received non-JSON response:",s,e),new Error("Received non-JSON response from server")}}async function OT(r,e,t,n,s,i=[],c,d=!1){const p={sourceFile:Tr};c.debug("Starting to fetch response...",p),d?c.info("Force refresh flag is TRUE - will bypass backend cache",{...p,forceRefresh:!0}):c.debug("Force refresh flag is FALSE - will use cache-first",{...p,forceRefresh:!1});const m=[{role:"user",content:"Here's some additional relevant context to help with your response:"+t},{role:"user",content:"This is the specific email in the thread to respond to:"+e}],g={WEB_SOURCES:{PUBLIC:i}};try{const x=await Gr(L6,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email_thread_id:r,datasources:g,format_instruction:s+" "+n,additional_context:m,force_refresh:d})},c);if(c.debug("Response received:",{...p,data:x}),!x.ok)throw Zc(c,x),new Error(`HTTP error! status: ${x.status}`);const b=x.headers.get("content-type");c.debug("Content-Type:",{...p,data:b});let S;if(b&&b.includes("application/json"))c.debug("Content-Type is JSON, parsing...",p),S=await x.json();else{c.debug("Content-Type is not JSON, handling as text...",p);const G=await x.text();throw c.error("Received non-JSON response:",G,p),new Error("Received non-JSON response from server")}c.info("Parsed JSON response:",{...p,data:S});const T=S.response,E=S.references,C=S.cms_fields_used,R=S.cms_data,A=S.raw_cms_data;c.info("Result response:",{...p,data:T}),c.info("Result references:",{...p,data:E});const L=new DOMParser().parseFromString(T,"text/html").body.innerHTML;return c.debug("Extracted HTML body content:",{...p,data:L}),{response:L,references:E,cms_fields_used:C,cms_data:R,raw_cms_data:A,refreshed:S.refreshed??!1}}catch(x){return c.error("Error caught:",x,p),{response:"error",references:[],cms_fields_used:[],cms_data:[]}}}async function DT(r,e,t,n,s,i,c,d=!1){const p={sourceFile:Tr};c.debug("Starting to fetch response for Outlook...",p),d?c.info("Force refresh flag is TRUE - will bypass backend cache",{...p,forceRefresh:!0}):c.debug("Force refresh flag is FALSE - will use cache-first",{...p,forceRefresh:!1});const m=[{role:"user",content:"Here's some additional relevant context to help with your response:"+t}];try{const g=await Gr(M6,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({thread_id:r,full_thread:e,email_participants:i,format_instruction:s+" "+n,additional_context:m,force_refresh:d})},c);if(c.debug("Response received:",{...p,data:g}),!g.ok)throw new Error(`HTTP error! status: ${g.status}`);const x=g.headers.get("content-type");c.debug("Content-Type:",{...p,data:x});let b;if(x&&x.includes("application/json"))c.debug("Content-Type is JSON, parsing...",p),b=await g.json();else{c.debug("Content-Type is not JSON, handling as text...",p);const L=await g.text();throw c.error("Received non-JSON response:",L,p),new Error("Received non-JSON response from server")}c.info("Parsed JSON response:",{...p,data:b});const S=b.response,T=b.references,E=b.cms_fields_used,C=b.cms_data,R=b.raw_cms_data;c.debug("Result response:",{...p,data:S}),c.debug("Result references:",{...p,data:T});const P=new DOMParser().parseFromString(S,"text/html").body.innerHTML;return c.debug("Extracted HTML body content:",{...p,data:P}),{response:P,references:T,cms_fields_used:E,cms_data:C,raw_cms_data:R,refreshed:b.refreshed??!1}}catch(g){return c.error("Error caught:",g,p),{response:"error",references:[],cms_fields_used:[],cms_data:[]}}}async function i8(r,e){const t=r==null?void 0:r.case_management_systems_data;if(!t||typeof t!="object")return;const n=Object.entries(t);if(n.length>100){e.warn("Skipping cache prefill: raw_cms_data exceeds 100 entries",{sourceFile:Tr,count:n.length});return}for(const[s,i]of n)if(!(!s||typeof s!="string"||!i||typeof i!="object"||await zm(s,e)))for(const[,d]of Object.entries(i))!d||typeof d!="object"||await ST(s,{client_data:d.client_data||{},case_data:d.case_data||[],pagination:d.pagination},e)}async function LT(r,e,t){const n={sourceFile:Tr};t.debug("Starting to fetch response...",n);const s=await Gr($6,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({reformat_instruction:e,chat_history:[{content:"Here's the HTML Content. Respond with only the HTML content for the revised email response:"+r}]})},t);if(t.debug("Response received:",{...n,data:s}),!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const i=s.headers.get("content-type");if(t.debug("Content-Type:",{...n,data:i}),i&&i.includes("application/json")){t.debug("Content-Type is JSON, parsing...",n);const c=await s.json();t.debug("Parsed JSON response:",{...n,data:c});const d=c.replace(/^```html\s*/,"");t.debug("Cleaned data:",{...n,data:d});const g=new DOMParser().parseFromString(d,"text/html").body.innerHTML;return t.debug("Extracted HTML body content:",{...n,data:g}),g}else{t.debug("Content-Type is not JSON, handling as text...",n);const c=await s.text();throw t.error("Received non-JSON response:",c,n),new Error("Received non-JSON response from server")}}async function Yc(r,e){const t={sourceFile:Tr};e.debug("Starting to list integrations...",t);const n=new URL(V6);n.searchParams.append("integration_scope",r);try{const s=await Gr(n,{method:"GET",headers:{"Content-Type":"application/json"}},e);if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const i=s.headers.get("content-type");if(i&&i.includes("application/json")){const c=await s.json();e.debug("Integrations:",{...t,data:c.integrations});const d=c.integrations.map(p=>({integration_type:p.integration_type,tenantId_userId:p.tenantId_userId,scope:r}));return await tg(e,d),d||[]}else throw new Error("Received non-JSON response from server")}catch(s){throw e.error("Error listing integrations:",s,t),s}}async function Xy(r){const e={sourceFile:Tr};r.debug("Starting to check if Gmail integration is connected...",e);try{const t=await Gr(H6,{method:"GET",headers:{"Content-Type":"application/json"}},r);r.debug("Response received:",{...e,data:t});let n=!1;if(t.ok){const s=await t.json();r.debug("Parsed JSON response:",{...e,data:s}),n=s.is_registered===!0}return await zU(r,n),n}catch(t){r.error("Error checking Gmail connection status:",t,e);try{const n=await HU(r);if(n.isConnected!==null)return r.debug("Returning cached Gmail connection status due to error",{...e,cachedStatus:n.isConnected,cachedTimestamp:n.timestamp}),n.isConnected}catch(n){r.error("Error retrieving cached Gmail connection status:",n,e)}return!1}}async function a8(r,e){const t={sourceFile:Tr};try{const n=await Gr(B6,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email_thread_id:r})},e);if(e.debug("Response received:",{...t,data:n}),!n.ok)throw Zc(e,n),new Error(`HTTP error! status: ${n.status}`);const s=n.headers.get("content-type");if(s&&s.includes("application/json")){const i=await n.json();if(!i||!i.message)throw new Error("Summary not found in response");let c=null;if(i.message.important_details)try{typeof i.message.important_details=="object"?(e.debug("Important details is already an object, using it directly...",t),c=i.message.important_details):typeof i.message.important_details=="string"&&(e.debug("Important details is a JSON string, parsing...",t),c=JSON.parse(i.message.important_details)),e.debug("Parsed important details:",{...t,data:c})}catch(d){e.error("Error parsing important details:",d,t),c=null}return{summary:i.message.summary,importantDetails:c,topicsDiscussed:i.message.topics_discussed,actionItems:i.message.action_items}}else throw new Error("Received non-JSON response from server")}catch(n){return e.error("Error caught:",n,t),{summary:"Error fetching email summary: "+n,importantDetails:null,topicsDiscussed:"",actionItems:""}}}async function AC(r,e,t){const n={sourceFile:Tr};try{const s=await Gr(G6,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email_thread_id:r,email_thread_content:e})},t);if(t.debug("Response received:",{...n,data:s}),!s.ok)throw Zc(t,s),new Error(`HTTP error! status: ${s.status}`);const i=s.headers.get("content-type");if(i&&i.includes("application/json")){const c=await s.json();if(!c||!c.message)throw new Error("Summary not found in response");return{description:c.message}}else throw new Error("Received non-JSON response from server")}catch(s){return t.error("Error caught:",s,n),{description:""}}}async function l8(r,e){const t={sourceFile:Tr};try{const n=await Gr(W6,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({full_thread:r})},e);if(e.debug("Response received:",{...t,data:n}),!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const s=n.headers.get("content-type");if(s&&s.includes("application/json")){const i=await n.json();if(!i||!i.message)throw new Error("Summary not found in response");let c=null;if(i.message.important_details)try{typeof i.message.important_details=="object"?(e.debug("Important details is already an object, using it directly...",t),c=i.message.important_details):typeof i.message.important_details=="string"&&(e.debug("Important details is a JSON string, parsing...",t),c=JSON.parse(i.message.important_details)),e.debug("Parsed important details:",{...t,data:c})}catch(d){e.error("Error parsing important details:",d,t),c=null}return{summary:i.message.summary,importantDetails:c,topicsDiscussed:i.message.topics_discussed,actionItems:i.message.action_items}}else throw new Error("Received non-JSON response from server")}catch(n){return e.error("Error caught:",n,t),{summary:"Error fetching email summary: "+n,importantDetails:null,topicsDiscussed:"",actionItems:""}}}async function tS(r,e,t,n=!1,s,i){const c={sourceFile:Tr,functionName:"getClientDataFromServer"},d=e.toLowerCase(),p=s!=null&&s.cursor?`:cursor_${s.cursor}`:"",m=`${r}:${d}${p}`,g=Lx.get(m);if(g)return t.debug("Returning existing in-flight request",{...c,clientEmail:e}),console.log(` [${r.toUpperCase()}] Deduplicating request for ${e} - returning in-flight promise`),g;const x=Ww(r,e,t,n,s,i);return Lx.set(m,x),x.finally(()=>{Lx.delete(m)})}async function Ww(r,e,t,n=!1,s,i,c=0){const d={sourceFile:Tr,functionName:"fetchClientDataInternal"},p=Date.now();if(console.group(` [${r.toUpperCase()}] getClientDataFromServer - ${e}${c>0?` (retry ${c})`:""}`),console.time("getClientDataFromServer:total"),console.log("Integration:",r),console.log("Client Email:",e),t.info("Starting client data fetch",{...d,clientEmail:e,integrationType:r,retryCount:c}),c===0){const C=q5(e);if(C.inCache)throw console.log(` Timeout cache hit: Email recently failed with ${C.errorType}`),console.timeEnd("getClientDataFromServer:total"),console.groupEnd(),t.info("Email in timeout cache, skipping API call to prevent retry storm",{...d,clientEmail:e,errorType:C.errorType,totalMs:Date.now()-p}),new Error(`Request recently failed (${C.errorType}) - try again later`)}console.time("getClientDataFromServer:nonExistentCacheCheck");const m=Date.now(),g=await e6(e,t),x=Date.now()-m;if(console.timeEnd("getClientDataFromServer:nonExistentCacheCheck"),g)throw console.log(" Non-existent cache hit: Email known to have no client data"),console.timeEnd("getClientDataFromServer:total"),console.groupEnd(),t.info("Email in non-existent cache, skipping API call",{...d,clientEmail:e,nonExistentCacheCheckMs:x,totalMs:Date.now()-p}),new Error("Client not found (cached)");console.time("getClientDataFromServer:clientCacheCheck");const b=Date.now(),S=s!=null&&s.cursor?null:await zm(e,t),T=Date.now()-b;if(console.timeEnd("getClientDataFromServer:clientCacheCheck"),S)return console.log(" Cache hit: Client data found in cache"),console.timeEnd("getClientDataFromServer:total"),console.groupEnd(),t.info("Client data found in cache",{...d,clientEmail:e,nonExistentCacheCheckMs:x,clientCacheCheckMs:T,totalMs:Date.now()-p}),S;const E=new URL(q6);E.searchParams.append("integration_type",r),E.searchParams.append("client_email",e),E.searchParams.append("data_type","client_data"),s&&(E.searchParams.append("limit",String(s.limit||10)),s.cursor&&E.searchParams.append("cursor",s.cursor)),i&&E.searchParams.append("thread_id",i),n&&E.searchParams.append("force_refresh","true");try{console.time("getClientDataFromServer:apiCall"),console.log(" Making API request to:",E.toString());const C=Date.now(),R=await Gr(E,{method:"GET",headers:{"Content-Type":"application/json"}},t),A=Date.now()-C,F=Jy(R);if(console.timeEnd("getClientDataFromServer:apiCall"),console.log(" Response status:",R.status,`(${A}ms)`),console.log(" Trace ID:",F||"N/A"),R.status===504||R.status===503)if(console.error(` ${R.status} Gateway Timeout - API call took too long`),console.log("Request URL:",E.toString()),console.log("Time elapsed before timeout:",A,"ms"),console.log(" Trace ID for debugging:",F||"N/A"),c<zf){const L=TC*Math.pow(2,c);return console.log(` Retrying in ${L}ms (attempt ${c+1}/${zf})`),console.timeEnd("getClientDataFromServer:total"),console.groupEnd(),t.info("Retrying after timeout",{...d,clientEmail:e,status:R.status,retryCount:c+1,delayMs:L,traceId:F}),await new Promise(G=>setTimeout(G,L)),Ww(r,e,t,n,s,i,c+1)}else EC(e,`${R.status}`),console.log(` Max retries (${zf}) exhausted, added to timeout cache`),t.warn("Max retries exhausted for timeout error, added to timeout cache",{...d,clientEmail:e,status:R.status,retryCount:c,traceId:F});if(t.info("API response received",{...d,clientEmail:e,status:R.status,apiMs:A,nonExistentCacheCheckMs:x,clientCacheCheckMs:T,traceId:F,retryCount:c}),!R.ok){if(R.status===404&&(await Z5(e,t),Zc(t,R)),console.error(" API error:",R.status),console.timeEnd("getClientDataFromServer:total"),console.groupEnd(),R.status===400)try{const L=await R.json();if(L!=null&&L.error)throw new Error(`HTTP error! status: 400 - ${L.error}`)}catch(L){if(L instanceof Error&&L.message.startsWith("HTTP error!"))throw L}throw new Error(`HTTP error! status: ${R.status}`)}const P=R.headers.get("content-type");if(P&&P.includes("application/json")){console.time("getClientDataFromServer:parseJson");const L=Date.now(),G=await R.json(),U=Date.now()-L;console.timeEnd("getClientDataFromServer:parseJson");const V=G.requestId,Q=G.traceId,fe=V||F;V&&console.log(" Request ID (from body):",V),Q&&console.log(" Trace ID (from body):",Q);const B={client_data:G.client_data||{},case_data:G.case_data||[],pagination:G.pagination||void 0};console.time("getClientDataFromServer:cacheWrite");const ee=Date.now();s!=null&&s.cursor||await ST(e,B,t);const ve=Date.now()-ee;console.timeEnd("getClientDataFromServer:cacheWrite"),xT(e);const ce=Date.now()-p;return console.log(" Client data fetch completed"),console.log(" Timing breakdown:",{nonExistentCacheCheck:`${x}ms`,clientCacheCheck:`${T}ms`,apiCall:`${A}ms`,parseJson:`${U}ms`,cacheWrite:`${ve}ms`,total:`${ce}ms`}),console.timeEnd("getClientDataFromServer:total"),console.groupEnd(),t.info("Client data fetch completed",{...d,clientEmail:e,nonExistentCacheCheckMs:x,clientCacheCheckMs:T,apiMs:A,parseMs:U,cacheWriteMs:ve,totalMs:ce,retryCount:c,requestId:fe,traceId:Q||F}),B}else throw console.error(" Received non-JSON response"),console.timeEnd("getClientDataFromServer:total"),console.groupEnd(),new Error("Received non-JSON response from server")}catch(C){const R=Date.now()-p;if(c<zf&&RC(C)){const A=TC*Math.pow(2,c);return console.log(` Retrying after error in ${A}ms (attempt ${c+1}/${zf})`),console.timeEnd("getClientDataFromServer:total"),console.groupEnd(),t.info("Retrying after network error",{...d,clientEmail:e,error:C instanceof Error?C.message:String(C),retryCount:c+1,delayMs:A}),await new Promise(F=>setTimeout(F,A)),Ww(r,e,t,n,s,i,c+1)}if(RC(C)){const A=C instanceof Error?C.message.includes("timeout")?"timeout":"network":"unknown";EC(e,A),console.log(` Max retries (${zf}) exhausted for ${A} error, added to timeout cache`),t.warn("Max retries exhausted for network error, added to timeout cache",{...d,clientEmail:e,errorType:A,retryCount:c})}throw console.error(" Client data fetch failed:",C instanceof Error?C.message:String(C)),console.log(" Timing at failure:",{nonExistentCacheCheck:`${x}ms`,clientCacheCheck:`${T}ms`,total:`${R}ms`}),console.timeEnd("getClientDataFromServer:total"),console.groupEnd(),t.info("Client data fetch failed",{...d,clientEmail:e,error:C instanceof Error?C.message:String(C),nonExistentCacheCheckMs:x,clientCacheCheckMs:T,totalMs:R,retryCount:c}),C}}async function MT(r,e,t){const n={sourceFile:Tr,functionName:"getDocumentListForProject"};t.debug("Starting to fetch project documents...",{...n,projectId:e});const s=new URL(J6);s.searchParams.append("integration_type",r),s.searchParams.append("project_id",e);try{const i=await Gr(s,{method:"GET",headers:{"Content-Type":"application/json"}},t);if(t.debug("Response received:",{...n,data:i}),!i.ok){if(i.status===404)return Zc(t,i),{documents:[]};throw new Error(`HTTP error! status: ${i.status}`)}const c=i.headers.get("content-type");if(c&&c.includes("application/json")){const d=await i.json();return t.debug("Parsed JSON response:",{...n,data:d}),{documents:d.documents||[]}}else throw new Error("Received non-JSON response from server")}catch(i){throw t.debug("Error fetching project documents:",{...n,error:i}),i}}async function c8(r,e,t){const n={sourceFile:Tr,functionName:"getCaseSummaryForProject"};t.debug("Starting to fetch case summary...",{...n,projectId:e});const s=new URL(X6);s.searchParams.append("integration_type",r),s.searchParams.append("project_id",e);try{const i=await Gr(s,{method:"GET",headers:{"Content-Type":"application/json"}},t);if(t.debug("Response received:",{...n,data:i}),!i.ok){if(i.status===404)return Zc(t,i),null;throw new Error(`HTTP error! status: ${i.status}`)}const c=i.headers.get("content-type");if(c&&c.includes("application/json")){const d=await i.json();return t.debug("Parsed JSON response:",{...n,data:d}),{caseFacts:d.caseFacts||"",supioLink:d.supioLink||"",statuteoflimitations:d.statuteoflimitations||{dateValue:"",doneDate:null},disbursementSheet:d.disbursementSheet||null,totalMeds:d.totalMeds||0,totalLiens:d.totalLiens||0}}else throw new Error("Received non-JSON response from server")}catch(i){return t.debug("Error fetching case summary:",{...n,error:i}),null}}async function u8(r,e){const t={sourceFile:Tr,functionName:"getEmailParticipantsFromServer"};e.debug("Starting to fetch response...",t);const n={email_thread_id:r};try{const s=await Gr(U6,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)},e);if(e.debug("Response received:",{...t,data:s}),!s.ok)throw Zc(e,s),new Error(`HTTP error! status: ${s.status}`);const i=s.headers.get("content-type");if(i&&i.includes("application/json")){const c=await s.json();return e.debug("Parsed JSON response:",{...t,data:c}),c.email_participants}else throw new Error("Received non-JSON response from server")}catch(s){throw e.error("Error fetching email participants:",s,t),s}}async function $T(r,e){const t={sourceFile:Tr,functionName:"getEmailParticipantsFromServer"};e.debug("Starting to fetch response...",t);const n={email_thread_id:r};try{const s=await Gr(z6,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)},e);if(e.debug("Response received:",{...t,data:s}),!s.ok)throw Zc(e,s),new Error(`HTTP error! status: ${s.status}`);const i=s.headers.get("content-type");if(i&&i.includes("application/json")){const c=await s.json();return e.debug("Parsed JSON response:",{...t,data:c}),c.email_details}else throw new Error("Received non-JSON response from server")}catch(s){throw e.error("Error fetching email participants:",s,t),s}}async function d8(r,e,t){const n={sourceFile:Tr,functionName:"getDocumentURLFromServer"};t.debug("Starting to fetch document data...",n);const s=new URL(K6);s.searchParams.append("integration_type",r),s.searchParams.append("document_id",e);try{const i=await Gr(s,{method:"GET",headers:{"Content-Type":"application/json"}},t);if(t.debug("Response received:",{...n,data:i}),!i.ok)throw i.status===404?new Error("Document not found or integration not configured"):new Error(`HTTP error! status: ${i.status}`);const c=i.headers.get("content-type");if(c&&c.includes("application/json")){const d=await i.json();if(t.debug("Parsed JSON response:",{...n,data:d}),!d.url)throw new Error("Document URL not found in response");return{documentId:parseInt(e),url:d.url}}else throw new Error("Received non-JSON response from server")}catch(i){throw t.error("Error fetching document data:",i,n),i}}async function f8(r,e){const t={sourceFile:Tr,functionName:"getAllClientsFromServer"};r.debug("Starting to fetch all clients for project...",t);const n=new URL(Y6);n.searchParams.append("integration_type",e);try{const s=await Gr(n,{method:"GET",headers:{"Content-Type":"application/json"}},r);if(r.debug("Response received:",{...t,data:s}),!s.ok)throw s.status===400?new Error("Missing required parameters"):s.status===404?new Error("No integration found for the specified type"):new Error(`HTTP error! status: ${s.status}`);const i=s.headers.get("content-type");if(i&&i.includes("application/json")){const c=await s.json();return r.debug("Parsed JSON response:",{...t,data:c}),{clients:c}}else throw new Error("Received non-JSON response from server")}catch(s){throw r.error("Error fetching all clients:",s,t),s}}async function Qy(r,e,t){var i,c;const n={sourceFile:Tr},s=Date.now();console.group(` [${r.toUpperCase()}] searchProjectsFromServer - "${e}"`),console.time("searchProjectsFromServer:total"),console.log("Integration:",r),console.log("Search Term:",e);try{t.info("Searching projects",{...n,integrationType:r,searchTerm:e});const d=new URL(Z6);d.searchParams.append("integration_type",r),d.searchParams.append("search_term",e),d.searchParams.append("exclude_archived","true"),d.searchParams.append("limit","10"),console.time("searchProjectsFromServer:apiCall"),console.log(" Making API request to:",d.toString());const p=Date.now(),m=await Gr(d,{method:"GET",headers:{"Content-Type":"application/json"}},t),g=Date.now()-p,x=Jy(m);if(console.timeEnd("searchProjectsFromServer:apiCall"),console.log(" Response status:",m.status,`(${g}ms)`),console.log(" Trace ID:",x||"N/A"),m.status===504&&(console.error(" 504 Gateway Timeout - API call took too long"),console.log("Request URL:",d.toString()),console.log("Time elapsed before timeout:",g,"ms"),console.log(" Trace ID for debugging:",x||"N/A")),!m.ok){if(m.status===404)return console.log(" No projects found (404)"),console.timeEnd("searchProjectsFromServer:total"),console.groupEnd(),t.debug("No projects found",{...n,traceId:x}),{projects:[],total:0,hasMore:!1};throw console.error(" API error:",m.status),console.timeEnd("searchProjectsFromServer:total"),console.groupEnd(),new Error(`Search failed: ${m.status}`)}const b=m.headers.get("content-type");if(b&&b.includes("application/json")){console.time("searchProjectsFromServer:parseJson");const S=await m.json();console.timeEnd("searchProjectsFromServer:parseJson");const T=Date.now()-s;return console.log(" Project search completed"),console.log(" Results:",((i=S.projects)==null?void 0:i.length)||0,"projects found"),console.log(" Timing breakdown:",{apiCall:`${g}ms`,total:`${T}ms`}),console.timeEnd("searchProjectsFromServer:total"),console.groupEnd(),t.info("Project search successful",{...n,resultCount:((c=S.projects)==null?void 0:c.length)||0}),S}else throw console.error(" Received non-JSON response"),console.timeEnd("searchProjectsFromServer:total"),console.groupEnd(),new Error("Received non-JSON response from server")}catch(d){const p=Date.now()-s;throw console.error(" Project search failed:",d instanceof Error?d.message:String(d)),console.log(" Timing at failure:",{total:`${p}ms`}),console.timeEnd("searchProjectsFromServer:total"),console.groupEnd(),t.error("Error searching projects",d,{...n,integrationType:r,searchTerm:e}),d}}async function h8(r,e,t){var i,c,d,p;const n={sourceFile:Tr},s=Date.now();console.group(` [${r.toUpperCase()}] getProjectDataById - ${e}`),console.time("getProjectDataById:total"),console.log("Integration:",r),console.log("Project ID:",e);try{t.info("Fetching project data by ID",{...n,integrationType:r,projectId:e});const m=new URL(e8);m.searchParams.append("integration_type",r),m.searchParams.append("project_id",e),console.time("getProjectDataById:apiCall"),console.log(" Making API request to:",m.toString());const g=Date.now(),x=await Gr(m,{method:"GET",headers:{"Content-Type":"application/json"}},t),b=Date.now()-g,S=Jy(x);if(console.timeEnd("getProjectDataById:apiCall"),console.log(" Response status:",x.status,`(${b}ms)`),console.log(" Trace ID:",S||"N/A"),x.status===504&&(console.error(" 504 Gateway Timeout - API call took too long"),console.log("Request URL:",m.toString()),console.log("Time elapsed before timeout:",b,"ms"),console.log(" Trace ID for debugging:",S||"N/A")),!x.ok){if(x.status===404)return console.log(" Project not found (404)"),console.timeEnd("getProjectDataById:total"),console.groupEnd(),t.debug("Project not found",{...n,traceId:S}),{};throw console.error(" API error:",x.status),console.timeEnd("getProjectDataById:total"),console.groupEnd(),new Error(`Failed to fetch project: ${x.status}`)}const T=x.headers.get("content-type");if(T&&T.includes("application/json")){console.time("getProjectDataById:parseJson");const E=await x.json();console.timeEnd("getProjectDataById:parseJson");const C=E.project||{},R=Date.now()-s;return console.log(" Project data fetched successfully"),console.log(" Data includes:",{hasCalendarEntries:!!((i=C.case_data)!=null&&i.calendar_entries||C.calendar_entries),hasNotes:!!((c=C.case_data)!=null&&c.notes||C.notes),hasTasks:!!((d=C.case_data)!=null&&d.last_completed_task||(p=C.case_data)!=null&&p.next_upcoming_task)}),console.log(" Timing breakdown:",{apiCall:`${b}ms`,total:`${R}ms`}),console.timeEnd("getProjectDataById:total"),console.groupEnd(),t.info("Project data fetched successfully",{...n,projectId:e}),C}else throw console.error(" Received non-JSON response"),console.timeEnd("getProjectDataById:total"),console.groupEnd(),new Error("Received non-JSON response from server")}catch(m){const g=Date.now()-s;throw console.error(" Project data fetch failed:",m instanceof Error?m.message:String(m)),console.log(" Timing at failure:",{total:`${g}ms`}),console.timeEnd("getProjectDataById:total"),console.groupEnd(),t.error("Error fetching project by ID",m,{...n,integrationType:r,projectId:e}),m}}async function p8(r,e){const t={sourceFile:Tr,functionName:"getUserDataFromServer"},n=Date.now(),s=`getUserDataFromServer:${n}`;r.debug("Starting to fetch user data...",t);const i=new URL(Q6);i.searchParams.append("integration_type",e);try{const c=Date.now(),d=await Gr(i,{method:"GET",headers:{"Content-Type":"application/json"}},r),p=Jy(d);if(console.timeEnd("getUserDataFromServer:apiCall"),d.status===504&&console.error(" 504 Gateway Timeout - API call took too long"),r.debug("Response received:",{...t,data:d,traceId:p}),!d.ok)throw d.status===400?(console.error(" API error: 400 - Missing required parameters"),new Error("Missing required parameters")):d.status===404?(console.error(" API error: 404 - No integration found"),new Error("No integration found for the specified type")):(console.error(" API error:",d.status),new Error(`HTTP error! status: ${d.status}`));const m=d.headers.get("content-type");if(m&&m.includes("application/json")){console.time("getUserDataFromServer:parseJson");const g=await d.json();return console.timeEnd("getUserDataFromServer:parseJson"),console.timeEnd(s),console.groupEnd(),r.debug("Parsed JSON response:",{...t,data:g}),{id:g.id||null,name:g.name||null,rate:g.rate||0}}else throw console.error(" Received non-JSON response"),new Error("Received non-JSON response from server")}catch(c){const d=Date.now()-n;throw console.error(" User data fetch failed:",c instanceof Error?c.message:String(c)),console.log(" Timing at failure:",{total:`${d}ms`}),console.timeEnd(s),console.groupEnd(),r.error("Error fetching user data:",c,t),c}}async function m8(r,e,t){var i,c;const n={sourceFile:Tr,functionName:"searchFirmUsersFromServer"};t.debug("Starting to search firm users...",{...n,integrationType:r,searchTerm:e});const s=new URL(FT);s.searchParams.append("integration_type",r),s.searchParams.append("request_function","search_firm_users"),s.searchParams.append("search_term",e),s.searchParams.append("limit","10");try{const d=await Gr(s,{method:"GET",headers:{"Content-Type":"application/json"}},t);if(t.debug("Response received:",{...n,status:d.status}),!d.ok){if(d.status===404)return t.debug("No users found",n),{users:[],total:0,hasMore:!1};throw new Error(`HTTP error! status: ${d.status}`)}const p=d.headers.get("content-type");if(p&&p.includes("application/json")){const m=await d.json();return t.debug("Parsed JSON response:",{...n,usersCount:((i=m.users)==null?void 0:i.length)||0}),{users:m.users||[],total:m.total||((c=m.users)==null?void 0:c.length)||0,hasMore:m.has_more||!1}}else throw new Error("Received non-JSON response from server")}catch(d){throw t.error("Error searching firm users:",d,n),d}}async function UT(r,e){var s;const t={sourceFile:Tr,functionName:"getFirmUsersFromServer"};e.debug("Starting to fetch firm users...",{...t,integrationType:r});const n=new URL(FT);n.searchParams.append("integration_type",r),n.searchParams.append("request_function","get_firm_users");try{const i=await Gr(n,{method:"GET",headers:{"Content-Type":"application/json"}},e);if(e.debug("Response received:",{...t,status:i.status}),!i.ok)throw new Error(`HTTP error! status: ${i.status}`);const c=i.headers.get("content-type");if(c&&c.includes("application/json")){const d=await i.json();return e.debug("Parsed JSON response:",{...t,usersCount:((s=d.users)==null?void 0:s.length)||0}),d.users||[]}else throw new Error("Received non-JSON response from server")}catch(i){throw e.error("Error fetching firm users:",i,t),i}}async function py(r,e,t,n,s,i,c,d,p,m,g,x,b,S,T,E){const C={sourceFile:Tr,functionName:"writeTimeEntryToServer"};E.debug("Starting to write time entry to server...",C);try{const R=await Gr(og,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_email:r,function:"write_time_entry_to_clio",integration_type:e,date:t,quantity:n,description:s,matter_id:i,write_time_entry:c,email_subject:d,email_body:p,sent_at:m,sender_email:g,recipient_emails:x,non_billable:b,no_charge:S,price:T})},E);if(E.debug("Response received:",{...C,data:R,sourceFile:Tr}),!R.ok)throw new Error(`HTTP error! status: ${R.status}`);const A=R.headers.get("content-type");if(A&&A.includes("application/json")){const F=await R.json();return E.debug("Parsed JSON response:",{...C,data:F}),F.message||"Time entry written successfully"}else throw new Error("Received non-JSON response from server")}catch(R){throw E.error("Error writing time entry:",R,{...C,sourceFile:Tr}),R}}async function zT(r){const e={sourceFile:Tr,functionName:"getIntegrationSettingsFromServer"};r.debug("Starting to fetch integration settings...",{...e});const t=new URL(t8);try{const n=await Gr(t,{method:"GET",headers:{"Content-Type":"application/json"}},r);if(r.debug("Response received:",{...e,data:n}),!n.ok){if(n.status===404)return r.debug("No settings found, returning defaults",e),{};throw new Error(`HTTP error! status: ${n.status}`)}const s=n.headers.get("content-type");if(s&&s.includes("application/json")){const i=await n.json();return r.debug("Parsed JSON response:",{...e,data:i}),i.integration_settings||{}}else throw new Error("Received non-JSON response from server")}catch(n){return r.error("Error fetching integration settings:",n,e),{}}}async function g8(r,e,t){const n={sourceFile:Tr,functionName:"generateTaskDescriptionFromEmail"};t.debug("Starting to generate task description from email...",n);try{const s=await Gr(r8,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({integration_type:r,email_content:e})},t);if(t.debug("Response received:",{...n,data:s}),!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const i=s.headers.get("content-type");if(i&&i.includes("application/json")){const c=await s.json();return t.debug("Parsed JSON response:",{...n,data:c}),{name:c.name||"",description:c.description||""}}else throw new Error("Received non-JSON response from server")}catch(s){throw t.error("Error generating task description:",s,n),s}}async function v8(r,e,t,n,s,i,c,d,p,m){const g={sourceFile:Tr,functionName:"createClioTask"};c.debug("Starting to create Clio task...",{...g,taskName:e,matterId:n,dueAt:s,priority:i,assigneeId:d,reminder:p,notificationFlags:m});try{const x={function:"write_task_to_clio",integration_type:r,name:e,description:t,matter_id:n,due_at:s,priority:i};d&&(x.assignee_id=d),p&&(x.reminder=p),m&&(x.notify_assignee=m.notifyAssignee,x.notify_completion=m.notifyCompletion);const b=await Gr(og,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(x)},c);if(c.debug("Response received:",{...g,data:b}),!b.ok)throw new Error(`HTTP error! status: ${b.status}`);const S=b.headers.get("content-type");if(S&&S.includes("application/json")){const T=await b.json();return c.debug("Parsed JSON response:",{...g,data:T}),{taskId:T.task_id||"",message:T.message||"Task created successfully"}}else throw new Error("Received non-JSON response from server")}catch(x){throw c.error("Error creating Clio task:",x,g),x}}async function y8(r,e,t,n,s,i,c){const d={sourceFile:Tr,functionName:"createClioNote"};try{const m=await Gr(og,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({function:"write_note_to_clio",integration_type:r,subject:e,detail:t,date:n,matter_id:s,contact_id:i})},c);if(!m.ok){const x=await m.json();throw new Error(x.message||`HTTP error! status: ${m.status}`)}const g=await m.json();return c.info("Note created successfully",{...d,noteId:g.note_id}),{noteId:g.note_id,message:g.message||"Note created successfully"}}catch(p){throw c.error("Error creating note",p,d),p}}async function x8(r,e){const t={sourceFile:Tr,functionName:"createContactInClio"};e.debug("Starting to create Clio contact...",{...t,email:r.email});try{const n=await Gr(og,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({function:"create_contact_in_clio",integration_type:"clio",first_name:r.firstName,last_name:r.lastName,email:r.email,phone_number:r.phoneNumber,contact_type:r.type,company_name:r.companyName})},e);if(e.debug("Response received:",{...t,data:n}),!n.ok){const c=(await n.json().catch(()=>({}))).error||`HTTP error! status: ${n.status}`;throw new Error(c)}const s=n.headers.get("content-type");if(s&&s.includes("application/json")){const i=await n.json();return e.debug("Parsed JSON response:",{...t,data:i}),{id:i.contact_id||i.id||"",message:i.message||"Contact created successfully"}}else throw new Error("Received non-JSON response from server")}catch(n){throw e.error("Error creating Clio contact:",n,t),n}}async function w8(r,e,t,n,s){const i={sourceFile:Tr,functionName:"linkContactToMatter"};s.debug("Starting to link contact to matter...",{...i,contactId:e,matterId:t,relationship:n});try{const c=await Gr(og,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({function:"link_contact_to_matter",integration_type:r,contact_id:e,matter_id:t,relationship:n})},s);if(s.debug("Response received:",{...i,data:c}),!c.ok){const m=(await c.json().catch(()=>({}))).error||`HTTP error! status: ${c.status}`;throw new Error(m)}const d=c.headers.get("content-type");if(d&&d.includes("application/json")){const p=await c.json();return s.debug("Parsed JSON response:",{...i,data:p}),{message:p.message||"Contact linked to matter successfully"}}else throw new Error("Received non-JSON response from server")}catch(c){throw s.error("Error linking contact to matter:",c,i),c}}function un(){const r=w.useContext(Z_);if(!r)throw new Error("usePlatform must be used within a PlatformProvider");if(!r.services)throw new Error("Platform services are not available. Services may still be loading or failed to initialize.");return r}const Ya=()=>un().services.storage,aa=()=>un().services.data,HT=()=>un().services.auth,b8=()=>un().services.messaging,_8=()=>un().services.tabs,S8=()=>un().services.lifecycle,E8=()=>un().services.logging,C8=({children:r})=>{const[e,t]=w.useState(!0),[n,s]=w.useState(!1),[i,c]=w.useState(!1),[d,p]=w.useState(null),[m,g]=w.useState("loading"),[x,b]=w.useState(null),[S,T]=w.useState(0),E=E8(),{platform:C}=un(),R=Ya(),A=w.useCallback(async()=>{if(C!=="chrome"){t(!1),g("disconnected"),b(new Date);return}c(!0),g("loading"),p(null);try{const U=await Xy(E);t(U),g(U?"connected":"disconnected"),b(new Date),U&&(T(0),n||(s(!0),R&&R.setLocalItem("wasEverConnectedGmail",!0).catch(V=>{E.error("Failed to save wasEverConnected to storage",V,{sourceFile:"src/shared/contexts/GmailConnectionContext/GmailConnectionProvider.tsx"})}))),E.debug("Gmail connection status checked",{sourceFile:"src/shared/contexts/GmailConnectionContext/GmailConnectionProvider.tsx",connected:U,status:U?"connected":"disconnected"})}catch(U){const V=U instanceof Error?U.message:"Unknown error occurred";p(V),t(!1),g("error"),b(new Date),E.error("Error checking Gmail connection",U,{sourceFile:"src/shared/contexts/GmailConnectionContext/GmailConnectionProvider.tsx"})}finally{c(!1)}},[E,C,n,R]),F=w.useCallback(async()=>{try{T(ce=>ce+1),g("loading"),p(null);const{initiateIntegration:U,findIntegrationById:V}=await Iw(async()=>{const{initiateIntegration:ce,findIntegrationById:ne}=await Promise.resolve().then(()=>F9);return{initiateIntegration:ce,findIntegrationById:ne}},void 0),{GMAIL_INTEGRATION_PAGE_URI:Q,GMAIL_INTEGRATION_REDIRECT_URI:fe}=await Iw(async()=>{const{GMAIL_INTEGRATION_PAGE_URI:ce,GMAIL_INTEGRATION_REDIRECT_URI:ne}=await Promise.resolve().then(()=>RU);return{GMAIL_INTEGRATION_PAGE_URI:ce,GMAIL_INTEGRATION_REDIRECT_URI:ne}},void 0),B=Q(fe),ee=await V("gmail");if(!ee)throw new Error("Gmail integration not found");const ve=await U(E,ee,B);return ve?await A():g("disconnected"),ve}catch(U){const V=U instanceof Error?U.message:"Failed to reconnect Gmail";throw p(V),g("error"),E.error("Failed to reconnect Gmail:",U,{sourceFile:"src/shared/contexts/GmailConnectionContext/GmailConnectionProvider.tsx",attemptNumber:S+1}),U}},[E,A,S]),P=w.useCallback(()=>{p(null),m==="error"&&g(e?"connected":"disconnected")},[m,e]),L=w.useCallback(async()=>{await A()},[A]);w.useEffect(()=>{if(C!=="chrome")return;const U=setInterval(()=>{A()},36e5);return()=>clearInterval(U)},[A,C]),w.useEffect(()=>{if(C!=="chrome")return;const V=(async()=>{try{const fe=(await Yn.createServices()).storage;if(fe.onChanged){const B=ee=>{if(ee.gmailConnectionStatus){const ve=ee.gmailConnectionStatus.newValue;E.debug("Gmail connection status changed via storage",{sourceFile:"src/shared/contexts/GmailConnectionContext/GmailConnectionProvider.tsx",newStatus:ve,oldStatus:ee.gmailConnectionStatus.oldValue}),ve!==void 0&&(t(ve),g(ve?"connected":"disconnected"),b(new Date),ve&&d&&p(null))}};return fe.onChanged(B),()=>{fe.removeChangeListener&&fe.removeChangeListener(B)}}}catch(Q){E.error("Failed to set up Gmail connection storage listener:",Q,{sourceFile:"src/shared/contexts/GmailConnectionContext/GmailConnectionProvider.tsx"})}})();return()=>{V.then(Q=>Q==null?void 0:Q())}},[C,E,d]),w.useEffect(()=>{(async()=>{if(!(C!=="chrome"||!R))try{const V=await R.getLocalItem("wasEverConnectedGmail");V!==null&&(s(V),E.debug("Loaded wasEverConnected from storage",{sourceFile:"src/shared/contexts/GmailConnectionContext/GmailConnectionProvider.tsx",wasEverConnected:V}))}catch(V){E.error("Failed to load wasEverConnected from storage",V,{sourceFile:"src/shared/contexts/GmailConnectionContext/GmailConnectionProvider.tsx"})}})()},[C,R,E]),w.useEffect(()=>{A()},[A]);const G={isConnected:e,wasEverConnected:n,isLoading:i,error:d,status:m,lastChecked:x,reconnectAttempts:S,checkConnection:A,initiateReconnection:F,clearError:P,forceRefresh:L};return u.jsx(yT.Provider,{value:G,children:r})},BT=w.createContext(void 0),GT=()=>{const r=w.useContext(BT);if(!r)throw new Error("useActiveSection must be used within an ActiveSectionProvider");return r},k8=({children:r})=>{const[e,t]=w.useState("main");return u.jsx(BT.Provider,{value:{activeSection:e,setActiveSection:t},children:r})};var Ee=typeof window<"u"?window:void 0,Ss=typeof globalThis<"u"?globalThis:Ee;typeof self>"u"&&(Ss.self=Ss),typeof File>"u"&&(Ss.File=function(){});var WT=Array.prototype,IC=WT.forEach,PC=WT.indexOf,oi=Ss==null?void 0:Ss.navigator,Je=Ss==null?void 0:Ss.document,bs=Ss==null?void 0:Ss.location,Vw=Ss==null?void 0:Ss.fetch,qw=Ss!=null&&Ss.XMLHttpRequest&&"withCredentials"in new Ss.XMLHttpRequest?Ss.XMLHttpRequest:void 0,jC=Ss==null?void 0:Ss.AbortController,jo=oi==null?void 0:oi.userAgent,Nt=Ee??{},Ml={DEBUG:!1,LIB_VERSION:"1.343.2"};function FC(r,e,t,n,s,i,c){try{var d=r[i](c),p=d.value}catch(m){return void t(m)}d.done?e(p):Promise.resolve(p).then(n,s)}function Qf(r){return function(){var e=this,t=arguments;return new Promise((function(n,s){var i=r.apply(e,t);function c(p){FC(i,n,s,c,d,"next",p)}function d(p){FC(i,n,s,c,d,"throw",p)}c(void 0)}))}}function rt(){return rt=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)({}).hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},rt.apply(null,arguments)}function VT(r,e){if(r==null)return{};var t={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(e.indexOf(n)!==-1)continue;t[n]=r[n]}return t}var N8=["amazonbot","amazonproductbot","app.hypefactors.com","applebot","archive.org_bot","awariobot","backlinksextendedbot","baiduspider","bingbot","bingpreview","chrome-lighthouse","dataforseobot","deepscan","duckduckbot","facebookexternal","facebookcatalog","http://yandex.com/bots","hubspot","ia_archiver","leikibot","linkedinbot","meta-externalagent","mj12bot","msnbot","nessus","petalbot","pinterest","prerender","rogerbot","screaming frog","sebot-wa","sitebulb","slackbot","slurp","trendictionbot","turnitin","twitterbot","vercel-screenshot","vercelbot","yahoo! slurp","yandexbot","zoombot","bot.htm","bot.php","(bot;","bot/","crawler","ahrefsbot","ahrefssiteaudit","semrushbot","siteauditbot","splitsignalbot","gptbot","oai-searchbot","chatgpt-user","perplexitybot","better uptime bot","sentryuptimebot","uptimerobot","headlesschrome","cypress","google-hoteladsverifier","adsbot-google","apis-google","duplexweb-google","feedfetcher-google","google favicon","google web preview","google-read-aloud","googlebot","googleother","google-cloudvertexbot","googleweblight","mediapartners-google","storebot-google","google-inspectiontool","bytespider"],OC=function(r,e){if(e===void 0&&(e=[]),!r)return!1;var t=r.toLowerCase();return N8.concat(e).some((n=>{var s=n.toLowerCase();return t.indexOf(s)!==-1}))},T8=["$snapshot","$pageview","$pageleave","$set","survey dismissed","survey sent","survey shown","$identify","$groupidentify","$create_alias","$$client_ingestion_warning","$web_experiment_applied","$feature_enrollment_update","$feature_flag_called"];function mr(r,e){return r.indexOf(e)!==-1}var Zy=function(r){return r.trim()},Kw=function(r){return r.replace(/^\$/,"")},R8=Array.isArray,qT=Object.prototype,KT=qT.hasOwnProperty,e0=qT.toString,$r=R8||function(r){return e0.call(r)==="[object Array]"},Gc=r=>typeof r=="function",qn=r=>r===Object(r)&&!$r(r),Zf=r=>{if(qn(r)){for(var e in r)if(KT.call(r,e))return!1;return!0}return!1},Xe=r=>r===void 0,Kn=r=>e0.call(r)=="[object String]",Yw=r=>Kn(r)&&r.trim().length===0,la=r=>r===null,xr=r=>Xe(r)||la(r),Wl=r=>e0.call(r)=="[object Number]"&&r==r,Yf=r=>Wl(r)&&r>0,Bl=r=>e0.call(r)==="[object Boolean]",A8=r=>r instanceof FormData,I8=r=>mr(T8,r);function Jw(r){return r===null||typeof r!="object"}function my(r,e){return Object.prototype.toString.call(r)==="[object "+e+"]"}function YT(r){return!Xe(Event)&&(function(e,t){try{return e instanceof t}catch{return!1}})(r,Event)}var P8=[!0,"true",1,"1","yes"],Mx=r=>mr(P8,r),j8=[!1,"false",0,"0","no"];function Wa(r,e,t,n,s){return e>t&&(n.warn("min cannot be greater than max."),e=t),Wl(r)?r>t?(n.warn(" cannot be  greater than max: "+t+". Using max value instead."),t):r<e?(n.warn(" cannot be less than min: "+e+". Using min value instead."),e):r:(n.warn(" must be a number. using max or fallback. max: "+t+", fallback: "+s),Wa(s||t,e,t,n))}class F8{constructor(e){this.t={},this.i=e.i,this.o=Wa(e.bucketSize,0,100,e.h),this.m=Wa(e.refillRate,0,this.o,e.h),this.$=Wa(e.refillInterval,0,864e5,e.h)}S(e,t){var n=t-e.lastAccess,s=Math.floor(n/this.$);if(s>0){var i=s*this.m;e.tokens=Math.min(e.tokens+i,this.o),e.lastAccess=e.lastAccess+s*this.$}}consumeRateLimit(e){var t,n=Date.now(),s=String(e),i=this.t[s];return i?this.S(i,n):(i={tokens:this.o,lastAccess:n},this.t[s]=i),i.tokens===0||(i.tokens--,i.tokens===0&&((t=this.i)==null||t.call(this,e)),i.tokens===0)}stop(){this.t={}}}var ji="Mobile",gy="iOS",Hl="Android",Hm="Tablet",JT=Hl+" "+Hm,XT="iPad",QT="Apple",ZT=QT+" Watch",Bm="Safari",hh="BlackBerry",eR="Samsung",tR=eR+"Browser",rR=eR+" Internet",ud="Chrome",O8=ud+" OS",nR=ud+" "+gy,rS="Internet Explorer",sR=rS+" "+ji,nS="Opera",D8=nS+" Mini",sS="Edge",oR="Microsoft "+sS,sh="Firefox",iR=sh+" "+gy,Gm="Nintendo",Wm="PlayStation",oh="Xbox",aR=Hl+" "+ji,lR=ji+" "+Bm,hm="Windows",Xw=hm+" Phone",DC="Nokia",Qw="Ouya",cR="Generic",L8=cR+" "+ji.toLowerCase(),uR=cR+" "+Hm.toLowerCase(),Zw="Konqueror",so="(\\d+(\\.\\d+)?)",$x=new RegExp("Version/"+so),M8=new RegExp(oh,"i"),$8=new RegExp(Wm+" \\w+","i"),U8=new RegExp(Gm+" \\w+","i"),oS=new RegExp(hh+"|PlayBook|BB10","i"),z8={"NT3.51":"NT 3.11","NT4.0":"NT 4.0","5.0":"2000",5.1:"XP",5.2:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1",6.4:"10","10.0":"10"},Av,LC,Ux,H8=(r,e)=>e&&mr(e,QT)||(function(t){return mr(t,Bm)&&!mr(t,ud)&&!mr(t,Hl)})(r),dR=function(r,e){return e=e||"",mr(r," OPR/")&&mr(r,"Mini")?D8:mr(r," OPR/")?nS:oS.test(r)?hh:mr(r,"IE"+ji)||mr(r,"WPDesktop")?sR:mr(r,tR)?rR:mr(r,sS)||mr(r,"Edg/")?oR:mr(r,"FBIOS")?"Facebook "+ji:mr(r,"UCWEB")||mr(r,"UCBrowser")?"UC Browser":mr(r,"CriOS")?nR:mr(r,"CrMo")||mr(r,ud)?ud:mr(r,Hl)&&mr(r,Bm)?aR:mr(r,"FxiOS")?iR:mr(r.toLowerCase(),Zw.toLowerCase())?Zw:H8(r,e)?mr(r,ji)?lR:Bm:mr(r,sh)?sh:mr(r,"MSIE")||mr(r,"Trident/")?rS:mr(r,"Gecko")?sh:""},B8={[sR]:[new RegExp("rv:"+so)],[oR]:[new RegExp(sS+"?\\/"+so)],[ud]:[new RegExp("("+ud+"|CrMo)\\/"+so)],[nR]:[new RegExp("CriOS\\/"+so)],"UC Browser":[new RegExp("(UCBrowser|UCWEB)\\/"+so)],[Bm]:[$x],[lR]:[$x],[nS]:[new RegExp("(Opera|OPR)\\/"+so)],[sh]:[new RegExp(sh+"\\/"+so)],[iR]:[new RegExp("FxiOS\\/"+so)],[Zw]:[new RegExp("Konqueror[:/]?"+so,"i")],[hh]:[new RegExp(hh+" "+so),$x],[aR]:[new RegExp("android\\s"+so,"i")],[rR]:[new RegExp(tR+"\\/"+so)],[rS]:[new RegExp("(rv:|MSIE )"+so)],Mozilla:[new RegExp("rv:"+so)]},G8=function(r,e){var t=dR(r,e),n=B8[t];if(Xe(n))return null;for(var s=0;s<n.length;s++){var i=n[s],c=r.match(i);if(c)return parseFloat(c[c.length-2])}return null},MC=[[new RegExp(oh+"; "+oh+" (.*?)[);]","i"),r=>[oh,r&&r[1]||""]],[new RegExp(Gm,"i"),[Gm,""]],[new RegExp(Wm,"i"),[Wm,""]],[oS,[hh,""]],[new RegExp(hm,"i"),(r,e)=>{if(/Phone/.test(e)||/WPDesktop/.test(e))return[Xw,""];if(new RegExp(ji).test(e)&&!/IEMobile\b/.test(e))return[hm+" "+ji,""];var t=/Windows NT ([0-9.]+)/i.exec(e);if(t&&t[1]){var n=t[1],s=z8[n]||"";return/arm/i.test(e)&&(s="RT"),[hm,s]}return[hm,""]}],[/((iPhone|iPad|iPod).*?OS (\d+)_(\d+)_?(\d+)?|iPhone)/,r=>{if(r&&r[3]){var e=[r[3],r[4],r[5]||"0"];return[gy,e.join(".")]}return[gy,""]}],[/(watch.*\/(\d+\.\d+\.\d+)|watch os,(\d+\.\d+),)/i,r=>{var e="";return r&&r.length>=3&&(e=Xe(r[2])?r[3]:r[2]),["watchOS",e]}],[new RegExp("("+Hl+" (\\d+)\\.(\\d+)\\.?(\\d+)?|"+Hl+")","i"),r=>{if(r&&r[2]){var e=[r[2],r[3],r[4]||"0"];return[Hl,e.join(".")]}return[Hl,""]}],[/Mac OS X (\d+)[_.](\d+)[_.]?(\d+)?/i,r=>{var e=["Mac OS X",""];if(r&&r[1]){var t=[r[1],r[2],r[3]||"0"];e[1]=t.join(".")}return e}],[/Mac/i,["Mac OS X",""]],[/CrOS/,[O8,""]],[/Linux|debian/i,["Linux",""]]],$C=function(r){return U8.test(r)?Gm:$8.test(r)?Wm:M8.test(r)?oh:new RegExp(Qw,"i").test(r)?Qw:new RegExp("("+Xw+"|WPDesktop)","i").test(r)?Xw:/iPad/.test(r)?XT:/iPod/.test(r)?"iPod Touch":/iPhone/.test(r)?"iPhone":/(watch)(?: ?os[,/]|\d,\d\/)[\d.]+/i.test(r)?ZT:oS.test(r)?hh:/(kobo)\s(ereader|touch)/i.test(r)?"Kobo":new RegExp(DC,"i").test(r)?DC:/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i.test(r)||/(kf[a-z]+)( bui|\)).+silk\//i.test(r)?"Kindle Fire":/(Android|ZTE)/i.test(r)?new RegExp(ji).test(r)&&!/(9138B|TB782B|Nexus [97]|pixel c|HUAWEISHT|BTV|noble nook|smart ultra 6)/i.test(r)||/pixel[\daxl ]{1,6}/i.test(r)&&!/pixel c/i.test(r)||/(huaweimed-al00|tah-|APA|SM-G92|i980|zte|U304AA)/i.test(r)||/lmy47v/i.test(r)&&!/QTAQZ3/i.test(r)?Hl:JT:new RegExp("(pda|"+ji+")","i").test(r)?L8:new RegExp(Hm,"i").test(r)&&!new RegExp(Hm+" pc","i").test(r)?uR:""},W8=r=>r instanceof Error;function V8(r){var e=globalThis._posthogChunkIds;if(e){var t=Object.keys(e);return Ux&&t.length===LC||(LC=t.length,Ux=t.reduce(((n,s)=>{Av||(Av={});var i=Av[s];if(i)n[i[0]]=i[1];else for(var c=r(s),d=c.length-1;d>=0;d--){var p=c[d],m=p==null?void 0:p.filename,g=e[s];if(m&&g){n[m]=g,Av[s]=[m,g];break}}return n}),{})),Ux}}class q8{constructor(e,t,n){n===void 0&&(n=[]),this.coercers=e,this.stackParser=t,this.modifiers=n}buildFromUnknown(e,t){t===void 0&&(t={});var n=t&&t.mechanism||{handled:!0,type:"generic"},s=this.buildCoercingContext(n,t,0).apply(e),i=this.buildParsingContext(t),c=this.parseStacktrace(s,i);return{$exception_list:this.convertToExceptionList(c,n),$exception_level:"error"}}modifyFrames(e){var t=this;return Qf((function*(){for(var n of e)n.stacktrace&&n.stacktrace.frames&&$r(n.stacktrace.frames)&&(n.stacktrace.frames=yield t.applyModifiers(n.stacktrace.frames));return e}))()}coerceFallback(e){var t;return{type:"Error",value:"Unknown error",stack:(t=e.syntheticException)==null?void 0:t.stack,synthetic:!0}}parseStacktrace(e,t){var n,s;return e.cause!=null&&(n=this.parseStacktrace(e.cause,t)),e.stack!=""&&e.stack!=null&&(s=this.applyChunkIds(this.stackParser(e.stack,e.synthetic?t.skipFirstLines:0),t.chunkIdMap)),rt({},e,{cause:n,stack:s})}applyChunkIds(e,t){return e.map((n=>(n.filename&&t&&(n.chunk_id=t[n.filename]),n)))}applyCoercers(e,t){for(var n of this.coercers)if(n.match(e))return n.coerce(e,t);return this.coerceFallback(t)}applyModifiers(e){var t=this;return Qf((function*(){var n=e;for(var s of t.modifiers)n=yield s(n);return n}))()}convertToExceptionList(e,t){var n,s,i,c={type:e.type,value:e.value,mechanism:{type:(n=t.type)!==null&&n!==void 0?n:"generic",handled:(s=t.handled)===null||s===void 0||s,synthetic:(i=e.synthetic)!==null&&i!==void 0&&i}};e.stack&&(c.stacktrace={type:"raw",frames:e.stack});var d=[c];return e.cause!=null&&d.push(...this.convertToExceptionList(e.cause,rt({},t,{handled:!0}))),d}buildParsingContext(e){var t;return{chunkIdMap:V8(this.stackParser),skipFirstLines:(t=e.skipFirstLines)!==null&&t!==void 0?t:1}}buildCoercingContext(e,t,n){n===void 0&&(n=0);var s=(i,c)=>{if(c<=4){var d=this.buildCoercingContext(e,t,c);return this.applyCoercers(i,d)}};return rt({},t,{syntheticException:n==0?t.syntheticException:void 0,mechanism:e,apply:i=>s(i,n),next:i=>s(i,n+1)})}}var ph="?";function eb(r,e,t,n,s){var i={platform:r,filename:e,function:t==="<anonymous>"?ph:t,in_app:!0};return Xe(n)||(i.lineno=n),Xe(s)||(i.colno=s),i}var fR=(r,e)=>{var t=r.indexOf("safari-extension")!==-1,n=r.indexOf("safari-web-extension")!==-1;return t||n?[r.indexOf("@")!==-1?r.split("@")[0]:ph,t?"safari-extension:"+e:"safari-web-extension:"+e]:[r,e]},K8=/^\s*at (\S+?)(?::(\d+))(?::(\d+))\s*$/i,Y8=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,J8=/\((\S*)(?::(\d+))(?::(\d+))\)/,X8=(r,e)=>{var t=K8.exec(r);if(t){var[,n,s,i]=t;return eb(e,n,ph,+s,+i)}var c=Y8.exec(r);if(c){if(c[2]&&c[2].indexOf("eval")===0){var d=J8.exec(c[2]);d&&(c[2]=d[1],c[3]=d[2],c[4]=d[3])}var[p,m]=fR(c[1]||ph,c[2]);return eb(e,m,p,c[3]?+c[3]:void 0,c[4]?+c[4]:void 0)}},Q8=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,Z8=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,ez=(r,e)=>{var t=Q8.exec(r);if(t){if(t[3]&&t[3].indexOf(" > eval")>-1){var n=Z8.exec(t[3]);n&&(t[1]=t[1]||"eval",t[3]=n[1],t[4]=n[2],t[5]="")}var s=t[3],i=t[1]||ph;return[i,s]=fR(i,s),eb(e,s,i,t[4]?+t[4]:void 0,t[5]?+t[5]:void 0)}},UC=/\(error: (.*)\)/,zC=50;function tz(){return(function(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return function(s,i){i===void 0&&(i=0);for(var c=[],d=s.split(`
`),p=i;p<d.length;p++){var m=d[p];if(!(m.length>1024)){var g=UC.test(m)?m.replace(UC,"$1"):m;if(!g.match(/\S*Error: /)){for(var x of t){var b=x(g,r);if(b){c.push(b);break}}if(c.length>=zC)break}}}return(function(S){if(!S.length)return[];var T=Array.from(S);return T.reverse(),T.slice(0,zC).map((E=>{return rt({},E,{filename:E.filename||(C=T,C[C.length-1]||{}).filename,function:E.function||ph});var C}))})(c)}})("web:javascript",X8,ez)}class rz{match(e){return this.isDOMException(e)||this.isDOMError(e)}coerce(e,t){var n=Kn(e.stack);return{type:this.getType(e),value:this.getValue(e),stack:n?e.stack:void 0,cause:e.cause?t.next(e.cause):void 0,synthetic:!1}}getType(e){return this.isDOMError(e)?"DOMError":"DOMException"}getValue(e){var t=e.name||(this.isDOMError(e)?"DOMError":"DOMException");return e.message?t+": "+e.message:t}isDOMException(e){return my(e,"DOMException")}isDOMError(e){return my(e,"DOMError")}}class nz{match(e){return(t=>t instanceof Error)(e)}coerce(e,t){return{type:this.getType(e),value:this.getMessage(e,t),stack:this.getStack(e),cause:e.cause?t.next(e.cause):void 0,synthetic:!1}}getType(e){return e.name||e.constructor.name}getMessage(e,t){var n=e.message;return n.error&&typeof n.error.message=="string"?String(n.error.message):String(n)}getStack(e){return e.stacktrace||e.stack||void 0}}class sz{constructor(){}match(e){return my(e,"ErrorEvent")&&e.error!=null}coerce(e,t){var n,s=t.apply(e.error);return s||{type:"ErrorEvent",value:e.message,stack:(n=t.syntheticException)==null?void 0:n.stack,synthetic:!0}}}var oz=/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/i;class iz{match(e){return typeof e=="string"}coerce(e,t){var n,[s,i]=this.getInfos(e);return{type:s??"Error",value:i??e,stack:(n=t.syntheticException)==null?void 0:n.stack,synthetic:!0}}getInfos(e){var t="Error",n=e,s=e.match(oz);return s&&(t=s[1],n=s[2]),[t,n]}}var az=["fatal","error","warning","log","info","debug"];function hR(r,e){e===void 0&&(e=40);var t=Object.keys(r);if(t.sort(),!t.length)return"[object has no keys]";for(var n=t.length;n>0;n--){var s=t.slice(0,n).join(", ");if(!(s.length>e))return n===t.length||s.length<=e?s:s.slice(0,e)+"..."}return""}class lz{match(e){return typeof e=="object"&&e!==null}coerce(e,t){var n,s=this.getErrorPropertyFromObject(e);return s?t.apply(s):{type:this.getType(e),value:this.getValue(e),stack:(n=t.syntheticException)==null?void 0:n.stack,level:this.isSeverityLevel(e.level)?e.level:"error",synthetic:!0}}getType(e){return YT(e)?e.constructor.name:"Error"}getValue(e){if("name"in e&&typeof e.name=="string"){var t="'"+e.name+"' captured as exception";return"message"in e&&typeof e.message=="string"&&(t+=" with message: '"+e.message+"'"),t}if("message"in e&&typeof e.message=="string")return e.message;var n=this.getObjectClassName(e);return(n&&n!=="Object"?"'"+n+"'":"Object")+" captured as exception with keys: "+hR(e)}isSeverityLevel(e){return Kn(e)&&!Yw(e)&&az.indexOf(e)>=0}getErrorPropertyFromObject(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var n=e[t];if(W8(n))return n}}getObjectClassName(e){try{var t=Object.getPrototypeOf(e);return t?t.constructor.name:void 0}catch{return}}}class cz{match(e){return YT(e)}coerce(e,t){var n,s=e.constructor.name;return{type:s,value:s+" captured as exception with keys: "+hR(e),stack:(n=t.syntheticException)==null?void 0:n.stack,synthetic:!0}}}class uz{match(e){return Jw(e)}coerce(e,t){var n;return{type:"Error",value:"Primitive value captured as exception: "+String(e),stack:(n=t.syntheticException)==null?void 0:n.stack,synthetic:!0}}}class dz{match(e){return my(e,"PromiseRejectionEvent")}coerce(e,t){var n,s=this.getUnhandledRejectionReason(e);return Jw(s)?{type:"UnhandledRejection",value:"Non-Error promise rejection captured with value: "+String(s),stack:(n=t.syntheticException)==null?void 0:n.stack,synthetic:!0}:t.apply(s)}getUnhandledRejectionReason(e){if(Jw(e))return e;try{if("reason"in e)return e.reason;if("detail"in e&&"reason"in e.detail)return e.detail.reason}catch{}return e}}var pR=function(r,e){var{debugEnabled:t}=e===void 0?{}:e,n={k:function(s){if(Ee&&(Ml.DEBUG||Nt.POSTHOG_DEBUG||t)&&!Xe(Ee.console)&&Ee.console){for(var i=("__rrweb_original__"in Ee.console[s])?Ee.console[s].__rrweb_original__:Ee.console[s],c=arguments.length,d=new Array(c>1?c-1:0),p=1;p<c;p++)d[p-1]=arguments[p];i(r,...d)}},info:function(){for(var s=arguments.length,i=new Array(s),c=0;c<s;c++)i[c]=arguments[c];n.k("log",...i)},warn:function(){for(var s=arguments.length,i=new Array(s),c=0;c<s;c++)i[c]=arguments[c];n.k("warn",...i)},error:function(){for(var s=arguments.length,i=new Array(s),c=0;c<s;c++)i[c]=arguments[c];n.k("error",...i)},critical:function(){for(var s=arguments.length,i=new Array(s),c=0;c<s;c++)i[c]=arguments[c];console.error(r,...i)},uninitializedWarning:s=>{n.error("You must initialize PostHog before calling "+s)},createLogger:(s,i)=>pR(r+" "+s,i)};return n},et=pR("[PostHog.js]"),_n=et.createLogger,fz=_n("[ExternalScriptsLoader]"),HC=(r,e,t)=>{if(r.config.disable_external_dependency_loading)return fz.warn(e+" was requested but loading of external scripts is disabled."),t("Loading of external scripts is disabled");var n=Je==null?void 0:Je.querySelectorAll("script");if(n){for(var s,i=function(){if(n[c].src===e){var p=n[c];return p.__posthog_loading_callback_fired?{v:t()}:(p.addEventListener("load",(m=>{p.__posthog_loading_callback_fired=!0,t(void 0,m)})),p.onerror=m=>t(m),{v:void 0})}},c=0;c<n.length;c++)if(s=i())return s.v}var d=()=>{if(!Je)return t("document not found");var p=Je.createElement("script");if(p.type="text/javascript",p.crossOrigin="anonymous",p.src=e,p.onload=x=>{p.__posthog_loading_callback_fired=!0,t(void 0,x)},p.onerror=x=>t(x),r.config.prepare_external_dependency_script&&(p=r.config.prepare_external_dependency_script(p)),!p)return t("prepare_external_dependency_script returned null");if(r.config.external_scripts_inject_target==="head")Je.head.appendChild(p);else{var m,g=Je.querySelectorAll("body > script");g.length>0?(m=g[0].parentNode)==null||m.insertBefore(p,g[0]):Je.body.appendChild(p)}};Je!=null&&Je.body?d():Je==null||Je.addEventListener("DOMContentLoaded",d)};Nt.__PosthogExtensions__=Nt.__PosthogExtensions__||{},Nt.__PosthogExtensions__.loadExternalDependency=(r,e,t)=>{var n="/static/"+e+".js?v="+r.version;if(e==="remote-config"&&(n="/array/"+r.config.token+"/config.js"),e==="toolbar"){var s=3e5;n=n+"&t="+Math.floor(Date.now()/s)*s}var i=r.requestRouter.endpointFor("assets",n);HC(r,i,t)},Nt.__PosthogExtensions__.loadSiteApp=(r,e,t)=>{var n=r.requestRouter.endpointFor("api",e);HC(r,n,t)};var vy={};function Wc(r,e,t){if($r(r)){if(IC&&r.forEach===IC)r.forEach(e,t);else if("length"in r&&r.length===+r.length){for(var n=0,s=r.length;n<s;n++)if(n in r&&e.call(t,r[n],n)===vy)return}}}function tn(r,e,t){if(!xr(r)){if($r(r))return Wc(r,e,t);if(A8(r)){for(var n of r.entries())if(e.call(t,n[1],n[0])===vy)return}else for(var s in r)if(KT.call(r,s)&&e.call(t,r[s],s)===vy)return}}var Rn=function(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return Wc(t,(function(s){for(var i in s)s[i]!==void 0&&(r[i]=s[i])})),r},bh=function(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return Wc(t,(function(s){Wc(s,(function(i){r.push(i)}))})),r};function ey(r){for(var e=Object.keys(r),t=e.length,n=new Array(t);t--;)n[t]=[e[t],r[e[t]]];return n}var BC=function(r){try{return r()}catch{return}},hz=function(r){return function(){try{for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.apply(this,t)}catch(s){et.critical("Implementation error. Please turn on debug mode and open a ticket on https://app.posthog.com/home#panel=support%3Asupport%3A."),et.critical(s)}}},iS=function(r){var e={};return tn(r,(function(t,n){(Kn(t)&&t.length>0||Wl(t))&&(e[n]=t)})),e};function pz(r,e){return t=r,n=i=>Kn(i)&&!la(e)?i.slice(0,e):i,s=new Set,(function i(c,d){return c!==Object(c)?n?n(c,d):c:s.has(c)?void 0:(s.add(c),$r(c)?(p=[],Wc(c,(m=>{p.push(i(m))}))):(p={},tn(c,((m,g)=>{s.has(m)||(p[g]=i(m,g))}))),p);var p})(t);var t,n,s}var mz=["herokuapp.com","vercel.app","netlify.app"];function gz(r){var e=r==null?void 0:r.hostname;if(!Kn(e))return!1;var t=e.split(".").slice(-2).join(".");for(var n of mz)if(t===n)return!1;return!0}function mR(r,e){for(var t=0;t<r.length;t++)if(e(r[t]))return r[t]}function Dn(r,e,t,n){var{capture:s=!1,passive:i=!0}=n??{};r==null||r.addEventListener(e,t,{capture:s,passive:i})}var gR="$people_distinct_id",pm="__alias",mm="__timers",GC="$autocapture_disabled_server_side",tb="$heatmaps_enabled_server_side",WC="$exception_capture_enabled_server_side",rb="$error_tracking_suppression_rules",VC="$error_tracking_capture_extension_exceptions",qC="$web_vitals_enabled_server_side",vR="$dead_clicks_enabled_server_side",KC="$product_tours_enabled_server_side",YC="$web_vitals_allowed_metrics",zx="$session_recording_remote_config",yy="$sesid",yR="$session_is_sampled",eh="$enabled_feature_flags",gm="$early_access_features",nb="$feature_flag_details",vm="$stored_person_properties",rd="$stored_group_properties",sb="$surveys",xy="$flag_call_reported",$l="$user_state",ob="$client_session_props",ib="$capture_rate_limit",ab="$initial_campaign_params",lb="$initial_referrer_info",wy="$initial_person_info",by="$epp",xR="__POSTHOG_TOOLBAR__",Kp="$posthog_cookieless",vz=[gR,pm,"__cmpns",mm,"$session_recording_enabled_server_side",tb,yy,eh,rb,$l,gm,nb,rd,vm,sb,xy,ob,ib,ab,lb,by,wy,"$conversations_widget_session_id","$conversations_ticket_id","$conversations_widget_state","$conversations_user_traits"];function JC(r){return r instanceof Element&&(r.id===xR||!(r.closest==null||!r.closest(".toolbar-global-fade-container")))}function t0(r){return!!r&&r.nodeType===1}function Vc(r,e){return!!r&&!!r.tagName&&r.tagName.toLowerCase()===e.toLowerCase()}function wR(r){return!!r&&r.nodeType===3}function bR(r){return!!r&&r.nodeType===11}function aS(r){return r?Zy(r).split(/\s+/):[]}function XC(r){var e=Ee==null?void 0:Ee.location.href;return!!(e&&r&&r.some((t=>e.match(t))))}function _y(r){var e="";switch(typeof r.className){case"string":e=r.className;break;case"object":e=(r.className&&"baseVal"in r.className?r.className.baseVal:null)||r.getAttribute("class")||"";break;default:e=""}return aS(e)}function _R(r){return xr(r)?null:Zy(r).split(/(\s+)/).filter((e=>Vm(e))).join("").replace(/[\r\n]/g," ").replace(/[ ]+/g," ").substring(0,255)}function ig(r){var e="";return cb(r)&&!NR(r)&&r.childNodes&&r.childNodes.length&&tn(r.childNodes,(function(t){var n;wR(t)&&t.textContent&&(e+=(n=_R(t.textContent))!==null&&n!==void 0?n:"")})),Zy(e)}function SR(r){return Xe(r.target)?r.srcElement||null:(e=r.target)!=null&&e.shadowRoot?r.composedPath()[0]||null:r.target||null;var e}var lS=["a","button","form","input","select","textarea","label"];function ER(r,e){if(Xe(e))return!0;var t,n=function(i){if(e.some((c=>i.matches(c))))return{v:!0}};for(var s of r)if(t=n(s))return t.v;return!1}function CR(r){var e=r.parentNode;return!(!e||!t0(e))&&e}var yz=["next","previous","prev",">","<"],QC=10,ZC=[".ph-no-rageclick",".ph-no-capture"];function xz(r,e){if(!Ee||cS(r))return!1;var t,n,s;if(Bl(e)?(t=!!e&&ZC,n=void 0):(t=(s=e==null?void 0:e.css_selector_ignorelist)!==null&&s!==void 0?s:ZC,n=e==null?void 0:e.content_ignorelist),t===!1)return!1;var{targetElementList:i}=kR(r,!1);return!(function(c,d){if(c===!1||Xe(c))return!1;var p;if(c===!0)p=yz;else{if(!$r(c))return!1;if(c.length>QC)return et.error("[PostHog] content_ignorelist array cannot exceed "+QC+" items. Use css_selector_ignorelist for more complex matching."),!1;p=c.map((m=>m.toLowerCase()))}return d.some((m=>{var{safeText:g,ariaLabel:x}=m;return p.some((b=>g.includes(b)||x.includes(b)))}))})(n,i.map((c=>{var d;return{safeText:ig(c).toLowerCase(),ariaLabel:((d=c.getAttribute("aria-label"))==null?void 0:d.toLowerCase().trim())||""}})))&&!ER(i,t)}var cS=r=>!r||Vc(r,"html")||!t0(r),kR=(r,e)=>{if(!Ee||cS(r))return{parentIsUsefulElement:!1,targetElementList:[]};for(var t=!1,n=[r],s=r;s.parentNode&&!Vc(s,"body");)if(bR(s.parentNode))n.push(s.parentNode.host),s=s.parentNode.host;else{var i=CR(s);if(!i)break;if(e||lS.indexOf(i.tagName.toLowerCase())>-1)t=!0;else{var c=Ee.getComputedStyle(i);c&&c.getPropertyValue("cursor")==="pointer"&&(t=!0)}n.push(i),s=i}return{parentIsUsefulElement:t,targetElementList:n}};function wz(r,e,t,n,s){var i,c,d,p;if(t===void 0&&(t=void 0),!Ee||cS(r)||(i=t)!=null&&i.url_allowlist&&!XC(t.url_allowlist)||(c=t)!=null&&c.url_ignorelist&&XC(t.url_ignorelist))return!1;if((d=t)!=null&&d.dom_event_allowlist){var m=t.dom_event_allowlist;if(m&&!m.some((T=>e.type===T)))return!1}var{parentIsUsefulElement:g,targetElementList:x}=kR(r,n);if(!(function(T,E){var C=E==null?void 0:E.element_allowlist;if(Xe(C))return!0;var R,A=function(P){if(C.some((L=>P.tagName.toLowerCase()===L)))return{v:!0}};for(var F of T)if(R=A(F))return R.v;return!1})(x,t)||!ER(x,(p=t)==null?void 0:p.css_selector_allowlist))return!1;var b=Ee.getComputedStyle(r);if(b&&b.getPropertyValue("cursor")==="pointer"&&e.type==="click")return!0;var S=r.tagName.toLowerCase();switch(S){case"html":return!1;case"form":return(s||["submit"]).indexOf(e.type)>=0;case"input":case"select":case"textarea":return(s||["change","click"]).indexOf(e.type)>=0;default:return g?(s||["click"]).indexOf(e.type)>=0:(s||["click"]).indexOf(e.type)>=0&&(lS.indexOf(S)>-1||r.getAttribute("contenteditable")==="true")}}function cb(r){for(var e=r;e.parentNode&&!Vc(e,"body");e=e.parentNode){var t=_y(e);if(mr(t,"ph-sensitive")||mr(t,"ph-no-capture"))return!1}if(mr(_y(r),"ph-include"))return!0;var n=r.type||"";if(Kn(n))switch(n.toLowerCase()){case"hidden":case"password":return!1}var s=r.name||r.id||"";return!(Kn(s)&&/^cc|cardnum|ccnum|creditcard|csc|cvc|cvv|exp|pass|pwd|routing|seccode|securitycode|securitynum|socialsec|socsec|ssn/i.test(s.replace(/[^a-zA-Z0-9]/g,"")))}function NR(r){return!!(Vc(r,"input")&&!["button","checkbox","submit","reset"].includes(r.type)||Vc(r,"select")||Vc(r,"textarea")||r.getAttribute("contenteditable")==="true")}var TR="(4[0-9]{12}(?:[0-9]{3})?)|(5[1-5][0-9]{14})|(6(?:011|5[0-9]{2})[0-9]{12})|(3[47][0-9]{13})|(3(?:0[0-5]|[68][0-9])[0-9]{11})|((?:2131|1800|35[0-9]{3})[0-9]{11})",bz=new RegExp("^(?:"+TR+")$"),_z=new RegExp(TR),RR="\\d{3}-?\\d{2}-?\\d{4}",Sz=new RegExp("^("+RR+")$"),Ez=new RegExp("("+RR+")");function Vm(r,e){return e===void 0&&(e=!0),!(xr(r)||Kn(r)&&(r=Zy(r),(e?bz:_z).test((r||"").replace(/[- ]/g,""))||(e?Sz:Ez).test(r)))}function AR(r){var e=ig(r);return Vm(e=(e+" "+IR(r)).trim())?e:""}function IR(r){var e="";return r&&r.childNodes&&r.childNodes.length&&tn(r.childNodes,(function(t){var n;if(t&&((n=t.tagName)==null?void 0:n.toLowerCase())==="span")try{var s=ig(t);e=(e+" "+s).trim(),t.childNodes&&t.childNodes.length&&(e=(e+" "+IR(t)).trim())}catch(i){et.error("[AutoCapture]",i)}})),e}function Cz(r){return(function(e){var t=e.map((n=>{var s,i,c="";if(n.tag_name&&(c+=n.tag_name),n.attr_class)for(var d of(n.attr_class.sort(),n.attr_class))c+="."+d.replace(/"/g,"");var p=rt({},n.text?{text:n.text}:{},{"nth-child":(s=n.nth_child)!==null&&s!==void 0?s:0,"nth-of-type":(i=n.nth_of_type)!==null&&i!==void 0?i:0},n.href?{href:n.href}:{},n.attr_id?{attr_id:n.attr_id}:{},n.attributes),m={};return ey(p).sort(((g,x)=>{var[b]=g,[S]=x;return b.localeCompare(S)})).forEach((g=>{var[x,b]=g;return m[ek(x.toString())]=ek(b.toString())})),c+=":",c+=ey(m).map((g=>{var[x,b]=g;return x+'="'+b+'"'})).join("")}));return t.join(";")})((function(e){return e.map((t=>{var n,s,i={text:(n=t.$el_text)==null?void 0:n.slice(0,400),tag_name:t.tag_name,href:(s=t.attr__href)==null?void 0:s.slice(0,2048),attr_class:kz(t),attr_id:t.attr__id,nth_child:t.nth_child,nth_of_type:t.nth_of_type,attributes:{}};return ey(t).filter((c=>{var[d]=c;return d.indexOf("attr__")===0})).forEach((c=>{var[d,p]=c;return i.attributes[d]=p})),i}))})(r))}function ek(r){return r.replace(/"|\\"/g,'\\"')}function kz(r){var e=r.attr__class;return e?$r(e)?e:aS(e):void 0}class PR{constructor(e){this.disabled=e===!1;var t=qn(e)?e:{};this.thresholdPx=t.threshold_px||30,this.timeoutMs=t.timeout_ms||1e3,this.clickCount=t.click_count||3,this.clicks=[]}isRageClick(e,t,n){if(this.disabled)return!1;var s=this.clicks[this.clicks.length-1];if(s&&Math.abs(e-s.x)+Math.abs(t-s.y)<this.thresholdPx&&n-s.timestamp<this.timeoutMs){if(this.clicks.push({x:e,y:t,timestamp:n}),this.clicks.length===this.clickCount)return!0}else this.clicks=[{x:e,y:t,timestamp:n}];return!1}}var Sy=r=>{var e=Je==null?void 0:Je.createElement("a");return Xe(e)?null:(e.href=r,e)},Nz=function(r,e){var t,n;e===void 0&&(e="&");var s=[];return tn(r,(function(i,c){Xe(i)||Xe(c)||c==="undefined"||(t=encodeURIComponent((d=>d instanceof File)(i)?i.name:i.toString()),n=encodeURIComponent(c),s[s.length]=n+"="+t)})),s.join(e)},Ey=function(r,e){for(var t,n=((r.split("#")[0]||"").split(/\?(.*)/)[1]||"").replace(/^\?+/g,"").split("&"),s=0;s<n.length;s++){var i=n[s].split("=");if(i[0]===e){t=i;break}}if(!$r(t)||t.length<2)return"";var c=t[1];try{c=decodeURIComponent(c)}catch{et.error("Skipping decoding for malformed query param: "+c)}return c.replace(/\+/g," ")},ag=function(r,e,t){if(!r||!e||!e.length)return r;for(var n=r.split("#"),s=n[0]||"",i=n[1],c=s.split("?"),d=c[1],p=c[0],m=(d||"").split("&"),g=[],x=0;x<m.length;x++){var b=m[x].split("=");$r(b)&&(e.includes(b[0])?g.push(b[0]+"="+t):g.push(m[x]))}var S=p;return d!=null&&(S+="?"+g.join("&")),i!=null&&(S+="#"+i),S},Cy=function(r,e){var t=r.match(new RegExp(e+"=([^&]*)"));return t?t[1]:null},Hx="$copy_autocapture",tk=_n("[AutoCapture]");function Bx(r,e){return e.length>r?e.slice(0,r)+"...":e}function Tz(r){if(r.previousElementSibling)return r.previousElementSibling;var e=r;do e=e.previousSibling;while(e&&!t0(e));return e}function Rz(r,e,t,n){var s=r.tagName.toLowerCase(),i={tag_name:s};lS.indexOf(s)>-1&&!t&&(s.toLowerCase()==="a"||s.toLowerCase()==="button"?i.$el_text=Bx(1024,AR(r)):i.$el_text=Bx(1024,ig(r)));var c=_y(r);c.length>0&&(i.classes=c.filter((function(g){return g!==""}))),tn(r.attributes,(function(g){var x;if((!NR(r)||["name","id","class","aria-label"].indexOf(g.name)!==-1)&&(n==null||!n.includes(g.name))&&!e&&Vm(g.value)&&(x=g.name,!Kn(x)||x.substring(0,10)!=="_ngcontent"&&x.substring(0,7)!=="_nghost")){var b=g.value;g.name==="class"&&(b=aS(b).join(" ")),i["attr__"+g.name]=Bx(1024,b)}}));for(var d=1,p=1,m=r;m=Tz(m);)d++,m.tagName===r.tagName&&p++;return i.nth_child=d,i.nth_of_type=p,i}function Az(r,e){for(var t,n,{e:s,maskAllElementAttributes:i,maskAllText:c,elementAttributeIgnoreList:d,elementsChainAsString:p}=e,m=[r],g=r;g.parentNode&&!Vc(g,"body");)bR(g.parentNode)?(m.push(g.parentNode.host),g=g.parentNode.host):(m.push(g.parentNode),g=g.parentNode);var x,b=[],S={},T=!1,E=!1;if(tn(m,(P=>{var L=cb(P);P.tagName.toLowerCase()==="a"&&(T=P.getAttribute("href"),T=L&&T&&Vm(T)&&T),mr(_y(P),"ph-no-capture")&&(E=!0),b.push(Rz(P,i,c,d));var G=(function(U){if(!cb(U))return{};var V={};return tn(U.attributes,(function(Q){if(Q.name&&Q.name.indexOf("data-ph-capture-attribute")===0){var fe=Q.name.replace("data-ph-capture-attribute-",""),B=Q.value;fe&&B&&Vm(B)&&(V[fe]=B)}})),V})(P);Rn(S,G)})),E)return{props:{},explicitNoCapture:E};if(c||(r.tagName.toLowerCase()==="a"||r.tagName.toLowerCase()==="button"?b[0].$el_text=AR(r):b[0].$el_text=ig(r)),T){var C,R;b[0].attr__href=T;var A=(C=Sy(T))==null?void 0:C.host,F=Ee==null||(R=Ee.location)==null?void 0:R.host;A&&F&&A!==F&&(x=T)}return{props:Rn({$event_type:s.type,$ce_version:1},p?{}:{$elements:b},{$elements_chain:Cz(b)},(t=b[0])!=null&&t.$el_text?{$el_text:(n=b[0])==null?void 0:n.$el_text}:{},x&&s.type==="click"?{$external_click_url:x}:{},S)}}class Iz{constructor(e){this.P=!1,this.T=null,this.I=!1,this.instance=e,this.rageclicks=new PR(e.config.rageclick),this.C=null}get R(){var e,t,n=qn(this.instance.config.autocapture)?this.instance.config.autocapture:{};return n.url_allowlist=(e=n.url_allowlist)==null?void 0:e.map((s=>new RegExp(s))),n.url_ignorelist=(t=n.url_ignorelist)==null?void 0:t.map((s=>new RegExp(s))),n}F(){if(this.isBrowserSupported()){if(Ee&&Je){var e=n=>{n=n||(Ee==null?void 0:Ee.event);try{this.O(n)}catch(s){tk.error("Failed to capture event",s)}};if(Dn(Je,"submit",e,{capture:!0}),Dn(Je,"change",e,{capture:!0}),Dn(Je,"click",e,{capture:!0}),this.R.capture_copied_text){var t=n=>{n=n||(Ee==null?void 0:Ee.event),this.O(n,Hx)};Dn(Je,"copy",t,{capture:!0}),Dn(Je,"cut",t,{capture:!0})}}}else tk.info("Disabling Automatic Event Collection because this browser is not supported")}startIfEnabled(){this.isEnabled&&!this.P&&(this.F(),this.P=!0)}onRemoteConfig(e){e.elementsChainAsString&&(this.I=e.elementsChainAsString),this.instance.persistence&&this.instance.persistence.register({[GC]:!!e.autocapture_opt_out}),this.T=!!e.autocapture_opt_out,this.startIfEnabled()}setElementSelectors(e){this.C=e}getElementSelectors(e){var t,n=[];return(t=this.C)==null||t.forEach((s=>{var i=Je==null?void 0:Je.querySelectorAll(s);i==null||i.forEach((c=>{e===c&&n.push(s)}))})),n}get isEnabled(){var e,t,n=(e=this.instance.persistence)==null?void 0:e.props[GC],s=this.T;if(la(s)&&!Bl(n)&&!this.instance.M())return!1;var i=(t=this.T)!==null&&t!==void 0?t:!!n;return!!this.instance.config.autocapture&&!i}O(e,t){if(t===void 0&&(t="$autocapture"),this.isEnabled){var n,s=SR(e);wR(s)&&(s=s.parentNode||null),t==="$autocapture"&&e.type==="click"&&e instanceof MouseEvent&&this.instance.config.rageclick&&(n=this.rageclicks)!=null&&n.isRageClick(e.clientX,e.clientY,e.timeStamp||new Date().getTime())&&xz(s,this.instance.config.rageclick)&&this.O(e,"$rageclick");var i=t===Hx;if(s&&wz(s,e,this.R,i,i?["copy","cut"]:void 0)){var{props:c,explicitNoCapture:d}=Az(s,{e,maskAllElementAttributes:this.instance.config.mask_all_element_attributes,maskAllText:this.instance.config.mask_all_text,elementAttributeIgnoreList:this.R.element_attribute_ignorelist,elementsChainAsString:this.I});if(d)return!1;var p=this.getElementSelectors(s);if(p&&p.length>0&&(c.$element_selectors=p),t===Hx){var m,g=_R(Ee==null||(m=Ee.getSelection())==null?void 0:m.toString()),x=e.type||"clipboard";if(!g)return!1;c.$selected_content=g,c.$copy_type=x}return this.instance.capture(t,c),!0}}}isBrowserSupported(){return Gc(Je==null?void 0:Je.querySelectorAll)}}Math.trunc||(Math.trunc=function(r){return r<0?Math.ceil(r):Math.floor(r)}),Number.isInteger||(Number.isInteger=function(r){return Wl(r)&&isFinite(r)&&Math.floor(r)===r});var rk="0123456789abcdef";class ky{constructor(e){if(this.bytes=e,e.length!==16)throw new TypeError("not 128-bit length")}static fromFieldsV7(e,t,n,s){if(!Number.isInteger(e)||!Number.isInteger(t)||!Number.isInteger(n)||!Number.isInteger(s)||e<0||t<0||n<0||s<0||e>0xffffffffffff||t>4095||n>1073741823||s>4294967295)throw new RangeError("invalid field value");var i=new Uint8Array(16);return i[0]=e/Math.pow(2,40),i[1]=e/Math.pow(2,32),i[2]=e/Math.pow(2,24),i[3]=e/Math.pow(2,16),i[4]=e/Math.pow(2,8),i[5]=e,i[6]=112|t>>>8,i[7]=t,i[8]=128|n>>>24,i[9]=n>>>16,i[10]=n>>>8,i[11]=n,i[12]=s>>>24,i[13]=s>>>16,i[14]=s>>>8,i[15]=s,new ky(i)}toString(){for(var e="",t=0;t<this.bytes.length;t++)e=e+rk.charAt(this.bytes[t]>>>4)+rk.charAt(15&this.bytes[t]),t!==3&&t!==5&&t!==7&&t!==9||(e+="-");if(e.length!==36)throw new Error("Invalid UUIDv7 was generated");return e}clone(){return new ky(this.bytes.slice(0))}equals(e){return this.compareTo(e)===0}compareTo(e){for(var t=0;t<16;t++){var n=this.bytes[t]-e.bytes[t];if(n!==0)return Math.sign(n)}return 0}}class Pz{constructor(){this.A=0,this.j=0,this.D=new jz}generate(){var e=this.generateOrAbort();if(Xe(e)){this.A=0;var t=this.generateOrAbort();if(Xe(t))throw new Error("Could not generate UUID after timestamp reset");return t}return e}generateOrAbort(){var e=Date.now();if(e>this.A)this.A=e,this.L();else{if(!(e+1e4>this.A))return;this.j++,this.j>4398046511103&&(this.A++,this.L())}return ky.fromFieldsV7(this.A,Math.trunc(this.j/Math.pow(2,30)),this.j&Math.pow(2,30)-1,this.D.nextUint32())}L(){this.j=1024*this.D.nextUint32()+(1023&this.D.nextUint32())}}var nk,jR=r=>{if(typeof UUIDV7_DENY_WEAK_RNG<"u"&&UUIDV7_DENY_WEAK_RNG)throw new Error("no cryptographically strong RNG available");for(var e=0;e<r.length;e++)r[e]=65536*Math.trunc(65536*Math.random())+Math.trunc(65536*Math.random());return r};Ee&&!Xe(Ee.crypto)&&crypto.getRandomValues&&(jR=r=>crypto.getRandomValues(r));class jz{constructor(){this.N=new Uint32Array(8),this.U=1/0}nextUint32(){return this.U>=this.N.length&&(jR(this.N),this.U=0),this.N[this.U++]}}var Hc=()=>Fz().toString(),Fz=()=>(nk||(nk=new Pz)).generate(),Yp="",Oz=/[a-z0-9][a-z0-9-]+\.[a-z]{2,}$/i;function Dz(r,e){if(e){var t=(function(s,i){if(i===void 0&&(i=Je),Yp)return Yp;if(!i||["localhost","127.0.0.1"].includes(s))return"";for(var c=s.split("."),d=Math.min(c.length,8),p="dmn_chk_"+Hc();!Yp&&d--;){var m=c.slice(d).join("."),g=p+"=1;domain=."+m+";path=/";i.cookie=g+";max-age=3",i.cookie.includes(p)&&(i.cookie=g+";max-age=0",Yp=m)}return Yp})(r);if(!t){var n=(s=>{var i=s.match(Oz);return i?i[0]:""})(r);n!==t&&et.info("Warning: cookie subdomain discovery mismatch",n,t),t=n}return t?"; domain=."+t:""}return""}var za={H:()=>!!Je,B:function(r){et.error("cookieStore error: "+r)},q:function(r){if(Je){try{for(var e=r+"=",t=Je.cookie.split(";").filter((i=>i.length)),n=0;n<t.length;n++){for(var s=t[n];s.charAt(0)==" ";)s=s.substring(1,s.length);if(s.indexOf(e)===0)return decodeURIComponent(s.substring(e.length,s.length))}}catch{}return null}},W:function(r){var e;try{e=JSON.parse(za.q(r))||{}}catch{}return e},G:function(r,e,t,n,s){if(Je)try{var i="",c="",d=Dz(Je.location.hostname,n);if(t){var p=new Date;p.setTime(p.getTime()+24*t*60*60*1e3),i="; expires="+p.toUTCString()}s&&(c="; secure");var m=r+"="+encodeURIComponent(JSON.stringify(e))+i+"; SameSite=Lax; path=/"+d+c;return m.length>3686.4&&et.warn("cookieStore warning: large cookie, len="+m.length),Je.cookie=m,m}catch{return}},V:function(r,e){if(Je!=null&&Je.cookie)try{za.G(r,"",-1,e)}catch{return}}},Gx=null,gn={H:function(){if(!la(Gx))return Gx;var r=!0;if(Xe(Ee))r=!1;else try{var e="__mplssupport__";gn.G(e,"xyz"),gn.q(e)!=='"xyz"'&&(r=!1),gn.V(e)}catch{r=!1}return r||et.error("localStorage unsupported; falling back to cookie store"),Gx=r,r},B:function(r){et.error("localStorage error: "+r)},q:function(r){try{return Ee==null?void 0:Ee.localStorage.getItem(r)}catch(e){gn.B(e)}return null},W:function(r){try{return JSON.parse(gn.q(r))||{}}catch{}return null},G:function(r,e){try{Ee==null||Ee.localStorage.setItem(r,JSON.stringify(e))}catch(t){gn.B(t)}},V:function(r){try{Ee==null||Ee.localStorage.removeItem(r)}catch(e){gn.B(e)}}},Lz=["$device_id","distinct_id",yy,yR,by,wy],Iv={},Mz={H:function(){return!0},B:function(r){et.error("memoryStorage error: "+r)},q:function(r){return Iv[r]||null},W:function(r){return Iv[r]||null},G:function(r,e){Iv[r]=e},V:function(r){delete Iv[r]}},Xu=null,xs={H:function(){if(!la(Xu))return Xu;if(Xu=!0,Xe(Ee))Xu=!1;else try{var r="__support__";xs.G(r,"xyz"),xs.q(r)!=='"xyz"'&&(Xu=!1),xs.V(r)}catch{Xu=!1}return Xu},B:function(r){et.error("sessionStorage error: ",r)},q:function(r){try{return Ee==null?void 0:Ee.sessionStorage.getItem(r)}catch(e){xs.B(e)}return null},W:function(r){try{return JSON.parse(xs.q(r))||null}catch{}return null},G:function(r,e){try{Ee==null||Ee.sessionStorage.setItem(r,JSON.stringify(e))}catch(t){xs.B(t)}},V:function(r){try{Ee==null||Ee.sessionStorage.removeItem(r)}catch(e){xs.B(e)}}},Ul=(function(r){return r[r.PENDING=-1]="PENDING",r[r.DENIED=0]="DENIED",r[r.GRANTED=1]="GRANTED",r})({});class $z{constructor(e){this._instance=e}get R(){return this._instance.config}get consent(){return this.J()?Ul.DENIED:this.K}isOptedOut(){return this.R.cookieless_mode==="always"||this.consent===Ul.DENIED||this.consent===Ul.PENDING&&(this.R.opt_out_capturing_by_default||this.R.cookieless_mode==="on_reject")}isOptedIn(){return!this.isOptedOut()}isExplicitlyOptedOut(){return this.consent===Ul.DENIED}optInOut(e){this.Y.G(this.X,e?1:0,this.R.cookie_expiration,this.R.cross_subdomain_cookie,this.R.secure_cookie)}reset(){this.Y.V(this.X,this.R.cross_subdomain_cookie)}get X(){var{token:e,opt_out_capturing_cookie_prefix:t,consent_persistence_name:n}=this._instance.config;return n||(t?t+e:"__ph_opt_in_out_"+e)}get K(){var e=this.Y.q(this.X);return Mx(e)?Ul.GRANTED:mr(j8,e)?Ul.DENIED:Ul.PENDING}get Y(){if(!this.Z){var e=this.R.opt_out_capturing_persistence_type;this.Z=e==="localStorage"?gn:za;var t=e==="localStorage"?za:gn;t.q(this.X)&&(this.Z.q(this.X)||this.optInOut(Mx(t.q(this.X))),t.V(this.X,this.R.cross_subdomain_cookie))}return this.Z}J(){return!!this.R.respect_dnt&&!!mR([oi==null?void 0:oi.doNotTrack,oi==null?void 0:oi.msDoNotTrack,Nt.doNotTrack],(e=>Mx(e)))}}var Pv=_n("[Dead Clicks]"),Uz=()=>!0,zz=r=>{var e,t=!((e=r.instance.persistence)==null||!e.get_property(vR)),n=r.instance.config.capture_dead_clicks;return Bl(n)?n:!!qn(n)||t};class FR{get lazyLoadedDeadClicksAutocapture(){return this.tt}constructor(e,t,n){this.instance=e,this.isEnabled=t,this.onCapture=n,this.startIfEnabled()}onRemoteConfig(e){this.instance.persistence&&this.instance.persistence.register({[vR]:e==null?void 0:e.captureDeadClicks}),this.startIfEnabled()}startIfEnabled(){this.isEnabled(this)&&this.it((()=>{this.et()}))}it(e){var t,n;(t=Nt.__PosthogExtensions__)!=null&&t.initDeadClicksAutocapture&&e(),(n=Nt.__PosthogExtensions__)==null||n.loadExternalDependency==null||n.loadExternalDependency(this.instance,"dead-clicks-autocapture",(s=>{s?Pv.error("failed to load script",s):e()}))}et(){var e;if(Je){if(!this.tt&&(e=Nt.__PosthogExtensions__)!=null&&e.initDeadClicksAutocapture){var t=qn(this.instance.config.capture_dead_clicks)?this.instance.config.capture_dead_clicks:{};t.__onCapture=this.onCapture,this.tt=Nt.__PosthogExtensions__.initDeadClicksAutocapture(this.instance,t),this.tt.start(Je),Pv.info("starting...")}}else Pv.error("`document` not found. Cannot start.")}stop(){this.tt&&(this.tt.stop(),this.tt=void 0,Pv.info("stopping..."))}}var Jp=_n("[ExceptionAutocapture]");class Hz{constructor(e){var t,n,s;this.rt=()=>{var i;if(Ee&&this.isEnabled&&(i=Nt.__PosthogExtensions__)!=null&&i.errorWrappingFunctions){var c=Nt.__PosthogExtensions__.errorWrappingFunctions.wrapOnError,d=Nt.__PosthogExtensions__.errorWrappingFunctions.wrapUnhandledRejection,p=Nt.__PosthogExtensions__.errorWrappingFunctions.wrapConsoleError;try{!this.st&&this.R.capture_unhandled_errors&&(this.st=c(this.captureException.bind(this))),!this.nt&&this.R.capture_unhandled_rejections&&(this.nt=d(this.captureException.bind(this))),!this.ot&&this.R.capture_console_errors&&(this.ot=p(this.captureException.bind(this)))}catch(m){Jp.error("failed to start",m),this.ut()}}},this._instance=e,this.ht=!((t=this._instance.persistence)==null||!t.props[WC]),this.dt=new F8({refillRate:(n=this._instance.config.error_tracking.__exceptionRateLimiterRefillRate)!==null&&n!==void 0?n:1,bucketSize:(s=this._instance.config.error_tracking.__exceptionRateLimiterBucketSize)!==null&&s!==void 0?s:10,refillInterval:1e4,h:Jp}),this.R=this.vt(),this.startIfEnabledOrStop()}vt(){var e=this._instance.config.capture_exceptions,t={capture_unhandled_errors:!1,capture_unhandled_rejections:!1,capture_console_errors:!1};return qn(e)?t=rt({},t,e):(Xe(e)?this.ht:e)&&(t=rt({},t,{capture_unhandled_errors:!0,capture_unhandled_rejections:!0})),t}get isEnabled(){return this.R.capture_console_errors||this.R.capture_unhandled_errors||this.R.capture_unhandled_rejections}startIfEnabledOrStop(){this.isEnabled?(Jp.info("enabled"),this.ut(),this.it(this.rt)):this.ut()}it(e){var t,n;(t=Nt.__PosthogExtensions__)!=null&&t.errorWrappingFunctions&&e(),(n=Nt.__PosthogExtensions__)==null||n.loadExternalDependency==null||n.loadExternalDependency(this._instance,"exception-autocapture",(s=>{if(s)return Jp.error("failed to load script",s);e()}))}ut(){var e,t,n;(e=this.st)==null||e.call(this),this.st=void 0,(t=this.nt)==null||t.call(this),this.nt=void 0,(n=this.ot)==null||n.call(this),this.ot=void 0}onRemoteConfig(e){var t=e.autocaptureExceptions;this.ht=!!t||!1,this._instance.persistence&&this._instance.persistence.register({[WC]:this.ht}),this.R=this.vt(),this.startIfEnabledOrStop()}onConfigChange(){this.R=this.vt()}captureException(e){var t,n,s=(t=e==null||(n=e.$exception_list)==null||(n=n[0])==null?void 0:n.type)!==null&&t!==void 0?t:"Exception";this.dt.consumeRateLimit(s)?Jp.info("Skipping exception capture because of client rate limiting.",{exception:s}):this._instance.exceptions.sendExceptionEvent(e)}}function sk(r,e,t){try{if(!(e in r))return()=>{};var n=r[e],s=t(n);return Gc(s)&&(s.prototype=s.prototype||{},Object.defineProperties(s,{__posthog_wrapped__:{enumerable:!1,value:!0}})),r[e]=s,()=>{r[e]=n}}catch{return()=>{}}}class Bz{constructor(e){var t;this._instance=e,this.ct=(Ee==null||(t=Ee.location)==null?void 0:t.pathname)||""}get isEnabled(){return this._instance.config.capture_pageview==="history_change"}startIfEnabled(){this.isEnabled&&(et.info("History API monitoring enabled, starting..."),this.monitorHistoryChanges())}stop(){this.ft&&this.ft(),this.ft=void 0,et.info("History API monitoring stopped")}monitorHistoryChanges(){var e,t;if(Ee&&Ee.history){var n=this;(e=Ee.history.pushState)!=null&&e.__posthog_wrapped__||sk(Ee.history,"pushState",(s=>function(i,c,d){s.call(this,i,c,d),n._t("pushState")})),(t=Ee.history.replaceState)!=null&&t.__posthog_wrapped__||sk(Ee.history,"replaceState",(s=>function(i,c,d){s.call(this,i,c,d),n._t("replaceState")})),this.bt()}}_t(e){try{var t,n=Ee==null||(t=Ee.location)==null?void 0:t.pathname;if(!n)return;n!==this.ct&&this.isEnabled&&this._instance.capture("$pageview",{navigation_type:e}),this.ct=n}catch(s){et.error("Error capturing "+e+" pageview",s)}}bt(){if(!this.ft){var e=()=>{this._t("popstate")};Dn(Ee,"popstate",e),this.ft=()=>{Ee&&Ee.removeEventListener("popstate",e)}}}}var Wx=_n("[SegmentIntegration]");function Gz(r,e){var t=r.config.segment;if(!t)return e();(function(n,s){var i=n.config.segment;if(!i)return s();var c=p=>{var m=()=>p.anonymousId()||Hc();n.config.get_device_id=m,p.id()&&(n.register({distinct_id:p.id(),$device_id:m()}),n.persistence.set_property($l,"identified")),s()},d=i.user();"then"in d&&Gc(d.then)?d.then(c):c(d)})(r,(()=>{t.register((n=>{Promise&&Promise.resolve||Wx.warn("This browser does not have Promise support, and can not use the segment integration");var s=(i,c)=>{if(!c)return i;i.event.userId||i.event.anonymousId===n.get_distinct_id()||(Wx.info("No userId set, resetting PostHog"),n.reset()),i.event.userId&&i.event.userId!==n.get_distinct_id()&&(Wx.info("UserId set, identifying with PostHog"),n.identify(i.event.userId));var d=n.calculateEventProperties(c,i.event.properties);return i.event.properties=Object.assign({},d,i.event.properties),i};return{name:"PostHog JS",type:"enrichment",version:"1.0.0",isLoaded:()=>!0,load:()=>Promise.resolve(),track:i=>s(i,i.event.event),page:i=>s(i,"$pageview"),identify:i=>s(i,"$identify"),screen:i=>s(i,"$screen")}})(r)).then((()=>{e()}))}))}var OR="posthog-js";function DR(r,e){var{organization:t,projectId:n,prefix:s,severityAllowList:i=["error"],sendExceptionsToPostHog:c=!0}=e===void 0?{}:e;return d=>{var p,m,g,x,b;if(!(i==="*"||i.includes(d.level))||!r.__loaded)return d;d.tags||(d.tags={});var S=r.requestRouter.endpointFor("ui","/project/"+r.config.token+"/person/"+r.get_distinct_id());d.tags["PostHog Person URL"]=S,r.sessionRecordingStarted()&&(d.tags["PostHog Recording URL"]=r.get_session_replay_url({withTimestamp:!0}));var T=((p=d.exception)==null?void 0:p.values)||[],E=T.map((R=>rt({},R,{stacktrace:R.stacktrace?rt({},R.stacktrace,{type:"raw",frames:(R.stacktrace.frames||[]).map((A=>rt({},A,{platform:"web:javascript"})))}):void 0}))),C={$exception_message:((m=T[0])==null?void 0:m.value)||d.message,$exception_type:(g=T[0])==null?void 0:g.type,$exception_level:d.level,$exception_list:E,$sentry_event_id:d.event_id,$sentry_exception:d.exception,$sentry_exception_message:((x=T[0])==null?void 0:x.value)||d.message,$sentry_exception_type:(b=T[0])==null?void 0:b.type,$sentry_tags:d.tags};return t&&n&&(C.$sentry_url=(s||"https://sentry.io/organizations/")+t+"/issues/?project="+n+"&query="+d.event_id),c&&r.exceptions.sendExceptionEvent(C),d}}class Wz{constructor(e,t,n,s,i,c){this.name=OR,this.setupOnce=function(d){d(DR(e,{organization:t,projectId:n,prefix:s,severityAllowList:i,sendExceptionsToPostHog:c==null||c}))}}}var Vz=Ee!=null&&Ee.location?Cy(Ee.location.hash,"__posthog")||Cy(location.hash,"state"):null,ok="_postHogToolbarParams",ik=_n("[Toolbar]"),Mc=(function(r){return r[r.UNINITIALIZED=0]="UNINITIALIZED",r[r.LOADING=1]="LOADING",r[r.LOADED=2]="LOADED",r})(Mc||{});class qz{constructor(e){this.instance=e}yt(e){Nt.ph_toolbar_state=e}wt(){var e;return(e=Nt.ph_toolbar_state)!==null&&e!==void 0?e:Mc.UNINITIALIZED}maybeLoadToolbar(e,t,n){if(e===void 0&&(e=void 0),t===void 0&&(t=void 0),n===void 0&&(n=void 0),!Ee||!Je)return!1;e=e??Ee.location,n=n??Ee.history;try{if(!t){try{Ee.localStorage.setItem("test","test"),Ee.localStorage.removeItem("test")}catch{return!1}t=Ee==null?void 0:Ee.localStorage}var s,i=Vz||Cy(e.hash,"__posthog")||Cy(e.hash,"state"),c=i?BC((()=>JSON.parse(atob(decodeURIComponent(i)))))||BC((()=>JSON.parse(decodeURIComponent(i)))):null;return c&&c.action==="ph_authorize"?((s=c).source="url",s&&Object.keys(s).length>0&&(c.desiredHash?e.hash=c.desiredHash:n?n.replaceState(n.state,"",e.pathname+e.search):e.hash="")):((s=JSON.parse(t.getItem(ok)||"{}")).source="localstorage",delete s.userIntent),!(!s.token||this.instance.config.token!==s.token)&&(this.loadToolbar(s),!0)}catch{return!1}}xt(e){var t=Nt.ph_load_toolbar||Nt.ph_load_editor;!xr(t)&&Gc(t)?t(e,this.instance):ik.warn("No toolbar load function found")}loadToolbar(e){var t=!(Je==null||!Je.getElementById(xR));if(!Ee||t)return!1;var n=this.instance.requestRouter.region==="custom"&&this.instance.config.advanced_disable_toolbar_metrics,s=rt({token:this.instance.config.token},e,{apiURL:this.instance.requestRouter.endpointFor("ui")},n?{instrument:!1}:{});if(Ee.localStorage.setItem(ok,JSON.stringify(rt({},s,{source:void 0}))),this.wt()===Mc.LOADED)this.xt(s);else if(this.wt()===Mc.UNINITIALIZED){var i;this.yt(Mc.LOADING),(i=Nt.__PosthogExtensions__)==null||i.loadExternalDependency==null||i.loadExternalDependency(this.instance,"toolbar",(c=>{if(c)return ik.error("[Toolbar] Failed to load",c),void this.yt(Mc.UNINITIALIZED);this.yt(Mc.LOADED),this.xt(s)})),Dn(Ee,"turbolinks:load",(()=>{this.yt(Mc.UNINITIALIZED),this.loadToolbar(s)}))}return!0}Et(e){return this.loadToolbar(e)}maybeLoadEditor(e,t,n){return e===void 0&&(e=void 0),t===void 0&&(t=void 0),n===void 0&&(n=void 0),this.maybeLoadToolbar(e,t,n)}}var Kz=_n("[TracingHeaders]");class Yz{constructor(e){this.$t=void 0,this.St=void 0,this.rt=()=>{var t,n;Xe(this.$t)&&((t=Nt.__PosthogExtensions__)==null||(t=t.tracingHeadersPatchFns)==null||t._patchXHR(this._instance.config.__add_tracing_headers||[],this._instance.get_distinct_id(),this._instance.sessionManager)),Xe(this.St)&&((n=Nt.__PosthogExtensions__)==null||(n=n.tracingHeadersPatchFns)==null||n._patchFetch(this._instance.config.__add_tracing_headers||[],this._instance.get_distinct_id(),this._instance.sessionManager))},this._instance=e}it(e){var t,n;(t=Nt.__PosthogExtensions__)!=null&&t.tracingHeadersPatchFns&&e(),(n=Nt.__PosthogExtensions__)==null||n.loadExternalDependency==null||n.loadExternalDependency(this._instance,"tracing-headers",(s=>{if(s)return Kz.error("failed to load script",s);e()}))}startIfEnabledOrStop(){var e,t;this._instance.config.__add_tracing_headers?this.it(this.rt):((e=this.$t)==null||e.call(this),(t=this.St)==null||t.call(this),this.$t=void 0,this.St=void 0)}}var jv="https?://(.*)",_h=["gclid","gclsrc","dclid","gbraid","wbraid","fbclid","msclkid","twclid","li_fat_id","igshid","ttclid","rdt_cid","epik","qclid","sccid","irclid","_kx"],Jz=bh(["utm_source","utm_medium","utm_campaign","utm_content","utm_term","gad_source","mc_cid"],_h),lg="<masked>",Xz=["li_fat_id"];function LR(r,e,t){if(!Je)return{};var n,s=e?bh([],_h,t||[]):[],i=MR(ag(Je.URL,s,lg),r),c=(n={},tn(Xz,(function(d){var p=za.q(d);n[d]=p||null})),n);return Rn(c,i)}function MR(r,e){var t=Jz.concat(e||[]),n={};return tn(t,(function(s){var i=Ey(r,s);n[s]=i||null})),n}function $R(r){var e=(function(i){return i?i.search(jv+"google.([^/?]*)")===0?"google":i.search(jv+"bing.com")===0?"bing":i.search(jv+"yahoo.com")===0?"yahoo":i.search(jv+"duckduckgo.com")===0?"duckduckgo":null:null})(r),t=e!="yahoo"?"q":"p",n={};if(!la(e)){n.$search_engine=e;var s=Je?Ey(Je.referrer,t):"";s.length&&(n.ph_keyword=s)}return n}function ak(){return navigator.language||navigator.userLanguage}function UR(){return(Je==null?void 0:Je.referrer)||"$direct"}function zR(r,e){var t=r?bh([],_h,e||[]):[],n=bs==null?void 0:bs.href.substring(0,1e3);return{r:UR().substring(0,1e3),u:n?ag(n,t,lg):void 0}}function HR(r){var e,{r:t,u:n}=r,s={$referrer:t,$referring_domain:t==null?void 0:t=="$direct"?"$direct":(e=Sy(t))==null?void 0:e.host};if(n){s.$current_url=n;var i=Sy(n);s.$host=i==null?void 0:i.host,s.$pathname=i==null?void 0:i.pathname;var c=MR(n);Rn(s,c)}if(t){var d=$R(t);Rn(s,d)}return s}function BR(){try{return Intl.DateTimeFormat().resolvedOptions().timeZone}catch{return}}function Qz(){try{return new Date().getTimezoneOffset()}catch{return}}function Zz(r,e){if(!jo)return{};var t,n,s,i=r?bh([],_h,e||[]):[],[c,d]=(function(p){for(var m=0;m<MC.length;m++){var[g,x]=MC[m],b=g.exec(p),S=b&&(Gc(x)?x(b,p):x);if(S)return S}return["",""]})(jo);return Rn(iS({$os:c,$os_version:d,$browser:dR(jo,navigator.vendor),$device:$C(jo),$device_type:(n=jo,s=$C(n),s===XT||s===JT||s==="Kobo"||s==="Kindle Fire"||s===uR?Hm:s===Gm||s===oh||s===Wm||s===Qw?"Console":s===ZT?"Wearable":s?ji:"Desktop"),$timezone:BR(),$timezone_offset:Qz()}),{$current_url:ag(bs==null?void 0:bs.href,i,lg),$host:bs==null?void 0:bs.host,$pathname:bs==null?void 0:bs.pathname,$raw_user_agent:jo.length>1e3?jo.substring(0,997)+"...":jo,$browser_version:G8(jo,navigator.vendor),$browser_language:ak(),$browser_language_prefix:(t=ak(),typeof t=="string"?t.split("-")[0]:void 0),$screen_height:Ee==null?void 0:Ee.screen.height,$screen_width:Ee==null?void 0:Ee.screen.width,$viewport_height:Ee==null?void 0:Ee.innerHeight,$viewport_width:Ee==null?void 0:Ee.innerWidth,$lib:"web",$lib_version:Ml.LIB_VERSION,$insert_id:Math.random().toString(36).substring(2,10)+Math.random().toString(36).substring(2,10),$time:Date.now()/1e3})}var Oc=_n("[Web Vitals]"),lk=9e5;class eH{constructor(e){var t;this.kt=!1,this.P=!1,this.N={url:void 0,metrics:[],firstMetricTimestamp:void 0},this.Pt=()=>{clearTimeout(this.Tt),this.N.metrics.length!==0&&(this._instance.capture("$web_vitals",this.N.metrics.reduce(((n,s)=>rt({},n,{["$web_vitals_"+s.name+"_event"]:rt({},s),["$web_vitals_"+s.name+"_value"]:s.value})),{})),this.N={url:void 0,metrics:[],firstMetricTimestamp:void 0})},this.It=n=>{var s,i=(s=this._instance.sessionManager)==null?void 0:s.checkAndGetSessionAndWindowId(!0);if(Xe(i))Oc.error("Could not read session ID. Dropping metrics!");else{this.N=this.N||{url:void 0,metrics:[],firstMetricTimestamp:void 0};var c=this.Ct();Xe(c)||(xr(n==null?void 0:n.name)||xr(n==null?void 0:n.value)?Oc.error("Invalid metric received",n):this.Rt&&n.value>=this.Rt?Oc.error("Ignoring metric with value >= "+this.Rt,n):(this.N.url!==c&&(this.Pt(),this.Tt=setTimeout(this.Pt,this.flushToCaptureTimeoutMs)),Xe(this.N.url)&&(this.N.url=c),this.N.firstMetricTimestamp=Xe(this.N.firstMetricTimestamp)?Date.now():this.N.firstMetricTimestamp,n.attribution&&n.attribution.interactionTargetElement&&(n.attribution.interactionTargetElement=void 0),this.N.metrics.push(rt({},n,{$current_url:c,$session_id:i.sessionId,$window_id:i.windowId,timestamp:Date.now()})),this.N.metrics.length===this.allowedMetrics.length&&this.Pt()))}},this.rt=()=>{if(!this.P){var n,s,i,c,d=Nt.__PosthogExtensions__;Xe(d)||Xe(d.postHogWebVitalsCallbacks)||({onLCP:n,onCLS:s,onFCP:i,onINP:c}=d.postHogWebVitalsCallbacks),n&&s&&i&&c?(this.allowedMetrics.indexOf("LCP")>-1&&n(this.It.bind(this)),this.allowedMetrics.indexOf("CLS")>-1&&s(this.It.bind(this)),this.allowedMetrics.indexOf("FCP")>-1&&i(this.It.bind(this)),this.allowedMetrics.indexOf("INP")>-1&&c(this.It.bind(this)),this.P=!0):Oc.error("web vitals callbacks not loaded - not starting")}},this._instance=e,this.kt=!((t=this._instance.persistence)==null||!t.props[qC]),this.startIfEnabled()}get allowedMetrics(){var e,t,n=qn(this._instance.config.capture_performance)?(e=this._instance.config.capture_performance)==null?void 0:e.web_vitals_allowed_metrics:void 0;return xr(n)?((t=this._instance.persistence)==null?void 0:t.props[YC])||["CLS","FCP","INP","LCP"]:n}get flushToCaptureTimeoutMs(){return(qn(this._instance.config.capture_performance)?this._instance.config.capture_performance.web_vitals_delayed_flush_ms:void 0)||5e3}get useAttribution(){var e=qn(this._instance.config.capture_performance)?this._instance.config.capture_performance.web_vitals_attribution:void 0;return e!=null&&e}get Rt(){var e=qn(this._instance.config.capture_performance)&&Wl(this._instance.config.capture_performance.__web_vitals_max_value)?this._instance.config.capture_performance.__web_vitals_max_value:lk;return 0<e&&e<=6e4?lk:e}get isEnabled(){var e=bs==null?void 0:bs.protocol;if(e!=="http:"&&e!=="https:")return Oc.info("Web Vitals are disabled on non-http/https protocols"),!1;var t=qn(this._instance.config.capture_performance)?this._instance.config.capture_performance.web_vitals:Bl(this._instance.config.capture_performance)?this._instance.config.capture_performance:void 0;return Bl(t)?t:this.kt}startIfEnabled(){this.isEnabled&&!this.P&&(Oc.info("enabled, starting..."),this.it(this.rt))}onRemoteConfig(e){var t=qn(e.capturePerformance)&&!!e.capturePerformance.web_vitals,n=qn(e.capturePerformance)?e.capturePerformance.web_vitals_allowed_metrics:void 0;this._instance.persistence&&(this._instance.persistence.register({[qC]:t}),this._instance.persistence.register({[YC]:n})),this.kt=t,this.startIfEnabled()}it(e){var t,n;if((t=Nt.__PosthogExtensions__)!=null&&t.postHogWebVitalsCallbacks)e();else{var s=this.useAttribution?"web-vitals-with-attribution":"web-vitals";(n=Nt.__PosthogExtensions__)==null||n.loadExternalDependency==null||n.loadExternalDependency(this._instance,s,(i=>{i?Oc.error("failed to load script",i):e()}))}}Ct(){var e=Ee?Ee.location.href:void 0;if(e){var t=this._instance.config.mask_personal_data_properties,n=this._instance.config.custom_personal_data_properties,s=t?bh([],_h,n||[]):[];return ag(e,s,lg)}Oc.error("Could not determine current URL")}}var tH=_n("[Heatmaps]");function ck(r){return qn(r)&&"clientX"in r&&"clientY"in r&&Wl(r.clientX)&&Wl(r.clientY)}class rH{constructor(e){var t;this.kt=!1,this.P=!1,this.Ft=null,this.instance=e,this.kt=!((t=this.instance.persistence)==null||!t.props[tb]),this.rageclicks=new PR(e.config.rageclick)}get flushIntervalMilliseconds(){var e=5e3;return qn(this.instance.config.capture_heatmaps)&&this.instance.config.capture_heatmaps.flush_interval_milliseconds&&(e=this.instance.config.capture_heatmaps.flush_interval_milliseconds),e}get isEnabled(){return xr(this.instance.config.capture_heatmaps)?xr(this.instance.config.enable_heatmaps)?this.kt:this.instance.config.enable_heatmaps:this.instance.config.capture_heatmaps!==!1}startIfEnabled(){if(this.isEnabled){if(this.P)return;tH.info("starting..."),this.Ot(),this.Mt()}else{var e;clearInterval((e=this.Ft)!==null&&e!==void 0?e:void 0),this.At(),this.getAndClearBuffer()}}onRemoteConfig(e){var t=!!e.heatmaps;this.instance.persistence&&this.instance.persistence.register({[tb]:t}),this.kt=t,this.startIfEnabled()}getAndClearBuffer(){var e=this.N;return this.N=void 0,e}jt(e){this.Dt(e.originalEvent,"deadclick")}Mt(){this.Ft&&clearInterval(this.Ft),this.Ft=(function(e){return(e==null?void 0:e.visibilityState)==="visible"})(Je)?setInterval(this.Lt.bind(this),this.flushIntervalMilliseconds):null}Ot(){Ee&&Je&&(this.Nt=this.Lt.bind(this),Dn(Ee,"beforeunload",this.Nt),this.Ut=e=>this.Dt(e||(Ee==null?void 0:Ee.event)),Dn(Je,"click",this.Ut,{capture:!0}),this.zt=e=>this.Ht(e||(Ee==null?void 0:Ee.event)),Dn(Je,"mousemove",this.zt,{capture:!0}),this.Bt=new FR(this.instance,Uz,this.jt.bind(this)),this.Bt.startIfEnabled(),this.qt=this.Mt.bind(this),Dn(Je,"visibilitychange",this.qt),this.P=!0)}At(){var e;Ee&&Je&&(this.Nt&&Ee.removeEventListener("beforeunload",this.Nt),this.Ut&&Je.removeEventListener("click",this.Ut,{capture:!0}),this.zt&&Je.removeEventListener("mousemove",this.zt,{capture:!0}),this.qt&&Je.removeEventListener("visibilitychange",this.qt),clearTimeout(this.Wt),(e=this.Bt)==null||e.stop(),this.P=!1)}Gt(e,t){var n=this.instance.scrollManager.scrollY(),s=this.instance.scrollManager.scrollX(),i=this.instance.scrollManager.scrollElement(),c=(function(d,p,m){for(var g=d;g&&t0(g)&&!Vc(g,"body");){if(g===m)return!1;if(mr(p,Ee==null?void 0:Ee.getComputedStyle(g).position))return!0;g=CR(g)}return!1})(SR(e),["fixed","sticky"],i);return{x:e.clientX+(c?0:s),y:e.clientY+(c?0:n),target_fixed:c,type:t}}Dt(e,t){var n;if(t===void 0&&(t="click"),!JC(e.target)&&ck(e)){var s=this.Gt(e,t);(n=this.rageclicks)!=null&&n.isRageClick(e.clientX,e.clientY,new Date().getTime())&&this.Vt(rt({},s,{type:"rageclick"})),this.Vt(s)}}Ht(e){!JC(e.target)&&ck(e)&&(clearTimeout(this.Wt),this.Wt=setTimeout((()=>{this.Vt(this.Gt(e,"mousemove"))}),500))}Vt(e){if(Ee){var t=Ee.location.href,n=this.instance.config.mask_personal_data_properties,s=this.instance.config.custom_personal_data_properties,i=n?bh([],_h,s||[]):[],c=ag(t,i,lg);this.N=this.N||{},this.N[c]||(this.N[c]=[]),this.N[c].push(e)}}Lt(){this.N&&!Zf(this.N)&&this.instance.capture("$$heatmap",{$heatmap_data:this.getAndClearBuffer()})}}class uk{constructor(e){this.Jt=(t,n,s)=>{s&&(s.noSessionId||s.activityTimeout||s.sessionPastMaximumLength)&&(et.info("[PageViewManager] Session rotated, clearing pageview state",{sessionId:t,changeReason:s}),this.Kt=void 0,this._instance.scrollManager.resetContext())},this._instance=e,this.Yt()}Yt(){var e;this.Xt=(e=this._instance.sessionManager)==null?void 0:e.onSessionId(this.Jt)}destroy(){var e;(e=this.Xt)==null||e.call(this),this.Xt=void 0}doPageView(e,t){var n,s=this.Qt(e,t);return this.Kt={pathname:(n=Ee==null?void 0:Ee.location.pathname)!==null&&n!==void 0?n:"",pageViewId:t,timestamp:e},this._instance.scrollManager.resetContext(),s}doPageLeave(e){var t;return this.Qt(e,(t=this.Kt)==null?void 0:t.pageViewId)}doEvent(){var e;return{$pageview_id:(e=this.Kt)==null?void 0:e.pageViewId}}Qt(e,t){var n=this.Kt;if(!n)return{$pageview_id:t};var s={$pageview_id:t,$prev_pageview_id:n.pageViewId},i=this._instance.scrollManager.getContext();if(i&&!this._instance.config.disable_scroll_properties){var{maxScrollHeight:c,lastScrollY:d,maxScrollY:p,maxContentHeight:m,lastContentY:g,maxContentY:x}=i;if(!(Xe(c)||Xe(d)||Xe(p)||Xe(m)||Xe(g)||Xe(x))){c=Math.ceil(c),d=Math.ceil(d),p=Math.ceil(p),m=Math.ceil(m),g=Math.ceil(g),x=Math.ceil(x);var b=c<=1?1:Wa(d/c,0,1,et),S=c<=1?1:Wa(p/c,0,1,et),T=m<=1?1:Wa(g/m,0,1,et),E=m<=1?1:Wa(x/m,0,1,et);s=Rn(s,{$prev_pageview_last_scroll:d,$prev_pageview_last_scroll_percentage:b,$prev_pageview_max_scroll:p,$prev_pageview_max_scroll_percentage:S,$prev_pageview_last_content:g,$prev_pageview_last_content_percentage:T,$prev_pageview_max_content:x,$prev_pageview_max_content_percentage:E})}}return n.pathname&&(s.$prev_pageview_pathname=n.pathname),n.timestamp&&(s.$prev_pageview_duration=(e.getTime()-n.timestamp.getTime())/1e3),s}}var zl=(function(r){return r.GZipJS="gzip-js",r.Base64="base64",r})({}),Fi=Uint8Array,Fo=Uint16Array,mh=Uint32Array,uS=new Fi([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),dS=new Fi([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),dk=new Fi([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),GR=function(r,e){for(var t=new Fo(31),n=0;n<31;++n)t[n]=e+=1<<r[n-1];var s=new mh(t[30]);for(n=1;n<30;++n)for(var i=t[n];i<t[n+1];++i)s[i]=i-t[n]<<5|n;return[t,s]},WR=GR(uS,2),nH=WR[0],ub=WR[1];nH[28]=258,ub[258]=28;for(var fk=GR(dS,0)[1],VR=new Fo(32768),ln=0;ln<32768;++ln){var Qu=(43690&ln)>>>1|(21845&ln)<<1;Qu=(61680&(Qu=(52428&Qu)>>>2|(13107&Qu)<<2))>>>4|(3855&Qu)<<4,VR[ln]=((65280&Qu)>>>8|(255&Qu)<<8)>>>1}var km=function(r,e,t){for(var n=r.length,s=0,i=new Fo(e);s<n;++s)++i[r[s]-1];var c,d=new Fo(e);for(s=0;s<e;++s)d[s]=d[s-1]+i[s-1]<<1;for(c=new Fo(n),s=0;s<n;++s)c[s]=VR[d[r[s]-1]++]>>>15-r[s];return c},dd=new Fi(288);for(ln=0;ln<144;++ln)dd[ln]=8;for(ln=144;ln<256;++ln)dd[ln]=9;for(ln=256;ln<280;++ln)dd[ln]=7;for(ln=280;ln<288;++ln)dd[ln]=8;var Ny=new Fi(32);for(ln=0;ln<32;++ln)Ny[ln]=5;var sH=km(dd,9),oH=km(Ny,5),qR=function(r){return(r/8>>0)+(7&r&&1)},KR=function(r,e,t){(t==null||t>r.length)&&(t=r.length);var n=new(r instanceof Fo?Fo:r instanceof mh?mh:Fi)(t-e);return n.set(r.subarray(e,t)),n},jl=function(r,e,t){t<<=7&e;var n=e/8>>0;r[n]|=t,r[n+1]|=t>>>8},Xp=function(r,e,t){t<<=7&e;var n=e/8>>0;r[n]|=t,r[n+1]|=t>>>8,r[n+2]|=t>>>16},Vx=function(r,e){for(var t=[],n=0;n<r.length;++n)r[n]&&t.push({s:n,f:r[n]});var s=t.length,i=t.slice();if(!s)return[new Fi(0),0];if(s==1){var c=new Fi(t[0].s+1);return c[t[0].s]=1,[c,1]}t.sort((function(L,G){return L.f-G.f})),t.push({s:-1,f:25001});var d=t[0],p=t[1],m=0,g=1,x=2;for(t[0]={s:-1,f:d.f+p.f,l:d,r:p};g!=s-1;)d=t[t[m].f<t[x].f?m++:x++],p=t[m!=g&&t[m].f<t[x].f?m++:x++],t[g++]={s:-1,f:d.f+p.f,l:d,r:p};var b=i[0].s;for(n=1;n<s;++n)i[n].s>b&&(b=i[n].s);var S=new Fo(b+1),T=db(t[g-1],S,0);if(T>e){n=0;var E=0,C=T-e,R=1<<C;for(i.sort((function(L,G){return S[G.s]-S[L.s]||L.f-G.f}));n<s;++n){var A=i[n].s;if(!(S[A]>e))break;E+=R-(1<<T-S[A]),S[A]=e}for(E>>>=C;E>0;){var F=i[n].s;S[F]<e?E-=1<<e-S[F]++-1:++n}for(;n>=0&&E;--n){var P=i[n].s;S[P]==e&&(--S[P],++E)}T=e}return[new Fi(S),T]},db=function(r,e,t){return r.s==-1?Math.max(db(r.l,e,t+1),db(r.r,e,t+1)):e[r.s]=t},hk=function(r){for(var e=r.length;e&&!r[--e];);for(var t=new Fo(++e),n=0,s=r[0],i=1,c=function(p){t[n++]=p},d=1;d<=e;++d)if(r[d]==s&&d!=e)++i;else{if(!s&&i>2){for(;i>138;i-=138)c(32754);i>2&&(c(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(c(s),--i;i>6;i-=6)c(8304);i>2&&(c(i-3<<5|8208),i=0)}for(;i--;)c(s);i=1,s=r[d]}return[t.subarray(0,n),e]},Qp=function(r,e){for(var t=0,n=0;n<e.length;++n)t+=r[n]*e[n];return t},fb=function(r,e,t){var n=t.length,s=qR(e+2);r[s]=255&n,r[s+1]=n>>>8,r[s+2]=255^r[s],r[s+3]=255^r[s+1];for(var i=0;i<n;++i)r[s+i+4]=t[i];return 8*(s+4+n)},pk=function(r,e,t,n,s,i,c,d,p,m,g){jl(e,g++,t),++s[256];for(var x=Vx(s,15),b=x[0],S=x[1],T=Vx(i,15),E=T[0],C=T[1],R=hk(b),A=R[0],F=R[1],P=hk(E),L=P[0],G=P[1],U=new Fo(19),V=0;V<A.length;++V)U[31&A[V]]++;for(V=0;V<L.length;++V)U[31&L[V]]++;for(var Q=Vx(U,7),fe=Q[0],B=Q[1],ee=19;ee>4&&!fe[dk[ee-1]];--ee);var ve,ce,ne,xe,J=m+5<<3,X=Qp(s,dd)+Qp(i,Ny)+c,z=Qp(s,b)+Qp(i,E)+c+14+3*ee+Qp(U,fe)+(2*U[16]+3*U[17]+7*U[18]);if(J<=X&&J<=z)return fb(e,g,r.subarray(p,p+m));if(jl(e,g,1+(z<X)),g+=2,z<X){ve=km(b,S),ce=b,ne=km(E,C),xe=E;var q=km(fe,B);for(jl(e,g,F-257),jl(e,g+5,G-1),jl(e,g+10,ee-4),g+=14,V=0;V<ee;++V)jl(e,g+3*V,fe[dk[V]]);g+=3*ee;for(var O=[A,L],$=0;$<2;++$){var ae=O[$];for(V=0;V<ae.length;++V){var be=31&ae[V];jl(e,g,q[be]),g+=fe[be],be>15&&(jl(e,g,ae[V]>>>5&127),g+=ae[V]>>>12)}}}else ve=sH,ce=dd,ne=oH,xe=Ny;for(V=0;V<d;++V)if(n[V]>255){be=n[V]>>>18&31,Xp(e,g,ve[be+257]),g+=ce[be+257],be>7&&(jl(e,g,n[V]>>>23&31),g+=uS[be]);var ie=31&n[V];Xp(e,g,ne[ie]),g+=xe[ie],ie>3&&(Xp(e,g,n[V]>>>5&8191),g+=dS[ie])}else Xp(e,g,ve[n[V]]),g+=ce[n[V]];return Xp(e,g,ve[256]),g+ce[256]},iH=new mh([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),aH=(function(){for(var r=new mh(256),e=0;e<256;++e){for(var t=e,n=9;--n;)t=(1&t&&3988292384)^t>>>1;r[e]=t}return r})(),lH=function(r,e,t,n,s){return(function(i,c,d,p,m,g){var x=i.length,b=new Fi(p+x+5*(1+Math.floor(x/7e3))+m),S=b.subarray(p,b.length-m),T=0;if(!c||x<8)for(var E=0;E<=x;E+=65535){var C=E+65535;C<x?T=fb(S,T,i.subarray(E,C)):(S[E]=g,T=fb(S,T,i.subarray(E,x)))}else{for(var R=iH[c-1],A=R>>>13,F=8191&R,P=(1<<d)-1,L=new Fo(32768),G=new Fo(P+1),U=Math.ceil(d/3),V=2*U,Q=function(yt){return(i[yt]^i[yt+1]<<U^i[yt+2]<<V)&P},fe=new mh(25e3),B=new Fo(288),ee=new Fo(32),ve=0,ce=0,ne=(E=0,0),xe=0,J=0;E<x;++E){var X=Q(E),z=32767&E,q=G[X];if(L[z]=q,G[X]=z,xe<=E){var O=x-E;if((ve>7e3||ne>24576)&&O>423){T=pk(i,S,0,fe,B,ee,ce,ne,J,E-J,T),ne=ve=ce=0,J=E;for(var $=0;$<286;++$)B[$]=0;for($=0;$<30;++$)ee[$]=0}var ae=2,be=0,ie=F,K=z-q&32767;if(O>2&&X==Q(E-K))for(var de=Math.min(A,O)-1,ge=Math.min(32767,E),se=Math.min(258,O);K<=ge&&--ie&&z!=q;){if(i[E+ae]==i[E+ae-K]){for(var Te=0;Te<se&&i[E+Te]==i[E+Te-K];++Te);if(Te>ae){if(ae=Te,be=K,Te>de)break;var qe=Math.min(K,Te-2),ze=0;for($=0;$<qe;++$){var Be=E-K+$+32768&32767,Ce=Be-L[Be]+32768&32767;Ce>ze&&(ze=Ce,q=Be)}}}K+=(z=q)-(q=L[z])+32768&32767}if(be){fe[ne++]=268435456|ub[ae]<<18|fk[be];var vt=31&ub[ae],kt=31&fk[be];ce+=uS[vt]+dS[kt],++B[257+vt],++ee[kt],xe=E+ae,++ve}else fe[ne++]=i[E],++B[i[E]]}}T=pk(i,S,g,fe,B,ee,ce,ne,J,E-J,T)}return KR(b,0,p+qR(T)+m)})(r,e.level==null?6:e.level,e.mem==null?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(r.length)))):12+e.mem,t,n,!0)},qx=function(r,e,t){for(;t;++e)r[e]=t,t>>>=8};function cH(r,e){e===void 0&&(e={});var t=(function(){var d=4294967295;return{p:function(p){for(var m=d,g=0;g<p.length;++g)m=aH[255&m^p[g]]^m>>>8;d=m},d:function(){return 4294967295^d}}})(),n=r.length;t.p(r);var s,i=lH(r,e,10+((s=e).filename&&s.filename.length+1||0),8),c=i.length;return(function(d,p){var m=p.filename;if(d[0]=31,d[1]=139,d[2]=8,d[8]=p.level<2?4:p.level==9?2:0,d[9]=3,p.mtime!=0&&qx(d,4,Math.floor(new Date(p.mtime||Date.now())/1e3)),m){d[3]=8;for(var g=0;g<=m.length;++g)d[g+10]=m.charCodeAt(g)}})(i,e),qx(i,c-8,t.d()),qx(i,c-4,n),i}var uH=function(r){var e,t,n,s,i="";for(e=t=0,n=(r=(r+"").replace(/\r\n/g,`
`).replace(/\r/g,`
`)).length,s=0;s<n;s++){var c=r.charCodeAt(s),d=null;c<128?t++:d=c>127&&c<2048?String.fromCharCode(c>>6|192,63&c|128):String.fromCharCode(c>>12|224,c>>6&63|128,63&c|128),la(d)||(t>e&&(i+=r.substring(e,t)),i+=d,e=t=s+1)}return t>e&&(i+=r.substring(e,r.length)),i},dH=!!qw||!!Vw,mk="text/plain",Ty=function(r,e,t){var n;t===void 0&&(t=!0);var[s,i]=r.split("?"),c=rt({},e),d=(n=i==null?void 0:i.split("&").map((m=>{var g,[x,b]=m.split("="),S=t&&(g=c[x])!==null&&g!==void 0?g:b;return delete c[x],x+"="+S})))!==null&&n!==void 0?n:[],p=Nz(c);return p&&d.push(p),s+"?"+d.join("&")},ym=(r,e)=>JSON.stringify(r,((t,n)=>typeof n=="bigint"?n.toString():n),e),Kx=r=>{var{data:e,compression:t}=r;if(e){if(t===zl.GZipJS){var n=cH((function(p,m){var g=p.length;if(typeof TextEncoder<"u")return new TextEncoder().encode(p);for(var x=new Fi(p.length+(p.length>>>1)),b=0,S=function(R){x[b++]=R},T=0;T<g;++T){if(b+5>x.length){var E=new Fi(b+8+(g-T<<1));E.set(x),x=E}var C=p.charCodeAt(T);C<128||m?S(C):C<2048?(S(192|C>>>6),S(128|63&C)):C>55295&&C<57344?(S(240|(C=65536+(1047552&C)|1023&p.charCodeAt(++T))>>>18),S(128|C>>>12&63),S(128|C>>>6&63),S(128|63&C)):(S(224|C>>>12),S(128|C>>>6&63),S(128|63&C))}return KR(x,0,b)})(ym(e)),{mtime:0}),s=new Blob([n],{type:mk});return{contentType:mk,body:s,estimatedSize:s.size}}if(t===zl.Base64){var i=(function(p){var m,g,x,b,S,T="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",E=0,C=0,R="",A=[];if(!p)return p;p=uH(p);do m=(S=p.charCodeAt(E++)<<16|p.charCodeAt(E++)<<8|p.charCodeAt(E++))>>18&63,g=S>>12&63,x=S>>6&63,b=63&S,A[C++]=T.charAt(m)+T.charAt(g)+T.charAt(x)+T.charAt(b);while(E<p.length);switch(R=A.join(""),p.length%3){case 1:R=R.slice(0,-2)+"==";break;case 2:R=R.slice(0,-1)+"="}return R})(ym(e)),c=(p=>"data="+encodeURIComponent(typeof p=="string"?p:ym(p)))(i);return{contentType:"application/x-www-form-urlencoded",body:c,estimatedSize:new Blob([c]).size}}var d=ym(e);return{contentType:"application/json",body:d,estimatedSize:new Blob([d]).size}}},ty=[];Vw&&ty.push({transport:"fetch",method:r=>{var e,t,{contentType:n,body:s,estimatedSize:i}=(e=Kx(r))!==null&&e!==void 0?e:{},c=new Headers;tn(r.headers,(function(g,x){c.append(x,g)})),n&&c.append("Content-Type",n);var d=r.url,p=null;if(jC){var m=new jC;p={signal:m.signal,timeout:setTimeout((()=>m.abort()),r.timeout)}}Vw(d,rt({method:(r==null?void 0:r.method)||"GET",headers:c,keepalive:r.method==="POST"&&(i||0)<52428.8,body:s,signal:(t=p)==null?void 0:t.signal},r.fetchOptions)).then((g=>g.text().then((x=>{var b={statusCode:g.status,text:x};if(g.status===200)try{b.json=JSON.parse(x)}catch(S){et.error(S)}r.callback==null||r.callback(b)})))).catch((g=>{et.error(g),r.callback==null||r.callback({statusCode:0,text:g})})).finally((()=>p?clearTimeout(p.timeout):null))}}),qw&&ty.push({transport:"XHR",method:r=>{var e,t=new qw;t.open(r.method||"GET",r.url,!0);var{contentType:n,body:s}=(e=Kx(r))!==null&&e!==void 0?e:{};tn(r.headers,(function(i,c){t.setRequestHeader(c,i)})),n&&t.setRequestHeader("Content-Type",n),r.timeout&&(t.timeout=r.timeout),r.disableXHRCredentials||(t.withCredentials=!0),t.onreadystatechange=()=>{if(t.readyState===4){var i={statusCode:t.status,text:t.responseText};if(t.status===200)try{i.json=JSON.parse(t.responseText)}catch{}r.callback==null||r.callback(i)}},t.send(s)}}),oi!=null&&oi.sendBeacon&&ty.push({transport:"sendBeacon",method:r=>{var e=Ty(r.url,{beacon:"1"});try{var t,{contentType:n,body:s}=(t=Kx(r))!==null&&t!==void 0?t:{},i=typeof s=="string"?new Blob([s],{type:n}):s;oi.sendBeacon(e,i)}catch{}}});var Ry=function(r,e){if(!(function(t){try{new RegExp(t)}catch{return!1}return!0})(e))return!1;try{return new RegExp(e).test(r)}catch{return!1}};function gk(r,e,t){return ym({distinct_id:r,userPropertiesToSet:e,userPropertiesToSetOnce:t})}var YR={exact:(r,e)=>e.some((t=>r.some((n=>t===n)))),is_not:(r,e)=>e.every((t=>r.every((n=>t!==n)))),regex:(r,e)=>e.some((t=>r.some((n=>Ry(t,n))))),not_regex:(r,e)=>e.every((t=>r.every((n=>!Ry(t,n))))),icontains:(r,e)=>e.map(Fv).some((t=>r.map(Fv).some((n=>t.includes(n))))),not_icontains:(r,e)=>e.map(Fv).every((t=>r.map(Fv).every((n=>!t.includes(n))))),gt:(r,e)=>e.some((t=>{var n=parseFloat(t);return!isNaN(n)&&r.some((s=>n>parseFloat(s)))})),lt:(r,e)=>e.some((t=>{var n=parseFloat(t);return!isNaN(n)&&r.some((s=>n<parseFloat(s)))}))},Fv=r=>r.toLowerCase();function JR(r,e){return!r||Object.entries(r).every((t=>{var[n,s]=t,i=e==null?void 0:e[n];if(Xe(i)||la(i))return!1;var c=[String(i)],d=YR[s.operator];return!!d&&d(s.values,c)}))}var Yx=_n("[Error tracking]");class fH{constructor(e){var t,n;this.Zt=[],this.ti=new q8([new rz,new dz,new sz,new nz,new cz,new lz,new iz,new uz],tz()),this._instance=e,this.Zt=(t=(n=this._instance.persistence)==null?void 0:n.get_property(rb))!==null&&t!==void 0?t:[]}onRemoteConfig(e){var t,n,s,i=(t=(n=e.errorTracking)==null?void 0:n.suppressionRules)!==null&&t!==void 0?t:[],c=(s=e.errorTracking)==null?void 0:s.captureExtensionExceptions;this.Zt=i,this._instance.persistence&&this._instance.persistence.register({[rb]:this.Zt,[VC]:c})}get ii(){var e,t=!!this._instance.get_property(VC),n=this._instance.config.error_tracking.captureExtensionExceptions;return(e=n??t)!==null&&e!==void 0&&e}buildProperties(e,t){return this.ti.buildFromUnknown(e,{syntheticException:t==null?void 0:t.syntheticException,mechanism:{handled:t==null?void 0:t.handled}})}sendExceptionEvent(e){var t=e.$exception_list;if(this.ei(t)){if(this.ri(t))return void Yx.info("Skipping exception capture because a suppression rule matched");if(!this.ii&&this.si(t))return void Yx.info("Skipping exception capture because it was thrown by an extension");if(!this._instance.config.error_tracking.__capturePostHogExceptions&&this.ni(t))return void Yx.info("Skipping exception capture because it was thrown by the PostHog SDK")}return this._instance.capture("$exception",e,{_noTruncate:!0,_batchKey:"exceptionEvent"})}ri(e){if(e.length===0)return!1;var t=e.reduce(((n,s)=>{var{type:i,value:c}=s;return Kn(i)&&i.length>0&&n.$exception_types.push(i),Kn(c)&&c.length>0&&n.$exception_values.push(c),n}),{$exception_types:[],$exception_values:[]});return this.Zt.some((n=>{var s=n.values.map((i=>{var c,d=YR[i.operator],p=$r(i.value)?i.value:[i.value],m=(c=t[i.key])!==null&&c!==void 0?c:[];return p.length>0&&d(p,m)}));return n.type==="OR"?s.some(Boolean):s.every(Boolean)}))}si(e){return e.flatMap((t=>{var n,s;return(n=(s=t.stacktrace)==null?void 0:s.frames)!==null&&n!==void 0?n:[]})).some((t=>t.filename&&t.filename.startsWith("chrome-extension://")))}ni(e){if(e.length>0){var t,n,s,i,c=(t=(n=e[0].stacktrace)==null?void 0:n.frames)!==null&&t!==void 0?t:[],d=c[c.length-1];return(s=d==null||(i=d.filename)==null?void 0:i.includes("posthog.com/static"))!==null&&s!==void 0&&s}return!1}ei(e){return!xr(e)&&$r(e)}}var ti=_n("[FeatureFlags]"),Zp=_n("[FeatureFlags]",{debugEnabled:!0}),Jx="$active_feature_flags",Hf="$override_feature_flags",vk="$feature_flag_payloads",em="$override_feature_flag_payloads",yk="$feature_flag_request_id",xk="$feature_flag_evaluated_at",wk=r=>{var e={};for(var[t,n]of ey(r||{}))n&&(e[t]=n);return e},hH=r=>{var e=r.flags;return e?(r.featureFlags=Object.fromEntries(Object.keys(e).map((t=>{var n;return[t,(n=e[t].variant)!==null&&n!==void 0?n:e[t].enabled]}))),r.featureFlagPayloads=Object.fromEntries(Object.keys(e).filter((t=>e[t].enabled)).filter((t=>{var n;return(n=e[t].metadata)==null?void 0:n.payload})).map((t=>{var n;return[t,(n=e[t].metadata)==null?void 0:n.payload]})))):ti.warn("Using an older version of the feature flags endpoint. Please upgrade your PostHog server to the latest version"),r},pH=(function(r){return r.FeatureFlags="feature_flags",r.Recordings="recordings",r})({});class mH{constructor(e){this.oi=!1,this.ai=!1,this.li=!1,this.ui=!1,this.hi=!1,this.di=!1,this.vi=!1,this.ci=!1,this._instance=e,this.featureFlagEventHandlers=[]}fi(){var e,t=(e=this._instance.config.evaluation_contexts)!==null&&e!==void 0?e:this._instance.config.evaluation_environments;return!this._instance.config.evaluation_environments||this._instance.config.evaluation_contexts||this.ci||(ti.warn("evaluation_environments is deprecated. Use evaluation_contexts instead. evaluation_environments will be removed in a future version."),this.ci=!0),t!=null&&t.length?t.filter((n=>{var s=n&&typeof n=="string"&&n.trim().length>0;return s||ti.error("Invalid evaluation context found:",n,"Expected non-empty string"),s})):[]}pi(){return this.fi().length>0}flags(){if(this._instance.config.__preview_remote_config)this.di=!0;else{var e=!this.gi&&(this._instance.config.advanced_disable_feature_flags||this._instance.config.advanced_disable_feature_flags_on_first_load);this.mi({disableFlags:e})}}get hasLoadedFlags(){return this.ai}getFlags(){return Object.keys(this.getFlagVariants())}getFlagsWithDetails(){var e=this._instance.get_property(nb),t=this._instance.get_property(Hf),n=this._instance.get_property(em);if(!n&&!t)return e||{};var s=Rn({},e||{}),i=[...new Set([...Object.keys(n||{}),...Object.keys(t||{})])];for(var c of i){var d,p,m=s[c],g=t==null?void 0:t[c],x=Xe(g)?(d=m==null?void 0:m.enabled)!==null&&d!==void 0&&d:!!g,b=Xe(g)?m.variant:typeof g=="string"?g:void 0,S=n==null?void 0:n[c],T=rt({},m,{enabled:x,variant:x?b??(m==null?void 0:m.variant):void 0});x!==(m==null?void 0:m.enabled)&&(T.original_enabled=m==null?void 0:m.enabled),b!==(m==null?void 0:m.variant)&&(T.original_variant=m==null?void 0:m.variant),S&&(T.metadata=rt({},m==null?void 0:m.metadata,{payload:S,original_payload:m==null||(p=m.metadata)==null?void 0:p.payload})),s[c]=T}return this.oi||(ti.warn(" Overriding feature flag details!",{flagDetails:e,overriddenPayloads:n,finalDetails:s}),this.oi=!0),s}getFlagVariants(){var e=this._instance.get_property(eh),t=this._instance.get_property(Hf);if(!t)return e||{};for(var n=Rn({},e),s=Object.keys(t),i=0;i<s.length;i++)n[s[i]]=t[s[i]];return this.oi||(ti.warn(" Overriding feature flags!",{enabledFlags:e,overriddenFlags:t,finalFlags:n}),this.oi=!0),n}getFlagPayloads(){var e=this._instance.get_property(vk),t=this._instance.get_property(em);if(!t)return e||{};for(var n=Rn({},e||{}),s=Object.keys(t),i=0;i<s.length;i++)n[s[i]]=t[s[i]];return this.oi||(ti.warn(" Overriding feature flag payloads!",{flagPayloads:e,overriddenPayloads:t,finalPayloads:n}),this.oi=!0),n}reloadFeatureFlags(){this.ui||this._instance.config.advanced_disable_feature_flags||this.gi||(this._instance.bi.emit("featureFlagsReloading",!0),this.gi=setTimeout((()=>{this.mi()}),5))}yi(){clearTimeout(this.gi),this.gi=void 0}ensureFlagsLoaded(){this.ai||this.li||this.gi||this.reloadFeatureFlags()}setAnonymousDistinctId(e){this.$anon_distinct_id=e}setReloadingPaused(e){this.ui=e}mi(e){var t;if(this.yi(),!this._instance.M())if(this.li)this.hi=!0;else{var n=this._instance.config.token,s=this._instance.get_property("$device_id"),i={token:n,distinct_id:this._instance.get_distinct_id(),groups:this._instance.getGroups(),$anon_distinct_id:this.$anon_distinct_id,person_properties:rt({},((t=this._instance.persistence)==null?void 0:t.get_initial_props())||{},this._instance.get_property(vm)||{}),group_properties:this._instance.get_property(rd)};la(s)||Xe(s)||(i.$device_id=s),(e!=null&&e.disableFlags||this._instance.config.advanced_disable_feature_flags)&&(i.disable_flags=!0),this.pi()&&(i.evaluation_contexts=this.fi());var c=this._instance.config.__preview_remote_config,d=c?"/flags/?v=2":"/flags/?v=2&config=true",p=this._instance.config.advanced_only_evaluate_survey_feature_flags?"&only_evaluate_survey_feature_flags=true":"",m=this._instance.requestRouter.endpointFor("flags",d+p);c&&(i.timezone=BR()),this.li=!0,this._instance._send_request({method:"POST",url:m,data:i,compression:this._instance.config.disable_compression?void 0:zl.Base64,timeout:this._instance.config.feature_flag_request_timeout_ms,callback:g=>{var x,b,S=!0;if(g.statusCode===200&&(this.hi||(this.$anon_distinct_id=void 0),S=!1),this.li=!1,this.di||(this.di=!0,this._instance.wi((b=g.json)!==null&&b!==void 0?b:{})),!i.disable_flags||this.hi)if(this.vi=!S,g.json&&(x=g.json.quotaLimited)!=null&&x.includes(pH.FeatureFlags))ti.warn("You have hit your feature flags quota limit, and will not be able to load feature flags until the quota is reset.  Please visit https://posthog.com/docs/billing/limits-alerts to learn more.");else{var T;i.disable_flags||this.receivedFeatureFlags((T=g.json)!==null&&T!==void 0?T:{},S),this.hi&&(this.hi=!1,this.mi())}}})}}getFeatureFlag(e,t){var n;if(t===void 0&&(t={}),this.ai||this.getFlags()&&this.getFlags().length>0){var s=this.getFeatureFlagResult(e,t);return(n=s==null?void 0:s.variant)!==null&&n!==void 0?n:s==null?void 0:s.enabled}ti.warn('getFeatureFlag for key "'+e+`" failed. Feature flags didn't load in time.`)}getFeatureFlagDetails(e){return this.getFlagsWithDetails()[e]}getFeatureFlagPayload(e){var t=this.getFeatureFlagResult(e,{send_event:!1});return t==null?void 0:t.payload}getFeatureFlagResult(e,t){if(t===void 0&&(t={}),this.ai||this.getFlags()&&this.getFlags().length>0){var n=this.getFlagVariants(),s=e in n,i=n[e],c=this.getFlagPayloads()[e],d=String(i),p=this._instance.get_property(yk)||void 0,m=this._instance.get_property(xk)||void 0,g=this._instance.get_property(xy)||{};if((t.send_event||!("send_event"in t))&&(!(e in g)||!g[e].includes(d))){var x,b,S,T,E,C,R,A,F;$r(g[e])?g[e].push(d):g[e]=[d],(x=this._instance.persistence)==null||x.register({[xy]:g});var P=this.getFeatureFlagDetails(e),L={$feature_flag:e,$feature_flag_response:i,$feature_flag_payload:c||null,$feature_flag_request_id:p,$feature_flag_evaluated_at:m,$feature_flag_bootstrapped_response:((b=this._instance.config.bootstrap)==null||(b=b.featureFlags)==null?void 0:b[e])||null,$feature_flag_bootstrapped_payload:((S=this._instance.config.bootstrap)==null||(S=S.featureFlagPayloads)==null?void 0:S[e])||null,$used_bootstrap_value:!this.vi};Xe(P==null||(T=P.metadata)==null?void 0:T.version)||(L.$feature_flag_version=P.metadata.version);var G,U=(E=P==null||(C=P.reason)==null?void 0:C.description)!==null&&E!==void 0?E:P==null||(R=P.reason)==null?void 0:R.code;U&&(L.$feature_flag_reason=U),P!=null&&(A=P.metadata)!=null&&A.id&&(L.$feature_flag_id=P.metadata.id),Xe(P==null?void 0:P.original_variant)&&Xe(P==null?void 0:P.original_enabled)||(L.$feature_flag_original_response=Xe(P.original_variant)?P.original_enabled:P.original_variant),P!=null&&(F=P.metadata)!=null&&F.original_payload&&(L.$feature_flag_original_payload=P==null||(G=P.metadata)==null?void 0:G.original_payload),this._instance.capture("$feature_flag_called",L)}if(s){var V=c;if(!Xe(c))try{V=JSON.parse(c)}catch{}return{key:e,enabled:!!i,variant:typeof i=="string"?i:void 0,payload:V}}}else ti.warn('getFeatureFlagResult for key "'+e+`" failed. Feature flags didn't load in time.`)}getRemoteConfigPayload(e,t){var n=this._instance.config.token,s={distinct_id:this._instance.get_distinct_id(),token:n};this.pi()&&(s.evaluation_contexts=this.fi()),this._instance._send_request({method:"POST",url:this._instance.requestRouter.endpointFor("flags","/flags/?v=2&config=true"),data:s,compression:this._instance.config.disable_compression?void 0:zl.Base64,timeout:this._instance.config.feature_flag_request_timeout_ms,callback:i=>{var c,d=(c=i.json)==null?void 0:c.featureFlagPayloads;t((d==null?void 0:d[e])||void 0)}})}isFeatureEnabled(e,t){if(t===void 0&&(t={}),this.ai||this.getFlags()&&this.getFlags().length>0){var n=this.getFeatureFlag(e,t);return Xe(n)?void 0:!!n}ti.warn('isFeatureEnabled for key "'+e+`" failed. Feature flags didn't load in time.`)}addFeatureFlagsHandler(e){this.featureFlagEventHandlers.push(e)}removeFeatureFlagsHandler(e){this.featureFlagEventHandlers=this.featureFlagEventHandlers.filter((t=>t!==e))}receivedFeatureFlags(e,t){if(this._instance.persistence){this.ai=!0;var n=this.getFlagVariants(),s=this.getFlagPayloads(),i=this.getFlagsWithDetails();(function(c,d,p,m,g){p===void 0&&(p={}),m===void 0&&(m={}),g===void 0&&(g={});var x=hH(c),b=x.flags,S=x.featureFlags,T=x.featureFlagPayloads;if(S){var E=c.requestId,C=c.evaluatedAt;if($r(S)){ti.warn("v1 of the feature flags endpoint is deprecated. Please use the latest version.");var R={};if(S)for(var A=0;A<S.length;A++)R[S[A]]=!0;d&&d.register({[Jx]:S,[eh]:R})}else{var F=S,P=T,L=b;if(c.errorsWhileComputingFlags)if(b){var G=new Set(Object.keys(b).filter((U=>{var V;return!((V=b[U])!=null&&V.failed)})));F=rt({},p,Object.fromEntries(Object.entries(F).filter((U=>{var[V]=U;return G.has(V)})))),P=rt({},m,Object.fromEntries(Object.entries(P||{}).filter((U=>{var[V]=U;return G.has(V)})))),L=rt({},g,Object.fromEntries(Object.entries(L||{}).filter((U=>{var[V]=U;return G.has(V)}))))}else F=rt({},p,F),P=rt({},m,P),L=rt({},g,L);d&&d.register(rt({[Jx]:Object.keys(wk(F)),[eh]:F||{},[vk]:P||{},[nb]:L||{}},E?{[yk]:E}:{},C?{[xk]:C}:{}))}}})(e,this._instance.persistence,n,s,i),this.xi(t)}}override(e,t){t===void 0&&(t=!1),ti.warn("override is deprecated. Please use overrideFeatureFlags instead."),this.overrideFeatureFlags({flags:e,suppressWarning:t})}overrideFeatureFlags(e){if(!this._instance.__loaded||!this._instance.persistence)return ti.uninitializedWarning("posthog.featureFlags.overrideFeatureFlags");if(e===!1)return this._instance.persistence.unregister(Hf),this._instance.persistence.unregister(em),this.xi(),Zp.info("All overrides cleared");if(e&&typeof e=="object"&&("flags"in e||"payloads"in e)){var t,n=e;if(this.oi=!!((t=n.suppressWarning)!==null&&t!==void 0&&t),"flags"in n){if(n.flags===!1)this._instance.persistence.unregister(Hf),Zp.info("Flag overrides cleared");else if(n.flags){if($r(n.flags)){for(var s={},i=0;i<n.flags.length;i++)s[n.flags[i]]=!0;this._instance.persistence.register({[Hf]:s})}else this._instance.persistence.register({[Hf]:n.flags});Zp.info("Flag overrides set",{flags:n.flags})}}return"payloads"in n&&(n.payloads===!1?(this._instance.persistence.unregister(em),Zp.info("Payload overrides cleared")):n.payloads&&(this._instance.persistence.register({[em]:n.payloads}),Zp.info("Payload overrides set",{payloads:n.payloads}))),void this.xi()}this.xi()}onFeatureFlags(e){if(this.addFeatureFlagsHandler(e),this.ai){var{flags:t,flagVariants:n}=this.Ei();e(t,n)}return()=>this.removeFeatureFlagsHandler(e)}updateEarlyAccessFeatureEnrollment(e,t,n){var s,i=(this._instance.get_property(gm)||[]).find((m=>m.flagKey===e)),c={["$feature_enrollment/"+e]:t},d={$feature_flag:e,$feature_enrollment:t,$set:c};i&&(d.$early_access_feature_name=i.name),n&&(d.$feature_enrollment_stage=n),this._instance.capture("$feature_enrollment_update",d),this.setPersonPropertiesForFlags(c,!1);var p=rt({},this.getFlagVariants(),{[e]:t});(s=this._instance.persistence)==null||s.register({[Jx]:Object.keys(wk(p)),[eh]:p}),this.xi()}getEarlyAccessFeatures(e,t,n){t===void 0&&(t=!1);var s=this._instance.get_property(gm),i=n?"&"+n.map((c=>"stage="+c)).join("&"):"";if(s&&!t)return e(s);this._instance._send_request({url:this._instance.requestRouter.endpointFor("api","/api/early_access_features/?token="+this._instance.config.token+i),method:"GET",callback:c=>{var d,p;if(c.json){var m=c.json.earlyAccessFeatures;return(d=this._instance.persistence)==null||d.unregister(gm),(p=this._instance.persistence)==null||p.register({[gm]:m}),e(m)}}})}Ei(){var e=this.getFlags(),t=this.getFlagVariants();return{flags:e.filter((n=>t[n])),flagVariants:Object.keys(t).filter((n=>t[n])).reduce(((n,s)=>(n[s]=t[s],n)),{})}}xi(e){var{flags:t,flagVariants:n}=this.Ei();this.featureFlagEventHandlers.forEach((s=>s(t,n,{errorsLoading:e})))}setPersonPropertiesForFlags(e,t){t===void 0&&(t=!0);var n=this._instance.get_property(vm)||{};this._instance.register({[vm]:rt({},n,e)}),t&&this._instance.reloadFeatureFlags()}resetPersonPropertiesForFlags(){this._instance.unregister(vm)}setGroupPropertiesForFlags(e,t){t===void 0&&(t=!0);var n=this._instance.get_property(rd)||{};Object.keys(n).length!==0&&Object.keys(n).forEach((s=>{n[s]=rt({},n[s],e[s]),delete e[s]})),this._instance.register({[rd]:rt({},n,e)}),t&&this._instance.reloadFeatureFlags()}resetGroupPropertiesForFlags(e){if(e){var t=this._instance.get_property(rd)||{};this._instance.register({[rd]:rt({},t,{[e]:{}})})}else this._instance.unregister(rd)}reset(){this.ai=!1,this.li=!1,this.ui=!1,this.hi=!1,this.di=!1,this.vi=!1,this.$anon_distinct_id=void 0,this.yi(),this.oi=!1}}var gH=["cookie","localstorage","localstorage+cookie","sessionstorage","memory"];class Xx{constructor(e,t){this.R=e,this.props={},this.$i=!1,this.Si=(n=>{var s="";return n.token&&(s=n.token.replace(/\+/g,"PL").replace(/\//g,"SL").replace(/=/g,"EQ")),n.persistence_name?"ph_"+n.persistence_name:"ph_"+s+"_posthog"})(e),this.Y=this.ki(e),this.load(),e.debug&&et.info("Persistence loaded",e.persistence,rt({},this.props)),this.update_config(e,e,t),this.save()}isDisabled(){return!!this.Pi}ki(e){gH.indexOf(e.persistence.toLowerCase())===-1&&(et.critical("Unknown persistence type "+e.persistence+"; falling back to localStorage+cookie"),e.persistence="localStorage+cookie");var t=(function(s){s===void 0&&(s=[]);var i=[...Lz,...s];return rt({},gn,{W:function(c){try{var d={};try{d=za.W(c)||{}}catch{}var p=Rn(d,JSON.parse(gn.q(c)||"{}"));return gn.G(c,p),p}catch{}return null},G:function(c,d,p,m,g,x){try{gn.G(c,d,void 0,void 0,x);var b={};i.forEach((S=>{d[S]&&(b[S]=d[S])})),Object.keys(b).length&&za.G(c,b,p,m,g,x)}catch(S){gn.B(S)}},V:function(c,d){try{Ee==null||Ee.localStorage.removeItem(c),za.V(c,d)}catch(p){gn.B(p)}}})})(e.cookie_persisted_properties||[]),n=e.persistence.toLowerCase();return n==="localstorage"&&gn.H()?gn:n==="localstorage+cookie"&&t.H()?t:n==="sessionstorage"&&xs.H()?xs:n==="memory"?Mz:n==="cookie"?za:t.H()?t:za}properties(){var e={};return tn(this.props,(function(t,n){if(n===eh&&qn(t))for(var s=Object.keys(t),i=0;i<s.length;i++)e["$feature/"+s[i]]=t[s[i]];else d=n,p=!1,(la(c=vz)?p:PC&&c.indexOf===PC?c.indexOf(d)!=-1:(tn(c,(function(m){if(p||(p=m===d))return vy})),p))||(e[n]=t);var c,d,p})),e}load(){if(!this.Pi){var e=this.Y.W(this.Si);e&&(this.props=Rn({},e))}}save(){this.Pi||this.Y.G(this.Si,this.props,this.Ti,this.Ii,this.Ci,this.R.debug)}remove(){this.Y.V(this.Si,!1),this.Y.V(this.Si,!0)}clear(){this.remove(),this.props={}}register_once(e,t,n){if(qn(e)){Xe(t)&&(t="None"),this.Ti=Xe(n)?this.Ri:n;var s=!1;if(tn(e,((i,c)=>{this.props.hasOwnProperty(c)&&this.props[c]!==t||(this.props[c]=i,s=!0)})),s)return this.save(),!0}return!1}register(e,t){if(qn(e)){this.Ti=Xe(t)?this.Ri:t;var n=!1;if(tn(e,((s,i)=>{e.hasOwnProperty(i)&&this.props[i]!==s&&(this.props[i]=s,n=!0)})),n)return this.save(),!0}return!1}unregister(e){e in this.props&&(delete this.props[e],this.save())}update_campaign_params(){if(!this.$i){var e=LR(this.R.custom_campaign_params,this.R.mask_personal_data_properties,this.R.custom_personal_data_properties);Zf(iS(e))||this.register(e),this.$i=!0}}update_search_keyword(){var e;this.register((e=Je==null?void 0:Je.referrer)?$R(e):{})}update_referrer_info(){var e;this.register_once({$referrer:UR(),$referring_domain:Je!=null&&Je.referrer&&((e=Sy(Je.referrer))==null?void 0:e.host)||"$direct"},void 0)}set_initial_person_info(){this.props[ab]||this.props[lb]||this.register_once({[wy]:zR(this.R.mask_personal_data_properties,this.R.custom_personal_data_properties)},void 0)}get_initial_props(){var e={};tn([lb,ab],(c=>{var d=this.props[c];d&&tn(d,(function(p,m){e["$initial_"+Kw(m)]=p}))}));var t,n,s=this.props[wy];if(s){var i=(t=HR(s),n={},tn(t,(function(c,d){n["$initial_"+Kw(d)]=c})),n);Rn(e,i)}return e}safe_merge(e){return tn(this.props,(function(t,n){n in e||(e[n]=t)})),e}update_config(e,t,n){if(this.Ri=this.Ti=e.cookie_expiration,this.set_disabled(e.disable_persistence||!!n),this.set_cross_subdomain(e.cross_subdomain_cookie),this.set_secure(e.secure_cookie),e.persistence!==t.persistence||!((c,d)=>{if(c.length!==d.length)return!1;var p=[...c].sort(),m=[...d].sort();return p.every(((g,x)=>g===m[x]))})(e.cookie_persisted_properties||[],t.cookie_persisted_properties||[])){var s=this.ki(e),i=this.props;this.clear(),this.Y=s,this.props=i,this.save()}}set_disabled(e){this.Pi=e,this.Pi?this.remove():this.save()}set_cross_subdomain(e){e!==this.Ii&&(this.Ii=e,this.remove(),this.save())}set_secure(e){e!==this.Ci&&(this.Ci=e,this.remove(),this.save())}set_event_timer(e,t){var n=this.props[mm]||{};n[e]=t,this.props[mm]=n,this.save()}remove_event_timer(e){var t=(this.props[mm]||{})[e];return Xe(t)||(delete this.props[mm][e],this.save()),t}get_property(e){return this.props[e]}set_property(e,t){this.props[e]=t,this.save()}}var bk=_n("[Product Tours]"),Qx="ph_product_tours";class vH{constructor(e){this.Fi=null,this.Oi=null,this._instance=e}onRemoteConfig(e){this._instance.persistence&&this._instance.persistence.register({[KC]:!(e==null||!e.productTours)}),this.loadIfEnabled()}loadIfEnabled(){var e,t;this.Fi||(e=this._instance).config.disable_product_tours||(t=e.persistence)==null||!t.get_property(KC)||this.it((()=>this.Mi()))}it(e){var t,n;(t=Nt.__PosthogExtensions__)!=null&&t.generateProductTours?e():(n=Nt.__PosthogExtensions__)==null||n.loadExternalDependency==null||n.loadExternalDependency(this._instance,"product-tours",(s=>{s?bk.error("Could not load product tours script",s):e()}))}Mi(){var e;!this.Fi&&(e=Nt.__PosthogExtensions__)!=null&&e.generateProductTours&&(this.Fi=Nt.__PosthogExtensions__.generateProductTours(this._instance,!0))}getProductTours(e,t){if(t===void 0&&(t=!1),!$r(this.Oi)||t){var n=this._instance.persistence;if(n){var s=n.props[Qx];if($r(s)&&!t)return this.Oi=s,void e(s,{isLoaded:!0})}this._instance._send_request({url:this._instance.requestRouter.endpointFor("api","/api/product_tours/?token="+this._instance.config.token),method:"GET",callback:i=>{var c=i.statusCode;if(c!==200||!i.json){var d="Product Tours API could not be loaded, status: "+c;return bk.error(d),void e([],{isLoaded:!1,error:d})}var p=$r(i.json.product_tours)?i.json.product_tours:[];this.Oi=p,n&&n.register({[Qx]:p}),e(p,{isLoaded:!0})}})}else e(this.Oi,{isLoaded:!0})}getActiveProductTours(e){xr(this.Fi)?e([],{isLoaded:!1,error:"Product tours not loaded"}):this.Fi.getActiveProductTours(e)}showProductTour(e){var t;(t=this.Fi)==null||t.showTourById(e)}previewTour(e){this.Fi?this.Fi.previewTour(e):this.it((()=>{var t;this.Mi(),(t=this.Fi)==null||t.previewTour(e)}))}dismissProductTour(){var e;(e=this.Fi)==null||e.dismissTour("user_clicked_skip")}nextStep(){var e;(e=this.Fi)==null||e.nextStep()}previousStep(){var e;(e=this.Fi)==null||e.previousStep()}clearCache(){var e;this.Oi=null,(e=this._instance.persistence)==null||e.unregister(Qx)}resetTour(e){var t;(t=this.Fi)==null||t.resetTour(e)}resetAllTours(){var e;(e=this.Fi)==null||e.resetAllTours()}cancelPendingTour(e){var t;(t=this.Fi)==null||t.cancelPendingTour(e)}}var tm=(function(r){return r.Activation="events",r.Cancellation="cancelEvents",r})({});(function(r){return r.Button="button",r.Tab="tab",r.Selector="selector",r})({});(function(r){return r.TopLeft="top_left",r.TopRight="top_right",r.TopCenter="top_center",r.MiddleLeft="middle_left",r.MiddleRight="middle_right",r.MiddleCenter="middle_center",r.Left="left",r.Center="center",r.Right="right",r.NextToTrigger="next_to_trigger",r})({});(function(r){return r.Top="top",r.Left="left",r.Right="right",r.Bottom="bottom",r})({});var Zx=(function(r){return r.Popover="popover",r.API="api",r.Widget="widget",r.ExternalSurvey="external_survey",r})({});(function(r){return r.Open="open",r.MultipleChoice="multiple_choice",r.SingleChoice="single_choice",r.Rating="rating",r.Link="link",r})({});(function(r){return r.NextQuestion="next_question",r.End="end",r.ResponseBased="response_based",r.SpecificQuestion="specific_question",r})({});(function(r){return r.Once="once",r.Recurring="recurring",r.Always="always",r})({});var xm=(function(r){return r.SHOWN="survey shown",r.DISMISSED="survey dismissed",r.SENT="survey sent",r.ABANDONED="survey abandoned",r})({}),ew=(function(r){return r.SURVEY_ID="$survey_id",r.SURVEY_NAME="$survey_name",r.SURVEY_RESPONSE="$survey_response",r.SURVEY_ITERATION="$survey_iteration",r.SURVEY_ITERATION_START_DATE="$survey_iteration_start_date",r.SURVEY_PARTIALLY_COMPLETED="$survey_partially_completed",r.SURVEY_SUBMISSION_ID="$survey_submission_id",r.SURVEY_QUESTIONS="$survey_questions",r.SURVEY_COMPLETED="$survey_completed",r.PRODUCT_TOUR_ID="$product_tour_id",r.SURVEY_LAST_SEEN_DATE="$survey_last_seen_date",r})({}),hb=(function(r){return r.Popover="popover",r.Inline="inline",r})({}),Xr=_n("[Surveys]"),XR="seenSurvey_",yH=(r,e)=>{var t="$survey_"+e+"/"+r.id;return r.current_iteration&&r.current_iteration>0&&(t="$survey_"+e+"/"+r.id+"/"+r.current_iteration),t},_k=r=>((e,t)=>{var n=""+e+t.id;return t.current_iteration&&t.current_iteration>0&&(n=""+e+t.id+"_"+t.current_iteration),n})(XR,r),xH=[Zx.Popover,Zx.Widget,Zx.API],wH={ignoreConditions:!1,ignoreDelay:!1,displayType:hb.Popover};class fS{constructor(){this.Ai={},this.Ai={}}on(e,t){return this.Ai[e]||(this.Ai[e]=[]),this.Ai[e].push(t),()=>{this.Ai[e]=this.Ai[e].filter((n=>n!==t))}}emit(e,t){for(var n of this.Ai[e]||[])n(t);for(var s of this.Ai["*"]||[])s(e,t)}}function Bf(r,e,t){if(xr(r))return!1;switch(t){case"exact":return r===e;case"contains":var n=e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/_/g,".").replace(/%/g,".*");return new RegExp(n,"i").test(r);case"regex":try{return new RegExp(e).test(r)}catch{return!1}default:return!1}}class bH{constructor(e){this.ji=new fS,this.Di=(t,n)=>this.Li(t,n)&&this.Ni(t,n)&&this.Ui(t,n)&&this.zi(t,n),this.Li=(t,n)=>n==null||!n.event||(t==null?void 0:t.event)===(n==null?void 0:n.event),this._instance=e,this.Hi=new Set,this.Bi=new Set}init(){var e;if(!Xe((e=this._instance)==null?void 0:e._addCaptureHook)){var t;(t=this._instance)==null||t._addCaptureHook(((n,s)=>{this.on(n,s)}))}}register(e){var t,n;if(!Xe((t=this._instance)==null?void 0:t._addCaptureHook)&&(e.forEach((c=>{var d,p;(d=this.Bi)==null||d.add(c),(p=c.steps)==null||p.forEach((m=>{var g;(g=this.Hi)==null||g.add((m==null?void 0:m.event)||"")}))})),(n=this._instance)!=null&&n.autocapture)){var s,i=new Set;e.forEach((c=>{var d;(d=c.steps)==null||d.forEach((p=>{p!=null&&p.selector&&i.add(p==null?void 0:p.selector)}))})),(s=this._instance)==null||s.autocapture.setElementSelectors(i)}}on(e,t){var n;t!=null&&e.length!=0&&(this.Hi.has(e)||this.Hi.has(t==null?void 0:t.event))&&this.Bi&&((n=this.Bi)==null?void 0:n.size)>0&&this.Bi.forEach((s=>{this.qi(t,s)&&this.ji.emit("actionCaptured",s.name)}))}Wi(e){this.onAction("actionCaptured",(t=>e(t)))}qi(e,t){if((t==null?void 0:t.steps)==null)return!1;for(var n of t.steps)if(this.Di(e,n))return!0;return!1}onAction(e,t){return this.ji.on(e,t)}Ni(e,t){if(t!=null&&t.url){var n,s=e==null||(n=e.properties)==null?void 0:n.$current_url;if(!s||typeof s!="string"||!Bf(s,t.url,t.url_matching||"contains"))return!1}return!0}Ui(e,t){return!!this.Gi(e,t)&&!!this.Vi(e,t)&&!!this.Ji(e,t)}Gi(e,t){var n;if(t==null||!t.href)return!0;var s=this.Ki(e);if(s.length>0)return s.some((d=>Bf(d.href,t.href,t.href_matching||"exact")));var i,c=(e==null||(n=e.properties)==null?void 0:n.$elements_chain)||"";return!!c&&Bf((i=c.match(/(?::|")href="(.*?)"/))?i[1]:"",t.href,t.href_matching||"exact")}Vi(e,t){var n;if(t==null||!t.text)return!0;var s=this.Ki(e);if(s.length>0)return s.some((m=>Bf(m.text,t.text,t.text_matching||"exact")||Bf(m.$el_text,t.text,t.text_matching||"exact")));var i,c,d,p=(e==null||(n=e.properties)==null?void 0:n.$elements_chain)||"";return!!p&&(i=(function(m){for(var g,x=[],b=/(?::|")text="(.*?)"/g;!xr(g=b.exec(m));)x.includes(g[1])||x.push(g[1]);return x})(p),c=t.text,d=t.text_matching||"exact",i.some((m=>Bf(m,c,d))))}Ji(e,t){var n,s;if(t==null||!t.selector)return!0;var i=e==null||(n=e.properties)==null?void 0:n.$element_selectors;if(i!=null&&i.includes(t.selector))return!0;var c=(e==null||(s=e.properties)==null?void 0:s.$elements_chain)||"";if(t.selector_regex&&c)try{return new RegExp(t.selector_regex).test(c)}catch{return!1}return!1}Ki(e){var t;return(e==null||(t=e.properties)==null?void 0:t.$elements)==null?[]:e==null?void 0:e.properties.$elements}zi(e,t){return t==null||!t.properties||t.properties.length===0||JR(t.properties.reduce(((n,s)=>{var i=$r(s.value)?s.value.map(String):s.value!=null?[String(s.value)]:[];return n[s.key]={values:i,operator:s.operator||"exact"},n}),{}),e==null?void 0:e.properties)}}class _H{constructor(e){this._instance=e,this.Yi=new Map,this.Xi=new Map,this.Qi=new Map}Zi(e,t){return!!e&&JR(e.propertyFilters,t==null?void 0:t.properties)}te(e,t){var n=new Map;return e.forEach((s=>{var i;(i=s.conditions)==null||(i=i[t])==null||(i=i.values)==null||i.forEach((c=>{if(c!=null&&c.name){var d=n.get(c.name)||[];d.push(s.id),n.set(c.name,d)}}))})),n}ie(e,t,n){var s=(n===tm.Activation?this.Yi:this.Xi).get(e),i=[];return this.ee((c=>{i=c.filter((d=>s==null?void 0:s.includes(d.id)))})),i.filter((c=>{var d,p=(d=c.conditions)==null||(d=d[n])==null||(d=d.values)==null?void 0:d.find((m=>m.name===e));return this.Zi(p,t)}))}register(e){var t;Xe((t=this._instance)==null?void 0:t._addCaptureHook)||(this.re(e),this.se(e))}se(e){var t=e.filter((n=>{var s,i;return((s=n.conditions)==null?void 0:s.actions)&&((i=n.conditions)==null||(i=i.actions)==null||(i=i.values)==null?void 0:i.length)>0}));t.length!==0&&(this.ne==null&&(this.ne=new bH(this._instance),this.ne.init(),this.ne.Wi((n=>{this.onAction(n)}))),t.forEach((n=>{var s,i,c,d,p;n.conditions&&(s=n.conditions)!=null&&s.actions&&(i=n.conditions)!=null&&(i=i.actions)!=null&&i.values&&((c=n.conditions)==null||(c=c.actions)==null||(c=c.values)==null?void 0:c.length)>0&&((d=this.ne)==null||d.register(n.conditions.actions.values),(p=n.conditions)==null||(p=p.actions)==null||(p=p.values)==null||p.forEach((m=>{if(m&&m.name){var g=this.Qi.get(m.name);g&&g.push(n.id),this.Qi.set(m.name,g||[n.id])}})))})))}re(e){var t,n=e.filter((i=>{var c,d;return((c=i.conditions)==null?void 0:c.events)&&((d=i.conditions)==null||(d=d.events)==null||(d=d.values)==null?void 0:d.length)>0})),s=e.filter((i=>{var c,d;return((c=i.conditions)==null?void 0:c.cancelEvents)&&((d=i.conditions)==null||(d=d.cancelEvents)==null||(d=d.values)==null?void 0:d.length)>0}));(n.length!==0||s.length!==0)&&((t=this._instance)==null||t._addCaptureHook(((i,c)=>{this.onEvent(i,c)})),this.Yi=this.te(e,tm.Activation),this.Xi=this.te(e,tm.Cancellation))}onEvent(e,t){var n,s=this.oe(),i=this.ae(),c=this.le(),d=((n=this._instance)==null||(n=n.persistence)==null?void 0:n.props[i])||[];if(c===e&&t&&d.length>0){var p,m;s.info("event matched, removing item from activated items",{event:e,eventPayload:t,existingActivatedItems:d});var g=(t==null||(p=t.properties)==null?void 0:p.$survey_id)||(t==null||(m=t.properties)==null?void 0:m.$product_tour_id);if(g){var x=d.indexOf(g);x>=0&&(d.splice(x,1),this.ue(d))}}else{if(this.Xi.has(e)){var b=this.ie(e,t,tm.Cancellation);b.length>0&&(s.info("cancel event matched, cancelling items",{event:e,itemsToCancel:b.map((T=>T.id))}),b.forEach((T=>{var E=d.indexOf(T.id);E>=0&&d.splice(E,1),this.he(T.id)})),this.ue(d))}if(this.Yi.has(e)){s.info("event name matched",{event:e,eventPayload:t,items:this.Yi.get(e)});var S=this.ie(e,t,tm.Activation);this.ue(d.concat(S.map((T=>T.id))||[]))}}}onAction(e){var t,n=this.ae(),s=((t=this._instance)==null||(t=t.persistence)==null?void 0:t.props[n])||[];this.Qi.has(e)&&this.ue(s.concat(this.Qi.get(e)||[]))}ue(e){var t,n=this.oe(),s=this.ae(),i=[...new Set(e)].filter((c=>!this.de(c)));n.info("updating activated items",{activatedItems:i}),(t=this._instance)==null||(t=t.persistence)==null||t.register({[s]:i})}getActivatedIds(){var e,t=this.ae(),n=(e=this._instance)==null||(e=e.persistence)==null?void 0:e.props[t];return n||[]}getEventToItemsMap(){return this.Yi}ve(){return this.ne}}class SH extends _H{constructor(e){super(e)}ae(){return"$surveys_activated"}le(){return xm.SHOWN}ee(e){var t;(t=this._instance)==null||t.getSurveys(e)}he(e){var t;(t=this._instance)==null||t.cancelPendingSurvey(e)}oe(){return Xr}de(){return!1}getSurveys(){return this.getActivatedIds()}getEventToSurveys(){return this.getEventToItemsMap()}}class EH{constructor(e){this.ce=void 0,this._surveyManager=null,this.fe=!1,this.pe=[],this.ge=null,this._instance=e,this._surveyEventReceiver=null}onRemoteConfig(e){if(!this._instance.config.disable_surveys){var t=e.surveys;if(xr(t))return Xr.warn("Flags not loaded yet. Not loading surveys.");var n=$r(t);this.ce=n?t.length>0:t,Xr.info("flags response received, isSurveysEnabled: "+this.ce),this.loadIfEnabled()}}reset(){localStorage.removeItem("lastSeenSurveyDate");for(var e=[],t=0;t<localStorage.length;t++){var n=localStorage.key(t);(n!=null&&n.startsWith(XR)||n!=null&&n.startsWith("inProgressSurvey_"))&&e.push(n)}e.forEach((s=>localStorage.removeItem(s)))}loadIfEnabled(){if(!this._surveyManager)if(this.fe)Xr.info("Already initializing surveys, skipping...");else if(this._instance.config.disable_surveys)Xr.info("Disabled. Not loading surveys.");else if(this._instance.config.cookieless_mode&&this._instance.consent.isOptedOut())Xr.info("Not loading surveys in cookieless mode without consent.");else{var e=Nt==null?void 0:Nt.__PosthogExtensions__;if(e){if(!Xe(this.ce)||this._instance.config.advanced_enable_surveys){var t=this.ce||this._instance.config.advanced_enable_surveys;this.fe=!0;try{var n=e.generateSurveys;if(n)return void this._e(n,t);var s=e.loadExternalDependency;if(!s)return void this.me("PostHog loadExternalDependency extension not found.");s(this._instance,"surveys",(i=>{i||!e.generateSurveys?this.me("Could not load surveys script",i):this._e(e.generateSurveys,t)}))}catch(i){throw this.me("Error initializing surveys",i),i}finally{this.fe=!1}}}else Xr.error("PostHog Extensions not found.")}}_e(e,t){this._surveyManager=e(this._instance,t),this._surveyEventReceiver=new SH(this._instance),Xr.info("Surveys loaded successfully"),this.be({isLoaded:!0})}me(e,t){Xr.error(e,t),this.be({isLoaded:!1,error:e})}onSurveysLoaded(e){return this.pe.push(e),this._surveyManager&&this.be({isLoaded:!0}),()=>{this.pe=this.pe.filter((t=>t!==e))}}getSurveys(e,t){if(t===void 0&&(t=!1),this._instance.config.disable_surveys)return Xr.info("Disabled. Not loading surveys."),e([]);var n,s=this._instance.get_property(sb);if(s&&!t)return e(s,{isLoaded:!0});typeof Promise<"u"&&this.ge?this.ge.then((i=>{var{surveys:c,context:d}=i;return e(c,d)})):(typeof Promise<"u"&&(this.ge=new Promise((i=>{n=i}))),this._instance._send_request({url:this._instance.requestRouter.endpointFor("api","/api/surveys/?token="+this._instance.config.token),method:"GET",timeout:this._instance.config.surveys_request_timeout_ms,callback:i=>{var c;this.ge=null;var d=i.statusCode;if(d!==200||!i.json){var p="Surveys API could not be loaded, status: "+d;Xr.error(p);var m={isLoaded:!1,error:p};return e([],m),void(n==null||n({surveys:[],context:m}))}var g,x=i.json.surveys||[],b=x.filter((T=>(function(E){return!(!E.start_date||E.end_date)})(T)&&((function(E){var C;return!((C=E.conditions)==null||(C=C.events)==null||(C=C.values)==null||!C.length)})(T)||(function(E){var C;return!((C=E.conditions)==null||(C=C.actions)==null||(C=C.values)==null||!C.length)})(T))));b.length>0&&((g=this._surveyEventReceiver)==null||g.register(b)),(c=this._instance.persistence)==null||c.register({[sb]:x});var S={isLoaded:!0};e(x,S),n==null||n({surveys:x,context:S})}}))}be(e){for(var t of this.pe)try{if(!e.isLoaded)return t([],e);this.getSurveys(t)}catch(n){Xr.error("Error in survey callback",n)}}getActiveMatchingSurveys(e,t){if(t===void 0&&(t=!1),!xr(this._surveyManager))return this._surveyManager.getActiveMatchingSurveys(e,t);Xr.warn("init was not called")}ye(e){var t=null;return this.getSurveys((n=>{var s;t=(s=n.find((i=>i.id===e)))!==null&&s!==void 0?s:null})),t}we(e){if(xr(this._surveyManager))return{eligible:!1,reason:"SDK is not enabled or survey functionality is not yet loaded"};var t=typeof e=="string"?this.ye(e):e;return t?this._surveyManager.checkSurveyEligibility(t):{eligible:!1,reason:"Survey not found"}}canRenderSurvey(e){if(xr(this._surveyManager))return Xr.warn("init was not called"),{visible:!1,disabledReason:"SDK is not enabled or survey functionality is not yet loaded"};var t=this.we(e);return{visible:t.eligible,disabledReason:t.reason}}canRenderSurveyAsync(e,t){return xr(this._surveyManager)?(Xr.warn("init was not called"),Promise.resolve({visible:!1,disabledReason:"SDK is not enabled or survey functionality is not yet loaded"})):new Promise((n=>{this.getSurveys((s=>{var i,c=(i=s.find((p=>p.id===e)))!==null&&i!==void 0?i:null;if(c){var d=this.we(c);n({visible:d.eligible,disabledReason:d.reason})}else n({visible:!1,disabledReason:"Survey not found"})}),t)}))}renderSurvey(e,t,n){var s;if(xr(this._surveyManager))Xr.warn("init was not called");else{var i=typeof e=="string"?this.ye(e):e;if(i!=null&&i.id)if(xH.includes(i.type)){var c=Je==null?void 0:Je.querySelector(t);if(c)return(s=i.appearance)!=null&&s.surveyPopupDelaySeconds?(Xr.info("Rendering survey "+i.id+" with delay of "+i.appearance.surveyPopupDelaySeconds+" seconds"),void setTimeout((()=>{var d,p;Xr.info("Rendering survey "+i.id+" with delay of "+((d=i.appearance)==null?void 0:d.surveyPopupDelaySeconds)+" seconds"),(p=this._surveyManager)==null||p.renderSurvey(i,c,n),Xr.info("Survey "+i.id+" rendered")}),1e3*i.appearance.surveyPopupDelaySeconds)):void this._surveyManager.renderSurvey(i,c,n);Xr.warn("Survey element not found")}else Xr.warn("Surveys of type "+i.type+" cannot be rendered in the app");else Xr.warn("Survey not found")}}displaySurvey(e,t){var n;if(xr(this._surveyManager))Xr.warn("init was not called");else{var s=this.ye(e);if(s){var i=s;if((n=s.appearance)!=null&&n.surveyPopupDelaySeconds&&t.ignoreDelay&&(i=rt({},s,{appearance:rt({},s.appearance,{surveyPopupDelaySeconds:0})})),t.displayType!==hb.Popover&&t.initialResponses&&Xr.warn("initialResponses is only supported for popover surveys. prefill will not be applied."),t.ignoreConditions===!1){var c=this.canRenderSurvey(s);if(!c.visible)return void Xr.warn("Survey is not eligible to be displayed: ",c.disabledReason)}t.displayType!==hb.Inline?this._surveyManager.handlePopoverSurvey(i,t):this.renderSurvey(i,t.selector,t.properties)}else Xr.warn("Survey not found")}}cancelPendingSurvey(e){xr(this._surveyManager)?Xr.warn("init was not called"):this._surveyManager.cancelSurvey(e)}handlePageUnload(){var e;(e=this._surveyManager)==null||e.handlePageUnload()}}var Fl=_n("[Conversations]");class CH{constructor(e){this.xe=void 0,this._conversationsManager=null,this.Ee=!1,this.$e=null,this._instance=e}onRemoteConfig(e){if(!this._instance.config.disable_conversations){var t=e.conversations;xr(t)||(Bl(t)?this.xe=t:(this.xe=t.enabled,this.$e=t),this.loadIfEnabled())}}reset(){var e;(e=this._conversationsManager)==null||e.reset(),this._conversationsManager=null,this.xe=void 0,this.$e=null}loadIfEnabled(){if(!this._conversationsManager&&!this.Ee&&!(this._instance.config.disable_conversations||this._instance.config.cookieless_mode&&this._instance.consent.isOptedOut())){var e=Nt==null?void 0:Nt.__PosthogExtensions__;if(e&&!Xe(this.xe)&&this.xe)if(this.$e&&this.$e.token){this.Ee=!0;try{var t=e.initConversations;if(t)return this.Se(t),void(this.Ee=!1);var n=e.loadExternalDependency;if(!n)return void this.ke("PostHog loadExternalDependency extension not found.");n(this._instance,"conversations",(s=>{s||!e.initConversations?this.ke("Could not load conversations script",s):this.Se(e.initConversations),this.Ee=!1}))}catch(s){this.ke("Error initializing conversations",s),this.Ee=!1}}else Fl.error("Conversations enabled but missing token in remote config.")}}Se(e){if(this.$e)try{this._conversationsManager=e(this.$e,this._instance),Fl.info("Conversations loaded successfully")}catch(t){this.ke("Error completing conversations initialization",t)}else Fl.error("Cannot complete initialization: remote config is null")}ke(e,t){Fl.error(e,t),this._conversationsManager=null,this.Ee=!1}show(){this._conversationsManager?this._conversationsManager.show():Fl.warn("Conversations not loaded yet.")}hide(){this._conversationsManager&&this._conversationsManager.hide()}isAvailable(){return this.xe===!0&&!la(this._conversationsManager)}isVisible(){var e,t;return(e=(t=this._conversationsManager)==null?void 0:t.isVisible())!==null&&e!==void 0&&e}sendMessage(e,t,n){var s=this;return Qf((function*(){return s._conversationsManager?s._conversationsManager.sendMessage(e,t,n):(Fl.warn("Conversations not available yet."),null)}))()}getMessages(e,t){var n=this;return Qf((function*(){return n._conversationsManager?n._conversationsManager.getMessages(e,t):(Fl.warn("Conversations not available yet."),null)}))()}markAsRead(e){var t=this;return Qf((function*(){return t._conversationsManager?t._conversationsManager.markAsRead(e):(Fl.warn("Conversations not available yet."),null)}))()}getTickets(e){var t=this;return Qf((function*(){return t._conversationsManager?t._conversationsManager.getTickets(e):(Fl.warn("Conversations not available yet."),null)}))()}getCurrentTicketId(){var e,t;return(e=(t=this._conversationsManager)==null?void 0:t.getCurrentTicketId())!==null&&e!==void 0?e:null}getWidgetSessionId(){var e,t;return(e=(t=this._conversationsManager)==null?void 0:t.getWidgetSessionId())!==null&&e!==void 0?e:null}}class kH{constructor(e){var t;this.Pe=!1,this.Te=!1,this._instance=e,this._instance&&(t=this._instance.config.logs)!=null&&t.captureConsoleLogs&&(this.Pe=!0)}onRemoteConfig(e){var t,n=(t=e.logs)==null?void 0:t.captureConsoleLogs;!xr(n)&&n&&(this.Pe=!0,this.loadIfEnabled())}reset(){}loadIfEnabled(){if(this.Pe&&!this.Te){var e=_n("[logs]"),t=Nt==null?void 0:Nt.__PosthogExtensions__;if(t){var n=t.loadExternalDependency;n?n(this._instance,"logs",(s=>{var i;s||(i=t.logs)==null||!i.initializeLogs?e.error("Could not load logs script",s):(t.logs.initializeLogs(this._instance),this.Te=!0)})):e.error("PostHog loadExternalDependency extension not found.")}else e.error("PostHog Extensions not found.")}}}var Sk=_n("[RateLimiter]");class NH{constructor(e){this.serverLimits={},this.lastEventRateLimited=!1,this.checkForLimiting=t=>{var n=t.text;if(n&&n.length)try{(JSON.parse(n).quota_limited||[]).forEach((s=>{Sk.info((s||"events")+" is quota limited."),this.serverLimits[s]=new Date().getTime()+6e4}))}catch(s){return void Sk.warn('could not rate limit - continuing. Error: "'+(s==null?void 0:s.message)+'"',{text:n})}},this.instance=e,this.lastEventRateLimited=this.clientRateLimitContext(!0).isRateLimited}get captureEventsPerSecond(){var e;return((e=this.instance.config.rate_limiting)==null?void 0:e.events_per_second)||10}get captureEventsBurstLimit(){var e;return Math.max(((e=this.instance.config.rate_limiting)==null?void 0:e.events_burst_limit)||10*this.captureEventsPerSecond,this.captureEventsPerSecond)}clientRateLimitContext(e){var t,n,s;e===void 0&&(e=!1);var{captureEventsBurstLimit:i,captureEventsPerSecond:c}=this,d=new Date().getTime(),p=(t=(n=this.instance.persistence)==null?void 0:n.get_property(ib))!==null&&t!==void 0?t:{tokens:i,last:d};p.tokens+=(d-p.last)/1e3*c,p.last=d,p.tokens>i&&(p.tokens=i);var m=p.tokens<1;return m||e||(p.tokens=Math.max(0,p.tokens-1)),!m||this.lastEventRateLimited||e||this.instance.capture("$$client_ingestion_warning",{$$client_ingestion_warning_message:"posthog-js client rate limited. Config is set to "+c+" events per second and "+i+" events burst limit."},{skip_client_rate_limiting:!0}),this.lastEventRateLimited=m,(s=this.instance.persistence)==null||s.set_property(ib,p),{isRateLimited:m,remainingTokens:p.tokens}}isServerRateLimited(e){var t=this.serverLimits[e||"events"]||!1;return t!==!1&&new Date().getTime()<t}}var Zu=_n("[RemoteConfig]");class TH{constructor(e){this._instance=e}get remoteConfig(){var e;return(e=Nt._POSTHOG_REMOTE_CONFIG)==null||(e=e[this._instance.config.token])==null?void 0:e.config}Ie(e){var t,n;(t=Nt.__PosthogExtensions__)!=null&&t.loadExternalDependency?(n=Nt.__PosthogExtensions__)==null||n.loadExternalDependency==null||n.loadExternalDependency(this._instance,"remote-config",(()=>e(this.remoteConfig))):(Zu.error("PostHog Extensions not found. Cannot load remote config."),e())}Ce(e){this._instance._send_request({method:"GET",url:this._instance.requestRouter.endpointFor("assets","/array/"+this._instance.config.token+"/config"),callback:t=>{e(t.json)}})}load(){try{if(this.remoteConfig)return Zu.info("Using preloaded remote config",this.remoteConfig),void this.wi(this.remoteConfig);if(this._instance.M())return void Zu.warn("Remote config is disabled. Falling back to local config.");this.Ie((e=>{if(!e)return Zu.info("No config found after loading remote JS config. Falling back to JSON."),void this.Ce((t=>{this.wi(t)}));this.wi(e)}))}catch(e){Zu.error("Error loading remote config",e)}}wi(e){e?this._instance.config.__preview_remote_config?(this._instance.wi(e),e.hasFeatureFlags!==!1&&this._instance.featureFlags.ensureFlagsLoaded()):Zu.info("__preview_remote_config is disabled. Logging config instead",e):Zu.error("Failed to fetch remote config from PostHog.")}}var pb=3e3;class RH{constructor(e,t){this.Re=!0,this.Fe=[],this.Oe=Wa((t==null?void 0:t.flush_interval_ms)||pb,250,5e3,et.createLogger("flush interval"),pb),this.Me=e}enqueue(e){this.Fe.push(e),this.Ae||this.je()}unload(){this.De();var e=this.Fe.length>0?this.Le():{},t=Object.values(e);[...t.filter((n=>n.url.indexOf("/e")===0)),...t.filter((n=>n.url.indexOf("/e")!==0))].map((n=>{this.Me(rt({},n,{transport:"sendBeacon"}))}))}enable(){this.Re=!1,this.je()}je(){var e=this;this.Re||(this.Ae=setTimeout((()=>{if(this.De(),this.Fe.length>0){var t=this.Le(),n=function(){var i=t[s],c=new Date().getTime();i.data&&$r(i.data)&&tn(i.data,(d=>{d.offset=Math.abs(d.timestamp-c),delete d.timestamp})),e.Me(i)};for(var s in t)n()}}),this.Oe))}De(){clearTimeout(this.Ae),this.Ae=void 0}Le(){var e={};return tn(this.Fe,(t=>{var n,s=t,i=(s?s.batchKey:null)||s.url;Xe(e[i])&&(e[i]=rt({},s,{data:[]})),(n=e[i].data)==null||n.push(s.data)})),this.Fe=[],e}}var AH=["retriesPerformedSoFar"];class IH{constructor(e){this.Ne=!1,this.Ue=3e3,this.Fe=[],this._instance=e,this.Fe=[],this.ze=!0,!Xe(Ee)&&"onLine"in Ee.navigator&&(this.ze=Ee.navigator.onLine,this.He=()=>{this.ze=!0,this.Lt()},this.Be=()=>{this.ze=!1},Dn(Ee,"online",this.He),Dn(Ee,"offline",this.Be))}get length(){return this.Fe.length}retriableRequest(e){var{retriesPerformedSoFar:t}=e,n=VT(e,AH);Yf(t)&&(n.url=Ty(n.url,{retry_count:t})),this._instance._send_request(rt({},n,{callback:s=>{s.statusCode!==200&&(s.statusCode<400||s.statusCode>=500)&&(t??0)<10?this.qe(rt({retriesPerformedSoFar:t},n)):n.callback==null||n.callback(s)}}))}qe(e){var t=e.retriesPerformedSoFar||0;e.retriesPerformedSoFar=t+1;var n=(function(c){var d=3e3*Math.pow(2,c),p=d/2,m=Math.min(18e5,d),g=(Math.random()-.5)*(m-p);return Math.ceil(m+g)})(t),s=Date.now()+n;this.Fe.push({retryAt:s,requestOptions:e});var i="Enqueued failed request for retry in "+n;navigator.onLine||(i+=" (Browser is offline)"),et.warn(i),this.Ne||(this.Ne=!0,this.We())}We(){if(this.Ge&&clearTimeout(this.Ge),this.Fe.length===0)return this.Ne=!1,void(this.Ge=void 0);this.Ge=setTimeout((()=>{this.ze&&this.Fe.length>0&&this.Lt(),this.We()}),this.Ue)}Lt(){var e=Date.now(),t=[],n=this.Fe.filter((i=>i.retryAt<e||(t.push(i),!1)));if(this.Fe=t,n.length>0)for(var{requestOptions:s}of n)this.retriableRequest(s)}unload(){for(var{requestOptions:e}of(this.Ge&&(clearTimeout(this.Ge),this.Ge=void 0),this.Ne=!1,Xe(Ee)||(this.He&&(Ee.removeEventListener("online",this.He),this.He=void 0),this.Be&&(Ee.removeEventListener("offline",this.Be),this.Be=void 0)),this.Fe))try{this._instance._send_request(rt({},e,{transport:"sendBeacon"}))}catch(t){et.error(t)}this.Fe=[]}}class PH{constructor(e){this.Ve=()=>{var t,n,s,i;this.Je||(this.Je={});var c=this.scrollElement(),d=this.scrollY(),p=c?Math.max(0,c.scrollHeight-c.clientHeight):0,m=d+((c==null?void 0:c.clientHeight)||0),g=(c==null?void 0:c.scrollHeight)||0;this.Je.lastScrollY=Math.ceil(d),this.Je.maxScrollY=Math.max(d,(t=this.Je.maxScrollY)!==null&&t!==void 0?t:0),this.Je.maxScrollHeight=Math.max(p,(n=this.Je.maxScrollHeight)!==null&&n!==void 0?n:0),this.Je.lastContentY=m,this.Je.maxContentY=Math.max(m,(s=this.Je.maxContentY)!==null&&s!==void 0?s:0),this.Je.maxContentHeight=Math.max(g,(i=this.Je.maxContentHeight)!==null&&i!==void 0?i:0)},this._instance=e}getContext(){return this.Je}resetContext(){var e=this.Je;return setTimeout(this.Ve,0),e}startMeasuringScrollPosition(){Dn(Ee,"scroll",this.Ve,{capture:!0}),Dn(Ee,"scrollend",this.Ve,{capture:!0}),Dn(Ee,"resize",this.Ve)}scrollElement(){if(!this._instance.config.scroll_root_selector)return Ee==null?void 0:Ee.document.documentElement;var e=$r(this._instance.config.scroll_root_selector)?this._instance.config.scroll_root_selector:[this._instance.config.scroll_root_selector];for(var t of e){var n=Ee==null?void 0:Ee.document.querySelector(t);if(n)return n}}scrollY(){if(this._instance.config.scroll_root_selector){var e=this.scrollElement();return e&&e.scrollTop||0}return Ee&&(Ee.scrollY||Ee.pageYOffset||Ee.document.documentElement.scrollTop)||0}scrollX(){if(this._instance.config.scroll_root_selector){var e=this.scrollElement();return e&&e.scrollLeft||0}return Ee&&(Ee.scrollX||Ee.pageXOffset||Ee.document.documentElement.scrollLeft)||0}}var jH=r=>zR(r==null?void 0:r.config.mask_personal_data_properties,r==null?void 0:r.config.custom_personal_data_properties);class Ek{constructor(e,t,n,s){this.Ke=i=>{var c=this.Ye();if(!c||c.sessionId!==i){var d={sessionId:i,props:this.Xe(this._instance)};this.Qe.register({[ob]:d})}},this._instance=e,this.Ze=t,this.Qe=n,this.Xe=s||jH,this.Ze.onSessionId(this.Ke)}Ye(){return this.Qe.props[ob]}getSetOnceProps(){var e,t=(e=this.Ye())==null?void 0:e.props;return t?"r"in t?HR(t):{$referring_domain:t.referringDomain,$pathname:t.initialPathName,utm_source:t.utm_source,utm_campaign:t.utm_campaign,utm_medium:t.utm_medium,utm_content:t.utm_content,utm_term:t.utm_term}:{}}getSessionProps(){var e={};return tn(iS(this.getSetOnceProps()),((t,n)=>{n==="$current_url"&&(n="url"),e["$session_entry_"+Kw(n)]=t})),e}}var tw=_n("[SessionId]");class Ck{on(e,t){return this.tr.on(e,t)}constructor(e,t,n){var s;if(this.ir=[],this.er=void 0,this.tr=new fS,this.rr=(g,x)=>!(!Yf(g)||!Yf(x))&&Math.abs(g-x)>this.sessionTimeoutMs,!e.persistence)throw new Error("SessionIdManager requires a PostHogPersistence instance");if(e.config.cookieless_mode==="always")throw new Error('SessionIdManager cannot be used with cookieless_mode="always"');this.R=e.config,this.Qe=e.persistence,this.sr=void 0,this.nr=void 0,this._sessionStartTimestamp=null,this._sessionActivityTimestamp=null,this.ar=t||Hc,this.lr=n||Hc;var i=this.R.persistence_name||this.R.token,c=this.R.session_idle_timeout_seconds||1800;if(this._sessionTimeoutMs=1e3*Wa(c,60,36e3,tw.createLogger("session_idle_timeout_seconds"),1800),e.register({$configured_session_timeout_ms:this._sessionTimeoutMs}),this.ur(),this.hr="ph_"+i+"_window_id",this.dr="ph_"+i+"_primary_window_exists",this.vr()){var d=xs.W(this.hr),p=xs.W(this.dr);d&&!p?this.sr=d:xs.V(this.hr),xs.G(this.dr,!0)}if((s=this.R.bootstrap)!=null&&s.sessionID)try{var m=(g=>{var x=g.replace(/-/g,"");if(x.length!==32)throw new Error("Not a valid UUID");if(x[12]!=="7")throw new Error("Not a UUIDv7");return parseInt(x.substring(0,12),16)})(this.R.bootstrap.sessionID);this.cr(this.R.bootstrap.sessionID,new Date().getTime(),m)}catch(g){tw.error("Invalid sessionID in bootstrap",g)}this.pr()}get sessionTimeoutMs(){return this._sessionTimeoutMs}onSessionId(e){return Xe(this.ir)&&(this.ir=[]),this.ir.push(e),this.nr&&e(this.nr,this.sr),()=>{this.ir=this.ir.filter((t=>t!==e))}}vr(){return this.R.persistence!=="memory"&&!this.Qe.Pi&&xs.H()}gr(e){e!==this.sr&&(this.sr=e,this.vr()&&xs.G(this.hr,e))}_r(){return this.sr?this.sr:this.vr()?xs.W(this.hr):null}cr(e,t,n){e===this.nr&&t===this._sessionActivityTimestamp&&n===this._sessionStartTimestamp||(this._sessionStartTimestamp=n,this._sessionActivityTimestamp=t,this.nr=e,this.Qe.register({[yy]:[t,e,n]}))}mr(){var e=this.Qe.props[yy];return $r(e)&&e.length===2&&e.push(e[0]),e||[0,null,0]}resetSessionId(){this.cr(null,null,null)}destroy(){clearTimeout(this.br),this.br=void 0,this.er&&Ee&&(Ee.removeEventListener("beforeunload",this.er,{capture:!1}),this.er=void 0),this.ir=[]}pr(){this.er=()=>{this.vr()&&xs.V(this.dr)},Dn(Ee,"beforeunload",this.er,{capture:!1})}checkAndGetSessionAndWindowId(e,t){if(e===void 0&&(e=!1),t===void 0&&(t=null),this.R.cookieless_mode==="always")throw new Error('checkAndGetSessionAndWindowId should not be called with cookieless_mode="always"');var n=t||new Date().getTime(),[s,i,c]=this.mr(),d=this._r(),p=Yf(c)&&Math.abs(n-c)>864e5,m=!1,g=!i,x=!g&&!e&&this.rr(n,s);g||x||p?(i=this.ar(),d=this.lr(),tw.info("new session ID generated",{sessionId:i,windowId:d,changeReason:{noSessionId:g,activityTimeout:x,sessionPastMaximumLength:p}}),c=n,m=!0):d||(d=this.lr(),m=!0);var b=Yf(s)&&e&&!p?s:n,S=Yf(c)?c:new Date().getTime();return this.gr(d),this.cr(i,b,S),e||this.ur(),m&&this.ir.forEach((T=>T(i,d,m?{noSessionId:g,activityTimeout:x,sessionPastMaximumLength:p}:void 0))),{sessionId:i,windowId:d,sessionStartTimestamp:S,changeReason:m?{noSessionId:g,activityTimeout:x,sessionPastMaximumLength:p}:void 0,lastActivityTimestamp:s}}ur(){clearTimeout(this.br),this.br=setTimeout((()=>{var[e]=this.mr();if(this.rr(new Date().getTime(),e)){var t=this.nr;this.resetSessionId(),this.tr.emit("forcedIdleReset",{idleSessionId:t})}}),1.1*this.sessionTimeoutMs)}}var FH=["$set_once","$set"],Dc=_n("[SiteApps]");class OH{constructor(e){this._instance=e,this.yr=[],this.apps={}}get isEnabled(){return!!this._instance.config.opt_in_site_apps}wr(e,t){if(t){var n=this.globalsForEvent(t);this.yr.push(n),this.yr.length>1e3&&(this.yr=this.yr.slice(10))}}get siteAppLoaders(){var e;return(e=Nt._POSTHOG_REMOTE_CONFIG)==null||(e=e[this._instance.config.token])==null?void 0:e.siteApps}init(){if(this.isEnabled){var e=this._instance._addCaptureHook(this.wr.bind(this));this.Er=()=>{e(),this.yr=[],this.Er=void 0}}}globalsForEvent(e){var t,n,s,i,c,d,p;if(!e)throw new Error("Event payload is required");var m={},g=this._instance.get_property("$groups")||[],x=this._instance.get_property("$stored_group_properties")||{};for(var[b,S]of Object.entries(x))m[b]={id:g[b],type:b,properties:S};var{$set_once:T,$set:E}=e;return{event:rt({},VT(e,FH),{properties:rt({},e.properties,E?{$set:rt({},(t=(n=e.properties)==null?void 0:n.$set)!==null&&t!==void 0?t:{},E)}:{},T?{$set_once:rt({},(s=(i=e.properties)==null?void 0:i.$set_once)!==null&&s!==void 0?s:{},T)}:{}),elements_chain:(c=(d=e.properties)==null?void 0:d.$elements_chain)!==null&&c!==void 0?c:"",distinct_id:(p=e.properties)==null?void 0:p.distinct_id}),person:{properties:this._instance.get_property("$stored_person_properties")},groups:m}}setupSiteApp(e){var t=this.apps[e.id],n=()=>{var d;!t.errored&&this.yr.length&&(Dc.info("Processing "+this.yr.length+" events for site app with id "+e.id),this.yr.forEach((p=>t.processEvent==null?void 0:t.processEvent(p))),t.processedBuffer=!0),Object.values(this.apps).every((p=>p.processedBuffer||p.errored))&&((d=this.Er)==null||d.call(this))},s=!1,i=d=>{t.errored=!d,t.loaded=!0,Dc.info("Site app with id "+e.id+" "+(d?"loaded":"errored")),s&&n()};try{var{processEvent:c}=e.init({posthog:this._instance,callback:d=>{i(d)}});c&&(t.processEvent=c),s=!0}catch(d){Dc.error("Error while initializing PostHog app with config id "+e.id,d),i(!1)}if(s&&t.loaded)try{n()}catch(d){Dc.error("Error while processing buffered events PostHog app with config id "+e.id,d),t.errored=!0}}$r(){var e=this.siteAppLoaders||[];for(var t of e)this.apps[t.id]={id:t.id,loaded:!1,errored:!1,processedBuffer:!1};for(var n of e)this.setupSiteApp(n)}Sr(e){if(Object.keys(this.apps).length!==0){var t=this.globalsForEvent(e);for(var n of Object.values(this.apps))try{n.processEvent==null||n.processEvent(t)}catch(s){Dc.error("Error while processing event "+e.event+" for site app "+n.id,s)}}}onRemoteConfig(e){var t,n,s,i=this;if((t=this.siteAppLoaders)!=null&&t.length)return this.isEnabled?(this.$r(),void this._instance.on("eventCaptured",(m=>this.Sr(m)))):void Dc.error('PostHog site apps are disabled. Enable the "opt_in_site_apps" config to proceed.');if((n=this.Er)==null||n.call(this),(s=e.siteApps)!=null&&s.length)if(this.isEnabled){var c=function(m){var g;Nt["__$$ph_site_app_"+m]=i._instance,(g=Nt.__PosthogExtensions__)==null||g.loadSiteApp==null||g.loadSiteApp(i._instance,p,(x=>{if(x)return Dc.error("Error while initializing PostHog app with config id "+m,x)}))};for(var{id:d,url:p}of e.siteApps)c(d)}else Dc.error('PostHog site apps are disabled. Enable the "opt_in_site_apps" config to proceed.')}}var QR=function(r,e){if(!r)return!1;var t=r.userAgent;if(t&&OC(t,e))return!0;try{var n=r==null?void 0:r.userAgentData;if(n!=null&&n.brands&&n.brands.some((s=>OC(s==null?void 0:s.brand,e))))return!0}catch{}return!!r.webdriver},wm=(function(r){return r.US="us",r.EU="eu",r.CUSTOM="custom",r})({}),kk="i.posthog.com";class DH{constructor(e){this.kr={},this.instance=e}get apiHost(){var e=this.instance.config.api_host.trim().replace(/\/$/,"");return e==="https://app.posthog.com"?"https://us.i.posthog.com":e}get flagsApiHost(){var e=this.instance.config.flags_api_host;return e?e.trim().replace(/\/$/,""):this.apiHost}get uiHost(){var e,t=(e=this.instance.config.ui_host)==null?void 0:e.replace(/\/$/,"");return t||(t=this.apiHost.replace("."+kk,".posthog.com")),t==="https://app.posthog.com"?"https://us.posthog.com":t}get region(){return this.kr[this.apiHost]||(/https:\/\/(app|us|us-assets)(\.i)?\.posthog\.com/i.test(this.apiHost)?this.kr[this.apiHost]=wm.US:/https:\/\/(eu|eu-assets)(\.i)?\.posthog\.com/i.test(this.apiHost)?this.kr[this.apiHost]=wm.EU:this.kr[this.apiHost]=wm.CUSTOM),this.kr[this.apiHost]}endpointFor(e,t){if(t===void 0&&(t=""),t&&(t=t[0]==="/"?t:"/"+t),e==="ui")return this.uiHost+t;if(e==="flags")return this.flagsApiHost+t;if(this.region===wm.CUSTOM)return this.apiHost+t;var n=kk+t;switch(e){case"assets":return"https://"+this.region+"-assets."+n;case"api":return"https://"+this.region+"."+n}}}var LH={icontains:(r,e)=>!!Ee&&e.href.toLowerCase().indexOf(r.toLowerCase())>-1,not_icontains:(r,e)=>!!Ee&&e.href.toLowerCase().indexOf(r.toLowerCase())===-1,regex:(r,e)=>!!Ee&&Ry(e.href,r),not_regex:(r,e)=>!!Ee&&!Ry(e.href,r),exact:(r,e)=>e.href===r,is_not:(r,e)=>e.href!==r};class Ms{constructor(e){var t=this;this.getWebExperimentsAndEvaluateDisplayLogic=function(n){n===void 0&&(n=!1),t.getWebExperiments((s=>{Ms.Pr("retrieved web experiments from the server"),t.Tr=new Map,s.forEach((i=>{if(i.feature_flag_key){var c;t.Tr&&(Ms.Pr("setting flag key ",i.feature_flag_key," to web experiment ",i),(c=t.Tr)==null||c.set(i.feature_flag_key,i));var d=t._instance.getFeatureFlag(i.feature_flag_key);Kn(d)&&i.variants[d]&&t.Ir(i.name,d,i.variants[d].transforms)}else if(i.variants)for(var p in i.variants){var m=i.variants[p];Ms.Cr(m)&&t.Ir(i.name,p,m.transforms)}}))}),n)},this._instance=e,this._instance.onFeatureFlags((n=>{this.onFeatureFlags(n)}))}onFeatureFlags(e){if(this._is_bot())Ms.Pr("Refusing to render web experiment since the viewer is a likely bot");else if(!this._instance.config.disable_web_experiments){if(xr(this.Tr))return this.Tr=new Map,this.loadIfEnabled(),void this.previewWebExperiment();Ms.Pr("applying feature flags",e),e.forEach((t=>{var n;if(this.Tr&&(n=this.Tr)!=null&&n.has(t)){var s,i=this._instance.getFeatureFlag(t),c=(s=this.Tr)==null?void 0:s.get(t);i&&c!=null&&c.variants[i]&&this.Ir(c.name,i,c.variants[i].transforms)}}))}}previewWebExperiment(){var e=Ms.getWindowLocation();if(e!=null&&e.search){var t=Ey(e==null?void 0:e.search,"__experiment_id"),n=Ey(e==null?void 0:e.search,"__experiment_variant");t&&n&&(Ms.Pr("previewing web experiments "+t+" && "+n),this.getWebExperiments((s=>{this.Rr(parseInt(t),n,s)}),!1,!0))}}loadIfEnabled(){this._instance.config.disable_web_experiments||this.getWebExperimentsAndEvaluateDisplayLogic()}getWebExperiments(e,t,n){if(this._instance.config.disable_web_experiments&&!n)return e([]);var s=this._instance.get_property("$web_experiments");if(s&&!t)return e(s);this._instance._send_request({url:this._instance.requestRouter.endpointFor("api","/api/web_experiments/?token="+this._instance.config.token),method:"GET",callback:i=>{if(i.statusCode!==200||!i.json)return e([]);var c=i.json.experiments||[];return e(c)}})}Rr(e,t,n){var s=n.filter((i=>i.id===e));s&&s.length>0&&(Ms.Pr("Previewing web experiment ["+s[0].name+"] with variant ["+t+"]"),this.Ir(s[0].name,t,s[0].variants[t].transforms))}static Cr(e){return!xr(e.conditions)&&Ms.Fr(e)&&Ms.Or(e)}static Fr(e){var t;if(xr(e.conditions)||xr((t=e.conditions)==null?void 0:t.url))return!0;var n,s,i,c=Ms.getWindowLocation();return!!c&&((n=e.conditions)==null||!n.url||LH[(s=(i=e.conditions)==null?void 0:i.urlMatchType)!==null&&s!==void 0?s:"icontains"](e.conditions.url,c))}static getWindowLocation(){return Ee==null?void 0:Ee.location}static Or(e){var t;if(xr(e.conditions)||xr((t=e.conditions)==null?void 0:t.utm))return!0;var n=LR();if(n.utm_source){var s,i,c,d,p,m,g,x,b=(s=e.conditions)==null||(s=s.utm)==null||!s.utm_campaign||((i=e.conditions)==null||(i=i.utm)==null?void 0:i.utm_campaign)==n.utm_campaign,S=(c=e.conditions)==null||(c=c.utm)==null||!c.utm_source||((d=e.conditions)==null||(d=d.utm)==null?void 0:d.utm_source)==n.utm_source,T=(p=e.conditions)==null||(p=p.utm)==null||!p.utm_medium||((m=e.conditions)==null||(m=m.utm)==null?void 0:m.utm_medium)==n.utm_medium,E=(g=e.conditions)==null||(g=g.utm)==null||!g.utm_term||((x=e.conditions)==null||(x=x.utm)==null?void 0:x.utm_term)==n.utm_term;return b&&T&&E&&S}return!1}static Pr(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];et.info("[WebExperiments] "+e,n)}Ir(e,t,n){this._is_bot()?Ms.Pr("Refusing to render web experiment since the viewer is a likely bot"):t!=="control"?n.forEach((s=>{if(s.selector){var i;Ms.Pr("applying transform of variant "+t+" for experiment "+e+" ",s);var c=(i=document)==null?void 0:i.querySelectorAll(s.selector);c==null||c.forEach((d=>{var p=d;s.html&&(p.innerHTML=s.html),s.css&&p.setAttribute("style",s.css)}))}})):Ms.Pr("Control variants leave the page unmodified.")}_is_bot(){return oi&&this._instance?QR(oi,this._instance.config.custom_blocked_useragents):void 0}}var MH=_n("[PostHog ExternalIntegrations]"),$H={intercom:"intercom-integration",crispChat:"crisp-chat-integration"};class UH{constructor(e){this._instance=e}it(e,t){var n;(n=Nt.__PosthogExtensions__)==null||n.loadExternalDependency==null||n.loadExternalDependency(this._instance,e,(s=>{if(s)return MH.error("failed to load script",s);t()}))}startIfEnabledOrStop(){var e=this,t=function(c){var d,p,m;!s||(d=Nt.__PosthogExtensions__)!=null&&(d=d.integrations)!=null&&d[c]||e.it($H[c],(()=>{var g;(g=Nt.__PosthogExtensions__)==null||(g=g.integrations)==null||(g=g[c])==null||g.start(e._instance)})),!s&&(p=Nt.__PosthogExtensions__)!=null&&(p=p.integrations)!=null&&p[c]&&((m=Nt.__PosthogExtensions__)==null||(m=m.integrations)==null||(m=m[c])==null||m.stop())};for(var[n,s]of Object.entries((i=this._instance.config.integrations)!==null&&i!==void 0?i:{})){var i;t(n)}}}var mb="[SessionRecording]",rm=_n(mb);class Nk{get started(){var e;return!((e=this.Mr)==null||!e.isStarted)}get status(){return this.Mr?this.Mr.status:this.Ar&&!this.jr?"disabled":"lazy_loading"}constructor(e){if(this._forceAllowLocalhostNetworkCapture=!1,this.Ar=!1,this.Dr=void 0,this._instance=e,!this._instance.sessionManager)throw rm.error("started without valid sessionManager"),new Error(mb+" started without valid sessionManager. This is a bug.");if(this._instance.config.cookieless_mode==="always")throw new Error(mb+' cannot be used with cookieless_mode="always"')}get jr(){var e,t=!((e=this._instance.get_property(zx))==null||!e.enabled),n=!this._instance.config.disable_session_recording,s=this._instance.config.disable_session_recording||this._instance.consent.isOptedOut();return Ee&&t&&n&&!s}startIfEnabledOrStop(e){var t;if(!this.jr||(t=this.Mr)==null||!t.isStarted){var n=!Xe(Object.assign)&&!Xe(Array.from);this.jr&&n?(this.Lr(e),rm.info("starting")):this.stopRecording()}}Lr(e){var t,n,s;this.jr&&(Nt!=null&&(t=Nt.__PosthogExtensions__)!=null&&(t=t.rrweb)!=null&&t.record&&(n=Nt.__PosthogExtensions__)!=null&&n.initSessionRecording?this.Nr(e):(s=Nt.__PosthogExtensions__)==null||s.loadExternalDependency==null||s.loadExternalDependency(this._instance,this.Ur,(i=>{if(i)return rm.error("could not load recorder",i);this.Nr(e)})))}stopRecording(){var e,t;(e=this.Dr)==null||e.call(this),this.Dr=void 0,(t=this.Mr)==null||t.stop()}zr(){var e;(e=this._instance.persistence)==null||e.unregister(yR)}Hr(e){if(this._instance.persistence){var t,n,s=this._instance.persistence,i=()=>{var c=e.sessionRecording===!1?void 0:e.sessionRecording,d=c==null?void 0:c.sampleRate,p=xr(d)?null:parseFloat(d);xr(p)&&this.zr();var m=c==null?void 0:c.minimumDurationMilliseconds;s.register({[zx]:rt({cache_timestamp:Date.now(),enabled:!!c},c,{networkPayloadCapture:rt({capturePerformance:e.capturePerformance},c==null?void 0:c.networkPayloadCapture),canvasRecording:{enabled:c==null?void 0:c.recordCanvas,fps:c==null?void 0:c.canvasFps,quality:c==null?void 0:c.canvasQuality},sampleRate:p,minimumDurationMilliseconds:Xe(m)?null:m,endpoint:c==null?void 0:c.endpoint,triggerMatchType:c==null?void 0:c.triggerMatchType,masking:c==null?void 0:c.masking,urlTriggers:c==null?void 0:c.urlTriggers})})};i(),(t=this.Dr)==null||t.call(this),this.Dr=(n=this._instance.sessionManager)==null?void 0:n.onSessionId(i)}}onRemoteConfig(e){"sessionRecording"in e?e.sessionRecording!==!1?(this.Hr(e),this.Ar=!0,this.startIfEnabledOrStop()):this.Ar=!0:rm.info("skipping remote config with no sessionRecording",e)}log(e,t){var n;t===void 0&&(t="log"),(n=this.Mr)!=null&&n.log?this.Mr.log(e,t):rm.warn("log called before recorder was ready")}get Ur(){var e,t,n=(e=this._instance)==null||(e=e.persistence)==null?void 0:e.get_property(zx);return(n==null||(t=n.scriptConfig)==null?void 0:t.script)||"lazy-recorder"}Nr(e){var t,n;if((t=Nt.__PosthogExtensions__)==null||!t.initSessionRecording)throw Error("Called on script loaded before session recording is available");this.Mr||(this.Mr=(n=Nt.__PosthogExtensions__)==null?void 0:n.initSessionRecording(this._instance),this.Mr._forceAllowLocalhostNetworkCapture=this._forceAllowLocalhostNetworkCapture),this.Mr.start(e)}onRRwebEmit(e){var t;(t=this.Mr)==null||t.onRRwebEmit==null||t.onRRwebEmit(e)}overrideLinkedFlag(){var e,t;this.Mr||(t=this._instance.persistence)==null||t.register({$replay_override_linked_flag:!0}),(e=this.Mr)==null||e.overrideLinkedFlag()}overrideSampling(){var e,t;this.Mr||(t=this._instance.persistence)==null||t.register({$replay_override_sampling:!0}),(e=this.Mr)==null||e.overrideSampling()}overrideTrigger(e){var t,n;this.Mr||(n=this._instance.persistence)==null||n.register({[e==="url"?"$replay_override_url_trigger":"$replay_override_event_trigger"]:!0}),(t=this.Mr)==null||t.overrideTrigger(e)}get sdkDebugProperties(){var e;return((e=this.Mr)==null?void 0:e.sdkDebugProperties)||{$recording_status:this.status}}tryAddCustomEvent(e,t){var n;return!((n=this.Mr)==null||!n.tryAddCustomEvent(e,t))}}var Nm={},gb=()=>{},Jf="posthog",ZR=!dH&&(jo==null?void 0:jo.indexOf("MSIE"))===-1&&(jo==null?void 0:jo.indexOf("Mozilla"))===-1,Tk=r=>{var e;return rt({api_host:"https://us.i.posthog.com",flags_api_host:null,ui_host:null,token:"",autocapture:!0,cross_subdomain_cookie:gz(Je==null?void 0:Je.location),persistence:"localStorage+cookie",persistence_name:"",cookie_persisted_properties:[],loaded:gb,save_campaign_params:!0,custom_campaign_params:[],custom_blocked_useragents:[],save_referrer:!0,capture_pageleave:"if_capture_pageview",defaults:r??"unset",__preview_deferred_init_extensions:!1,debug:bs&&Kn(bs==null?void 0:bs.search)&&bs.search.indexOf("__posthog_debug=true")!==-1||!1,cookie_expiration:365,upgrade:!1,disable_session_recording:!1,disable_persistence:!1,disable_web_experiments:!0,disable_surveys:!1,disable_surveys_automatic_display:!1,disable_conversations:!1,disable_product_tours:!0,disable_external_dependency_loading:!1,enable_recording_console_log:void 0,secure_cookie:(Ee==null||(e=Ee.location)==null?void 0:e.protocol)==="https:",ip:!1,opt_out_capturing_by_default:!1,opt_out_persistence_by_default:!1,opt_out_useragent_filter:!1,opt_out_capturing_persistence_type:"localStorage",consent_persistence_name:null,opt_out_capturing_cookie_prefix:null,opt_in_site_apps:!1,property_denylist:[],respect_dnt:!1,sanitize_properties:null,request_headers:{},request_batching:!0,properties_string_max_length:65535,mask_all_element_attributes:!1,mask_all_text:!1,mask_personal_data_properties:!1,custom_personal_data_properties:[],advanced_disable_flags:!1,advanced_disable_decide:!1,advanced_disable_feature_flags:!1,advanced_disable_feature_flags_on_first_load:!1,advanced_only_evaluate_survey_feature_flags:!1,advanced_enable_surveys:!1,advanced_disable_toolbar_metrics:!1,feature_flag_request_timeout_ms:3e3,surveys_request_timeout_ms:1e4,on_request_error:t=>{var n="Bad HTTP status: "+t.statusCode+" "+t.text;et.error(n)},get_device_id:t=>t,capture_performance:void 0,name:"posthog",bootstrap:{},disable_compression:!1,session_idle_timeout_seconds:1800,person_profiles:"identified_only",before_send:void 0,request_queue_config:{flush_interval_ms:pb},error_tracking:{},_onCapture:gb,__preview_eager_load_replay:!1},(t=>({rageclick:!(t&&t>="2025-11-30")||{content_ignorelist:!0},capture_pageview:!(t&&t>="2025-05-24")||"history_change",session_recording:t&&t>="2025-11-30"?{strictMinimumDuration:!0}:{},external_scripts_inject_target:t&&t>="2026-01-30"?"head":"body",internal_or_test_user_hostname:t&&t>="2026-01-30"?/^(localhost|127\.0\.0\.1)$/:void 0}))(r))},Rk=r=>{var e={};Xe(r.process_person)||(e.person_profiles=r.process_person),Xe(r.xhr_headers)||(e.request_headers=r.xhr_headers),Xe(r.cookie_name)||(e.persistence_name=r.cookie_name),Xe(r.disable_cookie)||(e.disable_persistence=r.disable_cookie),Xe(r.store_google)||(e.save_campaign_params=r.store_google),Xe(r.verbose)||(e.debug=r.verbose);var t=Rn({},e,r);return $r(r.property_blacklist)&&(Xe(r.property_denylist)?t.property_denylist=r.property_blacklist:$r(r.property_denylist)?t.property_denylist=[...r.property_blacklist,...r.property_denylist]:et.error("Invalid value for property_denylist config: "+r.property_denylist)),t};class zH{constructor(){this.__forceAllowLocalhost=!1}get Br(){return this.__forceAllowLocalhost}set Br(e){et.error("WebPerformanceObserver is deprecated and has no impact on network capture. Use `_forceAllowLocalhostNetworkCapture` on `posthog.sessionRecording`"),this.__forceAllowLocalhost=e}}class r0{get decideEndpointWasHit(){var e,t;return(e=(t=this.featureFlags)==null?void 0:t.hasLoadedFlags)!==null&&e!==void 0&&e}get flagsEndpointWasHit(){var e,t;return(e=(t=this.featureFlags)==null?void 0:t.hasLoadedFlags)!==null&&e!==void 0&&e}constructor(){this.webPerformance=new zH,this.qr=!1,this.version=Ml.LIB_VERSION,this.bi=new fS,this._calculate_event_properties=this.calculateEventProperties.bind(this),this.config=Tk(),this.SentryIntegration=Wz,this.sentryIntegration=e=>(function(t,n){var s=DR(t,n);return{name:OR,processEvent:i=>s(i)}})(this,e),this.__request_queue=[],this.__loaded=!1,this.analyticsDefaultEndpoint="/e/",this.Wr=!1,this.Gr=null,this.Vr=null,this.Jr=null,this.featureFlags=new mH(this),this.toolbar=new qz(this),this.scrollManager=new PH(this),this.pageViewManager=new uk(this),this.surveys=new EH(this),this.conversations=new CH(this),this.logs=new kH(this),this.experiments=new Ms(this),this.exceptions=new fH(this),this.rateLimiter=new NH(this),this.requestRouter=new DH(this),this.consent=new $z(this),this.externalIntegrations=new UH(this),this.people={set:(e,t,n)=>{var s=Kn(e)?{[e]:t}:e;this.setPersonProperties(s),n==null||n({})},set_once:(e,t,n)=>{var s=Kn(e)?{[e]:t}:e;this.setPersonProperties(void 0,s),n==null||n({})}},this.on("eventCaptured",(e=>et.info('send "'+(e==null?void 0:e.event)+'"',e)))}init(e,t,n){if(n&&n!==Jf){var s,i=(s=Nm[n])!==null&&s!==void 0?s:new r0;return i._init(e,t,n),Nm[n]=i,Nm[Jf][n]=i,i}return this._init(e,t,n)}_init(e,t,n){var s;if(t===void 0&&(t={}),Xe(e)||Yw(e))return et.critical("PostHog was initialized without a token. This likely indicates a misconfiguration. Please check the first argument passed to posthog.init()"),this;if(this.__loaded)return console.warn("[PostHog.js]","You have already initialized PostHog! Re-initializing is a no-op"),this;this.__loaded=!0,this.config={},t.debug=this.Kr(t.debug),this.Yr=t,this.Xr=[],t.person_profiles&&(this.Vr=t.person_profiles),this.set_config(Rn({},Tk(t.defaults),Rk(t),{name:n,token:e})),this.config.on_xhr_error&&et.error("on_xhr_error is deprecated. Use on_request_error instead"),this.compression=t.disable_compression?void 0:zl.GZipJS;var i=this.Qr();this.persistence=new Xx(this.config,i),this.sessionPersistence=this.config.persistence==="sessionStorage"||this.config.persistence==="memory"?this.persistence:new Xx(rt({},this.config,{persistence:"sessionStorage"}),i);var c=rt({},this.persistence.props),d=rt({},this.sessionPersistence.props);this.register({$initialization_time:new Date().toISOString()}),this.Zr=new RH((A=>this.ts(A)),this.config.request_queue_config),this.es=new IH(this),this.__request_queue=[];var p=this.config.cookieless_mode==="always"||this.config.cookieless_mode==="on_reject"&&this.consent.isExplicitlyOptedOut();if(p||(this.sessionManager=new Ck(this),this.sessionPropsManager=new Ek(this,this.sessionManager,this.persistence)),this.config.__preview_deferred_init_extensions?(et.info("Deferring extension initialization to improve startup performance"),setTimeout((()=>{this.rs(p)}),0)):(et.info("Initializing extensions synchronously"),this.rs(p)),Ml.DEBUG=Ml.DEBUG||this.config.debug,Ml.DEBUG&&et.info("Starting in debug mode",{this:this,config:t,thisC:rt({},this.config),p:c,s:d}),((s=t.bootstrap)==null?void 0:s.distinctID)!==void 0){var m,g,x=this.config.get_device_id(Hc()),b=(m=t.bootstrap)!=null&&m.isIdentifiedID?x:t.bootstrap.distinctID;this.persistence.set_property($l,(g=t.bootstrap)!=null&&g.isIdentifiedID?"identified":"anonymous"),this.register({distinct_id:t.bootstrap.distinctID,$device_id:b})}if(this.ss()){var S,T,E=Object.keys(((S=t.bootstrap)==null?void 0:S.featureFlags)||{}).filter((A=>{var F;return!((F=t.bootstrap)==null||(F=F.featureFlags)==null||!F[A])})).reduce(((A,F)=>{var P;return A[F]=((P=t.bootstrap)==null||(P=P.featureFlags)==null?void 0:P[F])||!1,A}),{}),C=Object.keys(((T=t.bootstrap)==null?void 0:T.featureFlagPayloads)||{}).filter((A=>E[A])).reduce(((A,F)=>{var P,L;return(P=t.bootstrap)!=null&&(P=P.featureFlagPayloads)!=null&&P[F]&&(A[F]=(L=t.bootstrap)==null||(L=L.featureFlagPayloads)==null?void 0:L[F]),A}),{});this.featureFlags.receivedFeatureFlags({featureFlags:E,featureFlagPayloads:C})}if(p)this.register_once({distinct_id:Kp,$device_id:null},"");else if(!this.get_distinct_id()){var R=this.config.get_device_id(Hc());this.register_once({distinct_id:R,$device_id:R},""),this.persistence.set_property($l,"anonymous")}return Dn(Ee,"onpagehide"in self?"pagehide":"unload",this._handle_unload.bind(this),{passive:!1}),this.toolbar.maybeLoadToolbar(),t.segment?Gz(this,(()=>this.ns())):this.ns(),Gc(this.config._onCapture)&&this.config._onCapture!==gb&&(et.warn("onCapture is deprecated. Please use `before_send` instead"),this.on("eventCaptured",(A=>this.config._onCapture(A.event,A)))),this.config.ip&&et.warn('The `ip` config option has NO EFFECT AT ALL and has been deprecated. Use a custom transformation or "Discard IP data" project setting instead. See https://posthog.com/tutorials/web-redact-properties#hiding-customer-ip-address for more information.'),this}rs(e){var t=performance.now();this.historyAutocapture=new Bz(this),this.historyAutocapture.startIfEnabled();var n=[];n.push((()=>{new Yz(this).startIfEnabledOrStop()})),n.push((()=>{var s;this.siteApps=new OH(this),(s=this.siteApps)==null||s.init()})),e||n.push((()=>{this.sessionRecording=new Nk(this),this.sessionRecording.startIfEnabledOrStop()})),this.config.disable_scroll_properties||n.push((()=>{this.scrollManager.startMeasuringScrollPosition()})),n.push((()=>{this.autocapture=new Iz(this),this.autocapture.startIfEnabled()})),n.push((()=>{this.surveys.loadIfEnabled()})),n.push((()=>{this.logs.loadIfEnabled()})),n.push((()=>{this.conversations.loadIfEnabled()})),n.push((()=>{this.productTours=new vH(this),this.productTours.loadIfEnabled()})),n.push((()=>{this.heatmaps=new rH(this),this.heatmaps.startIfEnabled()})),n.push((()=>{this.webVitalsAutocapture=new eH(this)})),n.push((()=>{this.exceptionObserver=new Hz(this),this.exceptionObserver.startIfEnabledOrStop()})),n.push((()=>{this.deadClicksAutocapture=new FR(this,zz),this.deadClicksAutocapture.startIfEnabled()})),n.push((()=>{if(this.os){var s=this.os;this.os=void 0,this.wi(s)}})),this.ls(n,t)}ls(e,t){for(;e.length>0;){if(this.config.__preview_deferred_init_extensions&&performance.now()-t>=30&&e.length>0)return void setTimeout((()=>{this.ls(e,t)}),0);var n=e.shift();if(n)try{n()}catch(i){et.error("Error initializing extension:",i)}}var s=Math.round(performance.now()-t);this.register_for_session({$sdk_debug_extensions_init_method:this.config.__preview_deferred_init_extensions?"deferred":"synchronous",$sdk_debug_extensions_init_time_ms:s}),this.config.__preview_deferred_init_extensions&&et.info("PostHog extensions initialized ("+s+"ms)")}wi(e){var t,n,s,i,c,d,p,m,g;if(!Je||!Je.body)return et.info("document not ready yet, trying again in 500 milliseconds..."),void setTimeout((()=>{this.wi(e)}),500);this.config.__preview_deferred_init_extensions&&(this.os=e),this.compression=void 0,e.supportedCompression&&!this.config.disable_compression&&(this.compression=mr(e.supportedCompression,zl.GZipJS)?zl.GZipJS:mr(e.supportedCompression,zl.Base64)?zl.Base64:void 0),(t=e.analytics)!=null&&t.endpoint&&(this.analyticsDefaultEndpoint=e.analytics.endpoint),this.set_config({person_profiles:this.Vr?this.Vr:"identified_only"}),(n=this.siteApps)==null||n.onRemoteConfig(e),(s=this.sessionRecording)==null||s.onRemoteConfig(e),(i=this.autocapture)==null||i.onRemoteConfig(e),(c=this.heatmaps)==null||c.onRemoteConfig(e),this.surveys.onRemoteConfig(e),this.logs.onRemoteConfig(e),this.conversations.onRemoteConfig(e),(d=this.productTours)==null||d.onRemoteConfig(e),(p=this.webVitalsAutocapture)==null||p.onRemoteConfig(e),(m=this.exceptionObserver)==null||m.onRemoteConfig(e),this.exceptions.onRemoteConfig(e),(g=this.deadClicksAutocapture)==null||g.onRemoteConfig(e)}ns(){try{this.config.loaded(this)}catch(n){et.critical("`loaded` function failed",n)}if(this.us(),this.config.internal_or_test_user_hostname&&bs!=null&&bs.hostname){var e=bs.hostname,t=this.config.internal_or_test_user_hostname;(typeof t=="string"?e===t:t.test(e))&&this.setInternalOrTestUser()}this.config.capture_pageview&&setTimeout((()=>{(this.consent.isOptedIn()||this.config.cookieless_mode==="always")&&this.hs()}),1),new TH(this).load(),this.featureFlags.flags()}us(){var e;this.is_capturing()&&this.config.request_batching&&((e=this.Zr)==null||e.enable())}_dom_loaded(){this.is_capturing()&&Wc(this.__request_queue,(e=>this.ts(e))),this.__request_queue=[],this.us()}_handle_unload(){var e,t;this.surveys.handlePageUnload(),this.config.request_batching?(this.ds()&&this.capture("$pageleave"),(e=this.Zr)==null||e.unload(),(t=this.es)==null||t.unload()):this.ds()&&this.capture("$pageleave",null,{transport:"sendBeacon"})}_send_request(e){this.__loaded&&(ZR?this.__request_queue.push(e):this.rateLimiter.isServerRateLimited(e.batchKey)||(e.transport=e.transport||this.config.api_transport,e.url=Ty(e.url,{ip:this.config.ip?1:0}),e.headers=rt({},this.config.request_headers,e.headers),e.compression=e.compression==="best-available"?this.compression:e.compression,e.disableXHRCredentials=this.config.__preview_disable_xhr_credentials,this.config.__preview_disable_beacon&&(e.disableTransport=["sendBeacon"]),e.fetchOptions=e.fetchOptions||this.config.fetch_options,(t=>{var n,s,i,c=rt({},t);c.timeout=c.timeout||6e4,c.url=Ty(c.url,{_:new Date().getTime().toString(),ver:Ml.LIB_VERSION,compression:c.compression});var d=(n=c.transport)!==null&&n!==void 0?n:"fetch",p=ty.filter((g=>!c.disableTransport||!g.transport||!c.disableTransport.includes(g.transport))),m=(s=(i=mR(p,(g=>g.transport===d)))==null?void 0:i.method)!==null&&s!==void 0?s:p[0].method;if(!m)throw new Error("No available transport method");m(c)})(rt({},e,{callback:t=>{var n,s;this.rateLimiter.checkForLimiting(t),t.statusCode>=400&&((n=(s=this.config).on_request_error)==null||n.call(s,t)),e.callback==null||e.callback(t)}}))))}ts(e){this.es?this.es.retriableRequest(e):this._send_request(e)}_execute_array(e){var t,n=[],s=[],i=[];Wc(e,(d=>{d&&(t=d[0],$r(t)?i.push(d):Gc(d)?d.call(this):$r(d)&&t==="alias"?n.push(d):$r(d)&&t.indexOf("capture")!==-1&&Gc(this[t])?i.push(d):s.push(d))}));var c=function(d,p){Wc(d,(function(m){if($r(m[0])){var g=p;tn(m,(function(x){g=g[x[0]].apply(g,x.slice(1))}))}else this[m[0]].apply(this,m.slice(1))}),p)};c(n,this),c(s,this),c(i,this)}ss(){var e,t;return((e=this.config.bootstrap)==null?void 0:e.featureFlags)&&Object.keys((t=this.config.bootstrap)==null?void 0:t.featureFlags).length>0||!1}push(e){this._execute_array([e])}capture(e,t,n){var s;if(this.__loaded&&this.persistence&&this.sessionPersistence&&this.Zr){if(this.is_capturing())if(!Xe(e)&&Kn(e)){var i=!this.config.opt_out_useragent_filter&&this._is_bot();if(!(i&&!this.config.__preview_capture_bot_pageviews)){var c=n!=null&&n.skip_client_rate_limiting?void 0:this.rateLimiter.clientRateLimitContext();if(c==null||!c.isRateLimited){t!=null&&t.$current_url&&!Kn(t==null?void 0:t.$current_url)&&(et.error("Invalid `$current_url` property provided to `posthog.capture`. Input must be a string. Ignoring provided value."),t==null||delete t.$current_url),this.sessionPersistence.update_search_keyword(),this.config.save_campaign_params&&this.sessionPersistence.update_campaign_params(),this.config.save_referrer&&this.sessionPersistence.update_referrer_info(),(this.config.save_campaign_params||this.config.save_referrer)&&this.persistence.set_initial_person_info();var d=new Date,p=(n==null?void 0:n.timestamp)||d,m=Hc(),g={uuid:m,event:e,properties:this.calculateEventProperties(e,t||{},p,m)};e==="$pageview"&&this.config.__preview_capture_bot_pageviews&&i&&(g.event="$bot_pageview",g.properties.$browser_type="bot"),c&&(g.properties.$lib_rate_limit_remaining_tokens=c.remainingTokens),n!=null&&n.$set&&(g.$set=n==null?void 0:n.$set);var x,b=e!=="$groupidentify",S=this.vs(n==null?void 0:n.$set_once,b);if(S&&(g.$set_once=S),(g=pz(g,n!=null&&n._noTruncate?null:this.config.properties_string_max_length)).timestamp=p,Xe(n==null?void 0:n.timestamp)||(g.properties.$event_time_override_provided=!0,g.properties.$event_time_override_system_time=d),e===xm.DISMISSED||e===xm.SENT){var T=t==null?void 0:t[ew.SURVEY_ID],E=t==null?void 0:t[ew.SURVEY_ITERATION];x={id:T,current_iteration:E},localStorage.getItem(_k(x))||localStorage.setItem(_k(x),"true"),g.$set=rt({},g.$set,{[yH({id:T,current_iteration:E},e===xm.SENT?"responded":"dismissed")]:!0})}else e===xm.SHOWN&&(g.$set=rt({},g.$set,{[ew.SURVEY_LAST_SEEN_DATE]:new Date().toISOString()}));var C=rt({},g.properties.$set,g.$set);if(Zf(C)||this.setPersonPropertiesForFlags(C),!xr(this.config.before_send)){var R=this.cs(g);if(!R)return;g=R}this.bi.emit("eventCaptured",g);var A={method:"POST",url:(s=n==null?void 0:n._url)!==null&&s!==void 0?s:this.requestRouter.endpointFor("api",this.analyticsDefaultEndpoint),data:g,compression:"best-available",batchKey:n==null?void 0:n._batchKey};return!this.config.request_batching||n&&(n==null||!n._batchKey)||n!=null&&n.send_instantly?this.ts(A):this.Zr.enqueue(A),g}et.critical("This capture call is ignored due to client rate limiting.")}}else et.error("No event name provided to posthog.capture")}else et.uninitializedWarning("posthog.capture")}_addCaptureHook(e){return this.on("eventCaptured",(t=>e(t.event,t)))}calculateEventProperties(e,t,n,s,i){if(n=n||new Date,!this.persistence||!this.sessionPersistence)return t;var c=i?void 0:this.persistence.remove_event_timer(e),d=rt({},t);if(d.token=this.config.token,d.$config_defaults=this.config.defaults,(this.config.cookieless_mode=="always"||this.config.cookieless_mode=="on_reject"&&this.consent.isExplicitlyOptedOut())&&(d.$cookieless_mode=!0),e==="$snapshot"){var p=rt({},this.persistence.properties(),this.sessionPersistence.properties());return d.distinct_id=p.distinct_id,(!Kn(d.distinct_id)&&!Wl(d.distinct_id)||Yw(d.distinct_id))&&et.error("Invalid distinct_id for replay event. This indicates a bug in your implementation"),d}var m,g=Zz(this.config.mask_personal_data_properties,this.config.custom_personal_data_properties);if(this.sessionManager){var{sessionId:x,windowId:b}=this.sessionManager.checkAndGetSessionAndWindowId(i,n.getTime());d.$session_id=x,d.$window_id=b}this.sessionPropsManager&&Rn(d,this.sessionPropsManager.getSessionProps());try{var S;this.sessionRecording&&Rn(d,this.sessionRecording.sdkDebugProperties),d.$sdk_debug_retry_queue_size=(S=this.es)==null?void 0:S.length}catch(R){d.$sdk_debug_error_capturing_properties=String(R)}if(this.requestRouter.region===wm.CUSTOM&&(d.$lib_custom_api_host=this.config.api_host),m=e!=="$pageview"||i?e!=="$pageleave"||i?this.pageViewManager.doEvent():this.pageViewManager.doPageLeave(n):this.pageViewManager.doPageView(n,s),d=Rn(d,m),e==="$pageview"&&Je&&(d.title=Je.title),!Xe(c)){var T=n.getTime()-c;d.$duration=parseFloat((T/1e3).toFixed(3))}jo&&this.config.opt_out_useragent_filter&&(d.$browser_type=this._is_bot()?"bot":"browser"),(d=Rn({},g,this.persistence.properties(),this.sessionPersistence.properties(),d)).$is_identified=this._isIdentified(),$r(this.config.property_denylist)?tn(this.config.property_denylist,(function(R){delete d[R]})):et.error("Invalid value for property_denylist config: "+this.config.property_denylist+" or property_blacklist config: "+this.config.property_blacklist);var E=this.config.sanitize_properties;E&&(et.error("sanitize_properties is deprecated. Use before_send instead"),d=E(d,e));var C=this.fs();return d.$process_person_profile=C,C&&!i&&this.ps("_calculate_event_properties"),d}vs(e,t){var n;if(t===void 0&&(t=!0),!this.persistence||!this.fs()||this.qr)return e;var s=this.persistence.get_initial_props(),i=(n=this.sessionPropsManager)==null?void 0:n.getSetOnceProps(),c=Rn({},s,i||{},e||{}),d=this.config.sanitize_properties;return d&&(et.error("sanitize_properties is deprecated. Use before_send instead"),c=d(c,"$set_once")),t&&(this.qr=!0),Zf(c)?void 0:c}register(e,t){var n;(n=this.persistence)==null||n.register(e,t)}register_once(e,t,n){var s;(s=this.persistence)==null||s.register_once(e,t,n)}register_for_session(e){var t;(t=this.sessionPersistence)==null||t.register(e)}unregister(e){var t;(t=this.persistence)==null||t.unregister(e)}unregister_for_session(e){var t;(t=this.sessionPersistence)==null||t.unregister(e)}gs(e,t){this.register({[e]:t})}getFeatureFlag(e,t){return this.featureFlags.getFeatureFlag(e,t)}getFeatureFlagPayload(e){return this.featureFlags.getFeatureFlagPayload(e)}getFeatureFlagResult(e,t){return this.featureFlags.getFeatureFlagResult(e,t)}isFeatureEnabled(e,t){return this.featureFlags.isFeatureEnabled(e,t)}reloadFeatureFlags(){this.featureFlags.reloadFeatureFlags()}updateFlags(e,t,n){var s=n!=null&&n.merge?this.featureFlags.getFlagVariants():{},i=n!=null&&n.merge?this.featureFlags.getFlagPayloads():{},c=rt({},s,e),d=rt({},i,t),p={};for(var[m,g]of Object.entries(c)){var x=typeof g=="string";p[m]={key:m,enabled:!!x||!!g,variant:x?g:void 0,reason:void 0,metadata:Xe(d==null?void 0:d[m])?void 0:{id:0,version:void 0,description:void 0,payload:d[m]}}}this.featureFlags.receivedFeatureFlags({flags:p})}updateEarlyAccessFeatureEnrollment(e,t,n){this.featureFlags.updateEarlyAccessFeatureEnrollment(e,t,n)}getEarlyAccessFeatures(e,t,n){return t===void 0&&(t=!1),this.featureFlags.getEarlyAccessFeatures(e,t,n)}on(e,t){return this.bi.on(e,t)}onFeatureFlags(e){return this.featureFlags.onFeatureFlags(e)}onSurveysLoaded(e){return this.surveys.onSurveysLoaded(e)}onSessionId(e){var t,n;return(t=(n=this.sessionManager)==null?void 0:n.onSessionId(e))!==null&&t!==void 0?t:()=>{}}getSurveys(e,t){t===void 0&&(t=!1),this.surveys.getSurveys(e,t)}getActiveMatchingSurveys(e,t){t===void 0&&(t=!1),this.surveys.getActiveMatchingSurveys(e,t)}renderSurvey(e,t){this.surveys.renderSurvey(e,t)}displaySurvey(e,t){t===void 0&&(t=wH),this.surveys.displaySurvey(e,t)}cancelPendingSurvey(e){this.surveys.cancelPendingSurvey(e)}canRenderSurvey(e){return this.surveys.canRenderSurvey(e)}canRenderSurveyAsync(e,t){return t===void 0&&(t=!1),this.surveys.canRenderSurveyAsync(e,t)}identify(e,t,n){if(!this.__loaded||!this.persistence)return et.uninitializedWarning("posthog.identify");if(Wl(e)&&(e=e.toString(),et.warn("The first argument to posthog.identify was a number, but it should be a string. It has been converted to a string.")),e)if(["distinct_id","distinctid"].includes(e.toLowerCase()))et.critical('The string "'+e+'" was set in posthog.identify which indicates an error. This ID should be unique to the user and not a hardcoded string.');else if(e!==Kp){if(this.ps("posthog.identify")){var s=this.get_distinct_id();if(this.register({$user_id:e}),!this.get_property("$device_id")){var i=s;this.register_once({$had_persisted_distinct_id:!0,$device_id:i},"")}e!==s&&e!==this.get_property(pm)&&(this.unregister(pm),this.register({distinct_id:e}));var c=(this.persistence.get_property($l)||"anonymous")==="anonymous";e!==s&&c?(this.persistence.set_property($l,"identified"),this.setPersonPropertiesForFlags(rt({},n||{},t||{}),!1),this.capture("$identify",{distinct_id:e,$anon_distinct_id:s},{$set:t||{},$set_once:n||{}}),this.Jr=gk(e,t,n),this.featureFlags.setAnonymousDistinctId(s)):(t||n)&&this.setPersonProperties(t,n),e!==s&&(this.reloadFeatureFlags(),this.unregister(xy))}}else et.critical('The string "'+Kp+'" was set in posthog.identify which indicates an error. This ID is only used as a sentinel value.');else et.error("Unique user id has not been set in posthog.identify")}setPersonProperties(e,t){if((e||t)&&this.ps("posthog.setPersonProperties")){var n=gk(this.get_distinct_id(),e,t);this.Jr!==n?(this.setPersonPropertiesForFlags(rt({},t||{},e||{})),this.capture("$set",{$set:e||{},$set_once:t||{}}),this.Jr=n):et.info("A duplicate setPersonProperties call was made with the same properties. It has been ignored.")}}group(e,t,n){if(e&&t){var s=this.getGroups();s[e]!==t&&this.resetGroupPropertiesForFlags(e),this.register({$groups:rt({},s,{[e]:t})}),n&&(this.capture("$groupidentify",{$group_type:e,$group_key:t,$group_set:n}),this.setGroupPropertiesForFlags({[e]:n})),s[e]===t||n||this.reloadFeatureFlags()}else et.error("posthog.group requires a group type and group key")}resetGroups(){this.register({$groups:{}}),this.resetGroupPropertiesForFlags(),this.reloadFeatureFlags()}setPersonPropertiesForFlags(e,t){t===void 0&&(t=!0),this.featureFlags.setPersonPropertiesForFlags(e,t)}resetPersonPropertiesForFlags(){this.featureFlags.resetPersonPropertiesForFlags()}setGroupPropertiesForFlags(e,t){t===void 0&&(t=!0),this.ps("posthog.setGroupPropertiesForFlags")&&this.featureFlags.setGroupPropertiesForFlags(e,t)}resetGroupPropertiesForFlags(e){this.featureFlags.resetGroupPropertiesForFlags(e)}reset(e){var t,n,s,i;if(et.info("reset"),!this.__loaded)return et.uninitializedWarning("posthog.reset");var c=this.get_property("$device_id");if(this.consent.reset(),(t=this.persistence)==null||t.clear(),(n=this.sessionPersistence)==null||n.clear(),this.surveys.reset(),this.featureFlags.reset(),(s=this.persistence)==null||s.set_property($l,"anonymous"),(i=this.sessionManager)==null||i.resetSessionId(),this.Jr=null,this.config.cookieless_mode==="always")this.register_once({distinct_id:Kp,$device_id:null},"");else{var d=this.config.get_device_id(Hc());this.register_once({distinct_id:d,$device_id:e?d:c},"")}this.register({$last_posthog_reset:new Date().toISOString()},1)}get_distinct_id(){return this.get_property("distinct_id")}getGroups(){return this.get_property("$groups")||{}}get_session_id(){var e,t;return(e=(t=this.sessionManager)==null?void 0:t.checkAndGetSessionAndWindowId(!0).sessionId)!==null&&e!==void 0?e:""}get_session_replay_url(e){if(!this.sessionManager)return"";var{sessionId:t,sessionStartTimestamp:n}=this.sessionManager.checkAndGetSessionAndWindowId(!0),s=this.requestRouter.endpointFor("ui","/project/"+this.config.token+"/replay/"+t);if(e!=null&&e.withTimestamp&&n){var i,c=(i=e.timestampLookBack)!==null&&i!==void 0?i:10;if(!n)return s;s+="?t="+Math.max(Math.floor((new Date().getTime()-n)/1e3)-c,0)}return s}alias(e,t){return e===this.get_property(gR)?(et.critical("Attempting to create alias for existing People user - aborting."),-2):this.ps("posthog.alias")?(Xe(t)&&(t=this.get_distinct_id()),e!==t?(this.gs(pm,e),this.capture("$create_alias",{alias:e,distinct_id:t})):(et.warn("alias matches current distinct_id - skipping api call."),this.identify(e),-1)):void 0}set_config(e){var t=rt({},this.config);if(qn(e)){var n,s,i,c,d,p,m;Rn(this.config,Rk(e));var g=this.Qr();(n=this.persistence)==null||n.update_config(this.config,t,g),this.sessionPersistence=this.config.persistence==="sessionStorage"||this.config.persistence==="memory"?this.persistence:new Xx(rt({},this.config,{persistence:"sessionStorage"}),g);var x=this.Kr(this.config.debug);Bl(x)&&(this.config.debug=x),Bl(this.config.debug)&&(this.config.debug?(Ml.DEBUG=!0,gn.H()&&gn.G("ph_debug","true"),et.info("set_config",{config:e,oldConfig:t,newConfig:rt({},this.config)})):(Ml.DEBUG=!1,gn.H()&&gn.V("ph_debug"))),(s=this.exceptionObserver)==null||s.onConfigChange(),(i=this.sessionRecording)==null||i.startIfEnabledOrStop(),(c=this.autocapture)==null||c.startIfEnabled(),(d=this.heatmaps)==null||d.startIfEnabled(),(p=this.exceptionObserver)==null||p.startIfEnabledOrStop(),this.surveys.loadIfEnabled(),this._s(),(m=this.externalIntegrations)==null||m.startIfEnabledOrStop()}}startSessionRecording(e){var t=e===!0,n={sampling:t||!(e==null||!e.sampling),linked_flag:t||!(e==null||!e.linked_flag),url_trigger:t||!(e==null||!e.url_trigger),event_trigger:t||!(e==null||!e.event_trigger)};if(Object.values(n).some(Boolean)){var s,i,c,d,p;(s=this.sessionManager)==null||s.checkAndGetSessionAndWindowId(),n.sampling&&((i=this.sessionRecording)==null||i.overrideSampling()),n.linked_flag&&((c=this.sessionRecording)==null||c.overrideLinkedFlag()),n.url_trigger&&((d=this.sessionRecording)==null||d.overrideTrigger("url")),n.event_trigger&&((p=this.sessionRecording)==null||p.overrideTrigger("event"))}this.set_config({disable_session_recording:!1})}stopSessionRecording(){this.set_config({disable_session_recording:!0})}sessionRecordingStarted(){var e;return!((e=this.sessionRecording)==null||!e.started)}captureException(e,t){var n=new Error("PostHog syntheticException"),s=this.exceptions.buildProperties(e,{handled:!0,syntheticException:n});return this.exceptions.sendExceptionEvent(rt({},s,t))}startExceptionAutocapture(e){this.set_config({capture_exceptions:e==null||e})}stopExceptionAutocapture(){this.set_config({capture_exceptions:!1})}loadToolbar(e){return this.toolbar.loadToolbar(e)}get_property(e){var t;return(t=this.persistence)==null?void 0:t.props[e]}getSessionProperty(e){var t;return(t=this.sessionPersistence)==null?void 0:t.props[e]}toString(){var e,t=(e=this.config.name)!==null&&e!==void 0?e:Jf;return t!==Jf&&(t=Jf+"."+t),t}_isIdentified(){var e,t;return((e=this.persistence)==null?void 0:e.get_property($l))==="identified"||((t=this.sessionPersistence)==null?void 0:t.get_property($l))==="identified"}fs(){var e,t;return!(this.config.person_profiles==="never"||this.config.person_profiles==="identified_only"&&!this._isIdentified()&&Zf(this.getGroups())&&((e=this.persistence)==null||(e=e.props)==null||!e[pm])&&((t=this.persistence)==null||(t=t.props)==null||!t[by]))}ds(){return this.config.capture_pageleave===!0||this.config.capture_pageleave==="if_capture_pageview"&&(this.config.capture_pageview===!0||this.config.capture_pageview==="history_change")}createPersonProfile(){this.fs()||this.ps("posthog.createPersonProfile")&&this.setPersonProperties({},{})}setInternalOrTestUser(){this.ps("posthog.setInternalOrTestUser")&&this.setPersonProperties({$internal_or_test_user:!0})}ps(e){return this.config.person_profiles==="never"?(et.error(e+' was called, but process_person is set to "never". This call will be ignored.'),!1):(this.gs(by,!0),!0)}Qr(){if(this.config.cookieless_mode==="always")return!0;var e=this.consent.isOptedOut(),t=this.config.opt_out_persistence_by_default||this.config.cookieless_mode==="on_reject";return this.config.disable_persistence||e&&!!t}_s(){var e,t,n,s,i=this.Qr();return((e=this.persistence)==null?void 0:e.Pi)!==i&&((n=this.persistence)==null||n.set_disabled(i)),((t=this.sessionPersistence)==null?void 0:t.Pi)!==i&&((s=this.sessionPersistence)==null||s.set_disabled(i)),i}opt_in_capturing(e){var t;if(this.config.cookieless_mode!=="always"){var n,s,i;this.config.cookieless_mode==="on_reject"&&this.consent.isExplicitlyOptedOut()&&(this.reset(!0),(n=this.sessionManager)==null||n.destroy(),(s=this.pageViewManager)==null||s.destroy(),this.sessionManager=new Ck(this),this.pageViewManager=new uk(this),this.persistence&&(this.sessionPropsManager=new Ek(this,this.sessionManager,this.persistence)),this.sessionRecording=new Nk(this),this.sessionRecording.startIfEnabledOrStop()),this.consent.optInOut(!0),this._s(),this.us(),(t=this.sessionRecording)==null||t.startIfEnabledOrStop(),this.config.cookieless_mode=="on_reject"&&this.surveys.loadIfEnabled(),(Xe(e==null?void 0:e.captureEventName)||e!=null&&e.captureEventName)&&this.capture((i=e==null?void 0:e.captureEventName)!==null&&i!==void 0?i:"$opt_in",e==null?void 0:e.captureProperties,{send_instantly:!0}),this.config.capture_pageview&&this.hs()}else et.warn('Consent opt in/out is not valid with cookieless_mode="always" and will be ignored')}opt_out_capturing(){var e,t,n;this.config.cookieless_mode!=="always"?(this.config.cookieless_mode==="on_reject"&&this.consent.isOptedIn()&&this.reset(!0),this.consent.optInOut(!1),this._s(),this.config.cookieless_mode==="on_reject"&&(this.register({distinct_id:Kp,$device_id:null}),(e=this.sessionManager)==null||e.destroy(),(t=this.pageViewManager)==null||t.destroy(),this.sessionManager=void 0,this.sessionPropsManager=void 0,(n=this.sessionRecording)==null||n.stopRecording(),this.sessionRecording=void 0,this.hs())):et.warn('Consent opt in/out is not valid with cookieless_mode="always" and will be ignored')}has_opted_in_capturing(){return this.consent.isOptedIn()}has_opted_out_capturing(){return this.consent.isOptedOut()}get_explicit_consent_status(){var e=this.consent.consent;return e===Ul.GRANTED?"granted":e===Ul.DENIED?"denied":"pending"}is_capturing(){return this.config.cookieless_mode==="always"||(this.config.cookieless_mode==="on_reject"?this.consent.isExplicitlyOptedOut()||this.consent.isOptedIn():!this.has_opted_out_capturing())}clear_opt_in_out_capturing(){this.consent.reset(),this._s()}_is_bot(){return oi?QR(oi,this.config.custom_blocked_useragents):void 0}hs(){Je&&(Je.visibilityState==="visible"?this.Wr||(this.Wr=!0,this.capture("$pageview",{title:Je.title},{send_instantly:!0}),this.Gr&&(Je.removeEventListener("visibilitychange",this.Gr),this.Gr=null)):this.Gr||(this.Gr=this.hs.bind(this),Dn(Je,"visibilitychange",this.Gr)))}debug(e){e===!1?(Ee==null||Ee.console.log("You've disabled debug mode."),this.set_config({debug:!1})):(Ee==null||Ee.console.log("You're now in debug mode. All calls to PostHog will be logged in your console.\nYou can disable this with `posthog.debug(false)`."),this.set_config({debug:!0}))}M(){var e,t,n,s,i,c,d,p=this.Yr||{};return"advanced_disable_flags"in p?!!p.advanced_disable_flags:this.config.advanced_disable_flags!==!1?!!this.config.advanced_disable_flags:this.config.advanced_disable_decide===!0?(et.warn("Config field 'advanced_disable_decide' is deprecated. Please use 'advanced_disable_flags' instead. The old field will be removed in a future major version."),!0):(n="advanced_disable_decide",s=!1,i=et,c=(t="advanced_disable_flags")in(e=p)&&!xr(e[t]),d=n in e&&!xr(e[n]),c?e[t]:d?(i&&i.warn("Config field '"+n+"' is deprecated. Please use '"+t+"' instead. The old field will be removed in a future major version."),e[n]):s)}cs(e){if(xr(this.config.before_send))return e;var t=$r(this.config.before_send)?this.config.before_send:[this.config.before_send],n=e;for(var s of t){if(n=s(n),xr(n)){var i="Event '"+e.event+"' was rejected in beforeSend function";return I8(e.event)?et.warn(i+". This can cause unexpected behavior."):et.info(i),null}n.properties&&!Zf(n.properties)||et.warn("Event '"+e.event+"' has no properties after beforeSend function, this is likely an error.")}return n}getPageViewId(){var e;return(e=this.pageViewManager.Kt)==null?void 0:e.pageViewId}captureTraceFeedback(e,t){this.capture("$ai_feedback",{$ai_trace_id:String(e),$ai_feedback_text:t})}captureTraceMetric(e,t,n){this.capture("$ai_metric",{$ai_trace_id:String(e),$ai_metric_name:t,$ai_metric_value:String(n)})}Kr(e){var t=Bl(e)&&!e,n=gn.H()&&gn.q("ph_debug")==="true";return!t&&(!!n||e)}}(function(r,e){for(var t=0;t<e.length;t++)r.prototype[e[t]]=hz(r.prototype[e[t]])})(r0,["identify"]);var Ak,Ha=(Ak=Nm[Jf]=new r0,(function(){function r(){r.done||(r.done=!0,ZR=!1,tn(Nm,(function(e){e._dom_loaded()})))}Je!=null&&Je.addEventListener?Je.readyState==="complete"?r():Dn(Je,"DOMContentLoaded",r,{capture:!1}):Ee&&et.error("Browser doesn't support `document.addEventListener` so PostHog couldn't be initialized")})(),Ak),eA=w.createContext({client:Ha,bootstrap:void 0});function tA(r,e,t){if(t===void 0&&(t=new WeakMap),r===e)return!0;if(typeof r!="object"||r===null||typeof e!="object"||e===null)return!1;if(t.has(r)&&t.get(r)===e)return!0;t.set(r,e);var n=Object.keys(r),s=Object.keys(e);if(n.length!==s.length)return!1;for(var i=0,c=n;i<c.length;i++){var d=c[i];if(!s.includes(d)||!tA(r[d],e[d],t))return!1}return!0}function HH(r){var e,t,n=r.children,s=r.client,i=r.apiKey,c=r.options,d=w.useRef(null),p=w.useMemo(function(){return s?(i&&console.warn("[PostHog.js] You have provided both `client` and `apiKey` to `PostHogProvider`. `apiKey` will be ignored in favour of `client`."),c&&console.warn("[PostHog.js] You have provided both `client` and `options` to `PostHogProvider`. `options` will be ignored in favour of `client`."),s):(i||console.warn("[PostHog.js] No `apiKey` or `client` were provided to `PostHogProvider`. Using default global `window.posthog` instance. You must initialize it manually. This is not recommended behavior."),Ha)},[s,i,JSON.stringify(c)]);return w.useEffect(function(){if(!s){var m=d.current;m?(i!==m.apiKey&&console.warn("[PostHog.js] You have provided a different `apiKey` to `PostHogProvider` than the one that was already initialized. This is not supported by our provider and we'll keep using the previous key. If you need to toggle between API Keys you need to control the `client` yourself and pass it in as a prop rather than an `apiKey` prop."),c&&!tA(c,m.options)&&Ha.set_config(c),d.current={apiKey:i,options:c??{}}):(Ha.__loaded&&console.warn("[PostHog.js] `posthog` was already loaded elsewhere. This may cause issues."),Ha.init(i,c),d.current={apiKey:i,options:c??{}})}},[s,i,JSON.stringify(c)]),gr.createElement(eA.Provider,{value:{client:p,bootstrap:(e=c==null?void 0:c.bootstrap)!==null&&e!==void 0?e:(t=s==null?void 0:s.config)===null||t===void 0?void 0:t.bootstrap}},n)}var rw=function(r){return typeof r=="function"},vb=function(r,e){return vb=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])},vb(r,e)};function BH(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");vb(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var GH={componentStack:null,exceptionEvent:null,error:null},WH={INVALID_FALLBACK:"[PostHog.js][PostHogErrorBoundary] Invalid fallback prop, provide a valid React element or a function that returns a valid React element."};(function(r){BH(e,r);function e(t){var n=r.call(this,t)||this;return n.state=GH,n}return e.prototype.componentDidCatch=function(t,n){var s=this.props.additionalProperties,i;rw(s)?i=s(t):typeof s=="object"&&(i=s);var c=this.context.client,d=c.captureException(t,i),p=n.componentStack;this.setState({error:t,componentStack:p??null,exceptionEvent:d})},e.prototype.render=function(){var t=this.props,n=t.children,s=t.fallback,i=this.state;if(i.componentStack==null)return rw(n)?n():n;var c=rw(s)?gr.createElement(s,{error:i.error,componentStack:i.componentStack,exceptionEvent:i.exceptionEvent}):s;return gr.isValidElement(c)?c:(console.warn(WH.INVALID_FALLBACK),gr.createElement(gr.Fragment,null))},e.contextType=eA,e})(gr.Component);function zr(){var e;const r=w.useContext(Z_);if(r.isLoading)return{debug:async()=>{},info:async()=>{},warn:async()=>{},error:async()=>{}};if(!((e=r.services)!=null&&e.logging))throw new Error("Logging provider not available. Make sure PlatformProvider is wrapping your component.");return r.services.logging}function Ik(r){try{const e=r.split(".")[1];return JSON.parse(atob(e.replace(/-/g,"+").replace(/_/g,"/"))).email??null}catch{return null}}const VH=({children:r})=>{const e=Ya(),t=zr();return w.useEffect(()=>{if(typeof window>"u"||!Mw){console.warn(" PostHog: Not initialized - missing or invalid key");return}(async()=>{const s=await Mm(t),i=s!=null&&s.id_token?Ik(s.id_token):null;Ha.init(Mw,{api_host:sT,autocapture:!0,capture_pageview:!0,capture_pageleave:!0,capture_dead_clicks:!1,disable_session_recording:!0,loaded:c=>{i&&c.identify(i,{email:i}),console.log("PostHog: Initialized successfully")},debug:J1==="dev"})})()},[]),w.useEffect(()=>{var s;const n=i=>{"token"in i&&(i.token.newValue?Mm(t).then(c=>{const d=c!=null&&c.id_token?Ik(c.id_token):null;d&&Ha.identify(d,{email:d})}):Ha.reset())};return(s=e==null?void 0:e.onChanged)==null||s.call(e,n),()=>{var i;(i=e==null?void 0:e.removeChangeListener)==null||i.call(e,n)}},[e,t]),u.jsx(HH,{client:Ha,children:r})},an=w.forwardRef(({className:r,type:e,...t},n)=>u.jsx("input",{type:e,className:Fr("flex h-10 w-full rounded-md border border-neutral-200 bg-white px-3 py-2 text-base text-neutral-950 ring-offset-white file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-neutral-950 placeholder:text-neutral-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm dark:border-border dark:bg-card dark:text-gray-100 dark:ring-offset-neutral-950 dark:file:text-neutral-50 dark:placeholder:text-neutral-400 dark:focus-visible:ring-primary",r),ref:n,...t}));an.displayName="Input";const Pk=r=>typeof r=="boolean"?`${r}`:r===0?"0":r,jk=TT,hS=(r,e)=>t=>{var n;if((e==null?void 0:e.variants)==null)return jk(r,t==null?void 0:t.class,t==null?void 0:t.className);const{variants:s,defaultVariants:i}=e,c=Object.keys(s).map(m=>{const g=t==null?void 0:t[m],x=i==null?void 0:i[m];if(g===null)return null;const b=Pk(g)||Pk(x);return s[m][b]}),d=t&&Object.entries(t).reduce((m,g)=>{let[x,b]=g;return b===void 0||(m[x]=b),m},{}),p=e==null||(n=e.compoundVariants)===null||n===void 0?void 0:n.reduce((m,g)=>{let{class:x,className:b,...S}=g;return Object.entries(S).every(T=>{let[E,C]=T;return Array.isArray(C)?C.includes({...i,...d}[E]):{...i,...d}[E]===C})?[...m,x,b]:m},[]);return jk(r,c,p,t==null?void 0:t.class,t==null?void 0:t.className)},qH=hS("rounded-lg border border-neutral-200 bg-white text-neutral-950 shadow-sm dark:border-border dark:bg-card dark:text-card-foreground",{variants:{variant:{default:"",TemplateCard:"",ReferenceSourcesCard:"",IntegrationsCard:""}},defaultVariants:{variant:"default"}}),Es=w.forwardRef(({className:r,variant:e,...t},n)=>u.jsx("div",{ref:n,className:Fr(qH({variant:e,className:r})),...t}));Es.displayName="Card";const io=w.forwardRef(({className:r,cardVariant:e,...t},n)=>u.jsx("div",{ref:n,className:Fr(e==="TemplateCard"?"flex flex-col space-y-1 p-4":"flex flex-col space-y-1.5 p-6",r),...t}));io.displayName="CardHeader";const ao=w.forwardRef(({className:r,...e},t)=>u.jsx("h3",{ref:t,className:Fr("font-semibold leading-none tracking-tight",r),...e}));ao.displayName="CardTitle";const KH=w.forwardRef(({className:r,...e},t)=>u.jsx("p",{ref:t,className:Fr("text-sm text-neutral-500 dark:text-neutral-400",r),...e}));KH.displayName="CardDescription";const Cs=w.forwardRef(({className:r,cardVariant:e,...t},n)=>u.jsx("div",{ref:n,className:Fr(e==="TemplateCard"?"p-0 pt-0":"p-6 pt-0",r),...t}));Cs.displayName="CardContent";const YH=w.forwardRef(({className:r,...e},t)=>u.jsx("div",{ref:t,className:Fr("flex items-center p-6 pt-0",r),...e}));YH.displayName="CardFooter";function Fk(r,e){if(typeof r=="function")return r(e);r!=null&&(r.current=e)}function eu(...r){return e=>{let t=!1;const n=r.map(s=>{const i=Fk(s,e);return!t&&typeof i=="function"&&(t=!0),i});if(t)return()=>{for(let s=0;s<n.length;s++){const i=n[s];typeof i=="function"?i():Fk(r[s],null)}}}}function Ln(...r){return w.useCallback(eu(...r),r)}var JH=Symbol.for("react.lazy"),Ay=jb[" use ".trim().toString()];function XH(r){return typeof r=="object"&&r!==null&&"then"in r}function rA(r){return r!=null&&typeof r=="object"&&"$$typeof"in r&&r.$$typeof===JH&&"_payload"in r&&XH(r._payload)}function QH(r){const e=eB(r),t=w.forwardRef((n,s)=>{let{children:i,...c}=n;rA(i)&&typeof Ay=="function"&&(i=Ay(i._payload));const d=w.Children.toArray(i),p=d.find(rB);if(p){const m=p.props.children,g=d.map(x=>x===p?w.Children.count(m)>1?w.Children.only(null):w.isValidElement(m)?m.props.children:null:x);return u.jsx(e,{...c,ref:s,children:w.isValidElement(m)?w.cloneElement(m,void 0,g):null})}return u.jsx(e,{...c,ref:s,children:i})});return t.displayName=`${r}.Slot`,t}var ZH=QH("Slot");function eB(r){const e=w.forwardRef((t,n)=>{let{children:s,...i}=t;if(rA(s)&&typeof Ay=="function"&&(s=Ay(s._payload)),w.isValidElement(s)){const c=sB(s),d=nB(i,s.props);return s.type!==w.Fragment&&(d.ref=n?eu(n,c):c),w.cloneElement(s,d)}return w.Children.count(s)>1?w.Children.only(null):null});return e.displayName=`${r}.SlotClone`,e}var tB=Symbol("radix.slottable");function rB(r){return w.isValidElement(r)&&typeof r.type=="function"&&"__radixId"in r.type&&r.type.__radixId===tB}function nB(r,e){const t={...e};for(const n in e){const s=r[n],i=e[n];/^on[A-Z]/.test(n)?s&&i?t[n]=(...d)=>{const p=i(...d);return s(...d),p}:s&&(t[n]=s):n==="style"?t[n]={...s,...i}:n==="className"&&(t[n]=[s,i].filter(Boolean).join(" "))}return{...r,...t}}function sB(r){var n,s;let e=(n=Object.getOwnPropertyDescriptor(r.props,"ref"))==null?void 0:n.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=(s=Object.getOwnPropertyDescriptor(r,"ref"))==null?void 0:s.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}const oB=hS("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-white transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 dark:ring-offset-neutral-950 dark:focus-visible:ring-primary",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90 dark:bg-primary dark:text-primary-foreground dark:hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90 dark:bg-destructive dark:text-destructive-foreground dark:hover:bg-destructive/90",outline:"border border-neutral-200 bg-background hover:bg-accent hover:text-accent-foreground dark:border-neutral-800 dark:bg-background dark:hover:bg-accent dark:hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80 dark:bg-secondary dark:text-secondary-foreground dark:hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent dark:hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline dark:text-primary"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),We=w.forwardRef(({className:r,variant:e,size:t,asChild:n=!1,...s},i)=>{const c=n?ZH:"button";return u.jsx(c,{className:Fr(oB({variant:e,size:t,className:r})),ref:i,...s})});We.displayName="Button";/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iB=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),nA=(...r)=>r.filter((e,t,n)=>!!e&&n.indexOf(e)===t).join(" ");/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var aB={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lB=w.forwardRef(({color:r="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:n,className:s="",children:i,iconNode:c,...d},p)=>w.createElement("svg",{ref:p,...aB,width:e,height:e,stroke:r,strokeWidth:n?Number(t)*24/Number(e):t,className:nA("lucide",s),...d},[...c.map(([m,g])=>w.createElement(m,g)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ir=(r,e)=>{const t=w.forwardRef(({className:n,...s},i)=>w.createElement(lB,{ref:i,iconNode:e,className:nA(`lucide-${iB(r)}`,n),...s}));return t.displayName=`${r}`,t};/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pS=ir("ArrowDownToLine",[["path",{d:"M12 17V3",key:"1cwfxf"}],["path",{d:"m6 11 6 6 6-6",key:"12ii2o"}],["path",{d:"M19 21H5",key:"150jfl"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tm=ir("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cB=ir("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sA=ir("Briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nw=ir("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gf=ir("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uB=ir("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ws=ir("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ry=ir("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ov=ir("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qm=ir("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qc=ir("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dB=ir("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dv=ir("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fB=ir("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hB=ir("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ba=ir("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pB=ir("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mB=ir("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ld=ir("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gB=ir("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sw=ir("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vB=ir("Folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yB=ir("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xB=ir("ListTodo",[["rect",{x:"3",y:"5",width:"6",height:"6",rx:"1",key:"1defrl"}],["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ii=ir("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jc=ir("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wB=ir("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ok=ir("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bB=ir("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _B=ir("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SB=ir("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dk=ir("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EB=ir("Presentation",[["path",{d:"M2 3h20",key:"91anmk"}],["path",{d:"M21 3v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V3",key:"2k9sn8"}],["path",{d:"m7 21 5-5 5 5",key:"bip4we"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Do=ir("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CB=ir("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lo=ir("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ih=ir("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iy=ir("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oA=ir("WifiOff",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oi=ir("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function Lt(r,e,{checkForDefaultPrevented:t=!0}={}){return function(s){if(r==null||r(s),t===!1||!s.defaultPrevented)return e==null?void 0:e(s)}}function kB(r,e){const t=w.createContext(e),n=i=>{const{children:c,...d}=i,p=w.useMemo(()=>d,Object.values(d));return u.jsx(t.Provider,{value:p,children:c})};n.displayName=r+"Provider";function s(i){const c=w.useContext(t);if(c)return c;if(e!==void 0)return e;throw new Error(`\`${i}\` must be used within \`${r}\``)}return[n,s]}function Ja(r,e=[]){let t=[];function n(i,c){const d=w.createContext(c),p=t.length;t=[...t,c];const m=x=>{var R;const{scope:b,children:S,...T}=x,E=((R=b==null?void 0:b[r])==null?void 0:R[p])||d,C=w.useMemo(()=>T,Object.values(T));return u.jsx(E.Provider,{value:C,children:S})};m.displayName=i+"Provider";function g(x,b){var E;const S=((E=b==null?void 0:b[r])==null?void 0:E[p])||d,T=w.useContext(S);if(T)return T;if(c!==void 0)return c;throw new Error(`\`${x}\` must be used within \`${i}\``)}return[m,g]}const s=()=>{const i=t.map(c=>w.createContext(c));return function(d){const p=(d==null?void 0:d[r])||i;return w.useMemo(()=>({[`__scope${r}`]:{...d,[r]:p}}),[d,p])}};return s.scopeName=r,[n,NB(s,...e)]}function NB(...r){const e=r[0];if(r.length===1)return e;const t=()=>{const n=r.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const c=n.reduce((d,{useScope:p,scopeName:m})=>{const x=p(i)[`__scope${m}`];return{...d,...x}},{});return w.useMemo(()=>({[`__scope${e.scopeName}`]:c}),[c])}};return t.scopeName=e.scopeName,t}var Vl=globalThis!=null&&globalThis.document?w.useLayoutEffect:()=>{},TB=jb[" useInsertionEffect ".trim().toString()]||Vl;function tu({prop:r,defaultProp:e,onChange:t=()=>{},caller:n}){const[s,i,c]=RB({defaultProp:e,onChange:t}),d=r!==void 0,p=d?r:s;{const g=w.useRef(r!==void 0);w.useEffect(()=>{const x=g.current;x!==d&&console.warn(`${n} is changing from ${x?"controlled":"uncontrolled"} to ${d?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),g.current=d},[d,n])}const m=w.useCallback(g=>{var x;if(d){const b=AB(g)?g(r):g;b!==r&&((x=c.current)==null||x.call(c,b))}else i(g)},[d,r,i,c]);return[p,m]}function RB({defaultProp:r,onChange:e}){const[t,n]=w.useState(r),s=w.useRef(t),i=w.useRef(e);return TB(()=>{i.current=e},[e]),w.useEffect(()=>{var c;s.current!==t&&((c=i.current)==null||c.call(i,t),s.current=t)},[t,s]),[t,n,i]}function AB(r){return typeof r=="function"}const IB=["top","right","bottom","left"],Xc=Math.min,si=Math.max,Py=Math.round,Lv=Math.floor,qa=r=>({x:r,y:r}),PB={left:"right",right:"left",bottom:"top",top:"bottom"},jB={start:"end",end:"start"};function yb(r,e,t){return si(r,Xc(e,t))}function ql(r,e){return typeof r=="function"?r(e):r}function Kl(r){return r.split("-")[0]}function Sh(r){return r.split("-")[1]}function mS(r){return r==="x"?"y":"x"}function gS(r){return r==="y"?"height":"width"}const FB=new Set(["top","bottom"]);function Va(r){return FB.has(Kl(r))?"y":"x"}function vS(r){return mS(Va(r))}function OB(r,e,t){t===void 0&&(t=!1);const n=Sh(r),s=vS(r),i=gS(s);let c=s==="x"?n===(t?"end":"start")?"right":"left":n==="start"?"bottom":"top";return e.reference[i]>e.floating[i]&&(c=jy(c)),[c,jy(c)]}function DB(r){const e=jy(r);return[xb(r),e,xb(e)]}function xb(r){return r.replace(/start|end/g,e=>jB[e])}const Lk=["left","right"],Mk=["right","left"],LB=["top","bottom"],MB=["bottom","top"];function $B(r,e,t){switch(r){case"top":case"bottom":return t?e?Mk:Lk:e?Lk:Mk;case"left":case"right":return e?LB:MB;default:return[]}}function UB(r,e,t,n){const s=Sh(r);let i=$B(Kl(r),t==="start",n);return s&&(i=i.map(c=>c+"-"+s),e&&(i=i.concat(i.map(xb)))),i}function jy(r){return r.replace(/left|right|bottom|top/g,e=>PB[e])}function zB(r){return{top:0,right:0,bottom:0,left:0,...r}}function iA(r){return typeof r!="number"?zB(r):{top:r,right:r,bottom:r,left:r}}function Fy(r){const{x:e,y:t,width:n,height:s}=r;return{width:n,height:s,top:t,left:e,right:e+n,bottom:t+s,x:e,y:t}}function $k(r,e,t){let{reference:n,floating:s}=r;const i=Va(e),c=vS(e),d=gS(c),p=Kl(e),m=i==="y",g=n.x+n.width/2-s.width/2,x=n.y+n.height/2-s.height/2,b=n[d]/2-s[d]/2;let S;switch(p){case"top":S={x:g,y:n.y-s.height};break;case"bottom":S={x:g,y:n.y+n.height};break;case"right":S={x:n.x+n.width,y:x};break;case"left":S={x:n.x-s.width,y:x};break;default:S={x:n.x,y:n.y}}switch(Sh(e)){case"start":S[c]-=b*(t&&m?-1:1);break;case"end":S[c]+=b*(t&&m?-1:1);break}return S}async function HB(r,e){var t;e===void 0&&(e={});const{x:n,y:s,platform:i,rects:c,elements:d,strategy:p}=r,{boundary:m="clippingAncestors",rootBoundary:g="viewport",elementContext:x="floating",altBoundary:b=!1,padding:S=0}=ql(e,r),T=iA(S),C=d[b?x==="floating"?"reference":"floating":x],R=Fy(await i.getClippingRect({element:(t=await(i.isElement==null?void 0:i.isElement(C)))==null||t?C:C.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(d.floating)),boundary:m,rootBoundary:g,strategy:p})),A=x==="floating"?{x:n,y:s,width:c.floating.width,height:c.floating.height}:c.reference,F=await(i.getOffsetParent==null?void 0:i.getOffsetParent(d.floating)),P=await(i.isElement==null?void 0:i.isElement(F))?await(i.getScale==null?void 0:i.getScale(F))||{x:1,y:1}:{x:1,y:1},L=Fy(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:d,rect:A,offsetParent:F,strategy:p}):A);return{top:(R.top-L.top+T.top)/P.y,bottom:(L.bottom-R.bottom+T.bottom)/P.y,left:(R.left-L.left+T.left)/P.x,right:(L.right-R.right+T.right)/P.x}}const BB=async(r,e,t)=>{const{placement:n="bottom",strategy:s="absolute",middleware:i=[],platform:c}=t,d=i.filter(Boolean),p=await(c.isRTL==null?void 0:c.isRTL(e));let m=await c.getElementRects({reference:r,floating:e,strategy:s}),{x:g,y:x}=$k(m,n,p),b=n,S={},T=0;for(let C=0;C<d.length;C++){var E;const{name:R,fn:A}=d[C],{x:F,y:P,data:L,reset:G}=await A({x:g,y:x,initialPlacement:n,placement:b,strategy:s,middlewareData:S,rects:m,platform:{...c,detectOverflow:(E=c.detectOverflow)!=null?E:HB},elements:{reference:r,floating:e}});g=F??g,x=P??x,S={...S,[R]:{...S[R],...L}},G&&T<=50&&(T++,typeof G=="object"&&(G.placement&&(b=G.placement),G.rects&&(m=G.rects===!0?await c.getElementRects({reference:r,floating:e,strategy:s}):G.rects),{x:g,y:x}=$k(m,b,p)),C=-1)}return{x:g,y:x,placement:b,strategy:s,middlewareData:S}},GB=r=>({name:"arrow",options:r,async fn(e){const{x:t,y:n,placement:s,rects:i,platform:c,elements:d,middlewareData:p}=e,{element:m,padding:g=0}=ql(r,e)||{};if(m==null)return{};const x=iA(g),b={x:t,y:n},S=vS(s),T=gS(S),E=await c.getDimensions(m),C=S==="y",R=C?"top":"left",A=C?"bottom":"right",F=C?"clientHeight":"clientWidth",P=i.reference[T]+i.reference[S]-b[S]-i.floating[T],L=b[S]-i.reference[S],G=await(c.getOffsetParent==null?void 0:c.getOffsetParent(m));let U=G?G[F]:0;(!U||!await(c.isElement==null?void 0:c.isElement(G)))&&(U=d.floating[F]||i.floating[T]);const V=P/2-L/2,Q=U/2-E[T]/2-1,fe=Xc(x[R],Q),B=Xc(x[A],Q),ee=fe,ve=U-E[T]-B,ce=U/2-E[T]/2+V,ne=yb(ee,ce,ve),xe=!p.arrow&&Sh(s)!=null&&ce!==ne&&i.reference[T]/2-(ce<ee?fe:B)-E[T]/2<0,J=xe?ce<ee?ce-ee:ce-ve:0;return{[S]:b[S]+J,data:{[S]:ne,centerOffset:ce-ne-J,...xe&&{alignmentOffset:J}},reset:xe}}}),WB=function(r){return r===void 0&&(r={}),{name:"flip",options:r,async fn(e){var t,n;const{placement:s,middlewareData:i,rects:c,initialPlacement:d,platform:p,elements:m}=e,{mainAxis:g=!0,crossAxis:x=!0,fallbackPlacements:b,fallbackStrategy:S="bestFit",fallbackAxisSideDirection:T="none",flipAlignment:E=!0,...C}=ql(r,e);if((t=i.arrow)!=null&&t.alignmentOffset)return{};const R=Kl(s),A=Va(d),F=Kl(d)===d,P=await(p.isRTL==null?void 0:p.isRTL(m.floating)),L=b||(F||!E?[jy(d)]:DB(d)),G=T!=="none";!b&&G&&L.push(...UB(d,E,T,P));const U=[d,...L],V=await p.detectOverflow(e,C),Q=[];let fe=((n=i.flip)==null?void 0:n.overflows)||[];if(g&&Q.push(V[R]),x){const ce=OB(s,c,P);Q.push(V[ce[0]],V[ce[1]])}if(fe=[...fe,{placement:s,overflows:Q}],!Q.every(ce=>ce<=0)){var B,ee;const ce=(((B=i.flip)==null?void 0:B.index)||0)+1,ne=U[ce];if(ne&&(!(x==="alignment"?A!==Va(ne):!1)||fe.every(X=>Va(X.placement)===A?X.overflows[0]>0:!0)))return{data:{index:ce,overflows:fe},reset:{placement:ne}};let xe=(ee=fe.filter(J=>J.overflows[0]<=0).sort((J,X)=>J.overflows[1]-X.overflows[1])[0])==null?void 0:ee.placement;if(!xe)switch(S){case"bestFit":{var ve;const J=(ve=fe.filter(X=>{if(G){const z=Va(X.placement);return z===A||z==="y"}return!0}).map(X=>[X.placement,X.overflows.filter(z=>z>0).reduce((z,q)=>z+q,0)]).sort((X,z)=>X[1]-z[1])[0])==null?void 0:ve[0];J&&(xe=J);break}case"initialPlacement":xe=d;break}if(s!==xe)return{reset:{placement:xe}}}return{}}}};function Uk(r,e){return{top:r.top-e.height,right:r.right-e.width,bottom:r.bottom-e.height,left:r.left-e.width}}function zk(r){return IB.some(e=>r[e]>=0)}const VB=function(r){return r===void 0&&(r={}),{name:"hide",options:r,async fn(e){const{rects:t,platform:n}=e,{strategy:s="referenceHidden",...i}=ql(r,e);switch(s){case"referenceHidden":{const c=await n.detectOverflow(e,{...i,elementContext:"reference"}),d=Uk(c,t.reference);return{data:{referenceHiddenOffsets:d,referenceHidden:zk(d)}}}case"escaped":{const c=await n.detectOverflow(e,{...i,altBoundary:!0}),d=Uk(c,t.floating);return{data:{escapedOffsets:d,escaped:zk(d)}}}default:return{}}}}},aA=new Set(["left","top"]);async function qB(r,e){const{placement:t,platform:n,elements:s}=r,i=await(n.isRTL==null?void 0:n.isRTL(s.floating)),c=Kl(t),d=Sh(t),p=Va(t)==="y",m=aA.has(c)?-1:1,g=i&&p?-1:1,x=ql(e,r);let{mainAxis:b,crossAxis:S,alignmentAxis:T}=typeof x=="number"?{mainAxis:x,crossAxis:0,alignmentAxis:null}:{mainAxis:x.mainAxis||0,crossAxis:x.crossAxis||0,alignmentAxis:x.alignmentAxis};return d&&typeof T=="number"&&(S=d==="end"?T*-1:T),p?{x:S*g,y:b*m}:{x:b*m,y:S*g}}const KB=function(r){return r===void 0&&(r=0),{name:"offset",options:r,async fn(e){var t,n;const{x:s,y:i,placement:c,middlewareData:d}=e,p=await qB(e,r);return c===((t=d.offset)==null?void 0:t.placement)&&(n=d.arrow)!=null&&n.alignmentOffset?{}:{x:s+p.x,y:i+p.y,data:{...p,placement:c}}}}},YB=function(r){return r===void 0&&(r={}),{name:"shift",options:r,async fn(e){const{x:t,y:n,placement:s,platform:i}=e,{mainAxis:c=!0,crossAxis:d=!1,limiter:p={fn:R=>{let{x:A,y:F}=R;return{x:A,y:F}}},...m}=ql(r,e),g={x:t,y:n},x=await i.detectOverflow(e,m),b=Va(Kl(s)),S=mS(b);let T=g[S],E=g[b];if(c){const R=S==="y"?"top":"left",A=S==="y"?"bottom":"right",F=T+x[R],P=T-x[A];T=yb(F,T,P)}if(d){const R=b==="y"?"top":"left",A=b==="y"?"bottom":"right",F=E+x[R],P=E-x[A];E=yb(F,E,P)}const C=p.fn({...e,[S]:T,[b]:E});return{...C,data:{x:C.x-t,y:C.y-n,enabled:{[S]:c,[b]:d}}}}}},JB=function(r){return r===void 0&&(r={}),{options:r,fn(e){const{x:t,y:n,placement:s,rects:i,middlewareData:c}=e,{offset:d=0,mainAxis:p=!0,crossAxis:m=!0}=ql(r,e),g={x:t,y:n},x=Va(s),b=mS(x);let S=g[b],T=g[x];const E=ql(d,e),C=typeof E=="number"?{mainAxis:E,crossAxis:0}:{mainAxis:0,crossAxis:0,...E};if(p){const F=b==="y"?"height":"width",P=i.reference[b]-i.floating[F]+C.mainAxis,L=i.reference[b]+i.reference[F]-C.mainAxis;S<P?S=P:S>L&&(S=L)}if(m){var R,A;const F=b==="y"?"width":"height",P=aA.has(Kl(s)),L=i.reference[x]-i.floating[F]+(P&&((R=c.offset)==null?void 0:R[x])||0)+(P?0:C.crossAxis),G=i.reference[x]+i.reference[F]+(P?0:((A=c.offset)==null?void 0:A[x])||0)-(P?C.crossAxis:0);T<L?T=L:T>G&&(T=G)}return{[b]:S,[x]:T}}}},XB=function(r){return r===void 0&&(r={}),{name:"size",options:r,async fn(e){var t,n;const{placement:s,rects:i,platform:c,elements:d}=e,{apply:p=()=>{},...m}=ql(r,e),g=await c.detectOverflow(e,m),x=Kl(s),b=Sh(s),S=Va(s)==="y",{width:T,height:E}=i.floating;let C,R;x==="top"||x==="bottom"?(C=x,R=b===(await(c.isRTL==null?void 0:c.isRTL(d.floating))?"start":"end")?"left":"right"):(R=x,C=b==="end"?"top":"bottom");const A=E-g.top-g.bottom,F=T-g.left-g.right,P=Xc(E-g[C],A),L=Xc(T-g[R],F),G=!e.middlewareData.shift;let U=P,V=L;if((t=e.middlewareData.shift)!=null&&t.enabled.x&&(V=F),(n=e.middlewareData.shift)!=null&&n.enabled.y&&(U=A),G&&!b){const fe=si(g.left,0),B=si(g.right,0),ee=si(g.top,0),ve=si(g.bottom,0);S?V=T-2*(fe!==0||B!==0?fe+B:si(g.left,g.right)):U=E-2*(ee!==0||ve!==0?ee+ve:si(g.top,g.bottom))}await p({...e,availableWidth:V,availableHeight:U});const Q=await c.getDimensions(d.floating);return T!==Q.width||E!==Q.height?{reset:{rects:!0}}:{}}}};function n0(){return typeof window<"u"}function Eh(r){return lA(r)?(r.nodeName||"").toLowerCase():"#document"}function ai(r){var e;return(r==null||(e=r.ownerDocument)==null?void 0:e.defaultView)||window}function Xa(r){var e;return(e=(lA(r)?r.ownerDocument:r.document)||window.document)==null?void 0:e.documentElement}function lA(r){return n0()?r instanceof Node||r instanceof ai(r).Node:!1}function oa(r){return n0()?r instanceof Element||r instanceof ai(r).Element:!1}function Ka(r){return n0()?r instanceof HTMLElement||r instanceof ai(r).HTMLElement:!1}function Hk(r){return!n0()||typeof ShadowRoot>"u"?!1:r instanceof ShadowRoot||r instanceof ai(r).ShadowRoot}const QB=new Set(["inline","contents"]);function cg(r){const{overflow:e,overflowX:t,overflowY:n,display:s}=ia(r);return/auto|scroll|overlay|hidden|clip/.test(e+n+t)&&!QB.has(s)}const ZB=new Set(["table","td","th"]);function eG(r){return ZB.has(Eh(r))}const tG=[":popover-open",":modal"];function s0(r){return tG.some(e=>{try{return r.matches(e)}catch{return!1}})}const rG=["transform","translate","scale","rotate","perspective"],nG=["transform","translate","scale","rotate","perspective","filter"],sG=["paint","layout","strict","content"];function yS(r){const e=xS(),t=oa(r)?ia(r):r;return rG.some(n=>t[n]?t[n]!=="none":!1)||(t.containerType?t.containerType!=="normal":!1)||!e&&(t.backdropFilter?t.backdropFilter!=="none":!1)||!e&&(t.filter?t.filter!=="none":!1)||nG.some(n=>(t.willChange||"").includes(n))||sG.some(n=>(t.contain||"").includes(n))}function oG(r){let e=Qc(r);for(;Ka(e)&&!gh(e);){if(yS(e))return e;if(s0(e))return null;e=Qc(e)}return null}function xS(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const iG=new Set(["html","body","#document"]);function gh(r){return iG.has(Eh(r))}function ia(r){return ai(r).getComputedStyle(r)}function o0(r){return oa(r)?{scrollLeft:r.scrollLeft,scrollTop:r.scrollTop}:{scrollLeft:r.scrollX,scrollTop:r.scrollY}}function Qc(r){if(Eh(r)==="html")return r;const e=r.assignedSlot||r.parentNode||Hk(r)&&r.host||Xa(r);return Hk(e)?e.host:e}function cA(r){const e=Qc(r);return gh(e)?r.ownerDocument?r.ownerDocument.body:r.body:Ka(e)&&cg(e)?e:cA(e)}function Km(r,e,t){var n;e===void 0&&(e=[]),t===void 0&&(t=!0);const s=cA(r),i=s===((n=r.ownerDocument)==null?void 0:n.body),c=ai(s);if(i){const d=wb(c);return e.concat(c,c.visualViewport||[],cg(s)?s:[],d&&t?Km(d):[])}return e.concat(s,Km(s,[],t))}function wb(r){return r.parent&&Object.getPrototypeOf(r.parent)?r.frameElement:null}function uA(r){const e=ia(r);let t=parseFloat(e.width)||0,n=parseFloat(e.height)||0;const s=Ka(r),i=s?r.offsetWidth:t,c=s?r.offsetHeight:n,d=Py(t)!==i||Py(n)!==c;return d&&(t=i,n=c),{width:t,height:n,$:d}}function wS(r){return oa(r)?r:r.contextElement}function ah(r){const e=wS(r);if(!Ka(e))return qa(1);const t=e.getBoundingClientRect(),{width:n,height:s,$:i}=uA(e);let c=(i?Py(t.width):t.width)/n,d=(i?Py(t.height):t.height)/s;return(!c||!Number.isFinite(c))&&(c=1),(!d||!Number.isFinite(d))&&(d=1),{x:c,y:d}}const aG=qa(0);function dA(r){const e=ai(r);return!xS()||!e.visualViewport?aG:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function lG(r,e,t){return e===void 0&&(e=!1),!t||e&&t!==ai(r)?!1:e}function fd(r,e,t,n){e===void 0&&(e=!1),t===void 0&&(t=!1);const s=r.getBoundingClientRect(),i=wS(r);let c=qa(1);e&&(n?oa(n)&&(c=ah(n)):c=ah(r));const d=lG(i,t,n)?dA(i):qa(0);let p=(s.left+d.x)/c.x,m=(s.top+d.y)/c.y,g=s.width/c.x,x=s.height/c.y;if(i){const b=ai(i),S=n&&oa(n)?ai(n):n;let T=b,E=wb(T);for(;E&&n&&S!==T;){const C=ah(E),R=E.getBoundingClientRect(),A=ia(E),F=R.left+(E.clientLeft+parseFloat(A.paddingLeft))*C.x,P=R.top+(E.clientTop+parseFloat(A.paddingTop))*C.y;p*=C.x,m*=C.y,g*=C.x,x*=C.y,p+=F,m+=P,T=ai(E),E=wb(T)}}return Fy({width:g,height:x,x:p,y:m})}function i0(r,e){const t=o0(r).scrollLeft;return e?e.left+t:fd(Xa(r)).left+t}function fA(r,e){const t=r.getBoundingClientRect(),n=t.left+e.scrollLeft-i0(r,t),s=t.top+e.scrollTop;return{x:n,y:s}}function cG(r){let{elements:e,rect:t,offsetParent:n,strategy:s}=r;const i=s==="fixed",c=Xa(n),d=e?s0(e.floating):!1;if(n===c||d&&i)return t;let p={scrollLeft:0,scrollTop:0},m=qa(1);const g=qa(0),x=Ka(n);if((x||!x&&!i)&&((Eh(n)!=="body"||cg(c))&&(p=o0(n)),Ka(n))){const S=fd(n);m=ah(n),g.x=S.x+n.clientLeft,g.y=S.y+n.clientTop}const b=c&&!x&&!i?fA(c,p):qa(0);return{width:t.width*m.x,height:t.height*m.y,x:t.x*m.x-p.scrollLeft*m.x+g.x+b.x,y:t.y*m.y-p.scrollTop*m.y+g.y+b.y}}function uG(r){return Array.from(r.getClientRects())}function dG(r){const e=Xa(r),t=o0(r),n=r.ownerDocument.body,s=si(e.scrollWidth,e.clientWidth,n.scrollWidth,n.clientWidth),i=si(e.scrollHeight,e.clientHeight,n.scrollHeight,n.clientHeight);let c=-t.scrollLeft+i0(r);const d=-t.scrollTop;return ia(n).direction==="rtl"&&(c+=si(e.clientWidth,n.clientWidth)-s),{width:s,height:i,x:c,y:d}}const Bk=25;function fG(r,e){const t=ai(r),n=Xa(r),s=t.visualViewport;let i=n.clientWidth,c=n.clientHeight,d=0,p=0;if(s){i=s.width,c=s.height;const g=xS();(!g||g&&e==="fixed")&&(d=s.offsetLeft,p=s.offsetTop)}const m=i0(n);if(m<=0){const g=n.ownerDocument,x=g.body,b=getComputedStyle(x),S=g.compatMode==="CSS1Compat"&&parseFloat(b.marginLeft)+parseFloat(b.marginRight)||0,T=Math.abs(n.clientWidth-x.clientWidth-S);T<=Bk&&(i-=T)}else m<=Bk&&(i+=m);return{width:i,height:c,x:d,y:p}}const hG=new Set(["absolute","fixed"]);function pG(r,e){const t=fd(r,!0,e==="fixed"),n=t.top+r.clientTop,s=t.left+r.clientLeft,i=Ka(r)?ah(r):qa(1),c=r.clientWidth*i.x,d=r.clientHeight*i.y,p=s*i.x,m=n*i.y;return{width:c,height:d,x:p,y:m}}function Gk(r,e,t){let n;if(e==="viewport")n=fG(r,t);else if(e==="document")n=dG(Xa(r));else if(oa(e))n=pG(e,t);else{const s=dA(r);n={x:e.x-s.x,y:e.y-s.y,width:e.width,height:e.height}}return Fy(n)}function hA(r,e){const t=Qc(r);return t===e||!oa(t)||gh(t)?!1:ia(t).position==="fixed"||hA(t,e)}function mG(r,e){const t=e.get(r);if(t)return t;let n=Km(r,[],!1).filter(d=>oa(d)&&Eh(d)!=="body"),s=null;const i=ia(r).position==="fixed";let c=i?Qc(r):r;for(;oa(c)&&!gh(c);){const d=ia(c),p=yS(c);!p&&d.position==="fixed"&&(s=null),(i?!p&&!s:!p&&d.position==="static"&&!!s&&hG.has(s.position)||cg(c)&&!p&&hA(r,c))?n=n.filter(g=>g!==c):s=d,c=Qc(c)}return e.set(r,n),n}function gG(r){let{element:e,boundary:t,rootBoundary:n,strategy:s}=r;const c=[...t==="clippingAncestors"?s0(e)?[]:mG(e,this._c):[].concat(t),n],d=c[0],p=c.reduce((m,g)=>{const x=Gk(e,g,s);return m.top=si(x.top,m.top),m.right=Xc(x.right,m.right),m.bottom=Xc(x.bottom,m.bottom),m.left=si(x.left,m.left),m},Gk(e,d,s));return{width:p.right-p.left,height:p.bottom-p.top,x:p.left,y:p.top}}function vG(r){const{width:e,height:t}=uA(r);return{width:e,height:t}}function yG(r,e,t){const n=Ka(e),s=Xa(e),i=t==="fixed",c=fd(r,!0,i,e);let d={scrollLeft:0,scrollTop:0};const p=qa(0);function m(){p.x=i0(s)}if(n||!n&&!i)if((Eh(e)!=="body"||cg(s))&&(d=o0(e)),n){const S=fd(e,!0,i,e);p.x=S.x+e.clientLeft,p.y=S.y+e.clientTop}else s&&m();i&&!n&&s&&m();const g=s&&!n&&!i?fA(s,d):qa(0),x=c.left+d.scrollLeft-p.x-g.x,b=c.top+d.scrollTop-p.y-g.y;return{x,y:b,width:c.width,height:c.height}}function ow(r){return ia(r).position==="static"}function Wk(r,e){if(!Ka(r)||ia(r).position==="fixed")return null;if(e)return e(r);let t=r.offsetParent;return Xa(r)===t&&(t=t.ownerDocument.body),t}function pA(r,e){const t=ai(r);if(s0(r))return t;if(!Ka(r)){let s=Qc(r);for(;s&&!gh(s);){if(oa(s)&&!ow(s))return s;s=Qc(s)}return t}let n=Wk(r,e);for(;n&&eG(n)&&ow(n);)n=Wk(n,e);return n&&gh(n)&&ow(n)&&!yS(n)?t:n||oG(r)||t}const xG=async function(r){const e=this.getOffsetParent||pA,t=this.getDimensions,n=await t(r.floating);return{reference:yG(r.reference,await e(r.floating),r.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function wG(r){return ia(r).direction==="rtl"}const bG={convertOffsetParentRelativeRectToViewportRelativeRect:cG,getDocumentElement:Xa,getClippingRect:gG,getOffsetParent:pA,getElementRects:xG,getClientRects:uG,getDimensions:vG,getScale:ah,isElement:oa,isRTL:wG};function mA(r,e){return r.x===e.x&&r.y===e.y&&r.width===e.width&&r.height===e.height}function _G(r,e){let t=null,n;const s=Xa(r);function i(){var d;clearTimeout(n),(d=t)==null||d.disconnect(),t=null}function c(d,p){d===void 0&&(d=!1),p===void 0&&(p=1),i();const m=r.getBoundingClientRect(),{left:g,top:x,width:b,height:S}=m;if(d||e(),!b||!S)return;const T=Lv(x),E=Lv(s.clientWidth-(g+b)),C=Lv(s.clientHeight-(x+S)),R=Lv(g),F={rootMargin:-T+"px "+-E+"px "+-C+"px "+-R+"px",threshold:si(0,Xc(1,p))||1};let P=!0;function L(G){const U=G[0].intersectionRatio;if(U!==p){if(!P)return c();U?c(!1,U):n=setTimeout(()=>{c(!1,1e-7)},1e3)}U===1&&!mA(m,r.getBoundingClientRect())&&c(),P=!1}try{t=new IntersectionObserver(L,{...F,root:s.ownerDocument})}catch{t=new IntersectionObserver(L,F)}t.observe(r)}return c(!0),i}function SG(r,e,t,n){n===void 0&&(n={});const{ancestorScroll:s=!0,ancestorResize:i=!0,elementResize:c=typeof ResizeObserver=="function",layoutShift:d=typeof IntersectionObserver=="function",animationFrame:p=!1}=n,m=wS(r),g=s||i?[...m?Km(m):[],...Km(e)]:[];g.forEach(R=>{s&&R.addEventListener("scroll",t,{passive:!0}),i&&R.addEventListener("resize",t)});const x=m&&d?_G(m,t):null;let b=-1,S=null;c&&(S=new ResizeObserver(R=>{let[A]=R;A&&A.target===m&&S&&(S.unobserve(e),cancelAnimationFrame(b),b=requestAnimationFrame(()=>{var F;(F=S)==null||F.observe(e)})),t()}),m&&!p&&S.observe(m),S.observe(e));let T,E=p?fd(r):null;p&&C();function C(){const R=fd(r);E&&!mA(E,R)&&t(),E=R,T=requestAnimationFrame(C)}return t(),()=>{var R;g.forEach(A=>{s&&A.removeEventListener("scroll",t),i&&A.removeEventListener("resize",t)}),x==null||x(),(R=S)==null||R.disconnect(),S=null,p&&cancelAnimationFrame(T)}}const EG=KB,CG=YB,kG=WB,NG=XB,TG=VB,Vk=GB,RG=JB,AG=(r,e,t)=>{const n=new Map,s={platform:bG,...t},i={...s.platform,_c:n};return BB(r,e,{...s,platform:i})};var bS=CN();const IG=Ib(bS);var PG=typeof document<"u",jG=function(){},ny=PG?w.useLayoutEffect:jG;function Oy(r,e){if(r===e)return!0;if(typeof r!=typeof e)return!1;if(typeof r=="function"&&r.toString()===e.toString())return!0;let t,n,s;if(r&&e&&typeof r=="object"){if(Array.isArray(r)){if(t=r.length,t!==e.length)return!1;for(n=t;n--!==0;)if(!Oy(r[n],e[n]))return!1;return!0}if(s=Object.keys(r),t=s.length,t!==Object.keys(e).length)return!1;for(n=t;n--!==0;)if(!{}.hasOwnProperty.call(e,s[n]))return!1;for(n=t;n--!==0;){const i=s[n];if(!(i==="_owner"&&r.$$typeof)&&!Oy(r[i],e[i]))return!1}return!0}return r!==r&&e!==e}function gA(r){return typeof window>"u"?1:(r.ownerDocument.defaultView||window).devicePixelRatio||1}function qk(r,e){const t=gA(r);return Math.round(e*t)/t}function iw(r){const e=w.useRef(r);return ny(()=>{e.current=r}),e}function FG(r){r===void 0&&(r={});const{placement:e="bottom",strategy:t="absolute",middleware:n=[],platform:s,elements:{reference:i,floating:c}={},transform:d=!0,whileElementsMounted:p,open:m}=r,[g,x]=w.useState({x:0,y:0,strategy:t,placement:e,middlewareData:{},isPositioned:!1}),[b,S]=w.useState(n);Oy(b,n)||S(n);const[T,E]=w.useState(null),[C,R]=w.useState(null),A=w.useCallback(X=>{X!==G.current&&(G.current=X,E(X))},[]),F=w.useCallback(X=>{X!==U.current&&(U.current=X,R(X))},[]),P=i||T,L=c||C,G=w.useRef(null),U=w.useRef(null),V=w.useRef(g),Q=p!=null,fe=iw(p),B=iw(s),ee=iw(m),ve=w.useCallback(()=>{if(!G.current||!U.current)return;const X={placement:e,strategy:t,middleware:b};B.current&&(X.platform=B.current),AG(G.current,U.current,X).then(z=>{const q={...z,isPositioned:ee.current!==!1};ce.current&&!Oy(V.current,q)&&(V.current=q,bS.flushSync(()=>{x(q)}))})},[b,e,t,B,ee]);ny(()=>{m===!1&&V.current.isPositioned&&(V.current.isPositioned=!1,x(X=>({...X,isPositioned:!1})))},[m]);const ce=w.useRef(!1);ny(()=>(ce.current=!0,()=>{ce.current=!1}),[]),ny(()=>{if(P&&(G.current=P),L&&(U.current=L),P&&L){if(fe.current)return fe.current(P,L,ve);ve()}},[P,L,ve,fe,Q]);const ne=w.useMemo(()=>({reference:G,floating:U,setReference:A,setFloating:F}),[A,F]),xe=w.useMemo(()=>({reference:P,floating:L}),[P,L]),J=w.useMemo(()=>{const X={position:t,left:0,top:0};if(!xe.floating)return X;const z=qk(xe.floating,g.x),q=qk(xe.floating,g.y);return d?{...X,transform:"translate("+z+"px, "+q+"px)",...gA(xe.floating)>=1.5&&{willChange:"transform"}}:{position:t,left:z,top:q}},[t,d,xe.floating,g.x,g.y]);return w.useMemo(()=>({...g,update:ve,refs:ne,elements:xe,floatingStyles:J}),[g,ve,ne,xe,J])}const OG=r=>{function e(t){return{}.hasOwnProperty.call(t,"current")}return{name:"arrow",options:r,fn(t){const{element:n,padding:s}=typeof r=="function"?r(t):r;return n&&e(n)?n.current!=null?Vk({element:n.current,padding:s}).fn(t):{}:n?Vk({element:n,padding:s}).fn(t):{}}}},DG=(r,e)=>({...EG(r),options:[r,e]}),LG=(r,e)=>({...CG(r),options:[r,e]}),MG=(r,e)=>({...RG(r),options:[r,e]}),$G=(r,e)=>({...kG(r),options:[r,e]}),UG=(r,e)=>({...NG(r),options:[r,e]}),zG=(r,e)=>({...TG(r),options:[r,e]}),HG=(r,e)=>({...OG(r),options:[r,e]});function BG(r){const e=GG(r),t=w.forwardRef((n,s)=>{const{children:i,...c}=n,d=w.Children.toArray(i),p=d.find(VG);if(p){const m=p.props.children,g=d.map(x=>x===p?w.Children.count(m)>1?w.Children.only(null):w.isValidElement(m)?m.props.children:null:x);return u.jsx(e,{...c,ref:s,children:w.isValidElement(m)?w.cloneElement(m,void 0,g):null})}return u.jsx(e,{...c,ref:s,children:i})});return t.displayName=`${r}.Slot`,t}function GG(r){const e=w.forwardRef((t,n)=>{const{children:s,...i}=t;if(w.isValidElement(s)){const c=KG(s),d=qG(i,s.props);return s.type!==w.Fragment&&(d.ref=n?eu(n,c):c),w.cloneElement(s,d)}return w.Children.count(s)>1?w.Children.only(null):null});return e.displayName=`${r}.SlotClone`,e}var WG=Symbol("radix.slottable");function VG(r){return w.isValidElement(r)&&typeof r.type=="function"&&"__radixId"in r.type&&r.type.__radixId===WG}function qG(r,e){const t={...e};for(const n in e){const s=r[n],i=e[n];/^on[A-Z]/.test(n)?s&&i?t[n]=(...d)=>{const p=i(...d);return s(...d),p}:s&&(t[n]=s):n==="style"?t[n]={...s,...i}:n==="className"&&(t[n]=[s,i].filter(Boolean).join(" "))}return{...r,...t}}function KG(r){var n,s;let e=(n=Object.getOwnPropertyDescriptor(r.props,"ref"))==null?void 0:n.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=(s=Object.getOwnPropertyDescriptor(r,"ref"))==null?void 0:s.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}var YG=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Ur=YG.reduce((r,e)=>{const t=BG(`Primitive.${e}`),n=w.forwardRef((s,i)=>{const{asChild:c,...d}=s,p=c?t:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),u.jsx(p,{...d,ref:i})});return n.displayName=`Primitive.${e}`,{...r,[e]:n}},{});function vA(r,e){r&&bS.flushSync(()=>r.dispatchEvent(e))}var JG="Arrow",yA=w.forwardRef((r,e)=>{const{children:t,width:n=10,height:s=5,...i}=r;return u.jsx(Ur.svg,{...i,ref:e,width:n,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:r.asChild?t:u.jsx("polygon",{points:"0,0 30,0 15,10"})})});yA.displayName=JG;var XG=yA;function Yl(r){const e=w.useRef(r);return w.useEffect(()=>{e.current=r}),w.useMemo(()=>(...t)=>{var n;return(n=e.current)==null?void 0:n.call(e,...t)},[])}function QG(r){const[e,t]=w.useState(void 0);return Vl(()=>{if(r){t({width:r.offsetWidth,height:r.offsetHeight});const n=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const i=s[0];let c,d;if("borderBoxSize"in i){const p=i.borderBoxSize,m=Array.isArray(p)?p[0]:p;c=m.inlineSize,d=m.blockSize}else c=r.offsetWidth,d=r.offsetHeight;t({width:c,height:d})});return n.observe(r,{box:"border-box"}),()=>n.unobserve(r)}else t(void 0)},[r]),e}var _S="Popper",[xA,a0]=Ja(_S),[ZG,wA]=xA(_S),bA=r=>{const{__scopePopper:e,children:t}=r,[n,s]=w.useState(null);return u.jsx(ZG,{scope:e,anchor:n,onAnchorChange:s,children:t})};bA.displayName=_S;var _A="PopperAnchor",SA=w.forwardRef((r,e)=>{const{__scopePopper:t,virtualRef:n,...s}=r,i=wA(_A,t),c=w.useRef(null),d=Ln(e,c),p=w.useRef(null);return w.useEffect(()=>{const m=p.current;p.current=(n==null?void 0:n.current)||c.current,m!==p.current&&i.onAnchorChange(p.current)}),n?null:u.jsx(Ur.div,{...s,ref:d})});SA.displayName=_A;var SS="PopperContent",[e7,t7]=xA(SS),EA=w.forwardRef((r,e)=>{var de,ge,se,Te,qe,ze;const{__scopePopper:t,side:n="bottom",sideOffset:s=0,align:i="center",alignOffset:c=0,arrowPadding:d=0,avoidCollisions:p=!0,collisionBoundary:m=[],collisionPadding:g=0,sticky:x="partial",hideWhenDetached:b=!1,updatePositionStrategy:S="optimized",onPlaced:T,...E}=r,C=wA(SS,t),[R,A]=w.useState(null),F=Ln(e,Be=>A(Be)),[P,L]=w.useState(null),G=QG(P),U=(G==null?void 0:G.width)??0,V=(G==null?void 0:G.height)??0,Q=n+(i!=="center"?"-"+i:""),fe=typeof g=="number"?g:{top:0,right:0,bottom:0,left:0,...g},B=Array.isArray(m)?m:[m],ee=B.length>0,ve={padding:fe,boundary:B.filter(n7),altBoundary:ee},{refs:ce,floatingStyles:ne,placement:xe,isPositioned:J,middlewareData:X}=FG({strategy:"fixed",placement:Q,whileElementsMounted:(...Be)=>SG(...Be,{animationFrame:S==="always"}),elements:{reference:C.anchor},middleware:[DG({mainAxis:s+V,alignmentAxis:c}),p&&LG({mainAxis:!0,crossAxis:!1,limiter:x==="partial"?MG():void 0,...ve}),p&&$G({...ve}),UG({...ve,apply:({elements:Be,rects:Ce,availableWidth:vt,availableHeight:kt})=>{const{width:yt,height:At}=Ce.reference,It=Be.floating.style;It.setProperty("--radix-popper-available-width",`${vt}px`),It.setProperty("--radix-popper-available-height",`${kt}px`),It.setProperty("--radix-popper-anchor-width",`${yt}px`),It.setProperty("--radix-popper-anchor-height",`${At}px`)}}),P&&HG({element:P,padding:d}),s7({arrowWidth:U,arrowHeight:V}),b&&zG({strategy:"referenceHidden",...ve})]}),[z,q]=NA(xe),O=Yl(T);Vl(()=>{J&&(O==null||O())},[J,O]);const $=(de=X.arrow)==null?void 0:de.x,ae=(ge=X.arrow)==null?void 0:ge.y,be=((se=X.arrow)==null?void 0:se.centerOffset)!==0,[ie,K]=w.useState();return Vl(()=>{R&&K(window.getComputedStyle(R).zIndex)},[R]),u.jsx("div",{ref:ce.setFloating,"data-radix-popper-content-wrapper":"",style:{...ne,transform:J?ne.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:ie,"--radix-popper-transform-origin":[(Te=X.transformOrigin)==null?void 0:Te.x,(qe=X.transformOrigin)==null?void 0:qe.y].join(" "),...((ze=X.hide)==null?void 0:ze.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:r.dir,children:u.jsx(e7,{scope:t,placedSide:z,onArrowChange:L,arrowX:$,arrowY:ae,shouldHideArrow:be,children:u.jsx(Ur.div,{"data-side":z,"data-align":q,...E,ref:F,style:{...E.style,animation:J?void 0:"none"}})})})});EA.displayName=SS;var CA="PopperArrow",r7={top:"bottom",right:"left",bottom:"top",left:"right"},kA=w.forwardRef(function(e,t){const{__scopePopper:n,...s}=e,i=t7(CA,n),c=r7[i.placedSide];return u.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[c]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:u.jsx(XG,{...s,ref:t,style:{...s.style,display:"block"}})})});kA.displayName=CA;function n7(r){return r!==null}var s7=r=>({name:"transformOrigin",options:r,fn(e){var C,R,A;const{placement:t,rects:n,middlewareData:s}=e,c=((C=s.arrow)==null?void 0:C.centerOffset)!==0,d=c?0:r.arrowWidth,p=c?0:r.arrowHeight,[m,g]=NA(t),x={start:"0%",center:"50%",end:"100%"}[g],b=(((R=s.arrow)==null?void 0:R.x)??0)+d/2,S=(((A=s.arrow)==null?void 0:A.y)??0)+p/2;let T="",E="";return m==="bottom"?(T=c?x:`${b}px`,E=`${-p}px`):m==="top"?(T=c?x:`${b}px`,E=`${n.floating.height+p}px`):m==="right"?(T=`${-p}px`,E=c?x:`${S}px`):m==="left"&&(T=`${n.floating.width+p}px`,E=c?x:`${S}px`),{data:{x:T,y:E}}}});function NA(r){const[e,t="center"]=r.split("-");return[e,t]}var TA=bA,RA=SA,AA=EA,IA=kA,o7="Portal",ES=w.forwardRef((r,e)=>{var d;const{container:t,...n}=r,[s,i]=w.useState(!1);Vl(()=>i(!0),[]);const c=t||s&&((d=globalThis==null?void 0:globalThis.document)==null?void 0:d.body);return c?IG.createPortal(u.jsx(Ur.div,{...n,ref:e}),c):null});ES.displayName=o7;function i7(r,e){return w.useReducer((t,n)=>e[t][n]??t,r)}var ca=r=>{const{present:e,children:t}=r,n=a7(e),s=typeof t=="function"?t({present:n.isPresent}):w.Children.only(t),i=Ln(n.ref,l7(s));return typeof t=="function"||n.isPresent?w.cloneElement(s,{ref:i}):null};ca.displayName="Presence";function a7(r){const[e,t]=w.useState(),n=w.useRef(null),s=w.useRef(r),i=w.useRef("none"),c=r?"mounted":"unmounted",[d,p]=i7(c,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return w.useEffect(()=>{const m=Mv(n.current);i.current=d==="mounted"?m:"none"},[d]),Vl(()=>{const m=n.current,g=s.current;if(g!==r){const b=i.current,S=Mv(m);r?p("MOUNT"):S==="none"||(m==null?void 0:m.display)==="none"?p("UNMOUNT"):p(g&&b!==S?"ANIMATION_OUT":"UNMOUNT"),s.current=r}},[r,p]),Vl(()=>{if(e){let m;const g=e.ownerDocument.defaultView??window,x=S=>{const E=Mv(n.current).includes(CSS.escape(S.animationName));if(S.target===e&&E&&(p("ANIMATION_END"),!s.current)){const C=e.style.animationFillMode;e.style.animationFillMode="forwards",m=g.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=C)})}},b=S=>{S.target===e&&(i.current=Mv(n.current))};return e.addEventListener("animationstart",b),e.addEventListener("animationcancel",x),e.addEventListener("animationend",x),()=>{g.clearTimeout(m),e.removeEventListener("animationstart",b),e.removeEventListener("animationcancel",x),e.removeEventListener("animationend",x)}}else p("ANIMATION_END")},[e,p]),{isPresent:["mounted","unmountSuspended"].includes(d),ref:w.useCallback(m=>{n.current=m?getComputedStyle(m):null,t(m)},[])}}function Mv(r){return(r==null?void 0:r.animationName)||"none"}function l7(r){var n,s;let e=(n=Object.getOwnPropertyDescriptor(r.props,"ref"))==null?void 0:n.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=(s=Object.getOwnPropertyDescriptor(r,"ref"))==null?void 0:s.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}function c7(r,e=globalThis==null?void 0:globalThis.document){const t=Yl(r);w.useEffect(()=>{const n=s=>{s.key==="Escape"&&t(s)};return e.addEventListener("keydown",n,{capture:!0}),()=>e.removeEventListener("keydown",n,{capture:!0})},[t,e])}var u7="DismissableLayer",bb="dismissableLayer.update",d7="dismissableLayer.pointerDownOutside",f7="dismissableLayer.focusOutside",Kk,PA=w.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),l0=w.forwardRef((r,e)=>{const{disableOutsidePointerEvents:t=!1,onEscapeKeyDown:n,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:c,onDismiss:d,...p}=r,m=w.useContext(PA),[g,x]=w.useState(null),b=(g==null?void 0:g.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,S]=w.useState({}),T=Ln(e,U=>x(U)),E=Array.from(m.layers),[C]=[...m.layersWithOutsidePointerEventsDisabled].slice(-1),R=E.indexOf(C),A=g?E.indexOf(g):-1,F=m.layersWithOutsidePointerEventsDisabled.size>0,P=A>=R,L=m7(U=>{const V=U.target,Q=[...m.branches].some(fe=>fe.contains(V));!P||Q||(s==null||s(U),c==null||c(U),U.defaultPrevented||d==null||d())},b),G=g7(U=>{const V=U.target;[...m.branches].some(fe=>fe.contains(V))||(i==null||i(U),c==null||c(U),U.defaultPrevented||d==null||d())},b);return c7(U=>{A===m.layers.size-1&&(n==null||n(U),!U.defaultPrevented&&d&&(U.preventDefault(),d()))},b),w.useEffect(()=>{if(g)return t&&(m.layersWithOutsidePointerEventsDisabled.size===0&&(Kk=b.body.style.pointerEvents,b.body.style.pointerEvents="none"),m.layersWithOutsidePointerEventsDisabled.add(g)),m.layers.add(g),Yk(),()=>{t&&m.layersWithOutsidePointerEventsDisabled.size===1&&(b.body.style.pointerEvents=Kk)}},[g,b,t,m]),w.useEffect(()=>()=>{g&&(m.layers.delete(g),m.layersWithOutsidePointerEventsDisabled.delete(g),Yk())},[g,m]),w.useEffect(()=>{const U=()=>S({});return document.addEventListener(bb,U),()=>document.removeEventListener(bb,U)},[]),u.jsx(Ur.div,{...p,ref:T,style:{pointerEvents:F?P?"auto":"none":void 0,...r.style},onFocusCapture:Lt(r.onFocusCapture,G.onFocusCapture),onBlurCapture:Lt(r.onBlurCapture,G.onBlurCapture),onPointerDownCapture:Lt(r.onPointerDownCapture,L.onPointerDownCapture)})});l0.displayName=u7;var h7="DismissableLayerBranch",p7=w.forwardRef((r,e)=>{const t=w.useContext(PA),n=w.useRef(null),s=Ln(e,n);return w.useEffect(()=>{const i=n.current;if(i)return t.branches.add(i),()=>{t.branches.delete(i)}},[t.branches]),u.jsx(Ur.div,{...r,ref:s})});p7.displayName=h7;function m7(r,e=globalThis==null?void 0:globalThis.document){const t=Yl(r),n=w.useRef(!1),s=w.useRef(()=>{});return w.useEffect(()=>{const i=d=>{if(d.target&&!n.current){let p=function(){jA(d7,t,m,{discrete:!0})};const m={originalEvent:d};d.pointerType==="touch"?(e.removeEventListener("click",s.current),s.current=p,e.addEventListener("click",s.current,{once:!0})):p()}else e.removeEventListener("click",s.current);n.current=!1},c=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(c),e.removeEventListener("pointerdown",i),e.removeEventListener("click",s.current)}},[e,t]),{onPointerDownCapture:()=>n.current=!0}}function g7(r,e=globalThis==null?void 0:globalThis.document){const t=Yl(r),n=w.useRef(!1);return w.useEffect(()=>{const s=i=>{i.target&&!n.current&&jA(f7,t,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",s),()=>e.removeEventListener("focusin",s)},[e,t]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function Yk(){const r=new CustomEvent(bb);document.dispatchEvent(r)}function jA(r,e,t,{discrete:n}){const s=t.originalEvent.target,i=new CustomEvent(r,{bubbles:!1,cancelable:!0,detail:t});e&&s.addEventListener(r,e,{once:!0}),n?vA(s,i):s.dispatchEvent(i)}var aw,c0="HoverCard",[FA]=Ja(c0,[a0]),u0=a0(),[v7,CS]=FA(c0),OA=r=>{const{__scopeHoverCard:e,children:t,open:n,defaultOpen:s,onOpenChange:i,openDelay:c=700,closeDelay:d=300}=r,p=u0(e),m=w.useRef(0),g=w.useRef(0),x=w.useRef(!1),b=w.useRef(!1),[S,T]=tu({prop:n,defaultProp:s??!1,onChange:i,caller:c0}),E=w.useCallback(()=>{clearTimeout(g.current),m.current=window.setTimeout(()=>T(!0),c)},[c,T]),C=w.useCallback(()=>{clearTimeout(m.current),!x.current&&!b.current&&(g.current=window.setTimeout(()=>T(!1),d))},[d,T]),R=w.useCallback(()=>T(!1),[T]);return w.useEffect(()=>()=>{clearTimeout(m.current),clearTimeout(g.current)},[]),u.jsx(v7,{scope:e,open:S,onOpenChange:T,onOpen:E,onClose:C,onDismiss:R,hasSelectionRef:x,isPointerDownOnContentRef:b,children:u.jsx(TA,{...p,children:t})})};OA.displayName=c0;var DA="HoverCardTrigger",LA=w.forwardRef((r,e)=>{const{__scopeHoverCard:t,...n}=r,s=CS(DA,t),i=u0(t);return u.jsx(RA,{asChild:!0,...i,children:u.jsx(Ur.a,{"data-state":s.open?"open":"closed",...n,ref:e,onPointerEnter:Lt(r.onPointerEnter,Ly(s.onOpen)),onPointerLeave:Lt(r.onPointerLeave,Ly(s.onClose)),onFocus:Lt(r.onFocus,s.onOpen),onBlur:Lt(r.onBlur,s.onClose),onTouchStart:Lt(r.onTouchStart,c=>c.preventDefault())})})});LA.displayName=DA;var y7="HoverCardPortal",[WK,x7]=FA(y7,{forceMount:void 0}),Dy="HoverCardContent",MA=w.forwardRef((r,e)=>{const t=x7(Dy,r.__scopeHoverCard),{forceMount:n=t.forceMount,...s}=r,i=CS(Dy,r.__scopeHoverCard);return u.jsx(ca,{present:n||i.open,children:u.jsx(w7,{"data-state":i.open?"open":"closed",...s,onPointerEnter:Lt(r.onPointerEnter,Ly(i.onOpen)),onPointerLeave:Lt(r.onPointerLeave,Ly(i.onClose)),ref:e})})});MA.displayName=Dy;var w7=w.forwardRef((r,e)=>{const{__scopeHoverCard:t,onEscapeKeyDown:n,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:c,...d}=r,p=CS(Dy,t),m=u0(t),g=w.useRef(null),x=Ln(e,g),[b,S]=w.useState(!1);return w.useEffect(()=>{if(b){const T=document.body;return aw=T.style.userSelect||T.style.webkitUserSelect,T.style.userSelect="none",T.style.webkitUserSelect="none",()=>{T.style.userSelect=aw,T.style.webkitUserSelect=aw}}},[b]),w.useEffect(()=>{if(g.current){const T=()=>{S(!1),p.isPointerDownOnContentRef.current=!1,setTimeout(()=>{var C;((C=document.getSelection())==null?void 0:C.toString())!==""&&(p.hasSelectionRef.current=!0)})};return document.addEventListener("pointerup",T),()=>{document.removeEventListener("pointerup",T),p.hasSelectionRef.current=!1,p.isPointerDownOnContentRef.current=!1}}},[p.isPointerDownOnContentRef,p.hasSelectionRef]),w.useEffect(()=>{g.current&&_7(g.current).forEach(E=>E.setAttribute("tabindex","-1"))}),u.jsx(l0,{asChild:!0,disableOutsidePointerEvents:!1,onInteractOutside:c,onEscapeKeyDown:n,onPointerDownOutside:s,onFocusOutside:Lt(i,T=>{T.preventDefault()}),onDismiss:p.onDismiss,children:u.jsx(AA,{...m,...d,onPointerDown:Lt(d.onPointerDown,T=>{T.currentTarget.contains(T.target)&&S(!0),p.hasSelectionRef.current=!1,p.isPointerDownOnContentRef.current=!0}),ref:x,style:{...d.style,userSelect:b?"text":void 0,WebkitUserSelect:b?"text":void 0,"--radix-hover-card-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-hover-card-content-available-width":"var(--radix-popper-available-width)","--radix-hover-card-content-available-height":"var(--radix-popper-available-height)","--radix-hover-card-trigger-width":"var(--radix-popper-anchor-width)","--radix-hover-card-trigger-height":"var(--radix-popper-anchor-height)"}})})}),b7="HoverCardArrow",$A=w.forwardRef((r,e)=>{const{__scopeHoverCard:t,...n}=r,s=u0(t);return u.jsx(IA,{...s,...n,ref:e})});$A.displayName=b7;function Ly(r){return e=>e.pointerType==="touch"?void 0:r()}function _7(r){const e=[],t=document.createTreeWalker(r,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP});for(;t.nextNode();)e.push(t.currentNode);return e}var S7=OA,E7=LA,C7=MA,k7=$A;const _b="src/lib/utils/emailUtils.tsx";async function kS(r,e){try{await(await Yn.createServices()).contentScript.insertContentIntoComposeBox(r)}catch(t){e.error("Error inserting content into compose box",t,{sourceFile:_b,functionName:"insertHtmlIntoComposeBox"}),N7(r,e)}}function N7(r,e){const t=r.replace(/<([^>]+)class="ql-align-([^"]+)"([^>]*)>/g,'<$1style="text-align: $2"$3>');chrome.tabs.query({active:!0,currentWindow:!0},n=>{const s=n[0];if(!(s!=null&&s.id)){e.error("No active tab found or tab ID is undefined",void 0,{sourceFile:_b,functionName:"insertHtmlIntoComposeBoxLegacy"});return}chrome.scripting.executeScript({target:{tabId:s.id},func:i=>{console.debug("Script executing in tab context");function c(){return document.querySelector('div[role="textbox"][aria-label="Message Body"]')||document.querySelector('div[aria-label="Message body, press Alt+F10 to exit"]')}function d(m,g){document.execCommand("insertHTML",!1,g),console.debug("Inserted using execCommand fallback")}const p=c();if(p)console.debug("found composeBox: ",p);else{console.error("Compose box not found");return}try{p.focus(),navigator.clipboard&&navigator.clipboard.writeText?navigator.clipboard.writeText(i).then(()=>{document.execCommand("paste"),console.debug("Pasted using Clipboard API")}).catch(m=>{console.warn("Clipboard API failed, using fallback:",m),d(p,i)}):d(p,i)}catch(m){console.error("Error during paste operation:",m)}},args:[t]}).catch(i=>{e.error("Error executing script",i,{sourceFile:_b,functionName:"insertHtmlIntoComposeBoxLegacy"})})})}const T7="src/lib/types/Template.ts",Jk=async(r,e)=>{const t="GetTemplateWithContentFromServerTemplate";try{const n=r.source;if(!n)throw new Error("Source value is undefined");const s={...r,source:n};return{id:s.template_id,timeStamp:Date.now(),title:s.templateName,description:s.templateDescription,tags:s.tags||[],source:s.source==="SCOPE_USER"?"personal":"org",content:s.templateBody}}catch(n){throw e.error("Error getting template content",n,{sourceFile:T7,functionName:t,templateId:r.template_id}),n}},Ll="src/lib/utils/templateUtils.tsx",Xk=async(r,e=!0)=>{const t="getAllTemplatesWithContent";try{const n=await o8(r);r.debug("Templates from server",{sourceFile:Ll,functionName:t,userCount:n.user_templates.length,orgCount:n.org_templates.length});const s=async g=>{const x="fetchPersonalTemplateWithErrorHandling";try{const b={...g,source:g.source||"SCOPE_USER"};return r.debug("Fetching personal template",{sourceFile:Ll,functionName:x,templateId:b.template_id,scope:b.source}),await Jk(b,r)}catch(b){return r.error("Failed to load personal template",b,{sourceFile:Ll,functionName:x,templateId:g.template_id}),null}},i=async g=>{const x="fetchOrgTemplateWithErrorHandling";try{const b={...g,source:g.source||"SCOPE_TENANT"};return r.debug("Fetching org template",{sourceFile:Ll,functionName:x,templateId:b.template_id,scope:b.source}),await Jk(b,r)}catch(b){return r.error("Failed to load org template",b,{sourceFile:Ll,functionName:x,templateId:g.template_id}),null}};let c=[];e&&(c=await Promise.all(n.user_templates.map(s)));const d=c.filter(Boolean),m=(await Promise.all(n.org_templates.map(i))).filter(Boolean);return r.info("Loaded templates",{sourceFile:Ll,functionName:t,personalLoaded:d.length,personalTotal:n.user_templates.length,orgLoaded:m.length,orgTotal:n.org_templates.length}),e&&await $U(r,d),await UU(r,m),[...d,...m]}catch(n){r.error("Error in getAllTemplatesWithContent",n,{sourceFile:Ll,functionName:t}),r.info("Falling back to cached templates from local storage",{sourceFile:Ll,functionName:t});const s=await aT(r),i=await lT(r);return[...s,...i]}},R7=async r=>{const e="getTemplatesFromLocalStorage";try{const[t,n]=await Promise.all([aT(r),lT(r)]);return[...t,...n]}catch(t){return r.error("Error getting templates from local storage",t,{sourceFile:Ll,functionName:e}),[]}};async function Qk(r,{signalType:e,signalValue:t}){localStorage.setItem(e,t);try{const s=(await Yn.createServices()).tabs;s.openOptionsPage?await s.openOptionsPage():r.error("Tabs provider does not support options page",new Error("Tabs provider does not support options page"),{sourceFile:"src/shared/lib/utils/optionsUtils.ts",sourceFunction:"openOrFocusOptionsPage"})}catch(n){r.error("Error opening options page",n,{sourceFile:"src/shared/lib/utils/optionsUtils.ts",sourceFunction:"openOrFocusOptionsPage"})}}const d0=({feature:r,description:e,benefits:t=[],className:n="",variant:s="card"})=>{const{isConnected:i,isLoading:c,error:d,status:p,initiateReconnection:m}=$i(),{platform:g}=un();if(g!=="chrome"||i)return null;const x=async()=>{try{await m()}catch(T){console.error("Failed to reconnect Gmail:",T)}},b=()=>p==="loading"?u.jsx(Do,{className:"h-5 w-5 text-blue-600 animate-spin"}):p==="error"?u.jsx(ih,{className:"h-5 w-5 text-red-600"}):u.jsx(Jc,{className:"h-5 w-5 text-amber-600"}),S=()=>p==="loading"?"Checking Gmail connection...":p==="error"?d||"Gmail connection error occurred":"Gmail connection required";return s==="banner"?u.jsxs("div",{className:`flex items-center justify-between bg-amber-50 border border-amber-200 px-4 py-3 rounded-lg ${n}`,children:[u.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[b(),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("p",{className:"text-sm font-medium text-amber-800",children:S()}),u.jsx("p",{className:"text-sm text-amber-700 mt-1",children:e||`Connect Gmail to access ${r} features.`})]})]}),u.jsx(We,{onClick:x,disabled:c,variant:"outline",size:"sm",className:"bg-amber-100 border-amber-300 text-amber-800 hover:bg-amber-200 hover:border-amber-400 whitespace-nowrap ml-4",children:c?u.jsxs(u.Fragment,{children:[u.jsx(Do,{className:"h-4 w-4 mr-2 animate-spin"}),"Connecting..."]}):"Connect Gmail"})]}):s==="inline"?u.jsxs("div",{className:`flex items-center gap-2 text-amber-700 ${n}`,children:[b(),u.jsx("span",{className:"text-sm",children:S()}),u.jsx(We,{onClick:x,disabled:c,variant:"link",size:"sm",className:"h-auto p-0 text-amber-700 hover:text-amber-800",children:"Connect Gmail"})]}):u.jsx(Es,{className:`${n}`,children:u.jsx(Cs,{className:"p-6",children:u.jsxs("div",{className:"flex items-start gap-4",children:[u.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-amber-100 rounded-full flex items-center justify-center",children:b()}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("h3",{className:"text-base font-semibold text-gray-900 mb-2",children:"Gmail Connection Required"}),u.jsx("p",{className:"text-gray-600 mb-4",children:e||`To access ${r}, you need to connect your Gmail account first.`}),t.length>0&&u.jsxs("div",{className:"mb-4",children:[u.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"What you'll get with Gmail connected:"}),u.jsx("ul",{className:"text-sm text-gray-600 space-y-1",children:t.map((T,E)=>u.jsxs("li",{className:"flex items-start gap-2",children:[u.jsx(qc,{className:"h-4 w-4 text-green-600 mt-0.5 flex-shrink-0"}),u.jsx("span",{children:T})]},E))})]}),d&&u.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-3 mb-4",children:u.jsx("p",{className:"text-sm text-red-800",children:d})}),u.jsx("div",{className:"flex items-center gap-3",children:u.jsx(We,{onClick:x,disabled:c,className:"bg-blue-600 hover:bg-blue-700",children:c?u.jsxs(u.Fragment,{children:[u.jsx(Do,{className:"h-4 w-4 mr-2 animate-spin"}),"Connecting..."]}):u.jsxs(u.Fragment,{children:[u.jsx(Jc,{className:"h-4 w-4 mr-2"}),"Connect Gmail"]})})})]})]})})})},ro="src/sidepanel/panels/TemplatesPanel.tsx",A7=({clientEmail:r,isAuthenticated:e})=>{const t=zr(),{platform:n}=un(),{isConnected:s}=$i(),[i,c]=w.useState(""),[d,p]=w.useState([]),[m,g]=w.useState(!1),[x,b]=w.useState([]),[S,T]=w.useState([]),[E,C]=w.useState("all"),[R,A]=w.useState([]),[F,P]=w.useState(!0),[L,G]=w.useState(!1),[U,V]=w.useState(null),Q=w.useRef(null),fe=w.useRef(null);w.useEffect(()=>{function $(ae){m&&Q.current&&!Q.current.contains(ae.target)&&fe.current&&!fe.current.contains(ae.target)&&g(!1)}return document.addEventListener("mousedown",$),()=>{document.removeEventListener("mousedown",$)}},[m]),w.useEffect(()=>{function $(ae){U&&!ae.target.closest("[data-radix-hover-card-content]")&&V(null)}return U&&document.addEventListener("mousedown",$),()=>{document.removeEventListener("mousedown",$)}},[U]),w.useEffect(()=>{if(R.length>0){const $=R.filter(ae=>{var be,ie,K,de,ge;return(E==="all"||E==="org"&&ae.source==="org"||E==="personal"&&ae.source!=="org")&&(((be=ae.title)==null?void 0:be.toLowerCase().includes(i.toLowerCase()))||((ie=ae.content)==null?void 0:ie.toLowerCase().includes(i.toLowerCase()))||((K=ae.tags)==null?void 0:K.some(se=>se.toLowerCase().includes(i.toLowerCase())))||((de=ae.description)==null?void 0:de.toLowerCase().includes(i.toLowerCase())))&&(x.length===0||((ge=ae.tags)==null?void 0:ge.some(se=>x.includes(se))))});if(i.trim()){const ae=$.sort((be,ie)=>{const K=i.toLowerCase(),de=Te=>{var qe,ze,Be,Ce;return(qe=Te.tags)!=null&&qe.some(vt=>vt.toLowerCase().includes(K))?1:(ze=Te.title)!=null&&ze.toLowerCase().includes(K)?2:(Be=Te.description)!=null&&Be.toLowerCase().includes(K)?3:(Ce=Te.content)!=null&&Ce.toLowerCase().includes(K)?4:5},ge=de(be),se=de(ie);return ge!==se?ge-se:(be.title||"").localeCompare(ie.title||"")});p(ae)}else p($)}},[R,i,x,E]),w.useEffect(()=>{if(!e){t.debug("Skipping template loading - user not authenticated",{sourceFile:ro,isAuthenticated:e});return}const $=async()=>{P(!0);const ae="loadTemplatesDirectly";try{t.info("Loading templates directly from server (like options page)",{sourceFile:ro,functionName:ae});const be=await Xk(t,!0);if(be.length>0){t.info("Templates loaded successfully",{sourceFile:ro,functionName:ae,count:be.length}),A(be);const ie=await hy(t);let K=[];ie.id!==""&&(K=ie.templateConfiguration.tags||[]);const de=new Set(K);be.forEach(ge=>{ge.tags&&Array.isArray(ge.tags)&&ge.tags.forEach(se=>de.add(se))}),T(Array.from(de))}else t.info("No templates found!",{sourceFile:ro,functionName:ae}),A([])}catch(be){t.error("Error loading templates directly from server",be,{sourceFile:ro,functionName:ae});try{const ie=await R7(t);t.info("Fallback to local storage successful",{sourceFile:ro,functionName:ae,count:ie.length}),A(ie)}catch(ie){t.error("Fallback to local storage also failed",ie,{sourceFile:ro,functionName:ae}),A([])}}finally{P(!1)}};t.info("TemplatesPanel initialized, loading templates directly from server",{sourceFile:ro,isAuthenticated:e}),$()},[t,e]);const B=w.useCallback(async()=>{if(L)return;G(!0);const $="refreshTemplates";t.info("Starting template refresh from server",{sourceFile:ro,functionName:$});try{const ae=await hy(t);let be=[];ae.id!==""?(t.debug("configuration loaded from storage",{sourceFile:ro,functionName:$,config:ae}),be=ae.templateConfiguration.tags||[]):t.warn("No configuration found in storage",{sourceFile:ro,functionName:$}),t.info("Calling getAllTemplatesWithContent",{sourceFile:ro,functionName:$});const ie=await Xk(t,!0);t.info("getAllTemplatesWithContent completed",{sourceFile:ro,functionName:$,templateCount:ie.length});const K=new Set(be);ie.forEach(ge=>{ge.tags&&Array.isArray(ge.tags)&&ge.tags.forEach(se=>K.add(se))});const de=Array.from(K);t.info("Template refresh successful",{sourceFile:ro,functionName:$,templateCount:ie.length,tagsCount:de.length,templates:ie.map(ge=>({title:ge.title,tags:ge.tags,source:ge.source}))}),T(de),A(ie)}catch(ae){t.error("Error refreshing templates from server",ae,{sourceFile:ro,functionName:$}),console.error("Template loading failed:",ae)}finally{G(!1)}},[L,t]),ee=()=>{g(!m)},ve=$=>{b(ae=>ae.includes($)?ae.filter(be=>be!==$):[...ae,$])},ce=$=>{V(ae=>ae===$?null:$)},[ne,xe]=w.useState(!1),J=w.useRef(null),X=w.useRef(null);w.useEffect(()=>{function $(ae){ne&&J.current&&!J.current.contains(ae.target)&&X.current&&!X.current.contains(ae.target)&&xe(!1)}return document.addEventListener("mousedown",$),()=>{document.removeEventListener("mousedown",$)}},[ne]);const z=()=>{xe(!ne)},q=$=>{C($),xe(!1)};return n==="chrome"&&!s?u.jsx("div",{className:"p-4",children:u.jsx(d0,{feature:"Templates",description:"Connect your Gmail account to access and insert email templates",benefits:["Access all your personal and organization templates","Insert template content directly into compose box","Search and filter templates by tags and content"]})}):u.jsxs("div",{className:"space-y-4 h-full",children:[u.jsxs("div",{className:"relative",children:[u.jsx(an,{type:"text",placeholder:"Search templates...",value:i,onChange:$=>c($.target.value),className:"pl-10 pr-12"}),u.jsx(lo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:18}),u.jsx(We,{ref:fe,variant:"outline",className:"absolute right-0 top-1/2 transform -translate-y-1/2",onClick:ee,children:u.jsx(sw,{})}),m&&u.jsx("div",{ref:Q,className:"absolute right-0 mt-2 w-48 bg-white dark:bg-card border dark:border-border rounded shadow-lg z-10",children:S.length>0?S.map($=>u.jsxs("label",{className:"block px-4 py-2 hover:bg-gray-50 dark:hover:bg-muted cursor-pointer text-gray-900 dark:text-gray-200",children:[u.jsx("input",{type:"checkbox",className:"mr-2",checked:x.includes($),onChange:()=>ve($)}),$]},$)):u.jsx("div",{className:"px-4 py-2 text-gray-500",children:"No tags available"})})]}),u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"relative",children:[u.jsxs(We,{ref:X,variant:"outline",size:"sm",onClick:z,className:"flex items-center hover:bg-blue-50",children:[E==="all"&&u.jsxs(u.Fragment,{children:[u.jsx(sw,{className:"mr-2 h-4 w-4"}),"All Templates (",d.length,")"]}),E==="personal"&&u.jsxs(u.Fragment,{children:[u.jsx(Iy,{className:"mr-2 h-4 w-4"}),"Personal Only (",d.length,")"]}),E==="org"&&u.jsxs(u.Fragment,{children:[u.jsx(nw,{className:"mr-2 h-4 w-4"}),"Org Only (",d.length,")"]})]}),ne&&u.jsxs("div",{ref:J,className:"absolute left-0 mt-1 w-40 bg-white dark:bg-card border dark:border-border rounded shadow-lg z-10",children:[E!=="all"&&u.jsxs("div",{className:"px-4 py-2 hover:bg-gray-50 dark:hover:bg-muted cursor-pointer flex items-center text-gray-900 dark:text-gray-200",onClick:()=>q("all"),children:[u.jsx(sw,{className:"mr-2 h-4 w-4"}),"All Templates"]}),E!=="personal"&&u.jsxs("div",{className:"px-4 py-2 hover:bg-gray-50 dark:hover:bg-muted cursor-pointer flex items-center text-gray-900 dark:text-gray-200",onClick:()=>q("personal"),children:[u.jsx(Iy,{className:"mr-2 h-4 w-4"}),"Personal Only"]}),E!=="org"&&R.filter($=>$.source==="org").length>0&&u.jsxs("div",{className:"px-4 py-2 hover:bg-gray-50 dark:hover:bg-muted cursor-pointer flex items-center text-gray-900 dark:text-gray-200",onClick:()=>q("org"),children:[u.jsx(nw,{className:"mr-2 h-4 w-4"}),"Org Only"]})]})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(We,{size:"icon",className:"rounded-lg bg-blue-600 text-white hover:bg-blue-700 hover:text-white dark:bg-blue-600 dark:text-white dark:hover:bg-blue-700 border border-blue-600 dark:border-blue-600",title:"Add Template",onClick:()=>{Qk(t,{signalType:"openCreateTemplate",signalValue:"true"})},children:u.jsx(dB,{className:"w-5 h-5"})}),u.jsx(We,{variant:"outline",size:"icon",className:"rounded-lg hover:bg-blue-50",title:"Refresh Templates",onClick:B,disabled:L||F,children:u.jsx(Do,{className:`w-5 h-5 ${L?"animate-spin":""}`})})]})]}),F?u.jsxs("div",{className:"flex justify-center items-center py-12",children:[u.jsx(ii,{className:"h-8 w-8 animate-spin text-blue-600"}),u.jsx("span",{className:"ml-2 text-gray-600",children:"Loading templates..."})]}):u.jsxs("div",{className:"overflow-y-auto h-full pb-2",children:[d.map($=>u.jsxs(Es,{className:"animate-fadeIn relative mb-2",children:[u.jsxs(io,{children:[u.jsx(ao,{className:"text-sm flex items-center",children:$.title}),$.tags&&$.tags.length>0&&u.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:$.tags.map((ae,be)=>u.jsx("span",{className:"inline-block bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full",children:ae},be))})]}),u.jsxs(Cs,{children:[u.jsx("p",{className:"text-xs mb-2 overflow-hidden text-ellipsis max-h-[50px]",children:$.description}),u.jsxs("div",{className:"flex space-x-2",children:[u.jsx(We,{className:"flex-1 text-xs py-1 bg-blue-600 text-white hover:bg-blue-700 hover:text-white dark:bg-blue-600 dark:text-white dark:hover:bg-blue-700 w-1/2 border border-blue-600 dark:border-blue-600",onClick:()=>{kS($.content,t)},children:u.jsxs("span",{className:"flex items-center justify-center w-full",children:[u.jsx(pS,{className:"w-4 h-4 flex-shrink-0 mr-1 rotate-90"}),u.jsx("span",{className:"hide-text-when-narrow",children:"Insert"})]})}),u.jsxs(S7,{open:U===$.id?!0:void 0,onOpenChange:ae=>{!ae&&U===$.id&&V(null)},openDelay:0,closeDelay:100,children:[u.jsx(E7,{asChild:!0,children:u.jsx(We,{variant:"outline",className:`text-xs py-1 bg-white dark:bg-card text-black dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-muted hover:text-blue-600 dark:hover:text-blue-400 w-1/4 ${U===$.id?"bg-gray-100 dark:bg-muted text-blue-600 dark:text-blue-400":""}`,onClick:ae=>{ae.preventDefault(),ce($.id)},children:u.jsxs("span",{className:"flex items-center justify-center w-full",children:[u.jsx(pB,{className:"w-4 h-4 flex-shrink-0 mr-1"}),u.jsx("span",{className:"hide-text-when-narrow",children:"View"})]})})}),u.jsxs(C7,{className:"bg-white dark:bg-card border-2 mt-8 mr-8 border-gray-200 dark:border-border rounded-md text-gray-700 dark:text-gray-200 p-4 z-50 overflow-auto",align:"center",side:"top",style:{maxHeight:"40vh",maxWidth:"80vw",width:"auto",height:"auto",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.15)"},children:[u.jsx("div",{dangerouslySetInnerHTML:{__html:$.content}}),u.jsx(k7,{className:"fill-blue-500"})]})]}),$.source==="org"?u.jsx("div",{className:"w-1/4 flex items-center",title:"Organization templates can only be edited by an admin.",children:u.jsxs("span",{className:"text-xs py-1 px-2 bg-blue-100 text-blue-800 border border-blue-300 flex items-center justify-center w-full rounded-full",children:[u.jsx(nw,{className:"w-4 h-4 flex-shrink-0 mr-1"}),u.jsx("span",{className:"hide-text-when-narrow",children:"Org"})]})}):u.jsx(We,{variant:"outline",className:"text-xs py-1 bg-white dark:bg-card text-black dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-muted w-1/4",title:"Edit Template",onClick:()=>{Qk(t,{signalType:"editTemplateId",signalValue:$.id})},children:u.jsxs("span",{className:"flex items-center justify-center w-full",children:[u.jsx(_B,{className:"w-4 h-4 flex-shrink-0 mr-1"}),u.jsx("span",{className:"hide-text-when-narrow",children:"Edit"})]})})]})]})]},$.id)),d.length===0&&u.jsxs("div",{className:"mt-8 text-center text-gray-500",children:[u.jsx("p",{children:"No templates found matching your criteria."}),u.jsx("p",{className:"text-sm mt-2",children:"Try adjusting your filters or search terms."})]})]})]})};/*! @license DOMPurify 3.3.1 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.1/LICENSE */const{entries:UA,setPrototypeOf:Zk,isFrozen:I7,getPrototypeOf:P7,getOwnPropertyDescriptor:j7}=Object;let{freeze:co,seal:Li,create:Sb}=Object,{apply:Eb,construct:Cb}=typeof Reflect<"u"&&Reflect;co||(co=function(e){return e});Li||(Li=function(e){return e});Eb||(Eb=function(e,t){for(var n=arguments.length,s=new Array(n>2?n-2:0),i=2;i<n;i++)s[i-2]=arguments[i];return e.apply(t,s)});Cb||(Cb=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];return new e(...n)});const $v=uo(Array.prototype.forEach),F7=uo(Array.prototype.lastIndexOf),eN=uo(Array.prototype.pop),nm=uo(Array.prototype.push),O7=uo(Array.prototype.splice),sy=uo(String.prototype.toLowerCase),lw=uo(String.prototype.toString),cw=uo(String.prototype.match),sm=uo(String.prototype.replace),D7=uo(String.prototype.indexOf),L7=uo(String.prototype.trim),na=uo(Object.prototype.hasOwnProperty),no=uo(RegExp.prototype.test),om=M7(TypeError);function uo(r){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];return Eb(r,e,n)}}function M7(r){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Cb(r,t)}}function fr(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:sy;Zk&&Zk(r,null);let n=e.length;for(;n--;){let s=e[n];if(typeof s=="string"){const i=t(s);i!==s&&(I7(e)||(e[n]=i),s=i)}r[s]=!0}return r}function $7(r){for(let e=0;e<r.length;e++)na(r,e)||(r[e]=null);return r}function Ma(r){const e=Sb(null);for(const[t,n]of UA(r))na(r,t)&&(Array.isArray(n)?e[t]=$7(n):n&&typeof n=="object"&&n.constructor===Object?e[t]=Ma(n):e[t]=n);return e}function im(r,e){for(;r!==null;){const n=j7(r,e);if(n){if(n.get)return uo(n.get);if(typeof n.value=="function")return uo(n.value)}r=P7(r)}function t(){return null}return t}const tN=co(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),uw=co(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),dw=co(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),U7=co(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),fw=co(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),z7=co(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),rN=co(["#text"]),nN=co(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),hw=co(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),sN=co(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Uv=co(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),H7=Li(/\{\{[\w\W]*|[\w\W]*\}\}/gm),B7=Li(/<%[\w\W]*|[\w\W]*%>/gm),G7=Li(/\$\{[\w\W]*/gm),W7=Li(/^data-[\-\w.\u00B7-\uFFFF]+$/),V7=Li(/^aria-[\-\w]+$/),zA=Li(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),q7=Li(/^(?:\w+script|data):/i),K7=Li(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),HA=Li(/^html$/i),Y7=Li(/^[a-z][.\w]*(-[.\w]+)+$/i);var oN=Object.freeze({__proto__:null,ARIA_ATTR:V7,ATTR_WHITESPACE:K7,CUSTOM_ELEMENT:Y7,DATA_ATTR:W7,DOCTYPE_NAME:HA,ERB_EXPR:B7,IS_ALLOWED_URI:zA,IS_SCRIPT_OR_DATA:q7,MUSTACHE_EXPR:H7,TMPLIT_EXPR:G7});const am={element:1,text:3,progressingInstruction:7,comment:8,document:9},J7=function(){return typeof window>"u"?null:window},X7=function(e,t){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let n=null;const s="data-tt-policy-suffix";t&&t.hasAttribute(s)&&(n=t.getAttribute(s));const i="dompurify"+(n?"#"+n:"");try{return e.createPolicy(i,{createHTML(c){return c},createScriptURL(c){return c}})}catch{return console.warn("TrustedTypes policy "+i+" could not be created."),null}},iN=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function BA(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:J7();const e=mt=>BA(mt);if(e.version="3.3.1",e.removed=[],!r||!r.document||r.document.nodeType!==am.document||!r.Element)return e.isSupported=!1,e;let{document:t}=r;const n=t,s=n.currentScript,{DocumentFragment:i,HTMLTemplateElement:c,Node:d,Element:p,NodeFilter:m,NamedNodeMap:g=r.NamedNodeMap||r.MozNamedAttrMap,HTMLFormElement:x,DOMParser:b,trustedTypes:S}=r,T=p.prototype,E=im(T,"cloneNode"),C=im(T,"remove"),R=im(T,"nextSibling"),A=im(T,"childNodes"),F=im(T,"parentNode");if(typeof c=="function"){const mt=t.createElement("template");mt.content&&mt.content.ownerDocument&&(t=mt.content.ownerDocument)}let P,L="";const{implementation:G,createNodeIterator:U,createDocumentFragment:V,getElementsByTagName:Q}=t,{importNode:fe}=n;let B=iN();e.isSupported=typeof UA=="function"&&typeof F=="function"&&G&&G.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:ee,ERB_EXPR:ve,TMPLIT_EXPR:ce,DATA_ATTR:ne,ARIA_ATTR:xe,IS_SCRIPT_OR_DATA:J,ATTR_WHITESPACE:X,CUSTOM_ELEMENT:z}=oN;let{IS_ALLOWED_URI:q}=oN,O=null;const $=fr({},[...tN,...uw,...dw,...fw,...rN]);let ae=null;const be=fr({},[...nN,...hw,...sN,...Uv]);let ie=Object.seal(Sb(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),K=null,de=null;const ge=Object.seal(Sb(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let se=!0,Te=!0,qe=!1,ze=!0,Be=!1,Ce=!0,vt=!1,kt=!1,yt=!1,At=!1,It=!1,Yt=!1,Xt=!0,Or=!1;const vr="user-content-";let dn=!0,_e=!1,Fe={},nt=null;const ft=fr({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Ut=null;const Ue=fr({},["audio","video","img","source","image","track"]);let He=null;const Mt=fr({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Ie="http://www.w3.org/1998/Math/MathML",St="http://www.w3.org/2000/svg",ht="http://www.w3.org/1999/xhtml";let Ge=ht,cr=!1,zt=null;const yr=fr({},[Ie,St,ht],lw);let tr=fr({},["mi","mo","mn","ms","mtext"]),ar=fr({},["annotation-xml"]);const Jn=fr({},["title","style","font","a","script"]);let ls=null;const qs=["application/xhtml+xml","text/html"],ho="text/html";let Er=null,vn=null;const Lo=t.createElement("form"),cs=function(te){return te instanceof RegExp||te instanceof Function},he=function(){let te=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(vn&&vn===te)){if((!te||typeof te!="object")&&(te={}),te=Ma(te),ls=qs.indexOf(te.PARSER_MEDIA_TYPE)===-1?ho:te.PARSER_MEDIA_TYPE,Er=ls==="application/xhtml+xml"?lw:sy,O=na(te,"ALLOWED_TAGS")?fr({},te.ALLOWED_TAGS,Er):$,ae=na(te,"ALLOWED_ATTR")?fr({},te.ALLOWED_ATTR,Er):be,zt=na(te,"ALLOWED_NAMESPACES")?fr({},te.ALLOWED_NAMESPACES,lw):yr,He=na(te,"ADD_URI_SAFE_ATTR")?fr(Ma(Mt),te.ADD_URI_SAFE_ATTR,Er):Mt,Ut=na(te,"ADD_DATA_URI_TAGS")?fr(Ma(Ue),te.ADD_DATA_URI_TAGS,Er):Ue,nt=na(te,"FORBID_CONTENTS")?fr({},te.FORBID_CONTENTS,Er):ft,K=na(te,"FORBID_TAGS")?fr({},te.FORBID_TAGS,Er):Ma({}),de=na(te,"FORBID_ATTR")?fr({},te.FORBID_ATTR,Er):Ma({}),Fe=na(te,"USE_PROFILES")?te.USE_PROFILES:!1,se=te.ALLOW_ARIA_ATTR!==!1,Te=te.ALLOW_DATA_ATTR!==!1,qe=te.ALLOW_UNKNOWN_PROTOCOLS||!1,ze=te.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Be=te.SAFE_FOR_TEMPLATES||!1,Ce=te.SAFE_FOR_XML!==!1,vt=te.WHOLE_DOCUMENT||!1,At=te.RETURN_DOM||!1,It=te.RETURN_DOM_FRAGMENT||!1,Yt=te.RETURN_TRUSTED_TYPE||!1,yt=te.FORCE_BODY||!1,Xt=te.SANITIZE_DOM!==!1,Or=te.SANITIZE_NAMED_PROPS||!1,dn=te.KEEP_CONTENT!==!1,_e=te.IN_PLACE||!1,q=te.ALLOWED_URI_REGEXP||zA,Ge=te.NAMESPACE||ht,tr=te.MATHML_TEXT_INTEGRATION_POINTS||tr,ar=te.HTML_INTEGRATION_POINTS||ar,ie=te.CUSTOM_ELEMENT_HANDLING||{},te.CUSTOM_ELEMENT_HANDLING&&cs(te.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(ie.tagNameCheck=te.CUSTOM_ELEMENT_HANDLING.tagNameCheck),te.CUSTOM_ELEMENT_HANDLING&&cs(te.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(ie.attributeNameCheck=te.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),te.CUSTOM_ELEMENT_HANDLING&&typeof te.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(ie.allowCustomizedBuiltInElements=te.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Be&&(Te=!1),It&&(At=!0),Fe&&(O=fr({},rN),ae=[],Fe.html===!0&&(fr(O,tN),fr(ae,nN)),Fe.svg===!0&&(fr(O,uw),fr(ae,hw),fr(ae,Uv)),Fe.svgFilters===!0&&(fr(O,dw),fr(ae,hw),fr(ae,Uv)),Fe.mathMl===!0&&(fr(O,fw),fr(ae,sN),fr(ae,Uv))),te.ADD_TAGS&&(typeof te.ADD_TAGS=="function"?ge.tagCheck=te.ADD_TAGS:(O===$&&(O=Ma(O)),fr(O,te.ADD_TAGS,Er))),te.ADD_ATTR&&(typeof te.ADD_ATTR=="function"?ge.attributeCheck=te.ADD_ATTR:(ae===be&&(ae=Ma(ae)),fr(ae,te.ADD_ATTR,Er))),te.ADD_URI_SAFE_ATTR&&fr(He,te.ADD_URI_SAFE_ATTR,Er),te.FORBID_CONTENTS&&(nt===ft&&(nt=Ma(nt)),fr(nt,te.FORBID_CONTENTS,Er)),te.ADD_FORBID_CONTENTS&&(nt===ft&&(nt=Ma(nt)),fr(nt,te.ADD_FORBID_CONTENTS,Er)),dn&&(O["#text"]=!0),vt&&fr(O,["html","head","body"]),O.table&&(fr(O,["tbody"]),delete K.tbody),te.TRUSTED_TYPES_POLICY){if(typeof te.TRUSTED_TYPES_POLICY.createHTML!="function")throw om('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof te.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw om('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');P=te.TRUSTED_TYPES_POLICY,L=P.createHTML("")}else P===void 0&&(P=X7(S,s)),P!==null&&typeof L=="string"&&(L=P.createHTML(""));co&&co(te),vn=te}},Ke=fr({},[...uw,...dw,...U7]),_t=fr({},[...fw,...z7]),pt=function(te){let Le=F(te);(!Le||!Le.tagName)&&(Le={namespaceURI:Ge,tagName:"template"});const st=sy(te.tagName),jr=sy(Le.tagName);return zt[te.namespaceURI]?te.namespaceURI===St?Le.namespaceURI===ht?st==="svg":Le.namespaceURI===Ie?st==="svg"&&(jr==="annotation-xml"||tr[jr]):!!Ke[st]:te.namespaceURI===Ie?Le.namespaceURI===ht?st==="math":Le.namespaceURI===St?st==="math"&&ar[jr]:!!_t[st]:te.namespaceURI===ht?Le.namespaceURI===St&&!ar[jr]||Le.namespaceURI===Ie&&!tr[jr]?!1:!_t[st]&&(Jn[st]||!Ke[st]):!!(ls==="application/xhtml+xml"&&zt[te.namespaceURI]):!1},tt=function(te){nm(e.removed,{element:te});try{F(te).removeChild(te)}catch{C(te)}},ut=function(te,Le){try{nm(e.removed,{attribute:Le.getAttributeNode(te),from:Le})}catch{nm(e.removed,{attribute:null,from:Le})}if(Le.removeAttribute(te),te==="is")if(At||It)try{tt(Le)}catch{}else try{Le.setAttribute(te,"")}catch{}},lt=function(te){let Le=null,st=null;if(yt)te="<remove></remove>"+te;else{const Vr=cw(te,/^[\r\n\t ]+/);st=Vr&&Vr[0]}ls==="application/xhtml+xml"&&Ge===ht&&(te='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+te+"</body></html>");const jr=P?P.createHTML(te):te;if(Ge===ht)try{Le=new b().parseFromString(jr,ls)}catch{}if(!Le||!Le.documentElement){Le=G.createDocument(Ge,"template",null);try{Le.documentElement.innerHTML=cr?L:jr}catch{}}const qt=Le.body||Le.documentElement;return te&&st&&qt.insertBefore(t.createTextNode(st),qt.childNodes[0]||null),Ge===ht?Q.call(Le,vt?"html":"body")[0]:vt?Le.documentElement:qt},Jt=function(te){return U.call(te.ownerDocument||te,te,m.SHOW_ELEMENT|m.SHOW_COMMENT|m.SHOW_TEXT|m.SHOW_PROCESSING_INSTRUCTION|m.SHOW_CDATA_SECTION,null)},Mn=function(te){return te instanceof x&&(typeof te.nodeName!="string"||typeof te.textContent!="string"||typeof te.removeChild!="function"||!(te.attributes instanceof g)||typeof te.removeAttribute!="function"||typeof te.setAttribute!="function"||typeof te.namespaceURI!="string"||typeof te.insertBefore!="function"||typeof te.hasChildNodes!="function")},Wr=function(te){return typeof d=="function"&&te instanceof d};function rr(mt,te,Le){$v(mt,st=>{st.call(e,te,Le,vn)})}const $n=function(te){let Le=null;if(rr(B.beforeSanitizeElements,te,null),Mn(te))return tt(te),!0;const st=Er(te.nodeName);if(rr(B.uponSanitizeElement,te,{tagName:st,allowedTags:O}),Ce&&te.hasChildNodes()&&!Wr(te.firstElementChild)&&no(/<[/\w!]/g,te.innerHTML)&&no(/<[/\w!]/g,te.textContent)||te.nodeType===am.progressingInstruction||Ce&&te.nodeType===am.comment&&no(/<[/\w]/g,te.data))return tt(te),!0;if(!(ge.tagCheck instanceof Function&&ge.tagCheck(st))&&(!O[st]||K[st])){if(!K[st]&&ui(st)&&(ie.tagNameCheck instanceof RegExp&&no(ie.tagNameCheck,st)||ie.tagNameCheck instanceof Function&&ie.tagNameCheck(st)))return!1;if(dn&&!nt[st]){const jr=F(te)||te.parentNode,qt=A(te)||te.childNodes;if(qt&&jr){const Vr=qt.length;for(let fn=Vr-1;fn>=0;--fn){const ks=E(qt[fn],!0);ks.__removalCount=(te.__removalCount||0)+1,jr.insertBefore(ks,R(te))}}}return tt(te),!0}return te instanceof p&&!pt(te)||(st==="noscript"||st==="noembed"||st==="noframes")&&no(/<\/no(script|embed|frames)/i,te.innerHTML)?(tt(te),!0):(Be&&te.nodeType===am.text&&(Le=te.textContent,$v([ee,ve,ce],jr=>{Le=sm(Le,jr," ")}),te.textContent!==Le&&(nm(e.removed,{element:te.cloneNode()}),te.textContent=Le)),rr(B.afterSanitizeElements,te,null),!1)},po=function(te,Le,st){if(Xt&&(Le==="id"||Le==="name")&&(st in t||st in Lo))return!1;if(!(Te&&!de[Le]&&no(ne,Le))){if(!(se&&no(xe,Le))){if(!(ge.attributeCheck instanceof Function&&ge.attributeCheck(Le,te))){if(!ae[Le]||de[Le]){if(!(ui(te)&&(ie.tagNameCheck instanceof RegExp&&no(ie.tagNameCheck,te)||ie.tagNameCheck instanceof Function&&ie.tagNameCheck(te))&&(ie.attributeNameCheck instanceof RegExp&&no(ie.attributeNameCheck,Le)||ie.attributeNameCheck instanceof Function&&ie.attributeNameCheck(Le,te))||Le==="is"&&ie.allowCustomizedBuiltInElements&&(ie.tagNameCheck instanceof RegExp&&no(ie.tagNameCheck,st)||ie.tagNameCheck instanceof Function&&ie.tagNameCheck(st))))return!1}else if(!He[Le]){if(!no(q,sm(st,X,""))){if(!((Le==="src"||Le==="xlink:href"||Le==="href")&&te!=="script"&&D7(st,"data:")===0&&Ut[te])){if(!(qe&&!no(J,sm(st,X,"")))){if(st)return!1}}}}}}}return!0},ui=function(te){return te!=="annotation-xml"&&cw(te,z)},fa=function(te){rr(B.beforeSanitizeAttributes,te,null);const{attributes:Le}=te;if(!Le||Mn(te))return;const st={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:ae,forceKeepAttr:void 0};let jr=Le.length;for(;jr--;){const qt=Le[jr],{name:Vr,namespaceURI:fn,value:ks}=qt,us=Er(Vr),di=ks;let qr=Vr==="value"?di:L7(di);if(st.attrName=us,st.attrValue=qr,st.keepAttr=!0,st.forceKeepAttr=void 0,rr(B.uponSanitizeAttribute,te,st),qr=st.attrValue,Or&&(us==="id"||us==="name")&&(ut(Vr,te),qr=vr+qr),Ce&&no(/((--!?|])>)|<\/(style|title|textarea)/i,qr)){ut(Vr,te);continue}if(us==="attributename"&&cw(qr,"href")){ut(Vr,te);continue}if(st.forceKeepAttr)continue;if(!st.keepAttr){ut(Vr,te);continue}if(!ze&&no(/\/>/i,qr)){ut(Vr,te);continue}Be&&$v([ee,ve,ce],Un=>{qr=sm(qr,Un," ")});const fi=Er(te.nodeName);if(!po(fi,us,qr)){ut(Vr,te);continue}if(P&&typeof S=="object"&&typeof S.getAttributeType=="function"&&!fn)switch(S.getAttributeType(fi,us)){case"TrustedHTML":{qr=P.createHTML(qr);break}case"TrustedScriptURL":{qr=P.createScriptURL(qr);break}}if(qr!==di)try{fn?te.setAttributeNS(fn,Vr,qr):te.setAttribute(Vr,qr),Mn(te)?tt(te):eN(e.removed)}catch{ut(Vr,te)}}rr(B.afterSanitizeAttributes,te,null)},Qa=function mt(te){let Le=null;const st=Jt(te);for(rr(B.beforeSanitizeShadowDOM,te,null);Le=st.nextNode();)rr(B.uponSanitizeShadowNode,Le,null),$n(Le),fa(Le),Le.content instanceof i&&mt(Le.content);rr(B.afterSanitizeShadowDOM,te,null)};return e.sanitize=function(mt){let te=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Le=null,st=null,jr=null,qt=null;if(cr=!mt,cr&&(mt="<!-->"),typeof mt!="string"&&!Wr(mt))if(typeof mt.toString=="function"){if(mt=mt.toString(),typeof mt!="string")throw om("dirty is not a string, aborting")}else throw om("toString is not a function");if(!e.isSupported)return mt;if(kt||he(te),e.removed=[],typeof mt=="string"&&(_e=!1),_e){if(mt.nodeName){const ks=Er(mt.nodeName);if(!O[ks]||K[ks])throw om("root node is forbidden and cannot be sanitized in-place")}}else if(mt instanceof d)Le=lt("<!---->"),st=Le.ownerDocument.importNode(mt,!0),st.nodeType===am.element&&st.nodeName==="BODY"||st.nodeName==="HTML"?Le=st:Le.appendChild(st);else{if(!At&&!Be&&!vt&&mt.indexOf("<")===-1)return P&&Yt?P.createHTML(mt):mt;if(Le=lt(mt),!Le)return At?null:Yt?L:""}Le&&yt&&tt(Le.firstChild);const Vr=Jt(_e?mt:Le);for(;jr=Vr.nextNode();)$n(jr),fa(jr),jr.content instanceof i&&Qa(jr.content);if(_e)return mt;if(At){if(It)for(qt=V.call(Le.ownerDocument);Le.firstChild;)qt.appendChild(Le.firstChild);else qt=Le;return(ae.shadowroot||ae.shadowrootmode)&&(qt=fe.call(n,qt,!0)),qt}let fn=vt?Le.outerHTML:Le.innerHTML;return vt&&O["!doctype"]&&Le.ownerDocument&&Le.ownerDocument.doctype&&Le.ownerDocument.doctype.name&&no(HA,Le.ownerDocument.doctype.name)&&(fn="<!DOCTYPE "+Le.ownerDocument.doctype.name+`>
`+fn),Be&&$v([ee,ve,ce],ks=>{fn=sm(fn,ks," ")}),P&&Yt?P.createHTML(fn):fn},e.setConfig=function(){let mt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};he(mt),kt=!0},e.clearConfig=function(){vn=null,kt=!1},e.isValidAttribute=function(mt,te,Le){vn||he({});const st=Er(mt),jr=Er(te);return po(st,jr,Le)},e.addHook=function(mt,te){typeof te=="function"&&nm(B[mt],te)},e.removeHook=function(mt,te){if(te!==void 0){const Le=F7(B[mt],te);return Le===-1?void 0:O7(B[mt],Le,1)[0]}return eN(B[mt])},e.removeHooks=function(mt){B[mt]=[]},e.removeAllHooks=function(){B=iN()},e}var NS=BA();const oy=r=>{var s;const e=r.replace(/^```html\s*/,""),t=document.createElement("div");return t.innerHTML=e.replace(/style="[^"]*"/g,""),(((s=t.textContent)==null?void 0:s.replace(/(\n{2,}|[ \t]+\n+|\n+[ \t]+)/g,`
`))||"").trim()},kb=r=>r.replace(/&quot;/g,'"').replace(/\\"/g,'"').replace(/\\n/g,`
`).replace(/\n{3,}/g,`

`).replace(/\\n/g,`
`).replace(/\\'/g,"'").replace(/\\"/g,'"').replace(/\\\\/g,"\\").replace(/```html/g,"").replace(/```/g,"").replace(/^"/,"").replace(/"$/,"").replace(/\u2019/g,"'").replace(/\u2018/g,"'").replace(/\u201A/g,"'").replace(/\u201B/g,"'"),Pi=({src:r,width:e,height:t,alt:n,className:s})=>{const i=r.startsWith("/")?`${X1}${r}`:r;return u.jsx("img",{src:i,width:e,height:t,alt:n,className:s})},Q7=({isOpen:r,onToggle:e,value:t,onChange:n,onRefine:s,onRefineInstructionChange:i,hasGeneratedResponse:c=!1})=>{const[d,p]=w.useState(""),m=c&&!!s,g=m?d:t,x=T=>{m?(p(T),i==null||i(T)):n(T)},b=()=>{d.trim()&&s&&(s(d.trim()),p(""))},S=T=>{T.key==="Enter"&&!T.shiftKey&&d.trim()&&(T.preventDefault(),b())};return u.jsxs(Es,{className:"overflow-hidden shadow-sm mb-4",children:[u.jsx(io,{className:"p-3 border-b dark:border-border cursor-pointer",onClick:e,role:"button","aria-expanded":r,tabIndex:0,onKeyDown:T=>{(T.key==="Enter"||T.key===" ")&&(T.preventDefault(),e())},children:u.jsxs("div",{className:"flex items-center justify-between w-full",children:[u.jsx("div",{className:"flex items-center gap-2",children:u.jsx(ao,{className:"text-sm font-semibold",children:m?u.jsxs(u.Fragment,{children:["Refine this draft"," ",u.jsx("span",{className:"text-gray-500 dark:text-gray-300 text-xs",children:"Optional"})]}):"Additional context"})}),u.jsx(Pi,{src:"/icons/chevron-down.svg",width:20,height:20,alt:"Chevron down",className:`h-5 w-5 text-muted-foreground dark:brightness-0 dark:invert transition-transform duration-200 ${r?"transform rotate-180":""}`})]})}),r&&u.jsxs(Cs,{className:"p-2",children:[u.jsx("div",{className:"rounded-lg border-2 border-neutral-200 dark:border-border bg-neutral-50/50 dark:bg-card/50 overflow-hidden transition-all duration-200 focus-within:!border-blue-500 dark:focus-within:!border-blue-400 focus-within:ring-2 focus-within:ring-blue-500/20 dark:focus-within:ring-blue-400/20 focus-within:bg-white dark:focus-within:bg-card",children:u.jsx("div",{className:"p-3 bg-white dark:bg-card",children:u.jsx("textarea",{className:"text-sm w-full bg-transparent text-gray-900 dark:text-gray-200 !border-0 !ring-0 !outline-none focus:!border-0 focus:!ring-0 focus:!outline-none focus-visible:!ring-0 focus-visible:!ring-offset-0 focus-visible:!outline-none min-h-[100px] max-h-40 py-0 px-0 placeholder:text-neutral-400 dark:placeholder:text-gray-500 resize-none",placeholder:"Anything specific you want to change or add to the draft?","aria-label":"Additional context for draft generation",value:g,onChange:T=>x(T.target.value),onKeyDown:m?S:void 0})})}),u.jsx("div",{className:"pb-3 pt-2",children:u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:'Examples: "Make this shorter." "Respond in Spanish." "Mention our meeting tomorrow."'})})]})]})},lh=({options:r,value:e,onChange:t})=>u.jsx("div",{className:"flex rounded-md shadow-sm",role:"radiogroup",children:r.map(n=>u.jsx(We,{role:"radio","aria-checked":e===n,variant:e===n?"default":"outline",className:`flex-1 text-xs ${e===n?"":"text-muted-foreground"}`,onClick:()=>t(n),children:n},n))}),Z7=({isOpen:r,onToggle:e,formality:t,empathy:n,complexity:s,onFormalityChange:i,onEmpathyChange:c,onComplexityChange:d})=>u.jsxs(Es,{className:"overflow-hidden shadow-sm mb-4",children:[u.jsx(io,{className:"p-3 border-b dark:border-border cursor-pointer",onClick:e,role:"button","aria-expanded":r,tabIndex:0,onKeyDown:p=>{(p.key==="Enter"||p.key===" ")&&(p.preventDefault(),e())},children:u.jsxs("div",{className:"flex items-center justify-between w-full",children:[u.jsxs(ao,{className:"text-sm font-semibold",children:["Adjust tone ",u.jsx("span",{className:"text-gray-500 dark:text-gray-300 text-xs",children:"Optional"})]}),u.jsx(Pi,{src:"/icons/chevron-down.svg",width:20,height:20,alt:"Chevron down",className:`h-5 w-5 text-muted-foreground dark:brightness-0 dark:invert transition-transform duration-200 ${r?"transform rotate-180":""}`})]})}),r&&u.jsxs(Cs,{className:"p-4 space-y-4",children:[u.jsxs("div",{className:"space-y-2",children:[u.jsx("p",{className:"text-xs font-semibold text-neutral-700 dark:text-gray-300",children:"Formality"}),u.jsx(lh,{options:["Casual","Neutral","Formal"],value:t,onChange:p=>i(p)})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("p",{className:"text-xs font-semibold text-neutral-700 dark:text-gray-300",children:"Empathy"}),u.jsx(lh,{options:["Low","Neutral","High"],value:n,onChange:p=>c(p)})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("p",{className:"text-xs font-semibold text-neutral-700 dark:text-gray-300",children:"Complexity"}),u.jsx(lh,{options:["Simple","Neutral","Detailed"],value:s,onChange:p=>d(p)})]})]})]}),GA=({htmlString:r})=>{const e=()=>({__html:NS.sanitize(r,{USE_PROFILES:{html:!0}})});return u.jsx("div",{className:"rich-text-content text-gray-800 dark:text-gray-200",style:{fontSize:"14px",lineHeight:"1.6",fontFamily:"Arial, sans-serif"},dangerouslySetInnerHTML:e()})},eW={loading:"Checking for updated information",success:"Case information refreshed just now","no-changes":"No updates found. Draft is up to date.",error:"Couldnt check for updates right now. Draft unchanged."},tW=({fullResponse:r,isGenerating:e,hasError:t,onInsert:n,onRefresh:s,onCreateDraft:i,refreshStatus:c,isRefreshed:d,hasPendingChanges:p,onApplyChanges:m,showApplySuccess:g})=>{if(t&&!r&&!e)return u.jsx(Es,{className:"mb-2",children:u.jsxs(Cs,{className:"p-6 text-center",children:[u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4",children:"Draft not available yet."}),u.jsx(We,{className:"bg-blue-600 hover:bg-blue-700 text-white",onClick:i,children:"Create draft"})]})});if(e)return u.jsxs(Es,{className:"mb-2",children:[u.jsx(io,{className:"p-3 border-b dark:border-border",children:u.jsxs(ao,{className:"flex items-center py-0 my-0 text-sm font-semibold",children:[u.jsx(Pi,{src:"/icons/email-icon.svg",width:16,height:16,alt:"Draft",className:"h-4 w-4 text-muted-foreground dark:brightness-0 dark:invert mr-2"}),u.jsx("p",{className:"text-sm font-semibold",children:"Draft"})]})}),u.jsxs(Cs,{className:"p-6",children:[u.jsxs("div",{className:"space-y-3 animate-pulse",role:"status","aria-label":"Loading draft",children:[u.jsx("div",{className:"h-3 bg-gray-200 dark:bg-gray-700 rounded w-3/4"}),u.jsx("div",{className:"h-3 bg-gray-200 dark:bg-gray-700 rounded w-full"}),u.jsx("div",{className:"h-3 bg-gray-200 dark:bg-gray-700 rounded w-5/6"}),u.jsx("div",{className:"h-3 bg-gray-200 dark:bg-gray-700 rounded w-2/3"})]}),u.jsxs("div",{className:"flex items-center justify-center mt-4",children:[u.jsx(ii,{className:"h-4 w-4 animate-spin text-blue-600 mr-2"}),u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Preparing your draft"})]})]})]});if(!r)return null;const x=c!=="idle"?eW[c]:d?"Case information refreshed":null;return u.jsxs(Es,{className:"animate-slide-fade-in mb-2 origin-top",children:[u.jsx(io,{className:"p-3 border-b dark:border-border",children:u.jsxs(ao,{className:"flex items-center py-0 my-0 text-sm font-semibold",children:[u.jsx(Pi,{src:"/icons/email-icon.svg",width:16,height:16,alt:"Draft",className:"h-4 w-4 text-muted-foreground dark:brightness-0 dark:invert mr-2"}),u.jsx("p",{className:"text-sm font-semibold",children:"Draft"}),u.jsxs(We,{className:"ml-auto bg-blue-600 hover:bg-blue-700 text-white",size:"sm",onClick:n,children:[u.jsx(pS,{className:"w-4 h-4 flex-shrink-0 mr-1 rotate-90"}),"Insert"]})]})}),u.jsxs(Cs,{className:"p-6",children:[g?u.jsx("div",{className:"mb-4 flex items-center rounded-md bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 px-3 py-2",children:u.jsx("p",{className:"text-xs text-green-700 dark:text-green-400",children:"Draft updated just now"})}):u.jsxs("div",{className:"mb-4 text-xs text-gray-600 dark:text-gray-400 items-center",children:[x??u.jsx("p",{children:"Based on case information available when this email was received."}),c!=="loading"&&u.jsxs(u.Fragment,{children:[" ",u.jsx("button",{onClick:s,className:"text-blue-600 dark:text-blue-400",title:"Refresh with latest data","aria-label":"Refresh with latest data",children:"Refresh with latest data"})]}),c==="loading"&&u.jsx(ii,{className:"h-3 w-3 animate-spin text-blue-600 ml-2"})]}),u.jsx(GA,{htmlString:r}),p&&m&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700 my-4"}),u.jsx(We,{className:"w-full bg-blue-600 hover:bg-blue-700 text-white",size:"sm",onClick:m,children:"Apply changes"}),u.jsx("p",{className:"text-xs text-center text-gray-500 dark:text-gray-400 mt-2",children:"Applies tone and refine settings below"})]})]})]})},Nn="src/shared/components/sidepanel/panels/GenerateEmailDraftPanelWithPrefetch.tsx",rW="25dc68db26595a7485917129d6993f96",nW="c1c8e460f2105029b2b4563f9222161c",sW=()=>`The response should just be the email body with salutation at the beginning. Do not include a subject line in your response draft.
    Do not add links to the references in your response draft. Do not add citation numbers in your response draft.
    Do not list the references in your response draft, since they will be added in a different section in the JSON response.
    Do not add a complimentary closing or a signature as this will be added later.`.trim(),lm=(r,e,t)=>{let n="";switch(r){case"Casual":n+="Keep the tone casual. ";break;case"Neutral":n+="Maintain a neutral tone. ";break;case"Formal":n+="Keep the tone formal. ";break}switch(e){case"Low":n+="Show low empathy. ";break;case"Neutral":n+="Maintain neutral empathy. ";break;case"High":n+="Show high empathy. ";break}switch(t){case"Simple":n+="Keep it simple and use simple words. ";break;case"Neutral":n+="Maintain neutral complexity. ";break;case"Detailed":n+="Provide detailed information and you're free to use harder words. ";break}return n.trim()},oW=({clientEmail:r,onCmsRefresh:e,onGenerateRefreshReady:t})=>{const n=zr(),s=Ya(),i=aa(),c=un().platform,{isConnected:d}=$i(),[p,m]=w.useState(!1),[g,x]=w.useState(!1),[b,S]=w.useState("idle"),[T,E]=w.useState(!1),[C,R]=w.useState(!1),[A,F]=w.useState(!0),[P,L]=w.useState(""),[G,U]=w.useState(!1),[V,Q]=w.useState(!0),[fe,B]=w.useState(null),[ee,ve]=w.useState(null),[ce,ne]=w.useState([]),xe=w.useRef(null),[J,X]=w.useState(""),[z,q]=w.useState("Neutral"),[O,$]=w.useState("Neutral"),[ae,be]=w.useState("Neutral"),ie=w.useRef(null),K=w.useRef(0),de=w.useRef(0),[ge,se]=w.useState(lm(z,O,ae)),[Te,qe]=w.useState(J),[ze,Be]=w.useState(!1),[Ce,vt]=w.useState(!1),[kt,yt]=w.useState(""),At=w.useMemo(()=>lm(z,O,ae),[z,O,ae]),It=w.useMemo(()=>sW(),[]),Yt=()=>Q(Ie=>!Ie),Xt=()=>U(Ie=>!Ie),Or=w.useCallback(async Ie=>{const St="fetchFromStorageProvider";if(!s)return"";try{const ht=await s.getLocalItem(Ie);return ht&&n.debug("Loaded additional context from storage",{sourceFile:Nn,functionName:St}),ht||""}catch(ht){return n.error("Error loading additional context from storage",ht,{sourceFile:Nn,functionName:St}),""}},[s,n]);w.useEffect(()=>{const Ie="useEffect[threadDataListener]";if(!i){n.debug("DataProvider not available yet",{sourceFile:Nn,functionName:Ie});return}const St=async Ge=>{const cr=Ge!==null&&Ge.threadId!==xe.current;if(Ge){if(n.debug("Thread changed via platform abstraction",{sourceFile:Nn,functionName:Ie,threadId:Ge.threadId,isThreadChanged:cr}),ve(Ge.threadId),ne(Ge.participants||[]),Ge.messages&&Array.isArray(Ge.messages)&&Ge.messages.length>0&&Ge.messages[0]&&typeof Ge.messages[0]=="object"){const yr=Ge.messages.map((tr,ar)=>({body:tr.body||tr.html||"",html:tr.html||tr.body||"",from:tr.from||"",timestamp:tr.timestamp||"",subject:ar===0&&Ge.subject||""}));B(yr)}const zt=++de.current;if(cr){L(""),m(!1),x(!1),S("idle"),E(!1),yt(""),q("Neutral"),$("Neutral"),be("Neutral"),X(""),qe("");const yr=`toneSettings_${Ge.threadId}`,tr=await Or(yr);if(zt!==de.current)return;if(tr)try{const ar=JSON.parse(tr),Jn=["Casual","Neutral","Formal"],ls=["Low","Neutral","High"],qs=["Simple","Neutral","Detailed"],ho=Jn.includes(ar.formality)?ar.formality:"Neutral",Er=ls.includes(ar.empathy)?ar.empathy:"Neutral",vn=qs.includes(ar.complexity)?ar.complexity:"Neutral";q(ho),$(Er),be(vn),se(lm(ho,Er,vn))}catch{se(lm("Neutral","Neutral","Neutral"))}else se(lm("Neutral","Neutral","Neutral"))}if(xe.current=Ge.threadId,cr){const yr=`additionalContext_${Ge.threadId}`,tr=await Or(yr);if(zt!==de.current)return;X(tr),qe(tr)}else{const yr=`additionalContext_${Ge.threadId}`,tr=await Or(yr);if(zt!==de.current)return;X(tr)}}else{n.debug("Thread cleared via platform abstraction",{sourceFile:Nn,functionName:Ie});const zt=xe.current!==null;ve(null),B(null),ne([]),L(""),m(!1),x(!1),S("idle"),E(!1),zt&&(X(""),xe.current=null)}};return i.onThreadChanged(St),(async()=>{try{const Ge=await i.getCurrentThread();await St(Ge)}catch(Ge){n.error("Error loading current thread",Ge,{sourceFile:Nn,functionName:"loadCurrentThread"})}})(),()=>{i.removeThreadListener(St)}},[i,n]),w.useEffect(()=>{const St=setTimeout(async()=>{const ht="useEffect[saveAdditionalContext]";if(!(!ee||!s))try{const Ge=`additionalContext_${ee}`;await s.setLocalItem(Ge,J)}catch(Ge){n.error("Error saving additional context to storage",Ge,{sourceFile:Nn,functionName:ht,threadId:ee})}},500);return()=>clearTimeout(St)},[J,ee,s,n]),w.useEffect(()=>{if(!ee||!s)return;const St=setTimeout(async()=>{try{const ht=`toneSettings_${ee}`;await s.setLocalItem(ht,JSON.stringify({formality:z,empathy:O,complexity:ae}))}catch(ht){n.error("Error saving tone settings to storage",ht,{sourceFile:Nn,functionName:"useEffect[saveToneSettings]",threadId:ee})}},500);return()=>clearTimeout(St)},[z,O,ae,ee,s,n]),w.useEffect(()=>{const Ie=async()=>{try{if(!s)return;const Ge=await s.getLocalItem("useUscis");Be(Ge??!1),n.debug("uscisIsEnabled loaded from storage via platform abstraction",{sourceFile:Nn,functionName:"initializeUscisState",uscisEnabled:Ge??!1})}catch(Ge){n.error("Error loading USCIS state",Ge,{sourceFile:Nn,functionName:"initializeUscisState"})}},St=async()=>{try{if(!s)return;const Ge=await s.getLocalItem("useOregon");vt(Ge??!1),n.debug("oregonIsEnabled loaded from storage via platform abstraction",{sourceFile:Nn,functionName:"initializeOregonState",oregonEnabled:Ge??!1})}catch(Ge){n.error("Error loading Oregon state",Ge,{sourceFile:Nn,functionName:"initializeOregonState"})}},ht=async Ge=>{try{Ge.useUscis!==void 0&&(Be(Ge.useUscis),n.debug("USCIS setting changed via platform abstraction",{sourceFile:Nn,functionName:"handleStorageChange",useUscis:Ge.useUscis})),Ge.useOregon!==void 0&&(vt(Ge.useOregon),n.debug("Oregon setting changed via platform abstraction",{sourceFile:Nn,functionName:"handleStorageChange",useOregon:Ge.useOregon}))}catch(cr){n.error("Error handling storage changes",cr,{sourceFile:Nn,functionName:"handleStorageChange"})}};return Ie(),St(),s!=null&&s.onChanged&&s.onChanged(ht),F(!1),()=>{s!=null&&s.removeChangeListener&&ht&&s.removeChangeListener(ht)}},[s,n]),w.useEffect(()=>{if(P&&ie.current){const Ie=ie.current,ht=(Ie.scrollHeight-Ie.clientHeight)*.8;Ie.scrollTo({top:ht,behavior:"smooth"}),n.debug("Scrolling to 90% of bottom after response generation",{sourceFile:Nn,functionName:"useEffect[fullResponse]"})}},[P,n]);const vr=w.useCallback(async(Ie,St)=>{m(!0);const ht="regenerateResponse";try{if(!ee){n.error("Thread ID is not set for regeneration",void 0,{sourceFile:Nn,functionName:ht}),m(!1);return}const Ge=await LT(St,Ie,n);L(kb(Ge)),m(!1)}catch(Ge){n.error("Error regenerating response",Ge,{sourceFile:Nn,functionName:ht}),m(!1)}},[ee,n]),dn=w.useCallback(()=>{kS(NS.sanitize(P),n)},[P,n]),_e=w.useCallback(Ie=>{yt(Ie)},[]),Fe=w.useCallback(async Ie=>{const St=++K.current;m(!0);const ht="handleGenerateResponse";try{const Ge=(fe==null?void 0:fe.map(ar=>`From: ${ar.from}
Timestamp: ${ar.timestamp}
Body: ${oy(ar.body)}

`).join(""))||"",cr=[];if(ze&&cr.push(rW),Ce&&cr.push(nW),!ee){n.error("Thread ID is not set",void 0,{sourceFile:Nn,functionName:ht}),m(!1);return}let zt;const yr=(Ie==null?void 0:Ie.skipCache)??!1;if(c==="outlook"?zt=await DT(ee,Ge,J,At,It,ce,n,yr):zt=await OT(ee,Ge,J,At,It,cr,n,yr),St!==K.current)return;if(zt.response==="error")throw new Error("Server returned error response");const tr=kb(zt.response);L(tr),m(!1),S(ar=>ar==="loading"?"success":ar),zt.refreshed===!0&&E(!0),se(At),qe(J),zt.raw_cms_data&&i8(zt.raw_cms_data,n)}catch(Ge){n.error("Error generating response",Ge,{sourceFile:Nn,functionName:ht}),m(!1),x(!0),S(cr=>cr==="loading"?"error":cr)}},[c,fe,J,At,It,ze,Ce,ee,ce,n]),nt=w.useCallback(async()=>{S("loading"),await Fe({skipCache:!0}),e==null||e()},[Fe,e]),ft=w.useCallback(async()=>{S("loading"),await Fe({skipCache:!0})},[Fe]);w.useEffect(()=>{t==null||t(ft)},[t,ft]);const Ut=w.useCallback(()=>{x(!1),Fe()},[Fe]),Ue=w.useCallback(async()=>{try{if(J!==Te){L(""),await Fe({skipCache:!0}),se(At),qe(J),yt(""),R(!0);return}const St=[];if(At!==ge&&St.push(`Rewrite this email draft applying the following tone: ${At}`),kt.trim()&&St.push(kt.trim()),St.length===0)return;await vr(St.join(`

Also: `),P),se(At),yt(""),R(!0)}catch(Ie){n.error("Error applying changes",Ie,{sourceFile:Nn,functionName:"handleApplyChanges"})}},[J,At,kt,P,vr,Fe,Te,ge,n]),He=(At!==ge||J!==Te||kt.trim().length>0)&&!!P&&!p;return w.useEffect(()=>{if(A||!ee||!fe||P||p||g||c==="chrome"&&!d)return;let Ie=!1;return(()=>{Ie||Fe()})(),()=>{Ie=!0}},[A,ee,fe,P,p,g,c,d,Fe,n]),w.useEffect(()=>{if(b!=="idle"&&b!=="loading"){const Ie=setTimeout(()=>S("idle"),5e3);return()=>clearTimeout(Ie)}},[b]),w.useEffect(()=>{if(C){const Ie=setTimeout(()=>R(!1),5e3);return()=>clearTimeout(Ie)}},[C]),c==="chrome"&&!d?u.jsx("div",{className:"p-4",children:u.jsx(d0,{feature:"Email Composition",description:"Connect your Gmail account to generate personalized email responses",benefits:["Analyze email threads and context automatically","Generate contextually relevant responses","Insert generated content directly into compose box"]})}):u.jsxs("div",{className:"space-y-4 h-full overflow-y-auto overflow-x-hidden",ref:ie,children:[u.jsx(tW,{fullResponse:P,isGenerating:p,hasError:g,onInsert:dn,onRefresh:nt,onCreateDraft:Ut,refreshStatus:b,isRefreshed:T,hasPendingChanges:He,onApplyChanges:Ue,showApplySuccess:C}),u.jsx(Z7,{isOpen:G,onToggle:Xt,formality:z,empathy:O,complexity:ae,onFormalityChange:q,onEmpathyChange:$,onComplexityChange:be}),u.jsx(Q7,{isOpen:V,onToggle:Yt,value:J,onChange:X,onRefine:_e,onRefineInstructionChange:yt,hasGeneratedResponse:!!P}),u.jsx("div",{className:"mb-24"})]})},WA=w.forwardRef(({value:r,onChange:e,className:t,...n},s)=>{const i=w.useRef(null);w.useImperativeHandle(s,()=>i.current);const c=()=>{const d=i.current;d&&(d.style.height="auto",d.style.height=`${d.scrollHeight}px`)};return w.useEffect(()=>{c()},[r]),u.jsx("textarea",{ref:i,value:r,onChange:d=>{e&&e(d)},className:`auto-resizing-textarea ${t||""}`,...n})});WA.displayName="AutoResizingTextarea";var iW=jb[" useId ".trim().toString()]||(()=>{}),aW=0;function Gl(r){const[e,t]=w.useState(iW());return Vl(()=>{t(n=>n??String(aW++))},[r]),e?`radix-${e}`:""}var pw="focusScope.autoFocusOnMount",mw="focusScope.autoFocusOnUnmount",aN={bubbles:!1,cancelable:!0},lW="FocusScope",TS=w.forwardRef((r,e)=>{const{loop:t=!1,trapped:n=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...c}=r,[d,p]=w.useState(null),m=Yl(s),g=Yl(i),x=w.useRef(null),b=Ln(e,E=>p(E)),S=w.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;w.useEffect(()=>{if(n){let E=function(F){if(S.paused||!d)return;const P=F.target;d.contains(P)?x.current=P:$c(x.current,{select:!0})},C=function(F){if(S.paused||!d)return;const P=F.relatedTarget;P!==null&&(d.contains(P)||$c(x.current,{select:!0}))},R=function(F){if(document.activeElement===document.body)for(const L of F)L.removedNodes.length>0&&$c(d)};document.addEventListener("focusin",E),document.addEventListener("focusout",C);const A=new MutationObserver(R);return d&&A.observe(d,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",E),document.removeEventListener("focusout",C),A.disconnect()}}},[n,d,S.paused]),w.useEffect(()=>{if(d){cN.add(S);const E=document.activeElement;if(!d.contains(E)){const R=new CustomEvent(pw,aN);d.addEventListener(pw,m),d.dispatchEvent(R),R.defaultPrevented||(cW(pW(VA(d)),{select:!0}),document.activeElement===E&&$c(d))}return()=>{d.removeEventListener(pw,m),setTimeout(()=>{const R=new CustomEvent(mw,aN);d.addEventListener(mw,g),d.dispatchEvent(R),R.defaultPrevented||$c(E??document.body,{select:!0}),d.removeEventListener(mw,g),cN.remove(S)},0)}}},[d,m,g,S]);const T=w.useCallback(E=>{if(!t&&!n||S.paused)return;const C=E.key==="Tab"&&!E.altKey&&!E.ctrlKey&&!E.metaKey,R=document.activeElement;if(C&&R){const A=E.currentTarget,[F,P]=uW(A);F&&P?!E.shiftKey&&R===P?(E.preventDefault(),t&&$c(F,{select:!0})):E.shiftKey&&R===F&&(E.preventDefault(),t&&$c(P,{select:!0})):R===A&&E.preventDefault()}},[t,n,S.paused]);return u.jsx(Ur.div,{tabIndex:-1,...c,ref:b,onKeyDown:T})});TS.displayName=lW;function cW(r,{select:e=!1}={}){const t=document.activeElement;for(const n of r)if($c(n,{select:e}),document.activeElement!==t)return}function uW(r){const e=VA(r),t=lN(e,r),n=lN(e.reverse(),r);return[t,n]}function VA(r){const e=[],t=document.createTreeWalker(r,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const s=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||s?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;t.nextNode();)e.push(t.currentNode);return e}function lN(r,e){for(const t of r)if(!dW(t,{upTo:e}))return t}function dW(r,{upTo:e}){if(getComputedStyle(r).visibility==="hidden")return!0;for(;r;){if(e!==void 0&&r===e)return!1;if(getComputedStyle(r).display==="none")return!0;r=r.parentElement}return!1}function fW(r){return r instanceof HTMLInputElement&&"select"in r}function $c(r,{select:e=!1}={}){if(r&&r.focus){const t=document.activeElement;r.focus({preventScroll:!0}),r!==t&&fW(r)&&e&&r.select()}}var cN=hW();function hW(){let r=[];return{add(e){const t=r[0];e!==t&&(t==null||t.pause()),r=uN(r,e),r.unshift(e)},remove(e){var t;r=uN(r,e),(t=r[0])==null||t.resume()}}}function uN(r,e){const t=[...r],n=t.indexOf(e);return n!==-1&&t.splice(n,1),t}function pW(r){return r.filter(e=>e.tagName!=="A")}var gw=0;function qA(){w.useEffect(()=>{const r=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",r[0]??dN()),document.body.insertAdjacentElement("beforeend",r[1]??dN()),gw++,()=>{gw===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),gw--}},[])}function dN(){const r=document.createElement("span");return r.setAttribute("data-radix-focus-guard",""),r.tabIndex=0,r.style.outline="none",r.style.opacity="0",r.style.position="fixed",r.style.pointerEvents="none",r}var iy="right-scroll-bar-position",ay="width-before-scroll-bar",mW="with-scroll-bars-hidden",gW="--removed-body-scroll-bar-size";function vw(r,e){return typeof r=="function"?r(e):r&&(r.current=e),r}function vW(r,e){var t=w.useState(function(){return{value:r,callback:e,facade:{get current(){return t.value},set current(n){var s=t.value;s!==n&&(t.value=n,t.callback(n,s))}}}})[0];return t.callback=e,t.facade}var yW=typeof window<"u"?w.useLayoutEffect:w.useEffect,fN=new WeakMap;function xW(r,e){var t=vW(null,function(n){return r.forEach(function(s){return vw(s,n)})});return yW(function(){var n=fN.get(t);if(n){var s=new Set(n),i=new Set(r),c=t.current;s.forEach(function(d){i.has(d)||vw(d,null)}),i.forEach(function(d){s.has(d)||vw(d,c)})}fN.set(t,r)},[r]),t}function wW(r){return r}function bW(r,e){e===void 0&&(e=wW);var t=[],n=!1,s={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return t.length?t[t.length-1]:r},useMedium:function(i){var c=e(i,n);return t.push(c),function(){t=t.filter(function(d){return d!==c})}},assignSyncMedium:function(i){for(n=!0;t.length;){var c=t;t=[],c.forEach(i)}t={push:function(d){return i(d)},filter:function(){return t}}},assignMedium:function(i){n=!0;var c=[];if(t.length){var d=t;t=[],d.forEach(i),c=t}var p=function(){var g=c;c=[],g.forEach(i)},m=function(){return Promise.resolve().then(p)};m(),t={push:function(g){c.push(g),m()},filter:function(g){return c=c.filter(g),t}}}};return s}function _W(r){r===void 0&&(r={});var e=bW(null);return e.options=Ua({async:!0,ssr:!1},r),e}var KA=function(r){var e=r.sideCar,t=O1(r,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=e.read();if(!n)throw new Error("Sidecar medium not found");return w.createElement(n,Ua({},t))};KA.isSideCarExport=!0;function SW(r,e){return r.useMedium(e),KA}var YA=_W(),yw=function(){},f0=w.forwardRef(function(r,e){var t=w.useRef(null),n=w.useState({onScrollCapture:yw,onWheelCapture:yw,onTouchMoveCapture:yw}),s=n[0],i=n[1],c=r.forwardProps,d=r.children,p=r.className,m=r.removeScrollBar,g=r.enabled,x=r.shards,b=r.sideCar,S=r.noRelative,T=r.noIsolation,E=r.inert,C=r.allowPinchZoom,R=r.as,A=R===void 0?"div":R,F=r.gapMode,P=O1(r,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),L=b,G=xW([t,e]),U=Ua(Ua({},P),s);return w.createElement(w.Fragment,null,g&&w.createElement(L,{sideCar:YA,removeScrollBar:m,shards:x,noRelative:S,noIsolation:T,inert:E,setCallbacks:i,allowPinchZoom:!!C,lockRef:t,gapMode:F}),c?w.cloneElement(w.Children.only(d),Ua(Ua({},U),{ref:G})):w.createElement(A,Ua({},U,{className:p,ref:G}),d))});f0.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};f0.classNames={fullWidth:ay,zeroRight:iy};var EW=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function CW(){if(!document)return null;var r=document.createElement("style");r.type="text/css";var e=EW();return e&&r.setAttribute("nonce",e),r}function kW(r,e){r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}function NW(r){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(r)}var TW=function(){var r=0,e=null;return{add:function(t){r==0&&(e=CW())&&(kW(e,t),NW(e)),r++},remove:function(){r--,!r&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},RW=function(){var r=TW();return function(e,t){w.useEffect(function(){return r.add(e),function(){r.remove()}},[e&&t])}},JA=function(){var r=RW(),e=function(t){var n=t.styles,s=t.dynamic;return r(n,s),null};return e},AW={left:0,top:0,right:0,gap:0},xw=function(r){return parseInt(r||"",10)||0},IW=function(r){var e=window.getComputedStyle(document.body),t=e[r==="padding"?"paddingLeft":"marginLeft"],n=e[r==="padding"?"paddingTop":"marginTop"],s=e[r==="padding"?"paddingRight":"marginRight"];return[xw(t),xw(n),xw(s)]},PW=function(r){if(r===void 0&&(r="margin"),typeof window>"u")return AW;var e=IW(r),t=document.documentElement.clientWidth,n=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,n-t+e[2]-e[0])}},jW=JA(),ch="data-scroll-locked",FW=function(r,e,t,n){var s=r.left,i=r.top,c=r.right,d=r.gap;return t===void 0&&(t="margin"),`
  .`.concat(mW,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(d,"px ").concat(n,`;
  }
  body[`).concat(ch,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(n,";"),t==="margin"&&`
    padding-left: `.concat(s,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(c,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(d,"px ").concat(n,`;
    `),t==="padding"&&"padding-right: ".concat(d,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(iy,` {
    right: `).concat(d,"px ").concat(n,`;
  }
  
  .`).concat(ay,` {
    margin-right: `).concat(d,"px ").concat(n,`;
  }
  
  .`).concat(iy," .").concat(iy,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(ay," .").concat(ay,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(ch,`] {
    `).concat(gW,": ").concat(d,`px;
  }
`)},hN=function(){var r=parseInt(document.body.getAttribute(ch)||"0",10);return isFinite(r)?r:0},OW=function(){w.useEffect(function(){return document.body.setAttribute(ch,(hN()+1).toString()),function(){var r=hN()-1;r<=0?document.body.removeAttribute(ch):document.body.setAttribute(ch,r.toString())}},[])},DW=function(r){var e=r.noRelative,t=r.noImportant,n=r.gapMode,s=n===void 0?"margin":n;OW();var i=w.useMemo(function(){return PW(s)},[s]);return w.createElement(jW,{styles:FW(i,!e,s,t?"":"!important")})},Nb=!1;if(typeof window<"u")try{var zv=Object.defineProperty({},"passive",{get:function(){return Nb=!0,!0}});window.addEventListener("test",zv,zv),window.removeEventListener("test",zv,zv)}catch{Nb=!1}var Wf=Nb?{passive:!1}:!1,LW=function(r){return r.tagName==="TEXTAREA"},XA=function(r,e){if(!(r instanceof Element))return!1;var t=window.getComputedStyle(r);return t[e]!=="hidden"&&!(t.overflowY===t.overflowX&&!LW(r)&&t[e]==="visible")},MW=function(r){return XA(r,"overflowY")},$W=function(r){return XA(r,"overflowX")},pN=function(r,e){var t=e.ownerDocument,n=e;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var s=QA(r,n);if(s){var i=ZA(r,n),c=i[1],d=i[2];if(c>d)return!0}n=n.parentNode}while(n&&n!==t.body);return!1},UW=function(r){var e=r.scrollTop,t=r.scrollHeight,n=r.clientHeight;return[e,t,n]},zW=function(r){var e=r.scrollLeft,t=r.scrollWidth,n=r.clientWidth;return[e,t,n]},QA=function(r,e){return r==="v"?MW(e):$W(e)},ZA=function(r,e){return r==="v"?UW(e):zW(e)},HW=function(r,e){return r==="h"&&e==="rtl"?-1:1},BW=function(r,e,t,n,s){var i=HW(r,window.getComputedStyle(e).direction),c=i*n,d=t.target,p=e.contains(d),m=!1,g=c>0,x=0,b=0;do{if(!d)break;var S=ZA(r,d),T=S[0],E=S[1],C=S[2],R=E-C-i*T;(T||R)&&QA(r,d)&&(x+=R,b+=T);var A=d.parentNode;d=A&&A.nodeType===Node.DOCUMENT_FRAGMENT_NODE?A.host:A}while(!p&&d!==document.body||p&&(e.contains(d)||e===d));return(g&&Math.abs(x)<1||!g&&Math.abs(b)<1)&&(m=!0),m},Hv=function(r){return"changedTouches"in r?[r.changedTouches[0].clientX,r.changedTouches[0].clientY]:[0,0]},mN=function(r){return[r.deltaX,r.deltaY]},gN=function(r){return r&&"current"in r?r.current:r},GW=function(r,e){return r[0]===e[0]&&r[1]===e[1]},WW=function(r){return`
  .block-interactivity-`.concat(r,` {pointer-events: none;}
  .allow-interactivity-`).concat(r,` {pointer-events: all;}
`)},VW=0,Vf=[];function qW(r){var e=w.useRef([]),t=w.useRef([0,0]),n=w.useRef(),s=w.useState(VW++)[0],i=w.useState(JA)[0],c=w.useRef(r);w.useEffect(function(){c.current=r},[r]),w.useEffect(function(){if(r.inert){document.body.classList.add("block-interactivity-".concat(s));var E=JM([r.lockRef.current],(r.shards||[]).map(gN),!0).filter(Boolean);return E.forEach(function(C){return C.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),E.forEach(function(C){return C.classList.remove("allow-interactivity-".concat(s))})}}},[r.inert,r.lockRef.current,r.shards]);var d=w.useCallback(function(E,C){if("touches"in E&&E.touches.length===2||E.type==="wheel"&&E.ctrlKey)return!c.current.allowPinchZoom;var R=Hv(E),A=t.current,F="deltaX"in E?E.deltaX:A[0]-R[0],P="deltaY"in E?E.deltaY:A[1]-R[1],L,G=E.target,U=Math.abs(F)>Math.abs(P)?"h":"v";if("touches"in E&&U==="h"&&G.type==="range")return!1;var V=window.getSelection(),Q=V&&V.anchorNode,fe=Q?Q===G||Q.contains(G):!1;if(fe)return!1;var B=pN(U,G);if(!B)return!0;if(B?L=U:(L=U==="v"?"h":"v",B=pN(U,G)),!B)return!1;if(!n.current&&"changedTouches"in E&&(F||P)&&(n.current=L),!L)return!0;var ee=n.current||L;return BW(ee,C,E,ee==="h"?F:P)},[]),p=w.useCallback(function(E){var C=E;if(!(!Vf.length||Vf[Vf.length-1]!==i)){var R="deltaY"in C?mN(C):Hv(C),A=e.current.filter(function(L){return L.name===C.type&&(L.target===C.target||C.target===L.shadowParent)&&GW(L.delta,R)})[0];if(A&&A.should){C.cancelable&&C.preventDefault();return}if(!A){var F=(c.current.shards||[]).map(gN).filter(Boolean).filter(function(L){return L.contains(C.target)}),P=F.length>0?d(C,F[0]):!c.current.noIsolation;P&&C.cancelable&&C.preventDefault()}}},[]),m=w.useCallback(function(E,C,R,A){var F={name:E,delta:C,target:R,should:A,shadowParent:KW(R)};e.current.push(F),setTimeout(function(){e.current=e.current.filter(function(P){return P!==F})},1)},[]),g=w.useCallback(function(E){t.current=Hv(E),n.current=void 0},[]),x=w.useCallback(function(E){m(E.type,mN(E),E.target,d(E,r.lockRef.current))},[]),b=w.useCallback(function(E){m(E.type,Hv(E),E.target,d(E,r.lockRef.current))},[]);w.useEffect(function(){return Vf.push(i),r.setCallbacks({onScrollCapture:x,onWheelCapture:x,onTouchMoveCapture:b}),document.addEventListener("wheel",p,Wf),document.addEventListener("touchmove",p,Wf),document.addEventListener("touchstart",g,Wf),function(){Vf=Vf.filter(function(E){return E!==i}),document.removeEventListener("wheel",p,Wf),document.removeEventListener("touchmove",p,Wf),document.removeEventListener("touchstart",g,Wf)}},[]);var S=r.removeScrollBar,T=r.inert;return w.createElement(w.Fragment,null,T?w.createElement(i,{styles:WW(s)}):null,S?w.createElement(DW,{noRelative:r.noRelative,gapMode:r.gapMode}):null)}function KW(r){for(var e=null;r!==null;)r instanceof ShadowRoot&&(e=r.host,r=r.host),r=r.parentNode;return e}const YW=SW(YA,qW);var RS=w.forwardRef(function(r,e){return w.createElement(f0,Ua({},r,{ref:e,sideCar:YW}))});RS.classNames=f0.classNames;var JW=function(r){if(typeof document>"u")return null;var e=Array.isArray(r)?r[0]:r;return e.ownerDocument.body},qf=new WeakMap,Bv=new WeakMap,Gv={},ww=0,eI=function(r){return r&&(r.host||eI(r.parentNode))},XW=function(r,e){return e.map(function(t){if(r.contains(t))return t;var n=eI(t);return n&&r.contains(n)?n:(console.error("aria-hidden",t,"in not contained inside",r,". Doing nothing"),null)}).filter(function(t){return!!t})},QW=function(r,e,t,n){var s=XW(e,Array.isArray(r)?r:[r]);Gv[t]||(Gv[t]=new WeakMap);var i=Gv[t],c=[],d=new Set,p=new Set(s),m=function(x){!x||d.has(x)||(d.add(x),m(x.parentNode))};s.forEach(m);var g=function(x){!x||p.has(x)||Array.prototype.forEach.call(x.children,function(b){if(d.has(b))g(b);else try{var S=b.getAttribute(n),T=S!==null&&S!=="false",E=(qf.get(b)||0)+1,C=(i.get(b)||0)+1;qf.set(b,E),i.set(b,C),c.push(b),E===1&&T&&Bv.set(b,!0),C===1&&b.setAttribute(t,"true"),T||b.setAttribute(n,"true")}catch(R){console.error("aria-hidden: cannot operate on ",b,R)}})};return g(e),d.clear(),ww++,function(){c.forEach(function(x){var b=qf.get(x)-1,S=i.get(x)-1;qf.set(x,b),i.set(x,S),b||(Bv.has(x)||x.removeAttribute(n),Bv.delete(x)),S||x.removeAttribute(t)}),ww--,ww||(qf=new WeakMap,qf=new WeakMap,Bv=new WeakMap,Gv={})}},tI=function(r,e,t){t===void 0&&(t="data-aria-hidden");var n=Array.from(Array.isArray(r)?r:[r]),s=JW(r);return s?(n.push.apply(n,Array.from(s.querySelectorAll("[aria-live], script"))),QW(n,s,t,"aria-hidden")):function(){return null}};function ZW(r){const e=e9(r),t=w.forwardRef((n,s)=>{const{children:i,...c}=n,d=w.Children.toArray(i),p=d.find(r9);if(p){const m=p.props.children,g=d.map(x=>x===p?w.Children.count(m)>1?w.Children.only(null):w.isValidElement(m)?m.props.children:null:x);return u.jsx(e,{...c,ref:s,children:w.isValidElement(m)?w.cloneElement(m,void 0,g):null})}return u.jsx(e,{...c,ref:s,children:i})});return t.displayName=`${r}.Slot`,t}function e9(r){const e=w.forwardRef((t,n)=>{const{children:s,...i}=t;if(w.isValidElement(s)){const c=s9(s),d=n9(i,s.props);return s.type!==w.Fragment&&(d.ref=n?eu(n,c):c),w.cloneElement(s,d)}return w.Children.count(s)>1?w.Children.only(null):null});return e.displayName=`${r}.SlotClone`,e}var t9=Symbol("radix.slottable");function r9(r){return w.isValidElement(r)&&typeof r.type=="function"&&"__radixId"in r.type&&r.type.__radixId===t9}function n9(r,e){const t={...e};for(const n in e){const s=r[n],i=e[n];/^on[A-Z]/.test(n)?s&&i?t[n]=(...d)=>{const p=i(...d);return s(...d),p}:s&&(t[n]=s):n==="style"?t[n]={...s,...i}:n==="className"&&(t[n]=[s,i].filter(Boolean).join(" "))}return{...r,...t}}function s9(r){var n,s;let e=(n=Object.getOwnPropertyDescriptor(r.props,"ref"))==null?void 0:n.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=(s=Object.getOwnPropertyDescriptor(r,"ref"))==null?void 0:s.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}var h0="Dialog",[rI]=Ja(h0),[o9,ua]=rI(h0),nI=r=>{const{__scopeDialog:e,children:t,open:n,defaultOpen:s,onOpenChange:i,modal:c=!0}=r,d=w.useRef(null),p=w.useRef(null),[m,g]=tu({prop:n,defaultProp:s??!1,onChange:i,caller:h0});return u.jsx(o9,{scope:e,triggerRef:d,contentRef:p,contentId:Gl(),titleId:Gl(),descriptionId:Gl(),open:m,onOpenChange:g,onOpenToggle:w.useCallback(()=>g(x=>!x),[g]),modal:c,children:t})};nI.displayName=h0;var sI="DialogTrigger",i9=w.forwardRef((r,e)=>{const{__scopeDialog:t,...n}=r,s=ua(sI,t),i=Ln(e,s.triggerRef);return u.jsx(Ur.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":PS(s.open),...n,ref:i,onClick:Lt(r.onClick,s.onOpenToggle)})});i9.displayName=sI;var AS="DialogPortal",[a9,oI]=rI(AS,{forceMount:void 0}),iI=r=>{const{__scopeDialog:e,forceMount:t,children:n,container:s}=r,i=ua(AS,e);return u.jsx(a9,{scope:e,forceMount:t,children:w.Children.map(n,c=>u.jsx(ca,{present:t||i.open,children:u.jsx(ES,{asChild:!0,container:s,children:c})}))})};iI.displayName=AS;var My="DialogOverlay",aI=w.forwardRef((r,e)=>{const t=oI(My,r.__scopeDialog),{forceMount:n=t.forceMount,...s}=r,i=ua(My,r.__scopeDialog);return i.modal?u.jsx(ca,{present:n||i.open,children:u.jsx(c9,{...s,ref:e})}):null});aI.displayName=My;var l9=ZW("DialogOverlay.RemoveScroll"),c9=w.forwardRef((r,e)=>{const{__scopeDialog:t,...n}=r,s=ua(My,t);return u.jsx(RS,{as:l9,allowPinchZoom:!0,shards:[s.contentRef],children:u.jsx(Ur.div,{"data-state":PS(s.open),...n,ref:e,style:{pointerEvents:"auto",...n.style}})})}),hd="DialogContent",lI=w.forwardRef((r,e)=>{const t=oI(hd,r.__scopeDialog),{forceMount:n=t.forceMount,...s}=r,i=ua(hd,r.__scopeDialog);return u.jsx(ca,{present:n||i.open,children:i.modal?u.jsx(u9,{...s,ref:e}):u.jsx(d9,{...s,ref:e})})});lI.displayName=hd;var u9=w.forwardRef((r,e)=>{const t=ua(hd,r.__scopeDialog),n=w.useRef(null),s=Ln(e,t.contentRef,n);return w.useEffect(()=>{const i=n.current;if(i)return tI(i)},[]),u.jsx(cI,{...r,ref:s,trapFocus:t.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Lt(r.onCloseAutoFocus,i=>{var c;i.preventDefault(),(c=t.triggerRef.current)==null||c.focus()}),onPointerDownOutside:Lt(r.onPointerDownOutside,i=>{const c=i.detail.originalEvent,d=c.button===0&&c.ctrlKey===!0;(c.button===2||d)&&i.preventDefault()}),onFocusOutside:Lt(r.onFocusOutside,i=>i.preventDefault())})}),d9=w.forwardRef((r,e)=>{const t=ua(hd,r.__scopeDialog),n=w.useRef(!1),s=w.useRef(!1);return u.jsx(cI,{...r,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var c,d;(c=r.onCloseAutoFocus)==null||c.call(r,i),i.defaultPrevented||(n.current||(d=t.triggerRef.current)==null||d.focus(),i.preventDefault()),n.current=!1,s.current=!1},onInteractOutside:i=>{var p,m;(p=r.onInteractOutside)==null||p.call(r,i),i.defaultPrevented||(n.current=!0,i.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const c=i.target;((m=t.triggerRef.current)==null?void 0:m.contains(c))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&s.current&&i.preventDefault()}})}),cI=w.forwardRef((r,e)=>{const{__scopeDialog:t,trapFocus:n,onOpenAutoFocus:s,onCloseAutoFocus:i,...c}=r,d=ua(hd,t),p=w.useRef(null),m=Ln(e,p);return qA(),u.jsxs(u.Fragment,{children:[u.jsx(TS,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:s,onUnmountAutoFocus:i,children:u.jsx(l0,{role:"dialog",id:d.contentId,"aria-describedby":d.descriptionId,"aria-labelledby":d.titleId,"data-state":PS(d.open),...c,ref:m,onDismiss:()=>d.onOpenChange(!1)})}),u.jsxs(u.Fragment,{children:[u.jsx(f9,{titleId:d.titleId}),u.jsx(p9,{contentRef:p,descriptionId:d.descriptionId})]})]})}),IS="DialogTitle",uI=w.forwardRef((r,e)=>{const{__scopeDialog:t,...n}=r,s=ua(IS,t);return u.jsx(Ur.h2,{id:s.titleId,...n,ref:e})});uI.displayName=IS;var dI="DialogDescription",fI=w.forwardRef((r,e)=>{const{__scopeDialog:t,...n}=r,s=ua(dI,t);return u.jsx(Ur.p,{id:s.descriptionId,...n,ref:e})});fI.displayName=dI;var hI="DialogClose",pI=w.forwardRef((r,e)=>{const{__scopeDialog:t,...n}=r,s=ua(hI,t);return u.jsx(Ur.button,{type:"button",...n,ref:e,onClick:Lt(r.onClick,()=>s.onOpenChange(!1))})});pI.displayName=hI;function PS(r){return r?"open":"closed"}var mI="DialogTitleWarning",[VK,gI]=kB(mI,{contentName:hd,titleName:IS,docsSlug:"dialog"}),f9=({titleId:r})=>{const e=gI(mI),t=`\`${e.contentName}\` requires a \`${e.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${e.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${e.docsSlug}`;return w.useEffect(()=>{r&&(document.getElementById(r)||console.error(t))},[t,r]),null},h9="DialogDescriptionWarning",p9=({contentRef:r,descriptionId:e})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${gI(h9).contentName}}.`;return w.useEffect(()=>{var i;const s=(i=r.current)==null?void 0:i.getAttribute("aria-describedby");e&&s&&(document.getElementById(e)||console.warn(n))},[n,r,e]),null},m9=nI,g9=iI,vI=aI,yI=lI,xI=uI,wI=fI,v9=pI;const y9=m9,x9=g9,bI=w.forwardRef(({className:r,...e},t)=>u.jsx(vI,{ref:t,className:Fr("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",r),...e}));bI.displayName=vI.displayName;const _I=w.forwardRef(({className:r,children:e,...t},n)=>u.jsxs(x9,{children:[u.jsx(bI,{}),u.jsxs(yI,{ref:n,className:Fr("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",r),...t,children:[e,u.jsxs(v9,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[u.jsx(Oi,{className:"h-4 w-4"}),u.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));_I.displayName=yI.displayName;const SI=({className:r,...e})=>u.jsx("div",{className:Fr("flex flex-col space-y-1.5 text-center sm:text-left",r),...e});SI.displayName="DialogHeader";const EI=({className:r,...e})=>u.jsx("div",{className:Fr("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",r),...e});EI.displayName="DialogFooter";const CI=w.forwardRef(({className:r,...e},t)=>u.jsx(xI,{ref:t,className:Fr("text-lg font-semibold leading-none tracking-tight",r),...e}));CI.displayName=xI.displayName;const kI=w.forwardRef(({className:r,...e},t)=>u.jsx(wI,{ref:t,className:Fr("text-sm text-muted-foreground",r),...e}));kI.displayName=wI.displayName;const w9=({isOpen:r,onClose:e,title:t="Gmail Connection Required",description:n="This feature requires an active Gmail connection. Please connect your Gmail account to continue.",actionText:s="the requested action"})=>{const[i,c]=w.useState(!1),{initiateReconnection:d,wasEverConnected:p}=$i(),m=async()=>{c(!0);try{await d(),e()}catch(g){console.error("Failed to reconnect Gmail:",g)}finally{c(!1)}};return u.jsx(y9,{open:r,onOpenChange:e,children:u.jsxs(_I,{className:"sm:max-w-md",children:[u.jsxs(SI,{children:[u.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[u.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:u.jsx(Jc,{className:"h-5 w-5 text-blue-600"})}),u.jsx(CI,{className:"text-lg font-semibold",children:t})]}),u.jsx(kI,{className:"text-sm text-gray-600 leading-relaxed",children:n})]}),u.jsx("div",{className:"bg-gray-50 rounded-lg p-4 my-4",children:u.jsxs("div",{className:"flex items-start gap-3",children:[u.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full mt-2 flex-shrink-0"}),u.jsxs("div",{className:"text-sm text-gray-700",children:[u.jsx("p",{className:"font-medium mb-1",children:"What happens next:"}),u.jsxs("p",{children:["You'll be redirected to Gmail's authorization page to ",p?"reconnect":"connect"," your account securely."]})]})]})}),u.jsxs(EI,{className:"flex gap-2 sm:gap-2",children:[u.jsx(We,{variant:"outline",onClick:e,disabled:i,className:"flex-1",children:"Cancel"}),u.jsx(We,{onClick:m,disabled:i,className:"flex-1 bg-blue-600 hover:bg-blue-700",children:i?u.jsxs(u.Fragment,{children:[u.jsx(Do,{className:"h-4 w-4 mr-2 animate-spin"}),"Connecting..."]}):p?"Reconnect Gmail":"Connect Gmail"})]})]})})},on="src/shared/components/sidepanel/panels/GenerateEmailDraftPanel.tsx",b9=()=>`The response should just be the email body with salutation at the beginning. Do not include a subject line in your response draft. 
    Do not add links to the references in your response draft. Do not add citation numbers in your response draft.
    Do not list the references in your response draft, since they will be added in a different section in the JSON response.
    Do not add a complimentary closing or a signature as this will be added later.`.trim(),_9=(r,e,t)=>{let n="";switch(r){case"Casual":n+="Keep the tone casual. ";break;case"Neutral":n+="Maintain a neutral tone. ";break;case"Formal":n+="Keep the tone formal. ";break}switch(e){case"Low":n+="Show low empathy. ";break;case"Neutral":n+="Maintain neutral empathy. ";break;case"High":n+="Show high empathy. ";break}switch(t){case"Simple":n+="Keep it simple amd use simple words. ";break;case"Neutral":n+="Maintain neutral complexity. ";break;case"Detailed":n+="Provide detailed information and you're free to use harder words. ";break}return n.trim()},S9=({clientEmail:r})=>{const e=zr(),t=Ya(),n=aa(),s=un().platform,{isConnected:i}=$i(),[c,d]=w.useState(!1),[p,m]=w.useState(!1),[g,x]=w.useState(""),b=w.useRef(null),[S,T]=w.useState(!0),[E,C]=w.useState(""),[R,A]=w.useState([]),[F,P]=w.useState(0),[L,G]=w.useState(""),[U,V]=w.useState(!1),[Q,fe]=w.useState(!0),[B,ee]=w.useState(!0),[ve,ce]=w.useState(!0),[ne,xe]=w.useState(null),[J,X]=w.useState(null),[z,q]=w.useState([]),O=w.useRef(null),[$,ae]=w.useState(""),[be,ie]=w.useState("Neutral"),[K,de]=w.useState("Neutral"),[ge,se]=w.useState("Neutral"),Te=w.useRef(null),[qe,ze]=w.useState(!1),[Be,Ce]=w.useState(!1),[vt,kt]=w.useState([]),[yt,At]=w.useState(!0),[It,Yt]=w.useState(!1),Xt="25dc68db26595a7485917129d6993f96",Or="c1c8e460f2105029b2b4563f9222161c",vr=["Analyzing email thread...","Pulling relevant information...","Structuring your response...","Preparing personalized reply...","Finalizing your draft..."],dn=w.useCallback(async Ue=>{const He="fetchFromStorageProvider";if(!t)return"";try{const Mt=await t.getLocalItem(Ue);return Mt&&e.debug("Loaded additional context from storage",{sourceFile:on,functionName:He}),Mt||""}catch(Mt){return e.error("Error loading additional context from storage",Mt,{sourceFile:on,functionName:He}),""}},[t,e]);w.useEffect(()=>{let Ue;const He=()=>{if(c){const Mt=Math.floor(Math.random()*2e3)+1e3;Ue=setTimeout(()=>{P(Ie=>(Ie+1)%vr.length),He()},Mt)}};return c&&He(),()=>{Ue&&clearTimeout(Ue)}},[c,vr.length]),w.useEffect(()=>{const Ue="useEffect[threadDataListener]";if(!n){e.debug("DataProvider not available yet",{sourceFile:on,functionName:Ue});return}const He=async Ie=>{const St=Ie!==null&&Ie.threadId!==O.current;if(Ie){if(e.debug("Thread changed via platform abstraction",{sourceFile:on,functionName:Ue,threadId:Ie.threadId,isThreadChanged:St}),X(Ie.threadId),q(Ie.participants||[]),Ie.messages&&Array.isArray(Ie.messages)&&Ie.messages.length>0&&Ie.messages[0]&&typeof Ie.messages[0]=="object"){const Ge=Ie.messages.map((zt,yr)=>({body:zt.body||zt.html||"",html:zt.html||zt.body||"",from:zt.from||"",timestamp:zt.timestamp||"",subject:yr===0&&Ie.subject||""}));xe(Ge);const cr=Ge.length>0?oy(Ge[0].body):"";G(cr)}if(St){C(""),A([]),kt([]),m(!1),d(!1),ie("Neutral"),de("Neutral"),se("Neutral"),ae("");const Ge=`toneSettings_${Ie.threadId}`,cr=await dn(Ge);if(cr)try{const zt=JSON.parse(cr),yr=["Casual","Neutral","Formal"],tr=["Low","Neutral","High"],ar=["Simple","Neutral","Detailed"];yr.includes(zt.formality)&&ie(zt.formality),tr.includes(zt.empathy)&&de(zt.empathy),ar.includes(zt.complexity)&&se(zt.complexity)}catch{}}O.current=Ie.threadId;const ht=`additionalContext_${Ie.threadId}`;ae(await dn(ht))}else{e.debug("Thread cleared via platform abstraction",{sourceFile:on,functionName:Ue});const ht=O.current!==null;X(null),xe(null),q([]),G(""),C(""),A([]),kt([]),m(!1),d(!1),ht&&(ae(""),O.current=null)}};return n.onThreadChanged(He),(async()=>{try{const Ie=await n.getCurrentThread();await He(Ie)}catch(Ie){e.error("Error loading current thread",Ie,{sourceFile:on,functionName:"loadCurrentThread"})}})(),()=>{n.removeThreadListener(He)}},[n,e]),w.useEffect(()=>{const He=setTimeout(async()=>{const Mt="useEffect[saveAdditionalContext]";if(!(!J||!t))try{const Ie=`additionalContext_${J}`;await t.setLocalItem(Ie,$)}catch(Ie){e.error("Error saving additional context to storage",Ie,{sourceFile:on,functionName:Mt,threadId:J})}},500);return()=>clearTimeout(He)},[$,J,t,e]),w.useEffect(()=>{if(!J||!t)return;const He=setTimeout(async()=>{try{const Mt=`toneSettings_${J}`;await t.setLocalItem(Mt,JSON.stringify({formality:be,empathy:K,complexity:ge}))}catch(Mt){e.error("Error saving tone settings to storage",Mt,{sourceFile:on,functionName:"useEffect[saveToneSettings]",threadId:J})}},500);return()=>clearTimeout(He)},[be,K,ge,J,t,e]);const _e=w.useCallback(async Ue=>{try{if(!J)return e.debug("No thread ID available for cache check",{sourceFile:on,functionName:Ue}),!1;const He=Fe(J),Mt=await r6(He,e);return Mt?(e.debug("Found cached response for thread",{sourceFile:on,functionName:Ue,cacheKey:He,threadId:J}),C(Mt.response),A(Mt.references),kt(Mt.cmsData),d(!1),m(!0),!0):(e.debug("No cached response found for thread",{sourceFile:on,functionName:Ue,cacheKey:He,threadId:J}),!1)}catch(He){return e.warn("Error checking for cached response",{sourceFile:on,functionName:Ue,error:He}),!1}},[J,e]);w.useEffect(()=>{const He=setTimeout(async()=>{const Mt="checkForCachedResponse";!J||E||c||await _e(Mt)},500);return()=>clearTimeout(He)},[J,_e,E,c]),w.useEffect(()=>{(async()=>{const He="checkCachedResponseOnReady";S||!J||!ne||E||c||(e.debug("Component ready, checking for cached response immediately",{sourceFile:on,functionName:He,threadId:J,hasThreadData:!!ne,isLoading:S,hasResponse:!!E}),await _e(He))})()},[S,J,ne,_e,E,c,e]),w.useEffect(()=>{if(p&&b.current){const Ue=setTimeout(()=>{var He;(He=b.current)==null||He.focus()},100);return()=>clearTimeout(Ue)}},[p]),w.useEffect(()=>{const Ue=async()=>{try{if(!t)return;const Ie=await t.getLocalItem("useUscis");ze(Ie??!1),e.debug("uscisIsEnabled loaded from storage via platform abstraction",{sourceFile:on,functionName:"initializeUscisState",uscisEnabled:Ie??!1})}catch(Ie){e.error("Error loading USCIS state",Ie,{sourceFile:on,functionName:"initializeUscisState"})}},He=async()=>{try{if(!t)return;const Ie=await t.getLocalItem("useOregon");Ce(Ie??!1),e.debug("oregonIsEnabled loaded from storage via platform abstraction",{sourceFile:on,functionName:"initializeOregonState",oregonEnabled:Ie??!1})}catch(Ie){e.error("Error loading Oregon state",Ie,{sourceFile:on,functionName:"initializeOregonState"})}},Mt=async Ie=>{try{Ie.useUscis!==void 0&&(ze(Ie.useUscis),e.debug("USCIS setting changed via platform abstraction",{sourceFile:on,functionName:"handleStorageChange",useUscis:Ie.useUscis})),Ie.useOregon!==void 0&&(Ce(Ie.useOregon),e.debug("Oregon setting changed via platform abstraction",{sourceFile:on,functionName:"handleStorageChange",useOregon:Ie.useOregon}))}catch(St){e.error("Error handling storage changes",St,{sourceFile:on,functionName:"handleStorageChange"})}};return Ue(),He(),t!=null&&t.onChanged&&t.onChanged(Mt),T(!1),()=>{t!=null&&t.removeChangeListener&&Mt&&t.removeChangeListener(Mt)}},[t,e]),w.useEffect(()=>{if(E&&Te.current){const Ue=Te.current,Mt=(Ue.scrollHeight-Ue.clientHeight)*.8;Ue.scrollTo({top:Mt,behavior:"smooth"}),e.debug("Scrolling to 90% of bottom after response generation",{sourceFile:on,functionName:"useEffect[fullResponse]"})}},[E,e]);const Fe=Ue=>`response_${Ue}`,nt=async(Ue,He)=>{d(!0),C("Reformatting..."),m(!1);const Mt="regenerateResponse";try{if(!J){e.error("Thread ID is not set for regeneration",void 0,{sourceFile:on,functionName:Mt}),d(!1);return}const Ie=Fe(J),St=await LT(He,Ue,e);C(St),d(!1),m(!0),await CC(Ie,St,[],[],e)}catch(Ie){e.error("Error regenerating response",Ie,{sourceFile:on,functionName:Mt}),d(!1),m(!0)}},ft=async()=>{if(s==="chrome"&&!i){Yt(!0);return}d(!0),m(!1);const Ue="handleGenerateResponse";try{const He=(ne==null?void 0:ne.map(yr=>`From: ${yr.from}
Timestamp: ${yr.timestamp}
Body: ${oy(yr.body)}

`).join(""))||"",Mt=[];if(qe&&Mt.push(Xt),Be&&Mt.push(Or),!J){e.error("Thread ID is not set",void 0,{sourceFile:on,functionName:Ue}),d(!1);return}const Ie=_9(be,K,ge),St=b9(),ht=Fe(J);let Ge;s==="outlook"?Ge=await DT(J,He,$,Ie,St,z,e):Ge=await OT(J,He,$,Ie,St,Mt,e);const cr=Ge.response,zt=kb(cr);C(zt),A(Ge.references),kt(Ge.cms_data||[]),d(!1),m(!0),await CC(ht,zt,Ge.references,Ge.cms_data||[],e)}catch(He){e.error("Error generating response",He,{sourceFile:on,functionName:Ue}),d(!1)}};return s==="chrome"&&!i?u.jsx("div",{className:"p-4",children:u.jsx(d0,{feature:"Email Composition",description:"Connect your Gmail account to generate personalized email responses",benefits:["Analyze email threads and context automatically","Generate contextually relevant responses","Insert generated content directly into compose box"]})}):u.jsxs("div",{className:"space-y-4 h-full overflow-y-auto overflow-x-hidden",ref:Te,children:[u.jsxs(Es,{className:"overflow-hidden shadow-sm mb-4",children:[u.jsx(io,{className:"p-3 border-b dark:border-border cursor-pointer",onClick:()=>ee(!B),children:u.jsxs("div",{className:"flex items-center justify-between w-full",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx(ao,{className:"text-sm font-semibold pr-1",children:"Current Email"}),u.jsxs("div",{className:"relative group",children:[u.jsx(Pi,{src:"/icons/info-circled.svg",width:16,height:16,alt:"Info",className:"h-4 w-4 text-muted-foreground dark:brightness-0 dark:invert"}),u.jsx("div",{className:"absolute left-0 top-full mt-2 w-48 p-2 bg-white dark:bg-gray-800 text-black dark:text-white text-xs rounded shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-opacity z-50 border dark:border-border",children:"This is the email Candle AI is responding to."})]})]}),u.jsx(Pi,{src:"/icons/chevron-down.svg",width:20,height:20,alt:"Chevron down",className:`h-5 w-5 text-muted-foreground dark:brightness-0 dark:invert transition-transform duration-200 ${B?"transform rotate-180":""}`})]})}),B&&u.jsx(Cs,{className:"p-0.5",children:u.jsx("textarea",{value:S?"Loading...":ne?oy(ne[0].body):s==="chrome"&&!i?"Gmail disconnected. Connect Gmail to view email content.":"Please select an email thread",disabled:!0,className:"w-full border dark:border-border rounded p-4 min-h-[100px] text-xs bg-white dark:bg-card text-gray-900 dark:text-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400"})})]}),u.jsxs(Es,{className:"overflow-hidden shadow-sm mb-4",children:[u.jsx(io,{className:"p-3 border-b dark:border-border cursor-pointer",onClick:()=>fe(!Q),children:u.jsxs("div",{className:"flex items-center justify-between w-full",children:[u.jsx(ao,{className:"text-sm font-semibold",children:"Anything specific you want the response to include?"}),u.jsx(Pi,{src:"/icons/chevron-down.svg",width:20,height:20,alt:"Chevron down",className:`h-5 w-5 text-muted-foreground dark:brightness-0 dark:invert transition-transform duration-200 ${Q?"transform rotate-180":""}`})]})}),Q&&u.jsx(Cs,{className:"p-0.5",children:u.jsx("textarea",{className:"w-full border dark:border-border rounded p-4 min-h-[100px] text-sm bg-white dark:bg-card text-gray-900 dark:text-gray-200 placeholder:text-gray-400 dark:placeholder:text-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400",placeholder:`Examples: 'This client's visa is expiring soon. Suggest they renew it soon.'
'Respond in Spanish.'`,value:$,onChange:Ue=>ae(Ue.target.value)})})]}),u.jsxs(Es,{className:"overflow-hidden shadow-sm mb-4",children:[u.jsx(io,{className:"p-3 border-b dark:border-border cursor-pointer",onClick:()=>V(!U),children:u.jsxs("div",{className:"flex items-center justify-between w-full",children:[u.jsx(ao,{className:"text-sm font-semibold",children:"Tone"}),u.jsx(Pi,{src:"/icons/chevron-down.svg",width:20,height:20,alt:"Chevron down",className:`h-5 w-5 text-muted-foreground dark:brightness-0 dark:invert transition-transform duration-200 ${U?"transform rotate-180":""}`})]})}),U&&u.jsxs(Cs,{className:"p-4 space-y-4",children:[u.jsxs("div",{className:"space-y-2",children:[u.jsx("p",{className:"text-xs font-semibold text-neutral-700 dark:text-gray-300",children:"Formality"}),u.jsx(lh,{options:["Casual","Neutral","Formal"],value:be,onChange:ie})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("p",{className:"text-xs font-semibold text-neutral-700 dark:text-gray-300",children:"Empathy"}),u.jsx(lh,{options:["Low","Neutral","High"],value:K,onChange:de})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("p",{className:"text-xs font-semibold text-neutral-700 dark:text-gray-300",children:"Complexity"}),u.jsx(lh,{options:["Simple","Neutral","Detailed"],value:ge,onChange:se})]})]})]}),u.jsx(We,{className:"w-full bg-blue-600 hover:bg-blue-700 text-white py-4 mt-2",onClick:ft,disabled:c||!J&&s!=="chrome"||s==="chrome"&&!i&&!J,children:c?"Generating...":s==="chrome"&&!i?"Connect Gmail to Generate Response":J?"Generate Response":"Select a thread"}),c&&u.jsxs("div",{className:"flex flex-col items-center justify-center",children:[u.jsx(ii,{className:"h-8 w-8 animate-spin text-blue-600"}),u.jsx("p",{className:"mt-2 text-sm text-gray-500",children:vr[F]})]}),u.jsxs("div",{className:"mb-24",children:[u.jsx(w9,{isOpen:It,onClose:()=>Yt(!1),title:"Gmail Connection Required",description:"Generate Response requires an active Gmail connection to analyze your email thread and create personalized responses.",actionText:"generate email responses"}),E&&!c&&u.jsxs(Es,{className:"animate-slide-fade-in mb-2 origin-top",children:[u.jsx(io,{className:"p-3 border-b dark:border-border cursor-pointer",children:u.jsxs(ao,{className:"flex items-center py-0 my-0 text-sm font-semibold",children:[u.jsx(Pi,{src:"/icons/email-icon.svg",width:16,height:16,alt:"Generated Response",className:"h-4 w-4 text-muted-foreground dark:brightness-0 dark:invert mr-2"}),u.jsx("p",{className:"text-sm font-semibold",children:"Generated Response"}),u.jsxs(We,{className:"ml-auto bg-blue-600 hover:bg-blue-700 text-white",size:"sm",onClick:()=>{kS(NS.sanitize(E),e)},children:[u.jsx(pS,{className:"w-4 h-4 flex-shrink-0 mr-1 rotate-90"}),"Insert"]})]})}),u.jsx(Cs,{className:"p-6",children:u.jsx(GA,{htmlString:E})})]}),p&&u.jsx("div",{className:"animate-fadeIn mb-2",children:u.jsxs("div",{className:"rounded-lg border-2 border-neutral-200 dark:border-border bg-neutral-50/50 dark:bg-card/50 overflow-hidden transition-all duration-200 focus-within:!border-blue-500 dark:focus-within:!border-blue-400 focus-within:ring-2 focus-within:ring-blue-500/20 dark:focus-within:ring-blue-400/20 focus-within:bg-white dark:focus-within:bg-card",children:[u.jsx("div",{className:"p-3 bg-white dark:bg-card",children:u.jsx(WA,{ref:b,placeholder:"Customize this response",value:g,className:"text-sm w-full bg-transparent text-gray-900 dark:text-gray-200 !border-0 !ring-0 !outline-none focus:!border-0 focus:!ring-0 focus:!outline-none focus-visible:!ring-0 focus-visible:!ring-offset-0 focus-visible:!outline-none min-h-[40px] max-h-40 py-0 px-0 placeholder:text-neutral-400 dark:placeholder:text-gray-500 resize-none",onChange:Ue=>x(Ue.target.value),onKeyDown:Ue=>{Ue.key==="Enter"&&!Ue.shiftKey&&g.trim()&&(Ue.preventDefault(),nt(g,E),x(""))}})}),u.jsx("div",{className:"h-[1px] bg-neutral-200 dark:bg-border"}),u.jsxs("div",{className:"flex gap-0 bg-white dark:bg-card border-t dark:border-border",children:[u.jsx(We,{onClick:()=>{nt("More empathetic",E)},variant:"ghost",className:"flex-1 rounded-none text-xs text-neutral-700 dark:text-gray-300 hover:bg-neutral-50 dark:hover:bg-muted py-2.5 h-auto font-normal",children:"More empathetic"}),u.jsx("div",{className:"w-[1px] bg-neutral-200 dark:bg-border my-1.5"}),u.jsx(We,{onClick:()=>{nt("Make it shorter",E)},variant:"ghost",className:"flex-1 rounded-none text-xs text-neutral-700 dark:text-gray-300 hover:bg-neutral-50 dark:hover:bg-muted py-2.5 h-auto font-normal",children:"Make it shorter"}),u.jsx("div",{className:"w-[1px] bg-neutral-200 dark:bg-border my-1.5"}),u.jsx(We,{onClick:()=>{g&&(nt(g,E),x(""))},disabled:!g.trim(),size:"icon",className:"h-auto w-12 rounded-none bg-blue-600 text-white hover:bg-blue-700 disabled:bg-blue-600/50 disabled:text-white/90 disabled:cursor-not-allowed transition-all duration-200",children:u.jsx(cB,{className:"h-4 w-4"})})]})]})})]})]})},E9=()=>{const[r,e]=w.useState(!1),t=Ya(),n=zr(),s=HT();w.useEffect(()=>{n.info("LoginPanel component loaded",{sourceFile:"src/sidepanel/panels/LoginPanel.tsx"});const c=d=>{d.token&&(e(!1),n.info("Token detected in storage, auth state will be updated automatically",{sourceFile:"src/sidepanel/panels/LoginPanel.tsx"}))};return t!=null&&t.onChanged&&t.onChanged(c),()=>{t!=null&&t.removeChangeListener&&t.removeChangeListener(c)}},[t,n]);const i=async()=>{n.info("Login button clicked",{sourceFile:"src/sidepanel/panels/LoginPanel.tsx"}),e(!0);try{await s.login(),n.info("Login completed successfully",{sourceFile:"src/sidepanel/panels/LoginPanel.tsx"}),e(!1)}catch(c){n.error("Login failed",c,{sourceFile:"src/sidepanel/panels/LoginPanel.tsx"}),e(!1)}};return u.jsxs("div",{className:"flex flex-col items-center justify-center h-full px-6 bg-gradient-to-b from-blue-50/30 to-white dark:from-gray-900 dark:to-gray-950 animate-fade-in",children:[u.jsx("div",{className:"flex items-center justify-center max-w-md w-full mb-8",children:u.jsxs("svg",{width:"400",height:"200",viewBox:"0 0 400 300",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"w-full h-auto max-h-[200px] drop-shadow-lg",children:[u.jsxs("defs",{children:[u.jsxs("linearGradient",{id:"emailGradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[u.jsx("stop",{offset:"0%",style:{stopColor:"#EEF2FF",stopOpacity:1}}),u.jsx("stop",{offset:"100%",style:{stopColor:"#E0E7FF",stopOpacity:1}})]}),u.jsxs("linearGradient",{id:"glowGradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[u.jsx("stop",{offset:"0%",style:{stopColor:"#818CF8",stopOpacity:.6}}),u.jsx("stop",{offset:"100%",style:{stopColor:"#4F46E5",stopOpacity:.3}})]}),u.jsxs("filter",{id:"glow",children:[u.jsx("feGaussianBlur",{stdDeviation:"4",result:"coloredBlur"}),u.jsxs("feMerge",{children:[u.jsx("feMergeNode",{in:"coloredBlur"}),u.jsx("feMergeNode",{in:"SourceGraphic"})]})]})]}),u.jsx("circle",{cx:"200",cy:"150",r:"120",fill:"url(#glowGradient)",opacity:"0.3",className:"animate-pulse-slow"}),u.jsx("circle",{cx:"200",cy:"150",r:"80",fill:"url(#glowGradient)",opacity:"0.2",className:"animate-pulse-slow",style:{animationDelay:"0.5s"}}),u.jsxs("g",{className:"animate-float",children:[u.jsx("rect",{x:"100",y:"80",width:"200",height:"140",rx:"8",fill:"url(#emailGradient)",stroke:"#6366F1",strokeWidth:"2"}),u.jsx("line",{x1:"120",y1:"110",x2:"240",y2:"110",stroke:"#94A3B8",strokeWidth:"2",strokeLinecap:"round"}),u.jsx("line",{x1:"120",y1:"130",x2:"260",y2:"130",stroke:"#94A3B8",strokeWidth:"2",strokeLinecap:"round"}),u.jsx("line",{x1:"120",y1:"150",x2:"230",y2:"150",stroke:"#94A3B8",strokeWidth:"2",strokeLinecap:"round"}),u.jsx("line",{x1:"120",y1:"170",x2:"250",y2:"170",stroke:"#94A3B8",strokeWidth:"2",strokeLinecap:"round"}),u.jsx("line",{x1:"120",y1:"190",x2:"210",y2:"190",stroke:"#94A3B8",strokeWidth:"2",strokeLinecap:"round"})]}),u.jsxs("g",{className:"animate-sparkle",children:[u.jsx("circle",{cx:"80",cy:"60",r:"4",fill:"#818CF8",filter:"url(#glow)"}),u.jsx("path",{d:"M 80 50 L 82 58 L 90 60 L 82 62 L 80 70 L 78 62 L 70 60 L 78 58 Z",fill:"#818CF8",filter:"url(#glow)"})]}),u.jsxs("g",{className:"animate-sparkle",style:{animationDelay:"0.7s"},children:[u.jsx("circle",{cx:"320",cy:"80",r:"3",fill:"#4F46E5",filter:"url(#glow)"}),u.jsx("path",{d:"M 320 72 L 321.5 78 L 328 80 L 321.5 82 L 320 88 L 318.5 82 L 312 80 L 318.5 78 Z",fill:"#4F46E5",filter:"url(#glow)"})]}),u.jsxs("g",{className:"animate-sparkle",style:{animationDelay:"1.4s"},children:[u.jsx("circle",{cx:"310",cy:"230",r:"3.5",fill:"#818CF8",filter:"url(#glow)"}),u.jsx("path",{d:"M 310 221 L 311.8 227.5 L 319 230 L 311.8 232.5 L 310 239 L 308.2 232.5 L 301 230 L 308.2 227.5 Z",fill:"#818CF8",filter:"url(#glow)"})]}),u.jsxs("g",{className:"animate-sparkle",style:{animationDelay:"0.3s"},children:[u.jsx("circle",{cx:"90",cy:"240",r:"3",fill:"#6366F1",filter:"url(#glow)"}),u.jsx("path",{d:"M 90 233 L 91.5 238 L 97 240 L 91.5 242 L 90 247 L 88.5 242 L 83 240 L 88.5 238 Z",fill:"#6366F1",filter:"url(#glow)"})]}),u.jsxs("g",{className:"animate-sparkle",style:{animationDelay:"1s"},children:[u.jsx("circle",{cx:"320",cy:"150",r:"5",fill:"#4F46E5",filter:"url(#glow)"}),u.jsx("path",{d:"M 320 138 L 323 147 L 333 150 L 323 153 L 320 162 L 317 153 L 307 150 L 317 147 Z",fill:"#4F46E5",filter:"url(#glow)"})]}),u.jsx("circle",{cx:"85",cy:"150",r:"2.5",fill:"#818CF8",opacity:"0.6",className:"animate-sparkle"}),u.jsx("circle",{cx:"315",cy:"200",r:"2",fill:"#6366F1",opacity:"0.5",className:"animate-sparkle",style:{animationDelay:"0.5s"}}),u.jsx("circle",{cx:"280",cy:"70",r:"2",fill:"#4F46E5",opacity:"0.6",className:"animate-sparkle",style:{animationDelay:"1s"}})]})}),u.jsxs("div",{className:"text-center mb-6 space-y-3 animate-slide-up",children:[u.jsxs("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white leading-tight",children:["Legal emails,",u.jsx("br",{}),"effortlessly handled"]}),u.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 max-w-xs mx-auto",children:"AI-powered email assistant for legal professionals"})]}),u.jsx("div",{className:"w-full max-w-xs animate-slide-up",style:{animationDelay:"0.2s"},children:u.jsx(We,{onClick:i,className:"w-full h-12 text-base font-medium shadow-lg hover:shadow-xl transition-all duration-200 hover:scale-[1.02] bg-blue-600 hover:bg-blue-700 dark:bg-blue-600 dark:hover:bg-blue-700",disabled:r,children:r?u.jsxs("span",{className:"flex items-center justify-center gap-2",children:[u.jsxs("svg",{className:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[u.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),u.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Logging in..."]}):"Get Started"})})]})},C9=[{available:!0,id:"gmail",name:"Gmail",description:"Connect your Gmail account to access your email",authMethod:"oauth",authUrl:K_(q_),logo:"/gmail.svg",homeUrl:"https://mail.google.com",isConnected:!1,category:"email"},{available:!0,id:"filevine",name:"Filevine",description:"Connect your Filevine account to access case status",authMethod:"custom",authUrl:"https://identity.filevine.com/",customAuthFields:[{id:"clientId",displayName:"Client ID",type:"text"},{id:"clientSecret",displayName:"Client Secret",type:"text"},{id:"PAT",displayName:"Personal Access Token",type:"text"},{id:"organizationId",displayName:"Organization ID",type:"text"},{id:"userId",displayName:"User ID",type:"text"}],logo:"/filevine.svg",homeUrl:"https://identity.filevine.com/",isConnected:!1,category:"case_management"},{available:!0,id:"clio",name:"Clio",description:"Connect your Clio account to access case status",authMethod:"server",authUrl:Y_+"clio",logo:"/clio.svg",homeUrl:"https://app.clio.com",isConnected:!1,category:"case_management"},{available:!1,id:"drive",name:"Google Drive",description:"Connect your Google account to access files on Drive",authMethod:"oauth",authUrl:"/api/auth/google",logo:"/google.svg",homeUrl:"https://drive.google.com",isConnected:!1,category:"data_management"},{available:!1,id:"onedrive",name:"OneDrive",description:"Connect your Microsoft account to access files on OneDrive",authMethod:"oauth",authUrl:"/api/auth/onedrive",logo:"/onedrive.svg",homeUrl:"https://onedrive.live.com",isConnected:!1,category:"data_management"}],NI=[{available:!0,id:"inszoom",name:"INSZoom",description:"Connect your INSZoom account to access case status",authMethod:"custom",authUrl:"https://global.inszoom.com/",logo:"/inszoom.ico",customAuthFields:[{id:"auth_key",displayName:"Authorization Key",type:"text"},{id:"subscription_key",displayName:"Subscription Key",type:"text"},{id:"case_status_report",displayName:"Latest Case Status Report",type:"file"}],homeUrl:"https://global.inszoom.com",isConnected:!1,category:"case_management"},{available:!1,id:"drive",name:"Google Drive",description:"Connect your Google account to access files on Drive",authMethod:"oauth",authUrl:"/api/auth/google",logo:"/google.svg",homeUrl:"https://drive.google.com",isConnected:!1,category:"data_management"},{available:!1,id:"onedrive",name:"OneDrive",description:"Connect your Microsoft account to access files on OneDrive",authMethod:"oauth",authUrl:"/api/auth/onedrive",logo:"/onedrive.svg",homeUrl:"https://onedrive.live.com",isConnected:!1,category:"data_management"}],Ir="src/lib/utils/integrationUtils.tsx";async function jS(r){const e=C9.find(n=>n.id===r);return e||NI.find(n=>n.id===r)||null}async function k9(r){return NI.find(e=>e.id===r)||null}async function TI(r,e,t,n,s){if(e.authMethod==="server")throw new Error("Integration is a server integration which shouldn't be initiated by the extension");r.info("Initiating integration process for integration:",{sourceFile:Ir,integrationId:e});try{let i;if(s&&Object.keys(s).length>0){r.info("Starting file serialization process",{sourceFile:Ir,fileCount:Object.keys(s).length});const d=100*1024*1024;for(const[p,m]of Object.entries(s))if(m.size>d){const g=`File "${m.name}" exceeds 100MB limit. File size: ${(m.size/1048576).toFixed(2)}MB`;throw r.error("File size validation failed",new Error(g),{sourceFile:Ir,fieldId:p,fileName:m.name,fileSize:m.size,maxSize:d}),new Error(g)}i={};for(const[p,m]of Object.entries(s)){const g=await Dx(m);r.info("Original file checksum calculated",{sourceFile:Ir,fieldId:p,fileName:m.name,fileSize:m.size,fileType:m.type,originalChecksum:g});const x=await m.arrayBuffer(),b=new Uint8Array(x),S=await Dx(x);r.info("ArrayBuffer checksum calculated",{sourceFile:Ir,fieldId:p,fileName:m.name,bufferChecksum:S,bufferSize:x.byteLength,checksumMatch:g===S});let T="";const E=8192;for(let L=0;L<b.length;L+=E){const G=b.slice(L,L+E);T+=String.fromCharCode(...G)}const C=btoa(T),R=atob(C),A=new ArrayBuffer(R.length),F=new Uint8Array(A);for(let L=0;L<R.length;L++)F[L]=R.charCodeAt(L);const P=await Dx(A);i[p]={name:m.name,type:m.type,size:m.size,data:C},r.info("File serialization completed",{sourceFile:Ir,fieldId:p,fileName:m.name,fileSize:m.size,base64Length:C.length,originalChecksum:g,bufferChecksum:S,decodedChecksum:P,allChecksumsMatch:g===S&&S===P})}r.info("All files serialized successfully",{sourceFile:Ir,serializedFileCount:Object.keys(i).length})}const c=await Yn.createServices();if(c.messaging.sendMessage){const d=await c.messaging.sendMessage({type:"INITIATE_INTEGRATION",integration:e,authUrl:t,credentials:n,files:i});if(!d.success)throw new Error(d.error||"Integration failed");return r.info("Integration initiated successfully",{sourceFile:Ir}),d.success}else{const d=await chrome.runtime.sendMessage({type:"INITIATE_INTEGRATION",integration:e,authUrl:t,credentials:n,files:i});if(!d.success)throw new Error(d.error||"Integration failed");return r.info("Integration initiated successfully",{sourceFile:Ir}),d.success}}catch(i){throw r.error("Integration failed:",i,{sourceFile:Ir}),i}}async function N9(r,e){try{const t=await Yn.createServices();if(t.messaging.sendMessage){const n=await t.messaging.sendMessage({type:"DISCONNECT_INTEGRATION",integration:e});if(!n.success)throw new Error(n.error||"Disconnection failed");return r.info("Integration disconnected successfully",{sourceFile:Ir}),n.success}else{const n=await chrome.runtime.sendMessage({type:"DISCONNECT_INTEGRATION",integration:e});if(!n.success)throw new Error(n.error||"Disconnection failed");return r.info("Integration disconnected successfully",{sourceFile:Ir}),n.success}}catch(t){throw r.error("Disconnection failed:",t,{sourceFile:Ir}),t}}async function RI(r){const e="isCaseManagementSystemIntegrationConnected";try{r.debug("Starting CMS integration check",{sourceFile:Ir,functionName:e});const t=await rg(r);r.debug("Local integrations retrieved",{sourceFile:Ir,functionName:e,count:t.length,integrations:t.map(m=>m.integration_type)});const n=t.some(m=>m.integration_type==="filevine"||m.integration_type==="clio"||m.integration_type==="inszoom");if(r.debug("Local CMS integration check result",{sourceFile:Ir,functionName:e,isConnectedLocally:n}),n)return r.info("CMS integration found in local storage",{sourceFile:Ir,functionName:e}),!0;const[s,i]=await Promise.all([Yc("user",r).catch(()=>[]),Yc("tenant",r).catch(()=>[])]),c=s.map(m=>({integration_type:m.integration_type,tenantId_userId:m.tenantId_userId,scope:"user"})),d=i.map(m=>({integration_type:m.integration_type,tenantId_userId:m.tenantId_userId,scope:"tenant"})),p=[...c,...d];return await tg(r,p),p.some(m=>m.integration_type==="filevine"||m.integration_type==="clio"||m.integration_type==="inszoom");return r.info("Final CMS integration check result",{sourceFile:Ir,functionName:e,isConnectedOnServer}),isConnectedOnServer}catch(t){return r.error("Failed to check if CMS integration is connected",t,{sourceFile:Ir,functionName:e}),!1}}async function T9(r,e){try{if((await rg(r)).some(m=>m.integration_type===e))return!0;const[s,i]=await Promise.all([Yc("user",r).catch(()=>[]),Yc("tenant",r).catch(()=>[])]),c=s.map(m=>({integration_type:m.integration_type,tenantId_userId:m.tenantId_userId,scope:"user"})),d=i.map(m=>({integration_type:m.integration_type,tenantId_userId:m.tenantId_userId,scope:"tenant"})),p=[...c,...d];return await tg(r,p),p.some(m=>m.integration_type===e)||!1}catch(t){return r.warn("Failed to check if integration is connected:",{sourceFile:Ir,integrationId:e,error:t}),!1}}async function AI(r){try{r.info("Refreshing integrations from server",{sourceFile:Ir}),await cT(r);const[e,t]=await Promise.all([Yc("user",r).catch(()=>[]),Yc("tenant",r).catch(()=>[])]),n=e.map(c=>({integration_type:c.integration_type,tenantId_userId:c.tenantId_userId,scope:"user"})),s=t.map(c=>({integration_type:c.integration_type,tenantId_userId:c.tenantId_userId,scope:"tenant"})),i=[...n,...s];return await tg(r,i),r.info("Refreshed integrations from server",{sourceFile:Ir,userCount:n.length,tenantCount:s.length,totalCount:i.length}),!0}catch(e){return r.warn("Failed to refresh integrations:",{sourceFile:Ir,error:e}),!1}}async function II(r){try{const e=await rg(r);if(e.length>0)return e;const[t,n]=await Promise.all([Yc("user",r).catch(d=>(r.warn("Failed to fetch user integrations:",{sourceFile:Ir,error:d}),[])),Yc("tenant",r).catch(d=>(r.warn("Failed to fetch tenant integrations:",{sourceFile:Ir,error:d}),[]))]),s=t.map(d=>({...d,scope:"user"})),i=n.map(d=>({...d,scope:"tenant"})),c=[...s,...i];return await tg(r,c),r.info("Saved merged integrations to local storage",{sourceFile:Ir,userCount:s.length,tenantCount:i.length,totalCount:c.length,integrations:c}),c}catch(e){return r.error("Failed to list integrations:",e,{sourceFile:Ir}),[]}}async function R9(r,e){try{return(await rg(r)).find(n=>n.integration_type===e)||null}catch(t){return r.error("Failed to get integration details:",t,{sourceFile:Ir}),null}}async function A9(r,e){var i;const t=await hy(r),n=((i=t.integrations)==null?void 0:i.filter(c=>c.integration_type!==e.integration_type))||[];n.push(e);const s={...t,integrations:n};await iT(r,s)}async function I9(r,e){var i;const t=await hy(r),n=((i=t.integrations)==null?void 0:i.filter(c=>c.integration_type!==e))||[],s={...t,integrations:n};await iT(r,s)}async function P9(r,e){if(!e)throw new Error("Integration not found");if(e.authMethod!=="server")throw new Error("Integration is not a server integration");try{const t=await Mm(r);if(!t)throw r.warn("Failed to get authentication token",{sourceFile:Ir}),new Error("Authentication required. Please log in first.");const n=`${Y_}${e.id}?token=${encodeURIComponent(t.id_token)}`;r.debug("Opening server auth page",{sourceFile:Ir,integrationId:e.id}),window.open(n,"_blank")}catch(t){throw r.error("Failed to open server auth page:",t,{sourceFile:Ir}),t}}async function j9(r){try{return await cT(r),await wT(r),!0}catch(e){return r.error("Failed to clear integration data:",e,{sourceFile:Ir}),!1}}const F9=Object.freeze(Object.defineProperty({__proto__:null,clearIntegrationData:j9,disconnectIntegration:N9,findIntegrationById:jS,findOrgIntegrationById:k9,getIntegrationDetails:R9,initiateIntegration:TI,isCaseManagementSystemIntegrationConnected:RI,isIntegrationConnected:T9,listIntegrations:II,openServerAuthPageForIntegration:P9,refreshIntegrations:AI,removeIntegrationDetails:I9,saveIntegrationDetails:A9},Symbol.toStringTag,{value:"Module"})),cm="src/components/ui/DetailsTable.tsx",vN=r=>u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",width:"16",height:"16",...r,className:`inline-block w-4 h-4 ${r.className||""}`,children:[u.jsx("path",{d:"M11 3a1 1 0 100 2h2.586l-6.293 6.293a1 1 0 101.414 1.414L15 6.414V9a1 1 0 102 0V4a1 1 0 00-1-1h-5z"}),u.jsx("path",{d:"M5 5a2 2 0 00-2 2v8a2 2 0 002 2h8a2 2 0 002-2v-3a1 1 0 10-2 0v3H5V7h3a1 1 0 000-2H5z"})]}),ru=({details:r,linkableFields:e})=>{const t=zr(),[n,s]=gr.useState(new Set),[i,c]=gr.useState(new Set),d=80;if(!r)return t.debug("No important details to render",{sourceFile:cm}),null;if(Object.keys(r).length===0)return t.debug("No important details to render",{sourceFile:cm}),null;const p=T=>{const E=document.createElement("textarea");E.value=T,E.style.position="fixed",E.style.opacity="0",document.body.appendChild(E),E.select();const C=document.execCommand("copy");return document.body.removeChild(E),C},m=(T,E)=>{navigator.clipboard.writeText(T).then(()=>{t.debug("Copied to clipboard",{sourceFile:cm,copiedValue:T}),c(C=>new Set([...C,E])),setTimeout(()=>{c(C=>{const R=new Set(C);return R.delete(E),R})},2e3)}).catch(C=>{t.error("Failed to copy with navigator.clipboard.writeText",C,{sourceFile:cm});try{p(T)&&(c(R=>new Set([...R,E])),setTimeout(()=>{c(R=>{const A=new Set(R);return A.delete(E),A})},2e3))}catch(R){t.error("Failed to copy with document.execCommand",R,{sourceFile:cm})}})},g=T=>{const E=new Set(n);E.has(T)?E.delete(T):E.add(T),s(E)},x=T=>{if(!T)return"";try{return new Date(T).toLocaleDateString(void 0,{timeZone:"UTC"})}catch{return T}},b=T=>{try{const E=new URL(T);return E.protocol==="http:"||E.protocol==="https:"}catch{return!1}},S=T=>T.split(/(\[\[.*?\]\]|\(\(.*?\)\))/g).map((C,R)=>{if(C.startsWith("[[")&&C.endsWith("]]")){const A=C.slice(2,-2);return u.jsx("span",{className:"font-semibold",children:A},R)}else if(C.startsWith("((")&&C.endsWith("))")){const A=C.slice(2,-2);return/^\d{4}-\d{2}-\d{2}/.test(A)?u.jsx("span",{className:"text-base",children:x(A)},R):u.jsx("span",{className:"text-base",children:A},R)}return C});return u.jsx("div",{className:"p-1",children:u.jsx("table",{className:"w-full text-sm text-left text-gray-700 dark:text-gray-300 table-fixed",children:u.jsx("tbody",{children:Object.entries(r).map(([T,E],C)=>{let R;E===""||E===null||E===void 0?R="":typeof E=="string"||typeof E=="number"?R=String(E):R=JSON.stringify(E);const A=e==null?void 0:e.find(U=>U.field===T),F=b(R),P=R.length>d,L=n.has(C),G=P&&!L?R.substring(0,d)+"...":R;return u.jsxs("tr",{className:"bg-card",children:[u.jsx("td",{className:"py-4 px-3 whitespace-normal font-medium w-2/5 text-gray-800 dark:text-gray-200",children:A?u.jsxs("a",{href:A.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 dark:text-blue-400 hover:underline whitespace-normal hover:text-blue-800 dark:hover:text-blue-300 flex items-center gap-1",children:[T,u.jsx(vN,{})]}):T}),u.jsx("td",{className:`py-2 px-3 whitespace-pre-wrap break-words ${F?"":"hover:bg-gray-100 dark:hover:bg-muted"}`,style:F?{}:{cursor:`url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>') 10 10, copy`},onClick:()=>!F&&!P&&m(R,C),title:F?"Click to open link":P?"":"Click to copy",children:F?u.jsxs("a",{href:R,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 dark:text-blue-400 hover:underline break-words flex items-center gap-1",children:[S(R),u.jsx(vN,{className:"flex-shrink-0"})]}):u.jsxs("div",{children:[u.jsxs("div",{className:"relative",children:[u.jsx("span",{className:"break-words text-gray-700 dark:text-gray-300",onClick:()=>!P&&m(R,C),children:S(G)}),i.has(C)&&u.jsx("span",{className:"absolute -top-1 -right-1 bg-white dark:bg-gray-700 text-black dark:text-white text-xs px-2 py-1 rounded-full shadow-lg border border-gray-300 dark:border-gray-600",children:"Copied!"})]}),P&&u.jsx("div",{className:"mt-1",children:u.jsx("button",{onClick:U=>{U.stopPropagation(),g(C)},className:"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 underline text-sm",children:L?"show less":"show more"})})]})})]},C)})})})})},Tn="src/shared/components/sidepanel/mainPanelContent/EmailSummaryBox.tsx",O9=()=>{const[r,e]=w.useState(""),[t,n]=w.useState(null),[s,i]=w.useState(null),[c,d]=w.useState(!1),[p,m]=w.useState(!0),[g,x]=w.useState(!1),[b,S]=w.useState("summary"),[T,E]=w.useState(null),[C,R]=w.useState(null),[A,F]=w.useState(0),{platform:P}=un(),L=aa(),G=zr(),U=w.useRef(null),V=w.useRef(null),Q=w.useRef(!1),fe=["Analyzing email content...","Extracting key information...","Identifying important details...","Generating summary...","Finalizing insights..."];w.useEffect(()=>{let J;const X=()=>{if(c){const z=Math.floor(Math.random()*1500)+500;J=setTimeout(()=>{F(q=>(q+1)%fe.length),X()},z)}};return c&&X(),()=>{J&&clearTimeout(J)}},[c,fe.length]);const B=w.useCallback(async J=>{if(Q.current&&U.current===J){G.debug("Already loading summary for thread:",{threadId:J,sourceFile:Tn});return}U.current=J,d(!0),Q.current=!0;try{const X=await a8(J,G);U.current===J?(G.debug("Summary response:",{summaryResponse:X,sourceFile:Tn}),e(X.summary),E(X.importantDetails),d(!1),Q.current=!1):G.debug("Ignoring summary response for outdated thread:",{threadId:J,sourceFile:Tn})}catch(X){G.error("Error fetching email summary:",X,{sourceFile:Tn}),U.current===J&&(d(!1),Q.current=!1)}},[G]),ee=w.useCallback(async(J,X)=>{if(Q.current&&U.current===J){G.debug("Already loading summary for thread:",{threadId:J,sourceFile:Tn});return}U.current=J,d(!0),Q.current=!0;const z=await J5(J,G);if(z){G.debug("Using cached summary for thread:",{threadId:J,sourceFile:Tn}),e(z.summary),E(z.importantDetails),d(!1),Q.current=!1;return}try{if(!X){G.warn("No thread data found",{sourceFile:Tn,functionName:"fetchEmailSummaryForOutlook"}),d(!1),Q.current=!1;return}const q=await l8(X,G);U.current===J?(G.debug("Summary response:",{summaryResponse:q,sourceFile:Tn}),await Y5(J,q.summary,q.importantDetails,G),e(q.summary),E(q.importantDetails),d(!1),Q.current=!1):G.debug("Ignoring summary response for outdated thread:",{threadId:J,sourceFile:Tn})}catch(q){G.error("Error fetching email summary for Outlook:",q,{sourceFile:Tn}),U.current===J&&(d(!1),Q.current=!1,e("Error fetching email summary. Please try again."))}},[G]);w.useEffect(()=>{const J=async()=>{G.info("Checking if Gmail is connected",{sourceFile:Tn});const z=await Xy(G);G.info("Gmail connection check result",{connected:z,sourceFile:Tn}),m(z)},X=async()=>{try{const q=(await Yn.createServices()).storage;if(q.onChanged){const O=$=>{if($.gmailConnectionStatus){const ae=$.gmailConnectionStatus.newValue;G.info("Gmail connection status changed via storage",{sourceFile:Tn,newStatus:ae,oldStatus:$.gmailConnectionStatus.oldValue}),m(!0)}};return q.onChanged(O),()=>{q.removeChangeListener&&q.removeChangeListener(O)}}}catch(z){G.error("Failed to set up storage listener:",z,{sourceFile:Tn})}};if(P==="chrome"){const q=(async()=>(await J(),await X()))();return()=>{q.then(O=>O==null?void 0:O())}}else P==="outlook"&&(m(!1),console.log("Not calling checkGmailConnection for Outlook"))},[P,G]),w.useEffect(()=>{if(L!=null&&L.onThreadChanged){const J=z=>{if(G.debug("Thread change received",{sourceFile:Tn,functionName:"handleThreadChange",hasThread:!!z,threadId:z==null?void 0:z.threadId,platform:P}),!z){G.debug("No thread provided, keeping current state",{sourceFile:Tn}),n(null),i(null);return}if(n(z.threadId||null),G.debug("Thread ID set",{sourceFile:Tn,threadId:z.threadId}),z.messages&&Array.isArray(z.messages)&&z.messages.length>0&&z.messages[0]&&typeof z.messages[0]=="object"){const q=z.messages.map((O,$)=>({body:O.body||O.html||"",html:O.html||O.body||"",from:O.from||"",timestamp:O.timestamp||"",subject:$===0&&z.subject||""}));i(JSON.stringify(q)),G.debug("Thread data converted and set",{sourceFile:Tn,messageCount:q.length})}};return L.onThreadChanged(J),(async()=>{try{const z=await L.getCurrentThread();J(z)}catch(z){G.error("Error loading current thread",z,{sourceFile:Tn,functionName:"loadCurrentThread"})}})(),()=>{L.removeThreadListener&&L.removeThreadListener(J)}}},[L,P,G]),w.useEffect(()=>{t&&p&&P==="chrome"?(t!==U.current||!Q.current)&&B(t):!p&&P==="chrome"?(e("Connect to Gmail to enable email summaries"),E(null),S("summary"),U.current=null,Q.current=!1,d(!1)):!p&&P==="outlook"&&s&&t?(t!==U.current||!Q.current)&&ee(t||"",s):(e("Select a thread to summarize"),E(null),S("summary"),U.current=null,Q.current=!1,d(!1))},[t,p,B,ee,P,s]);const ve=async()=>{try{x(!0);const J=K_(q_),X=await jS("gmail");if(!X){G.error("Gmail integration not found",new Error("Gmail integration not found"),{sourceFile:Tn});return}await TI(G,X,J)&&(m(!0),t&&B(t))}catch(J){G.error("Failed to connect to Gmail:",J,{sourceFile:Tn}),e("Failed to connect to Gmail. Please try again.")}finally{x(!1)}},ce=()=>T?u.jsx(ru,{details:T}):null,ne=()=>{b==="summary"&&V.current&&(R(V.current.offsetHeight),S("details"))},xe=T!==null&&Object.keys(T).length>0;return w.useEffect(()=>{xe||S("summary")},[xe]),w.useEffect(()=>{C&&document.documentElement.style.setProperty("--content-height",`${C}px`)},[C]),u.jsxs("div",{className:"w-full max-w-full min-h-[4rem] border rounded-lg shadow-md bg-white mx-2 mt-2 mb-6 overflow-hidden box-border border-b-0",title:"Email Summary",style:{maxWidth:"calc(100% - 1rem)"},children:[u.jsx("div",{className:"flex items-center justify-center p-2 border-b bg-gray-150 min-w-0",children:u.jsxs("div",{className:"flex items-center gap-1 bg-gray-150 p-1 rounded-full",children:[u.jsxs("button",{className:`px-3 py-1.5 rounded-full text-sm font-medium transition-colors whitespace-nowrap flex items-center gap-1.5 ${b==="summary"?"text-blue-700 border bg-white border-blue-200":"bg-gray-75 text-gray-600 hover:bg-gray-100 border border-gray-200"}`,onClick:()=>S("summary"),children:[u.jsx(Jc,{className:"w-3.5 h-3.5"}),"Summary"]}),xe&&u.jsxs("button",{className:`px-3 py-1.5 rounded-full text-sm font-medium transition-colors flex items-center gap-1.5 whitespace-nowrap ${b==="details"?"text-blue-700 border bg-white border-blue-200":"bg-gray-75 text-gray-600 hover:bg-gray-100 border border-gray-200"}`,onClick:ne,children:[u.jsx(Pi,{src:"/icons/info-circled.svg",width:14,height:14,alt:"Info",className:"w-3.5 h-3.5"}),"Key Points"]})]})}),u.jsx("div",{className:"w-full min-w-0",children:c?u.jsxs("div",{className:"w-full border rounded flex flex-col items-center justify-center bg-gray-50 p-4",children:[u.jsx(ii,{className:"h-8 w-8 animate-spin text-blue-600"}),u.jsx("div",{className:"text-center text-sm text-gray-500",children:fe[A]})]}):!p&&P==="chrome"?u.jsxs("div",{className:"w-full p-4 flex flex-col items-center justify-center",children:[u.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Connect to Gmail to enable email summaries"}),u.jsx(We,{onClick:ve,className:"w-full bg-blue-600 hover:bg-blue-700 text-white py-4 mt-2",disabled:g,children:g?"Connecting...":"Connect Gmail"})]}):u.jsx("div",{className:"w-full min-w-0 overflow-hidden",children:b==="summary"?u.jsx("div",{ref:V,className:"p-3 text-sm text-gray-600 whitespace-pre-wrap break-words overflow-wrap-anywhere",children:r}):u.jsx("div",{className:"overflow-y-auto",children:ce()})})})]})};function yN(r){const e=D9(r),t=w.forwardRef((n,s)=>{const{children:i,...c}=n,d=w.Children.toArray(i),p=d.find(M9);if(p){const m=p.props.children,g=d.map(x=>x===p?w.Children.count(m)>1?w.Children.only(null):w.isValidElement(m)?m.props.children:null:x);return u.jsx(e,{...c,ref:s,children:w.isValidElement(m)?w.cloneElement(m,void 0,g):null})}return u.jsx(e,{...c,ref:s,children:i})});return t.displayName=`${r}.Slot`,t}function D9(r){const e=w.forwardRef((t,n)=>{const{children:s,...i}=t;if(w.isValidElement(s)){const c=U9(s),d=$9(i,s.props);return s.type!==w.Fragment&&(d.ref=n?eu(n,c):c),w.cloneElement(s,d)}return w.Children.count(s)>1?w.Children.only(null):null});return e.displayName=`${r}.SlotClone`,e}var L9=Symbol("radix.slottable");function M9(r){return w.isValidElement(r)&&typeof r.type=="function"&&"__radixId"in r.type&&r.type.__radixId===L9}function $9(r,e){const t={...e};for(const n in e){const s=r[n],i=e[n];/^on[A-Z]/.test(n)?s&&i?t[n]=(...d)=>{const p=i(...d);return s(...d),p}:s&&(t[n]=s):n==="style"?t[n]={...s,...i}:n==="className"&&(t[n]=[s,i].filter(Boolean).join(" "))}return{...r,...t}}function U9(r){var n,s;let e=(n=Object.getOwnPropertyDescriptor(r.props,"ref"))==null?void 0:n.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=(s=Object.getOwnPropertyDescriptor(r,"ref"))==null?void 0:s.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}function FS(r){const e=r+"CollectionProvider",[t,n]=Ja(e),[s,i]=t(e,{collectionRef:{current:null},itemMap:new Map}),c=E=>{const{scope:C,children:R}=E,A=gr.useRef(null),F=gr.useRef(new Map).current;return u.jsx(s,{scope:C,itemMap:F,collectionRef:A,children:R})};c.displayName=e;const d=r+"CollectionSlot",p=yN(d),m=gr.forwardRef((E,C)=>{const{scope:R,children:A}=E,F=i(d,R),P=Ln(C,F.collectionRef);return u.jsx(p,{ref:P,children:A})});m.displayName=d;const g=r+"CollectionItemSlot",x="data-radix-collection-item",b=yN(g),S=gr.forwardRef((E,C)=>{const{scope:R,children:A,...F}=E,P=gr.useRef(null),L=Ln(C,P),G=i(g,R);return gr.useEffect(()=>(G.itemMap.set(P,{ref:P,...F}),()=>void G.itemMap.delete(P))),u.jsx(b,{[x]:"",ref:L,children:A})});S.displayName=g;function T(E){const C=i(r+"CollectionConsumer",E);return gr.useCallback(()=>{const A=C.collectionRef.current;if(!A)return[];const F=Array.from(A.querySelectorAll(`[${x}]`));return Array.from(C.itemMap.values()).sort((G,U)=>F.indexOf(G.ref.current)-F.indexOf(U.ref.current))},[C.collectionRef,C.itemMap])}return[{Provider:c,Slot:m,ItemSlot:S},T,n]}var z9=w.createContext(void 0);function p0(r){const e=w.useContext(z9);return r||e||"ltr"}var bw="rovingFocusGroup.onEntryFocus",H9={bubbles:!1,cancelable:!0},ug="RovingFocusGroup",[Tb,PI,B9]=FS(ug),[G9,m0]=Ja(ug,[B9]),[W9,V9]=G9(ug),jI=w.forwardRef((r,e)=>u.jsx(Tb.Provider,{scope:r.__scopeRovingFocusGroup,children:u.jsx(Tb.Slot,{scope:r.__scopeRovingFocusGroup,children:u.jsx(q9,{...r,ref:e})})}));jI.displayName=ug;var q9=w.forwardRef((r,e)=>{const{__scopeRovingFocusGroup:t,orientation:n,loop:s=!1,dir:i,currentTabStopId:c,defaultCurrentTabStopId:d,onCurrentTabStopIdChange:p,onEntryFocus:m,preventScrollOnEntryFocus:g=!1,...x}=r,b=w.useRef(null),S=Ln(e,b),T=p0(i),[E,C]=tu({prop:c,defaultProp:d??null,onChange:p,caller:ug}),[R,A]=w.useState(!1),F=Yl(m),P=PI(t),L=w.useRef(!1),[G,U]=w.useState(0);return w.useEffect(()=>{const V=b.current;if(V)return V.addEventListener(bw,F),()=>V.removeEventListener(bw,F)},[F]),u.jsx(W9,{scope:t,orientation:n,dir:T,loop:s,currentTabStopId:E,onItemFocus:w.useCallback(V=>C(V),[C]),onItemShiftTab:w.useCallback(()=>A(!0),[]),onFocusableItemAdd:w.useCallback(()=>U(V=>V+1),[]),onFocusableItemRemove:w.useCallback(()=>U(V=>V-1),[]),children:u.jsx(Ur.div,{tabIndex:R||G===0?-1:0,"data-orientation":n,...x,ref:S,style:{outline:"none",...r.style},onMouseDown:Lt(r.onMouseDown,()=>{L.current=!0}),onFocus:Lt(r.onFocus,V=>{const Q=!L.current;if(V.target===V.currentTarget&&Q&&!R){const fe=new CustomEvent(bw,H9);if(V.currentTarget.dispatchEvent(fe),!fe.defaultPrevented){const B=P().filter(xe=>xe.focusable),ee=B.find(xe=>xe.active),ve=B.find(xe=>xe.id===E),ne=[ee,ve,...B].filter(Boolean).map(xe=>xe.ref.current);DI(ne,g)}}L.current=!1}),onBlur:Lt(r.onBlur,()=>A(!1))})})}),FI="RovingFocusGroupItem",OI=w.forwardRef((r,e)=>{const{__scopeRovingFocusGroup:t,focusable:n=!0,active:s=!1,tabStopId:i,children:c,...d}=r,p=Gl(),m=i||p,g=V9(FI,t),x=g.currentTabStopId===m,b=PI(t),{onFocusableItemAdd:S,onFocusableItemRemove:T,currentTabStopId:E}=g;return w.useEffect(()=>{if(n)return S(),()=>T()},[n,S,T]),u.jsx(Tb.ItemSlot,{scope:t,id:m,focusable:n,active:s,children:u.jsx(Ur.span,{tabIndex:x?0:-1,"data-orientation":g.orientation,...d,ref:e,onMouseDown:Lt(r.onMouseDown,C=>{n?g.onItemFocus(m):C.preventDefault()}),onFocus:Lt(r.onFocus,()=>g.onItemFocus(m)),onKeyDown:Lt(r.onKeyDown,C=>{if(C.key==="Tab"&&C.shiftKey){g.onItemShiftTab();return}if(C.target!==C.currentTarget)return;const R=J9(C,g.orientation,g.dir);if(R!==void 0){if(C.metaKey||C.ctrlKey||C.altKey||C.shiftKey)return;C.preventDefault();let F=b().filter(P=>P.focusable).map(P=>P.ref.current);if(R==="last")F.reverse();else if(R==="prev"||R==="next"){R==="prev"&&F.reverse();const P=F.indexOf(C.currentTarget);F=g.loop?X9(F,P+1):F.slice(P+1)}setTimeout(()=>DI(F))}}),children:typeof c=="function"?c({isCurrentTabStop:x,hasTabStop:E!=null}):c})})});OI.displayName=FI;var K9={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function Y9(r,e){return e!=="rtl"?r:r==="ArrowLeft"?"ArrowRight":r==="ArrowRight"?"ArrowLeft":r}function J9(r,e,t){const n=Y9(r.key,t);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return K9[n]}function DI(r,e=!1){const t=document.activeElement;for(const n of r)if(n===t||(n.focus({preventScroll:e}),document.activeElement!==t))return}function X9(r,e){return r.map((t,n)=>r[(e+n)%r.length])}var LI=jI,MI=OI,g0="Tabs",[Q9]=Ja(g0,[m0]),$I=m0(),[Z9,OS]=Q9(g0),UI=w.forwardRef((r,e)=>{const{__scopeTabs:t,value:n,onValueChange:s,defaultValue:i,orientation:c="horizontal",dir:d,activationMode:p="automatic",...m}=r,g=p0(d),[x,b]=tu({prop:n,onChange:s,defaultProp:i??"",caller:g0});return u.jsx(Z9,{scope:t,baseId:Gl(),value:x,onValueChange:b,orientation:c,dir:g,activationMode:p,children:u.jsx(Ur.div,{dir:g,"data-orientation":c,...m,ref:e})})});UI.displayName=g0;var zI="TabsList",HI=w.forwardRef((r,e)=>{const{__scopeTabs:t,loop:n=!0,...s}=r,i=OS(zI,t),c=$I(t);return u.jsx(LI,{asChild:!0,...c,orientation:i.orientation,dir:i.dir,loop:n,children:u.jsx(Ur.div,{role:"tablist","aria-orientation":i.orientation,...s,ref:e})})});HI.displayName=zI;var BI="TabsTrigger",GI=w.forwardRef((r,e)=>{const{__scopeTabs:t,value:n,disabled:s=!1,...i}=r,c=OS(BI,t),d=$I(t),p=qI(c.baseId,n),m=KI(c.baseId,n),g=n===c.value;return u.jsx(MI,{asChild:!0,...d,focusable:!s,active:g,children:u.jsx(Ur.button,{type:"button",role:"tab","aria-selected":g,"aria-controls":m,"data-state":g?"active":"inactive","data-disabled":s?"":void 0,disabled:s,id:p,...i,ref:e,onMouseDown:Lt(r.onMouseDown,x=>{!s&&x.button===0&&x.ctrlKey===!1?c.onValueChange(n):x.preventDefault()}),onKeyDown:Lt(r.onKeyDown,x=>{[" ","Enter"].includes(x.key)&&c.onValueChange(n)}),onFocus:Lt(r.onFocus,()=>{const x=c.activationMode!=="manual";!g&&!s&&x&&c.onValueChange(n)})})})});GI.displayName=BI;var WI="TabsContent",VI=w.forwardRef((r,e)=>{const{__scopeTabs:t,value:n,forceMount:s,children:i,...c}=r,d=OS(WI,t),p=qI(d.baseId,n),m=KI(d.baseId,n),g=n===d.value,x=w.useRef(g);return w.useEffect(()=>{const b=requestAnimationFrame(()=>x.current=!1);return()=>cancelAnimationFrame(b)},[]),u.jsx(ca,{present:s||g,children:({present:b})=>u.jsx(Ur.div,{"data-state":g?"active":"inactive","data-orientation":d.orientation,role:"tabpanel","aria-labelledby":p,hidden:!b,id:m,tabIndex:0,...c,ref:e,style:{...r.style,animationDuration:x.current?"0s":void 0},children:b&&i})})});VI.displayName=WI;function qI(r,e){return`${r}-trigger-${e}`}function KI(r,e){return`${r}-content-${e}`}var eV=UI,YI=HI,JI=GI,XI=VI;const tV=eV,QI=w.forwardRef(({className:r,...e},t)=>u.jsx(YI,{ref:t,className:Fr("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",r),...e}));QI.displayName=YI.displayName;const ly=w.forwardRef(({className:r,...e},t)=>u.jsx(JI,{ref:t,className:Fr("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm overflow-x-hidden",r),...e}));ly.displayName=JI.displayName;const cy=w.forwardRef(({className:r,...e},t)=>u.jsx(XI,{ref:t,className:Fr("ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",r),...e}));cy.displayName=XI.displayName;const rV="https://rubypowerslaw.filevineapp.com",Mr="src/sidepanel/panels/DocViewerPanel.tsx",ZI=({documentId:r,documentName:e,onBack:t})=>{const n=zr();n.info(`[DocViewerPanel] Initializing with documentId: ${r}, documentName: ${e}`,{sourceFile:Mr});const[s,i]=w.useState(null),[c,d]=w.useState(!0),[p,m]=w.useState(null),[g,x]=w.useState("other"),[b,S]=w.useState(!0),[T,E]=w.useState(!1),[C,R]=w.useState(0),[A,F]=w.useState(!1),P=w.useRef(null),L=w.useCallback(ee=>{n.info(`[DocViewerPanel] getDocumentType called with extension: ${ee}`,{sourceFile:Mr});const ve=["jpg","jpeg","png","gif","bmp","webp","svg","tiff"],ce=["pdf"],ne=["doc","docx","xls","xlsx","ppt","pptx","odt","ods","odp","rtf"],xe=["txt","md","csv","json","xml","html","htm"];let J="other";return ve.includes(ee)?J="image":ce.includes(ee)?J="pdf":ne.includes(ee)?J="office":xe.includes(ee)&&(J="text"),n.info(`[DocViewerPanel] Document type determined: ${J} for extension: ${ee}`,{sourceFile:Mr}),J},[n]);w.useEffect(()=>{(async()=>{var ve;if(n.info(`[DocViewerPanel] Starting fetchDocumentUrl for documentId: ${r}`,{sourceFile:Mr}),!r){n.warn("[DocViewerPanel] No document ID provided",{sourceFile:Mr,error:"No document ID provided"}),m("No document ID provided"),d(!1);return}d(!0),m(null);try{n.info(`[DocViewerPanel] Fetching document URL from server for documentId: ${r}`,{sourceFile:Mr});const ce=await d8("filevine",r.toString(),n);if(n.info("[DocViewerPanel] Received document data:",{sourceFile:Mr,documentData:ce}),!ce.url){const J=new Error("Document URL not found in response");throw n.error("[DocViewerPanel] Document URL not found in response",J,{sourceFile:Mr}),J}n.info(`[DocViewerPanel] Setting document URL: ${ce.url}`,{sourceFile:Mr}),i(ce.url);const ne=((ve=e.split(".").pop())==null?void 0:ve.toLowerCase())||"";n.info(`[DocViewerPanel] Detected file extension: ${ne}`,{sourceFile:Mr});const xe=L(ne);n.info(`[DocViewerPanel] Determined document type: ${xe}`,{sourceFile:Mr}),x(xe)}catch(ce){n.error("[DocViewerPanel] Error fetching document URL:",ce,{sourceFile:Mr}),m("Failed to load document. Please try again later.")}finally{d(!1)}})()},[r,e,C,n,L]),w.useEffect(()=>(P.current&&(clearTimeout(P.current),P.current=null),F(!1),!c&&b&&g!=="image"&&(n.info("[DocViewerPanel] Setting loading timeout for document",{sourceFile:Mr}),P.current=setTimeout(()=>{n.info("[DocViewerPanel] Document loading is taking too long",{sourceFile:Mr}),F(!0)},1e4)),()=>{P.current&&(clearTimeout(P.current),P.current=null)}),[c,b,g,n]);const G=()=>{n.info("[DocViewerPanel] iframe loaded successfully",{sourceFile:Mr}),S(!1),E(!1),F(!1),P.current&&(clearTimeout(P.current),P.current=null)},U=ee=>{n.error("[DocViewerPanel] iframe error:",ee,{sourceFile:Mr}),S(!1),E(!0),F(!1),P.current&&(clearTimeout(P.current),P.current=null)},V=()=>{n.info("[DocViewerPanel] Retrying document load",{sourceFile:Mr}),S(!0),E(!1),F(!1),R(ee=>ee+1)},Q=()=>{if(r){const ee=`${rV}/docwebviewer/view/${r}`;n.info(`[DocViewerPanel] Opening document in new tab with original URL: ${ee}`,{sourceFile:Mr}),window.open(ee,"_blank")}},fe=()=>{if(!s){n.warn("[DocViewerPanel] No document URL available for download",{sourceFile:Mr});return}try{n.info(`[DocViewerPanel] Starting download for: ${e}`,{sourceFile:Mr});const ee=new URL(s);ee.searchParams.set("response-content-disposition",`attachment; filename="${encodeURIComponent(e)}"`);const ve=document.createElement("a");ve.href=ee.toString(),ve.download=e,ve.target="_blank",ve.rel="noopener noreferrer",document.body.appendChild(ve),ve.click(),setTimeout(()=>{document.body.removeChild(ve)},100),n.info(`[DocViewerPanel] Download initiated for: ${e}`,{sourceFile:Mr})}catch(ee){n.error("[DocViewerPanel] Error downloading document:",ee,{sourceFile:Mr})}};if(c)return n.info("[DocViewerPanel] Rendering loading state",{sourceFile:Mr}),u.jsxs(Es,{className:"w-full h-full",children:[u.jsx(io,{className:"pb-4",children:u.jsxs("div",{className:"flex flex-row items-start gap-3",children:[u.jsx(We,{variant:"ghost",size:"sm",onClick:t,className:"h-8 w-8 p-0 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors shrink-0 mt-0.5","aria-label":"Go back",title:"Go back",children:u.jsx(Tm,{className:"h-4 w-4"})}),u.jsx(ao,{className:"text-base font-semibold leading-relaxed break-words flex-1 min-w-0",children:e})]})}),u.jsx(Cs,{className:"flex items-center justify-center h-[80vh]",children:u.jsxs("div",{className:"text-center",children:[u.jsx(ii,{className:"h-8 w-8 animate-spin mx-auto mb-4 text-blue-600 dark:text-blue-400"}),u.jsx("p",{className:"dark:text-gray-200",children:"Loading document..."})]})})]});if(p)return n.info(`[DocViewerPanel] Rendering error state: ${p}`,{sourceFile:Mr}),u.jsxs(Es,{className:"w-full h-full",children:[u.jsx(io,{className:"pb-4",children:u.jsxs("div",{className:"flex flex-row items-start gap-3",children:[u.jsx(We,{variant:"ghost",size:"sm",onClick:t,className:"h-8 w-8 p-0 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors shrink-0 mt-0.5","aria-label":"Go back",title:"Go back",children:u.jsx(Tm,{className:"h-4 w-4"})}),u.jsx(ao,{className:"text-base font-semibold leading-relaxed break-words flex-1 min-w-0",children:e})]})}),u.jsx(Cs,{className:"flex items-center justify-center h-[80vh]",children:u.jsxs("div",{className:"text-center text-red-500",children:[u.jsx("p",{children:p}),u.jsxs(We,{variant:"outline",className:"mt-4",onClick:V,children:[u.jsx(Do,{className:"h-4 w-4 mr-2"}),"Retry"]})]})})]});const B=()=>{if(n.info(`[DocViewerPanel] renderDocumentViewer called with documentType: ${g}, documentUrl: ${s}`,{sourceFile:Mr}),!s)return n.info("[DocViewerPanel] No document URL available, returning null",{sourceFile:Mr}),null;const ee=`https://docs.google.com/viewer?url=${encodeURIComponent(s||"")}&embedded=true`;n.info(`[DocViewerPanel] Google Docs Viewer URL: ${ee}`,{sourceFile:Mr});const ve=g==="pdf"?"PDF":g==="office"?"Office document":g==="text"?"Text document":g==="image"?"Image":"Document";return g==="image"?(n.info("[DocViewerPanel] Rendering image viewer",{sourceFile:Mr}),u.jsx("div",{className:"w-full h-full flex items-center justify-center overflow-auto",children:u.jsx("img",{src:s,alt:e,className:"max-w-full max-h-full object-contain",onLoad:()=>S(!1),onError:()=>{S(!1),E(!0)}})})):(n.info(`[DocViewerPanel] Rendering ${ve} viewer with Google Docs for: ${e}`,{sourceFile:Mr}),u.jsxs("div",{className:"w-full h-full relative",children:[b&&u.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white dark:bg-gray-900 bg-opacity-80 dark:bg-opacity-80 z-10",children:u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 dark:border-gray-100 mx-auto mb-4"}),u.jsxs("p",{className:"dark:text-gray-200",children:["Loading ",ve.toLowerCase(),"..."]}),u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-2",children:"This may take a moment for large files"}),A&&u.jsxs("div",{className:"mt-4 p-4 bg-yellow-50 border border-yellow-200 rounded-md",children:[u.jsx("p",{className:"text-amber-700 font-medium",children:"This is taking longer than expected."}),u.jsx("p",{className:"text-sm text-amber-600 mt-1",children:g==="office"?"Office documents can sometimes be slow to load in the viewer.":"This document might be large or complex."}),u.jsxs("div",{className:"mt-3 flex justify-center space-x-3",children:[u.jsxs(We,{variant:"outline",size:"sm",onClick:V,children:[u.jsx(Do,{className:"h-3 w-3 mr-1"}),"Retry"]}),u.jsx(We,{variant:"default",size:"sm",onClick:Q,children:"Open in new tab"})]})]})]})}),T&&u.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white dark:bg-gray-900 z-10",children:u.jsxs("div",{className:"text-center text-red-500 dark:text-red-400",children:[u.jsxs("p",{children:["Failed to load ",ve.toLowerCase(),"."]}),u.jsx("p",{className:"text-sm mt-2 dark:text-gray-400",children:"The document might be too large or in an unsupported format."}),u.jsxs("div",{className:"mt-4 flex justify-center space-x-3",children:[u.jsxs(We,{variant:"outline",onClick:V,children:[u.jsx(Do,{className:"h-4 w-4 mr-2"}),"Retry"]}),u.jsx(We,{variant:"default",onClick:Q,children:"Open in new tab"})]})]})}),u.jsx("iframe",{src:ee,className:"w-full h-full border-none",title:e,sandbox:"allow-scripts allow-same-origin allow-forms allow-popups allow-popups-to-escape-sandbox",onLoad:G,onError:U})]}))};return n.info(`[DocViewerPanel] Rendering main component with documentType: ${g}`,{sourceFile:Mr}),u.jsxs(Es,{className:"w-full h-full",children:[u.jsxs(io,{className:"pb-4",children:[u.jsxs("div",{className:"flex flex-row items-start gap-3",children:[u.jsx(We,{variant:"ghost",size:"sm",onClick:t,className:"h-8 w-8 p-0 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors shrink-0 mt-0.5","aria-label":"Go back",title:"Go back",children:u.jsx(Tm,{className:"h-4 w-4"})}),u.jsx(ao,{className:"text-base font-semibold leading-relaxed break-words flex-1 min-w-0",children:e})]}),!c&&u.jsxs("div",{className:"flex gap-2 pl-8 pr-6",children:[u.jsxs(We,{variant:"outline",size:"sm",onClick:fe,className:"h-9 px-4","aria-label":"Download file",children:[u.jsx(hB,{className:"h-4 w-4 mr-2"}),"Download"]}),u.jsxs(We,{variant:"outline",size:"sm",onClick:Q,className:"h-9 px-4","aria-label":"Open in new tab",children:[u.jsx(Ba,{className:"h-4 w-4 mr-2"}),"Open in new tab"]})]})]}),u.jsx(Cs,{className:"h-[80vh] overflow-hidden",children:B()})]})},Ol="src/sidepanel/panels/ClientDocumentsPanel.tsx",nV="https://rubypowerslaw.filevineapp.com",sV=({clientEmail:r,projectId:e,documents:t,isLoading:n,error:s,goBack:i,initialSelectedDocument:c})=>{const d=zr(),[p,m]=w.useState([]),[g,x]=w.useState(!1),[b,S]=w.useState(null),[T,E]=w.useState(""),[C,R]=w.useState(null),[A,F]=w.useState({contracts:!1,payments:!1,allDocuments:!0}),[P,L]=w.useState({});w.useEffect(()=>{const z={sourceFile:Ol,functionName:"useEffect[fetchData]"};if(t&&t.length>0||n){t&&m(t);return}(async()=>{if(!e){S("No project ID provided. Please select a valid project.");return}x(!0),S(null);try{const O=await _T(e,d);if(O){d.debug("Using cached documents for project",{...z,data:{projectId:e}}),m(O),x(!1);return}d.debug("ClientDocumentsPanel: Fetching documents from server for project",{...z,data:{projectId:e}});const ae=(await MT("filevine",e,d)).documents.map(be=>({name:be.filename,url:`${nV}/docwebviewer/view/${be.documentId}`,documentId:be.documentId,folderName:be.folderName}));await bT(e,ae,d),m(ae)}catch(O){d.error("Error fetching documents:",O,z),S("Failed to load documents. Please try again later.")}finally{x(!1)}})()},[e,t,n,d]);const G=n!==void 0?n:g,U=s!==void 0?s:b,V=gr.useMemo(()=>{const z={sourceFile:Ol,functionName:"useMemo[filteredDocuments]"};return d.debug("Computing filteredDocuments",z),p.filter(q=>q.name.toLowerCase().includes(T.toLowerCase()))},[p,T,d]),Q=p.filter(z=>z.folderName&&z.folderName.toLowerCase().includes("contract")),fe=p.filter(z=>z.folderName&&z.folderName.toLowerCase().includes("payment")),B=z=>{var ae;const q={sourceFile:Ol,functionName:"isViewableDocument",data:{filename:z}},O=(ae=z.split(".").pop())==null?void 0:ae.toLowerCase(),$=["pdf","jpg","jpeg","png","gif","bmp","webp","doc","docx","xls","xlsx","ppt","pptx","odt","ods","odp","rtf","txt"];return d.debug(`File extension: ${O}`,q),d.debug(`Viewable extensions: ${$}`,q),$.includes(O||"")},ee=z=>{var O;const q=((O=z.split(".").pop())==null?void 0:O.toLowerCase())||"";return["jpg","jpeg","png","gif","bmp","webp","svg","tiff"].includes(q)?u.jsx(yB,{className:"h-4 w-4 text-purple-500 dark:text-purple-400"}):["xls","xlsx","csv","ods"].includes(q)?u.jsx(mB,{className:"h-4 w-4 text-green-500 dark:text-green-400"}):["ppt","pptx","odp"].includes(q)?u.jsx(EB,{className:"h-4 w-4 text-orange-500 dark:text-orange-400"}):["pdf","doc","docx","txt","rtf","odt"].includes(q)?u.jsx(ld,{className:"h-4 w-4 text-blue-500 dark:text-blue-400"}):u.jsx(gB,{className:"h-4 w-4 text-gray-500 dark:text-gray-400"})},ve=z=>{const q={sourceFile:Ol,functionName:"handleViewDocument",data:{docName:z.name,docId:z.documentId,url:z.url,folder:z.folderName}};d.debug("Handling view document",q),z.documentId&&B(z.name)?(d.debug("Selected document",q),R({name:z.name,documentId:z.documentId,url:z.url,folderName:z.folderName})):z.url&&(d.debug("Opening document URL",q),window.open(z.url,"_blank"))},ce=z=>{F(q=>({...q,[z]:!q[z]}))},ne=z=>{const q={sourceFile:Ol,functionName:"toggleFolder",data:{folderName:z}};d.debug("Toggling folder",q),L(O=>({...O,[z]:!O[z]}))},xe=gr.useCallback(z=>{const q={sourceFile:Ol,functionName:"groupDocumentsByFolder"};d.debug("Running groupDocumentsByFolder",q);const O={};return O["No Folder"]=[],z.forEach($=>{const ae=$.folderName||"No Folder";O[ae]||(O[ae]=[]),O[ae].push($)}),O["No Folder"].length===0&&delete O["No Folder"],O},[d]),J=gr.useMemo(()=>{const z={sourceFile:Ol,functionName:"useMemo[groupedFilteredDocuments]"};return d.debug("Computing groupedFilteredDocuments",z),xe(V)},[V,xe,d]);w.useEffect(()=>{const z={sourceFile:Ol,functionName:"useEffect[folderExpansion]"};if(d.debug("Running folder expansion initialization effect",z),V.length>0){const q=Object.keys(J);d.debug(`Found folders: ${q.join(", ")}`,z),L(O=>{const $={...O};let ae=!1;return q.forEach(be=>{$[be]===void 0&&($[be]=!1,ae=!0)}),ae?$:O})}},[J,V.length,d]),w.useEffect(()=>{const z={sourceFile:Ol,functionName:"useEffect[initialSelectedDocument]"};c&&(d.debug("Setting initial selected document",{...z,document:c}),R({name:c.name,documentId:c.documentId,url:c.url}))},[c,d]);const X=()=>!G&&!U&&p.length===0?u.jsx("div",{className:"text-gray-500 dark:text-gray-400 text-center py-4",children:"No documents found for this client."}):!G&&!U&&p.length>0?u.jsxs("div",{className:"space-y-4",children:[Q.length>0&&u.jsxs("div",{children:[u.jsxs("button",{onClick:()=>ce("contracts"),className:"flex items-center justify-between w-full py-2 text-left font-medium text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-md px-2",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx(ld,{className:"h-4 w-4 mr-2 text-blue-500 dark:text-blue-400"}),u.jsxs("span",{children:["Contracts (",Q.length,")"]})]}),A.contracts?u.jsx(Ov,{className:"h-4 w-4"}):u.jsx(ws,{className:"h-4 w-4"})]}),A.contracts&&u.jsx("ul",{className:"ml-6 mt-2 space-y-1 text-sm",children:Q.map(z=>u.jsxs("li",{className:"flex items-center gap-2 text-gray-600 dark:text-gray-400",children:[u.jsx("span",{className:"flex-shrink-0",children:ee(z.name)}),u.jsx("button",{onClick:()=>ve(z),className:"text-blue-600 dark:text-blue-400 hover:underline hover:text-blue-800 dark:hover:text-blue-300 focus:outline-none text-left truncate min-w-0",title:z.name,children:z.name})]},z.documentId))})]}),fe.length>0&&u.jsxs("div",{children:[u.jsxs("button",{onClick:()=>ce("payments"),className:"flex items-center justify-between w-full py-2 text-left font-medium text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-md px-2",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx(fB,{className:"h-4 w-4 mr-2 text-green-500 dark:text-green-400"}),u.jsxs("span",{children:["Payments (",fe.length,")"]})]}),A.payments?u.jsx(Ov,{className:"h-4 w-4"}):u.jsx(ws,{className:"h-4 w-4"})]}),A.payments&&u.jsx("ul",{className:"ml-6 mt-2 space-y-1 text-sm",children:fe.map(z=>u.jsxs("li",{className:"flex items-center gap-2 text-gray-600 dark:text-gray-400",children:[u.jsx("span",{className:"flex-shrink-0",children:ee(z.name)}),u.jsx("button",{onClick:()=>ve(z),className:"text-blue-600 dark:text-blue-400 hover:underline hover:text-blue-800 dark:hover:text-blue-300 focus:outline-none text-left truncate min-w-0",title:z.name,children:z.name})]},z.documentId))})]}),V.length>0&&u.jsxs("div",{children:[u.jsxs("button",{onClick:()=>ce("allDocuments"),className:"flex items-center justify-between w-full py-2 text-left font-medium text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-md px-2",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx(ld,{className:"h-4 w-4 mr-2 text-gray-500 dark:text-gray-400"}),u.jsxs("span",{children:["All Documents (",V.length,")"]})]}),A.allDocuments?u.jsx(Ov,{className:"h-4 w-4"}):u.jsx(ws,{className:"h-4 w-4"})]}),A.allDocuments&&u.jsx("div",{className:"ml-2 mt-2 space-y-2 text-sm",children:Object.entries(J).map(([z,q])=>u.jsxs("div",{children:[u.jsxs("button",{onClick:()=>ne(z),className:"flex items-center justify-between w-full py-1 text-left font-medium text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-md px-1",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(vB,{className:"h-4 w-4 text-amber-500 dark:text-amber-400"}),u.jsxs("span",{children:[z," (",q.length,")"]})]}),P[z]?u.jsx(Ov,{className:"h-4 w-4"}):u.jsx(ws,{className:"h-4 w-4"})]}),P[z]&&u.jsx("ul",{className:"ml-6 mt-1 space-y-1",children:q.map(O=>u.jsxs("li",{className:"flex items-center gap-2 text-gray-600 dark:text-gray-400",children:[u.jsx("span",{className:"flex-shrink-0",children:ee(O.name)}),u.jsx("button",{onClick:()=>ve(O),className:"text-blue-600 dark:text-blue-400 hover:underline hover:text-blue-800 dark:hover:text-blue-300 focus:outline-none text-left truncate min-w-0",title:O.name,children:O.name})]},O.documentId))})]},z))})]})]}):null;return u.jsx("div",{className:"flex flex-col h-full bg-background",children:u.jsx("div",{className:"flex-grow overflow-hidden",children:C?u.jsx(ZI,{documentId:C.documentId,documentName:C.name,onBack:()=>R(null)}):G?u.jsxs(Es,{className:"w-full h-full",children:[u.jsx(io,{className:"pb-4",children:u.jsxs("div",{className:"flex flex-row items-start gap-3",children:[i&&u.jsx(We,{variant:"ghost",size:"sm",onClick:i,className:"h-8 w-8 p-0 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors shrink-0 mt-0.5","aria-label":"Go back",title:"Go back",children:u.jsx(Tm,{className:"h-4 w-4"})}),u.jsx(ao,{className:"text-base font-semibold leading-relaxed break-words flex-1 min-w-0",children:"Project Documents"})]})}),u.jsx(Cs,{className:"flex items-center justify-center h-[80vh]",children:u.jsxs("div",{className:"text-center",children:[u.jsx(ii,{className:"h-8 w-8 animate-spin mx-auto mb-4 text-blue-600 dark:text-blue-400"}),u.jsx("p",{className:"dark:text-gray-200",children:"Loading documents..."})]})})]}):U?u.jsxs("div",{className:"text-red-600 bg-red-50 p-3 rounded-md",children:["Error: ",U]}):u.jsxs(Es,{className:"mb-4",children:[u.jsx(io,{className:"pb-2",children:u.jsxs("div",{className:"flex flex-row items-start gap-3",children:[i&&u.jsx(We,{variant:"ghost",size:"sm",onClick:i,className:"h-8 w-8 p-0 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors shrink-0 mt-0.5","aria-label":"Go back",title:"Go back",children:u.jsx(Tm,{className:"h-4 w-4"})}),u.jsx(ao,{className:"text-base font-semibold leading-relaxed break-words flex-1 min-w-0",children:"Project Documents"})]})}),u.jsxs(Cs,{className:"px-4 pt-2 pb-4",children:[u.jsxs("div",{className:"relative mb-4",children:[u.jsx(lo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),u.jsx(an,{type:"text",placeholder:"Search All Documents...",value:T,onChange:z=>E(z.target.value),className:"w-full pl-9 pr-4 py-2 h-9 text-sm border rounded-md"})]}),u.jsx("div",{className:"overflow-y-auto max-h-[80vh] pb-32",children:X()})]})]})})})};function oV(r){const e=iV(r),t=w.forwardRef((n,s)=>{const{children:i,...c}=n,d=w.Children.toArray(i),p=d.find(lV);if(p){const m=p.props.children,g=d.map(x=>x===p?w.Children.count(m)>1?w.Children.only(null):w.isValidElement(m)?m.props.children:null:x);return u.jsx(e,{...c,ref:s,children:w.isValidElement(m)?w.cloneElement(m,void 0,g):null})}return u.jsx(e,{...c,ref:s,children:i})});return t.displayName=`${r}.Slot`,t}function iV(r){const e=w.forwardRef((t,n)=>{const{children:s,...i}=t;if(w.isValidElement(s)){const c=uV(s),d=cV(i,s.props);return s.type!==w.Fragment&&(d.ref=n?eu(n,c):c),w.cloneElement(s,d)}return w.Children.count(s)>1?w.Children.only(null):null});return e.displayName=`${r}.SlotClone`,e}var aV=Symbol("radix.slottable");function lV(r){return w.isValidElement(r)&&typeof r.type=="function"&&"__radixId"in r.type&&r.type.__radixId===aV}function cV(r,e){const t={...e};for(const n in e){const s=r[n],i=e[n];/^on[A-Z]/.test(n)?s&&i?t[n]=(...d)=>{const p=i(...d);return s(...d),p}:s&&(t[n]=s):n==="style"?t[n]={...s,...i}:n==="className"&&(t[n]=[s,i].filter(Boolean).join(" "))}return{...r,...t}}function uV(r){var n,s;let e=(n=Object.getOwnPropertyDescriptor(r.props,"ref"))==null?void 0:n.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=(s=Object.getOwnPropertyDescriptor(r,"ref"))==null?void 0:s.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}var Rb=["Enter"," "],dV=["ArrowDown","PageUp","Home"],eP=["ArrowUp","PageDown","End"],fV=[...dV,...eP],hV={ltr:[...Rb,"ArrowRight"],rtl:[...Rb,"ArrowLeft"]},pV={ltr:["ArrowLeft"],rtl:["ArrowRight"]},dg="Menu",[Ym,mV,gV]=FS(dg),[md,tP]=Ja(dg,[gV,a0,m0]),v0=a0(),rP=m0(),[vV,gd]=md(dg),[yV,fg]=md(dg),nP=r=>{const{__scopeMenu:e,open:t=!1,children:n,dir:s,onOpenChange:i,modal:c=!0}=r,d=v0(e),[p,m]=w.useState(null),g=w.useRef(!1),x=Yl(i),b=p0(s);return w.useEffect(()=>{const S=()=>{g.current=!0,document.addEventListener("pointerdown",T,{capture:!0,once:!0}),document.addEventListener("pointermove",T,{capture:!0,once:!0})},T=()=>g.current=!1;return document.addEventListener("keydown",S,{capture:!0}),()=>{document.removeEventListener("keydown",S,{capture:!0}),document.removeEventListener("pointerdown",T,{capture:!0}),document.removeEventListener("pointermove",T,{capture:!0})}},[]),u.jsx(TA,{...d,children:u.jsx(vV,{scope:e,open:t,onOpenChange:x,content:p,onContentChange:m,children:u.jsx(yV,{scope:e,onClose:w.useCallback(()=>x(!1),[x]),isUsingKeyboardRef:g,dir:b,modal:c,children:n})})})};nP.displayName=dg;var xV="MenuAnchor",DS=w.forwardRef((r,e)=>{const{__scopeMenu:t,...n}=r,s=v0(t);return u.jsx(RA,{...s,...n,ref:e})});DS.displayName=xV;var LS="MenuPortal",[wV,sP]=md(LS,{forceMount:void 0}),oP=r=>{const{__scopeMenu:e,forceMount:t,children:n,container:s}=r,i=gd(LS,e);return u.jsx(wV,{scope:e,forceMount:t,children:u.jsx(ca,{present:t||i.open,children:u.jsx(ES,{asChild:!0,container:s,children:n})})})};oP.displayName=LS;var Di="MenuContent",[bV,MS]=md(Di),iP=w.forwardRef((r,e)=>{const t=sP(Di,r.__scopeMenu),{forceMount:n=t.forceMount,...s}=r,i=gd(Di,r.__scopeMenu),c=fg(Di,r.__scopeMenu);return u.jsx(Ym.Provider,{scope:r.__scopeMenu,children:u.jsx(ca,{present:n||i.open,children:u.jsx(Ym.Slot,{scope:r.__scopeMenu,children:c.modal?u.jsx(_V,{...s,ref:e}):u.jsx(SV,{...s,ref:e})})})})}),_V=w.forwardRef((r,e)=>{const t=gd(Di,r.__scopeMenu),n=w.useRef(null),s=Ln(e,n);return w.useEffect(()=>{const i=n.current;if(i)return tI(i)},[]),u.jsx($S,{...r,ref:s,trapFocus:t.open,disableOutsidePointerEvents:t.open,disableOutsideScroll:!0,onFocusOutside:Lt(r.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>t.onOpenChange(!1)})}),SV=w.forwardRef((r,e)=>{const t=gd(Di,r.__scopeMenu);return u.jsx($S,{...r,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>t.onOpenChange(!1)})}),EV=oV("MenuContent.ScrollLock"),$S=w.forwardRef((r,e)=>{const{__scopeMenu:t,loop:n=!1,trapFocus:s,onOpenAutoFocus:i,onCloseAutoFocus:c,disableOutsidePointerEvents:d,onEntryFocus:p,onEscapeKeyDown:m,onPointerDownOutside:g,onFocusOutside:x,onInteractOutside:b,onDismiss:S,disableOutsideScroll:T,...E}=r,C=gd(Di,t),R=fg(Di,t),A=v0(t),F=rP(t),P=mV(t),[L,G]=w.useState(null),U=w.useRef(null),V=Ln(e,U,C.onContentChange),Q=w.useRef(0),fe=w.useRef(""),B=w.useRef(0),ee=w.useRef(null),ve=w.useRef("right"),ce=w.useRef(0),ne=T?RS:w.Fragment,xe=T?{as:EV,allowPinchZoom:!0}:void 0,J=z=>{var de,ge;const q=fe.current+z,O=P().filter(se=>!se.disabled),$=document.activeElement,ae=(de=O.find(se=>se.ref.current===$))==null?void 0:de.textValue,be=O.map(se=>se.textValue),ie=DV(be,q,ae),K=(ge=O.find(se=>se.textValue===ie))==null?void 0:ge.ref.current;(function se(Te){fe.current=Te,window.clearTimeout(Q.current),Te!==""&&(Q.current=window.setTimeout(()=>se(""),1e3))})(q),K&&setTimeout(()=>K.focus())};w.useEffect(()=>()=>window.clearTimeout(Q.current),[]),qA();const X=w.useCallback(z=>{var O,$;return ve.current===((O=ee.current)==null?void 0:O.side)&&MV(z,($=ee.current)==null?void 0:$.area)},[]);return u.jsx(bV,{scope:t,searchRef:fe,onItemEnter:w.useCallback(z=>{X(z)&&z.preventDefault()},[X]),onItemLeave:w.useCallback(z=>{var q;X(z)||((q=U.current)==null||q.focus(),G(null))},[X]),onTriggerLeave:w.useCallback(z=>{X(z)&&z.preventDefault()},[X]),pointerGraceTimerRef:B,onPointerGraceIntentChange:w.useCallback(z=>{ee.current=z},[]),children:u.jsx(ne,{...xe,children:u.jsx(TS,{asChild:!0,trapped:s,onMountAutoFocus:Lt(i,z=>{var q;z.preventDefault(),(q=U.current)==null||q.focus({preventScroll:!0})}),onUnmountAutoFocus:c,children:u.jsx(l0,{asChild:!0,disableOutsidePointerEvents:d,onEscapeKeyDown:m,onPointerDownOutside:g,onFocusOutside:x,onInteractOutside:b,onDismiss:S,children:u.jsx(LI,{asChild:!0,...F,dir:R.dir,orientation:"vertical",loop:n,currentTabStopId:L,onCurrentTabStopIdChange:G,onEntryFocus:Lt(p,z=>{R.isUsingKeyboardRef.current||z.preventDefault()}),preventScrollOnEntryFocus:!0,children:u.jsx(AA,{role:"menu","aria-orientation":"vertical","data-state":_P(C.open),"data-radix-menu-content":"",dir:R.dir,...A,...E,ref:V,style:{outline:"none",...E.style},onKeyDown:Lt(E.onKeyDown,z=>{const O=z.target.closest("[data-radix-menu-content]")===z.currentTarget,$=z.ctrlKey||z.altKey||z.metaKey,ae=z.key.length===1;O&&(z.key==="Tab"&&z.preventDefault(),!$&&ae&&J(z.key));const be=U.current;if(z.target!==be||!fV.includes(z.key))return;z.preventDefault();const K=P().filter(de=>!de.disabled).map(de=>de.ref.current);eP.includes(z.key)&&K.reverse(),FV(K)}),onBlur:Lt(r.onBlur,z=>{z.currentTarget.contains(z.target)||(window.clearTimeout(Q.current),fe.current="")}),onPointerMove:Lt(r.onPointerMove,Jm(z=>{const q=z.target,O=ce.current!==z.clientX;if(z.currentTarget.contains(q)&&O){const $=z.clientX>ce.current?"right":"left";ve.current=$,ce.current=z.clientX}}))})})})})})})});iP.displayName=Di;var CV="MenuGroup",US=w.forwardRef((r,e)=>{const{__scopeMenu:t,...n}=r;return u.jsx(Ur.div,{role:"group",...n,ref:e})});US.displayName=CV;var kV="MenuLabel",aP=w.forwardRef((r,e)=>{const{__scopeMenu:t,...n}=r;return u.jsx(Ur.div,{...n,ref:e})});aP.displayName=kV;var $y="MenuItem",xN="menu.itemSelect",y0=w.forwardRef((r,e)=>{const{disabled:t=!1,onSelect:n,...s}=r,i=w.useRef(null),c=fg($y,r.__scopeMenu),d=MS($y,r.__scopeMenu),p=Ln(e,i),m=w.useRef(!1),g=()=>{const x=i.current;if(!t&&x){const b=new CustomEvent(xN,{bubbles:!0,cancelable:!0});x.addEventListener(xN,S=>n==null?void 0:n(S),{once:!0}),vA(x,b),b.defaultPrevented?m.current=!1:c.onClose()}};return u.jsx(lP,{...s,ref:p,disabled:t,onClick:Lt(r.onClick,g),onPointerDown:x=>{var b;(b=r.onPointerDown)==null||b.call(r,x),m.current=!0},onPointerUp:Lt(r.onPointerUp,x=>{var b;m.current||(b=x.currentTarget)==null||b.click()}),onKeyDown:Lt(r.onKeyDown,x=>{const b=d.searchRef.current!=="";t||b&&x.key===" "||Rb.includes(x.key)&&(x.currentTarget.click(),x.preventDefault())})})});y0.displayName=$y;var lP=w.forwardRef((r,e)=>{const{__scopeMenu:t,disabled:n=!1,textValue:s,...i}=r,c=MS($y,t),d=rP(t),p=w.useRef(null),m=Ln(e,p),[g,x]=w.useState(!1),[b,S]=w.useState("");return w.useEffect(()=>{const T=p.current;T&&S((T.textContent??"").trim())},[i.children]),u.jsx(Ym.ItemSlot,{scope:t,disabled:n,textValue:s??b,children:u.jsx(MI,{asChild:!0,...d,focusable:!n,children:u.jsx(Ur.div,{role:"menuitem","data-highlighted":g?"":void 0,"aria-disabled":n||void 0,"data-disabled":n?"":void 0,...i,ref:m,onPointerMove:Lt(r.onPointerMove,Jm(T=>{n?c.onItemLeave(T):(c.onItemEnter(T),T.defaultPrevented||T.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:Lt(r.onPointerLeave,Jm(T=>c.onItemLeave(T))),onFocus:Lt(r.onFocus,()=>x(!0)),onBlur:Lt(r.onBlur,()=>x(!1))})})})}),NV="MenuCheckboxItem",cP=w.forwardRef((r,e)=>{const{checked:t=!1,onCheckedChange:n,...s}=r;return u.jsx(pP,{scope:r.__scopeMenu,checked:t,children:u.jsx(y0,{role:"menuitemcheckbox","aria-checked":Uy(t)?"mixed":t,...s,ref:e,"data-state":HS(t),onSelect:Lt(s.onSelect,()=>n==null?void 0:n(Uy(t)?!0:!t),{checkForDefaultPrevented:!1})})})});cP.displayName=NV;var uP="MenuRadioGroup",[TV,RV]=md(uP,{value:void 0,onValueChange:()=>{}}),dP=w.forwardRef((r,e)=>{const{value:t,onValueChange:n,...s}=r,i=Yl(n);return u.jsx(TV,{scope:r.__scopeMenu,value:t,onValueChange:i,children:u.jsx(US,{...s,ref:e})})});dP.displayName=uP;var fP="MenuRadioItem",hP=w.forwardRef((r,e)=>{const{value:t,...n}=r,s=RV(fP,r.__scopeMenu),i=t===s.value;return u.jsx(pP,{scope:r.__scopeMenu,checked:i,children:u.jsx(y0,{role:"menuitemradio","aria-checked":i,...n,ref:e,"data-state":HS(i),onSelect:Lt(n.onSelect,()=>{var c;return(c=s.onValueChange)==null?void 0:c.call(s,t)},{checkForDefaultPrevented:!1})})})});hP.displayName=fP;var zS="MenuItemIndicator",[pP,AV]=md(zS,{checked:!1}),mP=w.forwardRef((r,e)=>{const{__scopeMenu:t,forceMount:n,...s}=r,i=AV(zS,t);return u.jsx(ca,{present:n||Uy(i.checked)||i.checked===!0,children:u.jsx(Ur.span,{...s,ref:e,"data-state":HS(i.checked)})})});mP.displayName=zS;var IV="MenuSeparator",gP=w.forwardRef((r,e)=>{const{__scopeMenu:t,...n}=r;return u.jsx(Ur.div,{role:"separator","aria-orientation":"horizontal",...n,ref:e})});gP.displayName=IV;var PV="MenuArrow",vP=w.forwardRef((r,e)=>{const{__scopeMenu:t,...n}=r,s=v0(t);return u.jsx(IA,{...s,...n,ref:e})});vP.displayName=PV;var jV="MenuSub",[qK,yP]=md(jV),bm="MenuSubTrigger",xP=w.forwardRef((r,e)=>{const t=gd(bm,r.__scopeMenu),n=fg(bm,r.__scopeMenu),s=yP(bm,r.__scopeMenu),i=MS(bm,r.__scopeMenu),c=w.useRef(null),{pointerGraceTimerRef:d,onPointerGraceIntentChange:p}=i,m={__scopeMenu:r.__scopeMenu},g=w.useCallback(()=>{c.current&&window.clearTimeout(c.current),c.current=null},[]);return w.useEffect(()=>g,[g]),w.useEffect(()=>{const x=d.current;return()=>{window.clearTimeout(x),p(null)}},[d,p]),u.jsx(DS,{asChild:!0,...m,children:u.jsx(lP,{id:s.triggerId,"aria-haspopup":"menu","aria-expanded":t.open,"aria-controls":s.contentId,"data-state":_P(t.open),...r,ref:eu(e,s.onTriggerChange),onClick:x=>{var b;(b=r.onClick)==null||b.call(r,x),!(r.disabled||x.defaultPrevented)&&(x.currentTarget.focus(),t.open||t.onOpenChange(!0))},onPointerMove:Lt(r.onPointerMove,Jm(x=>{i.onItemEnter(x),!x.defaultPrevented&&!r.disabled&&!t.open&&!c.current&&(i.onPointerGraceIntentChange(null),c.current=window.setTimeout(()=>{t.onOpenChange(!0),g()},100))})),onPointerLeave:Lt(r.onPointerLeave,Jm(x=>{var S,T;g();const b=(S=t.content)==null?void 0:S.getBoundingClientRect();if(b){const E=(T=t.content)==null?void 0:T.dataset.side,C=E==="right",R=C?-5:5,A=b[C?"left":"right"],F=b[C?"right":"left"];i.onPointerGraceIntentChange({area:[{x:x.clientX+R,y:x.clientY},{x:A,y:b.top},{x:F,y:b.top},{x:F,y:b.bottom},{x:A,y:b.bottom}],side:E}),window.clearTimeout(d.current),d.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(x),x.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:Lt(r.onKeyDown,x=>{var S;const b=i.searchRef.current!=="";r.disabled||b&&x.key===" "||hV[n.dir].includes(x.key)&&(t.onOpenChange(!0),(S=t.content)==null||S.focus(),x.preventDefault())})})})});xP.displayName=bm;var wP="MenuSubContent",bP=w.forwardRef((r,e)=>{const t=sP(Di,r.__scopeMenu),{forceMount:n=t.forceMount,...s}=r,i=gd(Di,r.__scopeMenu),c=fg(Di,r.__scopeMenu),d=yP(wP,r.__scopeMenu),p=w.useRef(null),m=Ln(e,p);return u.jsx(Ym.Provider,{scope:r.__scopeMenu,children:u.jsx(ca,{present:n||i.open,children:u.jsx(Ym.Slot,{scope:r.__scopeMenu,children:u.jsx($S,{id:d.contentId,"aria-labelledby":d.triggerId,...s,ref:m,align:"start",side:c.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:g=>{var x;c.isUsingKeyboardRef.current&&((x=p.current)==null||x.focus()),g.preventDefault()},onCloseAutoFocus:g=>g.preventDefault(),onFocusOutside:Lt(r.onFocusOutside,g=>{g.target!==d.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:Lt(r.onEscapeKeyDown,g=>{c.onClose(),g.preventDefault()}),onKeyDown:Lt(r.onKeyDown,g=>{var S;const x=g.currentTarget.contains(g.target),b=pV[c.dir].includes(g.key);x&&b&&(i.onOpenChange(!1),(S=d.trigger)==null||S.focus(),g.preventDefault())})})})})})});bP.displayName=wP;function _P(r){return r?"open":"closed"}function Uy(r){return r==="indeterminate"}function HS(r){return Uy(r)?"indeterminate":r?"checked":"unchecked"}function FV(r){const e=document.activeElement;for(const t of r)if(t===e||(t.focus(),document.activeElement!==e))return}function OV(r,e){return r.map((t,n)=>r[(e+n)%r.length])}function DV(r,e,t){const s=e.length>1&&Array.from(e).every(m=>m===e[0])?e[0]:e,i=t?r.indexOf(t):-1;let c=OV(r,Math.max(i,0));s.length===1&&(c=c.filter(m=>m!==t));const p=c.find(m=>m.toLowerCase().startsWith(s.toLowerCase()));return p!==t?p:void 0}function LV(r,e){const{x:t,y:n}=r;let s=!1;for(let i=0,c=e.length-1;i<e.length;c=i++){const d=e[i],p=e[c],m=d.x,g=d.y,x=p.x,b=p.y;g>n!=b>n&&t<(x-m)*(n-g)/(b-g)+m&&(s=!s)}return s}function MV(r,e){if(!e)return!1;const t={x:r.clientX,y:r.clientY};return LV(t,e)}function Jm(r){return e=>e.pointerType==="mouse"?r(e):void 0}var $V=nP,UV=DS,zV=oP,HV=iP,BV=US,GV=aP,WV=y0,VV=cP,qV=dP,KV=hP,YV=mP,JV=gP,XV=vP,QV=xP,ZV=bP,x0="DropdownMenu",[eq]=Ja(x0,[tP]),fo=tP(),[tq,SP]=eq(x0),EP=r=>{const{__scopeDropdownMenu:e,children:t,dir:n,open:s,defaultOpen:i,onOpenChange:c,modal:d=!0}=r,p=fo(e),m=w.useRef(null),[g,x]=tu({prop:s,defaultProp:i??!1,onChange:c,caller:x0});return u.jsx(tq,{scope:e,triggerId:Gl(),triggerRef:m,contentId:Gl(),open:g,onOpenChange:x,onOpenToggle:w.useCallback(()=>x(b=>!b),[x]),modal:d,children:u.jsx($V,{...p,open:g,onOpenChange:x,dir:n,modal:d,children:t})})};EP.displayName=x0;var CP="DropdownMenuTrigger",kP=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,disabled:n=!1,...s}=r,i=SP(CP,t),c=fo(t);return u.jsx(UV,{asChild:!0,...c,children:u.jsx(Ur.button,{type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":n?"":void 0,disabled:n,...s,ref:eu(e,i.triggerRef),onPointerDown:Lt(r.onPointerDown,d=>{!n&&d.button===0&&d.ctrlKey===!1&&(i.onOpenToggle(),i.open||d.preventDefault())}),onKeyDown:Lt(r.onKeyDown,d=>{n||(["Enter"," "].includes(d.key)&&i.onOpenToggle(),d.key==="ArrowDown"&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(d.key)&&d.preventDefault())})})})});kP.displayName=CP;var rq="DropdownMenuPortal",NP=r=>{const{__scopeDropdownMenu:e,...t}=r,n=fo(e);return u.jsx(zV,{...n,...t})};NP.displayName=rq;var TP="DropdownMenuContent",RP=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=SP(TP,t),i=fo(t),c=w.useRef(!1);return u.jsx(HV,{id:s.contentId,"aria-labelledby":s.triggerId,...i,...n,ref:e,onCloseAutoFocus:Lt(r.onCloseAutoFocus,d=>{var p;c.current||(p=s.triggerRef.current)==null||p.focus(),c.current=!1,d.preventDefault()}),onInteractOutside:Lt(r.onInteractOutside,d=>{const p=d.detail.originalEvent,m=p.button===0&&p.ctrlKey===!0,g=p.button===2||m;(!s.modal||g)&&(c.current=!0)}),style:{...r.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});RP.displayName=TP;var nq="DropdownMenuGroup",sq=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=fo(t);return u.jsx(BV,{...s,...n,ref:e})});sq.displayName=nq;var oq="DropdownMenuLabel",AP=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=fo(t);return u.jsx(GV,{...s,...n,ref:e})});AP.displayName=oq;var iq="DropdownMenuItem",IP=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=fo(t);return u.jsx(WV,{...s,...n,ref:e})});IP.displayName=iq;var aq="DropdownMenuCheckboxItem",PP=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=fo(t);return u.jsx(VV,{...s,...n,ref:e})});PP.displayName=aq;var lq="DropdownMenuRadioGroup",cq=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=fo(t);return u.jsx(qV,{...s,...n,ref:e})});cq.displayName=lq;var uq="DropdownMenuRadioItem",jP=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=fo(t);return u.jsx(KV,{...s,...n,ref:e})});jP.displayName=uq;var dq="DropdownMenuItemIndicator",FP=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=fo(t);return u.jsx(YV,{...s,...n,ref:e})});FP.displayName=dq;var fq="DropdownMenuSeparator",OP=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=fo(t);return u.jsx(JV,{...s,...n,ref:e})});OP.displayName=fq;var hq="DropdownMenuArrow",pq=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=fo(t);return u.jsx(XV,{...s,...n,ref:e})});pq.displayName=hq;var mq="DropdownMenuSubTrigger",DP=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=fo(t);return u.jsx(QV,{...s,...n,ref:e})});DP.displayName=mq;var gq="DropdownMenuSubContent",LP=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=fo(t);return u.jsx(ZV,{...s,...n,ref:e,style:{...r.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});LP.displayName=gq;var vq=EP,yq=kP,xq=NP,MP=RP,$P=AP,UP=IP,zP=PP,HP=jP,BP=FP,GP=OP,WP=DP,VP=LP;const Ws=vq,Vs=yq,wq=w.forwardRef(({className:r,inset:e,children:t,...n},s)=>u.jsxs(WP,{ref:s,className:Fr("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",e&&"pl-8",r),...n,children:[t,u.jsx(ry,{className:"ml-auto h-4 w-4"})]}));wq.displayName=WP.displayName;const bq=w.forwardRef(({className:r,...e},t)=>u.jsx(VP,{ref:t,className:Fr("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in data-[side=bottom]:slide-in-from-top-1 data-[side=left]:slide-in-from-right-1 data-[side=right]:slide-in-from-left-1 data-[side=top]:slide-in-from-bottom-1",r),...e}));bq.displayName=VP.displayName;const _s=w.forwardRef(({className:r,sideOffset:e=4,...t},n)=>u.jsx(xq,{children:u.jsx(MP,{ref:n,sideOffset:e,className:Fr("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-white dark:bg-card p-1 text-neutral-950 dark:text-card-foreground shadow-md animate-in data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r),...t})}));_s.displayName=MP.displayName;const is=w.forwardRef(({className:r,inset:e,...t},n)=>u.jsx(UP,{ref:n,className:Fr("relative flex cursor-pointer select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors hover:bg-neutral-100 dark:hover:bg-muted focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 dark:text-gray-200",e&&"pl-8",r),...t}));is.displayName=UP.displayName;const _q=w.forwardRef(({className:r,children:e,checked:t,...n},s)=>u.jsxs(zP,{ref:s,className:Fr("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r),checked:t,...n,children:[u.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:u.jsx(BP,{children:u.jsx(uB,{className:"h-4 w-4"})})}),e]}));_q.displayName=zP.displayName;const Sq=w.forwardRef(({className:r,children:e,...t},n)=>u.jsxs(HP,{ref:n,className:Fr("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r),...t,children:[u.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:u.jsx(BP,{children:u.jsx("div",{className:"h-2 w-2 rounded-full bg-current"})})}),e]}));Sq.displayName=HP.displayName;const Eq=w.forwardRef(({className:r,inset:e,...t},n)=>u.jsx($P,{ref:n,className:Fr("px-2 py-1.5 text-sm font-semibold",e&&"pl-8",r),...t}));Eq.displayName=$P.displayName;const zy=w.forwardRef(({className:r,...e},t)=>u.jsx(GP,{ref:t,className:Fr("-mx-1 my-1 h-px bg-neutral-100",r),...e}));zy.displayName=GP.displayName;const Gs=({rows:r=2})=>u.jsx("div",{className:"p-1",children:u.jsx("table",{className:"w-full text-sm text-left text-gray-600 dark:text-gray-300",children:u.jsx("tbody",{children:Array.from({length:r}).map((e,t)=>u.jsxs("tr",{className:"bg-card animate-pulse",children:[u.jsx("td",{className:"py-2 px-3 whitespace-normal font-medium w-1/3",children:u.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-3/4"})}),u.jsx("td",{className:"py-2 px-3",children:u.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-full"})})]},t))})})}),Cq=({value:r,onChange:e,onSelect:t,suggestions:n,isLoading:s=!1,isValidating:i=!1,isValid:c=null,placeholder:d="Enter contact email",className:p="",disabled:m=!1})=>{const[g,x]=w.useState(0),b=w.useRef(null),S=w.useMemo(()=>{if(!r||r.length<2)return[];const P=r.toLowerCase();return n.filter(L=>{var G;return L.email.toLowerCase().includes(P)||((G=L.name)==null?void 0:G.toLowerCase().includes(P))}).slice(0,6)},[r,n]),T=S.length>0&&r.length>=2;w.useEffect(()=>{x(0)},[S]);const E=P=>P.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),C=(P,L)=>{if(!L)return P;const G=E(L),U=P.split(new RegExp(`(${G})`,"gi"));return u.jsx("span",{children:U.map((V,Q)=>V.toLowerCase()===L.toLowerCase()?u.jsx("span",{className:"font-semibold text-blue-600 dark:text-blue-400",children:V},Q):u.jsx("span",{children:V},Q))})},R=P=>{if(!T){P.key==="Enter"&&(P.preventDefault(),t(r));return}switch(P.key){case"ArrowDown":P.preventDefault(),x(L=>L<S.length-1?L+1:L);break;case"ArrowUp":P.preventDefault(),x(L=>L>0?L-1:L);break;case"Enter":P.preventDefault(),S[g]?A(S[g].email):t(r);break}},A=P=>{e(P),t(P)},F=()=>i?u.jsx(ii,{className:"w-4 h-4 animate-spin text-gray-400"}):c===!0?u.jsx(qc,{className:"w-4 h-4 text-green-600"}):c===!1?u.jsx(qm,{className:"w-4 h-4 text-red-600"}):null;return u.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[u.jsxs("div",{className:"relative w-full",children:[u.jsx(an,{ref:b,type:"email",value:r,onChange:P=>e(P.target.value),onKeyDown:R,placeholder:d,className:`pr-8 ${p} ${c===!1?"border-red-300 focus:ring-red-500":""}`,disabled:m}),u.jsx("div",{className:"absolute right-2 top-1/2 -translate-y-1/2 pointer-events-none",children:u.jsx(F,{})})]}),(T||s&&r.length>=2)&&u.jsx("div",{className:"w-full border border-gray-200 dark:border-gray-700 rounded-md max-h-[200px] overflow-y-auto bg-white dark:bg-gray-800",children:s?u.jsxs("div",{className:"flex items-center justify-center py-4",children:[u.jsx(ii,{className:"h-4 w-4 animate-spin text-gray-400"}),u.jsx("span",{className:"ml-2 text-xs text-gray-500",children:"Loading contacts..."})]}):u.jsx("div",{className:"py-1",children:S.map((P,L)=>u.jsx("div",{onClick:G=>{G.preventDefault(),G.stopPropagation(),A(P.email)},onMouseEnter:()=>x(L),className:`px-3 py-2 cursor-pointer transition-colors ${L===g?"bg-blue-50 dark:bg-blue-900/20":"hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:u.jsxs("div",{className:"flex flex-col w-full",children:[P.name&&u.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate",children:C(P.name,r)}),u.jsx("span",{className:`text-xs text-gray-600 dark:text-gray-400 truncate ${P.name?"":"text-sm font-medium text-gray-900 dark:text-gray-100"}`,children:C(P.email,r)})]})},P.email))})})]})},ed="src/shared/hooks/useFilevineContacts.ts";let La=null,Wv=null;const kq=1800*1e3,td=1e4;let Lc=null;function Nq(r="filevine"){const[e,t]=w.useState(La||[]),[n,s]=w.useState(!1),[i,c]=w.useState(null),d=zr(),p=w.useCallback(async()=>{if(La&&Wv&&Date.now()-Wv<kq)return La.length>td&&(d.warn("Cached contacts exceed size limit, truncating",{sourceFile:ed,actual:La.length,limit:td}),La=La.slice(0,td)),d.debug("Using cached contacts",{sourceFile:ed}),t(La),La;if(Lc){d.debug("Waiting for existing fetch request",{sourceFile:ed});try{const g=await Lc;return t(g),g}catch(g){throw c(g instanceof Error?g:new Error("Failed to fetch contacts")),g}}return s(!0),c(null),Lc=(async()=>{try{d.debug("Fetching all contacts from server",{sourceFile:ed});const g=await f8(d,r),x=[];g.clients&&Object.entries(g.clients).forEach(([S,T])=>{var R;const E=Array.isArray(T)?T:[],C=E==null?void 0:E[0];if(C){const A=C.fullName||void 0,F=((R=C.personTypes)==null?void 0:R[0])||void 0;x.push({email:S,name:A,role:F})}else x.push({email:S,name:void 0,role:void 0})}),x.sort((S,T)=>{var R,A;const E=((R=S.name)==null?void 0:R.toLowerCase())||S.email.toLowerCase(),C=((A=T.name)==null?void 0:A.toLowerCase())||T.email.toLowerCase();return E.localeCompare(C)}),d.debug(`Fetched ${x.length} contacts`,{sourceFile:ed,count:x.length});const b=x.length>td?x.slice(0,td):x;return x.length>td&&d.warn("Contact cache size exceeds limit, truncating",{sourceFile:ed,actual:x.length,limit:td}),La=b,Wv=Date.now(),t(b),s(!1),b}catch(g){const x=g instanceof Error?g:new Error("Failed to fetch contacts");throw d.error("Error fetching contacts",x,{sourceFile:ed}),c(x),s(!1),x}finally{Lc=null}})(),Lc},[r,d]);return{contacts:e,isLoading:n,error:i,loadContacts:p,refreshContacts:async()=>{if(Lc)try{await Lc}catch{}return La=null,Wv=null,Lc=null,p()}}}const Tq="src/sidepanel/panels/components/FilevineClientInfoBox.tsx",Rq=({clientEmail:r,emailParticipants:e,emailParticipantClients:t,tempClientEmail:n,setTempClientEmail:s,setIsManuallySet:i,isManuallySet:c,selectedClientDetails:d,isLoading:p,ClientNavigation:m,setClientEmail:g,isValidClient:x,isTempEmailValid:b,isValidating:S,isProjectManuallySelected:T=!1})=>{const E=zr(),{isConnected:C,initiateReconnection:R}=$i(),{platform:A}=un(),[F,P]=gr.useState(!1),{contacts:L,isLoading:G,loadContacts:U}=Nq("filevine");gr.useEffect(()=>{F&&L.length===0&&!G&&U()},[F,L.length,G,U]);const V=()=>u.jsx(Gs,{rows:2}),Q=()=>u.jsxs("div",{className:"p-4 text-center",children:[u.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-3",children:u.jsx(Jc,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"})}),u.jsx("p",{className:"text-sm font-medium text-gray-800 mb-2",children:"Gmail disconnected"}),u.jsx("p",{className:"text-xs text-gray-600 mb-4",children:"Connect Gmail to view email insights"}),u.jsxs(We,{onClick:async()=>{try{await R()}catch(fe){E.error("Failed to reconnect Gmail:",fe,{sourceFile:Tq})}},size:"sm",className:"bg-blue-600 hover:bg-blue-700 text-white text-xs px-4 py-2",children:[u.jsx(Do,{className:"h-3 w-3 mr-1"}),"Reconnect Gmail"]})]});return u.jsxs("div",{className:"w-full min-h-[4rem] border border-border/50 rounded-lg shadow-sm bg-card text-card-foreground",title:"Client Information",children:[u.jsxs("div",{className:"flex items-center justify-between p-2 border-b bg-muted",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(Iy,{className:"w-3.5 h-3.5 text-slate-600 dark:text-gray-300"}),u.jsx("span",{className:"font-medium text-sm text-slate-800 dark:text-white",children:"CONTACT"})]}),u.jsxs(Ws,{open:F,onOpenChange:P,children:[u.jsx(Vs,{asChild:!0,children:u.jsx(We,{variant:"ghost",size:"icon",className:"h-6 w-6",children:u.jsx(lo,{className:"h-4 w-4"})})}),u.jsx(_s,{align:"end",className:"p-3 w-80",children:u.jsx(Cq,{value:n||"",onChange:fe=>s(fe),onSelect:fe=>{g(fe,!0),P(!1)},suggestions:L,isLoading:G,isValidating:S,isValid:b,placeholder:"Search contact by email or name",className:"h-9 text-sm"})})]})]}),p?V():T?u.jsxs("div",{className:"p-4 text-center",children:[u.jsx(lo,{className:"w-8 h-8 mx-auto mb-2 text-gray-400"}),u.jsx("div",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Project Manually Selected"}),u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Search for a contact to view full client information"})]}):u.jsxs(u.Fragment,{children:[t.length>0&&!c&&u.jsx(m,{}),c&&r&&u.jsx("div",{className:"px-3 py-2 bg-gray-50 dark:bg-gray-800 border-b dark:border-gray-700",children:u.jsxs("div",{className:"flex flex-col",children:[(()=>{const fe=L.find(B=>B.email===r);return fe!=null&&fe.name?u.jsxs(u.Fragment,{children:[u.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate",children:fe.name}),u.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-400 truncate",children:r})]}):u.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate",children:r})})(),u.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5",children:"(Manually set)"})]})}),S&&e.length>0&&t.length===0&&!c?u.jsx(Gs,{rows:2}):d&&Object.keys(d).length>0?u.jsx(ru,{details:d}):A==="chrome"&&!C?Q():u.jsx("div",{className:"p-3 text-sm text-gray-600 dark:text-gray-400",children:u.jsx("p",{className:"mb-2",children:c&&r?`No contact information found for ${r}`:e.length>0&&t.length===0?`No contact information available for emails on the selected thread:
                        ${e.join(", ")}`:e.length>0?"No contact information available for the selected email ID":"Select a contact email thread to view contact information"})})]})]})};var w0="Collapsible",[Aq,qP]=Ja(w0),[Iq,BS]=Aq(w0),KP=w.forwardRef((r,e)=>{const{__scopeCollapsible:t,open:n,defaultOpen:s,disabled:i,onOpenChange:c,...d}=r,[p,m]=tu({prop:n,defaultProp:s??!1,onChange:c,caller:w0});return u.jsx(Iq,{scope:t,disabled:i,contentId:Gl(),open:p,onOpenToggle:w.useCallback(()=>m(g=>!g),[m]),children:u.jsx(Ur.div,{"data-state":WS(p),"data-disabled":i?"":void 0,...d,ref:e})})});KP.displayName=w0;var YP="CollapsibleTrigger",JP=w.forwardRef((r,e)=>{const{__scopeCollapsible:t,...n}=r,s=BS(YP,t);return u.jsx(Ur.button,{type:"button","aria-controls":s.contentId,"aria-expanded":s.open||!1,"data-state":WS(s.open),"data-disabled":s.disabled?"":void 0,disabled:s.disabled,...n,ref:e,onClick:Lt(r.onClick,s.onOpenToggle)})});JP.displayName=YP;var GS="CollapsibleContent",XP=w.forwardRef((r,e)=>{const{forceMount:t,...n}=r,s=BS(GS,r.__scopeCollapsible);return u.jsx(ca,{present:t||s.open,children:({present:i})=>u.jsx(Pq,{...n,ref:e,present:i})})});XP.displayName=GS;var Pq=w.forwardRef((r,e)=>{const{__scopeCollapsible:t,present:n,children:s,...i}=r,c=BS(GS,t),[d,p]=w.useState(n),m=w.useRef(null),g=Ln(e,m),x=w.useRef(0),b=x.current,S=w.useRef(0),T=S.current,E=c.open||d,C=w.useRef(E),R=w.useRef(void 0);return w.useEffect(()=>{const A=requestAnimationFrame(()=>C.current=!1);return()=>cancelAnimationFrame(A)},[]),Vl(()=>{const A=m.current;if(A){R.current=R.current||{transitionDuration:A.style.transitionDuration,animationName:A.style.animationName},A.style.transitionDuration="0s",A.style.animationName="none";const F=A.getBoundingClientRect();x.current=F.height,S.current=F.width,C.current||(A.style.transitionDuration=R.current.transitionDuration,A.style.animationName=R.current.animationName),p(n)}},[c.open,n]),u.jsx(Ur.div,{"data-state":WS(c.open),"data-disabled":c.disabled?"":void 0,id:c.contentId,hidden:!E,...i,ref:g,style:{"--radix-collapsible-content-height":b?`${b}px`:void 0,"--radix-collapsible-content-width":T?`${T}px`:void 0,...r.style},children:E&&s})});function WS(r){return r?"open":"closed"}var jq=KP,Fq=JP,Oq=XP,da="Accordion",Dq=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[VS,Lq,Mq]=FS(da),[b0]=Ja(da,[Mq,qP]),qS=qP(),QP=gr.forwardRef((r,e)=>{const{type:t,...n}=r,s=n,i=n;return u.jsx(VS.Provider,{scope:r.__scopeAccordion,children:t==="multiple"?u.jsx(Hq,{...i,ref:e}):u.jsx(zq,{...s,ref:e})})});QP.displayName=da;var[ZP,$q]=b0(da),[ej,Uq]=b0(da,{collapsible:!1}),zq=gr.forwardRef((r,e)=>{const{value:t,defaultValue:n,onValueChange:s=()=>{},collapsible:i=!1,...c}=r,[d,p]=tu({prop:t,defaultProp:n??"",onChange:s,caller:da});return u.jsx(ZP,{scope:r.__scopeAccordion,value:gr.useMemo(()=>d?[d]:[],[d]),onItemOpen:p,onItemClose:gr.useCallback(()=>i&&p(""),[i,p]),children:u.jsx(ej,{scope:r.__scopeAccordion,collapsible:i,children:u.jsx(tj,{...c,ref:e})})})}),Hq=gr.forwardRef((r,e)=>{const{value:t,defaultValue:n,onValueChange:s=()=>{},...i}=r,[c,d]=tu({prop:t,defaultProp:n??[],onChange:s,caller:da}),p=gr.useCallback(g=>d((x=[])=>[...x,g]),[d]),m=gr.useCallback(g=>d((x=[])=>x.filter(b=>b!==g)),[d]);return u.jsx(ZP,{scope:r.__scopeAccordion,value:c,onItemOpen:p,onItemClose:m,children:u.jsx(ej,{scope:r.__scopeAccordion,collapsible:!0,children:u.jsx(tj,{...i,ref:e})})})}),[Bq,_0]=b0(da),tj=gr.forwardRef((r,e)=>{const{__scopeAccordion:t,disabled:n,dir:s,orientation:i="vertical",...c}=r,d=gr.useRef(null),p=Ln(d,e),m=Lq(t),x=p0(s)==="ltr",b=Lt(r.onKeyDown,S=>{var V;if(!Dq.includes(S.key))return;const T=S.target,E=m().filter(Q=>{var fe;return!((fe=Q.ref.current)!=null&&fe.disabled)}),C=E.findIndex(Q=>Q.ref.current===T),R=E.length;if(C===-1)return;S.preventDefault();let A=C;const F=0,P=R-1,L=()=>{A=C+1,A>P&&(A=F)},G=()=>{A=C-1,A<F&&(A=P)};switch(S.key){case"Home":A=F;break;case"End":A=P;break;case"ArrowRight":i==="horizontal"&&(x?L():G());break;case"ArrowDown":i==="vertical"&&L();break;case"ArrowLeft":i==="horizontal"&&(x?G():L());break;case"ArrowUp":i==="vertical"&&G();break}const U=A%R;(V=E[U].ref.current)==null||V.focus()});return u.jsx(Bq,{scope:t,disabled:n,direction:s,orientation:i,children:u.jsx(VS.Slot,{scope:t,children:u.jsx(Ur.div,{...c,"data-orientation":i,ref:p,onKeyDown:n?void 0:b})})})}),Hy="AccordionItem",[Gq,KS]=b0(Hy),rj=gr.forwardRef((r,e)=>{const{__scopeAccordion:t,value:n,...s}=r,i=_0(Hy,t),c=$q(Hy,t),d=qS(t),p=Gl(),m=n&&c.value.includes(n)||!1,g=i.disabled||r.disabled;return u.jsx(Gq,{scope:t,open:m,disabled:g,triggerId:p,children:u.jsx(jq,{"data-orientation":i.orientation,"data-state":lj(m),...d,...s,ref:e,disabled:g,open:m,onOpenChange:x=>{x?c.onItemOpen(n):c.onItemClose(n)}})})});rj.displayName=Hy;var nj="AccordionHeader",sj=gr.forwardRef((r,e)=>{const{__scopeAccordion:t,...n}=r,s=_0(da,t),i=KS(nj,t);return u.jsx(Ur.h3,{"data-orientation":s.orientation,"data-state":lj(i.open),"data-disabled":i.disabled?"":void 0,...n,ref:e})});sj.displayName=nj;var Ab="AccordionTrigger",oj=gr.forwardRef((r,e)=>{const{__scopeAccordion:t,...n}=r,s=_0(da,t),i=KS(Ab,t),c=Uq(Ab,t),d=qS(t);return u.jsx(VS.ItemSlot,{scope:t,children:u.jsx(Fq,{"aria-disabled":i.open&&!c.collapsible||void 0,"data-orientation":s.orientation,id:i.triggerId,...d,...n,ref:e})})});oj.displayName=Ab;var ij="AccordionContent",aj=gr.forwardRef((r,e)=>{const{__scopeAccordion:t,...n}=r,s=_0(da,t),i=KS(ij,t),c=qS(t);return u.jsx(Oq,{role:"region","aria-labelledby":i.triggerId,"data-orientation":s.orientation,...c,...n,ref:e,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...r.style}})});aj.displayName=ij;function lj(r){return r?"open":"closed"}var Wq=QP,Vq=rj,qq=sj,cj=oj,uj=aj;const Kq=Wq,dj=w.forwardRef(({className:r,...e},t)=>u.jsx(Vq,{ref:t,className:Fr("border-b border-neutral-200 dark:border-border",r),...e}));dj.displayName="AccordionItem";const fj=w.forwardRef(({className:r,children:e,...t},n)=>u.jsx(qq,{className:"flex",children:u.jsxs(cj,{ref:n,className:Fr("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",r),...t,children:[e,u.jsx(ws,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})}));fj.displayName=cj.displayName;const hj=w.forwardRef(({className:r,children:e,...t},n)=>u.jsx(uj,{ref:n,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...t,children:u.jsx("div",{className:Fr("pb-4 pt-0",r),children:e})}));hj.displayName=uj.displayName;var _m={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */var Yq=_m.exports,wN;function Jq(){return wN||(wN=1,(function(r,e){(function(){var t,n="4.17.23",s=200,i="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",c="Expected a function",d="Invalid `variable` option passed into `_.template`",p="__lodash_hash_undefined__",m=500,g="__lodash_placeholder__",x=1,b=2,S=4,T=1,E=2,C=1,R=2,A=4,F=8,P=16,L=32,G=64,U=128,V=256,Q=512,fe=30,B="...",ee=800,ve=16,ce=1,ne=2,xe=3,J=1/0,X=9007199254740991,z=17976931348623157e292,q=NaN,O=4294967295,$=O-1,ae=O>>>1,be=[["ary",U],["bind",C],["bindKey",R],["curry",F],["curryRight",P],["flip",Q],["partial",L],["partialRight",G],["rearg",V]],ie="[object Arguments]",K="[object Array]",de="[object AsyncFunction]",ge="[object Boolean]",se="[object Date]",Te="[object DOMException]",qe="[object Error]",ze="[object Function]",Be="[object GeneratorFunction]",Ce="[object Map]",vt="[object Number]",kt="[object Null]",yt="[object Object]",At="[object Promise]",It="[object Proxy]",Yt="[object RegExp]",Xt="[object Set]",Or="[object String]",vr="[object Symbol]",dn="[object Undefined]",_e="[object WeakMap]",Fe="[object WeakSet]",nt="[object ArrayBuffer]",ft="[object DataView]",Ut="[object Float32Array]",Ue="[object Float64Array]",He="[object Int8Array]",Mt="[object Int16Array]",Ie="[object Int32Array]",St="[object Uint8Array]",ht="[object Uint8ClampedArray]",Ge="[object Uint16Array]",cr="[object Uint32Array]",zt=/\b__p \+= '';/g,yr=/\b(__p \+=) '' \+/g,tr=/(__e\(.*?\)|\b__t\)) \+\n'';/g,ar=/&(?:amp|lt|gt|quot|#39);/g,Jn=/[&<>"']/g,ls=RegExp(ar.source),qs=RegExp(Jn.source),ho=/<%-([\s\S]+?)%>/g,Er=/<%([\s\S]+?)%>/g,vn=/<%=([\s\S]+?)%>/g,Lo=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,cs=/^\w*$/,he=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ke=/[\\^$.*+?()[\]{}|]/g,_t=RegExp(Ke.source),pt=/^\s+/,tt=/\s/,ut=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,lt=/\{\n\/\* \[wrapped with (.+)\] \*/,Jt=/,? & /,Mn=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Wr=/[()=,{}\[\]\/\s]/,rr=/\\(\\)?/g,$n=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,po=/\w*$/,ui=/^[-+]0x[0-9a-f]+$/i,fa=/^0b[01]+$/i,Qa=/^\[object .+?Constructor\]$/,mt=/^0o[0-7]+$/i,te=/^(?:0|[1-9]\d*)$/,Le=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,st=/($^)/,jr=/['\n\r\u2028\u2029\\]/g,qt="\\ud800-\\udfff",Vr="\\u0300-\\u036f",fn="\\ufe20-\\ufe2f",ks="\\u20d0-\\u20ff",us=Vr+fn+ks,di="\\u2700-\\u27bf",qr="a-z\\xdf-\\xf6\\xf8-\\xff",fi="\\xac\\xb1\\xd7\\xf7",Un="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",vd="\\u2000-\\u206f",zn=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",nu="A-Z\\xc0-\\xd6\\xd8-\\xde",su="\\ufe0e\\ufe0f",Jl=fi+Un+vd+zn,mo="[']",Mo="["+qt+"]",go="["+Jl+"]",hi="["+us+"]",yd="\\d+",Ch="["+di+"]",Xl="["+qr+"]",ou="[^"+qt+Jl+yd+di+qr+nu+"]",Za="\\ud83c[\\udffb-\\udfff]",el="(?:"+hi+"|"+Za+")",xd="[^"+qt+"]",tl="(?:\\ud83c[\\udde6-\\uddff]){2}",ur="[\\ud800-\\udbff][\\udc00-\\udfff]",$o="["+nu+"]",iu="\\u200d",rl="(?:"+Xl+"|"+ou+")",wd="(?:"+$o+"|"+ou+")",au="(?:"+mo+"(?:d|ll|m|re|s|t|ve))?",lu="(?:"+mo+"(?:D|LL|M|RE|S|T|VE))?",Ql=el+"?",nl="["+su+"]?",pi="(?:"+iu+"(?:"+[xd,tl,ur].join("|")+")"+nl+Ql+")*",Uo="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",zo="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Se=nl+Ql+pi,$e="(?:"+[Ch,tl,ur].join("|")+")"+Se,Ve="(?:"+[xd+hi+"?",hi,tl,ur,Mo].join("|")+")",Pt=RegExp(mo,"g"),$t=RegExp(hi,"g"),Et=RegExp(Za+"(?="+Za+")|"+Ve+Se,"g"),ot=RegExp([$o+"?"+Xl+"+"+au+"(?="+[go,$o,"$"].join("|")+")",wd+"+"+lu+"(?="+[go,$o+rl,"$"].join("|")+")",$o+"?"+rl+"+"+au,$o+"+"+lu,zo,Uo,yd,$e].join("|"),"g"),ct=RegExp("["+iu+qt+us+su+"]"),An=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Ns=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],bd=-1,er={};er[Ut]=er[Ue]=er[He]=er[Mt]=er[Ie]=er[St]=er[ht]=er[Ge]=er[cr]=!0,er[ie]=er[K]=er[nt]=er[ge]=er[ft]=er[se]=er[qe]=er[ze]=er[Ce]=er[vt]=er[yt]=er[Yt]=er[Xt]=er[Or]=er[_e]=!1;var Cr={};Cr[ie]=Cr[K]=Cr[nt]=Cr[ft]=Cr[ge]=Cr[se]=Cr[Ut]=Cr[Ue]=Cr[He]=Cr[Mt]=Cr[Ie]=Cr[Ce]=Cr[vt]=Cr[yt]=Cr[Yt]=Cr[Xt]=Cr[Or]=Cr[vr]=Cr[St]=Cr[ht]=Cr[Ge]=Cr[cr]=!0,Cr[qe]=Cr[ze]=Cr[_e]=!1;var Ho={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},sl={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},_d={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},cu={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},kh=parseFloat,Sd=parseInt,Ed=typeof Cv=="object"&&Cv&&Cv.Object===Object&&Cv,hg=typeof self=="object"&&self&&self.Object===Object&&self,Qr=Ed||hg||Function("return this")(),uu=e&&!e.nodeType&&e,mi=uu&&!0&&r&&!r.nodeType&&r,Nh=mi&&mi.exports===uu,Zl=Nh&&Ed.process,ds=(function(){try{var le=mi&&mi.require&&mi.require("util").types;return le||Zl&&Zl.binding&&Zl.binding("util")}catch{}})(),Th=ds&&ds.isArrayBuffer,Ts=ds&&ds.isDate,ol=ds&&ds.isMap,Cd=ds&&ds.isRegExp,ec=ds&&ds.isSet,pg=ds&&ds.isTypedArray;function fs(le,ke,ye){switch(ye.length){case 0:return le.call(ke);case 1:return le.call(ke,ye[0]);case 2:return le.call(ke,ye[0],ye[1]);case 3:return le.call(ke,ye[0],ye[1],ye[2])}return le.apply(ke,ye)}function Rh(le,ke,ye,Qe){for(var Wt=-1,kr=le==null?0:le.length;++Wt<kr;){var yn=le[Wt];ke(Qe,yn,ye(yn),le)}return Qe}function Xn(le,ke){for(var ye=-1,Qe=le==null?0:le.length;++ye<Qe&&ke(le[ye],ye,le)!==!1;);return le}function kd(le,ke){for(var ye=le==null?0:le.length;ye--&&ke(le[ye],ye,le)!==!1;);return le}function Ah(le,ke){for(var ye=-1,Qe=le==null?0:le.length;++ye<Qe;)if(!ke(le[ye],ye,le))return!1;return!0}function ha(le,ke){for(var ye=-1,Qe=le==null?0:le.length,Wt=0,kr=[];++ye<Qe;){var yn=le[ye];ke(yn,ye,le)&&(kr[Wt++]=yn)}return kr}function Nd(le,ke){var ye=le==null?0:le.length;return!!ye&&tc(le,ke,0)>-1}function Ih(le,ke,ye){for(var Qe=-1,Wt=le==null?0:le.length;++Qe<Wt;)if(ye(ke,le[Qe]))return!0;return!1}function Hr(le,ke){for(var ye=-1,Qe=le==null?0:le.length,Wt=Array(Qe);++ye<Qe;)Wt[ye]=ke(le[ye],ye,le);return Wt}function pa(le,ke){for(var ye=-1,Qe=ke.length,Wt=le.length;++ye<Qe;)le[Wt+ye]=ke[ye];return le}function Ph(le,ke,ye,Qe){var Wt=-1,kr=le==null?0:le.length;for(Qe&&kr&&(ye=le[++Wt]);++Wt<kr;)ye=ke(ye,le[Wt],Wt,le);return ye}function S0(le,ke,ye,Qe){var Wt=le==null?0:le.length;for(Qe&&Wt&&(ye=le[--Wt]);Wt--;)ye=ke(ye,le[Wt],Wt,le);return ye}function jh(le,ke){for(var ye=-1,Qe=le==null?0:le.length;++ye<Qe;)if(ke(le[ye],ye,le))return!0;return!1}var E0=Oh("length");function mg(le){return le.split("")}function C0(le){return le.match(Mn)||[]}function gg(le,ke,ye){var Qe;return ye(le,function(Wt,kr,yn){if(ke(Wt,kr,yn))return Qe=kr,!1}),Qe}function Td(le,ke,ye,Qe){for(var Wt=le.length,kr=ye+(Qe?1:-1);Qe?kr--:++kr<Wt;)if(ke(le[kr],kr,le))return kr;return-1}function tc(le,ke,ye){return ke===ke?Id(le,ke,ye):Td(le,vg,ye)}function Fh(le,ke,ye,Qe){for(var Wt=ye-1,kr=le.length;++Wt<kr;)if(Qe(le[Wt],ke))return Wt;return-1}function vg(le){return le!==le}function yg(le,ke){var ye=le==null?0:le.length;return ye?Dh(le,ke)/ye:q}function Oh(le){return function(ke){return ke==null?t:ke[le]}}function Rd(le){return function(ke){return le==null?t:le[ke]}}function xg(le,ke,ye,Qe,Wt){return Wt(le,function(kr,yn,Dr){ye=Qe?(Qe=!1,kr):ke(ye,kr,yn,Dr)}),ye}function k0(le,ke){var ye=le.length;for(le.sort(ke);ye--;)le[ye]=le[ye].value;return le}function Dh(le,ke){for(var ye,Qe=-1,Wt=le.length;++Qe<Wt;){var kr=ke(le[Qe]);kr!==t&&(ye=ye===t?kr:ye+kr)}return ye}function Lh(le,ke){for(var ye=-1,Qe=Array(le);++ye<le;)Qe[ye]=ke(ye);return Qe}function N0(le,ke){return Hr(ke,function(ye){return[ye,le[ye]]})}function wg(le){return le&&le.slice(0,Pd(le)+1).replace(pt,"")}function Ks(le){return function(ke){return le(ke)}}function du(le,ke){return Hr(ke,function(ye){return le[ye]})}function Ui(le,ke){return le.has(ke)}function bg(le,ke){for(var ye=-1,Qe=le.length;++ye<Qe&&tc(ke,le[ye],0)>-1;);return ye}function Mh(le,ke){for(var ye=le.length;ye--&&tc(ke,le[ye],0)>-1;);return ye}function _g(le,ke){for(var ye=le.length,Qe=0;ye--;)le[ye]===ke&&++Qe;return Qe}var Sg=Rd(Ho),Eg=Rd(sl);function Cg(le){return"\\"+cu[le]}function rc(le,ke){return le==null?t:le[ke]}function nc(le){return ct.test(le)}function T0(le){return An.test(le)}function R0(le){for(var ke,ye=[];!(ke=le.next()).done;)ye.push(ke.value);return ye}function Ad(le){var ke=-1,ye=Array(le.size);return le.forEach(function(Qe,Wt){ye[++ke]=[Wt,Qe]}),ye}function $h(le,ke){return function(ye){return le(ke(ye))}}function vo(le,ke){for(var ye=-1,Qe=le.length,Wt=0,kr=[];++ye<Qe;){var yn=le[ye];(yn===ke||yn===g)&&(le[ye]=g,kr[Wt++]=ye)}return kr}function ma(le){var ke=-1,ye=Array(le.size);return le.forEach(function(Qe){ye[++ke]=Qe}),ye}function A0(le){var ke=-1,ye=Array(le.size);return le.forEach(function(Qe){ye[++ke]=[Qe,Qe]}),ye}function Id(le,ke,ye){for(var Qe=ye-1,Wt=le.length;++Qe<Wt;)if(le[Qe]===ke)return Qe;return-1}function I0(le,ke,ye){for(var Qe=ye+1;Qe--;)if(le[Qe]===ke)return Qe;return Qe}function il(le){return nc(le)?Ng(le):E0(le)}function Ys(le){return nc(le)?Tg(le):mg(le)}function Pd(le){for(var ke=le.length;ke--&&tt.test(le.charAt(ke)););return ke}var kg=Rd(_d);function Ng(le){for(var ke=Et.lastIndex=0;Et.test(le);)++ke;return ke}function Tg(le){return le.match(Et)||[]}function P0(le){return le.match(ot)||[]}var j0=(function le(ke){ke=ke==null?Qr:sc.defaults(Qr.Object(),ke,sc.pick(Qr,Ns));var ye=ke.Array,Qe=ke.Date,Wt=ke.Error,kr=ke.Function,yn=ke.Math,Dr=ke.Object,fu=ke.RegExp,F0=ke.String,yo=ke.TypeError,zi=ye.prototype,Uh=kr.prototype,gi=Dr.prototype,oc=ke["__core-js_shared__"],hu=Uh.toString,br=gi.hasOwnProperty,ic=0,jd=(function(){var l=/[^.]+$/.exec(oc&&oc.keys&&oc.keys.IE_PROTO||"");return l?"Symbol(src)_1."+l:""})(),pu=gi.toString,Fd=hu.call(Dr),Rg=Qr._,Ag=fu("^"+hu.call(br).replace(Ke,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),mu=Nh?ke.Buffer:t,Hi=ke.Symbol,gu=ke.Uint8Array,zh=mu?mu.allocUnsafe:t,Bo=$h(Dr.getPrototypeOf,Dr),Od=Dr.create,Dd=gi.propertyIsEnumerable,Ld=zi.splice,Ig=Hi?Hi.isConcatSpreadable:t,Bi=Hi?Hi.iterator:t,al=Hi?Hi.toStringTag:t,vu=(function(){try{var l=ka(Dr,"defineProperty");return l({},"",{}),l}catch{}})(),Pg=ke.clearTimeout!==Qr.clearTimeout&&ke.clearTimeout,Kr=Qe&&Qe.now!==Qr.Date.now&&Qe.now,Hh=ke.setTimeout!==Qr.setTimeout&&ke.setTimeout,ll=yn.ceil,ga=yn.floor,Md=Dr.getOwnPropertySymbols,Bh=mu?mu.isBuffer:t,ac=ke.isFinite,$d=zi.join,lc=$h(Dr.keys,Dr),xn=yn.max,Qn=yn.min,O0=Qe.now,jg=ke.parseInt,yu=yn.random,Ud=zi.reverse,xu=ka(ke,"DataView"),cl=ka(ke,"Map"),wu=ka(ke,"Promise"),va=ka(ke,"Set"),bu=ka(ke,"WeakMap"),cc=ka(Dr,"create"),zd=bu&&new bu,uc={},Gh=Na(xu),ya=Na(cl),Fg=Na(wu),dc=Na(va),vi=Na(bu),xa=Hi?Hi.prototype:t,Js=xa?xa.valueOf:t,Hd=xa?xa.toString:t;function D(l){if(bn(l)&&!Zt(l)&&!(l instanceof Qt)){if(l instanceof Zn)return l;if(br.call(l,"__wrapped__"))return lv(l)}return new Zn(l)}var fc=(function(){function l(){}return function(f){if(!mn(f))return{};if(Od)return Od(f);l.prototype=f;var y=new l;return l.prototype=t,y}})();function yi(){}function Zn(l,f){this.__wrapped__=l,this.__actions__=[],this.__chain__=!!f,this.__index__=0,this.__values__=t}D.templateSettings={escape:ho,evaluate:Er,interpolate:vn,variable:"",imports:{_:D}},D.prototype=yi.prototype,D.prototype.constructor=D,Zn.prototype=fc(yi.prototype),Zn.prototype.constructor=Zn;function Qt(l){this.__wrapped__=l,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=O,this.__views__=[]}function Bd(){var l=new Qt(this.__wrapped__);return l.__actions__=ps(this.__actions__),l.__dir__=this.__dir__,l.__filtered__=this.__filtered__,l.__iteratees__=ps(this.__iteratees__),l.__takeCount__=this.__takeCount__,l.__views__=ps(this.__views__),l}function Wh(){if(this.__filtered__){var l=new Qt(this);l.__dir__=-1,l.__filtered__=!0}else l=this.clone(),l.__dir__*=-1;return l}function hc(){var l=this.__wrapped__.value(),f=this.__dir__,y=Zt(l),k=f<0,I=y?l.length:0,M=xp(0,I,this.__views__),Y=M.start,re=M.end,ue=re-Y,Re=k?re:Y-1,Ae=this.__iteratees__,Oe=Ae.length,Ye=0,wt=Qn(ue,this.__takeCount__);if(!y||!k&&I==ue&&wt==ue)return bc(l,this.__actions__);var Bt=[];e:for(;ue--&&Ye<wt;){Re+=f;for(var lr=-1,Gt=l[Re];++lr<Oe;){var pr=Ae[lr],Sr=pr.iteratee,Zo=pr.type,to=Sr(Gt);if(Zo==ne)Gt=to;else if(!to){if(Zo==ce)continue e;break e}}Bt[Ye++]=Gt}return Bt}Qt.prototype=fc(yi.prototype),Qt.prototype.constructor=Qt;function Rs(l){var f=-1,y=l==null?0:l.length;for(this.clear();++f<y;){var k=l[f];this.set(k[0],k[1])}}function Yr(){this.__data__=cc?cc(null):{},this.size=0}function Br(l){var f=this.has(l)&&delete this.__data__[l];return this.size-=f?1:0,f}function wa(l){var f=this.__data__;if(cc){var y=f[l];return y===p?t:y}return br.call(f,l)?f[l]:t}function es(l){var f=this.__data__;return cc?f[l]!==t:br.call(f,l)}function As(l,f){var y=this.__data__;return this.size+=this.has(l)?0:1,y[l]=cc&&f===t?p:f,this}Rs.prototype.clear=Yr,Rs.prototype.delete=Br,Rs.prototype.get=wa,Rs.prototype.has=es,Rs.prototype.set=As;function hs(l){var f=-1,y=l==null?0:l.length;for(this.clear();++f<y;){var k=l[f];this.set(k[0],k[1])}}function pc(){this.__data__=[],this.size=0}function Is(l){var f=this.__data__,y=rs(f,l);if(y<0)return!1;var k=f.length-1;return y==k?f.pop():Ld.call(f,y,1),--this.size,!0}function Gd(l){var f=this.__data__,y=rs(f,l);return y<0?t:f[y][1]}function Og(l){return rs(this.__data__,l)>-1}function Dg(l,f){var y=this.__data__,k=rs(y,l);return k<0?(++this.size,y.push([l,f])):y[k][1]=f,this}hs.prototype.clear=pc,hs.prototype.delete=Is,hs.prototype.get=Gd,hs.prototype.has=Og,hs.prototype.set=Dg;function xo(l){var f=-1,y=l==null?0:l.length;for(this.clear();++f<y;){var k=l[f];this.set(k[0],k[1])}}function Lg(){this.size=0,this.__data__={hash:new Rs,map:new(cl||hs),string:new Rs}}function Gi(l){var f=Lu(this,l).delete(l);return this.size-=f?1:0,f}function Wd(l){return Lu(this,l).get(l)}function Vh(l){return Lu(this,l).has(l)}function Mg(l,f){var y=Lu(this,l),k=y.size;return y.set(l,f),this.size+=y.size==k?0:1,this}xo.prototype.clear=Lg,xo.prototype.delete=Gi,xo.prototype.get=Wd,xo.prototype.has=Vh,xo.prototype.set=Mg;function ul(l){var f=-1,y=l==null?0:l.length;for(this.__data__=new xo;++f<y;)this.add(l[f])}function ba(l){return this.__data__.set(l,p),this}function mc(l){return this.__data__.has(l)}ul.prototype.add=ul.prototype.push=ba,ul.prototype.has=mc;function ts(l){var f=this.__data__=new hs(l);this.size=f.size}function Vd(){this.__data__=new hs,this.size=0}function qd(l){var f=this.__data__,y=f.delete(l);return this.size=f.size,y}function wo(l){return this.__data__.get(l)}function bo(l){return this.__data__.has(l)}function dl(l,f){var y=this.__data__;if(y instanceof hs){var k=y.__data__;if(!cl||k.length<s-1)return k.push([l,f]),this.size=++y.size,this;y=this.__data__=new xo(k)}return y.set(l,f),this.size=y.size,this}ts.prototype.clear=Vd,ts.prototype.delete=qd,ts.prototype.get=wo,ts.prototype.has=bo,ts.prototype.set=dl;function xi(l,f){var y=Zt(l),k=!y&&Yu(l),I=!y&&!k&&Ic(l),M=!y&&!k&&!I&&Lf(l),Y=y||k||I||M,re=Y?Lh(l.length,F0):[],ue=re.length;for(var Re in l)(f||br.call(l,Re))&&!(Y&&(Re=="length"||I&&(Re=="offset"||Re=="parent")||M&&(Re=="buffer"||Re=="byteLength"||Re=="byteOffset")||en(Re,ue)))&&re.push(Re);return re}function wi(l){var f=l.length;return f?l[xc(0,f-1)]:t}function fl(l,f){return wf(ps(l),Wi(f,0,l.length))}function $g(l){return wf(ps(l))}function _u(l,f,y){(y!==t&&!ta(l[f],y)||y===t&&!(f in l))&&bi(l,f,y)}function hl(l,f,y){var k=l[f];(!(br.call(l,f)&&ta(k,y))||y===t&&!(f in l))&&bi(l,f,y)}function rs(l,f){for(var y=l.length;y--;)if(ta(l[y][0],f))return y;return-1}function Xs(l,f,y,k){return Si(l,function(I,M,Y){f(k,I,y(I),Y)}),k}function Jr(l,f){return l&&Wo(f,os(f),l)}function Go(l,f){return l&&Wo(f,Ao(f),l)}function bi(l,f,y){f=="__proto__"&&vu?vu(l,f,{configurable:!0,enumerable:!0,value:y,writable:!0}):l[f]=y}function Kd(l,f){for(var y=-1,k=f.length,I=ye(k),M=l==null;++y<k;)I[y]=M?t:ox(l,f[y]);return I}function Wi(l,f,y){return l===l&&(y!==t&&(l=l<=y?l:y),f!==t&&(l=l>=f?l:f)),l}function Ps(l,f,y,k,I,M){var Y,re=f&x,ue=f&b,Re=f&S;if(y&&(Y=I?y(l,k,I,M):y(l)),Y!==t)return Y;if(!mn(l))return l;var Ae=Zt(l);if(Ae){if(Y=$u(l),!re)return ps(l,Y)}else{var Oe=Gn(l),Ye=Oe==ze||Oe==Be;if(Ic(l))return ap(l,re);if(Oe==yt||Oe==ie||Ye&&!I){if(Y=ue||Ye?{}:Wn(l),!re)return ue?L0(l,Go(Y,l)):lf(l,Jr(Y,l))}else{if(!Cr[Oe])return I?l:{};Y=M0(l,Oe,re)}}M||(M=new ts);var wt=M.get(l);if(wt)return wt;M.set(l,Y),QS(l)?l.forEach(function(Gt){Y.add(Ps(Gt,f,y,Gt,l,M))}):JS(l)&&l.forEach(function(Gt,pr){Y.set(pr,Ps(Gt,f,y,pr,l,M))});var Bt=Re?ue?Du:Ou:ue?Ao:os,lr=Ae?t:Bt(l);return Xn(lr||l,function(Gt,pr){lr&&(pr=Gt,Gt=l[pr]),hl(Y,pr,Ps(Gt,f,y,pr,l,M))}),Y}function Ug(l){var f=os(l);return function(y){return Su(y,l,f)}}function Su(l,f,y){var k=y.length;if(l==null)return!k;for(l=Dr(l);k--;){var I=y[k],M=f[I],Y=l[I];if(Y===t&&!(I in l)||!M(Y))return!1}return!0}function qh(l,f,y){if(typeof l!="function")throw new yo(c);return Tc(function(){l.apply(t,y)},f)}function _i(l,f,y,k){var I=-1,M=Nd,Y=!0,re=l.length,ue=[],Re=f.length;if(!re)return ue;y&&(f=Hr(f,Ks(y))),k?(M=Ih,Y=!1):f.length>=s&&(M=Ui,Y=!1,f=new ul(f));e:for(;++I<re;){var Ae=l[I],Oe=y==null?Ae:y(Ae);if(Ae=k||Ae!==0?Ae:0,Y&&Oe===Oe){for(var Ye=Re;Ye--;)if(f[Ye]===Oe)continue e;ue.push(Ae)}else M(f,Oe,k)||ue.push(Ae)}return ue}var Si=ko(Qs),zg=ko(_a,!0);function Eu(l,f){var y=!0;return Si(l,function(k,I,M){return y=!!f(k,I,M),y}),y}function pl(l,f,y){for(var k=-1,I=l.length;++k<I;){var M=l[k],Y=f(M);if(Y!=null&&(re===t?Y===Y&&!Qo(Y):y(Y,re)))var re=Y,ue=M}return ue}function Hg(l,f,y,k){var I=l.length;for(y=sr(y),y<0&&(y=-y>I?0:I+y),k=k===t||k>I?I:sr(k),k<0&&(k+=I),k=y>k?0:eE(k);y<k;)l[y++]=f;return l}function Kh(l,f){var y=[];return Si(l,function(k,I,M){f(k,I,M)&&y.push(k)}),y}function cn(l,f,y,k,I){var M=-1,Y=l.length;for(y||(y=vf),I||(I=[]);++M<Y;){var re=l[M];f>0&&y(re)?f>1?cn(re,f-1,y,k,I):pa(I,re):k||(I[I.length]=re)}return I}var Yd=uf(),Cu=uf(!0);function Qs(l,f){return l&&Yd(l,f,os)}function _a(l,f){return l&&Cu(l,f,os)}function gc(l,f){return ha(f,function(y){return Nl(l[y])})}function Vi(l,f){f=ki(f,l);for(var y=0,k=f.length;l!=null&&y<k;)l=l[Yo(f[y++])];return y&&y==k?l:t}function Jd(l,f,y){var k=f(l);return Zt(l)?k:pa(k,y(l))}function Hn(l){return l==null?l===t?dn:kt:al&&al in Dr(l)?gf(l):bp(l)}function Sa(l,f){return l>f}function _o(l,f){return l!=null&&br.call(l,f)}function ml(l,f){return l!=null&&f in Dr(l)}function Yh(l,f,y){return l>=Qn(f,y)&&l<xn(f,y)}function Xd(l,f,y){for(var k=y?Ih:Nd,I=l[0].length,M=l.length,Y=M,re=ye(M),ue=1/0,Re=[];Y--;){var Ae=l[Y];Y&&f&&(Ae=Hr(Ae,Ks(f))),ue=Qn(Ae.length,ue),re[Y]=!y&&(f||I>=120&&Ae.length>=120)?new ul(Y&&Ae):t}Ae=l[0];var Oe=-1,Ye=re[0];e:for(;++Oe<I&&Re.length<ue;){var wt=Ae[Oe],Bt=f?f(wt):wt;if(wt=y||wt!==0?wt:0,!(Ye?Ui(Ye,Bt):k(Re,Bt,y))){for(Y=M;--Y;){var lr=re[Y];if(!(lr?Ui(lr,Bt):k(l[Y],Bt,y)))continue e}Ye&&Ye.push(Bt),Re.push(wt)}}return Re}function qi(l,f,y,k){return Qs(l,function(I,M,Y){f(k,y(I),M,Y)}),k}function So(l,f,y){f=ki(f,l),l=In(l,f);var k=l==null?l:l[Yo(vs(f))];return k==null?t:fs(k,l,y)}function Qd(l){return bn(l)&&Hn(l)==ie}function Bg(l){return bn(l)&&Hn(l)==nt}function Ki(l){return bn(l)&&Hn(l)==se}function Eo(l,f,y,k,I){return l===f?!0:l==null||f==null||!bn(l)&&!bn(f)?l!==l&&f!==f:Zd(l,f,y,k,Eo,I)}function Zd(l,f,y,k,I,M){var Y=Zt(l),re=Zt(f),ue=Y?K:Gn(l),Re=re?K:Gn(f);ue=ue==ie?yt:ue,Re=Re==ie?yt:Re;var Ae=ue==yt,Oe=Re==yt,Ye=ue==Re;if(Ye&&Ic(l)){if(!Ic(f))return!1;Y=!0,Ae=!1}if(Ye&&!Ae)return M||(M=new ts),Y||Lf(l)?vp(l,f,y,k,I,M):yp(l,f,ue,y,k,I,M);if(!(y&T)){var wt=Ae&&br.call(l,"__wrapped__"),Bt=Oe&&br.call(f,"__wrapped__");if(wt||Bt){var lr=wt?l.value():l,Gt=Bt?f.value():f;return M||(M=new ts),I(lr,Gt,y,k,M)}}return Ye?(M||(M=new ts),ev(l,f,y,k,I,M)):!1}function Gg(l){return bn(l)&&Gn(l)==Ce}function vc(l,f,y,k){var I=y.length,M=I,Y=!k;if(l==null)return!M;for(l=Dr(l);I--;){var re=y[I];if(Y&&re[2]?re[1]!==l[re[0]]:!(re[0]in l))return!1}for(;++I<M;){re=y[I];var ue=re[0],Re=l[ue],Ae=re[1];if(Y&&re[2]){if(Re===t&&!(ue in l))return!1}else{var Oe=new ts;if(k)var Ye=k(Re,Ae,ue,l,f,Oe);if(!(Ye===t?Eo(Ae,Re,T|E,k,Oe):Ye))return!1}}return!0}function Jh(l){if(!mn(l)||nv(l))return!1;var f=Nl(l)?Ag:Qa;return f.test(Na(l))}function ku(l){return bn(l)&&Hn(l)==Yt}function Ei(l){return bn(l)&&Gn(l)==Xt}function Nu(l){return bn(l)&&_v(l.length)&&!!er[Hn(l)]}function yc(l){return typeof l=="function"?l:l==null?Io:typeof l=="object"?Zt(l)?Zr(l[0],l[1]):ef(l):dE(l)}function Yi(l){if(!Zi(l))return lc(l);var f=[];for(var y in Dr(l))br.call(l,y)&&y!="constructor"&&f.push(y);return f}function Xh(l){if(!mn(l))return iv(l);var f=Zi(l),y=[];for(var k in l)k=="constructor"&&(f||!br.call(l,k))||y.push(k);return y}function Ea(l,f){return l<f}function Qh(l,f){var y=-1,k=Ro(l)?ye(l.length):[];return Si(l,function(I,M,Y){k[++y]=f(I,M,Y)}),k}function ef(l){var f=Mu(l);return f.length==1&&f[0][2]?yf(f[0][0],f[0][1]):function(y){return y===l||vc(y,l,f)}}function Zr(l,f){return it(l)&&zu(f)?yf(Yo(l),f):function(y){var k=ox(y,l);return k===t&&k===f?ix(y,l):Eo(f,k,T|E)}}function gl(l,f,y,k,I){l!==f&&Yd(f,function(M,Y){if(I||(I=new ts),mn(M))Zh(l,f,Y,y,gl,k,I);else{var re=k?k(Ri(l,Y),M,Y+"",l,f,I):t;re===t&&(re=M),_u(l,Y,re)}},Ao)}function Zh(l,f,y,k,I,M,Y){var re=Ri(l,y),ue=Ri(f,y),Re=Y.get(ue);if(Re){_u(l,y,Re);return}var Ae=M?M(re,ue,y+"",l,f,Y):t,Oe=Ae===t;if(Oe){var Ye=Zt(ue),wt=!Ye&&Ic(ue),Bt=!Ye&&!wt&&Lf(ue);Ae=ue,Ye||wt||Bt?Zt(re)?Ae=re:Cn(re)?Ae=ps(re):wt?(Oe=!1,Ae=ap(ue,!0)):Bt?(Oe=!1,Ae=Yg(ue,!0)):Ae=[]:$p(ue)||Yu(ue)?(Ae=re,Yu(re)?Ae=tE(re):(!mn(re)||Nl(re))&&(Ae=Wn(ue))):Oe=!1}Oe&&(Y.set(ue,Ae),I(Ae,ue,k,M,Y),Y.delete(ue)),_u(l,y,Ae)}function tf(l,f){var y=l.length;if(y)return f+=f<0?y:0,en(f,y)?l[f]:t}function Tu(l,f,y){f.length?f=Hr(f,function(M){return Zt(M)?function(Y){return Vi(Y,M.length===1?M[0]:M)}:M}):f=[Io];var k=-1;f=Hr(f,Ks(Dt()));var I=Qh(l,function(M,Y,re){var ue=Hr(f,function(Re){return Re(M)});return{criteria:ue,index:++k,value:M}});return k0(I,function(M,Y){return D0(M,Y,y)})}function ep(l,f){return Ca(l,f,function(y,k){return ix(l,k)})}function Ca(l,f,y){for(var k=-1,I=f.length,M={};++k<I;){var Y=f[k],re=Vi(l,Y);y(re,Y)&&yl(M,ki(Y,l),re)}return M}function rn(l){return function(f){return Vi(f,l)}}function hn(l,f,y,k){var I=k?Fh:tc,M=-1,Y=f.length,re=l;for(l===f&&(f=ps(f)),y&&(re=Hr(l,Ks(y)));++M<Y;)for(var ue=0,Re=f[M],Ae=y?y(Re):Re;(ue=I(re,Ae,ue,k))>-1;)re!==l&&Ld.call(re,ue,1),Ld.call(l,ue,1);return l}function Sn(l,f){for(var y=l?f.length:0,k=y-1;y--;){var I=f[y];if(y==k||I!==M){var M=I;en(I)?Ld.call(l,I,1):sf(l,I)}}return l}function xc(l,f){return l+ga(yu()*(f-l+1))}function Ru(l,f,y,k){for(var I=-1,M=xn(ll((f-l)/(y||1)),0),Y=ye(M);M--;)Y[k?M:++I]=l,l+=y;return Y}function vl(l,f){var y="";if(!l||f<1||f>X)return y;do f%2&&(y+=l),f=ga(f/2),f&&(l+=l);while(f);return y}function nr(l,f){return Zs(xf(l,f,Io),l+"")}function ns(l){return wi(Mf(l))}function tp(l,f){var y=Mf(l);return wf(y,Wi(f,0,y.length))}function yl(l,f,y,k){if(!mn(l))return l;f=ki(f,l);for(var I=-1,M=f.length,Y=M-1,re=l;re!=null&&++I<M;){var ue=Yo(f[I]),Re=y;if(ue==="__proto__"||ue==="constructor"||ue==="prototype")return l;if(I!=Y){var Ae=re[ue];Re=k?k(Ae,ue,re):t,Re===t&&(Re=mn(Ae)?Ae:en(f[I+1])?[]:{})}hl(re,ue,Re),re=re[ue]}return l}var rf=zd?function(l,f){return zd.set(l,f),l}:Io,Ci=vu?function(l,f){return vu(l,"toString",{configurable:!0,enumerable:!1,value:lx(f),writable:!0})}:Io;function Co(l){return wf(Mf(l))}function ss(l,f,y){var k=-1,I=l.length;f<0&&(f=-f>I?0:I+f),y=y>I?I:y,y<0&&(y+=I),I=f>y?0:y-f>>>0,f>>>=0;for(var M=ye(I);++k<I;)M[k]=l[k+f];return M}function rp(l,f){var y;return Si(l,function(k,I,M){return y=f(k,I,M),!y}),!!y}function wc(l,f,y){var k=0,I=l==null?k:l.length;if(typeof f=="number"&&f===f&&I<=ae){for(;k<I;){var M=k+I>>>1,Y=l[M];Y!==null&&!Qo(Y)&&(y?Y<=f:Y<f)?k=M+1:I=M}return I}return nf(l,f,Io,y)}function nf(l,f,y,k){var I=0,M=l==null?0:l.length;if(M===0)return 0;f=y(f);for(var Y=f!==f,re=f===null,ue=Qo(f),Re=f===t;I<M;){var Ae=ga((I+M)/2),Oe=y(l[Ae]),Ye=Oe!==t,wt=Oe===null,Bt=Oe===Oe,lr=Qo(Oe);if(Y)var Gt=k||Bt;else Re?Gt=Bt&&(k||Ye):re?Gt=Bt&&Ye&&(k||!wt):ue?Gt=Bt&&Ye&&!wt&&(k||!lr):wt||lr?Gt=!1:Gt=k?Oe<=f:Oe<f;Gt?I=Ae+1:M=Ae}return Qn(M,$)}function np(l,f){for(var y=-1,k=l.length,I=0,M=[];++y<k;){var Y=l[y],re=f?f(Y):Y;if(!y||!ta(re,ue)){var ue=re;M[I++]=Y===0?0:Y}}return M}function sp(l){return typeof l=="number"?l:Qo(l)?q:+l}function js(l){if(typeof l=="string")return l;if(Zt(l))return Hr(l,js)+"";if(Qo(l))return Hd?Hd.call(l):"";var f=l+"";return f=="0"&&1/l==-J?"-0":f}function Ji(l,f,y){var k=-1,I=Nd,M=l.length,Y=!0,re=[],ue=re;if(y)Y=!1,I=Ih;else if(M>=s){var Re=f?null:Zg(l);if(Re)return ma(Re);Y=!1,I=Ui,ue=new ul}else ue=f?[]:re;e:for(;++k<M;){var Ae=l[k],Oe=f?f(Ae):Ae;if(Ae=y||Ae!==0?Ae:0,Y&&Oe===Oe){for(var Ye=ue.length;Ye--;)if(ue[Ye]===Oe)continue e;f&&ue.push(Oe),re.push(Ae)}else I(ue,Oe,y)||(ue!==re&&ue.push(Oe),re.push(Ae))}return re}function sf(l,f){f=ki(f,l);var y=-1,k=f.length;if(!k)return!0;for(var I=l==null||typeof l!="object"&&typeof l!="function";++y<k;){var M=f[y];if(typeof M=="string"){if(M==="__proto__"&&!br.call(l,"__proto__"))return!1;if(M==="constructor"&&y+1<k&&typeof f[y+1]=="string"&&f[y+1]==="prototype"){if(I&&y===0)continue;return!1}}}var Y=In(l,f);return Y==null||delete Y[Yo(vs(f))]}function op(l,f,y,k){return yl(l,f,y(Vi(l,f)),k)}function Au(l,f,y,k){for(var I=l.length,M=k?I:-1;(k?M--:++M<I)&&f(l[M],M,l););return y?ss(l,k?0:M,k?M+1:I):ss(l,k?M+1:0,k?I:M)}function bc(l,f){var y=l;return y instanceof Qt&&(y=y.value()),Ph(f,function(k,I){return I.func.apply(I.thisArg,pa([k],I.args))},y)}function of(l,f,y){var k=l.length;if(k<2)return k?Ji(l[0]):[];for(var I=-1,M=ye(k);++I<k;)for(var Y=l[I],re=-1;++re<k;)re!=I&&(M[I]=_i(M[I]||Y,l[re],f,y));return Ji(cn(M,1),f,y)}function Iu(l,f,y){for(var k=-1,I=l.length,M=f.length,Y={};++k<I;){var re=k<M?f[k]:t;y(Y,l[k],re)}return Y}function _c(l){return Cn(l)?l:[]}function af(l){return typeof l=="function"?l:Io}function ki(l,f){return Zt(l)?l:it(l,f)?[l]:Ep(Lr(l))}var Wg=nr;function Xi(l,f,y){var k=l.length;return y=y===t?k:y,!f&&y>=k?l:ss(l,f,y)}var ip=Pg||function(l){return Qr.clearTimeout(l)};function ap(l,f){if(f)return l.slice();var y=l.length,k=zh?zh(y):new l.constructor(y);return l.copy(k),k}function Pu(l){var f=new l.constructor(l.byteLength);return new gu(f).set(new gu(l)),f}function Vg(l,f){var y=f?Pu(l.buffer):l.buffer;return new l.constructor(y,l.byteOffset,l.byteLength)}function qg(l){var f=new l.constructor(l.source,po.exec(l));return f.lastIndex=l.lastIndex,f}function Kg(l){return Js?Dr(Js.call(l)):{}}function Yg(l,f){var y=f?Pu(l.buffer):l.buffer;return new l.constructor(y,l.byteOffset,l.length)}function lp(l,f){if(l!==f){var y=l!==t,k=l===null,I=l===l,M=Qo(l),Y=f!==t,re=f===null,ue=f===f,Re=Qo(f);if(!re&&!Re&&!M&&l>f||M&&Y&&ue&&!re&&!Re||k&&Y&&ue||!y&&ue||!I)return 1;if(!k&&!M&&!Re&&l<f||Re&&y&&I&&!k&&!M||re&&y&&I||!Y&&I||!ue)return-1}return 0}function D0(l,f,y){for(var k=-1,I=l.criteria,M=f.criteria,Y=I.length,re=y.length;++k<Y;){var ue=lp(I[k],M[k]);if(ue){if(k>=re)return ue;var Re=y[k];return ue*(Re=="desc"?-1:1)}}return l.index-f.index}function Jg(l,f,y,k){for(var I=-1,M=l.length,Y=y.length,re=-1,ue=f.length,Re=xn(M-Y,0),Ae=ye(ue+Re),Oe=!k;++re<ue;)Ae[re]=f[re];for(;++I<Y;)(Oe||I<M)&&(Ae[y[I]]=l[I]);for(;Re--;)Ae[re++]=l[I++];return Ae}function cp(l,f,y,k){for(var I=-1,M=l.length,Y=-1,re=y.length,ue=-1,Re=f.length,Ae=xn(M-re,0),Oe=ye(Ae+Re),Ye=!k;++I<Ae;)Oe[I]=l[I];for(var wt=I;++ue<Re;)Oe[wt+ue]=f[ue];for(;++Y<re;)(Ye||I<M)&&(Oe[wt+y[Y]]=l[I++]);return Oe}function ps(l,f){var y=-1,k=l.length;for(f||(f=ye(k));++y<k;)f[y]=l[y];return f}function Wo(l,f,y,k){var I=!y;y||(y={});for(var M=-1,Y=f.length;++M<Y;){var re=f[M],ue=k?k(y[re],l[re],re,y,l):t;ue===t&&(ue=l[re]),I?bi(y,re,ue):hl(y,re,ue)}return y}function lf(l,f){return Wo(l,Vo(l),f)}function L0(l,f){return Wo(l,tv(l),f)}function cf(l,f){return function(y,k){var I=Zt(y)?Rh:Xs,M=f?f():{};return I(y,l,Dt(k,2),M)}}function Sc(l){return nr(function(f,y){var k=-1,I=y.length,M=I>1?y[I-1]:t,Y=I>2?y[2]:t;for(M=l.length>3&&typeof M=="function"?(I--,M):t,Y&&gs(y[0],y[1],Y)&&(M=I<3?t:M,I=1),f=Dr(f);++k<I;){var re=y[k];re&&l(f,re,k,M)}return f})}function ko(l,f){return function(y,k){if(y==null)return y;if(!Ro(y))return l(y,k);for(var I=y.length,M=f?I:-1,Y=Dr(y);(f?M--:++M<I)&&k(Y[M],M,Y)!==!1;);return y}}function uf(l){return function(f,y,k){for(var I=-1,M=Dr(f),Y=k(f),re=Y.length;re--;){var ue=Y[l?re:++I];if(y(M[ue],ue,M)===!1)break}return f}}function df(l,f,y){var k=f&C,I=Ec(l);function M(){var Y=this&&this!==Qr&&this instanceof M?I:l;return Y.apply(k?y:this,arguments)}return M}function up(l){return function(f){f=Lr(f);var y=nc(f)?Ys(f):t,k=y?y[0]:f.charAt(0),I=y?Xi(y,1).join(""):f.slice(1);return k[l]()+I}}function xl(l){return function(f){return Ph(cE(lE(f).replace(Pt,"")),l,"")}}function Ec(l){return function(){var f=arguments;switch(f.length){case 0:return new l;case 1:return new l(f[0]);case 2:return new l(f[0],f[1]);case 3:return new l(f[0],f[1],f[2]);case 4:return new l(f[0],f[1],f[2],f[3]);case 5:return new l(f[0],f[1],f[2],f[3],f[4]);case 6:return new l(f[0],f[1],f[2],f[3],f[4],f[5]);case 7:return new l(f[0],f[1],f[2],f[3],f[4],f[5],f[6])}var y=fc(l.prototype),k=l.apply(y,f);return mn(k)?k:y}}function dp(l,f,y){var k=Ec(l);function I(){for(var M=arguments.length,Y=ye(M),re=M,ue=Qi(I);re--;)Y[re]=arguments[re];var Re=M<3&&Y[0]!==ue&&Y[M-1]!==ue?[]:vo(Y,ue);if(M-=Re.length,M<y)return ms(l,f,Cc,I.placeholder,t,Y,Re,t,t,y-M);var Ae=this&&this!==Qr&&this instanceof I?k:l;return fs(Ae,this,Y)}return I}function wl(l){return function(f,y,k){var I=Dr(f);if(!Ro(f)){var M=Dt(y,3);f=os(f),y=function(re){return M(I[re],re,I)}}var Y=l(f,y,k);return Y>-1?I[M?f[Y]:Y]:t}}function ff(l){return Ti(function(f){var y=f.length,k=y,I=Zn.prototype.thru;for(l&&f.reverse();k--;){var M=f[k];if(typeof M!="function")throw new yo(c);if(I&&!Y&&kc(M)=="wrapper")var Y=new Zn([],!0)}for(k=Y?k:y;++k<y;){M=f[k];var re=kc(M),ue=re=="wrapper"?mf(M):t;ue&&Uu(ue[0])&&ue[1]==(U|F|L|V)&&!ue[4].length&&ue[9]==1?Y=Y[kc(ue[0])].apply(Y,ue[3]):Y=M.length==1&&Uu(M)?Y[re]():Y.thru(M)}return function(){var Re=arguments,Ae=Re[0];if(Y&&Re.length==1&&Zt(Ae))return Y.plant(Ae).value();for(var Oe=0,Ye=y?f[Oe].apply(this,Re):Ae;++Oe<y;)Ye=f[Oe].call(this,Ye);return Ye}})}function Cc(l,f,y,k,I,M,Y,re,ue,Re){var Ae=f&U,Oe=f&C,Ye=f&R,wt=f&(F|P),Bt=f&Q,lr=Ye?t:Ec(l);function Gt(){for(var pr=arguments.length,Sr=ye(pr),Zo=pr;Zo--;)Sr[Zo]=arguments[Zo];if(wt)var to=Qi(Gt),ei=_g(Sr,to);if(k&&(Sr=Jg(Sr,k,I,wt)),M&&(Sr=cp(Sr,M,Y,wt)),pr-=ei,wt&&pr<Re){var kn=vo(Sr,to);return ms(l,f,Cc,Gt.placeholder,y,Sr,kn,re,ue,Re-pr)}var ra=Oe?y:this,Rl=Ye?ra[l]:l;return pr=Sr.length,re?Sr=qo(Sr,re):Bt&&pr>1&&Sr.reverse(),Ae&&ue<pr&&(Sr.length=ue),this&&this!==Qr&&this instanceof Gt&&(Rl=lr||Ec(Rl)),Rl.apply(ra,Sr)}return Gt}function Xg(l,f){return function(y,k){return qi(y,l,f(k),{})}}function ju(l,f){return function(y,k){var I;if(y===t&&k===t)return f;if(y!==t&&(I=y),k!==t){if(I===t)return k;typeof y=="string"||typeof k=="string"?(y=js(y),k=js(k)):(y=sp(y),k=sp(k)),I=l(y,k)}return I}}function hf(l){return Ti(function(f){return f=Hr(f,Ks(Dt())),nr(function(y){var k=this;return l(f,function(I){return fs(I,k,y)})})})}function Fu(l,f){f=f===t?" ":js(f);var y=f.length;if(y<2)return y?vl(f,l):f;var k=vl(f,ll(l/il(f)));return nc(f)?Xi(Ys(k),0,l).join(""):k.slice(0,l)}function Qg(l,f,y,k){var I=f&C,M=Ec(l);function Y(){for(var re=-1,ue=arguments.length,Re=-1,Ae=k.length,Oe=ye(Ae+ue),Ye=this&&this!==Qr&&this instanceof Y?M:l;++Re<Ae;)Oe[Re]=k[Re];for(;ue--;)Oe[Re++]=arguments[++re];return fs(Ye,I?y:this,Oe)}return Y}function fp(l){return function(f,y,k){return k&&typeof k!="number"&&gs(f,y,k)&&(y=k=t),f=Tl(f),y===t?(y=f,f=0):y=Tl(y),k=k===t?f<y?1:-1:Tl(k),Ru(f,y,k,l)}}function pf(l){return function(f,y){return typeof f=="string"&&typeof y=="string"||(f=Ai(f),y=Ai(y)),l(f,y)}}function ms(l,f,y,k,I,M,Y,re,ue,Re){var Ae=f&F,Oe=Ae?Y:t,Ye=Ae?t:Y,wt=Ae?M:t,Bt=Ae?t:M;f|=Ae?L:G,f&=~(Ae?G:L),f&A||(f&=-4);var lr=[l,f,I,wt,Oe,Bt,Ye,re,ue,Re],Gt=y.apply(t,lr);return Uu(l)&&_p(Gt,lr),Gt.placeholder=k,Sp(Gt,l,f)}function Bn(l){var f=yn[l];return function(y,k){if(y=Ai(y),k=k==null?0:Qn(sr(k),292),k&&ac(y)){var I=(Lr(y)+"e").split("e"),M=f(I[0]+"e"+(+I[1]+k));return I=(Lr(M)+"e").split("e"),+(I[0]+"e"+(+I[1]-k))}return f(y)}}var Zg=va&&1/ma(new va([,-0]))[1]==J?function(l){return new va(l)}:dx;function hp(l){return function(f){var y=Gn(f);return y==Ce?Ad(f):y==Xt?A0(f):N0(f,l(f))}}function Ni(l,f,y,k,I,M,Y,re){var ue=f&R;if(!ue&&typeof l!="function")throw new yo(c);var Re=k?k.length:0;if(Re||(f&=-97,k=I=t),Y=Y===t?Y:xn(sr(Y),0),re=re===t?re:sr(re),Re-=I?I.length:0,f&G){var Ae=k,Oe=I;k=I=t}var Ye=ue?t:mf(l),wt=[l,f,y,k,I,Ae,Oe,M,Y,re];if(Ye&&ov(wt,Ye),l=wt[0],f=wt[1],y=wt[2],k=wt[3],I=wt[4],re=wt[9]=wt[9]===t?ue?0:l.length:xn(wt[9]-Re,0),!re&&f&(F|P)&&(f&=-25),!f||f==C)var Bt=df(l,f,y);else f==F||f==P?Bt=dp(l,f,re):(f==L||f==(C|L))&&!I.length?Bt=Qg(l,f,y,k):Bt=Cc.apply(t,wt);var lr=Ye?rf:_p;return Sp(lr(Bt,wt),l,f)}function pp(l,f,y,k){return l===t||ta(l,gi[y])&&!br.call(k,y)?f:l}function mp(l,f,y,k,I,M){return mn(l)&&mn(f)&&(M.set(f,l),gl(l,f,t,mp,M),M.delete(f)),l}function gp(l){return $p(l)?t:l}function vp(l,f,y,k,I,M){var Y=y&T,re=l.length,ue=f.length;if(re!=ue&&!(Y&&ue>re))return!1;var Re=M.get(l),Ae=M.get(f);if(Re&&Ae)return Re==f&&Ae==l;var Oe=-1,Ye=!0,wt=y&E?new ul:t;for(M.set(l,f),M.set(f,l);++Oe<re;){var Bt=l[Oe],lr=f[Oe];if(k)var Gt=Y?k(lr,Bt,Oe,f,l,M):k(Bt,lr,Oe,l,f,M);if(Gt!==t){if(Gt)continue;Ye=!1;break}if(wt){if(!jh(f,function(pr,Sr){if(!Ui(wt,Sr)&&(Bt===pr||I(Bt,pr,y,k,M)))return wt.push(Sr)})){Ye=!1;break}}else if(!(Bt===lr||I(Bt,lr,y,k,M))){Ye=!1;break}}return M.delete(l),M.delete(f),Ye}function yp(l,f,y,k,I,M,Y){switch(y){case ft:if(l.byteLength!=f.byteLength||l.byteOffset!=f.byteOffset)return!1;l=l.buffer,f=f.buffer;case nt:return!(l.byteLength!=f.byteLength||!M(new gu(l),new gu(f)));case ge:case se:case vt:return ta(+l,+f);case qe:return l.name==f.name&&l.message==f.message;case Yt:case Or:return l==f+"";case Ce:var re=Ad;case Xt:var ue=k&T;if(re||(re=ma),l.size!=f.size&&!ue)return!1;var Re=Y.get(l);if(Re)return Re==f;k|=E,Y.set(l,f);var Ae=vp(re(l),re(f),k,I,M,Y);return Y.delete(l),Ae;case vr:if(Js)return Js.call(l)==Js.call(f)}return!1}function ev(l,f,y,k,I,M){var Y=y&T,re=Ou(l),ue=re.length,Re=Ou(f),Ae=Re.length;if(ue!=Ae&&!Y)return!1;for(var Oe=ue;Oe--;){var Ye=re[Oe];if(!(Y?Ye in f:br.call(f,Ye)))return!1}var wt=M.get(l),Bt=M.get(f);if(wt&&Bt)return wt==f&&Bt==l;var lr=!0;M.set(l,f),M.set(f,l);for(var Gt=Y;++Oe<ue;){Ye=re[Oe];var pr=l[Ye],Sr=f[Ye];if(k)var Zo=Y?k(Sr,pr,Ye,f,l,M):k(pr,Sr,Ye,l,f,M);if(!(Zo===t?pr===Sr||I(pr,Sr,y,k,M):Zo)){lr=!1;break}Gt||(Gt=Ye=="constructor")}if(lr&&!Gt){var to=l.constructor,ei=f.constructor;to!=ei&&"constructor"in l&&"constructor"in f&&!(typeof to=="function"&&to instanceof to&&typeof ei=="function"&&ei instanceof ei)&&(lr=!1)}return M.delete(l),M.delete(f),lr}function Ti(l){return Zs(xf(l,t,_f),l+"")}function Ou(l){return Jd(l,os,Vo)}function Du(l){return Jd(l,Ao,tv)}var mf=zd?function(l){return zd.get(l)}:dx;function kc(l){for(var f=l.name+"",y=uc[f],k=br.call(uc,f)?y.length:0;k--;){var I=y[k],M=I.func;if(M==null||M==l)return I.name}return f}function Qi(l){var f=br.call(D,"placeholder")?D:l;return f.placeholder}function Dt(){var l=D.iteratee||cx;return l=l===cx?yc:l,arguments.length?l(arguments[0],arguments[1]):l}function Lu(l,f){var y=l.__data__;return Nc(f)?y[typeof f=="string"?"string":"hash"]:y.map}function Mu(l){for(var f=os(l),y=f.length;y--;){var k=f[y],I=l[k];f[y]=[k,I,zu(I)]}return f}function ka(l,f){var y=rc(l,f);return Jh(y)?y:t}function gf(l){var f=br.call(l,al),y=l[al];try{l[al]=t;var k=!0}catch{}var I=pu.call(l);return k&&(f?l[al]=y:delete l[al]),I}var Vo=Md?function(l){return l==null?[]:(l=Dr(l),ha(Md(l),function(f){return Dd.call(l,f)}))}:fx,tv=Md?function(l){for(var f=[];l;)pa(f,Vo(l)),l=Bo(l);return f}:fx,Gn=Hn;(xu&&Gn(new xu(new ArrayBuffer(1)))!=ft||cl&&Gn(new cl)!=Ce||wu&&Gn(wu.resolve())!=At||va&&Gn(new va)!=Xt||bu&&Gn(new bu)!=_e)&&(Gn=function(l){var f=Hn(l),y=f==yt?l.constructor:t,k=y?Na(y):"";if(k)switch(k){case Gh:return ft;case ya:return Ce;case Fg:return At;case dc:return Xt;case vi:return _e}return f});function xp(l,f,y){for(var k=-1,I=y.length;++k<I;){var M=y[k],Y=M.size;switch(M.type){case"drop":l+=Y;break;case"dropRight":f-=Y;break;case"take":f=Qn(f,l+Y);break;case"takeRight":l=xn(l,f-Y);break}}return{start:l,end:f}}function rv(l){var f=l.match(lt);return f?f[1].split(Jt):[]}function wp(l,f,y){f=ki(f,l);for(var k=-1,I=f.length,M=!1;++k<I;){var Y=Yo(f[k]);if(!(M=l!=null&&y(l,Y)))break;l=l[Y]}return M||++k!=I?M:(I=l==null?0:l.length,!!I&&_v(I)&&en(Y,I)&&(Zt(l)||Yu(l)))}function $u(l){var f=l.length,y=new l.constructor(f);return f&&typeof l[0]=="string"&&br.call(l,"index")&&(y.index=l.index,y.input=l.input),y}function Wn(l){return typeof l.constructor=="function"&&!Zi(l)?fc(Bo(l)):{}}function M0(l,f,y){var k=l.constructor;switch(f){case nt:return Pu(l);case ge:case se:return new k(+l);case ft:return Vg(l,y);case Ut:case Ue:case He:case Mt:case Ie:case St:case ht:case Ge:case cr:return Yg(l,y);case Ce:return new k;case vt:case Or:return new k(l);case Yt:return qg(l);case Xt:return new k;case vr:return Kg(l)}}function $0(l,f){var y=f.length;if(!y)return l;var k=y-1;return f[k]=(y>1?"& ":"")+f[k],f=f.join(y>2?", ":" "),l.replace(ut,`{
/* [wrapped with `+f+`] */
`)}function vf(l){return Zt(l)||Yu(l)||!!(Ig&&l&&l[Ig])}function en(l,f){var y=typeof l;return f=f??X,!!f&&(y=="number"||y!="symbol"&&te.test(l))&&l>-1&&l%1==0&&l<f}function gs(l,f,y){if(!mn(y))return!1;var k=typeof f;return(k=="number"?Ro(y)&&en(f,y.length):k=="string"&&f in y)?ta(y[f],l):!1}function it(l,f){if(Zt(l))return!1;var y=typeof l;return y=="number"||y=="symbol"||y=="boolean"||l==null||Qo(l)?!0:cs.test(l)||!Lo.test(l)||f!=null&&l in Dr(f)}function Nc(l){var f=typeof l;return f=="string"||f=="number"||f=="symbol"||f=="boolean"?l!=="__proto__":l===null}function Uu(l){var f=kc(l),y=D[f];if(typeof y!="function"||!(f in Qt.prototype))return!1;if(l===y)return!0;var k=mf(y);return!!k&&l===k[0]}function nv(l){return!!jd&&jd in l}var U0=oc?Nl:hx;function Zi(l){var f=l&&l.constructor,y=typeof f=="function"&&f.prototype||gi;return l===y}function zu(l){return l===l&&!mn(l)}function yf(l,f){return function(y){return y==null?!1:y[l]===f&&(f!==t||l in Dr(y))}}function sv(l){var f=me(l,function(k){return y.size===m&&y.clear(),k}),y=f.cache;return f}function ov(l,f){var y=l[1],k=f[1],I=y|k,M=I<(C|R|U),Y=k==U&&y==F||k==U&&y==V&&l[7].length<=f[8]||k==(U|V)&&f[7].length<=f[8]&&y==F;if(!(M||Y))return l;k&C&&(l[2]=f[2],I|=y&C?0:A);var re=f[3];if(re){var ue=l[3];l[3]=ue?Jg(ue,re,f[4]):re,l[4]=ue?vo(l[3],g):f[4]}return re=f[5],re&&(ue=l[5],l[5]=ue?cp(ue,re,f[6]):re,l[6]=ue?vo(l[5],g):f[6]),re=f[7],re&&(l[7]=re),k&U&&(l[8]=l[8]==null?f[8]:Qn(l[8],f[8])),l[9]==null&&(l[9]=f[9]),l[0]=f[0],l[1]=I,l}function iv(l){var f=[];if(l!=null)for(var y in Dr(l))f.push(y);return f}function bp(l){return pu.call(l)}function xf(l,f,y){return f=xn(f===t?l.length-1:f,0),function(){for(var k=arguments,I=-1,M=xn(k.length-f,0),Y=ye(M);++I<M;)Y[I]=k[f+I];I=-1;for(var re=ye(f+1);++I<f;)re[I]=k[I];return re[f]=y(Y),fs(l,this,re)}}function In(l,f){return f.length<2?l:Vi(l,ss(f,0,-1))}function qo(l,f){for(var y=l.length,k=Qn(f.length,y),I=ps(l);k--;){var M=f[k];l[k]=en(M,y)?I[M]:t}return l}function Ri(l,f){if(!(f==="constructor"&&typeof l[f]=="function")&&f!="__proto__")return l[f]}var _p=Ko(rf),Tc=Hh||function(l,f){return Qr.setTimeout(l,f)},Zs=Ko(Ci);function Sp(l,f,y){var k=f+"";return Zs(l,$0(k,av(rv(k),y)))}function Ko(l){var f=0,y=0;return function(){var k=O0(),I=ve-(k-y);if(y=k,I>0){if(++f>=ee)return arguments[0]}else f=0;return l.apply(t,arguments)}}function wf(l,f){var y=-1,k=l.length,I=k-1;for(f=f===t?k:f;++y<f;){var M=xc(y,I),Y=l[M];l[M]=l[y],l[y]=Y}return l.length=f,l}var Ep=sv(function(l){var f=[];return l.charCodeAt(0)===46&&f.push(""),l.replace(he,function(y,k,I,M){f.push(I?M.replace(rr,"$1"):k||y)}),f});function Yo(l){if(typeof l=="string"||Qo(l))return l;var f=l+"";return f=="0"&&1/l==-J?"-0":f}function Na(l){if(l!=null){try{return hu.call(l)}catch{}try{return l+""}catch{}}return""}function av(l,f){return Xn(be,function(y){var k="_."+y[0];f&y[1]&&!Nd(l,k)&&l.push(k)}),l.sort()}function lv(l){if(l instanceof Qt)return l.clone();var f=new Zn(l.__wrapped__,l.__chain__);return f.__actions__=ps(l.__actions__),f.__index__=l.__index__,f.__values__=l.__values__,f}function bf(l,f,y){(y?gs(l,f,y):f===t)?f=1:f=xn(sr(f),0);var k=l==null?0:l.length;if(!k||f<1)return[];for(var I=0,M=0,Y=ye(ll(k/f));I<k;)Y[M++]=ss(l,I,I+=f);return Y}function Cp(l){for(var f=-1,y=l==null?0:l.length,k=0,I=[];++f<y;){var M=l[f];M&&(I[k++]=M)}return I}function No(){var l=arguments.length;if(!l)return[];for(var f=ye(l-1),y=arguments[0],k=l;k--;)f[k-1]=arguments[k];return pa(Zt(y)?ps(y):[y],cn(f,1))}var _r=nr(function(l,f){return Cn(l)?_i(l,cn(f,1,Cn,!0)):[]}),Pn=nr(function(l,f){var y=vs(f);return Cn(y)&&(y=t),Cn(l)?_i(l,cn(f,1,Cn,!0),Dt(y,2)):[]}),wn=nr(function(l,f){var y=vs(f);return Cn(y)&&(y=t),Cn(l)?_i(l,cn(f,1,Cn,!0),t,y):[]});function Vn(l,f,y){var k=l==null?0:l.length;return k?(f=y||f===t?1:sr(f),ss(l,f<0?0:f,k)):[]}function eo(l,f,y){var k=l==null?0:l.length;return k?(f=y||f===t?1:sr(f),f=k-f,ss(l,0,f<0?0:f)):[]}function Rc(l,f){return l&&l.length?Au(l,Dt(f,3),!0,!0):[]}function En(l,f){return l&&l.length?Au(l,Dt(f,3),!0):[]}function Hu(l,f,y,k){var I=l==null?0:l.length;return I?(y&&typeof y!="number"&&gs(l,f,y)&&(y=0,k=I),Hg(l,f,y,k)):[]}function Ta(l,f,y){var k=l==null?0:l.length;if(!k)return-1;var I=y==null?0:sr(y);return I<0&&(I=xn(k+I,0)),Td(l,Dt(f,3),I)}function Bu(l,f,y){var k=l==null?0:l.length;if(!k)return-1;var I=k-1;return y!==t&&(I=sr(y),I=y<0?xn(k+I,0):Qn(I,k-1)),Td(l,Dt(f,3),I,!0)}function _f(l){var f=l==null?0:l.length;return f?cn(l,1):[]}function Gu(l){var f=l==null?0:l.length;return f?cn(l,J):[]}function Fs(l,f){var y=l==null?0:l.length;return y?(f=f===t?1:sr(f),cn(l,f)):[]}function kp(l){for(var f=-1,y=l==null?0:l.length,k={};++f<y;){var I=l[f];k[I[0]]=I[1]}return k}function bl(l){return l&&l.length?l[0]:t}function ea(l,f,y){var k=l==null?0:l.length;if(!k)return-1;var I=y==null?0:sr(y);return I<0&&(I=xn(k+I,0)),tc(l,f,I)}function Sf(l){var f=l==null?0:l.length;return f?ss(l,0,-1):[]}var Np=nr(function(l){var f=Hr(l,_c);return f.length&&f[0]===l[0]?Xd(f):[]}),Ra=nr(function(l){var f=vs(l),y=Hr(l,_c);return f===vs(y)?f=t:y.pop(),y.length&&y[0]===l[0]?Xd(y,Dt(f,2)):[]}),Ef=nr(function(l){var f=vs(l),y=Hr(l,_c);return f=typeof f=="function"?f:t,f&&y.pop(),y.length&&y[0]===l[0]?Xd(y,t,f):[]});function Aa(l,f){return l==null?"":$d.call(l,f)}function vs(l){var f=l==null?0:l.length;return f?l[f-1]:t}function Wu(l,f,y){var k=l==null?0:l.length;if(!k)return-1;var I=k;return y!==t&&(I=sr(y),I=I<0?xn(k+I,0):Qn(I,k-1)),f===f?I0(l,f,I):Td(l,vg,I,!0)}function Tp(l,f){return l&&l.length?tf(l,sr(f)):t}var Cf=nr(Vu);function Vu(l,f){return l&&l.length&&f&&f.length?hn(l,f):l}function ys(l,f,y){return l&&l.length&&f&&f.length?hn(l,f,Dt(y,2)):l}function Ia(l,f,y){return l&&l.length&&f&&f.length?hn(l,f,t,y):l}var Jo=Ti(function(l,f){var y=l==null?0:l.length,k=Kd(l,f);return Sn(l,Hr(f,function(I){return en(I,y)?+I:I}).sort(lp)),k});function Os(l,f){var y=[];if(!(l&&l.length))return y;var k=-1,I=[],M=l.length;for(f=Dt(f,3);++k<M;){var Y=l[k];f(Y,k,l)&&(y.push(Y),I.push(k))}return Sn(l,I),y}function kf(l){return l==null?l:Ud.call(l)}function Rp(l,f,y){var k=l==null?0:l.length;return k?(y&&typeof y!="number"&&gs(l,f,y)?(f=0,y=k):(f=f==null?0:sr(f),y=y===t?k:sr(y)),ss(l,f,y)):[]}function Ap(l,f){return wc(l,f)}function z0(l,f,y){return nf(l,f,Dt(y,2))}function Pa(l,f){var y=l==null?0:l.length;if(y){var k=wc(l,f);if(k<y&&ta(l[k],f))return k}return-1}function cv(l,f){return wc(l,f,!0)}function Ip(l,f,y){return nf(l,f,Dt(y,2),!0)}function _l(l,f){var y=l==null?0:l.length;if(y){var k=wc(l,f,!0)-1;if(ta(l[k],f))return k}return-1}function Pp(l){return l&&l.length?np(l):[]}function Sl(l,f){return l&&l.length?np(l,Dt(f,2)):[]}function uv(l){var f=l==null?0:l.length;return f?ss(l,1,f):[]}function dv(l,f,y){return l&&l.length?(f=y||f===t?1:sr(f),ss(l,0,f<0?0:f)):[]}function jp(l,f,y){var k=l==null?0:l.length;return k?(f=y||f===t?1:sr(f),f=k-f,ss(l,f<0?0:f,k)):[]}function Nf(l,f){return l&&l.length?Au(l,Dt(f,3),!1,!0):[]}function H0(l,f){return l&&l.length?Au(l,Dt(f,3)):[]}var B0=nr(function(l){return Ji(cn(l,1,Cn,!0))}),fv=nr(function(l){var f=vs(l);return Cn(f)&&(f=t),Ji(cn(l,1,Cn,!0),Dt(f,2))}),hv=nr(function(l){var f=vs(l);return f=typeof f=="function"?f:t,Ji(cn(l,1,Cn,!0),t,f)});function El(l){return l&&l.length?Ji(l):[]}function G0(l,f){return l&&l.length?Ji(l,Dt(f,2)):[]}function Ac(l,f){return f=typeof f=="function"?f:t,l&&l.length?Ji(l,t,f):[]}function Tf(l){if(!(l&&l.length))return[];var f=0;return l=ha(l,function(y){if(Cn(y))return f=xn(y.length,f),!0}),Lh(f,function(y){return Hr(l,Oh(y))})}function nn(l,f){if(!(l&&l.length))return[];var y=Tf(l);return f==null?y:Hr(y,function(k){return fs(f,t,k)})}var W0=nr(function(l,f){return Cn(l)?_i(l,f):[]}),pv=nr(function(l){return of(ha(l,Cn))}),V0=nr(function(l){var f=vs(l);return Cn(f)&&(f=t),of(ha(l,Cn),Dt(f,2))}),q0=nr(function(l){var f=vs(l);return f=typeof f=="function"?f:t,of(ha(l,Cn),t,f)}),mv=nr(Tf);function gv(l,f){return Iu(l||[],f||[],hl)}function K0(l,f){return Iu(l||[],f||[],yl)}var To=nr(function(l){var f=l.length,y=f>1?l[f-1]:t;return y=typeof y=="function"?(l.pop(),y):t,nn(l,y)});function Rf(l){var f=D(l);return f.__chain__=!0,f}function Y0(l,f){return f(l),l}function Xo(l,f){return f(l)}var Af=Ti(function(l){var f=l.length,y=f?l[0]:0,k=this.__wrapped__,I=function(M){return Kd(M,l)};return f>1||this.__actions__.length||!(k instanceof Qt)||!en(y)?this.thru(I):(k=k.slice(y,+y+(f?1:0)),k.__actions__.push({func:Xo,args:[I],thisArg:t}),new Zn(k,this.__chain__).thru(function(M){return f&&!M.length&&M.push(t),M}))});function Cl(){return Rf(this)}function If(){return new Zn(this.value(),this.__chain__)}function Fp(){this.__values__===t&&(this.__values__=ZS(this.value()));var l=this.__index__>=this.__values__.length,f=l?t:this.__values__[this.__index__++];return{done:l,value:f}}function Op(){return this}function J0(l){for(var f,y=this;y instanceof yi;){var k=lv(y);k.__index__=0,k.__values__=t,f?I.__wrapped__=k:f=k;var I=k;y=y.__wrapped__}return I.__wrapped__=l,f}function Dp(){var l=this.__wrapped__;if(l instanceof Qt){var f=l;return this.__actions__.length&&(f=new Qt(this)),f=f.reverse(),f.__actions__.push({func:Xo,args:[kf],thisArg:t}),new Zn(f,this.__chain__)}return this.thru(kf)}function X0(){return bc(this.__wrapped__,this.__actions__)}var vv=cf(function(l,f,y){br.call(l,y)?++l[y]:bi(l,y,1)});function yv(l,f,y){var k=Zt(l)?Ah:Eu;return y&&gs(l,f,y)&&(f=t),k(l,Dt(f,3))}function Pf(l,f){var y=Zt(l)?ha:Kh;return y(l,Dt(f,3))}var jf=wl(Ta),xv=wl(Bu);function Lp(l,f){return cn(kl(l,f),1)}function Q0(l,f){return cn(kl(l,f),J)}function wv(l,f,y){return y=y===t?1:sr(y),cn(kl(l,f),y)}function Ff(l,f){var y=Zt(l)?Xn:Si;return y(l,Dt(f,3))}function qu(l,f){var y=Zt(l)?kd:zg;return y(l,Dt(f,3))}var Mp=cf(function(l,f,y){br.call(l,y)?l[y].push(f):bi(l,y,[f])});function Of(l,f,y,k){l=Ro(l)?l:Mf(l),y=y&&!k?sr(y):0;var I=l.length;return y<0&&(y=xn(I+y,0)),Sv(l)?y<=I&&l.indexOf(f,y)>-1:!!I&&tc(l,f,y)>-1}var bv=nr(function(l,f,y){var k=-1,I=typeof f=="function",M=Ro(l)?ye(l.length):[];return Si(l,function(Y){M[++k]=I?fs(f,Y,y):So(Y,f,y)}),M}),Z0=cf(function(l,f,y){bi(l,y,f)});function kl(l,f){var y=Zt(l)?Hr:Qh;return y(l,Dt(f,3))}function ex(l,f,y,k){return l==null?[]:(Zt(f)||(f=f==null?[]:[f]),y=k?t:y,Zt(y)||(y=y==null?[]:[y]),Tu(l,f,y))}var Ku=cf(function(l,f,y){l[y?0:1].push(f)},function(){return[[],[]]});function tx(l,f,y){var k=Zt(l)?Ph:xg,I=arguments.length<3;return k(l,Dt(f,4),y,I,Si)}function Df(l,f,y){var k=Zt(l)?S0:xg,I=arguments.length<3;return k(l,Dt(f,4),y,I,zg)}function o(l,f){var y=Zt(l)?ha:Kh;return y(l,Me(Dt(f,3)))}function a(l){var f=Zt(l)?wi:ns;return f(l)}function h(l,f,y){(y?gs(l,f,y):f===t)?f=1:f=sr(f);var k=Zt(l)?fl:tp;return k(l,f)}function v(l){var f=Zt(l)?$g:Co;return f(l)}function _(l){if(l==null)return 0;if(Ro(l))return Sv(l)?il(l):l.length;var f=Gn(l);return f==Ce||f==Xt?l.size:Yi(l).length}function N(l,f,y){var k=Zt(l)?jh:rp;return y&&gs(l,f,y)&&(f=t),k(l,Dt(f,3))}var j=nr(function(l,f){if(l==null)return[];var y=f.length;return y>1&&gs(l,f[0],f[1])?f=[]:y>2&&gs(f[0],f[1],f[2])&&(f=[f[0]]),Tu(l,cn(f,1),[])}),W=Kr||function(){return Qr.Date.now()};function Z(l,f){if(typeof f!="function")throw new yo(c);return l=sr(l),function(){if(--l<1)return f.apply(this,arguments)}}function we(l,f,y){return f=y?t:f,f=l&&f==null?l.length:f,Ni(l,U,t,t,t,t,f)}function je(l,f){var y;if(typeof f!="function")throw new yo(c);return l=sr(l),function(){return--l>0&&(y=f.apply(this,arguments)),l<=1&&(f=t),y}}var De=nr(function(l,f,y){var k=C;if(y.length){var I=vo(y,Qi(De));k|=L}return Ni(l,k,f,y,I)}),Pe=nr(function(l,f,y){var k=C|R;if(y.length){var I=vo(y,Qi(Pe));k|=L}return Ni(f,k,l,y,I)});function Ze(l,f,y){f=y?t:f;var k=Ni(l,F,t,t,t,t,t,f);return k.placeholder=Ze.placeholder,k}function at(l,f,y){f=y?t:f;var k=Ni(l,P,t,t,t,t,t,f);return k.placeholder=at.placeholder,k}function dt(l,f,y){var k,I,M,Y,re,ue,Re=0,Ae=!1,Oe=!1,Ye=!0;if(typeof l!="function")throw new yo(c);f=Ai(f)||0,mn(y)&&(Ae=!!y.leading,Oe="maxWait"in y,M=Oe?xn(Ai(y.maxWait)||0,f):M,Ye="trailing"in y?!!y.trailing:Ye);function wt(kn){var ra=k,Rl=I;return k=I=t,Re=kn,Y=l.apply(Rl,ra),Y}function Bt(kn){return Re=kn,re=Tc(pr,f),Ae?wt(kn):Y}function lr(kn){var ra=kn-ue,Rl=kn-Re,fE=f-ra;return Oe?Qn(fE,M-Rl):fE}function Gt(kn){var ra=kn-ue,Rl=kn-Re;return ue===t||ra>=f||ra<0||Oe&&Rl>=M}function pr(){var kn=W();if(Gt(kn))return Sr(kn);re=Tc(pr,lr(kn))}function Sr(kn){return re=t,Ye&&k?wt(kn):(k=I=t,Y)}function Zo(){re!==t&&ip(re),Re=0,k=ue=I=re=t}function to(){return re===t?Y:Sr(W())}function ei(){var kn=W(),ra=Gt(kn);if(k=arguments,I=this,ue=kn,ra){if(re===t)return Bt(ue);if(Oe)return ip(re),re=Tc(pr,f),wt(ue)}return re===t&&(re=Tc(pr,f)),Y}return ei.cancel=Zo,ei.flush=to,ei}var pn=nr(function(l,f){return qh(l,1,f)}),pe=nr(function(l,f,y){return qh(l,Ai(f)||0,y)});function oe(l){return Ni(l,Q)}function me(l,f){if(typeof l!="function"||f!=null&&typeof f!="function")throw new yo(c);var y=function(){var k=arguments,I=f?f.apply(this,k):k[0],M=y.cache;if(M.has(I))return M.get(I);var Y=l.apply(this,k);return y.cache=M.set(I,Y)||M,Y};return y.cache=new(me.Cache||xo),y}me.Cache=xo;function Me(l){if(typeof l!="function")throw new yo(c);return function(){var f=arguments;switch(f.length){case 0:return!l.call(this);case 1:return!l.call(this,f[0]);case 2:return!l.call(this,f[0],f[1]);case 3:return!l.call(this,f[0],f[1],f[2])}return!l.apply(this,f)}}function gt(l){return je(2,l)}var jt=Wg(function(l,f){f=f.length==1&&Zt(f[0])?Hr(f[0],Ks(Dt())):Hr(cn(f,1),Ks(Dt()));var y=f.length;return nr(function(k){for(var I=-1,M=Qn(k.length,y);++I<M;)k[I]=f[I].call(this,k[I]);return fs(l,this,k)})}),Ct=nr(function(l,f){var y=vo(f,Qi(Ct));return Ni(l,L,t,f,y)}),Ht=nr(function(l,f){var y=vo(f,Qi(Ht));return Ni(l,G,t,f,y)}),jn=Ti(function(l,f){return Ni(l,V,t,t,t,f)});function Nr(l,f){if(typeof l!="function")throw new yo(c);return f=f===t?f:sr(f),nr(l,f)}function ja(l,f){if(typeof l!="function")throw new yo(c);return f=f==null?0:xn(sr(f),0),nr(function(y){var k=y[f],I=Xi(y,0,f);return k&&pa(I,k),fs(l,this,I)})}function rx(l,f,y){var k=!0,I=!0;if(typeof l!="function")throw new yo(c);return mn(y)&&(k="leading"in y?!!y.leading:k,I="trailing"in y?!!y.trailing:I),dt(l,f,{leading:k,maxWait:f,trailing:I})}function xj(l){return we(l,1)}function wj(l,f){return Ct(af(f),l)}function bj(){if(!arguments.length)return[];var l=arguments[0];return Zt(l)?l:[l]}function _j(l){return Ps(l,S)}function Sj(l,f){return f=typeof f=="function"?f:t,Ps(l,S,f)}function Ej(l){return Ps(l,x|S)}function Cj(l,f){return f=typeof f=="function"?f:t,Ps(l,x|S,f)}function kj(l,f){return f==null||Su(l,f,os(f))}function ta(l,f){return l===f||l!==l&&f!==f}var Nj=pf(Sa),Tj=pf(function(l,f){return l>=f}),Yu=Qd((function(){return arguments})())?Qd:function(l){return bn(l)&&br.call(l,"callee")&&!Dd.call(l,"callee")},Zt=ye.isArray,Rj=Th?Ks(Th):Bg;function Ro(l){return l!=null&&_v(l.length)&&!Nl(l)}function Cn(l){return bn(l)&&Ro(l)}function Aj(l){return l===!0||l===!1||bn(l)&&Hn(l)==ge}var Ic=Bh||hx,Ij=Ts?Ks(Ts):Ki;function Pj(l){return bn(l)&&l.nodeType===1&&!$p(l)}function jj(l){if(l==null)return!0;if(Ro(l)&&(Zt(l)||typeof l=="string"||typeof l.splice=="function"||Ic(l)||Lf(l)||Yu(l)))return!l.length;var f=Gn(l);if(f==Ce||f==Xt)return!l.size;if(Zi(l))return!Yi(l).length;for(var y in l)if(br.call(l,y))return!1;return!0}function Fj(l,f){return Eo(l,f)}function Oj(l,f,y){y=typeof y=="function"?y:t;var k=y?y(l,f):t;return k===t?Eo(l,f,t,y):!!k}function nx(l){if(!bn(l))return!1;var f=Hn(l);return f==qe||f==Te||typeof l.message=="string"&&typeof l.name=="string"&&!$p(l)}function Dj(l){return typeof l=="number"&&ac(l)}function Nl(l){if(!mn(l))return!1;var f=Hn(l);return f==ze||f==Be||f==de||f==It}function YS(l){return typeof l=="number"&&l==sr(l)}function _v(l){return typeof l=="number"&&l>-1&&l%1==0&&l<=X}function mn(l){var f=typeof l;return l!=null&&(f=="object"||f=="function")}function bn(l){return l!=null&&typeof l=="object"}var JS=ol?Ks(ol):Gg;function Lj(l,f){return l===f||vc(l,f,Mu(f))}function Mj(l,f,y){return y=typeof y=="function"?y:t,vc(l,f,Mu(f),y)}function $j(l){return XS(l)&&l!=+l}function Uj(l){if(U0(l))throw new Wt(i);return Jh(l)}function zj(l){return l===null}function Hj(l){return l==null}function XS(l){return typeof l=="number"||bn(l)&&Hn(l)==vt}function $p(l){if(!bn(l)||Hn(l)!=yt)return!1;var f=Bo(l);if(f===null)return!0;var y=br.call(f,"constructor")&&f.constructor;return typeof y=="function"&&y instanceof y&&hu.call(y)==Fd}var sx=Cd?Ks(Cd):ku;function Bj(l){return YS(l)&&l>=-X&&l<=X}var QS=ec?Ks(ec):Ei;function Sv(l){return typeof l=="string"||!Zt(l)&&bn(l)&&Hn(l)==Or}function Qo(l){return typeof l=="symbol"||bn(l)&&Hn(l)==vr}var Lf=pg?Ks(pg):Nu;function Gj(l){return l===t}function Wj(l){return bn(l)&&Gn(l)==_e}function Vj(l){return bn(l)&&Hn(l)==Fe}var qj=pf(Ea),Kj=pf(function(l,f){return l<=f});function ZS(l){if(!l)return[];if(Ro(l))return Sv(l)?Ys(l):ps(l);if(Bi&&l[Bi])return R0(l[Bi]());var f=Gn(l),y=f==Ce?Ad:f==Xt?ma:Mf;return y(l)}function Tl(l){if(!l)return l===0?l:0;if(l=Ai(l),l===J||l===-J){var f=l<0?-1:1;return f*z}return l===l?l:0}function sr(l){var f=Tl(l),y=f%1;return f===f?y?f-y:f:0}function eE(l){return l?Wi(sr(l),0,O):0}function Ai(l){if(typeof l=="number")return l;if(Qo(l))return q;if(mn(l)){var f=typeof l.valueOf=="function"?l.valueOf():l;l=mn(f)?f+"":f}if(typeof l!="string")return l===0?l:+l;l=wg(l);var y=fa.test(l);return y||mt.test(l)?Sd(l.slice(2),y?2:8):ui.test(l)?q:+l}function tE(l){return Wo(l,Ao(l))}function Yj(l){return l?Wi(sr(l),-X,X):l===0?l:0}function Lr(l){return l==null?"":js(l)}var Jj=Sc(function(l,f){if(Zi(f)||Ro(f)){Wo(f,os(f),l);return}for(var y in f)br.call(f,y)&&hl(l,y,f[y])}),rE=Sc(function(l,f){Wo(f,Ao(f),l)}),Ev=Sc(function(l,f,y,k){Wo(f,Ao(f),l,k)}),Xj=Sc(function(l,f,y,k){Wo(f,os(f),l,k)}),Qj=Ti(Kd);function Zj(l,f){var y=fc(l);return f==null?y:Jr(y,f)}var eF=nr(function(l,f){l=Dr(l);var y=-1,k=f.length,I=k>2?f[2]:t;for(I&&gs(f[0],f[1],I)&&(k=1);++y<k;)for(var M=f[y],Y=Ao(M),re=-1,ue=Y.length;++re<ue;){var Re=Y[re],Ae=l[Re];(Ae===t||ta(Ae,gi[Re])&&!br.call(l,Re))&&(l[Re]=M[Re])}return l}),tF=nr(function(l){return l.push(t,mp),fs(nE,t,l)});function rF(l,f){return gg(l,Dt(f,3),Qs)}function nF(l,f){return gg(l,Dt(f,3),_a)}function sF(l,f){return l==null?l:Yd(l,Dt(f,3),Ao)}function oF(l,f){return l==null?l:Cu(l,Dt(f,3),Ao)}function iF(l,f){return l&&Qs(l,Dt(f,3))}function aF(l,f){return l&&_a(l,Dt(f,3))}function lF(l){return l==null?[]:gc(l,os(l))}function cF(l){return l==null?[]:gc(l,Ao(l))}function ox(l,f,y){var k=l==null?t:Vi(l,f);return k===t?y:k}function uF(l,f){return l!=null&&wp(l,f,_o)}function ix(l,f){return l!=null&&wp(l,f,ml)}var dF=Xg(function(l,f,y){f!=null&&typeof f.toString!="function"&&(f=pu.call(f)),l[f]=y},lx(Io)),fF=Xg(function(l,f,y){f!=null&&typeof f.toString!="function"&&(f=pu.call(f)),br.call(l,f)?l[f].push(y):l[f]=[y]},Dt),hF=nr(So);function os(l){return Ro(l)?xi(l):Yi(l)}function Ao(l){return Ro(l)?xi(l,!0):Xh(l)}function pF(l,f){var y={};return f=Dt(f,3),Qs(l,function(k,I,M){bi(y,f(k,I,M),k)}),y}function mF(l,f){var y={};return f=Dt(f,3),Qs(l,function(k,I,M){bi(y,I,f(k,I,M))}),y}var gF=Sc(function(l,f,y){gl(l,f,y)}),nE=Sc(function(l,f,y,k){gl(l,f,y,k)}),vF=Ti(function(l,f){var y={};if(l==null)return y;var k=!1;f=Hr(f,function(M){return M=ki(M,l),k||(k=M.length>1),M}),Wo(l,Du(l),y),k&&(y=Ps(y,x|b|S,gp));for(var I=f.length;I--;)sf(y,f[I]);return y});function yF(l,f){return sE(l,Me(Dt(f)))}var xF=Ti(function(l,f){return l==null?{}:ep(l,f)});function sE(l,f){if(l==null)return{};var y=Hr(Du(l),function(k){return[k]});return f=Dt(f),Ca(l,y,function(k,I){return f(k,I[0])})}function wF(l,f,y){f=ki(f,l);var k=-1,I=f.length;for(I||(I=1,l=t);++k<I;){var M=l==null?t:l[Yo(f[k])];M===t&&(k=I,M=y),l=Nl(M)?M.call(l):M}return l}function bF(l,f,y){return l==null?l:yl(l,f,y)}function _F(l,f,y,k){return k=typeof k=="function"?k:t,l==null?l:yl(l,f,y,k)}var oE=hp(os),iE=hp(Ao);function SF(l,f,y){var k=Zt(l),I=k||Ic(l)||Lf(l);if(f=Dt(f,4),y==null){var M=l&&l.constructor;I?y=k?new M:[]:mn(l)?y=Nl(M)?fc(Bo(l)):{}:y={}}return(I?Xn:Qs)(l,function(Y,re,ue){return f(y,Y,re,ue)}),y}function EF(l,f){return l==null?!0:sf(l,f)}function CF(l,f,y){return l==null?l:op(l,f,af(y))}function kF(l,f,y,k){return k=typeof k=="function"?k:t,l==null?l:op(l,f,af(y),k)}function Mf(l){return l==null?[]:du(l,os(l))}function NF(l){return l==null?[]:du(l,Ao(l))}function TF(l,f,y){return y===t&&(y=f,f=t),y!==t&&(y=Ai(y),y=y===y?y:0),f!==t&&(f=Ai(f),f=f===f?f:0),Wi(Ai(l),f,y)}function RF(l,f,y){return f=Tl(f),y===t?(y=f,f=0):y=Tl(y),l=Ai(l),Yh(l,f,y)}function AF(l,f,y){if(y&&typeof y!="boolean"&&gs(l,f,y)&&(f=y=t),y===t&&(typeof f=="boolean"?(y=f,f=t):typeof l=="boolean"&&(y=l,l=t)),l===t&&f===t?(l=0,f=1):(l=Tl(l),f===t?(f=l,l=0):f=Tl(f)),l>f){var k=l;l=f,f=k}if(y||l%1||f%1){var I=yu();return Qn(l+I*(f-l+kh("1e-"+((I+"").length-1))),f)}return xc(l,f)}var IF=xl(function(l,f,y){return f=f.toLowerCase(),l+(y?aE(f):f)});function aE(l){return ax(Lr(l).toLowerCase())}function lE(l){return l=Lr(l),l&&l.replace(Le,Sg).replace($t,"")}function PF(l,f,y){l=Lr(l),f=js(f);var k=l.length;y=y===t?k:Wi(sr(y),0,k);var I=y;return y-=f.length,y>=0&&l.slice(y,I)==f}function jF(l){return l=Lr(l),l&&qs.test(l)?l.replace(Jn,Eg):l}function FF(l){return l=Lr(l),l&&_t.test(l)?l.replace(Ke,"\\$&"):l}var OF=xl(function(l,f,y){return l+(y?"-":"")+f.toLowerCase()}),DF=xl(function(l,f,y){return l+(y?" ":"")+f.toLowerCase()}),LF=up("toLowerCase");function MF(l,f,y){l=Lr(l),f=sr(f);var k=f?il(l):0;if(!f||k>=f)return l;var I=(f-k)/2;return Fu(ga(I),y)+l+Fu(ll(I),y)}function $F(l,f,y){l=Lr(l),f=sr(f);var k=f?il(l):0;return f&&k<f?l+Fu(f-k,y):l}function UF(l,f,y){l=Lr(l),f=sr(f);var k=f?il(l):0;return f&&k<f?Fu(f-k,y)+l:l}function zF(l,f,y){return y||f==null?f=0:f&&(f=+f),jg(Lr(l).replace(pt,""),f||0)}function HF(l,f,y){return(y?gs(l,f,y):f===t)?f=1:f=sr(f),vl(Lr(l),f)}function BF(){var l=arguments,f=Lr(l[0]);return l.length<3?f:f.replace(l[1],l[2])}var GF=xl(function(l,f,y){return l+(y?"_":"")+f.toLowerCase()});function WF(l,f,y){return y&&typeof y!="number"&&gs(l,f,y)&&(f=y=t),y=y===t?O:y>>>0,y?(l=Lr(l),l&&(typeof f=="string"||f!=null&&!sx(f))&&(f=js(f),!f&&nc(l))?Xi(Ys(l),0,y):l.split(f,y)):[]}var VF=xl(function(l,f,y){return l+(y?" ":"")+ax(f)});function qF(l,f,y){return l=Lr(l),y=y==null?0:Wi(sr(y),0,l.length),f=js(f),l.slice(y,y+f.length)==f}function KF(l,f,y){var k=D.templateSettings;y&&gs(l,f,y)&&(f=t),l=Lr(l),f=Ev({},f,k,pp);var I=Ev({},f.imports,k.imports,pp),M=os(I),Y=du(I,M),re,ue,Re=0,Ae=f.interpolate||st,Oe="__p += '",Ye=fu((f.escape||st).source+"|"+Ae.source+"|"+(Ae===vn?$n:st).source+"|"+(f.evaluate||st).source+"|$","g"),wt="//# sourceURL="+(br.call(f,"sourceURL")?(f.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++bd+"]")+`
`;l.replace(Ye,function(Gt,pr,Sr,Zo,to,ei){return Sr||(Sr=Zo),Oe+=l.slice(Re,ei).replace(jr,Cg),pr&&(re=!0,Oe+=`' +
__e(`+pr+`) +
'`),to&&(ue=!0,Oe+=`';
`+to+`;
__p += '`),Sr&&(Oe+=`' +
((__t = (`+Sr+`)) == null ? '' : __t) +
'`),Re=ei+Gt.length,Gt}),Oe+=`';
`;var Bt=br.call(f,"variable")&&f.variable;if(!Bt)Oe=`with (obj) {
`+Oe+`
}
`;else if(Wr.test(Bt))throw new Wt(d);Oe=(ue?Oe.replace(zt,""):Oe).replace(yr,"$1").replace(tr,"$1;"),Oe="function("+(Bt||"obj")+`) {
`+(Bt?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(re?", __e = _.escape":"")+(ue?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+Oe+`return __p
}`;var lr=uE(function(){return kr(M,wt+"return "+Oe).apply(t,Y)});if(lr.source=Oe,nx(lr))throw lr;return lr}function YF(l){return Lr(l).toLowerCase()}function JF(l){return Lr(l).toUpperCase()}function XF(l,f,y){if(l=Lr(l),l&&(y||f===t))return wg(l);if(!l||!(f=js(f)))return l;var k=Ys(l),I=Ys(f),M=bg(k,I),Y=Mh(k,I)+1;return Xi(k,M,Y).join("")}function QF(l,f,y){if(l=Lr(l),l&&(y||f===t))return l.slice(0,Pd(l)+1);if(!l||!(f=js(f)))return l;var k=Ys(l),I=Mh(k,Ys(f))+1;return Xi(k,0,I).join("")}function ZF(l,f,y){if(l=Lr(l),l&&(y||f===t))return l.replace(pt,"");if(!l||!(f=js(f)))return l;var k=Ys(l),I=bg(k,Ys(f));return Xi(k,I).join("")}function e2(l,f){var y=fe,k=B;if(mn(f)){var I="separator"in f?f.separator:I;y="length"in f?sr(f.length):y,k="omission"in f?js(f.omission):k}l=Lr(l);var M=l.length;if(nc(l)){var Y=Ys(l);M=Y.length}if(y>=M)return l;var re=y-il(k);if(re<1)return k;var ue=Y?Xi(Y,0,re).join(""):l.slice(0,re);if(I===t)return ue+k;if(Y&&(re+=ue.length-re),sx(I)){if(l.slice(re).search(I)){var Re,Ae=ue;for(I.global||(I=fu(I.source,Lr(po.exec(I))+"g")),I.lastIndex=0;Re=I.exec(Ae);)var Oe=Re.index;ue=ue.slice(0,Oe===t?re:Oe)}}else if(l.indexOf(js(I),re)!=re){var Ye=ue.lastIndexOf(I);Ye>-1&&(ue=ue.slice(0,Ye))}return ue+k}function t2(l){return l=Lr(l),l&&ls.test(l)?l.replace(ar,kg):l}var r2=xl(function(l,f,y){return l+(y?" ":"")+f.toUpperCase()}),ax=up("toUpperCase");function cE(l,f,y){return l=Lr(l),f=y?t:f,f===t?T0(l)?P0(l):C0(l):l.match(f)||[]}var uE=nr(function(l,f){try{return fs(l,t,f)}catch(y){return nx(y)?y:new Wt(y)}}),n2=Ti(function(l,f){return Xn(f,function(y){y=Yo(y),bi(l,y,De(l[y],l))}),l});function s2(l){var f=l==null?0:l.length,y=Dt();return l=f?Hr(l,function(k){if(typeof k[1]!="function")throw new yo(c);return[y(k[0]),k[1]]}):[],nr(function(k){for(var I=-1;++I<f;){var M=l[I];if(fs(M[0],this,k))return fs(M[1],this,k)}})}function o2(l){return Ug(Ps(l,x))}function lx(l){return function(){return l}}function i2(l,f){return l==null||l!==l?f:l}var a2=ff(),l2=ff(!0);function Io(l){return l}function cx(l){return yc(typeof l=="function"?l:Ps(l,x))}function c2(l){return ef(Ps(l,x))}function u2(l,f){return Zr(l,Ps(f,x))}var d2=nr(function(l,f){return function(y){return So(y,l,f)}}),f2=nr(function(l,f){return function(y){return So(l,y,f)}});function ux(l,f,y){var k=os(f),I=gc(f,k);y==null&&!(mn(f)&&(I.length||!k.length))&&(y=f,f=l,l=this,I=gc(f,os(f)));var M=!(mn(y)&&"chain"in y)||!!y.chain,Y=Nl(l);return Xn(I,function(re){var ue=f[re];l[re]=ue,Y&&(l.prototype[re]=function(){var Re=this.__chain__;if(M||Re){var Ae=l(this.__wrapped__),Oe=Ae.__actions__=ps(this.__actions__);return Oe.push({func:ue,args:arguments,thisArg:l}),Ae.__chain__=Re,Ae}return ue.apply(l,pa([this.value()],arguments))})}),l}function h2(){return Qr._===this&&(Qr._=Rg),this}function dx(){}function p2(l){return l=sr(l),nr(function(f){return tf(f,l)})}var m2=hf(Hr),g2=hf(Ah),v2=hf(jh);function dE(l){return it(l)?Oh(Yo(l)):rn(l)}function y2(l){return function(f){return l==null?t:Vi(l,f)}}var x2=fp(),w2=fp(!0);function fx(){return[]}function hx(){return!1}function b2(){return{}}function _2(){return""}function S2(){return!0}function E2(l,f){if(l=sr(l),l<1||l>X)return[];var y=O,k=Qn(l,O);f=Dt(f),l-=O;for(var I=Lh(k,f);++y<l;)f(y);return I}function C2(l){return Zt(l)?Hr(l,Yo):Qo(l)?[l]:ps(Ep(Lr(l)))}function k2(l){var f=++ic;return Lr(l)+f}var N2=ju(function(l,f){return l+f},0),T2=Bn("ceil"),R2=ju(function(l,f){return l/f},1),A2=Bn("floor");function I2(l){return l&&l.length?pl(l,Io,Sa):t}function P2(l,f){return l&&l.length?pl(l,Dt(f,2),Sa):t}function j2(l){return yg(l,Io)}function F2(l,f){return yg(l,Dt(f,2))}function O2(l){return l&&l.length?pl(l,Io,Ea):t}function D2(l,f){return l&&l.length?pl(l,Dt(f,2),Ea):t}var L2=ju(function(l,f){return l*f},1),M2=Bn("round"),$2=ju(function(l,f){return l-f},0);function U2(l){return l&&l.length?Dh(l,Io):0}function z2(l,f){return l&&l.length?Dh(l,Dt(f,2)):0}return D.after=Z,D.ary=we,D.assign=Jj,D.assignIn=rE,D.assignInWith=Ev,D.assignWith=Xj,D.at=Qj,D.before=je,D.bind=De,D.bindAll=n2,D.bindKey=Pe,D.castArray=bj,D.chain=Rf,D.chunk=bf,D.compact=Cp,D.concat=No,D.cond=s2,D.conforms=o2,D.constant=lx,D.countBy=vv,D.create=Zj,D.curry=Ze,D.curryRight=at,D.debounce=dt,D.defaults=eF,D.defaultsDeep=tF,D.defer=pn,D.delay=pe,D.difference=_r,D.differenceBy=Pn,D.differenceWith=wn,D.drop=Vn,D.dropRight=eo,D.dropRightWhile=Rc,D.dropWhile=En,D.fill=Hu,D.filter=Pf,D.flatMap=Lp,D.flatMapDeep=Q0,D.flatMapDepth=wv,D.flatten=_f,D.flattenDeep=Gu,D.flattenDepth=Fs,D.flip=oe,D.flow=a2,D.flowRight=l2,D.fromPairs=kp,D.functions=lF,D.functionsIn=cF,D.groupBy=Mp,D.initial=Sf,D.intersection=Np,D.intersectionBy=Ra,D.intersectionWith=Ef,D.invert=dF,D.invertBy=fF,D.invokeMap=bv,D.iteratee=cx,D.keyBy=Z0,D.keys=os,D.keysIn=Ao,D.map=kl,D.mapKeys=pF,D.mapValues=mF,D.matches=c2,D.matchesProperty=u2,D.memoize=me,D.merge=gF,D.mergeWith=nE,D.method=d2,D.methodOf=f2,D.mixin=ux,D.negate=Me,D.nthArg=p2,D.omit=vF,D.omitBy=yF,D.once=gt,D.orderBy=ex,D.over=m2,D.overArgs=jt,D.overEvery=g2,D.overSome=v2,D.partial=Ct,D.partialRight=Ht,D.partition=Ku,D.pick=xF,D.pickBy=sE,D.property=dE,D.propertyOf=y2,D.pull=Cf,D.pullAll=Vu,D.pullAllBy=ys,D.pullAllWith=Ia,D.pullAt=Jo,D.range=x2,D.rangeRight=w2,D.rearg=jn,D.reject=o,D.remove=Os,D.rest=Nr,D.reverse=kf,D.sampleSize=h,D.set=bF,D.setWith=_F,D.shuffle=v,D.slice=Rp,D.sortBy=j,D.sortedUniq=Pp,D.sortedUniqBy=Sl,D.split=WF,D.spread=ja,D.tail=uv,D.take=dv,D.takeRight=jp,D.takeRightWhile=Nf,D.takeWhile=H0,D.tap=Y0,D.throttle=rx,D.thru=Xo,D.toArray=ZS,D.toPairs=oE,D.toPairsIn=iE,D.toPath=C2,D.toPlainObject=tE,D.transform=SF,D.unary=xj,D.union=B0,D.unionBy=fv,D.unionWith=hv,D.uniq=El,D.uniqBy=G0,D.uniqWith=Ac,D.unset=EF,D.unzip=Tf,D.unzipWith=nn,D.update=CF,D.updateWith=kF,D.values=Mf,D.valuesIn=NF,D.without=W0,D.words=cE,D.wrap=wj,D.xor=pv,D.xorBy=V0,D.xorWith=q0,D.zip=mv,D.zipObject=gv,D.zipObjectDeep=K0,D.zipWith=To,D.entries=oE,D.entriesIn=iE,D.extend=rE,D.extendWith=Ev,ux(D,D),D.add=N2,D.attempt=uE,D.camelCase=IF,D.capitalize=aE,D.ceil=T2,D.clamp=TF,D.clone=_j,D.cloneDeep=Ej,D.cloneDeepWith=Cj,D.cloneWith=Sj,D.conformsTo=kj,D.deburr=lE,D.defaultTo=i2,D.divide=R2,D.endsWith=PF,D.eq=ta,D.escape=jF,D.escapeRegExp=FF,D.every=yv,D.find=jf,D.findIndex=Ta,D.findKey=rF,D.findLast=xv,D.findLastIndex=Bu,D.findLastKey=nF,D.floor=A2,D.forEach=Ff,D.forEachRight=qu,D.forIn=sF,D.forInRight=oF,D.forOwn=iF,D.forOwnRight=aF,D.get=ox,D.gt=Nj,D.gte=Tj,D.has=uF,D.hasIn=ix,D.head=bl,D.identity=Io,D.includes=Of,D.indexOf=ea,D.inRange=RF,D.invoke=hF,D.isArguments=Yu,D.isArray=Zt,D.isArrayBuffer=Rj,D.isArrayLike=Ro,D.isArrayLikeObject=Cn,D.isBoolean=Aj,D.isBuffer=Ic,D.isDate=Ij,D.isElement=Pj,D.isEmpty=jj,D.isEqual=Fj,D.isEqualWith=Oj,D.isError=nx,D.isFinite=Dj,D.isFunction=Nl,D.isInteger=YS,D.isLength=_v,D.isMap=JS,D.isMatch=Lj,D.isMatchWith=Mj,D.isNaN=$j,D.isNative=Uj,D.isNil=Hj,D.isNull=zj,D.isNumber=XS,D.isObject=mn,D.isObjectLike=bn,D.isPlainObject=$p,D.isRegExp=sx,D.isSafeInteger=Bj,D.isSet=QS,D.isString=Sv,D.isSymbol=Qo,D.isTypedArray=Lf,D.isUndefined=Gj,D.isWeakMap=Wj,D.isWeakSet=Vj,D.join=Aa,D.kebabCase=OF,D.last=vs,D.lastIndexOf=Wu,D.lowerCase=DF,D.lowerFirst=LF,D.lt=qj,D.lte=Kj,D.max=I2,D.maxBy=P2,D.mean=j2,D.meanBy=F2,D.min=O2,D.minBy=D2,D.stubArray=fx,D.stubFalse=hx,D.stubObject=b2,D.stubString=_2,D.stubTrue=S2,D.multiply=L2,D.nth=Tp,D.noConflict=h2,D.noop=dx,D.now=W,D.pad=MF,D.padEnd=$F,D.padStart=UF,D.parseInt=zF,D.random=AF,D.reduce=tx,D.reduceRight=Df,D.repeat=HF,D.replace=BF,D.result=wF,D.round=M2,D.runInContext=le,D.sample=a,D.size=_,D.snakeCase=GF,D.some=N,D.sortedIndex=Ap,D.sortedIndexBy=z0,D.sortedIndexOf=Pa,D.sortedLastIndex=cv,D.sortedLastIndexBy=Ip,D.sortedLastIndexOf=_l,D.startCase=VF,D.startsWith=qF,D.subtract=$2,D.sum=U2,D.sumBy=z2,D.template=KF,D.times=E2,D.toFinite=Tl,D.toInteger=sr,D.toLength=eE,D.toLower=YF,D.toNumber=Ai,D.toSafeInteger=Yj,D.toString=Lr,D.toUpper=JF,D.trim=XF,D.trimEnd=QF,D.trimStart=ZF,D.truncate=e2,D.unescape=t2,D.uniqueId=k2,D.upperCase=r2,D.upperFirst=ax,D.each=Ff,D.eachRight=qu,D.first=bl,ux(D,(function(){var l={};return Qs(D,function(f,y){br.call(D.prototype,y)||(l[y]=f)}),l})(),{chain:!1}),D.VERSION=n,Xn(["bind","bindKey","curry","curryRight","partial","partialRight"],function(l){D[l].placeholder=D}),Xn(["drop","take"],function(l,f){Qt.prototype[l]=function(y){y=y===t?1:xn(sr(y),0);var k=this.__filtered__&&!f?new Qt(this):this.clone();return k.__filtered__?k.__takeCount__=Qn(y,k.__takeCount__):k.__views__.push({size:Qn(y,O),type:l+(k.__dir__<0?"Right":"")}),k},Qt.prototype[l+"Right"]=function(y){return this.reverse()[l](y).reverse()}}),Xn(["filter","map","takeWhile"],function(l,f){var y=f+1,k=y==ce||y==xe;Qt.prototype[l]=function(I){var M=this.clone();return M.__iteratees__.push({iteratee:Dt(I,3),type:y}),M.__filtered__=M.__filtered__||k,M}}),Xn(["head","last"],function(l,f){var y="take"+(f?"Right":"");Qt.prototype[l]=function(){return this[y](1).value()[0]}}),Xn(["initial","tail"],function(l,f){var y="drop"+(f?"":"Right");Qt.prototype[l]=function(){return this.__filtered__?new Qt(this):this[y](1)}}),Qt.prototype.compact=function(){return this.filter(Io)},Qt.prototype.find=function(l){return this.filter(l).head()},Qt.prototype.findLast=function(l){return this.reverse().find(l)},Qt.prototype.invokeMap=nr(function(l,f){return typeof l=="function"?new Qt(this):this.map(function(y){return So(y,l,f)})}),Qt.prototype.reject=function(l){return this.filter(Me(Dt(l)))},Qt.prototype.slice=function(l,f){l=sr(l);var y=this;return y.__filtered__&&(l>0||f<0)?new Qt(y):(l<0?y=y.takeRight(-l):l&&(y=y.drop(l)),f!==t&&(f=sr(f),y=f<0?y.dropRight(-f):y.take(f-l)),y)},Qt.prototype.takeRightWhile=function(l){return this.reverse().takeWhile(l).reverse()},Qt.prototype.toArray=function(){return this.take(O)},Qs(Qt.prototype,function(l,f){var y=/^(?:filter|find|map|reject)|While$/.test(f),k=/^(?:head|last)$/.test(f),I=D[k?"take"+(f=="last"?"Right":""):f],M=k||/^find/.test(f);I&&(D.prototype[f]=function(){var Y=this.__wrapped__,re=k?[1]:arguments,ue=Y instanceof Qt,Re=re[0],Ae=ue||Zt(Y),Oe=function(pr){var Sr=I.apply(D,pa([pr],re));return k&&Ye?Sr[0]:Sr};Ae&&y&&typeof Re=="function"&&Re.length!=1&&(ue=Ae=!1);var Ye=this.__chain__,wt=!!this.__actions__.length,Bt=M&&!Ye,lr=ue&&!wt;if(!M&&Ae){Y=lr?Y:new Qt(this);var Gt=l.apply(Y,re);return Gt.__actions__.push({func:Xo,args:[Oe],thisArg:t}),new Zn(Gt,Ye)}return Bt&&lr?l.apply(this,re):(Gt=this.thru(Oe),Bt?k?Gt.value()[0]:Gt.value():Gt)})}),Xn(["pop","push","shift","sort","splice","unshift"],function(l){var f=zi[l],y=/^(?:push|sort|unshift)$/.test(l)?"tap":"thru",k=/^(?:pop|shift)$/.test(l);D.prototype[l]=function(){var I=arguments;if(k&&!this.__chain__){var M=this.value();return f.apply(Zt(M)?M:[],I)}return this[y](function(Y){return f.apply(Zt(Y)?Y:[],I)})}}),Qs(Qt.prototype,function(l,f){var y=D[f];if(y){var k=y.name+"";br.call(uc,k)||(uc[k]=[]),uc[k].push({name:f,func:y})}}),uc[Cc(t,R).name]=[{name:"wrapper",func:t}],Qt.prototype.clone=Bd,Qt.prototype.reverse=Wh,Qt.prototype.value=hc,D.prototype.at=Af,D.prototype.chain=Cl,D.prototype.commit=If,D.prototype.next=Fp,D.prototype.plant=J0,D.prototype.reverse=Dp,D.prototype.toJSON=D.prototype.valueOf=D.prototype.value=X0,D.prototype.first=D.prototype.head,Bi&&(D.prototype[Bi]=Op),D}),sc=j0();mi?((mi.exports=sc)._=sc,uu._=sc):Qr._=sc}).call(Yq)})(_m,_m.exports)),_m.exports}var By=Jq();const Vv="src/shared/components/sidepanel/panels/components/FilevineCaseInfoBox.tsx",Xq=({caseSummaryData:r,isCaseSummaryLoading:e,caseSummaryError:t,caseDetails:n,onDocumentView:s})=>{if(e)return u.jsxs("div",{className:"space-y-2",children:[u.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded animate-pulse"}),u.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded animate-pulse"}),u.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded animate-pulse"})]});if(t)return u.jsx("div",{className:"text-sm text-red-600 dark:text-red-400",children:t});if(!r)return null;const i={};return r.caseFacts&&(i["Case Facts"]=r.caseFacts),r.supioLink&&(i["Supio Link"]=r.supioLink),n.incidentDate&&(i["Incident Date"]=new Date(n.incidentDate).toLocaleDateString(void 0,{timeZone:"UTC"})),r.statuteoflimitations&&r.statuteoflimitations.dateValue&&(i["Statute of Limitations (SOL)"]=new Date(r.statuteoflimitations.dateValue).toLocaleDateString(void 0,{timeZone:"UTC"})),r.totalMeds>0&&(i["Total Meds"]=`$${r.totalMeds.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`),r.totalLiens>0&&(i["Total Liens"]=`$${r.totalLiens.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`),u.jsxs("div",{className:"space-y-3",children:[u.jsx(ru,{details:i}),r.disbursementSheet&&u.jsx("div",{className:"px-3 pb-2",children:u.jsx("table",{className:"w-full text-sm text-left text-gray-700 dark:text-gray-300",children:u.jsx("tbody",{children:u.jsxs("tr",{className:"bg-card",children:[u.jsx("td",{className:"py-4 px-3 whitespace-normal font-medium w-1/3 text-gray-800 dark:text-gray-200",children:"Disbursement Sheet"}),u.jsx("td",{className:"py-2 px-3",children:u.jsxs("button",{onClick:()=>{s&&r.disbursementSheet&&s({name:r.disbursementSheet.filename,documentId:r.disbursementSheet.documentId,url:""})},className:"text-blue-600 dark:text-blue-400 hover:underline inline-flex items-center gap-1 cursor-pointer focus:outline-none",children:[u.jsx(ld,{className:"w-3 h-3"}),r.disbursementSheet.filename]})})]})})})})]})},Qq=({clientEmail:r,selectedCaseDetails:e,casesForCurrentClient:t,currentCaseIndex:n,caseDetails:s,nextCase:i,prevCase:c,isLoading:d,setCurrentCaseIndex:p,isValidating:m=!1,handleSectionClick:g,projectId:x,onDocumentView:b,onProjectManuallySelected:S,onResetToEmailProject:T,isProjectManuallySelected:E=!1})=>{const C=zr(),[R,A]=w.useState(""),[F,P]=w.useState(!1),[L,G]=w.useState(null),[U,V]=w.useState(!1),[Q,fe]=w.useState(null),[B,ee]=w.useState(""),[ve,ce]=w.useState([]),[ne,xe]=w.useState(!1),[J,X]=w.useState(!1),[z,q]=w.useState(null),O=w.useMemo(()=>{if(!R.trim())return t;const se=R.toLowerCase();return t.filter(Te=>String(Te.projectName||"").toLowerCase().includes(se))},[t,R]),$=w.useMemo(()=>By.debounce(async se=>{if(!se.trim()||se.length<2){ce([]),q(null);return}xe(!0),q(null);try{const Te=await Qy("filevine",se,C);ce(Te.projects||[]),Te.projects.length===0&&q(`No projects found for "${se}"`)}catch(Te){C.error("Project search failed",Te,{sourceFile:Vv}),q("Failed to search projects. Please try again."),ce([])}finally{xe(!1)}},400),[C]),ae=se=>{var Te,qe,ze;try{const Be={projectId:{native:((Te=se.projectId)==null?void 0:Te.native)||null,partner:((qe=se.projectId)==null?void 0:qe.partner)||null},projectName:se.projectName||"",projectTypeCode:se.projectTypeCode||"",projectTypeName:se.projectTypeName||"",phaseName:se.phaseName||"",phaseDate:se.phaseDate||"",firstPrimaryName:se.firstPrimaryName||"",firstPrimaryUsername:se.firstPrimaryUsername||"",hashtags:Array.isArray(se.hashtags)?se.hashtags.join(", "):"",projectEmailAddress:se.projectEmailAddress||"",projectUrl:se.projectUrl||"",incidentDate:se.incidentDate||""};C.info("Project manually selected via search",{projectId:(ze=Be.projectId)==null?void 0:ze.native,projectName:Be.projectName,sourceFile:Vv}),S&&S(Be),X(!1),ee(""),ce([]),q(null)}catch(Be){C.error("Failed to select project",Be,{sourceFile:Vv})}},be=se=>{P(se),se||A("")},ie=async()=>{if(!(!x||L)){V(!0),fe(null);try{const se=await c8("filevine",x,C);G(se)}catch(se){C.error("Error fetching case summary",se,{sourceFile:Vv}),fe("Failed to load case summary data")}finally{V(!1)}}};w.useEffect(()=>{G(null),fe(null)},[x]);const K=()=>u.jsx(Gs,{rows:2}),de=()=>g?u.jsxs(We,{variant:"ghost",className:"justify-between w-full text-sm px-0 hover:bg-transparent",onClick:()=>g("Project Documents"),children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx(ld,{className:"h-4 w-4 mr-2 text-blue-500 dark:text-blue-400"}),u.jsx("span",{className:"text-blue-500 dark:text-blue-400",children:"Project Documents"})]}),u.jsx(Pi,{src:"/icons/chevron-right.svg",width:16,height:16,alt:"Chevron right",className:"h-4 w-4"})]}):null,ge=se=>{if(p)p(se);else if(se>n)for(let Te=n;Te<se;Te++)i();else if(se<n)for(let Te=n;Te>se;Te--)c()};return u.jsxs("div",{className:"w-full min-h-[4rem] border border-border/50 rounded-lg shadow-sm bg-card text-card-foreground",title:"Case Information",children:[u.jsxs("div",{className:"flex items-center justify-between p-2 border-b bg-muted",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(sA,{className:"w-3.5 h-3.5 text-slate-600 dark:text-gray-300"}),u.jsx("span",{className:"font-medium text-sm text-slate-800 dark:text-white",children:"PROJECTS"})]}),u.jsxs("div",{className:"flex items-center gap-1",children:[E&&T&&u.jsx(We,{variant:"ghost",size:"icon",className:"h-8 w-8",title:"Reset to email-based project",onClick:T,children:u.jsx(Do,{className:"h-4 w-4"})}),u.jsxs(Ws,{open:J,onOpenChange:X,children:[u.jsx(Vs,{asChild:!0,children:u.jsx(We,{variant:"ghost",size:"icon",className:"h-8 w-8",title:"Search all projects",onClick:se=>{se.stopPropagation(),X(!J)},children:u.jsx(lo,{className:"h-4 w-4"})})}),u.jsxs(_s,{align:"end",className:"w-[320px] p-0",children:[u.jsxs("div",{className:"p-3 border-b border-gray-200 dark:border-gray-700",children:[u.jsx("div",{className:"text-sm font-medium mb-2 text-gray-800 dark:text-gray-200",children:"Search All Projects"}),u.jsxs("div",{className:"relative",children:[u.jsx(lo,{className:"absolute left-2 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),u.jsx(an,{placeholder:"Search by project or client name...",value:B,onChange:se=>{const Te=se.target.value;ee(Te),$(Te)},className:"pl-8 pr-8 h-9 text-sm",autoFocus:!0,onClick:se=>se.stopPropagation(),onKeyDown:se=>se.stopPropagation()}),B&&u.jsx("button",{onClick:se=>{se.stopPropagation(),ee(""),ce([]),q(null)},className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:u.jsx(Oi,{className:"w-4 h-4"})})]})]}),u.jsx("div",{className:"max-h-[300px] overflow-y-auto",children:ne?u.jsxs("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 flex items-center gap-2",children:[u.jsx("div",{className:"w-4 h-4 border-2 border-gray-300 border-t-gray-600 rounded-full animate-spin"}),"Searching..."]}):z&&ve.length===0?u.jsx("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:z}):ve.length>0?ve.map(se=>u.jsxs(is,{className:"flex flex-col items-start p-3 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-800",onClick:()=>ae(se),children:[u.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-gray-100",children:se.projectName}),u.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5",children:[se.phaseName,"  Client: ",se.clientName]})]},se.projectId.native)):B.trim()&&!ne?u.jsxs("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:['No projects found for "',B,'"']}):u.jsx("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:"Type at least 2 characters to search projects..."})})]})]})]})]}),d?K():e&&Object.keys(e).length>0?u.jsxs(u.Fragment,{children:[t.length>0&&u.jsxs("div",{className:"flex items-center px-3 py-1 bg-gray-50 dark:bg-gray-800 border-b dark:border-gray-700 gap-2",children:[u.jsxs("div",{className:"flex-1 min-w-0 flex items-center",children:[t.length>1&&u.jsxs(Ws,{open:F,onOpenChange:be,children:[u.jsx(Vs,{asChild:!0,children:u.jsxs(We,{variant:"ghost",size:"sm",className:"h-8 text-xs text-gray-600 dark:text-gray-300 flex items-center gap-1 px-2 max-w-full",children:[u.jsx("span",{className:"truncate",title:e.Title||"",children:e.Title||"Case"}),u.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400 flex-shrink-0",children:["(",n+1,"/",t.length,")"]}),u.jsx(ws,{className:"w-3 h-3 ml-1 flex-shrink-0"})]})}),u.jsxs(_s,{align:"start",className:"w-[280px] p-0",children:[u.jsxs("div",{className:"p-2 border-b border-gray-200 dark:border-gray-700",children:[u.jsxs("div",{className:"relative",children:[u.jsx(lo,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),u.jsx(an,{placeholder:"Search projects...",value:R,onChange:se=>A(se.target.value),className:"pl-8 pr-8 h-8 text-xs",autoFocus:!0,onClick:se=>se.stopPropagation(),onKeyDown:se=>se.stopPropagation()}),R&&u.jsx("button",{onClick:se=>{se.stopPropagation(),A("")},className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:u.jsx(Oi,{className:"w-4 h-4"})})]}),R&&u.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:["Showing ",O.length," of ",t.length]})]}),u.jsx("div",{className:"max-h-[200px] overflow-y-auto",children:O.length>0?O.map((se,Te)=>{const qe=t.findIndex(ze=>ze===se);return u.jsx(is,{className:`text-xs truncate ${qe===n?"bg-gray-100 dark:bg-gray-700 font-medium":""}`,onClick:()=>ge(qe),children:String(se.projectName||`Case ${qe+1}`)},qe)}):u.jsxs("div",{className:"p-3 text-xs text-center text-gray-500 dark:text-gray-400",children:['No projects match "',R,'"']})})]})]}),t.length===1&&u.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-300 px-2 truncate",title:e.Title||"",children:e.Title||"Case"})]}),s.projectUrl&&u.jsxs("a",{href:s.projectUrl,target:"_blank",rel:"noopener noreferrer",className:"h-8 text-xs text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 border border-blue-200 dark:border-blue-800 px-3 flex-shrink-0 rounded-md inline-flex items-center gap-1 no-underline hover:no-underline",children:[u.jsx(Ba,{className:"w-3 h-3"}),"View"]})]}),u.jsx("div",{className:"break-words overflow-hidden",children:u.jsx(ru,{details:e})}),u.jsx("div",{className:"px-3 border-t",children:de()}),s.projectTypeCode&&s.projectTypeCode!=="IM"&&u.jsx("div",{className:"border-t",children:u.jsx(Kq,{type:"single",collapsible:!0,onValueChange:se=>{se==="view-more"&&ie()},children:u.jsxs(dj,{value:"view-more",className:"border-0",children:[u.jsx(fj,{className:"px-3 py-2 hover:no-underline text-sm font-medium",children:"View More"}),u.jsx(hj,{className:"px-3 pb-2",children:u.jsx(Xq,{caseSummaryData:L,isCaseSummaryLoading:U,caseSummaryError:Q,caseDetails:s,onDocumentView:b})})]})},x)})]}):m?u.jsx(Gs,{rows:2}):u.jsx("div",{className:"p-3 text-sm text-gray-600 dark:text-gray-400",children:r?u.jsx(u.Fragment,{children:u.jsx("p",{className:"mb-2",children:"Select a client email thread to view project information"})}):"Select a client email thread to view case information"})]})},hr="src/sidepanel/mainPanelContent/FilevineInsights.tsx",Zq="https://rubypowerslaw.filevineapp.com",eK=({toggleSection:r,clientEmail:e,setClientEmail:t,setProjectId:n,setDocuments:s,setIsDocumentsLoading:i,setDocumentsError:c,onDocumentView:d,tempClientEmail:p,setTempClientEmail:m,emailParticipants:g,emailParticipantClients:x,currentClientIndex:b,setCurrentClientIndex:S,currentCaseIndex:T,casesForCurrentClient:E,setCasesForCurrentClient:C,isManuallySet:R,setIsManuallySet:A,isProjectManuallySelected:F,setIsProjectManuallySelected:P,isValidClient:L,isTempEmailValid:G,nextCase:U,prevCase:V,handleSetCurrentCaseIndex:Q,ClientNavigation:fe,onClientDataValidated:B,isValidating:ee,refreshTrigger:ve,integrationSettings:ce})=>{const[ne,xe]=w.useState(!1),[J,X]=w.useState({}),[z,q]=w.useState({}),[O,$]=w.useState({}),[ae,be]=w.useState(!1),[ie,K]=w.useState(void 0),[de,ge]=w.useState([]),[se,Te]=w.useState(!1),[qe,ze]=w.useState(null),Be=w.useRef({}),Ce=zr(),vt=aa(),kt=w.useCallback(_e=>{if(!_e||!_e.client_data)return!1;const Fe=_e.client_data;return Fe&&typeof Fe=="object"&&Object.keys(Fe).length>0},[]),yt=w.useCallback(_e=>{Ce.info("selectClientDetails called",{sourceFile:hr,hasDetails:!!_e,detailsKeys:_e?Object.keys(_e):[]});const Fe=ft=>{const Ut=ft.replace(/\D/g,"");return Ut.length===10?`(${Ut.slice(0,3)}) ${Ut.slice(3,6)}-${Ut.slice(6)}`:ft};Ce.debug("Client details received for formatting",{sourceFile:hr,caseNames:_e.caseNames});const nt={Name:_e.fullName||"",Phone:Fe(_e.phoneNumber||""),Address:_e.fullAddress||""};Ce.info("Client details formatted and set",{sourceFile:hr,selectedDetails:nt,originalDetails:_e}),q(nt)},[Ce]),At=w.useCallback(_e=>{Ce.info("selectCaseDetails called",{sourceFile:hr,hasDetails:!!_e,detailsKeys:_e?Object.keys(_e):[]});let Fe="";if(_e.projectName){const Ut=_e.projectName.match(/(\d{2}-\d{3})/);Ut&&Ut[1]&&(Fe=Ut[1])}Ce.debug("Case details received for formatting",{sourceFile:hr});const ft=(_e.projectTypeCode||"")==="IM"?{Title:_e.projectName||"","Internal Case ID":Fe,"Assigned To":_e.firstPrimaryName||"",Phase:_e.phaseName||"",Tags:_e.hashtags||"","Filevine Email":_e.projectEmailAddress||""}:{Title:_e.projectName||"","Assigned To":_e.firstPrimaryName||"",Phase:_e.phaseName||"",Tags:_e.hashtags||"","Filevine Email":_e.projectEmailAddress||""};Ce.info("Case details formatted and set",{sourceFile:hr,selectedDetails:ft,originalDetails:_e}),$(ft)},[Ce]),It=w.useCallback(async _e=>{if(Be.current[_e]){Ce.debug("Using cached client data",{sourceFile:hr,email:_e});return}try{Ce.debug("Fetching client data",{sourceFile:hr,email:_e});const Fe=await vt.getCurrentThreadId(),nt=await tS("filevine",_e,Ce,!1,void 0,Fe);Be.current[_e]=nt}catch(Fe){throw Fe instanceof Error&&(Fe.message.includes("Client not found")||Fe.message.includes("(cached)"))?Ce.debug("Client not found for email (including cached)",{sourceFile:hr,email:_e}):Ce.error(`Error fetching client data for ${_e}`,Fe,{sourceFile:hr}),Fe}},[Ce,vt]),Yt=w.useCallback(async()=>{if(Ce.info("fetchClientData called",{sourceFile:hr,clientEmail:e,isFilevineConnected:ne,hasClientEmail:!!e}),!e||!ne){Ce.info("fetchClientData early return",{sourceFile:hr,reason:e?"filevine not connected":"no client email",clientEmail:e,isFilevineConnected:ne});return}try{if(be(!0),Ce.info("fetchClientData starting data fetch",{sourceFile:hr,clientEmail:e,isLoading:!0}),!Be.current[e])try{await It(e)}catch(Ue){Ue instanceof Error&&Ue.message.includes("(cached)")?Ce.debug("Using cached knowledge that this client doesn't exist",{sourceFile:hr,clientEmail:e}):Ce.error("Error fetching client data",Ue,{sourceFile:hr}),X({}),C([]),q({}),$({}),be(!1);return}const _e=Be.current[e];if(!_e){X({}),C([]),q({}),$({}),be(!1),B(e,!1);return}const Fe=kt(_e);if(B(e,Fe),!Fe){Ce.debug("Client data exists but is not valid",{sourceFile:hr,clientEmail:e}),X({}),C([]),q({}),$({}),be(!1);return}const nt=_e.client_data;yt(nt);const ft=_e.case_data||[];C(ft);const Ut=ft.length>0?Object.entries(ft[0]).reduce((Ue,[He,Mt])=>(Ue[He]=String(Mt),Ue),{}):{};X(Ut),At(Ut)}catch(_e){Ce.error("Error processing client data",_e,{sourceFile:hr}),X({}),C([]),e&&B(e,!1)}finally{be(!1)}},[e,ne,It,Ce,yt,At,C,B,kt]);w.useEffect(()=>{Ce.info("FilevineInsights component initialized",{sourceFile:hr,clientEmail:e,emailParticipants:g.length,currentClientIndex:b,currentCaseIndex:T,casesForCurrentClient:E.length}),(async()=>{try{xe(!0)}catch(Fe){Ce.error("Error checking Filevine connection",Fe,{sourceFile:hr}),xe(!1)}})()},[Ce,E.length,T,b,e,g.length]),w.useEffect(()=>{ee&&g.length>0&&(Be.current={},Ce.debug("Cleared component-level client data cache for refresh",{sourceFile:hr}))},[ee,g.length,Ce]),w.useEffect(()=>{const _e=async()=>{if(ne){Ce.info("Validating all email participants",{sourceFile:hr,participantCount:g.length});for(const Fe of g)try{await It(Fe);const nt=Be.current[Fe],ft=kt(nt);B(Fe,ft),Ce.debug("Participant validation result",{sourceFile:hr,email:Fe,hasValidData:ft})}catch(nt){Ce.debug("Participant validation failed",{sourceFile:hr,email:Fe,error:nt}),B(Fe,!1)}}};g.length>0&&ne&&_e()},[g,ne,It,kt,B,Ce,ve]),w.useEffect(()=>{if(F){Ce.debug("Skipping fetchClientData because project was manually selected",{sourceFile:hr,clientEmail:e,isProjectManuallySelected:F});return}e&&ne&&(Yt(),m(e),R&&!g.includes(e.toLowerCase())&&Ce.debug("Manually set email not in participants, validating separately",{sourceFile:hr,clientEmail:e}))},[e,ne,Yt,m,R,F,g,Ce]),w.useEffect(()=>{(!e||g.length===0&&!R)&&(m(null),q({}),$({}))},[e,g.length,R,m,q,$]),w.useEffect(()=>{var _e;if(E.length>0&&T<E.length){const Fe=E[T],nt=Fe?Object.entries(Fe).reduce((Ut,[Ue,He])=>(Ut[Ue]=String(He),Ut),{}):{};X(nt),At(nt);const ft=(_e=Fe==null?void 0:Fe.projectId)!=null&&_e.native?String(Fe.projectId.native):void 0;K(ft),n&&ft&&n(ft)}},[T,E,At,n]);const Xt=w.useCallback(async()=>{var nt;if(!ne||E.length===0)return;const _e=E[T],Fe=((nt=_e==null?void 0:_e.projectId)==null?void 0:nt.native)||(_e==null?void 0:_e.projectId);if(!Fe){Ce.debug("No project ID found for current case",{sourceFile:hr,currentCaseIndex:T});const ft="No project ID available. Cannot fetch documents.";ze(ft),c&&c(ft);return}Te(!0),i&&i(!0),ze(null),c&&c(null);try{const ft=await _T(String(Fe),Ce);if(ft){Ce.debug("Using cached documents for project",{sourceFile:hr,projectId:Fe}),ge(ft),s&&s(ft),Te(!1),i&&i(!1);return}const Ue=(await MT("filevine",String(Fe),Ce)).documents.map(He=>({name:He.filename,url:`${Zq}/docwebviewer/view/${He.documentId}`,documentId:He.documentId,folderName:He.folderName}));await bT(String(Fe),Ue,Ce),ge(Ue),s&&s(Ue)}catch(ft){Ce.error("Error fetching documents",ft,{sourceFile:hr});const Ut="Failed to load documents. Please try again later.";ze(Ut),c&&c(Ut)}finally{Te(!1),i&&i(!1)}},[ne,E,T,s,i,c,Ce]),Or=_e=>{var Fe;try{const nt=((Fe=_e.projectId)==null?void 0:Fe.native)||_e.projectId;Ce.info("Project manually selected via search",{projectId:nt,projectName:_e.projectName,sourceFile:hr}),X(_e),At(_e),C([_e]),t(""),q({}),P(!0),K(nt),n&&nt&&n(nt)}catch(nt){Ce.error("Failed to set manually selected project",nt,{sourceFile:hr})}},vr=()=>{try{if(Ce.info("Resetting to email-based project",{sourceFile:hr}),P(!1),x.length>0){const _e=x[0];t(_e),Ce.debug("Restored client email",{sourceFile:hr,clientEmail:_e})}}catch(_e){Ce.error("Failed to reset to email-based project",_e,{sourceFile:hr})}};if(!ne)return null;const dn=_e=>{Ce.debug(`[FilevineInfoBox] handleSectionClick called with section: "${_e}"`,{sourceFile:hr,functionName:"handleSectionClick",data:{section:_e}}),r?(Ce.debug(`[FilevineInfoBox] Calling toggleSection with section: "${_e}"`,{sourceFile:hr,functionName:"handleSectionClick",data:{section:_e}}),r(_e),_e.toLowerCase()==="project documents"?(Ce.debug('[FilevineInfoBox] Section is "project documents", calling fetchMatterDocuments',{sourceFile:hr,functionName:"handleSectionClick",data:{section:_e}}),Xt()):Ce.debug('[FilevineInfoBox] Section is not "project documents", not calling fetchMatterDocuments',{sourceFile:hr,functionName:"handleSectionClick",data:{section:_e}})):Ce.warn("[FilevineInfoBox] toggleSection is not defined. Cannot navigate.",{sourceFile:hr,functionName:"handleSectionClick",data:{section:_e}})};return u.jsxs("div",{className:"space-y-4 overflow-y-auto h-full mt-0",children:[u.jsx(Rq,{clientEmail:e,emailParticipants:g,emailParticipantClients:x,currentClientIndex:b,setCurrentClientIndex:S,setClientEmail:t,isManuallySet:R,selectedClientDetails:z,isLoading:ae,ClientNavigation:fe,tempClientEmail:p,setTempClientEmail:m,setIsManuallySet:A,isValidClient:L,isTempEmailValid:G,isValidating:ee,isProjectManuallySelected:F}),u.jsx(Qq,{clientEmail:e,selectedCaseDetails:O,casesForCurrentClient:E,currentCaseIndex:T,caseDetails:J,nextCase:U,prevCase:V,isLoading:ae,setCurrentCaseIndex:Q,isValidating:ee,handleSectionClick:dn,projectId:ie,onDocumentView:d,onProjectManuallySelected:Or,onResetToEmailProject:vr,isProjectManuallySelected:F}),u.jsx("div",{className:"h-8"})]})},tK=hS("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),Xm=w.forwardRef(({className:r,variant:e,...t},n)=>u.jsx("div",{ref:n,role:"alert",className:Fr(tK({variant:e}),r),...t}));Xm.displayName="Alert";const rK=w.forwardRef(({className:r,...e},t)=>u.jsx("h5",{ref:t,className:Fr("mb-1 font-medium leading-none tracking-tight",r),...e}));rK.displayName="AlertTitle";const Qm=w.forwardRef(({className:r,...e},t)=>u.jsx("div",{ref:t,className:Fr("text-sm [&_p]:leading-relaxed",r),...e}));Qm.displayName="AlertDescription";const qv="src/shared/components/sidepanel/panels/components/ClioContactCreation.tsx",bN=r=>{if(!r||r.trim()==="")return!0;if(!/^[\d\s+().-]+$/.test(r))return!1;const t=r.replace(/\D/g,"");return t.length>=7&&t.length<=15},nK=({emailParticipants:r,emailParticipantClients:e,getClientNameFromCache:t,onContactsCreated:n})=>{const s=zr(),[i,c]=w.useState([]),[d,p]=w.useState(!1),[m,g]=w.useState(!1),[x,b]=w.useState([]),[S,T]=w.useState({}),[E,C]=w.useState([]),[R,A]=w.useState(!1),[F,P]=w.useState(null),[L,G]=w.useState(!1),U=w.useCallback(ce=>{const ne=ce.toLowerCase();return e.some(xe=>xe.toLowerCase()===ne)},[e]);w.useEffect(()=>{const ce=r.map((ne,xe)=>{const J=U(ne);let X="";if(J){const z=t(ne);z&&(X=z)}return X||(X=ne.split("@")[0].split(".").map(q=>q.charAt(0).toUpperCase()+q.slice(1).toLowerCase()).join(" ")),{id:`participant-${xe}`,name:X,email:ne,inClio:J}});c(ce),s.debug("Participants initialized with Clio status",{sourceFile:qv,totalParticipants:ce.length,inClio:ce.filter(ne=>ne.inClio).length,notInClio:ce.filter(ne=>!ne.inClio).length})},[r,e,s,U,t]);const V=i.some(ce=>!ce.inClio),Q=()=>{p(!0),g(!1);const ce={};i.forEach(ne=>{if(!ne.inClio){const xe=ne.name.split(" ");ce[ne.id]={firstName:xe[0]||"",lastName:xe.slice(1).join(" ")||"",email:ne.email,phoneNumber:"",type:"person",companyName:""}}}),T(ce)},fe=()=>{p(!1),b([]),P(null)},B=ce=>{b(ne=>ne.includes(ce)?ne.filter(xe=>xe!==ce):[...ne,ce])},ee=(ce,ne,xe)=>{T(J=>({...J,[ce]:{...J[ce],[ne]:xe}}))},ve=async()=>{var ce,ne,xe;A(!0),P(null);for(const J of x){const X=S[J];if(!X){P({type:"validation",message:"Contact data is missing. Please try again."}),A(!1);return}if(X.type==="person"){if(!((ce=X.firstName)!=null&&ce.trim())||!((ne=X.lastName)!=null&&ne.trim())){P({type:"validation",message:"First and Last name is required for person contacts."}),A(!1);return}}else if(X.type==="company"&&!((xe=X.companyName)!=null&&xe.trim())){P({type:"validation",message:"Company name is required for company contacts."}),A(!1);return}if(X!=null&&X.phoneNumber&&!bN(X.phoneNumber)){P({type:"validation",message:"Invalid phone number. Please enter 7-15 digits with optional formatting (+, -, spaces, parentheses)."}),A(!1);return}}try{const J=[];for(const z of x){const q=i.find($=>$.id===z),O=S[z];if(!(!q||!O))try{const $=await x8(O,s),ae=O.type==="company"?O.companyName||"":`${O.firstName||""} ${O.lastName||""}`.trim();J.push({id:$.id,name:ae||q.name,email:q.email}),s.info("Contact created successfully in Clio",{sourceFile:qv,email:q.email})}catch($){if(s.error("Error creating contact in Clio",$,{sourceFile:qv,email:q.email}),$ instanceof Error&&($.message.includes("duplicate")||$.message.includes("already exists")?P({type:"duplicate",message:"A contact with this email already exists in Clio."}):$.message.includes("permission")?P({type:"permission",message:"You do not have permission to create contacts in Clio. Contact your admin."}):P({type:"network",message:"Something went wrong. Please try again."})),J.length>0){const ae=[...E,...J];C(ae),c(ie=>ie.map(K=>{const de=J.find(ge=>ge.email.toLowerCase()===K.email.toLowerCase());return de?{...K,inClio:!0,name:de.name}:K}));const be=J.map(ie=>{var K;return(K=i.find(de=>de.email.toLowerCase()===ie.email.toLowerCase()))==null?void 0:K.id}).filter(Boolean);b(ie=>ie.filter(K=>!be.includes(K))),n&&n(ae)}A(!1);return}}G(!0);const X=[...E,...J];C(X),p(!1),b([]),A(!1),c(z=>z.map(q=>{const O=J.find($=>$.email.toLowerCase()===q.email.toLowerCase());return O?{...q,inClio:!0,name:O.name}:q})),n&&n(X)}catch(J){s.error("Unexpected error in contact creation flow",J,{sourceFile:qv}),P({type:"network",message:"Something went wrong. Please try again."}),A(!1)}};return i.length===0||!V&&E.length===0?null:u.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700",children:u.jsxs("div",{className:"p-4",children:[!L&&u.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 border border-gray-300 dark:border-gray-600 rounded-md p-4",children:[u.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:"Some email participants are not contacts in Clio."}),V&&!d&&u.jsxs("div",{className:"flex items-center gap-3 mt-3",children:[u.jsx(We,{onClick:Q,size:"sm",className:"h-9",children:"Add to Clio"}),u.jsx("button",{onClick:()=>g(!m),className:"text-sm text-blue-600 dark:text-blue-400 hover:underline",children:"How this works"})]}),m&&u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-3 leading-relaxed",children:"Create a Clio contact from email participants so Candle can show client and matter context."}),d&&u.jsxs("div",{className:"mt-4 border-t dark:border-gray-700 pt-4",children:[u.jsx("h4",{className:"text-sm font-semibold text-gray-800 dark:text-gray-200 mb-1",children:"Add contact to Clio"}),u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-4",children:"Select people on this email thread"}),F&&u.jsx("div",{role:"alert","aria-live":"assertive",className:"mb-4",children:u.jsx("div",{className:"flex items-start bg-red-50 dark:bg-red-950/30 border border-red-200 dark:border-red-800 text-red-900 dark:text-red-100 rounded-md p-3",children:u.jsxs("div",{className:"flex-1",children:[u.jsx("p",{className:"text-sm",children:F.message}),F.type==="network"&&u.jsx("div",{className:"mt-2",children:u.jsx(We,{onClick:ve,size:"sm",variant:"destructive",className:"h-7 text-xs",children:"Retry"})})]})})}),u.jsx("div",{className:"space-y-2 mb-4",children:i.map(ce=>u.jsxs("div",{className:`flex items-center gap-3 p-3 border dark:border-gray-600 rounded-md ${ce.inClio?"bg-gray-50 dark:bg-gray-800 opacity-60":"bg-white dark:bg-gray-900"}`,children:[u.jsx("input",{type:"checkbox",checked:x.includes(ce.id),onChange:()=>B(ce.id),disabled:ce.inClio,className:"h-4 w-4 text-blue-600"}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate",children:ce.name}),u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:ce.email})]}),u.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${ce.inClio?"bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-400 border border-green-300 dark:border-green-800":"bg-orange-100 dark:bg-orange-900/30 text-orange-800 dark:text-orange-400 border border-orange-300 dark:border-orange-800"}`,children:ce.inClio?"In Clio":"Not in Clio"})]},ce.id))}),x.length>0&&u.jsx("div",{className:"border-t dark:border-gray-700 pt-4 space-y-4",children:x.map(ce=>{const ne=i.find(J=>J.id===ce),xe=S[ce]||{};return ne?u.jsxs("div",{className:"space-y-3",children:[u.jsx("div",{className:"text-sm font-semibold text-gray-800 dark:text-gray-200",children:ne.name}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Contact type"}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{onClick:()=>ee(ce,"type","person"),className:`flex-1 px-3 py-2 text-sm border rounded transition-colors ${xe.type==="person"?"bg-blue-600 dark:bg-blue-700 text-white border-blue-600 dark:border-blue-700":"bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 border-gray-300 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:"Person"}),u.jsx("button",{onClick:()=>ee(ce,"type","company"),className:`flex-1 px-3 py-2 text-sm border rounded transition-colors ${xe.type==="company"?"bg-blue-600 dark:bg-blue-700 text-white border-blue-600 dark:border-blue-700":"bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 border-gray-300 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:"Company"})]})]}),xe.type==="person"?u.jsxs(u.Fragment,{children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"First name"}),u.jsx(an,{type:"text",value:xe.firstName||"",onChange:J=>ee(ce,"firstName",J.target.value),className:"h-9 text-sm"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Last name"}),u.jsx(an,{type:"text",value:xe.lastName||"",onChange:J=>ee(ce,"lastName",J.target.value),className:"h-9 text-sm"})]})]}):u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Company name"}),u.jsx(an,{type:"text",value:xe.companyName||"",onChange:J=>ee(ce,"companyName",J.target.value),className:"h-9 text-sm"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Phone number (optional)"}),u.jsx(an,{type:"tel",value:xe.phoneNumber||"",onChange:J=>ee(ce,"phoneNumber",J.target.value),placeholder:"+1 (555) 123-4567",className:"h-9 text-sm"}),xe.phoneNumber&&!bN(xe.phoneNumber)&&u.jsx("p",{className:"text-xs text-red-600 dark:text-red-400 mt-1",children:"Please enter a valid phone number (7-15 digits)"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Email"}),u.jsx(an,{type:"text",value:xe.email||"",readOnly:!0,disabled:!0,className:"h-9 text-sm"})]})]},ce):null})}),u.jsxs("div",{className:"flex gap-2 mt-4 pt-4 border-t dark:border-gray-700",children:[u.jsx(We,{onClick:ve,disabled:x.length===0||R,size:"sm",className:"h-9",children:R?"Creating...":"Create contact"}),u.jsx(We,{onClick:fe,variant:"outline",size:"sm",className:"h-9",children:"Cancel"})]})]})]}),L&&u.jsxs("div",{className:"bg-green-50 dark:bg-green-900/30 border border-green-200 dark:border-green-700 rounded-md p-4",children:[u.jsx("h4",{className:"text-sm font-semibold text-green-900 dark:text-green-100 mb-2",children:"This contact has been added in Clio"}),u.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mb-2",children:"Clio may take a few minutes to show updates."}),u.jsx("div",{className:"space-y-2",children:E.map(ce=>u.jsxs("div",{className:"flex items-center justify-between p-2 bg-white dark:bg-gray-800 rounded-md border border-gray-200 dark:border-gray-600",children:[u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate",children:ce.name}),u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:ce.email})]}),u.jsx("span",{className:"px-2 py-1 text-xs bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-400 border border-green-300 dark:border-green-800 rounded-full",children:"In Clio"})]},ce.id))}),u.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-3",children:"Go to the Matter section below to link this contact to a matter."}),V&&u.jsx(We,{onClick:()=>{G(!1),p(!0)},size:"sm",variant:"outline",className:"h-8 text-xs mt-3",children:"Add more contacts"})]})]})})},sK=({clientEmail:r,emailParticipants:e,emailParticipantClients:t,currentClientIndex:n,setCurrentClientIndex:s,setClientEmail:i,isManuallySet:c,selectedClientDetails:d,linkableFields:p,isLoading:m,ClientNavigation:g,handleSectionClick:x,tempClientEmail:b,setTempClientEmail:S,setIsManuallySet:T,isValidClient:E,isTempEmailValid:C,showClientDocumentsButton:R,isValidating:A,fetchError:F=!1,hasTransientError:P=!1,onContactsCreated:L,getClientNameFromCache:G,isClientDataValidationComplete:U})=>{var ve;zr();const V=()=>u.jsx(Gs,{rows:2}),Q=(ve=p.find(ce=>ce.field==="Name"))==null?void 0:ve.url,fe=()=>u.jsxs("div",{className:"flex items-center px-3 py-1 bg-gray-50 dark:bg-gray-800 border-b dark:border-gray-700 gap-2",children:[u.jsx("div",{className:"flex-1 min-w-0 flex items-center",children:u.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-300 truncate",title:b||"",children:[b," (Manually set)"]})}),Q&&u.jsxs("a",{href:Q,target:"_blank",rel:"noopener noreferrer",className:"h-8 text-xs text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 border border-blue-200 dark:border-blue-800 px-3 flex-shrink-0 rounded-md inline-flex items-center gap-1 no-underline hover:no-underline",children:[u.jsx(Ba,{className:"w-3 h-3"}),"View"]})]}),B=()=>u.jsx(ru,{details:d}),ee=()=>{let ce="Select a client email thread to view client information";return c&&r?ce=`No client information found for ${r}`:e.length>0&&(t.length===0?ce=`No client information available for emails on the selected thread: ${e.join(", ")}`:ce="No client information available for the selected email ID"),u.jsx("div",{className:"p-3 text-sm text-gray-600 dark:text-gray-400",children:u.jsx("p",{className:"mb-2",children:ce})})};return u.jsxs("div",{className:"w-full min-h-[4rem] border border-border/50 rounded-lg shadow-sm bg-card text-card-foreground",title:"Client Information",children:[u.jsxs("div",{className:"flex items-center justify-between p-2 border-b bg-muted",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(Iy,{className:"w-3.5 h-3.5 text-slate-600 dark:text-gray-300"}),u.jsx("span",{className:"font-medium text-sm text-slate-800 dark:text-white",children:"CONTACT"})]}),u.jsxs(Ws,{children:[u.jsx(Vs,{asChild:!0,children:u.jsx(We,{variant:"ghost",size:"icon",className:"h-6 w-6 hidden",children:u.jsx(lo,{className:"h-4 w-4"})})}),u.jsx(_s,{align:"end",className:"p-2",children:u.jsx("div",{className:"flex flex-col gap-2 w-64",children:u.jsxs("div",{className:"flex gap-2 items-center",children:[u.jsx(an,{type:"email",value:b||"",onChange:ce=>S(ce.target.value),placeholder:"Set client email",className:`flex-1 px-2 py-1 h-8 text-xs ${C===!1?"border-red-300 focus:ring-red-500":""}`}),u.jsx(We,{variant:"outline",size:"sm",className:`h-8 text-xs px-2 ${C===!1?"bg-red-50 hover:bg-red-100":""}`,onClick:()=>{i(b||""),T(!0)},disabled:!b,title:C===!1?"Warning: This email is not recognized as a valid client in Clio":"Set email as current client",children:"Search"})]})})})]})]}),m?V():F?u.jsxs(Xm,{variant:"destructive",className:"m-2",children:[u.jsx(qm,{className:"h-4 w-4"}),u.jsx(Qm,{className:"ml-2",children:"Failed to fetch contact data. Please refresh to try again."})]}):u.jsxs(u.Fragment,{children:[t.length>0&&!c&&u.jsx(g,{clientUrl:Q}),c&&r&&u.jsx(fe,{}),d&&Object.keys(d).length>0?u.jsx(B,{}):A&&!c?u.jsx(Gs,{rows:2}):P&&!c?u.jsx("div",{className:"flex justify-center p-2",children:u.jsxs(Xm,{variant:"default",className:"w-full border-amber-200 bg-amber-50 dark:border-amber-800 dark:bg-amber-950",children:[u.jsx(qm,{className:"h-4 w-4 text-amber-600 dark:text-amber-400"}),u.jsx(Qm,{className:"ml-2 text-amber-800 dark:text-amber-200",children:"Request timed out. Please try again later."})]})}):u.jsx(ee,{})]}),U&&!c&&e.length!==t.length&&G&&u.jsx(nK,{emailParticipants:e,emailParticipantClients:t,getClientNameFromCache:G,onContactsCreated:L})]})},Kv="src/shared/components/sidepanel/panels/components/ClioMatterLinking.tsx",_w=({createdContacts:r,onMatterLinked:e})=>{const t=zr(),[n,s]=w.useState(!1),[i,c]=w.useState(""),[d,p]=w.useState(!1),[m,g]=w.useState(null),[x,b]=w.useState([]),[S,T]=w.useState([]),[E,C]=w.useState({}),[R,A]=w.useState(!1),[F,P]=w.useState(null),[L,G]=w.useState(null),[U,V]=w.useState(!1),Q=()=>{s(!0),P(null),T(r.map(ne=>ne.id))},fe=()=>{s(!1),c(""),p(!1),g(null),P(null),C({})},B=async ne=>{if(c(ne),p(!0),!ne){g(null),b([]);return}if(ne.length<3){b([]);return}V(!0);try{const J=((await Qy("clio",ne,t)).projects||[]).map(X=>{var z;return{id:String(((z=X.projectId)==null?void 0:z.native)||""),name:X.projectName||"",status:X.isArchived?"closed":"open",description:X.projectName||""}});b(J)}catch(xe){t.error("Error searching matters",xe,{sourceFile:Kv,searchQuery:ne})}finally{V(!1)}},ee=ne=>{g(ne),c(ne.name),p(!1)},ve=ne=>{T(xe=>xe.includes(ne)?xe.filter(J=>J!==ne):[...xe,ne])},ce=async()=>{if(m){A(!0),P(null);try{const ne=[];for(const xe of S){const J=E[xe]||"Related Contact";try{await w8("clio",xe,m.id,J,t),ne.push(xe),t.info("Contact linked to matter successfully",{sourceFile:Kv})}catch(X){t.error("Error linking contact to matter",X,{sourceFile:Kv}),X instanceof Error&&(X.message.includes("permission")?P({type:"permission",message:"You do not have permission to modify matters in Clio. Contact your admin."}):P({type:"network",message:"Something went wrong. Please try again."})),ne.length>0&&(T(z=>z.filter(q=>!ne.includes(q))),e&&e(m.id)),A(!1);return}}G(m),s(!1),A(!1),e&&e(m.id)}catch(ne){t.error("Unexpected error in matter linking flow",ne,{sourceFile:Kv}),P({type:"network",message:"Something went wrong. Please try again."}),A(!1)}}};return u.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700",children:u.jsxs("div",{className:"p-2",children:[!n&&!L&&u.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 border border-gray-300 dark:border-gray-600 rounded-md p-4",children:[u.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:"Link the created contact(s) to a matter as related contacts."}),u.jsx(We,{onClick:Q,size:"sm",className:"h-9",children:"Add to a matter"})]}),n&&u.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 border border-gray-300 dark:border-gray-600 rounded-md p-4",children:[u.jsx("h4",{className:"text-sm font-semibold text-gray-800 dark:text-gray-200 mb-1",children:"Link matter as a related contact"}),u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-4",children:"Add as a related contact in Clio"}),F&&u.jsx("div",{role:"alert","aria-live":"assertive",className:"mb-4",children:u.jsx("div",{className:"flex items-start bg-red-50 dark:bg-red-950/30 border border-red-200 dark:border-red-800 text-red-900 dark:text-red-100 rounded-md p-3",children:u.jsxs("div",{className:"flex-1",children:[u.jsx("p",{className:"text-sm",children:F.message}),F.type==="network"&&u.jsx("div",{className:"mt-2",children:u.jsx(We,{onClick:ce,size:"sm",variant:"destructive",className:"h-7 text-xs",children:"Retry"})})]})})}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Matter"}),u.jsx(an,{type:"text",placeholder:"Search matters...",value:i,onChange:ne=>B(ne.target.value),onFocus:()=>p(!0),className:"h-9 text-sm"}),d&&i&&x.length>0&&u.jsx("div",{className:"mt-1 max-h-48 overflow-y-auto border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 shadow-lg",children:x.map(ne=>u.jsxs("div",{onClick:()=>ee(ne),className:"flex items-center justify-between p-3 hover:bg-gray-50 dark:hover:bg-gray-700 cursor-pointer border-b dark:border-gray-600 last:border-b-0",children:[u.jsx("div",{className:"text-sm text-gray-900 dark:text-gray-100 flex-1 truncate",children:ne.name}),u.jsx("span",{className:`ml-2 px-2 py-1 text-xs rounded-full ${ne.status==="open"?"bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-400 border border-blue-300 dark:border-blue-800":"bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-300 border border-gray-300 dark:border-gray-700"}`,children:ne.status==="open"?"Open":"Closed"})]},ne.id))}),U&&u.jsx("div",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400",children:"Searching matters..."})]}),m&&u.jsx(u.Fragment,{children:u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Related contact(s) to add"}),r.map(ne=>u.jsxs("div",{className:"mb-4",children:[u.jsxs("div",{className:"flex items-center gap-3 p-3 border dark:border-gray-600 rounded-md bg-white dark:bg-gray-800",children:[u.jsx("input",{type:"checkbox",checked:S.includes(ne.id),onChange:()=>ve(ne.id),className:"h-4 w-4 text-blue-600"}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate",children:ne.name}),u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:ne.email})]})]}),S.includes(ne.id)&&u.jsxs("div",{className:"mt-2",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Relationship"}),u.jsx(an,{type:"text",placeholder:"e.g., Opposing Counsel, Co-Counsel, Employee",value:E[ne.id]||"",onChange:xe=>C(J=>({...J,[ne.id]:xe.target.value})),className:"h-9 text-sm"})]})]},ne.id))]})}),u.jsxs("div",{className:"flex gap-2 pt-4 border-t dark:border-gray-700",children:[u.jsx(We,{onClick:ce,disabled:!m||S.length===0||R,size:"sm",className:"h-9",children:R?"Saving...":"Save"}),u.jsx(We,{onClick:fe,variant:"outline",size:"sm",className:"h-9",children:"Back"})]})]}),L&&!n&&u.jsxs("div",{className:"bg-green-50 dark:bg-green-900/30 border border-green-200 dark:border-green-700 rounded-md p-4",children:[u.jsx("h4",{className:"text-sm font-semibold text-green-900 dark:text-green-100 mb-3",children:"Added to matter"}),u.jsx("div",{className:"mb-3 p-3 bg-white dark:bg-gray-800 rounded-md border border-gray-200 dark:border-gray-600",children:u.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:L.name})}),u.jsx("div",{className:"space-y-2 mb-3",children:r.filter(ne=>S.includes(ne.id)).map(ne=>u.jsxs("div",{className:"flex items-center justify-between p-2 bg-white dark:bg-gray-800 rounded-md border border-gray-200 dark:border-gray-600",children:[u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate",children:ne.name}),u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:E[ne.id]||"Related contact"})]}),u.jsxs("a",{href:`https://app.clio.com/nc#/contacts/${ne.id}`,target:"_blank",rel:"noopener noreferrer",className:"h-7 text-xs text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 border border-blue-200 dark:border-blue-800 px-2 flex-shrink-0 rounded-md inline-flex items-center gap-1 no-underline hover:no-underline ml-2",children:[u.jsx(Ba,{className:"w-3 h-3"}),"View"]})]},ne.id))}),u.jsx("div",{className:"flex gap-2",children:u.jsx(We,{onClick:()=>{G(null),s(!0),g(null),c(""),C({})},variant:"outline",size:"sm",className:"h-9 whitespace-nowrap",children:"Link another matter"})})]})]})})},Dl="src/shared/components/sidepanel/panels/components/ClioCaseInfoBox.tsx",oK=({clientEmail:r,selectedCaseDetails:e,casesForCurrentClient:t,currentCaseIndex:n,linkableFields:s,nextCase:i,prevCase:c,isLoading:d,isManuallySet:p,setCurrentCaseIndex:m,calendarEntries:g=[],isValidating:x=!1,caseUrl:b,matterId:S,onMatterManuallySelected:T,fetchError:E=!1,hasTransientError:C=!1,userData:R,createdContacts:A=[],onMatterLinked:F,pageSize:P=5,currentPage:L=1,totalMatters:G,onNavigateToPage:U,allMatterSummaries:V=[],isLoadingMatterDetails:Q=!1,matterDetailError:fe=!1})=>{var Uo,zo;const B=zr(),ee=aa(),[ve,ce]=w.useState(!1),[ne,xe]=w.useState(!1),[J,X]=w.useState(!1),[z,q]=w.useState(!1),[O,$]=w.useState(""),[ae,be]=w.useState(!1),ie=w.useRef(!1),[K,de]=w.useState(""),[ge,se]=w.useState([]),[Te,qe]=w.useState(!1),[ze,Be]=w.useState(!1),[Ce,vt]=w.useState(null),[kt,yt]=w.useState(null),At=w.useMemo(()=>{if(V.length>0&&S){const Se=V.findIndex($e=>$e.id===S);if(Se!==-1)return Se+1}return(L-1)*P+n+1},[V,S,L,P,n]),[It,Yt]=w.useState(!1),[Xt,Or]=w.useState(""),[vr,dn]=w.useState(""),[_e,Fe]=w.useState(new Date().toISOString().split("T")[0]),[nt,ft]=w.useState("Normal"),[Ut,Ue]=w.useState(!1),[He,Mt]=w.useState(!1),[Ie,St]=w.useState(!1),ht=w.useRef(!1),Ge=w.useRef(null),cr=w.useRef(!1),[zt,yr]=w.useState(null),[tr,ar]=w.useState(null),[Jn,ls]=w.useState(!0),[qs,ho]=w.useState(!1),[Er,vn]=w.useState(""),[Lo,cs]=w.useState([]),[he,Ke]=w.useState(!1),[_t,pt]=w.useState(!1),[tt,ut]=w.useState(null),[lt,Jt]=w.useState(""),[Mn,Wr]=w.useState(""),[rr,$n]=w.useState(!1),[po,ui]=w.useState(1),[fa,Qa]=w.useState("Days"),[mt]=w.useState("Email"),[te,Le]=w.useState(!1),[st,jr]=w.useState(!0),[qt,Vr]=w.useState(!0),[fn,ks]=w.useState(!0),[us,di]=w.useState(!1),[qr,fi]=w.useState(""),[Un,vd]=w.useState(""),[zn,nu]=w.useState(new Date().toISOString().split("T")[0]),[su,Jl]=w.useState(!1),[mo,Mo]=w.useState(null),go=()=>{Or(""),dn(""),Fe(new Date().toISOString().split("T")[0]),ft("Normal"),Jt((R==null?void 0:R.id)||""),Wr((R==null?void 0:R.name)||""),vn(""),cs([]),ut(null),$n(!1),ui(1),Qa("Days"),ht.current=!1,yr(null),ls(!0),jr(!0),Vr(!0)},hi=()=>{fi(""),vd(""),nu(new Date().toISOString().split("T")[0]),Mo(null)};w.useEffect(()=>{ar(null)},[S]),w.useEffect(()=>{if(!zt)return;const Se=setTimeout(()=>yr(null),5e3);return()=>clearTimeout(Se)},[zt]),w.useEffect(()=>{if(!mo)return;const Se=setTimeout(()=>Mo(null),5e3);return()=>clearTimeout(Se)},[mo]),w.useEffect(()=>{const Se=!!(lt&&(R!=null&&R.id)&&lt!==R.id);ks(!Se)},[lt,R]),w.useEffect(()=>{A&&A.length>0?ho(!0):ho(!1)},[A]),w.useEffect(()=>{S||(go(),Yt(!1)),It||(ht.current=!1)},[It,S]),w.useEffect(()=>{It&&R&&!lt&&(Jt(R.id),Wr(R.name))},[It,R,lt]);const yd=w.useMemo(()=>By.debounce(async Se=>{if(!Se.trim()||Se.length<2){cs([]),ut(null);return}Ke(!0),ut(null);try{const $e=await kT(B),Ve=Se.toLowerCase();if($e){const Pt=$e.filter($t=>$t.name.toLowerCase().includes(Ve)).sort(($t,Et)=>{const ot=$t.name.toLowerCase().startsWith(Ve),ct=Et.name.toLowerCase().startsWith(Ve);return ot!==ct?ot?-1:1:$t.name.localeCompare(Et.name)});cs(Pt),Pt.length===0&&ut(`No users found for "${Se}"`)}else{cr.current||(cr.current=!0,UT("clio",B).then($t=>CT($t.map(({id:Et,name:ot})=>({id:Et,name:ot})),B)).catch($t=>B.error("Failed to refresh firm users cache",$t,{sourceFile:Dl})).finally(()=>{cr.current=!1}));const Pt=await m8("clio",Se,B);cs((Pt.users||[]).map(({id:$t,name:Et})=>({id:$t,name:Et}))),(Pt.users||[]).length===0&&ut(`No users found for "${Se}"`)}}catch($e){B.error("Assignee search failed",$e,{sourceFile:Dl}),ut("Failed to search users. Please try again."),cs([])}finally{Ke(!1)}},400),[B]);w.useEffect(()=>{const Se=async $e=>{if(!$e){go(),Yt(!1);return}if($e.threadId!=Ge.current){go(),Yt(!1),Ge.current=String($e.threadId),ar(null);return}};return ee&&(ee.onThreadChanged(Se),ee.getCurrentThread().then($e=>{Se($e)}).catch($e=>{B.error("Error getting initial thread",$e,{sourceFile:"ClioCaseInfoBox.tsx"})})),()=>{ee==null||ee.removeThreadListener(Se)}},[ee,B]),w.useEffect(()=>{(async()=>{var $e;if(It&&!ht.current){ht.current=!0,Ue(!0);try{const Ve=await ee.getCurrentThread();if(Ve&&(($e=Ve==null?void 0:Ve.messages)==null?void 0:$e.length)>0){const Pt=Ve.messages[Ve.messages.length-1].subject,$t=Ve.messages[Ve.messages.length-1].body,Et="Subject: "+Pt+`
Body: `+$t,ot=await g8("clio",Et,B);Or(ot.name),dn(ot.description)}}catch(Ve){B.error("Failed to generate task description",Ve,{sourceFile:Dl})}finally{Ue(!1)}}})()},[It,ee,B]);const Ch=async()=>{var Ve;yr(null);const Se=[];if(Xt.trim()||Se.push("Task Name"),vr.trim()||Se.push("Task Description"),S||Se.push("Matter"),lt||Se.push("Assign To"),(!_e||!/^\d{4}-\d{2}-\d{2}$/.test(_e)||Number.isNaN(Date.parse(_e)))&&Se.push("Date"),Se.length>0){yr({type:"error",text:`Please fill in the following fields: ${Se.join(", ")}`});return}Mt(!0);try{const Pt=_e?new Date(_e).toISOString():null;let $t=vr;if(Jn){const ct=await ee.getCurrentThread();if(!ct||((Ve=ct==null?void 0:ct.messages)==null?void 0:Ve.length)<1){yr({type:"error",text:"Something went wrong. Please try again"});return}const An=ct.messages[ct.messages.length-1].body;$t=vr+`

Referenced Email Below

`+An}await v8("clio",Xt,$t,S,Pt,nt,B,lt||void 0,rr?{value:po,unit:fa,method:mt,assigneeId:lt||void 0}:void 0,fn?void 0:{notifyAssignee:st,notifyCompletion:qt}),go(),Yt(!1),yr({type:"success",text:"Task created successfully!"}),ar({name:Xt,description:vr,due_at:_e,priority:nt})}catch(Pt){B.error("Failed to create task",Pt,{sourceFile:Dl}),yr({type:"error",text:"Failed to create task. Please try again."})}finally{Mt(!1)}},Xl=async()=>{Jl(!0),Mo(null);const Se=[];if(qr.trim()||Se.push("Subject"),Un.trim()||Se.push("Note"),S||Se.push("Matter"),(!zn||!/^\d{4}-\d{2}-\d{2}$/.test(zn)||Number.isNaN(Date.parse(zn)))&&Se.push("Date"),Se.length>0){Mo({type:"error",text:`Please fill in: ${Se.join(", ")}`}),Jl(!1);return}try{const Ve=await y8("clio",qr,Un,zn,S,null,B);B.info("Note created successfully",{sourceFile:Dl,noteId:Ve.noteId}),hi(),di(!1),Mo({type:"success",text:"Note created successfully!"})}catch(Ve){B.error("Error creating note",Ve,{sourceFile:Dl}),Mo({type:"error",text:Ve instanceof Error?Ve.message:"Failed to create note"})}finally{Jl(!1)}};w.useMemo(()=>{if(!O.trim())return t;const Se=O.toLowerCase();return t.filter($e=>String($e.description||"").toLowerCase().includes(Se))},[t,O]);const ou=Se=>{if(be(Se),ie.current){Se&&(ie.current=!1);return}const $e=kt||S;if(Se&&V.length>0&&$e){const Ve=V.findIndex(Pt=>Pt.id===$e);if(Ve!==-1){const Pt=Math.floor(Ve/P)+1;Pt!==L&&U&&U(Pt)}}Se||$("")},Za=w.useMemo(()=>By.debounce(async Se=>{if(!Se.trim()||Se.length<2){se([]),vt(null);return}qe(!0),vt(null);try{const $e=await Qy("clio",Se,B);se($e.projects||[]),$e.projects.length===0&&vt(`No matters found for "${Se}"`)}catch($e){B.error("Matter search failed",$e,{sourceFile:Dl}),vt("Failed to search matters. Please try again."),se([])}finally{qe(!1)}},400),[B]),el=Se=>{var $e,Ve;try{const Pt={id:((Ve=($e=Se.projectId)==null?void 0:$e.native)==null?void 0:Ve.toString())||"",description:Se.projectName||"",practice_area:Se.projectTypeName||"",matter_stage:Se.phaseName||"",status:Se.isArchived?"Closed":"Open",client_name:Se.clientName||"",responsible_attorney:Se.firstPrimaryName||"",url:Se.projectUrl||"",name:Se.projectName||""};B.info("Matter manually selected via search",{matterId:Pt.id,matterName:Pt.description,sourceFile:Dl}),T&&T(Pt),Be(!1),de(""),se([]),vt(null)}catch(Pt){B.error("Failed to select matter",Pt,{sourceFile:Dl})}},xd=()=>u.jsx(Gs,{rows:2}),tl=Se=>{if(yt(null),m)m(Se);else if(Se>n)for(let $e=n;$e<Se;$e++)i();else if(Se<n)for(let $e=n;$e>Se;$e--)c()},ur=Se=>{try{const $e=Se.split("T")[0];if(!$e)return Se;const[Ve,Pt,$t]=$e.split("-").map(Number);return isNaN(Ve)||isNaN(Pt)||isNaN($t)||Pt<1||Pt>12?Se:`${["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][Pt-1]} ${$t}, ${Ve}`}catch{return Se}},$o=Se=>{try{const $e=Se.split("T")[1];if(!$e)return"";const Ve=$e.split(/[Z+-]/)[0],[Pt,$t]=Ve.split(":").map(Number);if(isNaN(Pt)||isNaN($t))return"";const Et=Pt>=12?"PM":"AM",ot=Pt%12||12,ct=$t.toString().padStart(2,"0");return`${ot}:${ct} ${Et}`}catch{return""}},iu=Se=>Se?(new DOMParser().parseFromString(Se,"text/html").body.textContent||"").length>200:!1,rl=Se=>{const $e=["a","b","br","div","em","i","li","ol","p","s","strong","u","ul"],Ve=["href","rel","type","target"],$t=new DOMParser().parseFromString(Se,"text/html"),Et=$t.body.getElementsByTagName("*");for(let ot=Et.length-1;ot>=0;ot--){const ct=Et[ot];$e.includes(ct.tagName.toLowerCase())?Array.from(ct.attributes).forEach(Ns=>{Ve.includes(Ns.name.toLowerCase())||ct.removeAttribute(Ns.name)}):ct.replaceWith(document.createTextNode(ct.textContent||""))}return $t.body.innerHTML},wd=()=>{if(!t.length||n>=t.length)return[];const Se=t[n],$e=String(Se.id||"");return $e?g.filter(Ve=>{var $t;return String((($t=Ve.matter)==null?void 0:$t.id)||Ve.case_id||"")===$e}):[]},au=Se=>{const $e=String(Se.start_at||Se.date||"");if(!$e)return!1;try{return new Date($e)>=new Date}catch{return!1}},lu=()=>{const $e=wd().filter(au).sort((Ve,Pt)=>{const $t=new Date(String(Ve.start_at||Ve.date||"")),Et=new Date(String(Pt.start_at||Pt.date||""));return $t.getTime()-Et.getTime()});return $e.length>0?[$e[0]]:$e},Ql=()=>{const Se=lu(),$e=t.length>0&&n<t.length?t[n]:null,Ve=$e==null?void 0:$e.id,Pt=Ve?`https://app.clio.com/nc/#/matters/${Ve}/calendar`:null;return u.jsxs("div",{className:"border-t bg-card",children:[u.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800",children:[u.jsxs("div",{className:"flex items-center gap-2 cursor-pointer flex-1 hover:opacity-80 transition-opacity",onClick:()=>ce(!ve),children:[u.jsx(Gf,{className:"w-4 h-4 text-slate-600 dark:text-gray-300"}),u.jsx("span",{className:"font-medium text-sm text-slate-800 dark:text-white",children:"Next Event"}),Se.length>0&&!d&&(ve?u.jsx(ry,{className:"w-4 h-4 text-gray-400"}):u.jsx(ws,{className:"w-4 h-4 text-gray-400"}))]}),Pt&&u.jsxs("a",{href:Pt,target:"_blank",rel:"noopener noreferrer",className:"h-7 text-xs text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 border border-blue-200 dark:border-blue-800 px-2 flex-shrink-0 rounded-md inline-flex items-center gap-1 no-underline hover:no-underline",onClick:$t=>$t.stopPropagation(),children:[u.jsx(Ba,{className:"w-3 h-3"}),"View all"]})]}),!ve&&u.jsx(u.Fragment,{children:d?u.jsx(Gs,{rows:2}):Se.length>0?u.jsx("div",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:Se.map(($t,Et)=>{const ot=String($t.start_at||$t.date||""),ct=String($t.end_at||""),An=String($t.summary||$t.title||"Calendar Event"),Ns=String($t.location||"");return u.jsxs("div",{className:"p-3 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:[u.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-gray-100 mb-1",children:An}),u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"space-y-1",children:[u.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600 dark:text-gray-400",children:[u.jsx(Gf,{className:"w-3 h-3"}),u.jsx("span",{children:ur(ot)})]}),Ns&&u.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600 dark:text-gray-400",children:[u.jsx(wB,{className:"w-3 h-3"}),u.jsx("span",{children:Ns})]})]}),u.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600 dark:text-gray-400",children:[u.jsx(Dv,{className:"w-3 h-3"}),u.jsxs("span",{children:[$o(ot),ct&&` - ${$o(ct)}`]})]})]})]},Et)})}):u.jsx("div",{className:"p-3 text-sm text-gray-600 dark:text-gray-400",children:r&&t.length>0?u.jsx(u.Fragment,{children:u.jsx("p",{className:"mb-2",children:"No upcoming calendar entries found for this case"})}):"Select a client email thread to view calendar entries"})})]})},nl=()=>{const Se=t.length>0&&n<t.length?t[n]:null,$e=Se==null?void 0:Se.last_completed_task,Ve=Se==null?void 0:Se.next_upcoming_task,Pt=$e||Ve,$t=Se==null?void 0:Se.id,Et=$t?`https://app.clio.com/nc/#/matters/${$t}/tasks`:null;return u.jsxs("div",{className:"border-t bg-card",children:[u.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800",children:[u.jsxs("div",{className:"flex items-center gap-2 cursor-pointer flex-1 hover:opacity-80 transition-opacity",onClick:()=>xe(!ne),children:[u.jsx(xB,{className:"w-4 h-4 text-slate-600 dark:text-gray-300"}),u.jsx("span",{className:"font-medium text-sm text-slate-800 dark:text-white",children:"Tasks"}),(Pt||It)&&!d&&(ne?u.jsx(ry,{className:"w-4 h-4 text-gray-400"}):u.jsx(ws,{className:"w-4 h-4 text-gray-400"}))]}),u.jsxs("div",{className:"flex items-center gap-2",children:[S&&(It?u.jsxs(We,{variant:"ghost",size:"sm",className:"h-7 text-xs text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 px-2",onClick:ot=>{ot.stopPropagation(),Yt(!1),go()},children:[u.jsx(Ok,{className:"w-3 h-3 mr-1"}),"Remove"]}):u.jsxs(We,{variant:"ghost",size:"sm",className:"h-7 text-xs text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 px-2",onClick:ot=>{ot.stopPropagation(),Yt(!0)},children:[u.jsx(Dk,{className:"w-3 h-3 mr-1"}),"Add Task"]})),Et&&u.jsxs("a",{href:Et,target:"_blank",rel:"noopener noreferrer",className:"h-7 text-xs text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 border border-blue-200 dark:border-blue-800 px-2 flex-shrink-0 rounded-md inline-flex items-center gap-1 no-underline hover:no-underline",onClick:ot=>ot.stopPropagation(),children:[u.jsx(Ba,{className:"w-3 h-3"}),"View all"]})]})]}),!ne&&u.jsxs(u.Fragment,{children:[It&&u.jsx("div",{className:"p-3 border-b border-gray-200 dark:border-gray-700 bg-gray-50/50 dark:bg-gray-800/50",children:u.jsxs("div",{className:"space-y-3",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Task Name"}),u.jsx(an,{disabled:Ut,placeholder:Ut?"Generating task name...":"Enter task name...",value:Xt,onChange:ot=>Or(ot.target.value),className:"h-8 text-sm"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Task Description"}),u.jsx("textarea",{placeholder:Ut?"Generating task description...":"Enter task description...",value:vr,onChange:ot=>dn(ot.target.value),disabled:Ut,className:`w-full min-h-[80px] px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 resize-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${Ut?"opacity-60 cursor-not-allowed":""}`}),Ut&&u.jsxs("div",{className:"flex items-center gap-2 mt-1 text-xs text-gray-500 dark:text-gray-400",children:[u.jsx("div",{className:"w-3 h-3 border-2 border-gray-300 border-t-blue-600 rounded-full animate-spin"}),"Generating task from email..."]})]}),u.jsxs("div",{className:"flex gap-3",children:[u.jsxs("div",{className:"flex-1",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Due At"}),u.jsx(an,{type:"date",value:_e,onChange:ot=>Fe(ot.target.value),className:"h-8 text-sm"})]}),u.jsxs("div",{className:"flex-1",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Priority"}),u.jsxs(Ws,{open:Ie,onOpenChange:St,children:[u.jsx(Vs,{asChild:!0,children:u.jsxs(We,{variant:"outline",className:"w-full h-8 text-sm justify-between font-normal",children:[u.jsx("span",{children:nt}),u.jsx(ws,{className:"w-3 h-3 ml-2 flex-shrink-0"})]})}),u.jsx(_s,{align:"start",className:"w-[140px]",children:["High","Normal","Low"].map(ot=>u.jsx(is,{className:`cursor-pointer ${nt===ot?"bg-gray-100 dark:bg-gray-700":""}`,onClick:()=>{ft(ot),St(!1)},children:ot},ot))})]})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Assign To"}),u.jsxs(Ws,{open:_t,onOpenChange:pt,children:[u.jsx(Vs,{asChild:!0,children:u.jsxs(We,{variant:"outline",className:"w-full h-8 text-sm justify-between font-normal",children:[u.jsx("span",{className:"truncate",children:Mn||"Select assignee"}),u.jsx(ws,{className:"w-3 h-3 ml-2 flex-shrink-0"})]})}),u.jsxs(_s,{align:"start",className:"w-[320px] p-0",children:[u.jsxs("div",{className:"p-3 border-b border-gray-200 dark:border-gray-700",children:[u.jsx("div",{className:"text-sm font-medium mb-2 text-gray-800 dark:text-gray-200",children:"Search Users"}),u.jsxs("div",{className:"relative",children:[u.jsx(lo,{className:"absolute left-2 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),u.jsx(an,{placeholder:"Search by name...",value:Er,onChange:ot=>{const ct=ot.target.value;vn(ct),yd(ct)},className:"pl-8 pr-8 h-9 text-sm",autoFocus:!0,onClick:ot=>ot.stopPropagation(),onKeyDown:ot=>ot.stopPropagation()}),Er&&u.jsx("button",{onClick:ot=>{ot.stopPropagation(),vn(""),cs([]),ut(null)},className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:u.jsx(Oi,{className:"w-4 h-4"})})]})]}),u.jsx("div",{className:"max-h-[300px] overflow-y-auto",children:he?u.jsxs("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 flex items-center gap-2",children:[u.jsx("div",{className:"w-4 h-4 border-2 border-gray-300 border-t-gray-600 rounded-full animate-spin"}),"Searching..."]}):tt&&Lo.length===0?u.jsx("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:tt}):Lo.length>0?Lo.map(ot=>u.jsx(is,{className:"flex flex-col items-start p-3 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-800",onClick:()=>{Jt(ot.id),Wr(ot.name),pt(!1),vn(""),cs([])},children:u.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-gray-100",children:ot.name})},ot.id)):Er.trim().length>=2&&!he?u.jsxs("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:['No users found for "',Er,'"']}):u.jsx("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:Mn?u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Currently assigned to: ",Mn]}),u.jsx("div",{className:"text-xs",children:"Type at least 2 characters to search for other users..."})]}):"Type at least 2 characters to search users..."})})]})]})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("input",{type:"checkbox",id:"hasReminder",checked:rr,onChange:ot=>$n(ot.target.checked),className:"cursor-pointer"}),u.jsx("label",{htmlFor:"hasReminder",className:"text-xs font-medium text-gray-700 dark:text-gray-300 cursor-pointer",children:"Add Reminder"})]}),rr&&u.jsxs("div",{className:"pl-5 space-y-2 border-l-2 border-gray-200 dark:border-gray-600",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Remind"}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx(an,{type:"number",min:"1",value:po,onChange:ot=>ui(Math.max(1,parseInt(ot.target.value)||1)),className:"h-8 text-sm w-20"}),u.jsxs(Ws,{open:te,onOpenChange:Le,children:[u.jsx(Vs,{asChild:!0,children:u.jsxs(We,{variant:"outline",className:"flex-1 h-8 text-sm justify-between font-normal",children:[u.jsx("span",{children:fa}),u.jsx(ws,{className:"w-3 h-3 ml-2 flex-shrink-0"})]})}),u.jsx(_s,{align:"start",className:"w-[140px]",children:["Minutes","Hours","Days","Weeks"].map(ot=>u.jsx(is,{className:`cursor-pointer ${fa===ot?"bg-gray-100 dark:bg-gray-700":""}`,onClick:()=>{Qa(ot),Le(!1)},children:ot},ot))})]})]}),u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"before due date"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Delivery Method"}),u.jsx("div",{className:"w-full h-8 px-3 text-sm flex items-center border border-input rounded-md bg-gray-50 dark:bg-gray-800 text-gray-700 dark:text-gray-300",children:"Email"})]})]})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("input",{type:"checkbox",id:"appendEmailToDescription",checked:Jn,onChange:ot=>ls(ot.target.checked),className:"cursor-pointer"}),u.jsx("label",{htmlFor:"appendEmailToDescription",className:"text-xs text-gray-700 dark:text-gray-300 cursor-pointer",children:"Append email to Description"})]}),!fn&&u.jsxs("div",{className:"space-y-2 pt-2 border-t border-gray-200 dark:border-gray-700",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("input",{type:"checkbox",id:"notifyAssignee",checked:st,onChange:ot=>jr(ot.target.checked),className:"cursor-pointer"}),u.jsx("label",{htmlFor:"notifyAssignee",className:"text-xs text-gray-700 dark:text-gray-300 cursor-pointer",children:"Notify assignee when task is assigned"})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("input",{type:"checkbox",id:"notifyCompletion",checked:qt,onChange:ot=>Vr(ot.target.checked),className:"cursor-pointer"}),u.jsx("label",{htmlFor:"notifyCompletion",className:"text-xs text-gray-700 dark:text-gray-300 cursor-pointer",children:"Notify me when task is completed"})]})]}),u.jsx(We,{onClick:Ch,disabled:He,className:"w-full h-8 text-sm",children:He?"Creating task in Clio...":"Create Task"})]})}),zt&&u.jsx("div",{className:`p-2 rounded-md text-sm ${zt.type==="success"?"bg-green-50 dark:bg-green-900/20 text-green-700 dark:text-green-400 border border-green-200 dark:border-green-800":"bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-400 border border-red-200 dark:border-red-800"}`,children:zt.text}),tr&&u.jsx("div",{className:"p-3 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:u.jsxs("div",{className:"flex items-start gap-2 mb-2",children:[u.jsx(Dv,{className:"w-4 h-4 text-blue-600 dark:text-blue-400 mt-0.5 flex-shrink-0"}),u.jsxs("div",{className:"flex-1",children:[u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 font-medium mb-1",children:"Newly Created Task"}),u.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-gray-100 mb-1",children:String(tr.name||"Untitled Task")}),u.jsxs("div",{className:"space-y-1",children:[!!tr.due_at&&u.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600 dark:text-gray-400",children:[u.jsx(Gf,{className:"w-3 h-3"}),u.jsxs("span",{children:["Due: ",ur(String(tr.due_at))]})]}),!!tr.priority&&u.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600 dark:text-gray-400",children:[u.jsx("span",{className:"font-medium",children:"Priority:"}),u.jsx("span",{children:String(tr.priority)})]})]})]})]})}),d?u.jsx(Gs,{rows:2}):Pt?u.jsxs("div",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:[$e&&u.jsx("div",{className:"p-3 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:u.jsxs("div",{className:"flex items-start gap-2 mb-2",children:[u.jsx(qc,{className:"w-4 h-4 text-green-600 dark:text-green-400 mt-0.5 flex-shrink-0"}),u.jsxs("div",{className:"flex-1",children:[u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 font-medium mb-1",children:"Last Completed Task"}),u.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-gray-100 mb-1",children:String($e.name||"Untitled Task")}),!!$e.completed_at&&u.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600 dark:text-gray-400",children:[u.jsx(Gf,{className:"w-3 h-3"}),u.jsxs("span",{children:["Completed: ",ur(String($e.completed_at))]})]})]})]})}),Ve&&u.jsx("div",{className:"p-3 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:u.jsxs("div",{className:"flex items-start gap-2 mb-2",children:[u.jsx(Dv,{className:"w-4 h-4 text-blue-600 dark:text-blue-400 mt-0.5 flex-shrink-0"}),u.jsxs("div",{className:"flex-1",children:[u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 font-medium mb-1",children:"Next Upcoming Task"}),u.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-gray-100 mb-1",children:String(Ve.name||"Untitled Task")}),u.jsxs("div",{className:"space-y-1",children:[!!Ve.due_at&&u.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600 dark:text-gray-400",children:[u.jsx(Gf,{className:"w-3 h-3"}),u.jsxs("span",{children:["Due: ",ur(String(Ve.due_at))]})]}),!!Ve.priority&&u.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600 dark:text-gray-400",children:[u.jsx("span",{className:"font-medium",children:"Priority:"}),u.jsx("span",{children:String(Ve.priority)})]})]})]})]})})]}):!It&&!tr?u.jsx("div",{className:"p-3 text-sm text-gray-600 dark:text-gray-400",children:r&&t.length>0?u.jsx(u.Fragment,{children:u.jsx("p",{className:"mb-2",children:"No tasks found for this matter"})}):"Select a client email thread to view tasks"}):null]})]})},pi=()=>{const Se=t.length>0&&n<t.length?t[n]:null,$e=Se==null?void 0:Se.most_recent_note,Ve=$e&&$e.detail,Pt=Se==null?void 0:Se.id,$t=Pt?`https://app.clio.com/nc/#/matters/${Pt}/notes`:null;return u.jsxs("div",{className:"border-t bg-card",children:[u.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800",children:[u.jsxs("div",{className:"flex items-center gap-2 cursor-pointer flex-1 hover:opacity-80 transition-opacity",onClick:()=>X(!J),children:[u.jsx(ld,{className:"w-4 h-4 text-slate-600 dark:text-gray-300"}),u.jsx("span",{className:"font-medium text-sm text-slate-800 dark:text-white",children:"Latest Note"}),!!Ve&&!d&&u.jsx(u.Fragment,{children:J?u.jsx(ry,{className:"w-4 h-4 text-gray-400"}):u.jsx(ws,{className:"w-4 h-4 text-gray-400"})})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[Pt&&(us?u.jsxs(We,{variant:"ghost",size:"sm",className:"h-7 text-xs text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 px-2",onClick:Et=>{Et.stopPropagation(),di(!1),hi()},children:[u.jsx(Ok,{className:"w-3 h-3 mr-1"}),"Remove"]}):u.jsxs(We,{variant:"ghost",size:"sm",className:"h-7 text-xs text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 px-2",onClick:Et=>{Et.stopPropagation(),di(!0)},children:[u.jsx(Dk,{className:"w-3 h-3 mr-1"}),"Add Note"]})),$t&&u.jsxs("a",{href:$t,target:"_blank",rel:"noopener noreferrer",className:"h-7 text-xs text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 border border-blue-200 dark:border-blue-800 px-2 flex-shrink-0 rounded-md inline-flex items-center gap-1 no-underline hover:no-underline",onClick:Et=>Et.stopPropagation(),children:[u.jsx(Ba,{className:"w-3 h-3"}),"View all"]})]})]}),us&&u.jsx("div",{className:"bg-gray-50/50 dark:bg-gray-800/30 p-3 border-b border-gray-200 dark:border-gray-700",children:u.jsxs("div",{className:"space-y-3",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Subject"}),u.jsx(an,{type:"text",value:qr,onChange:Et=>fi(Et.target.value),placeholder:"Enter note subject...",className:"h-9 text-sm"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Note"}),u.jsx("textarea",{value:Un,onChange:Et=>vd(Et.target.value),placeholder:"Enter note details...",className:"w-full min-h-[80px] px-3 py-2 text-sm border rounded-md resize-y dark:bg-gray-800 dark:border-gray-600 dark:text-gray-100",rows:3})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Date"}),u.jsx(an,{type:"date",value:zn,onChange:Et=>nu(Et.target.value),className:"h-9 text-sm"})]}),u.jsx(We,{onClick:Xl,disabled:su,className:"w-full h-9",children:su?"Creating note in Clio...":"Create Note"})]})}),mo&&u.jsx("div",{className:`p-2 rounded-md text-sm ${mo.type==="success"?"bg-green-50 dark:bg-green-900/20 text-green-700 dark:text-green-400 border border-green-200 dark:border-green-800":"bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-400 border border-red-200 dark:border-red-800"}`,children:mo.text}),!J&&u.jsx(u.Fragment,{children:d?u.jsx(Gs,{rows:1}):Ve?u.jsx("div",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:u.jsxs("div",{className:"p-3 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:[u.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-gray-100 mb-2",children:String($e.subject||"Note")}),u.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600 dark:text-gray-400 mb-2",children:[u.jsx(Gf,{className:"w-3 h-3"}),u.jsx("span",{children:ur(String($e.created_at))}),(()=>{const Et=$o(String($e.created_at||""));return Et?u.jsxs(u.Fragment,{children:[u.jsx("span",{children:""}),u.jsx(Dv,{className:"w-3 h-3"}),u.jsx("span",{children:Et})]}):null})()]}),u.jsx("div",{className:"text-sm text-gray-700 dark:text-gray-300",children:(()=>{const Et=String($e.detail||""),ot=iu(Et);return z||!ot?u.jsx("div",{className:"prose prose-sm max-w-none dark:prose-invert",dangerouslySetInnerHTML:{__html:rl(Et)}}):u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"line-clamp-3 prose prose-sm max-w-none dark:prose-invert",dangerouslySetInnerHTML:{__html:rl(Et)}}),u.jsx("button",{onClick:ct=>{ct.stopPropagation(),q(!0)},className:"text-blue-600 dark:text-blue-400 hover:underline mt-1 text-xs font-medium",children:"Expand"})]})})()}),z&&u.jsx("button",{onClick:Et=>{Et.stopPropagation(),q(!1)},className:"text-blue-600 dark:text-blue-400 hover:underline mt-2 text-xs font-medium",children:"Show less"})]})}):u.jsx("div",{className:"p-3 text-sm text-gray-600 dark:text-gray-400",children:r&&t.length>0?"No notes found for this matter":"Select a client email thread to view matter notes"})})]})};return u.jsxs("div",{className:"w-full min-h-[4rem] border border-border/50 rounded-lg shadow-sm bg-card text-card-foreground",title:"Matters and Calendar Information",children:[u.jsxs("div",{className:"flex items-center justify-between p-2 border-b bg-muted",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(sA,{className:"w-3.5 h-3.5 text-slate-600 dark:text-gray-300"}),u.jsx("span",{className:"font-medium text-sm text-slate-800 dark:text-white",children:"MATTERS"})]}),u.jsxs(Ws,{open:ze,onOpenChange:Be,children:[u.jsx(Vs,{asChild:!0,children:u.jsx(We,{variant:"ghost",size:"icon",className:"h-8 w-8 hidden",title:"Search all matters",children:u.jsx(lo,{className:"h-4 w-4"})})}),u.jsxs(_s,{align:"end",className:"w-[320px] p-0",children:[u.jsxs("div",{className:"p-3 border-b border-gray-200 dark:border-gray-700",children:[u.jsx("div",{className:"text-sm font-medium mb-2 text-gray-800 dark:text-gray-200",children:"Search All Matters"}),u.jsxs("div",{className:"relative",children:[u.jsx(lo,{className:"absolute left-2 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),u.jsx(an,{placeholder:"Search by matter or client name...",value:K,onChange:Se=>{const $e=Se.target.value;de($e),Za($e)},className:"pl-8 pr-8 h-9 text-sm",autoFocus:!0,onClick:Se=>Se.stopPropagation(),onKeyDown:Se=>Se.stopPropagation()}),K&&u.jsx("button",{onClick:Se=>{Se.stopPropagation(),de(""),se([]),vt(null)},className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:u.jsx(Oi,{className:"w-4 h-4"})})]})]}),u.jsx("div",{className:"max-h-[300px] overflow-y-auto",children:Te?u.jsxs("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 flex items-center gap-2",children:[u.jsx("div",{className:"w-4 h-4 border-2 border-gray-300 border-t-gray-600 rounded-full animate-spin"}),"Searching..."]}):Ce&&ge.length===0?u.jsx("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:Ce}):ge.length>0?ge.map(Se=>u.jsxs(is,{className:"flex flex-col items-start p-3 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-800",onClick:()=>el(Se),children:[u.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-gray-100",children:Se.projectName}),u.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5",children:[Se.phaseName,"  Client: ",Se.clientName]})]},Se.projectId.native)):K.trim()&&!Te?u.jsxs("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:['No matters found for "',K,'"']}):u.jsx("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:"Type at least 2 characters to search matters..."})})]})]})]}),d?xd():E?u.jsxs(Xm,{variant:"destructive",className:"m-2",children:[u.jsx(qm,{className:"h-4 w-4"}),u.jsx(Qm,{className:"ml-2",children:"Failed to fetch matter data. Please refresh to try again."})]}):e&&Object.keys(e).length>0?u.jsxs(u.Fragment,{children:[t.length>0&&u.jsxs("div",{className:"flex items-center px-3 py-1 bg-gray-50 dark:bg-gray-800 border-b dark:border-gray-700 gap-2",children:[u.jsx("div",{className:"flex-1 min-w-0 flex items-center",children:(()=>{const Se=G??t.length,$e=Se>P,Ve=$e?Math.ceil(Se/P):1,Pt=(L-1)*P+1,$t=Math.min(L*P,Se),Et=(()=>{if(!O.trim())return t;const ct=O.toLowerCase();return V.length>0&&O.length>=2?V.filter(An=>(An.description||"").toLowerCase().includes(ct)):t.filter(An=>String(An.description||"").toLowerCase().includes(ct))})(),ot=()=>{if(Ve<=5)return Array.from({length:Ve},(An,Ns)=>Ns+1);const ct=[];return L<=3?ct.push(1,2,3,"...",Ve):L>=Ve-2?ct.push(1,"...",Ve-2,Ve-1,Ve):ct.push(1,"...",L,"...",Ve),ct};return u.jsx(u.Fragment,{children:t.length>1||$e?u.jsxs(Ws,{open:ae,onOpenChange:ou,children:[u.jsx(Vs,{asChild:!0,children:u.jsxs(We,{variant:"ghost",size:"sm",className:"h-auto text-left text-gray-600 dark:text-gray-300 flex flex-col items-start gap-0 px-2 py-1 max-w-full overflow-hidden",children:[u.jsx("span",{className:"text-sm truncate font-medium w-full",title:e.Title||"",children:e.Title||"Case"}),u.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400 flex items-center gap-1",children:[At," of ",Se," matters in Clio",u.jsx(ws,{className:"w-3 h-3"})]})]})}),u.jsxs(_s,{align:"start",className:"w-[320px] p-0",children:[u.jsx("div",{className:"p-2 border-b border-gray-200 dark:border-gray-700",children:u.jsxs("div",{className:"relative",children:[u.jsx(lo,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),u.jsx(an,{placeholder:"Search matters...",value:O,onChange:ct=>$(ct.target.value),className:"pl-8 pr-8 h-8 text-xs",autoFocus:!0,onClick:ct=>ct.stopPropagation(),onKeyDown:ct=>ct.stopPropagation()}),O&&u.jsx("button",{onClick:ct=>{ct.stopPropagation(),$("")},className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:u.jsx(Oi,{className:"w-4 h-4"})})]})}),!O.trim()&&L===1&&u.jsx("div",{className:"px-3 py-1.5 text-xs text-gray-500 dark:text-gray-400 border-b border-gray-100 dark:border-gray-700",children:"Sorted by: last opened in Clio"}),O.trim()&&V.length>0&&O.length>=2&&u.jsxs("div",{className:"px-3 py-1.5 text-xs text-gray-500 dark:text-gray-400 border-b border-gray-100 dark:border-gray-700",children:["Searching all ",Se," matters"]}),u.jsx("div",{className:"max-h-[250px] overflow-y-auto",children:Et.length>0?Et.map(ct=>{const An=O.length>=2&&V.length>0,Ns=t.indexOf(ct),bd=Ns!==-1,er=String(ct.id||""),Cr=kt?er===kt:bd&&Ns===n,Ho=String(ct.description||"Case"),sl=Cr?"bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400 font-medium":"";return An?u.jsx("button",{type:"button",className:`relative flex w-full cursor-pointer select-none items-center rounded-sm text-sm outline-none transition-colors hover:bg-neutral-100 dark:hover:bg-muted dark:text-gray-200 py-2.5 px-3 truncate text-left ${sl}`,onClick:()=>{if(T&&er){yt(er);const _d=V.findIndex(cu=>cu.id===er);if(_d!==-1&&U){const cu=Math.floor(_d/P)+1;U(cu)}T({id:er,description:String(ct.description||""),name:String(ct.name||"")},{preservePagination:!0}),be(!1),$("")}},children:Ho},er||Ho):u.jsx(is,{className:`text-sm py-2.5 px-3 truncate ${sl}`,onClick:()=>{bd?tl(Ns):T&&er&&(yt(er),be(!1),T({id:er,description:String(ct.description||""),name:String(ct.name||"")},{preservePagination:!0}))},children:Ho},er||Ho)}):u.jsxs("div",{className:"p-3 text-xs text-center text-gray-500 dark:text-gray-400",children:["No matters match ",O,""]})}),$e&&!(O.trim()&&V.length>0&&O.length>=2)&&u.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 px-3 py-2",onPointerDown:ct=>{ct.preventDefault(),ct.stopPropagation()},onClick:ct=>ct.stopPropagation(),children:[u.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mb-2",children:["Showing ",Pt,"-",$t," of ",Se," matters"]}),u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("button",{onClick:()=>{ie.current=!0,U==null||U(L-1)},disabled:L<=1,className:"text-xs px-2 py-1 text-gray-600 dark:text-gray-400 border border-gray-300 dark:border-gray-600 rounded hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-40 disabled:cursor-not-allowed",children:" Newer"}),u.jsx("div",{className:"flex items-center gap-1",children:ot().map((ct,An)=>ct==="..."?u.jsx("span",{className:"text-xs text-gray-400 px-1",children:""},`ellipsis-${An}`):u.jsx("button",{disabled:ct===L,className:`text-xs w-6 h-6 rounded flex items-center justify-center ${ct===L?"bg-blue-600 text-white font-medium":"text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700"} disabled:cursor-not-allowed`,onClick:()=>{typeof ct=="number"&&(ie.current=!0,U==null||U(ct))},children:ct},ct))}),u.jsx("button",{onClick:()=>{ie.current=!0,U==null||U(L+1)},disabled:L>=Ve,className:"text-xs px-2 py-1 text-gray-600 dark:text-gray-400 border border-gray-300 dark:border-gray-600 rounded hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-40 disabled:cursor-not-allowed",children:"Older "})]})]})]})]}):u.jsxs("div",{className:"flex flex-col px-2 py-1 overflow-hidden",children:[u.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-300 truncate font-medium w-full",title:e.Title||"",children:e.Title||"Case"}),!p&&u.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[At," of ",Se," matters in Clio"]})]})})})()}),((Uo=s.find(Se=>Se.field==="Title"))==null?void 0:Uo.url)&&u.jsxs("a",{href:(zo=s.find(Se=>Se.field==="Title"))==null?void 0:zo.url,target:"_blank",rel:"noopener noreferrer",className:"h-8 text-xs text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 border border-blue-200 dark:border-blue-800 px-3 flex-shrink-0 rounded-md inline-flex items-center gap-1 no-underline hover:no-underline",children:[u.jsx(Ba,{className:"w-3 h-3"}),"View"]})]}),qs&&!p&&u.jsx(_w,{createdContacts:A,onMatterLinked:F}),fe&&u.jsxs(Xm,{variant:"destructive",className:"m-2",children:[u.jsx(qm,{className:"h-4 w-4"}),u.jsx(Qm,{className:"ml-2",children:"Failed to load matter details. Previous details shown below."})]}),Q?u.jsx(Gs,{rows:5}):u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"break-words",children:u.jsx(ru,{details:e})}),S&&u.jsx("div",{className:"border-t bg-card p-3",children:u.jsxs("a",{href:`https://app.clio.com/nc/#/matters/${S}/documents`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-sm text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 hover:underline transition-colors",children:[u.jsx(ld,{className:"w-4 h-4 text-blue-500"}),u.jsx("span",{children:"View all documents in Clio"}),u.jsx(Ba,{className:"w-3 h-3"})]})}),pi(),Ql(),nl()]})]}):x?u.jsx(Gs,{rows:2}):u.jsx("div",{className:"p-3 text-sm text-gray-600 dark:text-gray-400",children:r?u.jsxs(u.Fragment,{children:[u.jsx("p",{className:"mb-2",children:"Select a client email thread to view matter information"}),qs&&!p&&u.jsx(_w,{createdContacts:A,onMatterLinked:F})]}):u.jsxs(u.Fragment,{children:[qs&&!p&&u.jsx(_w,{createdContacts:A,onMatterLinked:F}),!qs&&"Select a client email thread to view case information"]})})]})},Sw="src/shared/components/sidepanel/panels/components/UnifiedSearch.tsx",iK=({onMatterSelected:r})=>{const e=zr(),t=w.useRef(null),[n,s]=w.useState(""),[i,c]=w.useState([]),[d,p]=w.useState(!1),[m,g]=w.useState(!1),[x,b]=w.useState(null);w.useEffect(()=>{const E=C=>{t.current&&!t.current.contains(C.target)&&g(!1)};return document.addEventListener("mousedown",E),()=>{document.removeEventListener("mousedown",E)}},[]);const S=w.useMemo(()=>By.debounce(async E=>{if(!E.trim()||E.length<2){c([]),b(null);return}p(!0),b(null);try{const C=await Qy("clio",E,e);c(C.projects||[]),C.projects.length===0&&b(`No matters found for "${E}"`)}catch(C){e.error("Matter search failed",C,{sourceFile:Sw}),b("Failed to search matters. Please try again."),c([])}finally{p(!1)}},400),[e]),T=E=>{var C,R;try{e.info("Matter selected via unified search",{matterId:(R=(C=E.projectId)==null?void 0:C.native)==null?void 0:R.toString(),matterName:E.projectName,sourceFile:Sw}),r(E),g(!1),s(""),c([]),b(null)}catch(A){e.error("Failed to select matter",A,{sourceFile:Sw})}};return u.jsxs("div",{ref:t,className:"w-full mb-3 p-1",children:[u.jsxs("div",{className:"relative",children:[u.jsx(lo,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400 pointer-events-none z-10"}),u.jsx(an,{placeholder:"Search clients and matters...",value:n,onChange:E=>{const C=E.target.value;s(C),g(!0),S(C)},onFocus:()=>g(!0),className:"pl-10 pr-10 h-10 text-sm border border-border/50 rounded-lg shadow-sm bg-card"}),n&&u.jsx("button",{onClick:E=>{E.stopPropagation(),s(""),c([]),b(null),g(!1)},className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 z-10",children:u.jsx(Oi,{className:"w-4 h-4"})})]}),m&&(n.length>=2||d||i.length>0)&&u.jsx("div",{className:"relative",children:u.jsx("div",{className:"absolute top-2 left-0 right-0 z-50 w-full max-w-full border border-border/50 rounded-lg shadow-lg bg-card",children:u.jsx("div",{className:"max-h-[300px] overflow-y-auto",children:d?u.jsxs("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 flex items-center gap-2",children:[u.jsx("div",{className:"w-4 h-4 border-2 border-gray-300 border-t-gray-600 rounded-full animate-spin"}),"Searching..."]}):x&&i.length===0?u.jsx("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:x}):i.length>0?i.map(E=>u.jsxs("div",{className:"flex flex-col items-start p-3 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-800 border-b border-gray-100 dark:border-gray-700 last:border-b-0",onClick:()=>T(E),children:[u.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-gray-100",children:E.projectName}),u.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5",children:[E.phaseName,"  Client: ",E.clientName]})]},E.projectId.native)):n.trim()&&!d?u.jsxs("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:['No matters found for "',n,'"']}):u.jsx("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:"Type at least 2 characters to search clients and matters..."})})})})]})},Ls="src/shared/hooks/useParticipantValidation.ts",aK=0,Ew=1,_N=2e3,SN=3e4;function lK(r){const e=r.message.toLowerCase();return e.includes("client not found")||e.includes("404")||e.includes("not found")}function cK(r){const e=r.message.toLowerCase();return e.includes("timed out")||e.includes("timeout")||e.includes("504")||e.includes("503")||e.includes("network")||e.includes("failed to fetch")}function uK({emailParticipants:r,getClientDetailsForEmail:e,clientDataCache:t,isValidClientData:n,onClientDataValidated:s,refreshTrigger:i,onTransientError:c,onValidationComplete:d}){const p=zr(),m=w.useRef(null),g=w.useRef(new Set),x=w.useCallback(async(C,R,A=!1)=>{var fe,B;if(R.aborted)return;const F=C.toLowerCase();if(g.current.has(F)){p.debug("Skipping duplicate in-flight validation",{sourceFile:Ls,email:C});return}const P=(fe=t.current)==null?void 0:fe[C];if(P&&typeof P=="object"&&"pagination"in P&&P.pagination!=null){const ee=n(P);s(C,ee),p.debug("Participant validated from L1 cache (skipped API call)",{sourceFile:Ls,email:C,hasValidData:ee});return}const L=await zm(C,p);if(L&&"pagination"in L&&L.pagination!=null){t.current&&(t.current[C]=L);const ee=n(L);s(C,ee),p.debug("Participant validated from L2 cache (skipped API call)",{sourceFile:Ls,email:C,hasValidData:ee});return}g.current.add(F);let G,U,V=!1;const Q=e(C,A);try{if(await Promise.race([Q,new Promise((ce,ne)=>{G=setTimeout(()=>{V=!0,ne(new Error(`Request timed out after ${SN}ms`))},SN),U=()=>{clearTimeout(G),ne(new DOMException("Aborted","AbortError"))},R.addEventListener("abort",U,{once:!0})})]),R.aborted)return;const ee=(B=t.current)==null?void 0:B[C],ve=ee?n(ee):!1;s(C,ve),p.debug("Participant validation result",{sourceFile:Ls,email:C,hasValidData:ve})}catch(ee){if(R.aborted)return;ee instanceof Error?lK(ee)?(p.debug("Participant not found in system",{sourceFile:Ls,email:C,error:ee.message}),s(C,!1)):cK(ee)?(p.warn("Participant validation timed out or network error - marking as pending",{sourceFile:Ls,email:C,error:ee.message}),s(C,!1),c==null||c(C,ee),V&&Q.then(()=>{var ne;if(R.aborted)return;const ve=(ne=t.current)==null?void 0:ne[C];(ve?n(ve):!1)&&(p.info("Request succeeded after timeout - updating validation",{sourceFile:Ls,email:C}),console.log(` [Late Success] Data loaded after timeout for ${C}`),s(C,!0))}).catch(ve=>{R.aborted||p.debug("Request failed after timeout",{sourceFile:Ls,email:C,error:ve instanceof Error?ve.message:String(ve)})})):(p.error("Participant validation failed with unexpected error",ee,{sourceFile:Ls,email:C}),s(C,!1)):(p.error("Participant validation failed with non-Error",new Error(String(ee)),{sourceFile:Ls,email:C}),s(C,!1))}finally{G!==void 0&&clearTimeout(G),U&&R.removeEventListener("abort",U),g.current.delete(F)}},[e,t,n,s,c,p]),b=w.useCallback(async(C,R,A=!1)=>{await Promise.all(C.map(F=>x(F,R,A)))},[x]),S=(C,R)=>new Promise((A,F)=>{if(R.aborted)return F(new DOMException("Aborted","AbortError"));const P=()=>{clearTimeout(L),F(new DOMException("Aborted","AbortError"))},L=setTimeout(()=>{R.removeEventListener("abort",P),A()},C);R.addEventListener("abort",P,{once:!0})}),T=w.useMemo(()=>[...r].sort().join(","),[r]),E=w.useRef(aK);w.useEffect(()=>{var L;if(r.length===0)return;(L=m.current)==null||L.abort();const C=new AbortController;m.current=C;const R=g.current,A=i>E.current,F=t.current;return A&&F&&(Object.keys(F).forEach(G=>{delete F[G]}),ET(p),K5(),R.clear(),p.debug("Cleared all cache tiers for refresh",{sourceFile:Ls,refreshTrigger:i})),E.current=i,(async()=>{const{signal:G}=C;p.info("Validating all email participants (rate-limited)",{sourceFile:Ls,participantCount:r.length,batchSize:Ew,batchDelayMs:_N});const U=[];for(let V=0;V<r.length;V+=Ew)U.push(r.slice(V,V+Ew));for(let V=0;V<U.length;V++){if(G.aborted){p.debug("Validation aborted",{sourceFile:Ls});return}const Q=U[V];if(p.debug("Processing validation batch",{sourceFile:Ls,batchIndex:V+1,totalBatches:U.length,batchEmails:Q}),await b(Q,G,A),V<U.length-1&&!G.aborted)try{await S(_N,G)}catch(fe){if(fe instanceof DOMException&&fe.name==="AbortError"){p.debug("Validation delay aborted",{sourceFile:Ls});return}throw fe}}p.info("Completed validating all participants",{sourceFile:Ls,participantCount:r.length}),d==null||d()})(),()=>{C.abort(),R.clear()}},[T,b,p,i,t,d])}const pj=w.createContext(void 0),dK=({children:r})=>{const[e,t]=w.useState(0),[n,s]=w.useState(!1),i=w.useRef(null),[c,d]=w.useState(!0),p=w.useRef(new Map),m=Ya(),g=async R=>{try{return await m.getLocalItem(`elapsedTime_${R}`)??0}catch(A){return console.warn("Failed to read from storage, using in-memory storage:",A),p.current.get(R)??0}},x=async(R,A)=>{try{await m.setLocalItem(`elapsedTime_${R}`,A)}catch(F){console.warn("Failed to write to storage, using in-memory storage:",F),p.current.set(R,A)}},b=()=>{i.current!==null&&(window.clearInterval(i.current),i.current=null)},S=async R=>{!n&&c&&(s(!0),b(),g(R).then(A=>{t(A)}),i.current=window.setInterval(()=>{t(A=>{const F=A+1;return x(R,F),F})},1e3))},T=async R=>{if(n){s(!1),b();const A=await g(R);x(R,A)}},E=R=>{x(R,0),t(0)},C=async R=>await g(R);return w.useEffect(()=>()=>{b()},[]),u.jsx(pj.Provider,{value:{elapsedTime:e,isTimerRunning:n,startTimer:S,stopTimer:T,resetTimer:E,getElapsedTimeForThread:C,setShouldStartTimer:d,setElapsedTime:t},children:r})},mj=()=>{const r=w.useContext(pj);if(!r)throw new Error("useTimer must be used within a TimerProvider");return r},Cw=r=>{const e=Math.floor(r/3600),t=Math.floor(r%3600/60),n=r%60,s=i=>String(i).padStart(2,"0");return`${s(e)}:${s(t)}:${s(n)}`},fK=({userData:r,clientEmail:e,fileToMatterChecked:t,casesForCurrentClient:n,selectedCase:s,onSave:i,onCancel:c})=>{const d=zr(),p=aa(),{platform:m}=un(),{elapsedTime:g,stopTimer:x,resetTimer:b}=mj(),[S,T]=w.useState(new Date().toISOString().slice(0,10)),[E,C]=w.useState(Cw(g)),[R,A]=w.useState(""),[F,P]=w.useState(s||n[0]||{}),L=t,[G,U]=w.useState((r==null?void 0:r.rate)||null),[V,Q]=w.useState(!1),[fe,B]=w.useState("Failed to save time entry. Please try again."),[ee,ve]=w.useState(!1),[ce,ne]=w.useState(!1),[xe,J]=w.useState(!1),[X,z]=w.useState(!1),q=gr.useRef(null),[O,$]=w.useState(!1),ae=async()=>{if(J(!0),!(F!=null&&F.id)){J(!1),z(!0),B("Please select a matter to file the time entry.");return}const ie=/^(\d{1,2}):([0-5]\d):([0-5]\d)$/,K=E.trim().match(ie);if(!K){J(!1),z(!0),B("Please enter a valid duration in HH:MM:SS format.");return}const[,de,ge,se]=K,Te=Number(de)*3600+Number(ge)*60+Number(se);if(!S||!/^\d{4}-\d{2}-\d{2}$/.test(S)||Number.isNaN(Date.parse(S))){J(!1),z(!0),B("Please select a valid date (YYYY-MM-DD).");return}if(!q.current){J(!1),z(!0),B("Unable to retrieve email thread information.");return}m==="chrome"&&$T(q.current,d).then(async ze=>{if(ze.length!=0)try{const Be=ze[ze.length-1],Ce=Be.to.concat(Be.cc),vt=Be.from,kt=Be.subject||"",yt=Be.body||"",At=Be.date||"",It=Ce,Yt=R.trim().replace(/[<>]/g,"").substring(0,5e3),Xt=await py(e,"clio",S,Te,Yt,F==null?void 0:F.id,L,kt,yt,At,vt,It,ee,ce,G,d);d.info("Time entry successfully written to server",{sourceFile:"TimeEntryModal.tsx",message:Xt}),B("New email log and time entry created successfully."),J(!1),z(!1),q.current&&(await x(q.current),b(q.current)),i()}catch(Be){d.error("Error writing time entry to server",{error:Be},{sourceFile:"TimeEntryModal.tsx"}),J(!1),z(!0),B("Something went wrong. Please try again.")}}).catch(ze=>{d.error("Error fetching email details from server",{error:ze},{sourceFile:"TimeEntryModal.tsx"}),J(!1),z(!0),B("Something went wrong. Please try again.")}),m==="outlook"&&p.getCurrentThread().then(async ze=>{if(ze===null){J(!1),z(!0),B("Unable to retrieve email details. Please try again.");return}const Be=ze.messages[ze.messages.length-1].from,Ce=ze.subject||"",vt=ze.messages[ze.messages.length-1].body||"",kt=ze.messages[ze.messages.length-1].timestamp||"",yt=ze.participants.filter((Yt=>Yt!==Be)),At=R.trim().replace(/[<>]/g,"").substring(0,5e3),It=await py(e,"clio",S,Te,At,F==null?void 0:F.id,L,Ce,vt,kt,Be,yt,ee,ce,G,d);d.info("Time entry successfully written to server",{sourceFile:"InsightsTimer.tsx",message:It}),B("New email log and time entry created successfully."),J(!1),z(!1),q.current&&(await x(q.current),b(q.current)),i()}).catch(ze=>{d.error("Error writing time entry to server",{error:ze},{sourceFile:"TimeEntryModal.tsx"}),J(!1),z(!0),B("Something went wrong. Please try again.")})},be=ie=>{let K="";const de=(ie==null?void 0:ie.messages)||[];let ge=de;return de.length>3&&(ge=de.slice(-3)),ge.forEach((se,Te)=>{K+=`Email ${Te} Subject: ${se.subject||""}
Email ${Te} Body: ${se.body||""}

`}),K};return w.useEffect(()=>{const ie=async()=>{p==null||p.getCurrentThread().then(de=>{$(!0);const ge=(de==null?void 0:de.threadId)||null;if(!ge){$(!1);return}if(m==="outlook"){const se=be(de);AC(ge,se,d).then((Te=>{A(Te.description),$(!1)})).catch(Te=>{d.error("Error generating email description summary",Te,{sourceFile:"TimeEntryModal.tsx"}),$(!1)})}m==="chrome"&&AC(ge,null,d).then(se=>{A(se.description),$(!1)}).catch(se=>{d.error("Error generating email description summary",se,{sourceFile:"TimeEntryModal.tsx"}),$(!1)})})},K=()=>{p==null||p.getCurrentThread().then(de=>{q.current=(de==null?void 0:de.threadId)||null})};ie(),K()},[L,p,d]),w.useEffect(()=>{var ie,K,de,ge;(ge=(de=(K=(ie=F==null?void 0:F.raw_data)==null?void 0:ie.custom_rate)==null?void 0:K.rates)==null?void 0:de[0])!=null&&ge.rate?U(F.raw_data.custom_rate.rates[0].rate):U((r==null?void 0:r.rate)||0)},[F,r]),u.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 dark:bg-opacity-70 z-50 p-4 overflow-y-auto",onClick:c,children:u.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-lg w-full max-w-lg p-6 my-auto max-h-[90vh] overflow-y-auto",onClick:ie=>ie.stopPropagation(),children:[u.jsxs("div",{className:"flex justify-between items-center mb-4",children:[u.jsxs("h2",{className:"text-lg font-semibold text-blue-600 dark:text-blue-400",children:["Review Time Entry"," "]}),u.jsx("button",{className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",onClick:c,children:u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),X&&u.jsx("div",{role:"alert","aria-live":"assertive",className:"mb-4",children:u.jsxs("div",{className:"flex items-start bg-red-50 dark:bg-red-950/30 border border-red-200 dark:border-red-800 text-red-900 dark:text-red-100 rounded-md p-3",children:[u.jsx("svg",{className:"w-5 h-5 flex-shrink-0",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:u.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.72-1.36 3.485 0l6.518 11.588c.75 1.334-.213 2.995-1.742 2.995H3.481c-1.529 0-2.492-1.661-1.742-2.995L8.257 3.1zM10 8a1 1 0 10-0 2 1 1 0 000-2zm0 4a1 1 0 01-.993-.883L9 11V9a1 1 0 012 0v2a1 1 0 01-.883.993L10 12z",clipRule:"evenodd"})}),u.jsxs("div",{className:"ml-3 flex-1",children:[u.jsx("p",{className:"font-medium",children:"Error"}),u.jsx("p",{className:"mt-1 text-sm",children:fe})]})]})}),u.jsx("p",{className:"mb-4",children:"Review and edit details before saving."}),u.jsxs("div",{className:"flex gap-4 mb-4 w-full",children:[u.jsxs("div",{className:"shrink-0",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Date"}),u.jsx("input",{type:"date",value:S,onChange:ie=>T(ie.target.value),className:"mt-1 block border border-gray-300 dark:border-gray-600 text-gray-600 dark:text-gray-300 bg-white dark:bg-gray-800 rounded-md shadow-sm px-3 py-2 text-sm focus:ring-blue-500 focus:border-blue-500 h-[38px]"})]}),u.jsxs("div",{className:"shrink-0",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Duration"}),u.jsx("input",{type:"text",value:E,onChange:ie=>{const K=ie.target.value,de=/^(\d{0,2})(:\d{0,2}){0,2}$/;K.length<=8&&/^[0-9:]*$/.test(K)&&de.test(K)&&C(K)},onBlur:ie=>{const K=ie.target.value.trim(),de=/^(\d{1,2}):([0-5]\d):([0-5]\d)$/;if(de.test(K)){const[,ge,se,Te]=K.match(de),qe=Number(ge)*3600+Number(se)*60+Number(Te);C(Cw(qe))}else C(Cw(g))},className:"mt-1 block border border-gray-300 dark:border-gray-600 text-gray-600 dark:text-gray-300 bg-white dark:bg-gray-800 rounded-md shadow-sm px-3 py-2 text-sm focus:ring-blue-500 focus:border-blue-500 h-[38px]",style:{width:"10ch"},"aria-label":"Duration (HH:MM:SS)"})]})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Description"}),u.jsx("textarea",{disabled:O,value:O?"Generating AI description...":R,onChange:ie=>A(ie.target.value),className:"mt-1 block w-full border border-gray-300 dark:border-gray-600 text-gray-600 dark:text-gray-300 bg-white dark:bg-gray-800 rounded-md shadow-sm px-3 py-2 text-sm focus:ring-blue-500 focus:border-blue-500",rows:3})]}),u.jsx("div",{className:"bg-gray-50 dark:bg-gray-800/50 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm p-4",children:u.jsxs("div",{className:"flex justify-between items-center mb-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-900 dark:text-gray-100",children:"Billed By"}),u.jsx("p",{className:"mt-1 text-sm font-medium text-gray-900 dark:text-gray-100",children:"Rate"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm text-gray-700 dark:text-gray-300 text-right",children:(r==null?void 0:r.name)||"Unknown"}),u.jsxs("div",{className:"flex items-center justify-end gap-2",children:[u.jsx("input",{value:G??0,onChange:ie=>U(Number(ie.target.value)||0),onBlur:()=>Q(!1),className:V?"mt-1 text-sm text-right text-gray-700 dark:text-gray-300 border border-gray-200 dark:border-gray-600 rounded bg-white dark:bg-gray-800 inline-block":"mt-1 text-sm text-right text-gray-700 dark:text-gray-300 border border-transparent rounded bg-transparent inline-block","aria-label":"Rate",disabled:!V,style:{width:`${Math.max(String(G??0).length,1)+1}ch`}}),u.jsx("button",{type:"button",className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300","aria-label":"Edit rate",onClick:()=>Q(!V),children:u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536M4 20h4.586a1 1 0 00.707-.293l9.414-9.414a1 1 0 000-1.414L15.121 4.88a1 1 0 00-1.414 0L4 14.586V20z"})})})]})]})]})}),u.jsxs("div",{className:"mb-4 mt-5",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Matter"}),u.jsxs(Ws,{children:[u.jsx(Vs,{asChild:!0,children:u.jsxs(We,{variant:"ghost",size:"sm",className:"mt-1 h-[38px] text-sm text-gray-600 dark:text-gray-300 flex items-center gap-1 px-3 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm w-full justify-between",children:[u.jsx("span",{className:"truncate",title:String((F==null?void 0:F.description)||"Select a matter"),children:String((F==null?void 0:F.description)||"Select a matter")}),u.jsx(ws,{className:"w-4 h-4 ml-1 flex-shrink-0"})]})}),u.jsx(_s,{align:"start",className:"w-full max-h-[200px] overflow-y-auto",style:{width:"var(--radix-dropdown-menu-trigger-width)"},children:n.map((ie,K)=>u.jsx(is,{className:"text-sm truncate max-w-full",onClick:()=>P(ie),title:String((ie==null?void 0:ie.description)||`Case ${K+1}`),children:String((ie==null?void 0:ie.description)||`Case ${K+1}`)},K))})]})]}),u.jsxs("div",{className:"mb-4 bg-blue-50 dark:bg-blue-950/30 p-3 rounded-md",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx("input",{type:"checkbox",id:"fileToMatter",checked:ee,onChange:ie=>ve(ie.target.checked),className:"cursor-pointer"}),u.jsx("label",{htmlFor:"fileToMatter",className:"ml-2 text-sm font-medium text-blue-600 dark:text-blue-400",children:"Non-billable"})]}),ee&&u.jsxs("div",{className:"flex items-center",children:[u.jsx("input",{type:"checkbox",id:"billEntry",checked:ce,onChange:ie=>ne(ie.target.checked),className:"cursor-pointer"}),u.jsx("label",{htmlFor:"billEntry",className:"ml-2 text-sm font-medium text-blue-600 dark:text-blue-400",children:"Show this entry on the bill"})]})]}),u.jsxs("div",{className:"flex flex-col gap-3",children:[u.jsx(We,{className:"w-full p-2",disabled:xe,onClick:ae,children:xe?"Saving...":"Save Time Entry"}),u.jsx("button",{className:"w-full p-2 bg-transparent text-white hover:cursor-pointer hover:bg-transparent shadow-none border-none",disabled:xe,onClick:c,children:"Cancel"})]})]})})},hK=r=>{const e=Math.floor(r/3600),t=Math.floor(r%3600/60),n=r%60,s=i=>String(i).padStart(2,"0");return`${s(e)}:${s(t)}:${s(n)}`},pK=({userData:r,clientEmail:e,emailParticipantClients:t,currentCaseIndex:n,casesForCurrentClient:s})=>{const i=zr(),{elapsedTime:c,isTimerRunning:d,startTimer:p,stopTimer:m,resetTimer:g,setShouldStartTimer:x,setElapsedTime:b}=mj(),S=aa(),{platform:T}=un(),[E,C]=w.useState(s[0]||null),[R,A]=w.useState(!0),[F,P]=w.useState(!1),[L,G]=w.useState(!1),U=gr.useRef(null),[V,Q]=w.useState(s||null),fe=new Date().toISOString().slice(0,10),B="",[ee,ve]=w.useState("Failed to save time entry. Please try again."),[ce,ne]=w.useState(!1),[xe,J]=w.useState(!1),X=async()=>{if(ne(!0),!fe||!/^\d{4}-\d{2}-\d{2}$/.test(fe)||Number.isNaN(Date.parse(fe))){ne(!1),J(!0),ve("Please select a valid date (YYYY-MM-DD).");return}if(U.current===null){ne(!1),J(!0),ve("Unable to retrieve email details. Please try again.");return}T==="chrome"&&$T(U.current,i).then(async $=>{if($.length<1){ne(!1),J(!0),ve("Unable to retrieve email details. Please try again.");return}try{const ae=$[$.length-1],be=ae.to.concat(ae.cc),ie=ae.from,K=ae.subject||"",de=ae.body||"",ge=ae.date||"",se=be,Te=B.trim().replace(/[<>]/g,"").substring(0,5e3),qe=await py(e,"clio",fe,c,Te,E==null?void 0:E.id,R,K,de,ge,ie,se,null,null,null,i);i.info("Time entry successfully written to server",{sourceFile:"InsightsTimer.tsx",message:qe}),ve("New email log created successfully."),ne(!1),J(!1),G(!0),U.current&&(await m(U.current),g(U.current))}catch(ae){i.error("Error writing time entry to server",ae,{sourceFile:"InsightsTimer.tsx"}),ne(!1),J(!0),ve("Something went wrong. Please try again.")}}).catch($=>{i.error("Error fetching email details from server",$,{sourceFile:"InsightsTimer.tsx"}),ne(!1),J(!0),ve("Something went wrong. Please try again.")}),T==="outlook"&&S.getCurrentThread().then(async $=>{if($===null||!$.messages||$.messages.length===0){ne(!1),J(!0),ve("Unable to retrieve email details. Please try again.");return}const ae=$.messages[$.messages.length-1].from,be=$.subject||"",ie=$.messages[$.messages.length-1].body||"",K=$.messages[$.messages.length-1].timestamp||"",de=$.participants.filter((Te=>Te!==ae)),ge=B.trim().replace(/[<>]/g,"").substring(0,5e3),se=await py(e,"clio",fe,c,ge,E==null?void 0:E.id,R,be,ie,K,ae,de,null,null,null,i);i.info("Time entry successfully written to server",{sourceFile:"InsightsTimer.tsx",message:se}),ve("New email log created successfully."),ne(!1),J(!1),G(!0),U.current&&(await m(U.current),g(U.current))}).catch($=>{ne(!1),J(!0),ve("Something went wrong. Please try again."),i.error("Error getting current thread",$,{sourceFile:"InsightsTimer.tsx"})})},z=async()=>{P(!1),G(!0),J(!1),ve("Successfully wrote email log and time entry"),U.current&&(await m(U.current),g(U.current))},q=async()=>{P(!1),x(!0),U.current&&await m(U.current)};return w.useEffect(()=>{if(!d)return;(()=>{S==null||S.getCurrentThread().then($=>{U.current=($==null?void 0:$.threadId)||null})})()},[d,S]),w.useEffect(()=>{Q(s),C(s[n]||null),G(!1),P(!1)},[n,s,r]),w.useEffect(()=>{let O=!0;const $=async ge=>{if(!O)return;const se=(ge==null?void 0:ge.threadId)||null;if(!se){U.current&&document.visibilityState==="visible"&&(await m(U.current),b(0),i.info("Thread cleared - stopping timer",{sourceFile:"InsightsTimer.tsx"})),U.current=null;return}se!==U.current&&(i.info("Thread changed - starting timer",{sourceFile:"InsightsTimer.tsx",oldThreadId:U.current,newThreadId:se}),U.current&&await m(U.current),U.current=se,x(!0),document.visibilityState==="visible"&&p(se))};S&&(S.onThreadChanged($),S.getCurrentThread().then(ge=>{$(ge)}).catch(ge=>{i.error("Error getting initial thread",ge,{sourceFile:"InsightsTimer.tsx"})}));const ae=async()=>{U.current&&await m(U.current)},be=async()=>{try{if(!S)return;const ge=await S.getCurrentThread(),se=(ge==null?void 0:ge.threadId)||null;if(!se||d&&U.current===se)return;U.current=se,p(se)}catch(ge){i.error("Error starting timer on visibility/focus",ge,{sourceFile:"InsightsTimer.tsx"})}},ie=()=>{document.visibilityState==="hidden"?ae():document.visibilityState==="visible"&&be()},K=()=>be(),de=()=>ae();return document.addEventListener("visibilitychange",ie),window.addEventListener("focus",K),window.addEventListener("blur",de),document.visibilityState==="visible"&&be(),()=>{O=!1,S&&S.removeThreadListener($),document.removeEventListener("visibilitychange",ie),window.removeEventListener("focus",K),window.removeEventListener("blur",de)}},[S,p,m,x,i]),w.useEffect(()=>{if(L||xe){const O=setTimeout(()=>{G(!1),J(!1)},5e3);return()=>clearTimeout(O)}},[L,xe]),u.jsxs(u.Fragment,{children:[F&&u.jsx(fK,{userData:r,clientEmail:e,emailParticipantClients:t,fileToMatterChecked:R,casesForCurrentClient:V,selectedCase:E,onSave:z,onCancel:q}),u.jsxs("div",{className:"flex flex-col gap-3 p-2 border rounded-md bg-blue-50 dark:bg-gray-800 border-blue-500 dark:border-gray-600 shadow-sm",children:[u.jsx("h2",{className:"text-sm font-semibold text-gray-700 dark:text-gray-200",children:"File email log"}),u.jsxs("div",{className:"flex items-center gap-1.5 overflow-hidden",children:[u.jsxs("button",{type:"button",onClick:async()=>{U.current&&(d?(x(!1),await m(U.current)):(x(!0),p(U.current)))},className:"flex items-center justify-start gap-1.5 w-[110px] h-[34px] px-2 rounded-md bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors border border-gray-200 dark:border-gray-600 overflow-hidden flex-shrink-0",children:[u.jsx("div",{className:"w-4 h-4 flex items-center justify-center flex-shrink-0",children:d?u.jsx(bB,{className:"w-4 h-4 text-green-700 dark:text-green-400"}):u.jsx(SB,{className:"w-4 h-4 text-gray-700 dark:text-gray-300"})}),u.jsx("span",{className:`text-base font-semibold ${d?"text-green-700 dark:text-green-400":"text-gray-700 dark:text-gray-300"} whitespace-nowrap w-[70px] text-center flex-shrink-0`,children:hK(c)})]}),u.jsxs("label",{className:"flex items-center gap-1 text-xs text-gray-600 dark:text-gray-400 flex-shrink min-w-0",children:[u.jsx("input",{type:"checkbox",id:"fileToMatter",checked:R,onChange:O=>A(O.target.checked),className:"cursor-pointer flex-shrink-0"}),u.jsx("span",{className:"truncate",children:"Add time entry"})]}),u.jsx("div",{className:"min-w-0 flex-1",children:u.jsx(We,{disabled:ce,onClick:async()=>{if(U.current){if(R){P(!0),x(!1),await m(U.current);return}ne(!0),x(!1),await m(U.current),X()}},size:"sm",className:"h-8 text-xs px-1.5 w-full flex items-center justify-center gap-1",children:ce?u.jsx("span",{className:"truncate",children:"Saving..."}):u.jsxs(u.Fragment,{children:[u.jsx(CB,{className:"w-3.5 h-3.5 flex-shrink-0"}),u.jsx("span",{className:"hidden min-[340px]:inline",children:"Save"})]})})})]}),u.jsx("div",{className:"min-w-0",children:u.jsx("div",{className:"flex items-center gap-2 w-full min-w-0",children:u.jsxs(Ws,{children:[u.jsx(Vs,{asChild:!0,children:u.jsxs(We,{variant:"ghost",size:"sm",className:"h-8 text-xs text-gray-600 dark:text-gray-300 flex items-center gap-1 px-2 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md w-full justify-between min-w-0",children:[u.jsx("span",{className:"truncate",title:String((E==null?void 0:E.description)||"Select a matter"),style:{maxWidth:"24ch",display:"inline-block"},children:String((E==null?void 0:E.description)||"Select a matter")}),u.jsx(ws,{className:"w-3 h-3 ml-1"})]})}),u.jsx(_s,{align:"start",className:"w-full max-h-[200px] overflow-y-auto",style:{width:"100%"},children:V.map((O,$)=>u.jsx(is,{className:"text-xs truncate max-w-full",onClick:()=>C(O),title:String((O==null?void 0:O.description)||`Case ${$+1}`),children:String((O==null?void 0:O.description)||`Case ${$+1}`)},$))})]})})})]}),L&&u.jsx("div",{role:"success","aria-live":"assertive",className:"mt-3",children:u.jsx("div",{className:"flex items-start border rounded-md p-3 border-green-200 dark:border-green-700 text-green-900 dark:text-green-100 bg-green-50 dark:bg-green-900",children:u.jsx("div",{className:"ml-3 flex-1",children:u.jsx("p",{className:"mt-1 text-sm",children:ee})})})}),xe&&u.jsx("div",{role:"alert","aria-live":"assertive",className:"mt-3",children:u.jsx("div",{className:"flex items-start border rounded-md p-3 border-red-200 dark:border-red-700 text-red-900 dark:text-red-100 bg-red-50 dark:bg-red-900",children:u.jsx("div",{className:"ml-3 flex-1",children:u.jsx("p",{className:"mt-1 text-sm",children:ee})})})})]})},Kt="src/sidepanel/panels/ClioInsights.tsx",mK=({clientEmail:r,setClientEmail:e,tempClientEmail:t,setTempClientEmail:n,emailParticipants:s,emailParticipantClients:i,currentClientIndex:c,setCurrentClientIndex:d,currentCaseIndex:p,casesForCurrentClient:m,setCasesForCurrentClient:g,isManuallySet:x,setIsManuallySet:b,isProjectManuallySelected:S,setIsProjectManuallySelected:T,isValidClient:E,isTempEmailValid:C,nextCase:R,prevCase:A,handleSetCurrentCaseIndex:F,ClientNavigation:P,onClientDataValidated:L,onTransientError:G,isValidating:U,refreshTrigger:V,integrationSettings:Q,hasTransientError:fe})=>{const B=zr(),ee=Ya(),ve=aa(),ce=w.useRef(r);ce.current=r;const ne=he=>he!==ce.current,[xe]=w.useState(!0),[J,X]=w.useState({}),[z,q]=w.useState({}),[O,$]=w.useState({}),[ae,be]=w.useState({}),[ie,K]=w.useState([]),[de,ge]=w.useState(!1),[se,Te]=w.useState(null),[qe,ze]=w.useState(null),[Be,Ce]=w.useState(!1),[vt,kt]=w.useState([]),[yt,At]=w.useState(!1),It=5,[Yt,Xt]=w.useState(1),[Or,vr]=w.useState(0),[dn,_e]=w.useState(!1),[Fe,nt]=w.useState(!1),ft=w.useRef(new Map),[Ut,Ue]=w.useState([]),He=w.useRef({}),Mt=w.useCallback(he=>{const Ke=typeof he=="string"?parseFloat(he):he;return isNaN(Ke)?"$0.00":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Ke)},[]),Ie=w.useCallback(he=>{if(!he||!he.client_data||!Array.isArray(he.client_data)||he.client_data.length===0)return!1;const Ke=he.client_data[0];return Ke&&typeof Ke=="object"&&Object.keys(Ke).length>0},[]),St=w.useCallback(he=>{if(B.info("selectClientDetails called",{sourceFile:Kt,hasDetails:!!he,detailsKeys:he?Object.keys(he):[]}),!he){B.warn("selectClientDetails called with undefined details",{sourceFile:Kt}),q({}),$({}),X({}),be({});return}B.info("Client details received for formatting",{sourceFile:Kt,clientDetails:he});const Ke=lt=>{const Jt=lt.replace(/\D/g,"");return Jt.length===10?`(${Jt.slice(0,3)}) ${Jt.slice(3,6)}-${Jt.slice(6)}`:lt};let _t="";if(he.primary_phone_number)_t=he.primary_phone_number;else if(he.phone_numbers)try{const lt=JSON.parse(he.phone_numbers);Array.isArray(lt)&&lt.length>0&&(_t=lt[0].number||"")}catch{const lt=he.phone_numbers;Array.isArray(lt)&&lt.length>0&&(_t=lt[0].number||"")}else he.phones&&Array.isArray(he.phones)&&(_t=he.phones[0]||"");let pt="";if(he.primary_email_address)pt=he.primary_email_address;else if(he.email_addresses)try{const lt=JSON.parse(he.email_addresses);Array.isArray(lt)&&lt.length>0&&(pt=lt[0].address||"")}catch{const lt=he.email_addresses;Array.isArray(lt)&&lt.length>0&&(pt=lt[0].address||"")}else he.emails&&Array.isArray(he.emails)&&(pt=he.emails[0]||"");let tt="";try{let lt=[];he.addresses&&(typeof he.addresses=="string"?lt=JSON.parse(he.addresses):lt=he.addresses);const Jt=lt[0];Jt&&(tt=`${Jt.street?`${Jt.street}, `:""}${Jt.city?`${Jt.city}, `:""}${Jt.province?`${Jt.province}, `:""}${Jt.country?`${Jt.country} `:""}${Jt.postal_code?`${Jt.postal_code}`:""}`.trim())}catch{B.warn("Error formatting address",{sourceFile:Kt})}const ut={Name:he.name||"",Email:pt||"",Phone:Ke(_t),Address:tt||""};B.info("Client details formatted and set",{sourceFile:Kt,selectedDetails:ut,originalDetails:he}),q(he),$(ut)},[B,Mt]),ht=w.useCallback(he=>{B.info("selectCaseDetails called",{sourceFile:Kt,hasDetails:!!he,detailsKeys:he?Object.keys(he):[]}),B.info("Case details received for formatting",{sourceFile:Kt,caseNames:he});const Ke={"Matter Number":he.name||"",Title:he.description||"","Maildrop Address":he.maildrop_address||"","Practice Area":he.practice_area||"",Status:he.status||"",Stage:he.matter_stage||"","Assigned To":he.responsible_attorney||"","Rate Type":he.custom_rate||"","Outstanding Balance":Mt(he.outstanding_balance||he.balance_outstanding||he.balance||0)};B.info("Case details formatted and set",{sourceFile:Kt,selectedDetails:Ke,originalDetails:he}),be(Ke)},[B,Mt]),Ge=w.useCallback(he=>{for(const Ke of ft.current.values()){const _t=Ke.find(pt=>String(pt.id)===he);if(_t&&_t.calendar_entries!==void 0)return _t}return null},[]),cr=w.useCallback(async(he,Ke)=>{B.info("Matter manually selected",{sourceFile:Kt,matterId:he.id,matterName:he.description}),Ke!=null&&Ke.preservePagination||(e(""),b(!0)),T(!0),Ke!=null&&Ke.preservePagination||(Xt(1),vr(1),ft.current.clear());const _t=Ge(he.id);if(_t){B.info("Using cached matter data from page cache",{sourceFile:Kt,matterId:he.id});const pt={};Object.entries(_t).forEach(([lt,Jt])=>{pt[lt]=String(Jt??"")}),X(pt),ht(pt);const tt=String(_t.id||he.id||""),ut=(_t.calendar_entries||[]).map(lt=>({...lt,case_id:tt}));K(ut),Ke!=null&&Ke.preservePagination||(g([_t]),F(0));return}_e(!0),nt(!1);try{const pt=await h8("clio",he.id,B);if(pt&&Object.keys(pt).length>0){const tt=pt.case_data||pt,ut=pt.client_data||{};B.info("Complete matter data fetched successfully",{sourceFile:Kt,matterId:he.id,hasCalendarEntries:!!tt.calendar_entries,hasLastCompletedTask:!!tt.last_completed_task,hasNextUpcomingTask:!!tt.next_upcoming_task,hasClientData:!!ut&&Object.keys(ut).length>0});const lt={};if(Object.entries(tt).forEach(([Wr,rr])=>{lt[Wr]=String(rr??"")}),X(lt),ht(lt),ut&&Object.keys(ut).length>0){St(ut);let Wr="";if(ut.primary_email_address)Wr=String(ut.primary_email_address);else if(ut.email_addresses)try{const rr=JSON.parse(String(ut.email_addresses));Array.isArray(rr)&&rr.length>0&&(Wr=rr[0].address||"")}catch{const rr=ut.email_addresses;Array.isArray(rr)&&rr.length>0&&(Wr=rr[0].address||"")}else ut.emails&&Array.isArray(ut.emails)&&(Wr=String(ut.emails[0]||""));Wr&&n(Wr)}const Jt=String(tt.id||he.id||""),Mn=(tt.calendar_entries||[]).map(Wr=>({...Wr,case_id:Jt}));K(Mn),Ke!=null&&Ke.preservePagination||(g([tt]),F(0))}else{B.warn("Failed to fetch complete matter data, using basic data",{sourceFile:Kt,matterId:he.id});const tt={};Object.entries(he).forEach(([ut,lt])=>{tt[ut]=String(lt??"")}),X(tt),ht(tt),K([]),Ke!=null&&Ke.preservePagination||(g([he]),F(0))}}catch(pt){B.error("Error fetching complete matter data",pt,{sourceFile:Kt,matterId:he.id}),nt(!0);const tt={};Object.entries(he).forEach(([ut,lt])=>{tt[ut]=String(lt??"")}),X(tt),ht(tt),K([]),Ke!=null&&Ke.preservePagination||(g([he]),F(0))}finally{_e(!1)}},[B,e,n,b,T,g,F,ht,St,K,Ge]),zt=w.useCallback(async(he,Ke=!1)=>{if(He.current[he]){const pt=He.current[he];if("pagination"in pt&&pt.pagination!=null){console.log(` [Cache L1] Component cache HIT for ${he}`),B.debug("Using cached client data (component cache)",{sourceFile:Kt,email:he});return}console.log(` [Cache L1] Stale pre-pagination data for ${he}, refetching`),delete He.current[he]}console.log(` [Cache L2] Checking browser storage for ${he}...`);const _t=await zm(he,B);if(_t){if("pagination"in _t&&_t.pagination!=null){console.log(` [Cache L2] Browser storage HIT - SALVAGED data for ${he}`),B.debug("Using cached client data (browser storage - salvaged)",{sourceFile:Kt,email:he}),He.current[he]=_t;return}console.log(` [Cache L2] Stale pre-pagination data for ${he}, clearing and refetching`),await Bw(he,B)}console.log(` [Cache L2] Browser storage MISS for ${he}`);try{console.log(` [Cache L3] Fetching from SERVER for ${he}...`),B.debug("Fetching client data from server",{sourceFile:Kt,email:he});const pt=await ve.getCurrentThreadId(),tt=await tS("clio",he,B,Ke,{limit:It},pt);He.current[he]=tt}catch(pt){throw pt instanceof Error&&pt.message.includes("Client not found")?B.debug("Client not found for email",{sourceFile:Kt,email:he}):B.error(`Error fetching client data for ${he}`,pt,{sourceFile:Kt}),pt}},[B,ve]),yr=w.useCallback(async()=>{B.info("fetchUserData called",{sourceFile:Kt,clientEmail:r});try{const he=await p8(B,"clio");ze(he)}catch(he){B.error("Error processing user data",he,{sourceFile:Kt})}},[B]),tr=w.useCallback(he=>{var lt;he.pagination?(vr(he.pagination.total_matters),he.pagination.matter_summaries&&Ue(he.pagination.matter_summaries),ft.current.set(1,he.case_data||[])):(vr(((lt=he.case_data)==null?void 0:lt.length)??0),Ue([]));const Ke=Ie(he);if(L(r,Ke),!Ke){B.debug("Cached client data is not valid",{sourceFile:Kt,clientEmail:r}),X({}),g([]),K([]),$({}),be({}),q({});return}const _t=he.client_data[0];St(_t);const pt=he.case_data||[];g(pt),F(0);const tt=pt.flatMap(Jt=>{const Mn=String(Jt.id||"");return(Jt.calendar_entries||[]).map(rr=>({...rr,case_id:Mn}))});K(tt);const ut=pt.length>0?Object.entries(pt[0]).reduce((Jt,[Mn,Wr])=>(Jt[Mn]=String(Wr),Jt),{}):{};X(ut),ht(ut),Te(null)},[r,Ie,L,B,St,ht,g,F]),ar=w.useCallback(async(he=!1)=>{var pt;if(B.info("fetchClientData called",{sourceFile:Kt,clientEmail:r,hasClientEmail:!!r}),!r){B.info("fetchClientData early return",{sourceFile:Kt,reason:r?"clio not connected":"no client email",clientEmail:r});return}const Ke=He.current[r];if(Ke&&"pagination"in Ke&&Ke.pagination!=null){B.debug("Cache hit (L1)  restoring from component cache",{sourceFile:Kt,clientEmail:r}),tr(Ke);return}const _t=await zm(r,B);if(_t&&"pagination"in _t&&_t.pagination!=null){B.debug("Cache hit (L2)  restoring from browser cache",{sourceFile:Kt,clientEmail:r}),He.current[r]=_t,tr(_t);return}ft.current.clear(),Xt(1),vr(0),Ue([]),F(0);try{if(ge(!0),Te(null),B.info("fetchClientData starting data fetch",{sourceFile:Kt,clientEmail:r,isLoading:!0}),!He.current[r])try{if(await zt(r,he),ne(r))return}catch(rr){rr instanceof Error&&rr.message.includes("(cached)")?B.debug("Using cached knowledge that this client doesn't exist",{sourceFile:Kt,clientEmail:r}):rr instanceof Error&&rr.message.includes("Client not found")?B.debug("Client not found",{sourceFile:Kt,clientEmail:r}):(B.error("Error fetching client data",rr,{sourceFile:Kt}),Te("both")),X({}),g([]),K([]),$({}),be({}),q({}),ge(!1);return}const tt=He.current[r];if(tt!=null&&tt.pagination?(vr(tt.pagination.total_matters),tt.pagination.matter_summaries&&Ue(tt.pagination.matter_summaries),ft.current.set(1,tt.case_data||[])):(vr(((pt=tt==null?void 0:tt.case_data)==null?void 0:pt.length)??0),Ue([])),!tt){X({}),g([]),K([]),$({}),be({}),q({}),ge(!1),L(r,!1);return}const ut=Ie(tt);if(L(r,ut),!ut){B.debug("Client data exists but is not valid",{sourceFile:Kt,clientEmail:r}),X({}),g([]),K([]),$({}),be({}),q({}),ge(!1);return}if(ne(r))return;const lt=tt.client_data[0];B.debug("Client data received",{sourceFile:Kt,clientDataAsRecord:lt}),St(lt);const Jt=tt.case_data||[];g(Jt),F(0);const Mn=Jt.flatMap(rr=>{const $n=String(rr.id||"");return(rr.calendar_entries||[]).map(ui=>({...ui,case_id:$n}))});K(Mn);const Wr=Jt.length>0?Object.entries(Jt[0]).reduce((rr,[$n,po])=>(rr[$n]=String(po),rr),{}):{};X(Wr),ht(Wr)}catch(tt){B.error("Error processing client data",tt,{sourceFile:Kt}),Te("both"),X({}),g([]),K([]),r&&L(r,!1)}finally{ge(!1)}},[r,zt,B,St,ht,g,L,Ie,F,tr]),Jn=w.useCallback(he=>{if(he===Yt||he<1)return;const Ke=Ut.length>0?Ut.length:Or,_t=Math.ceil(Ke/It);if(!(he>_t)){if(he===1&&ft.current.get(1))g(ft.current.get(1));else{const pt=(he-1)*It,ut=Ut.slice(pt,pt+It).map(lt=>({id:lt.id,description:lt.description,display_number:lt.display_number}));g(ut)}Xt(he),F(0),Ut.length>0&&vr(Ut.length)}},[Yt,Ut,Or,g,F]);w.useEffect(()=>{const he=async()=>{if(!await kT(B))try{const pt=(await UT("clio",B)).map(({id:tt,name:ut})=>({id:tt,name:ut}));await CT(pt,B)}catch(_t){B.error("Error fetching firm users",_t,{sourceFile:Kt})}};yr(),he()},[]),w.useEffect(()=>{(async()=>{var Ke,_t,pt,tt;if(Q&&Q.clio){const ut=((_t=(Ke=Q==null?void 0:Q.clio)==null?void 0:Ke.timeTracking)==null?void 0:_t.enabled)||!1;Ce(ut);return}try{const ut=await ee.getLocalItem("integrationSettings");if(ut&&ut.clio){const lt=((tt=(pt=ut==null?void 0:ut.clio)==null?void 0:pt.timeTracking)==null?void 0:tt.enabled)||!1;Ce(lt)}else Ce(!1)}catch(ut){B.error("Failed to fetch integration settings from storage",ut,{sourceFile:Kt}),Ce(!1)}})()},[Q]),w.useEffect(()=>{V>0&&(B.info("Clearing component cache due to refresh trigger",{sourceFile:Kt,refreshTrigger:V}),He.current={},Promise.all(s.map(he=>Bw(he,B))).catch(he=>{B.error("Failed to clear L2 cache during refresh",{sourceFile:Kt,error:he instanceof Error?he.message:String(he)})}),At(!1),r&&ar(!0))},[V]),w.useEffect(()=>{At(!1),s.length===0&&kt([])},[s]);const ls=w.useCallback(()=>{B.info("All participant validations complete",{sourceFile:Kt,participantCount:s.length}),At(!0)},[B,s.length]);uK({emailParticipants:s,getClientDetailsForEmail:zt,clientDataCache:He,isValidClientData:Ie,onClientDataValidated:L,refreshTrigger:V,onTransientError:G,onValidationComplete:ls}),w.useEffect(()=>{B.info("useEffect: client email or connection changed",{sourceFile:Kt,clientEmail:r,willFetchData:!!r}),r&&(B.info("Triggering fetchClientData from useEffect",{sourceFile:Kt,clientEmail:r}),ar(),n(r),x&&!s.includes(r.toLowerCase())&&B.debug("Manually set email not in participants, validating separately",{sourceFile:Kt,clientEmail:r}))},[r,ar,n,x,s,B]),w.useEffect(()=>{!x&&(!r||s.length===0)&&(n(null),$({}),be({}),K([]))},[r,s.length,x,n,$,be]),w.useEffect(()=>{if(B.info("useEffect: case index changed",{sourceFile:Kt,currentCaseIndex:p,casesCount:m.length,willUpdateCaseDetails:m.length>0&&p<m.length}),m.length>0&&p<m.length){const he=m[p];B.info("Updating case details for index",{sourceFile:Kt,currentCaseIndex:p,caseData:he?Object.keys(he):null});const Ke=he?Object.entries(he).reduce((_t,[pt,tt])=>(_t[pt]=String(tt),_t),{}):{};X(Ke),ht(Ke),B.info("Case details updated",{sourceFile:Kt,formattedCaseData:Ke})}},[p,m,ht,B]);const qs=w.useCallback(he=>{B.info("Contacts created, storing for matter linking",{sourceFile:Kt,contactCount:he.length}),kt(he)},[B]),ho=w.useCallback(he=>{B.info("Contact linked to matter successfully",{sourceFile:Kt})},[B]),Er=w.useCallback(async he=>{var _t,pt;ge(!0);const Ke={id:((pt=(_t=he.projectId)==null?void 0:_t.native)==null?void 0:pt.toString())||"",description:he.projectName||"",practice_area:he.projectTypeName||"",matter_stage:he.phaseName||"",status:he.isArchived?"Closed":"Open",client_name:he.clientName||"",responsible_attorney:he.firstPrimaryName||"",url:he.projectUrl||"",name:he.projectName||""};await cr(Ke).then(()=>{ge(!1)})},[cr]),vn=w.useCallback(he=>{const Ke=He.current[he]?He.current[he]:He.current[he.toLowerCase()];if(Ke!=null&&Ke.client_data&&Array.isArray(Ke.client_data)&&Ke.client_data.length>0){const _t=Ke.client_data[0];return String(_t.name||"")}return null},[]),Lo=(se==="client"||se==="both")&&!de,cs=(se==="matter"||se==="both")&&!de;return xe?u.jsxs("div",{className:"relative h-full",children:[u.jsxs("div",{className:"space-y-4 overflow-y-auto h-full mt-0 pb-32",children:[u.jsx(iK,{onMatterSelected:Er}),u.jsx(sK,{clientEmail:r,emailParticipants:s,emailParticipantClients:i,currentClientIndex:c,setCurrentClientIndex:d,setClientEmail:e,isManuallySet:x,selectedClientDetails:O,linkableFields:[{field:"Name",url:z.url||""}].filter(he=>he.url),isLoading:de,ClientNavigation:P,handleSectionClick:()=>{},tempClientEmail:t||"",setTempClientEmail:n,setIsManuallySet:b,isValidClient:E||!1,isTempEmailValid:C||!1,showClientDocumentsButton:!1,isValidating:U,fetchError:Lo,hasTransientError:fe,onContactsCreated:qs,getClientNameFromCache:vn,isClientDataValidationComplete:yt}),u.jsx(oK,{clientEmail:r,selectedCaseDetails:ae,casesForCurrentClient:m,currentCaseIndex:p,linkableFields:[{field:"Title",url:J.url||""}].filter(he=>he.url),nextCase:R,prevCase:A,isLoading:de,isManuallySet:x,setCurrentCaseIndex:F,calendarEntries:ie,isValidating:U,matterId:J.id||"",onMatterManuallySelected:cr,fetchError:cs,userData:qe,createdContacts:vt,onMatterLinked:ho,pageSize:It,currentPage:Yt,totalMatters:Or,onNavigateToPage:Jn,allMatterSummaries:Ut,isLoadingMatterDetails:dn,matterDetailError:Fe})]}),Be&&u.jsx("div",{className:"fixed bottom-5 left-4 right-4 z-10 shadow-[0_-4px_12px_rgba(0,0,0,0.1)]",children:u.jsx(pK,{userData:qe,clientEmail:r,emailParticipantClients:i,currentCaseIndex:p,casesForCurrentClient:m})})]}):(B.info("ClioInsights not rendering - Clio not connected",{sourceFile:Kt,isClioConnected:xe}),null)},gK=({clientEmail:r,emailParticipants:e,emailParticipantClients:t,currentClientIndex:n,setCurrentClientIndex:s,setClientEmail:i,isManuallySet:c,selectedClientDetails:d,isLoading:p,ClientNavigation:m,handleSectionClick:g,tempClientEmail:x,setTempClientEmail:b,setIsManuallySet:S,isValidClient:T,isTempEmailValid:E,isValidating:C})=>{const R=()=>u.jsx(Gs,{rows:2});return u.jsxs("div",{className:"w-full min-h-[4rem] border border-border/50 rounded-lg shadow-sm bg-card text-card-foreground",title:"Client Information",children:[u.jsxs("div",{className:"flex items-center justify-between p-2 border-b bg-muted",children:[u.jsx("div",{className:"flex items-center gap-2",children:u.jsx("a",{href:"https://global.inszoom.com/CorpAttorney/aty_dashboard.aspx?phn_msg=False&QLogin=Y",target:"_blank",rel:"noopener noreferrer",className:"font-medium text-sm ml-2 hover:opacity-80 text-blue-700 dark:text-blue-400 underline underline-offset-4 decoration-blue-700 dark:decoration-blue-400 transition-opacity cursor-pointer",children:"CLIENT"})}),u.jsxs(Ws,{children:[u.jsx(Vs,{asChild:!0,children:u.jsx(We,{variant:"ghost",size:"icon",className:"h-6 w-6",children:u.jsx(lo,{className:"h-4 w-4"})})}),u.jsx(_s,{align:"end",className:"p-2",children:u.jsx("div",{className:"flex flex-col gap-2 w-64",children:u.jsxs("div",{className:"flex gap-2 items-center",children:[u.jsx(an,{type:"email",value:x||"",onChange:A=>b(A.target.value),placeholder:"Set client email",className:`flex-1 px-2 py-1 h-8 text-xs ${E===!1?"border-red-300 focus:ring-red-500":""}`}),u.jsx(We,{variant:"outline",size:"sm",className:`h-8 text-xs px-2 ${E===!1?"bg-red-50 hover:bg-red-100":""}`,onClick:()=>{i(x||"",!0)},disabled:!x,title:E===!1?"Warning: This email is not recognized as a valid client in INSZoom":"Set email as current client",children:"Search"})]})})})]})]}),p?R():u.jsxs(u.Fragment,{children:[t.length>1&&!c&&u.jsx(m,{}),c&&r&&u.jsx("div",{className:"px-3 py-1 bg-gray-50 dark:bg-gray-800 border-b dark:border-gray-700",children:u.jsxs("span",{className:"text-xs text-gray-600 dark:text-gray-300 truncate max-w-[200px]",title:r||"",children:[r," (Manually set)"]})}),C&&e.length>0&&t.length===0&&!c?u.jsx(Gs,{rows:2}):d&&Object.keys(d).length>0?u.jsx(ru,{details:d}):u.jsx("div",{className:"p-3 text-sm text-gray-600 dark:text-gray-400",children:u.jsx("p",{className:"mb-2",children:c&&r?`No client information found for ${r}`:e.length>0&&t.length===0?`No client information available for emails on the selected thread:
                      ${e.join(", ")}`:e.length>0?"No client information available for the selected email ID":"Select a clientemail thread to view client information"})})]})]})},vK=({clientEmail:r,selectedCaseDetails:e,casesForCurrentClient:t,currentCaseIndex:n,caseDetails:s,nextCase:i,prevCase:c,isLoading:d,setCurrentCaseIndex:p,isValidating:m=!1})=>{const[g,x]=w.useState(""),[b,S]=w.useState(!1),T=w.useMemo(()=>{if(!g.trim())return t;const A=g.toLowerCase();return t.filter(F=>{var L;return String(F.projectName||((L=F.Data)==null?void 0:L.CaseDescription)||"").toLowerCase().includes(A)})},[t,g]),E=A=>{S(A),A||x("")},C=()=>u.jsx(Gs,{rows:2}),R=A=>{if(p)p(A);else if(A>n)for(let F=n;F<A;F++)i();else if(A<n)for(let F=n;F>A;F--)c()};return u.jsxs("div",{className:"w-full min-h-[4rem] border border-border/50 rounded-lg shadow-sm bg-card text-card-foreground",title:"Case Information",children:[u.jsx("div",{className:"flex items-center justify-between p-2 border-b bg-muted",children:u.jsx("div",{className:"flex items-center gap-2",children:u.jsx("a",{href:"https://global.inszoom.com/CorpAttorney/aty_dashboard.aspx?phn_msg=False&QLogin=Y",target:"_blank",rel:"noopener noreferrer",className:"font-medium text-sm ml-2 hover:opacity-80 text-blue-700 dark:text-blue-400 underline underline-offset-4 decoration-blue-700 dark:decoration-blue-400 transition-opacity cursor-pointer",children:"CASES"})})}),d?C():e&&Object.keys(e).length>0?u.jsxs(u.Fragment,{children:[t.length>1&&u.jsx("div",{className:"flex justify-between items-center px-3 py-1 bg-gray-50 dark:bg-gray-800 border-b dark:border-gray-700",children:u.jsx("div",{className:"flex-1 flex items-center",children:u.jsxs(Ws,{open:b,onOpenChange:E,children:[u.jsx(Vs,{asChild:!0,children:u.jsxs(We,{variant:"ghost",size:"sm",className:"h-8 text-sm text-gray-600 dark:text-gray-300 flex items-center gap-1 px-2",children:[u.jsx("span",{className:"truncate max-w-[180px]",title:e.Title||e["Case Description"]||"",children:e.Title||e["Case Description"]||"Case"}),u.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["(",n+1,"/",t.length,")"]}),u.jsx(ws,{className:"w-3 h-3 ml-1"})]})}),u.jsxs(_s,{align:"start",className:"w-[280px] p-0",children:[u.jsxs("div",{className:"p-2 border-b border-gray-200 dark:border-gray-700",children:[u.jsxs("div",{className:"relative",children:[u.jsx(lo,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),u.jsx(an,{placeholder:"Search cases...",value:g,onChange:A=>x(A.target.value),className:"pl-8 pr-8 h-8 text-xs",autoFocus:!0,onClick:A=>A.stopPropagation(),onKeyDown:A=>A.stopPropagation()}),g&&u.jsx("button",{onClick:A=>{A.stopPropagation(),x("")},className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:u.jsx(Oi,{className:"w-4 h-4"})})]}),g&&u.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:["Showing ",T.length," of ",t.length]})]}),u.jsx("div",{className:"max-h-[200px] overflow-y-auto",children:T.length>0?T.map((A,F)=>{var G;const P=t.findIndex(U=>U===A),L=String(A.projectName||((G=A.Data)==null?void 0:G.CaseDescription)||`Case ${P+1}`);return u.jsx(is,{className:`text-xs truncate ${P===n?"bg-gray-100 dark:bg-gray-700 font-medium":""}`,onClick:()=>R(P),title:L,children:L},P)}):u.jsxs("div",{className:"p-3 text-xs text-center text-gray-500 dark:text-gray-400",children:['No cases match "',g,'"']})})]})]})})}),u.jsx("div",{className:"break-words overflow-hidden",children:u.jsx(ru,{details:e,linkableFields:[{field:"Title",url:s.projectUrl}]})})]}):m?u.jsx(Gs,{rows:2}):u.jsx("div",{className:"p-3 text-sm text-gray-600 dark:text-gray-400",children:r?u.jsx(u.Fragment,{children:u.jsx("p",{className:"mb-2",children:"Select a client email thread to view case information"})}):"Select a client email thread to view case information"})]})},Ar="src/sidepanel/panels/InsZoomInsights.tsx",ri=r=>{if(!r)return"";try{return new Date(r).toLocaleDateString(void 0,{timeZone:"UTC"})}catch{return r}},EN=r=>{if(console.log("caseData",r),!r||Object.keys(r).length===0)return{};const e=n=>n.replace(/([a-z])([A-Z])/g,"$1 $2");return Object.entries(r).reduce((n,[s,i])=>{if(i!==null&&typeof i=="object"&&!Array.isArray(i)){let c=Object.entries(i);if(s==="report_fields")return console.log("formatting report_fields",c),Object.fromEntries(c),c.filter(([x,b])=>x!=="i797_valid_from"&&x!=="i797_valid_to"&&b!==null&&b!==void 0).forEach(([x,b])=>{let S=x.replace(/_/g," ").replace(/\b\w/g,E=>E.toUpperCase()).replace(/I797/g,"I-797").replace(/H Or L/g,"H/L"),T=String(b);T.includes(" 00:00:00")&&(T=ri(T.split(" ")[0])),n[S]=T}),console.log("promoted report_fields to top level",Object.keys(n)),n;s==="MilestoneCompletedDate"&&(c=c.sort(([,x],[,b])=>{const S=new Date(String(x)),T=new Date(String(b)),E=!isNaN(S.getTime()),C=!isNaN(T.getTime());return E&&C?T.getTime()-S.getTime():E&&!C?-1:!E&&C?1:0}));const d=[],p=[];c.forEach(([x,b])=>{const S=new Date(String(b));!isNaN(S.getTime())?d.push([x,b]):p.push([x,b])});const m=d.map(([x,b])=>`[[${e(x)}]]:
    ((${b}))
`).join(`
`),g=p.length>0?`
[[Not Completed:]]
${p.map(([x])=>`  - ${e(x)}`).join(`
`)}
`:"";n[s]=m+g}else{const c=i!=null?String(i):"";c.includes(`
`)?n[s]=`
  ${c.replace(/\n/g,`
  `)}`:n[s]=c}return n},{})},yK=({clientEmail:r,setClientEmail:e,tempClientEmail:t,setTempClientEmail:n,emailParticipants:s,emailParticipantClients:i,currentClientIndex:c,setCurrentClientIndex:d,currentCaseIndex:p,casesForCurrentClient:m,setCasesForCurrentClient:g,isManuallySet:x,setIsManuallySet:b,isProjectManuallySelected:S,setIsProjectManuallySelected:T,isValidClient:E,isTempEmailValid:C,nextCase:R,prevCase:A,handleSetCurrentCaseIndex:F,ClientNavigation:P,onClientDataValidated:L,isValidating:G,refreshTrigger:U,integrationSettings:V})=>{const Q=zr(),fe=aa(),[B]=w.useState(!0),[ee,ve]=w.useState({}),[ce,ne]=w.useState({}),[xe,J]=w.useState({}),[X,z]=w.useState(!1),q=w.useRef({}),O=w.useCallback(K=>{if(!K||!K.client_data)return!1;const de=K.client_data;return de&&typeof de=="object"&&Object.keys(de).length>0},[]),$=w.useCallback(async(K,de=!1)=>{if(Q.info("getClientDetailsForEmail called",{sourceFile:Ar,email:K,hasCachedData:!!q.current[K],forceRefresh:de}),de&&q.current[K]&&(Q.info("Force refresh requested - clearing component cache",{sourceFile:Ar,email:K}),delete q.current[K]),q.current[K]&&!de){Q.info("Using cached client data",{sourceFile:Ar,email:K}),Q.debug("Using cached client data",{sourceFile:Ar,email:K});return}try{Q.info("Starting client data fetch from server",{sourceFile:Ar,email:K,forceRefresh:de}),Q.debug("Fetching client data",{sourceFile:Ar,email:K,forceRefresh:de});const ge=await fe.getCurrentThreadId(),se=await tS("inszoom",K,Q,de,void 0,ge);if(se&&se.client_data&&se.client_data.Data){const Te=se.client_data.Data;let qe="",ze="",Be="",Ce="";Te.ArrivalAndDepartureDetails&&typeof Te.ArrivalAndDepartureDetails=="object"&&Te.ArrivalAndDepartureDetails!==null&&"ImmigrantStatusOnI94"in Te.ArrivalAndDepartureDetails&&(qe=String(Te.ArrivalAndDepartureDetails.ImmigrantStatusOnI94||""),ze=ri(String(Te.ArrivalAndDepartureDetails.I94ValidFrom||"")),Be=ri(String(Te.ArrivalAndDepartureDetails.DateOfExpiration||"")),Ce=String(Te.ArrivalAndDepartureDetails.I94Number||""));const vt={...se.client_data,FirstName:String(Te.FirstName||""),LastName:String(Te.LastName||""),Email:String(Te.Email||K),FileNumber:String(Te.FileNumber||""),Category:String(Te.Category||""),ImmigrantStatusOnI94:qe,I94ValidFrom:ze,I94ValidTo:Be,I94Number:Ce,...Te.report_fields&&{report_fields:Te.report_fields}};q.current[K]={client_data:vt,case_data:se.case_data||[],timestamp:Date.now()}}else q.current[K]={client_data:se.client_data,case_data:[],timestamp:Date.now()}}catch(ge){throw ge instanceof Error&&(ge.message.includes("Client not found")||ge.message.includes("(cached)"))?Q.debug("Client not found for email (including cached)",{sourceFile:Ar,email:K}):Q.error(`Error fetching client data for ${K}`,ge,{sourceFile:Ar}),ge}},[Q,fe]),ae=w.useCallback(K=>{Q.info("selectClientDetails called",{sourceFile:Ar,hasDetails:!!K,detailsKeys:K?Object.keys(K):[]}),Q.debug("Client details received for formatting",{sourceFile:Ar,details:K});const de=K.FirstName&&K.LastName?`${K.FirstName} ${K.LastName}`:K.fullName||"";let ge="";if(K.visa_details&&typeof K.visa_details=="object"&&K.visa_details!==null){const ze=K.visa_details;ze.Data&&Array.isArray(ze.Data)&&(ge=ze.Data.map(Ce=>{const vt=String(Ce.VisaType||""),kt=ri(String(Ce.IssuanceDate||"")),yt=ri(String(Ce.ExpirationDate||""));return`[[${vt}]]:
${kt} - ${yt}
`}).join(`
`))}let se="";if(K.passport_details&&typeof K.passport_details=="object"&&K.passport_details!==null){const ze=K.passport_details;ze.Data&&Array.isArray(ze.Data)&&(se=ze.Data.map(Ce=>{const vt=String(Ce.PassportNo||""),kt=String(Ce.PassportType||""),yt=String(Ce.PassportIssuingCountry||""),At=ri(String(Ce.PassportIssuanceDate||"")),It=ri(String(Ce.PassportExpirationDate||""));return`[[${yt} (${kt})]]
${vt} :
${At} - ${It}
`}).join(`
`))}let Te="";if(K.report_fields&&typeof K.report_fields=="object"&&K.report_fields!==null){const ze=K.report_fields,Be=ze.priority_date_1||"",Ce=ze.priority_date_1_country||"",vt=ze.priority_date_2||"",kt=ze.priority_date_2_country||"",yt=[];if(Be||Ce){const At=`${Be}${Ce?` [${Ce}]`:""}`;yt.push(At)}if(vt||kt){const At=`${vt}${kt?` [${kt}]`:""}`;yt.push(At)}yt.length>0&&(Te=yt.join(`
`))}const qe={Name:de,"Immigration Status":K.ImmigrantStatusOnI94||"","I-94 Number":K.I94Number||"","I-94 Validity":`${K.I94ValidFrom} - ${K.I94ValidTo}`||""};if(K.report_fields&&typeof K.report_fields=="object"&&K.report_fields!==null){const ze=K.report_fields,Be=ze.i797_status||"";qe["I-797 Status"]=Be;const Ce=ze.i797_valid_from||"",vt=ze.i797_valid_to||"";if(Ce&&Ce.trim()!==""||vt&&vt.trim()!==""){const kt=Ce?ri(Ce.split(" ")[0]):"",yt=vt?ri(vt.split(" ")[0]):"";qe["I-797 Validity"]=`${kt} - ${yt}`}else qe["I-797 Validity"]=""}else qe["I-797 Status"]="",qe["I-797 Validity"]="";if(qe["Passport Details"]=se,qe["Visa Details"]=ge,K.report_fields&&typeof K.report_fields=="object"&&K.report_fields!==null){const Be=K.report_fields.h_or_l_max_out_date||"";Be&&Be.includes(" 00:00:00")?qe["H/L Maxout Date"]=ri(Be.split(" ")[0]):qe["H/L Maxout Date"]=Be}else qe["H/L Maxout Date"]="";if(qe["Priority Dates"]=Te,K.report_fields&&typeof K.report_fields=="object"&&K.report_fields!==null){const Be=K.report_fields.maxout_date_applicability_notes||"";qe["Maxout Date Applicability and Notes"]=Be}else qe["Maxout Date Applicability and Notes"]="";Q.info("Client details formatted and set",{sourceFile:Ar,selectedDetails:qe,originalDetails:K}),ne(qe)},[Q]),be=w.useCallback(K=>{Q.info("selectCaseDetails called",{sourceFile:Ar,hasDetails:!!K,details:K||[]});const de={"Case Description":K.CaseDescription||K.projectName||"","Case Manager":K.WorkingCaseManagers_names||"","Case Status":K.CaseStatus||"","Opened Date":ri(K.CaseOpenedDate)||"","Date Filed":ri(K.DateSentToGovt)||""};de["Last Step Completed"]=K["Last Step Completed"]||"",de["Last Step Completed Date"]=ri(K["Last Step Completed Date"])||"",de["Receipt Number"]=K["Receipt Number"]||"",de["Case Main Receipt Status"]=K["Case Main Receipt Status"]||"",Q.info("Case details formatted and set",{sourceFile:Ar,selectedDetails:de,originalDetails:K}),J(de)},[Q]),ie=w.useCallback(async(K=!1)=>{if(Q.info("fetchClientData called",{sourceFile:Ar,clientEmail:r,isINSZoomConnected:B,hasClientEmail:!!r,forceRefresh:K}),!r||!B){Q.info("fetchClientData early return",{sourceFile:Ar,reason:r?"INSZoom not connected":"no client email",clientEmail:r,isINSZoomConnected:B});return}try{if(z(!0),Q.info("fetchClientData starting data fetch",{sourceFile:Ar,clientEmail:r,isLoading:!0,forceRefresh:K}),K||!q.current[r]||q.current[r].timestamp<Date.now()-1e3*60*60*24)try{await $(r,K)}catch(ze){ze instanceof Error&&ze.message.includes("(cached)")?Q.debug("Using cached knowledge that this client doesn't exist",{sourceFile:Ar,clientEmail:r}):Q.error("Error fetching client data",ze,{sourceFile:Ar}),ve({}),g([]),ne({}),J({}),z(!1);return}const de=q.current[r];if(!de){ve({}),g([]),ne({}),J({}),z(!1),L(r,!1);return}const ge=O(de);if(L(r,ge),!ge){Q.debug("Client data exists but is not valid",{sourceFile:Ar,clientEmail:r}),ve({}),g([]),ne({}),J({}),z(!1);return}const se=de.client_data;ae(se);const qe=(de.case_data||[]).sort((ze,Be)=>{const Ce=ze.Data||ze,vt=Be.Data||Be,kt=Ce.CaseOpenedDate,yt=vt.CaseOpenedDate;if(!kt&&!yt)return 0;if(!kt)return 1;if(!yt)return-1;const At=new Date(kt),It=new Date(yt),Yt=!isNaN(At.getTime()),Xt=!isNaN(It.getTime());return!Yt&&!Xt?0:Yt?Xt?It.getTime()-At.getTime():-1:1});if(g(qe),qe.length>0){const ze=qe[0].Data||qe[0],Be=EN(ze);ve(Be),be(Be)}else ve({}),be({})}catch(de){Q.error("Error processing client data",de,{sourceFile:Ar}),ve({}),g([]),r&&L(r,!1)}finally{z(!1)}},[r,B,$,Q,ae,be,g,L,O]);return w.useEffect(()=>{G&&s.length>0&&(q.current={},Q.debug("Cleared component-level client data cache for refresh",{sourceFile:Ar}))},[G,s.length,Q]),w.useEffect(()=>{const K=async()=>{if(B){Q.info("Validating all email participants",{sourceFile:Ar,participantCount:s.length});for(const de of s)try{await $(de);const ge=q.current[de],se=O(ge);L(de,se),Q.debug("Participant validation result",{sourceFile:Ar,email:de,hasValidData:se})}catch(ge){Q.debug("Participant validation failed",{sourceFile:Ar,email:de,error:ge}),L(de,!1)}}};s.length>0&&B&&K()},[s,B,$,O,L,Q,U]),w.useEffect(()=>{Q.info("useEffect: client email or connection changed",{sourceFile:Ar,clientEmail:r,isINSZoomConnected:B,willFetchData:!!(r&&B)}),r&&B&&(Q.info("Triggering fetchClientData from useEffect",{sourceFile:Ar,clientEmail:r,isManuallySet:x}),ie(x),n(r),x&&!s.includes(r.toLowerCase())&&Q.debug("Manually set email not in participants, validating separately",{sourceFile:Ar,clientEmail:r}))},[r,B,ie,n,x,s,Q]),w.useEffect(()=>{(!r||s.length===0&&!x)&&(n(null),ne({}),J({}))},[r,s.length,x,n,ne,J]),w.useEffect(()=>{if(Q.info("useEffect: case index changed",{sourceFile:Ar,currentCaseIndex:p,casesCount:m.length,willUpdateCaseDetails:m.length>0&&p<m.length}),m.length>0&&p<m.length){const K=m[p];Q.info("Updating case details for index",{sourceFile:Ar,currentCaseIndex:p,caseData:K?Object.keys(K):null});const de=K.Data||K,ge=EN(de);ve(ge),be(ge),Q.info("Case details updated",{sourceFile:Ar,formattedCaseData:Object.keys(ge)})}},[p,m,be,Q]),B?(Q.info("INSZoomInsights rendering components",{sourceFile:Ar,clientEmail:r,selectedClientDetails:Object.keys(ce),selectedCaseDetails:Object.keys(xe),isLoading:X}),u.jsxs("div",{className:"space-y-4 overflow-y-auto h-full mt-0",children:[u.jsx(gK,{clientEmail:r,emailParticipants:s,emailParticipantClients:i,currentClientIndex:c,setCurrentClientIndex:d,setClientEmail:e,isManuallySet:x,selectedClientDetails:ce,isLoading:X,ClientNavigation:P,handleSectionClick:()=>{},tempClientEmail:t,setTempClientEmail:n,setIsManuallySet:b,isValidClient:E,isTempEmailValid:C,isValidating:G}),u.jsx(vK,{clientEmail:r,selectedCaseDetails:xe,casesForCurrentClient:m,currentCaseIndex:p,caseDetails:ee,nextCase:R,prevCase:A,isLoading:X,setCurrentCaseIndex:F,isValidating:G})]})):(Q.info("INSZoomInsights not rendering - INSZoom not connected",{sourceFile:Ar,isINSZoomConnected:B}),null)},xK=/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;function wK(r){return r.filter(e=>e&&e.trim().length>0&&xK.test(e.trim())).map(e=>e.trim().toLowerCase())}function bK(r,e){if(!e)return r;const t=e.toLowerCase(),n=t.split("@")[1];return n?["gmail.com","googlemail.com","outlook.com","hotmail.com","live.com","yahoo.com","ymail.com","aol.com","icloud.com","me.com","mac.com","protonmail.com","proton.me","mail.com","zoho.com","gmx.com","gmx.net","trycandle.ai"].includes(n)?r.filter(c=>c.toLowerCase()!==t):r.filter(c=>c.toLowerCase().split("@")[1]!==n):r}const gj={rawParticipants:[],sanitizedParticipants:[],emailsWithValidData:new Set,validatedEmails:new Set,selectedClient:"",isValidating:!1,isManuallySet:!1,isProjectManuallySelected:!1,refreshTrigger:0,integrationSettings:{},hasTransientError:!1};function _K(r,e){var t,n;switch(e.type){case"SET_RAW_PARTICIPANTS":{const s=wK(e.participants);return console.log(" [Reducer] SET_RAW_PARTICIPANTS:",{rawCount:((t=e.participants)==null?void 0:t.length)??0,sanitizedCount:s.length,raw:e.participants,sanitized:s,filtered:(n=e.participants)==null?void 0:n.filter(i=>!s.includes(i.toLowerCase().trim()))}),JSON.stringify(s)===JSON.stringify(r.sanitizedParticipants)?(console.log(" [Reducer] Participants unchanged, skipping update"),r):{...r,rawParticipants:e.participants,sanitizedParticipants:s,isValidating:s.length>0}}case"MARK_EMAIL_VALIDATED":{const s=new Set(r.validatedEmails);s.add(e.email.toLowerCase());const i=new Set(r.emailsWithValidData),c=e.email.toLowerCase(),d=r.selectedClient&&c===r.selectedClient.toLowerCase();e.isValid?i.add(c):(!r.isValidating||!d)&&i.delete(c);const p=r.sanitizedParticipants.length>0&&s.size>=r.sanitizedParticipants.length;return p&&d&&!e.isValid&&i.delete(c),{...r,validatedEmails:s,emailsWithValidData:i,isValidating:!p}}case"SELECT_CLIENT":return{...r,selectedClient:e.email,isManuallySet:e.isManual};case"SET_MANUALLY_SET":return{...r,isManuallySet:e.value};case"SET_PROJECT_MANUALLY_SELECTED":return{...r,isProjectManuallySelected:e.value};case"START_VALIDATION":return{...r,isValidating:!0};case"COMPLETE_VALIDATION":return{...r,isValidating:!1};case"RESET_STATE":return{...gj,refreshTrigger:r.refreshTrigger,hasTransientError:!1};case"REFRESH_DATA":{const s=new Set;return r.selectedClient&&s.add(r.selectedClient.toLowerCase()),{...r,emailsWithValidData:s,validatedEmails:new Set,isValidating:!0,isManuallySet:!1,isProjectManuallySelected:!1,refreshTrigger:r.refreshTrigger+1,hasTransientError:!1}}case"SET_INTEGRATION_SETTINGS":return{...r,integrationSettings:e.settings};case"SET_TRANSIENT_ERROR":return{...r,hasTransientError:e.hasError};default:return r}}function SK({platform:r,dataProvider:e,isIntegrationConnected:t}){const n=zr(),[s,i]=w.useReducer(_K,gj),c=w.useRef(!1),d=w.useRef(0),p=Ya();w.useEffect(()=>{(async()=>{try{const Q=await zT(n);Object.keys(Q).length>0&&await p.setLocalItem("integrationSettings",Q),i({type:"SET_INTEGRATION_SETTINGS",settings:Q})}catch(Q){n.error("Failed to fetch integration settings",Q,{sourceFile:"src/shared/hooks/useEmailParticipants.ts"})}})()},[n]);const m=s.sanitizedParticipants.filter(V=>s.emailsWithValidData.has(V.toLowerCase())),g=Math.max(0,m.indexOf(s.selectedClient)),x=w.useCallback((V,Q)=>{n.info("Client data validation result received",{sourceFile:"useEmailParticipants.ts",email:V,isValid:Q}),i({type:"MARK_EMAIL_VALIDATED",email:V,isValid:Q})},[n]),b=w.useCallback((V,Q=!1)=>{i({type:"SELECT_CLIENT",email:V,isManual:Q})},[]),S=w.useCallback(V=>{i({type:"SET_MANUALLY_SET",value:V})},[]),T=w.useCallback(V=>{i({type:"SET_PROJECT_MANUALLY_SELECTED",value:V})},[]),E=w.useCallback((V,Q)=>{n.warn("Transient error during validation - user should try again later",{sourceFile:"useEmailParticipants.ts",email:V,error:Q.message}),i({type:"SET_TRANSIENT_ERROR",hasError:!0})},[n]),C=w.useCallback(()=>{n.debug("Resetting participant state",{sourceFile:"useEmailParticipants.ts"}),i({type:"RESET_STATE"})},[n]),R=w.useCallback(async()=>{const V=Date.now();if(V-d.current<50){n.debug("Debouncing fetchParticipants call",{sourceFile:"useEmailParticipants.ts"});return}d.current=V;try{if(r==="chrome"){const fe=await e.getCurrentThreadId();if(fe){n.info("Getting participants for Chrome",{sourceFile:"useEmailParticipants.ts",threadId:fe}),console.log(` [Participants] Fetching for thread: ${fe}`);try{const B=await u8(fe,n);console.log(` [Participants] Server returned ${(B==null?void 0:B.length)??0} participants:`,B),n.info("Received participants from server",{sourceFile:"useEmailParticipants.ts",threadId:fe,participantCount:(B==null?void 0:B.length)??0,participants:B==null?void 0:B.slice(0,5)}),(!B||B.length===0)&&(console.warn(` [Participants] No participants returned for thread ${fe}`),n.warn("No participants returned from server",{sourceFile:"useEmailParticipants.ts",threadId:fe})),i({type:"SET_RAW_PARTICIPANTS",participants:B||[]})}catch(B){console.error(` [Participants] Error fetching for thread ${fe}:`,B),n.error("Error fetching participants for Chrome",B,{sourceFile:"useEmailParticipants.ts",threadId:fe}),C()}}else console.warn(" [Participants] No threadId found for Chrome"),n.debug("No threadId found for Chrome",{sourceFile:"useEmailParticipants.ts"}),C()}else if(r==="outlook"){n.debug("Getting participants for Outlook",{sourceFile:"useEmailParticipants.ts"});try{const fe=await e.getCurrentThread();if(fe){let B=fe.participants;const ee=e.getCurrentUserEmail();if(ee){const ve=B.length;B=bK(B,ee),n.debug("Applied domain filtering for Outlook participants",{sourceFile:"useEmailParticipants.ts",userEmail:ee,originalCount:ve,filteredCount:B.length})}else n.warn("Could not get user email, skipping domain filtering",{sourceFile:"useEmailParticipants.ts"});i({type:"SET_RAW_PARTICIPANTS",participants:B})}else n.debug("No thread found for Outlook",{sourceFile:"useEmailParticipants.ts"}),C()}catch(fe){n.error("Error fetching participants for Outlook",fe,{sourceFile:"useEmailParticipants.ts"}),C()}}}catch(fe){n.error("Error in fetchParticipants",fe,{sourceFile:"useEmailParticipants.ts"}),C()}},[r,e,n,C]),A=w.useCallback(async()=>{if(!(s.isValidating||s.sanitizedParticipants.length===0)){n.info("Starting participant data refresh",{sourceFile:"useEmailParticipants.ts",participantCount:s.sanitizedParticipants.length});try{await Promise.all(s.sanitizedParticipants.map(V=>Bw(V,n))),i({type:"REFRESH_DATA"}),n.info("Participant data refresh initiated",{sourceFile:"useEmailParticipants.ts"})}catch(V){n.error("Error refreshing participant data",V,{sourceFile:"useEmailParticipants.ts"})}}},[s.isValidating,s.sanitizedParticipants,n]),F=m.length>0,P=m[0]??"",L=s.selectedClient?m.includes(s.selectedClient):!0,G=F&&!s.selectedClient&&!s.isManuallySet&&!s.isProjectManuallySelected,U=!s.isValidating&&s.selectedClient&&!L&&!s.isManuallySet&&!s.isProjectManuallySelected;return w.useEffect(()=>{G?(n.info("Auto-selecting first validated client",{sourceFile:"useEmailParticipants.ts",selectedClient:P}),i({type:"SELECT_CLIENT",email:P,isManual:!1})):U&&(n.info("Current client no longer valid, clearing",{sourceFile:"useEmailParticipants.ts",clientEmail:s.selectedClient}),i({type:"SELECT_CLIENT",email:"",isManual:!1}))},[G,U,P,s.selectedClient,n]),w.useEffect(()=>{if(e!=null&&e.onThreadChanged){const V=Q=>{Q?(n.debug("Thread changed",{sourceFile:"useEmailParticipants.ts",newThreadId:Q.threadId}),i({type:"RESET_STATE"}),R()):(n.info("Thread cleared",{sourceFile:"useEmailParticipants.ts"}),i({type:"RESET_STATE"}))};return e.onThreadChanged(V),()=>{e.removeThreadListener&&e.removeThreadListener(V)}}},[e,R,n]),w.useEffect(()=>{t&&!c.current&&(c.current=!0,R())},[t,R]),{validClients:m,selectedClient:s.selectedClient,currentClientIndex:g,sanitizedParticipants:s.sanitizedParticipants,isValidating:s.isValidating,isManuallySet:s.isManuallySet,isProjectManuallySelected:s.isProjectManuallySelected,refreshTrigger:s.refreshTrigger,integrationSettings:s.integrationSettings,hasTransientError:s.hasTransientError,selectClient:b,setManuallySet:S,setProjectManuallySelected:T,handleClientDataValidated:x,handleTransientError:E,refresh:A,resetState:C}}function EK({toggleSection:r,clientEmail:e,setClientEmail:t,setProjectId:n,setDocuments:s,setIsDocumentsLoading:i,setDocumentsError:c,onDocumentView:d,onRefreshReady:p,onGenerateRefresh:m}){const g=zr(),x=un().platform,b=aa();Ya();const{isConnected:S}=$i(),[T,E]=w.useState([]),[C,R]=w.useState(null),[A,F]=w.useState(!0),[P,L]=w.useState(0),[G,U]=w.useState([]),[V,Q]=w.useState(null),[fe,B]=w.useState(null),[ee,ve]=w.useState(!1),[ce,ne]=w.useState(!1),[xe,J]=w.useState(!1),X=ee||ce||xe,{validClients:z,selectedClient:q,currentClientIndex:O,sanitizedParticipants:$,isValidating:ae,isManuallySet:be,isProjectManuallySelected:ie,refreshTrigger:K,integrationSettings:de,hasTransientError:ge,selectClient:se,setManuallySet:Te,setProjectManuallySelected:qe,handleClientDataValidated:ze,handleTransientError:Be,refresh:Ce}=SK({platform:x,dataProvider:b,isIntegrationConnected:X});w.useEffect(()=>{p==null||p(Ce)},[p,Ce]),w.useEffect(()=>{t(q)},[q,t]),w.useEffect(()=>{(async()=>{await AI(g)})()},[g]);const vt=w.useCallback(()=>{if(P<G.length-1){const _e=P+1;L(_e)}},[P,G.length]),kt=w.useCallback(()=>{if(P>0){const _e=P-1;L(_e)}},[P]),yt=w.useRef(G.length);yt.current=G.length;const At=w.useCallback(_e=>{_e>=0&&_e<yt.current&&L(_e)},[]);w.useEffect(()=>{L(0)},[q]);const It=w.useCallback(({className:_e="",clientUrl:Fe})=>u.jsxs("div",{className:`flex items-center px-3 py-1 bg-gray-50 dark:bg-gray-800 border-b dark:border-gray-700 gap-2 ${_e}`,children:[u.jsx("div",{className:"flex-1 min-w-0 flex items-center",children:u.jsxs(Ws,{children:[u.jsx(Vs,{asChild:!0,children:u.jsxs(We,{variant:"ghost",size:"sm",className:"h-8 text-sm text-gray-600 dark:text-gray-300 flex items-center gap-1 px-2 max-w-full",children:[u.jsx("span",{className:"truncate",title:q||"",children:q||"No client"}),u.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400 flex-shrink-0",children:["(",O+1,"/",z.length,")"]}),u.jsx(ws,{className:"w-3 h-3 ml-1 flex-shrink-0"})]})}),u.jsx(_s,{align:"start",className:"max-h-[200px] overflow-y-auto",children:z.map((nt,ft)=>u.jsx(is,{className:`text-xs ${nt===q?"bg-gray-100 dark:bg-gray-700 font-medium":""}`,onClick:()=>{se(nt,!1)},children:nt},nt))})]})}),Fe&&u.jsxs("a",{href:Fe,target:"_blank",rel:"noopener noreferrer",className:"h-8 text-xs text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 border border-blue-200 dark:border-blue-800 px-3 flex-shrink-0 rounded-md inline-flex items-center gap-1 no-underline hover:no-underline",children:[u.jsx(Ba,{className:"w-3 h-3"}),"View"]})]}),[q,O,z,se]);w.useEffect(()=>{(async()=>{try{const Fe=await II(g),nt=Fe.some(Ue=>Ue.integration_type==="filevine"),ft=Fe.some(Ue=>Ue.integration_type==="clio"),Ut=Fe.some(Ue=>Ue.integration_type==="inszoom");ve(nt),ne(ft),J(Ut)}catch(Fe){g.error("Error checking integration connections",Fe,{sourceFile:"src/shared/components/sidepanel/panels/InsightsPanel.tsx"})}})()},[g]),w.useEffect(()=>{(async()=>{try{const Fe=await rg(g);E(Fe||[]);const nt=(Fe==null?void 0:Fe.some(He=>He.integration_type.toLowerCase()==="filevine"))||!1,ft=(Fe==null?void 0:Fe.some(He=>He.integration_type.toLowerCase()==="clio"))||!1,Ut=(Fe==null?void 0:Fe.some(He=>He.integration_type.toLowerCase()==="inszoom"))||!1;let Ue=null;if(nt?Ue="filevine":ft?Ue="clio":Ut&&(Ue="inszoom"),Ue){const He=await jS(Ue);R(He)}else R(null)}catch(Fe){g.error("Error fetching integrations:",Fe,{sourceFile:"src/shared/components/sidepanel/panels/InsightsPanel.tsx"})}finally{F(!1)}})()},[g]);const Yt=T.some(_e=>_e.integration_type.toLowerCase()==="filevine"),Xt=T.some(_e=>_e.integration_type.toLowerCase()==="clio"),Or=T.some(_e=>_e.integration_type.toLowerCase()==="inszoom");w.useEffect(()=>{B(V?!0:null)},[V]);const vr={clientEmail:q,setClientEmail:(_e,Fe)=>{if(!_e)se("",!1);else{const nt=z.indexOf(_e),ft=Fe===!0?!0:nt<0;se(_e,ft)}},tempClientEmail:V,setTempClientEmail:Q,emailParticipants:$,emailParticipantClients:z,currentClientIndex:O,setCurrentClientIndex:_e=>{const Fe=z[_e];Fe?se(Fe,!1):(g.warn("Invalid client index",{sourceFile:"src/shared/components/sidepanel/panels/InsightsPanel.tsx",index:_e,availableClients:z.length}),se("",!1))},currentCaseIndex:P,casesForCurrentClient:G,setCasesForCurrentClient:U,isManuallySet:be,setIsManuallySet:_e=>{Te(_e)},isProjectManuallySelected:ie,setIsProjectManuallySelected:qe,isValidClient:q?!0:null,isTempEmailValid:fe,nextCase:vt,prevCase:kt,handleSetCurrentCaseIndex:At,ClientNavigation:It,onClientDataValidated:ze,onTransientError:Be,isValidating:ae,refreshTrigger:K,integrationSettings:de,hasTransientError:ge},dn=x==="chrome"&&!S;return u.jsx("div",{className:"h-full",children:dn?u.jsx("div",{className:"p-4",children:u.jsx(d0,{feature:"Insights",description:"Connect your Gmail account to view client insights and case information",benefits:["Automatically identify clients from email participants","View relevant case information and documents","Access client details from your case management system"]})}):A?u.jsxs("div",{className:"flex flex-col items-center justify-center h-full",children:[u.jsx(ii,{className:"h-8 w-8 animate-spin text-blue-600"}),u.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"Loading integrations..."})]}):u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"flex items-center mb-1",children:u.jsx("span",{className:"font-small text-xs text-slate-800 dark:text-gray-400",children:"Data provided by"})}),u.jsxs("div",{className:"flex items-center justify-between mb-2",children:[C&&u.jsxs("a",{href:C.homeUrl,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 hover:opacity-80 text-blue-700 dark:text-blue-400 underline underline-offset-4 decoration-blue-700 dark:decoration-blue-400 transition-opacity cursor-pointer",children:[u.jsx(Pi,{src:C.logo,width:20,height:20,alt:C.name,className:"h-5 w-auto dark:brightness-0 dark:invert"}),u.jsx("span",{className:"font-small text-xs text-slate-800 dark:text-gray-300",children:C.name})]}),u.jsx(We,{size:"icon",variant:"outline",onClick:()=>{Ce(),m==null||m()},disabled:ae||$.length===0,className:"flex items-center h-6 w-6 mr-4",title:ae?"Refreshing...":$.length===0?"No participants to refresh":"Refresh participant data",children:u.jsx(Do,{className:`h-3 w-3 ${ae?"animate-spin":""}`})})]}),Yt&&u.jsx(eK,{toggleSection:r,setDocuments:s,setIsDocumentsLoading:i,setDocumentsError:c,setProjectId:n,onDocumentView:d,...vr}),Xt&&u.jsx(mK,{...vr}),Or&&u.jsx(yK,{...vr})]})})}const CK={showEmailSummary:!1,showInsightsTab:!0,showComposeTab:!0,showTemplatesTab:!0},kK=()=>CK,NK=r=>kK()[r],TK=({className:r=""})=>{const[e,t]=w.useState(!1),{isConnected:n,wasEverConnected:s,isLoading:i,error:c,status:d,reconnectAttempts:p,initiateReconnection:m,clearError:g}=$i(),{platform:x}=un();if(x!=="chrome"||n&&d!=="error"||e)return null;const b=async()=>{try{await m()}catch(F){console.error("Failed to reconnect Gmail:",F)}},S=()=>{t(!0),c&&g()},T=()=>d==="error"?"bg-red-50 border-red-200":s?"bg-yellow-50 border-yellow-200":"bg-blue-50 border-blue-200",E=()=>d==="error"?u.jsx(ih,{className:"h-4 w-4 text-red-600 flex-shrink-0"}):s?u.jsx(ih,{className:"h-4 w-4 text-yellow-600 flex-shrink-0"}):u.jsx(ih,{className:"h-4 w-4 text-blue-600 flex-shrink-0"}),C=()=>d==="error"?c||"Gmail connection error occurred":s?"Gmail connection lost. Some features may not work properly.":"Gmail connection required to access all features.",R=()=>d==="error"?"text-red-800":s?"text-yellow-800":"text-blue-800",A=()=>d==="error"?"bg-red-100 border-red-300 text-red-800 hover:bg-red-200 hover:border-red-400":s?"bg-yellow-100 border-yellow-300 text-yellow-800 hover:bg-yellow-200 hover:border-yellow-400":"bg-blue-100 border-blue-300 text-blue-800 hover:bg-blue-200 hover:border-blue-400";return u.jsxs("div",{className:`flex items-center justify-between ${T()} px-4 py-3 ${r}`,role:"alert","aria-live":"polite","aria-atomic":"true",children:[u.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[E(),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("p",{className:`text-sm ${R()} font-medium`,children:C()}),p>0&&u.jsxs("p",{className:`text-xs ${R()} opacity-75 mt-1`,children:["Reconnect attempts: ",p]})]})]}),u.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[u.jsx(We,{onClick:b,disabled:i,variant:"outline",size:"sm",className:`${A()} text-xs px-3 py-1 h-auto whitespace-nowrap`,"aria-label":i?"Connecting to Gmail...":s?"Reconnect Gmail account":"Connect Gmail account",children:i?u.jsxs(u.Fragment,{children:[u.jsx(Do,{className:"h-3 w-3 mr-1 animate-spin","aria-hidden":"true"}),"Connecting..."]}):s?"Reconnect Gmail":"Connect Gmail"}),u.jsx(We,{onClick:S,variant:"ghost",size:"sm",className:`${d==="error"?"text-red-600 hover:text-red-800 hover:bg-red-100":s?"text-yellow-600 hover:text-yellow-800 hover:bg-yellow-100":"text-blue-600 hover:text-blue-800 hover:bg-blue-100"} p-1 h-auto`,"aria-label":"Dismiss Gmail connection banner",children:u.jsx(Oi,{className:"h-4 w-4","aria-hidden":"true"})})]})]})},vj=w.createContext(void 0),yj=()=>{const r=w.useContext(vj);if(r===void 0)throw new Error("useToast must be used within a ToastProvider");return r},RK=({children:r})=>{const[e,t]=w.useState([]),n=w.useCallback(d=>{const p=Math.random().toString(36).substr(2,9),m={...d,id:p};t(x=>[...x,m]);const g=d.duration??5e3;return g>0&&setTimeout(()=>{t(x=>x.filter(b=>b.id!==p))},g),p},[]),s=w.useCallback(d=>{t(p=>p.filter(m=>m.id!==d))},[]),i=w.useCallback(()=>{t([])},[]),c={toasts:e,addToast:n,removeToast:s,clearAll:i};return u.jsxs(vj.Provider,{value:c,children:[r,u.jsx(AK,{})]})},AK=()=>{const{toasts:r,removeToast:e}=yj();return r.length===0?null:u.jsx("div",{className:"fixed top-4 right-4 z-50 flex flex-col gap-2 max-w-sm",children:r.map(t=>u.jsx(IK,{toast:t,onRemove:e},t.id))})},IK=({toast:r,onRemove:e})=>{const t=s=>{switch(s){case"success":return u.jsx(qc,{className:"h-5 w-5 text-green-600"});case"error":return u.jsx(ih,{className:"h-5 w-5 text-red-600"});case"warning":return u.jsx(oA,{className:"h-5 w-5 text-amber-600"});case"info":return u.jsx(Jc,{className:"h-5 w-5 text-blue-600"});default:return null}},n=s=>{switch(s){case"success":return"bg-green-50 border-green-200";case"error":return"bg-red-50 border-red-200";case"warning":return"bg-amber-50 border-amber-200";case"info":return"bg-blue-50 border-blue-200";default:return"bg-gray-50 border-gray-200"}};return u.jsxs("div",{className:`flex items-start gap-3 p-4 rounded-lg border shadow-lg animate-in slide-in-from-right-full ${n(r.type)}`,children:[t(r.type),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("p",{className:"text-sm font-medium text-gray-900",children:r.title}),r.description&&u.jsx("p",{className:"text-sm text-gray-600 mt-1",children:r.description}),r.action&&u.jsx(We,{onClick:r.action.onClick,variant:"outline",size:"sm",className:"mt-2 h-7 text-xs",children:r.action.label})]}),u.jsx(We,{onClick:()=>e(r.id),variant:"ghost",size:"sm",className:"p-1 h-auto",children:u.jsx(Oi,{className:"h-4 w-4"})})]})},PK=()=>{const{addToast:r}=yj(),e=w.useCallback(()=>{r({type:"success",title:"Gmail Connected",description:"Successfully connected to Gmail. All features are now available.",duration:4e3})},[r]),t=w.useCallback(c=>{r({type:"warning",title:"Gmail Connection Lost",description:"Some features may not work properly until you reconnect.",duration:0,action:c?{label:"Reconnect",onClick:c}:void 0})},[r]),n=w.useCallback((c,d)=>{r({type:"error",title:"Gmail Connection Error",description:c,duration:0,action:d?{label:"Retry",onClick:d}:void 0})},[r]),s=w.useCallback(()=>{r({type:"success",title:"Gmail Reconnected",description:"Successfully reconnected to Gmail.",duration:3e3})},[r]),i=w.useCallback(c=>{r({type:"error",title:"Reconnection Failed",description:"Failed to reconnect to Gmail. Please try again.",duration:0,action:c?{label:"Try Again",onClick:c}:void 0})},[r]);return{showConnectionSuccess:e,showConnectionLost:t,showConnectionError:n,showReconnectionSuccess:s,showReconnectionFailed:i}},jK=()=>{const{status:r,error:e,isConnected:t,initiateReconnection:n}=$i(),{platform:s}=un(),{showConnectionSuccess:i,showConnectionLost:c,showConnectionError:d,showReconnectionSuccess:p,showReconnectionFailed:m}=PK(),g=w.useRef("loading"),x=w.useRef(!0),b=w.useRef(!1);return w.useEffect(()=>{if(s!=="chrome")return;const S=g.current,T=x.current,E=b.current;if(!(!E&&r==="loading")){if(!E){b.current=!0,g.current=r,x.current=t;return}if(S!==r||T!==t)switch(r){case"connected":(S==="disconnected"||S==="error"||!T)&&(S==="loading"?p():i());break;case"disconnected":T&&S==="connected"&&c(()=>{n().catch(R=>{console.error("Failed to reconnect from toast:",R)})});break;case"error":d(e||"Unknown connection error occurred",()=>{n().catch(R=>{console.error("Failed to reconnect from toast:",R),m(()=>{n().catch(console.error)})})});break}g.current=r,x.current=t}},[r,e,t,s,n,i,c,d,p,m]),null},FK=({activeSection:r,toggleSection:e})=>{const t=zr();t.debug(`[MainPanelContent] Rendering with activeSection: "${r}"`,{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx",functionName:"MainPanelContent",data:{activeSection:r}});const n=HT(),s=Ya(),{platform:i}=un(),{isConnected:c,wasEverConnected:d}=$i(),p=i==="chrome"&&!c&&d,[m,g]=w.useState(""),[x,b]=w.useState(""),[S,T]=w.useState([]),[E,C]=w.useState(!1),[R,A]=w.useState(null),[F,P]=w.useState(null),[L,G]=w.useState("compose"),[U,V]=w.useState(!1),[Q,fe]=w.useState(!1),[B,ee]=w.useState(!1),[ve,ce]=w.useState(!1),ne=w.useRef(!1),xe=w.useRef(!1),J=w.useRef(null),X=w.useRef(null),z=w.useRef(null),q=w.useCallback(async()=>{try{t.info("Checking authentication status...",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"});const ie=await(n==null?void 0:n.isAuthenticated());return t.info("Authentication status checked",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx",authenticated:ie}),ie||!1}catch(ie){return t.error("Failed to check auth status",ie,{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"}),!1}},[n,t]);w.useEffect(()=>{t.info("MainPanelContent component loaded",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"});const ie=async()=>{const de=await q();fe(!0),ee(de),de?(t.info("Valid token found. User is authenticated.",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"}),r==="login"&&e("main")):(t.info("No valid token found. Show login page.",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"}),e("login"))},K=de=>{de.token&&(t.info("Token detected in storage, auth state will be updated automatically",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"}),ie(),Xy(t))};return s!=null&&s.onChanged&&s.onChanged(K),ie(),()=>{s!=null&&s.removeChangeListener&&s.removeChangeListener(K)}},[n,s,e,t,q,r]),w.useEffect(()=>{if(!Q||!B||xe.current){t.debug("Skipping CMS integration check - auth not ready, not authenticated, or already checked",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx",isAuthChecked:Q,isAuthenticated:B,hasRunInitialCheck:xe.current});return}xe.current=!0;const ie=async()=>{try{t.info("Checking Case Management System connection status",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"});const de=await RI(t);t.info("Case Management System connection status result",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx",connected:de}),V(de),ne.current||(de?(t.info("CMS connected, setting active tab to insights",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"}),G("insights")):(t.info("CMS not connected, setting active tab to compose",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"}),G("compose")),ne.current=!0)}catch(de){t.error("Error checking Case Management System connection",de,{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"}),V(!1),ne.current||(G("compose"),ne.current=!0)}},K=de=>{if(!de.integrations)return;t.info("Integrations changed via storage, rechecking CMS connection",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx",oldValue:de.integrations.oldValue,newValue:de.integrations.newValue});const ge=de.integrations.newValue;if(!Array.isArray(ge))return;const se=["inszoom","filevine","clio"];ge.some(qe=>se.includes(qe.integration_type))&&(t.info("CMS integration found",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx",newValue:de.integrations.newValue}),V(!0))};return ie(),s!=null&&s.onChanged&&s.onChanged(K),()=>{s!=null&&s.removeChangeListener&&s.removeChangeListener(K)}},[Q,B,t,s]),w.useEffect(()=>{if(!Q||!B)return;(async()=>{var K;try{const de=await zT(t);let ge=!1;try{if(de&&typeof de=="object"){const se=de==null?void 0:de.email;ge=!!((K=se==null?void 0:se.prefetch)!=null&&K.enabled)}}catch{ge=!1}ce(ge),t.debug("Prefetch setting checked",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx",prefetchEnabled:ge})}catch(de){t.error("Error checking prefetch setting",de,{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"}),ce(!1)}})()},[Q,B,t]);const O=ie=>{G(ie),e(ie==="login"?"login":"main")},$=w.useRef(m);w.useEffect(()=>{m!==$.current&&($.current=m,U&&G("insights"))},[m,U]);const ae=()=>{t.debug("[MainPanelContent] goBack called. Setting activeSection to null.",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx",functionName:"goBack"}),e("main"),P(null)},be=ie=>{t.debug("[MainPanelContent] handleDocumentView called",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx",functionName:"handleDocumentView",data:{document:ie}}),P(ie),e("Project Documents")};return w.useEffect(()=>{r==="Project Documents"&&J.current&&(J.current.scrollTop=0)},[r]),u.jsxs(RK,{children:[u.jsx(jK,{}),u.jsxs("div",{ref:J,className:`flex flex-col h-full relative ${r==="login"||r==="Project Documents"?"overflow-hidden":"overflow-y-auto"}`,children:[r!=="login"&&u.jsx(TK,{className:"flex-shrink-0"}),u.jsxs("div",{className:"flex flex-col",children:[NK("showEmailSummary")&&u.jsx("div",{className:"flex-shrink-0 border-b-2 border-gray-300",children:u.jsx(O9,{})}),u.jsx("div",{className:"flex-grow flex flex-col",children:p?u.jsx("div",{className:"flex-grow"}):u.jsxs(tV,{defaultValue:U?"insights":"compose",value:L,onValueChange:O,className:"w-full flex flex-col",children:[u.jsxs(QI,{className:`grid ${U?"grid-cols-3":"grid-cols-2"} w-full bg-white dark:bg-card border-b dark:border-border p-0 h-auto flex-shrink-0`,children:[U&&u.jsx(ly,{value:"insights",className:"m-2 mb-0 text-gray-600 dark:text-gray-200 data-[state=active]:text-blue-600 dark:data-[state=active]:text-blue-400 data-[state=active]:bg-white dark:data-[state=active]:bg-muted data-[state=active]:shadow-sm data-[state=active]:font-medium border-gray-200 dark:border-border data-[state=active]:border-b-2 data-[state=active]:border-b-blue-600 dark:data-[state=active]:border-b-blue-400",children:"Insights"}),u.jsx(ly,{value:"compose",className:"m-2 mb-0 text-gray-600 dark:text-gray-200 data-[state=active]:text-blue-600 dark:data-[state=active]:text-blue-400 data-[state=active]:bg-white dark:data-[state=active]:bg-muted data-[state=active]:shadow-sm data-[state=active]:font-medium border-gray-200 dark:border-border data-[state=active]:border-b-2 data-[state=active]:border-b-blue-600 dark:data-[state=active]:border-b-blue-400",children:"Compose"}),u.jsx(ly,{value:"templates",className:"m-2 mb-0 text-gray-600 dark:text-gray-200 data-[state=active]:text-blue-600 dark:data-[state=active]:text-blue-400 data-[state=active]:bg-white dark:data-[state=active]:bg-muted data-[state=active]:shadow-sm data-[state=active]:font-medium border-gray-200 dark:border-border data-[state=active]:border-b-2 data-[state=active]:border-b-blue-600 dark:data-[state=active]:border-b-blue-400",children:"Templates"})]}),u.jsxs("div",{className:"flex-grow mb-0",children:[U&&u.jsx(cy,{forceMount:!0,value:"insights",className:`p-4 ${L==="insights"?"block":"hidden"}`,children:u.jsx(EK,{toggleSection:e,clientEmail:m,setClientEmail:g,setProjectId:b,setDocuments:T,setIsDocumentsLoading:C,setDocumentsError:A,onDocumentView:be,onRefreshReady:ie=>{X.current=ie},onGenerateRefresh:ve?()=>{var ie;(ie=z.current)==null||ie.call(z)}:void 0})}),u.jsx(cy,{forceMount:!0,value:"compose",className:`p-4 ${L==="compose"?"block":"hidden"}`,children:ve?u.jsx(oW,{clientEmail:m,onCmsRefresh:()=>{var ie;return(ie=X.current)==null?void 0:ie.call(X)},onGenerateRefreshReady:ie=>{z.current=ie}}):u.jsx(S9,{clientEmail:m})}),u.jsx(cy,{forceMount:!0,value:"templates",className:`p-4 ${L==="templates"?"block":"hidden"}`,children:u.jsx(A7,{clientEmail:m,isAuthenticated:B})})]})]})})]})," ",r==="login"&&u.jsx("div",{className:"fixed inset-0 bg-white dark:bg-gray-950 z-50",children:u.jsx(E9,{})}),r==="Project Documents"&&(t.debug('[MainPanelContent] activeSection is "Project Documents". Rendering overlay.',{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx",functionName:"MainPanelContent.render",data:{activeSection:r,selectedDocumentToView:F}}),u.jsx("div",{className:"absolute inset-0 bg-white dark:bg-gray-950 z-10",children:F?u.jsx(ZI,{documentId:F.documentId,documentName:F.name,onBack:ae}):u.jsx(sV,{clientEmail:m,projectId:x,documents:S,isLoading:E,error:R,goBack:ae})}))]})]})},OK=()=>{var x;const[r,e]=w.useState(null),t=zr(),{platform:n}=un(),s=aa(),{isConnected:i}=$i();if(w.useEffect(()=>{var E,C;if(n!=="chrome")return;const b=async()=>{var R;try{if((R=chrome==null?void 0:chrome.tabs)!=null&&R.query){const[A]=await chrome.tabs.query({active:!0,currentWindow:!0});if(A!=null&&A.id&&(A!=null&&A.windowId)){let F;try{const P=await(s==null?void 0:s.getCurrentThread());F=P==null?void 0:P.subject}catch(P){t.debug("Could not get email thread subject",{sourceFile:"src/shared/components/sidepanel/TabIndicator.tsx",sourceFunction:"getCurrentTabInfo",error:P})}e({tabId:A.id,windowId:A.windowId,title:A.title,url:A.url,emailSubject:F}),t.debug("Updated tab info in indicator",{sourceFile:"src/shared/components/sidepanel/TabIndicator.tsx",sourceFunction:"getCurrentTabInfo",tabId:A.id,windowId:A.windowId,title:A.title,emailSubject:F})}}}catch(A){t.error("Error getting current tab info",A,{sourceFile:"src/shared/components/sidepanel/TabIndicator.tsx",sourceFunction:"getCurrentTabInfo"})}};b();const S=[];if((E=chrome==null?void 0:chrome.tabs)!=null&&E.onActivated){const R=A=>{t.debug("Tab activated in indicator",{sourceFile:"src/shared/components/sidepanel/TabIndicator.tsx",sourceFunction:"handleTabActivated",tabId:A.tabId,windowId:A.windowId}),setTimeout(b,200)};chrome.tabs.onActivated.addListener(R),S.push(()=>{var A,F;(F=(A=chrome==null?void 0:chrome.tabs)==null?void 0:A.onActivated)!=null&&F.removeListener&&chrome.tabs.onActivated.removeListener(R)})}if((C=chrome==null?void 0:chrome.tabs)!=null&&C.onUpdated){const R=(A,F,P)=>{var L;F.url&&P.active&&P.windowId&&(t.debug("Tab URL updated, refreshing tab indicator",{sourceFile:"src/shared/components/sidepanel/TabIndicator.tsx",sourceFunction:"handleTabUpdated",tabId:A,newUrl:F.url}),setTimeout(b,300)),F.status==="complete"&&P.active&&((L=P.url)!=null&&L.includes("mail.google.com"))&&setTimeout(b,500)};chrome.tabs.onUpdated.addListener(R),S.push(()=>{var A,F;(F=(A=chrome==null?void 0:chrome.tabs)==null?void 0:A.onUpdated)!=null&&F.removeListener&&chrome.tabs.onUpdated.removeListener(R)})}if(s!=null&&s.onThreadChanged){const R=()=>{t.debug("Thread data changed, updating tab indicator",{sourceFile:"src/shared/components/sidepanel/TabIndicator.tsx",sourceFunction:"handleThreadChanged"}),setTimeout(b,100)};s.onThreadChanged(R),S.push(()=>{s.removeThreadListener&&s.removeThreadListener(R)})}const T=setInterval(()=>{b()},3e3);return S.push(()=>{clearInterval(T)}),()=>{S.forEach(R=>R())}},[n,t,s]),n!=="chrome"||!r||!i)return null;const c=()=>{var b;return r.emailSubject&&r.emailSubject!=="No Subject"?r.emailSubject.length>50?`${r.emailSubject.substring(0,50)}...`:r.emailSubject:(b=r.url)!=null&&b.includes("mail.google.com")?"Open an email to begin":r.title?r.title.length>30?`${r.title.substring(0,30)}...`:r.title:"No content available"},d=()=>{var b;return r.emailSubject&&r.emailSubject!=="No Subject"?"border-green-400 bg-green-50 dark:border-green-500 dark:bg-green-950":(b=r.url)!=null&&b.includes("mail.google.com")?"border-yellow-400 bg-yellow-50 dark:border-yellow-500 dark:bg-yellow-950":"border-blue-400 bg-blue-50 dark:border-blue-500 dark:bg-blue-950"},p=()=>{var b;return r.emailSubject&&r.emailSubject!=="No Subject"?"bg-green-400 dark:bg-green-500":(b=r.url)!=null&&b.includes("mail.google.com")?"bg-yellow-400 dark:bg-yellow-500":"bg-blue-400 dark:bg-blue-500"},m=()=>{var b;return r.emailSubject&&r.emailSubject!=="No Subject"?"text-green-800 dark:text-green-200":(b=r.url)!=null&&b.includes("mail.google.com")?"text-yellow-800 dark:text-yellow-200":"text-blue-800 dark:text-blue-200"},g=()=>{var b;return r.emailSubject&&r.emailSubject!=="No Subject"?"text-green-600 dark:text-green-300":(b=r.url)!=null&&b.includes("mail.google.com")?"text-yellow-600 dark:text-yellow-300":"text-blue-600 dark:text-blue-300"};return u.jsx("div",{className:`border-l-4 p-3 mb-4 rounded-r-md ${d()}`,children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"flex-shrink-0",children:u.jsx("div",{className:`w-2 h-2 rounded-full animate-pulse ${p()}`})}),u.jsxs("div",{className:"ml-3 flex-1 min-w-0",children:[u.jsx("p",{className:`text-sm font-medium ${m()}`,children:r.emailSubject&&r.emailSubject!=="No Subject"?"Email Opened":(x=r.url)!=null&&x.includes("mail.google.com")?"No Email Selected":"Active Tab"}),u.jsx("p",{className:`text-sm ${g()} truncate`,title:r.emailSubject||r.title,children:c()})]})]})})},DK=()=>{const{activeSection:r,setActiveSection:e}=GT(),t=b8(),n=S8(),s=zr(),{platform:i}=un(),c=d=>{if(s.debug(`toggleSection called with section: "${d}"`,{sourceFile:"src/shared/components/sidepanel/SidePanelContent.tsx",section:d,currentActiveSection:r}),r===d){s.debug(`toggleSection called with section: "${d}" but activeSection is already ${r}`,{sourceFile:"src/shared/components/sidepanel/SidePanelContent.tsx",section:d,currentActiveSection:r});return}else s.debug(`toggleSection called with section: "${d}" changing activeSection from ${r}`,{sourceFile:"src/shared/components/sidepanel/SidePanelContent.tsx",section:d,currentActiveSection:r}),e(d)};return w.useEffect(()=>{if(t!=null&&t.onMessage){const d=async p=>{if(p.type==="USER_LOGGED_OUT"&&(s.info("Received logout notification in sidepanel",{sourceFile:"src/shared/components/sidepanel/SidePanelContent.tsx"}),n!=null&&n.closeWindow))try{await n.closeWindow()}catch(m){s.error("Failed to close window",m,{sourceFile:"src/shared/components/sidepanel/SidePanelContent.tsx"})}};return t.onMessage(d),()=>{t.removeMessageListener&&t.removeMessageListener(d)}}},[t,n,s]),w.useEffect(()=>{if(i==="chrome"&&(t!=null&&t.sendMessage))return t.sendMessage({type:"SIDE_PANEL_MOUNTED"}).catch(()=>{}),()=>{t.sendMessage&&t.sendMessage({type:"SIDE_PANEL_UNMOUNTED"}).catch(()=>{})}},[i,t]),u.jsxs("div",{className:"flex flex-col h-full",children:[r!=="login"&&r!=="Project Documents"&&u.jsx(OK,{}),u.jsx("div",{className:"flex-grow min-h-0",children:u.jsx(FK,{activeSection:r,toggleSection:c})})]})},LK=()=>u.jsx(dK,{children:u.jsx(DK,{})}),MK=({variant:r})=>{const e=`logo ${r?`logo--${r}`:""}`;return u.jsx("div",{className:e,children:"candle"})},$K=({className:r="",variant:e="badge",showLastChecked:t=!1,hideInLogin:n=!1})=>{const[s,i]=w.useState(!1),{isConnected:c,isLoading:d,error:p,status:m,lastChecked:g,reconnectAttempts:x,wasEverConnected:b,initiateReconnection:S,clearError:T,forceRefresh:E}=$i(),{platform:C}=un();if(C!=="chrome"||n)return null;const R=U=>{switch(U){case"connected":return u.jsx(qc,{className:"h-4 w-4 text-green-600"});case"disconnected":return u.jsx(oA,{className:"h-4 w-4 text-amber-600"});case"loading":return u.jsx(ii,{className:"h-4 w-4 animate-spin text-blue-600"});case"error":return u.jsx(ih,{className:"h-4 w-4 text-red-600"});default:return u.jsx(Jc,{className:"h-4 w-4 text-gray-400"})}},A=U=>{switch(U){case"connected":return"bg-green-50 border-green-200 text-green-800";case"disconnected":return"bg-amber-50 border-amber-200 text-amber-800";case"loading":return"bg-blue-50 border-blue-200 text-blue-800";case"error":return"bg-red-50 border-red-200 text-red-800";default:return"bg-gray-50 border-gray-200 text-gray-600"}},F=U=>{switch(U){case"connected":return"Gmail Connected";case"disconnected":return"Gmail Disconnected";case"loading":return"Checking Connection...";case"error":return"Connection Error";default:return"Unknown Status"}},P=async()=>{try{await S(),i(!1)}catch(U){console.error("Failed to reconnect Gmail:",U)}},L=async()=>{try{await E()}catch(U){console.error("Failed to refresh connection status:",U)}},G=U=>{if(!U)return"Never checked";const Q=new Date().getTime()-U.getTime(),fe=Math.floor(Q/6e4),B=Math.floor(Q%6e4/1e3);return fe<1?`${B}s ago`:fe<60?`${fe}m ago`:`${Math.floor(fe/60)}h ago`};return e==="minimal"?u.jsxs("div",{className:`flex items-center gap-1 ${r}`,title:F(m),children:[u.jsx("div",{className:"cursor-pointer",title:F(m),"aria-label":F(m),children:R(m)}),!c&&!d&&u.jsx(We,{onClick:P,variant:"ghost",size:"sm",className:"h-6 px-2 text-xs",disabled:d,title:b?"Reconnect to Gmail":"Connect to Gmail",children:b?"Reconnect":"Connect"})]}):e==="full"?u.jsxs("div",{className:`flex items-center justify-between p-3 rounded-lg border ${A(m)} ${r}`,children:[u.jsxs("div",{className:"flex items-center gap-3",children:[R(m),u.jsxs("div",{className:"flex-1",children:[u.jsx("p",{className:"text-sm font-medium",children:F(m)}),p&&u.jsx("p",{className:"text-xs mt-1 opacity-80",children:p}),t&&g&&u.jsxs("p",{className:"text-xs mt-1 opacity-60",children:["Last checked: ",G(g)]})]})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[!c&&!d&&u.jsx(We,{onClick:P,variant:"outline",size:"sm",className:"text-xs",disabled:d,children:d?u.jsxs(u.Fragment,{children:[u.jsx(ii,{className:"h-3 w-3 mr-1 animate-spin"}),"Connecting..."]}):b?"Reconnect Gmail":"Connect Gmail"}),u.jsx(We,{onClick:L,variant:"ghost",size:"sm",className:"p-1",disabled:d,children:u.jsx(Do,{className:`h-3 w-3 ${d?"animate-spin":""}`})}),p&&u.jsx(We,{onClick:T,variant:"ghost",size:"sm",className:"p-1",children:u.jsx(Oi,{className:"h-3 w-3"})})]})]}):u.jsxs(Ws,{open:s,onOpenChange:i,children:[u.jsx(Vs,{asChild:!0,children:u.jsxs(We,{variant:"ghost",size:"sm",className:`h-8 px-2 flex items-center gap-2 ${A(m)} border hover:opacity-80 ${r}`,"aria-label":`Gmail connection status: ${F(m)}`,"aria-expanded":s,"aria-haspopup":"menu",children:[R(m),u.jsx("span",{className:"text-xs font-medium",children:F(m)})]})}),u.jsxs(_s,{align:"end",className:"w-80",children:[u.jsxs("div",{className:"p-3",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[R(m),u.jsx("span",{className:"font-medium text-sm",children:F(m)})]}),p&&u.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-2 mb-3",children:u.jsx("p",{className:"text-xs text-red-800",children:p})}),u.jsxs("div",{className:"text-xs text-gray-600 mb-3",children:[u.jsxs("p",{children:["Last checked: ",G(g)]}),x>0&&u.jsxs("p",{children:["Reconnect attempts: ",x]})]}),m==="connected"&&u.jsx("div",{className:"bg-green-50 border border-green-200 rounded-md p-2 mb-3",children:u.jsx("p",{className:"text-xs text-green-800",children:"Gmail is connected and working properly. All features are available."})}),m==="disconnected"&&u.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-md p-2 mb-3",children:u.jsx("p",{className:"text-xs text-amber-800",children:b?'Gmail connection lost. Some features may not work properly. Click "Reconnect Gmail" to restore connection.':'Gmail connection required. Some features may not work properly. Click "Connect Gmail" to enable all features.'})})]}),u.jsx(zy,{}),u.jsxs("div",{className:"p-2",children:[u.jsx(is,{asChild:!0,children:u.jsxs(We,{onClick:L,variant:"ghost",size:"sm",className:"w-full justify-start",disabled:d,children:[u.jsx(Do,{className:`h-4 w-4 mr-2 ${d?"animate-spin":""}`}),"Refresh Status"]})}),!c&&u.jsx(is,{asChild:!0,children:u.jsx(We,{onClick:P,variant:"ghost",size:"sm",className:"w-full justify-start",disabled:d,children:d?u.jsxs(u.Fragment,{children:[u.jsx(ii,{className:"h-4 w-4 mr-2 animate-spin"}),"Connecting..."]}):u.jsxs(u.Fragment,{children:[u.jsx(Jc,{className:"h-4 w-4 mr-2"}),b?"Reconnect Gmail":"Connect Gmail"]})})}),p&&u.jsx(is,{asChild:!0,children:u.jsxs(We,{onClick:T,variant:"ghost",size:"sm",className:"w-full justify-start",children:[u.jsx(Oi,{className:"h-4 w-4 mr-2"}),"Clear Error"]})})]})]})]})},UK=({className:r="",variant:e="badge",hideInLogin:t=!1})=>{const{platform:n}=un();if(n!=="outlook"||t)return null;const s="Outlook Connected";return e==="minimal"?u.jsx("div",{className:`flex items-center gap-1 ${r}`,title:s,children:u.jsx("div",{className:"cursor-pointer",title:s,"aria-label":s,children:u.jsx(qc,{className:"h-4 w-4 text-green-600"})})}):e==="full"?u.jsx("div",{className:`flex items-center justify-between p-3 rounded-lg border bg-green-50 border-green-200 text-green-800 ${r}`,children:u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx(qc,{className:"h-4 w-4 text-green-600"}),u.jsx("div",{className:"flex-1",children:u.jsx("p",{className:"text-sm font-medium",children:s})})]})}):u.jsxs("div",{className:`h-8 px-2 flex items-center gap-2 bg-green-50 border-green-200 text-green-800 border rounded ${r}`,children:[u.jsx(qc,{className:"h-4 w-4 text-green-600"}),u.jsx("span",{className:"text-xs font-medium",children:s})]})},Kf="src/shared/components/sidepanel/mainPanelContent/panelHeader.tsx",zK=r=>u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",width:"18",height:"18",...r,children:[u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),HK=({className:r})=>{const{activeSection:e,setActiveSection:t}=GT(),n=_8(),s=zr(),i=async()=>{if(n!=null&&n.openOptionsPage)try{await n.openOptionsPage()}catch(p){s.error("Failed to open options page",p,{sourceFile:Kf})}else s.warn("Options page opening not available on this platform",{sourceFile:Kf})},c=async()=>{if(n!=null&&n.openURL)try{await n.openURL(tT,"_blank")}catch(p){s.error("Failed to open feedback form",p,{sourceFile:Kf})}else s.warn("openURL not available on this platform",{sourceFile:Kf})},d=async()=>{s.info("Logout initiated",{sourceFile:Kf});try{await Yy(s),await LU(s),await wT(s),t("login")}catch(p){s.error("Failed to logout",p,{sourceFile:Kf})}};return u.jsxs("div",{className:`relative flex items-center justify-between px-3 py-2 bg-blue-600 border-b border-gray-200 text-gray-100 ${r}`,children:[u.jsxs("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2",children:[u.jsx($K,{variant:"minimal",className:"text-white border-white/20 hover:bg-white/10",hideInLogin:e==="login"}),u.jsx(UK,{variant:"minimal",className:"text-white border-white/20 hover:bg-white/10",hideInLogin:e==="login"})]}),u.jsx("div",{className:"flex-1 flex justify-center",children:u.jsx(MK,{variant:"panel"})}),u.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:u.jsxs(Ws,{children:[u.jsx(Vs,{asChild:!0,children:u.jsx("button",{className:"p-1 rounded hover:bg-white/10 transition-colors",children:u.jsx(zK,{className:"text-white"})})}),u.jsxs(_s,{align:"end",side:"bottom",sideOffset:5,children:[u.jsx(is,{onClick:i,children:"Configure"}),u.jsx(zy,{}),u.jsx(is,{onClick:c,children:"Feedback"}),u.jsx(zy,{}),u.jsx(is,{onClick:d,children:"Logout"})]})]})})]})};function kw(){try{const r=Office.context.officeTheme;if(console.log(" Outlook Theme Detection:",r),r){const e=r.bodyBackgroundColor;if(console.log(" Background Color:",e),e){const t=e.replace("#",""),n=parseInt(t.substring(0,2),16),s=parseInt(t.substring(2,4),16),i=parseInt(t.substring(4,6),16),c=(n+s+i)/3;console.log(` Brightness: ${c} (R:${n}, G:${s}, B:${i})`),c<128?(console.log(" Dark mode detected - applying dark class"),document.documentElement.classList.add("dark")):(console.log(" Light mode detected - removing dark class"),document.documentElement.classList.remove("dark")),console.log(" HTML classes:",document.documentElement.className)}}else console.warn(" Office theme not available")}catch(r){console.error(" Error detecting Outlook theme:",r)}}Office.onReady(()=>{kw(),Office.context.mailbox&&Office.context.mailbox.addHandlerAsync(Office.EventType.OfficeThemeChanged,r=>{console.log(" Office theme changed event triggered"),kw()},r=>{r.status===Office.AsyncResultStatus.Succeeded?console.log(" Office theme change listener added successfully"):console.warn(" Failed to add Office theme change listener:",r.error)}),window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>{console.log(" System color scheme changed:",e.matches?"dark":"light"),kw()}),Z2.createRoot(document.getElementById("root")).render(u.jsx(gr.StrictMode,{children:u.jsx(F5,{children:u.jsx(C8,{children:u.jsx(k8,{children:u.jsx(VH,{children:u.jsxs("div",{className:"sidepanel-container",children:[u.jsx(HK,{className:"sticky top-0 z-50 border-b-0"}),u.jsx(LK,{})]})})})})})}))});export{cd as f,Wy as t};
