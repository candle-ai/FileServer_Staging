const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index.DS5eee3c.js","assets/modulepreload-polyfill.B5Qt9EMX.js"])))=>i.map(i=>d[i]);
var FO=Object.defineProperty;var jO=(r,e,t)=>e in r?FO(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var H=(r,e,t)=>jO(r,typeof e!="symbol"?e+"":e,t);import"./modulepreload-polyfill.B5Qt9EMX.js";function OO(r,e){for(var t=0;t<e.length;t++){const n=e[t];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in r)){const i=Object.getOwnPropertyDescriptor(n,s);i&&Object.defineProperty(r,s,i.get?i:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}))}var pv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Tb(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var ux={exports:{}},Pp={},dx={exports:{}},rr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aS;function DO(){if(aS)return rr;aS=1;var r=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),c=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),x=Symbol.iterator;function b(D){return D===null||typeof D!="object"?null:(D=x&&D[x]||D["@@iterator"],typeof D=="function"?D:null)}var E={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},T=Object.assign,S={};function N(D,$,ne){this.props=D,this.context=$,this.refs=S,this.updater=ne||E}N.prototype.isReactComponent={},N.prototype.setState=function(D,$){if(typeof D!="object"&&typeof D!="function"&&D!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,D,$,"setState")},N.prototype.forceUpdate=function(D){this.updater.enqueueForceUpdate(this,D,"forceUpdate")};function R(){}R.prototype=N.prototype;function A(D,$,ne){this.props=D,this.context=$,this.refs=S,this.updater=ne||E}var j=A.prototype=new R;j.constructor=A,T(j,N.prototype),j.isPureReactComponent=!0;var P=Array.isArray,M=Object.prototype.hasOwnProperty,B={current:null},U={key:!0,ref:!0,__self:!0,__source:!0};function V(D,$,ne){var _e,q={},ie=null,xe=null;if($!=null)for(_e in $.ref!==void 0&&(xe=$.ref),$.key!==void 0&&(ie=""+$.key),$)M.call($,_e)&&!U.hasOwnProperty(_e)&&(q[_e]=$[_e]);var ye=arguments.length-2;if(ye===1)q.children=ne;else if(1<ye){for(var ue=Array(ye),ke=0;ke<ye;ke++)ue[ke]=arguments[ke+2];q.children=ue}if(D&&D.defaultProps)for(_e in ye=D.defaultProps,ye)q[_e]===void 0&&(q[_e]=ye[_e]);return{$$typeof:r,type:D,key:ie,ref:xe,props:q,_owner:B.current}}function Y(D,$){return{$$typeof:r,type:D.type,key:$,ref:D.ref,props:D.props,_owner:D._owner}}function ce(D){return typeof D=="object"&&D!==null&&D.$$typeof===r}function X(D){var $={"=":"=0",":":"=2"};return"$"+D.replace(/[=:]/g,function(ne){return $[ne]})}var de=/\/+/g;function we(D,$){return typeof D=="object"&&D!==null&&D.key!=null?X(""+D.key):$.toString(36)}function le(D,$,ne,_e,q){var ie=typeof D;(ie==="undefined"||ie==="boolean")&&(D=null);var xe=!1;if(D===null)xe=!0;else switch(ie){case"string":case"number":xe=!0;break;case"object":switch(D.$$typeof){case r:case e:xe=!0}}if(xe)return xe=D,q=q(xe),D=_e===""?"."+we(xe,0):_e,P(q)?(ne="",D!=null&&(ne=D.replace(de,"$&/")+"/"),le(q,$,ne,"",function(ke){return ke})):q!=null&&(ce(q)&&(q=Y(q,ne+(!q.key||xe&&xe.key===q.key?"":(""+q.key).replace(de,"$&/")+"/")+D)),$.push(q)),1;if(xe=0,_e=_e===""?".":_e+":",P(D))for(var ye=0;ye<D.length;ye++){ie=D[ye];var ue=_e+we(ie,ye);xe+=le(ie,$,ne,ue,q)}else if(ue=b(D),typeof ue=="function")for(D=ue.call(D),ye=0;!(ie=D.next()).done;)ie=ie.value,ue=_e+we(ie,ye++),xe+=le(ie,$,ne,ue,q);else if(ie==="object")throw $=String(D),Error("Objects are not valid as a React child (found: "+($==="[object Object]"?"object with keys {"+Object.keys(D).join(", ")+"}":$)+"). If you meant to render a collection of children, use an array instead.");return xe}function se(D,$,ne){if(D==null)return D;var _e=[],q=0;return le(D,_e,"","",function(ie){return $.call(ne,ie,q++)}),_e}function me(D){if(D._status===-1){var $=D._result;$=$(),$.then(function(ne){(D._status===0||D._status===-1)&&(D._status=1,D._result=ne)},function(ne){(D._status===0||D._status===-1)&&(D._status=2,D._result=ne)}),D._status===-1&&(D._status=0,D._result=$)}if(D._status===1)return D._result.default;throw D._result}var te={current:null},G={transition:null},z={ReactCurrentDispatcher:te,ReactCurrentBatchConfig:G,ReactCurrentOwner:B};function J(){throw Error("act(...) is not supported in production builds of React.")}return rr.Children={map:se,forEach:function(D,$,ne){se(D,function(){$.apply(this,arguments)},ne)},count:function(D){var $=0;return se(D,function(){$++}),$},toArray:function(D){return se(D,function($){return $})||[]},only:function(D){if(!ce(D))throw Error("React.Children.only expected to receive a single React element child.");return D}},rr.Component=N,rr.Fragment=t,rr.Profiler=s,rr.PureComponent=A,rr.StrictMode=n,rr.Suspense=p,rr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=z,rr.act=J,rr.cloneElement=function(D,$,ne){if(D==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+D+".");var _e=T({},D.props),q=D.key,ie=D.ref,xe=D._owner;if($!=null){if($.ref!==void 0&&(ie=$.ref,xe=B.current),$.key!==void 0&&(q=""+$.key),D.type&&D.type.defaultProps)var ye=D.type.defaultProps;for(ue in $)M.call($,ue)&&!U.hasOwnProperty(ue)&&(_e[ue]=$[ue]===void 0&&ye!==void 0?ye[ue]:$[ue])}var ue=arguments.length-2;if(ue===1)_e.children=ne;else if(1<ue){ye=Array(ue);for(var ke=0;ke<ue;ke++)ye[ke]=arguments[ke+2];_e.children=ye}return{$$typeof:r,type:D.type,key:q,ref:ie,props:_e,_owner:xe}},rr.createContext=function(D){return D={$$typeof:c,_currentValue:D,_currentValue2:D,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},D.Provider={$$typeof:i,_context:D},D.Consumer=D},rr.createElement=V,rr.createFactory=function(D){var $=V.bind(null,D);return $.type=D,$},rr.createRef=function(){return{current:null}},rr.forwardRef=function(D){return{$$typeof:u,render:D}},rr.isValidElement=ce,rr.lazy=function(D){return{$$typeof:g,_payload:{_status:-1,_result:D},_init:me}},rr.memo=function(D,$){return{$$typeof:m,type:D,compare:$===void 0?null:$}},rr.startTransition=function(D){var $=G.transition;G.transition={};try{D()}finally{G.transition=$}},rr.unstable_act=J,rr.useCallback=function(D,$){return te.current.useCallback(D,$)},rr.useContext=function(D){return te.current.useContext(D)},rr.useDebugValue=function(){},rr.useDeferredValue=function(D){return te.current.useDeferredValue(D)},rr.useEffect=function(D,$){return te.current.useEffect(D,$)},rr.useId=function(){return te.current.useId()},rr.useImperativeHandle=function(D,$,ne){return te.current.useImperativeHandle(D,$,ne)},rr.useInsertionEffect=function(D,$){return te.current.useInsertionEffect(D,$)},rr.useLayoutEffect=function(D,$){return te.current.useLayoutEffect(D,$)},rr.useMemo=function(D,$){return te.current.useMemo(D,$)},rr.useReducer=function(D,$,ne){return te.current.useReducer(D,$,ne)},rr.useRef=function(D){return te.current.useRef(D)},rr.useState=function(D){return te.current.useState(D)},rr.useSyncExternalStore=function(D,$,ne){return te.current.useSyncExternalStore(D,$,ne)},rr.useTransition=function(){return te.current.useTransition()},rr.version="18.3.1",rr}var lS;function Rb(){return lS||(lS=1,dx.exports=DO()),dx.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cS;function LO(){if(cS)return Pp;cS=1;var r=Rb(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function c(u,p,m){var g,x={},b=null,E=null;m!==void 0&&(b=""+m),p.key!==void 0&&(b=""+p.key),p.ref!==void 0&&(E=p.ref);for(g in p)n.call(p,g)&&!i.hasOwnProperty(g)&&(x[g]=p[g]);if(u&&u.defaultProps)for(g in p=u.defaultProps,p)x[g]===void 0&&(x[g]=p[g]);return{$$typeof:e,type:u,key:b,ref:E,props:x,_owner:s.current}}return Pp.Fragment=t,Pp.jsx=c,Pp.jsxs=c,Pp}var uS;function MO(){return uS||(uS=1,ux.exports=LO()),ux.exports}var d=MO(),w=Rb();const lr=Tb(w),Ab=OO({__proto__:null,default:lr},[w]);var mv={},fx={exports:{}},wo={},hx={exports:{}},px={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dS;function $O(){return dS||(dS=1,(function(r){function e(G,z){var J=G.length;G.push(z);e:for(;0<J;){var D=J-1>>>1,$=G[D];if(0<s($,z))G[D]=z,G[J]=$,J=D;else break e}}function t(G){return G.length===0?null:G[0]}function n(G){if(G.length===0)return null;var z=G[0],J=G.pop();if(J!==z){G[0]=J;e:for(var D=0,$=G.length,ne=$>>>1;D<ne;){var _e=2*(D+1)-1,q=G[_e],ie=_e+1,xe=G[ie];if(0>s(q,J))ie<$&&0>s(xe,q)?(G[D]=xe,G[ie]=J,D=ie):(G[D]=q,G[_e]=J,D=_e);else if(ie<$&&0>s(xe,J))G[D]=xe,G[ie]=J,D=ie;else break e}}return z}function s(G,z){var J=G.sortIndex-z.sortIndex;return J!==0?J:G.id-z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;r.unstable_now=function(){return i.now()}}else{var c=Date,u=c.now();r.unstable_now=function(){return c.now()-u}}var p=[],m=[],g=1,x=null,b=3,E=!1,T=!1,S=!1,N=typeof setTimeout=="function"?setTimeout:null,R=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function j(G){for(var z=t(m);z!==null;){if(z.callback===null)n(m);else if(z.startTime<=G)n(m),z.sortIndex=z.expirationTime,e(p,z);else break;z=t(m)}}function P(G){if(S=!1,j(G),!T)if(t(p)!==null)T=!0,me(M);else{var z=t(m);z!==null&&te(P,z.startTime-G)}}function M(G,z){T=!1,S&&(S=!1,R(V),V=-1),E=!0;var J=b;try{for(j(z),x=t(p);x!==null&&(!(x.expirationTime>z)||G&&!X());){var D=x.callback;if(typeof D=="function"){x.callback=null,b=x.priorityLevel;var $=D(x.expirationTime<=z);z=r.unstable_now(),typeof $=="function"?x.callback=$:x===t(p)&&n(p),j(z)}else n(p);x=t(p)}if(x!==null)var ne=!0;else{var _e=t(m);_e!==null&&te(P,_e.startTime-z),ne=!1}return ne}finally{x=null,b=J,E=!1}}var B=!1,U=null,V=-1,Y=5,ce=-1;function X(){return!(r.unstable_now()-ce<Y)}function de(){if(U!==null){var G=r.unstable_now();ce=G;var z=!0;try{z=U(!0,G)}finally{z?we():(B=!1,U=null)}}else B=!1}var we;if(typeof A=="function")we=function(){A(de)};else if(typeof MessageChannel<"u"){var le=new MessageChannel,se=le.port2;le.port1.onmessage=de,we=function(){se.postMessage(null)}}else we=function(){N(de,0)};function me(G){U=G,B||(B=!0,we())}function te(G,z){V=N(function(){G(r.unstable_now())},z)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(G){G.callback=null},r.unstable_continueExecution=function(){T||E||(T=!0,me(M))},r.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Y=0<G?Math.floor(1e3/G):5},r.unstable_getCurrentPriorityLevel=function(){return b},r.unstable_getFirstCallbackNode=function(){return t(p)},r.unstable_next=function(G){switch(b){case 1:case 2:case 3:var z=3;break;default:z=b}var J=b;b=z;try{return G()}finally{b=J}},r.unstable_pauseExecution=function(){},r.unstable_requestPaint=function(){},r.unstable_runWithPriority=function(G,z){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var J=b;b=G;try{return z()}finally{b=J}},r.unstable_scheduleCallback=function(G,z,J){var D=r.unstable_now();switch(typeof J=="object"&&J!==null?(J=J.delay,J=typeof J=="number"&&0<J?D+J:D):J=D,G){case 1:var $=-1;break;case 2:$=250;break;case 5:$=1073741823;break;case 4:$=1e4;break;default:$=5e3}return $=J+$,G={id:g++,callback:z,priorityLevel:G,startTime:J,expirationTime:$,sortIndex:-1},J>D?(G.sortIndex=J,e(m,G),t(p)===null&&G===t(m)&&(S?(R(V),V=-1):S=!0,te(P,J-D))):(G.sortIndex=$,e(p,G),T||E||(T=!0,me(M))),G},r.unstable_shouldYield=X,r.unstable_wrapCallback=function(G){var z=b;return function(){var J=b;b=z;try{return G.apply(this,arguments)}finally{b=J}}}})(px)),px}var fS;function UO(){return fS||(fS=1,hx.exports=$O()),hx.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hS;function zO(){if(hS)return wo;hS=1;var r=Rb(),e=UO();function t(o){for(var a="https://reactjs.org/docs/error-decoder.html?invariant="+o,h=1;h<arguments.length;h++)a+="&args[]="+encodeURIComponent(arguments[h]);return"Minified React error #"+o+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,s={};function i(o,a){c(o,a),c(o+"Capture",a)}function c(o,a){for(s[o]=a,o=0;o<a.length;o++)n.add(a[o])}var u=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),p=Object.prototype.hasOwnProperty,m=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,g={},x={};function b(o){return p.call(x,o)?!0:p.call(g,o)?!1:m.test(o)?x[o]=!0:(g[o]=!0,!1)}function E(o,a,h,v){if(h!==null&&h.type===0)return!1;switch(typeof a){case"function":case"symbol":return!0;case"boolean":return v?!1:h!==null?!h.acceptsBooleans:(o=o.toLowerCase().slice(0,5),o!=="data-"&&o!=="aria-");default:return!1}}function T(o,a,h,v){if(a===null||typeof a>"u"||E(o,a,h,v))return!0;if(v)return!1;if(h!==null)switch(h.type){case 3:return!a;case 4:return a===!1;case 5:return isNaN(a);case 6:return isNaN(a)||1>a}return!1}function S(o,a,h,v,_,k,F){this.acceptsBooleans=a===2||a===3||a===4,this.attributeName=v,this.attributeNamespace=_,this.mustUseProperty=h,this.propertyName=o,this.type=a,this.sanitizeURL=k,this.removeEmptyString=F}var N={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(o){N[o]=new S(o,0,!1,o,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(o){var a=o[0];N[a]=new S(a,1,!1,o[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(o){N[o]=new S(o,2,!1,o.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(o){N[o]=new S(o,2,!1,o,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(o){N[o]=new S(o,3,!1,o.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(o){N[o]=new S(o,3,!0,o,null,!1,!1)}),["capture","download"].forEach(function(o){N[o]=new S(o,4,!1,o,null,!1,!1)}),["cols","rows","size","span"].forEach(function(o){N[o]=new S(o,6,!1,o,null,!1,!1)}),["rowSpan","start"].forEach(function(o){N[o]=new S(o,5,!1,o.toLowerCase(),null,!1,!1)});var R=/[\-:]([a-z])/g;function A(o){return o[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(o){var a=o.replace(R,A);N[a]=new S(a,1,!1,o,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(o){var a=o.replace(R,A);N[a]=new S(a,1,!1,o,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(o){var a=o.replace(R,A);N[a]=new S(a,1,!1,o,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(o){N[o]=new S(o,1,!1,o.toLowerCase(),null,!1,!1)}),N.xlinkHref=new S("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(o){N[o]=new S(o,1,!1,o.toLowerCase(),null,!0,!0)});function j(o,a,h,v){var _=N.hasOwnProperty(a)?N[a]:null;(_!==null?_.type!==0:v||!(2<a.length)||a[0]!=="o"&&a[0]!=="O"||a[1]!=="n"&&a[1]!=="N")&&(T(a,h,_,v)&&(h=null),v||_===null?b(a)&&(h===null?o.removeAttribute(a):o.setAttribute(a,""+h)):_.mustUseProperty?o[_.propertyName]=h===null?_.type===3?!1:"":h:(a=_.attributeName,v=_.attributeNamespace,h===null?o.removeAttribute(a):(_=_.type,h=_===3||_===4&&h===!0?"":""+h,v?o.setAttributeNS(v,a,h):o.setAttribute(a,h))))}var P=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,M=Symbol.for("react.element"),B=Symbol.for("react.portal"),U=Symbol.for("react.fragment"),V=Symbol.for("react.strict_mode"),Y=Symbol.for("react.profiler"),ce=Symbol.for("react.provider"),X=Symbol.for("react.context"),de=Symbol.for("react.forward_ref"),we=Symbol.for("react.suspense"),le=Symbol.for("react.suspense_list"),se=Symbol.for("react.memo"),me=Symbol.for("react.lazy"),te=Symbol.for("react.offscreen"),G=Symbol.iterator;function z(o){return o===null||typeof o!="object"?null:(o=G&&o[G]||o["@@iterator"],typeof o=="function"?o:null)}var J=Object.assign,D;function $(o){if(D===void 0)try{throw Error()}catch(h){var a=h.stack.trim().match(/\n( *(at )?)/);D=a&&a[1]||""}return`
`+D+o}var ne=!1;function _e(o,a){if(!o||ne)return"";ne=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(a)if(a=function(){throw Error()},Object.defineProperty(a.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(a,[])}catch(ve){var v=ve}Reflect.construct(o,[],a)}else{try{a.call()}catch(ve){v=ve}o.call(a.prototype)}else{try{throw Error()}catch(ve){v=ve}o()}}catch(ve){if(ve&&v&&typeof ve.stack=="string"){for(var _=ve.stack.split(`
`),k=v.stack.split(`
`),F=_.length-1,W=k.length-1;1<=F&&0<=W&&_[F]!==k[W];)W--;for(;1<=F&&0<=W;F--,W--)if(_[F]!==k[W]){if(F!==1||W!==1)do if(F--,W--,0>W||_[F]!==k[W]){var Q=`
`+_[F].replace(" at new "," at ");return o.displayName&&Q.includes("<anonymous>")&&(Q=Q.replace("<anonymous>",o.displayName)),Q}while(1<=F&&0<=W);break}}}finally{ne=!1,Error.prepareStackTrace=h}return(o=o?o.displayName||o.name:"")?$(o):""}function q(o){switch(o.tag){case 5:return $(o.type);case 16:return $("Lazy");case 13:return $("Suspense");case 19:return $("SuspenseList");case 0:case 2:case 15:return o=_e(o.type,!1),o;case 11:return o=_e(o.type.render,!1),o;case 1:return o=_e(o.type,!0),o;default:return""}}function ie(o){if(o==null)return null;if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o;switch(o){case U:return"Fragment";case B:return"Portal";case Y:return"Profiler";case V:return"StrictMode";case we:return"Suspense";case le:return"SuspenseList"}if(typeof o=="object")switch(o.$$typeof){case X:return(o.displayName||"Context")+".Consumer";case ce:return(o._context.displayName||"Context")+".Provider";case de:var a=o.render;return o=o.displayName,o||(o=a.displayName||a.name||"",o=o!==""?"ForwardRef("+o+")":"ForwardRef"),o;case se:return a=o.displayName||null,a!==null?a:ie(o.type)||"Memo";case me:a=o._payload,o=o._init;try{return ie(o(a))}catch{}}return null}function xe(o){var a=o.type;switch(o.tag){case 24:return"Cache";case 9:return(a.displayName||"Context")+".Consumer";case 10:return(a._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return o=a.render,o=o.displayName||o.name||"",a.displayName||(o!==""?"ForwardRef("+o+")":"ForwardRef");case 7:return"Fragment";case 5:return a;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ie(a);case 8:return a===V?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a}return null}function ye(o){switch(typeof o){case"boolean":case"number":case"string":case"undefined":return o;case"object":return o;default:return""}}function ue(o){var a=o.type;return(o=o.nodeName)&&o.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function ke(o){var a=ue(o)?"checked":"value",h=Object.getOwnPropertyDescriptor(o.constructor.prototype,a),v=""+o[a];if(!o.hasOwnProperty(a)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var _=h.get,k=h.set;return Object.defineProperty(o,a,{configurable:!0,get:function(){return _.call(this)},set:function(F){v=""+F,k.call(this,F)}}),Object.defineProperty(o,a,{enumerable:h.enumerable}),{getValue:function(){return v},setValue:function(F){v=""+F},stopTracking:function(){o._valueTracker=null,delete o[a]}}}}function He(o){o._valueTracker||(o._valueTracker=ke(o))}function Ue(o){if(!o)return!1;var a=o._valueTracker;if(!a)return!0;var h=a.getValue(),v="";return o&&(v=ue(o)?o.checked?"true":"false":o.value),o=v,o!==h?(a.setValue(o),!0):!1}function Le(o){if(o=o||(typeof document<"u"?document:void 0),typeof o>"u")return null;try{return o.activeElement||o.body}catch{return o.body}}function Ne(o,a){var h=a.checked;return J({},a,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:h??o._wrapperState.initialChecked})}function gt(o,a){var h=a.defaultValue==null?"":a.defaultValue,v=a.checked!=null?a.checked:a.defaultChecked;h=ye(a.value!=null?a.value:h),o._wrapperState={initialChecked:v,initialValue:h,controlled:a.type==="checkbox"||a.type==="radio"?a.checked!=null:a.value!=null}}function zt(o,a){a=a.checked,a!=null&&j(o,"checked",a,!1)}function yt(o,a){zt(o,a);var h=ye(a.value),v=a.type;if(h!=null)v==="number"?(h===0&&o.value===""||o.value!=h)&&(o.value=""+h):o.value!==""+h&&(o.value=""+h);else if(v==="submit"||v==="reset"){o.removeAttribute("value");return}a.hasOwnProperty("value")?Bt(o,a.type,h):a.hasOwnProperty("defaultValue")&&Bt(o,a.type,ye(a.defaultValue)),a.checked==null&&a.defaultChecked!=null&&(o.defaultChecked=!!a.defaultChecked)}function Zt(o,a,h){if(a.hasOwnProperty("value")||a.hasOwnProperty("defaultValue")){var v=a.type;if(!(v!=="submit"&&v!=="reset"||a.value!==void 0&&a.value!==null))return;a=""+o._wrapperState.initialValue,h||a===o.value||(o.value=a),o.defaultValue=a}h=o.name,h!==""&&(o.name=""),o.defaultChecked=!!o._wrapperState.initialChecked,h!==""&&(o.name=h)}function Bt(o,a,h){(a!=="number"||Le(o.ownerDocument)!==o)&&(h==null?o.defaultValue=""+o._wrapperState.initialValue:o.defaultValue!==""+h&&(o.defaultValue=""+h))}var or=Array.isArray;function st(o,a,h,v){if(o=o.options,a){a={};for(var _=0;_<h.length;_++)a["$"+h[_]]=!0;for(h=0;h<o.length;h++)_=a.hasOwnProperty("$"+o[h].value),o[h].selected!==_&&(o[h].selected=_),_&&v&&(o[h].defaultSelected=!0)}else{for(h=""+ye(h),a=null,_=0;_<o.length;_++){if(o[_].value===h){o[_].selected=!0,v&&(o[_].defaultSelected=!0);return}a!==null||o[_].disabled||(a=o[_])}a!==null&&(a.selected=!0)}}function Ft(o,a){if(a.dangerouslySetInnerHTML!=null)throw Error(t(91));return J({},a,{value:void 0,defaultValue:void 0,children:""+o._wrapperState.initialValue})}function er(o,a){var h=a.value;if(h==null){if(h=a.children,a=a.defaultValue,h!=null){if(a!=null)throw Error(t(92));if(or(h)){if(1<h.length)throw Error(t(93));h=h[0]}a=h}a==null&&(a=""),h=a}o._wrapperState={initialValue:ye(h)}}function Ae(o,a){var h=ye(a.value),v=ye(a.defaultValue);h!=null&&(h=""+h,h!==o.value&&(o.value=h),a.defaultValue==null&&o.defaultValue!==h&&(o.defaultValue=h)),v!=null&&(o.defaultValue=""+v)}function Ze(o){var a=o.textContent;a===o._wrapperState.initialValue&&a!==""&&a!==null&&(o.value=a)}function dt(o){switch(o){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function rt(o,a){return o==null||o==="http://www.w3.org/1999/xhtml"?dt(a):o==="http://www.w3.org/2000/svg"&&a==="foreignObject"?"http://www.w3.org/1999/xhtml":o}var Lt,gr=(function(o){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(a,h,v,_){MSApp.execUnsafeLocalFunction(function(){return o(a,h,v,_)})}:o})(function(o,a){if(o.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in o)o.innerHTML=a;else{for(Lt=Lt||document.createElement("div"),Lt.innerHTML="<svg>"+a.valueOf().toString()+"</svg>",a=Lt.firstChild;o.firstChild;)o.removeChild(o.firstChild);for(;a.firstChild;)o.appendChild(a.firstChild)}});function tr(o,a){if(a){var h=o.firstChild;if(h&&h===o.lastChild&&h.nodeType===3){h.nodeValue=a;return}}o.textContent=a}var lt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},kt=["Webkit","ms","Moz","O"];Object.keys(lt).forEach(function(o){kt.forEach(function(a){a=a+o.charAt(0).toUpperCase()+o.substring(1),lt[a]=lt[o]})});function Nt(o,a,h){return a==null||typeof a=="boolean"||a===""?"":h||typeof a!="number"||a===0||lt.hasOwnProperty(o)&&lt[o]?(""+a).trim():a+"px"}function ze(o,a){o=o.style;for(var h in a)if(a.hasOwnProperty(h)){var v=h.indexOf("--")===0,_=Nt(h,a[h],v);h==="float"&&(h="cssFloat"),v?o.setProperty(h,_):o[h]=_}}var vr=J({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function zr(o,a){if(a){if(vr[o]&&(a.children!=null||a.dangerouslySetInnerHTML!=null))throw Error(t(137,o));if(a.dangerouslySetInnerHTML!=null){if(a.children!=null)throw Error(t(60));if(typeof a.dangerouslySetInnerHTML!="object"||!("__html"in a.dangerouslySetInnerHTML))throw Error(t(61))}if(a.style!=null&&typeof a.style!="object")throw Error(t(62))}}function Or(o,a){if(o.indexOf("-")===-1)return typeof a.is=="string";switch(o){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var sn=null;function mn(o){return o=o.target||o.srcElement||window,o.correspondingUseElement&&(o=o.correspondingUseElement),o.nodeType===3?o.parentNode:o}var cn=null,_n=null,as=null;function An(o){if(o=Qn(o)){if(typeof cn!="function")throw Error(t(280));var a=o.stateNode;a&&(a=Od(a),cn(o.stateNode,o.type,a))}}function wi(o){_n?as?as.push(o):as=[o]:_n=o}function bi(){if(_n){var o=_n,a=as;if(as=_n=null,An(o),a)for(o=0;o<a.length;o++)An(a[o])}}function Dr(o,a){return o(a)}function pe(){}var Ye=!1;function pt(o,a,h){if(Ye)return o(a,h);Ye=!0;try{return Dr(o,a,h)}finally{Ye=!1,(_n!==null||as!==null)&&(pe(),bi())}}function Be(o,a){var h=o.stateNode;if(h===null)return null;var v=Od(h);if(v===null)return null;h=v[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(v=!v.disabled)||(o=o.type,v=!(o==="button"||o==="input"||o==="select"||o==="textarea")),o=!v;break e;default:o=!1}if(o)return null;if(h&&typeof h!="function")throw Error(t(231,a,typeof h));return h}var qt=!1;if(u)try{var dr={};Object.defineProperty(dr,"passive",{get:function(){qt=!0}}),window.addEventListener("test",dr,dr),window.removeEventListener("test",dr,dr)}catch{qt=!1}function Gt(o,a,h,v,_,k,F,W,Q){var ve=Array.prototype.slice.call(arguments,3);try{a.apply(h,ve)}catch(Pe){this.onError(Pe)}}var ot=!1,yr=null,un=!1,$n=null,ko={onError:function(o){ot=!0,yr=o}};function Ba(o,a,h,v,_,k,F,W,Q){ot=!1,yr=null,Gt.apply(ko,arguments)}function $s(o,a,h,v,_,k,F,W,Q){if(Ba.apply(this,arguments),ot){if(ot){var ve=yr;ot=!1,yr=null}else throw Error(t(198));un||(un=!0,$n=ve)}}function no(o){var a=o,h=o;if(o.alternate)for(;a.return;)a=a.return;else{o=a;do a=o,(a.flags&4098)!==0&&(h=a.return),o=a.return;while(o)}return a.tag===3?h:null}function _i(o){if(o.tag===13){var a=o.memoizedState;if(a===null&&(o=o.alternate,o!==null&&(a=o.memoizedState)),a!==null)return a.dehydrated}return null}function ta(o){if(no(o)!==o)throw Error(t(188))}function Ga(o){var a=o.alternate;if(!a){if(a=no(o),a===null)throw Error(t(188));return a!==o?null:o}for(var h=o,v=a;;){var _=h.return;if(_===null)break;var k=_.alternate;if(k===null){if(v=_.return,v!==null){h=v;continue}break}if(_.child===k.child){for(k=_.child;k;){if(k===h)return ta(_),o;if(k===v)return ta(_),a;k=k.sibling}throw Error(t(188))}if(h.return!==v.return)h=_,v=k;else{for(var F=!1,W=_.child;W;){if(W===h){F=!0,h=_,v=k;break}if(W===v){F=!0,v=_,h=k;break}W=W.sibling}if(!F){for(W=k.child;W;){if(W===h){F=!0,h=k,v=_;break}if(W===v){F=!0,v=k,h=_;break}W=W.sibling}if(!F)throw Error(t(189))}}if(h.alternate!==v)throw Error(t(190))}if(h.tag!==3)throw Error(t(188));return h.stateNode.current===h?o:a}function Wa(o){return o=Ga(o),o!==null?ut(o):null}function ut(o){if(o.tag===5||o.tag===6)return o;for(o=o.child;o!==null;){var a=ut(o);if(a!==null)return a;o=o.sibling}return null}var Z=e.unstable_scheduleCallback,Oe=e.unstable_cancelCallback,tt=e.unstable_shouldYield,br=e.unstable_requestPaint,Mt=e.unstable_now,Hr=e.unstable_getCurrentPriorityLevel,on=e.unstable_ImmediatePriority,ls=e.unstable_UserBlockingPriority,In=e.unstable_NormalPriority,Ei=e.unstable_LowPriority,qr=e.unstable_IdlePriority,No=null,En=null;function ra(o){if(En&&typeof En.onCommitFiberRoot=="function")try{En.onCommitFiberRoot(No,o,void 0,(o.current.flags&128)===128)}catch{}}var Un=Math.clz32?Math.clz32:ud,Qc=Math.log,cd=Math.LN2;function ud(o){return o>>>=0,o===0?32:31-(Qc(o)/cd|0)|0}var na=64,Bl=4194304;function sa(o){switch(o&-o){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return o&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return o}}function Si(o,a){var h=o.pendingLanes;if(h===0)return 0;var v=0,_=o.suspendedLanes,k=o.pingedLanes,F=h&268435455;if(F!==0){var W=F&~_;W!==0?v=sa(W):(k&=F,k!==0&&(v=sa(k)))}else F=h&~_,F!==0?v=sa(F):k!==0&&(v=sa(k));if(v===0)return 0;if(a!==0&&a!==v&&(a&_)===0&&(_=v&-v,k=a&-a,_>=k||_===16&&(k&4194240)!==0))return a;if((v&4)!==0&&(v|=h&16),a=o.entangledLanes,a!==0)for(o=o.entanglements,a&=v;0<a;)h=31-Un(a),_=1<<h,v|=o[h],a&=~_;return v}function dd(o,a){switch(o){case 1:case 2:case 4:return a+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function vh(o,a){for(var h=o.suspendedLanes,v=o.pingedLanes,_=o.expirationTimes,k=o.pendingLanes;0<k;){var F=31-Un(k),W=1<<F,Q=_[F];Q===-1?((W&h)===0||(W&v)!==0)&&(_[F]=dd(W,a)):Q<=a&&(o.expiredLanes|=W),k&=~W}}function Ko(o){return o=o.pendingLanes&-1073741825,o!==0?o:o&1073741824?1073741824:0}function Va(){var o=na;return na<<=1,(na&4194240)===0&&(na=64),o}function qa(o){for(var a=[],h=0;31>h;h++)a.push(o);return a}function oa(o,a,h){o.pendingLanes|=a,a!==536870912&&(o.suspendedLanes=0,o.pingedLanes=0),o=o.eventTimes,a=31-Un(a),o[a]=h}function fd(o,a){var h=o.pendingLanes&~a;o.pendingLanes=a,o.suspendedLanes=0,o.pingedLanes=0,o.expiredLanes&=a,o.mutableReadLanes&=a,o.entangledLanes&=a,a=o.entanglements;var v=o.eventTimes;for(o=o.expirationTimes;0<h;){var _=31-Un(h),k=1<<_;a[_]=0,v[_]=-1,o[_]=-1,h&=~k}}function Ka(o,a){var h=o.entangledLanes|=a;for(o=o.entanglements;h;){var v=31-Un(h),_=1<<v;_&a|o[v]&a&&(o[v]|=a),h&=~_}}var fr=0;function Ci(o){return o&=-o,1<o?4<o?(o&268435455)!==0?16:536870912:4:1}var Zc,Gl,eu,Wl,Ee,Me=!1,Ge=[],bt=null,xt=null,wt=null,We=new Map,it=new Map,gn=[],Yn="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function tu(o,a){switch(o){case"focusin":case"focusout":bt=null;break;case"dragenter":case"dragleave":xt=null;break;case"mouseover":case"mouseout":wt=null;break;case"pointerover":case"pointerout":We.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":it.delete(a.pointerId)}}function Ya(o,a,h,v,_,k){return o===null||o.nativeEvent!==k?(o={blockedOn:a,domEventName:h,eventSystemFlags:v,nativeEvent:k,targetContainers:[_]},a!==null&&(a=Qn(a),a!==null&&Gl(a)),o):(o.eventSystemFlags|=v,a=o.targetContainers,_!==null&&a.indexOf(_)===-1&&a.push(_),o)}function m0(o,a,h,v,_){switch(a){case"focusin":return bt=Ya(bt,o,a,h,v,_),!0;case"dragenter":return xt=Ya(xt,o,a,h,v,_),!0;case"mouseover":return wt=Ya(wt,o,a,h,v,_),!0;case"pointerover":var k=_.pointerId;return We.set(k,Ya(We.get(k)||null,o,a,h,v,_)),!0;case"gotpointercapture":return k=_.pointerId,it.set(k,Ya(it.get(k)||null,o,a,h,v,_)),!0}return!1}function eg(o){var a=Qo(o.target);if(a!==null){var h=no(a);if(h!==null){if(a=h.tag,a===13){if(a=_i(h),a!==null){o.blockedOn=a,Ee(o.priority,function(){eu(h)});return}}else if(a===3&&h.stateNode.current.memoizedState.isDehydrated){o.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}o.blockedOn=null}function hd(o){if(o.blockedOn!==null)return!1;for(var a=o.targetContainers;0<a.length;){var h=gd(o.domEventName,o.eventSystemFlags,a[0],o.nativeEvent);if(h===null){h=o.nativeEvent;var v=new h.constructor(h.type,h);sn=v,h.target.dispatchEvent(v),sn=null}else return a=Qn(h),a!==null&&Gl(a),o.blockedOn=h,!1;a.shift()}return!0}function tg(o,a,h){hd(o)&&h.delete(a)}function g0(){Me=!1,bt!==null&&hd(bt)&&(bt=null),xt!==null&&hd(xt)&&(xt=null),wt!==null&&hd(wt)&&(wt=null),We.forEach(tg),it.forEach(tg)}function Tr(o,a){o.blockedOn===a&&(o.blockedOn=null,Me||(Me=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,g0)))}function _r(o){function a(_){return Tr(_,o)}if(0<Ge.length){Tr(Ge[0],o);for(var h=1;h<Ge.length;h++){var v=Ge[h];v.blockedOn===o&&(v.blockedOn=null)}}for(bt!==null&&Tr(bt,o),xt!==null&&Tr(xt,o),wt!==null&&Tr(wt,o),We.forEach(a),it.forEach(a),h=0;h<gn.length;h++)v=gn[h],v.blockedOn===o&&(v.blockedOn=null);for(;0<gn.length&&(h=gn[0],h.blockedOn===null);)eg(h),h.blockedOn===null&&gn.shift()}var Vl=P.ReactCurrentBatchConfig,pd=!0;function v0(o,a,h,v){var _=fr,k=Vl.transition;Vl.transition=null;try{fr=1,yh(o,a,h,v)}finally{fr=_,Vl.transition=k}}function y0(o,a,h,v){var _=fr,k=Vl.transition;Vl.transition=null;try{fr=4,yh(o,a,h,v)}finally{fr=_,Vl.transition=k}}function yh(o,a,h,v){if(pd){var _=gd(o,a,h,v);if(_===null)Oh(o,a,v,md,h),tu(o,v);else if(m0(_,o,a,h,v))v.stopPropagation();else if(tu(o,v),a&4&&-1<Yn.indexOf(o)){for(;_!==null;){var k=Qn(_);if(k!==null&&Zc(k),k=gd(o,a,h,v),k===null&&Oh(o,a,v,md,h),k===_)break;_=k}_!==null&&v.stopPropagation()}else Oh(o,a,v,null,h)}}var md=null;function gd(o,a,h,v){if(md=null,o=mn(v),o=Qo(o),o!==null)if(a=no(o),a===null)o=null;else if(h=a.tag,h===13){if(o=_i(a),o!==null)return o;o=null}else if(h===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;o=null}else a!==o&&(o=null);return md=o,null}function rg(o){switch(o){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Hr()){case on:return 1;case ls:return 4;case In:case Ei:return 16;case qr:return 536870912;default:return 16}default:return 16}}var Kr=null,ru=null,Yo=null;function xh(){if(Yo)return Yo;var o,a=ru,h=a.length,v,_="value"in Kr?Kr.value:Kr.textContent,k=_.length;for(o=0;o<h&&a[o]===_[o];o++);var F=h-o;for(v=1;v<=F&&a[h-v]===_[k-v];v++);return Yo=_.slice(o,1<v?1-v:void 0)}function ql(o){var a=o.keyCode;return"charCode"in o?(o=o.charCode,o===0&&a===13&&(o=13)):o=a,o===10&&(o=13),32<=o||o===13?o:0}function cs(){return!0}function wh(){return!1}function _s(o){function a(h,v,_,k,F){this._reactName=h,this._targetInst=_,this.type=v,this.nativeEvent=k,this.target=F,this.currentTarget=null;for(var W in o)o.hasOwnProperty(W)&&(h=o[W],this[W]=h?h(k):k[W]);return this.isDefaultPrevented=(k.defaultPrevented!=null?k.defaultPrevented:k.returnValue===!1)?cs:wh,this.isPropagationStopped=wh,this}return J(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=cs)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=cs)},persist:function(){},isPersistent:cs}),a}var Ja={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(o){return o.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},vd=_s(Ja),Kl=J({},Ja,{view:0,detail:0}),ng=_s(Kl),us,bh,Jn,yd=J({},Kl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:kh,button:0,buttons:0,relatedTarget:function(o){return o.relatedTarget===void 0?o.fromElement===o.srcElement?o.toElement:o.fromElement:o.relatedTarget},movementX:function(o){return"movementX"in o?o.movementX:(o!==Jn&&(Jn&&o.type==="mousemove"?(us=o.screenX-Jn.screenX,bh=o.screenY-Jn.screenY):bh=us=0,Jn=o),us)},movementY:function(o){return"movementY"in o?o.movementY:bh}}),_h=_s(yd),ia=J({},yd,{dataTransfer:0}),xd=_s(ia),Eh=J({},Kl,{relatedTarget:0}),Lr=_s(Eh),aa=J({},Ja,{animationName:0,elapsedTime:0,pseudoElement:0}),Sh=_s(aa),x0=J({},Ja,{clipboardData:function(o){return"clipboardData"in o?o.clipboardData:window.clipboardData}}),Ch=_s(x0),w0=J({},Ja,{data:0}),sg=_s(w0),b0={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},og={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},wd={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Yl(o){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(o):(o=wd[o])?!!a[o]:!1}function kh(){return Yl}var ig=J({},Kl,{key:function(o){if(o.key){var a=b0[o.key]||o.key;if(a!=="Unidentified")return a}return o.type==="keypress"?(o=ql(o),o===13?"Enter":String.fromCharCode(o)):o.type==="keydown"||o.type==="keyup"?og[o.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:kh,charCode:function(o){return o.type==="keypress"?ql(o):0},keyCode:function(o){return o.type==="keydown"||o.type==="keyup"?o.keyCode:0},which:function(o){return o.type==="keypress"?ql(o):o.type==="keydown"||o.type==="keyup"?o.keyCode:0}}),ag=_s(ig),Nh=J({},yd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),bd=_s(Nh),lg=J({},Kl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:kh}),_0=_s(lg),Th=J({},Ja,{propertyName:0,elapsedTime:0,pseudoElement:0}),Rh=_s(Th),E0=J({},yd,{deltaX:function(o){return"deltaX"in o?o.deltaX:"wheelDeltaX"in o?-o.wheelDeltaX:0},deltaY:function(o){return"deltaY"in o?o.deltaY:"wheelDeltaY"in o?-o.wheelDeltaY:"wheelDelta"in o?-o.wheelDelta:0},deltaZ:0,deltaMode:0}),cg=_s(E0),Us=[9,13,27,32],nu=u&&"CompositionEvent"in window,ki=null;u&&"documentMode"in document&&(ki=document.documentMode);var ug=u&&"TextEvent"in window&&!ki,Ah=u&&(!nu||ki&&8<ki&&11>=ki),dg=" ",fg=!1;function hg(o,a){switch(o){case"keyup":return Us.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function pg(o){return o=o.detail,typeof o=="object"&&"data"in o?o.data:null}var Jl=!1;function Xl(o,a){switch(o){case"compositionend":return pg(a);case"keypress":return a.which!==32?null:(fg=!0,dg);case"textInput":return o=a.data,o===dg&&fg?null:o;default:return null}}function S0(o,a){if(Jl)return o==="compositionend"||!nu&&hg(o,a)?(o=xh(),Yo=ru=Kr=null,Jl=!1,o):null;switch(o){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return Ah&&a.locale!=="ko"?null:a.data;default:return null}}var C0={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function _d(o){var a=o&&o.nodeName&&o.nodeName.toLowerCase();return a==="input"?!!C0[o.type]:a==="textarea"}function Ih(o,a,h,v){wi(v),a=Id(a,"onChange"),0<a.length&&(h=new vd("onChange","change",null,h,v),o.push({event:h,listeners:a}))}var so=null,la=null;function k0(o){bg(o,0)}function Ed(o){var a=Wt(o);if(Ue(a))return o}function N0(o,a){if(o==="change")return a}var Xa=!1;if(u){var zs;if(u){var Sd="oninput"in document;if(!Sd){var mg=document.createElement("div");mg.setAttribute("oninput","return;"),Sd=typeof mg.oninput=="function"}zs=Sd}else zs=!1;Xa=zs&&(!document.documentMode||9<document.documentMode)}function gg(){so&&(so.detachEvent("onpropertychange",vg),la=so=null)}function vg(o){if(o.propertyName==="value"&&Ed(la)){var a=[];Ih(a,la,o,mn(o)),pt(k0,a)}}function T0(o,a,h){o==="focusin"?(gg(),so=a,la=h,so.attachEvent("onpropertychange",vg)):o==="focusout"&&gg()}function R0(o){if(o==="selectionchange"||o==="keyup"||o==="keydown")return Ed(la)}function Ql(o,a){if(o==="click")return Ed(a)}function oe(o,a){if(o==="input"||o==="change")return Ed(a)}function Se(o,a){return o===a&&(o!==0||1/o===1/a)||o!==o&&a!==a}var ge=typeof Object.is=="function"?Object.is:Se;function Je(o,a){if(ge(o,a))return!0;if(typeof o!="object"||o===null||typeof a!="object"||a===null)return!1;var h=Object.keys(o),v=Object.keys(a);if(h.length!==v.length)return!1;for(v=0;v<h.length;v++){var _=h[v];if(!p.call(a,_)||!ge(o[_],a[_]))return!1}return!0}function $t(o){for(;o&&o.firstChild;)o=o.firstChild;return o}function xr(o,a){var h=$t(o);o=0;for(var v;h;){if(h.nodeType===3){if(v=o+h.textContent.length,o<=a&&v>=a)return{node:h,offset:a-o};o=v}e:{for(;h;){if(h.nextSibling){h=h.nextSibling;break e}h=h.parentNode}h=void 0}h=$t(h)}}function vn(o,a){return o&&a?o===a?!0:o&&o.nodeType===3?!1:a&&a.nodeType===3?vn(o,a.parentNode):"contains"in o?o.contains(a):o.compareDocumentPosition?!!(o.compareDocumentPosition(a)&16):!1:!1}function Ar(){for(var o=window,a=Le();a instanceof o.HTMLIFrameElement;){try{var h=typeof a.contentWindow.location.href=="string"}catch{h=!1}if(h)o=a.contentWindow;else break;a=Le(o.document)}return a}function su(o){var a=o&&o.nodeName&&o.nodeName.toLowerCase();return a&&(a==="input"&&(o.type==="text"||o.type==="search"||o.type==="tel"||o.type==="url"||o.type==="password")||a==="textarea"||o.contentEditable==="true")}function A0(o){var a=Ar(),h=o.focusedElem,v=o.selectionRange;if(a!==h&&h&&h.ownerDocument&&vn(h.ownerDocument.documentElement,h)){if(v!==null&&su(h)){if(a=v.start,o=v.end,o===void 0&&(o=a),"selectionStart"in h)h.selectionStart=a,h.selectionEnd=Math.min(o,h.value.length);else if(o=(a=h.ownerDocument||document)&&a.defaultView||window,o.getSelection){o=o.getSelection();var _=h.textContent.length,k=Math.min(v.start,_);v=v.end===void 0?k:Math.min(v.end,_),!o.extend&&k>v&&(_=v,v=k,k=_),_=xr(h,k);var F=xr(h,v);_&&F&&(o.rangeCount!==1||o.anchorNode!==_.node||o.anchorOffset!==_.offset||o.focusNode!==F.node||o.focusOffset!==F.offset)&&(a=a.createRange(),a.setStart(_.node,_.offset),o.removeAllRanges(),k>v?(o.addRange(a),o.extend(F.node,F.offset)):(a.setEnd(F.node,F.offset),o.addRange(a)))}}for(a=[],o=h;o=o.parentNode;)o.nodeType===1&&a.push({element:o,left:o.scrollLeft,top:o.scrollTop});for(typeof h.focus=="function"&&h.focus(),h=0;h<a.length;h++)o=a[h],o.element.scrollLeft=o.left,o.element.scrollTop=o.top}}var oo=u&&"documentMode"in document&&11>=document.documentMode,Ni=null,Ph=null,Jo=null,Zl=!1;function ou(o,a,h){var v=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;Zl||Ni==null||Ni!==Le(v)||(v=Ni,"selectionStart"in v&&su(v)?v={start:v.selectionStart,end:v.selectionEnd}:(v=(v.ownerDocument&&v.ownerDocument.defaultView||window).getSelection(),v={anchorNode:v.anchorNode,anchorOffset:v.anchorOffset,focusNode:v.focusNode,focusOffset:v.focusOffset}),Jo&&Je(Jo,v)||(Jo=v,v=Id(Ph,"onSelect"),0<v.length&&(a=new vd("onSelect","select",null,a,h),o.push({event:a,listeners:v}),a.target=Ni)))}function hr(o,a){var h={};return h[o.toLowerCase()]=a.toLowerCase(),h["Webkit"+o]="webkit"+a,h["Moz"+o]="moz"+a,h}var ec={animationend:hr("Animation","AnimationEnd"),animationiteration:hr("Animation","AnimationIteration"),animationstart:hr("Animation","AnimationStart"),transitionend:hr("Transition","TransitionEnd")},Cd={},iu={};u&&(iu=document.createElement("div").style,"AnimationEvent"in window||(delete ec.animationend.animation,delete ec.animationiteration.animation,delete ec.animationstart.animation),"TransitionEvent"in window||delete ec.transitionend.transition);function kd(o){if(Cd[o])return Cd[o];if(!ec[o])return o;var a=ec[o],h;for(h in a)if(a.hasOwnProperty(h)&&h in iu)return Cd[o]=a[h];return o}var yg=kd("animationend"),xg=kd("animationiteration"),au=kd("animationstart"),Ti=kd("transitionend"),lu=new Map,Fh="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function To(o,a){lu.set(o,a),i(a,[o])}for(var Nd=0;Nd<Fh.length;Nd++){var Td=Fh[Nd],Rd=Td.toLowerCase(),wg=Td[0].toUpperCase()+Td.slice(1);To(Rd,"on"+wg)}To(yg,"onAnimationEnd"),To(xg,"onAnimationIteration"),To(au,"onAnimationStart"),To("dblclick","onDoubleClick"),To("focusin","onFocus"),To("focusout","onBlur"),To(Ti,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),i("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),i("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),i("onBeforeInput",["compositionend","keypress","textInput","paste"]),i("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ri="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Qa=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ri));function cu(o,a,h){var v=o.type||"unknown-event";o.currentTarget=h,$s(v,a,void 0,o),o.currentTarget=null}function bg(o,a){a=(a&4)!==0;for(var h=0;h<o.length;h++){var v=o[h],_=v.event;v=v.listeners;e:{var k=void 0;if(a)for(var F=v.length-1;0<=F;F--){var W=v[F],Q=W.instance,ve=W.currentTarget;if(W=W.listener,Q!==k&&_.isPropagationStopped())break e;cu(_,W,ve),k=Q}else for(F=0;F<v.length;F++){if(W=v[F],Q=W.instance,ve=W.currentTarget,W=W.listener,Q!==k&&_.isPropagationStopped())break e;cu(_,W,ve),k=Q}}}if(un)throw o=$n,un=!1,$n=null,o}function Br(o,a){var h=a[jd];h===void 0&&(h=a[jd]=new Set);var v=o+"__bubble";h.has(v)||(Ad(a,o,2,!1),h.add(v))}function jh(o,a,h){var v=0;a&&(v|=4),Ad(h,o,v,a)}var Za="_reactListening"+Math.random().toString(36).slice(2);function ca(o){if(!o[Za]){o[Za]=!0,n.forEach(function(h){h!=="selectionchange"&&(Qa.has(h)||jh(h,!1,o),jh(h,!0,o))});var a=o.nodeType===9?o:o.ownerDocument;a===null||a[Za]||(a[Za]=!0,jh("selectionchange",!1,a))}}function Ad(o,a,h,v){switch(rg(a)){case 1:var _=v0;break;case 4:_=y0;break;default:_=yh}h=_.bind(null,a,h,o),_=void 0,!qt||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(_=!0),v?_!==void 0?o.addEventListener(a,h,{capture:!0,passive:_}):o.addEventListener(a,h,!0):_!==void 0?o.addEventListener(a,h,{passive:_}):o.addEventListener(a,h,!1)}function Oh(o,a,h,v,_){var k=v;if((a&1)===0&&(a&2)===0&&v!==null)e:for(;;){if(v===null)return;var F=v.tag;if(F===3||F===4){var W=v.stateNode.containerInfo;if(W===_||W.nodeType===8&&W.parentNode===_)break;if(F===4)for(F=v.return;F!==null;){var Q=F.tag;if((Q===3||Q===4)&&(Q=F.stateNode.containerInfo,Q===_||Q.nodeType===8&&Q.parentNode===_))return;F=F.return}for(;W!==null;){if(F=Qo(W),F===null)return;if(Q=F.tag,Q===5||Q===6){v=k=F;continue e}W=W.parentNode}}v=v.return}pt(function(){var ve=k,Pe=mn(h),je=[];e:{var Ie=lu.get(o);if(Ie!==void 0){var Xe=vd,at=o;switch(o){case"keypress":if(ql(h)===0)break e;case"keydown":case"keyup":Xe=ag;break;case"focusin":at="focus",Xe=Lr;break;case"focusout":at="blur",Xe=Lr;break;case"beforeblur":case"afterblur":Xe=Lr;break;case"click":if(h.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Xe=_h;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Xe=xd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Xe=_0;break;case yg:case xg:case au:Xe=Sh;break;case Ti:Xe=Rh;break;case"scroll":Xe=ng;break;case"wheel":Xe=cg;break;case"copy":case"cut":case"paste":Xe=Ch;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Xe=bd}var ct=(a&4)!==0,fn=!ct&&o==="scroll",fe=ct?Ie!==null?Ie+"Capture":null:Ie;ct=[];for(var re=ve,he;re!==null;){he=re;var De=he.stateNode;if(he.tag===5&&De!==null&&(he=De,fe!==null&&(De=Be(re,fe),De!=null&&ct.push(tc(re,De,he)))),fn)break;re=re.return}0<ct.length&&(Ie=new Xe(Ie,at,null,h,Pe),je.push({event:Ie,listeners:ct}))}}if((a&7)===0){e:{if(Ie=o==="mouseover"||o==="pointerover",Xe=o==="mouseout"||o==="pointerout",Ie&&h!==sn&&(at=h.relatedTarget||h.fromElement)&&(Qo(at)||at[Hs]))break e;if((Xe||Ie)&&(Ie=Pe.window===Pe?Pe:(Ie=Pe.ownerDocument)?Ie.defaultView||Ie.parentWindow:window,Xe?(at=h.relatedTarget||h.toElement,Xe=ve,at=at?Qo(at):null,at!==null&&(fn=no(at),at!==fn||at.tag!==5&&at.tag!==6)&&(at=null)):(Xe=null,at=ve),Xe!==at)){if(ct=_h,De="onMouseLeave",fe="onMouseEnter",re="mouse",(o==="pointerout"||o==="pointerover")&&(ct=bd,De="onPointerLeave",fe="onPointerEnter",re="pointer"),fn=Xe==null?Ie:Wt(Xe),he=at==null?Ie:Wt(at),Ie=new ct(De,re+"leave",Xe,h,Pe),Ie.target=fn,Ie.relatedTarget=he,De=null,Qo(Pe)===ve&&(ct=new ct(fe,re+"enter",at,h,Pe),ct.target=he,ct.relatedTarget=fn,De=ct),fn=De,Xe&&at)t:{for(ct=Xe,fe=at,re=0,he=ct;he;he=rc(he))re++;for(he=0,De=fe;De;De=rc(De))he++;for(;0<re-he;)ct=rc(ct),re--;for(;0<he-re;)fe=rc(fe),he--;for(;re--;){if(ct===fe||fe!==null&&ct===fe.alternate)break t;ct=rc(ct),fe=rc(fe)}ct=null}else ct=null;Xe!==null&&yn(je,Ie,Xe,ct,!1),at!==null&&fn!==null&&yn(je,fn,at,ct,!0)}}e:{if(Ie=ve?Wt(ve):window,Xe=Ie.nodeName&&Ie.nodeName.toLowerCase(),Xe==="select"||Xe==="input"&&Ie.type==="file")var ft=N0;else if(_d(Ie))if(Xa)ft=oe;else{ft=R0;var Tt=T0}else(Xe=Ie.nodeName)&&Xe.toLowerCase()==="input"&&(Ie.type==="checkbox"||Ie.type==="radio")&&(ft=Ql);if(ft&&(ft=ft(o,ve))){Ih(je,ft,h,Pe);break e}Tt&&Tt(o,Ie,ve),o==="focusout"&&(Tt=Ie._wrapperState)&&Tt.controlled&&Ie.type==="number"&&Bt(Ie,"number",Ie.value)}switch(Tt=ve?Wt(ve):window,o){case"focusin":(_d(Tt)||Tt.contentEditable==="true")&&(Ni=Tt,Ph=ve,Jo=null);break;case"focusout":Jo=Ph=Ni=null;break;case"mousedown":Zl=!0;break;case"contextmenu":case"mouseup":case"dragend":Zl=!1,ou(je,h,Pe);break;case"selectionchange":if(oo)break;case"keydown":case"keyup":ou(je,h,Pe)}var _t;if(nu)e:{switch(o){case"compositionstart":var jt="onCompositionStart";break e;case"compositionend":jt="onCompositionEnd";break e;case"compositionupdate":jt="onCompositionUpdate";break e}jt=void 0}else Jl?hg(o,h)&&(jt="onCompositionEnd"):o==="keydown"&&h.keyCode===229&&(jt="onCompositionStart");jt&&(Ah&&h.locale!=="ko"&&(Jl||jt!=="onCompositionStart"?jt==="onCompositionEnd"&&Jl&&(_t=xh()):(Kr=Pe,ru="value"in Kr?Kr.value:Kr.textContent,Jl=!0)),Tt=Id(ve,jt),0<Tt.length&&(jt=new sg(jt,o,null,h,Pe),je.push({event:jt,listeners:Tt}),_t?jt.data=_t:(_t=pg(h),_t!==null&&(jt.data=_t)))),(_t=ug?Xl(o,h):S0(o,h))&&(ve=Id(ve,"onBeforeInput"),0<ve.length&&(Pe=new sg("onBeforeInput","beforeinput",null,h,Pe),je.push({event:Pe,listeners:ve}),Pe.data=_t))}bg(je,a)})}function tc(o,a,h){return{instance:o,listener:a,currentTarget:h}}function Id(o,a){for(var h=a+"Capture",v=[];o!==null;){var _=o,k=_.stateNode;_.tag===5&&k!==null&&(_=k,k=Be(o,h),k!=null&&v.unshift(tc(o,k,_)),k=Be(o,a),k!=null&&v.push(tc(o,k,_))),o=o.return}return v}function rc(o){if(o===null)return null;do o=o.return;while(o&&o.tag!==5);return o||null}function yn(o,a,h,v,_){for(var k=a._reactName,F=[];h!==null&&h!==v;){var W=h,Q=W.alternate,ve=W.stateNode;if(Q!==null&&Q===v)break;W.tag===5&&ve!==null&&(W=ve,_?(Q=Be(h,k),Q!=null&&F.unshift(tc(h,Q,W))):_||(Q=Be(h,k),Q!=null&&F.push(tc(h,Q,W)))),h=h.return}F.length!==0&&o.push({event:a,listeners:F})}var Xn=/\r\n?/g,I0=/\u0000|\uFFFD/g;function _g(o){return(typeof o=="string"?o:""+o).replace(Xn,`
`).replace(I0,"")}function uu(o,a,h){if(a=_g(a),_g(o)!==a&&h)throw Error(t(425))}function Pd(){}var du=null,el=null;function fu(o,a){return o==="textarea"||o==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var ua=typeof setTimeout=="function"?setTimeout:void 0,hu=typeof clearTimeout=="function"?clearTimeout:void 0,nc=typeof Promise=="function"?Promise:void 0,Fd=typeof queueMicrotask=="function"?queueMicrotask:typeof nc<"u"?function(o){return nc.resolve(null).then(o).catch(sc)}:ua;function sc(o){setTimeout(function(){throw o})}function Dh(o,a){var h=a,v=0;do{var _=h.nextSibling;if(o.removeChild(h),_&&_.nodeType===8)if(h=_.data,h==="/$"){if(v===0){o.removeChild(_),_r(a);return}v--}else h!=="$"&&h!=="$?"&&h!=="$!"||v++;h=_}while(h);_r(a)}function da(o){for(;o!=null;o=o.nextSibling){var a=o.nodeType;if(a===1||a===3)break;if(a===8){if(a=o.data,a==="$"||a==="$!"||a==="$?")break;if(a==="/$")return null}}return o}function Eg(o){o=o.previousSibling;for(var a=0;o;){if(o.nodeType===8){var h=o.data;if(h==="$"||h==="$!"||h==="$?"){if(a===0)return o;a--}else h==="/$"&&a++}o=o.previousSibling}return null}var oc=Math.random().toString(36).slice(2),Xo="__reactFiber$"+oc,fa="__reactProps$"+oc,Hs="__reactContainer$"+oc,jd="__reactEvents$"+oc,O="__reactListeners$"+oc,ic="__reactHandles$"+oc;function Qo(o){var a=o[Xo];if(a)return a;for(var h=o.parentNode;h;){if(a=h[Hs]||h[Xo]){if(h=a.alternate,a.child!==null||h!==null&&h.child!==null)for(o=Eg(o);o!==null;){if(h=o[Xo])return h;o=Eg(o)}return a}o=h,h=o.parentNode}return null}function Qn(o){return o=o[Xo]||o[Hs],!o||o.tag!==5&&o.tag!==6&&o.tag!==13&&o.tag!==3?null:o}function Wt(o){if(o.tag===5||o.tag===6)return o.stateNode;throw Error(t(33))}function Od(o){return o[fa]||null}var Lh=[],ac=-1;function Es(o){return{current:o}}function Gr(o){0>ac||(o.current=Lh[ac],Lh[ac]=null,ac--)}function Mr(o,a){ac++,Lh[ac]=o.current,o.current=a}var ha={},Zn=Es(ha),Ss=Es(!1),ds=ha;function lc(o,a){var h=o.type.contextTypes;if(!h)return ha;var v=o.stateNode;if(v&&v.__reactInternalMemoizedUnmaskedChildContext===a)return v.__reactInternalMemoizedMaskedChildContext;var _={},k;for(k in h)_[k]=a[k];return v&&(o=o.stateNode,o.__reactInternalMemoizedUnmaskedChildContext=a,o.__reactInternalMemoizedMaskedChildContext=_),_}function Cs(o){return o=o.childContextTypes,o!=null}function Dd(){Gr(Ss),Gr(Zn)}function Sg(o,a,h){if(Zn.current!==ha)throw Error(t(168));Mr(Zn,a),Mr(Ss,h)}function Cg(o,a,h){var v=o.stateNode;if(a=a.childContextTypes,typeof v.getChildContext!="function")return h;v=v.getChildContext();for(var _ in v)if(!(_ in a))throw Error(t(108,xe(o)||"Unknown",_));return J({},h,v)}function io(o){return o=(o=o.stateNode)&&o.__reactInternalMemoizedMergedChildContext||ha,ds=Zn.current,Mr(Zn,o),Mr(Ss,Ss.current),!0}function kg(o,a,h){var v=o.stateNode;if(!v)throw Error(t(169));h?(o=Cg(o,a,ds),v.__reactInternalMemoizedMergedChildContext=o,Gr(Ss),Gr(Zn),Mr(Zn,o)):Gr(Ss),Mr(Ss,h)}var Ai=null,Ld=!1,Mh=!1;function Ng(o){Ai===null?Ai=[o]:Ai.push(o)}function tl(o){Ld=!0,Ng(o)}function pa(){if(!Mh&&Ai!==null){Mh=!0;var o=0,a=fr;try{var h=Ai;for(fr=1;o<h.length;o++){var v=h[o];do v=v(!0);while(v!==null)}Ai=null,Ld=!1}catch(_){throw Ai!==null&&(Ai=Ai.slice(o+1)),Z(on,pa),_}finally{fr=a,Mh=!1}}return null}var cc=[],es=0,Md=null,$d=0,ao=[],lo=0,rl=null,Zo=1,ei="";function nl(o,a){cc[es++]=$d,cc[es++]=Md,Md=o,$d=a}function Tg(o,a,h){ao[lo++]=Zo,ao[lo++]=ei,ao[lo++]=rl,rl=o;var v=Zo;o=ei;var _=32-Un(v)-1;v&=~(1<<_),h+=1;var k=32-Un(a)+_;if(30<k){var F=_-_%5;k=(v&(1<<F)-1).toString(32),v>>=F,_-=F,Zo=1<<32-Un(a)+_|h<<_|v,ei=k+o}else Zo=1<<k|h<<_|v,ei=o}function pu(o){o.return!==null&&(nl(o,1),Tg(o,1,0))}function sl(o){for(;o===Md;)Md=cc[--es],cc[es]=null,$d=cc[--es],cc[es]=null;for(;o===rl;)rl=ao[--lo],ao[lo]=null,ei=ao[--lo],ao[lo]=null,Zo=ao[--lo],ao[lo]=null}var ts=null,Bs=null,Wr=!1,Ro=null;function ti(o,a){var h=go(5,null,null,0);h.elementType="DELETED",h.stateNode=a,h.return=o,a=o.deletions,a===null?(o.deletions=[h],o.flags|=16):a.push(h)}function Ud(o,a){switch(o.tag){case 5:var h=o.type;return a=a.nodeType!==1||h.toLowerCase()!==a.nodeName.toLowerCase()?null:a,a!==null?(o.stateNode=a,ts=o,Bs=da(a.firstChild),!0):!1;case 6:return a=o.pendingProps===""||a.nodeType!==3?null:a,a!==null?(o.stateNode=a,ts=o,Bs=null,!0):!1;case 13:return a=a.nodeType!==8?null:a,a!==null?(h=rl!==null?{id:Zo,overflow:ei}:null,o.memoizedState={dehydrated:a,treeContext:h,retryLane:1073741824},h=go(18,null,null,0),h.stateNode=a,h.return=o,o.child=h,ts=o,Bs=null,!0):!1;default:return!1}}function Ii(o){return(o.mode&1)!==0&&(o.flags&128)===0}function ks(o){if(Wr){var a=Bs;if(a){var h=a;if(!Ud(o,a)){if(Ii(o))throw Error(t(418));a=da(h.nextSibling);var v=ts;a&&Ud(o,a)?ti(v,h):(o.flags=o.flags&-4097|2,Wr=!1,ts=o)}}else{if(Ii(o))throw Error(t(418));o.flags=o.flags&-4097|2,Wr=!1,ts=o}}}function Rg(o){for(o=o.return;o!==null&&o.tag!==5&&o.tag!==3&&o.tag!==13;)o=o.return;ts=o}function mu(o){if(o!==ts)return!1;if(!Wr)return Rg(o),Wr=!0,!1;var a;if((a=o.tag!==3)&&!(a=o.tag!==5)&&(a=o.type,a=a!=="head"&&a!=="body"&&!fu(o.type,o.memoizedProps)),a&&(a=Bs)){if(Ii(o))throw $h(),Error(t(418));for(;a;)ti(o,a),a=da(a.nextSibling)}if(Rg(o),o.tag===13){if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(t(317));e:{for(o=o.nextSibling,a=0;o;){if(o.nodeType===8){var h=o.data;if(h==="/$"){if(a===0){Bs=da(o.nextSibling);break e}a--}else h!=="$"&&h!=="$!"&&h!=="$?"||a++}o=o.nextSibling}Bs=null}}else Bs=ts?da(o.stateNode.nextSibling):null;return!0}function $h(){for(var o=Bs;o;)o=da(o.nextSibling)}function ri(){Bs=ts=null,Wr=!1}function ni(o){Ro===null?Ro=[o]:Ro.push(o)}var Ag=P.ReactCurrentBatchConfig;function gu(o,a,h){if(o=h.ref,o!==null&&typeof o!="function"&&typeof o!="object"){if(h._owner){if(h=h._owner,h){if(h.tag!==1)throw Error(t(309));var v=h.stateNode}if(!v)throw Error(t(147,o));var _=v,k=""+o;return a!==null&&a.ref!==null&&typeof a.ref=="function"&&a.ref._stringRef===k?a.ref:(a=function(F){var W=_.refs;F===null?delete W[k]:W[k]=F},a._stringRef=k,a)}if(typeof o!="string")throw Error(t(284));if(!h._owner)throw Error(t(290,o))}return o}function ol(o,a){throw o=Object.prototype.toString.call(a),Error(t(31,o==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":o))}function Ig(o){var a=o._init;return a(o._payload)}function Uh(o){function a(fe,re){if(o){var he=fe.deletions;he===null?(fe.deletions=[re],fe.flags|=16):he.push(re)}}function h(fe,re){if(!o)return null;for(;re!==null;)a(fe,re),re=re.sibling;return null}function v(fe,re){for(fe=new Map;re!==null;)re.key!==null?fe.set(re.key,re):fe.set(re.index,re),re=re.sibling;return fe}function _(fe,re){return fe=Do(fe,re),fe.index=0,fe.sibling=null,fe}function k(fe,re,he){return fe.index=he,o?(he=fe.alternate,he!==null?(he=he.index,he<re?(fe.flags|=2,re):he):(fe.flags|=2,re)):(fe.flags|=1048576,re)}function F(fe){return o&&fe.alternate===null&&(fe.flags|=2),fe}function W(fe,re,he,De){return re===null||re.tag!==6?(re=kp(he,fe.mode,De),re.return=fe,re):(re=_(re,he),re.return=fe,re)}function Q(fe,re,he,De){var ft=he.type;return ft===U?Pe(fe,re,he.props.children,De,he.key):re!==null&&(re.elementType===ft||typeof ft=="object"&&ft!==null&&ft.$$typeof===me&&Ig(ft)===re.type)?(De=_(re,he.props),De.ref=gu(fe,re,he),De.return=fe,De):(De=_f(he.type,he.key,he.props,null,fe.mode,De),De.ref=gu(fe,re,he),De.return=fe,De)}function ve(fe,re,he,De){return re===null||re.tag!==4||re.stateNode.containerInfo!==he.containerInfo||re.stateNode.implementation!==he.implementation?(re=Np(he,fe.mode,De),re.return=fe,re):(re=_(re,he.children||[]),re.return=fe,re)}function Pe(fe,re,he,De,ft){return re===null||re.tag!==7?(re=gl(he,fe.mode,De,ft),re.return=fe,re):(re=_(re,he),re.return=fe,re)}function je(fe,re,he){if(typeof re=="string"&&re!==""||typeof re=="number")return re=kp(""+re,fe.mode,he),re.return=fe,re;if(typeof re=="object"&&re!==null){switch(re.$$typeof){case M:return he=_f(re.type,re.key,re.props,null,fe.mode,he),he.ref=gu(fe,null,re),he.return=fe,he;case B:return re=Np(re,fe.mode,he),re.return=fe,re;case me:var De=re._init;return je(fe,De(re._payload),he)}if(or(re)||z(re))return re=gl(re,fe.mode,he,null),re.return=fe,re;ol(fe,re)}return null}function Ie(fe,re,he,De){var ft=re!==null?re.key:null;if(typeof he=="string"&&he!==""||typeof he=="number")return ft!==null?null:W(fe,re,""+he,De);if(typeof he=="object"&&he!==null){switch(he.$$typeof){case M:return he.key===ft?Q(fe,re,he,De):null;case B:return he.key===ft?ve(fe,re,he,De):null;case me:return ft=he._init,Ie(fe,re,ft(he._payload),De)}if(or(he)||z(he))return ft!==null?null:Pe(fe,re,he,De,null);ol(fe,he)}return null}function Xe(fe,re,he,De,ft){if(typeof De=="string"&&De!==""||typeof De=="number")return fe=fe.get(he)||null,W(re,fe,""+De,ft);if(typeof De=="object"&&De!==null){switch(De.$$typeof){case M:return fe=fe.get(De.key===null?he:De.key)||null,Q(re,fe,De,ft);case B:return fe=fe.get(De.key===null?he:De.key)||null,ve(re,fe,De,ft);case me:var Tt=De._init;return Xe(fe,re,he,Tt(De._payload),ft)}if(or(De)||z(De))return fe=fe.get(he)||null,Pe(re,fe,De,ft,null);ol(re,De)}return null}function at(fe,re,he,De){for(var ft=null,Tt=null,_t=re,jt=re=0,jn=null;_t!==null&&jt<he.length;jt++){_t.index>jt?(jn=_t,_t=null):jn=_t.sibling;var wr=Ie(fe,_t,he[jt],De);if(wr===null){_t===null&&(_t=jn);break}o&&_t&&wr.alternate===null&&a(fe,_t),re=k(wr,re,jt),Tt===null?ft=wr:Tt.sibling=wr,Tt=wr,_t=jn}if(jt===he.length)return h(fe,_t),Wr&&nl(fe,jt),ft;if(_t===null){for(;jt<he.length;jt++)_t=je(fe,he[jt],De),_t!==null&&(re=k(_t,re,jt),Tt===null?ft=_t:Tt.sibling=_t,Tt=_t);return Wr&&nl(fe,jt),ft}for(_t=v(fe,_t);jt<he.length;jt++)jn=Xe(_t,fe,jt,he[jt],De),jn!==null&&(o&&jn.alternate!==null&&_t.delete(jn.key===null?jt:jn.key),re=k(jn,re,jt),Tt===null?ft=jn:Tt.sibling=jn,Tt=jn);return o&&_t.forEach(function(ka){return a(fe,ka)}),Wr&&nl(fe,jt),ft}function ct(fe,re,he,De){var ft=z(he);if(typeof ft!="function")throw Error(t(150));if(he=ft.call(he),he==null)throw Error(t(151));for(var Tt=ft=null,_t=re,jt=re=0,jn=null,wr=he.next();_t!==null&&!wr.done;jt++,wr=he.next()){_t.index>jt?(jn=_t,_t=null):jn=_t.sibling;var ka=Ie(fe,_t,wr.value,De);if(ka===null){_t===null&&(_t=jn);break}o&&_t&&ka.alternate===null&&a(fe,_t),re=k(ka,re,jt),Tt===null?ft=ka:Tt.sibling=ka,Tt=ka,_t=jn}if(wr.done)return h(fe,_t),Wr&&nl(fe,jt),ft;if(_t===null){for(;!wr.done;jt++,wr=he.next())wr=je(fe,wr.value,De),wr!==null&&(re=k(wr,re,jt),Tt===null?ft=wr:Tt.sibling=wr,Tt=wr);return Wr&&nl(fe,jt),ft}for(_t=v(fe,_t);!wr.done;jt++,wr=he.next())wr=Xe(_t,fe,jt,wr.value,De),wr!==null&&(o&&wr.alternate!==null&&_t.delete(wr.key===null?jt:wr.key),re=k(wr,re,jt),Tt===null?ft=wr:Tt.sibling=wr,Tt=wr);return o&&_t.forEach(function(Q0){return a(fe,Q0)}),Wr&&nl(fe,jt),ft}function fn(fe,re,he,De){if(typeof he=="object"&&he!==null&&he.type===U&&he.key===null&&(he=he.props.children),typeof he=="object"&&he!==null){switch(he.$$typeof){case M:e:{for(var ft=he.key,Tt=re;Tt!==null;){if(Tt.key===ft){if(ft=he.type,ft===U){if(Tt.tag===7){h(fe,Tt.sibling),re=_(Tt,he.props.children),re.return=fe,fe=re;break e}}else if(Tt.elementType===ft||typeof ft=="object"&&ft!==null&&ft.$$typeof===me&&Ig(ft)===Tt.type){h(fe,Tt.sibling),re=_(Tt,he.props),re.ref=gu(fe,Tt,he),re.return=fe,fe=re;break e}h(fe,Tt);break}else a(fe,Tt);Tt=Tt.sibling}he.type===U?(re=gl(he.props.children,fe.mode,De,he.key),re.return=fe,fe=re):(De=_f(he.type,he.key,he.props,null,fe.mode,De),De.ref=gu(fe,re,he),De.return=fe,fe=De)}return F(fe);case B:e:{for(Tt=he.key;re!==null;){if(re.key===Tt)if(re.tag===4&&re.stateNode.containerInfo===he.containerInfo&&re.stateNode.implementation===he.implementation){h(fe,re.sibling),re=_(re,he.children||[]),re.return=fe,fe=re;break e}else{h(fe,re);break}else a(fe,re);re=re.sibling}re=Np(he,fe.mode,De),re.return=fe,fe=re}return F(fe);case me:return Tt=he._init,fn(fe,re,Tt(he._payload),De)}if(or(he))return at(fe,re,he,De);if(z(he))return ct(fe,re,he,De);ol(fe,he)}return typeof he=="string"&&he!==""||typeof he=="number"?(he=""+he,re!==null&&re.tag===6?(h(fe,re.sibling),re=_(re,he),re.return=fe,fe=re):(h(fe,re),re=kp(he,fe.mode,De),re.return=fe,fe=re),F(fe)):h(fe,re)}return fn}var an=Uh(!0),zd=Uh(!1),vu=Es(null),Gs=null,ma=null,uc=null;function Pi(){uc=ma=Gs=null}function Hd(o){var a=vu.current;Gr(vu),o._currentValue=a}function zn(o,a,h){for(;o!==null;){var v=o.alternate;if((o.childLanes&a)!==a?(o.childLanes|=a,v!==null&&(v.childLanes|=a)):v!==null&&(v.childLanes&a)!==a&&(v.childLanes|=a),o===h)break;o=o.return}}function ga(o,a){Gs=o,uc=ma=null,o=o.dependencies,o!==null&&o.firstContext!==null&&((o.lanes&a)!==0&&(hs=!0),o.firstContext=null)}function co(o){var a=o._currentValue;if(uc!==o)if(o={context:o,memoizedValue:a,next:null},ma===null){if(Gs===null)throw Error(t(308));ma=o,Gs.dependencies={lanes:0,firstContext:o}}else ma=ma.next=o;return a}var il=null;function zh(o){il===null?il=[o]:il.push(o)}function Bd(o,a,h,v){var _=a.interleaved;return _===null?(h.next=h,zh(a)):(h.next=_.next,_.next=h),a.interleaved=h,Fi(o,v)}function Fi(o,a){o.lanes|=a;var h=o.alternate;for(h!==null&&(h.lanes|=a),h=o,o=o.return;o!==null;)o.childLanes|=a,h=o.alternate,h!==null&&(h.childLanes|=a),h=o,o=o.return;return h.tag===3?h.stateNode:null}var uo=!1;function Gd(o){o.updateQueue={baseState:o.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Pg(o,a){o=o.updateQueue,a.updateQueue===o&&(a.updateQueue={baseState:o.baseState,firstBaseUpdate:o.firstBaseUpdate,lastBaseUpdate:o.lastBaseUpdate,shared:o.shared,effects:o.effects})}function ji(o,a){return{eventTime:o,lane:a,tag:0,payload:null,callback:null,next:null}}function fo(o,a,h){var v=o.updateQueue;if(v===null)return null;if(v=v.shared,(pr&2)!==0){var _=v.pending;return _===null?a.next=a:(a.next=_.next,_.next=a),v.pending=a,Fi(o,h)}return _=v.interleaved,_===null?(a.next=a,zh(v)):(a.next=_.next,_.next=a),v.interleaved=a,Fi(o,h)}function Wd(o,a,h){if(a=a.updateQueue,a!==null&&(a=a.shared,(h&4194240)!==0)){var v=a.lanes;v&=o.pendingLanes,h|=v,a.lanes=h,Ka(o,h)}}function Fg(o,a){var h=o.updateQueue,v=o.alternate;if(v!==null&&(v=v.updateQueue,h===v)){var _=null,k=null;if(h=h.firstBaseUpdate,h!==null){do{var F={eventTime:h.eventTime,lane:h.lane,tag:h.tag,payload:h.payload,callback:h.callback,next:null};k===null?_=k=F:k=k.next=F,h=h.next}while(h!==null);k===null?_=k=a:k=k.next=a}else _=k=a;h={baseState:v.baseState,firstBaseUpdate:_,lastBaseUpdate:k,shared:v.shared,effects:v.effects},o.updateQueue=h;return}o=h.lastBaseUpdate,o===null?h.firstBaseUpdate=a:o.next=a,h.lastBaseUpdate=a}function dc(o,a,h,v){var _=o.updateQueue;uo=!1;var k=_.firstBaseUpdate,F=_.lastBaseUpdate,W=_.shared.pending;if(W!==null){_.shared.pending=null;var Q=W,ve=Q.next;Q.next=null,F===null?k=ve:F.next=ve,F=Q;var Pe=o.alternate;Pe!==null&&(Pe=Pe.updateQueue,W=Pe.lastBaseUpdate,W!==F&&(W===null?Pe.firstBaseUpdate=ve:W.next=ve,Pe.lastBaseUpdate=Q))}if(k!==null){var je=_.baseState;F=0,Pe=ve=Q=null,W=k;do{var Ie=W.lane,Xe=W.eventTime;if((v&Ie)===Ie){Pe!==null&&(Pe=Pe.next={eventTime:Xe,lane:0,tag:W.tag,payload:W.payload,callback:W.callback,next:null});e:{var at=o,ct=W;switch(Ie=a,Xe=h,ct.tag){case 1:if(at=ct.payload,typeof at=="function"){je=at.call(Xe,je,Ie);break e}je=at;break e;case 3:at.flags=at.flags&-65537|128;case 0:if(at=ct.payload,Ie=typeof at=="function"?at.call(Xe,je,Ie):at,Ie==null)break e;je=J({},je,Ie);break e;case 2:uo=!0}}W.callback!==null&&W.lane!==0&&(o.flags|=64,Ie=_.effects,Ie===null?_.effects=[W]:Ie.push(W))}else Xe={eventTime:Xe,lane:Ie,tag:W.tag,payload:W.payload,callback:W.callback,next:null},Pe===null?(ve=Pe=Xe,Q=je):Pe=Pe.next=Xe,F|=Ie;if(W=W.next,W===null){if(W=_.shared.pending,W===null)break;Ie=W,W=Ie.next,Ie.next=null,_.lastBaseUpdate=Ie,_.shared.pending=null}}while(!0);if(Pe===null&&(Q=je),_.baseState=Q,_.firstBaseUpdate=ve,_.lastBaseUpdate=Pe,a=_.shared.interleaved,a!==null){_=a;do F|=_.lane,_=_.next;while(_!==a)}else k===null&&(_.shared.lanes=0);ba|=F,o.lanes=F,o.memoizedState=je}}function Hh(o,a,h){if(o=a.effects,a.effects=null,o!==null)for(a=0;a<o.length;a++){var v=o[a],_=v.callback;if(_!==null){if(v.callback=null,v=h,typeof _!="function")throw Error(t(191,_));_.call(v)}}}var yu={},si=Es(yu),xu=Es(yu),fc=Es(yu);function Oi(o){if(o===yu)throw Error(t(174));return o}function Bh(o,a){switch(Mr(fc,a),Mr(xu,o),Mr(si,yu),o=a.nodeType,o){case 9:case 11:a=(a=a.documentElement)?a.namespaceURI:rt(null,"");break;default:o=o===8?a.parentNode:a,a=o.namespaceURI||null,o=o.tagName,a=rt(a,o)}Gr(si),Mr(si,a)}function va(){Gr(si),Gr(xu),Gr(fc)}function Gh(o){Oi(fc.current);var a=Oi(si.current),h=rt(a,o.type);a!==h&&(Mr(xu,o),Mr(si,h))}function Vd(o){xu.current===o&&(Gr(si),Gr(xu))}var Yr=Es(0);function al(o){for(var a=o;a!==null;){if(a.tag===13){var h=a.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||h.data==="$?"||h.data==="$!"))return a}else if(a.tag===19&&a.memoizedProps.revealOrder!==void 0){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===o)break;for(;a.sibling===null;){if(a.return===null||a.return===o)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var Wh=[];function qd(){for(var o=0;o<Wh.length;o++)Wh[o]._workInProgressVersionPrimary=null;Wh.length=0}var wu=P.ReactCurrentDispatcher,Vh=P.ReactCurrentBatchConfig,ya=0,Qr=null,dn=null,Sn=null,hc=!1,bu=!1,ll=0,Kt=0;function rs(){throw Error(t(321))}function qh(o,a){if(a===null)return!1;for(var h=0;h<a.length&&h<o.length;h++)if(!ge(o[h],a[h]))return!1;return!0}function cl(o,a,h,v,_,k){if(ya=k,Qr=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,wu.current=o===null||o.memoizedState===null?F0:ef,o=h(v,_),bu){k=0;do{if(bu=!1,ll=0,25<=k)throw Error(t(301));k+=1,Sn=dn=null,a.updateQueue=null,wu.current=vc,o=h(v,_)}while(bu)}if(wu.current=Zd,a=dn!==null&&dn.next!==null,ya=0,Sn=dn=Qr=null,hc=!1,a)throw Error(t(300));return o}function Kd(){var o=ll!==0;return ll=0,o}function oi(){var o={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Sn===null?Qr.memoizedState=Sn=o:Sn=Sn.next=o,Sn}function ho(){if(dn===null){var o=Qr.alternate;o=o!==null?o.memoizedState:null}else o=dn.next;var a=Sn===null?Qr.memoizedState:Sn.next;if(a!==null)Sn=a,dn=o;else{if(o===null)throw Error(t(310));dn=o,o={memoizedState:dn.memoizedState,baseState:dn.baseState,baseQueue:dn.baseQueue,queue:dn.queue,next:null},Sn===null?Qr.memoizedState=Sn=o:Sn=Sn.next=o}return Sn}function ns(o,a){return typeof a=="function"?a(o):a}function Kh(o){var a=ho(),h=a.queue;if(h===null)throw Error(t(311));h.lastRenderedReducer=o;var v=dn,_=v.baseQueue,k=h.pending;if(k!==null){if(_!==null){var F=_.next;_.next=k.next,k.next=F}v.baseQueue=_=k,h.pending=null}if(_!==null){k=_.next,v=v.baseState;var W=F=null,Q=null,ve=k;do{var Pe=ve.lane;if((ya&Pe)===Pe)Q!==null&&(Q=Q.next={lane:0,action:ve.action,hasEagerState:ve.hasEagerState,eagerState:ve.eagerState,next:null}),v=ve.hasEagerState?ve.eagerState:o(v,ve.action);else{var je={lane:Pe,action:ve.action,hasEagerState:ve.hasEagerState,eagerState:ve.eagerState,next:null};Q===null?(W=Q=je,F=v):Q=Q.next=je,Qr.lanes|=Pe,ba|=Pe}ve=ve.next}while(ve!==null&&ve!==k);Q===null?F=v:Q.next=W,ge(v,a.memoizedState)||(hs=!0),a.memoizedState=v,a.baseState=F,a.baseQueue=Q,h.lastRenderedState=v}if(o=h.interleaved,o!==null){_=o;do k=_.lane,Qr.lanes|=k,ba|=k,_=_.next;while(_!==o)}else _===null&&(h.lanes=0);return[a.memoizedState,h.dispatch]}function pc(o){var a=ho(),h=a.queue;if(h===null)throw Error(t(311));h.lastRenderedReducer=o;var v=h.dispatch,_=h.pending,k=a.memoizedState;if(_!==null){h.pending=null;var F=_=_.next;do k=o(k,F.action),F=F.next;while(F!==_);ge(k,a.memoizedState)||(hs=!0),a.memoizedState=k,a.baseQueue===null&&(a.baseState=k),h.lastRenderedState=k}return[k,v]}function Yd(){}function Yh(o,a){var h=Qr,v=ho(),_=a(),k=!ge(v.memoizedState,_);if(k&&(v.memoizedState=_,hs=!0),v=v.queue,ii(Di.bind(null,h,v,o),[o]),v.getSnapshot!==a||k||Sn!==null&&Sn.memoizedState.tag&1){if(h.flags|=2048,mc(9,Ns.bind(null,h,v,_,a),void 0,null),Fn===null)throw Error(t(349));(ya&30)!==0||Jh(h,a,_)}return _}function Jh(o,a,h){o.flags|=16384,o={getSnapshot:a,value:h},a=Qr.updateQueue,a===null?(a={lastEffect:null,stores:null},Qr.updateQueue=a,a.stores=[o]):(h=a.stores,h===null?a.stores=[o]:h.push(o))}function Ns(o,a,h,v){a.value=h,a.getSnapshot=v,Jd(a)&&Xh(o)}function Di(o,a,h){return h(function(){Jd(a)&&Xh(o)})}function Jd(o){var a=o.getSnapshot;o=o.value;try{var h=a();return!ge(o,h)}catch{return!0}}function Xh(o){var a=Fi(o,1);a!==null&&Oo(a,o,1,-1)}function _u(o){var a=oi();return typeof o=="function"&&(o=o()),a.memoizedState=a.baseState=o,o={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ns,lastRenderedState:o},a.queue=o,o=o.dispatch=$g.bind(null,Qr,o),[a.memoizedState,o]}function mc(o,a,h,v){return o={tag:o,create:a,destroy:h,deps:v,next:null},a=Qr.updateQueue,a===null?(a={lastEffect:null,stores:null},Qr.updateQueue=a,a.lastEffect=o.next=o):(h=a.lastEffect,h===null?a.lastEffect=o.next=o:(v=h.next,h.next=o,o.next=v,a.lastEffect=o)),o}function Xd(){return ho().memoizedState}function Eu(o,a,h,v){var _=oi();Qr.flags|=o,_.memoizedState=mc(1|a,h,void 0,v===void 0?null:v)}function gc(o,a,h,v){var _=ho();v=v===void 0?null:v;var k=void 0;if(dn!==null){var F=dn.memoizedState;if(k=F.destroy,v!==null&&qh(v,F.deps)){_.memoizedState=mc(a,h,k,v);return}}Qr.flags|=o,_.memoizedState=mc(1|a,h,k,v)}function Qd(o,a){return Eu(8390656,8,o,a)}function ii(o,a){return gc(2048,8,o,a)}function jg(o,a){return gc(4,2,o,a)}function Li(o,a){return gc(4,4,o,a)}function Qh(o,a){if(typeof a=="function")return o=o(),a(o),function(){a(null)};if(a!=null)return o=o(),a.current=o,function(){a.current=null}}function Zh(o,a,h){return h=h!=null?h.concat([o]):null,gc(4,4,Qh.bind(null,a,o),h)}function Su(){}function Og(o,a){var h=ho();a=a===void 0?null:a;var v=h.memoizedState;return v!==null&&a!==null&&qh(a,v[1])?v[0]:(h.memoizedState=[o,a],o)}function Dg(o,a){var h=ho();a=a===void 0?null:a;var v=h.memoizedState;return v!==null&&a!==null&&qh(a,v[1])?v[0]:(o=o(),h.memoizedState=[o,a],o)}function Lg(o,a,h){return(ya&21)===0?(o.baseState&&(o.baseState=!1,hs=!0),o.memoizedState=h):(ge(h,a)||(h=Va(),Qr.lanes|=h,ba|=h,o.baseState=!0),a)}function Mg(o,a){var h=fr;fr=h!==0&&4>h?h:4,o(!0);var v=Vh.transition;Vh.transition={};try{o(!1),a()}finally{fr=h,Vh.transition=v}}function ep(){return ho().memoizedState}function P0(o,a,h){var v=Sa(o);if(h={lane:v,action:h,hasEagerState:!1,eagerState:null,next:null},tp(o))fs(a,h);else if(h=Bd(o,a,h,v),h!==null){var _=gs();Oo(h,o,v,_),Ao(h,a,v)}}function $g(o,a,h){var v=Sa(o),_={lane:v,action:h,hasEagerState:!1,eagerState:null,next:null};if(tp(o))fs(a,_);else{var k=o.alternate;if(o.lanes===0&&(k===null||k.lanes===0)&&(k=a.lastRenderedReducer,k!==null))try{var F=a.lastRenderedState,W=k(F,h);if(_.hasEagerState=!0,_.eagerState=W,ge(W,F)){var Q=a.interleaved;Q===null?(_.next=_,zh(a)):(_.next=Q.next,Q.next=_),a.interleaved=_;return}}catch{}finally{}h=Bd(o,a,_,v),h!==null&&(_=gs(),Oo(h,o,v,_),Ao(h,a,v))}}function tp(o){var a=o.alternate;return o===Qr||a!==null&&a===Qr}function fs(o,a){bu=hc=!0;var h=o.pending;h===null?a.next=a:(a.next=h.next,h.next=a),o.pending=a}function Ao(o,a,h){if((h&4194240)!==0){var v=a.lanes;v&=o.pendingLanes,h|=v,a.lanes=h,Ka(o,h)}}var Zd={readContext:co,useCallback:rs,useContext:rs,useEffect:rs,useImperativeHandle:rs,useInsertionEffect:rs,useLayoutEffect:rs,useMemo:rs,useReducer:rs,useRef:rs,useState:rs,useDebugValue:rs,useDeferredValue:rs,useTransition:rs,useMutableSource:rs,useSyncExternalStore:rs,useId:rs,unstable_isNewReconciler:!1},F0={readContext:co,useCallback:function(o,a){return oi().memoizedState=[o,a===void 0?null:a],o},useContext:co,useEffect:Qd,useImperativeHandle:function(o,a,h){return h=h!=null?h.concat([o]):null,Eu(4194308,4,Qh.bind(null,a,o),h)},useLayoutEffect:function(o,a){return Eu(4194308,4,o,a)},useInsertionEffect:function(o,a){return Eu(4,2,o,a)},useMemo:function(o,a){var h=oi();return a=a===void 0?null:a,o=o(),h.memoizedState=[o,a],o},useReducer:function(o,a,h){var v=oi();return a=h!==void 0?h(a):a,v.memoizedState=v.baseState=a,o={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:o,lastRenderedState:a},v.queue=o,o=o.dispatch=P0.bind(null,Qr,o),[v.memoizedState,o]},useRef:function(o){var a=oi();return o={current:o},a.memoizedState=o},useState:_u,useDebugValue:Su,useDeferredValue:function(o){return oi().memoizedState=o},useTransition:function(){var o=_u(!1),a=o[0];return o=Mg.bind(null,o[1]),oi().memoizedState=o,[a,o]},useMutableSource:function(){},useSyncExternalStore:function(o,a,h){var v=Qr,_=oi();if(Wr){if(h===void 0)throw Error(t(407));h=h()}else{if(h=a(),Fn===null)throw Error(t(349));(ya&30)!==0||Jh(v,a,h)}_.memoizedState=h;var k={value:h,getSnapshot:a};return _.queue=k,Qd(Di.bind(null,v,k,o),[o]),v.flags|=2048,mc(9,Ns.bind(null,v,k,h,a),void 0,null),h},useId:function(){var o=oi(),a=Fn.identifierPrefix;if(Wr){var h=ei,v=Zo;h=(v&~(1<<32-Un(v)-1)).toString(32)+h,a=":"+a+"R"+h,h=ll++,0<h&&(a+="H"+h.toString(32)),a+=":"}else h=Kt++,a=":"+a+"r"+h.toString(32)+":";return o.memoizedState=a},unstable_isNewReconciler:!1},ef={readContext:co,useCallback:Og,useContext:co,useEffect:ii,useImperativeHandle:Zh,useInsertionEffect:jg,useLayoutEffect:Li,useMemo:Dg,useReducer:Kh,useRef:Xd,useState:function(){return Kh(ns)},useDebugValue:Su,useDeferredValue:function(o){var a=ho();return Lg(a,dn.memoizedState,o)},useTransition:function(){var o=Kh(ns)[0],a=ho().memoizedState;return[o,a]},useMutableSource:Yd,useSyncExternalStore:Yh,useId:ep,unstable_isNewReconciler:!1},vc={readContext:co,useCallback:Og,useContext:co,useEffect:ii,useImperativeHandle:Zh,useInsertionEffect:jg,useLayoutEffect:Li,useMemo:Dg,useReducer:pc,useRef:Xd,useState:function(){return pc(ns)},useDebugValue:Su,useDeferredValue:function(o){var a=ho();return dn===null?a.memoizedState=o:Lg(a,dn.memoizedState,o)},useTransition:function(){var o=pc(ns)[0],a=ho().memoizedState;return[o,a]},useMutableSource:Yd,useSyncExternalStore:Yh,useId:ep,unstable_isNewReconciler:!1};function po(o,a){if(o&&o.defaultProps){a=J({},a),o=o.defaultProps;for(var h in o)a[h]===void 0&&(a[h]=o[h]);return a}return a}function tf(o,a,h,v){a=o.memoizedState,h=h(v,a),h=h==null?a:J({},a,h),o.memoizedState=h,o.lanes===0&&(o.updateQueue.baseState=h)}var rf={isMounted:function(o){return(o=o._reactInternals)?no(o)===o:!1},enqueueSetState:function(o,a,h){o=o._reactInternals;var v=gs(),_=Sa(o),k=ji(v,_);k.payload=a,h!=null&&(k.callback=h),a=fo(o,k,_),a!==null&&(Oo(a,o,_,v),Wd(a,o,_))},enqueueReplaceState:function(o,a,h){o=o._reactInternals;var v=gs(),_=Sa(o),k=ji(v,_);k.tag=1,k.payload=a,h!=null&&(k.callback=h),a=fo(o,k,_),a!==null&&(Oo(a,o,_,v),Wd(a,o,_))},enqueueForceUpdate:function(o,a){o=o._reactInternals;var h=gs(),v=Sa(o),_=ji(h,v);_.tag=2,a!=null&&(_.callback=a),a=fo(o,_,v),a!==null&&(Oo(a,o,v,h),Wd(a,o,v))}};function rp(o,a,h,v,_,k,F){return o=o.stateNode,typeof o.shouldComponentUpdate=="function"?o.shouldComponentUpdate(v,k,F):a.prototype&&a.prototype.isPureReactComponent?!Je(h,v)||!Je(_,k):!0}function ul(o,a,h){var v=!1,_=ha,k=a.contextType;return typeof k=="object"&&k!==null?k=co(k):(_=Cs(a)?ds:Zn.current,v=a.contextTypes,k=(v=v!=null)?lc(o,_):ha),a=new a(h,k),o.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,a.updater=rf,o.stateNode=a,a._reactInternals=o,v&&(o=o.stateNode,o.__reactInternalMemoizedUnmaskedChildContext=_,o.__reactInternalMemoizedMaskedChildContext=k),a}function yc(o,a,h,v){o=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(h,v),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(h,v),a.state!==o&&rf.enqueueReplaceState(a,a.state,null)}function np(o,a,h,v){var _=o.stateNode;_.props=h,_.state=o.memoizedState,_.refs={},Gd(o);var k=a.contextType;typeof k=="object"&&k!==null?_.context=co(k):(k=Cs(a)?ds:Zn.current,_.context=lc(o,k)),_.state=o.memoizedState,k=a.getDerivedStateFromProps,typeof k=="function"&&(tf(o,a,k,h),_.state=o.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof _.getSnapshotBeforeUpdate=="function"||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(a=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),a!==_.state&&rf.enqueueReplaceState(_,_.state,null),dc(o,h,_,v),_.state=o.memoizedState),typeof _.componentDidMount=="function"&&(o.flags|=4194308)}function dl(o,a){try{var h="",v=a;do h+=q(v),v=v.return;while(v);var _=h}catch(k){_=`
Error generating stack: `+k.message+`
`+k.stack}return{value:o,source:a,stack:_,digest:null}}function nf(o,a,h){return{value:o,source:null,stack:h??null,digest:a??null}}function xc(o,a){try{console.error(a.value)}catch(h){setTimeout(function(){throw h})}}var Ug=typeof WeakMap=="function"?WeakMap:Map;function Cu(o,a,h){h=ji(-1,h),h.tag=3,h.payload={element:null};var v=a.value;return h.callback=function(){mf||(mf=!0,xp=v),xc(o,a)},h}function sf(o,a,h){h=ji(-1,h),h.tag=3;var v=o.type.getDerivedStateFromError;if(typeof v=="function"){var _=a.value;h.payload=function(){return v(_)},h.callback=function(){xc(o,a)}}var k=o.stateNode;return k!==null&&typeof k.componentDidCatch=="function"&&(h.callback=function(){xc(o,a),typeof v!="function"&&(_a===null?_a=new Set([this]):_a.add(this));var F=a.stack;this.componentDidCatch(a.value,{componentStack:F!==null?F:""})}),h}function ku(o,a,h){var v=o.pingCache;if(v===null){v=o.pingCache=new Ug;var _=new Set;v.set(a,_)}else _=v.get(a),_===void 0&&(_=new Set,v.set(a,_));_.has(h)||(_.add(h),o=z0.bind(null,o,a,h),a.then(o,o))}function zg(o){do{var a;if((a=o.tag===13)&&(a=o.memoizedState,a=a!==null?a.dehydrated!==null:!0),a)return o;o=o.return}while(o!==null);return null}function sp(o,a,h,v,_){return(o.mode&1)===0?(o===a?o.flags|=65536:(o.flags|=128,h.flags|=131072,h.flags&=-52805,h.tag===1&&(h.alternate===null?h.tag=17:(a=ji(-1,1),a.tag=2,fo(h,a,1))),h.lanes|=1),o):(o.flags|=65536,o.lanes=_,o)}var of=P.ReactCurrentOwner,hs=!1;function Hn(o,a,h,v){a.child=o===null?zd(a,null,h,v):an(a,o.child,h,v)}function Hg(o,a,h,v,_){h=h.render;var k=a.ref;return ga(a,_),v=cl(o,a,h,v,k,_),h=Kd(),o!==null&&!hs?(a.updateQueue=o.updateQueue,a.flags&=-2053,o.lanes&=~_,Io(o,a,_)):(Wr&&h&&pu(a),a.flags|=1,Hn(o,a,v,_),a.child)}function op(o,a,h,v,_){if(o===null){var k=h.type;return typeof k=="function"&&!bf(k)&&k.defaultProps===void 0&&h.compare===null&&h.defaultProps===void 0?(a.tag=15,a.type=k,ai(o,a,k,v,_)):(o=_f(h.type,null,v,a,a.mode,_),o.ref=a.ref,o.return=a,a.child=o)}if(k=o.child,(o.lanes&_)===0){var F=k.memoizedProps;if(h=h.compare,h=h!==null?h:Je,h(F,v)&&o.ref===a.ref)return Io(o,a,_)}return a.flags|=1,o=Do(k,v),o.ref=a.ref,o.return=a,a.child=o}function ai(o,a,h,v,_){if(o!==null){var k=o.memoizedProps;if(Je(k,v)&&o.ref===a.ref)if(hs=!1,a.pendingProps=v=k,(o.lanes&_)!==0)(o.flags&131072)!==0&&(hs=!0);else return a.lanes=o.lanes,Io(o,a,_)}return lp(o,a,h,v,_)}function ip(o,a,h){var v=a.pendingProps,_=v.children,k=o!==null?o.memoizedState:null;if(v.mode==="hidden")if((a.mode&1)===0)a.memoizedState={baseLanes:0,cachePool:null,transitions:null},Mr(Ec,Vs),Vs|=h;else{if((h&1073741824)===0)return o=k!==null?k.baseLanes|h:h,a.lanes=a.childLanes=1073741824,a.memoizedState={baseLanes:o,cachePool:null,transitions:null},a.updateQueue=null,Mr(Ec,Vs),Vs|=o,null;a.memoizedState={baseLanes:0,cachePool:null,transitions:null},v=k!==null?k.baseLanes:h,Mr(Ec,Vs),Vs|=v}else k!==null?(v=k.baseLanes|h,a.memoizedState=null):v=h,Mr(Ec,Vs),Vs|=v;return Hn(o,a,_,h),a.child}function ap(o,a){var h=a.ref;(o===null&&h!==null||o!==null&&o.ref!==h)&&(a.flags|=512,a.flags|=2097152)}function lp(o,a,h,v,_){var k=Cs(h)?ds:Zn.current;return k=lc(a,k),ga(a,_),h=cl(o,a,h,v,k,_),v=Kd(),o!==null&&!hs?(a.updateQueue=o.updateQueue,a.flags&=-2053,o.lanes&=~_,Io(o,a,_)):(Wr&&v&&pu(a),a.flags|=1,Hn(o,a,h,_),a.child)}function cp(o,a,h,v,_){if(Cs(h)){var k=!0;io(a)}else k=!1;if(ga(a,_),a.stateNode===null)lf(o,a),ul(a,h,v),np(a,h,v,_),v=!0;else if(o===null){var F=a.stateNode,W=a.memoizedProps;F.props=W;var Q=F.context,ve=h.contextType;typeof ve=="object"&&ve!==null?ve=co(ve):(ve=Cs(h)?ds:Zn.current,ve=lc(a,ve));var Pe=h.getDerivedStateFromProps,je=typeof Pe=="function"||typeof F.getSnapshotBeforeUpdate=="function";je||typeof F.UNSAFE_componentWillReceiveProps!="function"&&typeof F.componentWillReceiveProps!="function"||(W!==v||Q!==ve)&&yc(a,F,v,ve),uo=!1;var Ie=a.memoizedState;F.state=Ie,dc(a,v,F,_),Q=a.memoizedState,W!==v||Ie!==Q||Ss.current||uo?(typeof Pe=="function"&&(tf(a,h,Pe,v),Q=a.memoizedState),(W=uo||rp(a,h,W,v,Ie,Q,ve))?(je||typeof F.UNSAFE_componentWillMount!="function"&&typeof F.componentWillMount!="function"||(typeof F.componentWillMount=="function"&&F.componentWillMount(),typeof F.UNSAFE_componentWillMount=="function"&&F.UNSAFE_componentWillMount()),typeof F.componentDidMount=="function"&&(a.flags|=4194308)):(typeof F.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=v,a.memoizedState=Q),F.props=v,F.state=Q,F.context=ve,v=W):(typeof F.componentDidMount=="function"&&(a.flags|=4194308),v=!1)}else{F=a.stateNode,Pg(o,a),W=a.memoizedProps,ve=a.type===a.elementType?W:po(a.type,W),F.props=ve,je=a.pendingProps,Ie=F.context,Q=h.contextType,typeof Q=="object"&&Q!==null?Q=co(Q):(Q=Cs(h)?ds:Zn.current,Q=lc(a,Q));var Xe=h.getDerivedStateFromProps;(Pe=typeof Xe=="function"||typeof F.getSnapshotBeforeUpdate=="function")||typeof F.UNSAFE_componentWillReceiveProps!="function"&&typeof F.componentWillReceiveProps!="function"||(W!==je||Ie!==Q)&&yc(a,F,v,Q),uo=!1,Ie=a.memoizedState,F.state=Ie,dc(a,v,F,_);var at=a.memoizedState;W!==je||Ie!==at||Ss.current||uo?(typeof Xe=="function"&&(tf(a,h,Xe,v),at=a.memoizedState),(ve=uo||rp(a,h,ve,v,Ie,at,Q)||!1)?(Pe||typeof F.UNSAFE_componentWillUpdate!="function"&&typeof F.componentWillUpdate!="function"||(typeof F.componentWillUpdate=="function"&&F.componentWillUpdate(v,at,Q),typeof F.UNSAFE_componentWillUpdate=="function"&&F.UNSAFE_componentWillUpdate(v,at,Q)),typeof F.componentDidUpdate=="function"&&(a.flags|=4),typeof F.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof F.componentDidUpdate!="function"||W===o.memoizedProps&&Ie===o.memoizedState||(a.flags|=4),typeof F.getSnapshotBeforeUpdate!="function"||W===o.memoizedProps&&Ie===o.memoizedState||(a.flags|=1024),a.memoizedProps=v,a.memoizedState=at),F.props=v,F.state=at,F.context=Q,v=ve):(typeof F.componentDidUpdate!="function"||W===o.memoizedProps&&Ie===o.memoizedState||(a.flags|=4),typeof F.getSnapshotBeforeUpdate!="function"||W===o.memoizedProps&&Ie===o.memoizedState||(a.flags|=1024),v=!1)}return up(o,a,h,v,k,_)}function up(o,a,h,v,_,k){ap(o,a);var F=(a.flags&128)!==0;if(!v&&!F)return _&&kg(a,h,!1),Io(o,a,k);v=a.stateNode,of.current=a;var W=F&&typeof h.getDerivedStateFromError!="function"?null:v.render();return a.flags|=1,o!==null&&F?(a.child=an(a,o.child,null,k),a.child=an(a,null,W,k)):Hn(o,a,W,k),a.memoizedState=v.state,_&&kg(a,h,!0),a.child}function Bg(o){var a=o.stateNode;a.pendingContext?Sg(o,a.pendingContext,a.pendingContext!==a.context):a.context&&Sg(o,a.context,!1),Bh(o,a.containerInfo)}function li(o,a,h,v,_){return ri(),ni(_),a.flags|=256,Hn(o,a,h,v),a.child}var Nu={dehydrated:null,treeContext:null,retryLane:0};function Tu(o){return{baseLanes:o,cachePool:null,transitions:null}}function af(o,a,h){var v=a.pendingProps,_=Yr.current,k=!1,F=(a.flags&128)!==0,W;if((W=F)||(W=o!==null&&o.memoizedState===null?!1:(_&2)!==0),W?(k=!0,a.flags&=-129):(o===null||o.memoizedState!==null)&&(_|=1),Mr(Yr,_&1),o===null)return ks(a),o=a.memoizedState,o!==null&&(o=o.dehydrated,o!==null)?((a.mode&1)===0?a.lanes=1:o.data==="$!"?a.lanes=8:a.lanes=1073741824,null):(F=v.children,o=v.fallback,k?(v=a.mode,k=a.child,F={mode:"hidden",children:F},(v&1)===0&&k!==null?(k.childLanes=0,k.pendingProps=F):k=Ef(F,v,0,null),o=gl(o,v,h,null),k.return=a,o.return=a,k.sibling=o,a.child=k,a.child.memoizedState=Tu(h),a.memoizedState=Nu,o):wc(a,F));if(_=o.memoizedState,_!==null&&(W=_.dehydrated,W!==null))return It(o,a,F,v,W,_,h);if(k){k=v.fallback,F=a.mode,_=o.child,W=_.sibling;var Q={mode:"hidden",children:v.children};return(F&1)===0&&a.child!==_?(v=a.child,v.childLanes=0,v.pendingProps=Q,a.deletions=null):(v=Do(_,Q),v.subtreeFlags=_.subtreeFlags&14680064),W!==null?k=Do(W,k):(k=gl(k,F,h,null),k.flags|=2),k.return=a,v.return=a,v.sibling=k,a.child=v,v=k,k=a.child,F=o.child.memoizedState,F=F===null?Tu(h):{baseLanes:F.baseLanes|h,cachePool:null,transitions:F.transitions},k.memoizedState=F,k.childLanes=o.childLanes&~h,a.memoizedState=Nu,v}return k=o.child,o=k.sibling,v=Do(k,{mode:"visible",children:v.children}),(a.mode&1)===0&&(v.lanes=h),v.return=a,v.sibling=null,o!==null&&(h=a.deletions,h===null?(a.deletions=[o],a.flags|=16):h.push(o)),a.child=v,a.memoizedState=null,v}function wc(o,a){return a=Ef({mode:"visible",children:a},o.mode,0,null),a.return=o,o.child=a}function Mi(o,a,h,v){return v!==null&&ni(v),an(a,o.child,null,h),o=wc(a,a.pendingProps.children),o.flags|=2,a.memoizedState=null,o}function It(o,a,h,v,_,k,F){if(h)return a.flags&256?(a.flags&=-257,v=nf(Error(t(422))),Mi(o,a,F,v)):a.memoizedState!==null?(a.child=o.child,a.flags|=128,null):(k=v.fallback,_=a.mode,v=Ef({mode:"visible",children:v.children},_,0,null),k=gl(k,_,F,null),k.flags|=2,v.return=a,k.return=a,v.sibling=k,a.child=v,(a.mode&1)!==0&&an(a,o.child,null,F),a.child.memoizedState=Tu(F),a.memoizedState=Nu,k);if((a.mode&1)===0)return Mi(o,a,F,null);if(_.data==="$!"){if(v=_.nextSibling&&_.nextSibling.dataset,v)var W=v.dgst;return v=W,k=Error(t(419)),v=nf(k,v,void 0),Mi(o,a,F,v)}if(W=(F&o.childLanes)!==0,hs||W){if(v=Fn,v!==null){switch(F&-F){case 4:_=2;break;case 16:_=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:_=32;break;case 536870912:_=268435456;break;default:_=0}_=(_&(v.suspendedLanes|F))!==0?0:_,_!==0&&_!==k.retryLane&&(k.retryLane=_,Fi(o,_),Oo(v,o,_,-1))}return Cp(),v=nf(Error(t(421))),Mi(o,a,F,v)}return _.data==="$?"?(a.flags|=128,a.child=o.child,a=H0.bind(null,o),_._reactRetry=a,null):(o=k.treeContext,Bs=da(_.nextSibling),ts=a,Wr=!0,Ro=null,o!==null&&(ao[lo++]=Zo,ao[lo++]=ei,ao[lo++]=rl,Zo=o.id,ei=o.overflow,rl=a),a=wc(a,v.children),a.flags|=4096,a)}function Ru(o,a,h){o.lanes|=a;var v=o.alternate;v!==null&&(v.lanes|=a),zn(o.return,a,h)}function Au(o,a,h,v,_){var k=o.memoizedState;k===null?o.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:v,tail:h,tailMode:_}:(k.isBackwards=a,k.rendering=null,k.renderingStartTime=0,k.last=v,k.tail=h,k.tailMode=_)}function xa(o,a,h){var v=a.pendingProps,_=v.revealOrder,k=v.tail;if(Hn(o,a,v.children,h),v=Yr.current,(v&2)!==0)v=v&1|2,a.flags|=128;else{if(o!==null&&(o.flags&128)!==0)e:for(o=a.child;o!==null;){if(o.tag===13)o.memoizedState!==null&&Ru(o,h,a);else if(o.tag===19)Ru(o,h,a);else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===a)break e;for(;o.sibling===null;){if(o.return===null||o.return===a)break e;o=o.return}o.sibling.return=o.return,o=o.sibling}v&=1}if(Mr(Yr,v),(a.mode&1)===0)a.memoizedState=null;else switch(_){case"forwards":for(h=a.child,_=null;h!==null;)o=h.alternate,o!==null&&al(o)===null&&(_=h),h=h.sibling;h=_,h===null?(_=a.child,a.child=null):(_=h.sibling,h.sibling=null),Au(a,!1,_,h,k);break;case"backwards":for(h=null,_=a.child,a.child=null;_!==null;){if(o=_.alternate,o!==null&&al(o)===null){a.child=_;break}o=_.sibling,_.sibling=h,h=_,_=o}Au(a,!0,h,null,k);break;case"together":Au(a,!1,null,null,void 0);break;default:a.memoizedState=null}return a.child}function lf(o,a){(a.mode&1)===0&&o!==null&&(o.alternate=null,a.alternate=null,a.flags|=2)}function Io(o,a,h){if(o!==null&&(a.dependencies=o.dependencies),ba|=a.lanes,(h&a.childLanes)===0)return null;if(o!==null&&a.child!==o.child)throw Error(t(153));if(a.child!==null){for(o=a.child,h=Do(o,o.pendingProps),a.child=h,h.return=a;o.sibling!==null;)o=o.sibling,h=h.sibling=Do(o,o.pendingProps),h.return=a;h.sibling=null}return a.child}function Gg(o,a,h){switch(a.tag){case 3:Bg(a),ri();break;case 5:Gh(a);break;case 1:Cs(a.type)&&io(a);break;case 4:Bh(a,a.stateNode.containerInfo);break;case 10:var v=a.type._context,_=a.memoizedProps.value;Mr(vu,v._currentValue),v._currentValue=_;break;case 13:if(v=a.memoizedState,v!==null)return v.dehydrated!==null?(Mr(Yr,Yr.current&1),a.flags|=128,null):(h&a.child.childLanes)!==0?af(o,a,h):(Mr(Yr,Yr.current&1),o=Io(o,a,h),o!==null?o.sibling:null);Mr(Yr,Yr.current&1);break;case 19:if(v=(h&a.childLanes)!==0,(o.flags&128)!==0){if(v)return xa(o,a,h);a.flags|=128}if(_=a.memoizedState,_!==null&&(_.rendering=null,_.tail=null,_.lastEffect=null),Mr(Yr,Yr.current),v)break;return null;case 22:case 23:return a.lanes=0,ip(o,a,h)}return Io(o,a,h)}var Bn,dp,Wg,fp;Bn=function(o,a){for(var h=a.child;h!==null;){if(h.tag===5||h.tag===6)o.appendChild(h.stateNode);else if(h.tag!==4&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===a)break;for(;h.sibling===null;){if(h.return===null||h.return===a)return;h=h.return}h.sibling.return=h.return,h=h.sibling}},dp=function(){},Wg=function(o,a,h,v){var _=o.memoizedProps;if(_!==v){o=a.stateNode,Oi(si.current);var k=null;switch(h){case"input":_=Ne(o,_),v=Ne(o,v),k=[];break;case"select":_=J({},_,{value:void 0}),v=J({},v,{value:void 0}),k=[];break;case"textarea":_=Ft(o,_),v=Ft(o,v),k=[];break;default:typeof _.onClick!="function"&&typeof v.onClick=="function"&&(o.onclick=Pd)}zr(h,v);var F;h=null;for(ve in _)if(!v.hasOwnProperty(ve)&&_.hasOwnProperty(ve)&&_[ve]!=null)if(ve==="style"){var W=_[ve];for(F in W)W.hasOwnProperty(F)&&(h||(h={}),h[F]="")}else ve!=="dangerouslySetInnerHTML"&&ve!=="children"&&ve!=="suppressContentEditableWarning"&&ve!=="suppressHydrationWarning"&&ve!=="autoFocus"&&(s.hasOwnProperty(ve)?k||(k=[]):(k=k||[]).push(ve,null));for(ve in v){var Q=v[ve];if(W=_!=null?_[ve]:void 0,v.hasOwnProperty(ve)&&Q!==W&&(Q!=null||W!=null))if(ve==="style")if(W){for(F in W)!W.hasOwnProperty(F)||Q&&Q.hasOwnProperty(F)||(h||(h={}),h[F]="");for(F in Q)Q.hasOwnProperty(F)&&W[F]!==Q[F]&&(h||(h={}),h[F]=Q[F])}else h||(k||(k=[]),k.push(ve,h)),h=Q;else ve==="dangerouslySetInnerHTML"?(Q=Q?Q.__html:void 0,W=W?W.__html:void 0,Q!=null&&W!==Q&&(k=k||[]).push(ve,Q)):ve==="children"?typeof Q!="string"&&typeof Q!="number"||(k=k||[]).push(ve,""+Q):ve!=="suppressContentEditableWarning"&&ve!=="suppressHydrationWarning"&&(s.hasOwnProperty(ve)?(Q!=null&&ve==="onScroll"&&Br("scroll",o),k||W===Q||(k=[])):(k=k||[]).push(ve,Q))}h&&(k=k||[]).push("style",h);var ve=k;(a.updateQueue=ve)&&(a.flags|=4)}},fp=function(o,a,h,v){h!==v&&(a.flags|=4)};function Iu(o,a){if(!Wr)switch(o.tailMode){case"hidden":a=o.tail;for(var h=null;a!==null;)a.alternate!==null&&(h=a),a=a.sibling;h===null?o.tail=null:h.sibling=null;break;case"collapsed":h=o.tail;for(var v=null;h!==null;)h.alternate!==null&&(v=h),h=h.sibling;v===null?a||o.tail===null?o.tail=null:o.tail.sibling=null:v.sibling=null}}function Gn(o){var a=o.alternate!==null&&o.alternate.child===o.child,h=0,v=0;if(a)for(var _=o.child;_!==null;)h|=_.lanes|_.childLanes,v|=_.subtreeFlags&14680064,v|=_.flags&14680064,_.return=o,_=_.sibling;else for(_=o.child;_!==null;)h|=_.lanes|_.childLanes,v|=_.subtreeFlags,v|=_.flags,_.return=o,_=_.sibling;return o.subtreeFlags|=v,o.childLanes=h,a}function j0(o,a,h){var v=a.pendingProps;switch(sl(a),a.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Gn(a),null;case 1:return Cs(a.type)&&Dd(),Gn(a),null;case 3:return v=a.stateNode,va(),Gr(Ss),Gr(Zn),qd(),v.pendingContext&&(v.context=v.pendingContext,v.pendingContext=null),(o===null||o.child===null)&&(mu(a)?a.flags|=4:o===null||o.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,Ro!==null&&(_p(Ro),Ro=null))),dp(o,a),Gn(a),null;case 5:Vd(a);var _=Oi(fc.current);if(h=a.type,o!==null&&a.stateNode!=null)Wg(o,a,h,v,_),o.ref!==a.ref&&(a.flags|=512,a.flags|=2097152);else{if(!v){if(a.stateNode===null)throw Error(t(166));return Gn(a),null}if(o=Oi(si.current),mu(a)){v=a.stateNode,h=a.type;var k=a.memoizedProps;switch(v[Xo]=a,v[fa]=k,o=(a.mode&1)!==0,h){case"dialog":Br("cancel",v),Br("close",v);break;case"iframe":case"object":case"embed":Br("load",v);break;case"video":case"audio":for(_=0;_<Ri.length;_++)Br(Ri[_],v);break;case"source":Br("error",v);break;case"img":case"image":case"link":Br("error",v),Br("load",v);break;case"details":Br("toggle",v);break;case"input":gt(v,k),Br("invalid",v);break;case"select":v._wrapperState={wasMultiple:!!k.multiple},Br("invalid",v);break;case"textarea":er(v,k),Br("invalid",v)}zr(h,k),_=null;for(var F in k)if(k.hasOwnProperty(F)){var W=k[F];F==="children"?typeof W=="string"?v.textContent!==W&&(k.suppressHydrationWarning!==!0&&uu(v.textContent,W,o),_=["children",W]):typeof W=="number"&&v.textContent!==""+W&&(k.suppressHydrationWarning!==!0&&uu(v.textContent,W,o),_=["children",""+W]):s.hasOwnProperty(F)&&W!=null&&F==="onScroll"&&Br("scroll",v)}switch(h){case"input":He(v),Zt(v,k,!0);break;case"textarea":He(v),Ze(v);break;case"select":case"option":break;default:typeof k.onClick=="function"&&(v.onclick=Pd)}v=_,a.updateQueue=v,v!==null&&(a.flags|=4)}else{F=_.nodeType===9?_:_.ownerDocument,o==="http://www.w3.org/1999/xhtml"&&(o=dt(h)),o==="http://www.w3.org/1999/xhtml"?h==="script"?(o=F.createElement("div"),o.innerHTML="<script><\/script>",o=o.removeChild(o.firstChild)):typeof v.is=="string"?o=F.createElement(h,{is:v.is}):(o=F.createElement(h),h==="select"&&(F=o,v.multiple?F.multiple=!0:v.size&&(F.size=v.size))):o=F.createElementNS(o,h),o[Xo]=a,o[fa]=v,Bn(o,a,!1,!1),a.stateNode=o;e:{switch(F=Or(h,v),h){case"dialog":Br("cancel",o),Br("close",o),_=v;break;case"iframe":case"object":case"embed":Br("load",o),_=v;break;case"video":case"audio":for(_=0;_<Ri.length;_++)Br(Ri[_],o);_=v;break;case"source":Br("error",o),_=v;break;case"img":case"image":case"link":Br("error",o),Br("load",o),_=v;break;case"details":Br("toggle",o),_=v;break;case"input":gt(o,v),_=Ne(o,v),Br("invalid",o);break;case"option":_=v;break;case"select":o._wrapperState={wasMultiple:!!v.multiple},_=J({},v,{value:void 0}),Br("invalid",o);break;case"textarea":er(o,v),_=Ft(o,v),Br("invalid",o);break;default:_=v}zr(h,_),W=_;for(k in W)if(W.hasOwnProperty(k)){var Q=W[k];k==="style"?ze(o,Q):k==="dangerouslySetInnerHTML"?(Q=Q?Q.__html:void 0,Q!=null&&gr(o,Q)):k==="children"?typeof Q=="string"?(h!=="textarea"||Q!=="")&&tr(o,Q):typeof Q=="number"&&tr(o,""+Q):k!=="suppressContentEditableWarning"&&k!=="suppressHydrationWarning"&&k!=="autoFocus"&&(s.hasOwnProperty(k)?Q!=null&&k==="onScroll"&&Br("scroll",o):Q!=null&&j(o,k,Q,F))}switch(h){case"input":He(o),Zt(o,v,!1);break;case"textarea":He(o),Ze(o);break;case"option":v.value!=null&&o.setAttribute("value",""+ye(v.value));break;case"select":o.multiple=!!v.multiple,k=v.value,k!=null?st(o,!!v.multiple,k,!1):v.defaultValue!=null&&st(o,!!v.multiple,v.defaultValue,!0);break;default:typeof _.onClick=="function"&&(o.onclick=Pd)}switch(h){case"button":case"input":case"select":case"textarea":v=!!v.autoFocus;break e;case"img":v=!0;break e;default:v=!1}}v&&(a.flags|=4)}a.ref!==null&&(a.flags|=512,a.flags|=2097152)}return Gn(a),null;case 6:if(o&&a.stateNode!=null)fp(o,a,o.memoizedProps,v);else{if(typeof v!="string"&&a.stateNode===null)throw Error(t(166));if(h=Oi(fc.current),Oi(si.current),mu(a)){if(v=a.stateNode,h=a.memoizedProps,v[Xo]=a,(k=v.nodeValue!==h)&&(o=ts,o!==null))switch(o.tag){case 3:uu(v.nodeValue,h,(o.mode&1)!==0);break;case 5:o.memoizedProps.suppressHydrationWarning!==!0&&uu(v.nodeValue,h,(o.mode&1)!==0)}k&&(a.flags|=4)}else v=(h.nodeType===9?h:h.ownerDocument).createTextNode(v),v[Xo]=a,a.stateNode=v}return Gn(a),null;case 13:if(Gr(Yr),v=a.memoizedState,o===null||o.memoizedState!==null&&o.memoizedState.dehydrated!==null){if(Wr&&Bs!==null&&(a.mode&1)!==0&&(a.flags&128)===0)$h(),ri(),a.flags|=98560,k=!1;else if(k=mu(a),v!==null&&v.dehydrated!==null){if(o===null){if(!k)throw Error(t(318));if(k=a.memoizedState,k=k!==null?k.dehydrated:null,!k)throw Error(t(317));k[Xo]=a}else ri(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;Gn(a),k=!1}else Ro!==null&&(_p(Ro),Ro=null),k=!0;if(!k)return a.flags&65536?a:null}return(a.flags&128)!==0?(a.lanes=h,a):(v=v!==null,v!==(o!==null&&o.memoizedState!==null)&&v&&(a.child.flags|=8192,(a.mode&1)!==0&&(o===null||(Yr.current&1)!==0?Cn===0&&(Cn=3):Cp())),a.updateQueue!==null&&(a.flags|=4),Gn(a),null);case 4:return va(),dp(o,a),o===null&&ca(a.stateNode.containerInfo),Gn(a),null;case 10:return Hd(a.type._context),Gn(a),null;case 17:return Cs(a.type)&&Dd(),Gn(a),null;case 19:if(Gr(Yr),k=a.memoizedState,k===null)return Gn(a),null;if(v=(a.flags&128)!==0,F=k.rendering,F===null)if(v)Iu(k,!1);else{if(Cn!==0||o!==null&&(o.flags&128)!==0)for(o=a.child;o!==null;){if(F=al(o),F!==null){for(a.flags|=128,Iu(k,!1),v=F.updateQueue,v!==null&&(a.updateQueue=v,a.flags|=4),a.subtreeFlags=0,v=h,h=a.child;h!==null;)k=h,o=v,k.flags&=14680066,F=k.alternate,F===null?(k.childLanes=0,k.lanes=o,k.child=null,k.subtreeFlags=0,k.memoizedProps=null,k.memoizedState=null,k.updateQueue=null,k.dependencies=null,k.stateNode=null):(k.childLanes=F.childLanes,k.lanes=F.lanes,k.child=F.child,k.subtreeFlags=0,k.deletions=null,k.memoizedProps=F.memoizedProps,k.memoizedState=F.memoizedState,k.updateQueue=F.updateQueue,k.type=F.type,o=F.dependencies,k.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),h=h.sibling;return Mr(Yr,Yr.current&1|2),a.child}o=o.sibling}k.tail!==null&&Mt()>fl&&(a.flags|=128,v=!0,Iu(k,!1),a.lanes=4194304)}else{if(!v)if(o=al(F),o!==null){if(a.flags|=128,v=!0,h=o.updateQueue,h!==null&&(a.updateQueue=h,a.flags|=4),Iu(k,!0),k.tail===null&&k.tailMode==="hidden"&&!F.alternate&&!Wr)return Gn(a),null}else 2*Mt()-k.renderingStartTime>fl&&h!==1073741824&&(a.flags|=128,v=!0,Iu(k,!1),a.lanes=4194304);k.isBackwards?(F.sibling=a.child,a.child=F):(h=k.last,h!==null?h.sibling=F:a.child=F,k.last=F)}return k.tail!==null?(a=k.tail,k.rendering=a,k.tail=a.sibling,k.renderingStartTime=Mt(),a.sibling=null,h=Yr.current,Mr(Yr,v?h&1|2:h&1),a):(Gn(a),null);case 22:case 23:return Sp(),v=a.memoizedState!==null,o!==null&&o.memoizedState!==null!==v&&(a.flags|=8192),v&&(a.mode&1)!==0?(Vs&1073741824)!==0&&(Gn(a),a.subtreeFlags&6&&(a.flags|=8192)):Gn(a),null;case 24:return null;case 25:return null}throw Error(t(156,a.tag))}function O0(o,a){switch(sl(a),a.tag){case 1:return Cs(a.type)&&Dd(),o=a.flags,o&65536?(a.flags=o&-65537|128,a):null;case 3:return va(),Gr(Ss),Gr(Zn),qd(),o=a.flags,(o&65536)!==0&&(o&128)===0?(a.flags=o&-65537|128,a):null;case 5:return Vd(a),null;case 13:if(Gr(Yr),o=a.memoizedState,o!==null&&o.dehydrated!==null){if(a.alternate===null)throw Error(t(340));ri()}return o=a.flags,o&65536?(a.flags=o&-65537|128,a):null;case 19:return Gr(Yr),null;case 4:return va(),null;case 10:return Hd(a.type._context),null;case 22:case 23:return Sp(),null;case 24:return null;default:return null}}var cf=!1,Jr=!1,ps=typeof WeakSet=="function"?WeakSet:Set,nt=null;function bc(o,a){var h=o.ref;if(h!==null)if(typeof h=="function")try{h(null)}catch(v){Zr(o,a,v)}else h.current=null}function Pu(o,a,h){try{h()}catch(v){Zr(o,a,v)}}var Vg=!1;function D0(o,a){if(du=pd,o=Ar(),su(o)){if("selectionStart"in o)var h={start:o.selectionStart,end:o.selectionEnd};else e:{h=(h=o.ownerDocument)&&h.defaultView||window;var v=h.getSelection&&h.getSelection();if(v&&v.rangeCount!==0){h=v.anchorNode;var _=v.anchorOffset,k=v.focusNode;v=v.focusOffset;try{h.nodeType,k.nodeType}catch{h=null;break e}var F=0,W=-1,Q=-1,ve=0,Pe=0,je=o,Ie=null;t:for(;;){for(var Xe;je!==h||_!==0&&je.nodeType!==3||(W=F+_),je!==k||v!==0&&je.nodeType!==3||(Q=F+v),je.nodeType===3&&(F+=je.nodeValue.length),(Xe=je.firstChild)!==null;)Ie=je,je=Xe;for(;;){if(je===o)break t;if(Ie===h&&++ve===_&&(W=F),Ie===k&&++Pe===v&&(Q=F),(Xe=je.nextSibling)!==null)break;je=Ie,Ie=je.parentNode}je=Xe}h=W===-1||Q===-1?null:{start:W,end:Q}}else h=null}h=h||{start:0,end:0}}else h=null;for(el={focusedElem:o,selectionRange:h},pd=!1,nt=a;nt!==null;)if(a=nt,o=a.child,(a.subtreeFlags&1028)!==0&&o!==null)o.return=a,nt=o;else for(;nt!==null;){a=nt;try{var at=a.alternate;if((a.flags&1024)!==0)switch(a.tag){case 0:case 11:case 15:break;case 1:if(at!==null){var ct=at.memoizedProps,fn=at.memoizedState,fe=a.stateNode,re=fe.getSnapshotBeforeUpdate(a.elementType===a.type?ct:po(a.type,ct),fn);fe.__reactInternalSnapshotBeforeUpdate=re}break;case 3:var he=a.stateNode.containerInfo;he.nodeType===1?he.textContent="":he.nodeType===9&&he.documentElement&&he.removeChild(he.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(De){Zr(a,a.return,De)}if(o=a.sibling,o!==null){o.return=a.return,nt=o;break}nt=a.return}return at=Vg,Vg=!1,at}function $i(o,a,h){var v=a.updateQueue;if(v=v!==null?v.lastEffect:null,v!==null){var _=v=v.next;do{if((_.tag&o)===o){var k=_.destroy;_.destroy=void 0,k!==void 0&&Pu(a,h,k)}_=_.next}while(_!==v)}}function Fu(o,a){if(a=a.updateQueue,a=a!==null?a.lastEffect:null,a!==null){var h=a=a.next;do{if((h.tag&o)===o){var v=h.create;h.destroy=v()}h=h.next}while(h!==a)}}function uf(o){var a=o.ref;if(a!==null){var h=o.stateNode;switch(o.tag){case 5:o=h;break;default:o=h}typeof a=="function"?a(o):a.current=o}}function qg(o){var a=o.alternate;a!==null&&(o.alternate=null,qg(a)),o.child=null,o.deletions=null,o.sibling=null,o.tag===5&&(a=o.stateNode,a!==null&&(delete a[Xo],delete a[fa],delete a[jd],delete a[O],delete a[ic])),o.stateNode=null,o.return=null,o.dependencies=null,o.memoizedProps=null,o.memoizedState=null,o.pendingProps=null,o.stateNode=null,o.updateQueue=null}function Kg(o){return o.tag===5||o.tag===3||o.tag===4}function Yg(o){e:for(;;){for(;o.sibling===null;){if(o.return===null||Kg(o.return))return null;o=o.return}for(o.sibling.return=o.return,o=o.sibling;o.tag!==5&&o.tag!==6&&o.tag!==18;){if(o.flags&2||o.child===null||o.tag===4)continue e;o.child.return=o,o=o.child}if(!(o.flags&2))return o.stateNode}}function hp(o,a,h){var v=o.tag;if(v===5||v===6)o=o.stateNode,a?h.nodeType===8?h.parentNode.insertBefore(o,a):h.insertBefore(o,a):(h.nodeType===8?(a=h.parentNode,a.insertBefore(o,h)):(a=h,a.appendChild(o)),h=h._reactRootContainer,h!=null||a.onclick!==null||(a.onclick=Pd));else if(v!==4&&(o=o.child,o!==null))for(hp(o,a,h),o=o.sibling;o!==null;)hp(o,a,h),o=o.sibling}function df(o,a,h){var v=o.tag;if(v===5||v===6)o=o.stateNode,a?h.insertBefore(o,a):h.appendChild(o);else if(v!==4&&(o=o.child,o!==null))for(df(o,a,h),o=o.sibling;o!==null;)df(o,a,h),o=o.sibling}var Pn=null,Po=!1;function ci(o,a,h){for(h=h.child;h!==null;)pp(o,a,h),h=h.sibling}function pp(o,a,h){if(En&&typeof En.onCommitFiberUnmount=="function")try{En.onCommitFiberUnmount(No,h)}catch{}switch(h.tag){case 5:Jr||bc(h,a);case 6:var v=Pn,_=Po;Pn=null,ci(o,a,h),Pn=v,Po=_,Pn!==null&&(Po?(o=Pn,h=h.stateNode,o.nodeType===8?o.parentNode.removeChild(h):o.removeChild(h)):Pn.removeChild(h.stateNode));break;case 18:Pn!==null&&(Po?(o=Pn,h=h.stateNode,o.nodeType===8?Dh(o.parentNode,h):o.nodeType===1&&Dh(o,h),_r(o)):Dh(Pn,h.stateNode));break;case 4:v=Pn,_=Po,Pn=h.stateNode.containerInfo,Po=!0,ci(o,a,h),Pn=v,Po=_;break;case 0:case 11:case 14:case 15:if(!Jr&&(v=h.updateQueue,v!==null&&(v=v.lastEffect,v!==null))){_=v=v.next;do{var k=_,F=k.destroy;k=k.tag,F!==void 0&&((k&2)!==0||(k&4)!==0)&&Pu(h,a,F),_=_.next}while(_!==v)}ci(o,a,h);break;case 1:if(!Jr&&(bc(h,a),v=h.stateNode,typeof v.componentWillUnmount=="function"))try{v.props=h.memoizedProps,v.state=h.memoizedState,v.componentWillUnmount()}catch(W){Zr(h,a,W)}ci(o,a,h);break;case 21:ci(o,a,h);break;case 22:h.mode&1?(Jr=(v=Jr)||h.memoizedState!==null,ci(o,a,h),Jr=v):ci(o,a,h);break;default:ci(o,a,h)}}function _c(o){var a=o.updateQueue;if(a!==null){o.updateQueue=null;var h=o.stateNode;h===null&&(h=o.stateNode=new ps),a.forEach(function(v){var _=B0.bind(null,o,v);h.has(v)||(h.add(v),v.then(_,_))})}}function Ws(o,a){var h=a.deletions;if(h!==null)for(var v=0;v<h.length;v++){var _=h[v];try{var k=o,F=a,W=F;e:for(;W!==null;){switch(W.tag){case 5:Pn=W.stateNode,Po=!1;break e;case 3:Pn=W.stateNode.containerInfo,Po=!0;break e;case 4:Pn=W.stateNode.containerInfo,Po=!0;break e}W=W.return}if(Pn===null)throw Error(t(160));pp(k,F,_),Pn=null,Po=!1;var Q=_.alternate;Q!==null&&(Q.return=null),_.return=null}catch(ve){Zr(_,a,ve)}}if(a.subtreeFlags&12854)for(a=a.child;a!==null;)mp(a,o),a=a.sibling}function mp(o,a){var h=o.alternate,v=o.flags;switch(o.tag){case 0:case 11:case 14:case 15:if(Ws(a,o),Fo(o),v&4){try{$i(3,o,o.return),Fu(3,o)}catch(ct){Zr(o,o.return,ct)}try{$i(5,o,o.return)}catch(ct){Zr(o,o.return,ct)}}break;case 1:Ws(a,o),Fo(o),v&512&&h!==null&&bc(h,h.return);break;case 5:if(Ws(a,o),Fo(o),v&512&&h!==null&&bc(h,h.return),o.flags&32){var _=o.stateNode;try{tr(_,"")}catch(ct){Zr(o,o.return,ct)}}if(v&4&&(_=o.stateNode,_!=null)){var k=o.memoizedProps,F=h!==null?h.memoizedProps:k,W=o.type,Q=o.updateQueue;if(o.updateQueue=null,Q!==null)try{W==="input"&&k.type==="radio"&&k.name!=null&&zt(_,k),Or(W,F);var ve=Or(W,k);for(F=0;F<Q.length;F+=2){var Pe=Q[F],je=Q[F+1];Pe==="style"?ze(_,je):Pe==="dangerouslySetInnerHTML"?gr(_,je):Pe==="children"?tr(_,je):j(_,Pe,je,ve)}switch(W){case"input":yt(_,k);break;case"textarea":Ae(_,k);break;case"select":var Ie=_._wrapperState.wasMultiple;_._wrapperState.wasMultiple=!!k.multiple;var Xe=k.value;Xe!=null?st(_,!!k.multiple,Xe,!1):Ie!==!!k.multiple&&(k.defaultValue!=null?st(_,!!k.multiple,k.defaultValue,!0):st(_,!!k.multiple,k.multiple?[]:"",!1))}_[fa]=k}catch(ct){Zr(o,o.return,ct)}}break;case 6:if(Ws(a,o),Fo(o),v&4){if(o.stateNode===null)throw Error(t(162));_=o.stateNode,k=o.memoizedProps;try{_.nodeValue=k}catch(ct){Zr(o,o.return,ct)}}break;case 3:if(Ws(a,o),Fo(o),v&4&&h!==null&&h.memoizedState.isDehydrated)try{_r(a.containerInfo)}catch(ct){Zr(o,o.return,ct)}break;case 4:Ws(a,o),Fo(o);break;case 13:Ws(a,o),Fo(o),_=o.child,_.flags&8192&&(k=_.memoizedState!==null,_.stateNode.isHidden=k,!k||_.alternate!==null&&_.alternate.memoizedState!==null||(yp=Mt())),v&4&&_c(o);break;case 22:if(Pe=h!==null&&h.memoizedState!==null,o.mode&1?(Jr=(ve=Jr)||Pe,Ws(a,o),Jr=ve):Ws(a,o),Fo(o),v&8192){if(ve=o.memoizedState!==null,(o.stateNode.isHidden=ve)&&!Pe&&(o.mode&1)!==0)for(nt=o,Pe=o.child;Pe!==null;){for(je=nt=Pe;nt!==null;){switch(Ie=nt,Xe=Ie.child,Ie.tag){case 0:case 11:case 14:case 15:$i(4,Ie,Ie.return);break;case 1:bc(Ie,Ie.return);var at=Ie.stateNode;if(typeof at.componentWillUnmount=="function"){v=Ie,h=Ie.return;try{a=v,at.props=a.memoizedProps,at.state=a.memoizedState,at.componentWillUnmount()}catch(ct){Zr(v,h,ct)}}break;case 5:bc(Ie,Ie.return);break;case 22:if(Ie.memoizedState!==null){wa(je);continue}}Xe!==null?(Xe.return=Ie,nt=Xe):wa(je)}Pe=Pe.sibling}e:for(Pe=null,je=o;;){if(je.tag===5){if(Pe===null){Pe=je;try{_=je.stateNode,ve?(k=_.style,typeof k.setProperty=="function"?k.setProperty("display","none","important"):k.display="none"):(W=je.stateNode,Q=je.memoizedProps.style,F=Q!=null&&Q.hasOwnProperty("display")?Q.display:null,W.style.display=Nt("display",F))}catch(ct){Zr(o,o.return,ct)}}}else if(je.tag===6){if(Pe===null)try{je.stateNode.nodeValue=ve?"":je.memoizedProps}catch(ct){Zr(o,o.return,ct)}}else if((je.tag!==22&&je.tag!==23||je.memoizedState===null||je===o)&&je.child!==null){je.child.return=je,je=je.child;continue}if(je===o)break e;for(;je.sibling===null;){if(je.return===null||je.return===o)break e;Pe===je&&(Pe=null),je=je.return}Pe===je&&(Pe=null),je.sibling.return=je.return,je=je.sibling}}break;case 19:Ws(a,o),Fo(o),v&4&&_c(o);break;case 21:break;default:Ws(a,o),Fo(o)}}function Fo(o){var a=o.flags;if(a&2){try{e:{for(var h=o.return;h!==null;){if(Kg(h)){var v=h;break e}h=h.return}throw Error(t(160))}switch(v.tag){case 5:var _=v.stateNode;v.flags&32&&(tr(_,""),v.flags&=-33);var k=Yg(o);df(o,k,_);break;case 3:case 4:var F=v.stateNode.containerInfo,W=Yg(o);hp(o,W,F);break;default:throw Error(t(161))}}catch(Q){Zr(o,o.return,Q)}o.flags&=-3}a&4096&&(o.flags&=-4097)}function ff(o,a,h){nt=o,gp(o)}function gp(o,a,h){for(var v=(o.mode&1)!==0;nt!==null;){var _=nt,k=_.child;if(_.tag===22&&v){var F=_.memoizedState!==null||cf;if(!F){var W=_.alternate,Q=W!==null&&W.memoizedState!==null||Jr;W=cf;var ve=Jr;if(cf=F,(Jr=Q)&&!ve)for(nt=_;nt!==null;)F=nt,Q=F.child,F.tag===22&&F.memoizedState!==null?Jg(_):Q!==null?(Q.return=F,nt=Q):Jg(_);for(;k!==null;)nt=k,gp(k),k=k.sibling;nt=_,cf=W,Jr=ve}jo(o)}else(_.subtreeFlags&8772)!==0&&k!==null?(k.return=_,nt=k):jo(o)}}function jo(o){for(;nt!==null;){var a=nt;if((a.flags&8772)!==0){var h=a.alternate;try{if((a.flags&8772)!==0)switch(a.tag){case 0:case 11:case 15:Jr||Fu(5,a);break;case 1:var v=a.stateNode;if(a.flags&4&&!Jr)if(h===null)v.componentDidMount();else{var _=a.elementType===a.type?h.memoizedProps:po(a.type,h.memoizedProps);v.componentDidUpdate(_,h.memoizedState,v.__reactInternalSnapshotBeforeUpdate)}var k=a.updateQueue;k!==null&&Hh(a,k,v);break;case 3:var F=a.updateQueue;if(F!==null){if(h=null,a.child!==null)switch(a.child.tag){case 5:h=a.child.stateNode;break;case 1:h=a.child.stateNode}Hh(a,F,h)}break;case 5:var W=a.stateNode;if(h===null&&a.flags&4){h=W;var Q=a.memoizedProps;switch(a.type){case"button":case"input":case"select":case"textarea":Q.autoFocus&&h.focus();break;case"img":Q.src&&(h.src=Q.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(a.memoizedState===null){var ve=a.alternate;if(ve!==null){var Pe=ve.memoizedState;if(Pe!==null){var je=Pe.dehydrated;je!==null&&_r(je)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Jr||a.flags&512&&uf(a)}catch(Ie){Zr(a,a.return,Ie)}}if(a===o){nt=null;break}if(h=a.sibling,h!==null){h.return=a.return,nt=h;break}nt=a.return}}function wa(o){for(;nt!==null;){var a=nt;if(a===o){nt=null;break}var h=a.sibling;if(h!==null){h.return=a.return,nt=h;break}nt=a.return}}function Jg(o){for(;nt!==null;){var a=nt;try{switch(a.tag){case 0:case 11:case 15:var h=a.return;try{Fu(4,a)}catch(Q){Zr(a,h,Q)}break;case 1:var v=a.stateNode;if(typeof v.componentDidMount=="function"){var _=a.return;try{v.componentDidMount()}catch(Q){Zr(a,_,Q)}}var k=a.return;try{uf(a)}catch(Q){Zr(a,k,Q)}break;case 5:var F=a.return;try{uf(a)}catch(Q){Zr(a,F,Q)}}}catch(Q){Zr(a,a.return,Q)}if(a===o){nt=null;break}var W=a.sibling;if(W!==null){W.return=a.return,nt=W;break}nt=a.return}}var Xg=Math.ceil,hf=P.ReactCurrentDispatcher,vp=P.ReactCurrentOwner,mo=P.ReactCurrentBatchConfig,pr=0,Fn=null,xn=null,Wn=0,Vs=0,Ec=Es(0),Cn=0,ju=null,ba=0,Ou=0,pf=0,Du=null,Ts=null,yp=0,fl=1/0,Ui=null,mf=!1,xp=null,_a=null,gf=!1,Ea=null,ms=0,Lu=0,wp=null,vf=-1,Mu=0;function gs(){return(pr&6)!==0?Mt():vf!==-1?vf:vf=Mt()}function Sa(o){return(o.mode&1)===0?1:(pr&2)!==0&&Wn!==0?Wn&-Wn:Ag.transition!==null?(Mu===0&&(Mu=Va()),Mu):(o=fr,o!==0||(o=window.event,o=o===void 0?16:rg(o.type)),o)}function Oo(o,a,h,v){if(50<Lu)throw Lu=0,wp=null,Error(t(185));oa(o,h,v),((pr&2)===0||o!==Fn)&&(o===Fn&&((pr&2)===0&&(Ou|=h),Cn===4&&Ca(o,Wn)),Rs(o,v),h===1&&pr===0&&(a.mode&1)===0&&(fl=Mt()+500,Ld&&pa()))}function Rs(o,a){var h=o.callbackNode;vh(o,a);var v=Si(o,o===Fn?Wn:0);if(v===0)h!==null&&Oe(h),o.callbackNode=null,o.callbackPriority=0;else if(a=v&-v,o.callbackPriority!==a){if(h!=null&&Oe(h),a===1)o.tag===0?tl(Qg.bind(null,o)):Ng(Qg.bind(null,o)),Fd(function(){(pr&6)===0&&pa()}),h=null;else{switch(Ci(v)){case 1:h=on;break;case 4:h=ls;break;case 16:h=In;break;case 536870912:h=qr;break;default:h=In}h=ov(h,yf.bind(null,o))}o.callbackPriority=a,o.callbackNode=h}}function yf(o,a){if(vf=-1,Mu=0,(pr&6)!==0)throw Error(t(327));var h=o.callbackNode;if(Sc()&&o.callbackNode!==h)return null;var v=Si(o,o===Fn?Wn:0);if(v===0)return null;if((v&30)!==0||(v&o.expiredLanes)!==0||a)a=xf(o,v);else{a=v;var _=pr;pr|=2;var k=ev();(Fn!==o||Wn!==a)&&(Ui=null,fl=Mt()+500,pl(o,a));do try{$0();break}catch(W){Zg(o,W)}while(!0);Pi(),hf.current=k,pr=_,xn!==null?a=0:(Fn=null,Wn=0,a=Cn)}if(a!==0){if(a===2&&(_=Ko(o),_!==0&&(v=_,a=bp(o,_))),a===1)throw h=ju,pl(o,0),Ca(o,v),Rs(o,Mt()),h;if(a===6)Ca(o,v);else{if(_=o.current.alternate,(v&30)===0&&!L0(_)&&(a=xf(o,v),a===2&&(k=Ko(o),k!==0&&(v=k,a=bp(o,k))),a===1))throw h=ju,pl(o,0),Ca(o,v),Rs(o,Mt()),h;switch(o.finishedWork=_,o.finishedLanes=v,a){case 0:case 1:throw Error(t(345));case 2:ml(o,Ts,Ui);break;case 3:if(Ca(o,v),(v&130023424)===v&&(a=yp+500-Mt(),10<a)){if(Si(o,0)!==0)break;if(_=o.suspendedLanes,(_&v)!==v){gs(),o.pingedLanes|=o.suspendedLanes&_;break}o.timeoutHandle=ua(ml.bind(null,o,Ts,Ui),a);break}ml(o,Ts,Ui);break;case 4:if(Ca(o,v),(v&4194240)===v)break;for(a=o.eventTimes,_=-1;0<v;){var F=31-Un(v);k=1<<F,F=a[F],F>_&&(_=F),v&=~k}if(v=_,v=Mt()-v,v=(120>v?120:480>v?480:1080>v?1080:1920>v?1920:3e3>v?3e3:4320>v?4320:1960*Xg(v/1960))-v,10<v){o.timeoutHandle=ua(ml.bind(null,o,Ts,Ui),v);break}ml(o,Ts,Ui);break;case 5:ml(o,Ts,Ui);break;default:throw Error(t(329))}}}return Rs(o,Mt()),o.callbackNode===h?yf.bind(null,o):null}function bp(o,a){var h=Du;return o.current.memoizedState.isDehydrated&&(pl(o,a).flags|=256),o=xf(o,a),o!==2&&(a=Ts,Ts=h,a!==null&&_p(a)),o}function _p(o){Ts===null?Ts=o:Ts.push.apply(Ts,o)}function L0(o){for(var a=o;;){if(a.flags&16384){var h=a.updateQueue;if(h!==null&&(h=h.stores,h!==null))for(var v=0;v<h.length;v++){var _=h[v],k=_.getSnapshot;_=_.value;try{if(!ge(k(),_))return!1}catch{return!1}}}if(h=a.child,a.subtreeFlags&16384&&h!==null)h.return=a,a=h;else{if(a===o)break;for(;a.sibling===null;){if(a.return===null||a.return===o)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function Ca(o,a){for(a&=~pf,a&=~Ou,o.suspendedLanes|=a,o.pingedLanes&=~a,o=o.expirationTimes;0<a;){var h=31-Un(a),v=1<<h;o[h]=-1,a&=~v}}function Qg(o){if((pr&6)!==0)throw Error(t(327));Sc();var a=Si(o,0);if((a&1)===0)return Rs(o,Mt()),null;var h=xf(o,a);if(o.tag!==0&&h===2){var v=Ko(o);v!==0&&(a=v,h=bp(o,v))}if(h===1)throw h=ju,pl(o,0),Ca(o,a),Rs(o,Mt()),h;if(h===6)throw Error(t(345));return o.finishedWork=o.current.alternate,o.finishedLanes=a,ml(o,Ts,Ui),Rs(o,Mt()),null}function Ep(o,a){var h=pr;pr|=1;try{return o(a)}finally{pr=h,pr===0&&(fl=Mt()+500,Ld&&pa())}}function hl(o){Ea!==null&&Ea.tag===0&&(pr&6)===0&&Sc();var a=pr;pr|=1;var h=mo.transition,v=fr;try{if(mo.transition=null,fr=1,o)return o()}finally{fr=v,mo.transition=h,pr=a,(pr&6)===0&&pa()}}function Sp(){Vs=Ec.current,Gr(Ec)}function pl(o,a){o.finishedWork=null,o.finishedLanes=0;var h=o.timeoutHandle;if(h!==-1&&(o.timeoutHandle=-1,hu(h)),xn!==null)for(h=xn.return;h!==null;){var v=h;switch(sl(v),v.tag){case 1:v=v.type.childContextTypes,v!=null&&Dd();break;case 3:va(),Gr(Ss),Gr(Zn),qd();break;case 5:Vd(v);break;case 4:va();break;case 13:Gr(Yr);break;case 19:Gr(Yr);break;case 10:Hd(v.type._context);break;case 22:case 23:Sp()}h=h.return}if(Fn=o,xn=o=Do(o.current,null),Wn=Vs=a,Cn=0,ju=null,pf=Ou=ba=0,Ts=Du=null,il!==null){for(a=0;a<il.length;a++)if(h=il[a],v=h.interleaved,v!==null){h.interleaved=null;var _=v.next,k=h.pending;if(k!==null){var F=k.next;k.next=_,v.next=F}h.pending=v}il=null}return o}function Zg(o,a){do{var h=xn;try{if(Pi(),wu.current=Zd,hc){for(var v=Qr.memoizedState;v!==null;){var _=v.queue;_!==null&&(_.pending=null),v=v.next}hc=!1}if(ya=0,Sn=dn=Qr=null,bu=!1,ll=0,vp.current=null,h===null||h.return===null){Cn=1,ju=a,xn=null;break}e:{var k=o,F=h.return,W=h,Q=a;if(a=Wn,W.flags|=32768,Q!==null&&typeof Q=="object"&&typeof Q.then=="function"){var ve=Q,Pe=W,je=Pe.tag;if((Pe.mode&1)===0&&(je===0||je===11||je===15)){var Ie=Pe.alternate;Ie?(Pe.updateQueue=Ie.updateQueue,Pe.memoizedState=Ie.memoizedState,Pe.lanes=Ie.lanes):(Pe.updateQueue=null,Pe.memoizedState=null)}var Xe=zg(F);if(Xe!==null){Xe.flags&=-257,sp(Xe,F,W,k,a),Xe.mode&1&&ku(k,ve,a),a=Xe,Q=ve;var at=a.updateQueue;if(at===null){var ct=new Set;ct.add(Q),a.updateQueue=ct}else at.add(Q);break e}else{if((a&1)===0){ku(k,ve,a),Cp();break e}Q=Error(t(426))}}else if(Wr&&W.mode&1){var fn=zg(F);if(fn!==null){(fn.flags&65536)===0&&(fn.flags|=256),sp(fn,F,W,k,a),ni(dl(Q,W));break e}}k=Q=dl(Q,W),Cn!==4&&(Cn=2),Du===null?Du=[k]:Du.push(k),k=F;do{switch(k.tag){case 3:k.flags|=65536,a&=-a,k.lanes|=a;var fe=Cu(k,Q,a);Fg(k,fe);break e;case 1:W=Q;var re=k.type,he=k.stateNode;if((k.flags&128)===0&&(typeof re.getDerivedStateFromError=="function"||he!==null&&typeof he.componentDidCatch=="function"&&(_a===null||!_a.has(he)))){k.flags|=65536,a&=-a,k.lanes|=a;var De=sf(k,W,a);Fg(k,De);break e}}k=k.return}while(k!==null)}rv(h)}catch(ft){a=ft,xn===h&&h!==null&&(xn=h=h.return);continue}break}while(!0)}function ev(){var o=hf.current;return hf.current=Zd,o===null?Zd:o}function Cp(){(Cn===0||Cn===3||Cn===2)&&(Cn=4),Fn===null||(ba&268435455)===0&&(Ou&268435455)===0||Ca(Fn,Wn)}function xf(o,a){var h=pr;pr|=2;var v=ev();(Fn!==o||Wn!==a)&&(Ui=null,pl(o,a));do try{M0();break}catch(_){Zg(o,_)}while(!0);if(Pi(),pr=h,hf.current=v,xn!==null)throw Error(t(261));return Fn=null,Wn=0,Cn}function M0(){for(;xn!==null;)tv(xn)}function $0(){for(;xn!==null&&!tt();)tv(xn)}function tv(o){var a=sv(o.alternate,o,Vs);o.memoizedProps=o.pendingProps,a===null?rv(o):xn=a,vp.current=null}function rv(o){var a=o;do{var h=a.alternate;if(o=a.return,(a.flags&32768)===0){if(h=j0(h,a,Vs),h!==null){xn=h;return}}else{if(h=O0(h,a),h!==null){h.flags&=32767,xn=h;return}if(o!==null)o.flags|=32768,o.subtreeFlags=0,o.deletions=null;else{Cn=6,xn=null;return}}if(a=a.sibling,a!==null){xn=a;return}xn=a=o}while(a!==null);Cn===0&&(Cn=5)}function ml(o,a,h){var v=fr,_=mo.transition;try{mo.transition=null,fr=1,U0(o,a,h,v)}finally{mo.transition=_,fr=v}return null}function U0(o,a,h,v){do Sc();while(Ea!==null);if((pr&6)!==0)throw Error(t(327));h=o.finishedWork;var _=o.finishedLanes;if(h===null)return null;if(o.finishedWork=null,o.finishedLanes=0,h===o.current)throw Error(t(177));o.callbackNode=null,o.callbackPriority=0;var k=h.lanes|h.childLanes;if(fd(o,k),o===Fn&&(xn=Fn=null,Wn=0),(h.subtreeFlags&2064)===0&&(h.flags&2064)===0||gf||(gf=!0,ov(In,function(){return Sc(),null})),k=(h.flags&15990)!==0,(h.subtreeFlags&15990)!==0||k){k=mo.transition,mo.transition=null;var F=fr;fr=1;var W=pr;pr|=4,vp.current=null,D0(o,h),mp(h,o),A0(el),pd=!!du,el=du=null,o.current=h,ff(h),br(),pr=W,fr=F,mo.transition=k}else o.current=h;if(gf&&(gf=!1,Ea=o,ms=_),k=o.pendingLanes,k===0&&(_a=null),ra(h.stateNode),Rs(o,Mt()),a!==null)for(v=o.onRecoverableError,h=0;h<a.length;h++)_=a[h],v(_.value,{componentStack:_.stack,digest:_.digest});if(mf)throw mf=!1,o=xp,xp=null,o;return(ms&1)!==0&&o.tag!==0&&Sc(),k=o.pendingLanes,(k&1)!==0?o===wp?Lu++:(Lu=0,wp=o):Lu=0,pa(),null}function Sc(){if(Ea!==null){var o=Ci(ms),a=mo.transition,h=fr;try{if(mo.transition=null,fr=16>o?16:o,Ea===null)var v=!1;else{if(o=Ea,Ea=null,ms=0,(pr&6)!==0)throw Error(t(331));var _=pr;for(pr|=4,nt=o.current;nt!==null;){var k=nt,F=k.child;if((nt.flags&16)!==0){var W=k.deletions;if(W!==null){for(var Q=0;Q<W.length;Q++){var ve=W[Q];for(nt=ve;nt!==null;){var Pe=nt;switch(Pe.tag){case 0:case 11:case 15:$i(8,Pe,k)}var je=Pe.child;if(je!==null)je.return=Pe,nt=je;else for(;nt!==null;){Pe=nt;var Ie=Pe.sibling,Xe=Pe.return;if(qg(Pe),Pe===ve){nt=null;break}if(Ie!==null){Ie.return=Xe,nt=Ie;break}nt=Xe}}}var at=k.alternate;if(at!==null){var ct=at.child;if(ct!==null){at.child=null;do{var fn=ct.sibling;ct.sibling=null,ct=fn}while(ct!==null)}}nt=k}}if((k.subtreeFlags&2064)!==0&&F!==null)F.return=k,nt=F;else e:for(;nt!==null;){if(k=nt,(k.flags&2048)!==0)switch(k.tag){case 0:case 11:case 15:$i(9,k,k.return)}var fe=k.sibling;if(fe!==null){fe.return=k.return,nt=fe;break e}nt=k.return}}var re=o.current;for(nt=re;nt!==null;){F=nt;var he=F.child;if((F.subtreeFlags&2064)!==0&&he!==null)he.return=F,nt=he;else e:for(F=re;nt!==null;){if(W=nt,(W.flags&2048)!==0)try{switch(W.tag){case 0:case 11:case 15:Fu(9,W)}}catch(ft){Zr(W,W.return,ft)}if(W===F){nt=null;break e}var De=W.sibling;if(De!==null){De.return=W.return,nt=De;break e}nt=W.return}}if(pr=_,pa(),En&&typeof En.onPostCommitFiberRoot=="function")try{En.onPostCommitFiberRoot(No,o)}catch{}v=!0}return v}finally{fr=h,mo.transition=a}}return!1}function wf(o,a,h){a=dl(h,a),a=Cu(o,a,1),o=fo(o,a,1),a=gs(),o!==null&&(oa(o,1,a),Rs(o,a))}function Zr(o,a,h){if(o.tag===3)wf(o,o,h);else for(;a!==null;){if(a.tag===3){wf(a,o,h);break}else if(a.tag===1){var v=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof v.componentDidCatch=="function"&&(_a===null||!_a.has(v))){o=dl(h,o),o=sf(a,o,1),a=fo(a,o,1),o=gs(),a!==null&&(oa(a,1,o),Rs(a,o));break}}a=a.return}}function z0(o,a,h){var v=o.pingCache;v!==null&&v.delete(a),a=gs(),o.pingedLanes|=o.suspendedLanes&h,Fn===o&&(Wn&h)===h&&(Cn===4||Cn===3&&(Wn&130023424)===Wn&&500>Mt()-yp?pl(o,0):pf|=h),Rs(o,a)}function nv(o,a){a===0&&((o.mode&1)===0?a=1:(a=Bl,Bl<<=1,(Bl&130023424)===0&&(Bl=4194304)));var h=gs();o=Fi(o,a),o!==null&&(oa(o,a,h),Rs(o,h))}function H0(o){var a=o.memoizedState,h=0;a!==null&&(h=a.retryLane),nv(o,h)}function B0(o,a){var h=0;switch(o.tag){case 13:var v=o.stateNode,_=o.memoizedState;_!==null&&(h=_.retryLane);break;case 19:v=o.stateNode;break;default:throw Error(t(314))}v!==null&&v.delete(a),nv(o,h)}var sv;sv=function(o,a,h){if(o!==null)if(o.memoizedProps!==a.pendingProps||Ss.current)hs=!0;else{if((o.lanes&h)===0&&(a.flags&128)===0)return hs=!1,Gg(o,a,h);hs=(o.flags&131072)!==0}else hs=!1,Wr&&(a.flags&1048576)!==0&&Tg(a,$d,a.index);switch(a.lanes=0,a.tag){case 2:var v=a.type;lf(o,a),o=a.pendingProps;var _=lc(a,Zn.current);ga(a,h),_=cl(null,a,v,o,_,h);var k=Kd();return a.flags|=1,typeof _=="object"&&_!==null&&typeof _.render=="function"&&_.$$typeof===void 0?(a.tag=1,a.memoizedState=null,a.updateQueue=null,Cs(v)?(k=!0,io(a)):k=!1,a.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,Gd(a),_.updater=rf,a.stateNode=_,_._reactInternals=a,np(a,v,o,h),a=up(null,a,v,!0,k,h)):(a.tag=0,Wr&&k&&pu(a),Hn(null,a,_,h),a=a.child),a;case 16:v=a.elementType;e:{switch(lf(o,a),o=a.pendingProps,_=v._init,v=_(v._payload),a.type=v,_=a.tag=W0(v),o=po(v,o),_){case 0:a=lp(null,a,v,o,h);break e;case 1:a=cp(null,a,v,o,h);break e;case 11:a=Hg(null,a,v,o,h);break e;case 14:a=op(null,a,v,po(v.type,o),h);break e}throw Error(t(306,v,""))}return a;case 0:return v=a.type,_=a.pendingProps,_=a.elementType===v?_:po(v,_),lp(o,a,v,_,h);case 1:return v=a.type,_=a.pendingProps,_=a.elementType===v?_:po(v,_),cp(o,a,v,_,h);case 3:e:{if(Bg(a),o===null)throw Error(t(387));v=a.pendingProps,k=a.memoizedState,_=k.element,Pg(o,a),dc(a,v,null,h);var F=a.memoizedState;if(v=F.element,k.isDehydrated)if(k={element:v,isDehydrated:!1,cache:F.cache,pendingSuspenseBoundaries:F.pendingSuspenseBoundaries,transitions:F.transitions},a.updateQueue.baseState=k,a.memoizedState=k,a.flags&256){_=dl(Error(t(423)),a),a=li(o,a,v,h,_);break e}else if(v!==_){_=dl(Error(t(424)),a),a=li(o,a,v,h,_);break e}else for(Bs=da(a.stateNode.containerInfo.firstChild),ts=a,Wr=!0,Ro=null,h=zd(a,null,v,h),a.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling;else{if(ri(),v===_){a=Io(o,a,h);break e}Hn(o,a,v,h)}a=a.child}return a;case 5:return Gh(a),o===null&&ks(a),v=a.type,_=a.pendingProps,k=o!==null?o.memoizedProps:null,F=_.children,fu(v,_)?F=null:k!==null&&fu(v,k)&&(a.flags|=32),ap(o,a),Hn(o,a,F,h),a.child;case 6:return o===null&&ks(a),null;case 13:return af(o,a,h);case 4:return Bh(a,a.stateNode.containerInfo),v=a.pendingProps,o===null?a.child=an(a,null,v,h):Hn(o,a,v,h),a.child;case 11:return v=a.type,_=a.pendingProps,_=a.elementType===v?_:po(v,_),Hg(o,a,v,_,h);case 7:return Hn(o,a,a.pendingProps,h),a.child;case 8:return Hn(o,a,a.pendingProps.children,h),a.child;case 12:return Hn(o,a,a.pendingProps.children,h),a.child;case 10:e:{if(v=a.type._context,_=a.pendingProps,k=a.memoizedProps,F=_.value,Mr(vu,v._currentValue),v._currentValue=F,k!==null)if(ge(k.value,F)){if(k.children===_.children&&!Ss.current){a=Io(o,a,h);break e}}else for(k=a.child,k!==null&&(k.return=a);k!==null;){var W=k.dependencies;if(W!==null){F=k.child;for(var Q=W.firstContext;Q!==null;){if(Q.context===v){if(k.tag===1){Q=ji(-1,h&-h),Q.tag=2;var ve=k.updateQueue;if(ve!==null){ve=ve.shared;var Pe=ve.pending;Pe===null?Q.next=Q:(Q.next=Pe.next,Pe.next=Q),ve.pending=Q}}k.lanes|=h,Q=k.alternate,Q!==null&&(Q.lanes|=h),zn(k.return,h,a),W.lanes|=h;break}Q=Q.next}}else if(k.tag===10)F=k.type===a.type?null:k.child;else if(k.tag===18){if(F=k.return,F===null)throw Error(t(341));F.lanes|=h,W=F.alternate,W!==null&&(W.lanes|=h),zn(F,h,a),F=k.sibling}else F=k.child;if(F!==null)F.return=k;else for(F=k;F!==null;){if(F===a){F=null;break}if(k=F.sibling,k!==null){k.return=F.return,F=k;break}F=F.return}k=F}Hn(o,a,_.children,h),a=a.child}return a;case 9:return _=a.type,v=a.pendingProps.children,ga(a,h),_=co(_),v=v(_),a.flags|=1,Hn(o,a,v,h),a.child;case 14:return v=a.type,_=po(v,a.pendingProps),_=po(v.type,_),op(o,a,v,_,h);case 15:return ai(o,a,a.type,a.pendingProps,h);case 17:return v=a.type,_=a.pendingProps,_=a.elementType===v?_:po(v,_),lf(o,a),a.tag=1,Cs(v)?(o=!0,io(a)):o=!1,ga(a,h),ul(a,v,_),np(a,v,_,h),up(null,a,v,!0,o,h);case 19:return xa(o,a,h);case 22:return ip(o,a,h)}throw Error(t(156,a.tag))};function ov(o,a){return Z(o,a)}function G0(o,a,h,v){this.tag=o,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=v,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function go(o,a,h,v){return new G0(o,a,h,v)}function bf(o){return o=o.prototype,!(!o||!o.isReactComponent)}function W0(o){if(typeof o=="function")return bf(o)?1:0;if(o!=null){if(o=o.$$typeof,o===de)return 11;if(o===se)return 14}return 2}function Do(o,a){var h=o.alternate;return h===null?(h=go(o.tag,a,o.key,o.mode),h.elementType=o.elementType,h.type=o.type,h.stateNode=o.stateNode,h.alternate=o,o.alternate=h):(h.pendingProps=a,h.type=o.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=o.flags&14680064,h.childLanes=o.childLanes,h.lanes=o.lanes,h.child=o.child,h.memoizedProps=o.memoizedProps,h.memoizedState=o.memoizedState,h.updateQueue=o.updateQueue,a=o.dependencies,h.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},h.sibling=o.sibling,h.index=o.index,h.ref=o.ref,h}function _f(o,a,h,v,_,k){var F=2;if(v=o,typeof o=="function")bf(o)&&(F=1);else if(typeof o=="string")F=5;else e:switch(o){case U:return gl(h.children,_,k,a);case V:F=8,_|=8;break;case Y:return o=go(12,h,a,_|2),o.elementType=Y,o.lanes=k,o;case we:return o=go(13,h,a,_),o.elementType=we,o.lanes=k,o;case le:return o=go(19,h,a,_),o.elementType=le,o.lanes=k,o;case te:return Ef(h,_,k,a);default:if(typeof o=="object"&&o!==null)switch(o.$$typeof){case ce:F=10;break e;case X:F=9;break e;case de:F=11;break e;case se:F=14;break e;case me:F=16,v=null;break e}throw Error(t(130,o==null?o:typeof o,""))}return a=go(F,h,a,_),a.elementType=o,a.type=v,a.lanes=k,a}function gl(o,a,h,v){return o=go(7,o,v,a),o.lanes=h,o}function Ef(o,a,h,v){return o=go(22,o,v,a),o.elementType=te,o.lanes=h,o.stateNode={isHidden:!1},o}function kp(o,a,h){return o=go(6,o,null,a),o.lanes=h,o}function Np(o,a,h){return a=go(4,o.children!==null?o.children:[],o.key,a),a.lanes=h,a.stateNode={containerInfo:o.containerInfo,pendingChildren:null,implementation:o.implementation},a}function V0(o,a,h,v,_){this.tag=a,this.containerInfo=o,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=qa(0),this.expirationTimes=qa(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=qa(0),this.identifierPrefix=v,this.onRecoverableError=_,this.mutableSourceEagerHydrationData=null}function Tp(o,a,h,v,_,k,F,W,Q){return o=new V0(o,a,h,W,Q),a===1?(a=1,k===!0&&(a|=8)):a=0,k=go(3,null,null,a),o.current=k,k.stateNode=o,k.memoizedState={element:v,isDehydrated:h,cache:null,transitions:null,pendingSuspenseBoundaries:null},Gd(k),o}function q0(o,a,h){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:B,key:v==null?null:""+v,children:o,containerInfo:a,implementation:h}}function iv(o){if(!o)return ha;o=o._reactInternals;e:{if(no(o)!==o||o.tag!==1)throw Error(t(170));var a=o;do{switch(a.tag){case 3:a=a.stateNode.context;break e;case 1:if(Cs(a.type)){a=a.stateNode.__reactInternalMemoizedMergedChildContext;break e}}a=a.return}while(a!==null);throw Error(t(171))}if(o.tag===1){var h=o.type;if(Cs(h))return Cg(o,h,a)}return a}function av(o,a,h,v,_,k,F,W,Q){return o=Tp(h,v,!0,o,_,k,F,W,Q),o.context=iv(null),h=o.current,v=gs(),_=Sa(h),k=ji(v,_),k.callback=a??null,fo(h,k,_),o.current.lanes=_,oa(o,_,v),Rs(o,v),o}function Sf(o,a,h,v){var _=a.current,k=gs(),F=Sa(_);return h=iv(h),a.context===null?a.context=h:a.pendingContext=h,a=ji(k,F),a.payload={element:o},v=v===void 0?null:v,v!==null&&(a.callback=v),o=fo(_,a,F),o!==null&&(Oo(o,_,F,k),Wd(o,_,F)),F}function Cf(o){if(o=o.current,!o.child)return null;switch(o.child.tag){case 5:return o.child.stateNode;default:return o.child.stateNode}}function lv(o,a){if(o=o.memoizedState,o!==null&&o.dehydrated!==null){var h=o.retryLane;o.retryLane=h!==0&&h<a?h:a}}function Rp(o,a){lv(o,a),(o=o.alternate)&&lv(o,a)}function K0(){return null}var cv=typeof reportError=="function"?reportError:function(o){console.error(o)};function kf(o){this._internalRoot=o}$u.prototype.render=kf.prototype.render=function(o){var a=this._internalRoot;if(a===null)throw Error(t(409));Sf(o,a,null,null)},$u.prototype.unmount=kf.prototype.unmount=function(){var o=this._internalRoot;if(o!==null){this._internalRoot=null;var a=o.containerInfo;hl(function(){Sf(null,o,null,null)}),a[Hs]=null}};function $u(o){this._internalRoot=o}$u.prototype.unstable_scheduleHydration=function(o){if(o){var a=Wl();o={blockedOn:null,target:o,priority:a};for(var h=0;h<gn.length&&a!==0&&a<gn[h].priority;h++);gn.splice(h,0,o),h===0&&eg(o)}};function Ap(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11)}function Nf(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11&&(o.nodeType!==8||o.nodeValue!==" react-mount-point-unstable "))}function uv(){}function Y0(o,a,h,v,_){if(_){if(typeof v=="function"){var k=v;v=function(){var ve=Cf(F);k.call(ve)}}var F=av(a,v,o,0,null,!1,!1,"",uv);return o._reactRootContainer=F,o[Hs]=F.current,ca(o.nodeType===8?o.parentNode:o),hl(),F}for(;_=o.lastChild;)o.removeChild(_);if(typeof v=="function"){var W=v;v=function(){var ve=Cf(Q);W.call(ve)}}var Q=Tp(o,0,!1,null,null,!1,!1,"",uv);return o._reactRootContainer=Q,o[Hs]=Q.current,ca(o.nodeType===8?o.parentNode:o),hl(function(){Sf(a,Q,h,v)}),Q}function vl(o,a,h,v,_){var k=h._reactRootContainer;if(k){var F=k;if(typeof _=="function"){var W=_;_=function(){var Q=Cf(F);W.call(Q)}}Sf(a,F,o,_)}else F=Y0(h,a,o,_,v);return Cf(F)}Zc=function(o){switch(o.tag){case 3:var a=o.stateNode;if(a.current.memoizedState.isDehydrated){var h=sa(a.pendingLanes);h!==0&&(Ka(a,h|1),Rs(a,Mt()),(pr&6)===0&&(fl=Mt()+500,pa()))}break;case 13:hl(function(){var v=Fi(o,1);if(v!==null){var _=gs();Oo(v,o,1,_)}}),Rp(o,1)}},Gl=function(o){if(o.tag===13){var a=Fi(o,134217728);if(a!==null){var h=gs();Oo(a,o,134217728,h)}Rp(o,134217728)}},eu=function(o){if(o.tag===13){var a=Sa(o),h=Fi(o,a);if(h!==null){var v=gs();Oo(h,o,a,v)}Rp(o,a)}},Wl=function(){return fr},Ee=function(o,a){var h=fr;try{return fr=o,a()}finally{fr=h}},cn=function(o,a,h){switch(a){case"input":if(yt(o,h),a=h.name,h.type==="radio"&&a!=null){for(h=o;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll("input[name="+JSON.stringify(""+a)+'][type="radio"]'),a=0;a<h.length;a++){var v=h[a];if(v!==o&&v.form===o.form){var _=Od(v);if(!_)throw Error(t(90));Ue(v),yt(v,_)}}}break;case"textarea":Ae(o,h);break;case"select":a=h.value,a!=null&&st(o,!!h.multiple,a,!1)}},Dr=Ep,pe=hl;var J0={usingClientEntryPoint:!1,Events:[Qn,Wt,Od,wi,bi,Ep]},Uu={findFiberByHostInstance:Qo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},X0={bundleType:Uu.bundleType,version:Uu.version,rendererPackageName:Uu.rendererPackageName,rendererConfig:Uu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:P.ReactCurrentDispatcher,findHostInstanceByFiber:function(o){return o=Wa(o),o===null?null:o.stateNode},findFiberByHostInstance:Uu.findFiberByHostInstance||K0,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Tf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Tf.isDisabled&&Tf.supportsFiber)try{No=Tf.inject(X0),En=Tf}catch{}}return wo.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=J0,wo.createPortal=function(o,a){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Ap(a))throw Error(t(200));return q0(o,a,null,h)},wo.createRoot=function(o,a){if(!Ap(o))throw Error(t(299));var h=!1,v="",_=cv;return a!=null&&(a.unstable_strictMode===!0&&(h=!0),a.identifierPrefix!==void 0&&(v=a.identifierPrefix),a.onRecoverableError!==void 0&&(_=a.onRecoverableError)),a=Tp(o,1,!1,null,null,h,!1,v,_),o[Hs]=a.current,ca(o.nodeType===8?o.parentNode:o),new kf(a)},wo.findDOMNode=function(o){if(o==null)return null;if(o.nodeType===1)return o;var a=o._reactInternals;if(a===void 0)throw typeof o.render=="function"?Error(t(188)):(o=Object.keys(o).join(","),Error(t(268,o)));return o=Wa(a),o=o===null?null:o.stateNode,o},wo.flushSync=function(o){return hl(o)},wo.hydrate=function(o,a,h){if(!Nf(a))throw Error(t(200));return vl(null,o,a,!0,h)},wo.hydrateRoot=function(o,a,h){if(!Ap(o))throw Error(t(405));var v=h!=null&&h.hydratedSources||null,_=!1,k="",F=cv;if(h!=null&&(h.unstable_strictMode===!0&&(_=!0),h.identifierPrefix!==void 0&&(k=h.identifierPrefix),h.onRecoverableError!==void 0&&(F=h.onRecoverableError)),a=av(a,null,o,1,h??null,_,!1,k,F),o[Hs]=a.current,ca(o),v)for(o=0;o<v.length;o++)h=v[o],_=h._getVersion,_=_(h._source),a.mutableSourceEagerHydrationData==null?a.mutableSourceEagerHydrationData=[h,_]:a.mutableSourceEagerHydrationData.push(h,_);return new $u(a)},wo.render=function(o,a,h){if(!Nf(a))throw Error(t(200));return vl(null,o,a,!1,h)},wo.unmountComponentAtNode=function(o){if(!Nf(o))throw Error(t(40));return o._reactRootContainer?(hl(function(){vl(null,null,o,!1,function(){o._reactRootContainer=null,o[Hs]=null})}),!0):!1},wo.unstable_batchedUpdates=Ep,wo.unstable_renderSubtreeIntoContainer=function(o,a,h,v){if(!Nf(h))throw Error(t(200));if(o==null||o._reactInternals===void 0)throw Error(t(38));return vl(o,a,h,!1,v)},wo.version="18.3.1-next-f1338f8080-20240426",wo}var pS;function x1(){if(pS)return fx.exports;pS=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),fx.exports=zO(),fx.exports}var mS;function HO(){if(mS)return mv;mS=1;var r=x1();return mv.createRoot=r.createRoot,mv.hydrateRoot=r.hydrateRoot,mv}var BO=HO();const GO=Tb(BO);class WO{constructor(e){H(this,"logger");H(this,"changeListeners",new Set);var t;this.logger=e,(t=chrome==null?void 0:chrome.storage)!=null&&t.onChanged&&chrome.storage.onChanged.addListener(this.handleStorageChange.bind(this))}async getLocalItem(e){try{const t=await new Promise((n,s)=>{chrome.storage.local.get(e,i=>{chrome.runtime.lastError?s(new Error(chrome.runtime.lastError.message)):n(i)})});try{if(t[e]!==void 0){const n=JSON.parse(t[e]);return this.logger.debug(`Retrieved local item with key: ${e}`,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"getLocalItem"}),n}return null}catch{return this.logger.debug(`Local item with key: ${e} is not JSON, returning as is`,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"getLocalItem"}),t[e]}}catch(t){return this.logger.error(`Error retrieving local item with key: ${e}`,t,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"getLocalItem"}),null}}async setLocalItem(e,t){try{const n={[e]:JSON.stringify(t)};await new Promise((s,i)=>{chrome.storage.local.set(n,()=>{chrome.runtime.lastError?i(new Error(chrome.runtime.lastError.message)):s()})}),this.logger.debug(`Stored local item with key: ${e}`,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"setLocalItem"})}catch(n){throw this.logger.error(`Error storing local item with key: ${e}`,n,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"setLocalItem"}),n}}async removeLocalItem(e){try{await new Promise((t,n)=>{chrome.storage.local.remove(e,()=>{chrome.runtime.lastError?n(new Error(chrome.runtime.lastError.message)):t()})}),this.logger.debug(`Removed local item with key: ${e}`,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"removeLocalItem"})}catch(t){throw this.logger.error(`Error removing local item with key: ${e}`,t,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"removeLocalItem"}),t}}async clearLocal(){try{await new Promise((e,t)=>{chrome.storage.local.clear(()=>{chrome.runtime.lastError?t(new Error(chrome.runtime.lastError.message)):e()})}),this.logger.info("Cleared local storage",{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"clearLocal"})}catch(e){throw this.logger.error("Error clearing local storage",e,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"clearLocal"}),e}}async getAllKeys(){try{const e=await new Promise((n,s)=>{chrome.storage.local.get(null,i=>{chrome.runtime.lastError?s(new Error(chrome.runtime.lastError.message)):n(i)})}),t=Object.keys(e);return this.logger.debug(`Retrieved ${t.length} keys from storage`,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"getAllKeys"}),t}catch(e){return this.logger.error("Error getting all keys",e,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"getAllKeys"}),[]}}onChanged(e){this.changeListeners.add(e)}removeChangeListener(e){this.changeListeners.delete(e)}handleStorageChange(e,t){if((t==="local"||t==="session"||t==="sync")&&this.changeListeners.size>0){const n={};for(const[s,i]of Object.entries(e))try{n[s]={oldValue:i.oldValue?JSON.parse(i.oldValue):void 0,newValue:i.newValue?JSON.parse(i.newValue):void 0}}catch(c){this.logger.debug("Storage change value not JSON",{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"handleStorageChange",key:s,areaName:t,error:c}),n[s]={oldValue:i.oldValue,newValue:i.newValue}}this.changeListeners.forEach(s=>{try{s(n)}catch(i){this.logger.error("Error in storage change callback",i,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"handleStorageChange"})}})}}}class VO{constructor(e){H(this,"logger");H(this,"threadListeners",new Set);H(this,"currentThread",null);this.logger=e,this.initializeStorageListeners()}initializeStorageListeners(){var e,t,n;(t=(e=chrome==null?void 0:chrome.storage)==null?void 0:e.local)!=null&&t.onChanged&&chrome.storage.local.onChanged.addListener(s=>{Object.keys(s).some(c=>c.includes("threadId_window_")&&c.includes("_tab_")||c.includes("threadData_window_")&&c.includes("_tab_"))&&(this.logger.debug("Tab-specific thread data changed, triggering update",{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"initializeStorageListeners",changedKeys:Object.keys(s)}),this.handleThreadDataChange())}),(n=chrome==null?void 0:chrome.tabs)!=null&&n.onActivated&&chrome.tabs.onActivated.addListener(s=>{this.logger.debug("Tab activated, updating thread data",{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"initializeStorageListeners",tabId:s.tabId,windowId:s.windowId}),setTimeout(()=>{this.handleThreadDataChange()},100)})}async getCurrentTabInfo(){try{const[e]=await chrome.tabs.query({active:!0,currentWindow:!0});return!(e!=null&&e.id)||!(e!=null&&e.windowId)?(this.logger.warn("No active tab found",{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentTabInfo"}),null):{tabId:e.id,windowId:e.windowId}}catch(e){return this.logger.error("Error getting current tab info",e,{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentTabInfo"}),null}}async handleThreadDataChange(){var e;try{const t=await this.getCurrentTabInfo(),n=await this.getCurrentThread(),s=(n==null?void 0:n.threadId)||null,i=((e=this.currentThread)==null?void 0:e.threadId)||null;s!==i&&(this.logger.info("Notifying thread listeners for tab",{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"handleThreadDataChange",tabId:t==null?void 0:t.tabId,windowId:t==null?void 0:t.windowId,newThreadId:s,currentThreadId:i}),this.currentThread=n,this.notifyThreadListeners(n))}catch(t){this.logger.error("Error handling thread data change",t,{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"handleThreadDataChange"})}}async getCurrentThread(){const e=await this.getCurrentTabInfo();if(!e)return this.logger.warn("No tab info available for getting current thread",{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentThread"}),null;const{tabId:t,windowId:n}=e,s=`threadId_window_${n}_tab_${t}`,i=`threadData_window_${n}_tab_${t}`;return new Promise(c=>{chrome.storage.local.get([s,i],u=>{if(chrome.runtime.lastError){this.logger.error("Error getting thread data",chrome.runtime.lastError,{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentThread",tabId:t,windowId:n}),c(null);return}const p=u[s],m=u[i];if(!p||!m){this.logger.debug(`No thread data found for tab ${t} in window ${n}`,{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentThread",tabId:t,windowId:n,hasThreadId:!!p,hasThreadData:!!m}),c(null);return}try{const g=this.transformToEmailThread(p,m);this.logger.debug(`Retrieved thread data for tab ${t} in window ${n}`,{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentThread",tabId:t,windowId:n,threadId:p}),c(g)}catch(g){this.logger.error("Error transforming thread data",g,{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentThread",tabId:t,windowId:n}),c(null)}})})}async getCurrentThreadId(){const e=await this.getCurrentTabInfo();if(!e)return this.logger.warn("No tab info available for getting current thread ID",{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentThreadId"}),null;const{tabId:t,windowId:n}=e,s=`threadId_window_${n}_tab_${t}`;return new Promise(i=>{chrome.storage.local.get([s],c=>{if(chrome.runtime.lastError){this.logger.error("Error getting thread ID",chrome.runtime.lastError,{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentThreadId",tabId:t,windowId:n}),i(null);return}const u=c[s]||null;this.logger.debug(`Retrieved thread ID for tab ${t} in window ${n}`,{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentThreadId",tabId:t,windowId:n,threadId:u}),i(u)})})}getCurrentUserEmail(){return this.logger.debug("getCurrentUserEmail called for Chrome - not needed, backend handles filtering",{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentUserEmail"}),null}onThreadChanged(e){this.threadListeners.add(e)}removeThreadListener(e){this.threadListeners.delete(e)}notifyThreadListeners(e){this.threadListeners.forEach(t=>{try{t(e)}catch(n){this.logger.error("Error in thread change callback",n,{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"notifyThreadListeners"})}})}transformToEmailThread(e,t){var n;if(!t||!Array.isArray(t))return this.logger.warn("Invalid thread data format",{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"transformToEmailThread",threadId:e,threadData:t}),null;try{const s=t.map(c=>({from:c.from||"Unknown",timestamp:c.timestamp||new Date().toISOString(),subject:c.subject||"No Subject",body:c.body||"",html:c.html||c.body||""})),i=new Set;return t.forEach(c=>{c.from&&typeof c.from=="string"&&i.add(c.from),c.to&&Array.isArray(c.to)&&c.to.forEach(u=>{typeof u=="string"&&i.add(u)}),c.cc&&Array.isArray(c.cc)&&c.cc.forEach(u=>{typeof u=="string"&&i.add(u)}),c.bcc&&Array.isArray(c.bcc)&&c.bcc.forEach(u=>{typeof u=="string"&&i.add(u)})}),{threadId:e,messages:s,subject:((n=s[0])==null?void 0:n.subject)||"No Subject",participants:Array.from(i)}}catch(s){return this.logger.error("Error transforming email messages",s,{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"transformToEmailThread",threadId:e,threadData:t}),null}}}const qO="CandleLogsDB",KO=1,mx="logs";let Fp=null;function YO(){return Fp||(Fp=new Promise((r,e)=>{console.log("[Logger] Initializing IndexedDB...");const t=indexedDB.open(qO,KO);t.onupgradeneeded=n=>{console.log("[Logger] IndexedDB upgrade needed.");const s=n.target.result;if(!s.objectStoreNames.contains(mx)){console.log(`[Logger] Creating object store: ${mx}`);const i=s.createObjectStore(mx,{keyPath:"id",autoIncrement:!0});console.log("[Logger] Creating indexes: timestamp, level, chromeContext"),i.createIndex("timestamp","timestamp",{unique:!1}),i.createIndex("level","level",{unique:!1}),i.createIndex("chromeContext","chromeContext",{unique:!1})}},t.onsuccess=n=>{console.log("[Logger] IndexedDB initialized successfully."),r(n.target.result)},t.onerror=n=>{console.error("[Logger] IndexedDB initialization failed:",n.target.error),Fp=null,e(n.target.error)},t.onblocked=()=>{console.warn("[Logger] IndexedDB initialization blocked. Close other tabs using the database.")}}),Fp)}YO().catch(r=>console.error("[Logger] Initial DB connection failed:",r));const JO=r=>r!==null&&typeof r=="object"&&!Array.isArray(r),XO=r=>JO(r)?["id_token","access_token","refresh_token","expires_in","token_type"].every(t=>{switch(t){case"expires_in":return typeof r[t]=="number";default:return typeof r[t]=="string"}}):!1,w1=r=>({setHttpHandler(e){r.httpHandler=e},httpHandler(){return r.httpHandler},updateHttpClientConfig(e,t){var n;(n=r.httpHandler)==null||n.updateHttpClientConfig(e,t)},httpHandlerConfigs(){return r.httpHandler.httpHandlerConfigs()}}),b1=r=>({httpHandler:r.httpHandler()});var wm;(function(r){r.HTTP="http",r.HTTPS="https"})(wm||(wm={}));var Zv;(function(r){r.MD5="md5",r.CRC32="crc32",r.CRC32C="crc32c",r.SHA1="sha1",r.SHA256="sha256"})(Zv||(Zv={}));const Cw="__smithy_context";class Vo{constructor(e){H(this,"method");H(this,"protocol");H(this,"hostname");H(this,"port");H(this,"path");H(this,"query");H(this,"headers");H(this,"username");H(this,"password");H(this,"fragment");H(this,"body");this.method=e.method||"GET",this.hostname=e.hostname||"localhost",this.port=e.port,this.query=e.query||{},this.headers=e.headers||{},this.body=e.body,this.protocol=e.protocol?e.protocol.slice(-1)!==":"?`${e.protocol}:`:e.protocol:"https:",this.path=e.path?e.path.charAt(0)!=="/"?`/${e.path}`:e.path:"/",this.username=e.username,this.password=e.password,this.fragment=e.fragment}static clone(e){const t=new Vo({...e,headers:{...e.headers}});return t.query&&(t.query=QO(t.query)),t}static isInstance(e){if(!e)return!1;const t=e;return"method"in t&&"protocol"in t&&"hostname"in t&&"path"in t&&typeof t.query=="object"&&typeof t.headers=="object"}clone(){return Vo.clone(this)}}function QO(r){return Object.keys(r).reduce((e,t)=>{const n=r[t];return{...e,[t]:Array.isArray(n)?[...n]:n}},{})}class rh{constructor(e){H(this,"statusCode");H(this,"reason");H(this,"headers");H(this,"body");this.statusCode=e.statusCode,this.reason=e.reason,this.headers=e.headers||{},this.body=e.body}static isInstance(e){if(!e)return!1;const t=e;return typeof t.statusCode=="number"&&typeof t.headers=="object"}}const ZO=r=>e=>async t=>{if(!Vo.isInstance(t.request))return e(t);const{request:n}=t,{handlerProtocol:s=""}=r.requestHandler.metadata||{};if(s.indexOf("h2")>=0&&!n.headers[":authority"])delete n.headers.host,n.headers[":authority"]=n.hostname+(n.port?":"+n.port:"");else if(!n.headers.host){let i=n.hostname;n.port!=null&&(i+=`:${n.port}`),n.headers.host=i}return e(t)},e2={name:"hostHeaderMiddleware",step:"build",priority:"low",tags:["HOST"],override:!0},_1=r=>({applyToStack:e=>{e.add(ZO(r),e2)}}),t2=()=>(r,e)=>async t=>{var n,s;try{const i=await r(t),{clientName:c,commandName:u,logger:p,dynamoDbDocumentClientOptions:m={}}=e,{overrideInputFilterSensitiveLog:g,overrideOutputFilterSensitiveLog:x}=m,b=g??e.inputFilterSensitiveLog,E=x??e.outputFilterSensitiveLog,{$metadata:T,...S}=i.output;return(n=p==null?void 0:p.info)==null||n.call(p,{clientName:c,commandName:u,input:b(t.input),output:E(S),metadata:T}),i}catch(i){const{clientName:c,commandName:u,logger:p,dynamoDbDocumentClientOptions:m={}}=e,{overrideInputFilterSensitiveLog:g}=m,x=g??e.inputFilterSensitiveLog;throw(s=p==null?void 0:p.error)==null||s.call(p,{clientName:c,commandName:u,input:x(t.input),error:i,metadata:i.$metadata}),i}},r2={name:"loggerMiddleware",tags:["LOGGER"],step:"initialize",override:!0},E1=r=>({applyToStack:e=>{e.add(t2(),r2)}}),n2={step:"build",tags:["RECURSION_DETECTION"],name:"recursionDetectionMiddleware",override:!0,priority:"low"},s2=()=>r=>async e=>r(e),S1=r=>({applyToStack:e=>{e.add(s2(),n2)}}),od=r=>r[Cw]||(r[Cw]={}),Vi=r=>{if(typeof r=="function")return r;const e=Promise.resolve(r);return()=>e},o2=(r,e)=>{if(!e||e.length===0)return r;const t=[];for(const n of e)for(const s of r)s.schemeId.split("#")[1]===n&&t.push(s);for(const n of r)t.find(({schemeId:s})=>s===n.schemeId)||t.push(n);return t};function i2(r){const e=new Map;for(const t of r)e.set(t.schemeId,t);return e}const a2=(r,e)=>(t,n)=>async s=>{var x;const i=r.httpAuthSchemeProvider(await e.httpAuthSchemeParametersProvider(r,n,s.input)),c=r.authSchemePreference?await r.authSchemePreference():[],u=o2(i,c),p=i2(r.httpAuthSchemes),m=od(n),g=[];for(const b of u){const E=p.get(b.schemeId);if(!E){g.push(`HttpAuthScheme \`${b.schemeId}\` was not enabled for this service.`);continue}const T=E.identityProvider(await e.identityProviderConfigProvider(r));if(!T){g.push(`HttpAuthScheme \`${b.schemeId}\` did not have an IdentityProvider configured.`);continue}const{identityProperties:S={},signingProperties:N={}}=((x=b.propertiesExtractor)==null?void 0:x.call(b,r,n))||{};b.identityProperties=Object.assign(b.identityProperties||{},S),b.signingProperties=Object.assign(b.signingProperties||{},N),m.selectedHttpAuthScheme={httpAuthOption:b,identity:await T(b.identityProperties),signer:E.signer};break}if(!m.selectedHttpAuthScheme)throw new Error(g.join(`
`));return t(s)},l2={step:"serialize",tags:["HTTP_AUTH_SCHEME"],name:"httpAuthSchemeMiddleware",override:!0,relation:"before",toMiddleware:"endpointV2Middleware"},C1=(r,{httpAuthSchemeParametersProvider:e,identityProviderConfigProvider:t})=>({applyToStack:n=>{n.addRelativeTo(a2(r,{httpAuthSchemeParametersProvider:e,identityProviderConfigProvider:t}),l2)}}),c2={name:"serializerMiddleware"},u2=r=>e=>{throw e},d2=(r,e)=>{},f2=r=>(e,t)=>async n=>{if(!Vo.isInstance(n.request))return e(n);const i=od(t).selectedHttpAuthScheme;if(!i)throw new Error("No HttpAuthScheme was selected: unable to sign request");const{httpAuthOption:{signingProperties:c={}},identity:u,signer:p}=i,m=await e({...n,request:await p.sign(n.request,u,c)}).catch((p.errorHandler||u2)(c));return(p.successHandler||d2)(m.response,c),m},h2={step:"finalizeRequest",tags:["HTTP_SIGNING"],name:"httpSigningMiddleware",aliases:["apiKeyMiddleware","tokenMiddleware","awsAuthMiddleware"],override:!0,relation:"after",toMiddleware:"retryMiddleware"},k1=r=>({applyToStack:e=>{e.addRelativeTo(f2(),h2)}}),pm=r=>{if(typeof r=="function")return r;const e=Promise.resolve(r);return()=>e},N1="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",gS=Object.entries(N1).reduce((r,[e,t])=>(r[t]=Number(e),r),{}),p2=N1.split(""),qf=6,mm=8,m2=63,Um=r=>{let e=r.length/4*3;r.slice(-2)==="=="?e-=2:r.slice(-1)==="="&&e--;const t=new ArrayBuffer(e),n=new DataView(t);for(let s=0;s<r.length;s+=4){let i=0,c=0;for(let m=s,g=s+3;m<=g;m++)if(r[m]!=="="){if(!(r[m]in gS))throw new TypeError(`Invalid character ${r[m]} in base64 string.`);i|=gS[r[m]]<<(g-m)*qf,c+=qf}else i>>=qf;const u=s/4*3;i>>=c%mm;const p=Math.floor(c/mm);for(let m=0;m<p;m++){const g=(p-m-1)*mm;n.setUint8(u+m,(i&255<<g)>>g)}}return new Uint8Array(t)},ed=r=>new TextEncoder().encode(r),bm=r=>typeof r=="string"?ed(r):ArrayBuffer.isView(r)?new Uint8Array(r.buffer,r.byteOffset,r.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(r),Ly=r=>{if(typeof r=="string")return r;if(typeof r!="object"||typeof r.byteOffset!="number"||typeof r.byteLength!="number")throw new Error("@smithy/util-utf8: toUtf8 encoder function only accepts string | Uint8Array.");return new TextDecoder("utf-8").decode(r)};function _m(r){let e;typeof r=="string"?e=ed(r):e=r;const t=typeof e=="object"&&typeof e.length=="number",n=typeof e=="object"&&typeof e.byteOffset=="number"&&typeof e.byteLength=="number";if(!t&&!n)throw new Error("@smithy/util-base64: toBase64 encoder function only accepts string | Uint8Array.");let s="";for(let i=0;i<e.length;i+=3){let c=0,u=0;for(let m=i,g=Math.min(i+3,e.length);m<g;m++)c|=e[m]<<(g-m-1)*mm,u+=mm;const p=Math.ceil(u/qf);c<<=p*qf-u;for(let m=1;m<=p;m++){const g=(p-m)*qf;s+=p2[(c&m2<<g)>>g]}s+="==".slice(0,4-p)}return s}class Xu extends Uint8Array{static fromString(e,t="utf-8"){if(typeof e=="string")return t==="base64"?Xu.mutate(Um(e)):Xu.mutate(ed(e));throw new Error(`Unsupported conversion from ${typeof e} to Uint8ArrayBlobAdapter.`)}static mutate(e){return Object.setPrototypeOf(e,Xu.prototype),e}transformToString(e="utf-8"){return e==="base64"?_m(this):Ly(this)}}const Qu=r=>encodeURIComponent(r).replace(/[!'()*]/g,g2),g2=r=>`%${r.charCodeAt(0).toString(16).toUpperCase()}`;function v2(r){const e=[];for(let t of Object.keys(r).sort()){const n=r[t];if(t=Qu(t),Array.isArray(n))for(let s=0,i=n.length;s<i;s++)e.push(`${t}=${Qu(n[s])}`);else{let s=t;(n||typeof n=="string")&&(s+=`=${Qu(n)}`),e.push(s)}}return e.join("&")}function vS(r,e){return new Request(r,e)}function y2(r=0){return new Promise((e,t)=>{r&&setTimeout(()=>{const n=new Error(`Request did not complete within ${r} ms`);n.name="TimeoutError",t(n)},r)})}const gx={supported:void 0};class My{constructor(e){H(this,"config");H(this,"configProvider");typeof e=="function"?this.configProvider=e().then(t=>t||{}):(this.config=e??{},this.configProvider=Promise.resolve(this.config)),gx.supported===void 0&&(gx.supported=typeof Request<"u"&&"keepalive"in vS("https://[::1]"))}static create(e){return typeof(e==null?void 0:e.handle)=="function"?e:new My(e)}destroy(){}async handle(e,{abortSignal:t,requestTimeout:n}={}){var A;this.config||(this.config=await this.configProvider);const s=n??this.config.requestTimeout,i=this.config.keepAlive===!0,c=this.config.credentials;if(t!=null&&t.aborted){const j=new Error("Request aborted");return j.name="AbortError",Promise.reject(j)}let u=e.path;const p=v2(e.query||{});p&&(u+=`?${p}`),e.fragment&&(u+=`#${e.fragment}`);let m="";if(e.username!=null||e.password!=null){const j=e.username??"",P=e.password??"";m=`${j}:${P}@`}const{port:g,method:x}=e,b=`${e.protocol}//${m}${e.hostname}${g?`:${g}`:""}${u}`,E=x==="GET"||x==="HEAD"?void 0:e.body,T={body:E,headers:new Headers(e.headers),method:x,credentials:c};(A=this.config)!=null&&A.cache&&(T.cache=this.config.cache),E&&(T.duplex="half"),typeof AbortController<"u"&&(T.signal=t),gx.supported&&(T.keepalive=i),typeof this.config.requestInit=="function"&&Object.assign(T,this.config.requestInit(e));let S=()=>{};const N=vS(b,T),R=[fetch(N).then(j=>{const P=j.headers,M={};for(const U of P.entries())M[U[0]]=U[1];return j.body!=null?{response:new rh({headers:M,reason:j.statusText,statusCode:j.status,body:j.body})}:j.blob().then(U=>({response:new rh({headers:M,reason:j.statusText,statusCode:j.status,body:U})}))}),y2(s)];return t&&R.push(new Promise((j,P)=>{const M=()=>{const B=new Error("Request aborted");B.name="AbortError",P(B)};if(typeof t.addEventListener=="function"){const B=t;B.addEventListener("abort",M,{once:!0}),S=()=>B.removeEventListener("abort",M)}else t.onabort=M})),Promise.race(R).finally(S)}updateHttpClientConfig(e,t){this.config=void 0,this.configProvider=this.configProvider.then(n=>(n[e]=t,n))}httpHandlerConfigs(){return this.config??{}}}const T1=async r=>{var e;return typeof Blob=="function"&&r instanceof Blob||((e=r.constructor)==null?void 0:e.name)==="Blob"?Blob.prototype.arrayBuffer!==void 0?new Uint8Array(await r.arrayBuffer()):x2(r):w2(r)};async function x2(r){const e=await b2(r),t=Um(e);return new Uint8Array(t)}async function w2(r){const e=[],t=r.getReader();let n=!1,s=0;for(;!n;){const{done:u,value:p}=await t.read();p&&(e.push(p),s+=p.length),n=u}const i=new Uint8Array(s);let c=0;for(const u of e)i.set(u,c),c+=u.length;return i}function b2(r){return new Promise((e,t)=>{const n=new FileReader;n.onloadend=()=>{if(n.readyState!==2)return t(new Error("Reader aborted too early"));const s=n.result??"",i=s.indexOf(","),c=i>-1?i+1:s.length;e(s.substring(c))},n.onabort=()=>t(new Error("Read aborted")),n.onerror=()=>t(n.error),n.readAsDataURL(r)})}const R1={},kw={};for(let r=0;r<256;r++){let e=r.toString(16).toLowerCase();e.length===1&&(e=`0${e}`),R1[r]=e,kw[e]=r}function _2(r){if(r.length%2!==0)throw new Error("Hex encoded strings must have an even number length");const e=new Uint8Array(r.length/2);for(let t=0;t<r.length;t+=2){const n=r.slice(t,t+2).toLowerCase();if(n in kw)e[t/2]=kw[n];else throw new Error(`Cannot decode unrecognized sequence ${n} as hexadecimal`)}return e}function Zu(r){let e="";for(let t=0;t<r.byteLength;t++)e+=R1[r[t]];return e}const Nw=async(r=new Uint8Array,e)=>{if(r instanceof Uint8Array)return Xu.mutate(r);if(!r)return Xu.mutate(new Uint8Array);const t=e.streamCollector(r);return Xu.mutate(await t)},Mv=r=>typeof r=="function"?r():r,A1=(r,e,t,n,s)=>({name:e,namespace:r,traits:t,input:n,output:s}),E2=r=>(e,t)=>async n=>{var x,b,E,T;const{response:s}=await e(n),{operationSchema:i}=od(t),[,c,u,p,m,g]=i??[];try{const S=await r.protocol.deserializeResponse(A1(c,u,p,m,g),{...r,...t},s);return{response:s,output:S}}catch(S){if(Object.defineProperty(S,"$response",{value:s,enumerable:!1,writable:!1,configurable:!1}),!("$metadata"in S)){const N="Deserialization error: to see the raw response, inspect the hidden field {error}.$response on this object.";try{S.message+=`
  `+N}catch{!t.logger||((b=(x=t.logger)==null?void 0:x.constructor)==null?void 0:b.name)==="NoOpLogger"?console.warn(N):(T=(E=t.logger)==null?void 0:E.warn)==null||T.call(E,N)}typeof S.$responseBodyText<"u"&&S.$response&&(S.$response.body=S.$responseBodyText);try{if(rh.isInstance(s)){const{headers:R={}}=s,A=Object.entries(R);S.$metadata={httpStatusCode:s.statusCode,requestId:vx(/^x-[\w-]+-request-?id$/,A),extendedRequestId:vx(/^x-[\w-]+-id-2$/,A),cfId:vx(/^x-[\w-]+-cf-id$/,A)}}}catch{}}throw S}},vx=(r,e)=>(e.find(([t])=>t.match(r))||[void 0,void 0])[1],S2=r=>(e,t)=>async n=>{var b;const{operationSchema:s}=od(t),[,i,c,u,p,m]=s??[],g=(b=t.endpointV2)!=null&&b.url&&r.urlParser?async()=>r.urlParser(t.endpointV2.url):r.endpoint,x=await r.protocol.serializeRequest(A1(i,c,u,p,m),n.input,{...r,...t,endpoint:g});return e({...n,request:x})},C2={name:"deserializerMiddleware",step:"deserialize",tags:["DESERIALIZER"],override:!0},k2={name:"serializerMiddleware",step:"serialize",tags:["SERIALIZER"],override:!0};function I1(r){return{applyToStack:e=>{e.add(S2(r),k2),e.add(E2(r),C2),r.protocol.setSerdeContext(r)}}}function tm(r){if(typeof r=="object")return r;r=r|0;const e={};let t=0;for(const n of["httpLabel","idempotent","idempotencyToken","sensitive","httpPayload","httpResponseCode","httpQueryParams"])(r>>t++&1)===1&&(e[n]=1);return e}const yS={it:Symbol.for("@smithy/nor-struct-it")},jc=class jc{constructor(e,t){H(this,"ref");H(this,"memberName");H(this,"symbol",jc.symbol);H(this,"name");H(this,"schema");H(this,"_isMemberSchema");H(this,"traits");H(this,"memberTraits");H(this,"normalizedTraits");this.ref=e,this.memberName=t;const n=[];let s=e,i=e;for(this._isMemberSchema=!1;yx(s);)n.push(s[1]),s=s[0],i=Mv(s),this._isMemberSchema=!0;if(n.length>0){this.memberTraits={};for(let c=n.length-1;c>=0;--c){const u=n[c];Object.assign(this.memberTraits,tm(u))}}else this.memberTraits=0;if(i instanceof jc){const c=this.memberTraits;Object.assign(this,i),this.memberTraits=Object.assign({},c,i.getMemberTraits(),this.getMemberTraits()),this.normalizedTraits=void 0,this.memberName=t??i.memberName;return}if(this.schema=Mv(i),N2(this.schema)?(this.name=`${this.schema[1]}#${this.schema[2]}`,this.traits=this.schema[3]):(this.name=this.memberName??String(i),this.traits=0),this._isMemberSchema&&!t)throw new Error(`@smithy/core/schema - NormalizedSchema member init ${this.getName(!0)} missing member name.`)}static[Symbol.hasInstance](e){const t=this.prototype.isPrototypeOf(e);return!t&&typeof e=="object"&&e!==null?e.symbol===this.symbol:t}static of(e){const t=Mv(e);if(t instanceof jc)return t;if(yx(t)){const[n,s]=t;if(n instanceof jc)return Object.assign(n.getMergedTraits(),tm(s)),n;throw new Error(`@smithy/core/schema - may not init unwrapped member schema=${JSON.stringify(e,null,2)}.`)}return new jc(t)}getSchema(){const e=this.schema;return Array.isArray(e)&&e[0]===0?e[4]:e}getName(e=!1){const{name:t}=this;return!e&&t&&t.includes("#")?t.split("#")[1]:t||void 0}getMemberName(){return this.memberName}isMemberSchema(){return this._isMemberSchema}isListSchema(){const e=this.getSchema();return typeof e=="number"?e>=64&&e<128:e[0]===1}isMapSchema(){const e=this.getSchema();return typeof e=="number"?e>=128&&e<=255:e[0]===2}isStructSchema(){const e=this.getSchema();if(typeof e!="object")return!1;const t=e[0];return t===3||t===-3||t===4}isUnionSchema(){const e=this.getSchema();return typeof e!="object"?!1:e[0]===4}isBlobSchema(){const e=this.getSchema();return e===21||e===42}isTimestampSchema(){const e=this.getSchema();return typeof e=="number"&&e>=4&&e<=7}isUnitSchema(){return this.getSchema()==="unit"}isDocumentSchema(){return this.getSchema()===15}isStringSchema(){return this.getSchema()===0}isBooleanSchema(){return this.getSchema()===2}isNumericSchema(){return this.getSchema()===1}isBigIntegerSchema(){return this.getSchema()===17}isBigDecimalSchema(){return this.getSchema()===19}isStreaming(){const{streaming:e}=this.getMergedTraits();return!!e||this.getSchema()===42}isIdempotencyToken(){return!!this.getMergedTraits().idempotencyToken}getMergedTraits(){return this.normalizedTraits??(this.normalizedTraits={...this.getOwnTraits(),...this.getMemberTraits()})}getMemberTraits(){return tm(this.memberTraits)}getOwnTraits(){return tm(this.traits)}getKeySchema(){const[e,t]=[this.isDocumentSchema(),this.isMapSchema()];if(!e&&!t)throw new Error(`@smithy/core/schema - cannot get key for non-map: ${this.getName(!0)}`);const n=this.getSchema(),s=e?15:n[4]??0;return jp([s,0],"key")}getValueSchema(){const e=this.getSchema(),[t,n,s]=[this.isDocumentSchema(),this.isMapSchema(),this.isListSchema()],i=typeof e=="number"?63&e:e&&typeof e=="object"&&(n||s)?e[3+e[0]]:t?15:void 0;if(i!=null)return jp([i,0],n?"value":"member");throw new Error(`@smithy/core/schema - ${this.getName(!0)} has no value member.`)}getMemberSchema(e){const t=this.getSchema();if(this.isStructSchema()&&t[4].includes(e)){const n=t[4].indexOf(e),s=t[5][n];return jp(yx(s)?s:[s,0],e)}if(this.isDocumentSchema())return jp([15,0],e);throw new Error(`@smithy/core/schema - ${this.getName(!0)} has no no member=${e}.`)}getMemberSchemas(){const e={};try{for(const[t,n]of this.structIterator())e[t]=n}catch{}return e}getEventStreamMember(){if(this.isStructSchema()){for(const[e,t]of this.structIterator())if(t.isStreaming()&&t.isStructSchema())return e}return""}*structIterator(){if(this.isUnitSchema())return;if(!this.isStructSchema())throw new Error("@smithy/core/schema - cannot iterate non-struct schema.");const e=this.getSchema(),t=e[4].length;let n=e[yS.it];if(n&&t===n.length){yield*n;return}n=Array(t);for(let s=0;s<t;++s){const i=e[4][s],c=jp([e[5][s],0],i);yield n[s]=[i,c]}e[yS.it]=n}};H(jc,"symbol",Symbol.for("@smithy/nor"));let So=jc;function jp(r,e){if(r instanceof So)return Object.assign(r,{memberName:e,_isMemberSchema:!0});const t=So;return new t(r,e)}const yx=r=>Array.isArray(r)&&r.length===2,N2=r=>Array.isArray(r)&&r.length>=5,Pa=class Pa{constructor(e,t=new Map,n=new Map){H(this,"namespace");H(this,"schemas");H(this,"exceptions");this.namespace=e,this.schemas=t,this.exceptions=n}static for(e){return Pa.registries.has(e)||Pa.registries.set(e,new Pa(e)),Pa.registries.get(e)}register(e,t){const n=this.normalizeShapeId(e);Pa.for(n.split("#")[0]).schemas.set(n,t)}getSchema(e){const t=this.normalizeShapeId(e);if(!this.schemas.has(t))throw new Error(`@smithy/core/schema - schema not found for ${t}`);return this.schemas.get(t)}registerError(e,t){const n=e,s=Pa.for(n[1]);s.schemas.set(n[1]+"#"+n[2],n),s.exceptions.set(n,t)}getErrorCtor(e){const t=e;return Pa.for(t[1]).exceptions.get(t)}getBaseException(){for(const e of this.exceptions.keys())if(Array.isArray(e)){const[,t,n]=e,s=t+"#"+n;if(s.startsWith("smithy.ts.sdk.synthetic.")&&s.endsWith("ServiceException"))return e}}find(e){return[...this.schemas.values()].find(e)}clear(){this.schemas.clear(),this.exceptions.clear()}normalizeShapeId(e){return e.includes("#")?e:this.namespace+"#"+e}};H(Pa,"registries",new Map);let ht=Pa;const Tw=r=>{if(r!=null){if(typeof r=="string"){const e=parseFloat(r);if(!Number.isNaN(e))return String(e)!==String(r)&&D2.warn(O2(`Expected number but observed string: ${r}`)),e}if(typeof r=="number")return r;throw new TypeError(`Expected number, got ${typeof r}: ${r}`)}},T2=Math.ceil(2**127*(2-2**-23)),xS=r=>{const e=Tw(r);if(e!==void 0&&!Number.isNaN(e)&&e!==1/0&&e!==-1/0&&Math.abs(e)>T2)throw new TypeError(`Expected 32-bit float, got ${r}`);return e},R2=r=>{if(r!=null){if(Number.isInteger(r)&&!Number.isNaN(r))return r;throw new TypeError(`Expected integer, got ${typeof r}: ${r}`)}},wS=r=>P1(r,16),bS=r=>P1(r,8),P1=(r,e)=>{const t=R2(r);if(t!==void 0&&A2(t,e)!==t)throw new TypeError(`Expected ${e}-bit integer, got ${r}`);return t},A2=(r,e)=>{switch(e){case 32:return Int32Array.of(r)[0];case 16:return Int16Array.of(r)[0];case 8:return Int8Array.of(r)[0]}},I2=r=>Tw(typeof r=="string"?$y(r):r),P2=r=>xS(typeof r=="string"?$y(r):r),F2=/(-?(?:0|[1-9]\d*)(?:\.\d+)?(?:[eE][+-]?\d+)?)|(-?Infinity)|(NaN)/g,$y=r=>{const e=r.match(F2);if(e===null||e[0].length!==r.length)throw new TypeError("Expected real number, got implicit NaN");return parseFloat(r)},ey=r=>wS(typeof r=="string"?$y(r):r),j2=r=>bS(typeof r=="string"?$y(r):r),O2=r=>String(new TypeError(r).stack||r).split(`
`).slice(0,5).filter(e=>!e.includes("stackTraceWarning")).join(`
`),D2={warn:console.warn},L2=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],Ib=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function M2(r){const e=r.getUTCFullYear(),t=r.getUTCMonth(),n=r.getUTCDay(),s=r.getUTCDate(),i=r.getUTCHours(),c=r.getUTCMinutes(),u=r.getUTCSeconds(),p=s<10?`0${s}`:`${s}`,m=i<10?`0${i}`:`${i}`,g=c<10?`0${c}`:`${c}`,x=u<10?`0${u}`:`${u}`;return`${L2[n]}, ${p} ${Ib[t]} ${e} ${m}:${g}:${x} GMT`}const $2=new RegExp(/^(\d{4})-(\d{2})-(\d{2})[tT](\d{2}):(\d{2}):(\d{2})(?:\.(\d+))?(([-+]\d{2}\:\d{2})|[zZ])$/),U2=r=>{if(r==null)return;if(typeof r!="string")throw new TypeError("RFC-3339 date-times must be expressed as strings");const e=$2.exec(r);if(!e)throw new TypeError("Invalid RFC-3339 date-time value");const[t,n,s,i,c,u,p,m,g]=e,x=ey(Em(n)),b=Mc(s,"month",1,12),E=Mc(i,"day",1,31),T=$v(x,b,E,{hours:c,minutes:u,seconds:p,fractionalMilliseconds:m});return g.toUpperCase()!="Z"&&T.setTime(T.getTime()-Z2(g)),T},z2=new RegExp(/^(?:Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d{2}) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d{1,2}):(\d{2}):(\d{2})(?:\.(\d+))? GMT$/),H2=new RegExp(/^(?:Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d{2})-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d{2}) (\d{1,2}):(\d{2}):(\d{2})(?:\.(\d+))? GMT$/),B2=new RegExp(/^(?:Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( [1-9]|\d{2}) (\d{1,2}):(\d{2}):(\d{2})(?:\.(\d+))? (\d{4})$/),G2=r=>{if(r==null)return;if(typeof r!="string")throw new TypeError("RFC-7231 date-times must be expressed as strings");let e=z2.exec(r);if(e){const[t,n,s,i,c,u,p,m]=e;return $v(ey(Em(i)),xx(s),Mc(n,"day",1,31),{hours:c,minutes:u,seconds:p,fractionalMilliseconds:m})}if(e=H2.exec(r),e){const[t,n,s,i,c,u,p,m]=e;return K2($v(V2(i),xx(s),Mc(n,"day",1,31),{hours:c,minutes:u,seconds:p,fractionalMilliseconds:m}))}if(e=B2.exec(r),e){const[t,n,s,i,c,u,p,m]=e;return $v(ey(Em(m)),xx(n),Mc(s.trimLeft(),"day",1,31),{hours:i,minutes:c,seconds:u,fractionalMilliseconds:p})}throw new TypeError("Invalid RFC-7231 date-time value")},W2=r=>{if(r==null)return;let e;if(typeof r=="number")e=r;else if(typeof r=="string")e=I2(r);else if(typeof r=="object"&&r.tag===1)e=r.value;else throw new TypeError("Epoch timestamps must be expressed as floating point numbers or their string representation");if(Number.isNaN(e)||e===1/0||e===-1/0)throw new TypeError("Epoch timestamps must be valid, non-Infinite, non-NaN numerics");return new Date(Math.round(e*1e3))},$v=(r,e,t,n)=>{const s=e-1;return J2(r,s,t),new Date(Date.UTC(r,s,t,Mc(n.hours,"hour",0,23),Mc(n.minutes,"minute",0,59),Mc(n.seconds,"seconds",0,60),Q2(n.fractionalMilliseconds)))},V2=r=>{const e=new Date().getUTCFullYear(),t=Math.floor(e/100)*100+ey(Em(r));return t<e?t+100:t},q2=50*365*24*60*60*1e3,K2=r=>r.getTime()-new Date().getTime()>q2?new Date(Date.UTC(r.getUTCFullYear()-100,r.getUTCMonth(),r.getUTCDate(),r.getUTCHours(),r.getUTCMinutes(),r.getUTCSeconds(),r.getUTCMilliseconds())):r,xx=r=>{const e=Ib.indexOf(r);if(e<0)throw new TypeError(`Invalid month: ${r}`);return e+1},Y2=[31,28,31,30,31,30,31,31,30,31,30,31],J2=(r,e,t)=>{let n=Y2[e];if(e===1&&X2(r)&&(n=29),t>n)throw new TypeError(`Invalid day for ${Ib[e]} in ${r}: ${t}`)},X2=r=>r%4===0&&(r%100!==0||r%400===0),Mc=(r,e,t,n)=>{const s=j2(Em(r));if(s<t||s>n)throw new TypeError(`${e} must be between ${t} and ${n}, inclusive`);return s},Q2=r=>r==null?0:P2("0."+r)*1e3,Z2=r=>{const e=r[0];let t=1;if(e=="+")t=1;else if(e=="-")t=-1;else throw new TypeError(`Offset direction, ${e}, must be "+" or "-"`);const n=Number(r.substring(1,3)),s=Number(r.substring(4,6));return t*(n*60+s)*60*1e3},Em=r=>{let e=0;for(;e<r.length-1&&r.charAt(e)==="0";)e++;return e===0?r:r.slice(e)},_S=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),As=Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0")),F1=()=>{if(_S)return _S();const r=new Uint8Array(16);return crypto.getRandomValues(r),r[6]=r[6]&15|64,r[8]=r[8]&63|128,As[r[0]]+As[r[1]]+As[r[2]]+As[r[3]]+"-"+As[r[4]]+As[r[5]]+"-"+As[r[6]]+As[r[7]]+"-"+As[r[8]]+As[r[9]]+"-"+As[r[10]]+As[r[11]]+As[r[12]]+As[r[13]]+As[r[14]]+As[r[15]]},Dc=function(e){return Object.assign(new String(e),{deserializeJSON(){return JSON.parse(String(e))},toString(){return String(e)},toJSON(){return String(e)}})};Dc.from=r=>r&&typeof r=="object"&&(r instanceof Dc||"deserializeJSON"in r)?r:typeof r=="string"||Object.getPrototypeOf(r)===String.prototype?Dc(String(r)):Dc(JSON.stringify(r));Dc.fromObject=Dc.from;const ES=/^-?\d*(\.\d+)?$/;class Da{constructor(e,t){H(this,"string");H(this,"type");if(this.string=e,this.type=t,!ES.test(e))throw new Error('@smithy/core/serde - NumericValue must only contain [0-9], at most one decimal point ".", and an optional negation prefix "-".')}toString(){return this.string}static[Symbol.hasInstance](e){if(!e||typeof e!="object")return!1;const t=e;return Da.prototype.isPrototypeOf(e)||t.type==="bigDecimal"&&ES.test(t.string)}}const eD="modulepreload",tD=function(r){return"/FileServer_Staging/dist-outlook-addin/"+r},SS={},Rw=function(e,t,n){let s=Promise.resolve();if(t&&t.length>0){let c=function(m){return Promise.all(m.map(g=>Promise.resolve(g).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),p=(u==null?void 0:u.nonce)||(u==null?void 0:u.getAttribute("nonce"));s=c(t.map(m=>{if(m=tD(m),m in SS)return;SS[m]=!0;const g=m.endsWith(".css"),x=g?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${m}"]${x}`))return;const b=document.createElement("link");if(b.rel=g?"stylesheet":eD,g||(b.as="script"),b.crossOrigin="",b.href=m,p&&b.setAttribute("nonce",p),document.head.appendChild(b),g)return new Promise((E,T)=>{b.addEventListener("load",E),b.addEventListener("error",()=>T(new Error(`Unable to preload CSS for ${m}`)))})}))}function i(c){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=c,window.dispatchEvent(u),!u.defaultPrevented)throw c}return s.then(c=>{for(const u of c||[])u.status==="rejected"&&i(u.reason);return e().catch(i)})};class rD{constructor(){H(this,"serdeContext")}setSerdeContext(e){this.serdeContext=e}}class nD extends rD{constructor(t){super();H(this,"options");this.options=t}getRequestType(){return Vo}getResponseType(){return rh}setSerdeContext(t){this.serdeContext=t,this.serializer.setSerdeContext(t),this.deserializer.setSerdeContext(t),this.getPayloadCodec()&&this.getPayloadCodec().setSerdeContext(t)}updateServiceEndpoint(t,n){if("url"in n){t.protocol=n.url.protocol,t.hostname=n.url.hostname,t.port=n.url.port?Number(n.url.port):void 0,t.path=n.url.pathname,t.fragment=n.url.hash||void 0,t.username=n.url.username||void 0,t.password=n.url.password||void 0,t.query||(t.query={});for(const[s,i]of n.url.searchParams.entries())t.query[s]=i;return t}else return t.protocol=n.protocol,t.hostname=n.hostname,t.port=n.port?Number(n.port):void 0,t.path=n.path,t.query={...n.query},t}setHostPrefix(t,n,s){var u,p;if((u=this.serdeContext)!=null&&u.disableHostPrefix)return;const i=So.of(n.input),c=tm(n.traits??{});if(c.endpoint){let m=(p=c.endpoint)==null?void 0:p[0];if(typeof m=="string"){const g=[...i.structIterator()].filter(([,x])=>x.getMergedTraits().hostLabel);for(const[x]of g){const b=s[x];if(typeof b!="string")throw new Error(`@smithy/core/schema - ${x} in input must be a string as hostLabel.`);m=m.replace(`{${x}}`,b)}t.hostname=m+t.hostname}}}deserializeMetadata(t){return{httpStatusCode:t.statusCode,requestId:t.headers["x-amzn-requestid"]??t.headers["x-amzn-request-id"]??t.headers["x-amz-request-id"],extendedRequestId:t.headers["x-amz-id-2"],cfId:t.headers["x-amz-cf-id"]}}async serializeEventStream({eventStream:t,requestSchema:n,initialRequest:s}){return(await this.loadEventStreamCapability()).serializeEventStream({eventStream:t,requestSchema:n,initialRequest:s})}async deserializeEventStream({response:t,responseSchema:n,initialResponseContainer:s}){return(await this.loadEventStreamCapability()).deserializeEventStream({response:t,responseSchema:n,initialResponseContainer:s})}async loadEventStreamCapability(){const{EventStreamSerde:t}=await Rw(async()=>{const{EventStreamSerde:n}=await import("./index.DS5eee3c.js");return{EventStreamSerde:n}},__vite__mapDeps([0,1]));return new t({marshaller:this.getEventStreamMarshaller(),serializer:this.serializer,deserializer:this.deserializer,serdeContext:this.serdeContext,defaultContentType:this.getDefaultContentType()})}getDefaultContentType(){throw new Error(`@smithy/core/protocols - ${this.constructor.name} getDefaultContentType() implementation missing.`)}async deserializeHttpMessage(t,n,s,i,c){return[]}getEventStreamMarshaller(){const t=this.serdeContext;if(!t.eventStreamMarshaller)throw new Error("@smithy/core - HttpProtocol: eventStreamMarshaller missing in serdeContext.");return t.eventStreamMarshaller}}class sD extends nD{async serializeRequest(e,t,n){const s=this.serializer,i={},c={},u=await n.endpoint(),p=So.of(e==null?void 0:e.input),m=p.getSchema();let g;const x=new Vo({protocol:"",hostname:"",port:void 0,path:"/",fragment:void 0,query:i,headers:c,body:void 0});u&&(this.updateServiceEndpoint(x,u),this.setHostPrefix(x,e,t));const b={...t};if(t){const E=p.getEventStreamMember();if(E){if(b[E]){const T={};for(const[S,N]of p.structIterator())S!==E&&b[S]&&(s.write(N,b[S]),T[S]=s.flush());g=await this.serializeEventStream({eventStream:b[E],requestSchema:p,initialRequest:T})}}else s.write(m,b),g=s.flush()}return x.headers=c,x.query=i,x.body=g,x.method="POST",x}async deserializeResponse(e,t,n){const s=this.deserializer,i=So.of(e.output),c={};if(n.statusCode>=300){const p=await Nw(n.body,t);throw p.byteLength>0&&Object.assign(c,await s.read(15,p)),await this.handleError(e,t,n,c,this.deserializeMetadata(n)),new Error("@smithy/core/protocols - RPC Protocol error handler failed to throw.")}for(const p in n.headers){const m=n.headers[p];delete n.headers[p],n.headers[p.toLowerCase()]=m}const u=i.getEventStreamMember();if(u)c[u]=await this.deserializeEventStream({response:n,responseSchema:i,initialResponseContainer:c});else{const p=await Nw(n.body,t);p.byteLength>0&&Object.assign(c,await s.read(i,p))}return c.$metadata=this.deserializeMetadata(n),c}}function j1(r,e){if(e.timestampFormat.useTrait&&r.isTimestampSchema()&&(r.getSchema()===5||r.getSchema()===6||r.getSchema()===7))return r.getSchema();const{httpLabel:t,httpPrefixHeaders:n,httpHeader:s,httpQuery:i}=r.getMergedTraits();return(e.httpBindings?typeof n=="string"||s?6:i||t?5:void 0:void 0)??e.timestampFormat.default}function oD(r,e,t){r.__smithy_context?r.__smithy_context.features||(r.__smithy_context.features={}):r.__smithy_context={features:{}},r.__smithy_context.features[e]=t}class O1{constructor(e){H(this,"authSchemes",new Map);for(const[t,n]of Object.entries(e))n!==void 0&&this.authSchemes.set(t,n)}getIdentityProvider(e){return this.authSchemes.get(e)}}class D1{async sign(e,t,n){return e}}const iD=r=>function(t){return L1(t)&&t.expiration.getTime()-Date.now()<r},aD=3e5,lD=iD(aD),L1=r=>r.expiration!==void 0,cD=(r,e,t)=>{if(r===void 0)return;const n=typeof r!="function"?async()=>Promise.resolve(r):r;let s,i,c,u=!1;const p=async m=>{i||(i=n(m));try{s=await i,c=!0,u=!1}finally{i=void 0}return s};return e===void 0?async m=>((!c||m!=null&&m.forceRefresh)&&(s=await p(m)),s):async m=>((!c||m!=null&&m.forceRefresh)&&(s=await p(m)),u?s:t(s)?(e(s)&&await p(m),s):(u=!0,s))},uD=void 0;function dD(r){return r===void 0?!0:typeof r=="string"&&r.length<=50}function M1(r){const e=pm(r.userAgentAppId??uD),{customUserAgent:t}=r;return Object.assign(r,{customUserAgent:typeof t=="string"?[[t]]:t,userAgentAppId:async()=>{var s,i;const n=await e();if(!dD(n)){const c=((i=(s=r.logger)==null?void 0:s.constructor)==null?void 0:i.name)==="NoOpLogger"||!r.logger?console:r.logger;typeof n!="string"?c==null||c.warn("userAgentAppId must be a string or undefined."):n.length>50&&(c==null||c.warn("The provided userAgentAppId exceeds the maximum length of 50 characters."))}return n}})}class $1{constructor({size:e,params:t}){H(this,"capacity");H(this,"data",new Map);H(this,"parameters",[]);this.capacity=e??50,t&&(this.parameters=t)}get(e,t){const n=this.hash(e);if(n===!1)return t();if(!this.data.has(n)){if(this.data.size>this.capacity+10){const s=this.data.keys();let i=0;for(;;){const{value:c,done:u}=s.next();if(this.data.delete(c),u||++i>10)break}}this.data.set(n,t())}return this.data.get(n)}size(){return this.data.size}hash(e){let t="";const{parameters:n}=this;if(n.length===0)return!1;for(const s of n){const i=String(e[s]??"");if(i.includes("|;"))return!1;t+=i+"|;"}return t}}const fD=new RegExp("^(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}$"),Pb=r=>fD.test(r)||r.startsWith("[")&&r.endsWith("]"),hD=new RegExp("^(?!.*-$)(?!-)[a-zA-Z0-9-]{1,63}$"),zm=(r,e=!1)=>{if(!e)return hD.test(r);const t=r.split(".");for(const n of t)if(!zm(n))return!1;return!0},nh={},Sm="endpoints";function Bc(r){return typeof r!="object"||r==null?r:"ref"in r?`$${Bc(r.ref)}`:"fn"in r?`${r.fn}(${(r.argv||[]).map(Bc).join(", ")})`:JSON.stringify(r,null,2)}class qo extends Error{constructor(e){super(e),this.name="EndpointError"}}const pD=(r,e)=>r===e,mD=r=>{const e=r.split("."),t=[];for(const n of e){const s=n.indexOf("[");if(s!==-1){if(n.indexOf("]")!==n.length-1)throw new qo(`Path: '${r}' does not end with ']'`);const i=n.slice(s+1,-1);if(Number.isNaN(parseInt(i)))throw new qo(`Invalid array index: '${i}' in path: '${r}'`);s!==0&&t.push(n.slice(0,s)),t.push(i)}else t.push(n)}return t},U1=(r,e)=>mD(e).reduce((t,n)=>{if(typeof t!="object")throw new qo(`Index '${n}' in '${e}' not found in '${JSON.stringify(r)}'`);return Array.isArray(t)?t[parseInt(n)]:t[n]},r),gD=r=>r!=null,vD=r=>!r,wx={[wm.HTTP]:80,[wm.HTTPS]:443},yD=r=>{const e=(()=>{try{if(r instanceof URL)return r;if(typeof r=="object"&&"hostname"in r){const{hostname:b,port:E,protocol:T="",path:S="",query:N={}}=r,R=new URL(`${T}//${b}${E?`:${E}`:""}${S}`);return R.search=Object.entries(N).map(([A,j])=>`${A}=${j}`).join("&"),R}return new URL(r)}catch{return null}})();if(!e)return console.error(`Unable to parse ${JSON.stringify(r)} as a whatwg URL.`),null;const t=e.href,{host:n,hostname:s,pathname:i,protocol:c,search:u}=e;if(u)return null;const p=c.slice(0,-1);if(!Object.values(wm).includes(p))return null;const m=Pb(s),g=t.includes(`${n}:${wx[p]}`)||typeof r=="string"&&r.includes(`${n}:${wx[p]}`),x=`${n}${g?`:${wx[p]}`:""}`;return{scheme:p,authority:x,path:i,normalizedPath:i.endsWith("/")?i:`${i}/`,isIp:m}},xD=(r,e)=>r===e,wD=(r,e,t,n)=>e>=t||r.length<t?null:n?r.substring(r.length-t,r.length-e):r.substring(e,t),bD=r=>encodeURIComponent(r).replace(/[!*'()]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),_D={booleanEquals:pD,getAttr:U1,isSet:gD,isValidHostLabel:zm,not:vD,parseURL:yD,stringEquals:xD,substring:wD,uriEncode:bD},z1=(r,e)=>{const t=[],n={...e.endpointParams,...e.referenceRecord};let s=0;for(;s<r.length;){const i=r.indexOf("{",s);if(i===-1){t.push(r.slice(s));break}t.push(r.slice(s,i));const c=r.indexOf("}",i);if(c===-1){t.push(r.slice(i));break}r[i+1]==="{"&&r[c+1]==="}"&&(t.push(r.slice(i+1,c)),s=c+2);const u=r.substring(i+1,c);if(u.includes("#")){const[p,m]=u.split("#");t.push(U1(n[p],m))}else t.push(n[u]);s=c+1}return t.join("")},ED=({ref:r},e)=>({...e.endpointParams,...e.referenceRecord})[r],Uy=(r,e,t)=>{if(typeof r=="string")return z1(r,t);if(r.fn)return B1.callFunction(r,t);if(r.ref)return ED(r,t);throw new qo(`'${e}': ${String(r)} is not a string, function or reference.`)},H1=({fn:r,argv:e},t)=>{const n=e.map(i=>["boolean","number"].includes(typeof i)?i:B1.evaluateExpression(i,"arg",t)),s=r.split(".");return s[0]in nh&&s[1]!=null?nh[s[0]][s[1]](...n):_D[r](...n)},B1={evaluateExpression:Uy,callFunction:H1},SD=({assign:r,...e},t)=>{var s,i;if(r&&r in t.referenceRecord)throw new qo(`'${r}' is already defined in Reference Record.`);const n=H1(e,t);return(i=(s=t.logger)==null?void 0:s.debug)==null||i.call(s,`${Sm} evaluateCondition: ${Bc(e)} = ${Bc(n)}`),{result:n===""?!0:!!n,...r!=null&&{toAssign:{name:r,value:n}}}},Fb=(r=[],e)=>{var n,s;const t={};for(const i of r){const{result:c,toAssign:u}=SD(i,{...e,referenceRecord:{...e.referenceRecord,...t}});if(!c)return{result:c};u&&(t[u.name]=u.value,(s=(n=e.logger)==null?void 0:n.debug)==null||s.call(n,`${Sm} assign: ${u.name} := ${Bc(u.value)}`))}return{result:!0,referenceRecord:t}},CD=(r,e)=>Object.entries(r).reduce((t,[n,s])=>({...t,[n]:s.map(i=>{const c=Uy(i,"Header value entry",e);if(typeof c!="string")throw new qo(`Header '${n}' value '${c}' is not a string`);return c})}),{}),G1=(r,e)=>Object.entries(r).reduce((t,[n,s])=>({...t,[n]:V1.getEndpointProperty(s,e)}),{}),W1=(r,e)=>{if(Array.isArray(r))return r.map(t=>W1(t,e));switch(typeof r){case"string":return z1(r,e);case"object":if(r===null)throw new qo(`Unexpected endpoint property: ${r}`);return V1.getEndpointProperties(r,e);case"boolean":return r;default:throw new qo(`Unexpected endpoint property type: ${typeof r}`)}},V1={getEndpointProperty:W1,getEndpointProperties:G1},kD=(r,e)=>{const t=Uy(r,"Endpoint URL",e);if(typeof t=="string")try{return new URL(t)}catch(n){throw console.error(`Failed to construct URL with ${t}`,n),n}throw new qo(`Endpoint URL must be a string, got ${typeof t}`)},ND=(r,e)=>{var g,x;const{conditions:t,endpoint:n}=r,{result:s,referenceRecord:i}=Fb(t,e);if(!s)return;const c={...e,referenceRecord:{...e.referenceRecord,...i}},{url:u,properties:p,headers:m}=n;return(x=(g=e.logger)==null?void 0:g.debug)==null||x.call(g,`${Sm} Resolving endpoint from template: ${Bc(n)}`),{...m!=null&&{headers:CD(m,c)},...p!=null&&{properties:G1(p,c)},url:kD(u,c)}},TD=(r,e)=>{const{conditions:t,error:n}=r,{result:s,referenceRecord:i}=Fb(t,e);if(s)throw new qo(Uy(n,"Error",{...e,referenceRecord:{...e.referenceRecord,...i}}))},q1=(r,e)=>{for(const t of r)if(t.type==="endpoint"){const n=ND(t,e);if(n)return n}else if(t.type==="error")TD(t,e);else if(t.type==="tree"){const n=K1.evaluateTreeRule(t,e);if(n)return n}else throw new qo(`Unknown endpoint rule: ${t}`);throw new qo("Rules evaluation failed")},RD=(r,e)=>{const{conditions:t,rules:n}=r,{result:s,referenceRecord:i}=Fb(t,e);if(s)return K1.evaluateRules(n,{...e,referenceRecord:{...e.referenceRecord,...i}})},K1={evaluateRules:q1,evaluateTreeRule:RD},Y1=(r,e)=>{var m,g,x,b;const{endpointParams:t,logger:n}=e,{parameters:s,rules:i}=r;(g=(m=e.logger)==null?void 0:m.debug)==null||g.call(m,`${Sm} Initial EndpointParams: ${Bc(t)}`);const c=Object.entries(s).filter(([,E])=>E.default!=null).map(([E,T])=>[E,T.default]);if(c.length>0)for(const[E,T]of c)t[E]=t[E]??T;const u=Object.entries(s).filter(([,E])=>E.required).map(([E])=>E);for(const E of u)if(t[E]==null)throw new qo(`Missing required parameter: '${E}'`);const p=q1(i,{endpointParams:t,logger:n,referenceRecord:{}});return(b=(x=e.logger)==null?void 0:x.debug)==null||b.call(x,`${Sm} Resolved endpoint: ${Bc(p)}`),p},J1=(r,e=!1)=>{if(e){for(const t of r.split("."))if(!J1(t))return!1;return!0}return!(!zm(r)||r.length<3||r.length>63||r!==r.toLowerCase()||Pb(r))},CS=":",AD="/",ID=r=>{const e=r.split(CS);if(e.length<6)return null;const[t,n,s,i,c,...u]=e;if(t!=="arn"||n===""||s===""||u.join(CS)==="")return null;const p=u.map(m=>m.split(AD)).flat();return{partition:n,service:s,region:i,accountId:c,resourceId:p}},PD=[{id:"aws",outputs:{dnsSuffix:"amazonaws.com",dualStackDnsSuffix:"api.aws",implicitGlobalRegion:"us-east-1",name:"aws",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^(us|eu|ap|sa|ca|me|af|il|mx)\\-\\w+\\-\\d+$",regions:{"af-south-1":{description:"Africa (Cape Town)"},"ap-east-1":{description:"Asia Pacific (Hong Kong)"},"ap-east-2":{description:"Asia Pacific (Taipei)"},"ap-northeast-1":{description:"Asia Pacific (Tokyo)"},"ap-northeast-2":{description:"Asia Pacific (Seoul)"},"ap-northeast-3":{description:"Asia Pacific (Osaka)"},"ap-south-1":{description:"Asia Pacific (Mumbai)"},"ap-south-2":{description:"Asia Pacific (Hyderabad)"},"ap-southeast-1":{description:"Asia Pacific (Singapore)"},"ap-southeast-2":{description:"Asia Pacific (Sydney)"},"ap-southeast-3":{description:"Asia Pacific (Jakarta)"},"ap-southeast-4":{description:"Asia Pacific (Melbourne)"},"ap-southeast-5":{description:"Asia Pacific (Malaysia)"},"ap-southeast-6":{description:"Asia Pacific (New Zealand)"},"ap-southeast-7":{description:"Asia Pacific (Thailand)"},"aws-global":{description:"aws global region"},"ca-central-1":{description:"Canada (Central)"},"ca-west-1":{description:"Canada West (Calgary)"},"eu-central-1":{description:"Europe (Frankfurt)"},"eu-central-2":{description:"Europe (Zurich)"},"eu-north-1":{description:"Europe (Stockholm)"},"eu-south-1":{description:"Europe (Milan)"},"eu-south-2":{description:"Europe (Spain)"},"eu-west-1":{description:"Europe (Ireland)"},"eu-west-2":{description:"Europe (London)"},"eu-west-3":{description:"Europe (Paris)"},"il-central-1":{description:"Israel (Tel Aviv)"},"me-central-1":{description:"Middle East (UAE)"},"me-south-1":{description:"Middle East (Bahrain)"},"mx-central-1":{description:"Mexico (Central)"},"sa-east-1":{description:"South America (Sao Paulo)"},"us-east-1":{description:"US East (N. Virginia)"},"us-east-2":{description:"US East (Ohio)"},"us-west-1":{description:"US West (N. California)"},"us-west-2":{description:"US West (Oregon)"}}},{id:"aws-cn",outputs:{dnsSuffix:"amazonaws.com.cn",dualStackDnsSuffix:"api.amazonwebservices.com.cn",implicitGlobalRegion:"cn-northwest-1",name:"aws-cn",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^cn\\-\\w+\\-\\d+$",regions:{"aws-cn-global":{description:"aws-cn global region"},"cn-north-1":{description:"China (Beijing)"},"cn-northwest-1":{description:"China (Ningxia)"}}},{id:"aws-eusc",outputs:{dnsSuffix:"amazonaws.eu",dualStackDnsSuffix:"api.amazonwebservices.eu",implicitGlobalRegion:"eusc-de-east-1",name:"aws-eusc",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^eusc\\-(de)\\-\\w+\\-\\d+$",regions:{"eusc-de-east-1":{description:"AWS European Sovereign Cloud (Germany)"}}},{id:"aws-iso",outputs:{dnsSuffix:"c2s.ic.gov",dualStackDnsSuffix:"api.aws.ic.gov",implicitGlobalRegion:"us-iso-east-1",name:"aws-iso",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-iso\\-\\w+\\-\\d+$",regions:{"aws-iso-global":{description:"aws-iso global region"},"us-iso-east-1":{description:"US ISO East"},"us-iso-west-1":{description:"US ISO WEST"}}},{id:"aws-iso-b",outputs:{dnsSuffix:"sc2s.sgov.gov",dualStackDnsSuffix:"api.aws.scloud",implicitGlobalRegion:"us-isob-east-1",name:"aws-iso-b",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-isob\\-\\w+\\-\\d+$",regions:{"aws-iso-b-global":{description:"aws-iso-b global region"},"us-isob-east-1":{description:"US ISOB East (Ohio)"},"us-isob-west-1":{description:"US ISOB West"}}},{id:"aws-iso-e",outputs:{dnsSuffix:"cloud.adc-e.uk",dualStackDnsSuffix:"api.cloud-aws.adc-e.uk",implicitGlobalRegion:"eu-isoe-west-1",name:"aws-iso-e",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^eu\\-isoe\\-\\w+\\-\\d+$",regions:{"aws-iso-e-global":{description:"aws-iso-e global region"},"eu-isoe-west-1":{description:"EU ISOE West"}}},{id:"aws-iso-f",outputs:{dnsSuffix:"csp.hci.ic.gov",dualStackDnsSuffix:"api.aws.hci.ic.gov",implicitGlobalRegion:"us-isof-south-1",name:"aws-iso-f",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-isof\\-\\w+\\-\\d+$",regions:{"aws-iso-f-global":{description:"aws-iso-f global region"},"us-isof-east-1":{description:"US ISOF EAST"},"us-isof-south-1":{description:"US ISOF SOUTH"}}},{id:"aws-us-gov",outputs:{dnsSuffix:"amazonaws.com",dualStackDnsSuffix:"api.aws",implicitGlobalRegion:"us-gov-west-1",name:"aws-us-gov",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-gov\\-\\w+\\-\\d+$",regions:{"aws-us-gov-global":{description:"aws-us-gov global region"},"us-gov-east-1":{description:"AWS GovCloud (US-East)"},"us-gov-west-1":{description:"AWS GovCloud (US-West)"}}}],FD={partitions:PD};let jD=FD;const OD=r=>{const{partitions:e}=jD;for(const n of e){const{regions:s,outputs:i}=n;for(const[c,u]of Object.entries(s))if(c===r)return{...i,...u}}for(const n of e){const{regionRegex:s,outputs:i}=n;if(new RegExp(s).test(r))return{...i}}const t=e.find(n=>n.id==="aws");if(!t)throw new Error("Provided region was not found in the partition array or regex, and default partition with id 'aws' doesn't exist.");return{...t.outputs}},DD={isVirtualHostableS3Bucket:J1,parseArn:ID,partition:OD};nh.aws=DD;function LD(r){const e={};if(r=r.replace(/^\?/,""),r)for(const t of r.split("&")){let[n,s=null]=t.split("=");n=decodeURIComponent(n),s&&(s=decodeURIComponent(s)),n in e?Array.isArray(e[n])?e[n].push(s):e[n]=[e[n],s]:e[n]=s}return e}const Cm=r=>{if(typeof r=="string")return Cm(new URL(r));const{hostname:e,pathname:t,port:n,protocol:s,search:i}=r;let c;return i&&(c=LD(i)),{hostname:e,port:n?parseInt(n):void 0,protocol:s,path:t,query:c}};function MD(r,e,t){return r.$source||(r.$source={}),r.$source[e]=t,r}function Na(r,e,t){r.__aws_sdk_context?r.__aws_sdk_context.features||(r.__aws_sdk_context.features={}):r.__aws_sdk_context={features:{}},r.__aws_sdk_context.features[e]=t}const kS=r=>{var e,t;return rh.isInstance(r)?((e=r.headers)==null?void 0:e.date)??((t=r.headers)==null?void 0:t.Date):void 0},X1=r=>new Date(Date.now()+r),$D=(r,e)=>Math.abs(X1(e).getTime()-r)>=3e5,NS=(r,e)=>{const t=Date.parse(r);return $D(t,e)?t-Date.now():e},gm=(r,e)=>{if(!e)throw new Error(`Property \`${r}\` is not resolved for AWS SDK SigV4Auth`);return e},UD=async r=>{var m,g,x;const e=gm("context",r.context),t=gm("config",r.config),n=(x=(g=(m=e.endpointV2)==null?void 0:m.properties)==null?void 0:g.authSchemes)==null?void 0:x[0],i=await gm("signer",t.signer)(n),c=r==null?void 0:r.signingRegion,u=r==null?void 0:r.signingRegionSet,p=r==null?void 0:r.signingName;return{config:t,signer:i,signingRegion:c,signingRegionSet:u,signingName:p}};class Q1{async sign(e,t,n){var x;if(!Vo.isInstance(e))throw new Error("The request is not an instance of `HttpRequest` and cannot be signed");const s=await UD(n),{config:i,signer:c}=s;let{signingRegion:u,signingName:p}=s;const m=n.context;if(((x=m==null?void 0:m.authSchemes)==null?void 0:x.length)??!1){const[b,E]=m.authSchemes;(b==null?void 0:b.name)==="sigv4a"&&(E==null?void 0:E.name)==="sigv4"&&(u=(E==null?void 0:E.signingRegion)??u,p=(E==null?void 0:E.signingName)??p)}return await c.sign(e,{signingDate:X1(i.systemClockOffset),signingRegion:u,signingService:p})}errorHandler(e){return t=>{const n=t.ServerTime??kS(t.$response);if(n){const s=gm("config",e.config),i=s.systemClockOffset;s.systemClockOffset=NS(n,s.systemClockOffset),s.systemClockOffset!==i&&t.$metadata&&(t.$metadata.clockSkewCorrected=!0)}throw t}}successHandler(e,t){const n=kS(e);if(n){const s=gm("config",t.config);s.systemClockOffset=NS(n,s.systemClockOffset)}}}const zD=(r,e,t)=>{let n,s,i,c=!1;const u=async()=>{s||(s=r());try{n=await s,i=!0,c=!1}finally{s=void 0}return n};return async p=>((!i||p!=null&&p.forceRefresh)&&(n=await u()),n)},HD="X-Amz-Algorithm",BD="X-Amz-Credential",Z1="X-Amz-Date",GD="X-Amz-SignedHeaders",WD="X-Amz-Expires",eN="X-Amz-Signature",tN="X-Amz-Security-Token",rN="authorization",nN=Z1.toLowerCase(),VD="date",qD=[rN,nN,VD],KD=eN.toLowerCase(),Aw="x-amz-content-sha256",YD=tN.toLowerCase(),JD={authorization:!0,"cache-control":!0,connection:!0,expect:!0,from:!0,"keep-alive":!0,"max-forwards":!0,pragma:!0,referer:!0,te:!0,trailer:!0,"transfer-encoding":!0,upgrade:!0,"user-agent":!0,"x-amzn-trace-id":!0},XD=/^proxy-/,QD=/^sec-/,bx="AWS4-HMAC-SHA256",ZD="AWS4-HMAC-SHA256-PAYLOAD",eL="UNSIGNED-PAYLOAD",tL=50,sN="aws4_request",rL=3600*24*7,gv={},_x=[],Ex=(r,e,t)=>`${r}/${e}/${t}/${sN}`,nL=async(r,e,t,n,s)=>{const i=await TS(r,e.secretAccessKey,e.accessKeyId),c=`${t}:${n}:${s}:${Zu(i)}:${e.sessionToken}`;if(c in gv)return gv[c];for(_x.push(c);_x.length>tL;)delete gv[_x.shift()];let u=`AWS4${e.secretAccessKey}`;for(const p of[t,n,s,sN])u=await TS(r,u,p);return gv[c]=u},TS=(r,e,t)=>{const n=new r(e);return n.update(bm(t)),n.digest()},RS=({headers:r},e,t)=>{const n={};for(const s of Object.keys(r).sort()){if(r[s]==null)continue;const i=s.toLowerCase();(i in JD||e!=null&&e.has(i)||XD.test(i)||QD.test(i))&&(!t||t&&!t.has(i))||(n[i]=r[s].trim().replace(/\s+/g," "))}return n},sL=r=>typeof ArrayBuffer=="function"&&r instanceof ArrayBuffer||Object.prototype.toString.call(r)==="[object ArrayBuffer]",Sx=async({headers:r,body:e},t)=>{for(const n of Object.keys(r))if(n.toLowerCase()===Aw)return r[n];if(e==null)return"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855";if(typeof e=="string"||ArrayBuffer.isView(e)||sL(e)){const n=new t;return n.update(bm(e)),Zu(await n.digest())}return eL};class oL{format(e){const t=[];for(const i of Object.keys(e)){const c=ed(i);t.push(Uint8Array.from([c.byteLength]),c,this.formatHeaderValue(e[i]))}const n=new Uint8Array(t.reduce((i,c)=>i+c.byteLength,0));let s=0;for(const i of t)n.set(i,s),s+=i.byteLength;return n}formatHeaderValue(e){switch(e.type){case"boolean":return Uint8Array.from([e.value?0:1]);case"byte":return Uint8Array.from([2,e.value]);case"short":const t=new DataView(new ArrayBuffer(3));return t.setUint8(0,3),t.setInt16(1,e.value,!1),new Uint8Array(t.buffer);case"integer":const n=new DataView(new ArrayBuffer(5));return n.setUint8(0,4),n.setInt32(1,e.value,!1),new Uint8Array(n.buffer);case"long":const s=new Uint8Array(9);return s[0]=5,s.set(e.value.bytes,1),s;case"binary":const i=new DataView(new ArrayBuffer(3+e.value.byteLength));i.setUint8(0,6),i.setUint16(1,e.value.byteLength,!1);const c=new Uint8Array(i.buffer);return c.set(e.value,3),c;case"string":const u=ed(e.value),p=new DataView(new ArrayBuffer(3+u.byteLength));p.setUint8(0,7),p.setUint16(1,u.byteLength,!1);const m=new Uint8Array(p.buffer);return m.set(u,3),m;case"timestamp":const g=new Uint8Array(9);return g[0]=8,g.set(jb.fromNumber(e.value.valueOf()).bytes,1),g;case"uuid":if(!iL.test(e.value))throw new Error(`Invalid UUID received: ${e.value}`);const x=new Uint8Array(17);return x[0]=9,x.set(_2(e.value.replace(/\-/g,"")),1),x}}}var AS;(function(r){r[r.boolTrue=0]="boolTrue",r[r.boolFalse=1]="boolFalse",r[r.byte=2]="byte",r[r.short=3]="short",r[r.integer=4]="integer",r[r.long=5]="long",r[r.byteArray=6]="byteArray",r[r.string=7]="string",r[r.timestamp=8]="timestamp",r[r.uuid=9]="uuid"})(AS||(AS={}));const iL=/^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$/;class jb{constructor(e){H(this,"bytes");if(this.bytes=e,e.byteLength!==8)throw new Error("Int64 buffers must be exactly 8 bytes")}static fromNumber(e){if(e>9223372036854776e3||e<-9223372036854776e3)throw new Error(`${e} is too large (or, if negative, too small) to represent as an Int64`);const t=new Uint8Array(8);for(let n=7,s=Math.abs(Math.round(e));n>-1&&s>0;n--,s/=256)t[n]=s;return e<0&&IS(t),new jb(t)}valueOf(){const e=this.bytes.slice(0),t=e[0]&128;return t&&IS(e),parseInt(Zu(e),16)*(t?-1:1)}toString(){return String(this.valueOf())}}function IS(r){for(let e=0;e<8;e++)r[e]^=255;for(let e=7;e>-1&&(r[e]++,r[e]===0);e--);}const aL=(r,e)=>{r=r.toLowerCase();for(const t of Object.keys(e))if(r===t.toLowerCase())return!0;return!1},lL=(r,e={})=>{var s,i;const{headers:t,query:n={}}=Vo.clone(r);for(const c of Object.keys(t)){const u=c.toLowerCase();(u.slice(0,6)==="x-amz-"&&!((s=e.unhoistableHeaders)!=null&&s.has(u))||(i=e.hoistableHeaders)!=null&&i.has(u))&&(n[c]=t[c],delete t[c])}return{...r,headers:t,query:n}},PS=r=>{r=Vo.clone(r);for(const e of Object.keys(r.headers))qD.indexOf(e.toLowerCase())>-1&&delete r.headers[e];return r},cL=({query:r={}})=>{const e=[],t={};for(const n of Object.keys(r)){if(n.toLowerCase()===KD)continue;const s=Qu(n);e.push(s);const i=r[n];typeof i=="string"?t[s]=`${s}=${Qu(i)}`:Array.isArray(i)&&(t[s]=i.slice(0).reduce((c,u)=>c.concat([`${s}=${Qu(u)}`]),[]).sort().join("&"))}return e.sort().map(n=>t[n]).filter(n=>n).join("&")},uL=r=>dL(r).toISOString().replace(/\.\d{3}Z$/,"Z"),dL=r=>typeof r=="number"?new Date(r*1e3):typeof r=="string"?Number(r)?new Date(Number(r)*1e3):new Date(r):r;class fL{constructor({applyChecksum:e,credentials:t,region:n,service:s,sha256:i,uriEscapePath:c=!0}){H(this,"service");H(this,"regionProvider");H(this,"credentialProvider");H(this,"sha256");H(this,"uriEscapePath");H(this,"applyChecksum");this.service=s,this.sha256=i,this.uriEscapePath=c,this.applyChecksum=typeof e=="boolean"?e:!0,this.regionProvider=Vi(n),this.credentialProvider=Vi(t)}createCanonicalRequest(e,t,n){const s=Object.keys(t).sort();return`${e.method}
${this.getCanonicalPath(e)}
${cL(e)}
${s.map(i=>`${i}:${t[i]}`).join(`
`)}

${s.join(";")}
${n}`}async createStringToSign(e,t,n,s){const i=new this.sha256;i.update(bm(n));const c=await i.digest();return`${s}
${e}
${t}
${Zu(c)}`}getCanonicalPath({path:e}){if(this.uriEscapePath){const t=[];for(const i of e.split("/"))(i==null?void 0:i.length)!==0&&i!=="."&&(i===".."?t.pop():t.push(i));const n=`${e!=null&&e.startsWith("/")?"/":""}${t.join("/")}${t.length>0&&(e!=null&&e.endsWith("/"))?"/":""}`;return Qu(n).replace(/%2F/g,"/")}return e}validateResolvedCredentials(e){if(typeof e!="object"||typeof e.accessKeyId!="string"||typeof e.secretAccessKey!="string")throw new Error("Resolved credential object is not valid")}formatDate(e){const t=uL(e).replace(/[\-:]/g,"");return{longDate:t,shortDate:t.slice(0,8)}}getCanonicalHeaderList(e){return Object.keys(e).sort().join(";")}}class FS extends fL{constructor({applyChecksum:t,credentials:n,region:s,service:i,sha256:c,uriEscapePath:u=!0}){super({applyChecksum:t,credentials:n,region:s,service:i,sha256:c,uriEscapePath:u});H(this,"headerFormatter",new oL)}async presign(t,n={}){const{signingDate:s=new Date,expiresIn:i=3600,unsignableHeaders:c,unhoistableHeaders:u,signableHeaders:p,hoistableHeaders:m,signingRegion:g,signingService:x}=n,b=await this.credentialProvider();this.validateResolvedCredentials(b);const E=g??await this.regionProvider(),{longDate:T,shortDate:S}=this.formatDate(s);if(i>rL)return Promise.reject("Signature version 4 presigned URLs must have an expiration date less than one week in the future");const N=Ex(S,E,x??this.service),R=lL(PS(t),{unhoistableHeaders:u,hoistableHeaders:m});b.sessionToken&&(R.query[tN]=b.sessionToken),R.query[HD]=bx,R.query[BD]=`${b.accessKeyId}/${N}`,R.query[Z1]=T,R.query[WD]=i.toString(10);const A=RS(R,c,p);return R.query[GD]=this.getCanonicalHeaderList(A),R.query[eN]=await this.getSignature(T,N,this.getSigningKey(b,E,S,x),this.createCanonicalRequest(R,A,await Sx(t,this.sha256))),R}async sign(t,n){return typeof t=="string"?this.signString(t,n):t.headers&&t.payload?this.signEvent(t,n):t.message?this.signMessage(t,n):this.signRequest(t,n)}async signEvent({headers:t,payload:n},{signingDate:s=new Date,priorSignature:i,signingRegion:c,signingService:u}){const p=c??await this.regionProvider(),{shortDate:m,longDate:g}=this.formatDate(s),x=Ex(m,p,u??this.service),b=await Sx({headers:{},body:n},this.sha256),E=new this.sha256;E.update(t);const T=Zu(await E.digest()),S=[ZD,g,x,i,T,b].join(`
`);return this.signString(S,{signingDate:s,signingRegion:p,signingService:u})}async signMessage(t,{signingDate:n=new Date,signingRegion:s,signingService:i}){return this.signEvent({headers:this.headerFormatter.format(t.message.headers),payload:t.message.body},{signingDate:n,signingRegion:s,signingService:i,priorSignature:t.priorSignature}).then(u=>({message:t.message,signature:u}))}async signString(t,{signingDate:n=new Date,signingRegion:s,signingService:i}={}){const c=await this.credentialProvider();this.validateResolvedCredentials(c);const u=s??await this.regionProvider(),{shortDate:p}=this.formatDate(n),m=new this.sha256(await this.getSigningKey(c,u,p,i));return m.update(bm(t)),Zu(await m.digest())}async signRequest(t,{signingDate:n=new Date,signableHeaders:s,unsignableHeaders:i,signingRegion:c,signingService:u}={}){const p=await this.credentialProvider();this.validateResolvedCredentials(p);const m=c??await this.regionProvider(),g=PS(t),{longDate:x,shortDate:b}=this.formatDate(n),E=Ex(b,m,u??this.service);g.headers[nN]=x,p.sessionToken&&(g.headers[YD]=p.sessionToken);const T=await Sx(g,this.sha256);!aL(Aw,g.headers)&&this.applyChecksum&&(g.headers[Aw]=T);const S=RS(g,i,s),N=await this.getSignature(x,E,this.getSigningKey(p,m,b,u),this.createCanonicalRequest(g,S,T));return g.headers[rN]=`${bx} Credential=${p.accessKeyId}/${E}, SignedHeaders=${this.getCanonicalHeaderList(S)}, Signature=${N}`,g}async getSignature(t,n,s,i){const c=await this.createStringToSign(t,n,i,bx),u=new this.sha256(await s);return u.update(bm(c)),Zu(await u.digest())}getSigningKey(t,n,s,i){return nL(this.sha256,t,s,n,i||this.service)}}const oN=r=>{let e=r.credentials,t=!!r.credentials,n;Object.defineProperty(r,"credentials",{set(m){m&&m!==e&&m!==n&&(t=!0),e=m;const g=hL(r,{credentials:e,credentialDefaultProvider:r.credentialDefaultProvider}),x=pL(r,g);if(t&&!x.attributed){const b=typeof e=="object"&&e!==null;n=async E=>{const S=await x(E);return b&&(!S.$source||Object.keys(S.$source).length===0)?MD(S,"CREDENTIALS_CODE","e"):S},n.memoized=x.memoized,n.configBound=x.configBound,n.attributed=!0}else n=x},get(){return n},enumerable:!0,configurable:!0}),r.credentials=e;const{signingEscapePath:s=!0,systemClockOffset:i=r.systemClockOffset||0,sha256:c}=r;let u;return r.signer?u=pm(r.signer):r.regionInfoProvider?u=()=>pm(r.region)().then(async m=>[await r.regionInfoProvider(m,{useFipsEndpoint:await r.useFipsEndpoint(),useDualstackEndpoint:await r.useDualstackEndpoint()})||{},m]).then(([m,g])=>{const{signingRegion:x,signingService:b}=m;r.signingRegion=r.signingRegion||x||g,r.signingName=r.signingName||b||r.serviceId;const E={...r,credentials:r.credentials,region:r.signingRegion,service:r.signingName,sha256:c,uriEscapePath:s},T=r.signerConstructor||FS;return new T(E)}):u=async m=>{m=Object.assign({},{name:"sigv4",signingName:r.signingName||r.defaultSigningName,signingRegion:await pm(r.region)(),properties:{}},m);const g=m.signingRegion,x=m.signingName;r.signingRegion=r.signingRegion||g,r.signingName=r.signingName||x||r.serviceId;const b={...r,credentials:r.credentials,region:r.signingRegion,service:r.signingName,sha256:c,uriEscapePath:s},E=r.signerConstructor||FS;return new E(b)},Object.assign(r,{systemClockOffset:i,signingEscapePath:s,signer:u})};function hL(r,{credentials:e,credentialDefaultProvider:t}){let n;return e?e!=null&&e.memoized?n=e:n=cD(e,lD,L1):t?n=pm(t(Object.assign({},r,{parentClientConfig:r}))):n=async()=>{throw new Error("@aws-sdk/core::resolveAwsSdkSigV4Config - `credentials` not provided and no credentialDefaultProvider was configured.")},n.memoized=!0,n}function pL(r,e){if(e.configBound)return e;const t=async n=>e({...n,callerClientConfig:r});return t.memoized=e.memoized,t.configBound=!0,t}const jS=typeof TextEncoder=="function"?new TextEncoder:null,iN=r=>{if(typeof r=="string"){if(jS)return jS.encode(r).byteLength;let e=r.length;for(let t=e-1;t>=0;t--){const n=r.charCodeAt(t);n>127&&n<=2047?e++:n>2047&&n<=65535&&(e+=2),n>=56320&&n<=57343&&t--}return e}else{if(typeof r.byteLength=="number")return r.byteLength;if(typeof r.size=="number")return r.size}throw new Error(`Body Length computation failed for ${r}`)},Hu=(r,e)=>{const t=[];if(r&&t.push(r),e)for(const n of e)t.push(n);return t},kc=(r,e)=>`${r||"anonymous"}${e&&e.length>0?` (a.k.a. ${e.join(",")})`:""}`,ty=()=>{let r=[],e=[],t=!1;const n=new Set,s=x=>x.sort((b,E)=>OS[E.step]-OS[b.step]||DS[E.priority||"normal"]-DS[b.priority||"normal"]),i=x=>{let b=!1;const E=T=>{const S=Hu(T.name,T.aliases);if(S.includes(x)){b=!0;for(const N of S)n.delete(N);return!1}return!0};return r=r.filter(E),e=e.filter(E),b},c=x=>{let b=!1;const E=T=>{if(T.middleware===x){b=!0;for(const S of Hu(T.name,T.aliases))n.delete(S);return!1}return!0};return r=r.filter(E),e=e.filter(E),b},u=x=>{var b;return r.forEach(E=>{x.add(E.middleware,{...E})}),e.forEach(E=>{x.addRelativeTo(E.middleware,{...E})}),(b=x.identifyOnResolve)==null||b.call(x,g.identifyOnResolve()),x},p=x=>{const b=[];return x.before.forEach(E=>{E.before.length===0&&E.after.length===0?b.push(E):b.push(...p(E))}),b.push(x),x.after.reverse().forEach(E=>{E.before.length===0&&E.after.length===0?b.push(E):b.push(...p(E))}),b},m=(x=!1)=>{const b=[],E=[],T={};return r.forEach(N=>{const R={...N,before:[],after:[]};for(const A of Hu(R.name,R.aliases))T[A]=R;b.push(R)}),e.forEach(N=>{const R={...N,before:[],after:[]};for(const A of Hu(R.name,R.aliases))T[A]=R;E.push(R)}),E.forEach(N=>{if(N.toMiddleware){const R=T[N.toMiddleware];if(R===void 0){if(x)return;throw new Error(`${N.toMiddleware} is not found when adding ${kc(N.name,N.aliases)} middleware ${N.relation} ${N.toMiddleware}`)}N.relation==="after"&&R.after.push(N),N.relation==="before"&&R.before.push(N)}}),s(b).map(p).reduce((N,R)=>(N.push(...R),N),[])},g={add:(x,b={})=>{const{name:E,override:T,aliases:S}=b,N={step:"initialize",priority:"normal",middleware:x,...b},R=Hu(E,S);if(R.length>0){if(R.some(A=>n.has(A))){if(!T)throw new Error(`Duplicate middleware name '${kc(E,S)}'`);for(const A of R){const j=r.findIndex(M=>{var B;return M.name===A||((B=M.aliases)==null?void 0:B.some(U=>U===A))});if(j===-1)continue;const P=r[j];if(P.step!==N.step||N.priority!==P.priority)throw new Error(`"${kc(P.name,P.aliases)}" middleware with ${P.priority} priority in ${P.step} step cannot be overridden by "${kc(E,S)}" middleware with ${N.priority} priority in ${N.step} step.`);r.splice(j,1)}}for(const A of R)n.add(A)}r.push(N)},addRelativeTo:(x,b)=>{const{name:E,override:T,aliases:S}=b,N={middleware:x,...b},R=Hu(E,S);if(R.length>0){if(R.some(A=>n.has(A))){if(!T)throw new Error(`Duplicate middleware name '${kc(E,S)}'`);for(const A of R){const j=e.findIndex(M=>{var B;return M.name===A||((B=M.aliases)==null?void 0:B.some(U=>U===A))});if(j===-1)continue;const P=e[j];if(P.toMiddleware!==N.toMiddleware||P.relation!==N.relation)throw new Error(`"${kc(P.name,P.aliases)}" middleware ${P.relation} "${P.toMiddleware}" middleware cannot be overridden by "${kc(E,S)}" middleware ${N.relation} "${N.toMiddleware}" middleware.`);e.splice(j,1)}}for(const A of R)n.add(A)}e.push(N)},clone:()=>u(ty()),use:x=>{x.applyToStack(g)},remove:x=>typeof x=="string"?i(x):c(x),removeByTag:x=>{let b=!1;const E=T=>{const{tags:S,name:N,aliases:R}=T;if(S&&S.includes(x)){const A=Hu(N,R);for(const j of A)n.delete(j);return b=!0,!1}return!0};return r=r.filter(E),e=e.filter(E),b},concat:x=>{var E;const b=u(ty());return b.use(x),b.identifyOnResolve(t||b.identifyOnResolve()||(((E=x.identifyOnResolve)==null?void 0:E.call(x))??!1)),b},applyToStack:u,identify:()=>m(!0).map(x=>{const b=x.step??x.relation+" "+x.toMiddleware;return kc(x.name,x.aliases)+" - "+b}),identifyOnResolve(x){return typeof x=="boolean"&&(t=x),t},resolve:(x,b)=>{for(const E of m().map(T=>T.middleware).reverse())x=E(x,b);return t&&console.log(g.identify()),x}};return g},OS={initialize:5,serialize:4,build:3,finalizeRequest:2,deserialize:1},DS={high:3,normal:2,low:1};class aN{constructor(e){H(this,"config");H(this,"middlewareStack",ty());H(this,"initConfig");H(this,"handlers");this.config=e;const{protocol:t,protocolSettings:n}=e;n&&typeof t=="function"&&(e.protocol=new t(n))}send(e,t,n){const s=typeof t!="function"?t:void 0,i=typeof t=="function"?t:n,c=s===void 0&&this.config.cacheMiddleware===!0;let u;if(c){this.handlers||(this.handlers=new WeakMap);const p=this.handlers;p.has(e.constructor)?u=p.get(e.constructor):(u=e.resolveMiddleware(this.middlewareStack,this.config,s),p.set(e.constructor,u))}else delete this.handlers,u=e.resolveMiddleware(this.middlewareStack,this.config,s);if(i)u(e).then(p=>i(null,p.output),p=>i(p)).catch(()=>{});else return u(e).then(p=>p.output)}destroy(){var e,t,n;(n=(t=(e=this.config)==null?void 0:e.requestHandler)==null?void 0:t.destroy)==null||n.call(t),delete this.handlers}}const Cx="***SensitiveInformation***";function Iw(r,e){if(e==null)return e;const t=So.of(r);if(t.getMergedTraits().sensitive)return Cx;if(t.isListSchema()){if(!!t.getValueSchema().getMergedTraits().sensitive)return Cx}else if(t.isMapSchema()){if(!!t.getKeySchema().getMergedTraits().sensitive||!!t.getValueSchema().getMergedTraits().sensitive)return Cx}else if(t.isStructSchema()&&typeof e=="object"){const n=e,s={};for(const[i,c]of t.structIterator())n[i]!=null&&(s[i]=Iw(c,n[i]));return s}return e}class lN{constructor(){H(this,"middlewareStack",ty());H(this,"schema")}static classBuilder(){return new mL}resolveMiddlewareWithContext(e,t,n,{middlewareFn:s,clientName:i,commandName:c,inputFilterSensitiveLog:u,outputFilterSensitiveLog:p,smithyContext:m,additionalContext:g,CommandCtor:x}){for(const N of s.bind(this)(x,e,t,n))this.middlewareStack.use(N);const b=e.concat(this.middlewareStack),{logger:E}=t,T={logger:E,clientName:i,commandName:c,inputFilterSensitiveLog:u,outputFilterSensitiveLog:p,[Cw]:{commandInstance:this,...m},...g},{requestHandler:S}=t;return b.resolve(N=>S.handle(N.request,n||{}),T)}}class mL{constructor(){H(this,"_init",()=>{});H(this,"_ep",{});H(this,"_middlewareFn",()=>[]);H(this,"_commandName","");H(this,"_clientName","");H(this,"_additionalContext",{});H(this,"_smithyContext",{});H(this,"_inputFilterSensitiveLog");H(this,"_outputFilterSensitiveLog");H(this,"_serializer",null);H(this,"_deserializer",null);H(this,"_operationSchema")}init(e){this._init=e}ep(e){return this._ep=e,this}m(e){return this._middlewareFn=e,this}s(e,t,n={}){return this._smithyContext={service:e,operation:t,...n},this}c(e={}){return this._additionalContext=e,this}n(e,t){return this._clientName=e,this._commandName=t,this}f(e=n=>n,t=n=>n){return this._inputFilterSensitiveLog=e,this._outputFilterSensitiveLog=t,this}ser(e){return this._serializer=e,this}de(e){return this._deserializer=e,this}sc(e){return this._operationSchema=e,this._smithyContext.operationSchema=e,this}build(){const e=this;let t;return t=class extends lN{constructor(...[s]){super();H(this,"input");H(this,"serialize",e._serializer);H(this,"deserialize",e._deserializer);this.input=s??{},e._init(this),this.schema=e._operationSchema}static getEndpointParameterInstructions(){return e._ep}resolveMiddleware(s,i,c){const u=e._operationSchema,p=(u==null?void 0:u[4])??(u==null?void 0:u.input),m=(u==null?void 0:u[5])??(u==null?void 0:u.output);return this.resolveMiddlewareWithContext(s,i,c,{CommandCtor:t,middlewareFn:e._middlewareFn,clientName:e._clientName,commandName:e._commandName,inputFilterSensitiveLog:e._inputFilterSensitiveLog??(u?Iw.bind(null,p):g=>g),outputFilterSensitiveLog:e._outputFilterSensitiveLog??(u?Iw.bind(null,m):g=>g),smithyContext:e._smithyContext,additionalContext:e._additionalContext})}}}}class Bf extends Error{constructor(t){super(t.message);H(this,"$fault");H(this,"$response");H(this,"$retryable");H(this,"$metadata");Object.setPrototypeOf(this,Object.getPrototypeOf(this).constructor.prototype),this.name=t.name,this.$fault=t.$fault,this.$metadata=t.$metadata}static isInstance(t){if(!t)return!1;const n=t;return Bf.prototype.isPrototypeOf(n)||!!n.$fault&&!!n.$metadata&&(n.$fault==="client"||n.$fault==="server")}static[Symbol.hasInstance](t){if(!t)return!1;const n=t;return this===Bf?Bf.isInstance(t):Bf.isInstance(t)?n.name&&this.name?this.prototype.isPrototypeOf(t)||n.name===this.name:this.prototype.isPrototypeOf(t):!1}}const LS=(r,e={})=>{Object.entries(e).filter(([,n])=>n!==void 0).forEach(([n,s])=>{(r[n]==null||r[n]==="")&&(r[n]=s)});const t=r.message||r.Message||"UnknownError";return r.message=t,delete r.Message,r},cN=r=>{switch(r){case"standard":return{retryMode:"standard",connectionTimeout:3100};case"in-region":return{retryMode:"standard",connectionTimeout:1100};case"cross-region":return{retryMode:"standard",connectionTimeout:3100};case"mobile":return{retryMode:"standard",connectionTimeout:3e4};default:return{}}},gL=r=>{const e=[];for(const t in Zv){const n=Zv[t];r[n]!==void 0&&e.push({algorithmId:()=>n,checksumConstructor:()=>r[n]})}return{addChecksumAlgorithm(t){e.push(t)},checksumAlgorithms(){return e}}},vL=r=>{const e={};return r.checksumAlgorithms().forEach(t=>{e[t.algorithmId()]=t.checksumConstructor()}),e},yL=r=>({setRetryStrategy(e){r.retryStrategy=e},retryStrategy(){return r.retryStrategy}}),xL=r=>{const e={};return e.retryStrategy=r.retryStrategy(),e},uN=r=>Object.assign(gL(r),yL(r)),dN=r=>Object.assign(vL(r),xL(r));class Ob{trace(){}debug(){}info(){}warn(){}error(){}}class wL{constructor(e=!1){H(this,"queryCompat");this.queryCompat=e}resolveRestContentType(e,t){const n=t.getMemberSchemas(),s=Object.values(n).find(i=>!!i.getMergedTraits().httpPayload);if(s){const i=s.getMergedTraits().mediaType;return i||(s.isStringSchema()?"text/plain":s.isBlobSchema()?"application/octet-stream":e)}else if(!t.isUnitSchema()&&Object.values(n).find(c=>{const{httpQuery:u,httpQueryParams:p,httpHeader:m,httpLabel:g,httpPrefixHeaders:x}=c.getMergedTraits();return!u&&!p&&!m&&!g&&x===void 0}))return e}async getErrorSchemaOrThrowBaseException(e,t,n,s,i,c){let u=t,p=e;e.includes("#")&&([u,p]=e.split("#"));const m={$metadata:i,$fault:n.statusCode<500?"client":"server"},g=ht.for(u);try{return{errorSchema:(c==null?void 0:c(g,p))??g.getSchema(e),errorMetadata:m}}catch{s.message=s.message??s.Message??"UnknownError";const b=ht.for("smithy.ts.sdk.synthetic."+u),E=b.getBaseException();if(E){const T=b.getErrorCtor(E)??Error;throw this.decorateServiceException(Object.assign(new T({name:p}),m),s)}throw this.decorateServiceException(Object.assign(new Error(p),m),s)}}decorateServiceException(e,t={}){if(this.queryCompat){const n=e.Message??t.Message,s=LS(e,t);n&&(s.message=n),s.Error={...s.Error,Type:s.Error.Type,Code:s.Error.Code,Message:s.Error.message??s.Error.Message??n};const i=s.$metadata.requestId;return i&&(s.RequestId=i),s}return LS(e,t)}setQueryCompatError(e,t){var s;const n=(s=t.headers)==null?void 0:s["x-amzn-query-error"];if(e!==void 0&&n!=null){const[i,c]=n.split(";"),u=Object.entries(e),p={Code:i,Type:c};Object.assign(e,p);for(const[m,g]of u)p[m==="message"?"Message":m]=g;delete p.__type,e.Error=p}}queryCompatOutput(e,t){e.Error&&(t.Error=e.Error),e.Type&&(t.Type=e.Type),e.Code&&(t.Code=e.Code)}findQueryCompatibleError(e,t){try{return e.getSchema(t)}catch{return e.find(s=>{var i;return((i=So.of(s).getMergedTraits().awsQueryError)==null?void 0:i[0])===t})}}}class Db{constructor(){H(this,"serdeContext")}setSerdeContext(e){this.serdeContext=e}}class bL{constructor(e,t){H(this,"from");H(this,"to");H(this,"keys");this.from=e,this.to=t,this.keys=new Set(Object.keys(this.from).filter(n=>n!=="__type"))}mark(e){this.keys.delete(e)}hasUnknown(){return this.keys.size===1&&Object.keys(this.to).length===0}writeUnknown(){if(this.hasUnknown()){const e=this.keys.values().next().value,t=this.from[e];this.to.$unknown=[e,t]}}}function _L(r,e,t){if(t!=null&&t.source){const n=t.source;if(typeof e=="number"&&(e>Number.MAX_SAFE_INTEGER||e<Number.MIN_SAFE_INTEGER||n!==String(e)))return n.includes(".")?new Da(n,"bigDecimal"):BigInt(n)}return e}const EL=(r,e)=>Nw(r,e).then(t=>((e==null?void 0:e.utf8Encoder)??Ly)(t)),SL=(r,e)=>EL(r,e).then(t=>{if(t.length)try{return JSON.parse(t)}catch(n){throw(n==null?void 0:n.name)==="SyntaxError"&&Object.defineProperty(n,"$responseBodyText",{value:t}),n}return{}}),CL=(r,e)=>{const t=(i,c)=>Object.keys(i).find(u=>u.toLowerCase()===c.toLowerCase()),n=i=>{let c=i;return typeof c=="number"&&(c=c.toString()),c.indexOf(",")>=0&&(c=c.split(",")[0]),c.indexOf(":")>=0&&(c=c.split(":")[0]),c.indexOf("#")>=0&&(c=c.split("#")[1]),c},s=t(r.headers,"x-amzn-errortype");if(s!==void 0)return n(r.headers[s]);if(e&&typeof e=="object"){const i=t(e,"code");if(i&&e[i]!==void 0)return n(e[i]);if(e.__type!==void 0)return n(e.__type)}};class kL extends Db{constructor(t){super();H(this,"settings");this.settings=t}async read(t,n){return this._read(t,typeof n=="string"?JSON.parse(n,_L):await SL(n,this.serdeContext))}readObject(t,n){return this._read(t,n)}_read(t,n){const s=n!==null&&typeof n=="object",i=So.of(t);if(s){if(i.isStructSchema()){const u=n,p=i.isUnionSchema(),m={};let g;const{jsonName:x}=this.settings;x&&(g={});let b;p&&(b=new bL(u,m));for(const[E,T]of i.structIterator()){let S=E;x&&(S=T.getMergedTraits().jsonName??S,g[S]=E),p&&b.mark(S),u[S]!=null&&(m[E]=this._read(T,u[S]))}if(p)b.writeUnknown();else if(typeof u.__type=="string")for(const[E,T]of Object.entries(u)){const S=x?g[E]??E:E;S in m||(m[S]=T)}return m}if(Array.isArray(n)&&i.isListSchema()){const u=i.getValueSchema(),p=[],m=!!i.getMergedTraits().sparse;for(const g of n)(m||g!=null)&&p.push(this._read(u,g));return p}if(i.isMapSchema()){const u=i.getValueSchema(),p={},m=!!i.getMergedTraits().sparse;for(const[g,x]of Object.entries(n))(m||x!=null)&&(p[g]=this._read(u,x));return p}}if(i.isBlobSchema()&&typeof n=="string")return Um(n);const c=i.getMergedTraits().mediaType;if(i.isStringSchema()&&typeof n=="string"&&c)return c==="application/json"||c.endsWith("+json")?Dc.from(n):n;if(i.isTimestampSchema()&&n!=null)switch(j1(i,this.settings)){case 5:return U2(n);case 6:return G2(n);case 7:return W2(n);default:return console.warn("Missing timestamp format, parsing value with Date constructor:",n),new Date(n)}if(i.isBigIntegerSchema()&&(typeof n=="number"||typeof n=="string"))return BigInt(n);if(i.isBigDecimalSchema()&&n!=null){if(n instanceof Da)return n;const u=n;return u.type==="bigDecimal"&&"string"in u?new Da(u.string,u.type):new Da(String(n),"bigDecimal")}if(i.isNumericSchema()&&typeof n=="string"){switch(n){case"Infinity":return 1/0;case"-Infinity":return-1/0;case"NaN":return NaN}return n}if(i.isDocumentSchema())if(s){const u=Array.isArray(n)?[]:{};for(const[p,m]of Object.entries(n))m instanceof Da?u[p]=m:u[p]=this._read(i,m);return u}else return structuredClone(n);return n}}const MS="";class NL{constructor(){H(this,"values",new Map);H(this,"counter",0);H(this,"stage",0)}createReplacer(){if(this.stage===1)throw new Error("@aws-sdk/core/protocols - JsonReplacer already created.");if(this.stage===2)throw new Error("@aws-sdk/core/protocols - JsonReplacer exhausted.");return this.stage=1,(e,t)=>{if(t instanceof Da){const n=`${MS+"nv"+this.counter++}_`+t.string;return this.values.set(`"${n}"`,t.string),n}if(typeof t=="bigint"){const n=t.toString(),s=`${MS+"b"+this.counter++}_`+n;return this.values.set(`"${s}"`,n),s}return t}}replaceInJson(e){if(this.stage===0)throw new Error("@aws-sdk/core/protocols - JsonReplacer not created yet.");if(this.stage===2)throw new Error("@aws-sdk/core/protocols - JsonReplacer exhausted.");if(this.stage=2,this.counter===0)return e;for(const[t,n]of this.values)e=e.replace(t,n);return e}}class TL extends Db{constructor(t){super();H(this,"settings");H(this,"buffer");H(this,"useReplacer",!1);H(this,"rootSchema");this.settings=t}write(t,n){this.rootSchema=So.of(t),this.buffer=this._write(this.rootSchema,n)}writeDiscriminatedDocument(t,n){this.write(t,n),typeof this.buffer=="object"&&(this.buffer.__type=So.of(t).getName(!0))}flush(){const{rootSchema:t,useReplacer:n}=this;if(this.rootSchema=void 0,this.useReplacer=!1,t!=null&&t.isStructSchema()||t!=null&&t.isDocumentSchema()){if(!n)return JSON.stringify(this.buffer);const s=new NL;return s.replaceInJson(JSON.stringify(this.buffer,s.createReplacer(),0))}return this.buffer}_write(t,n,s){var u,p;const i=n!==null&&typeof n=="object",c=So.of(t);if(i){if(c.isStructSchema()){const m=n,g={},{jsonName:x}=this.settings;let b;x&&(b={});for(const[E,T]of c.structIterator()){const S=this._write(T,m[E],c);if(S!==void 0){let N=E;x&&(N=T.getMergedTraits().jsonName??E,b[E]=N),g[N]=S}}if(c.isUnionSchema()&&Object.keys(g).length===0){const{$unknown:E}=m;if(Array.isArray(E)){const[T,S]=E;g[T]=this._write(15,S)}}else if(typeof m.__type=="string")for(const[E,T]of Object.entries(m)){const S=x?b[E]??E:E;S in g||(g[S]=this._write(15,T))}return g}if(Array.isArray(n)&&c.isListSchema()){const m=c.getValueSchema(),g=[],x=!!c.getMergedTraits().sparse;for(const b of n)(x||b!=null)&&g.push(this._write(m,b));return g}if(c.isMapSchema()){const m=c.getValueSchema(),g={},x=!!c.getMergedTraits().sparse;for(const[b,E]of Object.entries(n))(x||E!=null)&&(g[b]=this._write(m,E));return g}if(n instanceof Uint8Array&&(c.isBlobSchema()||c.isDocumentSchema()))return c===this.rootSchema?n:(((u=this.serdeContext)==null?void 0:u.base64Encoder)??_m)(n);if(n instanceof Date&&(c.isTimestampSchema()||c.isDocumentSchema()))switch(j1(c,this.settings)){case 5:return n.toISOString().replace(".000Z","Z");case 6:return M2(n);case 7:return n.getTime()/1e3;default:return console.warn("Missing timestamp format, using epoch seconds",n),n.getTime()/1e3}n instanceof Da&&(this.useReplacer=!0)}if(!(n===null&&(s!=null&&s.isStructSchema()))){if(c.isStringSchema()){if(typeof n>"u"&&c.isIdempotencyToken())return F1();const m=c.getMergedTraits().mediaType;return n!=null&&m&&(m==="application/json"||m.endsWith("+json"))?Dc.from(n):n}if(typeof n=="number"&&c.isNumericSchema())return Math.abs(n)===1/0||isNaN(n)?String(n):n;if(typeof n=="string"&&c.isBlobSchema())return c===this.rootSchema?n:(((p=this.serdeContext)==null?void 0:p.base64Encoder)??_m)(n);if(typeof n=="bigint"&&(this.useReplacer=!0),c.isDocumentSchema())if(i){const m=Array.isArray(n)?[]:{};for(const[g,x]of Object.entries(n))x instanceof Da?(this.useReplacer=!0,m[g]=x):m[g]=this._write(c,x);return m}else return structuredClone(n);return n}}}class RL extends Db{constructor(t){super();H(this,"settings");this.settings=t}createSerializer(){const t=new TL(this.settings);return t.setSerdeContext(this.serdeContext),t}createDeserializer(){const t=new kL(this.settings);return t.setSerdeContext(this.serdeContext),t}}class AL extends sD{constructor({defaultNamespace:t,serviceTarget:n,awsQueryCompatible:s,jsonCodec:i}){super({defaultNamespace:t});H(this,"serializer");H(this,"deserializer");H(this,"serviceTarget");H(this,"codec");H(this,"mixin");H(this,"awsQueryCompatible");this.serviceTarget=n,this.codec=i??new RL({timestampFormat:{useTrait:!0,default:7},jsonName:!1}),this.serializer=this.codec.createSerializer(),this.deserializer=this.codec.createDeserializer(),this.awsQueryCompatible=!!s,this.mixin=new wL(this.awsQueryCompatible)}async serializeRequest(t,n,s){const i=await super.serializeRequest(t,n,s);return i.path.endsWith("/")||(i.path+="/"),Object.assign(i.headers,{"content-type":`application/x-amz-json-${this.getJsonRpcVersion()}`,"x-amz-target":`${this.serviceTarget}.${t.name}`}),this.awsQueryCompatible&&(i.headers["x-amzn-query-mode"]="true"),(Mv(t.input)==="unit"||!i.body)&&(i.body="{}"),i}getPayloadCodec(){return this.codec}async handleError(t,n,s,i,c){this.awsQueryCompatible&&this.mixin.setQueryCompatError(i,s);const u=CL(s,i)??"Unknown",{errorSchema:p,errorMetadata:m}=await this.mixin.getErrorSchemaOrThrowBaseException(u,this.options.defaultNamespace,s,i,c,this.awsQueryCompatible?this.mixin.findQueryCompatibleError:void 0),g=So.of(p),x=i.message??i.Message??"Unknown",b=ht.for(p[1]).getErrorCtor(p)??Error,E=new b(x),T={};for(const[S,N]of g.structIterator())i[S]!=null&&(T[S]=this.codec.createDeserializer().readObject(N,i[S]));throw this.awsQueryCompatible&&this.mixin.queryCompatOutput(i,T),this.mixin.decorateServiceException(Object.assign(E,m,{$fault:g.getMergedTraits().error,message:x},T),i)}}class fN extends AL{constructor({defaultNamespace:e,serviceTarget:t,awsQueryCompatible:n,jsonCodec:s}){super({defaultNamespace:e,serviceTarget:t,awsQueryCompatible:n,jsonCodec:s})}getShapeId(){return"aws.protocols#awsJson1_1"}getJsonRpcVersion(){return"1.1"}getDefaultContentType(){return"application/x-amz-json-1.1"}}const IL=/\d{12}\.ddb/;async function PL(r,e,t){var i,c,u,p,m,g,x;const n=t.request;if(((i=n==null?void 0:n.headers)==null?void 0:i["smithy-protocol"])==="rpc-v2-cbor"&&Na(r,"PROTOCOL_RPC_V2_CBOR","M"),typeof e.retryStrategy=="function"){const b=await e.retryStrategy();typeof b.acquireInitialRetryToken=="function"?(u=(c=b.constructor)==null?void 0:c.name)!=null&&u.includes("Adaptive")?Na(r,"RETRY_MODE_ADAPTIVE","F"):Na(r,"RETRY_MODE_STANDARD","E"):Na(r,"RETRY_MODE_LEGACY","D")}if(typeof e.accountIdEndpointMode=="function"){const b=r.endpointV2;switch(String((p=b==null?void 0:b.url)==null?void 0:p.hostname).match(IL)&&Na(r,"ACCOUNT_ID_ENDPOINT","O"),await((m=e.accountIdEndpointMode)==null?void 0:m.call(e))){case"disabled":Na(r,"ACCOUNT_ID_MODE_DISABLED","Q");break;case"preferred":Na(r,"ACCOUNT_ID_MODE_PREFERRED","P");break;case"required":Na(r,"ACCOUNT_ID_MODE_REQUIRED","R");break}}const s=(x=(g=r.__smithy_context)==null?void 0:g.selectedHttpAuthScheme)==null?void 0:x.identity;if(s!=null&&s.$source){const b=s;b.accountId&&Na(r,"RESOLVED_ACCOUNT_ID","T");for(const[E,T]of Object.entries(b.$source??{}))Na(r,E,T)}}const $S="user-agent",kx="x-amz-user-agent",US=" ",Nx="/",FL=/[^!$%&'*+\-.^_`|~\w]/g,jL=/[^!$%&'*+\-.^_`|~\w#]/g,zS="-",OL=1024;function DL(r){let e="";for(const t in r){const n=r[t];if(e.length+n.length+1<=OL){e.length?e+=","+n:e+=n;continue}break}return e}const LL=r=>(e,t)=>async n=>{var E,T,S,N;const{request:s}=n;if(!Vo.isInstance(s))return e(n);const{headers:i}=s,c=((E=t==null?void 0:t.userAgent)==null?void 0:E.map(vv))||[],u=(await r.defaultUserAgentProvider()).map(vv);await PL(t,r,n);const p=t;u.push(`m/${DL(Object.assign({},(T=t.__smithy_context)==null?void 0:T.features,(S=p.__aws_sdk_context)==null?void 0:S.features))}`);const m=((N=r==null?void 0:r.customUserAgent)==null?void 0:N.map(vv))||[],g=await r.userAgentAppId();g&&u.push(vv(["app",`${g}`]));const x=[].concat([...u,...c,...m]).join(US),b=[...u.filter(R=>R.startsWith("aws-sdk-")),...m].join(US);return r.runtime!=="browser"?(b&&(i[kx]=i[kx]?`${i[$S]} ${b}`:b),i[$S]=x):i[kx]=x,e({...n,request:s})},vv=r=>{var c;const e=r[0].split(Nx).map(u=>u.replace(FL,zS)).join(Nx),t=(c=r[1])==null?void 0:c.replace(jL,zS),n=e.indexOf(Nx),s=e.substring(0,n);let i=e.substring(n+1);return s==="api"&&(i=i.toLowerCase()),[s,i,t].filter(u=>u&&u.length>0).reduce((u,p,m)=>{switch(m){case 0:return p;case 1:return`${u}/${p}`;default:return`${u}#${p}`}},"")},ML={name:"getUserAgentMiddleware",step:"build",priority:"low",tags:["SET_USER_AGENT","USER_AGENT"],override:!0},hN=r=>({applyToStack:e=>{e.add(LL(r),ML)}}),pN=!1,mN=!1,HS=new Set,$L=(r,e=zm)=>{if(!HS.has(r)&&!e(r))if(r==="*")console.warn('@smithy/config-resolver WARN - Please use the caller region instead of "*". See "sigv4a" in https://github.com/aws/aws-sdk-js-v3/blob/main/supplemental-docs/CLIENTS.md.');else throw new Error(`Region not accepted: region="${r}" is not a valid hostname component.`);else HS.add(r)},gN=r=>typeof r=="string"&&(r.startsWith("fips-")||r.endsWith("-fips")),UL=r=>gN(r)?["fips-aws-global","aws-fips"].includes(r)?"us-east-1":r.replace(/fips-(dkr-|prod-)?|-fips/,""):r,vN=r=>{const{region:e,useFipsEndpoint:t}=r;if(!e)throw new Error("Region is missing");return Object.assign(r,{region:async()=>{const n=typeof e=="function"?await e():e,s=UL(n);return $L(s),s},useFipsEndpoint:async()=>{const n=typeof e=="string"?e:await e();return gN(n)?!0:typeof t!="function"?Promise.resolve(!!t):t()}})},BS="content-length";function zL(r){return e=>async t=>{const n=t.request;if(Vo.isInstance(n)){const{body:s,headers:i}=n;if(s&&Object.keys(i).map(c=>c.toLowerCase()).indexOf(BS)===-1)try{const c=r(s);n.headers={...n.headers,[BS]:String(c)}}catch{}}return e({...t,request:n})}}const HL={step:"build",tags:["SET_CONTENT_LENGTH","CONTENT_LENGTH"],name:"contentLengthMiddleware",override:!0},yN=r=>({applyToStack:e=>{e.add(zL(r.bodyLengthChecker),HL)}}),BL=async r=>{const e=(r==null?void 0:r.Bucket)||"";if(typeof r.Bucket=="string"&&(r.Bucket=e.replace(/#/g,encodeURIComponent("#")).replace(/\?/g,encodeURIComponent("?"))),KL(e)){if(r.ForcePathStyle===!0)throw new Error("Path-style addressing cannot be used with ARN buckets")}else(!qL(e)||e.indexOf(".")!==-1&&!String(r.Endpoint).startsWith("http:")||e.toLowerCase()!==e||e.length<3)&&(r.ForcePathStyle=!0);return r.DisableMultiRegionAccessPoints&&(r.disableMultiRegionAccessPoints=!0,r.DisableMRAP=!0),r},GL=/^[a-z0-9][a-z0-9\.\-]{1,61}[a-z0-9]$/,WL=/(\d+\.){3}\d+/,VL=/\.\./,qL=r=>GL.test(r)&&!WL.test(r)&&!VL.test(r),KL=r=>{const[e,t,n,,,s]=r.split(":"),i=e==="arn"&&r.split(":").length>=6,c=!!(i&&t&&n&&s);if(i&&!c)throw new Error(`Invalid ARN: ${r} was an invalid ARN.`);return c},YL=(r,e,t,n=!1)=>{const s=async()=>{let i;if(n){const c=t.clientContextParams;i=(c==null?void 0:c[r])??t[r]??t[e]}else i=t[r]??t[e];return typeof i=="function"?i():i};return r==="credentialScope"||e==="CredentialScope"?async()=>{const i=typeof t.credentials=="function"?await t.credentials():t.credentials;return(i==null?void 0:i.credentialScope)??(i==null?void 0:i.CredentialScope)}:r==="accountId"||e==="AccountId"?async()=>{const i=typeof t.credentials=="function"?await t.credentials():t.credentials;return(i==null?void 0:i.accountId)??(i==null?void 0:i.AccountId)}:r==="endpoint"||e==="endpoint"?async()=>{if(t.isCustomEndpoint===!1)return;const i=await s();if(i&&typeof i=="object"){if("url"in i)return i.url.href;if("hostname"in i){const{protocol:c,hostname:u,port:p,path:m}=i;return`${c}//${u}${p?":"+p:""}${m}`}}return i}:s},xN=async r=>{},wN=r=>typeof r=="object"?"url"in r?Cm(r.url):r:Cm(r),JL=async(r,e,t,n)=>{if(!t.isCustomEndpoint){let c;t.serviceConfiguredEndpoint?c=await t.serviceConfiguredEndpoint():c=await xN(t.serviceId),c&&(t.endpoint=()=>Promise.resolve(wN(c)),t.isCustomEndpoint=!0)}const s=await XL(r,e,t);if(typeof t.endpointProvider!="function")throw new Error("config.endpointProvider is not set.");return t.endpointProvider(s,n)},XL=async(r,e,t)=>{var i;const n={},s=((i=e==null?void 0:e.getEndpointParameterInstructions)==null?void 0:i.call(e))||{};for(const[c,u]of Object.entries(s))switch(u.type){case"staticContextParams":n[c]=u.value;break;case"contextParams":n[c]=r[u.name];break;case"clientContextParams":case"builtInParams":n[c]=await YL(u.name,c,t,u.type!=="builtInParams")();break;case"operationContextParams":n[c]=u.get(r);break;default:throw new Error("Unrecognized endpoint parameter instruction: "+JSON.stringify(u))}return Object.keys(s).length===0&&Object.assign(n,t),String(t.serviceId).toLowerCase()==="s3"&&await BL(n),n},QL=({config:r,instructions:e})=>(t,n)=>async s=>{var u,p,m;r.isCustomEndpoint&&oD(n,"ENDPOINT_OVERRIDE","N");const i=await JL(s.input,{getEndpointParameterInstructions(){return e}},{...r},n);n.endpointV2=i,n.authSchemes=(u=i.properties)==null?void 0:u.authSchemes;const c=(p=n.authSchemes)==null?void 0:p[0];if(c){n.signing_region=c.signingRegion,n.signing_service=c.signingName;const g=od(n),x=(m=g==null?void 0:g.selectedHttpAuthScheme)==null?void 0:m.httpAuthOption;x&&(x.signingProperties=Object.assign(x.signingProperties||{},{signing_region:c.signingRegion,signingRegion:c.signingRegion,signing_service:c.signingName,signingName:c.signingName,signingRegionSet:c.signingRegionSet},c.properties))}return t({...s})},ZL={step:"serialize",tags:["ENDPOINT_PARAMETERS","ENDPOINT_V2","ENDPOINT"],name:"endpointV2Middleware",override:!0,relation:"before",toMiddleware:c2.name},eM=(r,e)=>({applyToStack:t=>{t.addRelativeTo(QL({config:r,instructions:e}),ZL)}}),bN=r=>{const e=r.tls??!0,{endpoint:t,useDualstackEndpoint:n,useFipsEndpoint:s}=r,i=t!=null?async()=>wN(await Vi(t)()):void 0,u=Object.assign(r,{endpoint:i,tls:e,isCustomEndpoint:!!t,useDualstackEndpoint:Vi(n??!1),useFipsEndpoint:Vi(s??!1)});let p;return u.serviceConfiguredEndpoint=async()=>(r.serviceId&&!p&&(p=xN(r.serviceId)),p),u};var sh;(function(r){r.STANDARD="standard",r.ADAPTIVE="adaptive"})(sh||(sh={}));const km=3,_N=sh.STANDARD,tM=["BandwidthLimitExceeded","EC2ThrottledException","LimitExceededException","PriorRequestNotComplete","ProvisionedThroughputExceededException","RequestLimitExceeded","RequestThrottled","RequestThrottledException","SlowDown","ThrottledException","Throttling","ThrottlingException","TooManyRequestsException","TransactionInProgressException"],rM=["TimeoutError","RequestTimeout","RequestTimeoutException"],nM=[500,502,503,504],sM=["ECONNRESET","ECONNREFUSED","EPIPE","ETIMEDOUT"],oM=["EHOSTUNREACH","ENETUNREACH","ENOTFOUND"],iM=r=>(r==null?void 0:r.$retryable)!==void 0,aM=r=>{var e;return(e=r.$metadata)==null?void 0:e.clockSkewCorrected},lM=r=>{const e=new Set(["Failed to fetch","NetworkError when attempting to fetch resource","The Internet connection appears to be offline","Load failed","Network request failed"]);return r&&r instanceof TypeError?e.has(r.message):!1},EN=r=>{var e,t;return((e=r.$metadata)==null?void 0:e.httpStatusCode)===429||tM.includes(r.name)||((t=r.$retryable)==null?void 0:t.throttling)==!0},Lb=(r,e=0)=>{var t;return iM(r)||aM(r)||rM.includes(r.name)||sM.includes((r==null?void 0:r.code)||"")||oM.includes((r==null?void 0:r.code)||"")||nM.includes(((t=r.$metadata)==null?void 0:t.httpStatusCode)||0)||lM(r)||r.cause!==void 0&&e<=10&&Lb(r.cause,e+1)},cM=r=>{var e;if(((e=r.$metadata)==null?void 0:e.httpStatusCode)!==void 0){const t=r.$metadata.httpStatusCode;return 500<=t&&t<=599&&!Lb(r)}return!1},Dy=class Dy{constructor(e){H(this,"beta");H(this,"minCapacity");H(this,"minFillRate");H(this,"scaleConstant");H(this,"smooth");H(this,"currentCapacity",0);H(this,"enabled",!1);H(this,"lastMaxRate",0);H(this,"measuredTxRate",0);H(this,"requestCount",0);H(this,"fillRate");H(this,"lastThrottleTime");H(this,"lastTimestamp",0);H(this,"lastTxRateBucket");H(this,"maxCapacity");H(this,"timeWindow",0);this.beta=(e==null?void 0:e.beta)??.7,this.minCapacity=(e==null?void 0:e.minCapacity)??1,this.minFillRate=(e==null?void 0:e.minFillRate)??.5,this.scaleConstant=(e==null?void 0:e.scaleConstant)??.4,this.smooth=(e==null?void 0:e.smooth)??.8;const t=this.getCurrentTimeInSeconds();this.lastThrottleTime=t,this.lastTxRateBucket=Math.floor(this.getCurrentTimeInSeconds()),this.fillRate=this.minFillRate,this.maxCapacity=this.minCapacity}getCurrentTimeInSeconds(){return Date.now()/1e3}async getSendToken(){return this.acquireTokenBucket(1)}async acquireTokenBucket(e){if(this.enabled){if(this.refillTokenBucket(),e>this.currentCapacity){const t=(e-this.currentCapacity)/this.fillRate*1e3;await new Promise(n=>Dy.setTimeoutFn(n,t))}this.currentCapacity=this.currentCapacity-e}}refillTokenBucket(){const e=this.getCurrentTimeInSeconds();if(!this.lastTimestamp){this.lastTimestamp=e;return}const t=(e-this.lastTimestamp)*this.fillRate;this.currentCapacity=Math.min(this.maxCapacity,this.currentCapacity+t),this.lastTimestamp=e}updateClientSendingRate(e){let t;if(this.updateMeasuredRate(),EN(e)){const s=this.enabled?Math.min(this.measuredTxRate,this.fillRate):this.measuredTxRate;this.lastMaxRate=s,this.calculateTimeWindow(),this.lastThrottleTime=this.getCurrentTimeInSeconds(),t=this.cubicThrottle(s),this.enableTokenBucket()}else this.calculateTimeWindow(),t=this.cubicSuccess(this.getCurrentTimeInSeconds());const n=Math.min(t,2*this.measuredTxRate);this.updateTokenBucketRate(n)}calculateTimeWindow(){this.timeWindow=this.getPrecise(Math.pow(this.lastMaxRate*(1-this.beta)/this.scaleConstant,1/3))}cubicThrottle(e){return this.getPrecise(e*this.beta)}cubicSuccess(e){return this.getPrecise(this.scaleConstant*Math.pow(e-this.lastThrottleTime-this.timeWindow,3)+this.lastMaxRate)}enableTokenBucket(){this.enabled=!0}updateTokenBucketRate(e){this.refillTokenBucket(),this.fillRate=Math.max(e,this.minFillRate),this.maxCapacity=Math.max(e,this.minCapacity),this.currentCapacity=Math.min(this.currentCapacity,this.maxCapacity)}updateMeasuredRate(){const e=this.getCurrentTimeInSeconds(),t=Math.floor(e*2)/2;if(this.requestCount++,t>this.lastTxRateBucket){const n=this.requestCount/(t-this.lastTxRateBucket);this.measuredTxRate=this.getPrecise(n*this.smooth+this.measuredTxRate*(1-this.smooth)),this.requestCount=0,this.lastTxRateBucket=t}}getPrecise(e){return parseFloat(e.toFixed(8))}};H(Dy,"setTimeoutFn",setTimeout);let Pw=Dy;const Fw=100,SN=20*1e3,uM=500,GS=500,dM=5,fM=10,hM=1,pM="amz-sdk-invocation-id",mM="amz-sdk-request",gM=()=>{let r=Fw;return{computeNextBackoffDelay:n=>Math.floor(Math.min(SN,Math.random()*2**n*r)),setDelayBase:n=>{r=n}}},WS=({retryDelay:r,retryCount:e,retryCost:t})=>({getRetryCount:()=>e,getRetryDelay:()=>Math.min(SN,r),getRetryCost:()=>t});class CN{constructor(e){H(this,"maxAttempts");H(this,"mode",sh.STANDARD);H(this,"capacity",GS);H(this,"retryBackoffStrategy",gM());H(this,"maxAttemptsProvider");this.maxAttempts=e,this.maxAttemptsProvider=typeof e=="function"?e:async()=>e}async acquireInitialRetryToken(e){return WS({retryDelay:Fw,retryCount:0})}async refreshRetryTokenForRetry(e,t){const n=await this.getMaxAttempts();if(this.shouldRetry(e,t,n)){const s=t.errorType;this.retryBackoffStrategy.setDelayBase(s==="THROTTLING"?uM:Fw);const i=this.retryBackoffStrategy.computeNextBackoffDelay(e.getRetryCount()),c=t.retryAfterHint?Math.max(t.retryAfterHint.getTime()-Date.now()||0,i):i,u=this.getCapacityCost(s);return this.capacity-=u,WS({retryDelay:c,retryCount:e.getRetryCount()+1,retryCost:u})}throw new Error("No retry token available")}recordSuccess(e){this.capacity=Math.max(GS,this.capacity+(e.getRetryCost()??hM))}getCapacity(){return this.capacity}async getMaxAttempts(){try{return await this.maxAttemptsProvider()}catch{return console.warn(`Max attempts provider could not resolve. Using default of ${km}`),km}}shouldRetry(e,t,n){return e.getRetryCount()+1<n&&this.capacity>=this.getCapacityCost(t.errorType)&&this.isRetryableError(t.errorType)}getCapacityCost(e){return e==="TRANSIENT"?fM:dM}isRetryableError(e){return e==="THROTTLING"||e==="TRANSIENT"}}class vM{constructor(e,t){H(this,"maxAttemptsProvider");H(this,"rateLimiter");H(this,"standardRetryStrategy");H(this,"mode",sh.ADAPTIVE);this.maxAttemptsProvider=e;const{rateLimiter:n}=t??{};this.rateLimiter=n??new Pw,this.standardRetryStrategy=new CN(e)}async acquireInitialRetryToken(e){return await this.rateLimiter.getSendToken(),this.standardRetryStrategy.acquireInitialRetryToken(e)}async refreshRetryTokenForRetry(e,t){return this.rateLimiter.updateClientSendingRate(t),this.standardRetryStrategy.refreshRetryTokenForRetry(e,t)}recordSuccess(e){this.rateLimiter.updateClientSendingRate({}),this.standardRetryStrategy.recordSuccess(e)}}const yM=r=>r instanceof Error?r:r instanceof Object?Object.assign(new Error,r):typeof r=="string"?new Error(r):new Error(`AWS SDK error wrapper for ${r}`),kN=r=>{const{retryStrategy:e,retryMode:t,maxAttempts:n}=r,s=Vi(n??km);return Object.assign(r,{maxAttempts:s,retryStrategy:async()=>e||(await Vi(t)()===sh.ADAPTIVE?new vM(s):new CN(s))})},xM=r=>(r==null?void 0:r.body)instanceof ReadableStream,wM=r=>(e,t)=>async n=>{var c;let s=await r.retryStrategy();const i=await r.maxAttempts();if(bM(s)){s=s;let u=await s.acquireInitialRetryToken(t.partition_id),p=new Error,m=0,g=0;const{request:x}=n,b=Vo.isInstance(x);for(b&&(x.headers[pM]=F1());;)try{b&&(x.headers[mM]=`attempt=${m+1}; max=${i}`);const{response:E,output:T}=await e(n);return s.recordSuccess(u),T.$metadata.attempts=m+1,T.$metadata.totalRetryDelay=g,{response:E,output:T}}catch(E){const T=_M(E);if(p=yM(E),b&&xM(x))throw(c=t.logger instanceof Ob?console:t.logger)==null||c.warn("An error was encountered in a non-retryable streaming request."),p;try{u=await s.refreshRetryTokenForRetry(u,T)}catch{throw p.$metadata||(p.$metadata={}),p.$metadata.attempts=m+1,p.$metadata.totalRetryDelay=g,p}m=u.getRetryCount();const S=u.getRetryDelay();g+=S,await new Promise(N=>setTimeout(N,S))}}else return s=s,s!=null&&s.mode&&(t.userAgent=[...t.userAgent||[],["cfg/retry-mode",s.mode]]),s.retry(e,n)},bM=r=>typeof r.acquireInitialRetryToken<"u"&&typeof r.refreshRetryTokenForRetry<"u"&&typeof r.recordSuccess<"u",_M=r=>{const e={error:r,errorType:EM(r)},t=CM(r.$response);return t&&(e.retryAfterHint=t),e},EM=r=>EN(r)?"THROTTLING":Lb(r)?"TRANSIENT":cM(r)?"SERVER_ERROR":"CLIENT_ERROR",SM={name:"retryMiddleware",tags:["RETRY"],step:"finalizeRequest",priority:"high",override:!0},NN=r=>({applyToStack:e=>{e.add(wM(r),SM)}}),CM=r=>{if(!rh.isInstance(r))return;const e=Object.keys(r.headers).find(i=>i.toLowerCase()==="retry-after");if(!e)return;const t=r.headers[e],n=Number(t);return Number.isNaN(n)?new Date(t):new Date(n*1e3)},kM=async(r,e,t)=>({operation:od(e).operation,region:await Vi(r.region)()||(()=>{throw new Error("expected `region` to be configured for `aws.auth#sigv4`")})()});function NM(r){return{schemeId:"aws.auth#sigv4",signingProperties:{name:"cognito-idp",region:r.region},propertiesExtractor:(e,t)=>({signingProperties:{config:e,context:t}})}}function Er(r){return{schemeId:"smithy.api#noAuth"}}const TM=r=>{const e=[];switch(r.operation){case"AssociateSoftwareToken":{e.push(Er());break}case"ChangePassword":{e.push(Er());break}case"CompleteWebAuthnRegistration":{e.push(Er());break}case"ConfirmDevice":{e.push(Er());break}case"ConfirmForgotPassword":{e.push(Er());break}case"ConfirmSignUp":{e.push(Er());break}case"DeleteUser":{e.push(Er());break}case"DeleteUserAttributes":{e.push(Er());break}case"DeleteWebAuthnCredential":{e.push(Er());break}case"ForgetDevice":{e.push(Er());break}case"ForgotPassword":{e.push(Er());break}case"GetDevice":{e.push(Er());break}case"GetTokensFromRefreshToken":{e.push(Er());break}case"GetUser":{e.push(Er());break}case"GetUserAttributeVerificationCode":{e.push(Er());break}case"GetUserAuthFactors":{e.push(Er());break}case"GlobalSignOut":{e.push(Er());break}case"InitiateAuth":{e.push(Er());break}case"ListDevices":{e.push(Er());break}case"ListWebAuthnCredentials":{e.push(Er());break}case"ResendConfirmationCode":{e.push(Er());break}case"RespondToAuthChallenge":{e.push(Er());break}case"RevokeToken":{e.push(Er());break}case"SetUserMFAPreference":{e.push(Er());break}case"SetUserSettings":{e.push(Er());break}case"SignUp":{e.push(Er());break}case"StartWebAuthnRegistration":{e.push(Er());break}case"UpdateAuthEventFeedback":{e.push(Er());break}case"UpdateDeviceStatus":{e.push(Er());break}case"UpdateUserAttributes":{e.push(Er());break}case"VerifySoftwareToken":{e.push(Er());break}case"VerifyUserAttribute":{e.push(Er());break}default:e.push(NM(r))}return e},RM=r=>{const e=oN(r);return Object.assign(e,{authSchemePreference:Vi(r.authSchemePreference??[])})},AM=r=>Object.assign(r,{useDualstackEndpoint:r.useDualstackEndpoint??!1,useFipsEndpoint:r.useFipsEndpoint??!1,defaultSigningName:"cognito-idp"}),IM={UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}},PM="3.981.0",FM={version:PM},jM=r=>new TextEncoder().encode(r);var OM=typeof Buffer<"u"&&Buffer.from?function(r){return Buffer.from(r,"utf8")}:jM;function Nm(r){return r instanceof Uint8Array?r:typeof r=="string"?OM(r):ArrayBuffer.isView(r)?new Uint8Array(r.buffer,r.byteOffset,r.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(r)}function jw(r){return typeof r=="string"?r.length===0:r.byteLength===0}var TN={name:"SHA-256"},VS={name:"HMAC",hash:TN},DM=new Uint8Array([227,176,196,66,152,252,28,20,154,251,244,200,153,111,185,36,39,174,65,228,100,155,147,76,164,149,153,27,120,82,184,85]);const LM={};function Uv(){return typeof window<"u"?window:typeof self<"u"?self:LM}var MM=(function(){function r(e){this.toHash=new Uint8Array(0),this.secret=e,this.reset()}return r.prototype.update=function(e){if(!jw(e)){var t=Nm(e),n=new Uint8Array(this.toHash.byteLength+t.byteLength);n.set(this.toHash,0),n.set(t,this.toHash.byteLength),this.toHash=n}},r.prototype.digest=function(){var e=this;return this.key?this.key.then(function(t){return Uv().crypto.subtle.sign(VS,t,e.toHash).then(function(n){return new Uint8Array(n)})}):jw(this.toHash)?Promise.resolve(DM):Promise.resolve().then(function(){return Uv().crypto.subtle.digest(TN,e.toHash)}).then(function(t){return Promise.resolve(new Uint8Array(t))})},r.prototype.reset=function(){var e=this;this.toHash=new Uint8Array(0),this.secret&&this.secret!==void 0&&(this.key=new Promise(function(t,n){Uv().crypto.subtle.importKey("raw",Nm(e.secret),VS,!1,["sign"]).then(t,n)}),this.key.catch(function(){}))},r})(),Fa=function(){return Fa=Object.assign||function(e){for(var t,n=1,s=arguments.length;n<s;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},Fa.apply(this,arguments)};function RN(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(r);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(r,n[s])&&(t[n[s]]=r[n[s]]);return t}function $M(r,e,t,n){function s(i){return i instanceof t?i:new t(function(c){c(i)})}return new(t||(t=Promise))(function(i,c){function u(g){try{m(n.next(g))}catch(x){c(x)}}function p(g){try{m(n.throw(g))}catch(x){c(x)}}function m(g){g.done?i(g.value):s(g.value).then(u,p)}m((n=n.apply(r,e||[])).next())})}function UM(r,e){var t={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,c=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return c.next=u(0),c.throw=u(1),c.return=u(2),typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function u(m){return function(g){return p([m,g])}}function p(m){if(n)throw new TypeError("Generator is already executing.");for(;c&&(c=0,m[0]&&(t=0)),t;)try{if(n=1,s&&(i=m[0]&2?s.return:m[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,m[1])).done)return i;switch(s=0,i&&(m=[m[0]&2,i.value]),m[0]){case 0:case 1:i=m;break;case 4:return t.label++,{value:m[1],done:!1};case 5:t.label++,s=m[1],m=[0];continue;case 7:m=t.ops.pop(),t.trys.pop();continue;default:if(i=t.trys,!(i=i.length>0&&i[i.length-1])&&(m[0]===6||m[0]===2)){t=0;continue}if(m[0]===3&&(!i||m[1]>i[0]&&m[1]<i[3])){t.label=m[1];break}if(m[0]===6&&t.label<i[1]){t.label=i[1],i=m;break}if(i&&t.label<i[2]){t.label=i[2],t.ops.push(m);break}i[2]&&t.ops.pop(),t.trys.pop();continue}m=e.call(r,t)}catch(g){m=[6,g],s=0}finally{n=i=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}}function zM(r,e,t){if(t||arguments.length===2)for(var n=0,s=e.length,i;n<s;n++)(i||!(n in e))&&(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return r.concat(i||Array.prototype.slice.call(e))}var di=64,HM=32,BM=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),GM=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],WM=Math.pow(2,53)-1,zv=(function(){function r(){this.state=Int32Array.from(GM),this.temp=new Int32Array(64),this.buffer=new Uint8Array(64),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}return r.prototype.update=function(e){if(this.finished)throw new Error("Attempted to update an already finished hash.");var t=0,n=e.byteLength;if(this.bytesHashed+=n,this.bytesHashed*8>WM)throw new Error("Cannot hash more than 2^53 - 1 bits");for(;n>0;)this.buffer[this.bufferLength++]=e[t++],n--,this.bufferLength===di&&(this.hashBuffer(),this.bufferLength=0)},r.prototype.digest=function(){if(!this.finished){var e=this.bytesHashed*8,t=new DataView(this.buffer.buffer,this.buffer.byteOffset,this.buffer.byteLength),n=this.bufferLength;if(t.setUint8(this.bufferLength++,128),n%di>=di-8){for(var s=this.bufferLength;s<di;s++)t.setUint8(s,0);this.hashBuffer(),this.bufferLength=0}for(var s=this.bufferLength;s<di-8;s++)t.setUint8(s,0);t.setUint32(di-8,Math.floor(e/4294967296),!0),t.setUint32(di-4,e),this.hashBuffer(),this.finished=!0}for(var i=new Uint8Array(HM),s=0;s<8;s++)i[s*4]=this.state[s]>>>24&255,i[s*4+1]=this.state[s]>>>16&255,i[s*4+2]=this.state[s]>>>8&255,i[s*4+3]=this.state[s]>>>0&255;return i},r.prototype.hashBuffer=function(){for(var e=this,t=e.buffer,n=e.state,s=n[0],i=n[1],c=n[2],u=n[3],p=n[4],m=n[5],g=n[6],x=n[7],b=0;b<di;b++){if(b<16)this.temp[b]=(t[b*4]&255)<<24|(t[b*4+1]&255)<<16|(t[b*4+2]&255)<<8|t[b*4+3]&255;else{var E=this.temp[b-2],T=(E>>>17|E<<15)^(E>>>19|E<<13)^E>>>10;E=this.temp[b-15];var S=(E>>>7|E<<25)^(E>>>18|E<<14)^E>>>3;this.temp[b]=(T+this.temp[b-7]|0)+(S+this.temp[b-16]|0)}var N=(((p>>>6|p<<26)^(p>>>11|p<<21)^(p>>>25|p<<7))+(p&m^~p&g)|0)+(x+(BM[b]+this.temp[b]|0)|0)|0,R=((s>>>2|s<<30)^(s>>>13|s<<19)^(s>>>22|s<<10))+(s&i^s&c^i&c)|0;x=g,g=m,m=p,p=u+N|0,u=c,c=i,i=s,s=N+R|0}n[0]+=s,n[1]+=i,n[2]+=c,n[3]+=u,n[4]+=p,n[5]+=m,n[6]+=g,n[7]+=x},r})(),VM=(function(){function r(e){this.secret=e,this.hash=new zv,this.reset()}return r.prototype.update=function(e){if(!(jw(e)||this.error))try{this.hash.update(Nm(e))}catch(t){this.error=t}},r.prototype.digestSync=function(){if(this.error)throw this.error;return this.outer?(this.outer.finished||this.outer.update(this.hash.digest()),this.outer.digest()):this.hash.digest()},r.prototype.digest=function(){return $M(this,void 0,void 0,function(){return UM(this,function(e){return[2,this.digestSync()]})})},r.prototype.reset=function(){if(this.hash=new zv,this.secret){this.outer=new zv;var e=qM(this.secret),t=new Uint8Array(di);t.set(e);for(var n=0;n<di;n++)e[n]^=54,t[n]^=92;this.hash.update(e),this.outer.update(t);for(var n=0;n<e.byteLength;n++)e[n]=0}},r})();function qM(r){var e=Nm(r);if(e.byteLength>di){var t=new zv;t.update(e),e=t.digest()}var n=new Uint8Array(di);return n.set(e),n}var KM=["decrypt","digest","encrypt","exportKey","generateKey","importKey","sign","verify"];function YM(r){if(JM(r)&&typeof r.crypto.subtle=="object"){var e=r.crypto.subtle;return XM(e)}return!1}function JM(r){if(typeof r=="object"&&typeof r.crypto=="object"){var e=r.crypto.getRandomValues;return typeof e=="function"}return!1}function XM(r){return r&&KM.every(function(e){return typeof r[e]=="function"})}var AN=(function(){function r(e){YM(Uv())?this.hash=new MM(e):this.hash=new VM(e)}return r.prototype.update=function(e,t){this.hash.update(Nm(e))},r.prototype.digest=function(){return this.hash.digest()},r.prototype.reset=function(){this.hash.reset()},r})();const IN=({serviceId:r,clientVersion:e})=>async t=>{var E,T,S;const n=typeof window<"u"?window.navigator:void 0,s=(n==null?void 0:n.userAgent)??"",i=((E=n==null?void 0:n.userAgentData)==null?void 0:E.platform)??qS.os(s)??"other",c=void 0,u=((T=n==null?void 0:n.userAgentData)==null?void 0:T.brands)??[],p=u[u.length-1],m=(p==null?void 0:p.brand)??qS.browser(s)??"unknown",g=(p==null?void 0:p.version)??"unknown",x=[["aws-sdk-js",e],["ua","2.1"],[`os/${i}`,c],["lang/js"],["md/browser",`${m}_${g}`]];r&&x.push([`api/${r}`,e]);const b=await((S=t==null?void 0:t.userAgentAppId)==null?void 0:S.call(t));return b&&x.push([`app/${b}`]),x},qS={os(r){if(/iPhone|iPad|iPod/.test(r))return"iOS";if(/Macintosh|Mac OS X/.test(r))return"macOS";if(/Windows NT/.test(r))return"Windows";if(/Android/.test(r))return"Android";if(/Linux/.test(r))return"Linux"},browser(r){if(/EdgiOS|EdgA|Edg\//.test(r))return"Microsoft Edge";if(/Firefox\//.test(r))return"Firefox";if(/Chrome\//.test(r))return"Chrome";if(/Safari\//.test(r))return"Safari"}},PN=r=>()=>Promise.reject(r),QM=["in-region","cross-region","mobile","standard","legacy"],FN=({defaultsMode:r}={})=>zD(async()=>{const e=typeof r=="function"?await r():r;switch(e==null?void 0:e.toLowerCase()){case"auto":return Promise.resolve(ZM()?"mobile":"standard");case"mobile":case"in-region":case"cross-region":case"standard":case"legacy":return Promise.resolve(e==null?void 0:e.toLocaleLowerCase());case void 0:return Promise.resolve("legacy");default:throw new Error(`Invalid parameter for "defaultsMode", expect ${QM.join(", ")}, got ${e}`)}}),ZM=()=>{var e;const r=window==null?void 0:window.navigator;if(r!=null&&r.connection){const{effectiveType:t,rtt:n,downlink:s}=r==null?void 0:r.connection;if(typeof t=="string"&&t!=="4g"||Number(n)>100||Number(s)<10)return!0}return((e=r==null?void 0:r.userAgentData)==null?void 0:e.mobile)||typeof(r==null?void 0:r.maxTouchPoints)=="number"&&(r==null?void 0:r.maxTouchPoints)>1},jN=(r,e=!1)=>{if(e){for(const t of r.split("."))if(!jN(t))return!1;return!0}return!(!zm(r)||r.length<3||r.length>63||r!==r.toLowerCase()||Pb(r))},KS=":",e$="/",t$=r=>{const e=r.split(KS);if(e.length<6)return null;const[t,n,s,i,c,...u]=e;if(t!=="arn"||n===""||s===""||u.join(KS)==="")return null;const p=u.map(m=>m.split(e$)).flat();return{partition:n,service:s,region:i,accountId:c,resourceId:p}},r$=[{id:"aws",outputs:{dnsSuffix:"amazonaws.com",dualStackDnsSuffix:"api.aws",implicitGlobalRegion:"us-east-1",name:"aws",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^(us|eu|ap|sa|ca|me|af|il|mx)\\-\\w+\\-\\d+$",regions:{"af-south-1":{description:"Africa (Cape Town)"},"ap-east-1":{description:"Asia Pacific (Hong Kong)"},"ap-east-2":{description:"Asia Pacific (Taipei)"},"ap-northeast-1":{description:"Asia Pacific (Tokyo)"},"ap-northeast-2":{description:"Asia Pacific (Seoul)"},"ap-northeast-3":{description:"Asia Pacific (Osaka)"},"ap-south-1":{description:"Asia Pacific (Mumbai)"},"ap-south-2":{description:"Asia Pacific (Hyderabad)"},"ap-southeast-1":{description:"Asia Pacific (Singapore)"},"ap-southeast-2":{description:"Asia Pacific (Sydney)"},"ap-southeast-3":{description:"Asia Pacific (Jakarta)"},"ap-southeast-4":{description:"Asia Pacific (Melbourne)"},"ap-southeast-5":{description:"Asia Pacific (Malaysia)"},"ap-southeast-6":{description:"Asia Pacific (New Zealand)"},"ap-southeast-7":{description:"Asia Pacific (Thailand)"},"aws-global":{description:"aws global region"},"ca-central-1":{description:"Canada (Central)"},"ca-west-1":{description:"Canada West (Calgary)"},"eu-central-1":{description:"Europe (Frankfurt)"},"eu-central-2":{description:"Europe (Zurich)"},"eu-north-1":{description:"Europe (Stockholm)"},"eu-south-1":{description:"Europe (Milan)"},"eu-south-2":{description:"Europe (Spain)"},"eu-west-1":{description:"Europe (Ireland)"},"eu-west-2":{description:"Europe (London)"},"eu-west-3":{description:"Europe (Paris)"},"il-central-1":{description:"Israel (Tel Aviv)"},"me-central-1":{description:"Middle East (UAE)"},"me-south-1":{description:"Middle East (Bahrain)"},"mx-central-1":{description:"Mexico (Central)"},"sa-east-1":{description:"South America (Sao Paulo)"},"us-east-1":{description:"US East (N. Virginia)"},"us-east-2":{description:"US East (Ohio)"},"us-west-1":{description:"US West (N. California)"},"us-west-2":{description:"US West (Oregon)"}}},{id:"aws-cn",outputs:{dnsSuffix:"amazonaws.com.cn",dualStackDnsSuffix:"api.amazonwebservices.com.cn",implicitGlobalRegion:"cn-northwest-1",name:"aws-cn",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^cn\\-\\w+\\-\\d+$",regions:{"aws-cn-global":{description:"aws-cn global region"},"cn-north-1":{description:"China (Beijing)"},"cn-northwest-1":{description:"China (Ningxia)"}}},{id:"aws-eusc",outputs:{dnsSuffix:"amazonaws.eu",dualStackDnsSuffix:"api.amazonwebservices.eu",implicitGlobalRegion:"eusc-de-east-1",name:"aws-eusc",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^eusc\\-(de)\\-\\w+\\-\\d+$",regions:{"eusc-de-east-1":{description:"AWS European Sovereign Cloud (Germany)"}}},{id:"aws-iso",outputs:{dnsSuffix:"c2s.ic.gov",dualStackDnsSuffix:"api.aws.ic.gov",implicitGlobalRegion:"us-iso-east-1",name:"aws-iso",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-iso\\-\\w+\\-\\d+$",regions:{"aws-iso-global":{description:"aws-iso global region"},"us-iso-east-1":{description:"US ISO East"},"us-iso-west-1":{description:"US ISO WEST"}}},{id:"aws-iso-b",outputs:{dnsSuffix:"sc2s.sgov.gov",dualStackDnsSuffix:"api.aws.scloud",implicitGlobalRegion:"us-isob-east-1",name:"aws-iso-b",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-isob\\-\\w+\\-\\d+$",regions:{"aws-iso-b-global":{description:"aws-iso-b global region"},"us-isob-east-1":{description:"US ISOB East (Ohio)"},"us-isob-west-1":{description:"US ISOB West"}}},{id:"aws-iso-e",outputs:{dnsSuffix:"cloud.adc-e.uk",dualStackDnsSuffix:"api.cloud-aws.adc-e.uk",implicitGlobalRegion:"eu-isoe-west-1",name:"aws-iso-e",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^eu\\-isoe\\-\\w+\\-\\d+$",regions:{"aws-iso-e-global":{description:"aws-iso-e global region"},"eu-isoe-west-1":{description:"EU ISOE West"}}},{id:"aws-iso-f",outputs:{dnsSuffix:"csp.hci.ic.gov",dualStackDnsSuffix:"api.aws.hci.ic.gov",implicitGlobalRegion:"us-isof-south-1",name:"aws-iso-f",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-isof\\-\\w+\\-\\d+$",regions:{"aws-iso-f-global":{description:"aws-iso-f global region"},"us-isof-east-1":{description:"US ISOF EAST"},"us-isof-south-1":{description:"US ISOF SOUTH"}}},{id:"aws-us-gov",outputs:{dnsSuffix:"amazonaws.com",dualStackDnsSuffix:"api.aws",implicitGlobalRegion:"us-gov-west-1",name:"aws-us-gov",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-gov\\-\\w+\\-\\d+$",regions:{"aws-us-gov-global":{description:"aws-us-gov global region"},"us-gov-east-1":{description:"AWS GovCloud (US-East)"},"us-gov-west-1":{description:"AWS GovCloud (US-West)"}}}],n$={partitions:r$};let s$=n$;const o$=r=>{const{partitions:e}=s$;for(const n of e){const{regions:s,outputs:i}=n;for(const[c,u]of Object.entries(s))if(c===r)return{...i,...u}}for(const n of e){const{regionRegex:s,outputs:i}=n;if(new RegExp(s).test(r))return{...i}}const t=e.find(n=>n.id==="aws");if(!t)throw new Error("Provided region was not found in the partition array or regex, and default partition with id 'aws' doesn't exist.");return{...t.outputs}},Mb={isVirtualHostableS3Bucket:jN,parseArn:t$,partition:o$};nh.aws=Mb;const ON="required",Fs="fn",js="argv",ch="ref",YS=!0,JS="isSet",Tm="booleanEquals",If="error",Ta="endpoint",bl="tree",$b="PartitionResult",Ub="getAttr",Op="stringEquals",XS={[ON]:!1,type:"string"},QS={[ON]:!0,default:!1,type:"boolean"},ZS={[ch]:"Endpoint"},DN={[Fs]:Tm,[js]:[{[ch]:"UseFIPS"},!0]},LN={[Fs]:Tm,[js]:[{[ch]:"UseDualStack"},!0]},On={},rm={[ch]:"Region"},eC={[Fs]:Ub,[js]:[{[ch]:$b},"supportsFIPS"]},MN={[ch]:$b},tC={[Fs]:Tm,[js]:[!0,{[Fs]:Ub,[js]:[MN,"supportsDualStack"]}]},rC=[DN],nC=[LN],sC=[rm],i$={parameters:{Region:XS,UseDualStack:QS,UseFIPS:QS,Endpoint:XS},rules:[{conditions:[{[Fs]:JS,[js]:[ZS]}],rules:[{conditions:rC,error:"Invalid Configuration: FIPS and custom endpoint are not supported",type:If},{conditions:nC,error:"Invalid Configuration: Dualstack and custom endpoint are not supported",type:If},{endpoint:{url:ZS,properties:On,headers:On},type:Ta}],type:bl},{conditions:[{[Fs]:JS,[js]:sC}],rules:[{conditions:[{[Fs]:"aws.partition",[js]:sC,assign:$b}],rules:[{conditions:[DN,LN],rules:[{conditions:[{[Fs]:Tm,[js]:[YS,eC]},tC],rules:[{conditions:[{[Fs]:Op,[js]:[rm,"us-east-1"]}],endpoint:{url:"https://cognito-idp-fips.us-east-1.amazonaws.com",properties:On,headers:On},type:Ta},{conditions:[{[Fs]:Op,[js]:[rm,"us-east-2"]}],endpoint:{url:"https://cognito-idp-fips.us-east-2.amazonaws.com",properties:On,headers:On},type:Ta},{conditions:[{[Fs]:Op,[js]:[rm,"us-west-1"]}],endpoint:{url:"https://cognito-idp-fips.us-west-1.amazonaws.com",properties:On,headers:On},type:Ta},{conditions:[{[Fs]:Op,[js]:[rm,"us-west-2"]}],endpoint:{url:"https://cognito-idp-fips.us-west-2.amazonaws.com",properties:On,headers:On},type:Ta},{endpoint:{url:"https://cognito-idp-fips.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:On,headers:On},type:Ta}],type:bl},{error:"FIPS and DualStack are enabled, but this partition does not support one or both",type:If}],type:bl},{conditions:rC,rules:[{conditions:[{[Fs]:Tm,[js]:[eC,YS]}],rules:[{endpoint:{url:"https://cognito-idp-fips.{Region}.{PartitionResult#dnsSuffix}",properties:On,headers:On},type:Ta}],type:bl},{error:"FIPS is enabled but this partition does not support FIPS",type:If}],type:bl},{conditions:nC,rules:[{conditions:[tC],rules:[{conditions:[{[Fs]:Op,[js]:["aws",{[Fs]:Ub,[js]:[MN,"name"]}]}],endpoint:{url:"https://cognito-idp.{Region}.amazonaws.com",properties:On,headers:On},type:Ta},{endpoint:{url:"https://cognito-idp.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:On,headers:On},type:Ta}],type:bl},{error:"DualStack is enabled but this partition does not support DualStack",type:If}],type:bl},{endpoint:{url:"https://cognito-idp.{Region}.{PartitionResult#dnsSuffix}",properties:On,headers:On},type:Ta}],type:bl}],type:bl},{error:"Invalid Configuration: Missing Region",type:If}]},a$=i$,l$=new $1({size:50,params:["Endpoint","Region","UseDualStack","UseFIPS"]}),c$=(r,e={})=>l$.get(r,()=>Y1(a$,{endpointParams:r,logger:e.logger}));nh.aws=Mb;const u$=r=>({apiVersion:"2016-04-18",base64Decoder:(r==null?void 0:r.base64Decoder)??Um,base64Encoder:(r==null?void 0:r.base64Encoder)??_m,disableHostPrefix:(r==null?void 0:r.disableHostPrefix)??!1,endpointProvider:(r==null?void 0:r.endpointProvider)??c$,extensions:(r==null?void 0:r.extensions)??[],httpAuthSchemeProvider:(r==null?void 0:r.httpAuthSchemeProvider)??TM,httpAuthSchemes:(r==null?void 0:r.httpAuthSchemes)??[{schemeId:"aws.auth#sigv4",identityProvider:e=>e.getIdentityProvider("aws.auth#sigv4"),signer:new Q1},{schemeId:"smithy.api#noAuth",identityProvider:e=>e.getIdentityProvider("smithy.api#noAuth")||(async()=>({})),signer:new D1}],logger:(r==null?void 0:r.logger)??new Ob,protocol:(r==null?void 0:r.protocol)??fN,protocolSettings:(r==null?void 0:r.protocolSettings)??{defaultNamespace:"com.amazonaws.cognitoidentityprovider",xmlNamespace:"http://cognito-idp.amazonaws.com/doc/2016-04-18/",version:"2016-04-18",serviceTarget:"AWSCognitoIdentityProviderService"},serviceId:(r==null?void 0:r.serviceId)??"Cognito Identity Provider",urlParser:(r==null?void 0:r.urlParser)??Cm,utf8Decoder:(r==null?void 0:r.utf8Decoder)??ed,utf8Encoder:(r==null?void 0:r.utf8Encoder)??Ly}),d$=r=>{const e=FN(r),t=()=>e().then(cN),n=u$(r);return{...n,...r,runtime:"browser",defaultsMode:e,bodyLengthChecker:(r==null?void 0:r.bodyLengthChecker)??iN,credentialDefaultProvider:(r==null?void 0:r.credentialDefaultProvider)??(s=>()=>Promise.reject(new Error("Credential is missing"))),defaultUserAgentProvider:(r==null?void 0:r.defaultUserAgentProvider)??IN({serviceId:n.serviceId,clientVersion:FM.version}),maxAttempts:(r==null?void 0:r.maxAttempts)??km,region:(r==null?void 0:r.region)??PN("Region is missing"),requestHandler:My.create((r==null?void 0:r.requestHandler)??t),retryMode:(r==null?void 0:r.retryMode)??(async()=>(await t()).retryMode||_N),sha256:(r==null?void 0:r.sha256)??AN,streamCollector:(r==null?void 0:r.streamCollector)??T1,useDualstackEndpoint:(r==null?void 0:r.useDualstackEndpoint)??(()=>Promise.resolve(pN)),useFipsEndpoint:(r==null?void 0:r.useFipsEndpoint)??(()=>Promise.resolve(mN))}},$N=r=>({setRegion(e){r.region=e},region(){return r.region}}),UN=r=>({region:r.region()}),f$=r=>{const e=r.httpAuthSchemes;let t=r.httpAuthSchemeProvider,n=r.credentials;return{setHttpAuthScheme(s){const i=e.findIndex(c=>c.schemeId===s.schemeId);i===-1?e.push(s):e.splice(i,1,s)},httpAuthSchemes(){return e},setHttpAuthSchemeProvider(s){t=s},httpAuthSchemeProvider(){return t},setCredentials(s){n=s},credentials(){return n}}},h$=r=>({httpAuthSchemes:r.httpAuthSchemes(),httpAuthSchemeProvider:r.httpAuthSchemeProvider(),credentials:r.credentials()}),p$=(r,e)=>{const t=Object.assign($N(r),uN(r),w1(r),f$(r));return e.forEach(n=>n.configure(t)),Object.assign(r,UN(t),dN(t),b1(t),h$(t))};class zb extends aN{constructor(...[t]){const n=d$(t||{});super(n);H(this,"config");this.initConfig=n;const s=AM(n),i=M1(s),c=kN(i),u=vN(c),p=u,m=bN(p),g=RM(m),x=p$(g,(t==null?void 0:t.extensions)||[]);this.config=x,this.middlewareStack.use(I1(this.config)),this.middlewareStack.use(hN(this.config)),this.middlewareStack.use(NN(this.config)),this.middlewareStack.use(yN(this.config)),this.middlewareStack.use(_1(this.config)),this.middlewareStack.use(E1(this.config)),this.middlewareStack.use(S1(this.config)),this.middlewareStack.use(C1(this.config,{httpAuthSchemeParametersProvider:kM,identityProviderConfigProvider:async b=>new O1({"aws.auth#sigv4":b.credentials})})),this.middlewareStack.use(k1(this.config))}destroy(){super.destroy()}}class vt extends Bf{constructor(e){super(e),Object.setPrototypeOf(this,vt.prototype)}}class Hb extends vt{constructor(t){super({name:"InternalErrorException",$fault:"server",...t});H(this,"name","InternalErrorException");H(this,"$fault","server");Object.setPrototypeOf(this,Hb.prototype)}}class Bb extends vt{constructor(t){super({name:"InvalidParameterException",$fault:"client",...t});H(this,"name","InvalidParameterException");H(this,"$fault","client");H(this,"reasonCode");Object.setPrototypeOf(this,Bb.prototype),this.reasonCode=t.reasonCode}}class Gb extends vt{constructor(t){super({name:"NotAuthorizedException",$fault:"client",...t});H(this,"name","NotAuthorizedException");H(this,"$fault","client");Object.setPrototypeOf(this,Gb.prototype)}}class Wb extends vt{constructor(t){super({name:"ResourceNotFoundException",$fault:"client",...t});H(this,"name","ResourceNotFoundException");H(this,"$fault","client");Object.setPrototypeOf(this,Wb.prototype)}}class Vb extends vt{constructor(t){super({name:"TooManyRequestsException",$fault:"client",...t});H(this,"name","TooManyRequestsException");H(this,"$fault","client");Object.setPrototypeOf(this,Vb.prototype)}}class qb extends vt{constructor(t){super({name:"UserImportInProgressException",$fault:"client",...t});H(this,"name","UserImportInProgressException");H(this,"$fault","client");Object.setPrototypeOf(this,qb.prototype)}}class Kb extends vt{constructor(t){super({name:"UserNotFoundException",$fault:"client",...t});H(this,"name","UserNotFoundException");H(this,"$fault","client");Object.setPrototypeOf(this,Kb.prototype)}}class Yb extends vt{constructor(t){super({name:"InvalidLambdaResponseException",$fault:"client",...t});H(this,"name","InvalidLambdaResponseException");H(this,"$fault","client");Object.setPrototypeOf(this,Yb.prototype)}}class Jb extends vt{constructor(t){super({name:"LimitExceededException",$fault:"client",...t});H(this,"name","LimitExceededException");H(this,"$fault","client");Object.setPrototypeOf(this,Jb.prototype)}}class Xb extends vt{constructor(t){super({name:"TooManyFailedAttemptsException",$fault:"client",...t});H(this,"name","TooManyFailedAttemptsException");H(this,"$fault","client");Object.setPrototypeOf(this,Xb.prototype)}}class Qb extends vt{constructor(t){super({name:"UnexpectedLambdaException",$fault:"client",...t});H(this,"name","UnexpectedLambdaException");H(this,"$fault","client");Object.setPrototypeOf(this,Qb.prototype)}}class Zb extends vt{constructor(t){super({name:"UserLambdaValidationException",$fault:"client",...t});H(this,"name","UserLambdaValidationException");H(this,"$fault","client");Object.setPrototypeOf(this,Zb.prototype)}}class e_ extends vt{constructor(t){super({name:"CodeDeliveryFailureException",$fault:"client",...t});H(this,"name","CodeDeliveryFailureException");H(this,"$fault","client");Object.setPrototypeOf(this,e_.prototype)}}class t_ extends vt{constructor(t){super({name:"InvalidPasswordException",$fault:"client",...t});H(this,"name","InvalidPasswordException");H(this,"$fault","client");Object.setPrototypeOf(this,t_.prototype)}}class r_ extends vt{constructor(t){super({name:"InvalidSmsRoleAccessPolicyException",$fault:"client",...t});H(this,"name","InvalidSmsRoleAccessPolicyException");H(this,"$fault","client");Object.setPrototypeOf(this,r_.prototype)}}class n_ extends vt{constructor(t){super({name:"InvalidSmsRoleTrustRelationshipException",$fault:"client",...t});H(this,"name","InvalidSmsRoleTrustRelationshipException");H(this,"$fault","client");Object.setPrototypeOf(this,n_.prototype)}}class s_ extends vt{constructor(t){super({name:"PreconditionNotMetException",$fault:"client",...t});H(this,"name","PreconditionNotMetException");H(this,"$fault","client");Object.setPrototypeOf(this,s_.prototype)}}class o_ extends vt{constructor(t){super({name:"UnsupportedUserStateException",$fault:"client",...t});H(this,"name","UnsupportedUserStateException");H(this,"$fault","client");Object.setPrototypeOf(this,o_.prototype)}}class i_ extends vt{constructor(t){super({name:"UsernameExistsException",$fault:"client",...t});H(this,"name","UsernameExistsException");H(this,"$fault","client");Object.setPrototypeOf(this,i_.prototype)}}class a_ extends vt{constructor(t){super({name:"AliasExistsException",$fault:"client",...t});H(this,"name","AliasExistsException");H(this,"$fault","client");Object.setPrototypeOf(this,a_.prototype)}}class l_ extends vt{constructor(t){super({name:"InvalidUserPoolConfigurationException",$fault:"client",...t});H(this,"name","InvalidUserPoolConfigurationException");H(this,"$fault","client");Object.setPrototypeOf(this,l_.prototype)}}class c_ extends vt{constructor(t){super({name:"InvalidEmailRoleAccessPolicyException",$fault:"client",...t});H(this,"name","InvalidEmailRoleAccessPolicyException");H(this,"$fault","client");Object.setPrototypeOf(this,c_.prototype)}}class u_ extends vt{constructor(t){super({name:"MFAMethodNotFoundException",$fault:"client",...t});H(this,"name","MFAMethodNotFoundException");H(this,"$fault","client");Object.setPrototypeOf(this,u_.prototype)}}class d_ extends vt{constructor(t){super({name:"PasswordResetRequiredException",$fault:"client",...t});H(this,"name","PasswordResetRequiredException");H(this,"$fault","client");Object.setPrototypeOf(this,d_.prototype)}}class f_ extends vt{constructor(t){super({name:"UnsupportedOperationException",$fault:"client",...t});H(this,"name","UnsupportedOperationException");H(this,"$fault","client");Object.setPrototypeOf(this,f_.prototype)}}class h_ extends vt{constructor(t){super({name:"UserNotConfirmedException",$fault:"client",...t});H(this,"name","UserNotConfirmedException");H(this,"$fault","client");Object.setPrototypeOf(this,h_.prototype)}}class p_ extends vt{constructor(t){super({name:"UserPoolAddOnNotEnabledException",$fault:"client",...t});H(this,"name","UserPoolAddOnNotEnabledException");H(this,"$fault","client");Object.setPrototypeOf(this,p_.prototype)}}class m_ extends vt{constructor(t){super({name:"CodeMismatchException",$fault:"client",...t});H(this,"name","CodeMismatchException");H(this,"$fault","client");Object.setPrototypeOf(this,m_.prototype)}}class g_ extends vt{constructor(t){super({name:"ExpiredCodeException",$fault:"client",...t});H(this,"name","ExpiredCodeException");H(this,"$fault","client");Object.setPrototypeOf(this,g_.prototype)}}class v_ extends vt{constructor(t){super({name:"PasswordHistoryPolicyViolationException",$fault:"client",...t});H(this,"name","PasswordHistoryPolicyViolationException");H(this,"$fault","client");Object.setPrototypeOf(this,v_.prototype)}}class y_ extends vt{constructor(t){super({name:"SoftwareTokenMFANotFoundException",$fault:"client",...t});H(this,"name","SoftwareTokenMFANotFoundException");H(this,"$fault","client");Object.setPrototypeOf(this,y_.prototype)}}class x_ extends vt{constructor(t){super({name:"ConcurrentModificationException",$fault:"client",...t});H(this,"name","ConcurrentModificationException");H(this,"$fault","client");Object.setPrototypeOf(this,x_.prototype)}}class w_ extends vt{constructor(t){super({name:"ForbiddenException",$fault:"client",...t});H(this,"name","ForbiddenException");H(this,"$fault","client");Object.setPrototypeOf(this,w_.prototype)}}class b_ extends vt{constructor(t){super({name:"WebAuthnChallengeNotFoundException",$fault:"client",...t});H(this,"name","WebAuthnChallengeNotFoundException");H(this,"$fault","client");Object.setPrototypeOf(this,b_.prototype)}}class __ extends vt{constructor(t){super({name:"WebAuthnClientMismatchException",$fault:"client",...t});H(this,"name","WebAuthnClientMismatchException");H(this,"$fault","client");Object.setPrototypeOf(this,__.prototype)}}class E_ extends vt{constructor(t){super({name:"WebAuthnCredentialNotSupportedException",$fault:"client",...t});H(this,"name","WebAuthnCredentialNotSupportedException");H(this,"$fault","client");Object.setPrototypeOf(this,E_.prototype)}}class S_ extends vt{constructor(t){super({name:"WebAuthnNotEnabledException",$fault:"client",...t});H(this,"name","WebAuthnNotEnabledException");H(this,"$fault","client");Object.setPrototypeOf(this,S_.prototype)}}class C_ extends vt{constructor(t){super({name:"WebAuthnOriginNotAllowedException",$fault:"client",...t});H(this,"name","WebAuthnOriginNotAllowedException");H(this,"$fault","client");Object.setPrototypeOf(this,C_.prototype)}}class k_ extends vt{constructor(t){super({name:"WebAuthnRelyingPartyMismatchException",$fault:"client",...t});H(this,"name","WebAuthnRelyingPartyMismatchException");H(this,"$fault","client");Object.setPrototypeOf(this,k_.prototype)}}class N_ extends vt{constructor(t){super({name:"DeviceKeyExistsException",$fault:"client",...t});H(this,"name","DeviceKeyExistsException");H(this,"$fault","client");Object.setPrototypeOf(this,N_.prototype)}}class T_ extends vt{constructor(t){super({name:"GroupExistsException",$fault:"client",...t});H(this,"name","GroupExistsException");H(this,"$fault","client");Object.setPrototypeOf(this,T_.prototype)}}class R_ extends vt{constructor(t){super({name:"DuplicateProviderException",$fault:"client",...t});H(this,"name","DuplicateProviderException");H(this,"$fault","client");Object.setPrototypeOf(this,R_.prototype)}}class A_ extends vt{constructor(t){super({name:"ManagedLoginBrandingExistsException",$fault:"client",...t});H(this,"name","ManagedLoginBrandingExistsException");H(this,"$fault","client");Object.setPrototypeOf(this,A_.prototype)}}class I_ extends vt{constructor(t){super({name:"TermsExistsException",$fault:"client",...t});H(this,"name","TermsExistsException");H(this,"$fault","client");Object.setPrototypeOf(this,I_.prototype)}}class P_ extends vt{constructor(t){super({name:"FeatureUnavailableInTierException",$fault:"client",...t});H(this,"name","FeatureUnavailableInTierException");H(this,"$fault","client");Object.setPrototypeOf(this,P_.prototype)}}class F_ extends vt{constructor(t){super({name:"TierChangeNotAllowedException",$fault:"client",...t});H(this,"name","TierChangeNotAllowedException");H(this,"$fault","client");Object.setPrototypeOf(this,F_.prototype)}}class j_ extends vt{constructor(t){super({name:"UserPoolTaggingException",$fault:"client",...t});H(this,"name","UserPoolTaggingException");H(this,"$fault","client");Object.setPrototypeOf(this,j_.prototype)}}class O_ extends vt{constructor(t){super({name:"InvalidOAuthFlowException",$fault:"client",...t});H(this,"name","InvalidOAuthFlowException");H(this,"$fault","client");Object.setPrototypeOf(this,O_.prototype)}}class D_ extends vt{constructor(t){super({name:"ScopeDoesNotExistException",$fault:"client",...t});H(this,"name","ScopeDoesNotExistException");H(this,"$fault","client");Object.setPrototypeOf(this,D_.prototype)}}class L_ extends vt{constructor(t){super({name:"UnsupportedIdentityProviderException",$fault:"client",...t});H(this,"name","UnsupportedIdentityProviderException");H(this,"$fault","client");Object.setPrototypeOf(this,L_.prototype)}}class M_ extends vt{constructor(t){super({name:"RefreshTokenReuseException",$fault:"client",...t});H(this,"name","RefreshTokenReuseException");H(this,"$fault","client");Object.setPrototypeOf(this,M_.prototype)}}class $_ extends vt{constructor(t){super({name:"UnauthorizedException",$fault:"client",...t});H(this,"name","UnauthorizedException");H(this,"$fault","client");Object.setPrototypeOf(this,$_.prototype)}}class U_ extends vt{constructor(t){super({name:"UnsupportedTokenTypeException",$fault:"client",...t});H(this,"name","UnsupportedTokenTypeException");H(this,"$fault","client");Object.setPrototypeOf(this,U_.prototype)}}class z_ extends vt{constructor(t){super({name:"WebAuthnConfigurationMissingException",$fault:"client",...t});H(this,"name","WebAuthnConfigurationMissingException");H(this,"$fault","client");Object.setPrototypeOf(this,z_.prototype)}}class H_ extends vt{constructor(t){super({name:"EnableSoftwareTokenMFAException",$fault:"client",...t});H(this,"name","EnableSoftwareTokenMFAException");H(this,"$fault","client");Object.setPrototypeOf(this,H_.prototype)}}const m$="AvailableChallenges",g$="AliasExistsException",v$="AnalyticsEndpointId",y$="AuthFlow",x$="AnalyticsMetadata",w$="AnalyticsMetadataType",b$="AuthParameters",_$="AuthParametersType",E$="AuthenticationResult",S$="AuthenticationResultType",C$="AccessToken",k$="CodeDeliveryFailureException",N$="ClientId",T$="ClientIdType",R$="ClientMetadata",A$="CodeMismatchException",I$="ConcurrentModificationException",P$="ChallengeName",F$="ChallengeParameters",j$="DeviceGroupKey",O$="DeviceKey",D$="DeviceKeyExistsException",L$="DuplicateProviderException",M$="ExpiredCodeException",$$="EncodedData",U$="ExpiresIn",z$="EnableSoftwareTokenMFAException",H$="ForbiddenException",B$="FeatureUnavailableInTierException",G$="GroupExistsException",W$="IpAddress",V$="InitiateAuthRequest",q$="InitiateAuthResponse",K$="InitiateAuth",Y$="InternalErrorException",J$="InvalidEmailRoleAccessPolicyException",X$="InvalidLambdaResponseException",Q$="InvalidOAuthFlowException",Z$="InvalidParameterException",e4="InvalidPasswordException",t4="InvalidSmsRoleAccessPolicyException",r4="InvalidSmsRoleTrustRelationshipException",n4="IdToken",s4="InvalidUserPoolConfigurationException",o4="LimitExceededException",i4="MFAMethodNotFoundException",a4="ManagedLoginBrandingExistsException",l4="NotAuthorizedException",c4="NewDeviceMetadata",u4="NewDeviceMetadataType",d4="PasswordHistoryPolicyViolationException",f4="PreconditionNotMetException",h4="PasswordResetRequiredException",p4="ResourceNotFoundException",m4="RefreshToken",g4="RefreshTokenReuseException",zN="Session",v4="ScopeDoesNotExistException",y4="SessionType",x4="SoftwareTokenMFANotFoundException",w4="TierChangeNotAllowedException",b4="TermsExistsException",_4="TooManyFailedAttemptsException",E4="TooManyRequestsException",S4="TokenModelType",C4="TokenType",k4="UserContextDataType",N4="UserContextData",T4="UnauthorizedException",R4="UsernameExistsException",A4="UserImportInProgressException",I4="UnsupportedIdentityProviderException",P4="UnexpectedLambdaException",F4="UserLambdaValidationException",j4="UserNotConfirmedException",O4="UserNotFoundException",D4="UnsupportedOperationException",L4="UserPoolAddOnNotEnabledException",M4="UserPoolTaggingException",$4="UnsupportedTokenTypeException",U4="UnsupportedUserStateException",z4="WebAuthnClientMismatchException",H4="WebAuthnConfigurationMissingException",B4="WebAuthnChallengeNotFoundException",G4="WebAuthnCredentialNotSupportedException",W4="WebAuthnNotEnabledException",V4="WebAuthnOriginNotAllowedException",q4="WebAuthnRelyingPartyMismatchException",Rt="client",St="error",At="httpError",Ct="message",K4="reasonCode",Y4="server",HN="smithy.ts.sdk.synthetic.com.amazonaws.cognitoidentityprovider",Ce="com.amazonaws.cognitoidentityprovider";var J4=[0,Ce,T$,8,0],BN=[0,Ce,y4,8,0],Tx=[0,Ce,S4,8,0],X4=[-3,Ce,g$,{[St]:Rt,[At]:400},[Ct],[0]];ht.for(Ce).registerError(X4,a_);var Q4=[3,Ce,w$,0,[v$],[0]],Z4=[3,Ce,S$,0,[C$,U$,C4,m4,n4,c4],[[()=>Tx,0],1,0,[()=>Tx,0],[()=>Tx,0],()=>S3]],e3=[-3,Ce,k$,{[St]:Rt,[At]:400},[Ct],[0]];ht.for(Ce).registerError(e3,e_);var t3=[-3,Ce,A$,{[St]:Rt,[At]:400},[Ct],[0]];ht.for(Ce).registerError(t3,m_);var r3=[-3,Ce,I$,{[St]:Rt,[At]:400},[Ct],[0]];ht.for(Ce).registerError(r3,x_);var n3=[-3,Ce,D$,{[St]:Rt,[At]:400},[Ct],[0]];ht.for(Ce).registerError(n3,N_);var s3=[-3,Ce,L$,{[St]:Rt,[At]:400},[Ct],[0]];ht.for(Ce).registerError(s3,R_);var o3=[-3,Ce,z$,{[St]:Rt,[At]:400},[Ct],[0]];ht.for(Ce).registerError(o3,H_);var i3=[-3,Ce,M$,{[St]:Rt,[At]:400},[Ct],[0]];ht.for(Ce).registerError(i3,g_);var a3=[-3,Ce,B$,{[St]:Rt,[At]:403},[Ct],[0]];ht.for(Ce).registerError(a3,P_);var l3=[-3,Ce,H$,{[St]:Rt,[At]:403},[Ct],[0]];ht.for(Ce).registerError(l3,w_);var c3=[-3,Ce,G$,{[St]:Rt,[At]:400},[Ct],[0]];ht.for(Ce).registerError(c3,T_);var u3=[3,Ce,V$,0,[y$,N$,b$,R$,x$,N4,zN],[0,[()=>J4,0],[()=>oU,0],128,()=>Q4,[()=>B3,0],[()=>BN,0]],2],d3=[3,Ce,q$,0,[P$,zN,F$,E$,m$],[0,[()=>BN,0],128,[()=>Z4,0],64]],f3=[-3,Ce,Y$,{[St]:Y4},[Ct],[0]];ht.for(Ce).registerError(f3,Hb);var h3=[-3,Ce,J$,{[St]:Rt,[At]:400},[Ct],[0]];ht.for(Ce).registerError(h3,c_);var p3=[-3,Ce,X$,{[St]:Rt,[At]:400},[Ct],[0]];ht.for(Ce).registerError(p3,Yb);var m3=[-3,Ce,Q$,{[St]:Rt,[At]:400},[Ct],[0]];ht.for(Ce).registerError(m3,O_);var g3=[-3,Ce,Z$,{[St]:Rt,[At]:400},[Ct,K4],[0,0]];ht.for(Ce).registerError(g3,Bb);var v3=[-3,Ce,e4,{[St]:Rt,[At]:400},[Ct],[0]];ht.for(Ce).registerError(v3,t_);var y3=[-3,Ce,t4,{[St]:Rt,[At]:400},[Ct],[0]];ht.for(Ce).registerError(y3,r_);var x3=[-3,Ce,r4,{[St]:Rt,[At]:400},[Ct],[0]];ht.for(Ce).registerError(x3,n_);var w3=[-3,Ce,s4,{[St]:Rt,[At]:400},[Ct],[0]];ht.for(Ce).registerError(w3,l_);var b3=[-3,Ce,o4,{[St]:Rt,[At]:400},[Ct],[0]];ht.for(Ce).registerError(b3,Jb);var _3=[-3,Ce,a4,{[St]:Rt,[At]:400},[Ct],[0]];ht.for(Ce).registerError(_3,A_);var E3=[-3,Ce,i4,{[St]:Rt,[At]:400},[Ct],[0]];ht.for(Ce).registerError(E3,u_);var S3=[3,Ce,u4,0,[O$,j$],[0,0]],C3=[-3,Ce,l4,{[St]:Rt,[At]:403},[Ct],[0]];ht.for(Ce).registerError(C3,Gb);var k3=[-3,Ce,d4,{[St]:Rt,[At]:400},[Ct],[0]];ht.for(Ce).registerError(k3,v_);var N3=[-3,Ce,h4,{[St]:Rt,[At]:400},[Ct],[0]];ht.for(Ce).registerError(N3,d_);var T3=[-3,Ce,f4,{[St]:Rt,[At]:400},[Ct],[0]];ht.for(Ce).registerError(T3,s_);var R3=[-3,Ce,g4,{[St]:Rt,[At]:400},[Ct],[0]];ht.for(Ce).registerError(R3,M_);var A3=[-3,Ce,p4,{[St]:Rt,[At]:404},[Ct],[0]];ht.for(Ce).registerError(A3,Wb);var I3=[-3,Ce,v4,{[St]:Rt,[At]:400},[Ct],[0]];ht.for(Ce).registerError(I3,D_);var P3=[-3,Ce,x4,{[St]:Rt,[At]:400},[Ct],[0]];ht.for(Ce).registerError(P3,y_);var F3=[-3,Ce,b4,{[St]:Rt,[At]:400},[Ct],[0]];ht.for(Ce).registerError(F3,I_);var j3=[-3,Ce,w4,{[St]:Rt,[At]:403},[Ct],[0]];ht.for(Ce).registerError(j3,F_);var O3=[-3,Ce,_4,{[St]:Rt,[At]:400},[Ct],[0]];ht.for(Ce).registerError(O3,Xb);var D3=[-3,Ce,E4,{[St]:Rt,[At]:429},[Ct],[0]];ht.for(Ce).registerError(D3,Vb);var L3=[-3,Ce,T4,{[St]:Rt,[At]:401},[Ct],[0]];ht.for(Ce).registerError(L3,$_);var M3=[-3,Ce,P4,{[St]:Rt,[At]:400},[Ct],[0]];ht.for(Ce).registerError(M3,Qb);var $3=[-3,Ce,I4,{[St]:Rt,[At]:400},[Ct],[0]];ht.for(Ce).registerError($3,L_);var U3=[-3,Ce,D4,{[St]:Rt,[At]:400},[Ct],[0]];ht.for(Ce).registerError(U3,f_);var z3=[-3,Ce,$4,{[St]:Rt,[At]:400},[Ct],[0]];ht.for(Ce).registerError(z3,U_);var H3=[-3,Ce,U4,{[St]:Rt,[At]:400},[Ct],[0]];ht.for(Ce).registerError(H3,o_);var B3=[3,Ce,k4,8,[W$,$$],[0,0]],G3=[-3,Ce,A4,{[St]:Rt,[At]:400},[Ct],[0]];ht.for(Ce).registerError(G3,qb);var W3=[-3,Ce,F4,{[St]:Rt,[At]:400},[Ct],[0]];ht.for(Ce).registerError(W3,Zb);var V3=[-3,Ce,R4,{[St]:Rt,[At]:400},[Ct],[0]];ht.for(Ce).registerError(V3,i_);var q3=[-3,Ce,j4,{[St]:Rt,[At]:400},[Ct],[0]];ht.for(Ce).registerError(q3,h_);var K3=[-3,Ce,O4,{[St]:Rt,[At]:404},[Ct],[0]];ht.for(Ce).registerError(K3,Kb);var Y3=[-3,Ce,L4,{[St]:Rt,[At]:400},[Ct],[0]];ht.for(Ce).registerError(Y3,p_);var J3=[-3,Ce,M4,{[St]:Rt,[At]:400},[Ct],[0]];ht.for(Ce).registerError(J3,j_);var X3=[-3,Ce,B4,{[St]:Rt,[At]:400},[Ct],[0]];ht.for(Ce).registerError(X3,b_);var Q3=[-3,Ce,z4,{[St]:Rt,[At]:400},[Ct],[0]];ht.for(Ce).registerError(Q3,__);var Z3=[-3,Ce,H4,{[St]:Rt,[At]:400},[Ct],[0]];ht.for(Ce).registerError(Z3,z_);var eU=[-3,Ce,G4,{[St]:Rt,[At]:400},[Ct],[0]];ht.for(Ce).registerError(eU,E_);var tU=[-3,Ce,W4,{[St]:Rt,[At]:400},[Ct],[0]];ht.for(Ce).registerError(tU,S_);var rU=[-3,Ce,V4,{[St]:Rt,[At]:400},[Ct],[0]];ht.for(Ce).registerError(rU,C_);var nU=[-3,Ce,q4,{[St]:Rt,[At]:400},[Ct],[0]];ht.for(Ce).registerError(nU,k_);var sU=[-3,HN,"CognitoIdentityProviderServiceException",0,[],[]];ht.for(HN).registerError(sU,vt);var oU=[2,Ce,_$,8,0,0],iU=[9,Ce,K$,0,()=>u3,()=>d3];class B_ extends lN.classBuilder().ep(IM).m(function(e,t,n,s){return[eM(n,e.getEndpointParameterInstructions())]}).s("AWSCognitoIdentityProviderService","InitiateAuth",{}).n("CognitoIdentityProviderClient","InitiateAuthCommand").sc(iU).build(){}const aU="0.0.0",GN="staging",lU="outlook-addin",cU="staging-outlook-app-id",uU="https://candle-ai.github.io/FileServer_Staging/dist-outlook-addin/manifest.xml",dU="https://appsforoffice.microsoft.com/lib/1/hosted/office.js",fU="https://candle-ai.github.io/FileServer_Staging/dist-outlook-addin/src/apps/outlook-addin/auth-dialog-pkce.html",hU=!0,Ow="https://candle-ai.github.io/FileServer_Staging/dist-outlook-addin/src/apps/outlook-addin/auth-dialog-pkce.html?callback=true",pU="https://candle-ai.github.io/FileServer_Staging/dist-outlook-addin/options",G_="https://candle-ai.github.io/FileServer_Staging/dist-outlook-addin/auth/gmail/callback",Nr="https://vixpby8nfc.execute-api.us-east-1.amazonaws.com/prod",mU="https://vixpby8nfc.execute-api.us-east-1.amazonaws.com/prod",WN="https://candle-ai.github.io/FileServer_Staging/dist-outlook-addin",VN="https://candle-565393026129-us-east-1.auth.us-east-1.amazoncognito.com",uh="22pj09tqppmia7sh207a3ufaq9",qN=r=>`${VN}/login?client_id=${uh}&response_type=code&scope=email+openid+profile&redirect_uri=${r}`,KN="https://candle-565393026129-us-east-1.auth.us-east-1.amazoncognito.com/oauth2/token",gU="https://candle-565393026129-us-east-1.auth.us-east-1.amazoncognito.com/oauth2/userInfo",Kf="https://app.staging.trycandle.ai",YN="https://forms.gle/QFFz1rbFVmwJ96At6",vU="00db376f-0fb4-48b3-8844-c2cb1ba88920",JN="https://accounts.google.com/o/oauth2",XN="74023389454-6cal15ik3pu0p55rm5mr3go8kgro0gv8.apps.googleusercontent.com",W_=r=>`${JN}/auth?client_id=${XN}&redirect_uri=${r}&response_type=code&scope=https://www.googleapis.com/auth/gmail.readonly&access_type=offline&prompt=consent`,V_="https://vixpby8nfc.execute-api.us-east-1.amazonaws.com/prod/oauth/login/",Dw="phc_RZCAfsv2zW9fB7Pdb8b50InaGRQJl7f8DPbD1lkxmZP",QN="https://us.i.posthog.com",yU="outlook",xU="staging",ZN={buildTime:"2026-02-18T21:55:52.935Z",environment:"staging",configSource:"outlook_config.tsx",authMethod:"PKCE"},wU=Object.freeze(Object.defineProperty({__proto__:null,API_BASE_URL:mU,API_SERVER:Nr,AUTH_DIALOG_URL:fU,AWS_CLIENT_ID:uh,AWS_COGNITO_DOMAIN:VN,AWS_LOGIN_PAGE_URI:qN,AWS_OAUTH_TOKEN_URI:KN,AWS_USERINFO_URI:gU,BASE_DOMAIN:WN,BUILD_ENV:xU,CONFIG_VERIFICATION:ZN,FEEDBACK_FORM:YN,GMAIL_INTEGRATION_CLIENT_ID:XN,GMAIL_INTEGRATION_DOMAIN:JN,GMAIL_INTEGRATION_PAGE_URI:W_,GMAIL_INTEGRATION_REDIRECT_URI:G_,INTEGRATION_AUTH_URL_PREFIX:V_,LOGIN_REDIRECT_URI:Ow,MANIFEST_URL:uU,MODE:GN,OFFICE_JS_CDN:dU,OUTLOOK_APP_ID:cU,OUTLOOK_CLIENT_ID:vU,PLATFORM:yU,POSTHOG_HOST:QN,POSTHOG_KEY:Dw,POST_LOGIN_REDIRECT_URI:pU,SETTINGS_PAGE_URL:Kf,TYPE:lU,USE_PKCE_AUTH:hU,VERSION:aU},Symbol.toStringTag,{value:"Module"})),Yu="src/platforms/helpers/chromeAuthUtils.ts",q_=r=>new Promise(e=>{chrome.storage.local.set({token:JSON.stringify(r)},()=>{e()})}),bU=()=>new Promise(r=>{chrome.storage.local.get("token",e=>{const t=e.token?JSON.parse(e.token):null;r(t)})}),_U=()=>new Promise(r=>{chrome.storage.local.set({token:null},()=>{r()})});async function EU(r,e,t){const n="refreshAuthToken",s=new zb({region:"us-east-1"});try{t.info("Preparing for REFRESH_TOKEN_AUTH",{sourceFile:Yu,functionName:n}),t.debug("AuthFlow: REFRESH_TOKEN_AUTH",{sourceFile:Yu,functionName:n}),t.info("Refreshing auth token...",{sourceFile:Yu,functionName:n});const i=new B_({ClientId:uh,AuthFlow:"REFRESH_TOKEN_AUTH",AuthParameters:{REFRESH_TOKEN:r.refresh_token}}),u=(await s.send(i)).AuthenticationResult;if(!u)throw new Error("AuthenticationResult is missing in the response.");const{IdToken:p,AccessToken:m,RefreshToken:g,ExpiresIn:x,TokenType:b}=u;if(!p||!m||!x||!b)throw new Error("Missing required fields in AuthenticationResult.");const E={id_token:p,access_token:m,refresh_token:g||r.refresh_token,expires_in:x,token_type:b,fetched_at:e};return await q_(E),E}catch(i){throw t.error("Error refreshing auth token",i,{sourceFile:Yu,functionName:n}),new Error("Failed to refresh authentication token.")}}async function SU(r){const e="handleLoginFlow";try{r.info("Starting OAuth flow in popup...",{sourceFile:Yu,functionName:e});const t=qN(Ow);r.info("Auth URL",{sourceFile:Yu,functionName:e,authUrl:t});const n=await chrome.identity.launchWebAuthFlow({url:t,interactive:!0});if(!n)throw new Error("Authentication was cancelled or failed");const i=new URL(n).searchParams.get("code");if(!i)throw new Error("No authorization code received");const c={grant_type:"authorization_code",code:i,redirect_uri:Ow,client_id:uh},u=await fetch(KN,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(c).toString()});if(!u.ok)throw new Error(`Token exchange failed: ${u.statusText}`);const p=await u.json();if(!XO(p))throw new Error("Invalid token response format");const m={...p,fetched_at:Math.floor(Date.now())};return await q_(m),{success:!0}}catch(t){return r.error("Authentication failed",t,{sourceFile:Yu,functionName:e}),{success:!1,error:t instanceof Error?t.message:"Unknown error occurred"}}}class CU{constructor(e){H(this,"logger");H(this,"authListeners",new Set);this.logger=e}async login(){try{const e=await SU(this.logger);if(!e.success)throw new Error(e.error||"Login failed");const t=await this.getToken();if(!t)throw new Error("Token not found after login");return this.notifyAuthListeners(!0),t}catch(e){throw this.logger.error("Login failed",e,{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"login"}),e}}async logout(){var e;try{if(await this.deleteToken(),this.notifyAuthListeners(!1),(e=chrome==null?void 0:chrome.runtime)!=null&&e.sendMessage)try{await chrome.runtime.sendMessage({type:"USER_LOGGED_OUT"})}catch(t){this.logger.warn("Could not send logout message",{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"logout",error:t})}}catch(t){throw this.logger.error("Logout failed",t,{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"logout"}),t}}async getToken(){try{return await bU()}catch(e){return this.logger.error("Error getting auth token",e,{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"getToken"}),null}}async saveToken(e){try{const t={...e,fetched_at:Math.floor(Date.now())};await q_(t)}catch(t){throw this.logger.error("Error saving auth token",t,{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"saveToken"}),t}}async deleteToken(){try{await _U()}catch(e){throw this.logger.error("Error deleting auth token",e,{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"deleteToken"}),e}}isTokenValid(e){if(!e||!e.expires_in)return!1;const t=e;return t.fetched_at?Math.floor(Date.now())+6e4-t.fetched_at<t.expires_in*1e3:!1}async refreshToken(e){try{const t=e,n=Math.floor(Date.now())+6e4;return await EU(t,n,this.logger)}catch(t){throw this.logger.error("Error refreshing auth token",t,{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"refreshToken"}),t}}async isAuthenticated(){try{const e=await this.getToken();if(this.logger.debug("Checking authentication status",{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"isAuthenticated",token:e}),!e)return this.logger.debug("No token found - user is not authenticated",{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"isAuthenticated"}),!1;const t=this.isTokenValid(e);if(this.logger.debug("Authentication status checked",{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"isAuthenticated",isValid:t,token:e}),!t){this.logger.debug("Token is not valid - user is not authenticated",{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"isAuthenticated"});const n=await this.refreshToken(e);return this.logger.debug("Refreshed token",{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"isAuthenticated",refreshedToken:n}),this.isTokenValid(n)}return this.logger.debug("Token is valid - user is authenticated",{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"isAuthenticated"}),!0}catch(e){return this.logger.error("Error checking authentication status",e,{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"isAuthenticated"}),!1}}onAuthStateChanged(e){this.authListeners.add(e)}removeAuthStateListener(e){this.authListeners.delete(e)}notifyAuthListeners(e){this.logger.info("Notifying auth listeners",{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"notifyAuthListeners",isAuthenticated:e}),this.authListeners.forEach(t=>{try{t(e)}catch(n){this.logger.error("Error in auth state callback",n,{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"notifyAuthListeners"})}})}}class kU{constructor(e){H(this,"logger");H(this,"messageListeners",new Set);this.logger=e,this.setupMessageListeners()}setupMessageListeners(){var e;(e=chrome==null?void 0:chrome.runtime)!=null&&e.onMessage&&chrome.runtime.onMessage.addListener((t,n,s)=>{this.messageListeners.forEach(i=>{try{i(t)}catch(c){this.logger.error("Error in message callback",c,{sourceFile:"src/platforms/chrome/ChromeMessagingProvider.ts",sourceFunction:"setupMessageListeners"})}})})}async sendMessage(e){return new Promise((t,n)=>{var s;if(!((s=chrome==null?void 0:chrome.runtime)!=null&&s.sendMessage)){n(new Error("Chrome runtime not available"));return}chrome.runtime.sendMessage(e,i=>{var c;chrome.runtime.lastError?(this.logger.error("Error sending message",chrome.runtime.lastError,{sourceFile:"src/platforms/chrome/ChromeMessagingProvider.ts",sourceFunction:"sendMessage",message:e}),n(new Error(((c=chrome.runtime.lastError)==null?void 0:c.message)||"Unknown error"))):t(i)})})}onMessage(e){var n;const t=s=>{e(s)};this.messageListeners.add(t),(n=chrome==null?void 0:chrome.runtime)!=null&&n.onMessage&&chrome.runtime.onMessage.addListener(t)}removeMessageListener(e){this.messageListeners.forEach(t=>{var n;(n=chrome==null?void 0:chrome.runtime)!=null&&n.onMessage&&chrome.runtime.onMessage.removeListener(t)}),this.messageListeners.clear()}async sendTabMessage(e,t){return new Promise((n,s)=>{var i;if(!((i=chrome==null?void 0:chrome.tabs)!=null&&i.sendMessage)){s(new Error("Chrome tabs API not available"));return}chrome.tabs.sendMessage(e,t,c=>{var u;chrome.runtime.lastError?(this.logger.error("Error sending tab message",chrome.runtime.lastError,{sourceFile:"src/platforms/chrome/ChromeMessagingProvider.ts",sourceFunction:"sendTabMessage",message:t}),s(new Error(((u=chrome.runtime.lastError)==null?void 0:u.message)||"Unknown error"))):n(c)})})}}class NU{constructor(e){H(this,"logger");H(this,"eventListeners",new Map);H(this,"isInitialized",!1);this.logger=e}async initialize(){if(this.isInitialized){this.logger.info("Chrome platform already initialized",{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"initialize"});return}try{this.logger.info("Initializing Chrome platform...",{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"initialize"}),this.setupChromeEventListeners(),this.isInitialized=!0,this.logger.info("Chrome platform initialized successfully",{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"initialize"})}catch(e){throw this.logger.error("Failed to initialize Chrome platform",e,{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"initialize"}),e}}async cleanup(){try{this.logger.info("Cleaning up Chrome platform...",{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"cleanup"}),this.eventListeners.clear(),this.isInitialized=!1,this.logger.info("Chrome platform cleanup completed",{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"cleanup"})}catch(e){throw this.logger.error("Failed to cleanup Chrome platform",e,{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"cleanup"}),e}}async closeWindow(){try{typeof chrome<"u"&&chrome.sidePanel&&window.close(),this.logger.debug("Window close requested",{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"closeWindow"})}catch(e){throw this.logger.error("Failed to close window",e,{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"closeWindow"}),e}}onPlatformEvent(e,t){var n,s;switch(e){case"runtime.onInstalled":(n=chrome==null?void 0:chrome.runtime)!=null&&n.onInstalled&&chrome.runtime.onInstalled.addListener(t);break;case"runtime.onStartup":(s=chrome==null?void 0:chrome.runtime)!=null&&s.onStartup&&chrome.runtime.onStartup.addListener(t);break;default:this.logger.warn("Unknown platform event",{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"onPlatformEvent",event:e})}}setupChromeEventListeners(){var e,t,n;(e=chrome==null?void 0:chrome.runtime)!=null&&e.onStartup&&chrome.runtime.onStartup.addListener(()=>{this.emitPlatformEvent("startup")}),(t=chrome==null?void 0:chrome.runtime)!=null&&t.onSuspend&&chrome.runtime.onSuspend.addListener(()=>{this.emitPlatformEvent("suspend")}),(n=chrome==null?void 0:chrome.runtime)!=null&&n.onInstalled&&chrome.runtime.onInstalled.addListener(s=>{this.emitPlatformEvent("installed",s)})}emitPlatformEvent(e,...t){const n=this.eventListeners.get(e);n&&n.forEach(s=>{try{s(...t)}catch(i){this.logger.error(`Error in platform event callback for ${e}`,i,{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"emitPlatformEvent",event:e})}})}handleExtensionMessage(e,t,n){return this.logger.debug("Extension message received",{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"handleExtensionMessage",message:e,sender:t}),!0}handleContextMenuClick(e,t){this.logger.debug("Context menu clicked",{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"handleContextMenuClick",info:e,tab:t})}}const xi=async r=>{try{return(await Kn.createServices()).storage}catch(e){return r.warn("Platform detection failed, falling back to Chrome storage",{sourceFile:"src/shared/lib/utils/storageUtils.tsx",error:e}),null}},TU=async r=>{const e=await xi(r);e&&await e.clearLocal()},RU=async(r,e)=>{try{const t=await Kn.createServices();if(Kn.getCurrentPlatform()==="outlook"){r.debug("Token saving handled by OutlookAuthProvider",{sourceFile:"src/shared/lib/utils/storageUtils.tsx",sourceFunction:"saveAuthTokenPlatform"});return}const n=t.storage;n&&await n.setLocalItem("token",e)}catch(t){throw r.error("Failed to save auth token",t,{sourceFile:"src/shared/lib/utils/storageUtils.tsx",sourceFunction:"saveAuthTokenPlatform"}),t}},Rm=async r=>{try{const e=await Kn.createServices();if(Kn.getCurrentPlatform()==="outlook"){const n=await e.auth.getToken();return n?(r.info("Auth token retrieved from auth provider",{sourceFile:"src/shared/lib/utils/storageUtils.tsx",sourceFunction:"getAuthTokenPlatform",authToken:n}),n):null}const t=e.storage;return t?await t.getLocalItem("token"):null}catch(e){return r.error("Failed to get auth token",e,{sourceFile:"src/shared/lib/utils/storageUtils.tsx",sourceFunction:"getAuthTokenPlatform"}),null}},zy=async r=>{try{const e=await Kn.createServices();if(Kn.getCurrentPlatform()==="outlook"){await e.auth.logout();return}const t=e.storage;t&&await t.removeLocalItem("token")}catch(e){r.error("Failed to delete auth token",e,{sourceFile:"src/shared/lib/utils/storageUtils.tsx",sourceFunction:"deleteAuthTokenPlatform"})}},eT=async(r,e)=>{const t=await xi(r);if(t){const n={...e};(!n.id||n.id==="")&&(n.id=String(Date.now())),await t.setLocalItem("configuration",n)}},ry=async r=>{const e=await xi(r);return e?await e.getLocalItem("configuration")||{id:"",preferences:{theme:"",notificationsEnabled:!1,language:""},profile:{name:"",organization:"",role:""},templateConfiguration:{tags:[],fieldSubstitutions:{}},integrations:[]}:{id:"",preferences:{theme:"",notificationsEnabled:!1,language:""},profile:{name:"",organization:"",role:""},templateConfiguration:{tags:[],fieldSubstitutions:{}},integrations:[]}},AU=async(r,e)=>{const t=await xi(r);t&&await t.setLocalItem("emailTemplates",e)},tT=async r=>{const e=await xi(r);return e?await e.getLocalItem("emailTemplates")||[]:[]},Hm=async(r,e)=>{const t=await xi(r);t&&await t.setLocalItem("integrations",e)},Bm=async r=>{const e=await xi(r);return e?await e.getLocalItem("integrations")||[]:[]},IU=async(r,e)=>{const t=await xi(r);t&&await t.setLocalItem("orgTemplates",e)},rT=async r=>{const e=await xi(r);return e?await e.getLocalItem("orgTemplates")||[]:[]},PU=async(r,e)=>{const t=await xi(r);if(t){const n=new Date().toISOString();await t.setLocalItem("gmailConnectionStatus",e),await t.setLocalItem("gmailConnectionStatusTimestamp",n),r.debug("Saved Gmail connection status to storage",{sourceFile:"src/shared/lib/utils/storageUtils.tsx",isConnected:e,timestamp:n})}},FU=async r=>{const e=await xi(r);if(e){const t=await e.getLocalItem("gmailConnectionStatus"),n=await e.getLocalItem("gmailConnectionStatusTimestamp");return r.debug("Retrieved Gmail connection status from storage",{sourceFile:"src/shared/lib/utils/storageUtils.tsx",isConnected:t,timestamp:n}),{isConnected:t,timestamp:n}}return{isConnected:null,timestamp:null}},nT=async r=>{const e=await xi(r);e&&(await e.removeLocalItem("clients"),await e.removeLocalItem("integrations"))},Xs="src/lib/utils/authUtils.tsx";async function sT(r,e,t,n){const s="withLock";if(r.current)return n.info(`${t} already in progress, waiting for completion...`,{sourceFile:Xs,functionName:s}),await r.current;r.current=e();try{return await r.current}finally{r.current=null}}const jU={current:null};async function Lw(r){return sT(jU,()=>OU(r),"Token validation",r)}async function OU(r){const e="performTokenValidation";let t=await Rm(r);if(!t)throw new Error("No authentication token found.");const n=Math.floor(Date.now()),s=t.expires_in*1e3+(t.fetched_at||0);if(r.info("Token expiry check",{sourceFile:Xs,functionName:e,tokenExpiry:new Date(s).toISOString(),currentTime:new Date(n).toISOString(),timeUntilExpiry:s-n}),s-n<3e5)try{r.info("Token expired. Refreshing...",{sourceFile:Xs,functionName:e}),t=await oT(t,n,r),r.info("New token received",{sourceFile:Xs,functionName:e})}catch(i){throw r.error("Token refresh failed",i,{sourceFile:Xs,functionName:e}),await zy(r),new Error("Unauthorized: Failed to refresh token.")}return t}const Rx=20,DU=500;function LU(r){return new Promise(e=>setTimeout(e,r))}function MU(r){var s;const e=r,t=(s=e==null?void 0:e.$metadata)==null?void 0:s.httpStatusCode;if(typeof t=="number")return t>=500||t===429||t===408;const n=["TimeoutError","NetworkError"];return typeof(e==null?void 0:e.name)=="string"&&n.includes(e.name),!0}async function oT(r,e,t){const n="refreshAuthToken",s=new zb({region:"us-east-1"});for(let i=1;i<=Rx;i++)try{t.info(`Refreshing auth token (attempt ${i})...`,{sourceFile:Xs,functionName:n});const c=new B_({ClientId:uh,AuthFlow:"REFRESH_TOKEN_AUTH",AuthParameters:{REFRESH_TOKEN:r.refresh_token}}),p=(await s.send(c)).AuthenticationResult;if(!p)throw new Error("AuthenticationResult is missing in the response.");const{IdToken:m,AccessToken:g,RefreshToken:x,ExpiresIn:b,TokenType:E}=p;if(!m||!g||!b||!E)throw new Error("Missing required fields in AuthenticationResult.");const T={id_token:m,access_token:g,refresh_token:x||r.refresh_token,expires_in:b,token_type:E,fetched_at:e};return await RU(t,T),T}catch(c){const u=MU(c);if(t.error(`Error refreshing auth token (attempt ${i}/${Rx})`,c,{sourceFile:Xs,functionName:n,isTransient:u}),!u||i===Rx)throw await zy(t),new Error("Failed to refresh authentication token.");const p=DU*2**(i-1);t.warn(`Transient error refreshing token  retrying in ${p}ms`,{sourceFile:Xs,functionName:n,attempt:i}),await LU(p)}throw new Error("Failed to refresh authentication token.")}const $U={current:null};async function UU(r){return sT($U,()=>zU(r),"Force token refresh",r)}async function zU(r){const e="performForceTokenRefresh",t=await Rm(r);if(!t)throw new Error("No authentication token found.");const n=Math.floor(Date.now());r.info("Force refreshing token before opening options page",{sourceFile:Xs,functionName:e,currentTime:new Date(n).toISOString()});const s=await oT(t,n,r);return r.info("Token force refresh successful",{sourceFile:Xs,functionName:e}),s}async function $r(r,e={},t){const n="fetchWithAuth",s=Date.now(),i=Date.now();let c=await Lw(t);const u=Date.now()-i;e.headers={...e.headers,Authorization:`${c.id_token}`};const p=Date.now(),m=await fetch(r,e),g=Date.now()-p;if(t.info("fetchWithAuth completed",{sourceFile:Xs,functionName:n,url:r.pathname,status:m.status,tokenValidationMs:u,networkFetchMs:g,totalMs:Date.now()-s}),m.status===401)try{t.info("Received 401, getting fresh token...",{sourceFile:Xs,functionName:n});const x=Date.now();c=await Lw(t);const b=Date.now()-x;t.info("New token received for retry",{sourceFile:Xs,functionName:n,retryTokenMs:b}),e.headers&&typeof e.headers=="object"&&!Array.isArray(e.headers)&&(e.headers.Authorization=`${c.id_token}`);const E=Date.now(),T=await fetch(r,e),S=Date.now()-E;return t.info("fetchWithAuth retry completed",{sourceFile:Xs,functionName:n,url:r.pathname,status:T.status,retryTokenMs:b,retryFetchMs:S,totalMs:Date.now()-s}),T}catch(x){throw t.error("Token refresh failed",x,{sourceFile:Xs,functionName:n}),await zy(t),new Error("Unauthorized: Failed to refresh token.")}return m}class HU{constructor(e){H(this,"logger");this.logger=e}getResourceURL(e){return chrome.runtime.getURL(e)}async queryTabs(e={}){return new Promise(t=>{chrome.tabs.query(e,n=>{t(n.map(s=>({id:s.id,url:s.url,active:s.active})))})})}async updateTab(e,t){return new Promise(n=>{chrome.tabs.update(e,t,()=>{n()})})}async reloadTab(e){return new Promise(t=>{chrome.tabs.reload(e,void 0,()=>{t()})})}async openOptionsPage(){return new Promise(async e=>{try{const t=await UU(this.logger);let n=Kf;t!=null&&t.id_token&&(n+=`?token=${encodeURIComponent(t.id_token)}`),this.logger.info("Opening external options page",{sourceFile:"src/platforms/chrome/ChromeTabsProvider.ts",functionName:"openOptionsPage",url:Kf,hasToken:!!(t!=null&&t.id_token)}),chrome.tabs.create({url:n},()=>{e()})}catch(t){this.logger.error("Failed to open options page",t,{sourceFile:"src/platforms/chrome/ChromeTabsProvider.ts",functionName:"openOptionsPage"}),chrome.tabs.create({url:Kf},()=>{e()})}})}async openURL(e,t="_blank"){return new Promise(n=>{t==="_blank"?chrome.tabs.create({url:e},()=>{n()}):(window.open(e,t),n())})}}function Hv(r){const t=new DOMParser().parseFromString(r,"text/html"),n={white:"#ffffff",black:"#000000",red:"#e60000",orange:"#f90",yellow:"#ff0",green:"#008a00",blue:"#06c",purple:"#93f"};t.querySelectorAll("[class]").forEach(m=>{const g=m.classList,x={},b=[],E=m.getAttribute("style");E&&E.split(";").forEach(S=>{const[N,R]=S.split(":").map(A=>A.trim());N&&R&&(x[N]=R)});for(const S of["left","center","right","justify"]){const N=`ql-align-${S}`;if(g.contains(N)){const R=m.tagName.toLowerCase();R==="li"?S==="center"?(x["text-align"]="center",x["list-style-position"]="inside"):S==="right"?(x["text-align"]="right",x["list-style-position"]="inside"):S==="left"?x["text-align"]="left":S==="justify"&&(x["text-align"]="justify"):R==="ol"||R==="ul"?S==="center"?(x["margin-left"]="auto",x["margin-right"]="auto",x["padding-left"]="40px",x.width="fit-content"):S==="right"?(x["margin-left"]="auto",x["margin-right"]="0",x["padding-left"]="40px",x.width="fit-content"):S==="left"&&(x["margin-left"]="0",x["margin-right"]="auto"):x["text-align"]=S,b.push(N)}}g.contains("ql-font-serif")&&(x["font-family"]="Georgia, Times New Roman, serif",b.push("ql-font-serif")),g.contains("ql-font-monospace")&&(x["font-family"]="Monaco, Courier New, monospace",b.push("ql-font-monospace"));const T={"ql-size-small":"0.75em","ql-size-large":"1.5em","ql-size-huge":"2.5em"};for(const[S,N]of Object.entries(T))g.contains(S)&&(x["font-size"]=N,b.push(S));for(const[S,N]of Object.entries(n)){const R=`ql-color-${S}`;g.contains(R)&&(x.color=N,b.push(R))}for(const[S,N]of Object.entries(n)){const R=`ql-bg-${S}`;g.contains(R)&&(x["background-color"]=N,b.push(R))}if(Object.keys(x).length>0){const S=Object.entries(x).map(([N,R])=>`${N}: ${R}`).join("; ");m.setAttribute("style",S)}b.forEach(S=>{g.remove(S)}),g.length===0&&m.removeAttribute("class")});const i=t.createTreeWalker(t.body,NodeFilter.SHOW_TEXT,null),c=[];let u;for(;u=i.nextNode();)if(u.nodeValue&&u.nodeValue.includes("	")){const m=u.nodeValue.replace(/\t/g,"");c.push({node:u,newValue:m})}return c.forEach(({node:m,newValue:g})=>{m.nodeValue=g}),t.querySelectorAll("ul, ol").forEach(m=>{var E,T;const g=Array.from(m.children);if(g.length===0)return;const x=g.some(S=>S.getAttribute("data-list")==="bullet"),b=g.some(S=>S.getAttribute("data-list")==="ordered");if(x&&b){const S=t.createDocumentFragment();let N=null,R=null;g.forEach(A=>{const j=A.getAttribute("data-list")||"bullet";if(R!==j||!N){N=t.createElement(j==="ordered"?"ol":"ul");const P=m.getAttribute("style");P&&N.setAttribute("style",P);const M=m.getAttribute("class");M&&N.setAttribute("class",M),S.appendChild(N),R=j}N.appendChild(A.cloneNode(!0))}),(E=m.parentNode)==null||E.replaceChild(S,m)}else if(b&&m.tagName.toLowerCase()==="ul"){const S=t.createElement("ol");for(Array.from(m.attributes).forEach(N=>{S.setAttribute(N.name,N.value)});m.firstChild;)S.appendChild(m.firstChild);(T=m.parentNode)==null||T.replaceChild(S,m)}}),t.body.innerHTML}class BU{constructor(e){H(this,"logger");this.logger=e}async executeScript(e){var t;try{return(t=(await chrome.scripting.executeScript({target:e.target,func:e.func,args:e.args}))[0])==null?void 0:t.result}catch(n){throw this.logger.error("Error executing script",n,{sourceFile:"src/platforms/chrome/ChromeContentScriptProvider.ts",sourceFunction:"executeScript"}),n}}async insertContentIntoComposeBox(e){try{const t=Hv(e),s=(await chrome.tabs.query({active:!0,currentWindow:!0}))[0];if(!(s!=null&&s.id))throw new Error("No active tab found or tab ID is undefined");await chrome.scripting.executeScript({target:{tabId:s.id},func:i=>{function c(){return document.querySelector('div[role="textbox"][aria-label="Message Body"]')||document.querySelector('div[aria-label="Message body, press Alt+F10 to exit"]')}function u(x){var S;const b=window.getSelection();let E=null,T=0;if(b&&b.rangeCount>0&&(E=b.getRangeAt(0).cloneRange(),x.contains(E.startContainer)||x===E.startContainer)){const N=document.createTreeWalker(x,NodeFilter.SHOW_TEXT,null,!1);let R=0,A;for(;A=N.nextNode();)if(A===E.startContainer){R+=E.startOffset;break}else R+=((S=A.textContent)==null?void 0:S.length)||0;T=R}return{selection:b,range:E,offset:T}}function p(x,b){var E;try{const{selection:T,range:S,offset:N}=b;if(!T)return;if(S&&x.contains(S.startContainer)){T.removeAllRanges(),T.addRange(S);return}if(N>0){const A=document.createTreeWalker(x,NodeFilter.SHOW_TEXT,null,!1);let j=0,P;for(;P=A.nextNode();){const M=((E=P.textContent)==null?void 0:E.length)||0;if(j+M>=N){const B=document.createRange();B.setStart(P,N-j),B.collapse(!0),T.removeAllRanges(),T.addRange(B);return}j+=M}}const R=document.createRange();R.selectNodeContents(x),R.collapse(!1),T.removeAllRanges(),T.addRange(R)}catch(T){console.warn("Could not restore cursor position:",T)}}function m(x,b){document.execCommand("insertHTML",!1,b)}const g=c();if(!g)throw new Error("Compose box not found");try{const x=u(g);g.focus(),p(g,x),navigator.clipboard&&navigator.clipboard.writeText?navigator.clipboard.writeText(i).then(()=>{document.execCommand("paste")}).catch(()=>{m(g,i)}):m(g,i)}catch(x){throw new Error("Error during paste operation: "+x)}},args:[t]})}catch(t){throw this.logger.error("Error inserting content into compose box",t,{sourceFile:"src/platforms/chrome/ChromeContentScriptProvider.ts",sourceFunction:"insertContentIntoComposeBox"}),t}}}class GU{constructor(e){H(this,"logger");this.logger=e}async launchWebAuthFlow(e){try{const t=await chrome.identity.launchWebAuthFlow(e);if(!t)throw new Error("Authentication was cancelled or failed");return t}catch(t){throw this.logger.error("Error launching web auth flow",t,{sourceFile:"src/platforms/chrome/ChromeIdentityProvider.ts",sourceFunction:"launchWebAuthFlow"}),t}}async initiateOAuth(e,t){return this.launchWebAuthFlow({url:e,interactive:!0})}}const WU="CandleLogsDB",VU=1,Ju="logs",qU=5e3,KU=500,oC={ERROR:1,WARN:2,INFO:3,DEBUG:4};let Dp=null;function Mw(){return Dp||(Dp=new Promise((r,e)=>{console.log("[Logger] Initializing IndexedDB...");const t=indexedDB.open(WU,VU);t.onupgradeneeded=n=>{console.log("[Logger] IndexedDB upgrade needed.");const s=n.target.result;if(!s.objectStoreNames.contains(Ju)){console.log(`[Logger] Creating object store: ${Ju}`);const i=s.createObjectStore(Ju,{keyPath:"id",autoIncrement:!0});console.log("[Logger] Creating indexes: timestamp, level, chromeContext"),i.createIndex("timestamp","timestamp",{unique:!1}),i.createIndex("level","level",{unique:!1}),i.createIndex("chromeContext","chromeContext",{unique:!1})}},t.onsuccess=n=>{console.log("[Logger] IndexedDB initialized successfully."),r(n.target.result)},t.onerror=n=>{console.error("[Logger] IndexedDB initialization failed:",n.target.error),Dp=null,e(n.target.error)},t.onblocked=()=>{console.warn("[Logger] IndexedDB initialization blocked. Close other tabs using the database.")}}),Dp)}Mw().catch(r=>console.error("[Logger] Initial DB connection failed:",r));const Ho=class Ho{constructor(e){H(this,"context");H(this,"minLevel","INFO");this.context=e||"unknown"}async writeLog(e,t,n,s){if(oC[e]>oC[this.minLevel])return;const i=(n==null?void 0:n.sourceFile)||"unknown",c=n==null?void 0:n.sourceFunction;let u;s&&(s instanceof Error?u={name:s.name,message:s.message,stack:s.stack}:u=s);const{sourceFile:p,sourceFunction:m,...g}=n||{},x={...u?{error:u}:{},...g};{const T=[`[${e}] [${this.context}] [${i}${c?` (${c})`:""}]: ${t}`];switch(s&&T.push(s),Object.keys(g).length>0&&T.push(g),e){case"DEBUG":console.debug(...T);break;case"INFO":console.info(...T);break;case"WARN":console.warn(...T);break;case"ERROR":console.error(...T);break}}const b={timestamp:new Date().toISOString(),level:e,message:t,chromeContext:this.context,sourceFile:i,...c&&{sourceFunction:c},details:Object.keys(x).length>0?x:void 0};try{const T=(await Mw()).transaction(Ju,"readwrite"),N=T.objectStore(Ju).add(b);return new Promise((R,A)=>{N.onsuccess=()=>{R()},N.onerror=j=>{console.error("[Logger] Failed to write log to IndexedDB:",j.target.error,b),A(j.target.error)},T.onerror=j=>{console.error("[Logger] Transaction error writing log:",j.target.error,b),A(j.target.error)},T.onabort=j=>{console.warn("[Logger] Transaction aborted writing log:",j.target.error,b),A(new Error("Transaction aborted"))}})}catch(E){throw console.error("[Logger] Error obtaining DB or starting transaction:",E,b),E}}static async _cleanupOldLogs(){if(this._isCleaning){console.info("[Logger] Cleanup already in progress, skipping.");return}console.info("[Logger] Starting log cleanup check..."),this._isCleaning=!0;try{const t=(await Mw()).transaction(Ju,"readwrite"),n=t.objectStore(Ju),s=n.count(),i=await new Promise((m,g)=>{s.onsuccess=()=>m(s.result),s.onerror=x=>{console.error("[Logger] Failed to count logs for cleanup:",x.target.error),g(x.target.error)}});if(i<=this.MAX_LOG_ENTRIES){console.info(`[Logger] Log count (${i}) within limit (${this.MAX_LOG_ENTRIES}). No cleanup needed.`);return}let c=i-this.MAX_LOG_ENTRIES;console.warn(`[Logger] Log count (${i}) exceeds limit (${this.MAX_LOG_ENTRIES}). Deleting ${c} oldest logs.`);const u=n.openCursor();let p=0;await new Promise((m,g)=>{u.onsuccess=x=>{const b=x.target.result;if(b&&c>0){const E=b.delete();E.onsuccess=()=>{p++,c--,c>0?b.continue():m()},E.onerror=T=>{console.error("[Logger] Error deleting log entry during cleanup:",T.target.error,"Key:",b.primaryKey),b.continue()}}else m()},u.onerror=x=>{console.error("[Logger] Error opening cursor for cleanup:",x.target.error),g(x.target.error)}}),await new Promise((m,g)=>{t.oncomplete=()=>{console.info(`[Logger] Log cleanup finished. Deleted ${p} entries.`),m()},t.onerror=x=>{console.error("[Logger] Transaction error during cleanup:",x.target.error),g(x.target.error)},t.onabort=x=>{console.warn("[Logger] Transaction aborted during cleanup:",x.target.error),g(new Error("Cleanup transaction aborted"))}})}catch(e){console.error("[Logger] Error during log cleanup process:",e)}finally{this._isCleaning=!1,console.info("[Logger] Log cleanup check finished.")}}_triggerCleanupCheck(){if(Ho._writeCount++,Ho._writeCount>=Ho.CLEANUP_TRIGGER_COUNT&&!Ho._isCleaning){const e=Ho._writeCount;Ho._writeCount=0,console.info(`[Logger] Write count reached ${e}. Triggering background cleanup.`),Ho._cleanupOldLogs().catch(t=>{console.error("[Logger] Background cleanup process failed:",t)})}}async debug(e,t){try{await this.writeLog("DEBUG",e,t),this._triggerCleanupCheck()}catch{}}async info(e,t){try{await this.writeLog("INFO",e,t),this._triggerCleanupCheck()}catch{}}async warn(e,t){try{await this.writeLog("WARN",e,t),this._triggerCleanupCheck()}catch{}}async error(e,t,n){try{await this.writeLog("ERROR",e,n,t),this._triggerCleanupCheck()}catch{}}};H(Ho,"_writeCount",0),H(Ho,"_isCleaning",!1),H(Ho,"MAX_LOG_ENTRIES",qU),H(Ho,"CLEANUP_TRIGGER_COUNT",KU);let $w=Ho;class YU{constructor(e){H(this,"logger");this.logger=new $w(e)}async debug(e,t){return this.logger.debug(e,t)}async info(e,t){return this.logger.info(e,t)}async warn(e,t){return this.logger.warn(e,t)}async error(e,t,n){return this.logger.error(e,t,n)}setMinLevel(e){console.warn("[ChromeLoggingProvider] setMinLevel not yet implemented - using hardcoded INFO level")}getMinLevel(){return"INFO"}}function JU(r="unknown"){const e=new YU(r==="background"?"background":"options");return{storage:new WO(e),data:new VO(e),auth:new CU(e),messaging:new kU(e),lifecycle:new NU(e),tabs:new HU(e),contentScript:new BU(e),identity:new GU(e),logging:e}}class XU{constructor(e){H(this,"logger");H(this,"_changeListeners",[]);H(this,"onChanged",e=>{this.logger.warn("onChanged listener not fully supported with Office roaming settings. Callbacks will be stored but not automatically invoked.",{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"onChanged"}),this._changeListeners.push(e)});H(this,"removeChangeListener",e=>{this.logger.warn("removeChangeListener not fully supported with Office roaming settings.",{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"removeChangeListener"}),this._changeListeners=this._changeListeners.filter(t=>t!==e)});this.logger=e}async getLocalItem(e){var t;try{if(typeof localStorage<"u"){const n=localStorage.getItem(e);if(n){const s=JSON.parse(n);return this.logger.debug(`Retrieved local item with key: ${e}`,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"getLocalItem"}),s}}else if((t=Office==null?void 0:Office.context)!=null&&t.roamingSettings){const n=Office.context.roamingSettings.get(e);if(n){const s=JSON.parse(n);return this.logger.debug(`Retrieved item from roaming settings with key: ${e}`,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"getLocalItem"}),s}}return null}catch(n){return this.logger.error(`Error retrieving local item with key: ${e}`,n,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"getLocalItem"}),null}}async setLocalItem(e,t){var n;try{if(typeof localStorage<"u")localStorage.setItem(e,JSON.stringify(t)),this.logger.debug(`Stored local item with key: ${e}`,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"setLocalItem"}),this._notifyChangeListeners({[e]:{newValue:t}});else if((n=Office==null?void 0:Office.context)!=null&&n.roamingSettings)Office.context.roamingSettings.set(e,JSON.stringify(t)),await new Promise((s,i)=>{Office.context.roamingSettings.saveAsync(c=>{var u;c.status===Office.AsyncResultStatus.Succeeded?(this.logger.debug(`Stored item in roaming settings with key: ${e}`,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"setLocalItem"}),s()):i(new Error(((u=c.error)==null?void 0:u.message)||"Failed to save roaming settings"))})}),this._notifyChangeListeners({[e]:{newValue:t}});else throw new Error("No storage mechanism available")}catch(s){throw this.logger.error(`Error storing local item with key: ${e}`,s,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"setLocalItem"}),s}}async removeLocalItem(e){var t;try{const n=await this.getLocalItem(e);if(typeof localStorage<"u")localStorage.removeItem(e),this.logger.debug(`Removed local item with key: ${e}`,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"removeLocalItem"}),this._notifyChangeListeners({[e]:{oldValue:n,newValue:void 0}});else if((t=Office==null?void 0:Office.context)!=null&&t.roamingSettings)Office.context.roamingSettings.remove(e),await new Promise((s,i)=>{Office.context.roamingSettings.saveAsync(c=>{var u;c.status===Office.AsyncResultStatus.Succeeded?(this.logger.debug(`Removed item from roaming settings with key: ${e}`,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"removeLocalItem"}),s()):i(new Error(((u=c.error)==null?void 0:u.message)||"Failed to save roaming settings"))})}),this._notifyChangeListeners({[e]:{oldValue:n,newValue:void 0}});else throw new Error("No storage mechanism available")}catch(n){throw this.logger.error(`Error removing local item with key: ${e}`,n,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"removeLocalItem"}),n}}async clearLocal(){var e;try{if(typeof localStorage<"u")localStorage.clear(),this.logger.info("Cleared local storage",{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"clearLocal"}),this._notifyChangeListeners({});else if((e=Office==null?void 0:Office.context)!=null&&e.roamingSettings){const t=await this.getAllKeys(),n={};for(const s of t){const i=await this.getLocalItem(s);Office.context.roamingSettings.remove(s),n[s]={oldValue:i,newValue:void 0}}await new Promise((s,i)=>{Office.context.roamingSettings.saveAsync(c=>{var u;c.status===Office.AsyncResultStatus.Succeeded?(this.logger.info("Cleared all roaming settings",{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"clearLocal"}),s()):i(new Error(((u=c.error)==null?void 0:u.message)||"Failed to save roaming settings"))})}),this._notifyChangeListeners(n)}else throw new Error("No storage mechanism available")}catch(t){throw this.logger.error("Error clearing local storage",t,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"clearLocal"}),t}}async getAllKeys(){var e;try{if(typeof localStorage<"u"){const t=Object.keys(localStorage);return this.logger.debug(`Retrieved ${t.length} keys from storage`,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"getAllKeys"}),t}else if((e=Office==null?void 0:Office.context)!=null&&e.roamingSettings)return this.logger.warn("getAllKeys not fully supported with Office roaming settings",{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"getAllKeys"}),[];return[]}catch(t){return this.logger.error("Error getting all keys",t,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"getAllKeys"}),[]}}_notifyChangeListeners(e){this._changeListeners.forEach(t=>{try{t(e)}catch(n){this.logger.error("Error in storage change callback",n,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"_notifyChangeListeners"})}})}}class QU{constructor(e){H(this,"logger");H(this,"threadListeners",new Set);H(this,"currentThread",null);H(this,"lastKnownThreadId");H(this,"debounceTimer",null);this.logger=e,this.initializeOutlookListeners()}initializeOutlookListeners(){var e,t,n,s;(t=(e=Office==null?void 0:Office.context)==null?void 0:e.mailbox)!=null&&t.addHandlerAsync&&Office.context.mailbox.addHandlerAsync(Office.EventType.ItemChanged,this.debouncedHandleItemChanged.bind(this)),(s=(n=Office==null?void 0:Office.context)==null?void 0:n.mailbox)!=null&&s.item&&setTimeout(()=>this.handleItemChanged(),100)}debouncedHandleItemChanged(){this.debounceTimer&&clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout(()=>{this.handleItemChanged(),this.debounceTimer=null},50)}async handleItemChanged(){var e,t;try{const n=await this.getCurrentThread(),s=n==null?void 0:n.threadId,i=s!==((e=this.currentThread)==null?void 0:e.threadId);if(n&&this.currentThread&&!i){const c=JSON.stringify(this.currentThread.participants.sort()),u=JSON.stringify(n.participants.sort());if(c===u)return}i||!this.currentThread&&n?(this.logger.info("Thread changed or initialized",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"handleItemChanged",oldThreadId:(t=this.currentThread)==null?void 0:t.threadId,newThreadId:s}),this.currentThread=n,this.lastKnownThreadId=s,this.notifyThreadListeners(n)):n&&this.currentThread?this.hasThreadContentChanged(this.currentThread,n)?(this.logger.info("Thread content updated",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"handleItemChanged",threadId:s}),this.currentThread=n,this.notifyThreadListeners(n)):this.currentThread=n:this.logger.info("No meaningful thread change detected",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"handleItemChanged",hasNewThread:!!n,hasCurrentThread:!!this.currentThread})}catch(n){this.logger.error("Error handling item change",n,{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"handleItemChanged"})}}hasThreadContentChanged(e,t){var i,c;if(e.subject!==t.subject)return!0;if(e.messages.length!==t.messages.length)return t.messages.length>e.messages.length;const n=new Set(e.participants),s=new Set(t.participants);if(n.size!==s.size)return!0;for(const u of n)if(!s.has(u))return!0;for(let u=0;u<Math.min(e.messages.length,t.messages.length);u++){const p=e.messages[u],m=t.messages[u],g=((i=p.body)==null?void 0:i.trim())||"",x=((c=m.body)==null?void 0:c.trim())||"";if(g!==x&&g.length>0&&x.length>0||p.from!==m.from)return!0}return!1}shouldPreserveThreadHistory(e){var t,n,s;return!!(this.currentThread&&this.currentThread.threadId===e&&this.currentThread.messages.length>0&&((n=(t=Office==null?void 0:Office.context)==null?void 0:t.mailbox)!=null&&n.item)&&(Office.context.mailbox.item.itemType==="message"||(s=Office.context.mailbox.item.itemClass)!=null&&s.includes("IPM.Note")))}async getCurrentThread(){return new Promise(e=>{var t,n;if(!((n=(t=Office==null?void 0:Office.context)==null?void 0:t.mailbox)!=null&&n.item)){this.logger.info("No Office context or mailbox item available",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getCurrentThread"}),e(null);return}try{const s=Office.context.mailbox.item;this.logger.info("Getting current thread",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getCurrentThread",itemType:s.itemType,itemClass:s.itemClass,subject:s.subject,hasConversationId:!!s.conversationId,hasGetConversationIndexAsync:!!s.getConversationIndexAsync,hasCurrentThread:!!this.currentThread,lastKnownThreadId:this.lastKnownThreadId}),this.getThreadId(s).then(i=>{if(i)return this.getItemDetails(s,i);this.logger.warn("Could not determine thread ID",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getCurrentThread"}),e(null)}).then(i=>e(i||null)).catch(i=>{this.logger.error("Error getting current thread",i,{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getCurrentThread"}),e(null)})}catch(s){this.logger.error("Error in getCurrentThread",s,{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getCurrentThread"}),e(null)}})}normalizeSubject(e){return e?e.replace(/^((re|fw|fwd):\s*)+/i,"").trim():""}async getThreadId(e){return new Promise(t=>{if(e.conversationId){const n=e.conversationId;this.logger.info("Using conversationId as thread ID",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getThreadId",conversationId:n}),this.lastKnownThreadId=n,t(n);return}if(e.getConversationIndexAsync)e.getConversationIndexAsync(n=>{if(n.status===Office.AsyncResultStatus.Succeeded&&n.value)this.logger.info("Using conversation index as thread ID",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getThreadId",conversationIndex:n.value}),this.lastKnownThreadId=n.value,t(n.value);else{this.logger.info("getConversationIndexAsync failed, trying other methods",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getThreadId",error:n.error});const s=e.subject,i=this.currentThread?this.normalizeSubject(this.currentThread.subject):"",c=this.normalizeSubject(s);if(s&&this.currentThread&&i===c&&this.lastKnownThreadId){this.logger.info("Using cached thread ID based on normalized subject match (async failed)",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getThreadId",subject:s,cachedThreadId:this.lastKnownThreadId}),t(this.lastKnownThreadId);return}const u=e.itemId||this.lastKnownThreadId||"unknown";t(u)}});else{const n=e.subject,s=this.currentThread?this.normalizeSubject(this.currentThread.subject):"",i=this.normalizeSubject(n);if(n&&this.currentThread&&s===i&&this.lastKnownThreadId)this.logger.info("Using cached thread ID based on normalized subject match (no async method)",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getThreadId",subject:n,cachedThreadId:this.lastKnownThreadId}),t(this.lastKnownThreadId||null);else{const c=e.itemId||this.lastKnownThreadId||"unknown";this.logger.info("Using final fallback ID as thread ID",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getThreadId",fallbackId:c}),t(c)}}})}async getCurrentThreadId(){return new Promise(e=>{var n,s;if(!((s=(n=Office==null?void 0:Office.context)==null?void 0:n.mailbox)!=null&&s.item)){e(this.lastKnownThreadId||null);return}const t=Office.context.mailbox.item;this.getThreadId(t).then(e).catch(()=>e(this.lastKnownThreadId||null))})}onThreadChanged(e){this.threadListeners.add(e)}removeThreadListener(e){this.threadListeners.delete(e)}destroy(){this.debounceTimer&&(clearTimeout(this.debounceTimer),this.debounceTimer=null),this.threadListeners.clear()}notifyThreadListeners(e){this.threadListeners.forEach(t=>{try{t(e)}catch(n){this.logger.error("Error in thread change callback",n,{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"notifyThreadListeners"})}})}async getItemDetails(e,t){return new Promise(async n=>{var s;try{const i=e;let c="No Subject";if(typeof i.subject=="string")c=i.subject||"No Subject";else if(i.subject&&typeof i.subject.getAsync=="function")try{c=await new Promise((g,x)=>{i.subject.getAsync(b=>{b.status===Office.AsyncResultStatus.Succeeded?g(b.value):x(b.error)})})||"No Subject"}catch{}let u=this.extractParticipants(i);try{const m=await this.extractAsyncParticipants(i),g=new Set([...u,...m]);u=Array.from(g)}catch(m){this.logger.warn("Could not extract async participants",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getItemDetails",error:m})}const p={from:this.getFromAddress(i),timestamp:this.getTimestamp(i),subject:c,body:"",html:""};if(i.body&&i.body.getAsync)i.body.getAsync(Office.CoercionType.Html,m=>{var x;m.status===Office.AsyncResultStatus.Succeeded&&(p.html=m.value,p.body=this.stripHtml(m.value));const g=this.shouldPreserveThreadHistory(t)?[...((x=this.currentThread)==null?void 0:x.messages)||[],p]:[p];n({threadId:t,messages:g,subject:c,participants:u})});else{const m=this.shouldPreserveThreadHistory(t)?[...((s=this.currentThread)==null?void 0:s.messages)||[],p]:[p];n({threadId:t,messages:m,subject:c,participants:u})}}catch(i){this.logger.error("Error getting item details",i,{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getItemDetails",threadId:t}),n(null)}})}extractParticipants(e){const t=new Set;try{const n=this.getFromAddress(e);n&&n!=="Unknown"&&t.add(n),e.sender&&e.sender.emailAddress&&t.add(e.sender.emailAddress),e.to&&Array.isArray(e.to)&&e.to.forEach(s=>{s.emailAddress&&t.add(s.emailAddress)}),e.cc&&Array.isArray(e.cc)&&e.cc.forEach(s=>{s.emailAddress&&t.add(s.emailAddress)}),e.bcc&&Array.isArray(e.bcc)&&e.bcc.forEach(s=>{s.emailAddress&&t.add(s.emailAddress)})}catch(n){this.logger.warn("Error extracting participants",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"extractParticipants",error:n})}return Array.from(t)}async extractAsyncParticipants(e){const t=new Set;try{const n=[];e.to&&typeof e.to.getAsync=="function"&&n.push(this.getRecipientsAsync(e.to,"to")),e.cc&&typeof e.cc.getAsync=="function"&&n.push(this.getRecipientsAsync(e.cc,"cc")),e.bcc&&typeof e.bcc.getAsync=="function"&&n.push(this.getRecipientsAsync(e.bcc,"bcc")),(await Promise.allSettled(n)).forEach(i=>{i.status==="fulfilled"&&i.value.forEach(c=>t.add(c))})}catch(n){this.logger.warn("Error extracting async participants",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"extractAsyncParticipants",error:n})}return Array.from(t)}getRecipientsAsync(e,t){return new Promise(n=>{e.getAsync(s=>{if(s.status===Office.AsyncResultStatus.Succeeded){const i=s.value.map(c=>c.emailAddress).filter(c=>c);n(i)}else this.logger.warn(`Error getting ${t} recipients`,{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getRecipientsAsync",error:s.error}),n([])})})}getFromAddress(e){try{return e.from&&e.from.emailAddress?e.from.emailAddress:e.sender&&e.sender.emailAddress?e.sender.emailAddress:"Unknown"}catch(t){return this.logger.warn("Error getting from address",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getFromAddress",error:t}),"Unknown"}}getCurrentUserEmail(){var e,t,n;try{if((n=(t=(e=Office==null?void 0:Office.context)==null?void 0:e.mailbox)==null?void 0:t.userProfile)!=null&&n.emailAddress){const s=Office.context.mailbox.userProfile.emailAddress;return this.logger.info("Retrieved current user email from Outlook API",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getCurrentUserEmail",userEmail:s}),s}return this.logger.warn("userProfile.emailAddress not available",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getCurrentUserEmail"}),null}catch(s){return this.logger.error("Error getting current user email",s,{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getCurrentUserEmail"}),null}}getTimestamp(e){try{return e.dateTimeCreated?e.dateTimeCreated.toISOString():e.dateTimeModified?e.dateTimeModified.toISOString():new Date().toISOString()}catch(t){return this.logger.warn("Error getting timestamp",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getTimestamp",error:t}),new Date().toISOString()}}stripHtml(e){try{return e.replace(/<[^>]*>/g,"").trim()}catch(t){return this.logger.warn("Error stripping HTML",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"stripHtml",error:t}),e}}}const ZU=async(r,e,t)=>({operation:od(e).operation,region:await Vi(r.region)()||(()=>{throw new Error("expected `region` to be configured for `aws.auth#sigv4`")})()});function e5(r){return{schemeId:"aws.auth#sigv4",signingProperties:{name:"cognito-identity",region:r.region},propertiesExtractor:(e,t)=>({signingProperties:{config:e,context:t}})}}function yv(r){return{schemeId:"smithy.api#noAuth"}}const t5=r=>{const e=[];switch(r.operation){case"GetCredentialsForIdentity":{e.push(yv());break}case"GetId":{e.push(yv());break}case"GetOpenIdToken":{e.push(yv());break}case"UnlinkIdentity":{e.push(yv());break}default:e.push(e5(r))}return e},r5=r=>{const e=oN(r);return Object.assign(e,{authSchemePreference:Vi(r.authSchemePreference??[])})},n5=r=>Object.assign(r,{useDualstackEndpoint:r.useDualstackEndpoint??!1,useFipsEndpoint:r.useFipsEndpoint??!1,defaultSigningName:"cognito-identity"}),s5="3.981.0",o5={version:s5},iT="required",Os="fn",Ds="argv",dh="ref",iC=!0,aC="isSet",Am="booleanEquals",Pf="error",Ra="endpoint",_l="tree",K_="PartitionResult",Y_="getAttr",Lp="stringEquals",lC={[iT]:!1,type:"string"},cC={[iT]:!0,default:!1,type:"boolean"},uC={[dh]:"Endpoint"},aT={[Os]:Am,[Ds]:[{[dh]:"UseFIPS"},!0]},lT={[Os]:Am,[Ds]:[{[dh]:"UseDualStack"},!0]},Dn={},nm={[dh]:"Region"},dC={[Os]:Y_,[Ds]:[{[dh]:K_},"supportsFIPS"]},cT={[dh]:K_},fC={[Os]:Am,[Ds]:[!0,{[Os]:Y_,[Ds]:[cT,"supportsDualStack"]}]},hC=[aT],pC=[lT],mC=[nm],i5={parameters:{Region:lC,UseDualStack:cC,UseFIPS:cC,Endpoint:lC},rules:[{conditions:[{[Os]:aC,[Ds]:[uC]}],rules:[{conditions:hC,error:"Invalid Configuration: FIPS and custom endpoint are not supported",type:Pf},{conditions:pC,error:"Invalid Configuration: Dualstack and custom endpoint are not supported",type:Pf},{endpoint:{url:uC,properties:Dn,headers:Dn},type:Ra}],type:_l},{conditions:[{[Os]:aC,[Ds]:mC}],rules:[{conditions:[{[Os]:"aws.partition",[Ds]:mC,assign:K_}],rules:[{conditions:[aT,lT],rules:[{conditions:[{[Os]:Am,[Ds]:[iC,dC]},fC],rules:[{conditions:[{[Os]:Lp,[Ds]:[nm,"us-east-1"]}],endpoint:{url:"https://cognito-identity-fips.us-east-1.amazonaws.com",properties:Dn,headers:Dn},type:Ra},{conditions:[{[Os]:Lp,[Ds]:[nm,"us-east-2"]}],endpoint:{url:"https://cognito-identity-fips.us-east-2.amazonaws.com",properties:Dn,headers:Dn},type:Ra},{conditions:[{[Os]:Lp,[Ds]:[nm,"us-west-1"]}],endpoint:{url:"https://cognito-identity-fips.us-west-1.amazonaws.com",properties:Dn,headers:Dn},type:Ra},{conditions:[{[Os]:Lp,[Ds]:[nm,"us-west-2"]}],endpoint:{url:"https://cognito-identity-fips.us-west-2.amazonaws.com",properties:Dn,headers:Dn},type:Ra},{endpoint:{url:"https://cognito-identity-fips.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:Dn,headers:Dn},type:Ra}],type:_l},{error:"FIPS and DualStack are enabled, but this partition does not support one or both",type:Pf}],type:_l},{conditions:hC,rules:[{conditions:[{[Os]:Am,[Ds]:[dC,iC]}],rules:[{endpoint:{url:"https://cognito-identity-fips.{Region}.{PartitionResult#dnsSuffix}",properties:Dn,headers:Dn},type:Ra}],type:_l},{error:"FIPS is enabled but this partition does not support FIPS",type:Pf}],type:_l},{conditions:pC,rules:[{conditions:[fC],rules:[{conditions:[{[Os]:Lp,[Ds]:["aws",{[Os]:Y_,[Ds]:[cT,"name"]}]}],endpoint:{url:"https://cognito-identity.{Region}.amazonaws.com",properties:Dn,headers:Dn},type:Ra},{endpoint:{url:"https://cognito-identity.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:Dn,headers:Dn},type:Ra}],type:_l},{error:"DualStack is enabled but this partition does not support DualStack",type:Pf}],type:_l},{endpoint:{url:"https://cognito-identity.{Region}.{PartitionResult#dnsSuffix}",properties:Dn,headers:Dn},type:Ra}],type:_l}],type:_l},{error:"Invalid Configuration: Missing Region",type:Pf}]},a5=i5,l5=new $1({size:50,params:["Endpoint","Region","UseDualStack","UseFIPS"]}),c5=(r,e={})=>l5.get(r,()=>Y1(a5,{endpointParams:r,logger:e.logger}));nh.aws=Mb;const u5=r=>({apiVersion:"2014-06-30",base64Decoder:(r==null?void 0:r.base64Decoder)??Um,base64Encoder:(r==null?void 0:r.base64Encoder)??_m,disableHostPrefix:(r==null?void 0:r.disableHostPrefix)??!1,endpointProvider:(r==null?void 0:r.endpointProvider)??c5,extensions:(r==null?void 0:r.extensions)??[],httpAuthSchemeProvider:(r==null?void 0:r.httpAuthSchemeProvider)??t5,httpAuthSchemes:(r==null?void 0:r.httpAuthSchemes)??[{schemeId:"aws.auth#sigv4",identityProvider:e=>e.getIdentityProvider("aws.auth#sigv4"),signer:new Q1},{schemeId:"smithy.api#noAuth",identityProvider:e=>e.getIdentityProvider("smithy.api#noAuth")||(async()=>({})),signer:new D1}],logger:(r==null?void 0:r.logger)??new Ob,protocol:(r==null?void 0:r.protocol)??fN,protocolSettings:(r==null?void 0:r.protocolSettings)??{defaultNamespace:"com.amazonaws.cognitoidentity",xmlNamespace:"http://cognito-identity.amazonaws.com/doc/2014-06-30/",version:"2014-06-30",serviceTarget:"AWSCognitoIdentityService"},serviceId:(r==null?void 0:r.serviceId)??"Cognito Identity",urlParser:(r==null?void 0:r.urlParser)??Cm,utf8Decoder:(r==null?void 0:r.utf8Decoder)??ed,utf8Encoder:(r==null?void 0:r.utf8Encoder)??Ly}),d5=r=>{const e=FN(r),t=()=>e().then(cN),n=u5(r);return{...n,...r,runtime:"browser",defaultsMode:e,bodyLengthChecker:(r==null?void 0:r.bodyLengthChecker)??iN,credentialDefaultProvider:(r==null?void 0:r.credentialDefaultProvider)??(s=>()=>Promise.reject(new Error("Credential is missing"))),defaultUserAgentProvider:(r==null?void 0:r.defaultUserAgentProvider)??IN({serviceId:n.serviceId,clientVersion:o5.version}),maxAttempts:(r==null?void 0:r.maxAttempts)??km,region:(r==null?void 0:r.region)??PN("Region is missing"),requestHandler:My.create((r==null?void 0:r.requestHandler)??t),retryMode:(r==null?void 0:r.retryMode)??(async()=>(await t()).retryMode||_N),sha256:(r==null?void 0:r.sha256)??AN,streamCollector:(r==null?void 0:r.streamCollector)??T1,useDualstackEndpoint:(r==null?void 0:r.useDualstackEndpoint)??(()=>Promise.resolve(pN)),useFipsEndpoint:(r==null?void 0:r.useFipsEndpoint)??(()=>Promise.resolve(mN))}},f5=r=>{const e=r.httpAuthSchemes;let t=r.httpAuthSchemeProvider,n=r.credentials;return{setHttpAuthScheme(s){const i=e.findIndex(c=>c.schemeId===s.schemeId);i===-1?e.push(s):e.splice(i,1,s)},httpAuthSchemes(){return e},setHttpAuthSchemeProvider(s){t=s},httpAuthSchemeProvider(){return t},setCredentials(s){n=s},credentials(){return n}}},h5=r=>({httpAuthSchemes:r.httpAuthSchemes(),httpAuthSchemeProvider:r.httpAuthSchemeProvider(),credentials:r.credentials()}),p5=(r,e)=>{const t=Object.assign($N(r),uN(r),w1(r),f5(r));return e.forEach(n=>n.configure(t)),Object.assign(r,UN(t),dN(t),b1(t),h5(t))};class m5 extends aN{constructor(...[t]){const n=d5(t||{});super(n);H(this,"config");this.initConfig=n;const s=n5(n),i=M1(s),c=kN(i),u=vN(c),p=u,m=bN(p),g=r5(m),x=p5(g,(t==null?void 0:t.extensions)||[]);this.config=x,this.middlewareStack.use(I1(this.config)),this.middlewareStack.use(hN(this.config)),this.middlewareStack.use(NN(this.config)),this.middlewareStack.use(yN(this.config)),this.middlewareStack.use(_1(this.config)),this.middlewareStack.use(E1(this.config)),this.middlewareStack.use(S1(this.config)),this.middlewareStack.use(C1(this.config,{httpAuthSchemeParametersProvider:ZU,identityProviderConfigProvider:async b=>new O1({"aws.auth#sigv4":b.credentials})})),this.middlewareStack.use(k1(this.config))}destroy(){super.destroy()}}var uT=(r=>(r.Succeeded="succeeded",r.Failed="failed",r))(uT||{}),Uw=(r=>(r.DialogMessageReceived="dialogMessageReceived",r.DialogEventReceived="dialogEventReceived",r))(Uw||{});class dT{constructor(e){H(this,"logger");this.logger=e}async launchWebAuthFlow(e){return this.logger.warn("launchWebAuthFlow using basic window.open approach in Outlook context",{sourceFile:"src/platforms/outlook/OutlookIdentityProvider.ts",sourceFunction:"launchWebAuthFlow"}),this.initiateOAuth(e.url,"")}async initiateOAuth(e,t){var n;try{const s=window.Office;return(n=s==null?void 0:s.ui)!=null&&n.displayDialogAsync?(this.logger.info("Using Office.ui.displayDialogAsync for OAuth",{sourceFile:"src/platforms/outlook/OutlookIdentityProvider.ts",sourceFunction:"initiateOAuth"}),new Promise((i,c)=>{s.ui.displayDialogAsync(e,{height:60,width:60},u=>{var p;if(u.status===uT.Succeeded){const m=u.value;m.addEventHandler(Uw.DialogMessageReceived,g=>{m.close(),i(g.message||"")}),m.addEventHandler(Uw.DialogEventReceived,g=>{m.close(),g.error===12006?c(new Error("Authentication was cancelled by user")):c(new Error(`Authentication dialog failed with error: ${g.error}`))})}else c(new Error(`Failed to open authentication dialog: ${((p=u.error)==null?void 0:p.message)||"Unknown error"}`))})})):(this.logger.warn("Office.ui not available, using window.open fallback",{sourceFile:"src/platforms/outlook/OutlookIdentityProvider.ts",sourceFunction:"initiateOAuth"}),new Promise((i,c)=>{const u=window.open(e,"_blank","width=500,height=600,scrollbars=yes,resizable=yes");if(!u){c(new Error("Failed to open authentication window. Please check popup blockers."));return}const p=setInterval(()=>{try{if(u.closed){clearInterval(p),c(new Error("Authentication was cancelled by user"));return}try{const m=u.location.href;if(m&&m.includes("access_token=")){clearInterval(p),u.close(),i(m);return}}catch{}}catch{clearInterval(p),u==null||u.close(),c(new Error("Error during authentication process"))}},1e3);setTimeout(()=>{clearInterval(p),u.closed||u.close(),c(new Error("Authentication timeout - please try again"))},3e5)}))}catch(s){throw this.logger.error("Error initiating OAuth",s,{sourceFile:"src/platforms/outlook/OutlookIdentityProvider.ts",sourceFunction:"initiateOAuth"}),s}}}const g5=()=>{const r=window.location.hostname,e=window.location.pathname;return r==="localhost"?{environment:"local",DIALOG_URL:"https://localhost:5174/auth-dialog-pkce.html"}:e.includes("FileServer_Staging")?{environment:"staging",DIALOG_URL:"https://candle-ai.github.io/FileServer_Staging/dist-outlook-addin/src/apps/outlook-addin/auth-dialog-pkce.html"}:e.includes("FileServer_Prod")?{environment:"prod",DIALOG_URL:"https://candle-ai.github.io/FileServer_Prod/dist-outlook-addin/src/apps/outlook-addin/auth-dialog-pkce.html"}:{environment:"dev",DIALOG_URL:"https://candle-ai.github.io/FileServer/dist-outlook-addin/src/apps/outlook-addin/auth-dialog-pkce.html"}};async function v5(){const r=g5();return new Promise((e,t)=>{let n=!1;console.log(`Starting PKCE authentication in ${r.environment} environment with dialog:`,r.DIALOG_URL),Office.context.ui.displayDialogAsync(r.DIALOG_URL,{height:70,width:50,promptBeforeOpen:!1},s=>{if(s.status!==Office.AsyncResultStatus.Succeeded)return console.error("Failed to open auth dialog:",s.error),t(new Error(`Failed to open authentication dialog: ${s.error.message}`));const i=s.value;console.log("Auth dialog opened successfully"),i.addEventHandler(Office.EventType.DialogMessageReceived,c=>{try{if(!n&&"message"in c){let u;if(typeof c.message=="string")u=JSON.parse(c.message);else if(typeof c.message=="object")u=c.message;else{console.log("Unknown message type:",typeof c.message,c.message);return}if(console.log(`Received message from auth dialog (${r.environment}):`,u.type),u.type==="AUTH_SUCCESS"){if(console.log(`Authentication successful in ${r.environment} environment`),n=!0,i.close(),!u.tokens||!u.tokens.access_token){t(new Error("Invalid token response from authentication dialog"));return}const p={access_token:u.tokens.access_token,refresh_token:u.tokens.refresh_token,id_token:u.tokens.id_token,expires_in:u.tokens.expires_in,token_type:u.tokens.token_type,fetched_at:u.tokens.fetched_at};console.log(`Tokens received successfully in ${r.environment} environment`),e(p)}else u.type==="AUTH_ERROR"&&(console.log(`Authentication error in ${r.environment}:`,u.error),n=!0,i.close(),t(new Error(`Authentication failed: ${u.error}`)))}}catch(u){console.error("Error handling dialog message:",u),n||(n=!0,i.close(),t(new Error("Error processing authentication response")))}}),i.addEventHandler(Office.EventType.DialogEventReceived,c=>{if(console.log("Dialog event received:",c),!n&&"error"in c){const u=c.error;u===12006?(console.log("User cancelled authentication"),n=!0,t(new Error("Authentication cancelled by user"))):u===12005?console.log("Dialog navigation occurred (normal during OAuth)"):(console.error("Dialog error:",u),n=!0,t(new Error(`Authentication dialog error: ${u}`)))}}),setTimeout(()=>{n||(console.log(`Authentication timeout in ${r.environment} environment`),n=!0,i.close(),t(new Error("Authentication timeout - please try again")))},300*1e3)})})}const gC="us-east-1";class y5{constructor(e,t){H(this,"logger");H(this,"authListeners",new Set);H(this,"cachedToken",null);H(this,"cognitoClient");H(this,"identityProvider");H(this,"storageProvider");this.logger=e,this.storageProvider=t,this.cognitoClient=new m5({region:gC}),this.identityProvider=new dT(e)}async login(){try{const e=await v5();return this.logger.info("Token received",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"login",token:e}),this.cachedToken=e,await this.saveToken(e),this.notifyAuthListeners(!0),e}catch(e){throw this.logger.error("Login failed",e,{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"login"}),e}}async logout(){this.cachedToken=null,await this.deleteToken(),this.notifyAuthListeners(!1)}async getToken(){if(this.logger.debug("Getting token",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"getToken",hasCachedToken:!!this.cachedToken}),this.cachedToken)return this.logger.debug("Returning cached token",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"getToken"}),this.cachedToken;const e=await this.loadTokenFromStorage();return e?(this.logger.debug("Token loaded from storage, caching it",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"getToken"}),this.cachedToken=e,e):(this.logger.debug("No token found in cache or storage",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"getToken"}),null)}onAuthStateChanged(e){this.authListeners.add(e)}removeAuthStateListener(e){this.authListeners.delete(e)}notifyAuthListeners(e){this.authListeners.forEach(t=>{try{t(e)}catch(n){this.logger.error("Error in auth state callback",n,{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"notifyAuthListeners"})}})}async isAuthenticated(){console.log(" [OutlookAuthProvider] Checking authentication status"),this.logger.info("Checking authentication status",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"isAuthenticated"});const e=await this.getToken();if(!e)return console.log(" [OutlookAuthProvider] No token found"),this.logger.info("No token found - user is not authenticated",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"isAuthenticated"}),!1;const t=this.isTokenValid(e);if(console.log(" [OutlookAuthProvider] Token valid?",t),!t){console.log(" [OutlookAuthProvider] Token is expired or expiring soon, attempting refresh"),this.logger.info("Token is expired or expiring soon, attempting refresh",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"isAuthenticated",tokenExpiry:e.expires_in,fetchedAt:e.fetched_at});try{return console.log(" [OutlookAuthProvider] Calling refreshToken()..."),await this.refreshToken(e),console.log(" [OutlookAuthProvider] Token refreshed successfully!"),this.logger.info("Token refreshed successfully during authentication check",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"isAuthenticated"}),!0}catch(n){return console.error(" [OutlookAuthProvider] Token refresh failed:",n),this.logger.error("Token refresh failed during authentication check",n,{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"isAuthenticated"}),!1}}return this.logger.info("Authentication status checked - token is valid",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"isAuthenticated",hasToken:!!e,isValid:t,tokenExpiry:e.expires_in,fetchedAt:e.fetched_at}),!0}async validateToken(e){const t=await this.getToken();return t?this.isTokenValid(t):!1}isTokenValid(e){if(!e||!e.expires_in)return!1;const t=Math.floor(Date.now()),n=e.fetched_at||0,s=n+e.expires_in*1e3,i=s-t<3e5;return this.logger.debug("Token validation",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"isTokenValid",currentTime:t,fetchedAt:n,expiresIn:e.expires_in,tokenExpiry:s,isExpired:i,timeUntilExpiry:s-t}),!i}async refreshToken(e){console.log(" [OutlookAuthProvider.refreshToken] Starting token refresh using REFRESH_TOKEN_AUTH"),this.logger.info("Refreshing token using refresh_token",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"refreshToken"});try{const t=new zb({region:gC}),n=new B_({ClientId:uh,AuthFlow:"REFRESH_TOKEN_AUTH",AuthParameters:{REFRESH_TOKEN:e.refresh_token}});console.log(" [OutlookAuthProvider.refreshToken] Sending refresh request to AWS Cognito"),this.logger.debug("Sending refresh token request to Cognito",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"refreshToken"});const s=await t.send(n);console.log(" [OutlookAuthProvider.refreshToken] Received response from Cognito");const i=s.AuthenticationResult;if(!i)throw new Error("AuthenticationResult is missing in the response.");const{IdToken:c,AccessToken:u,RefreshToken:p,ExpiresIn:m,TokenType:g}=i;if(!c||!u||!m||!g)throw new Error("Missing required fields in AuthenticationResult.");const x={id_token:c,access_token:u,refresh_token:p||e.refresh_token,expires_in:m,token_type:g,fetched_at:Math.floor(Date.now())};return this.logger.info("Token refreshed successfully",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"refreshToken",newExpiresIn:m}),this.cachedToken=x,await this.saveToken(x),this.notifyAuthListeners(!0),x}catch(t){return this.logger.error("Token refresh failed, falling back to full re-login",t,{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"refreshToken"}),this.login()}}async saveToken(e){await this.storageProvider.setLocalItem("token",e)}async loadTokenFromStorage(){this.logger.debug("Loading token from storage",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"loadTokenFromStorage"});try{const e=await this.storageProvider.getLocalItem("token");if(!e)return this.logger.debug("No token found in storage",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"loadTokenFromStorage"}),null;const t=e;return this.logger.debug("Token successfully loaded from storage",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"loadTokenFromStorage",hasToken:!!t,fetchedAt:t==null?void 0:t.fetched_at,expiresIn:t==null?void 0:t.expires_in}),t}catch(e){return this.logger.warn("Failed to load token from storage",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"loadTokenFromStorage",error:e}),null}}async deleteToken(){await this.storageProvider.removeLocalItem("token")}parseAccessTokenFromOAuthResponse(e){try{let t=e;e.includes("#")&&(t=e.split("#")[1]);const n=new URLSearchParams(t),s=n.get("access_token");if(!s)return this.logger.error("No access_token found in OAuth response",new Error("Missing access token"),{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"parseAccessTokenFromOAuthResponse",responseUrl:e,fragment:t}),null;const i=n.get("error");if(i){const c=n.get("error_description")||"Unknown OAuth error";throw new Error(`OAuth error: ${i} - ${c}`)}return s}catch(t){return this.logger.error("Failed to parse OAuth response",t,{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"parseAccessTokenFromOAuthResponse",responseUrl:e}),null}}}class x5{constructor(e){H(this,"logger");this.logger=e}async sendMessage(e){return this.logger.debug("Sending message in Outlook context",{sourceFile:"src/platforms/outlook/OutlookMessagingProvider.ts",sourceFunction:"sendMessage",message:e}),Promise.resolve(e)}onMessage(e){this.logger.debug("Registering message callback in Outlook context",{sourceFile:"src/platforms/outlook/OutlookMessagingProvider.ts",sourceFunction:"onMessage"})}removeMessageListener(e){this.logger.debug("Removing message listener in Outlook context",{sourceFile:"src/platforms/outlook/OutlookMessagingProvider.ts",sourceFunction:"removeMessageListener"})}async sendOfficeNotification(e){try{typeof Office<"u"&&Office.context&&Office.context.ui&&Office.context.ui.displayDialogAsync(`data:text/html,<html><body><p>${e}</p></body></html>`,{height:20,width:40},t=>{t.status===Office.AsyncResultStatus.Succeeded&&setTimeout(()=>t.value.close(),3e3)})}catch(t){this.logger.error("Error showing Office notification",t,{sourceFile:"src/platforms/outlook/OutlookMessagingProvider.ts",sourceFunction:"sendOfficeNotification"})}}}class w5{constructor(e){H(this,"logger");H(this,"eventListeners",new Map);H(this,"isInitialized",!1);this.logger=e}async initialize(){if(this.isInitialized){this.logger.info("Outlook platform already initialized",{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"initialize"});return}try{this.logger.info("Initializing Outlook platform...",{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"initialize"}),await this.waitForOfficeReady(),this.setupOutlookEventListeners();try{const e=JSON.stringify(ZN);localStorage.setItem("CONFIG_VERIFICATION",e),this.logger.info(`[Debug] Saved CONFIG_VERIFICATION='${e}' to localStorage.`,{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"initialize"})}catch(e){this.logger.warn("[Debug] Could not save CONFIG_VERIFICATION to localStorage.",e,{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"initialize"})}this.isInitialized=!0,this.logger.info("Outlook platform initialized successfully",{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"initialize"})}catch(e){throw this.logger.error("Failed to initialize Outlook platform",e,{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"initialize"}),e}}async cleanup(){try{this.logger.info("Cleaning up Outlook platform...",{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"cleanup"}),this.eventListeners.clear(),this.isInitialized=!1,this.logger.info("Outlook platform cleanup completed",{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"cleanup"})}catch(e){throw this.logger.error("Failed to cleanup Outlook platform",e,{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"cleanup"}),e}}async closeWindow(){this.logger.debug("Window close requested (no-op for Outlook)",{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"closeWindow"})}onPlatformEvent(e,t){this.eventListeners.has(e)||this.eventListeners.set(e,new Set),this.eventListeners.get(e).add(t)}async waitForOfficeReady(){return new Promise(e=>{typeof Office<"u"&&Office.onReady?Office.onReady(()=>{e()}):e()})}setupOutlookEventListeners(){var e;typeof Office<"u"&&Office.context&&(e=Office.context.mailbox)!=null&&e.addHandlerAsync&&Office.context.mailbox.addHandlerAsync(Office.EventType.ItemChanged,this.handleItemChanged.bind(this),t=>{t.status===Office.AsyncResultStatus.Failed&&this.logger.error("Failed to add item changed handler",t.error,{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"setupOutlookEventListeners"})})}handleItemChanged(){this.emitPlatformEvent("itemChanged")}emitPlatformEvent(e,...t){const n=this.eventListeners.get(e);n&&n.forEach(s=>{try{s(...t)}catch(i){this.logger.error(`Error in platform event callback for ${e}`,i,{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"emitPlatformEvent",event:e})}})}}class b5{constructor(e){H(this,"logger");this.logger=e}getResourceURL(e){return this.logger.debug("getResourceURL called in Outlook context",{sourceFile:"src/platforms/outlook/OutlookTabsProvider.ts",sourceFunction:"getResourceURL",path:e}),e.includes("options.html")?Kf:""}async getCurrentTab(){return this.logger.debug("getCurrentTab called in Outlook context",{sourceFile:"src/platforms/outlook/OutlookTabsProvider.ts",sourceFunction:"getCurrentTab"}),{id:1,windowId:1,index:0,url:window.location.href,title:document.title||"Outlook Add-in",active:!0,highlighted:!0,pinned:!1,incognito:!1}}async createTab(e,t){return this.logger.debug("createTab called in Outlook context",{sourceFile:"src/platforms/outlook/OutlookTabsProvider.ts",sourceFunction:"createTab",url:e}),window.open(e,"_blank"),{id:Date.now(),windowId:1,index:0,url:e,title:"New Tab",active:!0,highlighted:!0,pinned:!1,incognito:!1}}async updateTab(e,t){this.logger.debug("updateTab called in Outlook context - this is a no-op",{sourceFile:"src/platforms/outlook/OutlookTabsProvider.ts",sourceFunction:"updateTab"})}async closeTab(e){this.logger.debug("closeTab called in Outlook context - this is a no-op",{sourceFile:"src/platforms/outlook/OutlookTabsProvider.ts",sourceFunction:"closeTab"})}onTabUpdated(e){this.logger.debug("onTabUpdated called in Outlook context - this is a no-op",{sourceFile:"src/platforms/outlook/OutlookTabsProvider.ts",sourceFunction:"onTabUpdated"})}removeTabUpdateListener(e){this.logger.debug("removeTabUpdateListener called in Outlook context - this is a no-op",{sourceFile:"src/platforms/outlook/OutlookTabsProvider.ts",sourceFunction:"removeTabUpdateListener"})}async openURL(e,t="_blank"){this.logger.debug("openURL called in Outlook context",{sourceFile:"src/platforms/outlook/OutlookTabsProvider.ts",sourceFunction:"openURL",url:e,target:t}),window.open(e,t)}async openOptionsPage(){this.logger.debug("openOptionsPage called in Outlook context",{sourceFile:"src/platforms/outlook/OutlookTabsProvider.ts",sourceFunction:"openOptionsPage"});const e=await Lw(this.logger);let t=Kf;e!=null&&e.id_token&&(t+=`?token=${e.id_token}`),window.open(t,"_blank")}}const Ax=32*1024;class _5{constructor(e){H(this,"logger");this.logger=e}truncateHtmlForReplyForm(e){const n=new TextEncoder().encode(e);if(n.length<=Ax)return e;this.logger.warn("HTML content exceeds 32 KB limit for reply form, truncating",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"truncateHtmlForReplyForm",originalSize:n.length,maxSize:Ax});let i=new TextDecoder().decode(n.slice(0,Ax-100));const c=Math.max(i.lastIndexOf("</p>"),i.lastIndexOf("</div>"),i.lastIndexOf("</li>"),i.lastIndexOf("<br>"));return c>i.length/2&&(i=i.substring(0,c+(i.includes("</p>")?4:i.includes("</div>")?6:i.includes("</li>")?5:4))),i+='<p style="color: gray; font-style: italic;">[Content truncated due to size limit]</p>',i}detectItemMode(){var e,t;try{if(!((t=(e=Office==null?void 0:Office.context)==null?void 0:e.mailbox)!=null&&t.item))return"unknown";const n=Office.context.mailbox.item;if(!n.itemId)return this.logger.debug("Detected compose mode (no itemId)",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"detectItemMode"}),"compose";const s=n.to;return s&&typeof s.setAsync=="function"?(this.logger.debug("Detected compose mode (to.setAsync exists)",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"detectItemMode"}),"compose"):(this.logger.debug("Detected read mode",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"detectItemMode"}),"read")}catch(n){return this.logger.warn("Error detecting item mode",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"detectItemMode",error:n}),"unknown"}}async executeScript(e){throw this.logger.warn("Script execution not implemented for Outlook context",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"executeScript"}),new Error("Script execution not available in Outlook context")}async injectScript(e){this.logger.warn("Script injection not applicable in Outlook context",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"injectScript"})}async insertContentIntoComposeBox(e){var t;try{const n=Hv(e);if(typeof Office<"u"&&Office.context&&Office.context.mailbox){const s=this.detectItemMode();this.logger.debug("Inserting content into compose box",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"insertContentIntoComposeBox",mode:s}),s==="compose"?(t=Office.context.mailbox.item)==null||t.body.setSelectedDataAsync(n,{coercionType:Office.CoercionType.Html},i=>{i.status===Office.AsyncResultStatus.Failed?(this.logger.error("Failed to insert content using setSelectedDataAsync, falling back to reply-all",i.error,{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"insertContentIntoComposeBox"}),this.replyAllWithContent(e)):this.logger.info("Successfully inserted content at cursor position",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"insertContentIntoComposeBox"})}):(this.logger.info("In read mode - creating reply-all with content",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"insertContentIntoComposeBox"}),await this.replyAllWithContent(e))}else this.logger.warn("Office.js context not available",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"insertContentIntoComposeBox"})}catch(n){throw this.logger.error("Error inserting content into compose box",n,{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"insertContentIntoComposeBox"}),n}}async replyWithContent(e){try{const t=Hv(e),n=this.truncateHtmlForReplyForm(t);if(typeof Office<"u"&&Office.context&&Office.context.mailbox&&Office.context.mailbox.item){const s=Office.context.mailbox.item;if(typeof s.displayReplyFormAsync=="function")return new Promise((i,c)=>{s.displayReplyFormAsync(n,u=>{u.status===Office.AsyncResultStatus.Succeeded?(this.logger.info("Successfully displayed reply form with content (async)",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyWithContent"}),i()):(this.logger.error("Failed to display reply form (async)",u.error,{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyWithContent"}),c(u.error))})});s.displayReplyForm(n),this.logger.info("Successfully displayed reply form with content",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyWithContent"})}else this.logger.warn("Office.js context not available",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyWithContent"})}catch(t){throw this.logger.error("Error displaying reply form with content",t,{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyWithContent"}),t}}async replyAllWithContent(e){try{const t=Hv(e),n=this.truncateHtmlForReplyForm(t);if(this.logger.debug("Attempting to display reply all form",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyAllWithContent",contentLength:n.length,contentPreview:n.substring(0,200)}),typeof Office<"u"&&Office.context&&Office.context.mailbox&&Office.context.mailbox.item){const s=Office.context.mailbox.item;if(typeof s.displayReplyAllFormAsync=="function")return new Promise((i,c)=>{s.displayReplyAllFormAsync(n,u=>{u.status===Office.AsyncResultStatus.Succeeded?(this.logger.info("Successfully displayed reply all form with content (async)",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyAllWithContent"}),i()):(this.logger.error("Failed to display reply all form (async)",u.error,{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyAllWithContent"}),c(u.error))})});s.displayReplyAllForm(n),this.logger.info("Successfully displayed reply all form with content",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyAllWithContent"})}else this.logger.warn("Office.js context not available",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyAllWithContent"})}catch(t){throw this.logger.error("Error displaying reply all form with content",t,{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyAllWithContent"}),t}}}const vC={ERROR:1,WARN:2,INFO:3,DEBUG:4};class E5{constructor(e){H(this,"context");H(this,"minLevel");this.context=e||"unknown",this.minLevel="INFO"}shouldLog(e){return vC[e]<=vC[this.minLevel]}formatMessage(e,t,n){const s=(n==null?void 0:n.sourceFile)||"unknown",i=n==null?void 0:n.sourceFunction;return`[${e}] [Outlook:${this.context}] [${s}${i?` (${i})`:""}]: ${t}`}async debug(e,t){if(!this.shouldLog("DEBUG"))return;const n=this.formatMessage("DEBUG",e,t),{sourceFile:s,sourceFunction:i,...c}=t||{},u=[n];Object.keys(c).length>0&&u.push(c),console.debug(...u)}async info(e,t){if(!this.shouldLog("INFO"))return;const n=this.formatMessage("INFO",e,t),{sourceFile:s,sourceFunction:i,...c}=t||{},u=[n];Object.keys(c).length>0&&u.push(c),console.info(...u)}async warn(e,t){if(!this.shouldLog("WARN"))return;const n=this.formatMessage("WARN",e,t),{sourceFile:s,sourceFunction:i,...c}=t||{},u=[n];Object.keys(c).length>0&&u.push(c),console.warn(...u)}async error(e,t,n){if(!this.shouldLog("ERROR"))return;const s=this.formatMessage("ERROR",e,n),{sourceFile:i,sourceFunction:c,...u}=n||{},p=[s];t&&p.push(t),Object.keys(u).length>0&&p.push(u),console.error(...p)}setMinLevel(e){this.minLevel=e}getMinLevel(){return this.minLevel}getUnderlyingLogger(){return{context:this.context,minLevel:this.minLevel,writeLog:async(e,t,n,s)=>{switch(e){case"DEBUG":return this.debug(t,n);case"INFO":return this.info(t,n);case"WARN":return this.warn(t,n);case"ERROR":return this.error(t,s,n)}},_triggerCleanupCheck:()=>{},debug:(e,t)=>this.debug(e,t),info:(e,t)=>this.info(e,t),warn:(e,t)=>this.warn(e,t),error:(e,t,n)=>this.error(e,t,n)}}}function S5(){const r=new E5("background"),e=new XU(r);return{storage:e,data:new QU(r),auth:new y5(r,e),messaging:new x5(r),lifecycle:new w5(r),tabs:new b5(r),contentScript:new _5(r),identity:new dT(r),logging:r}}const Ps=class Ps{static async createServices(e){const t=e||Ps.detectPlatform();if(Ps.instance&&Ps.currentPlatform===t)return Ps.instance;let n;if(t==="chrome"){const s=Ps.detectExecutionContext();n=JU(s)}else if(t==="outlook")n=S5();else throw new Error(`Unsupported platform: ${t}`);return await n.lifecycle.initialize(),Ps.instance=n,Ps.currentPlatform=t,n}static detectPlatform(){if(typeof chrome<"u"&&chrome.runtime&&chrome.runtime.id)return"chrome";if(typeof Office<"u"&&Office.context)return"outlook";throw new Error("Unable to detect platform. Neither Chrome nor Office APIs available.")}static detectExecutionContext(){if(typeof chrome<"u"&&chrome.runtime&&chrome.runtime.id){if(typeof document>"u")return"background";try{if(typeof window<"u"&&window.location){const e=window.location.href;return e.includes("options.html")?"options":e.includes("popup.html")?"popup":"content"}}catch{return"content"}return"content"}return"unknown"}static getCurrentPlatform(){return Ps.currentPlatform}static async resetInstance(){Ps.instance&&(await Ps.instance.lifecycle.cleanup(),Ps.instance=null,Ps.currentPlatform=null)}};H(Ps,"instance",null),H(Ps,"currentPlatform",null);let Kn=Ps;const J_=w.createContext({platform:"unassigned",services:null,isLoading:!0,error:null});function C5({children:r}){const[e,t]=w.useState("unassigned"),[n,s]=w.useState(null),[i,c]=w.useState(!0),[u,p]=w.useState(null),m=w.useCallback(async g=>{if(g!=null&&g.lifecycle)try{await g.lifecycle.cleanup()}catch(x){console.error("Error during platform cleanup",x,{sourceFile:"src/platforms/PlatformContext.tsx",sourceFunction:"cleanup"})}},[]);return w.useEffect(()=>{let g=null;async function x(){try{console.info("Initializing platform services...",{sourceFile:"src/platforms/PlatformContext.tsx",sourceFunction:"initializePlatform"});const b=await Kn.createServices();if(g=b,t(Kn.getCurrentPlatform()||"unassigned"),Kn.getCurrentPlatform()==="unassigned")throw new Error("Platform not supported");await b.lifecycle.initialize(),s(b),p(null),console.info("Platform services initialized successfully",{sourceFile:"src/platforms/PlatformContext.tsx",sourceFunction:"initializePlatform"})}catch(b){const E=b instanceof Error?b.message:"Unknown error occurred";console.error("Failed to initialize platform services",b,{sourceFile:"src/platforms/PlatformContext.tsx",sourceFunction:"initializePlatform"}),p(E)}finally{c(!1)}}return x(),()=>{g&&m(g)}},[m]),d.jsx(J_.Provider,{value:{platform:e,services:n,isLoading:i,error:u},children:i?d.jsx("div",{className:"flex items-center justify-center h-full",children:d.jsx("div",{className:"text-sm text-gray-600",children:"Initializing platform..."})}):u?d.jsx("div",{className:"flex items-center justify-center h-full",children:d.jsxs("div",{className:"text-sm text-red-600",children:["Error: ",u]})}):r})}const fT=w.createContext(void 0),Ji=()=>{const r=w.useContext(fT);if(r===void 0)throw console.error("useGmailConnection hook called outside of GmailConnectionProvider"),console.error("Component stack:",new Error().stack),new Error("useGmailConnection must be used within a GmailConnectionProvider. Check that the component using this hook is properly wrapped in the provider hierarchy.");return r},ur="src/lib/utils/cacheUtils.ts",k5=100,N5=1440*60*1e3,T5=100,R5=3600*1e3,A5=100,I5=1440*60*1e3,P5=100,F5=3600*1e3,j5=50,O5=1800*1e3,D5=3600*1e3*24,Ut={EMAIL_SUMMARY:"cache_email_summary_",EMAIL_SUMMARY_INDEX:"cache_email_summary_index",DOCUMENTS:"cache_documents_",DOCUMENTS_INDEX:"cache_documents_index",PROJECT_DOCUMENTS:"cache_project_documents_",PROJECT_DOCUMENTS_INDEX:"cache_project_documents_index",NON_EXISTENT_CLIENT:"cache_non_existent_client_",NON_EXISTENT_CLIENT_INDEX:"cache_non_existent_client_index",CLIENT:"cache_client_",CLIENT_INDEX:"cache_client_index",GENERATED_RESPONSE:"cache_generated_response_",GENERATED_RESPONSE_INDEX:"cache_generated_response_index",FIRM_USERS:"firm_users"},L5=30*1e3,Im=new Map;function M5(r){const e=r.toLowerCase(),t=Im.get(e);return t?Date.now()-t.timestamp>L5?(Im.delete(e),{inCache:!1}):{inCache:!0,errorType:t.errorType}:{inCache:!1}}function yC(r,e){const t=r.toLowerCase();Im.set(t,{timestamp:Date.now(),errorType:e})}function hT(r){const e=r.toLowerCase();Im.delete(e)}function $5(){Im.clear()}async function is(r){try{return(await Kn.createServices()).storage}catch(e){return r.warn("Platform detection failed, storage unavailable",{sourceFile:ur,error:e}),null}}async function Gm(r,e,t,n,s){try{const i=await r.getLocalItem(e)||[];if(i.length>=n){i.sort((u,p)=>u.timestamp-p.timestamp);const c=i.splice(0,i.length-n+1);for(const u of c)await r.removeLocalItem(u.key);await r.setLocalItem(e,i)}}catch(i){s.warn("Error managing cache size",{sourceFile:ur,error:i})}}async function Wm(r,e,t,n,s){try{const i=await r.getLocalItem(e)||[],c=i.findIndex(u=>u.key===t);c!==-1&&i.splice(c,1),i.push({key:t,timestamp:n}),await r.setLocalItem(e,i)}catch(i){s.warn("Error updating cache index",{sourceFile:ur,error:i})}}async function pT(r){await Promise.all([H5(r),B5(r),V5(r),yT(r),Y5(r)])}async function U5(r,e,t,n){try{const s=await is(n);if(!s)return;const i=`${Ut.EMAIL_SUMMARY}${r}`,c=Date.now();await Gm(s,Ut.EMAIL_SUMMARY_INDEX,Ut.EMAIL_SUMMARY,k5,n);const u={summary:e,importantDetails:t,timestamp:c};await s.setLocalItem(i,u),await Wm(s,Ut.EMAIL_SUMMARY_INDEX,i,c,n),n.debug("Added to summary cache",{sourceFile:ur,functionName:"addToSummaryCache",threadId:r})}catch(s){n.warn("Error adding to summary cache",{sourceFile:ur,functionName:"addToSummaryCache",threadId:r,error:s})}}async function z5(r,e){try{const t=await is(e);if(!t)return null;const n=`${Ut.EMAIL_SUMMARY}${r}`,s=await t.getLocalItem(n);return s?Date.now()-s.timestamp>N5?(await t.removeLocalItem(n),null):s:null}catch(t){return e.warn("Error getting from summary cache",{sourceFile:ur,functionName:"getFromSummaryCache",threadId:r,error:t}),null}}async function H5(r){try{const e=await is(r);if(!e)return;const t=await e.getLocalItem(Ut.EMAIL_SUMMARY_INDEX)||[];for(const n of t)await e.removeLocalItem(n.key);await e.removeLocalItem(Ut.EMAIL_SUMMARY_INDEX),r.debug("Summary cache cleared",{sourceFile:ur,functionName:"clearSummaryCache"})}catch(e){r.warn("Error clearing summary cache",{sourceFile:ur,functionName:"clearSummaryCache",error:e})}}async function mT(r,e,t){try{const n=await is(t);if(!n)return;const s=`${Ut.PROJECT_DOCUMENTS}${r}`,i=Date.now();await Gm(n,Ut.PROJECT_DOCUMENTS_INDEX,Ut.PROJECT_DOCUMENTS,T5,t);const c={documents:e,timestamp:i};await n.setLocalItem(s,c),await Wm(n,Ut.PROJECT_DOCUMENTS_INDEX,s,i,t),t.debug("Added to project document cache",{sourceFile:ur,functionName:"addToProjectDocumentCache",projectId:r})}catch(n){t.warn("Error adding to project document cache",{sourceFile:ur,functionName:"addToProjectDocumentCache",projectId:r,error:n})}}async function gT(r,e){try{const t=await is(e);if(!t)return null;e.debug("Getting documents from project document cache",{sourceFile:ur,functionName:"getFromProjectDocumentCache",projectId:r});const n=`${Ut.PROJECT_DOCUMENTS}${r}`,s=await t.getLocalItem(n);return s?Date.now()-s.timestamp>R5?(await t.removeLocalItem(n),null):s.documents:null}catch(t){return e.warn("Error getting from project document cache",{sourceFile:ur,functionName:"getFromProjectDocumentCache",projectId:r,error:t}),null}}async function B5(r){try{const e=await is(r);if(!e)return;const t=await e.getLocalItem(Ut.DOCUMENTS_INDEX)||[];for(const n of t)await e.removeLocalItem(n.key);await e.removeLocalItem(Ut.DOCUMENTS_INDEX),r.debug("Document cache cleared",{sourceFile:ur,functionName:"clearDocumentCache"})}catch(e){r.warn("Error clearing document cache",{sourceFile:ur,functionName:"clearDocumentCache",error:e})}}async function G5(r,e){try{const t=await is(e);if(!t)return;const n=r.toLowerCase(),s=`${Ut.NON_EXISTENT_CLIENT}${n}`,i=Date.now();await Gm(t,Ut.NON_EXISTENT_CLIENT_INDEX,Ut.NON_EXISTENT_CLIENT,A5,e),await t.setLocalItem(s,i),await Wm(t,Ut.NON_EXISTENT_CLIENT_INDEX,s,i,e),e.debug("Added to non-existent client cache",{sourceFile:ur,functionName:"addToNonExistentClientCache",email:n})}catch(t){e.warn("Error adding to non-existent client cache",{sourceFile:ur,functionName:"addToNonExistentClientCache",email:r,error:t})}}async function W5(r,e){try{const t=await is(e);if(!t)return!1;const n=r.toLowerCase(),s=`${Ut.NON_EXISTENT_CLIENT}${n}`,i=await t.getLocalItem(s);return i?Date.now()-i>I5?(await t.removeLocalItem(s),!1):!0:!1}catch(t){return e.warn("Error checking non-existent client cache",{sourceFile:ur,functionName:"isInNonExistentClientCache",email:r,error:t}),!1}}async function V5(r){try{const e=await is(r);if(!e)return;const t=await e.getLocalItem(Ut.NON_EXISTENT_CLIENT_INDEX)||[];for(const n of t)await e.removeLocalItem(n.key);await e.removeLocalItem(Ut.NON_EXISTENT_CLIENT_INDEX),r.debug("Non-existent client cache cleared",{sourceFile:ur,functionName:"clearNonExistentClientCache"})}catch(e){r.warn("Error clearing non-existent client cache",{sourceFile:ur,functionName:"clearNonExistentClientCache",error:e})}}async function q5(r,e,t){try{const n=await is(t);if(!n)return;const s=r.toLowerCase(),i=`${Ut.CLIENT}${s}`,c=Date.now();await Gm(n,Ut.CLIENT_INDEX,Ut.CLIENT,P5,t);const u={data:e,timestamp:c};await n.setLocalItem(i,u),await Wm(n,Ut.CLIENT_INDEX,i,c,t),t.debug("Added to client cache",{sourceFile:ur,functionName:"addToClientCache",clientEmail:s})}catch(n){t.warn("Error adding to client cache",{sourceFile:ur,functionName:"addToClientCache",clientEmail:r,error:n})}}async function vT(r,e){try{const t=await is(e);if(!t)return null;const n=r.toLowerCase();e.debug("Getting client info from client cache",{sourceFile:ur,functionName:"getFromClientCache",clientEmail:n});const s=`${Ut.CLIENT}${n}`,i=await t.getLocalItem(s);return i?Date.now()-i.timestamp>F5?(await t.removeLocalItem(s),null):i.data:null}catch(t){return e.warn("Error getting from client cache",{sourceFile:ur,functionName:"getFromClientCache",clientEmail:r,error:t}),null}}async function yT(r){try{const e=await is(r);if(!e)return;const t=await e.getLocalItem(Ut.CLIENT_INDEX)||[];for(const n of t)await e.removeLocalItem(n.key);await e.removeLocalItem(Ut.CLIENT_INDEX),r.debug("Client cache cleared",{sourceFile:ur,functionName:"clearClientCache"})}catch(e){r.warn("Error clearing client cache",{sourceFile:ur,functionName:"clearClientCache",error:e})}}async function Bv(r,e){try{const t=await is(e);if(!t)return;const n=r.toLowerCase();hT(n);const s=`${Ut.CLIENT}${n}`;await t.removeLocalItem(s);const i=await t.getLocalItem(Ut.CLIENT_INDEX)||[],c=i.filter(E=>E.key!==s);c.length!==i.length&&await t.setLocalItem(Ut.CLIENT_INDEX,c);const u=`${Ut.NON_EXISTENT_CLIENT}${n}`;await t.removeLocalItem(u);const p=await t.getLocalItem(Ut.NON_EXISTENT_CLIENT_INDEX)||[],m=p.filter(E=>E.key!==u);m.length!==p.length&&await t.setLocalItem(Ut.NON_EXISTENT_CLIENT_INDEX,m);const g=`${Ut.DOCUMENTS}${n}`;await t.removeLocalItem(g);const x=await t.getLocalItem(Ut.DOCUMENTS_INDEX)||[],b=x.filter(E=>E.key!==g);b.length!==x.length&&await t.setLocalItem(Ut.DOCUMENTS_INDEX,b),e.debug("Cleared all cached data for client email",{sourceFile:ur,functionName:"clearClientDataForEmail",clientEmail:n})}catch(t){e.warn("Error clearing client data for email",{sourceFile:ur,functionName:"clearClientDataForEmail",clientEmail:r,error:t})}}async function xC(r,e,t,n,s){try{const i=await is(s);if(!i)return;const c=`${Ut.GENERATED_RESPONSE}${r}`,u=Date.now();await Gm(i,Ut.GENERATED_RESPONSE_INDEX,Ut.GENERATED_RESPONSE,j5,s);const p={response:e,references:t,cmsData:n,timestamp:u};await i.setLocalItem(c,p),await Wm(i,Ut.GENERATED_RESPONSE_INDEX,c,u,s),s.debug("Added to generated response cache",{sourceFile:ur,functionName:"addToGeneratedResponseCache",cacheKey:r})}catch(i){s.warn("Error adding to generated response cache",{sourceFile:ur,functionName:"addToGeneratedResponseCache",cacheKey:r,error:i})}}async function K5(r,e){try{const t=await is(e);if(!t)return null;e.debug("Getting generated response from cache",{sourceFile:ur,functionName:"getFromGeneratedResponseCache",cacheKey:r});const n=`${Ut.GENERATED_RESPONSE}${r}`,s=await t.getLocalItem(n);return s?Date.now()-s.timestamp>O5?(await t.removeLocalItem(n),null):s:null}catch(t){return e.warn("Error getting from generated response cache",{sourceFile:ur,functionName:"getFromGeneratedResponseCache",cacheKey:r,error:t}),null}}async function xT(r,e){try{const t=await is(e);if(!t)return;const n={users:r,timestamp:Date.now()};await t.setLocalItem(Ut.FIRM_USERS,n),e.debug("Added to firm users cache",{sourceFile:ur,functionName:"addToFirmUsersCache",count:r.length})}catch(t){e.warn("Error adding to firm users cache",{sourceFile:ur,functionName:"addToFirmUsersCache",error:t})}}async function wT(r){try{const e=await is(r);if(!e)return null;const t=await e.getLocalItem(Ut.FIRM_USERS);return t?Date.now()-t.timestamp>D5?(await e.removeLocalItem(Ut.FIRM_USERS),null):t.users:null}catch(e){return r.warn("Error getting from firm users cache",{sourceFile:ur,functionName:"getFromFirmUsersCache",error:e}),null}}async function Y5(r){try{const e=await is(r);if(!e)return;const t=await e.getLocalItem(Ut.GENERATED_RESPONSE_INDEX)||[];for(const n of t)await e.removeLocalItem(n.key);await e.removeLocalItem(Ut.GENERATED_RESPONSE_INDEX),r.debug("Generated response cache cleared",{sourceFile:ur,functionName:"clearGeneratedResponseCache"})}catch(e){r.warn("Error clearing generated response cache",{sourceFile:ur,functionName:"clearGeneratedResponseCache",error:e})}}function bT(r){var e,t,n="";if(typeof r=="string"||typeof r=="number")n+=r;else if(typeof r=="object")if(Array.isArray(r)){var s=r.length;for(e=0;e<s;e++)r[e]&&(t=bT(r[e]))&&(n&&(n+=" "),n+=t)}else for(t in r)r[t]&&(n&&(n+=" "),n+=t);return n}function _T(){for(var r,e,t=0,n="",s=arguments.length;t<s;t++)(r=arguments[t])&&(e=bT(r))&&(n&&(n+=" "),n+=e);return n}const X_="-",J5=r=>{const e=Q5(r),{conflictingClassGroups:t,conflictingClassGroupModifiers:n}=r;return{getClassGroupId:c=>{const u=c.split(X_);return u[0]===""&&u.length!==1&&u.shift(),ET(u,e)||X5(c)},getConflictingClassGroupIds:(c,u)=>{const p=t[c]||[];return u&&n[c]?[...p,...n[c]]:p}}},ET=(r,e)=>{var c;if(r.length===0)return e.classGroupId;const t=r[0],n=e.nextPart.get(t),s=n?ET(r.slice(1),n):void 0;if(s)return s;if(e.validators.length===0)return;const i=r.join(X_);return(c=e.validators.find(({validator:u})=>u(i)))==null?void 0:c.classGroupId},wC=/^\[(.+)\]$/,X5=r=>{if(wC.test(r)){const e=wC.exec(r)[1],t=e==null?void 0:e.substring(0,e.indexOf(":"));if(t)return"arbitrary.."+t}},Q5=r=>{const{theme:e,prefix:t}=r,n={nextPart:new Map,validators:[]};return e6(Object.entries(r.classGroups),t).forEach(([i,c])=>{zw(c,n,i,e)}),n},zw=(r,e,t,n)=>{r.forEach(s=>{if(typeof s=="string"){const i=s===""?e:bC(e,s);i.classGroupId=t;return}if(typeof s=="function"){if(Z5(s)){zw(s(n),e,t,n);return}e.validators.push({validator:s,classGroupId:t});return}Object.entries(s).forEach(([i,c])=>{zw(c,bC(e,i),t,n)})})},bC=(r,e)=>{let t=r;return e.split(X_).forEach(n=>{t.nextPart.has(n)||t.nextPart.set(n,{nextPart:new Map,validators:[]}),t=t.nextPart.get(n)}),t},Z5=r=>r.isThemeGetter,e6=(r,e)=>e?r.map(([t,n])=>{const s=n.map(i=>typeof i=="string"?e+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([c,u])=>[e+c,u])):i);return[t,s]}):r,t6=r=>{if(r<1)return{get:()=>{},set:()=>{}};let e=0,t=new Map,n=new Map;const s=(i,c)=>{t.set(i,c),e++,e>r&&(e=0,n=t,t=new Map)};return{get(i){let c=t.get(i);if(c!==void 0)return c;if((c=n.get(i))!==void 0)return s(i,c),c},set(i,c){t.has(i)?t.set(i,c):s(i,c)}}},ST="!",r6=r=>{const{separator:e,experimentalParseClassName:t}=r,n=e.length===1,s=e[0],i=e.length,c=u=>{const p=[];let m=0,g=0,x;for(let N=0;N<u.length;N++){let R=u[N];if(m===0){if(R===s&&(n||u.slice(N,N+i)===e)){p.push(u.slice(g,N)),g=N+i;continue}if(R==="/"){x=N;continue}}R==="["?m++:R==="]"&&m--}const b=p.length===0?u:u.substring(g),E=b.startsWith(ST),T=E?b.substring(1):b,S=x&&x>g?x-g:void 0;return{modifiers:p,hasImportantModifier:E,baseClassName:T,maybePostfixModifierPosition:S}};return t?u=>t({className:u,parseClassName:c}):c},n6=r=>{if(r.length<=1)return r;const e=[];let t=[];return r.forEach(n=>{n[0]==="["?(e.push(...t.sort(),n),t=[]):t.push(n)}),e.push(...t.sort()),e},s6=r=>({cache:t6(r.cacheSize),parseClassName:r6(r),...J5(r)}),o6=/\s+/,i6=(r,e)=>{const{parseClassName:t,getClassGroupId:n,getConflictingClassGroupIds:s}=e,i=[],c=r.trim().split(o6);let u="";for(let p=c.length-1;p>=0;p-=1){const m=c[p],{modifiers:g,hasImportantModifier:x,baseClassName:b,maybePostfixModifierPosition:E}=t(m);let T=!!E,S=n(T?b.substring(0,E):b);if(!S){if(!T){u=m+(u.length>0?" "+u:u);continue}if(S=n(b),!S){u=m+(u.length>0?" "+u:u);continue}T=!1}const N=n6(g).join(":"),R=x?N+ST:N,A=R+S;if(i.includes(A))continue;i.push(A);const j=s(S,T);for(let P=0;P<j.length;++P){const M=j[P];i.push(R+M)}u=m+(u.length>0?" "+u:u)}return u};function a6(){let r=0,e,t,n="";for(;r<arguments.length;)(e=arguments[r++])&&(t=CT(e))&&(n&&(n+=" "),n+=t);return n}const CT=r=>{if(typeof r=="string")return r;let e,t="";for(let n=0;n<r.length;n++)r[n]&&(e=CT(r[n]))&&(t&&(t+=" "),t+=e);return t};function l6(r,...e){let t,n,s,i=c;function c(p){const m=e.reduce((g,x)=>x(g),r());return t=s6(m),n=t.cache.get,s=t.cache.set,i=u,u(p)}function u(p){const m=n(p);if(m)return m;const g=i6(p,t);return s(p,g),g}return function(){return i(a6.apply(null,arguments))}}const en=r=>{const e=t=>t[r]||[];return e.isThemeGetter=!0,e},kT=/^\[(?:([a-z-]+):)?(.+)\]$/i,c6=/^\d+\/\d+$/,u6=new Set(["px","full","screen"]),d6=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,f6=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,h6=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,p6=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,m6=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,El=r=>Yf(r)||u6.has(r)||c6.test(r),Nc=r=>fh(r,"length",E6),Yf=r=>!!r&&!Number.isNaN(Number(r)),Ix=r=>fh(r,"number",Yf),Mp=r=>!!r&&Number.isInteger(Number(r)),g6=r=>r.endsWith("%")&&Yf(r.slice(0,-1)),Jt=r=>kT.test(r),Tc=r=>d6.test(r),v6=new Set(["length","size","percentage"]),y6=r=>fh(r,v6,NT),x6=r=>fh(r,"position",NT),w6=new Set(["image","url"]),b6=r=>fh(r,w6,C6),_6=r=>fh(r,"",S6),$p=()=>!0,fh=(r,e,t)=>{const n=kT.exec(r);return n?n[1]?typeof e=="string"?n[1]===e:e.has(n[1]):t(n[2]):!1},E6=r=>f6.test(r)&&!h6.test(r),NT=()=>!1,S6=r=>p6.test(r),C6=r=>m6.test(r),k6=()=>{const r=en("colors"),e=en("spacing"),t=en("blur"),n=en("brightness"),s=en("borderColor"),i=en("borderRadius"),c=en("borderSpacing"),u=en("borderWidth"),p=en("contrast"),m=en("grayscale"),g=en("hueRotate"),x=en("invert"),b=en("gap"),E=en("gradientColorStops"),T=en("gradientColorStopPositions"),S=en("inset"),N=en("margin"),R=en("opacity"),A=en("padding"),j=en("saturate"),P=en("scale"),M=en("sepia"),B=en("skew"),U=en("space"),V=en("translate"),Y=()=>["auto","contain","none"],ce=()=>["auto","hidden","clip","visible","scroll"],X=()=>["auto",Jt,e],de=()=>[Jt,e],we=()=>["",El,Nc],le=()=>["auto",Yf,Jt],se=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],me=()=>["solid","dashed","dotted","double","none"],te=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],G=()=>["start","end","center","between","around","evenly","stretch"],z=()=>["","0",Jt],J=()=>["auto","avoid","all","avoid-page","page","left","right","column"],D=()=>[Yf,Jt];return{cacheSize:500,separator:":",theme:{colors:[$p],spacing:[El,Nc],blur:["none","",Tc,Jt],brightness:D(),borderColor:[r],borderRadius:["none","","full",Tc,Jt],borderSpacing:de(),borderWidth:we(),contrast:D(),grayscale:z(),hueRotate:D(),invert:z(),gap:de(),gradientColorStops:[r],gradientColorStopPositions:[g6,Nc],inset:X(),margin:X(),opacity:D(),padding:de(),saturate:D(),scale:D(),sepia:z(),skew:D(),space:de(),translate:de()},classGroups:{aspect:[{aspect:["auto","square","video",Jt]}],container:["container"],columns:[{columns:[Tc]}],"break-after":[{"break-after":J()}],"break-before":[{"break-before":J()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...se(),Jt]}],overflow:[{overflow:ce()}],"overflow-x":[{"overflow-x":ce()}],"overflow-y":[{"overflow-y":ce()}],overscroll:[{overscroll:Y()}],"overscroll-x":[{"overscroll-x":Y()}],"overscroll-y":[{"overscroll-y":Y()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[S]}],"inset-x":[{"inset-x":[S]}],"inset-y":[{"inset-y":[S]}],start:[{start:[S]}],end:[{end:[S]}],top:[{top:[S]}],right:[{right:[S]}],bottom:[{bottom:[S]}],left:[{left:[S]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Mp,Jt]}],basis:[{basis:X()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Jt]}],grow:[{grow:z()}],shrink:[{shrink:z()}],order:[{order:["first","last","none",Mp,Jt]}],"grid-cols":[{"grid-cols":[$p]}],"col-start-end":[{col:["auto",{span:["full",Mp,Jt]},Jt]}],"col-start":[{"col-start":le()}],"col-end":[{"col-end":le()}],"grid-rows":[{"grid-rows":[$p]}],"row-start-end":[{row:["auto",{span:[Mp,Jt]},Jt]}],"row-start":[{"row-start":le()}],"row-end":[{"row-end":le()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Jt]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Jt]}],gap:[{gap:[b]}],"gap-x":[{"gap-x":[b]}],"gap-y":[{"gap-y":[b]}],"justify-content":[{justify:["normal",...G()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...G(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...G(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[A]}],px:[{px:[A]}],py:[{py:[A]}],ps:[{ps:[A]}],pe:[{pe:[A]}],pt:[{pt:[A]}],pr:[{pr:[A]}],pb:[{pb:[A]}],pl:[{pl:[A]}],m:[{m:[N]}],mx:[{mx:[N]}],my:[{my:[N]}],ms:[{ms:[N]}],me:[{me:[N]}],mt:[{mt:[N]}],mr:[{mr:[N]}],mb:[{mb:[N]}],ml:[{ml:[N]}],"space-x":[{"space-x":[U]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[U]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Jt,e]}],"min-w":[{"min-w":[Jt,e,"min","max","fit"]}],"max-w":[{"max-w":[Jt,e,"none","full","min","max","fit","prose",{screen:[Tc]},Tc]}],h:[{h:[Jt,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Jt,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Jt,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Jt,e,"auto","min","max","fit"]}],"font-size":[{text:["base",Tc,Nc]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Ix]}],"font-family":[{font:[$p]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Jt]}],"line-clamp":[{"line-clamp":["none",Yf,Ix]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",El,Jt]}],"list-image":[{"list-image":["none",Jt]}],"list-style-type":[{list:["none","disc","decimal",Jt]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[r]}],"placeholder-opacity":[{"placeholder-opacity":[R]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[r]}],"text-opacity":[{"text-opacity":[R]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...me(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",El,Nc]}],"underline-offset":[{"underline-offset":["auto",El,Jt]}],"text-decoration-color":[{decoration:[r]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:de()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Jt]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Jt]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[R]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...se(),x6]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",y6]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},b6]}],"bg-color":[{bg:[r]}],"gradient-from-pos":[{from:[T]}],"gradient-via-pos":[{via:[T]}],"gradient-to-pos":[{to:[T]}],"gradient-from":[{from:[E]}],"gradient-via":[{via:[E]}],"gradient-to":[{to:[E]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[u]}],"border-w-x":[{"border-x":[u]}],"border-w-y":[{"border-y":[u]}],"border-w-s":[{"border-s":[u]}],"border-w-e":[{"border-e":[u]}],"border-w-t":[{"border-t":[u]}],"border-w-r":[{"border-r":[u]}],"border-w-b":[{"border-b":[u]}],"border-w-l":[{"border-l":[u]}],"border-opacity":[{"border-opacity":[R]}],"border-style":[{border:[...me(),"hidden"]}],"divide-x":[{"divide-x":[u]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[u]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[R]}],"divide-style":[{divide:me()}],"border-color":[{border:[s]}],"border-color-x":[{"border-x":[s]}],"border-color-y":[{"border-y":[s]}],"border-color-s":[{"border-s":[s]}],"border-color-e":[{"border-e":[s]}],"border-color-t":[{"border-t":[s]}],"border-color-r":[{"border-r":[s]}],"border-color-b":[{"border-b":[s]}],"border-color-l":[{"border-l":[s]}],"divide-color":[{divide:[s]}],"outline-style":[{outline:["",...me()]}],"outline-offset":[{"outline-offset":[El,Jt]}],"outline-w":[{outline:[El,Nc]}],"outline-color":[{outline:[r]}],"ring-w":[{ring:we()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[r]}],"ring-opacity":[{"ring-opacity":[R]}],"ring-offset-w":[{"ring-offset":[El,Nc]}],"ring-offset-color":[{"ring-offset":[r]}],shadow:[{shadow:["","inner","none",Tc,_6]}],"shadow-color":[{shadow:[$p]}],opacity:[{opacity:[R]}],"mix-blend":[{"mix-blend":[...te(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":te()}],filter:[{filter:["","none"]}],blur:[{blur:[t]}],brightness:[{brightness:[n]}],contrast:[{contrast:[p]}],"drop-shadow":[{"drop-shadow":["","none",Tc,Jt]}],grayscale:[{grayscale:[m]}],"hue-rotate":[{"hue-rotate":[g]}],invert:[{invert:[x]}],saturate:[{saturate:[j]}],sepia:[{sepia:[M]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[t]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[p]}],"backdrop-grayscale":[{"backdrop-grayscale":[m]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[g]}],"backdrop-invert":[{"backdrop-invert":[x]}],"backdrop-opacity":[{"backdrop-opacity":[R]}],"backdrop-saturate":[{"backdrop-saturate":[j]}],"backdrop-sepia":[{"backdrop-sepia":[M]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[c]}],"border-spacing-x":[{"border-spacing-x":[c]}],"border-spacing-y":[{"border-spacing-y":[c]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Jt]}],duration:[{duration:D()}],ease:[{ease:["linear","in","out","in-out",Jt]}],delay:[{delay:D()}],animate:[{animate:["none","spin","ping","pulse","bounce",Jt]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[P]}],"scale-x":[{"scale-x":[P]}],"scale-y":[{"scale-y":[P]}],rotate:[{rotate:[Mp,Jt]}],"translate-x":[{"translate-x":[V]}],"translate-y":[{"translate-y":[V]}],"skew-x":[{"skew-x":[B]}],"skew-y":[{"skew-y":[B]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Jt]}],accent:[{accent:["auto",r]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Jt]}],"caret-color":[{caret:[r]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":de()}],"scroll-mx":[{"scroll-mx":de()}],"scroll-my":[{"scroll-my":de()}],"scroll-ms":[{"scroll-ms":de()}],"scroll-me":[{"scroll-me":de()}],"scroll-mt":[{"scroll-mt":de()}],"scroll-mr":[{"scroll-mr":de()}],"scroll-mb":[{"scroll-mb":de()}],"scroll-ml":[{"scroll-ml":de()}],"scroll-p":[{"scroll-p":de()}],"scroll-px":[{"scroll-px":de()}],"scroll-py":[{"scroll-py":de()}],"scroll-ps":[{"scroll-ps":de()}],"scroll-pe":[{"scroll-pe":de()}],"scroll-pt":[{"scroll-pt":de()}],"scroll-pr":[{"scroll-pr":de()}],"scroll-pb":[{"scroll-pb":de()}],"scroll-pl":[{"scroll-pl":de()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Jt]}],fill:[{fill:[r,"none"]}],"stroke-w":[{stroke:[El,Nc,Ix]}],stroke:[{stroke:[r,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},N6=l6(k6);function Rr(...r){return N6(_T(r))}async function Px(r){let e;if(r instanceof File)e=await r.arrayBuffer();else if(r instanceof ArrayBuffer)e=r;else if(r instanceof Uint8Array)e=r.buffer;else throw new Error("Unsupported data type for checksum calculation");const t=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(t)).map(i=>i.toString(16).padStart(2,"0")).join("")}const kr="src/lib/utils/serverUtils.tsx",Fx=new Map,Ff=3,_C=1e3;function EC(r){if(r instanceof Error){const e=r.message.toLowerCase();return e.includes("timeout")||e.includes("network")||e.includes("failed to fetch")||e.includes("504")||e.includes("503")}return!1}function Hy(r){const e=["x-trace-id","x-request-id","x-correlation-id","x-amzn-request-id","x-amzn-requestid","x-amzn-trace-id","request-id","trace-id","correlation-id"];for(const t of e){const n=r.headers.get(t);if(n)return n}return null}new URL(Nr+"/email-template");const T6=new URL(Nr+"/email-templates"),R6=new URL(Nr+"/email/generate"),A6=new URL(Nr+"/email/generate_for_outlook"),I6=new URL(Nr+"/email/reformat"),P6=new URL(Nr+"/email/participants"),F6=new URL(Nr+"/email/participants_with_category");new URL(Nr+"/email/register");new URL(Nr+"/email/unregister");const j6=new URL(Nr+"/email/get_registration"),O6=new URL(Nr+"/email/summarization"),D6=new URL(Nr+"/email/description_summarization"),L6=new URL(Nr+"/email/summarization_for_outlook");new URL(Nr+"/integration");const M6=new URL(Nr+"/integrations"),$6=new URL(Nr+"/integrations/client"),U6=new URL(Nr+"/integrations/document"),z6=new URL(Nr+"/integrations/clients"),H6=new URL(Nr+"/integrations/project_documents"),B6=new URL(Nr+"/integrations/case_summary");new URL(Nr+"/integrations/uscis/case");const G6=new URL(Nr+"/integrations/user"),TT=new URL(Nr+"/integrations/users"),Vm=new URL(Nr+"/integrations/write"),W6=new URL(Nr+"/integrations/projects"),V6=new URL(Nr+"/integrations/project");new URL(Nr+"/integrations/contacts");const q6=new URL(Nr+"/integrations/settings"),K6=new URL(Nr+"/email/generate_task_description");new URL(Nr+"/admin/users");new URL(Nr+"/admin/user");const Y6="CANDLE_ERROR_TOKEN_NOT_FOUND",J6="CANDLE_ERROR_TOKEN_REFRESH_FAILED";function Kc(r,e){const t={sourceFile:kr};e.status===404?e.json().then(n=>{(n.error_code===Y6||n.error_code===J6)&&(r.warn("404 error, Gmail might be disconnected from server, checking...",{...t,data:n}),By(r).then(s=>{s||r.error("Gmail has been disconnected from server unexpectedly!",new Error("Gmail has been disconnected from server, syncing..."),{...t,data:n})}))}):r.warn("HTTP error! status: "+e.status,{...t,data:e})}async function X6(r){const e={sourceFile:kr};r.debug("Starting to fetch response...",e);const t=await $r(T6,{method:"GET",headers:{"Content-Type":"application/json"}},r);if(r.debug("Response received:",{...e,data:t}),!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const n=t.headers.get("content-type");if(r.debug("Content-Type:",{...e,data:n}),n&&n.includes("application/json")){r.debug("Content-Type is JSON, parsing...",e);const s=await t.json();r.debug("Parsed JSON response:",{...e,data:s}),s.user_templates&&s.user_templates.length>0&&r.debug("First user template tags:",{...e,data:s.user_templates[0].tags}),s.org_templates&&s.org_templates.length>0&&r.debug("First org template tags:",{...e,data:s.org_templates[0].tags});const i=s.user_templates.map(u=>({...u,source:"SCOPE_USER"})),c=s.org_templates.map(u=>({...u,source:"SCOPE_TENANT"}));return r.debug("Enhanced user templates with source:",{...e,data:i}),r.debug("Enhanced org templates with source:",{...e,data:c}),{user_templates:i,org_templates:c}}else{r.debug("Content-Type is not JSON, handling as text...",e);const s=await t.text();throw r.error("Received non-JSON response:",s,e),new Error("Received non-JSON response from server")}}async function Q6(r,e,t,n,s,i=[],c,u=!1){const p={sourceFile:kr};c.debug("Starting to fetch response...",p),u?c.info("Force refresh flag is TRUE - will bypass backend cache",{...p,forceRefresh:!0}):c.debug("Force refresh flag is FALSE - will use cache-first",{...p,forceRefresh:!1});const m=[{role:"user",content:"Here's some additional relevant context to help with your response:"+t},{role:"user",content:"This is the specific email in the thread to respond to:"+e}],g={WEB_SOURCES:{PUBLIC:i}};try{const x=await $r(R6,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email_thread_id:r,datasources:g,format_instruction:s+" "+n,additional_context:m,force_refresh:u})},c);if(c.debug("Response received:",{...p,data:x}),!x.ok)throw Kc(c,x),new Error(`HTTP error! status: ${x.status}`);const b=x.headers.get("content-type");c.debug("Content-Type:",{...p,data:b});let E;if(b&&b.includes("application/json"))c.debug("Content-Type is JSON, parsing...",p),E=await x.json();else{c.debug("Content-Type is not JSON, handling as text...",p);const M=await x.text();throw c.error("Received non-JSON response:",M,p),new Error("Received non-JSON response from server")}c.info("Parsed JSON response:",{...p,data:E});const T=E.response,S=E.references,N=E.cms_fields_used,R=E.cms_data;c.info("Result response:",{...p,data:T}),c.info("Result references:",{...p,data:S});const P=new DOMParser().parseFromString(T,"text/html").body.innerHTML;return c.debug("Extracted HTML body content:",{...p,data:P}),{response:P,references:S,cms_fields_used:N,cms_data:R}}catch(x){return c.error("Error caught:",x,p),{response:"error",references:[],cms_fields_used:[],cms_data:[]}}}async function Z6(r,e,t,n,s,i,c,u=!1){const p={sourceFile:kr};c.debug("Starting to fetch response for Outlook...",p),u?c.info("Force refresh flag is TRUE - will bypass backend cache",{...p,forceRefresh:!0}):c.debug("Force refresh flag is FALSE - will use cache-first",{...p,forceRefresh:!1});const m=[{role:"user",content:"Here's some additional relevant context to help with your response:"+t}];try{const g=await $r(A6,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({thread_id:r,full_thread:e,email_participants:i,format_instruction:s+" "+n,additional_context:m,force_refresh:u})},c);if(c.debug("Response received:",{...p,data:g}),!g.ok)throw new Error(`HTTP error! status: ${g.status}`);const x=g.headers.get("content-type");c.debug("Content-Type:",{...p,data:x});let b;if(x&&x.includes("application/json"))c.debug("Content-Type is JSON, parsing...",p),b=await g.json();else{c.debug("Content-Type is not JSON, handling as text...",p);const P=await g.text();throw c.error("Received non-JSON response:",P,p),new Error("Received non-JSON response from server")}c.info("Parsed JSON response:",{...p,data:b});const E=b.response,T=b.references,S=b.cms_fields_used,N=b.cms_data;c.debug("Result response:",{...p,data:E}),c.debug("Result references:",{...p,data:T});const j=new DOMParser().parseFromString(E,"text/html").body.innerHTML;return c.debug("Extracted HTML body content:",{...p,data:j}),{response:j,references:T,cms_fields_used:S,cms_data:N}}catch(g){return c.error("Error caught:",g,p),{response:"error",references:[],cms_fields_used:[],cms_data:[]}}}async function e8(r,e,t){const n={sourceFile:kr};t.debug("Starting to fetch response...",n);const s=await $r(I6,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({reformat_instruction:e,chat_history:[{content:"Here's the HTML Content. Respond with only the HTML content for the revised email response:"+r}]})},t);if(t.debug("Response received:",{...n,data:s}),!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const i=s.headers.get("content-type");if(t.debug("Content-Type:",{...n,data:i}),i&&i.includes("application/json")){t.debug("Content-Type is JSON, parsing...",n);const c=await s.json();t.debug("Parsed JSON response:",{...n,data:c});const u=c.replace(/^```html\s*/,"");t.debug("Cleaned data:",{...n,data:u});const g=new DOMParser().parseFromString(u,"text/html").body.innerHTML;return t.debug("Extracted HTML body content:",{...n,data:g}),g}else{t.debug("Content-Type is not JSON, handling as text...",n);const c=await s.text();throw t.error("Received non-JSON response:",c,n),new Error("Received non-JSON response from server")}}async function Gc(r,e){const t={sourceFile:kr};e.debug("Starting to list integrations...",t);const n=new URL(M6);n.searchParams.append("integration_scope",r);try{const s=await $r(n,{method:"GET",headers:{"Content-Type":"application/json"}},e);if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const i=s.headers.get("content-type");if(i&&i.includes("application/json")){const c=await s.json();e.debug("Integrations:",{...t,data:c.integrations});const u=c.integrations.map(p=>({integration_type:p.integration_type,tenantId_userId:p.tenantId_userId,scope:r}));return await Hm(e,u),u||[]}else throw new Error("Received non-JSON response from server")}catch(s){throw e.error("Error listing integrations:",s,t),s}}async function By(r){const e={sourceFile:kr};r.debug("Starting to check if Gmail integration is connected...",e);try{const t=await $r(j6,{method:"GET",headers:{"Content-Type":"application/json"}},r);r.debug("Response received:",{...e,data:t});let n=!1;if(t.ok){const s=await t.json();r.debug("Parsed JSON response:",{...e,data:s}),n=s.is_registered===!0}return await PU(r,n),n}catch(t){r.error("Error checking Gmail connection status:",t,e);try{const n=await FU(r);if(n.isConnected!==null)return r.debug("Returning cached Gmail connection status due to error",{...e,cachedStatus:n.isConnected,cachedTimestamp:n.timestamp}),n.isConnected}catch(n){r.error("Error retrieving cached Gmail connection status:",n,e)}return!1}}async function t8(r,e){const t={sourceFile:kr};try{const n=await $r(O6,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email_thread_id:r})},e);if(e.debug("Response received:",{...t,data:n}),!n.ok)throw Kc(e,n),new Error(`HTTP error! status: ${n.status}`);const s=n.headers.get("content-type");if(s&&s.includes("application/json")){const i=await n.json();if(!i||!i.message)throw new Error("Summary not found in response");let c=null;if(i.message.important_details)try{typeof i.message.important_details=="object"?(e.debug("Important details is already an object, using it directly...",t),c=i.message.important_details):typeof i.message.important_details=="string"&&(e.debug("Important details is a JSON string, parsing...",t),c=JSON.parse(i.message.important_details)),e.debug("Parsed important details:",{...t,data:c})}catch(u){e.error("Error parsing important details:",u,t),c=null}return{summary:i.message.summary,importantDetails:c,topicsDiscussed:i.message.topics_discussed,actionItems:i.message.action_items}}else throw new Error("Received non-JSON response from server")}catch(n){return e.error("Error caught:",n,t),{summary:"Error fetching email summary: "+n,importantDetails:null,topicsDiscussed:"",actionItems:""}}}async function SC(r,e,t){const n={sourceFile:kr};try{const s=await $r(D6,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email_thread_id:r,email_thread_content:e})},t);if(t.debug("Response received:",{...n,data:s}),!s.ok)throw Kc(t,s),new Error(`HTTP error! status: ${s.status}`);const i=s.headers.get("content-type");if(i&&i.includes("application/json")){const c=await s.json();if(!c||!c.message)throw new Error("Summary not found in response");return{description:c.message}}else throw new Error("Received non-JSON response from server")}catch(s){return t.error("Error caught:",s,n),{description:""}}}async function r8(r,e){const t={sourceFile:kr};try{const n=await $r(L6,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({full_thread:r})},e);if(e.debug("Response received:",{...t,data:n}),!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const s=n.headers.get("content-type");if(s&&s.includes("application/json")){const i=await n.json();if(!i||!i.message)throw new Error("Summary not found in response");let c=null;if(i.message.important_details)try{typeof i.message.important_details=="object"?(e.debug("Important details is already an object, using it directly...",t),c=i.message.important_details):typeof i.message.important_details=="string"&&(e.debug("Important details is a JSON string, parsing...",t),c=JSON.parse(i.message.important_details)),e.debug("Parsed important details:",{...t,data:c})}catch(u){e.error("Error parsing important details:",u,t),c=null}return{summary:i.message.summary,importantDetails:c,topicsDiscussed:i.message.topics_discussed,actionItems:i.message.action_items}}else throw new Error("Received non-JSON response from server")}catch(n){return e.error("Error caught:",n,t),{summary:"Error fetching email summary: "+n,importantDetails:null,topicsDiscussed:"",actionItems:""}}}async function Gy(r,e,t,n=!1,s){const i={sourceFile:kr,functionName:"getClientDataFromServer"},c=e.toLowerCase(),u=s!=null&&s.cursor?`:cursor_${s.cursor}`:"",p=`${r}:${c}${u}`,m=Fx.get(p);if(m)return t.debug("Returning existing in-flight request",{...i,clientEmail:e}),console.log(` [${r.toUpperCase()}] Deduplicating request for ${e} - returning in-flight promise`),m;const g=Hw(r,e,t,n,s);return Fx.set(p,g),g.finally(()=>{Fx.delete(p)})}async function n8(r,e,t,n,s=10){return Gy(r,e,n,!1,{limit:s,cursor:t})}async function Hw(r,e,t,n=!1,s,i=0){const c={sourceFile:kr,functionName:"fetchClientDataInternal"},u=Date.now();if(console.group(` [${r.toUpperCase()}] getClientDataFromServer - ${e}${i>0?` (retry ${i})`:""}`),console.time("getClientDataFromServer:total"),console.log("Integration:",r),console.log("Client Email:",e),t.info("Starting client data fetch",{...c,clientEmail:e,integrationType:r,retryCount:i}),i===0){const S=M5(e);if(S.inCache)throw console.log(` Timeout cache hit: Email recently failed with ${S.errorType}`),console.timeEnd("getClientDataFromServer:total"),console.groupEnd(),t.info("Email in timeout cache, skipping API call to prevent retry storm",{...c,clientEmail:e,errorType:S.errorType,totalMs:Date.now()-u}),new Error(`Request recently failed (${S.errorType}) - try again later`)}console.time("getClientDataFromServer:nonExistentCacheCheck");const p=Date.now(),m=await W5(e,t),g=Date.now()-p;if(console.timeEnd("getClientDataFromServer:nonExistentCacheCheck"),m)throw console.log(" Non-existent cache hit: Email known to have no client data"),console.timeEnd("getClientDataFromServer:total"),console.groupEnd(),t.info("Email in non-existent cache, skipping API call",{...c,clientEmail:e,nonExistentCacheCheckMs:g,totalMs:Date.now()-u}),new Error("Client not found (cached)");console.time("getClientDataFromServer:clientCacheCheck");const x=Date.now(),b=s!=null&&s.cursor?null:await vT(e,t),E=Date.now()-x;if(console.timeEnd("getClientDataFromServer:clientCacheCheck"),b)return console.log(" Cache hit: Client data found in cache"),console.timeEnd("getClientDataFromServer:total"),console.groupEnd(),t.info("Client data found in cache",{...c,clientEmail:e,nonExistentCacheCheckMs:g,clientCacheCheckMs:E,totalMs:Date.now()-u}),b;const T=new URL($6);T.searchParams.append("integration_type",r),T.searchParams.append("client_email",e),T.searchParams.append("data_type","client_data"),s&&(T.searchParams.append("limit",String(s.limit||10)),s.cursor&&T.searchParams.append("cursor",s.cursor)),n&&T.searchParams.append("force_refresh","true");try{console.time("getClientDataFromServer:apiCall"),console.log(" Making API request to:",T.toString());const S=Date.now(),N=await $r(T,{method:"GET",headers:{"Content-Type":"application/json"}},t),R=Date.now()-S,A=Hy(N);if(console.timeEnd("getClientDataFromServer:apiCall"),console.log(" Response status:",N.status,`(${R}ms)`),console.log(" Trace ID:",A||"N/A"),N.status===504||N.status===503)if(console.error(` ${N.status} Gateway Timeout - API call took too long`),console.log("Request URL:",T.toString()),console.log("Time elapsed before timeout:",R,"ms"),console.log(" Trace ID for debugging:",A||"N/A"),i<Ff){const P=_C*Math.pow(2,i);return console.log(` Retrying in ${P}ms (attempt ${i+1}/${Ff})`),console.timeEnd("getClientDataFromServer:total"),console.groupEnd(),t.info("Retrying after timeout",{...c,clientEmail:e,status:N.status,retryCount:i+1,delayMs:P,traceId:A}),await new Promise(M=>setTimeout(M,P)),Hw(r,e,t,n,s,i+1)}else yC(e,`${N.status}`),console.log(` Max retries (${Ff}) exhausted, added to timeout cache`),t.warn("Max retries exhausted for timeout error, added to timeout cache",{...c,clientEmail:e,status:N.status,retryCount:i,traceId:A});if(t.info("API response received",{...c,clientEmail:e,status:N.status,apiMs:R,nonExistentCacheCheckMs:g,clientCacheCheckMs:E,traceId:A,retryCount:i}),!N.ok){if(N.status===404&&(await G5(e,t),Kc(t,N)),console.error(" API error:",N.status),console.timeEnd("getClientDataFromServer:total"),console.groupEnd(),N.status===400)try{const P=await N.json();if(P!=null&&P.error)throw new Error(`HTTP error! status: 400 - ${P.error}`)}catch(P){if(P instanceof Error&&P.message.startsWith("HTTP error!"))throw P}throw new Error(`HTTP error! status: ${N.status}`)}const j=N.headers.get("content-type");if(j&&j.includes("application/json")){console.time("getClientDataFromServer:parseJson");const P=Date.now(),M=await N.json(),B=Date.now()-P;console.timeEnd("getClientDataFromServer:parseJson");const U=M.requestId,V=M.traceId,Y=U||A;U&&console.log(" Request ID (from body):",U),V&&console.log(" Trace ID (from body):",V);const ce={client_data:M.client_data||{},case_data:M.case_data||[],pagination:M.pagination||void 0};console.time("getClientDataFromServer:cacheWrite");const X=Date.now();s!=null&&s.cursor||await q5(e,ce,t);const de=Date.now()-X;console.timeEnd("getClientDataFromServer:cacheWrite"),hT(e);const we=Date.now()-u;return console.log(" Client data fetch completed"),console.log(" Timing breakdown:",{nonExistentCacheCheck:`${g}ms`,clientCacheCheck:`${E}ms`,apiCall:`${R}ms`,parseJson:`${B}ms`,cacheWrite:`${de}ms`,total:`${we}ms`}),console.timeEnd("getClientDataFromServer:total"),console.groupEnd(),t.info("Client data fetch completed",{...c,clientEmail:e,nonExistentCacheCheckMs:g,clientCacheCheckMs:E,apiMs:R,parseMs:B,cacheWriteMs:de,totalMs:we,retryCount:i,requestId:Y,traceId:V||A}),ce}else throw console.error(" Received non-JSON response"),console.timeEnd("getClientDataFromServer:total"),console.groupEnd(),new Error("Received non-JSON response from server")}catch(S){const N=Date.now()-u;if(i<Ff&&EC(S)){const R=_C*Math.pow(2,i);return console.log(` Retrying after error in ${R}ms (attempt ${i+1}/${Ff})`),console.timeEnd("getClientDataFromServer:total"),console.groupEnd(),t.info("Retrying after network error",{...c,clientEmail:e,error:S instanceof Error?S.message:String(S),retryCount:i+1,delayMs:R}),await new Promise(A=>setTimeout(A,R)),Hw(r,e,t,n,s,i+1)}if(EC(S)){const R=S instanceof Error?S.message.includes("timeout")?"timeout":"network":"unknown";yC(e,R),console.log(` Max retries (${Ff}) exhausted for ${R} error, added to timeout cache`),t.warn("Max retries exhausted for network error, added to timeout cache",{...c,clientEmail:e,errorType:R,retryCount:i})}throw console.error(" Client data fetch failed:",S instanceof Error?S.message:String(S)),console.log(" Timing at failure:",{nonExistentCacheCheck:`${g}ms`,clientCacheCheck:`${E}ms`,total:`${N}ms`}),console.timeEnd("getClientDataFromServer:total"),console.groupEnd(),t.info("Client data fetch failed",{...c,clientEmail:e,error:S instanceof Error?S.message:String(S),nonExistentCacheCheckMs:g,clientCacheCheckMs:E,totalMs:N,retryCount:i}),S}}async function RT(r,e,t){const n={sourceFile:kr,functionName:"getDocumentListForProject"};t.debug("Starting to fetch project documents...",{...n,projectId:e});const s=new URL(H6);s.searchParams.append("integration_type",r),s.searchParams.append("project_id",e);try{const i=await $r(s,{method:"GET",headers:{"Content-Type":"application/json"}},t);if(t.debug("Response received:",{...n,data:i}),!i.ok){if(i.status===404)return Kc(t,i),{documents:[]};throw new Error(`HTTP error! status: ${i.status}`)}const c=i.headers.get("content-type");if(c&&c.includes("application/json")){const u=await i.json();return t.debug("Parsed JSON response:",{...n,data:u}),{documents:u.documents||[]}}else throw new Error("Received non-JSON response from server")}catch(i){throw t.debug("Error fetching project documents:",{...n,error:i}),i}}async function s8(r,e,t){const n={sourceFile:kr,functionName:"getCaseSummaryForProject"};t.debug("Starting to fetch case summary...",{...n,projectId:e});const s=new URL(B6);s.searchParams.append("integration_type",r),s.searchParams.append("project_id",e);try{const i=await $r(s,{method:"GET",headers:{"Content-Type":"application/json"}},t);if(t.debug("Response received:",{...n,data:i}),!i.ok){if(i.status===404)return Kc(t,i),null;throw new Error(`HTTP error! status: ${i.status}`)}const c=i.headers.get("content-type");if(c&&c.includes("application/json")){const u=await i.json();return t.debug("Parsed JSON response:",{...n,data:u}),{caseFacts:u.caseFacts||"",supioLink:u.supioLink||"",statuteoflimitations:u.statuteoflimitations||{dateValue:"",doneDate:null},disbursementSheet:u.disbursementSheet||null,totalMeds:u.totalMeds||0,totalLiens:u.totalLiens||0}}else throw new Error("Received non-JSON response from server")}catch(i){return t.debug("Error fetching case summary:",{...n,error:i}),null}}async function o8(r,e){const t={sourceFile:kr,functionName:"getEmailParticipantsFromServer"};e.debug("Starting to fetch response...",t);const n={email_thread_id:r};try{const s=await $r(P6,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)},e);if(e.debug("Response received:",{...t,data:s}),!s.ok)throw Kc(e,s),new Error(`HTTP error! status: ${s.status}`);const i=s.headers.get("content-type");if(i&&i.includes("application/json")){const c=await s.json();return e.debug("Parsed JSON response:",{...t,data:c}),c.email_participants}else throw new Error("Received non-JSON response from server")}catch(s){throw e.error("Error fetching email participants:",s,t),s}}async function AT(r,e){const t={sourceFile:kr,functionName:"getEmailParticipantsFromServer"};e.debug("Starting to fetch response...",t);const n={email_thread_id:r};try{const s=await $r(F6,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)},e);if(e.debug("Response received:",{...t,data:s}),!s.ok)throw Kc(e,s),new Error(`HTTP error! status: ${s.status}`);const i=s.headers.get("content-type");if(i&&i.includes("application/json")){const c=await s.json();return e.debug("Parsed JSON response:",{...t,data:c}),c.email_details}else throw new Error("Received non-JSON response from server")}catch(s){throw e.error("Error fetching email participants:",s,t),s}}async function i8(r,e,t){const n={sourceFile:kr,functionName:"getDocumentURLFromServer"};t.debug("Starting to fetch document data...",n);const s=new URL(U6);s.searchParams.append("integration_type",r),s.searchParams.append("document_id",e);try{const i=await $r(s,{method:"GET",headers:{"Content-Type":"application/json"}},t);if(t.debug("Response received:",{...n,data:i}),!i.ok)throw i.status===404?new Error("Document not found or integration not configured"):new Error(`HTTP error! status: ${i.status}`);const c=i.headers.get("content-type");if(c&&c.includes("application/json")){const u=await i.json();if(t.debug("Parsed JSON response:",{...n,data:u}),!u.url)throw new Error("Document URL not found in response");return{documentId:parseInt(e),url:u.url}}else throw new Error("Received non-JSON response from server")}catch(i){throw t.error("Error fetching document data:",i,n),i}}async function a8(r,e){const t={sourceFile:kr,functionName:"getAllClientsFromServer"};r.debug("Starting to fetch all clients for project...",t);const n=new URL(z6);n.searchParams.append("integration_type",e);try{const s=await $r(n,{method:"GET",headers:{"Content-Type":"application/json"}},r);if(r.debug("Response received:",{...t,data:s}),!s.ok)throw s.status===400?new Error("Missing required parameters"):s.status===404?new Error("No integration found for the specified type"):new Error(`HTTP error! status: ${s.status}`);const i=s.headers.get("content-type");if(i&&i.includes("application/json")){const c=await s.json();return r.debug("Parsed JSON response:",{...t,data:c}),{clients:c}}else throw new Error("Received non-JSON response from server")}catch(s){throw r.error("Error fetching all clients:",s,t),s}}async function Wy(r,e,t){var i,c;const n={sourceFile:kr},s=Date.now();console.group(` [${r.toUpperCase()}] searchProjectsFromServer - "${e}"`),console.time("searchProjectsFromServer:total"),console.log("Integration:",r),console.log("Search Term:",e);try{t.info("Searching projects",{...n,integrationType:r,searchTerm:e});const u=new URL(W6);u.searchParams.append("integration_type",r),u.searchParams.append("search_term",e),u.searchParams.append("exclude_archived","true"),u.searchParams.append("limit","10"),console.time("searchProjectsFromServer:apiCall"),console.log(" Making API request to:",u.toString());const p=Date.now(),m=await $r(u,{method:"GET",headers:{"Content-Type":"application/json"}},t),g=Date.now()-p,x=Hy(m);if(console.timeEnd("searchProjectsFromServer:apiCall"),console.log(" Response status:",m.status,`(${g}ms)`),console.log(" Trace ID:",x||"N/A"),m.status===504&&(console.error(" 504 Gateway Timeout - API call took too long"),console.log("Request URL:",u.toString()),console.log("Time elapsed before timeout:",g,"ms"),console.log(" Trace ID for debugging:",x||"N/A")),!m.ok){if(m.status===404)return console.log(" No projects found (404)"),console.timeEnd("searchProjectsFromServer:total"),console.groupEnd(),t.debug("No projects found",{...n,traceId:x}),{projects:[],total:0,hasMore:!1};throw console.error(" API error:",m.status),console.timeEnd("searchProjectsFromServer:total"),console.groupEnd(),new Error(`Search failed: ${m.status}`)}const b=m.headers.get("content-type");if(b&&b.includes("application/json")){console.time("searchProjectsFromServer:parseJson");const E=await m.json();console.timeEnd("searchProjectsFromServer:parseJson");const T=Date.now()-s;return console.log(" Project search completed"),console.log(" Results:",((i=E.projects)==null?void 0:i.length)||0,"projects found"),console.log(" Timing breakdown:",{apiCall:`${g}ms`,total:`${T}ms`}),console.timeEnd("searchProjectsFromServer:total"),console.groupEnd(),t.info("Project search successful",{...n,resultCount:((c=E.projects)==null?void 0:c.length)||0}),E}else throw console.error(" Received non-JSON response"),console.timeEnd("searchProjectsFromServer:total"),console.groupEnd(),new Error("Received non-JSON response from server")}catch(u){const p=Date.now()-s;throw console.error(" Project search failed:",u instanceof Error?u.message:String(u)),console.log(" Timing at failure:",{total:`${p}ms`}),console.timeEnd("searchProjectsFromServer:total"),console.groupEnd(),t.error("Error searching projects",u,{...n,integrationType:r,searchTerm:e}),u}}async function l8(r,e,t){var i,c,u,p;const n={sourceFile:kr},s=Date.now();console.group(` [${r.toUpperCase()}] getProjectDataById - ${e}`),console.time("getProjectDataById:total"),console.log("Integration:",r),console.log("Project ID:",e);try{t.info("Fetching project data by ID",{...n,integrationType:r,projectId:e});const m=new URL(V6);m.searchParams.append("integration_type",r),m.searchParams.append("project_id",e),console.time("getProjectDataById:apiCall"),console.log(" Making API request to:",m.toString());const g=Date.now(),x=await $r(m,{method:"GET",headers:{"Content-Type":"application/json"}},t),b=Date.now()-g,E=Hy(x);if(console.timeEnd("getProjectDataById:apiCall"),console.log(" Response status:",x.status,`(${b}ms)`),console.log(" Trace ID:",E||"N/A"),x.status===504&&(console.error(" 504 Gateway Timeout - API call took too long"),console.log("Request URL:",m.toString()),console.log("Time elapsed before timeout:",b,"ms"),console.log(" Trace ID for debugging:",E||"N/A")),!x.ok){if(x.status===404)return console.log(" Project not found (404)"),console.timeEnd("getProjectDataById:total"),console.groupEnd(),t.debug("Project not found",{...n,traceId:E}),{};throw console.error(" API error:",x.status),console.timeEnd("getProjectDataById:total"),console.groupEnd(),new Error(`Failed to fetch project: ${x.status}`)}const T=x.headers.get("content-type");if(T&&T.includes("application/json")){console.time("getProjectDataById:parseJson");const S=await x.json();console.timeEnd("getProjectDataById:parseJson");const N=S.project||{},R=Date.now()-s;return console.log(" Project data fetched successfully"),console.log(" Data includes:",{hasCalendarEntries:!!((i=N.case_data)!=null&&i.calendar_entries||N.calendar_entries),hasNotes:!!((c=N.case_data)!=null&&c.notes||N.notes),hasTasks:!!((u=N.case_data)!=null&&u.last_completed_task||(p=N.case_data)!=null&&p.next_upcoming_task)}),console.log(" Timing breakdown:",{apiCall:`${b}ms`,total:`${R}ms`}),console.timeEnd("getProjectDataById:total"),console.groupEnd(),t.info("Project data fetched successfully",{...n,projectId:e}),N}else throw console.error(" Received non-JSON response"),console.timeEnd("getProjectDataById:total"),console.groupEnd(),new Error("Received non-JSON response from server")}catch(m){const g=Date.now()-s;throw console.error(" Project data fetch failed:",m instanceof Error?m.message:String(m)),console.log(" Timing at failure:",{total:`${g}ms`}),console.timeEnd("getProjectDataById:total"),console.groupEnd(),t.error("Error fetching project by ID",m,{...n,integrationType:r,projectId:e}),m}}async function c8(r,e){const t={sourceFile:kr,functionName:"getUserDataFromServer"},n=Date.now(),s=`getUserDataFromServer:${n}`;r.debug("Starting to fetch user data...",t);const i=new URL(G6);i.searchParams.append("integration_type",e);try{const c=Date.now(),u=await $r(i,{method:"GET",headers:{"Content-Type":"application/json"}},r),p=Hy(u);if(console.timeEnd("getUserDataFromServer:apiCall"),u.status===504&&console.error(" 504 Gateway Timeout - API call took too long"),r.debug("Response received:",{...t,data:u,traceId:p}),!u.ok)throw u.status===400?(console.error(" API error: 400 - Missing required parameters"),new Error("Missing required parameters")):u.status===404?(console.error(" API error: 404 - No integration found"),new Error("No integration found for the specified type")):(console.error(" API error:",u.status),new Error(`HTTP error! status: ${u.status}`));const m=u.headers.get("content-type");if(m&&m.includes("application/json")){console.time("getUserDataFromServer:parseJson");const g=await u.json();return console.timeEnd("getUserDataFromServer:parseJson"),console.timeEnd(s),console.groupEnd(),r.debug("Parsed JSON response:",{...t,data:g}),{id:g.id||null,name:g.name||null,rate:g.rate||0}}else throw console.error(" Received non-JSON response"),new Error("Received non-JSON response from server")}catch(c){const u=Date.now()-n;throw console.error(" User data fetch failed:",c instanceof Error?c.message:String(c)),console.log(" Timing at failure:",{total:`${u}ms`}),console.timeEnd(s),console.groupEnd(),r.error("Error fetching user data:",c,t),c}}async function u8(r,e,t){var i,c;const n={sourceFile:kr,functionName:"searchFirmUsersFromServer"};t.debug("Starting to search firm users...",{...n,integrationType:r,searchTerm:e});const s=new URL(TT);s.searchParams.append("integration_type",r),s.searchParams.append("request_function","search_firm_users"),s.searchParams.append("search_term",e),s.searchParams.append("limit","10");try{const u=await $r(s,{method:"GET",headers:{"Content-Type":"application/json"}},t);if(t.debug("Response received:",{...n,status:u.status}),!u.ok){if(u.status===404)return t.debug("No users found",n),{users:[],total:0,hasMore:!1};throw new Error(`HTTP error! status: ${u.status}`)}const p=u.headers.get("content-type");if(p&&p.includes("application/json")){const m=await u.json();return t.debug("Parsed JSON response:",{...n,usersCount:((i=m.users)==null?void 0:i.length)||0}),{users:m.users||[],total:m.total||((c=m.users)==null?void 0:c.length)||0,hasMore:m.has_more||!1}}else throw new Error("Received non-JSON response from server")}catch(u){throw t.error("Error searching firm users:",u,n),u}}async function IT(r,e){var s;const t={sourceFile:kr,functionName:"getFirmUsersFromServer"};e.debug("Starting to fetch firm users...",{...t,integrationType:r});const n=new URL(TT);n.searchParams.append("integration_type",r),n.searchParams.append("request_function","get_firm_users");try{const i=await $r(n,{method:"GET",headers:{"Content-Type":"application/json"}},e);if(e.debug("Response received:",{...t,status:i.status}),!i.ok)throw new Error(`HTTP error! status: ${i.status}`);const c=i.headers.get("content-type");if(c&&c.includes("application/json")){const u=await i.json();return e.debug("Parsed JSON response:",{...t,usersCount:((s=u.users)==null?void 0:s.length)||0}),u.users||[]}else throw new Error("Received non-JSON response from server")}catch(i){throw e.error("Error fetching firm users:",i,t),i}}async function ny(r,e,t,n,s,i,c,u,p,m,g,x,b,E,T,S){const N={sourceFile:kr,functionName:"writeTimeEntryToServer"};S.debug("Starting to write time entry to server...",N);try{const R=await $r(Vm,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_email:r,function:"write_time_entry_to_clio",integration_type:e,date:t,quantity:n,description:s,matter_id:i,write_time_entry:c,email_subject:u,email_body:p,sent_at:m,sender_email:g,recipient_emails:x,non_billable:b,no_charge:E,price:T})},S);if(S.debug("Response received:",{...N,data:R,sourceFile:kr}),!R.ok)throw new Error(`HTTP error! status: ${R.status}`);const A=R.headers.get("content-type");if(A&&A.includes("application/json")){const j=await R.json();return S.debug("Parsed JSON response:",{...N,data:j}),j.message||"Time entry written successfully"}else throw new Error("Received non-JSON response from server")}catch(R){throw S.error("Error writing time entry:",R,{...N,sourceFile:kr}),R}}async function d8(r){const e={sourceFile:kr,functionName:"getIntegrationSettingsFromServer"};r.debug("Starting to fetch integration settings...",{...e});const t=new URL(q6);try{const n=await $r(t,{method:"GET",headers:{"Content-Type":"application/json"}},r);if(r.debug("Response received:",{...e,data:n}),!n.ok){if(n.status===404)return r.debug("No settings found, returning defaults",e),{};throw new Error(`HTTP error! status: ${n.status}`)}const s=n.headers.get("content-type");if(s&&s.includes("application/json")){const i=await n.json();return r.debug("Parsed JSON response:",{...e,data:i}),i.integration_settings||{}}else throw new Error("Received non-JSON response from server")}catch(n){return r.error("Error fetching integration settings:",n,e),{}}}async function f8(r,e,t){const n={sourceFile:kr,functionName:"generateTaskDescriptionFromEmail"};t.debug("Starting to generate task description from email...",n);try{const s=await $r(K6,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({integration_type:r,email_content:e})},t);if(t.debug("Response received:",{...n,data:s}),!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const i=s.headers.get("content-type");if(i&&i.includes("application/json")){const c=await s.json();return t.debug("Parsed JSON response:",{...n,data:c}),{name:c.name||"",description:c.description||""}}else throw new Error("Received non-JSON response from server")}catch(s){throw t.error("Error generating task description:",s,n),s}}async function h8(r,e,t,n,s,i,c,u,p,m){const g={sourceFile:kr,functionName:"createClioTask"};c.debug("Starting to create Clio task...",{...g,taskName:e,matterId:n,dueAt:s,priority:i,assigneeId:u,reminder:p,notificationFlags:m});try{const x={function:"write_task_to_clio",integration_type:r,name:e,description:t,matter_id:n,due_at:s,priority:i};u&&(x.assignee_id=u),p&&(x.reminder=p),m&&(x.notify_assignee=m.notifyAssignee,x.notify_completion=m.notifyCompletion);const b=await $r(Vm,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(x)},c);if(c.debug("Response received:",{...g,data:b}),!b.ok)throw new Error(`HTTP error! status: ${b.status}`);const E=b.headers.get("content-type");if(E&&E.includes("application/json")){const T=await b.json();return c.debug("Parsed JSON response:",{...g,data:T}),{taskId:T.task_id||"",message:T.message||"Task created successfully"}}else throw new Error("Received non-JSON response from server")}catch(x){throw c.error("Error creating Clio task:",x,g),x}}async function p8(r,e,t,n,s,i,c){const u={sourceFile:kr,functionName:"createClioNote"};try{const m=await $r(Vm,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({function:"write_note_to_clio",integration_type:r,subject:e,detail:t,date:n,matter_id:s,contact_id:i})},c);if(!m.ok){const x=await m.json();throw new Error(x.message||`HTTP error! status: ${m.status}`)}const g=await m.json();return c.info("Note created successfully",{...u,noteId:g.note_id}),{noteId:g.note_id,message:g.message||"Note created successfully"}}catch(p){throw c.error("Error creating note",p,u),p}}async function m8(r,e){const t={sourceFile:kr,functionName:"createContactInClio"};e.debug("Starting to create Clio contact...",{...t,email:r.email});try{const n=await $r(Vm,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({function:"create_contact_in_clio",integration_type:"clio",first_name:r.firstName,last_name:r.lastName,email:r.email,phone_number:r.phoneNumber,contact_type:r.type,company_name:r.companyName})},e);if(e.debug("Response received:",{...t,data:n}),!n.ok){const c=(await n.json().catch(()=>({}))).error||`HTTP error! status: ${n.status}`;throw new Error(c)}const s=n.headers.get("content-type");if(s&&s.includes("application/json")){const i=await n.json();return e.debug("Parsed JSON response:",{...t,data:i}),{id:i.contact_id||i.id||"",message:i.message||"Contact created successfully"}}else throw new Error("Received non-JSON response from server")}catch(n){throw e.error("Error creating Clio contact:",n,t),n}}async function g8(r,e,t,n,s){const i={sourceFile:kr,functionName:"linkContactToMatter"};s.debug("Starting to link contact to matter...",{...i,contactId:e,matterId:t,relationship:n});try{const c=await $r(Vm,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({function:"link_contact_to_matter",integration_type:r,contact_id:e,matter_id:t,relationship:n})},s);if(s.debug("Response received:",{...i,data:c}),!c.ok){const m=(await c.json().catch(()=>({}))).error||`HTTP error! status: ${c.status}`;throw new Error(m)}const u=c.headers.get("content-type");if(u&&u.includes("application/json")){const p=await c.json();return s.debug("Parsed JSON response:",{...i,data:p}),{message:p.message||"Contact linked to matter successfully"}}else throw new Error("Received non-JSON response from server")}catch(c){throw s.error("Error linking contact to matter:",c,i),c}}function ln(){const r=w.useContext(J_);if(!r)throw new Error("usePlatform must be used within a PlatformProvider");if(!r.services)throw new Error("Platform services are not available. Services may still be loading or failed to initialize.");return r}const Hl=()=>ln().services.storage,id=()=>ln().services.data,PT=()=>ln().services.auth,v8=()=>ln().services.messaging,y8=()=>ln().services.tabs,x8=()=>ln().services.lifecycle,w8=()=>ln().services.logging,b8=({children:r})=>{const[e,t]=w.useState(!0),[n,s]=w.useState(!1),[i,c]=w.useState(!1),[u,p]=w.useState(null),[m,g]=w.useState("loading"),[x,b]=w.useState(null),[E,T]=w.useState(0),S=w8(),{platform:N}=ln(),R=Hl(),A=w.useCallback(async()=>{if(N!=="chrome"){t(!1),g("disconnected"),b(new Date);return}c(!0),g("loading"),p(null);try{const U=await By(S);t(U),g(U?"connected":"disconnected"),b(new Date),U&&(T(0),n||(s(!0),R&&R.setLocalItem("wasEverConnectedGmail",!0).catch(V=>{S.error("Failed to save wasEverConnected to storage",V,{sourceFile:"src/shared/contexts/GmailConnectionContext/GmailConnectionProvider.tsx"})}))),S.debug("Gmail connection status checked",{sourceFile:"src/shared/contexts/GmailConnectionContext/GmailConnectionProvider.tsx",connected:U,status:U?"connected":"disconnected"})}catch(U){const V=U instanceof Error?U.message:"Unknown error occurred";p(V),t(!1),g("error"),b(new Date),S.error("Error checking Gmail connection",U,{sourceFile:"src/shared/contexts/GmailConnectionContext/GmailConnectionProvider.tsx"})}finally{c(!1)}},[S,N,n,R]),j=w.useCallback(async()=>{try{T(le=>le+1),g("loading"),p(null);const{initiateIntegration:U,findIntegrationById:V}=await Rw(async()=>{const{initiateIntegration:le,findIntegrationById:se}=await Promise.resolve().then(()=>_9);return{initiateIntegration:le,findIntegrationById:se}},void 0),{GMAIL_INTEGRATION_PAGE_URI:Y,GMAIL_INTEGRATION_REDIRECT_URI:ce}=await Rw(async()=>{const{GMAIL_INTEGRATION_PAGE_URI:le,GMAIL_INTEGRATION_REDIRECT_URI:se}=await Promise.resolve().then(()=>wU);return{GMAIL_INTEGRATION_PAGE_URI:le,GMAIL_INTEGRATION_REDIRECT_URI:se}},void 0),X=Y(ce),de=await V("gmail");if(!de)throw new Error("Gmail integration not found");const we=await U(S,de,X);return we?await A():g("disconnected"),we}catch(U){const V=U instanceof Error?U.message:"Failed to reconnect Gmail";throw p(V),g("error"),S.error("Failed to reconnect Gmail:",U,{sourceFile:"src/shared/contexts/GmailConnectionContext/GmailConnectionProvider.tsx",attemptNumber:E+1}),U}},[S,A,E]),P=w.useCallback(()=>{p(null),m==="error"&&g(e?"connected":"disconnected")},[m,e]),M=w.useCallback(async()=>{await A()},[A]);w.useEffect(()=>{if(N!=="chrome")return;const U=setInterval(()=>{A()},36e5);return()=>clearInterval(U)},[A,N]),w.useEffect(()=>{if(N!=="chrome")return;const V=(async()=>{try{const ce=(await Kn.createServices()).storage;if(ce.onChanged){const X=de=>{if(de.gmailConnectionStatus){const we=de.gmailConnectionStatus.newValue;S.debug("Gmail connection status changed via storage",{sourceFile:"src/shared/contexts/GmailConnectionContext/GmailConnectionProvider.tsx",newStatus:we,oldStatus:de.gmailConnectionStatus.oldValue}),we!==void 0&&(t(we),g(we?"connected":"disconnected"),b(new Date),we&&u&&p(null))}};return ce.onChanged(X),()=>{ce.removeChangeListener&&ce.removeChangeListener(X)}}}catch(Y){S.error("Failed to set up Gmail connection storage listener:",Y,{sourceFile:"src/shared/contexts/GmailConnectionContext/GmailConnectionProvider.tsx"})}})();return()=>{V.then(Y=>Y==null?void 0:Y())}},[N,S,u]),w.useEffect(()=>{(async()=>{if(!(N!=="chrome"||!R))try{const V=await R.getLocalItem("wasEverConnectedGmail");V!==null&&(s(V),S.debug("Loaded wasEverConnected from storage",{sourceFile:"src/shared/contexts/GmailConnectionContext/GmailConnectionProvider.tsx",wasEverConnected:V}))}catch(V){S.error("Failed to load wasEverConnected from storage",V,{sourceFile:"src/shared/contexts/GmailConnectionContext/GmailConnectionProvider.tsx"})}})()},[N,R,S]),w.useEffect(()=>{A()},[A]);const B={isConnected:e,wasEverConnected:n,isLoading:i,error:u,status:m,lastChecked:x,reconnectAttempts:E,checkConnection:A,initiateReconnection:j,clearError:P,forceRefresh:M};return d.jsx(fT.Provider,{value:B,children:r})},FT=w.createContext(void 0),jT=()=>{const r=w.useContext(FT);if(!r)throw new Error("useActiveSection must be used within an ActiveSectionProvider");return r},_8=({children:r})=>{const[e,t]=w.useState("main");return d.jsx(FT.Provider,{value:{activeSection:e,setActiveSection:t},children:r})};var be=typeof window<"u"?window:void 0,bs=typeof globalThis<"u"?globalThis:be;typeof self>"u"&&(bs.self=bs),typeof File>"u"&&(bs.File=function(){});var OT=Array.prototype,CC=OT.forEach,kC=OT.indexOf,Go=bs==null?void 0:bs.navigator,qe=bs==null?void 0:bs.document,xs=bs==null?void 0:bs.location,Bw=bs==null?void 0:bs.fetch,Gw=bs!=null&&bs.XMLHttpRequest&&"withCredentials"in new bs.XMLHttpRequest?bs.XMLHttpRequest:void 0,NC=bs==null?void 0:bs.AbortController,_o=Go==null?void 0:Go.userAgent,Et=be??{},Rl={DEBUG:!1,LIB_VERSION:"1.343.2"};function TC(r,e,t,n,s,i,c){try{var u=r[i](c),p=u.value}catch(m){return void t(m)}u.done?e(p):Promise.resolve(p).then(n,s)}function Gf(r){return function(){var e=this,t=arguments;return new Promise((function(n,s){var i=r.apply(e,t);function c(p){TC(i,n,s,c,u,"next",p)}function u(p){TC(i,n,s,c,u,"throw",p)}c(void 0)}))}}function et(){return et=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)({}).hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},et.apply(null,arguments)}function DT(r,e){if(r==null)return{};var t={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(e.indexOf(n)!==-1)continue;t[n]=r[n]}return t}var E8=["amazonbot","amazonproductbot","app.hypefactors.com","applebot","archive.org_bot","awariobot","backlinksextendedbot","baiduspider","bingbot","bingpreview","chrome-lighthouse","dataforseobot","deepscan","duckduckbot","facebookexternal","facebookcatalog","http://yandex.com/bots","hubspot","ia_archiver","leikibot","linkedinbot","meta-externalagent","mj12bot","msnbot","nessus","petalbot","pinterest","prerender","rogerbot","screaming frog","sebot-wa","sitebulb","slackbot","slurp","trendictionbot","turnitin","twitterbot","vercel-screenshot","vercelbot","yahoo! slurp","yandexbot","zoombot","bot.htm","bot.php","(bot;","bot/","crawler","ahrefsbot","ahrefssiteaudit","semrushbot","siteauditbot","splitsignalbot","gptbot","oai-searchbot","chatgpt-user","perplexitybot","better uptime bot","sentryuptimebot","uptimerobot","headlesschrome","cypress","google-hoteladsverifier","adsbot-google","apis-google","duplexweb-google","feedfetcher-google","google favicon","google web preview","google-read-aloud","googlebot","googleother","google-cloudvertexbot","googleweblight","mediapartners-google","storebot-google","google-inspectiontool","bytespider"],RC=function(r,e){if(e===void 0&&(e=[]),!r)return!1;var t=r.toLowerCase();return E8.concat(e).some((n=>{var s=n.toLowerCase();return t.indexOf(s)!==-1}))},S8=["$snapshot","$pageview","$pageleave","$set","survey dismissed","survey sent","survey shown","$identify","$groupidentify","$create_alias","$$client_ingestion_warning","$web_experiment_applied","$feature_enrollment_update","$feature_flag_called"];function ar(r,e){return r.indexOf(e)!==-1}var Vy=function(r){return r.trim()},Ww=function(r){return r.replace(/^\$/,"")},C8=Array.isArray,LT=Object.prototype,MT=LT.hasOwnProperty,qy=LT.toString,Fr=C8||function(r){return qy.call(r)==="[object Array]"},$c=r=>typeof r=="function",Vn=r=>r===Object(r)&&!Fr(r),Wf=r=>{if(Vn(r)){for(var e in r)if(MT.call(r,e))return!1;return!0}return!1},Ke=r=>r===void 0,qn=r=>qy.call(r)=="[object String]",Vw=r=>qn(r)&&r.trim().length===0,Xi=r=>r===null,cr=r=>Ke(r)||Xi(r),Ll=r=>qy.call(r)=="[object Number]"&&r==r,zf=r=>Ll(r)&&r>0,Ol=r=>qy.call(r)==="[object Boolean]",k8=r=>r instanceof FormData,N8=r=>ar(S8,r);function qw(r){return r===null||typeof r!="object"}function sy(r,e){return Object.prototype.toString.call(r)==="[object "+e+"]"}function $T(r){return!Ke(Event)&&(function(e,t){try{return e instanceof t}catch{return!1}})(r,Event)}var T8=[!0,"true",1,"1","yes"],jx=r=>ar(T8,r),R8=[!1,"false",0,"0","no"];function La(r,e,t,n,s){return e>t&&(n.warn("min cannot be greater than max."),e=t),Ll(r)?r>t?(n.warn(" cannot be  greater than max: "+t+". Using max value instead."),t):r<e?(n.warn(" cannot be less than min: "+e+". Using min value instead."),e):r:(n.warn(" must be a number. using max or fallback. max: "+t+", fallback: "+s),La(s||t,e,t,n))}class A8{constructor(e){this.t={},this.i=e.i,this.o=La(e.bucketSize,0,100,e.h),this.m=La(e.refillRate,0,this.o,e.h),this.$=La(e.refillInterval,0,864e5,e.h)}S(e,t){var n=t-e.lastAccess,s=Math.floor(n/this.$);if(s>0){var i=s*this.m;e.tokens=Math.min(e.tokens+i,this.o),e.lastAccess=e.lastAccess+s*this.$}}consumeRateLimit(e){var t,n=Date.now(),s=String(e),i=this.t[s];return i?this.S(i,n):(i={tokens:this.o,lastAccess:n},this.t[s]=i),i.tokens===0||(i.tokens--,i.tokens===0&&((t=this.i)==null||t.call(this,e)),i.tokens===0)}stop(){this.t={}}}var pi="Mobile",oy="iOS",Fl="Android",Pm="Tablet",UT=Fl+" "+Pm,zT="iPad",HT="Apple",BT=HT+" Watch",Fm="Safari",oh="BlackBerry",GT="Samsung",WT=GT+"Browser",VT=GT+" Internet",td="Chrome",I8=td+" OS",qT=td+" "+oy,Q_="Internet Explorer",KT=Q_+" "+pi,Z_="Opera",P8=Z_+" Mini",eE="Edge",YT="Microsoft "+eE,Jf="Firefox",JT=Jf+" "+oy,jm="Nintendo",Om="PlayStation",Xf="Xbox",XT=Fl+" "+pi,QT=pi+" "+Fm,sm="Windows",Kw=sm+" Phone",AC="Nokia",Yw="Ouya",ZT="Generic",F8=ZT+" "+pi.toLowerCase(),eR=ZT+" "+Pm.toLowerCase(),Jw="Konqueror",Js="(\\d+(\\.\\d+)?)",Ox=new RegExp("Version/"+Js),j8=new RegExp(Xf,"i"),O8=new RegExp(Om+" \\w+","i"),D8=new RegExp(jm+" \\w+","i"),tE=new RegExp(oh+"|PlayBook|BB10","i"),L8={"NT3.51":"NT 3.11","NT4.0":"NT 4.0","5.0":"2000",5.1:"XP",5.2:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1",6.4:"10","10.0":"10"},xv,IC,Dx,M8=(r,e)=>e&&ar(e,HT)||(function(t){return ar(t,Fm)&&!ar(t,td)&&!ar(t,Fl)})(r),tR=function(r,e){return e=e||"",ar(r," OPR/")&&ar(r,"Mini")?P8:ar(r," OPR/")?Z_:tE.test(r)?oh:ar(r,"IE"+pi)||ar(r,"WPDesktop")?KT:ar(r,WT)?VT:ar(r,eE)||ar(r,"Edg/")?YT:ar(r,"FBIOS")?"Facebook "+pi:ar(r,"UCWEB")||ar(r,"UCBrowser")?"UC Browser":ar(r,"CriOS")?qT:ar(r,"CrMo")||ar(r,td)?td:ar(r,Fl)&&ar(r,Fm)?XT:ar(r,"FxiOS")?JT:ar(r.toLowerCase(),Jw.toLowerCase())?Jw:M8(r,e)?ar(r,pi)?QT:Fm:ar(r,Jf)?Jf:ar(r,"MSIE")||ar(r,"Trident/")?Q_:ar(r,"Gecko")?Jf:""},$8={[KT]:[new RegExp("rv:"+Js)],[YT]:[new RegExp(eE+"?\\/"+Js)],[td]:[new RegExp("("+td+"|CrMo)\\/"+Js)],[qT]:[new RegExp("CriOS\\/"+Js)],"UC Browser":[new RegExp("(UCBrowser|UCWEB)\\/"+Js)],[Fm]:[Ox],[QT]:[Ox],[Z_]:[new RegExp("(Opera|OPR)\\/"+Js)],[Jf]:[new RegExp(Jf+"\\/"+Js)],[JT]:[new RegExp("FxiOS\\/"+Js)],[Jw]:[new RegExp("Konqueror[:/]?"+Js,"i")],[oh]:[new RegExp(oh+" "+Js),Ox],[XT]:[new RegExp("android\\s"+Js,"i")],[VT]:[new RegExp(WT+"\\/"+Js)],[Q_]:[new RegExp("(rv:|MSIE )"+Js)],Mozilla:[new RegExp("rv:"+Js)]},U8=function(r,e){var t=tR(r,e),n=$8[t];if(Ke(n))return null;for(var s=0;s<n.length;s++){var i=n[s],c=r.match(i);if(c)return parseFloat(c[c.length-2])}return null},PC=[[new RegExp(Xf+"; "+Xf+" (.*?)[);]","i"),r=>[Xf,r&&r[1]||""]],[new RegExp(jm,"i"),[jm,""]],[new RegExp(Om,"i"),[Om,""]],[tE,[oh,""]],[new RegExp(sm,"i"),(r,e)=>{if(/Phone/.test(e)||/WPDesktop/.test(e))return[Kw,""];if(new RegExp(pi).test(e)&&!/IEMobile\b/.test(e))return[sm+" "+pi,""];var t=/Windows NT ([0-9.]+)/i.exec(e);if(t&&t[1]){var n=t[1],s=L8[n]||"";return/arm/i.test(e)&&(s="RT"),[sm,s]}return[sm,""]}],[/((iPhone|iPad|iPod).*?OS (\d+)_(\d+)_?(\d+)?|iPhone)/,r=>{if(r&&r[3]){var e=[r[3],r[4],r[5]||"0"];return[oy,e.join(".")]}return[oy,""]}],[/(watch.*\/(\d+\.\d+\.\d+)|watch os,(\d+\.\d+),)/i,r=>{var e="";return r&&r.length>=3&&(e=Ke(r[2])?r[3]:r[2]),["watchOS",e]}],[new RegExp("("+Fl+" (\\d+)\\.(\\d+)\\.?(\\d+)?|"+Fl+")","i"),r=>{if(r&&r[2]){var e=[r[2],r[3],r[4]||"0"];return[Fl,e.join(".")]}return[Fl,""]}],[/Mac OS X (\d+)[_.](\d+)[_.]?(\d+)?/i,r=>{var e=["Mac OS X",""];if(r&&r[1]){var t=[r[1],r[2],r[3]||"0"];e[1]=t.join(".")}return e}],[/Mac/i,["Mac OS X",""]],[/CrOS/,[I8,""]],[/Linux|debian/i,["Linux",""]]],FC=function(r){return D8.test(r)?jm:O8.test(r)?Om:j8.test(r)?Xf:new RegExp(Yw,"i").test(r)?Yw:new RegExp("("+Kw+"|WPDesktop)","i").test(r)?Kw:/iPad/.test(r)?zT:/iPod/.test(r)?"iPod Touch":/iPhone/.test(r)?"iPhone":/(watch)(?: ?os[,/]|\d,\d\/)[\d.]+/i.test(r)?BT:tE.test(r)?oh:/(kobo)\s(ereader|touch)/i.test(r)?"Kobo":new RegExp(AC,"i").test(r)?AC:/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i.test(r)||/(kf[a-z]+)( bui|\)).+silk\//i.test(r)?"Kindle Fire":/(Android|ZTE)/i.test(r)?new RegExp(pi).test(r)&&!/(9138B|TB782B|Nexus [97]|pixel c|HUAWEISHT|BTV|noble nook|smart ultra 6)/i.test(r)||/pixel[\daxl ]{1,6}/i.test(r)&&!/pixel c/i.test(r)||/(huaweimed-al00|tah-|APA|SM-G92|i980|zte|U304AA)/i.test(r)||/lmy47v/i.test(r)&&!/QTAQZ3/i.test(r)?Fl:UT:new RegExp("(pda|"+pi+")","i").test(r)?F8:new RegExp(Pm,"i").test(r)&&!new RegExp(Pm+" pc","i").test(r)?eR:""},z8=r=>r instanceof Error;function H8(r){var e=globalThis._posthogChunkIds;if(e){var t=Object.keys(e);return Dx&&t.length===IC||(IC=t.length,Dx=t.reduce(((n,s)=>{xv||(xv={});var i=xv[s];if(i)n[i[0]]=i[1];else for(var c=r(s),u=c.length-1;u>=0;u--){var p=c[u],m=p==null?void 0:p.filename,g=e[s];if(m&&g){n[m]=g,xv[s]=[m,g];break}}return n}),{})),Dx}}class B8{constructor(e,t,n){n===void 0&&(n=[]),this.coercers=e,this.stackParser=t,this.modifiers=n}buildFromUnknown(e,t){t===void 0&&(t={});var n=t&&t.mechanism||{handled:!0,type:"generic"},s=this.buildCoercingContext(n,t,0).apply(e),i=this.buildParsingContext(t),c=this.parseStacktrace(s,i);return{$exception_list:this.convertToExceptionList(c,n),$exception_level:"error"}}modifyFrames(e){var t=this;return Gf((function*(){for(var n of e)n.stacktrace&&n.stacktrace.frames&&Fr(n.stacktrace.frames)&&(n.stacktrace.frames=yield t.applyModifiers(n.stacktrace.frames));return e}))()}coerceFallback(e){var t;return{type:"Error",value:"Unknown error",stack:(t=e.syntheticException)==null?void 0:t.stack,synthetic:!0}}parseStacktrace(e,t){var n,s;return e.cause!=null&&(n=this.parseStacktrace(e.cause,t)),e.stack!=""&&e.stack!=null&&(s=this.applyChunkIds(this.stackParser(e.stack,e.synthetic?t.skipFirstLines:0),t.chunkIdMap)),et({},e,{cause:n,stack:s})}applyChunkIds(e,t){return e.map((n=>(n.filename&&t&&(n.chunk_id=t[n.filename]),n)))}applyCoercers(e,t){for(var n of this.coercers)if(n.match(e))return n.coerce(e,t);return this.coerceFallback(t)}applyModifiers(e){var t=this;return Gf((function*(){var n=e;for(var s of t.modifiers)n=yield s(n);return n}))()}convertToExceptionList(e,t){var n,s,i,c={type:e.type,value:e.value,mechanism:{type:(n=t.type)!==null&&n!==void 0?n:"generic",handled:(s=t.handled)===null||s===void 0||s,synthetic:(i=e.synthetic)!==null&&i!==void 0&&i}};e.stack&&(c.stacktrace={type:"raw",frames:e.stack});var u=[c];return e.cause!=null&&u.push(...this.convertToExceptionList(e.cause,et({},t,{handled:!0}))),u}buildParsingContext(e){var t;return{chunkIdMap:H8(this.stackParser),skipFirstLines:(t=e.skipFirstLines)!==null&&t!==void 0?t:1}}buildCoercingContext(e,t,n){n===void 0&&(n=0);var s=(i,c)=>{if(c<=4){var u=this.buildCoercingContext(e,t,c);return this.applyCoercers(i,u)}};return et({},t,{syntheticException:n==0?t.syntheticException:void 0,mechanism:e,apply:i=>s(i,n),next:i=>s(i,n+1)})}}var ih="?";function Xw(r,e,t,n,s){var i={platform:r,filename:e,function:t==="<anonymous>"?ih:t,in_app:!0};return Ke(n)||(i.lineno=n),Ke(s)||(i.colno=s),i}var rR=(r,e)=>{var t=r.indexOf("safari-extension")!==-1,n=r.indexOf("safari-web-extension")!==-1;return t||n?[r.indexOf("@")!==-1?r.split("@")[0]:ih,t?"safari-extension:"+e:"safari-web-extension:"+e]:[r,e]},G8=/^\s*at (\S+?)(?::(\d+))(?::(\d+))\s*$/i,W8=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,V8=/\((\S*)(?::(\d+))(?::(\d+))\)/,q8=(r,e)=>{var t=G8.exec(r);if(t){var[,n,s,i]=t;return Xw(e,n,ih,+s,+i)}var c=W8.exec(r);if(c){if(c[2]&&c[2].indexOf("eval")===0){var u=V8.exec(c[2]);u&&(c[2]=u[1],c[3]=u[2],c[4]=u[3])}var[p,m]=rR(c[1]||ih,c[2]);return Xw(e,m,p,c[3]?+c[3]:void 0,c[4]?+c[4]:void 0)}},K8=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,Y8=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,J8=(r,e)=>{var t=K8.exec(r);if(t){if(t[3]&&t[3].indexOf(" > eval")>-1){var n=Y8.exec(t[3]);n&&(t[1]=t[1]||"eval",t[3]=n[1],t[4]=n[2],t[5]="")}var s=t[3],i=t[1]||ih;return[i,s]=rR(i,s),Xw(e,s,i,t[4]?+t[4]:void 0,t[5]?+t[5]:void 0)}},jC=/\(error: (.*)\)/,OC=50;function X8(){return(function(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return function(s,i){i===void 0&&(i=0);for(var c=[],u=s.split(`
`),p=i;p<u.length;p++){var m=u[p];if(!(m.length>1024)){var g=jC.test(m)?m.replace(jC,"$1"):m;if(!g.match(/\S*Error: /)){for(var x of t){var b=x(g,r);if(b){c.push(b);break}}if(c.length>=OC)break}}}return(function(E){if(!E.length)return[];var T=Array.from(E);return T.reverse(),T.slice(0,OC).map((S=>{return et({},S,{filename:S.filename||(N=T,N[N.length-1]||{}).filename,function:S.function||ih});var N}))})(c)}})("web:javascript",q8,J8)}class Q8{match(e){return this.isDOMException(e)||this.isDOMError(e)}coerce(e,t){var n=qn(e.stack);return{type:this.getType(e),value:this.getValue(e),stack:n?e.stack:void 0,cause:e.cause?t.next(e.cause):void 0,synthetic:!1}}getType(e){return this.isDOMError(e)?"DOMError":"DOMException"}getValue(e){var t=e.name||(this.isDOMError(e)?"DOMError":"DOMException");return e.message?t+": "+e.message:t}isDOMException(e){return sy(e,"DOMException")}isDOMError(e){return sy(e,"DOMError")}}class Z8{match(e){return(t=>t instanceof Error)(e)}coerce(e,t){return{type:this.getType(e),value:this.getMessage(e,t),stack:this.getStack(e),cause:e.cause?t.next(e.cause):void 0,synthetic:!1}}getType(e){return e.name||e.constructor.name}getMessage(e,t){var n=e.message;return n.error&&typeof n.error.message=="string"?String(n.error.message):String(n)}getStack(e){return e.stacktrace||e.stack||void 0}}class ez{constructor(){}match(e){return sy(e,"ErrorEvent")&&e.error!=null}coerce(e,t){var n,s=t.apply(e.error);return s||{type:"ErrorEvent",value:e.message,stack:(n=t.syntheticException)==null?void 0:n.stack,synthetic:!0}}}var tz=/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/i;class rz{match(e){return typeof e=="string"}coerce(e,t){var n,[s,i]=this.getInfos(e);return{type:s??"Error",value:i??e,stack:(n=t.syntheticException)==null?void 0:n.stack,synthetic:!0}}getInfos(e){var t="Error",n=e,s=e.match(tz);return s&&(t=s[1],n=s[2]),[t,n]}}var nz=["fatal","error","warning","log","info","debug"];function nR(r,e){e===void 0&&(e=40);var t=Object.keys(r);if(t.sort(),!t.length)return"[object has no keys]";for(var n=t.length;n>0;n--){var s=t.slice(0,n).join(", ");if(!(s.length>e))return n===t.length||s.length<=e?s:s.slice(0,e)+"..."}return""}class sz{match(e){return typeof e=="object"&&e!==null}coerce(e,t){var n,s=this.getErrorPropertyFromObject(e);return s?t.apply(s):{type:this.getType(e),value:this.getValue(e),stack:(n=t.syntheticException)==null?void 0:n.stack,level:this.isSeverityLevel(e.level)?e.level:"error",synthetic:!0}}getType(e){return $T(e)?e.constructor.name:"Error"}getValue(e){if("name"in e&&typeof e.name=="string"){var t="'"+e.name+"' captured as exception";return"message"in e&&typeof e.message=="string"&&(t+=" with message: '"+e.message+"'"),t}if("message"in e&&typeof e.message=="string")return e.message;var n=this.getObjectClassName(e);return(n&&n!=="Object"?"'"+n+"'":"Object")+" captured as exception with keys: "+nR(e)}isSeverityLevel(e){return qn(e)&&!Vw(e)&&nz.indexOf(e)>=0}getErrorPropertyFromObject(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var n=e[t];if(z8(n))return n}}getObjectClassName(e){try{var t=Object.getPrototypeOf(e);return t?t.constructor.name:void 0}catch{return}}}class oz{match(e){return $T(e)}coerce(e,t){var n,s=e.constructor.name;return{type:s,value:s+" captured as exception with keys: "+nR(e),stack:(n=t.syntheticException)==null?void 0:n.stack,synthetic:!0}}}class iz{match(e){return qw(e)}coerce(e,t){var n;return{type:"Error",value:"Primitive value captured as exception: "+String(e),stack:(n=t.syntheticException)==null?void 0:n.stack,synthetic:!0}}}class az{match(e){return sy(e,"PromiseRejectionEvent")}coerce(e,t){var n,s=this.getUnhandledRejectionReason(e);return qw(s)?{type:"UnhandledRejection",value:"Non-Error promise rejection captured with value: "+String(s),stack:(n=t.syntheticException)==null?void 0:n.stack,synthetic:!0}:t.apply(s)}getUnhandledRejectionReason(e){if(qw(e))return e;try{if("reason"in e)return e.reason;if("detail"in e&&"reason"in e.detail)return e.detail.reason}catch{}return e}}var sR=function(r,e){var{debugEnabled:t}=e===void 0?{}:e,n={k:function(s){if(be&&(Rl.DEBUG||Et.POSTHOG_DEBUG||t)&&!Ke(be.console)&&be.console){for(var i=("__rrweb_original__"in be.console[s])?be.console[s].__rrweb_original__:be.console[s],c=arguments.length,u=new Array(c>1?c-1:0),p=1;p<c;p++)u[p-1]=arguments[p];i(r,...u)}},info:function(){for(var s=arguments.length,i=new Array(s),c=0;c<s;c++)i[c]=arguments[c];n.k("log",...i)},warn:function(){for(var s=arguments.length,i=new Array(s),c=0;c<s;c++)i[c]=arguments[c];n.k("warn",...i)},error:function(){for(var s=arguments.length,i=new Array(s),c=0;c<s;c++)i[c]=arguments[c];n.k("error",...i)},critical:function(){for(var s=arguments.length,i=new Array(s),c=0;c<s;c++)i[c]=arguments[c];console.error(r,...i)},uninitializedWarning:s=>{n.error("You must initialize PostHog before calling "+s)},createLogger:(s,i)=>sR(r+" "+s,i)};return n},Qe=sR("[PostHog.js]"),bn=Qe.createLogger,lz=bn("[ExternalScriptsLoader]"),DC=(r,e,t)=>{if(r.config.disable_external_dependency_loading)return lz.warn(e+" was requested but loading of external scripts is disabled."),t("Loading of external scripts is disabled");var n=qe==null?void 0:qe.querySelectorAll("script");if(n){for(var s,i=function(){if(n[c].src===e){var p=n[c];return p.__posthog_loading_callback_fired?{v:t()}:(p.addEventListener("load",(m=>{p.__posthog_loading_callback_fired=!0,t(void 0,m)})),p.onerror=m=>t(m),{v:void 0})}},c=0;c<n.length;c++)if(s=i())return s.v}var u=()=>{if(!qe)return t("document not found");var p=qe.createElement("script");if(p.type="text/javascript",p.crossOrigin="anonymous",p.src=e,p.onload=x=>{p.__posthog_loading_callback_fired=!0,t(void 0,x)},p.onerror=x=>t(x),r.config.prepare_external_dependency_script&&(p=r.config.prepare_external_dependency_script(p)),!p)return t("prepare_external_dependency_script returned null");if(r.config.external_scripts_inject_target==="head")qe.head.appendChild(p);else{var m,g=qe.querySelectorAll("body > script");g.length>0?(m=g[0].parentNode)==null||m.insertBefore(p,g[0]):qe.body.appendChild(p)}};qe!=null&&qe.body?u():qe==null||qe.addEventListener("DOMContentLoaded",u)};Et.__PosthogExtensions__=Et.__PosthogExtensions__||{},Et.__PosthogExtensions__.loadExternalDependency=(r,e,t)=>{var n="/static/"+e+".js?v="+r.version;if(e==="remote-config"&&(n="/array/"+r.config.token+"/config.js"),e==="toolbar"){var s=3e5;n=n+"&t="+Math.floor(Date.now()/s)*s}var i=r.requestRouter.endpointFor("assets",n);DC(r,i,t)},Et.__PosthogExtensions__.loadSiteApp=(r,e,t)=>{var n=r.requestRouter.endpointFor("api",e);DC(r,n,t)};var iy={};function Uc(r,e,t){if(Fr(r)){if(CC&&r.forEach===CC)r.forEach(e,t);else if("length"in r&&r.length===+r.length){for(var n=0,s=r.length;n<s;n++)if(n in r&&e.call(t,r[n],n)===iy)return}}}function Xr(r,e,t){if(!cr(r)){if(Fr(r))return Uc(r,e,t);if(k8(r)){for(var n of r.entries())if(e.call(t,n[1],n[0])===iy)return}else for(var s in r)if(MT.call(r,s)&&e.call(t,r[s],s)===iy)return}}var Rn=function(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return Uc(t,(function(s){for(var i in s)s[i]!==void 0&&(r[i]=s[i])})),r},hh=function(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return Uc(t,(function(s){Uc(s,(function(i){r.push(i)}))})),r};function Gv(r){for(var e=Object.keys(r),t=e.length,n=new Array(t);t--;)n[t]=[e[t],r[e[t]]];return n}var LC=function(r){try{return r()}catch{return}},cz=function(r){return function(){try{for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.apply(this,t)}catch(s){Qe.critical("Implementation error. Please turn on debug mode and open a ticket on https://app.posthog.com/home#panel=support%3Asupport%3A."),Qe.critical(s)}}},rE=function(r){var e={};return Xr(r,(function(t,n){(qn(t)&&t.length>0||Ll(t))&&(e[n]=t)})),e};function uz(r,e){return t=r,n=i=>qn(i)&&!Xi(e)?i.slice(0,e):i,s=new Set,(function i(c,u){return c!==Object(c)?n?n(c,u):c:s.has(c)?void 0:(s.add(c),Fr(c)?(p=[],Uc(c,(m=>{p.push(i(m))}))):(p={},Xr(c,((m,g)=>{s.has(m)||(p[g]=i(m,g))}))),p);var p})(t);var t,n,s}var dz=["herokuapp.com","vercel.app","netlify.app"];function fz(r){var e=r==null?void 0:r.hostname;if(!qn(e))return!1;var t=e.split(".").slice(-2).join(".");for(var n of dz)if(t===n)return!1;return!0}function oR(r,e){for(var t=0;t<r.length;t++)if(e(r[t]))return r[t]}function Ln(r,e,t,n){var{capture:s=!1,passive:i=!0}=n??{};r==null||r.addEventListener(e,t,{capture:s,passive:i})}var iR="$people_distinct_id",om="__alias",im="__timers",MC="$autocapture_disabled_server_side",Qw="$heatmaps_enabled_server_side",$C="$exception_capture_enabled_server_side",Zw="$error_tracking_suppression_rules",UC="$error_tracking_capture_extension_exceptions",zC="$web_vitals_enabled_server_side",aR="$dead_clicks_enabled_server_side",HC="$product_tours_enabled_server_side",BC="$web_vitals_allowed_metrics",Lx="$session_recording_remote_config",ay="$sesid",lR="$session_is_sampled",Vf="$enabled_feature_flags",am="$early_access_features",eb="$feature_flag_details",lm="$stored_person_properties",Ku="$stored_group_properties",tb="$surveys",ly="$flag_call_reported",Al="$user_state",rb="$client_session_props",nb="$capture_rate_limit",sb="$initial_campaign_params",ob="$initial_referrer_info",cy="$initial_person_info",uy="$epp",cR="__POSTHOG_TOOLBAR__",Up="$posthog_cookieless",hz=[iR,om,"__cmpns",im,"$session_recording_enabled_server_side",Qw,ay,Vf,Zw,Al,am,eb,Ku,lm,tb,ly,rb,nb,sb,ob,uy,cy,"$conversations_widget_session_id","$conversations_ticket_id","$conversations_widget_state","$conversations_user_traits"];function GC(r){return r instanceof Element&&(r.id===cR||!(r.closest==null||!r.closest(".toolbar-global-fade-container")))}function Ky(r){return!!r&&r.nodeType===1}function zc(r,e){return!!r&&!!r.tagName&&r.tagName.toLowerCase()===e.toLowerCase()}function uR(r){return!!r&&r.nodeType===3}function dR(r){return!!r&&r.nodeType===11}function nE(r){return r?Vy(r).split(/\s+/):[]}function WC(r){var e=be==null?void 0:be.location.href;return!!(e&&r&&r.some((t=>e.match(t))))}function dy(r){var e="";switch(typeof r.className){case"string":e=r.className;break;case"object":e=(r.className&&"baseVal"in r.className?r.className.baseVal:null)||r.getAttribute("class")||"";break;default:e=""}return nE(e)}function fR(r){return cr(r)?null:Vy(r).split(/(\s+)/).filter((e=>Dm(e))).join("").replace(/[\r\n]/g," ").replace(/[ ]+/g," ").substring(0,255)}function qm(r){var e="";return ib(r)&&!vR(r)&&r.childNodes&&r.childNodes.length&&Xr(r.childNodes,(function(t){var n;uR(t)&&t.textContent&&(e+=(n=fR(t.textContent))!==null&&n!==void 0?n:"")})),Vy(e)}function hR(r){return Ke(r.target)?r.srcElement||null:(e=r.target)!=null&&e.shadowRoot?r.composedPath()[0]||null:r.target||null;var e}var sE=["a","button","form","input","select","textarea","label"];function pR(r,e){if(Ke(e))return!0;var t,n=function(i){if(e.some((c=>i.matches(c))))return{v:!0}};for(var s of r)if(t=n(s))return t.v;return!1}function mR(r){var e=r.parentNode;return!(!e||!Ky(e))&&e}var pz=["next","previous","prev",">","<"],VC=10,qC=[".ph-no-rageclick",".ph-no-capture"];function mz(r,e){if(!be||oE(r))return!1;var t,n,s;if(Ol(e)?(t=!!e&&qC,n=void 0):(t=(s=e==null?void 0:e.css_selector_ignorelist)!==null&&s!==void 0?s:qC,n=e==null?void 0:e.content_ignorelist),t===!1)return!1;var{targetElementList:i}=gR(r,!1);return!(function(c,u){if(c===!1||Ke(c))return!1;var p;if(c===!0)p=pz;else{if(!Fr(c))return!1;if(c.length>VC)return Qe.error("[PostHog] content_ignorelist array cannot exceed "+VC+" items. Use css_selector_ignorelist for more complex matching."),!1;p=c.map((m=>m.toLowerCase()))}return u.some((m=>{var{safeText:g,ariaLabel:x}=m;return p.some((b=>g.includes(b)||x.includes(b)))}))})(n,i.map((c=>{var u;return{safeText:qm(c).toLowerCase(),ariaLabel:((u=c.getAttribute("aria-label"))==null?void 0:u.toLowerCase().trim())||""}})))&&!pR(i,t)}var oE=r=>!r||zc(r,"html")||!Ky(r),gR=(r,e)=>{if(!be||oE(r))return{parentIsUsefulElement:!1,targetElementList:[]};for(var t=!1,n=[r],s=r;s.parentNode&&!zc(s,"body");)if(dR(s.parentNode))n.push(s.parentNode.host),s=s.parentNode.host;else{var i=mR(s);if(!i)break;if(e||sE.indexOf(i.tagName.toLowerCase())>-1)t=!0;else{var c=be.getComputedStyle(i);c&&c.getPropertyValue("cursor")==="pointer"&&(t=!0)}n.push(i),s=i}return{parentIsUsefulElement:t,targetElementList:n}};function gz(r,e,t,n,s){var i,c,u,p;if(t===void 0&&(t=void 0),!be||oE(r)||(i=t)!=null&&i.url_allowlist&&!WC(t.url_allowlist)||(c=t)!=null&&c.url_ignorelist&&WC(t.url_ignorelist))return!1;if((u=t)!=null&&u.dom_event_allowlist){var m=t.dom_event_allowlist;if(m&&!m.some((T=>e.type===T)))return!1}var{parentIsUsefulElement:g,targetElementList:x}=gR(r,n);if(!(function(T,S){var N=S==null?void 0:S.element_allowlist;if(Ke(N))return!0;var R,A=function(P){if(N.some((M=>P.tagName.toLowerCase()===M)))return{v:!0}};for(var j of T)if(R=A(j))return R.v;return!1})(x,t)||!pR(x,(p=t)==null?void 0:p.css_selector_allowlist))return!1;var b=be.getComputedStyle(r);if(b&&b.getPropertyValue("cursor")==="pointer"&&e.type==="click")return!0;var E=r.tagName.toLowerCase();switch(E){case"html":return!1;case"form":return(s||["submit"]).indexOf(e.type)>=0;case"input":case"select":case"textarea":return(s||["change","click"]).indexOf(e.type)>=0;default:return g?(s||["click"]).indexOf(e.type)>=0:(s||["click"]).indexOf(e.type)>=0&&(sE.indexOf(E)>-1||r.getAttribute("contenteditable")==="true")}}function ib(r){for(var e=r;e.parentNode&&!zc(e,"body");e=e.parentNode){var t=dy(e);if(ar(t,"ph-sensitive")||ar(t,"ph-no-capture"))return!1}if(ar(dy(r),"ph-include"))return!0;var n=r.type||"";if(qn(n))switch(n.toLowerCase()){case"hidden":case"password":return!1}var s=r.name||r.id||"";return!(qn(s)&&/^cc|cardnum|ccnum|creditcard|csc|cvc|cvv|exp|pass|pwd|routing|seccode|securitycode|securitynum|socialsec|socsec|ssn/i.test(s.replace(/[^a-zA-Z0-9]/g,"")))}function vR(r){return!!(zc(r,"input")&&!["button","checkbox","submit","reset"].includes(r.type)||zc(r,"select")||zc(r,"textarea")||r.getAttribute("contenteditable")==="true")}var yR="(4[0-9]{12}(?:[0-9]{3})?)|(5[1-5][0-9]{14})|(6(?:011|5[0-9]{2})[0-9]{12})|(3[47][0-9]{13})|(3(?:0[0-5]|[68][0-9])[0-9]{11})|((?:2131|1800|35[0-9]{3})[0-9]{11})",vz=new RegExp("^(?:"+yR+")$"),yz=new RegExp(yR),xR="\\d{3}-?\\d{2}-?\\d{4}",xz=new RegExp("^("+xR+")$"),wz=new RegExp("("+xR+")");function Dm(r,e){return e===void 0&&(e=!0),!(cr(r)||qn(r)&&(r=Vy(r),(e?vz:yz).test((r||"").replace(/[- ]/g,""))||(e?xz:wz).test(r)))}function wR(r){var e=qm(r);return Dm(e=(e+" "+bR(r)).trim())?e:""}function bR(r){var e="";return r&&r.childNodes&&r.childNodes.length&&Xr(r.childNodes,(function(t){var n;if(t&&((n=t.tagName)==null?void 0:n.toLowerCase())==="span")try{var s=qm(t);e=(e+" "+s).trim(),t.childNodes&&t.childNodes.length&&(e=(e+" "+bR(t)).trim())}catch(i){Qe.error("[AutoCapture]",i)}})),e}function bz(r){return(function(e){var t=e.map((n=>{var s,i,c="";if(n.tag_name&&(c+=n.tag_name),n.attr_class)for(var u of(n.attr_class.sort(),n.attr_class))c+="."+u.replace(/"/g,"");var p=et({},n.text?{text:n.text}:{},{"nth-child":(s=n.nth_child)!==null&&s!==void 0?s:0,"nth-of-type":(i=n.nth_of_type)!==null&&i!==void 0?i:0},n.href?{href:n.href}:{},n.attr_id?{attr_id:n.attr_id}:{},n.attributes),m={};return Gv(p).sort(((g,x)=>{var[b]=g,[E]=x;return b.localeCompare(E)})).forEach((g=>{var[x,b]=g;return m[KC(x.toString())]=KC(b.toString())})),c+=":",c+=Gv(m).map((g=>{var[x,b]=g;return x+'="'+b+'"'})).join("")}));return t.join(";")})((function(e){return e.map((t=>{var n,s,i={text:(n=t.$el_text)==null?void 0:n.slice(0,400),tag_name:t.tag_name,href:(s=t.attr__href)==null?void 0:s.slice(0,2048),attr_class:_z(t),attr_id:t.attr__id,nth_child:t.nth_child,nth_of_type:t.nth_of_type,attributes:{}};return Gv(t).filter((c=>{var[u]=c;return u.indexOf("attr__")===0})).forEach((c=>{var[u,p]=c;return i.attributes[u]=p})),i}))})(r))}function KC(r){return r.replace(/"|\\"/g,'\\"')}function _z(r){var e=r.attr__class;return e?Fr(e)?e:nE(e):void 0}class _R{constructor(e){this.disabled=e===!1;var t=Vn(e)?e:{};this.thresholdPx=t.threshold_px||30,this.timeoutMs=t.timeout_ms||1e3,this.clickCount=t.click_count||3,this.clicks=[]}isRageClick(e,t,n){if(this.disabled)return!1;var s=this.clicks[this.clicks.length-1];if(s&&Math.abs(e-s.x)+Math.abs(t-s.y)<this.thresholdPx&&n-s.timestamp<this.timeoutMs){if(this.clicks.push({x:e,y:t,timestamp:n}),this.clicks.length===this.clickCount)return!0}else this.clicks=[{x:e,y:t,timestamp:n}];return!1}}var fy=r=>{var e=qe==null?void 0:qe.createElement("a");return Ke(e)?null:(e.href=r,e)},Ez=function(r,e){var t,n;e===void 0&&(e="&");var s=[];return Xr(r,(function(i,c){Ke(i)||Ke(c)||c==="undefined"||(t=encodeURIComponent((u=>u instanceof File)(i)?i.name:i.toString()),n=encodeURIComponent(c),s[s.length]=n+"="+t)})),s.join(e)},hy=function(r,e){for(var t,n=((r.split("#")[0]||"").split(/\?(.*)/)[1]||"").replace(/^\?+/g,"").split("&"),s=0;s<n.length;s++){var i=n[s].split("=");if(i[0]===e){t=i;break}}if(!Fr(t)||t.length<2)return"";var c=t[1];try{c=decodeURIComponent(c)}catch{Qe.error("Skipping decoding for malformed query param: "+c)}return c.replace(/\+/g," ")},Km=function(r,e,t){if(!r||!e||!e.length)return r;for(var n=r.split("#"),s=n[0]||"",i=n[1],c=s.split("?"),u=c[1],p=c[0],m=(u||"").split("&"),g=[],x=0;x<m.length;x++){var b=m[x].split("=");Fr(b)&&(e.includes(b[0])?g.push(b[0]+"="+t):g.push(m[x]))}var E=p;return u!=null&&(E+="?"+g.join("&")),i!=null&&(E+="#"+i),E},py=function(r,e){var t=r.match(new RegExp(e+"=([^&]*)"));return t?t[1]:null},Mx="$copy_autocapture",YC=bn("[AutoCapture]");function $x(r,e){return e.length>r?e.slice(0,r)+"...":e}function Sz(r){if(r.previousElementSibling)return r.previousElementSibling;var e=r;do e=e.previousSibling;while(e&&!Ky(e));return e}function Cz(r,e,t,n){var s=r.tagName.toLowerCase(),i={tag_name:s};sE.indexOf(s)>-1&&!t&&(s.toLowerCase()==="a"||s.toLowerCase()==="button"?i.$el_text=$x(1024,wR(r)):i.$el_text=$x(1024,qm(r)));var c=dy(r);c.length>0&&(i.classes=c.filter((function(g){return g!==""}))),Xr(r.attributes,(function(g){var x;if((!vR(r)||["name","id","class","aria-label"].indexOf(g.name)!==-1)&&(n==null||!n.includes(g.name))&&!e&&Dm(g.value)&&(x=g.name,!qn(x)||x.substring(0,10)!=="_ngcontent"&&x.substring(0,7)!=="_nghost")){var b=g.value;g.name==="class"&&(b=nE(b).join(" ")),i["attr__"+g.name]=$x(1024,b)}}));for(var u=1,p=1,m=r;m=Sz(m);)u++,m.tagName===r.tagName&&p++;return i.nth_child=u,i.nth_of_type=p,i}function kz(r,e){for(var t,n,{e:s,maskAllElementAttributes:i,maskAllText:c,elementAttributeIgnoreList:u,elementsChainAsString:p}=e,m=[r],g=r;g.parentNode&&!zc(g,"body");)dR(g.parentNode)?(m.push(g.parentNode.host),g=g.parentNode.host):(m.push(g.parentNode),g=g.parentNode);var x,b=[],E={},T=!1,S=!1;if(Xr(m,(P=>{var M=ib(P);P.tagName.toLowerCase()==="a"&&(T=P.getAttribute("href"),T=M&&T&&Dm(T)&&T),ar(dy(P),"ph-no-capture")&&(S=!0),b.push(Cz(P,i,c,u));var B=(function(U){if(!ib(U))return{};var V={};return Xr(U.attributes,(function(Y){if(Y.name&&Y.name.indexOf("data-ph-capture-attribute")===0){var ce=Y.name.replace("data-ph-capture-attribute-",""),X=Y.value;ce&&X&&Dm(X)&&(V[ce]=X)}})),V})(P);Rn(E,B)})),S)return{props:{},explicitNoCapture:S};if(c||(r.tagName.toLowerCase()==="a"||r.tagName.toLowerCase()==="button"?b[0].$el_text=wR(r):b[0].$el_text=qm(r)),T){var N,R;b[0].attr__href=T;var A=(N=fy(T))==null?void 0:N.host,j=be==null||(R=be.location)==null?void 0:R.host;A&&j&&A!==j&&(x=T)}return{props:Rn({$event_type:s.type,$ce_version:1},p?{}:{$elements:b},{$elements_chain:bz(b)},(t=b[0])!=null&&t.$el_text?{$el_text:(n=b[0])==null?void 0:n.$el_text}:{},x&&s.type==="click"?{$external_click_url:x}:{},E)}}class Nz{constructor(e){this.P=!1,this.T=null,this.I=!1,this.instance=e,this.rageclicks=new _R(e.config.rageclick),this.C=null}get R(){var e,t,n=Vn(this.instance.config.autocapture)?this.instance.config.autocapture:{};return n.url_allowlist=(e=n.url_allowlist)==null?void 0:e.map((s=>new RegExp(s))),n.url_ignorelist=(t=n.url_ignorelist)==null?void 0:t.map((s=>new RegExp(s))),n}F(){if(this.isBrowserSupported()){if(be&&qe){var e=n=>{n=n||(be==null?void 0:be.event);try{this.O(n)}catch(s){YC.error("Failed to capture event",s)}};if(Ln(qe,"submit",e,{capture:!0}),Ln(qe,"change",e,{capture:!0}),Ln(qe,"click",e,{capture:!0}),this.R.capture_copied_text){var t=n=>{n=n||(be==null?void 0:be.event),this.O(n,Mx)};Ln(qe,"copy",t,{capture:!0}),Ln(qe,"cut",t,{capture:!0})}}}else YC.info("Disabling Automatic Event Collection because this browser is not supported")}startIfEnabled(){this.isEnabled&&!this.P&&(this.F(),this.P=!0)}onRemoteConfig(e){e.elementsChainAsString&&(this.I=e.elementsChainAsString),this.instance.persistence&&this.instance.persistence.register({[MC]:!!e.autocapture_opt_out}),this.T=!!e.autocapture_opt_out,this.startIfEnabled()}setElementSelectors(e){this.C=e}getElementSelectors(e){var t,n=[];return(t=this.C)==null||t.forEach((s=>{var i=qe==null?void 0:qe.querySelectorAll(s);i==null||i.forEach((c=>{e===c&&n.push(s)}))})),n}get isEnabled(){var e,t,n=(e=this.instance.persistence)==null?void 0:e.props[MC],s=this.T;if(Xi(s)&&!Ol(n)&&!this.instance.M())return!1;var i=(t=this.T)!==null&&t!==void 0?t:!!n;return!!this.instance.config.autocapture&&!i}O(e,t){if(t===void 0&&(t="$autocapture"),this.isEnabled){var n,s=hR(e);uR(s)&&(s=s.parentNode||null),t==="$autocapture"&&e.type==="click"&&e instanceof MouseEvent&&this.instance.config.rageclick&&(n=this.rageclicks)!=null&&n.isRageClick(e.clientX,e.clientY,e.timeStamp||new Date().getTime())&&mz(s,this.instance.config.rageclick)&&this.O(e,"$rageclick");var i=t===Mx;if(s&&gz(s,e,this.R,i,i?["copy","cut"]:void 0)){var{props:c,explicitNoCapture:u}=kz(s,{e,maskAllElementAttributes:this.instance.config.mask_all_element_attributes,maskAllText:this.instance.config.mask_all_text,elementAttributeIgnoreList:this.R.element_attribute_ignorelist,elementsChainAsString:this.I});if(u)return!1;var p=this.getElementSelectors(s);if(p&&p.length>0&&(c.$element_selectors=p),t===Mx){var m,g=fR(be==null||(m=be.getSelection())==null?void 0:m.toString()),x=e.type||"clipboard";if(!g)return!1;c.$selected_content=g,c.$copy_type=x}return this.instance.capture(t,c),!0}}}isBrowserSupported(){return $c(qe==null?void 0:qe.querySelectorAll)}}Math.trunc||(Math.trunc=function(r){return r<0?Math.ceil(r):Math.floor(r)}),Number.isInteger||(Number.isInteger=function(r){return Ll(r)&&isFinite(r)&&Math.floor(r)===r});var JC="0123456789abcdef";class my{constructor(e){if(this.bytes=e,e.length!==16)throw new TypeError("not 128-bit length")}static fromFieldsV7(e,t,n,s){if(!Number.isInteger(e)||!Number.isInteger(t)||!Number.isInteger(n)||!Number.isInteger(s)||e<0||t<0||n<0||s<0||e>0xffffffffffff||t>4095||n>1073741823||s>4294967295)throw new RangeError("invalid field value");var i=new Uint8Array(16);return i[0]=e/Math.pow(2,40),i[1]=e/Math.pow(2,32),i[2]=e/Math.pow(2,24),i[3]=e/Math.pow(2,16),i[4]=e/Math.pow(2,8),i[5]=e,i[6]=112|t>>>8,i[7]=t,i[8]=128|n>>>24,i[9]=n>>>16,i[10]=n>>>8,i[11]=n,i[12]=s>>>24,i[13]=s>>>16,i[14]=s>>>8,i[15]=s,new my(i)}toString(){for(var e="",t=0;t<this.bytes.length;t++)e=e+JC.charAt(this.bytes[t]>>>4)+JC.charAt(15&this.bytes[t]),t!==3&&t!==5&&t!==7&&t!==9||(e+="-");if(e.length!==36)throw new Error("Invalid UUIDv7 was generated");return e}clone(){return new my(this.bytes.slice(0))}equals(e){return this.compareTo(e)===0}compareTo(e){for(var t=0;t<16;t++){var n=this.bytes[t]-e.bytes[t];if(n!==0)return Math.sign(n)}return 0}}class Tz{constructor(){this.A=0,this.j=0,this.D=new Rz}generate(){var e=this.generateOrAbort();if(Ke(e)){this.A=0;var t=this.generateOrAbort();if(Ke(t))throw new Error("Could not generate UUID after timestamp reset");return t}return e}generateOrAbort(){var e=Date.now();if(e>this.A)this.A=e,this.L();else{if(!(e+1e4>this.A))return;this.j++,this.j>4398046511103&&(this.A++,this.L())}return my.fromFieldsV7(this.A,Math.trunc(this.j/Math.pow(2,30)),this.j&Math.pow(2,30)-1,this.D.nextUint32())}L(){this.j=1024*this.D.nextUint32()+(1023&this.D.nextUint32())}}var XC,ER=r=>{if(typeof UUIDV7_DENY_WEAK_RNG<"u"&&UUIDV7_DENY_WEAK_RNG)throw new Error("no cryptographically strong RNG available");for(var e=0;e<r.length;e++)r[e]=65536*Math.trunc(65536*Math.random())+Math.trunc(65536*Math.random());return r};be&&!Ke(be.crypto)&&crypto.getRandomValues&&(ER=r=>crypto.getRandomValues(r));class Rz{constructor(){this.N=new Uint32Array(8),this.U=1/0}nextUint32(){return this.U>=this.N.length&&(ER(this.N),this.U=0),this.N[this.U++]}}var Lc=()=>Az().toString(),Az=()=>(XC||(XC=new Tz)).generate(),zp="",Iz=/[a-z0-9][a-z0-9-]+\.[a-z]{2,}$/i;function Pz(r,e){if(e){var t=(function(s,i){if(i===void 0&&(i=qe),zp)return zp;if(!i||["localhost","127.0.0.1"].includes(s))return"";for(var c=s.split("."),u=Math.min(c.length,8),p="dmn_chk_"+Lc();!zp&&u--;){var m=c.slice(u).join("."),g=p+"=1;domain=."+m+";path=/";i.cookie=g+";max-age=3",i.cookie.includes(p)&&(i.cookie=g+";max-age=0",zp=m)}return zp})(r);if(!t){var n=(s=>{var i=s.match(Iz);return i?i[0]:""})(r);n!==t&&Qe.info("Warning: cookie subdomain discovery mismatch",n,t),t=n}return t?"; domain=."+t:""}return""}var ja={H:()=>!!qe,B:function(r){Qe.error("cookieStore error: "+r)},q:function(r){if(qe){try{for(var e=r+"=",t=qe.cookie.split(";").filter((i=>i.length)),n=0;n<t.length;n++){for(var s=t[n];s.charAt(0)==" ";)s=s.substring(1,s.length);if(s.indexOf(e)===0)return decodeURIComponent(s.substring(e.length,s.length))}}catch{}return null}},W:function(r){var e;try{e=JSON.parse(ja.q(r))||{}}catch{}return e},G:function(r,e,t,n,s){if(qe)try{var i="",c="",u=Pz(qe.location.hostname,n);if(t){var p=new Date;p.setTime(p.getTime()+24*t*60*60*1e3),i="; expires="+p.toUTCString()}s&&(c="; secure");var m=r+"="+encodeURIComponent(JSON.stringify(e))+i+"; SameSite=Lax; path=/"+u+c;return m.length>3686.4&&Qe.warn("cookieStore warning: large cookie, len="+m.length),qe.cookie=m,m}catch{return}},V:function(r,e){if(qe!=null&&qe.cookie)try{ja.G(r,"",-1,e)}catch{return}}},Ux=null,pn={H:function(){if(!Xi(Ux))return Ux;var r=!0;if(Ke(be))r=!1;else try{var e="__mplssupport__";pn.G(e,"xyz"),pn.q(e)!=='"xyz"'&&(r=!1),pn.V(e)}catch{r=!1}return r||Qe.error("localStorage unsupported; falling back to cookie store"),Ux=r,r},B:function(r){Qe.error("localStorage error: "+r)},q:function(r){try{return be==null?void 0:be.localStorage.getItem(r)}catch(e){pn.B(e)}return null},W:function(r){try{return JSON.parse(pn.q(r))||{}}catch{}return null},G:function(r,e){try{be==null||be.localStorage.setItem(r,JSON.stringify(e))}catch(t){pn.B(t)}},V:function(r){try{be==null||be.localStorage.removeItem(r)}catch(e){pn.B(e)}}},Fz=["$device_id","distinct_id",ay,lR,uy,cy],wv={},jz={H:function(){return!0},B:function(r){Qe.error("memoryStorage error: "+r)},q:function(r){return wv[r]||null},W:function(r){return wv[r]||null},G:function(r,e){wv[r]=e},V:function(r){delete wv[r]}},Bu=null,vs={H:function(){if(!Xi(Bu))return Bu;if(Bu=!0,Ke(be))Bu=!1;else try{var r="__support__";vs.G(r,"xyz"),vs.q(r)!=='"xyz"'&&(Bu=!1),vs.V(r)}catch{Bu=!1}return Bu},B:function(r){Qe.error("sessionStorage error: ",r)},q:function(r){try{return be==null?void 0:be.sessionStorage.getItem(r)}catch(e){vs.B(e)}return null},W:function(r){try{return JSON.parse(vs.q(r))||null}catch{}return null},G:function(r,e){try{be==null||be.sessionStorage.setItem(r,JSON.stringify(e))}catch(t){vs.B(t)}},V:function(r){try{be==null||be.sessionStorage.removeItem(r)}catch(e){vs.B(e)}}},Il=(function(r){return r[r.PENDING=-1]="PENDING",r[r.DENIED=0]="DENIED",r[r.GRANTED=1]="GRANTED",r})({});class Oz{constructor(e){this._instance=e}get R(){return this._instance.config}get consent(){return this.J()?Il.DENIED:this.K}isOptedOut(){return this.R.cookieless_mode==="always"||this.consent===Il.DENIED||this.consent===Il.PENDING&&(this.R.opt_out_capturing_by_default||this.R.cookieless_mode==="on_reject")}isOptedIn(){return!this.isOptedOut()}isExplicitlyOptedOut(){return this.consent===Il.DENIED}optInOut(e){this.Y.G(this.X,e?1:0,this.R.cookie_expiration,this.R.cross_subdomain_cookie,this.R.secure_cookie)}reset(){this.Y.V(this.X,this.R.cross_subdomain_cookie)}get X(){var{token:e,opt_out_capturing_cookie_prefix:t,consent_persistence_name:n}=this._instance.config;return n||(t?t+e:"__ph_opt_in_out_"+e)}get K(){var e=this.Y.q(this.X);return jx(e)?Il.GRANTED:ar(R8,e)?Il.DENIED:Il.PENDING}get Y(){if(!this.Z){var e=this.R.opt_out_capturing_persistence_type;this.Z=e==="localStorage"?pn:ja;var t=e==="localStorage"?ja:pn;t.q(this.X)&&(this.Z.q(this.X)||this.optInOut(jx(t.q(this.X))),t.V(this.X,this.R.cross_subdomain_cookie))}return this.Z}J(){return!!this.R.respect_dnt&&!!oR([Go==null?void 0:Go.doNotTrack,Go==null?void 0:Go.msDoNotTrack,Et.doNotTrack],(e=>jx(e)))}}var bv=bn("[Dead Clicks]"),Dz=()=>!0,Lz=r=>{var e,t=!((e=r.instance.persistence)==null||!e.get_property(aR)),n=r.instance.config.capture_dead_clicks;return Ol(n)?n:!!Vn(n)||t};class SR{get lazyLoadedDeadClicksAutocapture(){return this.tt}constructor(e,t,n){this.instance=e,this.isEnabled=t,this.onCapture=n,this.startIfEnabled()}onRemoteConfig(e){this.instance.persistence&&this.instance.persistence.register({[aR]:e==null?void 0:e.captureDeadClicks}),this.startIfEnabled()}startIfEnabled(){this.isEnabled(this)&&this.it((()=>{this.et()}))}it(e){var t,n;(t=Et.__PosthogExtensions__)!=null&&t.initDeadClicksAutocapture&&e(),(n=Et.__PosthogExtensions__)==null||n.loadExternalDependency==null||n.loadExternalDependency(this.instance,"dead-clicks-autocapture",(s=>{s?bv.error("failed to load script",s):e()}))}et(){var e;if(qe){if(!this.tt&&(e=Et.__PosthogExtensions__)!=null&&e.initDeadClicksAutocapture){var t=Vn(this.instance.config.capture_dead_clicks)?this.instance.config.capture_dead_clicks:{};t.__onCapture=this.onCapture,this.tt=Et.__PosthogExtensions__.initDeadClicksAutocapture(this.instance,t),this.tt.start(qe),bv.info("starting...")}}else bv.error("`document` not found. Cannot start.")}stop(){this.tt&&(this.tt.stop(),this.tt=void 0,bv.info("stopping..."))}}var Hp=bn("[ExceptionAutocapture]");class Mz{constructor(e){var t,n,s;this.rt=()=>{var i;if(be&&this.isEnabled&&(i=Et.__PosthogExtensions__)!=null&&i.errorWrappingFunctions){var c=Et.__PosthogExtensions__.errorWrappingFunctions.wrapOnError,u=Et.__PosthogExtensions__.errorWrappingFunctions.wrapUnhandledRejection,p=Et.__PosthogExtensions__.errorWrappingFunctions.wrapConsoleError;try{!this.st&&this.R.capture_unhandled_errors&&(this.st=c(this.captureException.bind(this))),!this.nt&&this.R.capture_unhandled_rejections&&(this.nt=u(this.captureException.bind(this))),!this.ot&&this.R.capture_console_errors&&(this.ot=p(this.captureException.bind(this)))}catch(m){Hp.error("failed to start",m),this.ut()}}},this._instance=e,this.ht=!((t=this._instance.persistence)==null||!t.props[$C]),this.dt=new A8({refillRate:(n=this._instance.config.error_tracking.__exceptionRateLimiterRefillRate)!==null&&n!==void 0?n:1,bucketSize:(s=this._instance.config.error_tracking.__exceptionRateLimiterBucketSize)!==null&&s!==void 0?s:10,refillInterval:1e4,h:Hp}),this.R=this.vt(),this.startIfEnabledOrStop()}vt(){var e=this._instance.config.capture_exceptions,t={capture_unhandled_errors:!1,capture_unhandled_rejections:!1,capture_console_errors:!1};return Vn(e)?t=et({},t,e):(Ke(e)?this.ht:e)&&(t=et({},t,{capture_unhandled_errors:!0,capture_unhandled_rejections:!0})),t}get isEnabled(){return this.R.capture_console_errors||this.R.capture_unhandled_errors||this.R.capture_unhandled_rejections}startIfEnabledOrStop(){this.isEnabled?(Hp.info("enabled"),this.ut(),this.it(this.rt)):this.ut()}it(e){var t,n;(t=Et.__PosthogExtensions__)!=null&&t.errorWrappingFunctions&&e(),(n=Et.__PosthogExtensions__)==null||n.loadExternalDependency==null||n.loadExternalDependency(this._instance,"exception-autocapture",(s=>{if(s)return Hp.error("failed to load script",s);e()}))}ut(){var e,t,n;(e=this.st)==null||e.call(this),this.st=void 0,(t=this.nt)==null||t.call(this),this.nt=void 0,(n=this.ot)==null||n.call(this),this.ot=void 0}onRemoteConfig(e){var t=e.autocaptureExceptions;this.ht=!!t||!1,this._instance.persistence&&this._instance.persistence.register({[$C]:this.ht}),this.R=this.vt(),this.startIfEnabledOrStop()}onConfigChange(){this.R=this.vt()}captureException(e){var t,n,s=(t=e==null||(n=e.$exception_list)==null||(n=n[0])==null?void 0:n.type)!==null&&t!==void 0?t:"Exception";this.dt.consumeRateLimit(s)?Hp.info("Skipping exception capture because of client rate limiting.",{exception:s}):this._instance.exceptions.sendExceptionEvent(e)}}function QC(r,e,t){try{if(!(e in r))return()=>{};var n=r[e],s=t(n);return $c(s)&&(s.prototype=s.prototype||{},Object.defineProperties(s,{__posthog_wrapped__:{enumerable:!1,value:!0}})),r[e]=s,()=>{r[e]=n}}catch{return()=>{}}}class $z{constructor(e){var t;this._instance=e,this.ct=(be==null||(t=be.location)==null?void 0:t.pathname)||""}get isEnabled(){return this._instance.config.capture_pageview==="history_change"}startIfEnabled(){this.isEnabled&&(Qe.info("History API monitoring enabled, starting..."),this.monitorHistoryChanges())}stop(){this.ft&&this.ft(),this.ft=void 0,Qe.info("History API monitoring stopped")}monitorHistoryChanges(){var e,t;if(be&&be.history){var n=this;(e=be.history.pushState)!=null&&e.__posthog_wrapped__||QC(be.history,"pushState",(s=>function(i,c,u){s.call(this,i,c,u),n._t("pushState")})),(t=be.history.replaceState)!=null&&t.__posthog_wrapped__||QC(be.history,"replaceState",(s=>function(i,c,u){s.call(this,i,c,u),n._t("replaceState")})),this.bt()}}_t(e){try{var t,n=be==null||(t=be.location)==null?void 0:t.pathname;if(!n)return;n!==this.ct&&this.isEnabled&&this._instance.capture("$pageview",{navigation_type:e}),this.ct=n}catch(s){Qe.error("Error capturing "+e+" pageview",s)}}bt(){if(!this.ft){var e=()=>{this._t("popstate")};Ln(be,"popstate",e),this.ft=()=>{be&&be.removeEventListener("popstate",e)}}}}var zx=bn("[SegmentIntegration]");function Uz(r,e){var t=r.config.segment;if(!t)return e();(function(n,s){var i=n.config.segment;if(!i)return s();var c=p=>{var m=()=>p.anonymousId()||Lc();n.config.get_device_id=m,p.id()&&(n.register({distinct_id:p.id(),$device_id:m()}),n.persistence.set_property(Al,"identified")),s()},u=i.user();"then"in u&&$c(u.then)?u.then(c):c(u)})(r,(()=>{t.register((n=>{Promise&&Promise.resolve||zx.warn("This browser does not have Promise support, and can not use the segment integration");var s=(i,c)=>{if(!c)return i;i.event.userId||i.event.anonymousId===n.get_distinct_id()||(zx.info("No userId set, resetting PostHog"),n.reset()),i.event.userId&&i.event.userId!==n.get_distinct_id()&&(zx.info("UserId set, identifying with PostHog"),n.identify(i.event.userId));var u=n.calculateEventProperties(c,i.event.properties);return i.event.properties=Object.assign({},u,i.event.properties),i};return{name:"PostHog JS",type:"enrichment",version:"1.0.0",isLoaded:()=>!0,load:()=>Promise.resolve(),track:i=>s(i,i.event.event),page:i=>s(i,"$pageview"),identify:i=>s(i,"$identify"),screen:i=>s(i,"$screen")}})(r)).then((()=>{e()}))}))}var CR="posthog-js";function kR(r,e){var{organization:t,projectId:n,prefix:s,severityAllowList:i=["error"],sendExceptionsToPostHog:c=!0}=e===void 0?{}:e;return u=>{var p,m,g,x,b;if(!(i==="*"||i.includes(u.level))||!r.__loaded)return u;u.tags||(u.tags={});var E=r.requestRouter.endpointFor("ui","/project/"+r.config.token+"/person/"+r.get_distinct_id());u.tags["PostHog Person URL"]=E,r.sessionRecordingStarted()&&(u.tags["PostHog Recording URL"]=r.get_session_replay_url({withTimestamp:!0}));var T=((p=u.exception)==null?void 0:p.values)||[],S=T.map((R=>et({},R,{stacktrace:R.stacktrace?et({},R.stacktrace,{type:"raw",frames:(R.stacktrace.frames||[]).map((A=>et({},A,{platform:"web:javascript"})))}):void 0}))),N={$exception_message:((m=T[0])==null?void 0:m.value)||u.message,$exception_type:(g=T[0])==null?void 0:g.type,$exception_level:u.level,$exception_list:S,$sentry_event_id:u.event_id,$sentry_exception:u.exception,$sentry_exception_message:((x=T[0])==null?void 0:x.value)||u.message,$sentry_exception_type:(b=T[0])==null?void 0:b.type,$sentry_tags:u.tags};return t&&n&&(N.$sentry_url=(s||"https://sentry.io/organizations/")+t+"/issues/?project="+n+"&query="+u.event_id),c&&r.exceptions.sendExceptionEvent(N),u}}class zz{constructor(e,t,n,s,i,c){this.name=CR,this.setupOnce=function(u){u(kR(e,{organization:t,projectId:n,prefix:s,severityAllowList:i,sendExceptionsToPostHog:c==null||c}))}}}var Hz=be!=null&&be.location?py(be.location.hash,"__posthog")||py(location.hash,"state"):null,ZC="_postHogToolbarParams",ek=bn("[Toolbar]"),Pc=(function(r){return r[r.UNINITIALIZED=0]="UNINITIALIZED",r[r.LOADING=1]="LOADING",r[r.LOADED=2]="LOADED",r})(Pc||{});class Bz{constructor(e){this.instance=e}yt(e){Et.ph_toolbar_state=e}wt(){var e;return(e=Et.ph_toolbar_state)!==null&&e!==void 0?e:Pc.UNINITIALIZED}maybeLoadToolbar(e,t,n){if(e===void 0&&(e=void 0),t===void 0&&(t=void 0),n===void 0&&(n=void 0),!be||!qe)return!1;e=e??be.location,n=n??be.history;try{if(!t){try{be.localStorage.setItem("test","test"),be.localStorage.removeItem("test")}catch{return!1}t=be==null?void 0:be.localStorage}var s,i=Hz||py(e.hash,"__posthog")||py(e.hash,"state"),c=i?LC((()=>JSON.parse(atob(decodeURIComponent(i)))))||LC((()=>JSON.parse(decodeURIComponent(i)))):null;return c&&c.action==="ph_authorize"?((s=c).source="url",s&&Object.keys(s).length>0&&(c.desiredHash?e.hash=c.desiredHash:n?n.replaceState(n.state,"",e.pathname+e.search):e.hash="")):((s=JSON.parse(t.getItem(ZC)||"{}")).source="localstorage",delete s.userIntent),!(!s.token||this.instance.config.token!==s.token)&&(this.loadToolbar(s),!0)}catch{return!1}}xt(e){var t=Et.ph_load_toolbar||Et.ph_load_editor;!cr(t)&&$c(t)?t(e,this.instance):ek.warn("No toolbar load function found")}loadToolbar(e){var t=!(qe==null||!qe.getElementById(cR));if(!be||t)return!1;var n=this.instance.requestRouter.region==="custom"&&this.instance.config.advanced_disable_toolbar_metrics,s=et({token:this.instance.config.token},e,{apiURL:this.instance.requestRouter.endpointFor("ui")},n?{instrument:!1}:{});if(be.localStorage.setItem(ZC,JSON.stringify(et({},s,{source:void 0}))),this.wt()===Pc.LOADED)this.xt(s);else if(this.wt()===Pc.UNINITIALIZED){var i;this.yt(Pc.LOADING),(i=Et.__PosthogExtensions__)==null||i.loadExternalDependency==null||i.loadExternalDependency(this.instance,"toolbar",(c=>{if(c)return ek.error("[Toolbar] Failed to load",c),void this.yt(Pc.UNINITIALIZED);this.yt(Pc.LOADED),this.xt(s)})),Ln(be,"turbolinks:load",(()=>{this.yt(Pc.UNINITIALIZED),this.loadToolbar(s)}))}return!0}Et(e){return this.loadToolbar(e)}maybeLoadEditor(e,t,n){return e===void 0&&(e=void 0),t===void 0&&(t=void 0),n===void 0&&(n=void 0),this.maybeLoadToolbar(e,t,n)}}var Gz=bn("[TracingHeaders]");class Wz{constructor(e){this.$t=void 0,this.St=void 0,this.rt=()=>{var t,n;Ke(this.$t)&&((t=Et.__PosthogExtensions__)==null||(t=t.tracingHeadersPatchFns)==null||t._patchXHR(this._instance.config.__add_tracing_headers||[],this._instance.get_distinct_id(),this._instance.sessionManager)),Ke(this.St)&&((n=Et.__PosthogExtensions__)==null||(n=n.tracingHeadersPatchFns)==null||n._patchFetch(this._instance.config.__add_tracing_headers||[],this._instance.get_distinct_id(),this._instance.sessionManager))},this._instance=e}it(e){var t,n;(t=Et.__PosthogExtensions__)!=null&&t.tracingHeadersPatchFns&&e(),(n=Et.__PosthogExtensions__)==null||n.loadExternalDependency==null||n.loadExternalDependency(this._instance,"tracing-headers",(s=>{if(s)return Gz.error("failed to load script",s);e()}))}startIfEnabledOrStop(){var e,t;this._instance.config.__add_tracing_headers?this.it(this.rt):((e=this.$t)==null||e.call(this),(t=this.St)==null||t.call(this),this.$t=void 0,this.St=void 0)}}var _v="https?://(.*)",ph=["gclid","gclsrc","dclid","gbraid","wbraid","fbclid","msclkid","twclid","li_fat_id","igshid","ttclid","rdt_cid","epik","qclid","sccid","irclid","_kx"],Vz=hh(["utm_source","utm_medium","utm_campaign","utm_content","utm_term","gad_source","mc_cid"],ph),Ym="<masked>",qz=["li_fat_id"];function NR(r,e,t){if(!qe)return{};var n,s=e?hh([],ph,t||[]):[],i=TR(Km(qe.URL,s,Ym),r),c=(n={},Xr(qz,(function(u){var p=ja.q(u);n[u]=p||null})),n);return Rn(c,i)}function TR(r,e){var t=Vz.concat(e||[]),n={};return Xr(t,(function(s){var i=hy(r,s);n[s]=i||null})),n}function RR(r){var e=(function(i){return i?i.search(_v+"google.([^/?]*)")===0?"google":i.search(_v+"bing.com")===0?"bing":i.search(_v+"yahoo.com")===0?"yahoo":i.search(_v+"duckduckgo.com")===0?"duckduckgo":null:null})(r),t=e!="yahoo"?"q":"p",n={};if(!Xi(e)){n.$search_engine=e;var s=qe?hy(qe.referrer,t):"";s.length&&(n.ph_keyword=s)}return n}function tk(){return navigator.language||navigator.userLanguage}function AR(){return(qe==null?void 0:qe.referrer)||"$direct"}function IR(r,e){var t=r?hh([],ph,e||[]):[],n=xs==null?void 0:xs.href.substring(0,1e3);return{r:AR().substring(0,1e3),u:n?Km(n,t,Ym):void 0}}function PR(r){var e,{r:t,u:n}=r,s={$referrer:t,$referring_domain:t==null?void 0:t=="$direct"?"$direct":(e=fy(t))==null?void 0:e.host};if(n){s.$current_url=n;var i=fy(n);s.$host=i==null?void 0:i.host,s.$pathname=i==null?void 0:i.pathname;var c=TR(n);Rn(s,c)}if(t){var u=RR(t);Rn(s,u)}return s}function FR(){try{return Intl.DateTimeFormat().resolvedOptions().timeZone}catch{return}}function Kz(){try{return new Date().getTimezoneOffset()}catch{return}}function Yz(r,e){if(!_o)return{};var t,n,s,i=r?hh([],ph,e||[]):[],[c,u]=(function(p){for(var m=0;m<PC.length;m++){var[g,x]=PC[m],b=g.exec(p),E=b&&($c(x)?x(b,p):x);if(E)return E}return["",""]})(_o);return Rn(rE({$os:c,$os_version:u,$browser:tR(_o,navigator.vendor),$device:FC(_o),$device_type:(n=_o,s=FC(n),s===zT||s===UT||s==="Kobo"||s==="Kindle Fire"||s===eR?Pm:s===jm||s===Xf||s===Om||s===Yw?"Console":s===BT?"Wearable":s?pi:"Desktop"),$timezone:FR(),$timezone_offset:Kz()}),{$current_url:Km(xs==null?void 0:xs.href,i,Ym),$host:xs==null?void 0:xs.host,$pathname:xs==null?void 0:xs.pathname,$raw_user_agent:_o.length>1e3?_o.substring(0,997)+"...":_o,$browser_version:U8(_o,navigator.vendor),$browser_language:tk(),$browser_language_prefix:(t=tk(),typeof t=="string"?t.split("-")[0]:void 0),$screen_height:be==null?void 0:be.screen.height,$screen_width:be==null?void 0:be.screen.width,$viewport_height:be==null?void 0:be.innerHeight,$viewport_width:be==null?void 0:be.innerWidth,$lib:"web",$lib_version:Rl.LIB_VERSION,$insert_id:Math.random().toString(36).substring(2,10)+Math.random().toString(36).substring(2,10),$time:Date.now()/1e3})}var Rc=bn("[Web Vitals]"),rk=9e5;class Jz{constructor(e){var t;this.kt=!1,this.P=!1,this.N={url:void 0,metrics:[],firstMetricTimestamp:void 0},this.Pt=()=>{clearTimeout(this.Tt),this.N.metrics.length!==0&&(this._instance.capture("$web_vitals",this.N.metrics.reduce(((n,s)=>et({},n,{["$web_vitals_"+s.name+"_event"]:et({},s),["$web_vitals_"+s.name+"_value"]:s.value})),{})),this.N={url:void 0,metrics:[],firstMetricTimestamp:void 0})},this.It=n=>{var s,i=(s=this._instance.sessionManager)==null?void 0:s.checkAndGetSessionAndWindowId(!0);if(Ke(i))Rc.error("Could not read session ID. Dropping metrics!");else{this.N=this.N||{url:void 0,metrics:[],firstMetricTimestamp:void 0};var c=this.Ct();Ke(c)||(cr(n==null?void 0:n.name)||cr(n==null?void 0:n.value)?Rc.error("Invalid metric received",n):this.Rt&&n.value>=this.Rt?Rc.error("Ignoring metric with value >= "+this.Rt,n):(this.N.url!==c&&(this.Pt(),this.Tt=setTimeout(this.Pt,this.flushToCaptureTimeoutMs)),Ke(this.N.url)&&(this.N.url=c),this.N.firstMetricTimestamp=Ke(this.N.firstMetricTimestamp)?Date.now():this.N.firstMetricTimestamp,n.attribution&&n.attribution.interactionTargetElement&&(n.attribution.interactionTargetElement=void 0),this.N.metrics.push(et({},n,{$current_url:c,$session_id:i.sessionId,$window_id:i.windowId,timestamp:Date.now()})),this.N.metrics.length===this.allowedMetrics.length&&this.Pt()))}},this.rt=()=>{if(!this.P){var n,s,i,c,u=Et.__PosthogExtensions__;Ke(u)||Ke(u.postHogWebVitalsCallbacks)||({onLCP:n,onCLS:s,onFCP:i,onINP:c}=u.postHogWebVitalsCallbacks),n&&s&&i&&c?(this.allowedMetrics.indexOf("LCP")>-1&&n(this.It.bind(this)),this.allowedMetrics.indexOf("CLS")>-1&&s(this.It.bind(this)),this.allowedMetrics.indexOf("FCP")>-1&&i(this.It.bind(this)),this.allowedMetrics.indexOf("INP")>-1&&c(this.It.bind(this)),this.P=!0):Rc.error("web vitals callbacks not loaded - not starting")}},this._instance=e,this.kt=!((t=this._instance.persistence)==null||!t.props[zC]),this.startIfEnabled()}get allowedMetrics(){var e,t,n=Vn(this._instance.config.capture_performance)?(e=this._instance.config.capture_performance)==null?void 0:e.web_vitals_allowed_metrics:void 0;return cr(n)?((t=this._instance.persistence)==null?void 0:t.props[BC])||["CLS","FCP","INP","LCP"]:n}get flushToCaptureTimeoutMs(){return(Vn(this._instance.config.capture_performance)?this._instance.config.capture_performance.web_vitals_delayed_flush_ms:void 0)||5e3}get useAttribution(){var e=Vn(this._instance.config.capture_performance)?this._instance.config.capture_performance.web_vitals_attribution:void 0;return e!=null&&e}get Rt(){var e=Vn(this._instance.config.capture_performance)&&Ll(this._instance.config.capture_performance.__web_vitals_max_value)?this._instance.config.capture_performance.__web_vitals_max_value:rk;return 0<e&&e<=6e4?rk:e}get isEnabled(){var e=xs==null?void 0:xs.protocol;if(e!=="http:"&&e!=="https:")return Rc.info("Web Vitals are disabled on non-http/https protocols"),!1;var t=Vn(this._instance.config.capture_performance)?this._instance.config.capture_performance.web_vitals:Ol(this._instance.config.capture_performance)?this._instance.config.capture_performance:void 0;return Ol(t)?t:this.kt}startIfEnabled(){this.isEnabled&&!this.P&&(Rc.info("enabled, starting..."),this.it(this.rt))}onRemoteConfig(e){var t=Vn(e.capturePerformance)&&!!e.capturePerformance.web_vitals,n=Vn(e.capturePerformance)?e.capturePerformance.web_vitals_allowed_metrics:void 0;this._instance.persistence&&(this._instance.persistence.register({[zC]:t}),this._instance.persistence.register({[BC]:n})),this.kt=t,this.startIfEnabled()}it(e){var t,n;if((t=Et.__PosthogExtensions__)!=null&&t.postHogWebVitalsCallbacks)e();else{var s=this.useAttribution?"web-vitals-with-attribution":"web-vitals";(n=Et.__PosthogExtensions__)==null||n.loadExternalDependency==null||n.loadExternalDependency(this._instance,s,(i=>{i?Rc.error("failed to load script",i):e()}))}}Ct(){var e=be?be.location.href:void 0;if(e){var t=this._instance.config.mask_personal_data_properties,n=this._instance.config.custom_personal_data_properties,s=t?hh([],ph,n||[]):[];return Km(e,s,Ym)}Rc.error("Could not determine current URL")}}var Xz=bn("[Heatmaps]");function nk(r){return Vn(r)&&"clientX"in r&&"clientY"in r&&Ll(r.clientX)&&Ll(r.clientY)}class Qz{constructor(e){var t;this.kt=!1,this.P=!1,this.Ft=null,this.instance=e,this.kt=!((t=this.instance.persistence)==null||!t.props[Qw]),this.rageclicks=new _R(e.config.rageclick)}get flushIntervalMilliseconds(){var e=5e3;return Vn(this.instance.config.capture_heatmaps)&&this.instance.config.capture_heatmaps.flush_interval_milliseconds&&(e=this.instance.config.capture_heatmaps.flush_interval_milliseconds),e}get isEnabled(){return cr(this.instance.config.capture_heatmaps)?cr(this.instance.config.enable_heatmaps)?this.kt:this.instance.config.enable_heatmaps:this.instance.config.capture_heatmaps!==!1}startIfEnabled(){if(this.isEnabled){if(this.P)return;Xz.info("starting..."),this.Ot(),this.Mt()}else{var e;clearInterval((e=this.Ft)!==null&&e!==void 0?e:void 0),this.At(),this.getAndClearBuffer()}}onRemoteConfig(e){var t=!!e.heatmaps;this.instance.persistence&&this.instance.persistence.register({[Qw]:t}),this.kt=t,this.startIfEnabled()}getAndClearBuffer(){var e=this.N;return this.N=void 0,e}jt(e){this.Dt(e.originalEvent,"deadclick")}Mt(){this.Ft&&clearInterval(this.Ft),this.Ft=(function(e){return(e==null?void 0:e.visibilityState)==="visible"})(qe)?setInterval(this.Lt.bind(this),this.flushIntervalMilliseconds):null}Ot(){be&&qe&&(this.Nt=this.Lt.bind(this),Ln(be,"beforeunload",this.Nt),this.Ut=e=>this.Dt(e||(be==null?void 0:be.event)),Ln(qe,"click",this.Ut,{capture:!0}),this.zt=e=>this.Ht(e||(be==null?void 0:be.event)),Ln(qe,"mousemove",this.zt,{capture:!0}),this.Bt=new SR(this.instance,Dz,this.jt.bind(this)),this.Bt.startIfEnabled(),this.qt=this.Mt.bind(this),Ln(qe,"visibilitychange",this.qt),this.P=!0)}At(){var e;be&&qe&&(this.Nt&&be.removeEventListener("beforeunload",this.Nt),this.Ut&&qe.removeEventListener("click",this.Ut,{capture:!0}),this.zt&&qe.removeEventListener("mousemove",this.zt,{capture:!0}),this.qt&&qe.removeEventListener("visibilitychange",this.qt),clearTimeout(this.Wt),(e=this.Bt)==null||e.stop(),this.P=!1)}Gt(e,t){var n=this.instance.scrollManager.scrollY(),s=this.instance.scrollManager.scrollX(),i=this.instance.scrollManager.scrollElement(),c=(function(u,p,m){for(var g=u;g&&Ky(g)&&!zc(g,"body");){if(g===m)return!1;if(ar(p,be==null?void 0:be.getComputedStyle(g).position))return!0;g=mR(g)}return!1})(hR(e),["fixed","sticky"],i);return{x:e.clientX+(c?0:s),y:e.clientY+(c?0:n),target_fixed:c,type:t}}Dt(e,t){var n;if(t===void 0&&(t="click"),!GC(e.target)&&nk(e)){var s=this.Gt(e,t);(n=this.rageclicks)!=null&&n.isRageClick(e.clientX,e.clientY,new Date().getTime())&&this.Vt(et({},s,{type:"rageclick"})),this.Vt(s)}}Ht(e){!GC(e.target)&&nk(e)&&(clearTimeout(this.Wt),this.Wt=setTimeout((()=>{this.Vt(this.Gt(e,"mousemove"))}),500))}Vt(e){if(be){var t=be.location.href,n=this.instance.config.mask_personal_data_properties,s=this.instance.config.custom_personal_data_properties,i=n?hh([],ph,s||[]):[],c=Km(t,i,Ym);this.N=this.N||{},this.N[c]||(this.N[c]=[]),this.N[c].push(e)}}Lt(){this.N&&!Wf(this.N)&&this.instance.capture("$$heatmap",{$heatmap_data:this.getAndClearBuffer()})}}class sk{constructor(e){this.Jt=(t,n,s)=>{s&&(s.noSessionId||s.activityTimeout||s.sessionPastMaximumLength)&&(Qe.info("[PageViewManager] Session rotated, clearing pageview state",{sessionId:t,changeReason:s}),this.Kt=void 0,this._instance.scrollManager.resetContext())},this._instance=e,this.Yt()}Yt(){var e;this.Xt=(e=this._instance.sessionManager)==null?void 0:e.onSessionId(this.Jt)}destroy(){var e;(e=this.Xt)==null||e.call(this),this.Xt=void 0}doPageView(e,t){var n,s=this.Qt(e,t);return this.Kt={pathname:(n=be==null?void 0:be.location.pathname)!==null&&n!==void 0?n:"",pageViewId:t,timestamp:e},this._instance.scrollManager.resetContext(),s}doPageLeave(e){var t;return this.Qt(e,(t=this.Kt)==null?void 0:t.pageViewId)}doEvent(){var e;return{$pageview_id:(e=this.Kt)==null?void 0:e.pageViewId}}Qt(e,t){var n=this.Kt;if(!n)return{$pageview_id:t};var s={$pageview_id:t,$prev_pageview_id:n.pageViewId},i=this._instance.scrollManager.getContext();if(i&&!this._instance.config.disable_scroll_properties){var{maxScrollHeight:c,lastScrollY:u,maxScrollY:p,maxContentHeight:m,lastContentY:g,maxContentY:x}=i;if(!(Ke(c)||Ke(u)||Ke(p)||Ke(m)||Ke(g)||Ke(x))){c=Math.ceil(c),u=Math.ceil(u),p=Math.ceil(p),m=Math.ceil(m),g=Math.ceil(g),x=Math.ceil(x);var b=c<=1?1:La(u/c,0,1,Qe),E=c<=1?1:La(p/c,0,1,Qe),T=m<=1?1:La(g/m,0,1,Qe),S=m<=1?1:La(x/m,0,1,Qe);s=Rn(s,{$prev_pageview_last_scroll:u,$prev_pageview_last_scroll_percentage:b,$prev_pageview_max_scroll:p,$prev_pageview_max_scroll_percentage:E,$prev_pageview_last_content:g,$prev_pageview_last_content_percentage:T,$prev_pageview_max_content:x,$prev_pageview_max_content_percentage:S})}}return n.pathname&&(s.$prev_pageview_pathname=n.pathname),n.timestamp&&(s.$prev_pageview_duration=(e.getTime()-n.timestamp.getTime())/1e3),s}}var Pl=(function(r){return r.GZipJS="gzip-js",r.Base64="base64",r})({}),mi=Uint8Array,Eo=Uint16Array,ah=Uint32Array,iE=new mi([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),aE=new mi([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),ok=new mi([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),jR=function(r,e){for(var t=new Eo(31),n=0;n<31;++n)t[n]=e+=1<<r[n-1];var s=new ah(t[30]);for(n=1;n<30;++n)for(var i=t[n];i<t[n+1];++i)s[i]=i-t[n]<<5|n;return[t,s]},OR=jR(iE,2),Zz=OR[0],ab=OR[1];Zz[28]=258,ab[258]=28;for(var ik=jR(aE,0)[1],DR=new Eo(32768),nn=0;nn<32768;++nn){var Gu=(43690&nn)>>>1|(21845&nn)<<1;Gu=(61680&(Gu=(52428&Gu)>>>2|(13107&Gu)<<2))>>>4|(3855&Gu)<<4,DR[nn]=((65280&Gu)>>>8|(255&Gu)<<8)>>>1}var vm=function(r,e,t){for(var n=r.length,s=0,i=new Eo(e);s<n;++s)++i[r[s]-1];var c,u=new Eo(e);for(s=0;s<e;++s)u[s]=u[s-1]+i[s-1]<<1;for(c=new Eo(n),s=0;s<n;++s)c[s]=DR[u[r[s]-1]++]>>>15-r[s];return c},rd=new mi(288);for(nn=0;nn<144;++nn)rd[nn]=8;for(nn=144;nn<256;++nn)rd[nn]=9;for(nn=256;nn<280;++nn)rd[nn]=7;for(nn=280;nn<288;++nn)rd[nn]=8;var gy=new mi(32);for(nn=0;nn<32;++nn)gy[nn]=5;var eH=vm(rd,9),tH=vm(gy,5),LR=function(r){return(r/8>>0)+(7&r&&1)},MR=function(r,e,t){(t==null||t>r.length)&&(t=r.length);var n=new(r instanceof Eo?Eo:r instanceof ah?ah:mi)(t-e);return n.set(r.subarray(e,t)),n},Sl=function(r,e,t){t<<=7&e;var n=e/8>>0;r[n]|=t,r[n+1]|=t>>>8},Bp=function(r,e,t){t<<=7&e;var n=e/8>>0;r[n]|=t,r[n+1]|=t>>>8,r[n+2]|=t>>>16},Hx=function(r,e){for(var t=[],n=0;n<r.length;++n)r[n]&&t.push({s:n,f:r[n]});var s=t.length,i=t.slice();if(!s)return[new mi(0),0];if(s==1){var c=new mi(t[0].s+1);return c[t[0].s]=1,[c,1]}t.sort((function(M,B){return M.f-B.f})),t.push({s:-1,f:25001});var u=t[0],p=t[1],m=0,g=1,x=2;for(t[0]={s:-1,f:u.f+p.f,l:u,r:p};g!=s-1;)u=t[t[m].f<t[x].f?m++:x++],p=t[m!=g&&t[m].f<t[x].f?m++:x++],t[g++]={s:-1,f:u.f+p.f,l:u,r:p};var b=i[0].s;for(n=1;n<s;++n)i[n].s>b&&(b=i[n].s);var E=new Eo(b+1),T=lb(t[g-1],E,0);if(T>e){n=0;var S=0,N=T-e,R=1<<N;for(i.sort((function(M,B){return E[B.s]-E[M.s]||M.f-B.f}));n<s;++n){var A=i[n].s;if(!(E[A]>e))break;S+=R-(1<<T-E[A]),E[A]=e}for(S>>>=N;S>0;){var j=i[n].s;E[j]<e?S-=1<<e-E[j]++-1:++n}for(;n>=0&&S;--n){var P=i[n].s;E[P]==e&&(--E[P],++S)}T=e}return[new mi(E),T]},lb=function(r,e,t){return r.s==-1?Math.max(lb(r.l,e,t+1),lb(r.r,e,t+1)):e[r.s]=t},ak=function(r){for(var e=r.length;e&&!r[--e];);for(var t=new Eo(++e),n=0,s=r[0],i=1,c=function(p){t[n++]=p},u=1;u<=e;++u)if(r[u]==s&&u!=e)++i;else{if(!s&&i>2){for(;i>138;i-=138)c(32754);i>2&&(c(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(c(s),--i;i>6;i-=6)c(8304);i>2&&(c(i-3<<5|8208),i=0)}for(;i--;)c(s);i=1,s=r[u]}return[t.subarray(0,n),e]},Gp=function(r,e){for(var t=0,n=0;n<e.length;++n)t+=r[n]*e[n];return t},cb=function(r,e,t){var n=t.length,s=LR(e+2);r[s]=255&n,r[s+1]=n>>>8,r[s+2]=255^r[s],r[s+3]=255^r[s+1];for(var i=0;i<n;++i)r[s+i+4]=t[i];return 8*(s+4+n)},lk=function(r,e,t,n,s,i,c,u,p,m,g){Sl(e,g++,t),++s[256];for(var x=Hx(s,15),b=x[0],E=x[1],T=Hx(i,15),S=T[0],N=T[1],R=ak(b),A=R[0],j=R[1],P=ak(S),M=P[0],B=P[1],U=new Eo(19),V=0;V<A.length;++V)U[31&A[V]]++;for(V=0;V<M.length;++V)U[31&M[V]]++;for(var Y=Hx(U,7),ce=Y[0],X=Y[1],de=19;de>4&&!ce[ok[de-1]];--de);var we,le,se,me,te=m+5<<3,G=Gp(s,rd)+Gp(i,gy)+c,z=Gp(s,b)+Gp(i,S)+c+14+3*de+Gp(U,ce)+(2*U[16]+3*U[17]+7*U[18]);if(te<=G&&te<=z)return cb(e,g,r.subarray(p,p+m));if(Sl(e,g,1+(z<G)),g+=2,z<G){we=vm(b,E),le=b,se=vm(S,N),me=S;var J=vm(ce,X);for(Sl(e,g,j-257),Sl(e,g+5,B-1),Sl(e,g+10,de-4),g+=14,V=0;V<de;++V)Sl(e,g+3*V,ce[ok[V]]);g+=3*de;for(var D=[A,M],$=0;$<2;++$){var ne=D[$];for(V=0;V<ne.length;++V){var _e=31&ne[V];Sl(e,g,J[_e]),g+=ce[_e],_e>15&&(Sl(e,g,ne[V]>>>5&127),g+=ne[V]>>>12)}}}else we=eH,le=rd,se=tH,me=gy;for(V=0;V<u;++V)if(n[V]>255){_e=n[V]>>>18&31,Bp(e,g,we[_e+257]),g+=le[_e+257],_e>7&&(Sl(e,g,n[V]>>>23&31),g+=iE[_e]);var q=31&n[V];Bp(e,g,se[q]),g+=me[q],q>3&&(Bp(e,g,n[V]>>>5&8191),g+=aE[q])}else Bp(e,g,we[n[V]]),g+=le[n[V]];return Bp(e,g,we[256]),g+le[256]},rH=new ah([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),nH=(function(){for(var r=new ah(256),e=0;e<256;++e){for(var t=e,n=9;--n;)t=(1&t&&3988292384)^t>>>1;r[e]=t}return r})(),sH=function(r,e,t,n,s){return(function(i,c,u,p,m,g){var x=i.length,b=new mi(p+x+5*(1+Math.floor(x/7e3))+m),E=b.subarray(p,b.length-m),T=0;if(!c||x<8)for(var S=0;S<=x;S+=65535){var N=S+65535;N<x?T=cb(E,T,i.subarray(S,N)):(E[S]=g,T=cb(E,T,i.subarray(S,x)))}else{for(var R=rH[c-1],A=R>>>13,j=8191&R,P=(1<<u)-1,M=new Eo(32768),B=new Eo(P+1),U=Math.ceil(u/3),V=2*U,Y=function(yt){return(i[yt]^i[yt+1]<<U^i[yt+2]<<V)&P},ce=new ah(25e3),X=new Eo(288),de=new Eo(32),we=0,le=0,se=(S=0,0),me=0,te=0;S<x;++S){var G=Y(S),z=32767&S,J=B[G];if(M[z]=J,B[G]=z,me<=S){var D=x-S;if((we>7e3||se>24576)&&D>423){T=lk(i,E,0,ce,X,de,le,se,te,S-te,T),se=we=le=0,te=S;for(var $=0;$<286;++$)X[$]=0;for($=0;$<30;++$)de[$]=0}var ne=2,_e=0,q=j,ie=z-J&32767;if(D>2&&G==Y(S-ie))for(var xe=Math.min(A,D)-1,ye=Math.min(32767,S),ue=Math.min(258,D);ie<=ye&&--q&&z!=J;){if(i[S+ne]==i[S+ne-ie]){for(var ke=0;ke<ue&&i[S+ke]==i[S+ke-ie];++ke);if(ke>ne){if(ne=ke,_e=ie,ke>xe)break;var He=Math.min(ie,ke-2),Ue=0;for($=0;$<He;++$){var Le=S-ie+$+32768&32767,Ne=Le-M[Le]+32768&32767;Ne>Ue&&(Ue=Ne,J=Le)}}}ie+=(z=J)-(J=M[z])+32768&32767}if(_e){ce[se++]=268435456|ab[ne]<<18|ik[_e];var gt=31&ab[ne],zt=31&ik[_e];le+=iE[gt]+aE[zt],++X[257+gt],++de[zt],me=S+ne,++we}else ce[se++]=i[S],++X[i[S]]}}T=lk(i,E,g,ce,X,de,le,se,te,S-te,T)}return MR(b,0,p+LR(T)+m)})(r,e.level==null?6:e.level,e.mem==null?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(r.length)))):12+e.mem,t,n,!0)},Bx=function(r,e,t){for(;t;++e)r[e]=t,t>>>=8};function oH(r,e){e===void 0&&(e={});var t=(function(){var u=4294967295;return{p:function(p){for(var m=u,g=0;g<p.length;++g)m=nH[255&m^p[g]]^m>>>8;u=m},d:function(){return 4294967295^u}}})(),n=r.length;t.p(r);var s,i=sH(r,e,10+((s=e).filename&&s.filename.length+1||0),8),c=i.length;return(function(u,p){var m=p.filename;if(u[0]=31,u[1]=139,u[2]=8,u[8]=p.level<2?4:p.level==9?2:0,u[9]=3,p.mtime!=0&&Bx(u,4,Math.floor(new Date(p.mtime||Date.now())/1e3)),m){u[3]=8;for(var g=0;g<=m.length;++g)u[g+10]=m.charCodeAt(g)}})(i,e),Bx(i,c-8,t.d()),Bx(i,c-4,n),i}var iH=function(r){var e,t,n,s,i="";for(e=t=0,n=(r=(r+"").replace(/\r\n/g,`
`).replace(/\r/g,`
`)).length,s=0;s<n;s++){var c=r.charCodeAt(s),u=null;c<128?t++:u=c>127&&c<2048?String.fromCharCode(c>>6|192,63&c|128):String.fromCharCode(c>>12|224,c>>6&63|128,63&c|128),Xi(u)||(t>e&&(i+=r.substring(e,t)),i+=u,e=t=s+1)}return t>e&&(i+=r.substring(e,r.length)),i},aH=!!Gw||!!Bw,ck="text/plain",vy=function(r,e,t){var n;t===void 0&&(t=!0);var[s,i]=r.split("?"),c=et({},e),u=(n=i==null?void 0:i.split("&").map((m=>{var g,[x,b]=m.split("="),E=t&&(g=c[x])!==null&&g!==void 0?g:b;return delete c[x],x+"="+E})))!==null&&n!==void 0?n:[],p=Ez(c);return p&&u.push(p),s+"?"+u.join("&")},cm=(r,e)=>JSON.stringify(r,((t,n)=>typeof n=="bigint"?n.toString():n),e),Gx=r=>{var{data:e,compression:t}=r;if(e){if(t===Pl.GZipJS){var n=oH((function(p,m){var g=p.length;if(typeof TextEncoder<"u")return new TextEncoder().encode(p);for(var x=new mi(p.length+(p.length>>>1)),b=0,E=function(R){x[b++]=R},T=0;T<g;++T){if(b+5>x.length){var S=new mi(b+8+(g-T<<1));S.set(x),x=S}var N=p.charCodeAt(T);N<128||m?E(N):N<2048?(E(192|N>>>6),E(128|63&N)):N>55295&&N<57344?(E(240|(N=65536+(1047552&N)|1023&p.charCodeAt(++T))>>>18),E(128|N>>>12&63),E(128|N>>>6&63),E(128|63&N)):(E(224|N>>>12),E(128|N>>>6&63),E(128|63&N))}return MR(x,0,b)})(cm(e)),{mtime:0}),s=new Blob([n],{type:ck});return{contentType:ck,body:s,estimatedSize:s.size}}if(t===Pl.Base64){var i=(function(p){var m,g,x,b,E,T="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",S=0,N=0,R="",A=[];if(!p)return p;p=iH(p);do m=(E=p.charCodeAt(S++)<<16|p.charCodeAt(S++)<<8|p.charCodeAt(S++))>>18&63,g=E>>12&63,x=E>>6&63,b=63&E,A[N++]=T.charAt(m)+T.charAt(g)+T.charAt(x)+T.charAt(b);while(S<p.length);switch(R=A.join(""),p.length%3){case 1:R=R.slice(0,-2)+"==";break;case 2:R=R.slice(0,-1)+"="}return R})(cm(e)),c=(p=>"data="+encodeURIComponent(typeof p=="string"?p:cm(p)))(i);return{contentType:"application/x-www-form-urlencoded",body:c,estimatedSize:new Blob([c]).size}}var u=cm(e);return{contentType:"application/json",body:u,estimatedSize:new Blob([u]).size}}},Wv=[];Bw&&Wv.push({transport:"fetch",method:r=>{var e,t,{contentType:n,body:s,estimatedSize:i}=(e=Gx(r))!==null&&e!==void 0?e:{},c=new Headers;Xr(r.headers,(function(g,x){c.append(x,g)})),n&&c.append("Content-Type",n);var u=r.url,p=null;if(NC){var m=new NC;p={signal:m.signal,timeout:setTimeout((()=>m.abort()),r.timeout)}}Bw(u,et({method:(r==null?void 0:r.method)||"GET",headers:c,keepalive:r.method==="POST"&&(i||0)<52428.8,body:s,signal:(t=p)==null?void 0:t.signal},r.fetchOptions)).then((g=>g.text().then((x=>{var b={statusCode:g.status,text:x};if(g.status===200)try{b.json=JSON.parse(x)}catch(E){Qe.error(E)}r.callback==null||r.callback(b)})))).catch((g=>{Qe.error(g),r.callback==null||r.callback({statusCode:0,text:g})})).finally((()=>p?clearTimeout(p.timeout):null))}}),Gw&&Wv.push({transport:"XHR",method:r=>{var e,t=new Gw;t.open(r.method||"GET",r.url,!0);var{contentType:n,body:s}=(e=Gx(r))!==null&&e!==void 0?e:{};Xr(r.headers,(function(i,c){t.setRequestHeader(c,i)})),n&&t.setRequestHeader("Content-Type",n),r.timeout&&(t.timeout=r.timeout),r.disableXHRCredentials||(t.withCredentials=!0),t.onreadystatechange=()=>{if(t.readyState===4){var i={statusCode:t.status,text:t.responseText};if(t.status===200)try{i.json=JSON.parse(t.responseText)}catch{}r.callback==null||r.callback(i)}},t.send(s)}}),Go!=null&&Go.sendBeacon&&Wv.push({transport:"sendBeacon",method:r=>{var e=vy(r.url,{beacon:"1"});try{var t,{contentType:n,body:s}=(t=Gx(r))!==null&&t!==void 0?t:{},i=typeof s=="string"?new Blob([s],{type:n}):s;Go.sendBeacon(e,i)}catch{}}});var yy=function(r,e){if(!(function(t){try{new RegExp(t)}catch{return!1}return!0})(e))return!1;try{return new RegExp(e).test(r)}catch{return!1}};function uk(r,e,t){return cm({distinct_id:r,userPropertiesToSet:e,userPropertiesToSetOnce:t})}var $R={exact:(r,e)=>e.some((t=>r.some((n=>t===n)))),is_not:(r,e)=>e.every((t=>r.every((n=>t!==n)))),regex:(r,e)=>e.some((t=>r.some((n=>yy(t,n))))),not_regex:(r,e)=>e.every((t=>r.every((n=>!yy(t,n))))),icontains:(r,e)=>e.map(Ev).some((t=>r.map(Ev).some((n=>t.includes(n))))),not_icontains:(r,e)=>e.map(Ev).every((t=>r.map(Ev).every((n=>!t.includes(n))))),gt:(r,e)=>e.some((t=>{var n=parseFloat(t);return!isNaN(n)&&r.some((s=>n>parseFloat(s)))})),lt:(r,e)=>e.some((t=>{var n=parseFloat(t);return!isNaN(n)&&r.some((s=>n<parseFloat(s)))}))},Ev=r=>r.toLowerCase();function UR(r,e){return!r||Object.entries(r).every((t=>{var[n,s]=t,i=e==null?void 0:e[n];if(Ke(i)||Xi(i))return!1;var c=[String(i)],u=$R[s.operator];return!!u&&u(s.values,c)}))}var Wx=bn("[Error tracking]");class lH{constructor(e){var t,n;this.Zt=[],this.ti=new B8([new Q8,new az,new ez,new Z8,new oz,new sz,new rz,new iz],X8()),this._instance=e,this.Zt=(t=(n=this._instance.persistence)==null?void 0:n.get_property(Zw))!==null&&t!==void 0?t:[]}onRemoteConfig(e){var t,n,s,i=(t=(n=e.errorTracking)==null?void 0:n.suppressionRules)!==null&&t!==void 0?t:[],c=(s=e.errorTracking)==null?void 0:s.captureExtensionExceptions;this.Zt=i,this._instance.persistence&&this._instance.persistence.register({[Zw]:this.Zt,[UC]:c})}get ii(){var e,t=!!this._instance.get_property(UC),n=this._instance.config.error_tracking.captureExtensionExceptions;return(e=n??t)!==null&&e!==void 0&&e}buildProperties(e,t){return this.ti.buildFromUnknown(e,{syntheticException:t==null?void 0:t.syntheticException,mechanism:{handled:t==null?void 0:t.handled}})}sendExceptionEvent(e){var t=e.$exception_list;if(this.ei(t)){if(this.ri(t))return void Wx.info("Skipping exception capture because a suppression rule matched");if(!this.ii&&this.si(t))return void Wx.info("Skipping exception capture because it was thrown by an extension");if(!this._instance.config.error_tracking.__capturePostHogExceptions&&this.ni(t))return void Wx.info("Skipping exception capture because it was thrown by the PostHog SDK")}return this._instance.capture("$exception",e,{_noTruncate:!0,_batchKey:"exceptionEvent"})}ri(e){if(e.length===0)return!1;var t=e.reduce(((n,s)=>{var{type:i,value:c}=s;return qn(i)&&i.length>0&&n.$exception_types.push(i),qn(c)&&c.length>0&&n.$exception_values.push(c),n}),{$exception_types:[],$exception_values:[]});return this.Zt.some((n=>{var s=n.values.map((i=>{var c,u=$R[i.operator],p=Fr(i.value)?i.value:[i.value],m=(c=t[i.key])!==null&&c!==void 0?c:[];return p.length>0&&u(p,m)}));return n.type==="OR"?s.some(Boolean):s.every(Boolean)}))}si(e){return e.flatMap((t=>{var n,s;return(n=(s=t.stacktrace)==null?void 0:s.frames)!==null&&n!==void 0?n:[]})).some((t=>t.filename&&t.filename.startsWith("chrome-extension://")))}ni(e){if(e.length>0){var t,n,s,i,c=(t=(n=e[0].stacktrace)==null?void 0:n.frames)!==null&&t!==void 0?t:[],u=c[c.length-1];return(s=u==null||(i=u.filename)==null?void 0:i.includes("posthog.com/static"))!==null&&s!==void 0&&s}return!1}ei(e){return!cr(e)&&Fr(e)}}var Uo=bn("[FeatureFlags]"),Wp=bn("[FeatureFlags]",{debugEnabled:!0}),Vx="$active_feature_flags",jf="$override_feature_flags",dk="$feature_flag_payloads",Vp="$override_feature_flag_payloads",fk="$feature_flag_request_id",hk="$feature_flag_evaluated_at",pk=r=>{var e={};for(var[t,n]of Gv(r||{}))n&&(e[t]=n);return e},cH=r=>{var e=r.flags;return e?(r.featureFlags=Object.fromEntries(Object.keys(e).map((t=>{var n;return[t,(n=e[t].variant)!==null&&n!==void 0?n:e[t].enabled]}))),r.featureFlagPayloads=Object.fromEntries(Object.keys(e).filter((t=>e[t].enabled)).filter((t=>{var n;return(n=e[t].metadata)==null?void 0:n.payload})).map((t=>{var n;return[t,(n=e[t].metadata)==null?void 0:n.payload]})))):Uo.warn("Using an older version of the feature flags endpoint. Please upgrade your PostHog server to the latest version"),r},uH=(function(r){return r.FeatureFlags="feature_flags",r.Recordings="recordings",r})({});class dH{constructor(e){this.oi=!1,this.ai=!1,this.li=!1,this.ui=!1,this.hi=!1,this.di=!1,this.vi=!1,this.ci=!1,this._instance=e,this.featureFlagEventHandlers=[]}fi(){var e,t=(e=this._instance.config.evaluation_contexts)!==null&&e!==void 0?e:this._instance.config.evaluation_environments;return!this._instance.config.evaluation_environments||this._instance.config.evaluation_contexts||this.ci||(Uo.warn("evaluation_environments is deprecated. Use evaluation_contexts instead. evaluation_environments will be removed in a future version."),this.ci=!0),t!=null&&t.length?t.filter((n=>{var s=n&&typeof n=="string"&&n.trim().length>0;return s||Uo.error("Invalid evaluation context found:",n,"Expected non-empty string"),s})):[]}pi(){return this.fi().length>0}flags(){if(this._instance.config.__preview_remote_config)this.di=!0;else{var e=!this.gi&&(this._instance.config.advanced_disable_feature_flags||this._instance.config.advanced_disable_feature_flags_on_first_load);this.mi({disableFlags:e})}}get hasLoadedFlags(){return this.ai}getFlags(){return Object.keys(this.getFlagVariants())}getFlagsWithDetails(){var e=this._instance.get_property(eb),t=this._instance.get_property(jf),n=this._instance.get_property(Vp);if(!n&&!t)return e||{};var s=Rn({},e||{}),i=[...new Set([...Object.keys(n||{}),...Object.keys(t||{})])];for(var c of i){var u,p,m=s[c],g=t==null?void 0:t[c],x=Ke(g)?(u=m==null?void 0:m.enabled)!==null&&u!==void 0&&u:!!g,b=Ke(g)?m.variant:typeof g=="string"?g:void 0,E=n==null?void 0:n[c],T=et({},m,{enabled:x,variant:x?b??(m==null?void 0:m.variant):void 0});x!==(m==null?void 0:m.enabled)&&(T.original_enabled=m==null?void 0:m.enabled),b!==(m==null?void 0:m.variant)&&(T.original_variant=m==null?void 0:m.variant),E&&(T.metadata=et({},m==null?void 0:m.metadata,{payload:E,original_payload:m==null||(p=m.metadata)==null?void 0:p.payload})),s[c]=T}return this.oi||(Uo.warn(" Overriding feature flag details!",{flagDetails:e,overriddenPayloads:n,finalDetails:s}),this.oi=!0),s}getFlagVariants(){var e=this._instance.get_property(Vf),t=this._instance.get_property(jf);if(!t)return e||{};for(var n=Rn({},e),s=Object.keys(t),i=0;i<s.length;i++)n[s[i]]=t[s[i]];return this.oi||(Uo.warn(" Overriding feature flags!",{enabledFlags:e,overriddenFlags:t,finalFlags:n}),this.oi=!0),n}getFlagPayloads(){var e=this._instance.get_property(dk),t=this._instance.get_property(Vp);if(!t)return e||{};for(var n=Rn({},e||{}),s=Object.keys(t),i=0;i<s.length;i++)n[s[i]]=t[s[i]];return this.oi||(Uo.warn(" Overriding feature flag payloads!",{flagPayloads:e,overriddenPayloads:t,finalPayloads:n}),this.oi=!0),n}reloadFeatureFlags(){this.ui||this._instance.config.advanced_disable_feature_flags||this.gi||(this._instance.bi.emit("featureFlagsReloading",!0),this.gi=setTimeout((()=>{this.mi()}),5))}yi(){clearTimeout(this.gi),this.gi=void 0}ensureFlagsLoaded(){this.ai||this.li||this.gi||this.reloadFeatureFlags()}setAnonymousDistinctId(e){this.$anon_distinct_id=e}setReloadingPaused(e){this.ui=e}mi(e){var t;if(this.yi(),!this._instance.M())if(this.li)this.hi=!0;else{var n=this._instance.config.token,s=this._instance.get_property("$device_id"),i={token:n,distinct_id:this._instance.get_distinct_id(),groups:this._instance.getGroups(),$anon_distinct_id:this.$anon_distinct_id,person_properties:et({},((t=this._instance.persistence)==null?void 0:t.get_initial_props())||{},this._instance.get_property(lm)||{}),group_properties:this._instance.get_property(Ku)};Xi(s)||Ke(s)||(i.$device_id=s),(e!=null&&e.disableFlags||this._instance.config.advanced_disable_feature_flags)&&(i.disable_flags=!0),this.pi()&&(i.evaluation_contexts=this.fi());var c=this._instance.config.__preview_remote_config,u=c?"/flags/?v=2":"/flags/?v=2&config=true",p=this._instance.config.advanced_only_evaluate_survey_feature_flags?"&only_evaluate_survey_feature_flags=true":"",m=this._instance.requestRouter.endpointFor("flags",u+p);c&&(i.timezone=FR()),this.li=!0,this._instance._send_request({method:"POST",url:m,data:i,compression:this._instance.config.disable_compression?void 0:Pl.Base64,timeout:this._instance.config.feature_flag_request_timeout_ms,callback:g=>{var x,b,E=!0;if(g.statusCode===200&&(this.hi||(this.$anon_distinct_id=void 0),E=!1),this.li=!1,this.di||(this.di=!0,this._instance.wi((b=g.json)!==null&&b!==void 0?b:{})),!i.disable_flags||this.hi)if(this.vi=!E,g.json&&(x=g.json.quotaLimited)!=null&&x.includes(uH.FeatureFlags))Uo.warn("You have hit your feature flags quota limit, and will not be able to load feature flags until the quota is reset.  Please visit https://posthog.com/docs/billing/limits-alerts to learn more.");else{var T;i.disable_flags||this.receivedFeatureFlags((T=g.json)!==null&&T!==void 0?T:{},E),this.hi&&(this.hi=!1,this.mi())}}})}}getFeatureFlag(e,t){var n;if(t===void 0&&(t={}),this.ai||this.getFlags()&&this.getFlags().length>0){var s=this.getFeatureFlagResult(e,t);return(n=s==null?void 0:s.variant)!==null&&n!==void 0?n:s==null?void 0:s.enabled}Uo.warn('getFeatureFlag for key "'+e+`" failed. Feature flags didn't load in time.`)}getFeatureFlagDetails(e){return this.getFlagsWithDetails()[e]}getFeatureFlagPayload(e){var t=this.getFeatureFlagResult(e,{send_event:!1});return t==null?void 0:t.payload}getFeatureFlagResult(e,t){if(t===void 0&&(t={}),this.ai||this.getFlags()&&this.getFlags().length>0){var n=this.getFlagVariants(),s=e in n,i=n[e],c=this.getFlagPayloads()[e],u=String(i),p=this._instance.get_property(fk)||void 0,m=this._instance.get_property(hk)||void 0,g=this._instance.get_property(ly)||{};if((t.send_event||!("send_event"in t))&&(!(e in g)||!g[e].includes(u))){var x,b,E,T,S,N,R,A,j;Fr(g[e])?g[e].push(u):g[e]=[u],(x=this._instance.persistence)==null||x.register({[ly]:g});var P=this.getFeatureFlagDetails(e),M={$feature_flag:e,$feature_flag_response:i,$feature_flag_payload:c||null,$feature_flag_request_id:p,$feature_flag_evaluated_at:m,$feature_flag_bootstrapped_response:((b=this._instance.config.bootstrap)==null||(b=b.featureFlags)==null?void 0:b[e])||null,$feature_flag_bootstrapped_payload:((E=this._instance.config.bootstrap)==null||(E=E.featureFlagPayloads)==null?void 0:E[e])||null,$used_bootstrap_value:!this.vi};Ke(P==null||(T=P.metadata)==null?void 0:T.version)||(M.$feature_flag_version=P.metadata.version);var B,U=(S=P==null||(N=P.reason)==null?void 0:N.description)!==null&&S!==void 0?S:P==null||(R=P.reason)==null?void 0:R.code;U&&(M.$feature_flag_reason=U),P!=null&&(A=P.metadata)!=null&&A.id&&(M.$feature_flag_id=P.metadata.id),Ke(P==null?void 0:P.original_variant)&&Ke(P==null?void 0:P.original_enabled)||(M.$feature_flag_original_response=Ke(P.original_variant)?P.original_enabled:P.original_variant),P!=null&&(j=P.metadata)!=null&&j.original_payload&&(M.$feature_flag_original_payload=P==null||(B=P.metadata)==null?void 0:B.original_payload),this._instance.capture("$feature_flag_called",M)}if(s){var V=c;if(!Ke(c))try{V=JSON.parse(c)}catch{}return{key:e,enabled:!!i,variant:typeof i=="string"?i:void 0,payload:V}}}else Uo.warn('getFeatureFlagResult for key "'+e+`" failed. Feature flags didn't load in time.`)}getRemoteConfigPayload(e,t){var n=this._instance.config.token,s={distinct_id:this._instance.get_distinct_id(),token:n};this.pi()&&(s.evaluation_contexts=this.fi()),this._instance._send_request({method:"POST",url:this._instance.requestRouter.endpointFor("flags","/flags/?v=2&config=true"),data:s,compression:this._instance.config.disable_compression?void 0:Pl.Base64,timeout:this._instance.config.feature_flag_request_timeout_ms,callback:i=>{var c,u=(c=i.json)==null?void 0:c.featureFlagPayloads;t((u==null?void 0:u[e])||void 0)}})}isFeatureEnabled(e,t){if(t===void 0&&(t={}),this.ai||this.getFlags()&&this.getFlags().length>0){var n=this.getFeatureFlag(e,t);return Ke(n)?void 0:!!n}Uo.warn('isFeatureEnabled for key "'+e+`" failed. Feature flags didn't load in time.`)}addFeatureFlagsHandler(e){this.featureFlagEventHandlers.push(e)}removeFeatureFlagsHandler(e){this.featureFlagEventHandlers=this.featureFlagEventHandlers.filter((t=>t!==e))}receivedFeatureFlags(e,t){if(this._instance.persistence){this.ai=!0;var n=this.getFlagVariants(),s=this.getFlagPayloads(),i=this.getFlagsWithDetails();(function(c,u,p,m,g){p===void 0&&(p={}),m===void 0&&(m={}),g===void 0&&(g={});var x=cH(c),b=x.flags,E=x.featureFlags,T=x.featureFlagPayloads;if(E){var S=c.requestId,N=c.evaluatedAt;if(Fr(E)){Uo.warn("v1 of the feature flags endpoint is deprecated. Please use the latest version.");var R={};if(E)for(var A=0;A<E.length;A++)R[E[A]]=!0;u&&u.register({[Vx]:E,[Vf]:R})}else{var j=E,P=T,M=b;if(c.errorsWhileComputingFlags)if(b){var B=new Set(Object.keys(b).filter((U=>{var V;return!((V=b[U])!=null&&V.failed)})));j=et({},p,Object.fromEntries(Object.entries(j).filter((U=>{var[V]=U;return B.has(V)})))),P=et({},m,Object.fromEntries(Object.entries(P||{}).filter((U=>{var[V]=U;return B.has(V)})))),M=et({},g,Object.fromEntries(Object.entries(M||{}).filter((U=>{var[V]=U;return B.has(V)}))))}else j=et({},p,j),P=et({},m,P),M=et({},g,M);u&&u.register(et({[Vx]:Object.keys(pk(j)),[Vf]:j||{},[dk]:P||{},[eb]:M||{}},S?{[fk]:S}:{},N?{[hk]:N}:{}))}}})(e,this._instance.persistence,n,s,i),this.xi(t)}}override(e,t){t===void 0&&(t=!1),Uo.warn("override is deprecated. Please use overrideFeatureFlags instead."),this.overrideFeatureFlags({flags:e,suppressWarning:t})}overrideFeatureFlags(e){if(!this._instance.__loaded||!this._instance.persistence)return Uo.uninitializedWarning("posthog.featureFlags.overrideFeatureFlags");if(e===!1)return this._instance.persistence.unregister(jf),this._instance.persistence.unregister(Vp),this.xi(),Wp.info("All overrides cleared");if(e&&typeof e=="object"&&("flags"in e||"payloads"in e)){var t,n=e;if(this.oi=!!((t=n.suppressWarning)!==null&&t!==void 0&&t),"flags"in n){if(n.flags===!1)this._instance.persistence.unregister(jf),Wp.info("Flag overrides cleared");else if(n.flags){if(Fr(n.flags)){for(var s={},i=0;i<n.flags.length;i++)s[n.flags[i]]=!0;this._instance.persistence.register({[jf]:s})}else this._instance.persistence.register({[jf]:n.flags});Wp.info("Flag overrides set",{flags:n.flags})}}return"payloads"in n&&(n.payloads===!1?(this._instance.persistence.unregister(Vp),Wp.info("Payload overrides cleared")):n.payloads&&(this._instance.persistence.register({[Vp]:n.payloads}),Wp.info("Payload overrides set",{payloads:n.payloads}))),void this.xi()}this.xi()}onFeatureFlags(e){if(this.addFeatureFlagsHandler(e),this.ai){var{flags:t,flagVariants:n}=this.Ei();e(t,n)}return()=>this.removeFeatureFlagsHandler(e)}updateEarlyAccessFeatureEnrollment(e,t,n){var s,i=(this._instance.get_property(am)||[]).find((m=>m.flagKey===e)),c={["$feature_enrollment/"+e]:t},u={$feature_flag:e,$feature_enrollment:t,$set:c};i&&(u.$early_access_feature_name=i.name),n&&(u.$feature_enrollment_stage=n),this._instance.capture("$feature_enrollment_update",u),this.setPersonPropertiesForFlags(c,!1);var p=et({},this.getFlagVariants(),{[e]:t});(s=this._instance.persistence)==null||s.register({[Vx]:Object.keys(pk(p)),[Vf]:p}),this.xi()}getEarlyAccessFeatures(e,t,n){t===void 0&&(t=!1);var s=this._instance.get_property(am),i=n?"&"+n.map((c=>"stage="+c)).join("&"):"";if(s&&!t)return e(s);this._instance._send_request({url:this._instance.requestRouter.endpointFor("api","/api/early_access_features/?token="+this._instance.config.token+i),method:"GET",callback:c=>{var u,p;if(c.json){var m=c.json.earlyAccessFeatures;return(u=this._instance.persistence)==null||u.unregister(am),(p=this._instance.persistence)==null||p.register({[am]:m}),e(m)}}})}Ei(){var e=this.getFlags(),t=this.getFlagVariants();return{flags:e.filter((n=>t[n])),flagVariants:Object.keys(t).filter((n=>t[n])).reduce(((n,s)=>(n[s]=t[s],n)),{})}}xi(e){var{flags:t,flagVariants:n}=this.Ei();this.featureFlagEventHandlers.forEach((s=>s(t,n,{errorsLoading:e})))}setPersonPropertiesForFlags(e,t){t===void 0&&(t=!0);var n=this._instance.get_property(lm)||{};this._instance.register({[lm]:et({},n,e)}),t&&this._instance.reloadFeatureFlags()}resetPersonPropertiesForFlags(){this._instance.unregister(lm)}setGroupPropertiesForFlags(e,t){t===void 0&&(t=!0);var n=this._instance.get_property(Ku)||{};Object.keys(n).length!==0&&Object.keys(n).forEach((s=>{n[s]=et({},n[s],e[s]),delete e[s]})),this._instance.register({[Ku]:et({},n,e)}),t&&this._instance.reloadFeatureFlags()}resetGroupPropertiesForFlags(e){if(e){var t=this._instance.get_property(Ku)||{};this._instance.register({[Ku]:et({},t,{[e]:{}})})}else this._instance.unregister(Ku)}reset(){this.ai=!1,this.li=!1,this.ui=!1,this.hi=!1,this.di=!1,this.vi=!1,this.$anon_distinct_id=void 0,this.yi(),this.oi=!1}}var fH=["cookie","localstorage","localstorage+cookie","sessionstorage","memory"];class qx{constructor(e,t){this.R=e,this.props={},this.$i=!1,this.Si=(n=>{var s="";return n.token&&(s=n.token.replace(/\+/g,"PL").replace(/\//g,"SL").replace(/=/g,"EQ")),n.persistence_name?"ph_"+n.persistence_name:"ph_"+s+"_posthog"})(e),this.Y=this.ki(e),this.load(),e.debug&&Qe.info("Persistence loaded",e.persistence,et({},this.props)),this.update_config(e,e,t),this.save()}isDisabled(){return!!this.Pi}ki(e){fH.indexOf(e.persistence.toLowerCase())===-1&&(Qe.critical("Unknown persistence type "+e.persistence+"; falling back to localStorage+cookie"),e.persistence="localStorage+cookie");var t=(function(s){s===void 0&&(s=[]);var i=[...Fz,...s];return et({},pn,{W:function(c){try{var u={};try{u=ja.W(c)||{}}catch{}var p=Rn(u,JSON.parse(pn.q(c)||"{}"));return pn.G(c,p),p}catch{}return null},G:function(c,u,p,m,g,x){try{pn.G(c,u,void 0,void 0,x);var b={};i.forEach((E=>{u[E]&&(b[E]=u[E])})),Object.keys(b).length&&ja.G(c,b,p,m,g,x)}catch(E){pn.B(E)}},V:function(c,u){try{be==null||be.localStorage.removeItem(c),ja.V(c,u)}catch(p){pn.B(p)}}})})(e.cookie_persisted_properties||[]),n=e.persistence.toLowerCase();return n==="localstorage"&&pn.H()?pn:n==="localstorage+cookie"&&t.H()?t:n==="sessionstorage"&&vs.H()?vs:n==="memory"?jz:n==="cookie"?ja:t.H()?t:ja}properties(){var e={};return Xr(this.props,(function(t,n){if(n===Vf&&Vn(t))for(var s=Object.keys(t),i=0;i<s.length;i++)e["$feature/"+s[i]]=t[s[i]];else u=n,p=!1,(Xi(c=hz)?p:kC&&c.indexOf===kC?c.indexOf(u)!=-1:(Xr(c,(function(m){if(p||(p=m===u))return iy})),p))||(e[n]=t);var c,u,p})),e}load(){if(!this.Pi){var e=this.Y.W(this.Si);e&&(this.props=Rn({},e))}}save(){this.Pi||this.Y.G(this.Si,this.props,this.Ti,this.Ii,this.Ci,this.R.debug)}remove(){this.Y.V(this.Si,!1),this.Y.V(this.Si,!0)}clear(){this.remove(),this.props={}}register_once(e,t,n){if(Vn(e)){Ke(t)&&(t="None"),this.Ti=Ke(n)?this.Ri:n;var s=!1;if(Xr(e,((i,c)=>{this.props.hasOwnProperty(c)&&this.props[c]!==t||(this.props[c]=i,s=!0)})),s)return this.save(),!0}return!1}register(e,t){if(Vn(e)){this.Ti=Ke(t)?this.Ri:t;var n=!1;if(Xr(e,((s,i)=>{e.hasOwnProperty(i)&&this.props[i]!==s&&(this.props[i]=s,n=!0)})),n)return this.save(),!0}return!1}unregister(e){e in this.props&&(delete this.props[e],this.save())}update_campaign_params(){if(!this.$i){var e=NR(this.R.custom_campaign_params,this.R.mask_personal_data_properties,this.R.custom_personal_data_properties);Wf(rE(e))||this.register(e),this.$i=!0}}update_search_keyword(){var e;this.register((e=qe==null?void 0:qe.referrer)?RR(e):{})}update_referrer_info(){var e;this.register_once({$referrer:AR(),$referring_domain:qe!=null&&qe.referrer&&((e=fy(qe.referrer))==null?void 0:e.host)||"$direct"},void 0)}set_initial_person_info(){this.props[sb]||this.props[ob]||this.register_once({[cy]:IR(this.R.mask_personal_data_properties,this.R.custom_personal_data_properties)},void 0)}get_initial_props(){var e={};Xr([ob,sb],(c=>{var u=this.props[c];u&&Xr(u,(function(p,m){e["$initial_"+Ww(m)]=p}))}));var t,n,s=this.props[cy];if(s){var i=(t=PR(s),n={},Xr(t,(function(c,u){n["$initial_"+Ww(u)]=c})),n);Rn(e,i)}return e}safe_merge(e){return Xr(this.props,(function(t,n){n in e||(e[n]=t)})),e}update_config(e,t,n){if(this.Ri=this.Ti=e.cookie_expiration,this.set_disabled(e.disable_persistence||!!n),this.set_cross_subdomain(e.cross_subdomain_cookie),this.set_secure(e.secure_cookie),e.persistence!==t.persistence||!((c,u)=>{if(c.length!==u.length)return!1;var p=[...c].sort(),m=[...u].sort();return p.every(((g,x)=>g===m[x]))})(e.cookie_persisted_properties||[],t.cookie_persisted_properties||[])){var s=this.ki(e),i=this.props;this.clear(),this.Y=s,this.props=i,this.save()}}set_disabled(e){this.Pi=e,this.Pi?this.remove():this.save()}set_cross_subdomain(e){e!==this.Ii&&(this.Ii=e,this.remove(),this.save())}set_secure(e){e!==this.Ci&&(this.Ci=e,this.remove(),this.save())}set_event_timer(e,t){var n=this.props[im]||{};n[e]=t,this.props[im]=n,this.save()}remove_event_timer(e){var t=(this.props[im]||{})[e];return Ke(t)||(delete this.props[im][e],this.save()),t}get_property(e){return this.props[e]}set_property(e,t){this.props[e]=t,this.save()}}var mk=bn("[Product Tours]"),Kx="ph_product_tours";class hH{constructor(e){this.Fi=null,this.Oi=null,this._instance=e}onRemoteConfig(e){this._instance.persistence&&this._instance.persistence.register({[HC]:!(e==null||!e.productTours)}),this.loadIfEnabled()}loadIfEnabled(){var e,t;this.Fi||(e=this._instance).config.disable_product_tours||(t=e.persistence)==null||!t.get_property(HC)||this.it((()=>this.Mi()))}it(e){var t,n;(t=Et.__PosthogExtensions__)!=null&&t.generateProductTours?e():(n=Et.__PosthogExtensions__)==null||n.loadExternalDependency==null||n.loadExternalDependency(this._instance,"product-tours",(s=>{s?mk.error("Could not load product tours script",s):e()}))}Mi(){var e;!this.Fi&&(e=Et.__PosthogExtensions__)!=null&&e.generateProductTours&&(this.Fi=Et.__PosthogExtensions__.generateProductTours(this._instance,!0))}getProductTours(e,t){if(t===void 0&&(t=!1),!Fr(this.Oi)||t){var n=this._instance.persistence;if(n){var s=n.props[Kx];if(Fr(s)&&!t)return this.Oi=s,void e(s,{isLoaded:!0})}this._instance._send_request({url:this._instance.requestRouter.endpointFor("api","/api/product_tours/?token="+this._instance.config.token),method:"GET",callback:i=>{var c=i.statusCode;if(c!==200||!i.json){var u="Product Tours API could not be loaded, status: "+c;return mk.error(u),void e([],{isLoaded:!1,error:u})}var p=Fr(i.json.product_tours)?i.json.product_tours:[];this.Oi=p,n&&n.register({[Kx]:p}),e(p,{isLoaded:!0})}})}else e(this.Oi,{isLoaded:!0})}getActiveProductTours(e){cr(this.Fi)?e([],{isLoaded:!1,error:"Product tours not loaded"}):this.Fi.getActiveProductTours(e)}showProductTour(e){var t;(t=this.Fi)==null||t.showTourById(e)}previewTour(e){this.Fi?this.Fi.previewTour(e):this.it((()=>{var t;this.Mi(),(t=this.Fi)==null||t.previewTour(e)}))}dismissProductTour(){var e;(e=this.Fi)==null||e.dismissTour("user_clicked_skip")}nextStep(){var e;(e=this.Fi)==null||e.nextStep()}previousStep(){var e;(e=this.Fi)==null||e.previousStep()}clearCache(){var e;this.Oi=null,(e=this._instance.persistence)==null||e.unregister(Kx)}resetTour(e){var t;(t=this.Fi)==null||t.resetTour(e)}resetAllTours(){var e;(e=this.Fi)==null||e.resetAllTours()}cancelPendingTour(e){var t;(t=this.Fi)==null||t.cancelPendingTour(e)}}var qp=(function(r){return r.Activation="events",r.Cancellation="cancelEvents",r})({});(function(r){return r.Button="button",r.Tab="tab",r.Selector="selector",r})({});(function(r){return r.TopLeft="top_left",r.TopRight="top_right",r.TopCenter="top_center",r.MiddleLeft="middle_left",r.MiddleRight="middle_right",r.MiddleCenter="middle_center",r.Left="left",r.Center="center",r.Right="right",r.NextToTrigger="next_to_trigger",r})({});(function(r){return r.Top="top",r.Left="left",r.Right="right",r.Bottom="bottom",r})({});var Yx=(function(r){return r.Popover="popover",r.API="api",r.Widget="widget",r.ExternalSurvey="external_survey",r})({});(function(r){return r.Open="open",r.MultipleChoice="multiple_choice",r.SingleChoice="single_choice",r.Rating="rating",r.Link="link",r})({});(function(r){return r.NextQuestion="next_question",r.End="end",r.ResponseBased="response_based",r.SpecificQuestion="specific_question",r})({});(function(r){return r.Once="once",r.Recurring="recurring",r.Always="always",r})({});var um=(function(r){return r.SHOWN="survey shown",r.DISMISSED="survey dismissed",r.SENT="survey sent",r.ABANDONED="survey abandoned",r})({}),Jx=(function(r){return r.SURVEY_ID="$survey_id",r.SURVEY_NAME="$survey_name",r.SURVEY_RESPONSE="$survey_response",r.SURVEY_ITERATION="$survey_iteration",r.SURVEY_ITERATION_START_DATE="$survey_iteration_start_date",r.SURVEY_PARTIALLY_COMPLETED="$survey_partially_completed",r.SURVEY_SUBMISSION_ID="$survey_submission_id",r.SURVEY_QUESTIONS="$survey_questions",r.SURVEY_COMPLETED="$survey_completed",r.PRODUCT_TOUR_ID="$product_tour_id",r.SURVEY_LAST_SEEN_DATE="$survey_last_seen_date",r})({}),ub=(function(r){return r.Popover="popover",r.Inline="inline",r})({}),Vr=bn("[Surveys]"),zR="seenSurvey_",pH=(r,e)=>{var t="$survey_"+e+"/"+r.id;return r.current_iteration&&r.current_iteration>0&&(t="$survey_"+e+"/"+r.id+"/"+r.current_iteration),t},gk=r=>((e,t)=>{var n=""+e+t.id;return t.current_iteration&&t.current_iteration>0&&(n=""+e+t.id+"_"+t.current_iteration),n})(zR,r),mH=[Yx.Popover,Yx.Widget,Yx.API],gH={ignoreConditions:!1,ignoreDelay:!1,displayType:ub.Popover};class lE{constructor(){this.Ai={},this.Ai={}}on(e,t){return this.Ai[e]||(this.Ai[e]=[]),this.Ai[e].push(t),()=>{this.Ai[e]=this.Ai[e].filter((n=>n!==t))}}emit(e,t){for(var n of this.Ai[e]||[])n(t);for(var s of this.Ai["*"]||[])s(e,t)}}function Of(r,e,t){if(cr(r))return!1;switch(t){case"exact":return r===e;case"contains":var n=e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/_/g,".").replace(/%/g,".*");return new RegExp(n,"i").test(r);case"regex":try{return new RegExp(e).test(r)}catch{return!1}default:return!1}}class vH{constructor(e){this.ji=new lE,this.Di=(t,n)=>this.Li(t,n)&&this.Ni(t,n)&&this.Ui(t,n)&&this.zi(t,n),this.Li=(t,n)=>n==null||!n.event||(t==null?void 0:t.event)===(n==null?void 0:n.event),this._instance=e,this.Hi=new Set,this.Bi=new Set}init(){var e;if(!Ke((e=this._instance)==null?void 0:e._addCaptureHook)){var t;(t=this._instance)==null||t._addCaptureHook(((n,s)=>{this.on(n,s)}))}}register(e){var t,n;if(!Ke((t=this._instance)==null?void 0:t._addCaptureHook)&&(e.forEach((c=>{var u,p;(u=this.Bi)==null||u.add(c),(p=c.steps)==null||p.forEach((m=>{var g;(g=this.Hi)==null||g.add((m==null?void 0:m.event)||"")}))})),(n=this._instance)!=null&&n.autocapture)){var s,i=new Set;e.forEach((c=>{var u;(u=c.steps)==null||u.forEach((p=>{p!=null&&p.selector&&i.add(p==null?void 0:p.selector)}))})),(s=this._instance)==null||s.autocapture.setElementSelectors(i)}}on(e,t){var n;t!=null&&e.length!=0&&(this.Hi.has(e)||this.Hi.has(t==null?void 0:t.event))&&this.Bi&&((n=this.Bi)==null?void 0:n.size)>0&&this.Bi.forEach((s=>{this.qi(t,s)&&this.ji.emit("actionCaptured",s.name)}))}Wi(e){this.onAction("actionCaptured",(t=>e(t)))}qi(e,t){if((t==null?void 0:t.steps)==null)return!1;for(var n of t.steps)if(this.Di(e,n))return!0;return!1}onAction(e,t){return this.ji.on(e,t)}Ni(e,t){if(t!=null&&t.url){var n,s=e==null||(n=e.properties)==null?void 0:n.$current_url;if(!s||typeof s!="string"||!Of(s,t.url,t.url_matching||"contains"))return!1}return!0}Ui(e,t){return!!this.Gi(e,t)&&!!this.Vi(e,t)&&!!this.Ji(e,t)}Gi(e,t){var n;if(t==null||!t.href)return!0;var s=this.Ki(e);if(s.length>0)return s.some((u=>Of(u.href,t.href,t.href_matching||"exact")));var i,c=(e==null||(n=e.properties)==null?void 0:n.$elements_chain)||"";return!!c&&Of((i=c.match(/(?::|")href="(.*?)"/))?i[1]:"",t.href,t.href_matching||"exact")}Vi(e,t){var n;if(t==null||!t.text)return!0;var s=this.Ki(e);if(s.length>0)return s.some((m=>Of(m.text,t.text,t.text_matching||"exact")||Of(m.$el_text,t.text,t.text_matching||"exact")));var i,c,u,p=(e==null||(n=e.properties)==null?void 0:n.$elements_chain)||"";return!!p&&(i=(function(m){for(var g,x=[],b=/(?::|")text="(.*?)"/g;!cr(g=b.exec(m));)x.includes(g[1])||x.push(g[1]);return x})(p),c=t.text,u=t.text_matching||"exact",i.some((m=>Of(m,c,u))))}Ji(e,t){var n,s;if(t==null||!t.selector)return!0;var i=e==null||(n=e.properties)==null?void 0:n.$element_selectors;if(i!=null&&i.includes(t.selector))return!0;var c=(e==null||(s=e.properties)==null?void 0:s.$elements_chain)||"";if(t.selector_regex&&c)try{return new RegExp(t.selector_regex).test(c)}catch{return!1}return!1}Ki(e){var t;return(e==null||(t=e.properties)==null?void 0:t.$elements)==null?[]:e==null?void 0:e.properties.$elements}zi(e,t){return t==null||!t.properties||t.properties.length===0||UR(t.properties.reduce(((n,s)=>{var i=Fr(s.value)?s.value.map(String):s.value!=null?[String(s.value)]:[];return n[s.key]={values:i,operator:s.operator||"exact"},n}),{}),e==null?void 0:e.properties)}}class yH{constructor(e){this._instance=e,this.Yi=new Map,this.Xi=new Map,this.Qi=new Map}Zi(e,t){return!!e&&UR(e.propertyFilters,t==null?void 0:t.properties)}te(e,t){var n=new Map;return e.forEach((s=>{var i;(i=s.conditions)==null||(i=i[t])==null||(i=i.values)==null||i.forEach((c=>{if(c!=null&&c.name){var u=n.get(c.name)||[];u.push(s.id),n.set(c.name,u)}}))})),n}ie(e,t,n){var s=(n===qp.Activation?this.Yi:this.Xi).get(e),i=[];return this.ee((c=>{i=c.filter((u=>s==null?void 0:s.includes(u.id)))})),i.filter((c=>{var u,p=(u=c.conditions)==null||(u=u[n])==null||(u=u.values)==null?void 0:u.find((m=>m.name===e));return this.Zi(p,t)}))}register(e){var t;Ke((t=this._instance)==null?void 0:t._addCaptureHook)||(this.re(e),this.se(e))}se(e){var t=e.filter((n=>{var s,i;return((s=n.conditions)==null?void 0:s.actions)&&((i=n.conditions)==null||(i=i.actions)==null||(i=i.values)==null?void 0:i.length)>0}));t.length!==0&&(this.ne==null&&(this.ne=new vH(this._instance),this.ne.init(),this.ne.Wi((n=>{this.onAction(n)}))),t.forEach((n=>{var s,i,c,u,p;n.conditions&&(s=n.conditions)!=null&&s.actions&&(i=n.conditions)!=null&&(i=i.actions)!=null&&i.values&&((c=n.conditions)==null||(c=c.actions)==null||(c=c.values)==null?void 0:c.length)>0&&((u=this.ne)==null||u.register(n.conditions.actions.values),(p=n.conditions)==null||(p=p.actions)==null||(p=p.values)==null||p.forEach((m=>{if(m&&m.name){var g=this.Qi.get(m.name);g&&g.push(n.id),this.Qi.set(m.name,g||[n.id])}})))})))}re(e){var t,n=e.filter((i=>{var c,u;return((c=i.conditions)==null?void 0:c.events)&&((u=i.conditions)==null||(u=u.events)==null||(u=u.values)==null?void 0:u.length)>0})),s=e.filter((i=>{var c,u;return((c=i.conditions)==null?void 0:c.cancelEvents)&&((u=i.conditions)==null||(u=u.cancelEvents)==null||(u=u.values)==null?void 0:u.length)>0}));(n.length!==0||s.length!==0)&&((t=this._instance)==null||t._addCaptureHook(((i,c)=>{this.onEvent(i,c)})),this.Yi=this.te(e,qp.Activation),this.Xi=this.te(e,qp.Cancellation))}onEvent(e,t){var n,s=this.oe(),i=this.ae(),c=this.le(),u=((n=this._instance)==null||(n=n.persistence)==null?void 0:n.props[i])||[];if(c===e&&t&&u.length>0){var p,m;s.info("event matched, removing item from activated items",{event:e,eventPayload:t,existingActivatedItems:u});var g=(t==null||(p=t.properties)==null?void 0:p.$survey_id)||(t==null||(m=t.properties)==null?void 0:m.$product_tour_id);if(g){var x=u.indexOf(g);x>=0&&(u.splice(x,1),this.ue(u))}}else{if(this.Xi.has(e)){var b=this.ie(e,t,qp.Cancellation);b.length>0&&(s.info("cancel event matched, cancelling items",{event:e,itemsToCancel:b.map((T=>T.id))}),b.forEach((T=>{var S=u.indexOf(T.id);S>=0&&u.splice(S,1),this.he(T.id)})),this.ue(u))}if(this.Yi.has(e)){s.info("event name matched",{event:e,eventPayload:t,items:this.Yi.get(e)});var E=this.ie(e,t,qp.Activation);this.ue(u.concat(E.map((T=>T.id))||[]))}}}onAction(e){var t,n=this.ae(),s=((t=this._instance)==null||(t=t.persistence)==null?void 0:t.props[n])||[];this.Qi.has(e)&&this.ue(s.concat(this.Qi.get(e)||[]))}ue(e){var t,n=this.oe(),s=this.ae(),i=[...new Set(e)].filter((c=>!this.de(c)));n.info("updating activated items",{activatedItems:i}),(t=this._instance)==null||(t=t.persistence)==null||t.register({[s]:i})}getActivatedIds(){var e,t=this.ae(),n=(e=this._instance)==null||(e=e.persistence)==null?void 0:e.props[t];return n||[]}getEventToItemsMap(){return this.Yi}ve(){return this.ne}}class xH extends yH{constructor(e){super(e)}ae(){return"$surveys_activated"}le(){return um.SHOWN}ee(e){var t;(t=this._instance)==null||t.getSurveys(e)}he(e){var t;(t=this._instance)==null||t.cancelPendingSurvey(e)}oe(){return Vr}de(){return!1}getSurveys(){return this.getActivatedIds()}getEventToSurveys(){return this.getEventToItemsMap()}}class wH{constructor(e){this.ce=void 0,this._surveyManager=null,this.fe=!1,this.pe=[],this.ge=null,this._instance=e,this._surveyEventReceiver=null}onRemoteConfig(e){if(!this._instance.config.disable_surveys){var t=e.surveys;if(cr(t))return Vr.warn("Flags not loaded yet. Not loading surveys.");var n=Fr(t);this.ce=n?t.length>0:t,Vr.info("flags response received, isSurveysEnabled: "+this.ce),this.loadIfEnabled()}}reset(){localStorage.removeItem("lastSeenSurveyDate");for(var e=[],t=0;t<localStorage.length;t++){var n=localStorage.key(t);(n!=null&&n.startsWith(zR)||n!=null&&n.startsWith("inProgressSurvey_"))&&e.push(n)}e.forEach((s=>localStorage.removeItem(s)))}loadIfEnabled(){if(!this._surveyManager)if(this.fe)Vr.info("Already initializing surveys, skipping...");else if(this._instance.config.disable_surveys)Vr.info("Disabled. Not loading surveys.");else if(this._instance.config.cookieless_mode&&this._instance.consent.isOptedOut())Vr.info("Not loading surveys in cookieless mode without consent.");else{var e=Et==null?void 0:Et.__PosthogExtensions__;if(e){if(!Ke(this.ce)||this._instance.config.advanced_enable_surveys){var t=this.ce||this._instance.config.advanced_enable_surveys;this.fe=!0;try{var n=e.generateSurveys;if(n)return void this._e(n,t);var s=e.loadExternalDependency;if(!s)return void this.me("PostHog loadExternalDependency extension not found.");s(this._instance,"surveys",(i=>{i||!e.generateSurveys?this.me("Could not load surveys script",i):this._e(e.generateSurveys,t)}))}catch(i){throw this.me("Error initializing surveys",i),i}finally{this.fe=!1}}}else Vr.error("PostHog Extensions not found.")}}_e(e,t){this._surveyManager=e(this._instance,t),this._surveyEventReceiver=new xH(this._instance),Vr.info("Surveys loaded successfully"),this.be({isLoaded:!0})}me(e,t){Vr.error(e,t),this.be({isLoaded:!1,error:e})}onSurveysLoaded(e){return this.pe.push(e),this._surveyManager&&this.be({isLoaded:!0}),()=>{this.pe=this.pe.filter((t=>t!==e))}}getSurveys(e,t){if(t===void 0&&(t=!1),this._instance.config.disable_surveys)return Vr.info("Disabled. Not loading surveys."),e([]);var n,s=this._instance.get_property(tb);if(s&&!t)return e(s,{isLoaded:!0});typeof Promise<"u"&&this.ge?this.ge.then((i=>{var{surveys:c,context:u}=i;return e(c,u)})):(typeof Promise<"u"&&(this.ge=new Promise((i=>{n=i}))),this._instance._send_request({url:this._instance.requestRouter.endpointFor("api","/api/surveys/?token="+this._instance.config.token),method:"GET",timeout:this._instance.config.surveys_request_timeout_ms,callback:i=>{var c;this.ge=null;var u=i.statusCode;if(u!==200||!i.json){var p="Surveys API could not be loaded, status: "+u;Vr.error(p);var m={isLoaded:!1,error:p};return e([],m),void(n==null||n({surveys:[],context:m}))}var g,x=i.json.surveys||[],b=x.filter((T=>(function(S){return!(!S.start_date||S.end_date)})(T)&&((function(S){var N;return!((N=S.conditions)==null||(N=N.events)==null||(N=N.values)==null||!N.length)})(T)||(function(S){var N;return!((N=S.conditions)==null||(N=N.actions)==null||(N=N.values)==null||!N.length)})(T))));b.length>0&&((g=this._surveyEventReceiver)==null||g.register(b)),(c=this._instance.persistence)==null||c.register({[tb]:x});var E={isLoaded:!0};e(x,E),n==null||n({surveys:x,context:E})}}))}be(e){for(var t of this.pe)try{if(!e.isLoaded)return t([],e);this.getSurveys(t)}catch(n){Vr.error("Error in survey callback",n)}}getActiveMatchingSurveys(e,t){if(t===void 0&&(t=!1),!cr(this._surveyManager))return this._surveyManager.getActiveMatchingSurveys(e,t);Vr.warn("init was not called")}ye(e){var t=null;return this.getSurveys((n=>{var s;t=(s=n.find((i=>i.id===e)))!==null&&s!==void 0?s:null})),t}we(e){if(cr(this._surveyManager))return{eligible:!1,reason:"SDK is not enabled or survey functionality is not yet loaded"};var t=typeof e=="string"?this.ye(e):e;return t?this._surveyManager.checkSurveyEligibility(t):{eligible:!1,reason:"Survey not found"}}canRenderSurvey(e){if(cr(this._surveyManager))return Vr.warn("init was not called"),{visible:!1,disabledReason:"SDK is not enabled or survey functionality is not yet loaded"};var t=this.we(e);return{visible:t.eligible,disabledReason:t.reason}}canRenderSurveyAsync(e,t){return cr(this._surveyManager)?(Vr.warn("init was not called"),Promise.resolve({visible:!1,disabledReason:"SDK is not enabled or survey functionality is not yet loaded"})):new Promise((n=>{this.getSurveys((s=>{var i,c=(i=s.find((p=>p.id===e)))!==null&&i!==void 0?i:null;if(c){var u=this.we(c);n({visible:u.eligible,disabledReason:u.reason})}else n({visible:!1,disabledReason:"Survey not found"})}),t)}))}renderSurvey(e,t,n){var s;if(cr(this._surveyManager))Vr.warn("init was not called");else{var i=typeof e=="string"?this.ye(e):e;if(i!=null&&i.id)if(mH.includes(i.type)){var c=qe==null?void 0:qe.querySelector(t);if(c)return(s=i.appearance)!=null&&s.surveyPopupDelaySeconds?(Vr.info("Rendering survey "+i.id+" with delay of "+i.appearance.surveyPopupDelaySeconds+" seconds"),void setTimeout((()=>{var u,p;Vr.info("Rendering survey "+i.id+" with delay of "+((u=i.appearance)==null?void 0:u.surveyPopupDelaySeconds)+" seconds"),(p=this._surveyManager)==null||p.renderSurvey(i,c,n),Vr.info("Survey "+i.id+" rendered")}),1e3*i.appearance.surveyPopupDelaySeconds)):void this._surveyManager.renderSurvey(i,c,n);Vr.warn("Survey element not found")}else Vr.warn("Surveys of type "+i.type+" cannot be rendered in the app");else Vr.warn("Survey not found")}}displaySurvey(e,t){var n;if(cr(this._surveyManager))Vr.warn("init was not called");else{var s=this.ye(e);if(s){var i=s;if((n=s.appearance)!=null&&n.surveyPopupDelaySeconds&&t.ignoreDelay&&(i=et({},s,{appearance:et({},s.appearance,{surveyPopupDelaySeconds:0})})),t.displayType!==ub.Popover&&t.initialResponses&&Vr.warn("initialResponses is only supported for popover surveys. prefill will not be applied."),t.ignoreConditions===!1){var c=this.canRenderSurvey(s);if(!c.visible)return void Vr.warn("Survey is not eligible to be displayed: ",c.disabledReason)}t.displayType!==ub.Inline?this._surveyManager.handlePopoverSurvey(i,t):this.renderSurvey(i,t.selector,t.properties)}else Vr.warn("Survey not found")}}cancelPendingSurvey(e){cr(this._surveyManager)?Vr.warn("init was not called"):this._surveyManager.cancelSurvey(e)}handlePageUnload(){var e;(e=this._surveyManager)==null||e.handlePageUnload()}}var Cl=bn("[Conversations]");class bH{constructor(e){this.xe=void 0,this._conversationsManager=null,this.Ee=!1,this.$e=null,this._instance=e}onRemoteConfig(e){if(!this._instance.config.disable_conversations){var t=e.conversations;cr(t)||(Ol(t)?this.xe=t:(this.xe=t.enabled,this.$e=t),this.loadIfEnabled())}}reset(){var e;(e=this._conversationsManager)==null||e.reset(),this._conversationsManager=null,this.xe=void 0,this.$e=null}loadIfEnabled(){if(!this._conversationsManager&&!this.Ee&&!(this._instance.config.disable_conversations||this._instance.config.cookieless_mode&&this._instance.consent.isOptedOut())){var e=Et==null?void 0:Et.__PosthogExtensions__;if(e&&!Ke(this.xe)&&this.xe)if(this.$e&&this.$e.token){this.Ee=!0;try{var t=e.initConversations;if(t)return this.Se(t),void(this.Ee=!1);var n=e.loadExternalDependency;if(!n)return void this.ke("PostHog loadExternalDependency extension not found.");n(this._instance,"conversations",(s=>{s||!e.initConversations?this.ke("Could not load conversations script",s):this.Se(e.initConversations),this.Ee=!1}))}catch(s){this.ke("Error initializing conversations",s),this.Ee=!1}}else Cl.error("Conversations enabled but missing token in remote config.")}}Se(e){if(this.$e)try{this._conversationsManager=e(this.$e,this._instance),Cl.info("Conversations loaded successfully")}catch(t){this.ke("Error completing conversations initialization",t)}else Cl.error("Cannot complete initialization: remote config is null")}ke(e,t){Cl.error(e,t),this._conversationsManager=null,this.Ee=!1}show(){this._conversationsManager?this._conversationsManager.show():Cl.warn("Conversations not loaded yet.")}hide(){this._conversationsManager&&this._conversationsManager.hide()}isAvailable(){return this.xe===!0&&!Xi(this._conversationsManager)}isVisible(){var e,t;return(e=(t=this._conversationsManager)==null?void 0:t.isVisible())!==null&&e!==void 0&&e}sendMessage(e,t,n){var s=this;return Gf((function*(){return s._conversationsManager?s._conversationsManager.sendMessage(e,t,n):(Cl.warn("Conversations not available yet."),null)}))()}getMessages(e,t){var n=this;return Gf((function*(){return n._conversationsManager?n._conversationsManager.getMessages(e,t):(Cl.warn("Conversations not available yet."),null)}))()}markAsRead(e){var t=this;return Gf((function*(){return t._conversationsManager?t._conversationsManager.markAsRead(e):(Cl.warn("Conversations not available yet."),null)}))()}getTickets(e){var t=this;return Gf((function*(){return t._conversationsManager?t._conversationsManager.getTickets(e):(Cl.warn("Conversations not available yet."),null)}))()}getCurrentTicketId(){var e,t;return(e=(t=this._conversationsManager)==null?void 0:t.getCurrentTicketId())!==null&&e!==void 0?e:null}getWidgetSessionId(){var e,t;return(e=(t=this._conversationsManager)==null?void 0:t.getWidgetSessionId())!==null&&e!==void 0?e:null}}class _H{constructor(e){var t;this.Pe=!1,this.Te=!1,this._instance=e,this._instance&&(t=this._instance.config.logs)!=null&&t.captureConsoleLogs&&(this.Pe=!0)}onRemoteConfig(e){var t,n=(t=e.logs)==null?void 0:t.captureConsoleLogs;!cr(n)&&n&&(this.Pe=!0,this.loadIfEnabled())}reset(){}loadIfEnabled(){if(this.Pe&&!this.Te){var e=bn("[logs]"),t=Et==null?void 0:Et.__PosthogExtensions__;if(t){var n=t.loadExternalDependency;n?n(this._instance,"logs",(s=>{var i;s||(i=t.logs)==null||!i.initializeLogs?e.error("Could not load logs script",s):(t.logs.initializeLogs(this._instance),this.Te=!0)})):e.error("PostHog loadExternalDependency extension not found.")}else e.error("PostHog Extensions not found.")}}}var vk=bn("[RateLimiter]");class EH{constructor(e){this.serverLimits={},this.lastEventRateLimited=!1,this.checkForLimiting=t=>{var n=t.text;if(n&&n.length)try{(JSON.parse(n).quota_limited||[]).forEach((s=>{vk.info((s||"events")+" is quota limited."),this.serverLimits[s]=new Date().getTime()+6e4}))}catch(s){return void vk.warn('could not rate limit - continuing. Error: "'+(s==null?void 0:s.message)+'"',{text:n})}},this.instance=e,this.lastEventRateLimited=this.clientRateLimitContext(!0).isRateLimited}get captureEventsPerSecond(){var e;return((e=this.instance.config.rate_limiting)==null?void 0:e.events_per_second)||10}get captureEventsBurstLimit(){var e;return Math.max(((e=this.instance.config.rate_limiting)==null?void 0:e.events_burst_limit)||10*this.captureEventsPerSecond,this.captureEventsPerSecond)}clientRateLimitContext(e){var t,n,s;e===void 0&&(e=!1);var{captureEventsBurstLimit:i,captureEventsPerSecond:c}=this,u=new Date().getTime(),p=(t=(n=this.instance.persistence)==null?void 0:n.get_property(nb))!==null&&t!==void 0?t:{tokens:i,last:u};p.tokens+=(u-p.last)/1e3*c,p.last=u,p.tokens>i&&(p.tokens=i);var m=p.tokens<1;return m||e||(p.tokens=Math.max(0,p.tokens-1)),!m||this.lastEventRateLimited||e||this.instance.capture("$$client_ingestion_warning",{$$client_ingestion_warning_message:"posthog-js client rate limited. Config is set to "+c+" events per second and "+i+" events burst limit."},{skip_client_rate_limiting:!0}),this.lastEventRateLimited=m,(s=this.instance.persistence)==null||s.set_property(nb,p),{isRateLimited:m,remainingTokens:p.tokens}}isServerRateLimited(e){var t=this.serverLimits[e||"events"]||!1;return t!==!1&&new Date().getTime()<t}}var Wu=bn("[RemoteConfig]");class SH{constructor(e){this._instance=e}get remoteConfig(){var e;return(e=Et._POSTHOG_REMOTE_CONFIG)==null||(e=e[this._instance.config.token])==null?void 0:e.config}Ie(e){var t,n;(t=Et.__PosthogExtensions__)!=null&&t.loadExternalDependency?(n=Et.__PosthogExtensions__)==null||n.loadExternalDependency==null||n.loadExternalDependency(this._instance,"remote-config",(()=>e(this.remoteConfig))):(Wu.error("PostHog Extensions not found. Cannot load remote config."),e())}Ce(e){this._instance._send_request({method:"GET",url:this._instance.requestRouter.endpointFor("assets","/array/"+this._instance.config.token+"/config"),callback:t=>{e(t.json)}})}load(){try{if(this.remoteConfig)return Wu.info("Using preloaded remote config",this.remoteConfig),void this.wi(this.remoteConfig);if(this._instance.M())return void Wu.warn("Remote config is disabled. Falling back to local config.");this.Ie((e=>{if(!e)return Wu.info("No config found after loading remote JS config. Falling back to JSON."),void this.Ce((t=>{this.wi(t)}));this.wi(e)}))}catch(e){Wu.error("Error loading remote config",e)}}wi(e){e?this._instance.config.__preview_remote_config?(this._instance.wi(e),e.hasFeatureFlags!==!1&&this._instance.featureFlags.ensureFlagsLoaded()):Wu.info("__preview_remote_config is disabled. Logging config instead",e):Wu.error("Failed to fetch remote config from PostHog.")}}var db=3e3;class CH{constructor(e,t){this.Re=!0,this.Fe=[],this.Oe=La((t==null?void 0:t.flush_interval_ms)||db,250,5e3,Qe.createLogger("flush interval"),db),this.Me=e}enqueue(e){this.Fe.push(e),this.Ae||this.je()}unload(){this.De();var e=this.Fe.length>0?this.Le():{},t=Object.values(e);[...t.filter((n=>n.url.indexOf("/e")===0)),...t.filter((n=>n.url.indexOf("/e")!==0))].map((n=>{this.Me(et({},n,{transport:"sendBeacon"}))}))}enable(){this.Re=!1,this.je()}je(){var e=this;this.Re||(this.Ae=setTimeout((()=>{if(this.De(),this.Fe.length>0){var t=this.Le(),n=function(){var i=t[s],c=new Date().getTime();i.data&&Fr(i.data)&&Xr(i.data,(u=>{u.offset=Math.abs(u.timestamp-c),delete u.timestamp})),e.Me(i)};for(var s in t)n()}}),this.Oe))}De(){clearTimeout(this.Ae),this.Ae=void 0}Le(){var e={};return Xr(this.Fe,(t=>{var n,s=t,i=(s?s.batchKey:null)||s.url;Ke(e[i])&&(e[i]=et({},s,{data:[]})),(n=e[i].data)==null||n.push(s.data)})),this.Fe=[],e}}var kH=["retriesPerformedSoFar"];class NH{constructor(e){this.Ne=!1,this.Ue=3e3,this.Fe=[],this._instance=e,this.Fe=[],this.ze=!0,!Ke(be)&&"onLine"in be.navigator&&(this.ze=be.navigator.onLine,this.He=()=>{this.ze=!0,this.Lt()},this.Be=()=>{this.ze=!1},Ln(be,"online",this.He),Ln(be,"offline",this.Be))}get length(){return this.Fe.length}retriableRequest(e){var{retriesPerformedSoFar:t}=e,n=DT(e,kH);zf(t)&&(n.url=vy(n.url,{retry_count:t})),this._instance._send_request(et({},n,{callback:s=>{s.statusCode!==200&&(s.statusCode<400||s.statusCode>=500)&&(t??0)<10?this.qe(et({retriesPerformedSoFar:t},n)):n.callback==null||n.callback(s)}}))}qe(e){var t=e.retriesPerformedSoFar||0;e.retriesPerformedSoFar=t+1;var n=(function(c){var u=3e3*Math.pow(2,c),p=u/2,m=Math.min(18e5,u),g=(Math.random()-.5)*(m-p);return Math.ceil(m+g)})(t),s=Date.now()+n;this.Fe.push({retryAt:s,requestOptions:e});var i="Enqueued failed request for retry in "+n;navigator.onLine||(i+=" (Browser is offline)"),Qe.warn(i),this.Ne||(this.Ne=!0,this.We())}We(){if(this.Ge&&clearTimeout(this.Ge),this.Fe.length===0)return this.Ne=!1,void(this.Ge=void 0);this.Ge=setTimeout((()=>{this.ze&&this.Fe.length>0&&this.Lt(),this.We()}),this.Ue)}Lt(){var e=Date.now(),t=[],n=this.Fe.filter((i=>i.retryAt<e||(t.push(i),!1)));if(this.Fe=t,n.length>0)for(var{requestOptions:s}of n)this.retriableRequest(s)}unload(){for(var{requestOptions:e}of(this.Ge&&(clearTimeout(this.Ge),this.Ge=void 0),this.Ne=!1,Ke(be)||(this.He&&(be.removeEventListener("online",this.He),this.He=void 0),this.Be&&(be.removeEventListener("offline",this.Be),this.Be=void 0)),this.Fe))try{this._instance._send_request(et({},e,{transport:"sendBeacon"}))}catch(t){Qe.error(t)}this.Fe=[]}}class TH{constructor(e){this.Ve=()=>{var t,n,s,i;this.Je||(this.Je={});var c=this.scrollElement(),u=this.scrollY(),p=c?Math.max(0,c.scrollHeight-c.clientHeight):0,m=u+((c==null?void 0:c.clientHeight)||0),g=(c==null?void 0:c.scrollHeight)||0;this.Je.lastScrollY=Math.ceil(u),this.Je.maxScrollY=Math.max(u,(t=this.Je.maxScrollY)!==null&&t!==void 0?t:0),this.Je.maxScrollHeight=Math.max(p,(n=this.Je.maxScrollHeight)!==null&&n!==void 0?n:0),this.Je.lastContentY=m,this.Je.maxContentY=Math.max(m,(s=this.Je.maxContentY)!==null&&s!==void 0?s:0),this.Je.maxContentHeight=Math.max(g,(i=this.Je.maxContentHeight)!==null&&i!==void 0?i:0)},this._instance=e}getContext(){return this.Je}resetContext(){var e=this.Je;return setTimeout(this.Ve,0),e}startMeasuringScrollPosition(){Ln(be,"scroll",this.Ve,{capture:!0}),Ln(be,"scrollend",this.Ve,{capture:!0}),Ln(be,"resize",this.Ve)}scrollElement(){if(!this._instance.config.scroll_root_selector)return be==null?void 0:be.document.documentElement;var e=Fr(this._instance.config.scroll_root_selector)?this._instance.config.scroll_root_selector:[this._instance.config.scroll_root_selector];for(var t of e){var n=be==null?void 0:be.document.querySelector(t);if(n)return n}}scrollY(){if(this._instance.config.scroll_root_selector){var e=this.scrollElement();return e&&e.scrollTop||0}return be&&(be.scrollY||be.pageYOffset||be.document.documentElement.scrollTop)||0}scrollX(){if(this._instance.config.scroll_root_selector){var e=this.scrollElement();return e&&e.scrollLeft||0}return be&&(be.scrollX||be.pageXOffset||be.document.documentElement.scrollLeft)||0}}var RH=r=>IR(r==null?void 0:r.config.mask_personal_data_properties,r==null?void 0:r.config.custom_personal_data_properties);class yk{constructor(e,t,n,s){this.Ke=i=>{var c=this.Ye();if(!c||c.sessionId!==i){var u={sessionId:i,props:this.Xe(this._instance)};this.Qe.register({[rb]:u})}},this._instance=e,this.Ze=t,this.Qe=n,this.Xe=s||RH,this.Ze.onSessionId(this.Ke)}Ye(){return this.Qe.props[rb]}getSetOnceProps(){var e,t=(e=this.Ye())==null?void 0:e.props;return t?"r"in t?PR(t):{$referring_domain:t.referringDomain,$pathname:t.initialPathName,utm_source:t.utm_source,utm_campaign:t.utm_campaign,utm_medium:t.utm_medium,utm_content:t.utm_content,utm_term:t.utm_term}:{}}getSessionProps(){var e={};return Xr(rE(this.getSetOnceProps()),((t,n)=>{n==="$current_url"&&(n="url"),e["$session_entry_"+Ww(n)]=t})),e}}var Xx=bn("[SessionId]");class xk{on(e,t){return this.tr.on(e,t)}constructor(e,t,n){var s;if(this.ir=[],this.er=void 0,this.tr=new lE,this.rr=(g,x)=>!(!zf(g)||!zf(x))&&Math.abs(g-x)>this.sessionTimeoutMs,!e.persistence)throw new Error("SessionIdManager requires a PostHogPersistence instance");if(e.config.cookieless_mode==="always")throw new Error('SessionIdManager cannot be used with cookieless_mode="always"');this.R=e.config,this.Qe=e.persistence,this.sr=void 0,this.nr=void 0,this._sessionStartTimestamp=null,this._sessionActivityTimestamp=null,this.ar=t||Lc,this.lr=n||Lc;var i=this.R.persistence_name||this.R.token,c=this.R.session_idle_timeout_seconds||1800;if(this._sessionTimeoutMs=1e3*La(c,60,36e3,Xx.createLogger("session_idle_timeout_seconds"),1800),e.register({$configured_session_timeout_ms:this._sessionTimeoutMs}),this.ur(),this.hr="ph_"+i+"_window_id",this.dr="ph_"+i+"_primary_window_exists",this.vr()){var u=vs.W(this.hr),p=vs.W(this.dr);u&&!p?this.sr=u:vs.V(this.hr),vs.G(this.dr,!0)}if((s=this.R.bootstrap)!=null&&s.sessionID)try{var m=(g=>{var x=g.replace(/-/g,"");if(x.length!==32)throw new Error("Not a valid UUID");if(x[12]!=="7")throw new Error("Not a UUIDv7");return parseInt(x.substring(0,12),16)})(this.R.bootstrap.sessionID);this.cr(this.R.bootstrap.sessionID,new Date().getTime(),m)}catch(g){Xx.error("Invalid sessionID in bootstrap",g)}this.pr()}get sessionTimeoutMs(){return this._sessionTimeoutMs}onSessionId(e){return Ke(this.ir)&&(this.ir=[]),this.ir.push(e),this.nr&&e(this.nr,this.sr),()=>{this.ir=this.ir.filter((t=>t!==e))}}vr(){return this.R.persistence!=="memory"&&!this.Qe.Pi&&vs.H()}gr(e){e!==this.sr&&(this.sr=e,this.vr()&&vs.G(this.hr,e))}_r(){return this.sr?this.sr:this.vr()?vs.W(this.hr):null}cr(e,t,n){e===this.nr&&t===this._sessionActivityTimestamp&&n===this._sessionStartTimestamp||(this._sessionStartTimestamp=n,this._sessionActivityTimestamp=t,this.nr=e,this.Qe.register({[ay]:[t,e,n]}))}mr(){var e=this.Qe.props[ay];return Fr(e)&&e.length===2&&e.push(e[0]),e||[0,null,0]}resetSessionId(){this.cr(null,null,null)}destroy(){clearTimeout(this.br),this.br=void 0,this.er&&be&&(be.removeEventListener("beforeunload",this.er,{capture:!1}),this.er=void 0),this.ir=[]}pr(){this.er=()=>{this.vr()&&vs.V(this.dr)},Ln(be,"beforeunload",this.er,{capture:!1})}checkAndGetSessionAndWindowId(e,t){if(e===void 0&&(e=!1),t===void 0&&(t=null),this.R.cookieless_mode==="always")throw new Error('checkAndGetSessionAndWindowId should not be called with cookieless_mode="always"');var n=t||new Date().getTime(),[s,i,c]=this.mr(),u=this._r(),p=zf(c)&&Math.abs(n-c)>864e5,m=!1,g=!i,x=!g&&!e&&this.rr(n,s);g||x||p?(i=this.ar(),u=this.lr(),Xx.info("new session ID generated",{sessionId:i,windowId:u,changeReason:{noSessionId:g,activityTimeout:x,sessionPastMaximumLength:p}}),c=n,m=!0):u||(u=this.lr(),m=!0);var b=zf(s)&&e&&!p?s:n,E=zf(c)?c:new Date().getTime();return this.gr(u),this.cr(i,b,E),e||this.ur(),m&&this.ir.forEach((T=>T(i,u,m?{noSessionId:g,activityTimeout:x,sessionPastMaximumLength:p}:void 0))),{sessionId:i,windowId:u,sessionStartTimestamp:E,changeReason:m?{noSessionId:g,activityTimeout:x,sessionPastMaximumLength:p}:void 0,lastActivityTimestamp:s}}ur(){clearTimeout(this.br),this.br=setTimeout((()=>{var[e]=this.mr();if(this.rr(new Date().getTime(),e)){var t=this.nr;this.resetSessionId(),this.tr.emit("forcedIdleReset",{idleSessionId:t})}}),1.1*this.sessionTimeoutMs)}}var AH=["$set_once","$set"],Ac=bn("[SiteApps]");class IH{constructor(e){this._instance=e,this.yr=[],this.apps={}}get isEnabled(){return!!this._instance.config.opt_in_site_apps}wr(e,t){if(t){var n=this.globalsForEvent(t);this.yr.push(n),this.yr.length>1e3&&(this.yr=this.yr.slice(10))}}get siteAppLoaders(){var e;return(e=Et._POSTHOG_REMOTE_CONFIG)==null||(e=e[this._instance.config.token])==null?void 0:e.siteApps}init(){if(this.isEnabled){var e=this._instance._addCaptureHook(this.wr.bind(this));this.Er=()=>{e(),this.yr=[],this.Er=void 0}}}globalsForEvent(e){var t,n,s,i,c,u,p;if(!e)throw new Error("Event payload is required");var m={},g=this._instance.get_property("$groups")||[],x=this._instance.get_property("$stored_group_properties")||{};for(var[b,E]of Object.entries(x))m[b]={id:g[b],type:b,properties:E};var{$set_once:T,$set:S}=e;return{event:et({},DT(e,AH),{properties:et({},e.properties,S?{$set:et({},(t=(n=e.properties)==null?void 0:n.$set)!==null&&t!==void 0?t:{},S)}:{},T?{$set_once:et({},(s=(i=e.properties)==null?void 0:i.$set_once)!==null&&s!==void 0?s:{},T)}:{}),elements_chain:(c=(u=e.properties)==null?void 0:u.$elements_chain)!==null&&c!==void 0?c:"",distinct_id:(p=e.properties)==null?void 0:p.distinct_id}),person:{properties:this._instance.get_property("$stored_person_properties")},groups:m}}setupSiteApp(e){var t=this.apps[e.id],n=()=>{var u;!t.errored&&this.yr.length&&(Ac.info("Processing "+this.yr.length+" events for site app with id "+e.id),this.yr.forEach((p=>t.processEvent==null?void 0:t.processEvent(p))),t.processedBuffer=!0),Object.values(this.apps).every((p=>p.processedBuffer||p.errored))&&((u=this.Er)==null||u.call(this))},s=!1,i=u=>{t.errored=!u,t.loaded=!0,Ac.info("Site app with id "+e.id+" "+(u?"loaded":"errored")),s&&n()};try{var{processEvent:c}=e.init({posthog:this._instance,callback:u=>{i(u)}});c&&(t.processEvent=c),s=!0}catch(u){Ac.error("Error while initializing PostHog app with config id "+e.id,u),i(!1)}if(s&&t.loaded)try{n()}catch(u){Ac.error("Error while processing buffered events PostHog app with config id "+e.id,u),t.errored=!0}}$r(){var e=this.siteAppLoaders||[];for(var t of e)this.apps[t.id]={id:t.id,loaded:!1,errored:!1,processedBuffer:!1};for(var n of e)this.setupSiteApp(n)}Sr(e){if(Object.keys(this.apps).length!==0){var t=this.globalsForEvent(e);for(var n of Object.values(this.apps))try{n.processEvent==null||n.processEvent(t)}catch(s){Ac.error("Error while processing event "+e.event+" for site app "+n.id,s)}}}onRemoteConfig(e){var t,n,s,i=this;if((t=this.siteAppLoaders)!=null&&t.length)return this.isEnabled?(this.$r(),void this._instance.on("eventCaptured",(m=>this.Sr(m)))):void Ac.error('PostHog site apps are disabled. Enable the "opt_in_site_apps" config to proceed.');if((n=this.Er)==null||n.call(this),(s=e.siteApps)!=null&&s.length)if(this.isEnabled){var c=function(m){var g;Et["__$$ph_site_app_"+m]=i._instance,(g=Et.__PosthogExtensions__)==null||g.loadSiteApp==null||g.loadSiteApp(i._instance,p,(x=>{if(x)return Ac.error("Error while initializing PostHog app with config id "+m,x)}))};for(var{id:u,url:p}of e.siteApps)c(u)}else Ac.error('PostHog site apps are disabled. Enable the "opt_in_site_apps" config to proceed.')}}var HR=function(r,e){if(!r)return!1;var t=r.userAgent;if(t&&RC(t,e))return!0;try{var n=r==null?void 0:r.userAgentData;if(n!=null&&n.brands&&n.brands.some((s=>RC(s==null?void 0:s.brand,e))))return!0}catch{}return!!r.webdriver},dm=(function(r){return r.US="us",r.EU="eu",r.CUSTOM="custom",r})({}),wk="i.posthog.com";class PH{constructor(e){this.kr={},this.instance=e}get apiHost(){var e=this.instance.config.api_host.trim().replace(/\/$/,"");return e==="https://app.posthog.com"?"https://us.i.posthog.com":e}get flagsApiHost(){var e=this.instance.config.flags_api_host;return e?e.trim().replace(/\/$/,""):this.apiHost}get uiHost(){var e,t=(e=this.instance.config.ui_host)==null?void 0:e.replace(/\/$/,"");return t||(t=this.apiHost.replace("."+wk,".posthog.com")),t==="https://app.posthog.com"?"https://us.posthog.com":t}get region(){return this.kr[this.apiHost]||(/https:\/\/(app|us|us-assets)(\.i)?\.posthog\.com/i.test(this.apiHost)?this.kr[this.apiHost]=dm.US:/https:\/\/(eu|eu-assets)(\.i)?\.posthog\.com/i.test(this.apiHost)?this.kr[this.apiHost]=dm.EU:this.kr[this.apiHost]=dm.CUSTOM),this.kr[this.apiHost]}endpointFor(e,t){if(t===void 0&&(t=""),t&&(t=t[0]==="/"?t:"/"+t),e==="ui")return this.uiHost+t;if(e==="flags")return this.flagsApiHost+t;if(this.region===dm.CUSTOM)return this.apiHost+t;var n=wk+t;switch(e){case"assets":return"https://"+this.region+"-assets."+n;case"api":return"https://"+this.region+"."+n}}}var FH={icontains:(r,e)=>!!be&&e.href.toLowerCase().indexOf(r.toLowerCase())>-1,not_icontains:(r,e)=>!!be&&e.href.toLowerCase().indexOf(r.toLowerCase())===-1,regex:(r,e)=>!!be&&yy(e.href,r),not_regex:(r,e)=>!!be&&!yy(e.href,r),exact:(r,e)=>e.href===r,is_not:(r,e)=>e.href!==r};class Is{constructor(e){var t=this;this.getWebExperimentsAndEvaluateDisplayLogic=function(n){n===void 0&&(n=!1),t.getWebExperiments((s=>{Is.Pr("retrieved web experiments from the server"),t.Tr=new Map,s.forEach((i=>{if(i.feature_flag_key){var c;t.Tr&&(Is.Pr("setting flag key ",i.feature_flag_key," to web experiment ",i),(c=t.Tr)==null||c.set(i.feature_flag_key,i));var u=t._instance.getFeatureFlag(i.feature_flag_key);qn(u)&&i.variants[u]&&t.Ir(i.name,u,i.variants[u].transforms)}else if(i.variants)for(var p in i.variants){var m=i.variants[p];Is.Cr(m)&&t.Ir(i.name,p,m.transforms)}}))}),n)},this._instance=e,this._instance.onFeatureFlags((n=>{this.onFeatureFlags(n)}))}onFeatureFlags(e){if(this._is_bot())Is.Pr("Refusing to render web experiment since the viewer is a likely bot");else if(!this._instance.config.disable_web_experiments){if(cr(this.Tr))return this.Tr=new Map,this.loadIfEnabled(),void this.previewWebExperiment();Is.Pr("applying feature flags",e),e.forEach((t=>{var n;if(this.Tr&&(n=this.Tr)!=null&&n.has(t)){var s,i=this._instance.getFeatureFlag(t),c=(s=this.Tr)==null?void 0:s.get(t);i&&c!=null&&c.variants[i]&&this.Ir(c.name,i,c.variants[i].transforms)}}))}}previewWebExperiment(){var e=Is.getWindowLocation();if(e!=null&&e.search){var t=hy(e==null?void 0:e.search,"__experiment_id"),n=hy(e==null?void 0:e.search,"__experiment_variant");t&&n&&(Is.Pr("previewing web experiments "+t+" && "+n),this.getWebExperiments((s=>{this.Rr(parseInt(t),n,s)}),!1,!0))}}loadIfEnabled(){this._instance.config.disable_web_experiments||this.getWebExperimentsAndEvaluateDisplayLogic()}getWebExperiments(e,t,n){if(this._instance.config.disable_web_experiments&&!n)return e([]);var s=this._instance.get_property("$web_experiments");if(s&&!t)return e(s);this._instance._send_request({url:this._instance.requestRouter.endpointFor("api","/api/web_experiments/?token="+this._instance.config.token),method:"GET",callback:i=>{if(i.statusCode!==200||!i.json)return e([]);var c=i.json.experiments||[];return e(c)}})}Rr(e,t,n){var s=n.filter((i=>i.id===e));s&&s.length>0&&(Is.Pr("Previewing web experiment ["+s[0].name+"] with variant ["+t+"]"),this.Ir(s[0].name,t,s[0].variants[t].transforms))}static Cr(e){return!cr(e.conditions)&&Is.Fr(e)&&Is.Or(e)}static Fr(e){var t;if(cr(e.conditions)||cr((t=e.conditions)==null?void 0:t.url))return!0;var n,s,i,c=Is.getWindowLocation();return!!c&&((n=e.conditions)==null||!n.url||FH[(s=(i=e.conditions)==null?void 0:i.urlMatchType)!==null&&s!==void 0?s:"icontains"](e.conditions.url,c))}static getWindowLocation(){return be==null?void 0:be.location}static Or(e){var t;if(cr(e.conditions)||cr((t=e.conditions)==null?void 0:t.utm))return!0;var n=NR();if(n.utm_source){var s,i,c,u,p,m,g,x,b=(s=e.conditions)==null||(s=s.utm)==null||!s.utm_campaign||((i=e.conditions)==null||(i=i.utm)==null?void 0:i.utm_campaign)==n.utm_campaign,E=(c=e.conditions)==null||(c=c.utm)==null||!c.utm_source||((u=e.conditions)==null||(u=u.utm)==null?void 0:u.utm_source)==n.utm_source,T=(p=e.conditions)==null||(p=p.utm)==null||!p.utm_medium||((m=e.conditions)==null||(m=m.utm)==null?void 0:m.utm_medium)==n.utm_medium,S=(g=e.conditions)==null||(g=g.utm)==null||!g.utm_term||((x=e.conditions)==null||(x=x.utm)==null?void 0:x.utm_term)==n.utm_term;return b&&T&&S&&E}return!1}static Pr(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];Qe.info("[WebExperiments] "+e,n)}Ir(e,t,n){this._is_bot()?Is.Pr("Refusing to render web experiment since the viewer is a likely bot"):t!=="control"?n.forEach((s=>{if(s.selector){var i;Is.Pr("applying transform of variant "+t+" for experiment "+e+" ",s);var c=(i=document)==null?void 0:i.querySelectorAll(s.selector);c==null||c.forEach((u=>{var p=u;s.html&&(p.innerHTML=s.html),s.css&&p.setAttribute("style",s.css)}))}})):Is.Pr("Control variants leave the page unmodified.")}_is_bot(){return Go&&this._instance?HR(Go,this._instance.config.custom_blocked_useragents):void 0}}var jH=bn("[PostHog ExternalIntegrations]"),OH={intercom:"intercom-integration",crispChat:"crisp-chat-integration"};class DH{constructor(e){this._instance=e}it(e,t){var n;(n=Et.__PosthogExtensions__)==null||n.loadExternalDependency==null||n.loadExternalDependency(this._instance,e,(s=>{if(s)return jH.error("failed to load script",s);t()}))}startIfEnabledOrStop(){var e=this,t=function(c){var u,p,m;!s||(u=Et.__PosthogExtensions__)!=null&&(u=u.integrations)!=null&&u[c]||e.it(OH[c],(()=>{var g;(g=Et.__PosthogExtensions__)==null||(g=g.integrations)==null||(g=g[c])==null||g.start(e._instance)})),!s&&(p=Et.__PosthogExtensions__)!=null&&(p=p.integrations)!=null&&p[c]&&((m=Et.__PosthogExtensions__)==null||(m=m.integrations)==null||(m=m[c])==null||m.stop())};for(var[n,s]of Object.entries((i=this._instance.config.integrations)!==null&&i!==void 0?i:{})){var i;t(n)}}}var fb="[SessionRecording]",Kp=bn(fb);class bk{get started(){var e;return!((e=this.Mr)==null||!e.isStarted)}get status(){return this.Mr?this.Mr.status:this.Ar&&!this.jr?"disabled":"lazy_loading"}constructor(e){if(this._forceAllowLocalhostNetworkCapture=!1,this.Ar=!1,this.Dr=void 0,this._instance=e,!this._instance.sessionManager)throw Kp.error("started without valid sessionManager"),new Error(fb+" started without valid sessionManager. This is a bug.");if(this._instance.config.cookieless_mode==="always")throw new Error(fb+' cannot be used with cookieless_mode="always"')}get jr(){var e,t=!((e=this._instance.get_property(Lx))==null||!e.enabled),n=!this._instance.config.disable_session_recording,s=this._instance.config.disable_session_recording||this._instance.consent.isOptedOut();return be&&t&&n&&!s}startIfEnabledOrStop(e){var t;if(!this.jr||(t=this.Mr)==null||!t.isStarted){var n=!Ke(Object.assign)&&!Ke(Array.from);this.jr&&n?(this.Lr(e),Kp.info("starting")):this.stopRecording()}}Lr(e){var t,n,s;this.jr&&(Et!=null&&(t=Et.__PosthogExtensions__)!=null&&(t=t.rrweb)!=null&&t.record&&(n=Et.__PosthogExtensions__)!=null&&n.initSessionRecording?this.Nr(e):(s=Et.__PosthogExtensions__)==null||s.loadExternalDependency==null||s.loadExternalDependency(this._instance,this.Ur,(i=>{if(i)return Kp.error("could not load recorder",i);this.Nr(e)})))}stopRecording(){var e,t;(e=this.Dr)==null||e.call(this),this.Dr=void 0,(t=this.Mr)==null||t.stop()}zr(){var e;(e=this._instance.persistence)==null||e.unregister(lR)}Hr(e){if(this._instance.persistence){var t,n,s=this._instance.persistence,i=()=>{var c=e.sessionRecording===!1?void 0:e.sessionRecording,u=c==null?void 0:c.sampleRate,p=cr(u)?null:parseFloat(u);cr(p)&&this.zr();var m=c==null?void 0:c.minimumDurationMilliseconds;s.register({[Lx]:et({cache_timestamp:Date.now(),enabled:!!c},c,{networkPayloadCapture:et({capturePerformance:e.capturePerformance},c==null?void 0:c.networkPayloadCapture),canvasRecording:{enabled:c==null?void 0:c.recordCanvas,fps:c==null?void 0:c.canvasFps,quality:c==null?void 0:c.canvasQuality},sampleRate:p,minimumDurationMilliseconds:Ke(m)?null:m,endpoint:c==null?void 0:c.endpoint,triggerMatchType:c==null?void 0:c.triggerMatchType,masking:c==null?void 0:c.masking,urlTriggers:c==null?void 0:c.urlTriggers})})};i(),(t=this.Dr)==null||t.call(this),this.Dr=(n=this._instance.sessionManager)==null?void 0:n.onSessionId(i)}}onRemoteConfig(e){"sessionRecording"in e?e.sessionRecording!==!1?(this.Hr(e),this.Ar=!0,this.startIfEnabledOrStop()):this.Ar=!0:Kp.info("skipping remote config with no sessionRecording",e)}log(e,t){var n;t===void 0&&(t="log"),(n=this.Mr)!=null&&n.log?this.Mr.log(e,t):Kp.warn("log called before recorder was ready")}get Ur(){var e,t,n=(e=this._instance)==null||(e=e.persistence)==null?void 0:e.get_property(Lx);return(n==null||(t=n.scriptConfig)==null?void 0:t.script)||"lazy-recorder"}Nr(e){var t,n;if((t=Et.__PosthogExtensions__)==null||!t.initSessionRecording)throw Error("Called on script loaded before session recording is available");this.Mr||(this.Mr=(n=Et.__PosthogExtensions__)==null?void 0:n.initSessionRecording(this._instance),this.Mr._forceAllowLocalhostNetworkCapture=this._forceAllowLocalhostNetworkCapture),this.Mr.start(e)}onRRwebEmit(e){var t;(t=this.Mr)==null||t.onRRwebEmit==null||t.onRRwebEmit(e)}overrideLinkedFlag(){var e,t;this.Mr||(t=this._instance.persistence)==null||t.register({$replay_override_linked_flag:!0}),(e=this.Mr)==null||e.overrideLinkedFlag()}overrideSampling(){var e,t;this.Mr||(t=this._instance.persistence)==null||t.register({$replay_override_sampling:!0}),(e=this.Mr)==null||e.overrideSampling()}overrideTrigger(e){var t,n;this.Mr||(n=this._instance.persistence)==null||n.register({[e==="url"?"$replay_override_url_trigger":"$replay_override_event_trigger"]:!0}),(t=this.Mr)==null||t.overrideTrigger(e)}get sdkDebugProperties(){var e;return((e=this.Mr)==null?void 0:e.sdkDebugProperties)||{$recording_status:this.status}}tryAddCustomEvent(e,t){var n;return!((n=this.Mr)==null||!n.tryAddCustomEvent(e,t))}}var ym={},hb=()=>{},Hf="posthog",BR=!aH&&(_o==null?void 0:_o.indexOf("MSIE"))===-1&&(_o==null?void 0:_o.indexOf("Mozilla"))===-1,_k=r=>{var e;return et({api_host:"https://us.i.posthog.com",flags_api_host:null,ui_host:null,token:"",autocapture:!0,cross_subdomain_cookie:fz(qe==null?void 0:qe.location),persistence:"localStorage+cookie",persistence_name:"",cookie_persisted_properties:[],loaded:hb,save_campaign_params:!0,custom_campaign_params:[],custom_blocked_useragents:[],save_referrer:!0,capture_pageleave:"if_capture_pageview",defaults:r??"unset",__preview_deferred_init_extensions:!1,debug:xs&&qn(xs==null?void 0:xs.search)&&xs.search.indexOf("__posthog_debug=true")!==-1||!1,cookie_expiration:365,upgrade:!1,disable_session_recording:!1,disable_persistence:!1,disable_web_experiments:!0,disable_surveys:!1,disable_surveys_automatic_display:!1,disable_conversations:!1,disable_product_tours:!0,disable_external_dependency_loading:!1,enable_recording_console_log:void 0,secure_cookie:(be==null||(e=be.location)==null?void 0:e.protocol)==="https:",ip:!1,opt_out_capturing_by_default:!1,opt_out_persistence_by_default:!1,opt_out_useragent_filter:!1,opt_out_capturing_persistence_type:"localStorage",consent_persistence_name:null,opt_out_capturing_cookie_prefix:null,opt_in_site_apps:!1,property_denylist:[],respect_dnt:!1,sanitize_properties:null,request_headers:{},request_batching:!0,properties_string_max_length:65535,mask_all_element_attributes:!1,mask_all_text:!1,mask_personal_data_properties:!1,custom_personal_data_properties:[],advanced_disable_flags:!1,advanced_disable_decide:!1,advanced_disable_feature_flags:!1,advanced_disable_feature_flags_on_first_load:!1,advanced_only_evaluate_survey_feature_flags:!1,advanced_enable_surveys:!1,advanced_disable_toolbar_metrics:!1,feature_flag_request_timeout_ms:3e3,surveys_request_timeout_ms:1e4,on_request_error:t=>{var n="Bad HTTP status: "+t.statusCode+" "+t.text;Qe.error(n)},get_device_id:t=>t,capture_performance:void 0,name:"posthog",bootstrap:{},disable_compression:!1,session_idle_timeout_seconds:1800,person_profiles:"identified_only",before_send:void 0,request_queue_config:{flush_interval_ms:db},error_tracking:{},_onCapture:hb,__preview_eager_load_replay:!1},(t=>({rageclick:!(t&&t>="2025-11-30")||{content_ignorelist:!0},capture_pageview:!(t&&t>="2025-05-24")||"history_change",session_recording:t&&t>="2025-11-30"?{strictMinimumDuration:!0}:{},external_scripts_inject_target:t&&t>="2026-01-30"?"head":"body",internal_or_test_user_hostname:t&&t>="2026-01-30"?/^(localhost|127\.0\.0\.1)$/:void 0}))(r))},Ek=r=>{var e={};Ke(r.process_person)||(e.person_profiles=r.process_person),Ke(r.xhr_headers)||(e.request_headers=r.xhr_headers),Ke(r.cookie_name)||(e.persistence_name=r.cookie_name),Ke(r.disable_cookie)||(e.disable_persistence=r.disable_cookie),Ke(r.store_google)||(e.save_campaign_params=r.store_google),Ke(r.verbose)||(e.debug=r.verbose);var t=Rn({},e,r);return Fr(r.property_blacklist)&&(Ke(r.property_denylist)?t.property_denylist=r.property_blacklist:Fr(r.property_denylist)?t.property_denylist=[...r.property_blacklist,...r.property_denylist]:Qe.error("Invalid value for property_denylist config: "+r.property_denylist)),t};class LH{constructor(){this.__forceAllowLocalhost=!1}get Br(){return this.__forceAllowLocalhost}set Br(e){Qe.error("WebPerformanceObserver is deprecated and has no impact on network capture. Use `_forceAllowLocalhostNetworkCapture` on `posthog.sessionRecording`"),this.__forceAllowLocalhost=e}}class Yy{get decideEndpointWasHit(){var e,t;return(e=(t=this.featureFlags)==null?void 0:t.hasLoadedFlags)!==null&&e!==void 0&&e}get flagsEndpointWasHit(){var e,t;return(e=(t=this.featureFlags)==null?void 0:t.hasLoadedFlags)!==null&&e!==void 0&&e}constructor(){this.webPerformance=new LH,this.qr=!1,this.version=Rl.LIB_VERSION,this.bi=new lE,this._calculate_event_properties=this.calculateEventProperties.bind(this),this.config=_k(),this.SentryIntegration=zz,this.sentryIntegration=e=>(function(t,n){var s=kR(t,n);return{name:CR,processEvent:i=>s(i)}})(this,e),this.__request_queue=[],this.__loaded=!1,this.analyticsDefaultEndpoint="/e/",this.Wr=!1,this.Gr=null,this.Vr=null,this.Jr=null,this.featureFlags=new dH(this),this.toolbar=new Bz(this),this.scrollManager=new TH(this),this.pageViewManager=new sk(this),this.surveys=new wH(this),this.conversations=new bH(this),this.logs=new _H(this),this.experiments=new Is(this),this.exceptions=new lH(this),this.rateLimiter=new EH(this),this.requestRouter=new PH(this),this.consent=new Oz(this),this.externalIntegrations=new DH(this),this.people={set:(e,t,n)=>{var s=qn(e)?{[e]:t}:e;this.setPersonProperties(s),n==null||n({})},set_once:(e,t,n)=>{var s=qn(e)?{[e]:t}:e;this.setPersonProperties(void 0,s),n==null||n({})}},this.on("eventCaptured",(e=>Qe.info('send "'+(e==null?void 0:e.event)+'"',e)))}init(e,t,n){if(n&&n!==Hf){var s,i=(s=ym[n])!==null&&s!==void 0?s:new Yy;return i._init(e,t,n),ym[n]=i,ym[Hf][n]=i,i}return this._init(e,t,n)}_init(e,t,n){var s;if(t===void 0&&(t={}),Ke(e)||Vw(e))return Qe.critical("PostHog was initialized without a token. This likely indicates a misconfiguration. Please check the first argument passed to posthog.init()"),this;if(this.__loaded)return console.warn("[PostHog.js]","You have already initialized PostHog! Re-initializing is a no-op"),this;this.__loaded=!0,this.config={},t.debug=this.Kr(t.debug),this.Yr=t,this.Xr=[],t.person_profiles&&(this.Vr=t.person_profiles),this.set_config(Rn({},_k(t.defaults),Ek(t),{name:n,token:e})),this.config.on_xhr_error&&Qe.error("on_xhr_error is deprecated. Use on_request_error instead"),this.compression=t.disable_compression?void 0:Pl.GZipJS;var i=this.Qr();this.persistence=new qx(this.config,i),this.sessionPersistence=this.config.persistence==="sessionStorage"||this.config.persistence==="memory"?this.persistence:new qx(et({},this.config,{persistence:"sessionStorage"}),i);var c=et({},this.persistence.props),u=et({},this.sessionPersistence.props);this.register({$initialization_time:new Date().toISOString()}),this.Zr=new CH((A=>this.ts(A)),this.config.request_queue_config),this.es=new NH(this),this.__request_queue=[];var p=this.config.cookieless_mode==="always"||this.config.cookieless_mode==="on_reject"&&this.consent.isExplicitlyOptedOut();if(p||(this.sessionManager=new xk(this),this.sessionPropsManager=new yk(this,this.sessionManager,this.persistence)),this.config.__preview_deferred_init_extensions?(Qe.info("Deferring extension initialization to improve startup performance"),setTimeout((()=>{this.rs(p)}),0)):(Qe.info("Initializing extensions synchronously"),this.rs(p)),Rl.DEBUG=Rl.DEBUG||this.config.debug,Rl.DEBUG&&Qe.info("Starting in debug mode",{this:this,config:t,thisC:et({},this.config),p:c,s:u}),((s=t.bootstrap)==null?void 0:s.distinctID)!==void 0){var m,g,x=this.config.get_device_id(Lc()),b=(m=t.bootstrap)!=null&&m.isIdentifiedID?x:t.bootstrap.distinctID;this.persistence.set_property(Al,(g=t.bootstrap)!=null&&g.isIdentifiedID?"identified":"anonymous"),this.register({distinct_id:t.bootstrap.distinctID,$device_id:b})}if(this.ss()){var E,T,S=Object.keys(((E=t.bootstrap)==null?void 0:E.featureFlags)||{}).filter((A=>{var j;return!((j=t.bootstrap)==null||(j=j.featureFlags)==null||!j[A])})).reduce(((A,j)=>{var P;return A[j]=((P=t.bootstrap)==null||(P=P.featureFlags)==null?void 0:P[j])||!1,A}),{}),N=Object.keys(((T=t.bootstrap)==null?void 0:T.featureFlagPayloads)||{}).filter((A=>S[A])).reduce(((A,j)=>{var P,M;return(P=t.bootstrap)!=null&&(P=P.featureFlagPayloads)!=null&&P[j]&&(A[j]=(M=t.bootstrap)==null||(M=M.featureFlagPayloads)==null?void 0:M[j]),A}),{});this.featureFlags.receivedFeatureFlags({featureFlags:S,featureFlagPayloads:N})}if(p)this.register_once({distinct_id:Up,$device_id:null},"");else if(!this.get_distinct_id()){var R=this.config.get_device_id(Lc());this.register_once({distinct_id:R,$device_id:R},""),this.persistence.set_property(Al,"anonymous")}return Ln(be,"onpagehide"in self?"pagehide":"unload",this._handle_unload.bind(this),{passive:!1}),this.toolbar.maybeLoadToolbar(),t.segment?Uz(this,(()=>this.ns())):this.ns(),$c(this.config._onCapture)&&this.config._onCapture!==hb&&(Qe.warn("onCapture is deprecated. Please use `before_send` instead"),this.on("eventCaptured",(A=>this.config._onCapture(A.event,A)))),this.config.ip&&Qe.warn('The `ip` config option has NO EFFECT AT ALL and has been deprecated. Use a custom transformation or "Discard IP data" project setting instead. See https://posthog.com/tutorials/web-redact-properties#hiding-customer-ip-address for more information.'),this}rs(e){var t=performance.now();this.historyAutocapture=new $z(this),this.historyAutocapture.startIfEnabled();var n=[];n.push((()=>{new Wz(this).startIfEnabledOrStop()})),n.push((()=>{var s;this.siteApps=new IH(this),(s=this.siteApps)==null||s.init()})),e||n.push((()=>{this.sessionRecording=new bk(this),this.sessionRecording.startIfEnabledOrStop()})),this.config.disable_scroll_properties||n.push((()=>{this.scrollManager.startMeasuringScrollPosition()})),n.push((()=>{this.autocapture=new Nz(this),this.autocapture.startIfEnabled()})),n.push((()=>{this.surveys.loadIfEnabled()})),n.push((()=>{this.logs.loadIfEnabled()})),n.push((()=>{this.conversations.loadIfEnabled()})),n.push((()=>{this.productTours=new hH(this),this.productTours.loadIfEnabled()})),n.push((()=>{this.heatmaps=new Qz(this),this.heatmaps.startIfEnabled()})),n.push((()=>{this.webVitalsAutocapture=new Jz(this)})),n.push((()=>{this.exceptionObserver=new Mz(this),this.exceptionObserver.startIfEnabledOrStop()})),n.push((()=>{this.deadClicksAutocapture=new SR(this,Lz),this.deadClicksAutocapture.startIfEnabled()})),n.push((()=>{if(this.os){var s=this.os;this.os=void 0,this.wi(s)}})),this.ls(n,t)}ls(e,t){for(;e.length>0;){if(this.config.__preview_deferred_init_extensions&&performance.now()-t>=30&&e.length>0)return void setTimeout((()=>{this.ls(e,t)}),0);var n=e.shift();if(n)try{n()}catch(i){Qe.error("Error initializing extension:",i)}}var s=Math.round(performance.now()-t);this.register_for_session({$sdk_debug_extensions_init_method:this.config.__preview_deferred_init_extensions?"deferred":"synchronous",$sdk_debug_extensions_init_time_ms:s}),this.config.__preview_deferred_init_extensions&&Qe.info("PostHog extensions initialized ("+s+"ms)")}wi(e){var t,n,s,i,c,u,p,m,g;if(!qe||!qe.body)return Qe.info("document not ready yet, trying again in 500 milliseconds..."),void setTimeout((()=>{this.wi(e)}),500);this.config.__preview_deferred_init_extensions&&(this.os=e),this.compression=void 0,e.supportedCompression&&!this.config.disable_compression&&(this.compression=ar(e.supportedCompression,Pl.GZipJS)?Pl.GZipJS:ar(e.supportedCompression,Pl.Base64)?Pl.Base64:void 0),(t=e.analytics)!=null&&t.endpoint&&(this.analyticsDefaultEndpoint=e.analytics.endpoint),this.set_config({person_profiles:this.Vr?this.Vr:"identified_only"}),(n=this.siteApps)==null||n.onRemoteConfig(e),(s=this.sessionRecording)==null||s.onRemoteConfig(e),(i=this.autocapture)==null||i.onRemoteConfig(e),(c=this.heatmaps)==null||c.onRemoteConfig(e),this.surveys.onRemoteConfig(e),this.logs.onRemoteConfig(e),this.conversations.onRemoteConfig(e),(u=this.productTours)==null||u.onRemoteConfig(e),(p=this.webVitalsAutocapture)==null||p.onRemoteConfig(e),(m=this.exceptionObserver)==null||m.onRemoteConfig(e),this.exceptions.onRemoteConfig(e),(g=this.deadClicksAutocapture)==null||g.onRemoteConfig(e)}ns(){try{this.config.loaded(this)}catch(n){Qe.critical("`loaded` function failed",n)}if(this.us(),this.config.internal_or_test_user_hostname&&xs!=null&&xs.hostname){var e=xs.hostname,t=this.config.internal_or_test_user_hostname;(typeof t=="string"?e===t:t.test(e))&&this.setInternalOrTestUser()}this.config.capture_pageview&&setTimeout((()=>{(this.consent.isOptedIn()||this.config.cookieless_mode==="always")&&this.hs()}),1),new SH(this).load(),this.featureFlags.flags()}us(){var e;this.is_capturing()&&this.config.request_batching&&((e=this.Zr)==null||e.enable())}_dom_loaded(){this.is_capturing()&&Uc(this.__request_queue,(e=>this.ts(e))),this.__request_queue=[],this.us()}_handle_unload(){var e,t;this.surveys.handlePageUnload(),this.config.request_batching?(this.ds()&&this.capture("$pageleave"),(e=this.Zr)==null||e.unload(),(t=this.es)==null||t.unload()):this.ds()&&this.capture("$pageleave",null,{transport:"sendBeacon"})}_send_request(e){this.__loaded&&(BR?this.__request_queue.push(e):this.rateLimiter.isServerRateLimited(e.batchKey)||(e.transport=e.transport||this.config.api_transport,e.url=vy(e.url,{ip:this.config.ip?1:0}),e.headers=et({},this.config.request_headers,e.headers),e.compression=e.compression==="best-available"?this.compression:e.compression,e.disableXHRCredentials=this.config.__preview_disable_xhr_credentials,this.config.__preview_disable_beacon&&(e.disableTransport=["sendBeacon"]),e.fetchOptions=e.fetchOptions||this.config.fetch_options,(t=>{var n,s,i,c=et({},t);c.timeout=c.timeout||6e4,c.url=vy(c.url,{_:new Date().getTime().toString(),ver:Rl.LIB_VERSION,compression:c.compression});var u=(n=c.transport)!==null&&n!==void 0?n:"fetch",p=Wv.filter((g=>!c.disableTransport||!g.transport||!c.disableTransport.includes(g.transport))),m=(s=(i=oR(p,(g=>g.transport===u)))==null?void 0:i.method)!==null&&s!==void 0?s:p[0].method;if(!m)throw new Error("No available transport method");m(c)})(et({},e,{callback:t=>{var n,s;this.rateLimiter.checkForLimiting(t),t.statusCode>=400&&((n=(s=this.config).on_request_error)==null||n.call(s,t)),e.callback==null||e.callback(t)}}))))}ts(e){this.es?this.es.retriableRequest(e):this._send_request(e)}_execute_array(e){var t,n=[],s=[],i=[];Uc(e,(u=>{u&&(t=u[0],Fr(t)?i.push(u):$c(u)?u.call(this):Fr(u)&&t==="alias"?n.push(u):Fr(u)&&t.indexOf("capture")!==-1&&$c(this[t])?i.push(u):s.push(u))}));var c=function(u,p){Uc(u,(function(m){if(Fr(m[0])){var g=p;Xr(m,(function(x){g=g[x[0]].apply(g,x.slice(1))}))}else this[m[0]].apply(this,m.slice(1))}),p)};c(n,this),c(s,this),c(i,this)}ss(){var e,t;return((e=this.config.bootstrap)==null?void 0:e.featureFlags)&&Object.keys((t=this.config.bootstrap)==null?void 0:t.featureFlags).length>0||!1}push(e){this._execute_array([e])}capture(e,t,n){var s;if(this.__loaded&&this.persistence&&this.sessionPersistence&&this.Zr){if(this.is_capturing())if(!Ke(e)&&qn(e)){var i=!this.config.opt_out_useragent_filter&&this._is_bot();if(!(i&&!this.config.__preview_capture_bot_pageviews)){var c=n!=null&&n.skip_client_rate_limiting?void 0:this.rateLimiter.clientRateLimitContext();if(c==null||!c.isRateLimited){t!=null&&t.$current_url&&!qn(t==null?void 0:t.$current_url)&&(Qe.error("Invalid `$current_url` property provided to `posthog.capture`. Input must be a string. Ignoring provided value."),t==null||delete t.$current_url),this.sessionPersistence.update_search_keyword(),this.config.save_campaign_params&&this.sessionPersistence.update_campaign_params(),this.config.save_referrer&&this.sessionPersistence.update_referrer_info(),(this.config.save_campaign_params||this.config.save_referrer)&&this.persistence.set_initial_person_info();var u=new Date,p=(n==null?void 0:n.timestamp)||u,m=Lc(),g={uuid:m,event:e,properties:this.calculateEventProperties(e,t||{},p,m)};e==="$pageview"&&this.config.__preview_capture_bot_pageviews&&i&&(g.event="$bot_pageview",g.properties.$browser_type="bot"),c&&(g.properties.$lib_rate_limit_remaining_tokens=c.remainingTokens),n!=null&&n.$set&&(g.$set=n==null?void 0:n.$set);var x,b=e!=="$groupidentify",E=this.vs(n==null?void 0:n.$set_once,b);if(E&&(g.$set_once=E),(g=uz(g,n!=null&&n._noTruncate?null:this.config.properties_string_max_length)).timestamp=p,Ke(n==null?void 0:n.timestamp)||(g.properties.$event_time_override_provided=!0,g.properties.$event_time_override_system_time=u),e===um.DISMISSED||e===um.SENT){var T=t==null?void 0:t[Jx.SURVEY_ID],S=t==null?void 0:t[Jx.SURVEY_ITERATION];x={id:T,current_iteration:S},localStorage.getItem(gk(x))||localStorage.setItem(gk(x),"true"),g.$set=et({},g.$set,{[pH({id:T,current_iteration:S},e===um.SENT?"responded":"dismissed")]:!0})}else e===um.SHOWN&&(g.$set=et({},g.$set,{[Jx.SURVEY_LAST_SEEN_DATE]:new Date().toISOString()}));var N=et({},g.properties.$set,g.$set);if(Wf(N)||this.setPersonPropertiesForFlags(N),!cr(this.config.before_send)){var R=this.cs(g);if(!R)return;g=R}this.bi.emit("eventCaptured",g);var A={method:"POST",url:(s=n==null?void 0:n._url)!==null&&s!==void 0?s:this.requestRouter.endpointFor("api",this.analyticsDefaultEndpoint),data:g,compression:"best-available",batchKey:n==null?void 0:n._batchKey};return!this.config.request_batching||n&&(n==null||!n._batchKey)||n!=null&&n.send_instantly?this.ts(A):this.Zr.enqueue(A),g}Qe.critical("This capture call is ignored due to client rate limiting.")}}else Qe.error("No event name provided to posthog.capture")}else Qe.uninitializedWarning("posthog.capture")}_addCaptureHook(e){return this.on("eventCaptured",(t=>e(t.event,t)))}calculateEventProperties(e,t,n,s,i){if(n=n||new Date,!this.persistence||!this.sessionPersistence)return t;var c=i?void 0:this.persistence.remove_event_timer(e),u=et({},t);if(u.token=this.config.token,u.$config_defaults=this.config.defaults,(this.config.cookieless_mode=="always"||this.config.cookieless_mode=="on_reject"&&this.consent.isExplicitlyOptedOut())&&(u.$cookieless_mode=!0),e==="$snapshot"){var p=et({},this.persistence.properties(),this.sessionPersistence.properties());return u.distinct_id=p.distinct_id,(!qn(u.distinct_id)&&!Ll(u.distinct_id)||Vw(u.distinct_id))&&Qe.error("Invalid distinct_id for replay event. This indicates a bug in your implementation"),u}var m,g=Yz(this.config.mask_personal_data_properties,this.config.custom_personal_data_properties);if(this.sessionManager){var{sessionId:x,windowId:b}=this.sessionManager.checkAndGetSessionAndWindowId(i,n.getTime());u.$session_id=x,u.$window_id=b}this.sessionPropsManager&&Rn(u,this.sessionPropsManager.getSessionProps());try{var E;this.sessionRecording&&Rn(u,this.sessionRecording.sdkDebugProperties),u.$sdk_debug_retry_queue_size=(E=this.es)==null?void 0:E.length}catch(R){u.$sdk_debug_error_capturing_properties=String(R)}if(this.requestRouter.region===dm.CUSTOM&&(u.$lib_custom_api_host=this.config.api_host),m=e!=="$pageview"||i?e!=="$pageleave"||i?this.pageViewManager.doEvent():this.pageViewManager.doPageLeave(n):this.pageViewManager.doPageView(n,s),u=Rn(u,m),e==="$pageview"&&qe&&(u.title=qe.title),!Ke(c)){var T=n.getTime()-c;u.$duration=parseFloat((T/1e3).toFixed(3))}_o&&this.config.opt_out_useragent_filter&&(u.$browser_type=this._is_bot()?"bot":"browser"),(u=Rn({},g,this.persistence.properties(),this.sessionPersistence.properties(),u)).$is_identified=this._isIdentified(),Fr(this.config.property_denylist)?Xr(this.config.property_denylist,(function(R){delete u[R]})):Qe.error("Invalid value for property_denylist config: "+this.config.property_denylist+" or property_blacklist config: "+this.config.property_blacklist);var S=this.config.sanitize_properties;S&&(Qe.error("sanitize_properties is deprecated. Use before_send instead"),u=S(u,e));var N=this.fs();return u.$process_person_profile=N,N&&!i&&this.ps("_calculate_event_properties"),u}vs(e,t){var n;if(t===void 0&&(t=!0),!this.persistence||!this.fs()||this.qr)return e;var s=this.persistence.get_initial_props(),i=(n=this.sessionPropsManager)==null?void 0:n.getSetOnceProps(),c=Rn({},s,i||{},e||{}),u=this.config.sanitize_properties;return u&&(Qe.error("sanitize_properties is deprecated. Use before_send instead"),c=u(c,"$set_once")),t&&(this.qr=!0),Wf(c)?void 0:c}register(e,t){var n;(n=this.persistence)==null||n.register(e,t)}register_once(e,t,n){var s;(s=this.persistence)==null||s.register_once(e,t,n)}register_for_session(e){var t;(t=this.sessionPersistence)==null||t.register(e)}unregister(e){var t;(t=this.persistence)==null||t.unregister(e)}unregister_for_session(e){var t;(t=this.sessionPersistence)==null||t.unregister(e)}gs(e,t){this.register({[e]:t})}getFeatureFlag(e,t){return this.featureFlags.getFeatureFlag(e,t)}getFeatureFlagPayload(e){return this.featureFlags.getFeatureFlagPayload(e)}getFeatureFlagResult(e,t){return this.featureFlags.getFeatureFlagResult(e,t)}isFeatureEnabled(e,t){return this.featureFlags.isFeatureEnabled(e,t)}reloadFeatureFlags(){this.featureFlags.reloadFeatureFlags()}updateFlags(e,t,n){var s=n!=null&&n.merge?this.featureFlags.getFlagVariants():{},i=n!=null&&n.merge?this.featureFlags.getFlagPayloads():{},c=et({},s,e),u=et({},i,t),p={};for(var[m,g]of Object.entries(c)){var x=typeof g=="string";p[m]={key:m,enabled:!!x||!!g,variant:x?g:void 0,reason:void 0,metadata:Ke(u==null?void 0:u[m])?void 0:{id:0,version:void 0,description:void 0,payload:u[m]}}}this.featureFlags.receivedFeatureFlags({flags:p})}updateEarlyAccessFeatureEnrollment(e,t,n){this.featureFlags.updateEarlyAccessFeatureEnrollment(e,t,n)}getEarlyAccessFeatures(e,t,n){return t===void 0&&(t=!1),this.featureFlags.getEarlyAccessFeatures(e,t,n)}on(e,t){return this.bi.on(e,t)}onFeatureFlags(e){return this.featureFlags.onFeatureFlags(e)}onSurveysLoaded(e){return this.surveys.onSurveysLoaded(e)}onSessionId(e){var t,n;return(t=(n=this.sessionManager)==null?void 0:n.onSessionId(e))!==null&&t!==void 0?t:()=>{}}getSurveys(e,t){t===void 0&&(t=!1),this.surveys.getSurveys(e,t)}getActiveMatchingSurveys(e,t){t===void 0&&(t=!1),this.surveys.getActiveMatchingSurveys(e,t)}renderSurvey(e,t){this.surveys.renderSurvey(e,t)}displaySurvey(e,t){t===void 0&&(t=gH),this.surveys.displaySurvey(e,t)}cancelPendingSurvey(e){this.surveys.cancelPendingSurvey(e)}canRenderSurvey(e){return this.surveys.canRenderSurvey(e)}canRenderSurveyAsync(e,t){return t===void 0&&(t=!1),this.surveys.canRenderSurveyAsync(e,t)}identify(e,t,n){if(!this.__loaded||!this.persistence)return Qe.uninitializedWarning("posthog.identify");if(Ll(e)&&(e=e.toString(),Qe.warn("The first argument to posthog.identify was a number, but it should be a string. It has been converted to a string.")),e)if(["distinct_id","distinctid"].includes(e.toLowerCase()))Qe.critical('The string "'+e+'" was set in posthog.identify which indicates an error. This ID should be unique to the user and not a hardcoded string.');else if(e!==Up){if(this.ps("posthog.identify")){var s=this.get_distinct_id();if(this.register({$user_id:e}),!this.get_property("$device_id")){var i=s;this.register_once({$had_persisted_distinct_id:!0,$device_id:i},"")}e!==s&&e!==this.get_property(om)&&(this.unregister(om),this.register({distinct_id:e}));var c=(this.persistence.get_property(Al)||"anonymous")==="anonymous";e!==s&&c?(this.persistence.set_property(Al,"identified"),this.setPersonPropertiesForFlags(et({},n||{},t||{}),!1),this.capture("$identify",{distinct_id:e,$anon_distinct_id:s},{$set:t||{},$set_once:n||{}}),this.Jr=uk(e,t,n),this.featureFlags.setAnonymousDistinctId(s)):(t||n)&&this.setPersonProperties(t,n),e!==s&&(this.reloadFeatureFlags(),this.unregister(ly))}}else Qe.critical('The string "'+Up+'" was set in posthog.identify which indicates an error. This ID is only used as a sentinel value.');else Qe.error("Unique user id has not been set in posthog.identify")}setPersonProperties(e,t){if((e||t)&&this.ps("posthog.setPersonProperties")){var n=uk(this.get_distinct_id(),e,t);this.Jr!==n?(this.setPersonPropertiesForFlags(et({},t||{},e||{})),this.capture("$set",{$set:e||{},$set_once:t||{}}),this.Jr=n):Qe.info("A duplicate setPersonProperties call was made with the same properties. It has been ignored.")}}group(e,t,n){if(e&&t){var s=this.getGroups();s[e]!==t&&this.resetGroupPropertiesForFlags(e),this.register({$groups:et({},s,{[e]:t})}),n&&(this.capture("$groupidentify",{$group_type:e,$group_key:t,$group_set:n}),this.setGroupPropertiesForFlags({[e]:n})),s[e]===t||n||this.reloadFeatureFlags()}else Qe.error("posthog.group requires a group type and group key")}resetGroups(){this.register({$groups:{}}),this.resetGroupPropertiesForFlags(),this.reloadFeatureFlags()}setPersonPropertiesForFlags(e,t){t===void 0&&(t=!0),this.featureFlags.setPersonPropertiesForFlags(e,t)}resetPersonPropertiesForFlags(){this.featureFlags.resetPersonPropertiesForFlags()}setGroupPropertiesForFlags(e,t){t===void 0&&(t=!0),this.ps("posthog.setGroupPropertiesForFlags")&&this.featureFlags.setGroupPropertiesForFlags(e,t)}resetGroupPropertiesForFlags(e){this.featureFlags.resetGroupPropertiesForFlags(e)}reset(e){var t,n,s,i;if(Qe.info("reset"),!this.__loaded)return Qe.uninitializedWarning("posthog.reset");var c=this.get_property("$device_id");if(this.consent.reset(),(t=this.persistence)==null||t.clear(),(n=this.sessionPersistence)==null||n.clear(),this.surveys.reset(),this.featureFlags.reset(),(s=this.persistence)==null||s.set_property(Al,"anonymous"),(i=this.sessionManager)==null||i.resetSessionId(),this.Jr=null,this.config.cookieless_mode==="always")this.register_once({distinct_id:Up,$device_id:null},"");else{var u=this.config.get_device_id(Lc());this.register_once({distinct_id:u,$device_id:e?u:c},"")}this.register({$last_posthog_reset:new Date().toISOString()},1)}get_distinct_id(){return this.get_property("distinct_id")}getGroups(){return this.get_property("$groups")||{}}get_session_id(){var e,t;return(e=(t=this.sessionManager)==null?void 0:t.checkAndGetSessionAndWindowId(!0).sessionId)!==null&&e!==void 0?e:""}get_session_replay_url(e){if(!this.sessionManager)return"";var{sessionId:t,sessionStartTimestamp:n}=this.sessionManager.checkAndGetSessionAndWindowId(!0),s=this.requestRouter.endpointFor("ui","/project/"+this.config.token+"/replay/"+t);if(e!=null&&e.withTimestamp&&n){var i,c=(i=e.timestampLookBack)!==null&&i!==void 0?i:10;if(!n)return s;s+="?t="+Math.max(Math.floor((new Date().getTime()-n)/1e3)-c,0)}return s}alias(e,t){return e===this.get_property(iR)?(Qe.critical("Attempting to create alias for existing People user - aborting."),-2):this.ps("posthog.alias")?(Ke(t)&&(t=this.get_distinct_id()),e!==t?(this.gs(om,e),this.capture("$create_alias",{alias:e,distinct_id:t})):(Qe.warn("alias matches current distinct_id - skipping api call."),this.identify(e),-1)):void 0}set_config(e){var t=et({},this.config);if(Vn(e)){var n,s,i,c,u,p,m;Rn(this.config,Ek(e));var g=this.Qr();(n=this.persistence)==null||n.update_config(this.config,t,g),this.sessionPersistence=this.config.persistence==="sessionStorage"||this.config.persistence==="memory"?this.persistence:new qx(et({},this.config,{persistence:"sessionStorage"}),g);var x=this.Kr(this.config.debug);Ol(x)&&(this.config.debug=x),Ol(this.config.debug)&&(this.config.debug?(Rl.DEBUG=!0,pn.H()&&pn.G("ph_debug","true"),Qe.info("set_config",{config:e,oldConfig:t,newConfig:et({},this.config)})):(Rl.DEBUG=!1,pn.H()&&pn.V("ph_debug"))),(s=this.exceptionObserver)==null||s.onConfigChange(),(i=this.sessionRecording)==null||i.startIfEnabledOrStop(),(c=this.autocapture)==null||c.startIfEnabled(),(u=this.heatmaps)==null||u.startIfEnabled(),(p=this.exceptionObserver)==null||p.startIfEnabledOrStop(),this.surveys.loadIfEnabled(),this._s(),(m=this.externalIntegrations)==null||m.startIfEnabledOrStop()}}startSessionRecording(e){var t=e===!0,n={sampling:t||!(e==null||!e.sampling),linked_flag:t||!(e==null||!e.linked_flag),url_trigger:t||!(e==null||!e.url_trigger),event_trigger:t||!(e==null||!e.event_trigger)};if(Object.values(n).some(Boolean)){var s,i,c,u,p;(s=this.sessionManager)==null||s.checkAndGetSessionAndWindowId(),n.sampling&&((i=this.sessionRecording)==null||i.overrideSampling()),n.linked_flag&&((c=this.sessionRecording)==null||c.overrideLinkedFlag()),n.url_trigger&&((u=this.sessionRecording)==null||u.overrideTrigger("url")),n.event_trigger&&((p=this.sessionRecording)==null||p.overrideTrigger("event"))}this.set_config({disable_session_recording:!1})}stopSessionRecording(){this.set_config({disable_session_recording:!0})}sessionRecordingStarted(){var e;return!((e=this.sessionRecording)==null||!e.started)}captureException(e,t){var n=new Error("PostHog syntheticException"),s=this.exceptions.buildProperties(e,{handled:!0,syntheticException:n});return this.exceptions.sendExceptionEvent(et({},s,t))}startExceptionAutocapture(e){this.set_config({capture_exceptions:e==null||e})}stopExceptionAutocapture(){this.set_config({capture_exceptions:!1})}loadToolbar(e){return this.toolbar.loadToolbar(e)}get_property(e){var t;return(t=this.persistence)==null?void 0:t.props[e]}getSessionProperty(e){var t;return(t=this.sessionPersistence)==null?void 0:t.props[e]}toString(){var e,t=(e=this.config.name)!==null&&e!==void 0?e:Hf;return t!==Hf&&(t=Hf+"."+t),t}_isIdentified(){var e,t;return((e=this.persistence)==null?void 0:e.get_property(Al))==="identified"||((t=this.sessionPersistence)==null?void 0:t.get_property(Al))==="identified"}fs(){var e,t;return!(this.config.person_profiles==="never"||this.config.person_profiles==="identified_only"&&!this._isIdentified()&&Wf(this.getGroups())&&((e=this.persistence)==null||(e=e.props)==null||!e[om])&&((t=this.persistence)==null||(t=t.props)==null||!t[uy]))}ds(){return this.config.capture_pageleave===!0||this.config.capture_pageleave==="if_capture_pageview"&&(this.config.capture_pageview===!0||this.config.capture_pageview==="history_change")}createPersonProfile(){this.fs()||this.ps("posthog.createPersonProfile")&&this.setPersonProperties({},{})}setInternalOrTestUser(){this.ps("posthog.setInternalOrTestUser")&&this.setPersonProperties({$internal_or_test_user:!0})}ps(e){return this.config.person_profiles==="never"?(Qe.error(e+' was called, but process_person is set to "never". This call will be ignored.'),!1):(this.gs(uy,!0),!0)}Qr(){if(this.config.cookieless_mode==="always")return!0;var e=this.consent.isOptedOut(),t=this.config.opt_out_persistence_by_default||this.config.cookieless_mode==="on_reject";return this.config.disable_persistence||e&&!!t}_s(){var e,t,n,s,i=this.Qr();return((e=this.persistence)==null?void 0:e.Pi)!==i&&((n=this.persistence)==null||n.set_disabled(i)),((t=this.sessionPersistence)==null?void 0:t.Pi)!==i&&((s=this.sessionPersistence)==null||s.set_disabled(i)),i}opt_in_capturing(e){var t;if(this.config.cookieless_mode!=="always"){var n,s,i;this.config.cookieless_mode==="on_reject"&&this.consent.isExplicitlyOptedOut()&&(this.reset(!0),(n=this.sessionManager)==null||n.destroy(),(s=this.pageViewManager)==null||s.destroy(),this.sessionManager=new xk(this),this.pageViewManager=new sk(this),this.persistence&&(this.sessionPropsManager=new yk(this,this.sessionManager,this.persistence)),this.sessionRecording=new bk(this),this.sessionRecording.startIfEnabledOrStop()),this.consent.optInOut(!0),this._s(),this.us(),(t=this.sessionRecording)==null||t.startIfEnabledOrStop(),this.config.cookieless_mode=="on_reject"&&this.surveys.loadIfEnabled(),(Ke(e==null?void 0:e.captureEventName)||e!=null&&e.captureEventName)&&this.capture((i=e==null?void 0:e.captureEventName)!==null&&i!==void 0?i:"$opt_in",e==null?void 0:e.captureProperties,{send_instantly:!0}),this.config.capture_pageview&&this.hs()}else Qe.warn('Consent opt in/out is not valid with cookieless_mode="always" and will be ignored')}opt_out_capturing(){var e,t,n;this.config.cookieless_mode!=="always"?(this.config.cookieless_mode==="on_reject"&&this.consent.isOptedIn()&&this.reset(!0),this.consent.optInOut(!1),this._s(),this.config.cookieless_mode==="on_reject"&&(this.register({distinct_id:Up,$device_id:null}),(e=this.sessionManager)==null||e.destroy(),(t=this.pageViewManager)==null||t.destroy(),this.sessionManager=void 0,this.sessionPropsManager=void 0,(n=this.sessionRecording)==null||n.stopRecording(),this.sessionRecording=void 0,this.hs())):Qe.warn('Consent opt in/out is not valid with cookieless_mode="always" and will be ignored')}has_opted_in_capturing(){return this.consent.isOptedIn()}has_opted_out_capturing(){return this.consent.isOptedOut()}get_explicit_consent_status(){var e=this.consent.consent;return e===Il.GRANTED?"granted":e===Il.DENIED?"denied":"pending"}is_capturing(){return this.config.cookieless_mode==="always"||(this.config.cookieless_mode==="on_reject"?this.consent.isExplicitlyOptedOut()||this.consent.isOptedIn():!this.has_opted_out_capturing())}clear_opt_in_out_capturing(){this.consent.reset(),this._s()}_is_bot(){return Go?HR(Go,this.config.custom_blocked_useragents):void 0}hs(){qe&&(qe.visibilityState==="visible"?this.Wr||(this.Wr=!0,this.capture("$pageview",{title:qe.title},{send_instantly:!0}),this.Gr&&(qe.removeEventListener("visibilitychange",this.Gr),this.Gr=null)):this.Gr||(this.Gr=this.hs.bind(this),Ln(qe,"visibilitychange",this.Gr)))}debug(e){e===!1?(be==null||be.console.log("You've disabled debug mode."),this.set_config({debug:!1})):(be==null||be.console.log("You're now in debug mode. All calls to PostHog will be logged in your console.\nYou can disable this with `posthog.debug(false)`."),this.set_config({debug:!0}))}M(){var e,t,n,s,i,c,u,p=this.Yr||{};return"advanced_disable_flags"in p?!!p.advanced_disable_flags:this.config.advanced_disable_flags!==!1?!!this.config.advanced_disable_flags:this.config.advanced_disable_decide===!0?(Qe.warn("Config field 'advanced_disable_decide' is deprecated. Please use 'advanced_disable_flags' instead. The old field will be removed in a future major version."),!0):(n="advanced_disable_decide",s=!1,i=Qe,c=(t="advanced_disable_flags")in(e=p)&&!cr(e[t]),u=n in e&&!cr(e[n]),c?e[t]:u?(i&&i.warn("Config field '"+n+"' is deprecated. Please use '"+t+"' instead. The old field will be removed in a future major version."),e[n]):s)}cs(e){if(cr(this.config.before_send))return e;var t=Fr(this.config.before_send)?this.config.before_send:[this.config.before_send],n=e;for(var s of t){if(n=s(n),cr(n)){var i="Event '"+e.event+"' was rejected in beforeSend function";return N8(e.event)?Qe.warn(i+". This can cause unexpected behavior."):Qe.info(i),null}n.properties&&!Wf(n.properties)||Qe.warn("Event '"+e.event+"' has no properties after beforeSend function, this is likely an error.")}return n}getPageViewId(){var e;return(e=this.pageViewManager.Kt)==null?void 0:e.pageViewId}captureTraceFeedback(e,t){this.capture("$ai_feedback",{$ai_trace_id:String(e),$ai_feedback_text:t})}captureTraceMetric(e,t,n){this.capture("$ai_metric",{$ai_trace_id:String(e),$ai_metric_name:t,$ai_metric_value:String(n)})}Kr(e){var t=Ol(e)&&!e,n=pn.H()&&pn.q("ph_debug")==="true";return!t&&(!!n||e)}}(function(r,e){for(var t=0;t<e.length;t++)r.prototype[e[t]]=cz(r.prototype[e[t]])})(Yy,["identify"]);var Sk,Oa=(Sk=ym[Hf]=new Yy,(function(){function r(){r.done||(r.done=!0,BR=!1,Xr(ym,(function(e){e._dom_loaded()})))}qe!=null&&qe.addEventListener?qe.readyState==="complete"?r():Ln(qe,"DOMContentLoaded",r,{capture:!1}):be&&Qe.error("Browser doesn't support `document.addEventListener` so PostHog couldn't be initialized")})(),Sk),GR=w.createContext({client:Oa,bootstrap:void 0});function WR(r,e,t){if(t===void 0&&(t=new WeakMap),r===e)return!0;if(typeof r!="object"||r===null||typeof e!="object"||e===null)return!1;if(t.has(r)&&t.get(r)===e)return!0;t.set(r,e);var n=Object.keys(r),s=Object.keys(e);if(n.length!==s.length)return!1;for(var i=0,c=n;i<c.length;i++){var u=c[i];if(!s.includes(u)||!WR(r[u],e[u],t))return!1}return!0}function MH(r){var e,t,n=r.children,s=r.client,i=r.apiKey,c=r.options,u=w.useRef(null),p=w.useMemo(function(){return s?(i&&console.warn("[PostHog.js] You have provided both `client` and `apiKey` to `PostHogProvider`. `apiKey` will be ignored in favour of `client`."),c&&console.warn("[PostHog.js] You have provided both `client` and `options` to `PostHogProvider`. `options` will be ignored in favour of `client`."),s):(i||console.warn("[PostHog.js] No `apiKey` or `client` were provided to `PostHogProvider`. Using default global `window.posthog` instance. You must initialize it manually. This is not recommended behavior."),Oa)},[s,i,JSON.stringify(c)]);return w.useEffect(function(){if(!s){var m=u.current;m?(i!==m.apiKey&&console.warn("[PostHog.js] You have provided a different `apiKey` to `PostHogProvider` than the one that was already initialized. This is not supported by our provider and we'll keep using the previous key. If you need to toggle between API Keys you need to control the `client` yourself and pass it in as a prop rather than an `apiKey` prop."),c&&!WR(c,m.options)&&Oa.set_config(c),u.current={apiKey:i,options:c??{}}):(Oa.__loaded&&console.warn("[PostHog.js] `posthog` was already loaded elsewhere. This may cause issues."),Oa.init(i,c),u.current={apiKey:i,options:c??{}})}},[s,i,JSON.stringify(c)]),lr.createElement(GR.Provider,{value:{client:p,bootstrap:(e=c==null?void 0:c.bootstrap)!==null&&e!==void 0?e:(t=s==null?void 0:s.config)===null||t===void 0?void 0:t.bootstrap}},n)}var Qx=function(r){return typeof r=="function"},pb=function(r,e){return pb=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])},pb(r,e)};function $H(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");pb(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var UH={componentStack:null,exceptionEvent:null,error:null},zH={INVALID_FALLBACK:"[PostHog.js][PostHogErrorBoundary] Invalid fallback prop, provide a valid React element or a function that returns a valid React element."};(function(r){$H(e,r);function e(t){var n=r.call(this,t)||this;return n.state=UH,n}return e.prototype.componentDidCatch=function(t,n){var s=this.props.additionalProperties,i;Qx(s)?i=s(t):typeof s=="object"&&(i=s);var c=this.context.client,u=c.captureException(t,i),p=n.componentStack;this.setState({error:t,componentStack:p??null,exceptionEvent:u})},e.prototype.render=function(){var t=this.props,n=t.children,s=t.fallback,i=this.state;if(i.componentStack==null)return Qx(n)?n():n;var c=Qx(s)?lr.createElement(s,{error:i.error,componentStack:i.componentStack,exceptionEvent:i.exceptionEvent}):s;return lr.isValidElement(c)?c:(console.warn(zH.INVALID_FALLBACK),lr.createElement(lr.Fragment,null))},e.contextType=GR,e})(lr.Component);function Ur(){var e;const r=w.useContext(J_);if(r.isLoading)return{debug:async()=>{},info:async()=>{},warn:async()=>{},error:async()=>{}};if(!((e=r.services)!=null&&e.logging))throw new Error("Logging provider not available. Make sure PlatformProvider is wrapping your component.");return r.services.logging}function Ck(r){try{const e=r.split(".")[1];return JSON.parse(atob(e.replace(/-/g,"+").replace(/_/g,"/"))).email??null}catch{return null}}const HH=({children:r})=>{const e=Hl(),t=Ur();return w.useEffect(()=>{if(typeof window>"u"||!Dw){console.warn(" PostHog: Not initialized - missing or invalid key");return}(async()=>{const s=await Rm(t),i=s!=null&&s.id_token?Ck(s.id_token):null;Oa.init(Dw,{api_host:QN,autocapture:!0,capture_pageview:!0,capture_pageleave:!0,capture_dead_clicks:!1,disable_session_recording:!0,loaded:c=>{i&&c.identify(i,{email:i}),console.log("PostHog: Initialized successfully")},debug:GN==="dev"})})()},[]),w.useEffect(()=>{var s;const n=i=>{"token"in i&&(i.token.newValue?Rm(t).then(c=>{const u=c!=null&&c.id_token?Ck(c.id_token):null;u&&Oa.identify(u,{email:u})}):Oa.reset())};return(s=e==null?void 0:e.onChanged)==null||s.call(e,n),()=>{var i;(i=e==null?void 0:e.removeChangeListener)==null||i.call(e,n)}},[e,t]),d.jsx(MH,{client:Oa,children:r})},rn=w.forwardRef(({className:r,type:e,...t},n)=>d.jsx("input",{type:e,className:Rr("flex h-10 w-full rounded-md border border-neutral-200 bg-white px-3 py-2 text-base text-neutral-950 ring-offset-white file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-neutral-950 placeholder:text-neutral-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm dark:border-border dark:bg-card dark:text-gray-100 dark:ring-offset-neutral-950 dark:file:text-neutral-50 dark:placeholder:text-neutral-400 dark:focus-visible:ring-primary",r),ref:n,...t}));rn.displayName="Input";const kk=r=>typeof r=="boolean"?`${r}`:r===0?"0":r,Nk=_T,cE=(r,e)=>t=>{var n;if((e==null?void 0:e.variants)==null)return Nk(r,t==null?void 0:t.class,t==null?void 0:t.className);const{variants:s,defaultVariants:i}=e,c=Object.keys(s).map(m=>{const g=t==null?void 0:t[m],x=i==null?void 0:i[m];if(g===null)return null;const b=kk(g)||kk(x);return s[m][b]}),u=t&&Object.entries(t).reduce((m,g)=>{let[x,b]=g;return b===void 0||(m[x]=b),m},{}),p=e==null||(n=e.compoundVariants)===null||n===void 0?void 0:n.reduce((m,g)=>{let{class:x,className:b,...E}=g;return Object.entries(E).every(T=>{let[S,N]=T;return Array.isArray(N)?N.includes({...i,...u}[S]):{...i,...u}[S]===N})?[...m,x,b]:m},[]);return Nk(r,c,p,t==null?void 0:t.class,t==null?void 0:t.className)},BH=cE("rounded-lg border border-neutral-200 bg-white text-neutral-950 shadow-sm dark:border-border dark:bg-card dark:text-card-foreground",{variants:{variant:{default:"",TemplateCard:"",ReferenceSourcesCard:"",IntegrationsCard:""}},defaultVariants:{variant:"default"}}),fi=w.forwardRef(({className:r,variant:e,...t},n)=>d.jsx("div",{ref:n,className:Rr(BH({variant:e,className:r})),...t}));fi.displayName="Card";const Gi=w.forwardRef(({className:r,cardVariant:e,...t},n)=>d.jsx("div",{ref:n,className:Rr(e==="TemplateCard"?"flex flex-col space-y-1 p-4":"flex flex-col space-y-1.5 p-6",r),...t}));Gi.displayName="CardHeader";const Wi=w.forwardRef(({className:r,...e},t)=>d.jsx("h3",{ref:t,className:Rr("font-semibold leading-none tracking-tight",r),...e}));Wi.displayName="CardTitle";const GH=w.forwardRef(({className:r,...e},t)=>d.jsx("p",{ref:t,className:Rr("text-sm text-neutral-500 dark:text-neutral-400",r),...e}));GH.displayName="CardDescription";const hi=w.forwardRef(({className:r,cardVariant:e,...t},n)=>d.jsx("div",{ref:n,className:Rr(e==="TemplateCard"?"p-0 pt-0":"p-6 pt-0",r),...t}));hi.displayName="CardContent";const WH=w.forwardRef(({className:r,...e},t)=>d.jsx("div",{ref:t,className:Rr("flex items-center p-6 pt-0",r),...e}));WH.displayName="CardFooter";function Tk(r,e){if(typeof r=="function")return r(e);r!=null&&(r.current=e)}function Yc(...r){return e=>{let t=!1;const n=r.map(s=>{const i=Tk(s,e);return!t&&typeof i=="function"&&(t=!0),i});if(t)return()=>{for(let s=0;s<n.length;s++){const i=n[s];typeof i=="function"?i():Tk(r[s],null)}}}}function Mn(...r){return w.useCallback(Yc(...r),r)}var VH=Symbol.for("react.lazy"),xy=Ab[" use ".trim().toString()];function qH(r){return typeof r=="object"&&r!==null&&"then"in r}function VR(r){return r!=null&&typeof r=="object"&&"$$typeof"in r&&r.$$typeof===VH&&"_payload"in r&&qH(r._payload)}function KH(r){const e=JH(r),t=w.forwardRef((n,s)=>{let{children:i,...c}=n;VR(i)&&typeof xy=="function"&&(i=xy(i._payload));const u=w.Children.toArray(i),p=u.find(QH);if(p){const m=p.props.children,g=u.map(x=>x===p?w.Children.count(m)>1?w.Children.only(null):w.isValidElement(m)?m.props.children:null:x);return d.jsx(e,{...c,ref:s,children:w.isValidElement(m)?w.cloneElement(m,void 0,g):null})}return d.jsx(e,{...c,ref:s,children:i})});return t.displayName=`${r}.Slot`,t}var YH=KH("Slot");function JH(r){const e=w.forwardRef((t,n)=>{let{children:s,...i}=t;if(VR(s)&&typeof xy=="function"&&(s=xy(s._payload)),w.isValidElement(s)){const c=eB(s),u=ZH(i,s.props);return s.type!==w.Fragment&&(u.ref=n?Yc(n,c):c),w.cloneElement(s,u)}return w.Children.count(s)>1?w.Children.only(null):null});return e.displayName=`${r}.SlotClone`,e}var XH=Symbol("radix.slottable");function QH(r){return w.isValidElement(r)&&typeof r.type=="function"&&"__radixId"in r.type&&r.type.__radixId===XH}function ZH(r,e){const t={...e};for(const n in e){const s=r[n],i=e[n];/^on[A-Z]/.test(n)?s&&i?t[n]=(...u)=>{const p=i(...u);return s(...u),p}:s&&(t[n]=s):n==="style"?t[n]={...s,...i}:n==="className"&&(t[n]=[s,i].filter(Boolean).join(" "))}return{...r,...t}}function eB(r){var n,s;let e=(n=Object.getOwnPropertyDescriptor(r.props,"ref"))==null?void 0:n.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=(s=Object.getOwnPropertyDescriptor(r,"ref"))==null?void 0:s.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}const tB=cE("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-white transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 dark:ring-offset-neutral-950 dark:focus-visible:ring-primary",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90 dark:bg-primary dark:text-primary-foreground dark:hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90 dark:bg-destructive dark:text-destructive-foreground dark:hover:bg-destructive/90",outline:"border border-neutral-200 bg-background hover:bg-accent hover:text-accent-foreground dark:border-neutral-800 dark:bg-background dark:hover:bg-accent dark:hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80 dark:bg-secondary dark:text-secondary-foreground dark:hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent dark:hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline dark:text-primary"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),$e=w.forwardRef(({className:r,variant:e,size:t,asChild:n=!1,...s},i)=>{const c=n?YH:"button";return d.jsx(c,{className:Rr(tB({variant:e,size:t,className:r})),ref:i,...s})});$e.displayName="Button";/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rB=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),qR=(...r)=>r.filter((e,t,n)=>!!e&&n.indexOf(e)===t).join(" ");/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var nB={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sB=w.forwardRef(({color:r="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:n,className:s="",children:i,iconNode:c,...u},p)=>w.createElement("svg",{ref:p,...nB,width:e,height:e,stroke:r,strokeWidth:n?Number(t)*24/Number(e):t,className:qR("lucide",s),...u},[...c.map(([m,g])=>w.createElement(m,g)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qt=(r,e)=>{const t=w.forwardRef(({className:n,...s},i)=>w.createElement(sB,{ref:i,iconNode:e,className:qR(`lucide-${rB(r)}`,n),...s}));return t.displayName=`${r}`,t};/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KR=Qt("ArrowDownToLine",[["path",{d:"M12 17V3",key:"1cwfxf"}],["path",{d:"m6 11 6 6 6-6",key:"12ii2o"}],["path",{d:"M19 21H5",key:"150jfl"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xm=Qt("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oB=Qt("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YR=Qt("Briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zx=Qt("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Df=Qt("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iB=Qt("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ys=Qt("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vv=Qt("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sv=Qt("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wy=Qt("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hc=Qt("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aB=Qt("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cv=Qt("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lB=Qt("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cB=Qt("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jl=Qt("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uB=Qt("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dB=Qt("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qf=Qt("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fB=Qt("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ew=Qt("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hB=Qt("Folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pB=Qt("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mB=Qt("ListTodo",[["rect",{x:"3",y:"5",width:"6",height:"6",rx:"1",key:"1defrl"}],["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qi=Qt("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wc=Qt("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gB=Qt("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rk=Qt("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vB=Qt("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yB=Qt("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xB=Qt("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ak=Qt("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wB=Qt("Presentation",[["path",{d:"M2 3h20",key:"91anmk"}],["path",{d:"M21 3v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V3",key:"2k9sn8"}],["path",{d:"m7 21 5-5 5 5",key:"bip4we"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Co=Qt("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zs=Qt("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zf=Qt("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const by=Qt("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JR=Qt("WifiOff",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gi=Qt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function Pt(r,e,{checkForDefaultPrevented:t=!0}={}){return function(s){if(r==null||r(s),t===!1||!s.defaultPrevented)return e==null?void 0:e(s)}}function bB(r,e){const t=w.createContext(e),n=i=>{const{children:c,...u}=i,p=w.useMemo(()=>u,Object.values(u));return d.jsx(t.Provider,{value:p,children:c})};n.displayName=r+"Provider";function s(i){const c=w.useContext(t);if(c)return c;if(e!==void 0)return e;throw new Error(`\`${i}\` must be used within \`${r}\``)}return[n,s]}function za(r,e=[]){let t=[];function n(i,c){const u=w.createContext(c),p=t.length;t=[...t,c];const m=x=>{var R;const{scope:b,children:E,...T}=x,S=((R=b==null?void 0:b[r])==null?void 0:R[p])||u,N=w.useMemo(()=>T,Object.values(T));return d.jsx(S.Provider,{value:N,children:E})};m.displayName=i+"Provider";function g(x,b){var S;const E=((S=b==null?void 0:b[r])==null?void 0:S[p])||u,T=w.useContext(E);if(T)return T;if(c!==void 0)return c;throw new Error(`\`${x}\` must be used within \`${i}\``)}return[m,g]}const s=()=>{const i=t.map(c=>w.createContext(c));return function(u){const p=(u==null?void 0:u[r])||i;return w.useMemo(()=>({[`__scope${r}`]:{...u,[r]:p}}),[u,p])}};return s.scopeName=r,[n,_B(s,...e)]}function _B(...r){const e=r[0];if(r.length===1)return e;const t=()=>{const n=r.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const c=n.reduce((u,{useScope:p,scopeName:m})=>{const x=p(i)[`__scope${m}`];return{...u,...x}},{});return w.useMemo(()=>({[`__scope${e.scopeName}`]:c}),[c])}};return t.scopeName=e.scopeName,t}var Ml=globalThis!=null&&globalThis.document?w.useLayoutEffect:()=>{},EB=Ab[" useInsertionEffect ".trim().toString()]||Ml;function Jc({prop:r,defaultProp:e,onChange:t=()=>{},caller:n}){const[s,i,c]=SB({defaultProp:e,onChange:t}),u=r!==void 0,p=u?r:s;{const g=w.useRef(r!==void 0);w.useEffect(()=>{const x=g.current;x!==u&&console.warn(`${n} is changing from ${x?"controlled":"uncontrolled"} to ${u?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),g.current=u},[u,n])}const m=w.useCallback(g=>{var x;if(u){const b=CB(g)?g(r):g;b!==r&&((x=c.current)==null||x.call(c,b))}else i(g)},[u,r,i,c]);return[p,m]}function SB({defaultProp:r,onChange:e}){const[t,n]=w.useState(r),s=w.useRef(t),i=w.useRef(e);return EB(()=>{i.current=e},[e]),w.useEffect(()=>{var c;s.current!==t&&((c=i.current)==null||c.call(i,t),s.current=t)},[t,s]),[t,n,i]}function CB(r){return typeof r=="function"}const kB=["top","right","bottom","left"],Vc=Math.min,Bo=Math.max,_y=Math.round,kv=Math.floor,$a=r=>({x:r,y:r}),NB={left:"right",right:"left",bottom:"top",top:"bottom"},TB={start:"end",end:"start"};function mb(r,e,t){return Bo(r,Vc(e,t))}function $l(r,e){return typeof r=="function"?r(e):r}function Ul(r){return r.split("-")[0]}function mh(r){return r.split("-")[1]}function uE(r){return r==="x"?"y":"x"}function dE(r){return r==="y"?"height":"width"}const RB=new Set(["top","bottom"]);function Ma(r){return RB.has(Ul(r))?"y":"x"}function fE(r){return uE(Ma(r))}function AB(r,e,t){t===void 0&&(t=!1);const n=mh(r),s=fE(r),i=dE(s);let c=s==="x"?n===(t?"end":"start")?"right":"left":n==="start"?"bottom":"top";return e.reference[i]>e.floating[i]&&(c=Ey(c)),[c,Ey(c)]}function IB(r){const e=Ey(r);return[gb(r),e,gb(e)]}function gb(r){return r.replace(/start|end/g,e=>TB[e])}const Ik=["left","right"],Pk=["right","left"],PB=["top","bottom"],FB=["bottom","top"];function jB(r,e,t){switch(r){case"top":case"bottom":return t?e?Pk:Ik:e?Ik:Pk;case"left":case"right":return e?PB:FB;default:return[]}}function OB(r,e,t,n){const s=mh(r);let i=jB(Ul(r),t==="start",n);return s&&(i=i.map(c=>c+"-"+s),e&&(i=i.concat(i.map(gb)))),i}function Ey(r){return r.replace(/left|right|bottom|top/g,e=>NB[e])}function DB(r){return{top:0,right:0,bottom:0,left:0,...r}}function XR(r){return typeof r!="number"?DB(r):{top:r,right:r,bottom:r,left:r}}function Sy(r){const{x:e,y:t,width:n,height:s}=r;return{width:n,height:s,top:t,left:e,right:e+n,bottom:t+s,x:e,y:t}}function Fk(r,e,t){let{reference:n,floating:s}=r;const i=Ma(e),c=fE(e),u=dE(c),p=Ul(e),m=i==="y",g=n.x+n.width/2-s.width/2,x=n.y+n.height/2-s.height/2,b=n[u]/2-s[u]/2;let E;switch(p){case"top":E={x:g,y:n.y-s.height};break;case"bottom":E={x:g,y:n.y+n.height};break;case"right":E={x:n.x+n.width,y:x};break;case"left":E={x:n.x-s.width,y:x};break;default:E={x:n.x,y:n.y}}switch(mh(e)){case"start":E[c]-=b*(t&&m?-1:1);break;case"end":E[c]+=b*(t&&m?-1:1);break}return E}async function LB(r,e){var t;e===void 0&&(e={});const{x:n,y:s,platform:i,rects:c,elements:u,strategy:p}=r,{boundary:m="clippingAncestors",rootBoundary:g="viewport",elementContext:x="floating",altBoundary:b=!1,padding:E=0}=$l(e,r),T=XR(E),N=u[b?x==="floating"?"reference":"floating":x],R=Sy(await i.getClippingRect({element:(t=await(i.isElement==null?void 0:i.isElement(N)))==null||t?N:N.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(u.floating)),boundary:m,rootBoundary:g,strategy:p})),A=x==="floating"?{x:n,y:s,width:c.floating.width,height:c.floating.height}:c.reference,j=await(i.getOffsetParent==null?void 0:i.getOffsetParent(u.floating)),P=await(i.isElement==null?void 0:i.isElement(j))?await(i.getScale==null?void 0:i.getScale(j))||{x:1,y:1}:{x:1,y:1},M=Sy(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:u,rect:A,offsetParent:j,strategy:p}):A);return{top:(R.top-M.top+T.top)/P.y,bottom:(M.bottom-R.bottom+T.bottom)/P.y,left:(R.left-M.left+T.left)/P.x,right:(M.right-R.right+T.right)/P.x}}const MB=async(r,e,t)=>{const{placement:n="bottom",strategy:s="absolute",middleware:i=[],platform:c}=t,u=i.filter(Boolean),p=await(c.isRTL==null?void 0:c.isRTL(e));let m=await c.getElementRects({reference:r,floating:e,strategy:s}),{x:g,y:x}=Fk(m,n,p),b=n,E={},T=0;for(let N=0;N<u.length;N++){var S;const{name:R,fn:A}=u[N],{x:j,y:P,data:M,reset:B}=await A({x:g,y:x,initialPlacement:n,placement:b,strategy:s,middlewareData:E,rects:m,platform:{...c,detectOverflow:(S=c.detectOverflow)!=null?S:LB},elements:{reference:r,floating:e}});g=j??g,x=P??x,E={...E,[R]:{...E[R],...M}},B&&T<=50&&(T++,typeof B=="object"&&(B.placement&&(b=B.placement),B.rects&&(m=B.rects===!0?await c.getElementRects({reference:r,floating:e,strategy:s}):B.rects),{x:g,y:x}=Fk(m,b,p)),N=-1)}return{x:g,y:x,placement:b,strategy:s,middlewareData:E}},$B=r=>({name:"arrow",options:r,async fn(e){const{x:t,y:n,placement:s,rects:i,platform:c,elements:u,middlewareData:p}=e,{element:m,padding:g=0}=$l(r,e)||{};if(m==null)return{};const x=XR(g),b={x:t,y:n},E=fE(s),T=dE(E),S=await c.getDimensions(m),N=E==="y",R=N?"top":"left",A=N?"bottom":"right",j=N?"clientHeight":"clientWidth",P=i.reference[T]+i.reference[E]-b[E]-i.floating[T],M=b[E]-i.reference[E],B=await(c.getOffsetParent==null?void 0:c.getOffsetParent(m));let U=B?B[j]:0;(!U||!await(c.isElement==null?void 0:c.isElement(B)))&&(U=u.floating[j]||i.floating[T]);const V=P/2-M/2,Y=U/2-S[T]/2-1,ce=Vc(x[R],Y),X=Vc(x[A],Y),de=ce,we=U-S[T]-X,le=U/2-S[T]/2+V,se=mb(de,le,we),me=!p.arrow&&mh(s)!=null&&le!==se&&i.reference[T]/2-(le<de?ce:X)-S[T]/2<0,te=me?le<de?le-de:le-we:0;return{[E]:b[E]+te,data:{[E]:se,centerOffset:le-se-te,...me&&{alignmentOffset:te}},reset:me}}}),UB=function(r){return r===void 0&&(r={}),{name:"flip",options:r,async fn(e){var t,n;const{placement:s,middlewareData:i,rects:c,initialPlacement:u,platform:p,elements:m}=e,{mainAxis:g=!0,crossAxis:x=!0,fallbackPlacements:b,fallbackStrategy:E="bestFit",fallbackAxisSideDirection:T="none",flipAlignment:S=!0,...N}=$l(r,e);if((t=i.arrow)!=null&&t.alignmentOffset)return{};const R=Ul(s),A=Ma(u),j=Ul(u)===u,P=await(p.isRTL==null?void 0:p.isRTL(m.floating)),M=b||(j||!S?[Ey(u)]:IB(u)),B=T!=="none";!b&&B&&M.push(...OB(u,S,T,P));const U=[u,...M],V=await p.detectOverflow(e,N),Y=[];let ce=((n=i.flip)==null?void 0:n.overflows)||[];if(g&&Y.push(V[R]),x){const le=AB(s,c,P);Y.push(V[le[0]],V[le[1]])}if(ce=[...ce,{placement:s,overflows:Y}],!Y.every(le=>le<=0)){var X,de;const le=(((X=i.flip)==null?void 0:X.index)||0)+1,se=U[le];if(se&&(!(x==="alignment"?A!==Ma(se):!1)||ce.every(G=>Ma(G.placement)===A?G.overflows[0]>0:!0)))return{data:{index:le,overflows:ce},reset:{placement:se}};let me=(de=ce.filter(te=>te.overflows[0]<=0).sort((te,G)=>te.overflows[1]-G.overflows[1])[0])==null?void 0:de.placement;if(!me)switch(E){case"bestFit":{var we;const te=(we=ce.filter(G=>{if(B){const z=Ma(G.placement);return z===A||z==="y"}return!0}).map(G=>[G.placement,G.overflows.filter(z=>z>0).reduce((z,J)=>z+J,0)]).sort((G,z)=>G[1]-z[1])[0])==null?void 0:we[0];te&&(me=te);break}case"initialPlacement":me=u;break}if(s!==me)return{reset:{placement:me}}}return{}}}};function jk(r,e){return{top:r.top-e.height,right:r.right-e.width,bottom:r.bottom-e.height,left:r.left-e.width}}function Ok(r){return kB.some(e=>r[e]>=0)}const zB=function(r){return r===void 0&&(r={}),{name:"hide",options:r,async fn(e){const{rects:t,platform:n}=e,{strategy:s="referenceHidden",...i}=$l(r,e);switch(s){case"referenceHidden":{const c=await n.detectOverflow(e,{...i,elementContext:"reference"}),u=jk(c,t.reference);return{data:{referenceHiddenOffsets:u,referenceHidden:Ok(u)}}}case"escaped":{const c=await n.detectOverflow(e,{...i,altBoundary:!0}),u=jk(c,t.floating);return{data:{escapedOffsets:u,escaped:Ok(u)}}}default:return{}}}}},QR=new Set(["left","top"]);async function HB(r,e){const{placement:t,platform:n,elements:s}=r,i=await(n.isRTL==null?void 0:n.isRTL(s.floating)),c=Ul(t),u=mh(t),p=Ma(t)==="y",m=QR.has(c)?-1:1,g=i&&p?-1:1,x=$l(e,r);let{mainAxis:b,crossAxis:E,alignmentAxis:T}=typeof x=="number"?{mainAxis:x,crossAxis:0,alignmentAxis:null}:{mainAxis:x.mainAxis||0,crossAxis:x.crossAxis||0,alignmentAxis:x.alignmentAxis};return u&&typeof T=="number"&&(E=u==="end"?T*-1:T),p?{x:E*g,y:b*m}:{x:b*m,y:E*g}}const BB=function(r){return r===void 0&&(r=0),{name:"offset",options:r,async fn(e){var t,n;const{x:s,y:i,placement:c,middlewareData:u}=e,p=await HB(e,r);return c===((t=u.offset)==null?void 0:t.placement)&&(n=u.arrow)!=null&&n.alignmentOffset?{}:{x:s+p.x,y:i+p.y,data:{...p,placement:c}}}}},GB=function(r){return r===void 0&&(r={}),{name:"shift",options:r,async fn(e){const{x:t,y:n,placement:s,platform:i}=e,{mainAxis:c=!0,crossAxis:u=!1,limiter:p={fn:R=>{let{x:A,y:j}=R;return{x:A,y:j}}},...m}=$l(r,e),g={x:t,y:n},x=await i.detectOverflow(e,m),b=Ma(Ul(s)),E=uE(b);let T=g[E],S=g[b];if(c){const R=E==="y"?"top":"left",A=E==="y"?"bottom":"right",j=T+x[R],P=T-x[A];T=mb(j,T,P)}if(u){const R=b==="y"?"top":"left",A=b==="y"?"bottom":"right",j=S+x[R],P=S-x[A];S=mb(j,S,P)}const N=p.fn({...e,[E]:T,[b]:S});return{...N,data:{x:N.x-t,y:N.y-n,enabled:{[E]:c,[b]:u}}}}}},WB=function(r){return r===void 0&&(r={}),{options:r,fn(e){const{x:t,y:n,placement:s,rects:i,middlewareData:c}=e,{offset:u=0,mainAxis:p=!0,crossAxis:m=!0}=$l(r,e),g={x:t,y:n},x=Ma(s),b=uE(x);let E=g[b],T=g[x];const S=$l(u,e),N=typeof S=="number"?{mainAxis:S,crossAxis:0}:{mainAxis:0,crossAxis:0,...S};if(p){const j=b==="y"?"height":"width",P=i.reference[b]-i.floating[j]+N.mainAxis,M=i.reference[b]+i.reference[j]-N.mainAxis;E<P?E=P:E>M&&(E=M)}if(m){var R,A;const j=b==="y"?"width":"height",P=QR.has(Ul(s)),M=i.reference[x]-i.floating[j]+(P&&((R=c.offset)==null?void 0:R[x])||0)+(P?0:N.crossAxis),B=i.reference[x]+i.reference[j]+(P?0:((A=c.offset)==null?void 0:A[x])||0)-(P?N.crossAxis:0);T<M?T=M:T>B&&(T=B)}return{[b]:E,[x]:T}}}},VB=function(r){return r===void 0&&(r={}),{name:"size",options:r,async fn(e){var t,n;const{placement:s,rects:i,platform:c,elements:u}=e,{apply:p=()=>{},...m}=$l(r,e),g=await c.detectOverflow(e,m),x=Ul(s),b=mh(s),E=Ma(s)==="y",{width:T,height:S}=i.floating;let N,R;x==="top"||x==="bottom"?(N=x,R=b===(await(c.isRTL==null?void 0:c.isRTL(u.floating))?"start":"end")?"left":"right"):(R=x,N=b==="end"?"top":"bottom");const A=S-g.top-g.bottom,j=T-g.left-g.right,P=Vc(S-g[N],A),M=Vc(T-g[R],j),B=!e.middlewareData.shift;let U=P,V=M;if((t=e.middlewareData.shift)!=null&&t.enabled.x&&(V=j),(n=e.middlewareData.shift)!=null&&n.enabled.y&&(U=A),B&&!b){const ce=Bo(g.left,0),X=Bo(g.right,0),de=Bo(g.top,0),we=Bo(g.bottom,0);E?V=T-2*(ce!==0||X!==0?ce+X:Bo(g.left,g.right)):U=S-2*(de!==0||we!==0?de+we:Bo(g.top,g.bottom))}await p({...e,availableWidth:V,availableHeight:U});const Y=await c.getDimensions(u.floating);return T!==Y.width||S!==Y.height?{reset:{rects:!0}}:{}}}};function Jy(){return typeof window<"u"}function gh(r){return ZR(r)?(r.nodeName||"").toLowerCase():"#document"}function Wo(r){var e;return(r==null||(e=r.ownerDocument)==null?void 0:e.defaultView)||window}function Ha(r){var e;return(e=(ZR(r)?r.ownerDocument:r.document)||window.document)==null?void 0:e.documentElement}function ZR(r){return Jy()?r instanceof Node||r instanceof Wo(r).Node:!1}function Ki(r){return Jy()?r instanceof Element||r instanceof Wo(r).Element:!1}function Ua(r){return Jy()?r instanceof HTMLElement||r instanceof Wo(r).HTMLElement:!1}function Dk(r){return!Jy()||typeof ShadowRoot>"u"?!1:r instanceof ShadowRoot||r instanceof Wo(r).ShadowRoot}const qB=new Set(["inline","contents"]);function Jm(r){const{overflow:e,overflowX:t,overflowY:n,display:s}=Yi(r);return/auto|scroll|overlay|hidden|clip/.test(e+n+t)&&!qB.has(s)}const KB=new Set(["table","td","th"]);function YB(r){return KB.has(gh(r))}const JB=[":popover-open",":modal"];function Xy(r){return JB.some(e=>{try{return r.matches(e)}catch{return!1}})}const XB=["transform","translate","scale","rotate","perspective"],QB=["transform","translate","scale","rotate","perspective","filter"],ZB=["paint","layout","strict","content"];function hE(r){const e=pE(),t=Ki(r)?Yi(r):r;return XB.some(n=>t[n]?t[n]!=="none":!1)||(t.containerType?t.containerType!=="normal":!1)||!e&&(t.backdropFilter?t.backdropFilter!=="none":!1)||!e&&(t.filter?t.filter!=="none":!1)||QB.some(n=>(t.willChange||"").includes(n))||ZB.some(n=>(t.contain||"").includes(n))}function eG(r){let e=qc(r);for(;Ua(e)&&!lh(e);){if(hE(e))return e;if(Xy(e))return null;e=qc(e)}return null}function pE(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const tG=new Set(["html","body","#document"]);function lh(r){return tG.has(gh(r))}function Yi(r){return Wo(r).getComputedStyle(r)}function Qy(r){return Ki(r)?{scrollLeft:r.scrollLeft,scrollTop:r.scrollTop}:{scrollLeft:r.scrollX,scrollTop:r.scrollY}}function qc(r){if(gh(r)==="html")return r;const e=r.assignedSlot||r.parentNode||Dk(r)&&r.host||Ha(r);return Dk(e)?e.host:e}function eA(r){const e=qc(r);return lh(e)?r.ownerDocument?r.ownerDocument.body:r.body:Ua(e)&&Jm(e)?e:eA(e)}function Lm(r,e,t){var n;e===void 0&&(e=[]),t===void 0&&(t=!0);const s=eA(r),i=s===((n=r.ownerDocument)==null?void 0:n.body),c=Wo(s);if(i){const u=vb(c);return e.concat(c,c.visualViewport||[],Jm(s)?s:[],u&&t?Lm(u):[])}return e.concat(s,Lm(s,[],t))}function vb(r){return r.parent&&Object.getPrototypeOf(r.parent)?r.frameElement:null}function tA(r){const e=Yi(r);let t=parseFloat(e.width)||0,n=parseFloat(e.height)||0;const s=Ua(r),i=s?r.offsetWidth:t,c=s?r.offsetHeight:n,u=_y(t)!==i||_y(n)!==c;return u&&(t=i,n=c),{width:t,height:n,$:u}}function mE(r){return Ki(r)?r:r.contextElement}function eh(r){const e=mE(r);if(!Ua(e))return $a(1);const t=e.getBoundingClientRect(),{width:n,height:s,$:i}=tA(e);let c=(i?_y(t.width):t.width)/n,u=(i?_y(t.height):t.height)/s;return(!c||!Number.isFinite(c))&&(c=1),(!u||!Number.isFinite(u))&&(u=1),{x:c,y:u}}const rG=$a(0);function rA(r){const e=Wo(r);return!pE()||!e.visualViewport?rG:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function nG(r,e,t){return e===void 0&&(e=!1),!t||e&&t!==Wo(r)?!1:e}function nd(r,e,t,n){e===void 0&&(e=!1),t===void 0&&(t=!1);const s=r.getBoundingClientRect(),i=mE(r);let c=$a(1);e&&(n?Ki(n)&&(c=eh(n)):c=eh(r));const u=nG(i,t,n)?rA(i):$a(0);let p=(s.left+u.x)/c.x,m=(s.top+u.y)/c.y,g=s.width/c.x,x=s.height/c.y;if(i){const b=Wo(i),E=n&&Ki(n)?Wo(n):n;let T=b,S=vb(T);for(;S&&n&&E!==T;){const N=eh(S),R=S.getBoundingClientRect(),A=Yi(S),j=R.left+(S.clientLeft+parseFloat(A.paddingLeft))*N.x,P=R.top+(S.clientTop+parseFloat(A.paddingTop))*N.y;p*=N.x,m*=N.y,g*=N.x,x*=N.y,p+=j,m+=P,T=Wo(S),S=vb(T)}}return Sy({width:g,height:x,x:p,y:m})}function Zy(r,e){const t=Qy(r).scrollLeft;return e?e.left+t:nd(Ha(r)).left+t}function nA(r,e){const t=r.getBoundingClientRect(),n=t.left+e.scrollLeft-Zy(r,t),s=t.top+e.scrollTop;return{x:n,y:s}}function sG(r){let{elements:e,rect:t,offsetParent:n,strategy:s}=r;const i=s==="fixed",c=Ha(n),u=e?Xy(e.floating):!1;if(n===c||u&&i)return t;let p={scrollLeft:0,scrollTop:0},m=$a(1);const g=$a(0),x=Ua(n);if((x||!x&&!i)&&((gh(n)!=="body"||Jm(c))&&(p=Qy(n)),Ua(n))){const E=nd(n);m=eh(n),g.x=E.x+n.clientLeft,g.y=E.y+n.clientTop}const b=c&&!x&&!i?nA(c,p):$a(0);return{width:t.width*m.x,height:t.height*m.y,x:t.x*m.x-p.scrollLeft*m.x+g.x+b.x,y:t.y*m.y-p.scrollTop*m.y+g.y+b.y}}function oG(r){return Array.from(r.getClientRects())}function iG(r){const e=Ha(r),t=Qy(r),n=r.ownerDocument.body,s=Bo(e.scrollWidth,e.clientWidth,n.scrollWidth,n.clientWidth),i=Bo(e.scrollHeight,e.clientHeight,n.scrollHeight,n.clientHeight);let c=-t.scrollLeft+Zy(r);const u=-t.scrollTop;return Yi(n).direction==="rtl"&&(c+=Bo(e.clientWidth,n.clientWidth)-s),{width:s,height:i,x:c,y:u}}const Lk=25;function aG(r,e){const t=Wo(r),n=Ha(r),s=t.visualViewport;let i=n.clientWidth,c=n.clientHeight,u=0,p=0;if(s){i=s.width,c=s.height;const g=pE();(!g||g&&e==="fixed")&&(u=s.offsetLeft,p=s.offsetTop)}const m=Zy(n);if(m<=0){const g=n.ownerDocument,x=g.body,b=getComputedStyle(x),E=g.compatMode==="CSS1Compat"&&parseFloat(b.marginLeft)+parseFloat(b.marginRight)||0,T=Math.abs(n.clientWidth-x.clientWidth-E);T<=Lk&&(i-=T)}else m<=Lk&&(i+=m);return{width:i,height:c,x:u,y:p}}const lG=new Set(["absolute","fixed"]);function cG(r,e){const t=nd(r,!0,e==="fixed"),n=t.top+r.clientTop,s=t.left+r.clientLeft,i=Ua(r)?eh(r):$a(1),c=r.clientWidth*i.x,u=r.clientHeight*i.y,p=s*i.x,m=n*i.y;return{width:c,height:u,x:p,y:m}}function Mk(r,e,t){let n;if(e==="viewport")n=aG(r,t);else if(e==="document")n=iG(Ha(r));else if(Ki(e))n=cG(e,t);else{const s=rA(r);n={x:e.x-s.x,y:e.y-s.y,width:e.width,height:e.height}}return Sy(n)}function sA(r,e){const t=qc(r);return t===e||!Ki(t)||lh(t)?!1:Yi(t).position==="fixed"||sA(t,e)}function uG(r,e){const t=e.get(r);if(t)return t;let n=Lm(r,[],!1).filter(u=>Ki(u)&&gh(u)!=="body"),s=null;const i=Yi(r).position==="fixed";let c=i?qc(r):r;for(;Ki(c)&&!lh(c);){const u=Yi(c),p=hE(c);!p&&u.position==="fixed"&&(s=null),(i?!p&&!s:!p&&u.position==="static"&&!!s&&lG.has(s.position)||Jm(c)&&!p&&sA(r,c))?n=n.filter(g=>g!==c):s=u,c=qc(c)}return e.set(r,n),n}function dG(r){let{element:e,boundary:t,rootBoundary:n,strategy:s}=r;const c=[...t==="clippingAncestors"?Xy(e)?[]:uG(e,this._c):[].concat(t),n],u=c[0],p=c.reduce((m,g)=>{const x=Mk(e,g,s);return m.top=Bo(x.top,m.top),m.right=Vc(x.right,m.right),m.bottom=Vc(x.bottom,m.bottom),m.left=Bo(x.left,m.left),m},Mk(e,u,s));return{width:p.right-p.left,height:p.bottom-p.top,x:p.left,y:p.top}}function fG(r){const{width:e,height:t}=tA(r);return{width:e,height:t}}function hG(r,e,t){const n=Ua(e),s=Ha(e),i=t==="fixed",c=nd(r,!0,i,e);let u={scrollLeft:0,scrollTop:0};const p=$a(0);function m(){p.x=Zy(s)}if(n||!n&&!i)if((gh(e)!=="body"||Jm(s))&&(u=Qy(e)),n){const E=nd(e,!0,i,e);p.x=E.x+e.clientLeft,p.y=E.y+e.clientTop}else s&&m();i&&!n&&s&&m();const g=s&&!n&&!i?nA(s,u):$a(0),x=c.left+u.scrollLeft-p.x-g.x,b=c.top+u.scrollTop-p.y-g.y;return{x,y:b,width:c.width,height:c.height}}function tw(r){return Yi(r).position==="static"}function $k(r,e){if(!Ua(r)||Yi(r).position==="fixed")return null;if(e)return e(r);let t=r.offsetParent;return Ha(r)===t&&(t=t.ownerDocument.body),t}function oA(r,e){const t=Wo(r);if(Xy(r))return t;if(!Ua(r)){let s=qc(r);for(;s&&!lh(s);){if(Ki(s)&&!tw(s))return s;s=qc(s)}return t}let n=$k(r,e);for(;n&&YB(n)&&tw(n);)n=$k(n,e);return n&&lh(n)&&tw(n)&&!hE(n)?t:n||eG(r)||t}const pG=async function(r){const e=this.getOffsetParent||oA,t=this.getDimensions,n=await t(r.floating);return{reference:hG(r.reference,await e(r.floating),r.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function mG(r){return Yi(r).direction==="rtl"}const gG={convertOffsetParentRelativeRectToViewportRelativeRect:sG,getDocumentElement:Ha,getClippingRect:dG,getOffsetParent:oA,getElementRects:pG,getClientRects:oG,getDimensions:fG,getScale:eh,isElement:Ki,isRTL:mG};function iA(r,e){return r.x===e.x&&r.y===e.y&&r.width===e.width&&r.height===e.height}function vG(r,e){let t=null,n;const s=Ha(r);function i(){var u;clearTimeout(n),(u=t)==null||u.disconnect(),t=null}function c(u,p){u===void 0&&(u=!1),p===void 0&&(p=1),i();const m=r.getBoundingClientRect(),{left:g,top:x,width:b,height:E}=m;if(u||e(),!b||!E)return;const T=kv(x),S=kv(s.clientWidth-(g+b)),N=kv(s.clientHeight-(x+E)),R=kv(g),j={rootMargin:-T+"px "+-S+"px "+-N+"px "+-R+"px",threshold:Bo(0,Vc(1,p))||1};let P=!0;function M(B){const U=B[0].intersectionRatio;if(U!==p){if(!P)return c();U?c(!1,U):n=setTimeout(()=>{c(!1,1e-7)},1e3)}U===1&&!iA(m,r.getBoundingClientRect())&&c(),P=!1}try{t=new IntersectionObserver(M,{...j,root:s.ownerDocument})}catch{t=new IntersectionObserver(M,j)}t.observe(r)}return c(!0),i}function yG(r,e,t,n){n===void 0&&(n={});const{ancestorScroll:s=!0,ancestorResize:i=!0,elementResize:c=typeof ResizeObserver=="function",layoutShift:u=typeof IntersectionObserver=="function",animationFrame:p=!1}=n,m=mE(r),g=s||i?[...m?Lm(m):[],...Lm(e)]:[];g.forEach(R=>{s&&R.addEventListener("scroll",t,{passive:!0}),i&&R.addEventListener("resize",t)});const x=m&&u?vG(m,t):null;let b=-1,E=null;c&&(E=new ResizeObserver(R=>{let[A]=R;A&&A.target===m&&E&&(E.unobserve(e),cancelAnimationFrame(b),b=requestAnimationFrame(()=>{var j;(j=E)==null||j.observe(e)})),t()}),m&&!p&&E.observe(m),E.observe(e));let T,S=p?nd(r):null;p&&N();function N(){const R=nd(r);S&&!iA(S,R)&&t(),S=R,T=requestAnimationFrame(N)}return t(),()=>{var R;g.forEach(A=>{s&&A.removeEventListener("scroll",t),i&&A.removeEventListener("resize",t)}),x==null||x(),(R=E)==null||R.disconnect(),E=null,p&&cancelAnimationFrame(T)}}const xG=BB,wG=GB,bG=UB,_G=VB,EG=zB,Uk=$B,SG=WB,CG=(r,e,t)=>{const n=new Map,s={platform:gG,...t},i={...s.platform,_c:n};return MB(r,e,{...s,platform:i})};var gE=x1();const kG=Tb(gE);var NG=typeof document<"u",TG=function(){},qv=NG?w.useLayoutEffect:TG;function Cy(r,e){if(r===e)return!0;if(typeof r!=typeof e)return!1;if(typeof r=="function"&&r.toString()===e.toString())return!0;let t,n,s;if(r&&e&&typeof r=="object"){if(Array.isArray(r)){if(t=r.length,t!==e.length)return!1;for(n=t;n--!==0;)if(!Cy(r[n],e[n]))return!1;return!0}if(s=Object.keys(r),t=s.length,t!==Object.keys(e).length)return!1;for(n=t;n--!==0;)if(!{}.hasOwnProperty.call(e,s[n]))return!1;for(n=t;n--!==0;){const i=s[n];if(!(i==="_owner"&&r.$$typeof)&&!Cy(r[i],e[i]))return!1}return!0}return r!==r&&e!==e}function aA(r){return typeof window>"u"?1:(r.ownerDocument.defaultView||window).devicePixelRatio||1}function zk(r,e){const t=aA(r);return Math.round(e*t)/t}function rw(r){const e=w.useRef(r);return qv(()=>{e.current=r}),e}function RG(r){r===void 0&&(r={});const{placement:e="bottom",strategy:t="absolute",middleware:n=[],platform:s,elements:{reference:i,floating:c}={},transform:u=!0,whileElementsMounted:p,open:m}=r,[g,x]=w.useState({x:0,y:0,strategy:t,placement:e,middlewareData:{},isPositioned:!1}),[b,E]=w.useState(n);Cy(b,n)||E(n);const[T,S]=w.useState(null),[N,R]=w.useState(null),A=w.useCallback(G=>{G!==B.current&&(B.current=G,S(G))},[]),j=w.useCallback(G=>{G!==U.current&&(U.current=G,R(G))},[]),P=i||T,M=c||N,B=w.useRef(null),U=w.useRef(null),V=w.useRef(g),Y=p!=null,ce=rw(p),X=rw(s),de=rw(m),we=w.useCallback(()=>{if(!B.current||!U.current)return;const G={placement:e,strategy:t,middleware:b};X.current&&(G.platform=X.current),CG(B.current,U.current,G).then(z=>{const J={...z,isPositioned:de.current!==!1};le.current&&!Cy(V.current,J)&&(V.current=J,gE.flushSync(()=>{x(J)}))})},[b,e,t,X,de]);qv(()=>{m===!1&&V.current.isPositioned&&(V.current.isPositioned=!1,x(G=>({...G,isPositioned:!1})))},[m]);const le=w.useRef(!1);qv(()=>(le.current=!0,()=>{le.current=!1}),[]),qv(()=>{if(P&&(B.current=P),M&&(U.current=M),P&&M){if(ce.current)return ce.current(P,M,we);we()}},[P,M,we,ce,Y]);const se=w.useMemo(()=>({reference:B,floating:U,setReference:A,setFloating:j}),[A,j]),me=w.useMemo(()=>({reference:P,floating:M}),[P,M]),te=w.useMemo(()=>{const G={position:t,left:0,top:0};if(!me.floating)return G;const z=zk(me.floating,g.x),J=zk(me.floating,g.y);return u?{...G,transform:"translate("+z+"px, "+J+"px)",...aA(me.floating)>=1.5&&{willChange:"transform"}}:{position:t,left:z,top:J}},[t,u,me.floating,g.x,g.y]);return w.useMemo(()=>({...g,update:we,refs:se,elements:me,floatingStyles:te}),[g,we,se,me,te])}const AG=r=>{function e(t){return{}.hasOwnProperty.call(t,"current")}return{name:"arrow",options:r,fn(t){const{element:n,padding:s}=typeof r=="function"?r(t):r;return n&&e(n)?n.current!=null?Uk({element:n.current,padding:s}).fn(t):{}:n?Uk({element:n,padding:s}).fn(t):{}}}},IG=(r,e)=>({...xG(r),options:[r,e]}),PG=(r,e)=>({...wG(r),options:[r,e]}),FG=(r,e)=>({...SG(r),options:[r,e]}),jG=(r,e)=>({...bG(r),options:[r,e]}),OG=(r,e)=>({..._G(r),options:[r,e]}),DG=(r,e)=>({...EG(r),options:[r,e]}),LG=(r,e)=>({...AG(r),options:[r,e]});function MG(r){const e=$G(r),t=w.forwardRef((n,s)=>{const{children:i,...c}=n,u=w.Children.toArray(i),p=u.find(zG);if(p){const m=p.props.children,g=u.map(x=>x===p?w.Children.count(m)>1?w.Children.only(null):w.isValidElement(m)?m.props.children:null:x);return d.jsx(e,{...c,ref:s,children:w.isValidElement(m)?w.cloneElement(m,void 0,g):null})}return d.jsx(e,{...c,ref:s,children:i})});return t.displayName=`${r}.Slot`,t}function $G(r){const e=w.forwardRef((t,n)=>{const{children:s,...i}=t;if(w.isValidElement(s)){const c=BG(s),u=HG(i,s.props);return s.type!==w.Fragment&&(u.ref=n?Yc(n,c):c),w.cloneElement(s,u)}return w.Children.count(s)>1?w.Children.only(null):null});return e.displayName=`${r}.SlotClone`,e}var UG=Symbol("radix.slottable");function zG(r){return w.isValidElement(r)&&typeof r.type=="function"&&"__radixId"in r.type&&r.type.__radixId===UG}function HG(r,e){const t={...e};for(const n in e){const s=r[n],i=e[n];/^on[A-Z]/.test(n)?s&&i?t[n]=(...u)=>{const p=i(...u);return s(...u),p}:s&&(t[n]=s):n==="style"?t[n]={...s,...i}:n==="className"&&(t[n]=[s,i].filter(Boolean).join(" "))}return{...r,...t}}function BG(r){var n,s;let e=(n=Object.getOwnPropertyDescriptor(r.props,"ref"))==null?void 0:n.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=(s=Object.getOwnPropertyDescriptor(r,"ref"))==null?void 0:s.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}var GG=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],jr=GG.reduce((r,e)=>{const t=MG(`Primitive.${e}`),n=w.forwardRef((s,i)=>{const{asChild:c,...u}=s,p=c?t:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),d.jsx(p,{...u,ref:i})});return n.displayName=`Primitive.${e}`,{...r,[e]:n}},{});function lA(r,e){r&&gE.flushSync(()=>r.dispatchEvent(e))}var WG="Arrow",cA=w.forwardRef((r,e)=>{const{children:t,width:n=10,height:s=5,...i}=r;return d.jsx(jr.svg,{...i,ref:e,width:n,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:r.asChild?t:d.jsx("polygon",{points:"0,0 30,0 15,10"})})});cA.displayName=WG;var VG=cA;function zl(r){const e=w.useRef(r);return w.useEffect(()=>{e.current=r}),w.useMemo(()=>(...t)=>{var n;return(n=e.current)==null?void 0:n.call(e,...t)},[])}function qG(r){const[e,t]=w.useState(void 0);return Ml(()=>{if(r){t({width:r.offsetWidth,height:r.offsetHeight});const n=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const i=s[0];let c,u;if("borderBoxSize"in i){const p=i.borderBoxSize,m=Array.isArray(p)?p[0]:p;c=m.inlineSize,u=m.blockSize}else c=r.offsetWidth,u=r.offsetHeight;t({width:c,height:u})});return n.observe(r,{box:"border-box"}),()=>n.unobserve(r)}else t(void 0)},[r]),e}var vE="Popper",[uA,e0]=za(vE),[KG,dA]=uA(vE),fA=r=>{const{__scopePopper:e,children:t}=r,[n,s]=w.useState(null);return d.jsx(KG,{scope:e,anchor:n,onAnchorChange:s,children:t})};fA.displayName=vE;var hA="PopperAnchor",pA=w.forwardRef((r,e)=>{const{__scopePopper:t,virtualRef:n,...s}=r,i=dA(hA,t),c=w.useRef(null),u=Mn(e,c),p=w.useRef(null);return w.useEffect(()=>{const m=p.current;p.current=(n==null?void 0:n.current)||c.current,m!==p.current&&i.onAnchorChange(p.current)}),n?null:d.jsx(jr.div,{...s,ref:u})});pA.displayName=hA;var yE="PopperContent",[YG,JG]=uA(yE),mA=w.forwardRef((r,e)=>{var xe,ye,ue,ke,He,Ue;const{__scopePopper:t,side:n="bottom",sideOffset:s=0,align:i="center",alignOffset:c=0,arrowPadding:u=0,avoidCollisions:p=!0,collisionBoundary:m=[],collisionPadding:g=0,sticky:x="partial",hideWhenDetached:b=!1,updatePositionStrategy:E="optimized",onPlaced:T,...S}=r,N=dA(yE,t),[R,A]=w.useState(null),j=Mn(e,Le=>A(Le)),[P,M]=w.useState(null),B=qG(P),U=(B==null?void 0:B.width)??0,V=(B==null?void 0:B.height)??0,Y=n+(i!=="center"?"-"+i:""),ce=typeof g=="number"?g:{top:0,right:0,bottom:0,left:0,...g},X=Array.isArray(m)?m:[m],de=X.length>0,we={padding:ce,boundary:X.filter(QG),altBoundary:de},{refs:le,floatingStyles:se,placement:me,isPositioned:te,middlewareData:G}=RG({strategy:"fixed",placement:Y,whileElementsMounted:(...Le)=>yG(...Le,{animationFrame:E==="always"}),elements:{reference:N.anchor},middleware:[IG({mainAxis:s+V,alignmentAxis:c}),p&&PG({mainAxis:!0,crossAxis:!1,limiter:x==="partial"?FG():void 0,...we}),p&&jG({...we}),OG({...we,apply:({elements:Le,rects:Ne,availableWidth:gt,availableHeight:zt})=>{const{width:yt,height:Zt}=Ne.reference,Bt=Le.floating.style;Bt.setProperty("--radix-popper-available-width",`${gt}px`),Bt.setProperty("--radix-popper-available-height",`${zt}px`),Bt.setProperty("--radix-popper-anchor-width",`${yt}px`),Bt.setProperty("--radix-popper-anchor-height",`${Zt}px`)}}),P&&LG({element:P,padding:u}),ZG({arrowWidth:U,arrowHeight:V}),b&&DG({strategy:"referenceHidden",...we})]}),[z,J]=yA(me),D=zl(T);Ml(()=>{te&&(D==null||D())},[te,D]);const $=(xe=G.arrow)==null?void 0:xe.x,ne=(ye=G.arrow)==null?void 0:ye.y,_e=((ue=G.arrow)==null?void 0:ue.centerOffset)!==0,[q,ie]=w.useState();return Ml(()=>{R&&ie(window.getComputedStyle(R).zIndex)},[R]),d.jsx("div",{ref:le.setFloating,"data-radix-popper-content-wrapper":"",style:{...se,transform:te?se.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:q,"--radix-popper-transform-origin":[(ke=G.transformOrigin)==null?void 0:ke.x,(He=G.transformOrigin)==null?void 0:He.y].join(" "),...((Ue=G.hide)==null?void 0:Ue.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:r.dir,children:d.jsx(YG,{scope:t,placedSide:z,onArrowChange:M,arrowX:$,arrowY:ne,shouldHideArrow:_e,children:d.jsx(jr.div,{"data-side":z,"data-align":J,...S,ref:j,style:{...S.style,animation:te?void 0:"none"}})})})});mA.displayName=yE;var gA="PopperArrow",XG={top:"bottom",right:"left",bottom:"top",left:"right"},vA=w.forwardRef(function(e,t){const{__scopePopper:n,...s}=e,i=JG(gA,n),c=XG[i.placedSide];return d.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[c]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:d.jsx(VG,{...s,ref:t,style:{...s.style,display:"block"}})})});vA.displayName=gA;function QG(r){return r!==null}var ZG=r=>({name:"transformOrigin",options:r,fn(e){var N,R,A;const{placement:t,rects:n,middlewareData:s}=e,c=((N=s.arrow)==null?void 0:N.centerOffset)!==0,u=c?0:r.arrowWidth,p=c?0:r.arrowHeight,[m,g]=yA(t),x={start:"0%",center:"50%",end:"100%"}[g],b=(((R=s.arrow)==null?void 0:R.x)??0)+u/2,E=(((A=s.arrow)==null?void 0:A.y)??0)+p/2;let T="",S="";return m==="bottom"?(T=c?x:`${b}px`,S=`${-p}px`):m==="top"?(T=c?x:`${b}px`,S=`${n.floating.height+p}px`):m==="right"?(T=`${-p}px`,S=c?x:`${E}px`):m==="left"&&(T=`${n.floating.width+p}px`,S=c?x:`${E}px`),{data:{x:T,y:S}}}});function yA(r){const[e,t="center"]=r.split("-");return[e,t]}var xA=fA,wA=pA,bA=mA,_A=vA,e7="Portal",xE=w.forwardRef((r,e)=>{var u;const{container:t,...n}=r,[s,i]=w.useState(!1);Ml(()=>i(!0),[]);const c=t||s&&((u=globalThis==null?void 0:globalThis.document)==null?void 0:u.body);return c?kG.createPortal(d.jsx(jr.div,{...n,ref:e}),c):null});xE.displayName=e7;function t7(r,e){return w.useReducer((t,n)=>e[t][n]??t,r)}var Qi=r=>{const{present:e,children:t}=r,n=r7(e),s=typeof t=="function"?t({present:n.isPresent}):w.Children.only(t),i=Mn(n.ref,n7(s));return typeof t=="function"||n.isPresent?w.cloneElement(s,{ref:i}):null};Qi.displayName="Presence";function r7(r){const[e,t]=w.useState(),n=w.useRef(null),s=w.useRef(r),i=w.useRef("none"),c=r?"mounted":"unmounted",[u,p]=t7(c,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return w.useEffect(()=>{const m=Nv(n.current);i.current=u==="mounted"?m:"none"},[u]),Ml(()=>{const m=n.current,g=s.current;if(g!==r){const b=i.current,E=Nv(m);r?p("MOUNT"):E==="none"||(m==null?void 0:m.display)==="none"?p("UNMOUNT"):p(g&&b!==E?"ANIMATION_OUT":"UNMOUNT"),s.current=r}},[r,p]),Ml(()=>{if(e){let m;const g=e.ownerDocument.defaultView??window,x=E=>{const S=Nv(n.current).includes(CSS.escape(E.animationName));if(E.target===e&&S&&(p("ANIMATION_END"),!s.current)){const N=e.style.animationFillMode;e.style.animationFillMode="forwards",m=g.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=N)})}},b=E=>{E.target===e&&(i.current=Nv(n.current))};return e.addEventListener("animationstart",b),e.addEventListener("animationcancel",x),e.addEventListener("animationend",x),()=>{g.clearTimeout(m),e.removeEventListener("animationstart",b),e.removeEventListener("animationcancel",x),e.removeEventListener("animationend",x)}}else p("ANIMATION_END")},[e,p]),{isPresent:["mounted","unmountSuspended"].includes(u),ref:w.useCallback(m=>{n.current=m?getComputedStyle(m):null,t(m)},[])}}function Nv(r){return(r==null?void 0:r.animationName)||"none"}function n7(r){var n,s;let e=(n=Object.getOwnPropertyDescriptor(r.props,"ref"))==null?void 0:n.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=(s=Object.getOwnPropertyDescriptor(r,"ref"))==null?void 0:s.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}function s7(r,e=globalThis==null?void 0:globalThis.document){const t=zl(r);w.useEffect(()=>{const n=s=>{s.key==="Escape"&&t(s)};return e.addEventListener("keydown",n,{capture:!0}),()=>e.removeEventListener("keydown",n,{capture:!0})},[t,e])}var o7="DismissableLayer",yb="dismissableLayer.update",i7="dismissableLayer.pointerDownOutside",a7="dismissableLayer.focusOutside",Hk,EA=w.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),t0=w.forwardRef((r,e)=>{const{disableOutsidePointerEvents:t=!1,onEscapeKeyDown:n,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:c,onDismiss:u,...p}=r,m=w.useContext(EA),[g,x]=w.useState(null),b=(g==null?void 0:g.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,E]=w.useState({}),T=Mn(e,U=>x(U)),S=Array.from(m.layers),[N]=[...m.layersWithOutsidePointerEventsDisabled].slice(-1),R=S.indexOf(N),A=g?S.indexOf(g):-1,j=m.layersWithOutsidePointerEventsDisabled.size>0,P=A>=R,M=u7(U=>{const V=U.target,Y=[...m.branches].some(ce=>ce.contains(V));!P||Y||(s==null||s(U),c==null||c(U),U.defaultPrevented||u==null||u())},b),B=d7(U=>{const V=U.target;[...m.branches].some(ce=>ce.contains(V))||(i==null||i(U),c==null||c(U),U.defaultPrevented||u==null||u())},b);return s7(U=>{A===m.layers.size-1&&(n==null||n(U),!U.defaultPrevented&&u&&(U.preventDefault(),u()))},b),w.useEffect(()=>{if(g)return t&&(m.layersWithOutsidePointerEventsDisabled.size===0&&(Hk=b.body.style.pointerEvents,b.body.style.pointerEvents="none"),m.layersWithOutsidePointerEventsDisabled.add(g)),m.layers.add(g),Bk(),()=>{t&&m.layersWithOutsidePointerEventsDisabled.size===1&&(b.body.style.pointerEvents=Hk)}},[g,b,t,m]),w.useEffect(()=>()=>{g&&(m.layers.delete(g),m.layersWithOutsidePointerEventsDisabled.delete(g),Bk())},[g,m]),w.useEffect(()=>{const U=()=>E({});return document.addEventListener(yb,U),()=>document.removeEventListener(yb,U)},[]),d.jsx(jr.div,{...p,ref:T,style:{pointerEvents:j?P?"auto":"none":void 0,...r.style},onFocusCapture:Pt(r.onFocusCapture,B.onFocusCapture),onBlurCapture:Pt(r.onBlurCapture,B.onBlurCapture),onPointerDownCapture:Pt(r.onPointerDownCapture,M.onPointerDownCapture)})});t0.displayName=o7;var l7="DismissableLayerBranch",c7=w.forwardRef((r,e)=>{const t=w.useContext(EA),n=w.useRef(null),s=Mn(e,n);return w.useEffect(()=>{const i=n.current;if(i)return t.branches.add(i),()=>{t.branches.delete(i)}},[t.branches]),d.jsx(jr.div,{...r,ref:s})});c7.displayName=l7;function u7(r,e=globalThis==null?void 0:globalThis.document){const t=zl(r),n=w.useRef(!1),s=w.useRef(()=>{});return w.useEffect(()=>{const i=u=>{if(u.target&&!n.current){let p=function(){SA(i7,t,m,{discrete:!0})};const m={originalEvent:u};u.pointerType==="touch"?(e.removeEventListener("click",s.current),s.current=p,e.addEventListener("click",s.current,{once:!0})):p()}else e.removeEventListener("click",s.current);n.current=!1},c=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(c),e.removeEventListener("pointerdown",i),e.removeEventListener("click",s.current)}},[e,t]),{onPointerDownCapture:()=>n.current=!0}}function d7(r,e=globalThis==null?void 0:globalThis.document){const t=zl(r),n=w.useRef(!1);return w.useEffect(()=>{const s=i=>{i.target&&!n.current&&SA(a7,t,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",s),()=>e.removeEventListener("focusin",s)},[e,t]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function Bk(){const r=new CustomEvent(yb);document.dispatchEvent(r)}function SA(r,e,t,{discrete:n}){const s=t.originalEvent.target,i=new CustomEvent(r,{bubbles:!1,cancelable:!0,detail:t});e&&s.addEventListener(r,e,{once:!0}),n?lA(s,i):s.dispatchEvent(i)}var nw,r0="HoverCard",[CA]=za(r0,[e0]),n0=e0(),[f7,wE]=CA(r0),kA=r=>{const{__scopeHoverCard:e,children:t,open:n,defaultOpen:s,onOpenChange:i,openDelay:c=700,closeDelay:u=300}=r,p=n0(e),m=w.useRef(0),g=w.useRef(0),x=w.useRef(!1),b=w.useRef(!1),[E,T]=Jc({prop:n,defaultProp:s??!1,onChange:i,caller:r0}),S=w.useCallback(()=>{clearTimeout(g.current),m.current=window.setTimeout(()=>T(!0),c)},[c,T]),N=w.useCallback(()=>{clearTimeout(m.current),!x.current&&!b.current&&(g.current=window.setTimeout(()=>T(!1),u))},[u,T]),R=w.useCallback(()=>T(!1),[T]);return w.useEffect(()=>()=>{clearTimeout(m.current),clearTimeout(g.current)},[]),d.jsx(f7,{scope:e,open:E,onOpenChange:T,onOpen:S,onClose:N,onDismiss:R,hasSelectionRef:x,isPointerDownOnContentRef:b,children:d.jsx(xA,{...p,children:t})})};kA.displayName=r0;var NA="HoverCardTrigger",TA=w.forwardRef((r,e)=>{const{__scopeHoverCard:t,...n}=r,s=wE(NA,t),i=n0(t);return d.jsx(wA,{asChild:!0,...i,children:d.jsx(jr.a,{"data-state":s.open?"open":"closed",...n,ref:e,onPointerEnter:Pt(r.onPointerEnter,Ny(s.onOpen)),onPointerLeave:Pt(r.onPointerLeave,Ny(s.onClose)),onFocus:Pt(r.onFocus,s.onOpen),onBlur:Pt(r.onBlur,s.onClose),onTouchStart:Pt(r.onTouchStart,c=>c.preventDefault())})})});TA.displayName=NA;var h7="HoverCardPortal",[FK,p7]=CA(h7,{forceMount:void 0}),ky="HoverCardContent",RA=w.forwardRef((r,e)=>{const t=p7(ky,r.__scopeHoverCard),{forceMount:n=t.forceMount,...s}=r,i=wE(ky,r.__scopeHoverCard);return d.jsx(Qi,{present:n||i.open,children:d.jsx(m7,{"data-state":i.open?"open":"closed",...s,onPointerEnter:Pt(r.onPointerEnter,Ny(i.onOpen)),onPointerLeave:Pt(r.onPointerLeave,Ny(i.onClose)),ref:e})})});RA.displayName=ky;var m7=w.forwardRef((r,e)=>{const{__scopeHoverCard:t,onEscapeKeyDown:n,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:c,...u}=r,p=wE(ky,t),m=n0(t),g=w.useRef(null),x=Mn(e,g),[b,E]=w.useState(!1);return w.useEffect(()=>{if(b){const T=document.body;return nw=T.style.userSelect||T.style.webkitUserSelect,T.style.userSelect="none",T.style.webkitUserSelect="none",()=>{T.style.userSelect=nw,T.style.webkitUserSelect=nw}}},[b]),w.useEffect(()=>{if(g.current){const T=()=>{E(!1),p.isPointerDownOnContentRef.current=!1,setTimeout(()=>{var N;((N=document.getSelection())==null?void 0:N.toString())!==""&&(p.hasSelectionRef.current=!0)})};return document.addEventListener("pointerup",T),()=>{document.removeEventListener("pointerup",T),p.hasSelectionRef.current=!1,p.isPointerDownOnContentRef.current=!1}}},[p.isPointerDownOnContentRef,p.hasSelectionRef]),w.useEffect(()=>{g.current&&v7(g.current).forEach(S=>S.setAttribute("tabindex","-1"))}),d.jsx(t0,{asChild:!0,disableOutsidePointerEvents:!1,onInteractOutside:c,onEscapeKeyDown:n,onPointerDownOutside:s,onFocusOutside:Pt(i,T=>{T.preventDefault()}),onDismiss:p.onDismiss,children:d.jsx(bA,{...m,...u,onPointerDown:Pt(u.onPointerDown,T=>{T.currentTarget.contains(T.target)&&E(!0),p.hasSelectionRef.current=!1,p.isPointerDownOnContentRef.current=!0}),ref:x,style:{...u.style,userSelect:b?"text":void 0,WebkitUserSelect:b?"text":void 0,"--radix-hover-card-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-hover-card-content-available-width":"var(--radix-popper-available-width)","--radix-hover-card-content-available-height":"var(--radix-popper-available-height)","--radix-hover-card-trigger-width":"var(--radix-popper-anchor-width)","--radix-hover-card-trigger-height":"var(--radix-popper-anchor-height)"}})})}),g7="HoverCardArrow",AA=w.forwardRef((r,e)=>{const{__scopeHoverCard:t,...n}=r,s=n0(t);return d.jsx(_A,{...s,...n,ref:e})});AA.displayName=g7;function Ny(r){return e=>e.pointerType==="touch"?void 0:r()}function v7(r){const e=[],t=document.createTreeWalker(r,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP});for(;t.nextNode();)e.push(t.currentNode);return e}var y7=kA,x7=TA,w7=RA,b7=AA;const xb="src/lib/utils/emailUtils.tsx";async function IA(r,e){try{await(await Kn.createServices()).contentScript.insertContentIntoComposeBox(r)}catch(t){e.error("Error inserting content into compose box",t,{sourceFile:xb,functionName:"insertHtmlIntoComposeBox"}),_7(r,e)}}function _7(r,e){const t=r.replace(/<([^>]+)class="ql-align-([^"]+)"([^>]*)>/g,'<$1style="text-align: $2"$3>');chrome.tabs.query({active:!0,currentWindow:!0},n=>{const s=n[0];if(!(s!=null&&s.id)){e.error("No active tab found or tab ID is undefined",void 0,{sourceFile:xb,functionName:"insertHtmlIntoComposeBoxLegacy"});return}chrome.scripting.executeScript({target:{tabId:s.id},func:i=>{console.debug("Script executing in tab context");function c(){return document.querySelector('div[role="textbox"][aria-label="Message Body"]')||document.querySelector('div[aria-label="Message body, press Alt+F10 to exit"]')}function u(m,g){document.execCommand("insertHTML",!1,g),console.debug("Inserted using execCommand fallback")}const p=c();if(p)console.debug("found composeBox: ",p);else{console.error("Compose box not found");return}try{p.focus(),navigator.clipboard&&navigator.clipboard.writeText?navigator.clipboard.writeText(i).then(()=>{document.execCommand("paste"),console.debug("Pasted using Clipboard API")}).catch(m=>{console.warn("Clipboard API failed, using fallback:",m),u(p,i)}):u(p,i)}catch(m){console.error("Error during paste operation:",m)}},args:[t]}).catch(i=>{e.error("Error executing script",i,{sourceFile:xb,functionName:"insertHtmlIntoComposeBoxLegacy"})})})}const E7="src/lib/types/Template.ts",Gk=async(r,e)=>{const t="GetTemplateWithContentFromServerTemplate";try{const n=r.source;if(!n)throw new Error("Source value is undefined");const s={...r,source:n};return{id:s.template_id,timeStamp:Date.now(),title:s.templateName,description:s.templateDescription,tags:s.tags||[],source:s.source==="SCOPE_USER"?"personal":"org",content:s.templateBody}}catch(n){throw e.error("Error getting template content",n,{sourceFile:E7,functionName:t,templateId:r.template_id}),n}},Tl="src/lib/utils/templateUtils.tsx",Wk=async(r,e=!0)=>{const t="getAllTemplatesWithContent";try{const n=await X6(r);r.debug("Templates from server",{sourceFile:Tl,functionName:t,userCount:n.user_templates.length,orgCount:n.org_templates.length});const s=async g=>{const x="fetchPersonalTemplateWithErrorHandling";try{const b={...g,source:g.source||"SCOPE_USER"};return r.debug("Fetching personal template",{sourceFile:Tl,functionName:x,templateId:b.template_id,scope:b.source}),await Gk(b,r)}catch(b){return r.error("Failed to load personal template",b,{sourceFile:Tl,functionName:x,templateId:g.template_id}),null}},i=async g=>{const x="fetchOrgTemplateWithErrorHandling";try{const b={...g,source:g.source||"SCOPE_TENANT"};return r.debug("Fetching org template",{sourceFile:Tl,functionName:x,templateId:b.template_id,scope:b.source}),await Gk(b,r)}catch(b){return r.error("Failed to load org template",b,{sourceFile:Tl,functionName:x,templateId:g.template_id}),null}};let c=[];e&&(c=await Promise.all(n.user_templates.map(s)));const u=c.filter(Boolean),m=(await Promise.all(n.org_templates.map(i))).filter(Boolean);return r.info("Loaded templates",{sourceFile:Tl,functionName:t,personalLoaded:u.length,personalTotal:n.user_templates.length,orgLoaded:m.length,orgTotal:n.org_templates.length}),e&&await AU(r,u),await IU(r,m),[...u,...m]}catch(n){r.error("Error in getAllTemplatesWithContent",n,{sourceFile:Tl,functionName:t}),r.info("Falling back to cached templates from local storage",{sourceFile:Tl,functionName:t});const s=await tT(r),i=await rT(r);return[...s,...i]}},S7=async r=>{const e="getTemplatesFromLocalStorage";try{const[t,n]=await Promise.all([tT(r),rT(r)]);return[...t,...n]}catch(t){return r.error("Error getting templates from local storage",t,{sourceFile:Tl,functionName:e}),[]}};async function Vk(r,{signalType:e,signalValue:t}){localStorage.setItem(e,t);try{const s=(await Kn.createServices()).tabs;s.openOptionsPage?await s.openOptionsPage():r.error("Tabs provider does not support options page",new Error("Tabs provider does not support options page"),{sourceFile:"src/shared/lib/utils/optionsUtils.ts",sourceFunction:"openOrFocusOptionsPage"})}catch(n){r.error("Error opening options page",n,{sourceFile:"src/shared/lib/utils/optionsUtils.ts",sourceFunction:"openOrFocusOptionsPage"})}}const bE=({feature:r,description:e,benefits:t=[],className:n="",variant:s="card"})=>{const{isConnected:i,isLoading:c,error:u,status:p,initiateReconnection:m}=Ji(),{platform:g}=ln();if(g!=="chrome"||i)return null;const x=async()=>{try{await m()}catch(T){console.error("Failed to reconnect Gmail:",T)}},b=()=>p==="loading"?d.jsx(Co,{className:"h-5 w-5 text-blue-600 animate-spin"}):p==="error"?d.jsx(Zf,{className:"h-5 w-5 text-red-600"}):d.jsx(Wc,{className:"h-5 w-5 text-amber-600"}),E=()=>p==="loading"?"Checking Gmail connection...":p==="error"?u||"Gmail connection error occurred":"Gmail connection required";return s==="banner"?d.jsxs("div",{className:`flex items-center justify-between bg-amber-50 border border-amber-200 px-4 py-3 rounded-lg ${n}`,children:[d.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[b(),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("p",{className:"text-sm font-medium text-amber-800",children:E()}),d.jsx("p",{className:"text-sm text-amber-700 mt-1",children:e||`Connect Gmail to access ${r} features.`})]})]}),d.jsx($e,{onClick:x,disabled:c,variant:"outline",size:"sm",className:"bg-amber-100 border-amber-300 text-amber-800 hover:bg-amber-200 hover:border-amber-400 whitespace-nowrap ml-4",children:c?d.jsxs(d.Fragment,{children:[d.jsx(Co,{className:"h-4 w-4 mr-2 animate-spin"}),"Connecting..."]}):"Connect Gmail"})]}):s==="inline"?d.jsxs("div",{className:`flex items-center gap-2 text-amber-700 ${n}`,children:[b(),d.jsx("span",{className:"text-sm",children:E()}),d.jsx($e,{onClick:x,disabled:c,variant:"link",size:"sm",className:"h-auto p-0 text-amber-700 hover:text-amber-800",children:"Connect Gmail"})]}):d.jsx(fi,{className:`${n}`,children:d.jsx(hi,{className:"p-6",children:d.jsxs("div",{className:"flex items-start gap-4",children:[d.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-amber-100 rounded-full flex items-center justify-center",children:b()}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("h3",{className:"text-base font-semibold text-gray-900 mb-2",children:"Gmail Connection Required"}),d.jsx("p",{className:"text-gray-600 mb-4",children:e||`To access ${r}, you need to connect your Gmail account first.`}),t.length>0&&d.jsxs("div",{className:"mb-4",children:[d.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"What you'll get with Gmail connected:"}),d.jsx("ul",{className:"text-sm text-gray-600 space-y-1",children:t.map((T,S)=>d.jsxs("li",{className:"flex items-start gap-2",children:[d.jsx(Hc,{className:"h-4 w-4 text-green-600 mt-0.5 flex-shrink-0"}),d.jsx("span",{children:T})]},S))})]}),u&&d.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-3 mb-4",children:d.jsx("p",{className:"text-sm text-red-800",children:u})}),d.jsx("div",{className:"flex items-center gap-3",children:d.jsx($e,{onClick:x,disabled:c,className:"bg-blue-600 hover:bg-blue-700",children:c?d.jsxs(d.Fragment,{children:[d.jsx(Co,{className:"h-4 w-4 mr-2 animate-spin"}),"Connecting..."]}):d.jsxs(d.Fragment,{children:[d.jsx(Wc,{className:"h-4 w-4 mr-2"}),"Connect Gmail"]})})})]})]})})})},Ks="src/sidepanel/panels/TemplatesPanel.tsx",C7=({clientEmail:r,isAuthenticated:e})=>{const t=Ur(),{platform:n}=ln(),{isConnected:s}=Ji(),[i,c]=w.useState(""),[u,p]=w.useState([]),[m,g]=w.useState(!1),[x,b]=w.useState([]),[E,T]=w.useState([]),[S,N]=w.useState("all"),[R,A]=w.useState([]),[j,P]=w.useState(!0),[M,B]=w.useState(!1),[U,V]=w.useState(null),Y=w.useRef(null),ce=w.useRef(null);w.useEffect(()=>{function $(ne){m&&Y.current&&!Y.current.contains(ne.target)&&ce.current&&!ce.current.contains(ne.target)&&g(!1)}return document.addEventListener("mousedown",$),()=>{document.removeEventListener("mousedown",$)}},[m]),w.useEffect(()=>{function $(ne){U&&!ne.target.closest("[data-radix-hover-card-content]")&&V(null)}return U&&document.addEventListener("mousedown",$),()=>{document.removeEventListener("mousedown",$)}},[U]),w.useEffect(()=>{if(R.length>0){const $=R.filter(ne=>{var _e,q,ie,xe,ye;return(S==="all"||S==="org"&&ne.source==="org"||S==="personal"&&ne.source!=="org")&&(((_e=ne.title)==null?void 0:_e.toLowerCase().includes(i.toLowerCase()))||((q=ne.content)==null?void 0:q.toLowerCase().includes(i.toLowerCase()))||((ie=ne.tags)==null?void 0:ie.some(ue=>ue.toLowerCase().includes(i.toLowerCase())))||((xe=ne.description)==null?void 0:xe.toLowerCase().includes(i.toLowerCase())))&&(x.length===0||((ye=ne.tags)==null?void 0:ye.some(ue=>x.includes(ue))))});if(i.trim()){const ne=$.sort((_e,q)=>{const ie=i.toLowerCase(),xe=ke=>{var He,Ue,Le,Ne;return(He=ke.tags)!=null&&He.some(gt=>gt.toLowerCase().includes(ie))?1:(Ue=ke.title)!=null&&Ue.toLowerCase().includes(ie)?2:(Le=ke.description)!=null&&Le.toLowerCase().includes(ie)?3:(Ne=ke.content)!=null&&Ne.toLowerCase().includes(ie)?4:5},ye=xe(_e),ue=xe(q);return ye!==ue?ye-ue:(_e.title||"").localeCompare(q.title||"")});p(ne)}else p($)}},[R,i,x,S]),w.useEffect(()=>{if(!e){t.debug("Skipping template loading - user not authenticated",{sourceFile:Ks,isAuthenticated:e});return}const $=async()=>{P(!0);const ne="loadTemplatesDirectly";try{t.info("Loading templates directly from server (like options page)",{sourceFile:Ks,functionName:ne});const _e=await Wk(t,!0);if(_e.length>0){t.info("Templates loaded successfully",{sourceFile:Ks,functionName:ne,count:_e.length}),A(_e);const q=await ry(t);let ie=[];q.id!==""&&(ie=q.templateConfiguration.tags||[]);const xe=new Set(ie);_e.forEach(ye=>{ye.tags&&Array.isArray(ye.tags)&&ye.tags.forEach(ue=>xe.add(ue))}),T(Array.from(xe))}else t.info("No templates found!",{sourceFile:Ks,functionName:ne}),A([])}catch(_e){t.error("Error loading templates directly from server",_e,{sourceFile:Ks,functionName:ne});try{const q=await S7(t);t.info("Fallback to local storage successful",{sourceFile:Ks,functionName:ne,count:q.length}),A(q)}catch(q){t.error("Fallback to local storage also failed",q,{sourceFile:Ks,functionName:ne}),A([])}}finally{P(!1)}};t.info("TemplatesPanel initialized, loading templates directly from server",{sourceFile:Ks,isAuthenticated:e}),$()},[t,e]);const X=w.useCallback(async()=>{if(M)return;B(!0);const $="refreshTemplates";t.info("Starting template refresh from server",{sourceFile:Ks,functionName:$});try{const ne=await ry(t);let _e=[];ne.id!==""?(t.debug("configuration loaded from storage",{sourceFile:Ks,functionName:$,config:ne}),_e=ne.templateConfiguration.tags||[]):t.warn("No configuration found in storage",{sourceFile:Ks,functionName:$}),t.info("Calling getAllTemplatesWithContent",{sourceFile:Ks,functionName:$});const q=await Wk(t,!0);t.info("getAllTemplatesWithContent completed",{sourceFile:Ks,functionName:$,templateCount:q.length});const ie=new Set(_e);q.forEach(ye=>{ye.tags&&Array.isArray(ye.tags)&&ye.tags.forEach(ue=>ie.add(ue))});const xe=Array.from(ie);t.info("Template refresh successful",{sourceFile:Ks,functionName:$,templateCount:q.length,tagsCount:xe.length,templates:q.map(ye=>({title:ye.title,tags:ye.tags,source:ye.source}))}),T(xe),A(q)}catch(ne){t.error("Error refreshing templates from server",ne,{sourceFile:Ks,functionName:$}),console.error("Template loading failed:",ne)}finally{B(!1)}},[M,t]),de=()=>{g(!m)},we=$=>{b(ne=>ne.includes($)?ne.filter(_e=>_e!==$):[...ne,$])},le=$=>{V(ne=>ne===$?null:$)},[se,me]=w.useState(!1),te=w.useRef(null),G=w.useRef(null);w.useEffect(()=>{function $(ne){se&&te.current&&!te.current.contains(ne.target)&&G.current&&!G.current.contains(ne.target)&&me(!1)}return document.addEventListener("mousedown",$),()=>{document.removeEventListener("mousedown",$)}},[se]);const z=()=>{me(!se)},J=$=>{N($),me(!1)};return n==="chrome"&&!s?d.jsx("div",{className:"p-4",children:d.jsx(bE,{feature:"Templates",description:"Connect your Gmail account to access and insert email templates",benefits:["Access all your personal and organization templates","Insert template content directly into compose box","Search and filter templates by tags and content"]})}):d.jsxs("div",{className:"space-y-4 h-full",children:[d.jsxs("div",{className:"relative",children:[d.jsx(rn,{type:"text",placeholder:"Search templates...",value:i,onChange:$=>c($.target.value),className:"pl-10 pr-12"}),d.jsx(Zs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:18}),d.jsx($e,{ref:ce,variant:"outline",className:"absolute right-0 top-1/2 transform -translate-y-1/2",onClick:de,children:d.jsx(ew,{})}),m&&d.jsx("div",{ref:Y,className:"absolute right-0 mt-2 w-48 bg-white dark:bg-card border dark:border-border rounded shadow-lg z-10",children:E.length>0?E.map($=>d.jsxs("label",{className:"block px-4 py-2 hover:bg-gray-50 dark:hover:bg-muted cursor-pointer text-gray-900 dark:text-gray-200",children:[d.jsx("input",{type:"checkbox",className:"mr-2",checked:x.includes($),onChange:()=>we($)}),$]},$)):d.jsx("div",{className:"px-4 py-2 text-gray-500",children:"No tags available"})})]}),d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{className:"relative",children:[d.jsxs($e,{ref:G,variant:"outline",size:"sm",onClick:z,className:"flex items-center hover:bg-blue-50",children:[S==="all"&&d.jsxs(d.Fragment,{children:[d.jsx(ew,{className:"mr-2 h-4 w-4"}),"All Templates (",u.length,")"]}),S==="personal"&&d.jsxs(d.Fragment,{children:[d.jsx(by,{className:"mr-2 h-4 w-4"}),"Personal Only (",u.length,")"]}),S==="org"&&d.jsxs(d.Fragment,{children:[d.jsx(Zx,{className:"mr-2 h-4 w-4"}),"Org Only (",u.length,")"]})]}),se&&d.jsxs("div",{ref:te,className:"absolute left-0 mt-1 w-40 bg-white dark:bg-card border dark:border-border rounded shadow-lg z-10",children:[S!=="all"&&d.jsxs("div",{className:"px-4 py-2 hover:bg-gray-50 dark:hover:bg-muted cursor-pointer flex items-center text-gray-900 dark:text-gray-200",onClick:()=>J("all"),children:[d.jsx(ew,{className:"mr-2 h-4 w-4"}),"All Templates"]}),S!=="personal"&&d.jsxs("div",{className:"px-4 py-2 hover:bg-gray-50 dark:hover:bg-muted cursor-pointer flex items-center text-gray-900 dark:text-gray-200",onClick:()=>J("personal"),children:[d.jsx(by,{className:"mr-2 h-4 w-4"}),"Personal Only"]}),S!=="org"&&R.filter($=>$.source==="org").length>0&&d.jsxs("div",{className:"px-4 py-2 hover:bg-gray-50 dark:hover:bg-muted cursor-pointer flex items-center text-gray-900 dark:text-gray-200",onClick:()=>J("org"),children:[d.jsx(Zx,{className:"mr-2 h-4 w-4"}),"Org Only"]})]})]}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx($e,{size:"icon",className:"rounded-lg bg-blue-600 text-white hover:bg-blue-700 hover:text-white dark:bg-blue-600 dark:text-white dark:hover:bg-blue-700 border border-blue-600 dark:border-blue-600",title:"Add Template",onClick:()=>{Vk(t,{signalType:"openCreateTemplate",signalValue:"true"})},children:d.jsx(aB,{className:"w-5 h-5"})}),d.jsx($e,{variant:"outline",size:"icon",className:"rounded-lg hover:bg-blue-50",title:"Refresh Templates",onClick:X,disabled:M||j,children:d.jsx(Co,{className:`w-5 h-5 ${M?"animate-spin":""}`})})]})]}),j?d.jsxs("div",{className:"flex justify-center items-center py-12",children:[d.jsx(qi,{className:"h-8 w-8 animate-spin text-blue-600"}),d.jsx("span",{className:"ml-2 text-gray-600",children:"Loading templates..."})]}):d.jsxs("div",{className:"overflow-y-auto h-full pb-2",children:[u.map($=>d.jsxs(fi,{className:"animate-fadeIn relative mb-2",children:[d.jsxs(Gi,{children:[d.jsx(Wi,{className:"text-sm flex items-center",children:$.title}),$.tags&&$.tags.length>0&&d.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:$.tags.map((ne,_e)=>d.jsx("span",{className:"inline-block bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full",children:ne},_e))})]}),d.jsxs(hi,{children:[d.jsx("p",{className:"text-xs mb-2 overflow-hidden text-ellipsis max-h-[50px]",children:$.description}),d.jsxs("div",{className:"flex space-x-2",children:[d.jsx($e,{className:"flex-1 text-xs py-1 bg-blue-600 text-white hover:bg-blue-700 hover:text-white dark:bg-blue-600 dark:text-white dark:hover:bg-blue-700 w-1/2 border border-blue-600 dark:border-blue-600",onClick:()=>{IA($.content,t)},children:d.jsxs("span",{className:"flex items-center justify-center w-full",children:[d.jsx(KR,{className:"w-4 h-4 flex-shrink-0 mr-1 rotate-90"}),d.jsx("span",{className:"hide-text-when-narrow",children:"Insert"})]})}),d.jsxs(y7,{open:U===$.id?!0:void 0,onOpenChange:ne=>{!ne&&U===$.id&&V(null)},openDelay:0,closeDelay:100,children:[d.jsx(x7,{asChild:!0,children:d.jsx($e,{variant:"outline",className:`text-xs py-1 bg-white dark:bg-card text-black dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-muted hover:text-blue-600 dark:hover:text-blue-400 w-1/4 ${U===$.id?"bg-gray-100 dark:bg-muted text-blue-600 dark:text-blue-400":""}`,onClick:ne=>{ne.preventDefault(),le($.id)},children:d.jsxs("span",{className:"flex items-center justify-center w-full",children:[d.jsx(uB,{className:"w-4 h-4 flex-shrink-0 mr-1"}),d.jsx("span",{className:"hide-text-when-narrow",children:"View"})]})})}),d.jsxs(w7,{className:"bg-white dark:bg-card border-2 mt-8 mr-8 border-gray-200 dark:border-border rounded-md text-gray-700 dark:text-gray-200 p-4 z-50 overflow-auto",align:"center",side:"top",style:{maxHeight:"40vh",maxWidth:"80vw",width:"auto",height:"auto",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.15)"},children:[d.jsx("div",{dangerouslySetInnerHTML:{__html:$.content}}),d.jsx(b7,{className:"fill-blue-500"})]})]}),$.source==="org"?d.jsx("div",{className:"w-1/4 flex items-center",title:"Organization templates can only be edited by an admin.",children:d.jsxs("span",{className:"text-xs py-1 px-2 bg-blue-100 text-blue-800 border border-blue-300 flex items-center justify-center w-full rounded-full",children:[d.jsx(Zx,{className:"w-4 h-4 flex-shrink-0 mr-1"}),d.jsx("span",{className:"hide-text-when-narrow",children:"Org"})]})}):d.jsx($e,{variant:"outline",className:"text-xs py-1 bg-white dark:bg-card text-black dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-muted w-1/4",title:"Edit Template",onClick:()=>{Vk(t,{signalType:"editTemplateId",signalValue:$.id})},children:d.jsxs("span",{className:"flex items-center justify-center w-full",children:[d.jsx(yB,{className:"w-4 h-4 flex-shrink-0 mr-1"}),d.jsx("span",{className:"hide-text-when-narrow",children:"Edit"})]})})]})]})]},$.id)),u.length===0&&d.jsxs("div",{className:"mt-8 text-center text-gray-500",children:[d.jsx("p",{children:"No templates found matching your criteria."}),d.jsx("p",{className:"text-sm mt-2",children:"Try adjusting your filters or search terms."})]})]})]})},Oc=({src:r,width:e,height:t,alt:n,className:s})=>{const i=r.startsWith("/")?`${WN}${r}`:r;return d.jsx("img",{src:i,width:e,height:t,alt:n,className:s})},sw=({options:r,value:e,onChange:t})=>d.jsx("div",{className:"flex rounded-md shadow-sm",children:r.map(n=>d.jsx($e,{variant:e===n?"default":"outline",className:`flex-1 text-xs ${e===n?"":"text-muted-foreground"}`,onClick:()=>t(n),children:n},n))});/*! @license DOMPurify 3.3.1 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.1/LICENSE */const{entries:PA,setPrototypeOf:qk,isFrozen:k7,getPrototypeOf:N7,getOwnPropertyDescriptor:T7}=Object;let{freeze:eo,seal:yi,create:wb}=Object,{apply:bb,construct:_b}=typeof Reflect<"u"&&Reflect;eo||(eo=function(e){return e});yi||(yi=function(e){return e});bb||(bb=function(e,t){for(var n=arguments.length,s=new Array(n>2?n-2:0),i=2;i<n;i++)s[i-2]=arguments[i];return e.apply(t,s)});_b||(_b=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];return new e(...n)});const Tv=to(Array.prototype.forEach),R7=to(Array.prototype.lastIndexOf),Kk=to(Array.prototype.pop),Yp=to(Array.prototype.push),A7=to(Array.prototype.splice),Kv=to(String.prototype.toLowerCase),ow=to(String.prototype.toString),iw=to(String.prototype.match),Jp=to(String.prototype.replace),I7=to(String.prototype.indexOf),P7=to(String.prototype.trim),Bi=to(Object.prototype.hasOwnProperty),Ys=to(RegExp.prototype.test),Xp=F7(TypeError);function to(r){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];return bb(r,e,n)}}function F7(r){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return _b(r,t)}}function nr(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Kv;qk&&qk(r,null);let n=e.length;for(;n--;){let s=e[n];if(typeof s=="string"){const i=t(s);i!==s&&(k7(e)||(e[n]=i),s=i)}r[s]=!0}return r}function j7(r){for(let e=0;e<r.length;e++)Bi(r,e)||(r[e]=null);return r}function Ia(r){const e=wb(null);for(const[t,n]of PA(r))Bi(r,t)&&(Array.isArray(n)?e[t]=j7(n):n&&typeof n=="object"&&n.constructor===Object?e[t]=Ia(n):e[t]=n);return e}function Qp(r,e){for(;r!==null;){const n=T7(r,e);if(n){if(n.get)return to(n.get);if(typeof n.value=="function")return to(n.value)}r=N7(r)}function t(){return null}return t}const Yk=eo(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),aw=eo(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),lw=eo(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),O7=eo(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),cw=eo(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),D7=eo(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Jk=eo(["#text"]),Xk=eo(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),uw=eo(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Qk=eo(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Rv=eo(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),L7=yi(/\{\{[\w\W]*|[\w\W]*\}\}/gm),M7=yi(/<%[\w\W]*|[\w\W]*%>/gm),$7=yi(/\$\{[\w\W]*/gm),U7=yi(/^data-[\-\w.\u00B7-\uFFFF]+$/),z7=yi(/^aria-[\-\w]+$/),FA=yi(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),H7=yi(/^(?:\w+script|data):/i),B7=yi(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),jA=yi(/^html$/i),G7=yi(/^[a-z][.\w]*(-[.\w]+)+$/i);var Zk=Object.freeze({__proto__:null,ARIA_ATTR:z7,ATTR_WHITESPACE:B7,CUSTOM_ELEMENT:G7,DATA_ATTR:U7,DOCTYPE_NAME:jA,ERB_EXPR:M7,IS_ALLOWED_URI:FA,IS_SCRIPT_OR_DATA:H7,MUSTACHE_EXPR:L7,TMPLIT_EXPR:$7});const Zp={element:1,text:3,progressingInstruction:7,comment:8,document:9},W7=function(){return typeof window>"u"?null:window},V7=function(e,t){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let n=null;const s="data-tt-policy-suffix";t&&t.hasAttribute(s)&&(n=t.getAttribute(s));const i="dompurify"+(n?"#"+n:"");try{return e.createPolicy(i,{createHTML(c){return c},createScriptURL(c){return c}})}catch{return console.warn("TrustedTypes policy "+i+" could not be created."),null}},e1=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function OA(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:W7();const e=ut=>OA(ut);if(e.version="3.3.1",e.removed=[],!r||!r.document||r.document.nodeType!==Zp.document||!r.Element)return e.isSupported=!1,e;let{document:t}=r;const n=t,s=n.currentScript,{DocumentFragment:i,HTMLTemplateElement:c,Node:u,Element:p,NodeFilter:m,NamedNodeMap:g=r.NamedNodeMap||r.MozNamedAttrMap,HTMLFormElement:x,DOMParser:b,trustedTypes:E}=r,T=p.prototype,S=Qp(T,"cloneNode"),N=Qp(T,"remove"),R=Qp(T,"nextSibling"),A=Qp(T,"childNodes"),j=Qp(T,"parentNode");if(typeof c=="function"){const ut=t.createElement("template");ut.content&&ut.content.ownerDocument&&(t=ut.content.ownerDocument)}let P,M="";const{implementation:B,createNodeIterator:U,createDocumentFragment:V,getElementsByTagName:Y}=t,{importNode:ce}=n;let X=e1();e.isSupported=typeof PA=="function"&&typeof j=="function"&&B&&B.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:de,ERB_EXPR:we,TMPLIT_EXPR:le,DATA_ATTR:se,ARIA_ATTR:me,IS_SCRIPT_OR_DATA:te,ATTR_WHITESPACE:G,CUSTOM_ELEMENT:z}=Zk;let{IS_ALLOWED_URI:J}=Zk,D=null;const $=nr({},[...Yk,...aw,...lw,...cw,...Jk]);let ne=null;const _e=nr({},[...Xk,...uw,...Qk,...Rv]);let q=Object.seal(wb(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),ie=null,xe=null;const ye=Object.seal(wb(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let ue=!0,ke=!0,He=!1,Ue=!0,Le=!1,Ne=!0,gt=!1,zt=!1,yt=!1,Zt=!1,Bt=!1,or=!1,st=!0,Ft=!1;const er="user-content-";let Ae=!0,Ze=!1,dt={},rt=null;const Lt=nr({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let gr=null;const tr=nr({},["audio","video","img","source","image","track"]);let lt=null;const kt=nr({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Nt="http://www.w3.org/1998/Math/MathML",ze="http://www.w3.org/2000/svg",vr="http://www.w3.org/1999/xhtml";let zr=vr,Or=!1,sn=null;const mn=nr({},[Nt,ze,vr],ow);let cn=nr({},["mi","mo","mn","ms","mtext"]),_n=nr({},["annotation-xml"]);const as=nr({},["title","style","font","a","script"]);let An=null;const wi=["application/xhtml+xml","text/html"],bi="text/html";let Dr=null,pe=null;const Ye=t.createElement("form"),pt=function(Z){return Z instanceof RegExp||Z instanceof Function},Be=function(){let Z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(pe&&pe===Z)){if((!Z||typeof Z!="object")&&(Z={}),Z=Ia(Z),An=wi.indexOf(Z.PARSER_MEDIA_TYPE)===-1?bi:Z.PARSER_MEDIA_TYPE,Dr=An==="application/xhtml+xml"?ow:Kv,D=Bi(Z,"ALLOWED_TAGS")?nr({},Z.ALLOWED_TAGS,Dr):$,ne=Bi(Z,"ALLOWED_ATTR")?nr({},Z.ALLOWED_ATTR,Dr):_e,sn=Bi(Z,"ALLOWED_NAMESPACES")?nr({},Z.ALLOWED_NAMESPACES,ow):mn,lt=Bi(Z,"ADD_URI_SAFE_ATTR")?nr(Ia(kt),Z.ADD_URI_SAFE_ATTR,Dr):kt,gr=Bi(Z,"ADD_DATA_URI_TAGS")?nr(Ia(tr),Z.ADD_DATA_URI_TAGS,Dr):tr,rt=Bi(Z,"FORBID_CONTENTS")?nr({},Z.FORBID_CONTENTS,Dr):Lt,ie=Bi(Z,"FORBID_TAGS")?nr({},Z.FORBID_TAGS,Dr):Ia({}),xe=Bi(Z,"FORBID_ATTR")?nr({},Z.FORBID_ATTR,Dr):Ia({}),dt=Bi(Z,"USE_PROFILES")?Z.USE_PROFILES:!1,ue=Z.ALLOW_ARIA_ATTR!==!1,ke=Z.ALLOW_DATA_ATTR!==!1,He=Z.ALLOW_UNKNOWN_PROTOCOLS||!1,Ue=Z.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Le=Z.SAFE_FOR_TEMPLATES||!1,Ne=Z.SAFE_FOR_XML!==!1,gt=Z.WHOLE_DOCUMENT||!1,Zt=Z.RETURN_DOM||!1,Bt=Z.RETURN_DOM_FRAGMENT||!1,or=Z.RETURN_TRUSTED_TYPE||!1,yt=Z.FORCE_BODY||!1,st=Z.SANITIZE_DOM!==!1,Ft=Z.SANITIZE_NAMED_PROPS||!1,Ae=Z.KEEP_CONTENT!==!1,Ze=Z.IN_PLACE||!1,J=Z.ALLOWED_URI_REGEXP||FA,zr=Z.NAMESPACE||vr,cn=Z.MATHML_TEXT_INTEGRATION_POINTS||cn,_n=Z.HTML_INTEGRATION_POINTS||_n,q=Z.CUSTOM_ELEMENT_HANDLING||{},Z.CUSTOM_ELEMENT_HANDLING&&pt(Z.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(q.tagNameCheck=Z.CUSTOM_ELEMENT_HANDLING.tagNameCheck),Z.CUSTOM_ELEMENT_HANDLING&&pt(Z.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(q.attributeNameCheck=Z.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),Z.CUSTOM_ELEMENT_HANDLING&&typeof Z.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(q.allowCustomizedBuiltInElements=Z.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Le&&(ke=!1),Bt&&(Zt=!0),dt&&(D=nr({},Jk),ne=[],dt.html===!0&&(nr(D,Yk),nr(ne,Xk)),dt.svg===!0&&(nr(D,aw),nr(ne,uw),nr(ne,Rv)),dt.svgFilters===!0&&(nr(D,lw),nr(ne,uw),nr(ne,Rv)),dt.mathMl===!0&&(nr(D,cw),nr(ne,Qk),nr(ne,Rv))),Z.ADD_TAGS&&(typeof Z.ADD_TAGS=="function"?ye.tagCheck=Z.ADD_TAGS:(D===$&&(D=Ia(D)),nr(D,Z.ADD_TAGS,Dr))),Z.ADD_ATTR&&(typeof Z.ADD_ATTR=="function"?ye.attributeCheck=Z.ADD_ATTR:(ne===_e&&(ne=Ia(ne)),nr(ne,Z.ADD_ATTR,Dr))),Z.ADD_URI_SAFE_ATTR&&nr(lt,Z.ADD_URI_SAFE_ATTR,Dr),Z.FORBID_CONTENTS&&(rt===Lt&&(rt=Ia(rt)),nr(rt,Z.FORBID_CONTENTS,Dr)),Z.ADD_FORBID_CONTENTS&&(rt===Lt&&(rt=Ia(rt)),nr(rt,Z.ADD_FORBID_CONTENTS,Dr)),Ae&&(D["#text"]=!0),gt&&nr(D,["html","head","body"]),D.table&&(nr(D,["tbody"]),delete ie.tbody),Z.TRUSTED_TYPES_POLICY){if(typeof Z.TRUSTED_TYPES_POLICY.createHTML!="function")throw Xp('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof Z.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Xp('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');P=Z.TRUSTED_TYPES_POLICY,M=P.createHTML("")}else P===void 0&&(P=V7(E,s)),P!==null&&typeof M=="string"&&(M=P.createHTML(""));eo&&eo(Z),pe=Z}},qt=nr({},[...aw,...lw,...O7]),dr=nr({},[...cw,...D7]),Gt=function(Z){let Oe=j(Z);(!Oe||!Oe.tagName)&&(Oe={namespaceURI:zr,tagName:"template"});const tt=Kv(Z.tagName),br=Kv(Oe.tagName);return sn[Z.namespaceURI]?Z.namespaceURI===ze?Oe.namespaceURI===vr?tt==="svg":Oe.namespaceURI===Nt?tt==="svg"&&(br==="annotation-xml"||cn[br]):!!qt[tt]:Z.namespaceURI===Nt?Oe.namespaceURI===vr?tt==="math":Oe.namespaceURI===ze?tt==="math"&&_n[br]:!!dr[tt]:Z.namespaceURI===vr?Oe.namespaceURI===ze&&!_n[br]||Oe.namespaceURI===Nt&&!cn[br]?!1:!dr[tt]&&(as[tt]||!qt[tt]):!!(An==="application/xhtml+xml"&&sn[Z.namespaceURI]):!1},ot=function(Z){Yp(e.removed,{element:Z});try{j(Z).removeChild(Z)}catch{N(Z)}},yr=function(Z,Oe){try{Yp(e.removed,{attribute:Oe.getAttributeNode(Z),from:Oe})}catch{Yp(e.removed,{attribute:null,from:Oe})}if(Oe.removeAttribute(Z),Z==="is")if(Zt||Bt)try{ot(Oe)}catch{}else try{Oe.setAttribute(Z,"")}catch{}},un=function(Z){let Oe=null,tt=null;if(yt)Z="<remove></remove>"+Z;else{const Hr=iw(Z,/^[\r\n\t ]+/);tt=Hr&&Hr[0]}An==="application/xhtml+xml"&&zr===vr&&(Z='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+Z+"</body></html>");const br=P?P.createHTML(Z):Z;if(zr===vr)try{Oe=new b().parseFromString(br,An)}catch{}if(!Oe||!Oe.documentElement){Oe=B.createDocument(zr,"template",null);try{Oe.documentElement.innerHTML=Or?M:br}catch{}}const Mt=Oe.body||Oe.documentElement;return Z&&tt&&Mt.insertBefore(t.createTextNode(tt),Mt.childNodes[0]||null),zr===vr?Y.call(Oe,gt?"html":"body")[0]:gt?Oe.documentElement:Mt},$n=function(Z){return U.call(Z.ownerDocument||Z,Z,m.SHOW_ELEMENT|m.SHOW_COMMENT|m.SHOW_TEXT|m.SHOW_PROCESSING_INSTRUCTION|m.SHOW_CDATA_SECTION,null)},ko=function(Z){return Z instanceof x&&(typeof Z.nodeName!="string"||typeof Z.textContent!="string"||typeof Z.removeChild!="function"||!(Z.attributes instanceof g)||typeof Z.removeAttribute!="function"||typeof Z.setAttribute!="function"||typeof Z.namespaceURI!="string"||typeof Z.insertBefore!="function"||typeof Z.hasChildNodes!="function")},Ba=function(Z){return typeof u=="function"&&Z instanceof u};function $s(ut,Z,Oe){Tv(ut,tt=>{tt.call(e,Z,Oe,pe)})}const no=function(Z){let Oe=null;if($s(X.beforeSanitizeElements,Z,null),ko(Z))return ot(Z),!0;const tt=Dr(Z.nodeName);if($s(X.uponSanitizeElement,Z,{tagName:tt,allowedTags:D}),Ne&&Z.hasChildNodes()&&!Ba(Z.firstElementChild)&&Ys(/<[/\w!]/g,Z.innerHTML)&&Ys(/<[/\w!]/g,Z.textContent)||Z.nodeType===Zp.progressingInstruction||Ne&&Z.nodeType===Zp.comment&&Ys(/<[/\w]/g,Z.data))return ot(Z),!0;if(!(ye.tagCheck instanceof Function&&ye.tagCheck(tt))&&(!D[tt]||ie[tt])){if(!ie[tt]&&ta(tt)&&(q.tagNameCheck instanceof RegExp&&Ys(q.tagNameCheck,tt)||q.tagNameCheck instanceof Function&&q.tagNameCheck(tt)))return!1;if(Ae&&!rt[tt]){const br=j(Z)||Z.parentNode,Mt=A(Z)||Z.childNodes;if(Mt&&br){const Hr=Mt.length;for(let on=Hr-1;on>=0;--on){const ls=S(Mt[on],!0);ls.__removalCount=(Z.__removalCount||0)+1,br.insertBefore(ls,R(Z))}}}return ot(Z),!0}return Z instanceof p&&!Gt(Z)||(tt==="noscript"||tt==="noembed"||tt==="noframes")&&Ys(/<\/no(script|embed|frames)/i,Z.innerHTML)?(ot(Z),!0):(Le&&Z.nodeType===Zp.text&&(Oe=Z.textContent,Tv([de,we,le],br=>{Oe=Jp(Oe,br," ")}),Z.textContent!==Oe&&(Yp(e.removed,{element:Z.cloneNode()}),Z.textContent=Oe)),$s(X.afterSanitizeElements,Z,null),!1)},_i=function(Z,Oe,tt){if(st&&(Oe==="id"||Oe==="name")&&(tt in t||tt in Ye))return!1;if(!(ke&&!xe[Oe]&&Ys(se,Oe))){if(!(ue&&Ys(me,Oe))){if(!(ye.attributeCheck instanceof Function&&ye.attributeCheck(Oe,Z))){if(!ne[Oe]||xe[Oe]){if(!(ta(Z)&&(q.tagNameCheck instanceof RegExp&&Ys(q.tagNameCheck,Z)||q.tagNameCheck instanceof Function&&q.tagNameCheck(Z))&&(q.attributeNameCheck instanceof RegExp&&Ys(q.attributeNameCheck,Oe)||q.attributeNameCheck instanceof Function&&q.attributeNameCheck(Oe,Z))||Oe==="is"&&q.allowCustomizedBuiltInElements&&(q.tagNameCheck instanceof RegExp&&Ys(q.tagNameCheck,tt)||q.tagNameCheck instanceof Function&&q.tagNameCheck(tt))))return!1}else if(!lt[Oe]){if(!Ys(J,Jp(tt,G,""))){if(!((Oe==="src"||Oe==="xlink:href"||Oe==="href")&&Z!=="script"&&I7(tt,"data:")===0&&gr[Z])){if(!(He&&!Ys(te,Jp(tt,G,"")))){if(tt)return!1}}}}}}}return!0},ta=function(Z){return Z!=="annotation-xml"&&iw(Z,z)},Ga=function(Z){$s(X.beforeSanitizeAttributes,Z,null);const{attributes:Oe}=Z;if(!Oe||ko(Z))return;const tt={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:ne,forceKeepAttr:void 0};let br=Oe.length;for(;br--;){const Mt=Oe[br],{name:Hr,namespaceURI:on,value:ls}=Mt,In=Dr(Hr),Ei=ls;let qr=Hr==="value"?Ei:P7(Ei);if(tt.attrName=In,tt.attrValue=qr,tt.keepAttr=!0,tt.forceKeepAttr=void 0,$s(X.uponSanitizeAttribute,Z,tt),qr=tt.attrValue,Ft&&(In==="id"||In==="name")&&(yr(Hr,Z),qr=er+qr),Ne&&Ys(/((--!?|])>)|<\/(style|title|textarea)/i,qr)){yr(Hr,Z);continue}if(In==="attributename"&&iw(qr,"href")){yr(Hr,Z);continue}if(tt.forceKeepAttr)continue;if(!tt.keepAttr){yr(Hr,Z);continue}if(!Ue&&Ys(/\/>/i,qr)){yr(Hr,Z);continue}Le&&Tv([de,we,le],En=>{qr=Jp(qr,En," ")});const No=Dr(Z.nodeName);if(!_i(No,In,qr)){yr(Hr,Z);continue}if(P&&typeof E=="object"&&typeof E.getAttributeType=="function"&&!on)switch(E.getAttributeType(No,In)){case"TrustedHTML":{qr=P.createHTML(qr);break}case"TrustedScriptURL":{qr=P.createScriptURL(qr);break}}if(qr!==Ei)try{on?Z.setAttributeNS(on,Hr,qr):Z.setAttribute(Hr,qr),ko(Z)?ot(Z):Kk(e.removed)}catch{yr(Hr,Z)}}$s(X.afterSanitizeAttributes,Z,null)},Wa=function ut(Z){let Oe=null;const tt=$n(Z);for($s(X.beforeSanitizeShadowDOM,Z,null);Oe=tt.nextNode();)$s(X.uponSanitizeShadowNode,Oe,null),no(Oe),Ga(Oe),Oe.content instanceof i&&ut(Oe.content);$s(X.afterSanitizeShadowDOM,Z,null)};return e.sanitize=function(ut){let Z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Oe=null,tt=null,br=null,Mt=null;if(Or=!ut,Or&&(ut="<!-->"),typeof ut!="string"&&!Ba(ut))if(typeof ut.toString=="function"){if(ut=ut.toString(),typeof ut!="string")throw Xp("dirty is not a string, aborting")}else throw Xp("toString is not a function");if(!e.isSupported)return ut;if(zt||Be(Z),e.removed=[],typeof ut=="string"&&(Ze=!1),Ze){if(ut.nodeName){const ls=Dr(ut.nodeName);if(!D[ls]||ie[ls])throw Xp("root node is forbidden and cannot be sanitized in-place")}}else if(ut instanceof u)Oe=un("<!---->"),tt=Oe.ownerDocument.importNode(ut,!0),tt.nodeType===Zp.element&&tt.nodeName==="BODY"||tt.nodeName==="HTML"?Oe=tt:Oe.appendChild(tt);else{if(!Zt&&!Le&&!gt&&ut.indexOf("<")===-1)return P&&or?P.createHTML(ut):ut;if(Oe=un(ut),!Oe)return Zt?null:or?M:""}Oe&&yt&&ot(Oe.firstChild);const Hr=$n(Ze?ut:Oe);for(;br=Hr.nextNode();)no(br),Ga(br),br.content instanceof i&&Wa(br.content);if(Ze)return ut;if(Zt){if(Bt)for(Mt=V.call(Oe.ownerDocument);Oe.firstChild;)Mt.appendChild(Oe.firstChild);else Mt=Oe;return(ne.shadowroot||ne.shadowrootmode)&&(Mt=ce.call(n,Mt,!0)),Mt}let on=gt?Oe.outerHTML:Oe.innerHTML;return gt&&D["!doctype"]&&Oe.ownerDocument&&Oe.ownerDocument.doctype&&Oe.ownerDocument.doctype.name&&Ys(jA,Oe.ownerDocument.doctype.name)&&(on="<!DOCTYPE "+Oe.ownerDocument.doctype.name+`>
`+on),Le&&Tv([de,we,le],ls=>{on=Jp(on,ls," ")}),P&&or?P.createHTML(on):on},e.setConfig=function(){let ut=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Be(ut),zt=!0},e.clearConfig=function(){pe=null,zt=!1},e.isValidAttribute=function(ut,Z,Oe){pe||Be({});const tt=Dr(ut),br=Dr(Z);return _i(tt,br,Oe)},e.addHook=function(ut,Z){typeof Z=="function"&&Yp(X[ut],Z)},e.removeHook=function(ut,Z){if(Z!==void 0){const Oe=R7(X[ut],Z);return Oe===-1?void 0:A7(X[ut],Oe,1)[0]}return Kk(X[ut])},e.removeHooks=function(ut){X[ut]=[]},e.removeAllHooks=function(){X=e1()},e}OA();const dw=r=>{var s;const e=r.replace(/^```html\s*/,""),t=document.createElement("div");return t.innerHTML=e.replace(/style="[^"]*"/g,""),(((s=t.textContent)==null?void 0:s.replace(/(\n{2,}|[ \t]+\n+|\n+[ \t]+)/g,`
`))||"").trim()},Eb=r=>r.replace(/&quot;/g,'"').replace(/\\"/g,'"').replace(/\\n/g,`
`).replace(/\n{3,}/g,`

`).replace(/\\n/g,`
`).replace(/\\'/g,"'").replace(/\\"/g,'"').replace(/\\\\/g,"\\").replace(/```html/g,"").replace(/```/g,"").replace(/^"/,"").replace(/"$/,"").replace(/\u2019/g,"'").replace(/\u2018/g,"'").replace(/\u201A/g,"'").replace(/\u201B/g,"'"),q7=({htmlString:r})=>{const e=()=>{const t=Eb(r);return{__html:new DOMParser().parseFromString(t,"text/html").body.innerHTML}};return d.jsx("div",{className:"rich-text-content text-gray-800 dark:text-gray-200",style:{fontSize:"14px",lineHeight:"1.6",fontFamily:"Arial, sans-serif"},dangerouslySetInnerHTML:e()})},DA=w.forwardRef(({value:r,onChange:e,className:t,...n},s)=>{const i=w.useRef(null);w.useImperativeHandle(s,()=>i.current);const c=()=>{const u=i.current;u&&(u.style.height="auto",u.style.height=`${u.scrollHeight}px`)};return w.useEffect(()=>{c()},[r]),d.jsx("textarea",{ref:i,value:r,onChange:u=>{e&&e(u)},className:`auto-resizing-textarea ${t||""}`,...n})});DA.displayName="AutoResizingTextarea";var K7=Ab[" useId ".trim().toString()]||(()=>{}),Y7=0;function Dl(r){const[e,t]=w.useState(K7());return Ml(()=>{t(n=>n??String(Y7++))},[r]),e?`radix-${e}`:""}var fw="focusScope.autoFocusOnMount",hw="focusScope.autoFocusOnUnmount",t1={bubbles:!1,cancelable:!0},J7="FocusScope",_E=w.forwardRef((r,e)=>{const{loop:t=!1,trapped:n=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...c}=r,[u,p]=w.useState(null),m=zl(s),g=zl(i),x=w.useRef(null),b=Mn(e,S=>p(S)),E=w.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;w.useEffect(()=>{if(n){let S=function(j){if(E.paused||!u)return;const P=j.target;u.contains(P)?x.current=P:Fc(x.current,{select:!0})},N=function(j){if(E.paused||!u)return;const P=j.relatedTarget;P!==null&&(u.contains(P)||Fc(x.current,{select:!0}))},R=function(j){if(document.activeElement===document.body)for(const M of j)M.removedNodes.length>0&&Fc(u)};document.addEventListener("focusin",S),document.addEventListener("focusout",N);const A=new MutationObserver(R);return u&&A.observe(u,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",S),document.removeEventListener("focusout",N),A.disconnect()}}},[n,u,E.paused]),w.useEffect(()=>{if(u){n1.add(E);const S=document.activeElement;if(!u.contains(S)){const R=new CustomEvent(fw,t1);u.addEventListener(fw,m),u.dispatchEvent(R),R.defaultPrevented||(X7(rW(LA(u)),{select:!0}),document.activeElement===S&&Fc(u))}return()=>{u.removeEventListener(fw,m),setTimeout(()=>{const R=new CustomEvent(hw,t1);u.addEventListener(hw,g),u.dispatchEvent(R),R.defaultPrevented||Fc(S??document.body,{select:!0}),u.removeEventListener(hw,g),n1.remove(E)},0)}}},[u,m,g,E]);const T=w.useCallback(S=>{if(!t&&!n||E.paused)return;const N=S.key==="Tab"&&!S.altKey&&!S.ctrlKey&&!S.metaKey,R=document.activeElement;if(N&&R){const A=S.currentTarget,[j,P]=Q7(A);j&&P?!S.shiftKey&&R===P?(S.preventDefault(),t&&Fc(j,{select:!0})):S.shiftKey&&R===j&&(S.preventDefault(),t&&Fc(P,{select:!0})):R===A&&S.preventDefault()}},[t,n,E.paused]);return d.jsx(jr.div,{tabIndex:-1,...c,ref:b,onKeyDown:T})});_E.displayName=J7;function X7(r,{select:e=!1}={}){const t=document.activeElement;for(const n of r)if(Fc(n,{select:e}),document.activeElement!==t)return}function Q7(r){const e=LA(r),t=r1(e,r),n=r1(e.reverse(),r);return[t,n]}function LA(r){const e=[],t=document.createTreeWalker(r,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const s=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||s?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;t.nextNode();)e.push(t.currentNode);return e}function r1(r,e){for(const t of r)if(!Z7(t,{upTo:e}))return t}function Z7(r,{upTo:e}){if(getComputedStyle(r).visibility==="hidden")return!0;for(;r;){if(e!==void 0&&r===e)return!1;if(getComputedStyle(r).display==="none")return!0;r=r.parentElement}return!1}function eW(r){return r instanceof HTMLInputElement&&"select"in r}function Fc(r,{select:e=!1}={}){if(r&&r.focus){const t=document.activeElement;r.focus({preventScroll:!0}),r!==t&&eW(r)&&e&&r.select()}}var n1=tW();function tW(){let r=[];return{add(e){const t=r[0];e!==t&&(t==null||t.pause()),r=s1(r,e),r.unshift(e)},remove(e){var t;r=s1(r,e),(t=r[0])==null||t.resume()}}}function s1(r,e){const t=[...r],n=t.indexOf(e);return n!==-1&&t.splice(n,1),t}function rW(r){return r.filter(e=>e.tagName!=="A")}var pw=0;function MA(){w.useEffect(()=>{const r=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",r[0]??o1()),document.body.insertAdjacentElement("beforeend",r[1]??o1()),pw++,()=>{pw===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),pw--}},[])}function o1(){const r=document.createElement("span");return r.setAttribute("data-radix-focus-guard",""),r.tabIndex=0,r.style.outline="none",r.style.opacity="0",r.style.position="fixed",r.style.pointerEvents="none",r}var Yv="right-scroll-bar-position",Jv="width-before-scroll-bar",nW="with-scroll-bars-hidden",sW="--removed-body-scroll-bar-size";function mw(r,e){return typeof r=="function"?r(e):r&&(r.current=e),r}function oW(r,e){var t=w.useState(function(){return{value:r,callback:e,facade:{get current(){return t.value},set current(n){var s=t.value;s!==n&&(t.value=n,t.callback(n,s))}}}})[0];return t.callback=e,t.facade}var iW=typeof window<"u"?w.useLayoutEffect:w.useEffect,i1=new WeakMap;function aW(r,e){var t=oW(null,function(n){return r.forEach(function(s){return mw(s,n)})});return iW(function(){var n=i1.get(t);if(n){var s=new Set(n),i=new Set(r),c=t.current;s.forEach(function(u){i.has(u)||mw(u,null)}),i.forEach(function(u){s.has(u)||mw(u,c)})}i1.set(t,r)},[r]),t}function lW(r){return r}function cW(r,e){e===void 0&&(e=lW);var t=[],n=!1,s={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return t.length?t[t.length-1]:r},useMedium:function(i){var c=e(i,n);return t.push(c),function(){t=t.filter(function(u){return u!==c})}},assignSyncMedium:function(i){for(n=!0;t.length;){var c=t;t=[],c.forEach(i)}t={push:function(u){return i(u)},filter:function(){return t}}},assignMedium:function(i){n=!0;var c=[];if(t.length){var u=t;t=[],u.forEach(i),c=t}var p=function(){var g=c;c=[],g.forEach(i)},m=function(){return Promise.resolve().then(p)};m(),t={push:function(g){c.push(g),m()},filter:function(g){return c=c.filter(g),t}}}};return s}function uW(r){r===void 0&&(r={});var e=cW(null);return e.options=Fa({async:!0,ssr:!1},r),e}var $A=function(r){var e=r.sideCar,t=RN(r,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=e.read();if(!n)throw new Error("Sidecar medium not found");return w.createElement(n,Fa({},t))};$A.isSideCarExport=!0;function dW(r,e){return r.useMedium(e),$A}var UA=uW(),gw=function(){},s0=w.forwardRef(function(r,e){var t=w.useRef(null),n=w.useState({onScrollCapture:gw,onWheelCapture:gw,onTouchMoveCapture:gw}),s=n[0],i=n[1],c=r.forwardProps,u=r.children,p=r.className,m=r.removeScrollBar,g=r.enabled,x=r.shards,b=r.sideCar,E=r.noRelative,T=r.noIsolation,S=r.inert,N=r.allowPinchZoom,R=r.as,A=R===void 0?"div":R,j=r.gapMode,P=RN(r,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),M=b,B=aW([t,e]),U=Fa(Fa({},P),s);return w.createElement(w.Fragment,null,g&&w.createElement(M,{sideCar:UA,removeScrollBar:m,shards:x,noRelative:E,noIsolation:T,inert:S,setCallbacks:i,allowPinchZoom:!!N,lockRef:t,gapMode:j}),c?w.cloneElement(w.Children.only(u),Fa(Fa({},U),{ref:B})):w.createElement(A,Fa({},U,{className:p,ref:B}),u))});s0.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};s0.classNames={fullWidth:Jv,zeroRight:Yv};var fW=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function hW(){if(!document)return null;var r=document.createElement("style");r.type="text/css";var e=fW();return e&&r.setAttribute("nonce",e),r}function pW(r,e){r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}function mW(r){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(r)}var gW=function(){var r=0,e=null;return{add:function(t){r==0&&(e=hW())&&(pW(e,t),mW(e)),r++},remove:function(){r--,!r&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},vW=function(){var r=gW();return function(e,t){w.useEffect(function(){return r.add(e),function(){r.remove()}},[e&&t])}},zA=function(){var r=vW(),e=function(t){var n=t.styles,s=t.dynamic;return r(n,s),null};return e},yW={left:0,top:0,right:0,gap:0},vw=function(r){return parseInt(r||"",10)||0},xW=function(r){var e=window.getComputedStyle(document.body),t=e[r==="padding"?"paddingLeft":"marginLeft"],n=e[r==="padding"?"paddingTop":"marginTop"],s=e[r==="padding"?"paddingRight":"marginRight"];return[vw(t),vw(n),vw(s)]},wW=function(r){if(r===void 0&&(r="margin"),typeof window>"u")return yW;var e=xW(r),t=document.documentElement.clientWidth,n=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,n-t+e[2]-e[0])}},bW=zA(),th="data-scroll-locked",_W=function(r,e,t,n){var s=r.left,i=r.top,c=r.right,u=r.gap;return t===void 0&&(t="margin"),`
  .`.concat(nW,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(u,"px ").concat(n,`;
  }
  body[`).concat(th,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(n,";"),t==="margin"&&`
    padding-left: `.concat(s,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(c,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(u,"px ").concat(n,`;
    `),t==="padding"&&"padding-right: ".concat(u,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Yv,` {
    right: `).concat(u,"px ").concat(n,`;
  }
  
  .`).concat(Jv,` {
    margin-right: `).concat(u,"px ").concat(n,`;
  }
  
  .`).concat(Yv," .").concat(Yv,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(Jv," .").concat(Jv,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(th,`] {
    `).concat(sW,": ").concat(u,`px;
  }
`)},a1=function(){var r=parseInt(document.body.getAttribute(th)||"0",10);return isFinite(r)?r:0},EW=function(){w.useEffect(function(){return document.body.setAttribute(th,(a1()+1).toString()),function(){var r=a1()-1;r<=0?document.body.removeAttribute(th):document.body.setAttribute(th,r.toString())}},[])},SW=function(r){var e=r.noRelative,t=r.noImportant,n=r.gapMode,s=n===void 0?"margin":n;EW();var i=w.useMemo(function(){return wW(s)},[s]);return w.createElement(bW,{styles:_W(i,!e,s,t?"":"!important")})},Sb=!1;if(typeof window<"u")try{var Av=Object.defineProperty({},"passive",{get:function(){return Sb=!0,!0}});window.addEventListener("test",Av,Av),window.removeEventListener("test",Av,Av)}catch{Sb=!1}var Lf=Sb?{passive:!1}:!1,CW=function(r){return r.tagName==="TEXTAREA"},HA=function(r,e){if(!(r instanceof Element))return!1;var t=window.getComputedStyle(r);return t[e]!=="hidden"&&!(t.overflowY===t.overflowX&&!CW(r)&&t[e]==="visible")},kW=function(r){return HA(r,"overflowY")},NW=function(r){return HA(r,"overflowX")},l1=function(r,e){var t=e.ownerDocument,n=e;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var s=BA(r,n);if(s){var i=GA(r,n),c=i[1],u=i[2];if(c>u)return!0}n=n.parentNode}while(n&&n!==t.body);return!1},TW=function(r){var e=r.scrollTop,t=r.scrollHeight,n=r.clientHeight;return[e,t,n]},RW=function(r){var e=r.scrollLeft,t=r.scrollWidth,n=r.clientWidth;return[e,t,n]},BA=function(r,e){return r==="v"?kW(e):NW(e)},GA=function(r,e){return r==="v"?TW(e):RW(e)},AW=function(r,e){return r==="h"&&e==="rtl"?-1:1},IW=function(r,e,t,n,s){var i=AW(r,window.getComputedStyle(e).direction),c=i*n,u=t.target,p=e.contains(u),m=!1,g=c>0,x=0,b=0;do{if(!u)break;var E=GA(r,u),T=E[0],S=E[1],N=E[2],R=S-N-i*T;(T||R)&&BA(r,u)&&(x+=R,b+=T);var A=u.parentNode;u=A&&A.nodeType===Node.DOCUMENT_FRAGMENT_NODE?A.host:A}while(!p&&u!==document.body||p&&(e.contains(u)||e===u));return(g&&Math.abs(x)<1||!g&&Math.abs(b)<1)&&(m=!0),m},Iv=function(r){return"changedTouches"in r?[r.changedTouches[0].clientX,r.changedTouches[0].clientY]:[0,0]},c1=function(r){return[r.deltaX,r.deltaY]},u1=function(r){return r&&"current"in r?r.current:r},PW=function(r,e){return r[0]===e[0]&&r[1]===e[1]},FW=function(r){return`
  .block-interactivity-`.concat(r,` {pointer-events: none;}
  .allow-interactivity-`).concat(r,` {pointer-events: all;}
`)},jW=0,Mf=[];function OW(r){var e=w.useRef([]),t=w.useRef([0,0]),n=w.useRef(),s=w.useState(jW++)[0],i=w.useState(zA)[0],c=w.useRef(r);w.useEffect(function(){c.current=r},[r]),w.useEffect(function(){if(r.inert){document.body.classList.add("block-interactivity-".concat(s));var S=zM([r.lockRef.current],(r.shards||[]).map(u1),!0).filter(Boolean);return S.forEach(function(N){return N.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),S.forEach(function(N){return N.classList.remove("allow-interactivity-".concat(s))})}}},[r.inert,r.lockRef.current,r.shards]);var u=w.useCallback(function(S,N){if("touches"in S&&S.touches.length===2||S.type==="wheel"&&S.ctrlKey)return!c.current.allowPinchZoom;var R=Iv(S),A=t.current,j="deltaX"in S?S.deltaX:A[0]-R[0],P="deltaY"in S?S.deltaY:A[1]-R[1],M,B=S.target,U=Math.abs(j)>Math.abs(P)?"h":"v";if("touches"in S&&U==="h"&&B.type==="range")return!1;var V=window.getSelection(),Y=V&&V.anchorNode,ce=Y?Y===B||Y.contains(B):!1;if(ce)return!1;var X=l1(U,B);if(!X)return!0;if(X?M=U:(M=U==="v"?"h":"v",X=l1(U,B)),!X)return!1;if(!n.current&&"changedTouches"in S&&(j||P)&&(n.current=M),!M)return!0;var de=n.current||M;return IW(de,N,S,de==="h"?j:P)},[]),p=w.useCallback(function(S){var N=S;if(!(!Mf.length||Mf[Mf.length-1]!==i)){var R="deltaY"in N?c1(N):Iv(N),A=e.current.filter(function(M){return M.name===N.type&&(M.target===N.target||N.target===M.shadowParent)&&PW(M.delta,R)})[0];if(A&&A.should){N.cancelable&&N.preventDefault();return}if(!A){var j=(c.current.shards||[]).map(u1).filter(Boolean).filter(function(M){return M.contains(N.target)}),P=j.length>0?u(N,j[0]):!c.current.noIsolation;P&&N.cancelable&&N.preventDefault()}}},[]),m=w.useCallback(function(S,N,R,A){var j={name:S,delta:N,target:R,should:A,shadowParent:DW(R)};e.current.push(j),setTimeout(function(){e.current=e.current.filter(function(P){return P!==j})},1)},[]),g=w.useCallback(function(S){t.current=Iv(S),n.current=void 0},[]),x=w.useCallback(function(S){m(S.type,c1(S),S.target,u(S,r.lockRef.current))},[]),b=w.useCallback(function(S){m(S.type,Iv(S),S.target,u(S,r.lockRef.current))},[]);w.useEffect(function(){return Mf.push(i),r.setCallbacks({onScrollCapture:x,onWheelCapture:x,onTouchMoveCapture:b}),document.addEventListener("wheel",p,Lf),document.addEventListener("touchmove",p,Lf),document.addEventListener("touchstart",g,Lf),function(){Mf=Mf.filter(function(S){return S!==i}),document.removeEventListener("wheel",p,Lf),document.removeEventListener("touchmove",p,Lf),document.removeEventListener("touchstart",g,Lf)}},[]);var E=r.removeScrollBar,T=r.inert;return w.createElement(w.Fragment,null,T?w.createElement(i,{styles:FW(s)}):null,E?w.createElement(SW,{noRelative:r.noRelative,gapMode:r.gapMode}):null)}function DW(r){for(var e=null;r!==null;)r instanceof ShadowRoot&&(e=r.host,r=r.host),r=r.parentNode;return e}const LW=dW(UA,OW);var EE=w.forwardRef(function(r,e){return w.createElement(s0,Fa({},r,{ref:e,sideCar:LW}))});EE.classNames=s0.classNames;var MW=function(r){if(typeof document>"u")return null;var e=Array.isArray(r)?r[0]:r;return e.ownerDocument.body},$f=new WeakMap,Pv=new WeakMap,Fv={},yw=0,WA=function(r){return r&&(r.host||WA(r.parentNode))},$W=function(r,e){return e.map(function(t){if(r.contains(t))return t;var n=WA(t);return n&&r.contains(n)?n:(console.error("aria-hidden",t,"in not contained inside",r,". Doing nothing"),null)}).filter(function(t){return!!t})},UW=function(r,e,t,n){var s=$W(e,Array.isArray(r)?r:[r]);Fv[t]||(Fv[t]=new WeakMap);var i=Fv[t],c=[],u=new Set,p=new Set(s),m=function(x){!x||u.has(x)||(u.add(x),m(x.parentNode))};s.forEach(m);var g=function(x){!x||p.has(x)||Array.prototype.forEach.call(x.children,function(b){if(u.has(b))g(b);else try{var E=b.getAttribute(n),T=E!==null&&E!=="false",S=($f.get(b)||0)+1,N=(i.get(b)||0)+1;$f.set(b,S),i.set(b,N),c.push(b),S===1&&T&&Pv.set(b,!0),N===1&&b.setAttribute(t,"true"),T||b.setAttribute(n,"true")}catch(R){console.error("aria-hidden: cannot operate on ",b,R)}})};return g(e),u.clear(),yw++,function(){c.forEach(function(x){var b=$f.get(x)-1,E=i.get(x)-1;$f.set(x,b),i.set(x,E),b||(Pv.has(x)||x.removeAttribute(n),Pv.delete(x)),E||x.removeAttribute(t)}),yw--,yw||($f=new WeakMap,$f=new WeakMap,Pv=new WeakMap,Fv={})}},VA=function(r,e,t){t===void 0&&(t="data-aria-hidden");var n=Array.from(Array.isArray(r)?r:[r]),s=MW(r);return s?(n.push.apply(n,Array.from(s.querySelectorAll("[aria-live], script"))),UW(n,s,t,"aria-hidden")):function(){return null}};function zW(r){const e=HW(r),t=w.forwardRef((n,s)=>{const{children:i,...c}=n,u=w.Children.toArray(i),p=u.find(GW);if(p){const m=p.props.children,g=u.map(x=>x===p?w.Children.count(m)>1?w.Children.only(null):w.isValidElement(m)?m.props.children:null:x);return d.jsx(e,{...c,ref:s,children:w.isValidElement(m)?w.cloneElement(m,void 0,g):null})}return d.jsx(e,{...c,ref:s,children:i})});return t.displayName=`${r}.Slot`,t}function HW(r){const e=w.forwardRef((t,n)=>{const{children:s,...i}=t;if(w.isValidElement(s)){const c=VW(s),u=WW(i,s.props);return s.type!==w.Fragment&&(u.ref=n?Yc(n,c):c),w.cloneElement(s,u)}return w.Children.count(s)>1?w.Children.only(null):null});return e.displayName=`${r}.SlotClone`,e}var BW=Symbol("radix.slottable");function GW(r){return w.isValidElement(r)&&typeof r.type=="function"&&"__radixId"in r.type&&r.type.__radixId===BW}function WW(r,e){const t={...e};for(const n in e){const s=r[n],i=e[n];/^on[A-Z]/.test(n)?s&&i?t[n]=(...u)=>{const p=i(...u);return s(...u),p}:s&&(t[n]=s):n==="style"?t[n]={...s,...i}:n==="className"&&(t[n]=[s,i].filter(Boolean).join(" "))}return{...r,...t}}function VW(r){var n,s;let e=(n=Object.getOwnPropertyDescriptor(r.props,"ref"))==null?void 0:n.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=(s=Object.getOwnPropertyDescriptor(r,"ref"))==null?void 0:s.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}var o0="Dialog",[qA]=za(o0),[qW,Zi]=qA(o0),KA=r=>{const{__scopeDialog:e,children:t,open:n,defaultOpen:s,onOpenChange:i,modal:c=!0}=r,u=w.useRef(null),p=w.useRef(null),[m,g]=Jc({prop:n,defaultProp:s??!1,onChange:i,caller:o0});return d.jsx(qW,{scope:e,triggerRef:u,contentRef:p,contentId:Dl(),titleId:Dl(),descriptionId:Dl(),open:m,onOpenChange:g,onOpenToggle:w.useCallback(()=>g(x=>!x),[g]),modal:c,children:t})};KA.displayName=o0;var YA="DialogTrigger",KW=w.forwardRef((r,e)=>{const{__scopeDialog:t,...n}=r,s=Zi(YA,t),i=Mn(e,s.triggerRef);return d.jsx(jr.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":kE(s.open),...n,ref:i,onClick:Pt(r.onClick,s.onOpenToggle)})});KW.displayName=YA;var SE="DialogPortal",[YW,JA]=qA(SE,{forceMount:void 0}),XA=r=>{const{__scopeDialog:e,forceMount:t,children:n,container:s}=r,i=Zi(SE,e);return d.jsx(YW,{scope:e,forceMount:t,children:w.Children.map(n,c=>d.jsx(Qi,{present:t||i.open,children:d.jsx(xE,{asChild:!0,container:s,children:c})}))})};XA.displayName=SE;var Ty="DialogOverlay",QA=w.forwardRef((r,e)=>{const t=JA(Ty,r.__scopeDialog),{forceMount:n=t.forceMount,...s}=r,i=Zi(Ty,r.__scopeDialog);return i.modal?d.jsx(Qi,{present:n||i.open,children:d.jsx(XW,{...s,ref:e})}):null});QA.displayName=Ty;var JW=zW("DialogOverlay.RemoveScroll"),XW=w.forwardRef((r,e)=>{const{__scopeDialog:t,...n}=r,s=Zi(Ty,t);return d.jsx(EE,{as:JW,allowPinchZoom:!0,shards:[s.contentRef],children:d.jsx(jr.div,{"data-state":kE(s.open),...n,ref:e,style:{pointerEvents:"auto",...n.style}})})}),sd="DialogContent",ZA=w.forwardRef((r,e)=>{const t=JA(sd,r.__scopeDialog),{forceMount:n=t.forceMount,...s}=r,i=Zi(sd,r.__scopeDialog);return d.jsx(Qi,{present:n||i.open,children:i.modal?d.jsx(QW,{...s,ref:e}):d.jsx(ZW,{...s,ref:e})})});ZA.displayName=sd;var QW=w.forwardRef((r,e)=>{const t=Zi(sd,r.__scopeDialog),n=w.useRef(null),s=Mn(e,t.contentRef,n);return w.useEffect(()=>{const i=n.current;if(i)return VA(i)},[]),d.jsx(eI,{...r,ref:s,trapFocus:t.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Pt(r.onCloseAutoFocus,i=>{var c;i.preventDefault(),(c=t.triggerRef.current)==null||c.focus()}),onPointerDownOutside:Pt(r.onPointerDownOutside,i=>{const c=i.detail.originalEvent,u=c.button===0&&c.ctrlKey===!0;(c.button===2||u)&&i.preventDefault()}),onFocusOutside:Pt(r.onFocusOutside,i=>i.preventDefault())})}),ZW=w.forwardRef((r,e)=>{const t=Zi(sd,r.__scopeDialog),n=w.useRef(!1),s=w.useRef(!1);return d.jsx(eI,{...r,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var c,u;(c=r.onCloseAutoFocus)==null||c.call(r,i),i.defaultPrevented||(n.current||(u=t.triggerRef.current)==null||u.focus(),i.preventDefault()),n.current=!1,s.current=!1},onInteractOutside:i=>{var p,m;(p=r.onInteractOutside)==null||p.call(r,i),i.defaultPrevented||(n.current=!0,i.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const c=i.target;((m=t.triggerRef.current)==null?void 0:m.contains(c))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&s.current&&i.preventDefault()}})}),eI=w.forwardRef((r,e)=>{const{__scopeDialog:t,trapFocus:n,onOpenAutoFocus:s,onCloseAutoFocus:i,...c}=r,u=Zi(sd,t),p=w.useRef(null),m=Mn(e,p);return MA(),d.jsxs(d.Fragment,{children:[d.jsx(_E,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:s,onUnmountAutoFocus:i,children:d.jsx(t0,{role:"dialog",id:u.contentId,"aria-describedby":u.descriptionId,"aria-labelledby":u.titleId,"data-state":kE(u.open),...c,ref:m,onDismiss:()=>u.onOpenChange(!1)})}),d.jsxs(d.Fragment,{children:[d.jsx(e9,{titleId:u.titleId}),d.jsx(r9,{contentRef:p,descriptionId:u.descriptionId})]})]})}),CE="DialogTitle",tI=w.forwardRef((r,e)=>{const{__scopeDialog:t,...n}=r,s=Zi(CE,t);return d.jsx(jr.h2,{id:s.titleId,...n,ref:e})});tI.displayName=CE;var rI="DialogDescription",nI=w.forwardRef((r,e)=>{const{__scopeDialog:t,...n}=r,s=Zi(rI,t);return d.jsx(jr.p,{id:s.descriptionId,...n,ref:e})});nI.displayName=rI;var sI="DialogClose",oI=w.forwardRef((r,e)=>{const{__scopeDialog:t,...n}=r,s=Zi(sI,t);return d.jsx(jr.button,{type:"button",...n,ref:e,onClick:Pt(r.onClick,()=>s.onOpenChange(!1))})});oI.displayName=sI;function kE(r){return r?"open":"closed"}var iI="DialogTitleWarning",[jK,aI]=bB(iI,{contentName:sd,titleName:CE,docsSlug:"dialog"}),e9=({titleId:r})=>{const e=aI(iI),t=`\`${e.contentName}\` requires a \`${e.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${e.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${e.docsSlug}`;return w.useEffect(()=>{r&&(document.getElementById(r)||console.error(t))},[t,r]),null},t9="DialogDescriptionWarning",r9=({contentRef:r,descriptionId:e})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${aI(t9).contentName}}.`;return w.useEffect(()=>{var i;const s=(i=r.current)==null?void 0:i.getAttribute("aria-describedby");e&&s&&(document.getElementById(e)||console.warn(n))},[n,r,e]),null},n9=KA,s9=XA,lI=QA,cI=ZA,uI=tI,dI=nI,o9=oI;const i9=n9,a9=s9,fI=w.forwardRef(({className:r,...e},t)=>d.jsx(lI,{ref:t,className:Rr("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",r),...e}));fI.displayName=lI.displayName;const hI=w.forwardRef(({className:r,children:e,...t},n)=>d.jsxs(a9,{children:[d.jsx(fI,{}),d.jsxs(cI,{ref:n,className:Rr("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",r),...t,children:[e,d.jsxs(o9,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[d.jsx(gi,{className:"h-4 w-4"}),d.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));hI.displayName=cI.displayName;const pI=({className:r,...e})=>d.jsx("div",{className:Rr("flex flex-col space-y-1.5 text-center sm:text-left",r),...e});pI.displayName="DialogHeader";const mI=({className:r,...e})=>d.jsx("div",{className:Rr("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",r),...e});mI.displayName="DialogFooter";const gI=w.forwardRef(({className:r,...e},t)=>d.jsx(uI,{ref:t,className:Rr("text-lg font-semibold leading-none tracking-tight",r),...e}));gI.displayName=uI.displayName;const vI=w.forwardRef(({className:r,...e},t)=>d.jsx(dI,{ref:t,className:Rr("text-sm text-muted-foreground",r),...e}));vI.displayName=dI.displayName;const l9=({isOpen:r,onClose:e,title:t="Gmail Connection Required",description:n="This feature requires an active Gmail connection. Please connect your Gmail account to continue.",actionText:s="the requested action"})=>{const[i,c]=w.useState(!1),{initiateReconnection:u,wasEverConnected:p}=Ji(),m=async()=>{c(!0);try{await u(),e()}catch(g){console.error("Failed to reconnect Gmail:",g)}finally{c(!1)}};return d.jsx(i9,{open:r,onOpenChange:e,children:d.jsxs(hI,{className:"sm:max-w-md",children:[d.jsxs(pI,{children:[d.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[d.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:d.jsx(Wc,{className:"h-5 w-5 text-blue-600"})}),d.jsx(gI,{className:"text-lg font-semibold",children:t})]}),d.jsx(vI,{className:"text-sm text-gray-600 leading-relaxed",children:n})]}),d.jsx("div",{className:"bg-gray-50 rounded-lg p-4 my-4",children:d.jsxs("div",{className:"flex items-start gap-3",children:[d.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full mt-2 flex-shrink-0"}),d.jsxs("div",{className:"text-sm text-gray-700",children:[d.jsx("p",{className:"font-medium mb-1",children:"What happens next:"}),d.jsxs("p",{children:["You'll be redirected to Gmail's authorization page to ",p?"reconnect":"connect"," your account securely."]})]})]})}),d.jsxs(mI,{className:"flex gap-2 sm:gap-2",children:[d.jsx($e,{variant:"outline",onClick:e,disabled:i,className:"flex-1",children:"Cancel"}),d.jsx($e,{onClick:m,disabled:i,className:"flex-1 bg-blue-600 hover:bg-blue-700",children:i?d.jsxs(d.Fragment,{children:[d.jsx(Co,{className:"h-4 w-4 mr-2 animate-spin"}),"Connecting..."]}):p?"Reconnect Gmail":"Connect Gmail"})]})]})})},tn="src/shared/components/sidepanel/panels/GenerateEmailDraftPanel.tsx",c9=()=>`The response should just be the email body with salutation at the beginning. Do not include a subject line in your response draft. 
    Do not add links to the references in your response draft. Do not add citation numbers in your response draft.
    Do not list the references in your response draft, since they will be added in a different section in the JSON response.
    Do not add a complimentary closing or a signature as this will be added later.`.trim(),u9=(r,e,t)=>{let n="";switch(r){case"Casual":n+="Keep the tone casual. ";break;case"Neutral":n+="Maintain a neutral tone. ";break;case"Formal":n+="Keep the tone formal. ";break}switch(e){case"Low":n+="Show low empathy. ";break;case"Neutral":n+="Maintain neutral empathy. ";break;case"High":n+="Show high empathy. ";break}switch(t){case"Simple":n+="Keep it simple amd use simple words. ";break;case"Neutral":n+="Maintain neutral complexity. ";break;case"Detailed":n+="Provide detailed information and you're free to use harder words. ";break}return n.trim()},d9=({clientEmail:r})=>{const e=Ur(),t=Hl(),n=id(),s=ln().platform,{isConnected:i,wasEverConnected:c}=Ji(),[u,p]=w.useState(!1),[m,g]=w.useState(!1),[x,b]=w.useState(""),E=w.useRef(null),[T,S]=w.useState(!0),[N,R]=w.useState(""),[A,j]=w.useState([]),[P,M]=w.useState(0),[B,U]=w.useState(""),[V,Y]=w.useState(!1),[ce,X]=w.useState(!0),[de,we]=w.useState(!0),[le,se]=w.useState(!0),[me,te]=w.useState(null),[G,z]=w.useState(null),[J,D]=w.useState([]),$=w.useRef(null),[ne,_e]=w.useState(""),[q,ie]=w.useState("Neutral"),[xe,ye]=w.useState("Neutral"),[ue,ke]=w.useState("Neutral"),He=w.useRef(null),[Ue,Le]=w.useState(!1),[Ne,gt]=w.useState(!1),[zt,yt]=w.useState([]),[Zt,Bt]=w.useState(!0),[or,st]=w.useState(!1),Ft="25dc68db26595a7485917129d6993f96",er="c1c8e460f2105029b2b4563f9222161c",Ae=["Analyzing email thread...","Pulling relevant information...","Structuring your response...","Preparing personalized reply...","Finalizing your draft..."],Ze=w.useCallback(async lt=>{const kt="fetchFromStorageProvider";if(!t)return"";try{const Nt=await t.getLocalItem(lt);return Nt&&e.debug("Loaded additional context from storage",{sourceFile:tn,functionName:kt}),Nt||""}catch(Nt){return e.error("Error loading additional context from storage",Nt,{sourceFile:tn,functionName:kt}),""}},[t,e]);w.useEffect(()=>{let lt;const kt=()=>{if(u){const Nt=Math.floor(Math.random()*2e3)+1e3;lt=setTimeout(()=>{M(ze=>(ze+1)%Ae.length),kt()},Nt)}};return u&&kt(),()=>{lt&&clearTimeout(lt)}},[u,Ae.length]),w.useEffect(()=>{const lt="useEffect[threadDataListener]";if(!n){e.debug("DataProvider not available yet",{sourceFile:tn,functionName:lt});return}const kt=async ze=>{const vr=ze!==null&&ze.threadId!==$.current;if(ze){if(e.debug("Thread changed via platform abstraction",{sourceFile:tn,functionName:lt,threadId:ze.threadId,isThreadChanged:vr}),z(ze.threadId),console.log("Thread changed via platform abstraction",{sourceFile:tn,functionName:lt,thread:ze}),D(ze.participants||[]),ze.messages&&Array.isArray(ze.messages)&&ze.messages.length>0&&ze.messages[0]&&typeof ze.messages[0]=="object"){const Or=ze.messages.map((mn,cn)=>({body:mn.body||mn.html||"",html:mn.html||mn.body||"",from:mn.from||"",timestamp:mn.timestamp||"",subject:cn===0&&ze.subject||""}));te(Or);const sn=Or.length>0?dw(Or[0].body):"";U(sn)}vr&&(R(""),j([]),yt([]),g(!1),p(!1)),$.current=ze.threadId;const zr=`additionalContext_${ze.threadId}`;_e(await Ze(zr))}else{e.debug("Thread cleared via platform abstraction",{sourceFile:tn,functionName:lt});const zr=$.current!==null;z(null),te(null),D([]),U(""),R(""),j([]),yt([]),g(!1),p(!1),zr&&(_e(""),$.current=null)}};return n.onThreadChanged(kt),(async()=>{try{const ze=await n.getCurrentThread();await kt(ze)}catch(ze){e.error("Error loading current thread",ze,{sourceFile:tn,functionName:"loadCurrentThread"})}})(),()=>{n.removeThreadListener(kt)}},[n,e]),w.useEffect(()=>{const kt=setTimeout(async()=>{const Nt="useEffect[saveAdditionalContext]";if(!(!G||!t))try{const ze=`additionalContext_${G}`;await t.setLocalItem(ze,ne)}catch(ze){e.error("Error saving additional context to storage",ze,{sourceFile:tn,functionName:Nt,threadId:G})}},500);return()=>clearTimeout(kt)},[ne,G,t,e]);const dt=w.useCallback(async lt=>{try{if(!G)return e.debug("No thread ID available for cache check",{sourceFile:tn,functionName:lt}),!1;const kt=rt(G),Nt=await K5(kt,e);return Nt?(e.debug("Found cached response for thread",{sourceFile:tn,functionName:lt,cacheKey:kt,threadId:G}),R(Nt.response),j(Nt.references),yt(Nt.cmsData),p(!1),g(!0),!0):(e.debug("No cached response found for thread",{sourceFile:tn,functionName:lt,cacheKey:kt,threadId:G}),!1)}catch(kt){return e.warn("Error checking for cached response",{sourceFile:tn,functionName:lt,error:kt}),!1}},[G,e]);w.useEffect(()=>{const kt=setTimeout(async()=>{const Nt="checkForCachedResponse";!G||N||u||await dt(Nt)},500);return()=>clearTimeout(kt)},[G,dt,N,u]),w.useEffect(()=>{(async()=>{const kt="checkCachedResponseOnReady";T||!G||!me||N||u||(e.debug("Component ready, checking for cached response immediately",{sourceFile:tn,functionName:kt,threadId:G,hasThreadData:!!me,isLoading:T,hasResponse:!!N}),await dt(kt))})()},[T,G,me,dt,N,u,e]),w.useEffect(()=>{if(m&&E.current){const lt=setTimeout(()=>{var kt;(kt=E.current)==null||kt.focus()},100);return()=>clearTimeout(lt)}},[m]),w.useEffect(()=>{const lt=async()=>{try{if(!t)return;const ze=await t.getLocalItem("useUscis");Le(ze??!1),e.debug("uscisIsEnabled loaded from storage via platform abstraction",{sourceFile:tn,functionName:"initializeUscisState",uscisEnabled:ze??!1})}catch(ze){e.error("Error loading USCIS state",ze,{sourceFile:tn,functionName:"initializeUscisState"})}},kt=async()=>{try{if(!t)return;const ze=await t.getLocalItem("useOregon");gt(ze??!1),e.debug("oregonIsEnabled loaded from storage via platform abstraction",{sourceFile:tn,functionName:"initializeOregonState",oregonEnabled:ze??!1})}catch(ze){e.error("Error loading Oregon state",ze,{sourceFile:tn,functionName:"initializeOregonState"})}},Nt=async ze=>{try{ze.useUscis!==void 0&&(Le(ze.useUscis),e.debug("USCIS setting changed via platform abstraction",{sourceFile:tn,functionName:"handleStorageChange",useUscis:ze.useUscis})),ze.useOregon!==void 0&&(gt(ze.useOregon),e.debug("Oregon setting changed via platform abstraction",{sourceFile:tn,functionName:"handleStorageChange",useOregon:ze.useOregon}))}catch(vr){e.error("Error handling storage changes",vr,{sourceFile:tn,functionName:"handleStorageChange"})}};return lt(),kt(),t!=null&&t.onChanged&&t.onChanged(Nt),S(!1),()=>{t!=null&&t.removeChangeListener&&Nt&&t.removeChangeListener(Nt)}},[t,e]),w.useEffect(()=>{if(N&&He.current){const lt=He.current,Nt=(lt.scrollHeight-lt.clientHeight)*.8;lt.scrollTo({top:Nt,behavior:"smooth"}),e.debug("Scrolling to 90% of bottom after response generation",{sourceFile:tn,functionName:"useEffect[fullResponse]"})}},[N,e]);const rt=lt=>`response_${lt}`,Lt=async(lt,kt)=>{p(!0),R("Reformatting..."),g(!1);const Nt="regenerateResponse";try{if(!G){e.error("Thread ID is not set for regeneration",void 0,{sourceFile:tn,functionName:Nt}),p(!1);return}const ze=rt(G),vr=await e8(kt,lt,e);R(vr),p(!1),g(!0),await xC(ze,vr,[],[],e)}catch(ze){e.error("Error regenerating response",ze,{sourceFile:tn,functionName:Nt}),p(!1),g(!0)}},gr=async()=>{if(s==="chrome"&&!i){st(!0);return}p(!0),g(!1);const lt="handleGenerateResponse";try{const kt=(me==null?void 0:me.map(cn=>`From: ${cn.from}
Timestamp: ${cn.timestamp}
Body: ${dw(cn.body)}

`).join(""))||"",Nt=[];if(Ue&&Nt.push(Ft),Ne&&Nt.push(er),!G){e.error("Thread ID is not set",void 0,{sourceFile:tn,functionName:lt}),p(!1);return}const ze=u9(q,xe,ue),vr=c9(),zr=rt(G);let Or;s==="outlook"?Or=await Z6(G,kt,ne,ze,vr,J,e):Or=await Q6(G,kt,ne,ze,vr,Nt,e);const sn=Or.response,mn=Eb(sn);R(mn),j(Or.references),yt(Or.cms_data||[]),p(!1),g(!0),await xC(zr,mn,Or.references,Or.cms_data||[],e)}catch(kt){e.error("Error generating response",kt,{sourceFile:tn,functionName:lt}),p(!1)}};return s==="chrome"&&!i?d.jsx("div",{className:"p-4",children:d.jsx(bE,{feature:"Email Composition",description:"Connect your Gmail account to generate personalized email responses",benefits:["Analyze email threads and context automatically","Generate contextually relevant responses","Insert generated content directly into compose box"]})}):d.jsxs("div",{className:"space-y-4 h-full overflow-y-auto overflow-x-hidden",ref:He,children:[d.jsxs(fi,{className:"overflow-hidden shadow-sm mb-4",children:[d.jsx(Gi,{className:"p-3 border-b dark:border-border cursor-pointer",onClick:()=>we(!de),children:d.jsxs("div",{className:"flex items-center justify-between w-full",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx(Wi,{className:"text-sm font-semibold pr-1",children:"Current Email"}),d.jsxs("div",{className:"relative group",children:[d.jsx(Oc,{src:"/icons/info-circled.svg",width:16,height:16,alt:"Info",className:"h-4 w-4 text-muted-foreground dark:brightness-0 dark:invert"}),d.jsx("div",{className:"absolute left-0 top-full mt-2 w-48 p-2 bg-white dark:bg-gray-800 text-black dark:text-white text-xs rounded shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-opacity z-50 border dark:border-border",children:"This is the email Candle AI is responding to."})]})]}),d.jsx(Oc,{src:"/icons/chevron-down.svg",width:20,height:20,alt:"Chevron down",className:`h-5 w-5 text-muted-foreground dark:brightness-0 dark:invert transition-transform duration-200 ${de?"transform rotate-180":""}`})]})}),de&&d.jsx(hi,{className:"p-0.5",children:d.jsx("textarea",{value:T?"Loading...":me?dw(me[0].body):s==="chrome"&&!i?"Gmail disconnected. Connect Gmail to view email content.":"Please select an email thread",disabled:!0,className:"w-full border dark:border-border rounded p-4 min-h-[100px] text-xs bg-white dark:bg-card text-gray-900 dark:text-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400"})})]}),d.jsxs(fi,{className:"overflow-hidden shadow-sm mb-4",children:[d.jsx(Gi,{className:"p-3 border-b dark:border-border cursor-pointer",onClick:()=>X(!ce),children:d.jsxs("div",{className:"flex items-center justify-between w-full",children:[d.jsx(Wi,{className:"text-sm font-semibold",children:"Anything specific you want the response to include?"}),d.jsx(Oc,{src:"/icons/chevron-down.svg",width:20,height:20,alt:"Chevron down",className:`h-5 w-5 text-muted-foreground dark:brightness-0 dark:invert transition-transform duration-200 ${ce?"transform rotate-180":""}`})]})}),ce&&d.jsx(hi,{className:"p-0.5",children:d.jsx("textarea",{className:"w-full border dark:border-border rounded p-4 min-h-[100px] text-sm bg-white dark:bg-card text-gray-900 dark:text-gray-200 placeholder:text-gray-400 dark:placeholder:text-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400",placeholder:`Examples: 'This client's visa is expiring soon. Suggest they renew it soon.'
'Respond in Spanish.'`,value:ne,onChange:lt=>_e(lt.target.value)})})]}),d.jsxs(fi,{className:"overflow-hidden shadow-sm mb-4",children:[d.jsx(Gi,{className:"p-3 border-b dark:border-border cursor-pointer",onClick:()=>Y(!V),children:d.jsxs("div",{className:"flex items-center justify-between w-full",children:[d.jsx(Wi,{className:"text-sm font-semibold",children:"Tone"}),d.jsx(Oc,{src:"/icons/chevron-down.svg",width:20,height:20,alt:"Chevron down",className:`h-5 w-5 text-muted-foreground dark:brightness-0 dark:invert transition-transform duration-200 ${V?"transform rotate-180":""}`})]})}),V&&d.jsxs(hi,{className:"p-4 space-y-4",children:[d.jsxs("div",{className:"space-y-2",children:[d.jsx("p",{className:"text-xs font-semibold text-neutral-700 dark:text-gray-300",children:"Formality"}),d.jsx(sw,{options:["Casual","Neutral","Formal"],value:q,onChange:ie})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx("p",{className:"text-xs font-semibold text-neutral-700 dark:text-gray-300",children:"Empathy"}),d.jsx(sw,{options:["Low","Neutral","High"],value:xe,onChange:ye})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx("p",{className:"text-xs font-semibold text-neutral-700 dark:text-gray-300",children:"Complexity"}),d.jsx(sw,{options:["Simple","Neutral","Detailed"],value:ue,onChange:ke})]})]})]}),d.jsx($e,{className:"w-full bg-blue-600 hover:bg-blue-700 text-white py-4 mt-2",onClick:gr,disabled:u||!G&&s!=="chrome"||s==="chrome"&&!i&&!G,children:u?"Generating...":s==="chrome"&&!i?"Connect Gmail to Generate Response":G?"Generate Response":"Select a thread"}),u&&d.jsxs("div",{className:"flex flex-col items-center justify-center",children:[d.jsx(qi,{className:"h-8 w-8 animate-spin text-blue-600"}),d.jsx("p",{className:"mt-2 text-sm text-gray-500",children:Ae[P]})]}),d.jsxs("div",{className:"mb-24",children:[d.jsx(l9,{isOpen:or,onClose:()=>st(!1),title:"Gmail Connection Required",description:"Generate Response requires an active Gmail connection to analyze your email thread and create personalized responses.",actionText:"generate email responses"}),N&&!u&&d.jsxs(fi,{className:"animate-slide-fade-in mb-2 origin-top",children:[d.jsx(Gi,{className:"p-3 border-b dark:border-border cursor-pointer",children:d.jsxs(Wi,{className:"flex items-center py-0 my-0 text-sm font-semibold",children:[d.jsx(Oc,{src:"/icons/email-icon.svg",width:16,height:16,alt:"Generated Response",className:"h-4 w-4 text-muted-foreground dark:brightness-0 dark:invert mr-2"}),d.jsx("p",{className:"text-sm font-semibold",children:"Generated Response"}),d.jsxs($e,{className:"ml-auto bg-blue-600 hover:bg-blue-700 text-white",size:"sm",onClick:()=>{IA(Eb(N),e)},children:[d.jsx(KR,{className:"w-4 h-4 flex-shrink-0 mr-1 rotate-90"}),"Insert"]})]})}),d.jsx(hi,{className:"p-6",children:d.jsx(q7,{htmlString:N})})]}),m&&d.jsx("div",{className:"animate-fadeIn mb-2",children:d.jsxs("div",{className:"rounded-lg border-2 border-neutral-200 dark:border-border bg-neutral-50/50 dark:bg-card/50 overflow-hidden transition-all duration-200 focus-within:!border-blue-500 dark:focus-within:!border-blue-400 focus-within:ring-2 focus-within:ring-blue-500/20 dark:focus-within:ring-blue-400/20 focus-within:bg-white dark:focus-within:bg-card",children:[d.jsx("div",{className:"p-3 bg-white dark:bg-card",children:d.jsx(DA,{ref:E,placeholder:"Customize this response",value:x,className:"text-sm w-full bg-transparent text-gray-900 dark:text-gray-200 !border-0 !ring-0 !outline-none focus:!border-0 focus:!ring-0 focus:!outline-none focus-visible:!ring-0 focus-visible:!ring-offset-0 focus-visible:!outline-none min-h-[40px] max-h-40 py-0 px-0 placeholder:text-neutral-400 dark:placeholder:text-gray-500 resize-none",onChange:lt=>b(lt.target.value),onKeyDown:lt=>{lt.key==="Enter"&&!lt.shiftKey&&x.trim()&&(lt.preventDefault(),Lt(x,N),b(""))}})}),d.jsx("div",{className:"h-[1px] bg-neutral-200 dark:bg-border"}),d.jsxs("div",{className:"flex gap-0 bg-white dark:bg-card border-t dark:border-border",children:[d.jsx($e,{onClick:()=>{Lt("More empathetic",N)},variant:"ghost",className:"flex-1 rounded-none text-xs text-neutral-700 dark:text-gray-300 hover:bg-neutral-50 dark:hover:bg-muted py-2.5 h-auto font-normal",children:"More empathetic"}),d.jsx("div",{className:"w-[1px] bg-neutral-200 dark:bg-border my-1.5"}),d.jsx($e,{onClick:()=>{Lt("Make it shorter",N)},variant:"ghost",className:"flex-1 rounded-none text-xs text-neutral-700 dark:text-gray-300 hover:bg-neutral-50 dark:hover:bg-muted py-2.5 h-auto font-normal",children:"Make it shorter"}),d.jsx("div",{className:"w-[1px] bg-neutral-200 dark:bg-border my-1.5"}),d.jsx($e,{onClick:()=>{x&&(Lt(x,N),b(""))},disabled:!x.trim(),size:"icon",className:"h-auto w-12 rounded-none bg-blue-600 text-white hover:bg-blue-700 disabled:bg-blue-600/50 disabled:text-white/90 disabled:cursor-not-allowed transition-all duration-200",children:d.jsx(oB,{className:"h-4 w-4"})})]})]})})]})]})},f9=()=>{const[r,e]=w.useState(!1),t=Hl(),n=Ur(),s=PT();w.useEffect(()=>{n.info("LoginPanel component loaded",{sourceFile:"src/sidepanel/panels/LoginPanel.tsx"});const c=u=>{u.token&&(e(!1),n.info("Token detected in storage, auth state will be updated automatically",{sourceFile:"src/sidepanel/panels/LoginPanel.tsx"}))};return t!=null&&t.onChanged&&t.onChanged(c),()=>{t!=null&&t.removeChangeListener&&t.removeChangeListener(c)}},[t,n]);const i=async()=>{n.info("Login button clicked",{sourceFile:"src/sidepanel/panels/LoginPanel.tsx"}),e(!0);try{await s.login(),n.info("Login completed successfully",{sourceFile:"src/sidepanel/panels/LoginPanel.tsx"}),e(!1)}catch(c){n.error("Login failed",c,{sourceFile:"src/sidepanel/panels/LoginPanel.tsx"}),e(!1)}};return d.jsxs("div",{className:"flex flex-col items-center justify-center h-full px-6 bg-gradient-to-b from-blue-50/30 to-white dark:from-gray-900 dark:to-gray-950 animate-fade-in",children:[d.jsx("div",{className:"flex items-center justify-center max-w-md w-full mb-8",children:d.jsxs("svg",{width:"400",height:"200",viewBox:"0 0 400 300",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"w-full h-auto max-h-[200px] drop-shadow-lg",children:[d.jsxs("defs",{children:[d.jsxs("linearGradient",{id:"emailGradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[d.jsx("stop",{offset:"0%",style:{stopColor:"#EEF2FF",stopOpacity:1}}),d.jsx("stop",{offset:"100%",style:{stopColor:"#E0E7FF",stopOpacity:1}})]}),d.jsxs("linearGradient",{id:"glowGradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[d.jsx("stop",{offset:"0%",style:{stopColor:"#818CF8",stopOpacity:.6}}),d.jsx("stop",{offset:"100%",style:{stopColor:"#4F46E5",stopOpacity:.3}})]}),d.jsxs("filter",{id:"glow",children:[d.jsx("feGaussianBlur",{stdDeviation:"4",result:"coloredBlur"}),d.jsxs("feMerge",{children:[d.jsx("feMergeNode",{in:"coloredBlur"}),d.jsx("feMergeNode",{in:"SourceGraphic"})]})]})]}),d.jsx("circle",{cx:"200",cy:"150",r:"120",fill:"url(#glowGradient)",opacity:"0.3",className:"animate-pulse-slow"}),d.jsx("circle",{cx:"200",cy:"150",r:"80",fill:"url(#glowGradient)",opacity:"0.2",className:"animate-pulse-slow",style:{animationDelay:"0.5s"}}),d.jsxs("g",{className:"animate-float",children:[d.jsx("rect",{x:"100",y:"80",width:"200",height:"140",rx:"8",fill:"url(#emailGradient)",stroke:"#6366F1",strokeWidth:"2"}),d.jsx("line",{x1:"120",y1:"110",x2:"240",y2:"110",stroke:"#94A3B8",strokeWidth:"2",strokeLinecap:"round"}),d.jsx("line",{x1:"120",y1:"130",x2:"260",y2:"130",stroke:"#94A3B8",strokeWidth:"2",strokeLinecap:"round"}),d.jsx("line",{x1:"120",y1:"150",x2:"230",y2:"150",stroke:"#94A3B8",strokeWidth:"2",strokeLinecap:"round"}),d.jsx("line",{x1:"120",y1:"170",x2:"250",y2:"170",stroke:"#94A3B8",strokeWidth:"2",strokeLinecap:"round"}),d.jsx("line",{x1:"120",y1:"190",x2:"210",y2:"190",stroke:"#94A3B8",strokeWidth:"2",strokeLinecap:"round"})]}),d.jsxs("g",{className:"animate-sparkle",children:[d.jsx("circle",{cx:"80",cy:"60",r:"4",fill:"#818CF8",filter:"url(#glow)"}),d.jsx("path",{d:"M 80 50 L 82 58 L 90 60 L 82 62 L 80 70 L 78 62 L 70 60 L 78 58 Z",fill:"#818CF8",filter:"url(#glow)"})]}),d.jsxs("g",{className:"animate-sparkle",style:{animationDelay:"0.7s"},children:[d.jsx("circle",{cx:"320",cy:"80",r:"3",fill:"#4F46E5",filter:"url(#glow)"}),d.jsx("path",{d:"M 320 72 L 321.5 78 L 328 80 L 321.5 82 L 320 88 L 318.5 82 L 312 80 L 318.5 78 Z",fill:"#4F46E5",filter:"url(#glow)"})]}),d.jsxs("g",{className:"animate-sparkle",style:{animationDelay:"1.4s"},children:[d.jsx("circle",{cx:"310",cy:"230",r:"3.5",fill:"#818CF8",filter:"url(#glow)"}),d.jsx("path",{d:"M 310 221 L 311.8 227.5 L 319 230 L 311.8 232.5 L 310 239 L 308.2 232.5 L 301 230 L 308.2 227.5 Z",fill:"#818CF8",filter:"url(#glow)"})]}),d.jsxs("g",{className:"animate-sparkle",style:{animationDelay:"0.3s"},children:[d.jsx("circle",{cx:"90",cy:"240",r:"3",fill:"#6366F1",filter:"url(#glow)"}),d.jsx("path",{d:"M 90 233 L 91.5 238 L 97 240 L 91.5 242 L 90 247 L 88.5 242 L 83 240 L 88.5 238 Z",fill:"#6366F1",filter:"url(#glow)"})]}),d.jsxs("g",{className:"animate-sparkle",style:{animationDelay:"1s"},children:[d.jsx("circle",{cx:"320",cy:"150",r:"5",fill:"#4F46E5",filter:"url(#glow)"}),d.jsx("path",{d:"M 320 138 L 323 147 L 333 150 L 323 153 L 320 162 L 317 153 L 307 150 L 317 147 Z",fill:"#4F46E5",filter:"url(#glow)"})]}),d.jsx("circle",{cx:"85",cy:"150",r:"2.5",fill:"#818CF8",opacity:"0.6",className:"animate-sparkle"}),d.jsx("circle",{cx:"315",cy:"200",r:"2",fill:"#6366F1",opacity:"0.5",className:"animate-sparkle",style:{animationDelay:"0.5s"}}),d.jsx("circle",{cx:"280",cy:"70",r:"2",fill:"#4F46E5",opacity:"0.6",className:"animate-sparkle",style:{animationDelay:"1s"}})]})}),d.jsxs("div",{className:"text-center mb-6 space-y-3 animate-slide-up",children:[d.jsxs("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white leading-tight",children:["Legal emails,",d.jsx("br",{}),"effortlessly handled"]}),d.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 max-w-xs mx-auto",children:"AI-powered email assistant for legal professionals"})]}),d.jsx("div",{className:"w-full max-w-xs animate-slide-up",style:{animationDelay:"0.2s"},children:d.jsx($e,{onClick:i,className:"w-full h-12 text-base font-medium shadow-lg hover:shadow-xl transition-all duration-200 hover:scale-[1.02] bg-blue-600 hover:bg-blue-700 dark:bg-blue-600 dark:hover:bg-blue-700",disabled:r,children:r?d.jsxs("span",{className:"flex items-center justify-center gap-2",children:[d.jsxs("svg",{className:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[d.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),d.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Logging in..."]}):"Get Started"})})]})},h9=[{available:!0,id:"gmail",name:"Gmail",description:"Connect your Gmail account to access your email",authMethod:"oauth",authUrl:W_(G_),logo:"/gmail.svg",homeUrl:"https://mail.google.com",isConnected:!1,category:"email"},{available:!0,id:"filevine",name:"Filevine",description:"Connect your Filevine account to access case status",authMethod:"custom",authUrl:"https://identity.filevine.com/",customAuthFields:[{id:"clientId",displayName:"Client ID",type:"text"},{id:"clientSecret",displayName:"Client Secret",type:"text"},{id:"PAT",displayName:"Personal Access Token",type:"text"},{id:"organizationId",displayName:"Organization ID",type:"text"},{id:"userId",displayName:"User ID",type:"text"}],logo:"/filevine.svg",homeUrl:"https://identity.filevine.com/",isConnected:!1,category:"case_management"},{available:!0,id:"clio",name:"Clio",description:"Connect your Clio account to access case status",authMethod:"server",authUrl:V_+"clio",logo:"/clio.svg",homeUrl:"https://app.clio.com",isConnected:!1,category:"case_management"},{available:!1,id:"drive",name:"Google Drive",description:"Connect your Google account to access files on Drive",authMethod:"oauth",authUrl:"/api/auth/google",logo:"/google.svg",homeUrl:"https://drive.google.com",isConnected:!1,category:"data_management"},{available:!1,id:"onedrive",name:"OneDrive",description:"Connect your Microsoft account to access files on OneDrive",authMethod:"oauth",authUrl:"/api/auth/onedrive",logo:"/onedrive.svg",homeUrl:"https://onedrive.live.com",isConnected:!1,category:"data_management"}],yI=[{available:!0,id:"inszoom",name:"INSZoom",description:"Connect your INSZoom account to access case status",authMethod:"custom",authUrl:"https://global.inszoom.com/",logo:"/inszoom.ico",customAuthFields:[{id:"auth_key",displayName:"Authorization Key",type:"text"},{id:"subscription_key",displayName:"Subscription Key",type:"text"},{id:"case_status_report",displayName:"Latest Case Status Report",type:"file"}],homeUrl:"https://global.inszoom.com",isConnected:!1,category:"case_management"},{available:!1,id:"drive",name:"Google Drive",description:"Connect your Google account to access files on Drive",authMethod:"oauth",authUrl:"/api/auth/google",logo:"/google.svg",homeUrl:"https://drive.google.com",isConnected:!1,category:"data_management"},{available:!1,id:"onedrive",name:"OneDrive",description:"Connect your Microsoft account to access files on OneDrive",authMethod:"oauth",authUrl:"/api/auth/onedrive",logo:"/onedrive.svg",homeUrl:"https://onedrive.live.com",isConnected:!1,category:"data_management"}],Cr="src/lib/utils/integrationUtils.tsx";async function NE(r){const e=h9.find(n=>n.id===r);return e||yI.find(n=>n.id===r)||null}async function p9(r){return yI.find(e=>e.id===r)||null}async function xI(r,e,t,n,s){if(e.authMethod==="server")throw new Error("Integration is a server integration which shouldn't be initiated by the extension");r.info("Initiating integration process for integration:",{sourceFile:Cr,integrationId:e});try{let i;if(s&&Object.keys(s).length>0){r.info("Starting file serialization process",{sourceFile:Cr,fileCount:Object.keys(s).length});const u=100*1024*1024;for(const[p,m]of Object.entries(s))if(m.size>u){const g=`File "${m.name}" exceeds 100MB limit. File size: ${(m.size/1048576).toFixed(2)}MB`;throw r.error("File size validation failed",new Error(g),{sourceFile:Cr,fieldId:p,fileName:m.name,fileSize:m.size,maxSize:u}),new Error(g)}i={};for(const[p,m]of Object.entries(s)){const g=await Px(m);r.info("Original file checksum calculated",{sourceFile:Cr,fieldId:p,fileName:m.name,fileSize:m.size,fileType:m.type,originalChecksum:g});const x=await m.arrayBuffer(),b=new Uint8Array(x),E=await Px(x);r.info("ArrayBuffer checksum calculated",{sourceFile:Cr,fieldId:p,fileName:m.name,bufferChecksum:E,bufferSize:x.byteLength,checksumMatch:g===E});let T="";const S=8192;for(let M=0;M<b.length;M+=S){const B=b.slice(M,M+S);T+=String.fromCharCode(...B)}const N=btoa(T),R=atob(N),A=new ArrayBuffer(R.length),j=new Uint8Array(A);for(let M=0;M<R.length;M++)j[M]=R.charCodeAt(M);const P=await Px(A);i[p]={name:m.name,type:m.type,size:m.size,data:N},r.info("File serialization completed",{sourceFile:Cr,fieldId:p,fileName:m.name,fileSize:m.size,base64Length:N.length,originalChecksum:g,bufferChecksum:E,decodedChecksum:P,allChecksumsMatch:g===E&&E===P})}r.info("All files serialized successfully",{sourceFile:Cr,serializedFileCount:Object.keys(i).length})}const c=await Kn.createServices();if(c.messaging.sendMessage){const u=await c.messaging.sendMessage({type:"INITIATE_INTEGRATION",integration:e,authUrl:t,credentials:n,files:i});if(!u.success)throw new Error(u.error||"Integration failed");return r.info("Integration initiated successfully",{sourceFile:Cr}),u.success}else{const u=await chrome.runtime.sendMessage({type:"INITIATE_INTEGRATION",integration:e,authUrl:t,credentials:n,files:i});if(!u.success)throw new Error(u.error||"Integration failed");return r.info("Integration initiated successfully",{sourceFile:Cr}),u.success}}catch(i){throw r.error("Integration failed:",i,{sourceFile:Cr}),i}}async function m9(r,e){try{const t=await Kn.createServices();if(t.messaging.sendMessage){const n=await t.messaging.sendMessage({type:"DISCONNECT_INTEGRATION",integration:e});if(!n.success)throw new Error(n.error||"Disconnection failed");return r.info("Integration disconnected successfully",{sourceFile:Cr}),n.success}else{const n=await chrome.runtime.sendMessage({type:"DISCONNECT_INTEGRATION",integration:e});if(!n.success)throw new Error(n.error||"Disconnection failed");return r.info("Integration disconnected successfully",{sourceFile:Cr}),n.success}}catch(t){throw r.error("Disconnection failed:",t,{sourceFile:Cr}),t}}async function wI(r){const e="isCaseManagementSystemIntegrationConnected";try{r.debug("Starting CMS integration check",{sourceFile:Cr,functionName:e});const t=await Bm(r);r.debug("Local integrations retrieved",{sourceFile:Cr,functionName:e,count:t.length,integrations:t.map(m=>m.integration_type)});const n=t.some(m=>m.integration_type==="filevine"||m.integration_type==="clio"||m.integration_type==="inszoom");if(r.debug("Local CMS integration check result",{sourceFile:Cr,functionName:e,isConnectedLocally:n}),n)return r.info("CMS integration found in local storage",{sourceFile:Cr,functionName:e}),!0;const[s,i]=await Promise.all([Gc("user",r).catch(()=>[]),Gc("tenant",r).catch(()=>[])]),c=s.map(m=>({integration_type:m.integration_type,tenantId_userId:m.tenantId_userId,scope:"user"})),u=i.map(m=>({integration_type:m.integration_type,tenantId_userId:m.tenantId_userId,scope:"tenant"})),p=[...c,...u];return await Hm(r,p),p.some(m=>m.integration_type==="filevine"||m.integration_type==="clio"||m.integration_type==="inszoom");return r.info("Final CMS integration check result",{sourceFile:Cr,functionName:e,isConnectedOnServer}),isConnectedOnServer}catch(t){return r.error("Failed to check if CMS integration is connected",t,{sourceFile:Cr,functionName:e}),!1}}async function g9(r,e){try{if((await Bm(r)).some(m=>m.integration_type===e))return!0;const[s,i]=await Promise.all([Gc("user",r).catch(()=>[]),Gc("tenant",r).catch(()=>[])]),c=s.map(m=>({integration_type:m.integration_type,tenantId_userId:m.tenantId_userId,scope:"user"})),u=i.map(m=>({integration_type:m.integration_type,tenantId_userId:m.tenantId_userId,scope:"tenant"})),p=[...c,...u];return await Hm(r,p),p.some(m=>m.integration_type===e)||!1}catch(t){return r.warn("Failed to check if integration is connected:",{sourceFile:Cr,integrationId:e,error:t}),!1}}async function bI(r){try{r.info("Refreshing integrations from server",{sourceFile:Cr}),await nT(r);const[e,t]=await Promise.all([Gc("user",r).catch(()=>[]),Gc("tenant",r).catch(()=>[])]),n=e.map(c=>({integration_type:c.integration_type,tenantId_userId:c.tenantId_userId,scope:"user"})),s=t.map(c=>({integration_type:c.integration_type,tenantId_userId:c.tenantId_userId,scope:"tenant"})),i=[...n,...s];return await Hm(r,i),r.info("Refreshed integrations from server",{sourceFile:Cr,userCount:n.length,tenantCount:s.length,totalCount:i.length}),!0}catch(e){return r.warn("Failed to refresh integrations:",{sourceFile:Cr,error:e}),!1}}async function _I(r){try{const e=await Bm(r);if(e.length>0)return e;const[t,n]=await Promise.all([Gc("user",r).catch(u=>(r.warn("Failed to fetch user integrations:",{sourceFile:Cr,error:u}),[])),Gc("tenant",r).catch(u=>(r.warn("Failed to fetch tenant integrations:",{sourceFile:Cr,error:u}),[]))]),s=t.map(u=>({...u,scope:"user"})),i=n.map(u=>({...u,scope:"tenant"})),c=[...s,...i];return await Hm(r,c),r.info("Saved merged integrations to local storage",{sourceFile:Cr,userCount:s.length,tenantCount:i.length,totalCount:c.length,integrations:c}),c}catch(e){return r.error("Failed to list integrations:",e,{sourceFile:Cr}),[]}}async function v9(r,e){try{return(await Bm(r)).find(n=>n.integration_type===e)||null}catch(t){return r.error("Failed to get integration details:",t,{sourceFile:Cr}),null}}async function y9(r,e){var i;const t=await ry(r),n=((i=t.integrations)==null?void 0:i.filter(c=>c.integration_type!==e.integration_type))||[];n.push(e);const s={...t,integrations:n};await eT(r,s)}async function x9(r,e){var i;const t=await ry(r),n=((i=t.integrations)==null?void 0:i.filter(c=>c.integration_type!==e))||[],s={...t,integrations:n};await eT(r,s)}async function w9(r,e){if(!e)throw new Error("Integration not found");if(e.authMethod!=="server")throw new Error("Integration is not a server integration");try{const t=await Rm(r);if(!t)throw r.warn("Failed to get authentication token",{sourceFile:Cr}),new Error("Authentication required. Please log in first.");const n=`${V_}${e.id}?token=${encodeURIComponent(t.id_token)}`;r.debug("Opening server auth page",{sourceFile:Cr,integrationId:e.id}),window.open(n,"_blank")}catch(t){throw r.error("Failed to open server auth page:",t,{sourceFile:Cr}),t}}async function b9(r){try{return await nT(r),await pT(r),!0}catch(e){return r.error("Failed to clear integration data:",e,{sourceFile:Cr}),!1}}const _9=Object.freeze(Object.defineProperty({__proto__:null,clearIntegrationData:b9,disconnectIntegration:m9,findIntegrationById:NE,findOrgIntegrationById:p9,getIntegrationDetails:v9,initiateIntegration:xI,isCaseManagementSystemIntegrationConnected:wI,isIntegrationConnected:g9,listIntegrations:_I,openServerAuthPageForIntegration:w9,refreshIntegrations:bI,removeIntegrationDetails:x9,saveIntegrationDetails:y9},Symbol.toStringTag,{value:"Module"})),em="src/components/ui/DetailsTable.tsx",d1=r=>d.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",width:"16",height:"16",...r,className:`inline-block w-4 h-4 ${r.className||""}`,children:[d.jsx("path",{d:"M11 3a1 1 0 100 2h2.586l-6.293 6.293a1 1 0 101.414 1.414L15 6.414V9a1 1 0 102 0V4a1 1 0 00-1-1h-5z"}),d.jsx("path",{d:"M5 5a2 2 0 00-2 2v8a2 2 0 002 2h8a2 2 0 002-2v-3a1 1 0 10-2 0v3H5V7h3a1 1 0 000-2H5z"})]}),Xc=({details:r,linkableFields:e})=>{const t=Ur(),[n,s]=lr.useState(new Set),[i,c]=lr.useState(new Set),u=80;if(!r)return t.debug("No important details to render",{sourceFile:em}),null;if(Object.keys(r).length===0)return t.debug("No important details to render",{sourceFile:em}),null;const p=T=>{const S=document.createElement("textarea");S.value=T,S.style.position="fixed",S.style.opacity="0",document.body.appendChild(S),S.select();const N=document.execCommand("copy");return document.body.removeChild(S),N},m=(T,S)=>{navigator.clipboard.writeText(T).then(()=>{t.debug("Copied to clipboard",{sourceFile:em,copiedValue:T}),c(N=>new Set([...N,S])),setTimeout(()=>{c(N=>{const R=new Set(N);return R.delete(S),R})},2e3)}).catch(N=>{t.error("Failed to copy with navigator.clipboard.writeText",N,{sourceFile:em});try{p(T)&&(c(R=>new Set([...R,S])),setTimeout(()=>{c(R=>{const A=new Set(R);return A.delete(S),A})},2e3))}catch(R){t.error("Failed to copy with document.execCommand",R,{sourceFile:em})}})},g=T=>{const S=new Set(n);S.has(T)?S.delete(T):S.add(T),s(S)},x=T=>{if(!T)return"";try{return new Date(T).toLocaleDateString(void 0,{timeZone:"UTC"})}catch{return T}},b=T=>{try{const S=new URL(T);return S.protocol==="http:"||S.protocol==="https:"}catch{return!1}},E=T=>T.split(/(\[\[.*?\]\]|\(\(.*?\)\))/g).map((N,R)=>{if(N.startsWith("[[")&&N.endsWith("]]")){const A=N.slice(2,-2);return d.jsx("span",{className:"font-semibold",children:A},R)}else if(N.startsWith("((")&&N.endsWith("))")){const A=N.slice(2,-2);return/^\d{4}-\d{2}-\d{2}/.test(A)?d.jsx("span",{className:"text-base",children:x(A)},R):d.jsx("span",{className:"text-base",children:A},R)}return N});return d.jsx("div",{className:"p-1",children:d.jsx("table",{className:"w-full text-sm text-left text-gray-700 dark:text-gray-300 table-fixed",children:d.jsx("tbody",{children:Object.entries(r).map(([T,S],N)=>{let R;S===""||S===null||S===void 0?R="":typeof S=="string"||typeof S=="number"?R=String(S):R=JSON.stringify(S);const A=e==null?void 0:e.find(U=>U.field===T),j=b(R),P=R.length>u,M=n.has(N),B=P&&!M?R.substring(0,u)+"...":R;return d.jsxs("tr",{className:"bg-card",children:[d.jsx("td",{className:"py-4 px-3 whitespace-normal font-medium w-2/5 text-gray-800 dark:text-gray-200",children:A?d.jsxs("a",{href:A.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 dark:text-blue-400 hover:underline whitespace-normal hover:text-blue-800 dark:hover:text-blue-300 flex items-center gap-1",children:[T,d.jsx(d1,{})]}):T}),d.jsx("td",{className:`py-2 px-3 whitespace-pre-wrap break-words ${j?"":"hover:bg-gray-100 dark:hover:bg-muted"}`,style:j?{}:{cursor:`url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>') 10 10, copy`},onClick:()=>!j&&!P&&m(R,N),title:j?"Click to open link":P?"":"Click to copy",children:j?d.jsxs("a",{href:R,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 dark:text-blue-400 hover:underline break-words flex items-center gap-1",children:[E(R),d.jsx(d1,{className:"flex-shrink-0"})]}):d.jsxs("div",{children:[d.jsxs("div",{className:"relative",children:[d.jsx("span",{className:"break-words text-gray-700 dark:text-gray-300",onClick:()=>!P&&m(R,N),children:E(B)}),i.has(N)&&d.jsx("span",{className:"absolute -top-1 -right-1 bg-white dark:bg-gray-700 text-black dark:text-white text-xs px-2 py-1 rounded-full shadow-lg border border-gray-300 dark:border-gray-600",children:"Copied!"})]}),P&&d.jsx("div",{className:"mt-1",children:d.jsx("button",{onClick:U=>{U.stopPropagation(),g(N)},className:"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 underline text-sm",children:M?"show less":"show more"})})]})})]},N)})})})})},Tn="src/shared/components/sidepanel/mainPanelContent/EmailSummaryBox.tsx",E9=()=>{const[r,e]=w.useState(""),[t,n]=w.useState(null),[s,i]=w.useState(null),[c,u]=w.useState(!1),[p,m]=w.useState(!0),[g,x]=w.useState(!1),[b,E]=w.useState("summary"),[T,S]=w.useState(null),[N,R]=w.useState(null),[A,j]=w.useState(0),{platform:P}=ln(),M=id(),B=Ur(),U=w.useRef(null),V=w.useRef(null),Y=w.useRef(!1),ce=["Analyzing email content...","Extracting key information...","Identifying important details...","Generating summary...","Finalizing insights..."];w.useEffect(()=>{let te;const G=()=>{if(c){const z=Math.floor(Math.random()*1500)+500;te=setTimeout(()=>{j(J=>(J+1)%ce.length),G()},z)}};return c&&G(),()=>{te&&clearTimeout(te)}},[c,ce.length]);const X=w.useCallback(async te=>{if(Y.current&&U.current===te){B.debug("Already loading summary for thread:",{threadId:te,sourceFile:Tn});return}U.current=te,u(!0),Y.current=!0;try{const G=await t8(te,B);U.current===te?(B.debug("Summary response:",{summaryResponse:G,sourceFile:Tn}),e(G.summary),S(G.importantDetails),u(!1),Y.current=!1):B.debug("Ignoring summary response for outdated thread:",{threadId:te,sourceFile:Tn})}catch(G){B.error("Error fetching email summary:",G,{sourceFile:Tn}),U.current===te&&(u(!1),Y.current=!1)}},[B]),de=w.useCallback(async(te,G)=>{if(Y.current&&U.current===te){B.debug("Already loading summary for thread:",{threadId:te,sourceFile:Tn});return}U.current=te,u(!0),Y.current=!0;const z=await z5(te,B);if(z){B.debug("Using cached summary for thread:",{threadId:te,sourceFile:Tn}),e(z.summary),S(z.importantDetails),u(!1),Y.current=!1;return}try{if(!G){B.warn("No thread data found",{sourceFile:Tn,functionName:"fetchEmailSummaryForOutlook"}),u(!1),Y.current=!1;return}const J=await r8(G,B);U.current===te?(B.debug("Summary response:",{summaryResponse:J,sourceFile:Tn}),await U5(te,J.summary,J.importantDetails,B),e(J.summary),S(J.importantDetails),u(!1),Y.current=!1):B.debug("Ignoring summary response for outdated thread:",{threadId:te,sourceFile:Tn})}catch(J){B.error("Error fetching email summary for Outlook:",J,{sourceFile:Tn}),U.current===te&&(u(!1),Y.current=!1,e("Error fetching email summary. Please try again."))}},[B]);w.useEffect(()=>{const te=async()=>{B.info("Checking if Gmail is connected",{sourceFile:Tn});const z=await By(B);B.info("Gmail connection check result",{connected:z,sourceFile:Tn}),m(z)},G=async()=>{try{const J=(await Kn.createServices()).storage;if(J.onChanged){const D=$=>{if($.gmailConnectionStatus){const ne=$.gmailConnectionStatus.newValue;B.info("Gmail connection status changed via storage",{sourceFile:Tn,newStatus:ne,oldStatus:$.gmailConnectionStatus.oldValue}),m(!0)}};return J.onChanged(D),()=>{J.removeChangeListener&&J.removeChangeListener(D)}}}catch(z){B.error("Failed to set up storage listener:",z,{sourceFile:Tn})}};if(P==="chrome"){const J=(async()=>(await te(),await G()))();return()=>{J.then(D=>D==null?void 0:D())}}else P==="outlook"&&(m(!1),console.log("Not calling checkGmailConnection for Outlook"))},[P,B]),w.useEffect(()=>{if(M!=null&&M.onThreadChanged){const te=z=>{if(B.debug("Thread change received",{sourceFile:Tn,functionName:"handleThreadChange",hasThread:!!z,threadId:z==null?void 0:z.threadId,platform:P}),!z){B.debug("No thread provided, keeping current state",{sourceFile:Tn}),n(null),i(null);return}if(n(z.threadId||null),B.debug("Thread ID set",{sourceFile:Tn,threadId:z.threadId}),z.messages&&Array.isArray(z.messages)&&z.messages.length>0&&z.messages[0]&&typeof z.messages[0]=="object"){const J=z.messages.map((D,$)=>({body:D.body||D.html||"",html:D.html||D.body||"",from:D.from||"",timestamp:D.timestamp||"",subject:$===0&&z.subject||""}));i(JSON.stringify(J)),B.debug("Thread data converted and set",{sourceFile:Tn,messageCount:J.length})}};return M.onThreadChanged(te),(async()=>{try{const z=await M.getCurrentThread();te(z)}catch(z){B.error("Error loading current thread",z,{sourceFile:Tn,functionName:"loadCurrentThread"})}})(),()=>{M.removeThreadListener&&M.removeThreadListener(te)}}},[M,P,B]),w.useEffect(()=>{t&&p&&P==="chrome"?(t!==U.current||!Y.current)&&X(t):!p&&P==="chrome"?(e("Connect to Gmail to enable email summaries"),S(null),E("summary"),U.current=null,Y.current=!1,u(!1)):!p&&P==="outlook"&&s&&t?(t!==U.current||!Y.current)&&de(t||"",s):(e("Select a thread to summarize"),S(null),E("summary"),U.current=null,Y.current=!1,u(!1))},[t,p,X,de,P,s]);const we=async()=>{try{x(!0);const te=W_(G_),G=await NE("gmail");if(!G){B.error("Gmail integration not found",new Error("Gmail integration not found"),{sourceFile:Tn});return}await xI(B,G,te)&&(m(!0),t&&X(t))}catch(te){B.error("Failed to connect to Gmail:",te,{sourceFile:Tn}),e("Failed to connect to Gmail. Please try again.")}finally{x(!1)}},le=()=>T?d.jsx(Xc,{details:T}):null,se=()=>{b==="summary"&&V.current&&(R(V.current.offsetHeight),E("details"))},me=T!==null&&Object.keys(T).length>0;return w.useEffect(()=>{me||E("summary")},[me]),w.useEffect(()=>{N&&document.documentElement.style.setProperty("--content-height",`${N}px`)},[N]),d.jsxs("div",{className:"w-full max-w-full min-h-[4rem] border rounded-lg shadow-md bg-white mx-2 mt-2 mb-6 overflow-hidden box-border border-b-0",title:"Email Summary",style:{maxWidth:"calc(100% - 1rem)"},children:[d.jsx("div",{className:"flex items-center justify-center p-2 border-b bg-gray-150 min-w-0",children:d.jsxs("div",{className:"flex items-center gap-1 bg-gray-150 p-1 rounded-full",children:[d.jsxs("button",{className:`px-3 py-1.5 rounded-full text-sm font-medium transition-colors whitespace-nowrap flex items-center gap-1.5 ${b==="summary"?"text-blue-700 border bg-white border-blue-200":"bg-gray-75 text-gray-600 hover:bg-gray-100 border border-gray-200"}`,onClick:()=>E("summary"),children:[d.jsx(Wc,{className:"w-3.5 h-3.5"}),"Summary"]}),me&&d.jsxs("button",{className:`px-3 py-1.5 rounded-full text-sm font-medium transition-colors flex items-center gap-1.5 whitespace-nowrap ${b==="details"?"text-blue-700 border bg-white border-blue-200":"bg-gray-75 text-gray-600 hover:bg-gray-100 border border-gray-200"}`,onClick:se,children:[d.jsx(Oc,{src:"/icons/info-circled.svg",width:14,height:14,alt:"Info",className:"w-3.5 h-3.5"}),"Key Points"]})]})}),d.jsx("div",{className:"w-full min-w-0",children:c?d.jsxs("div",{className:"w-full border rounded flex flex-col items-center justify-center bg-gray-50 p-4",children:[d.jsx(qi,{className:"h-8 w-8 animate-spin text-blue-600"}),d.jsx("div",{className:"text-center text-sm text-gray-500",children:ce[A]})]}):!p&&P==="chrome"?d.jsxs("div",{className:"w-full p-4 flex flex-col items-center justify-center",children:[d.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Connect to Gmail to enable email summaries"}),d.jsx($e,{onClick:we,className:"w-full bg-blue-600 hover:bg-blue-700 text-white py-4 mt-2",disabled:g,children:g?"Connecting...":"Connect Gmail"})]}):d.jsx("div",{className:"w-full min-w-0 overflow-hidden",children:b==="summary"?d.jsx("div",{ref:V,className:"p-3 text-sm text-gray-600 whitespace-pre-wrap break-words overflow-wrap-anywhere",children:r}):d.jsx("div",{className:"overflow-y-auto",children:le()})})})]})};function f1(r){const e=S9(r),t=w.forwardRef((n,s)=>{const{children:i,...c}=n,u=w.Children.toArray(i),p=u.find(k9);if(p){const m=p.props.children,g=u.map(x=>x===p?w.Children.count(m)>1?w.Children.only(null):w.isValidElement(m)?m.props.children:null:x);return d.jsx(e,{...c,ref:s,children:w.isValidElement(m)?w.cloneElement(m,void 0,g):null})}return d.jsx(e,{...c,ref:s,children:i})});return t.displayName=`${r}.Slot`,t}function S9(r){const e=w.forwardRef((t,n)=>{const{children:s,...i}=t;if(w.isValidElement(s)){const c=T9(s),u=N9(i,s.props);return s.type!==w.Fragment&&(u.ref=n?Yc(n,c):c),w.cloneElement(s,u)}return w.Children.count(s)>1?w.Children.only(null):null});return e.displayName=`${r}.SlotClone`,e}var C9=Symbol("radix.slottable");function k9(r){return w.isValidElement(r)&&typeof r.type=="function"&&"__radixId"in r.type&&r.type.__radixId===C9}function N9(r,e){const t={...e};for(const n in e){const s=r[n],i=e[n];/^on[A-Z]/.test(n)?s&&i?t[n]=(...u)=>{const p=i(...u);return s(...u),p}:s&&(t[n]=s):n==="style"?t[n]={...s,...i}:n==="className"&&(t[n]=[s,i].filter(Boolean).join(" "))}return{...r,...t}}function T9(r){var n,s;let e=(n=Object.getOwnPropertyDescriptor(r.props,"ref"))==null?void 0:n.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=(s=Object.getOwnPropertyDescriptor(r,"ref"))==null?void 0:s.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}function TE(r){const e=r+"CollectionProvider",[t,n]=za(e),[s,i]=t(e,{collectionRef:{current:null},itemMap:new Map}),c=S=>{const{scope:N,children:R}=S,A=lr.useRef(null),j=lr.useRef(new Map).current;return d.jsx(s,{scope:N,itemMap:j,collectionRef:A,children:R})};c.displayName=e;const u=r+"CollectionSlot",p=f1(u),m=lr.forwardRef((S,N)=>{const{scope:R,children:A}=S,j=i(u,R),P=Mn(N,j.collectionRef);return d.jsx(p,{ref:P,children:A})});m.displayName=u;const g=r+"CollectionItemSlot",x="data-radix-collection-item",b=f1(g),E=lr.forwardRef((S,N)=>{const{scope:R,children:A,...j}=S,P=lr.useRef(null),M=Mn(N,P),B=i(g,R);return lr.useEffect(()=>(B.itemMap.set(P,{ref:P,...j}),()=>void B.itemMap.delete(P))),d.jsx(b,{[x]:"",ref:M,children:A})});E.displayName=g;function T(S){const N=i(r+"CollectionConsumer",S);return lr.useCallback(()=>{const A=N.collectionRef.current;if(!A)return[];const j=Array.from(A.querySelectorAll(`[${x}]`));return Array.from(N.itemMap.values()).sort((B,U)=>j.indexOf(B.ref.current)-j.indexOf(U.ref.current))},[N.collectionRef,N.itemMap])}return[{Provider:c,Slot:m,ItemSlot:E},T,n]}var R9=w.createContext(void 0);function i0(r){const e=w.useContext(R9);return r||e||"ltr"}var xw="rovingFocusGroup.onEntryFocus",A9={bubbles:!1,cancelable:!0},Xm="RovingFocusGroup",[Cb,EI,I9]=TE(Xm),[P9,a0]=za(Xm,[I9]),[F9,j9]=P9(Xm),SI=w.forwardRef((r,e)=>d.jsx(Cb.Provider,{scope:r.__scopeRovingFocusGroup,children:d.jsx(Cb.Slot,{scope:r.__scopeRovingFocusGroup,children:d.jsx(O9,{...r,ref:e})})}));SI.displayName=Xm;var O9=w.forwardRef((r,e)=>{const{__scopeRovingFocusGroup:t,orientation:n,loop:s=!1,dir:i,currentTabStopId:c,defaultCurrentTabStopId:u,onCurrentTabStopIdChange:p,onEntryFocus:m,preventScrollOnEntryFocus:g=!1,...x}=r,b=w.useRef(null),E=Mn(e,b),T=i0(i),[S,N]=Jc({prop:c,defaultProp:u??null,onChange:p,caller:Xm}),[R,A]=w.useState(!1),j=zl(m),P=EI(t),M=w.useRef(!1),[B,U]=w.useState(0);return w.useEffect(()=>{const V=b.current;if(V)return V.addEventListener(xw,j),()=>V.removeEventListener(xw,j)},[j]),d.jsx(F9,{scope:t,orientation:n,dir:T,loop:s,currentTabStopId:S,onItemFocus:w.useCallback(V=>N(V),[N]),onItemShiftTab:w.useCallback(()=>A(!0),[]),onFocusableItemAdd:w.useCallback(()=>U(V=>V+1),[]),onFocusableItemRemove:w.useCallback(()=>U(V=>V-1),[]),children:d.jsx(jr.div,{tabIndex:R||B===0?-1:0,"data-orientation":n,...x,ref:E,style:{outline:"none",...r.style},onMouseDown:Pt(r.onMouseDown,()=>{M.current=!0}),onFocus:Pt(r.onFocus,V=>{const Y=!M.current;if(V.target===V.currentTarget&&Y&&!R){const ce=new CustomEvent(xw,A9);if(V.currentTarget.dispatchEvent(ce),!ce.defaultPrevented){const X=P().filter(me=>me.focusable),de=X.find(me=>me.active),we=X.find(me=>me.id===S),se=[de,we,...X].filter(Boolean).map(me=>me.ref.current);NI(se,g)}}M.current=!1}),onBlur:Pt(r.onBlur,()=>A(!1))})})}),CI="RovingFocusGroupItem",kI=w.forwardRef((r,e)=>{const{__scopeRovingFocusGroup:t,focusable:n=!0,active:s=!1,tabStopId:i,children:c,...u}=r,p=Dl(),m=i||p,g=j9(CI,t),x=g.currentTabStopId===m,b=EI(t),{onFocusableItemAdd:E,onFocusableItemRemove:T,currentTabStopId:S}=g;return w.useEffect(()=>{if(n)return E(),()=>T()},[n,E,T]),d.jsx(Cb.ItemSlot,{scope:t,id:m,focusable:n,active:s,children:d.jsx(jr.span,{tabIndex:x?0:-1,"data-orientation":g.orientation,...u,ref:e,onMouseDown:Pt(r.onMouseDown,N=>{n?g.onItemFocus(m):N.preventDefault()}),onFocus:Pt(r.onFocus,()=>g.onItemFocus(m)),onKeyDown:Pt(r.onKeyDown,N=>{if(N.key==="Tab"&&N.shiftKey){g.onItemShiftTab();return}if(N.target!==N.currentTarget)return;const R=M9(N,g.orientation,g.dir);if(R!==void 0){if(N.metaKey||N.ctrlKey||N.altKey||N.shiftKey)return;N.preventDefault();let j=b().filter(P=>P.focusable).map(P=>P.ref.current);if(R==="last")j.reverse();else if(R==="prev"||R==="next"){R==="prev"&&j.reverse();const P=j.indexOf(N.currentTarget);j=g.loop?$9(j,P+1):j.slice(P+1)}setTimeout(()=>NI(j))}}),children:typeof c=="function"?c({isCurrentTabStop:x,hasTabStop:S!=null}):c})})});kI.displayName=CI;var D9={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function L9(r,e){return e!=="rtl"?r:r==="ArrowLeft"?"ArrowRight":r==="ArrowRight"?"ArrowLeft":r}function M9(r,e,t){const n=L9(r.key,t);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return D9[n]}function NI(r,e=!1){const t=document.activeElement;for(const n of r)if(n===t||(n.focus({preventScroll:e}),document.activeElement!==t))return}function $9(r,e){return r.map((t,n)=>r[(e+n)%r.length])}var TI=SI,RI=kI,l0="Tabs",[U9]=za(l0,[a0]),AI=a0(),[z9,RE]=U9(l0),II=w.forwardRef((r,e)=>{const{__scopeTabs:t,value:n,onValueChange:s,defaultValue:i,orientation:c="horizontal",dir:u,activationMode:p="automatic",...m}=r,g=i0(u),[x,b]=Jc({prop:n,onChange:s,defaultProp:i??"",caller:l0});return d.jsx(z9,{scope:t,baseId:Dl(),value:x,onValueChange:b,orientation:c,dir:g,activationMode:p,children:d.jsx(jr.div,{dir:g,"data-orientation":c,...m,ref:e})})});II.displayName=l0;var PI="TabsList",FI=w.forwardRef((r,e)=>{const{__scopeTabs:t,loop:n=!0,...s}=r,i=RE(PI,t),c=AI(t);return d.jsx(TI,{asChild:!0,...c,orientation:i.orientation,dir:i.dir,loop:n,children:d.jsx(jr.div,{role:"tablist","aria-orientation":i.orientation,...s,ref:e})})});FI.displayName=PI;var jI="TabsTrigger",OI=w.forwardRef((r,e)=>{const{__scopeTabs:t,value:n,disabled:s=!1,...i}=r,c=RE(jI,t),u=AI(t),p=MI(c.baseId,n),m=$I(c.baseId,n),g=n===c.value;return d.jsx(RI,{asChild:!0,...u,focusable:!s,active:g,children:d.jsx(jr.button,{type:"button",role:"tab","aria-selected":g,"aria-controls":m,"data-state":g?"active":"inactive","data-disabled":s?"":void 0,disabled:s,id:p,...i,ref:e,onMouseDown:Pt(r.onMouseDown,x=>{!s&&x.button===0&&x.ctrlKey===!1?c.onValueChange(n):x.preventDefault()}),onKeyDown:Pt(r.onKeyDown,x=>{[" ","Enter"].includes(x.key)&&c.onValueChange(n)}),onFocus:Pt(r.onFocus,()=>{const x=c.activationMode!=="manual";!g&&!s&&x&&c.onValueChange(n)})})})});OI.displayName=jI;var DI="TabsContent",LI=w.forwardRef((r,e)=>{const{__scopeTabs:t,value:n,forceMount:s,children:i,...c}=r,u=RE(DI,t),p=MI(u.baseId,n),m=$I(u.baseId,n),g=n===u.value,x=w.useRef(g);return w.useEffect(()=>{const b=requestAnimationFrame(()=>x.current=!1);return()=>cancelAnimationFrame(b)},[]),d.jsx(Qi,{present:s||g,children:({present:b})=>d.jsx(jr.div,{"data-state":g?"active":"inactive","data-orientation":u.orientation,role:"tabpanel","aria-labelledby":p,hidden:!b,id:m,tabIndex:0,...c,ref:e,style:{...r.style,animationDuration:x.current?"0s":void 0},children:b&&i})})});LI.displayName=DI;function MI(r,e){return`${r}-trigger-${e}`}function $I(r,e){return`${r}-content-${e}`}var H9=II,UI=FI,zI=OI,HI=LI;const B9=H9,BI=w.forwardRef(({className:r,...e},t)=>d.jsx(UI,{ref:t,className:Rr("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",r),...e}));BI.displayName=UI.displayName;const Xv=w.forwardRef(({className:r,...e},t)=>d.jsx(zI,{ref:t,className:Rr("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm overflow-x-hidden",r),...e}));Xv.displayName=zI.displayName;const Qv=w.forwardRef(({className:r,...e},t)=>d.jsx(HI,{ref:t,className:Rr("ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",r),...e}));Qv.displayName=HI.displayName;const G9="https://rubypowerslaw.filevineapp.com",Pr="src/sidepanel/panels/DocViewerPanel.tsx",GI=({documentId:r,documentName:e,onBack:t})=>{const n=Ur();n.info(`[DocViewerPanel] Initializing with documentId: ${r}, documentName: ${e}`,{sourceFile:Pr});const[s,i]=w.useState(null),[c,u]=w.useState(!0),[p,m]=w.useState(null),[g,x]=w.useState("other"),[b,E]=w.useState(!0),[T,S]=w.useState(!1),[N,R]=w.useState(0),[A,j]=w.useState(!1),P=w.useRef(null),M=w.useCallback(de=>{n.info(`[DocViewerPanel] getDocumentType called with extension: ${de}`,{sourceFile:Pr});const we=["jpg","jpeg","png","gif","bmp","webp","svg","tiff"],le=["pdf"],se=["doc","docx","xls","xlsx","ppt","pptx","odt","ods","odp","rtf"],me=["txt","md","csv","json","xml","html","htm"];let te="other";return we.includes(de)?te="image":le.includes(de)?te="pdf":se.includes(de)?te="office":me.includes(de)&&(te="text"),n.info(`[DocViewerPanel] Document type determined: ${te} for extension: ${de}`,{sourceFile:Pr}),te},[n]);w.useEffect(()=>{(async()=>{var we;if(n.info(`[DocViewerPanel] Starting fetchDocumentUrl for documentId: ${r}`,{sourceFile:Pr}),!r){n.warn("[DocViewerPanel] No document ID provided",{sourceFile:Pr,error:"No document ID provided"}),m("No document ID provided"),u(!1);return}u(!0),m(null);try{n.info(`[DocViewerPanel] Fetching document URL from server for documentId: ${r}`,{sourceFile:Pr});const le=await i8("filevine",r.toString(),n);if(n.info("[DocViewerPanel] Received document data:",{sourceFile:Pr,documentData:le}),!le.url){const te=new Error("Document URL not found in response");throw n.error("[DocViewerPanel] Document URL not found in response",te,{sourceFile:Pr}),te}n.info(`[DocViewerPanel] Setting document URL: ${le.url}`,{sourceFile:Pr}),i(le.url);const se=((we=e.split(".").pop())==null?void 0:we.toLowerCase())||"";n.info(`[DocViewerPanel] Detected file extension: ${se}`,{sourceFile:Pr});const me=M(se);n.info(`[DocViewerPanel] Determined document type: ${me}`,{sourceFile:Pr}),x(me)}catch(le){n.error("[DocViewerPanel] Error fetching document URL:",le,{sourceFile:Pr}),m("Failed to load document. Please try again later.")}finally{u(!1)}})()},[r,e,N,n,M]),w.useEffect(()=>(P.current&&(clearTimeout(P.current),P.current=null),j(!1),!c&&b&&g!=="image"&&(n.info("[DocViewerPanel] Setting loading timeout for document",{sourceFile:Pr}),P.current=setTimeout(()=>{n.info("[DocViewerPanel] Document loading is taking too long",{sourceFile:Pr}),j(!0)},1e4)),()=>{P.current&&(clearTimeout(P.current),P.current=null)}),[c,b,g,n]);const B=()=>{n.info("[DocViewerPanel] iframe loaded successfully",{sourceFile:Pr}),E(!1),S(!1),j(!1),P.current&&(clearTimeout(P.current),P.current=null)},U=de=>{n.error("[DocViewerPanel] iframe error:",de,{sourceFile:Pr}),E(!1),S(!0),j(!1),P.current&&(clearTimeout(P.current),P.current=null)},V=()=>{n.info("[DocViewerPanel] Retrying document load",{sourceFile:Pr}),E(!0),S(!1),j(!1),R(de=>de+1)},Y=()=>{if(r){const de=`${G9}/docwebviewer/view/${r}`;n.info(`[DocViewerPanel] Opening document in new tab with original URL: ${de}`,{sourceFile:Pr}),window.open(de,"_blank")}},ce=()=>{if(!s){n.warn("[DocViewerPanel] No document URL available for download",{sourceFile:Pr});return}try{n.info(`[DocViewerPanel] Starting download for: ${e}`,{sourceFile:Pr});const de=new URL(s);de.searchParams.set("response-content-disposition",`attachment; filename="${encodeURIComponent(e)}"`);const we=document.createElement("a");we.href=de.toString(),we.download=e,we.target="_blank",we.rel="noopener noreferrer",document.body.appendChild(we),we.click(),setTimeout(()=>{document.body.removeChild(we)},100),n.info(`[DocViewerPanel] Download initiated for: ${e}`,{sourceFile:Pr})}catch(de){n.error("[DocViewerPanel] Error downloading document:",de,{sourceFile:Pr})}};if(c)return n.info("[DocViewerPanel] Rendering loading state",{sourceFile:Pr}),d.jsxs(fi,{className:"w-full h-full",children:[d.jsx(Gi,{className:"pb-4",children:d.jsxs("div",{className:"flex flex-row items-start gap-3",children:[d.jsx($e,{variant:"ghost",size:"sm",onClick:t,className:"h-8 w-8 p-0 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors shrink-0 mt-0.5","aria-label":"Go back",title:"Go back",children:d.jsx(xm,{className:"h-4 w-4"})}),d.jsx(Wi,{className:"text-base font-semibold leading-relaxed break-words flex-1 min-w-0",children:e})]})}),d.jsx(hi,{className:"flex items-center justify-center h-[80vh]",children:d.jsxs("div",{className:"text-center",children:[d.jsx(qi,{className:"h-8 w-8 animate-spin mx-auto mb-4 text-blue-600 dark:text-blue-400"}),d.jsx("p",{className:"dark:text-gray-200",children:"Loading document..."})]})})]});if(p)return n.info(`[DocViewerPanel] Rendering error state: ${p}`,{sourceFile:Pr}),d.jsxs(fi,{className:"w-full h-full",children:[d.jsx(Gi,{className:"pb-4",children:d.jsxs("div",{className:"flex flex-row items-start gap-3",children:[d.jsx($e,{variant:"ghost",size:"sm",onClick:t,className:"h-8 w-8 p-0 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors shrink-0 mt-0.5","aria-label":"Go back",title:"Go back",children:d.jsx(xm,{className:"h-4 w-4"})}),d.jsx(Wi,{className:"text-base font-semibold leading-relaxed break-words flex-1 min-w-0",children:e})]})}),d.jsx(hi,{className:"flex items-center justify-center h-[80vh]",children:d.jsxs("div",{className:"text-center text-red-500",children:[d.jsx("p",{children:p}),d.jsxs($e,{variant:"outline",className:"mt-4",onClick:V,children:[d.jsx(Co,{className:"h-4 w-4 mr-2"}),"Retry"]})]})})]});const X=()=>{if(n.info(`[DocViewerPanel] renderDocumentViewer called with documentType: ${g}, documentUrl: ${s}`,{sourceFile:Pr}),!s)return n.info("[DocViewerPanel] No document URL available, returning null",{sourceFile:Pr}),null;const de=`https://docs.google.com/viewer?url=${encodeURIComponent(s||"")}&embedded=true`;n.info(`[DocViewerPanel] Google Docs Viewer URL: ${de}`,{sourceFile:Pr});const we=g==="pdf"?"PDF":g==="office"?"Office document":g==="text"?"Text document":g==="image"?"Image":"Document";return g==="image"?(n.info("[DocViewerPanel] Rendering image viewer",{sourceFile:Pr}),d.jsx("div",{className:"w-full h-full flex items-center justify-center overflow-auto",children:d.jsx("img",{src:s,alt:e,className:"max-w-full max-h-full object-contain",onLoad:()=>E(!1),onError:()=>{E(!1),S(!0)}})})):(n.info(`[DocViewerPanel] Rendering ${we} viewer with Google Docs for: ${e}`,{sourceFile:Pr}),d.jsxs("div",{className:"w-full h-full relative",children:[b&&d.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white dark:bg-gray-900 bg-opacity-80 dark:bg-opacity-80 z-10",children:d.jsxs("div",{className:"text-center",children:[d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 dark:border-gray-100 mx-auto mb-4"}),d.jsxs("p",{className:"dark:text-gray-200",children:["Loading ",we.toLowerCase(),"..."]}),d.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-2",children:"This may take a moment for large files"}),A&&d.jsxs("div",{className:"mt-4 p-4 bg-yellow-50 border border-yellow-200 rounded-md",children:[d.jsx("p",{className:"text-amber-700 font-medium",children:"This is taking longer than expected."}),d.jsx("p",{className:"text-sm text-amber-600 mt-1",children:g==="office"?"Office documents can sometimes be slow to load in the viewer.":"This document might be large or complex."}),d.jsxs("div",{className:"mt-3 flex justify-center space-x-3",children:[d.jsxs($e,{variant:"outline",size:"sm",onClick:V,children:[d.jsx(Co,{className:"h-3 w-3 mr-1"}),"Retry"]}),d.jsx($e,{variant:"default",size:"sm",onClick:Y,children:"Open in new tab"})]})]})]})}),T&&d.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white dark:bg-gray-900 z-10",children:d.jsxs("div",{className:"text-center text-red-500 dark:text-red-400",children:[d.jsxs("p",{children:["Failed to load ",we.toLowerCase(),"."]}),d.jsx("p",{className:"text-sm mt-2 dark:text-gray-400",children:"The document might be too large or in an unsupported format."}),d.jsxs("div",{className:"mt-4 flex justify-center space-x-3",children:[d.jsxs($e,{variant:"outline",onClick:V,children:[d.jsx(Co,{className:"h-4 w-4 mr-2"}),"Retry"]}),d.jsx($e,{variant:"default",onClick:Y,children:"Open in new tab"})]})]})}),d.jsx("iframe",{src:de,className:"w-full h-full border-none",title:e,sandbox:"allow-scripts allow-same-origin allow-forms allow-popups allow-popups-to-escape-sandbox",onLoad:B,onError:U})]}))};return n.info(`[DocViewerPanel] Rendering main component with documentType: ${g}`,{sourceFile:Pr}),d.jsxs(fi,{className:"w-full h-full",children:[d.jsxs(Gi,{className:"pb-4",children:[d.jsxs("div",{className:"flex flex-row items-start gap-3",children:[d.jsx($e,{variant:"ghost",size:"sm",onClick:t,className:"h-8 w-8 p-0 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors shrink-0 mt-0.5","aria-label":"Go back",title:"Go back",children:d.jsx(xm,{className:"h-4 w-4"})}),d.jsx(Wi,{className:"text-base font-semibold leading-relaxed break-words flex-1 min-w-0",children:e})]}),!c&&d.jsxs("div",{className:"flex gap-2 pl-8 pr-6",children:[d.jsxs($e,{variant:"outline",size:"sm",onClick:ce,className:"h-9 px-4","aria-label":"Download file",children:[d.jsx(cB,{className:"h-4 w-4 mr-2"}),"Download"]}),d.jsxs($e,{variant:"outline",size:"sm",onClick:Y,className:"h-9 px-4","aria-label":"Open in new tab",children:[d.jsx(jl,{className:"h-4 w-4 mr-2"}),"Open in new tab"]})]})]}),d.jsx(hi,{className:"h-[80vh] overflow-hidden",children:X()})]})},kl="src/sidepanel/panels/ClientDocumentsPanel.tsx",W9="https://rubypowerslaw.filevineapp.com",V9=({clientEmail:r,projectId:e,documents:t,isLoading:n,error:s,goBack:i,initialSelectedDocument:c})=>{const u=Ur(),[p,m]=w.useState([]),[g,x]=w.useState(!1),[b,E]=w.useState(null),[T,S]=w.useState(""),[N,R]=w.useState(null),[A,j]=w.useState({contracts:!1,payments:!1,allDocuments:!0}),[P,M]=w.useState({});w.useEffect(()=>{const z={sourceFile:kl,functionName:"useEffect[fetchData]"};if(t&&t.length>0||n){t&&m(t);return}(async()=>{if(!e){E("No project ID provided. Please select a valid project.");return}x(!0),E(null);try{const D=await gT(e,u);if(D){u.debug("Using cached documents for project",{...z,data:{projectId:e}}),m(D),x(!1);return}u.debug("ClientDocumentsPanel: Fetching documents from server for project",{...z,data:{projectId:e}});const ne=(await RT("filevine",e,u)).documents.map(_e=>({name:_e.filename,url:`${W9}/docwebviewer/view/${_e.documentId}`,documentId:_e.documentId,folderName:_e.folderName}));await mT(e,ne,u),m(ne)}catch(D){u.error("Error fetching documents:",D,z),E("Failed to load documents. Please try again later.")}finally{x(!1)}})()},[e,t,n,u]);const B=n!==void 0?n:g,U=s!==void 0?s:b,V=lr.useMemo(()=>{const z={sourceFile:kl,functionName:"useMemo[filteredDocuments]"};return u.debug("Computing filteredDocuments",z),p.filter(J=>J.name.toLowerCase().includes(T.toLowerCase()))},[p,T,u]),Y=p.filter(z=>z.folderName&&z.folderName.toLowerCase().includes("contract")),ce=p.filter(z=>z.folderName&&z.folderName.toLowerCase().includes("payment")),X=z=>{var ne;const J={sourceFile:kl,functionName:"isViewableDocument",data:{filename:z}},D=(ne=z.split(".").pop())==null?void 0:ne.toLowerCase(),$=["pdf","jpg","jpeg","png","gif","bmp","webp","doc","docx","xls","xlsx","ppt","pptx","odt","ods","odp","rtf","txt"];return u.debug(`File extension: ${D}`,J),u.debug(`Viewable extensions: ${$}`,J),$.includes(D||"")},de=z=>{var D;const J=((D=z.split(".").pop())==null?void 0:D.toLowerCase())||"";return["jpg","jpeg","png","gif","bmp","webp","svg","tiff"].includes(J)?d.jsx(pB,{className:"h-4 w-4 text-purple-500 dark:text-purple-400"}):["xls","xlsx","csv","ods"].includes(J)?d.jsx(dB,{className:"h-4 w-4 text-green-500 dark:text-green-400"}):["ppt","pptx","odp"].includes(J)?d.jsx(wB,{className:"h-4 w-4 text-orange-500 dark:text-orange-400"}):["pdf","doc","docx","txt","rtf","odt"].includes(J)?d.jsx(Qf,{className:"h-4 w-4 text-blue-500 dark:text-blue-400"}):d.jsx(fB,{className:"h-4 w-4 text-gray-500 dark:text-gray-400"})},we=z=>{const J={sourceFile:kl,functionName:"handleViewDocument",data:{docName:z.name,docId:z.documentId,url:z.url,folder:z.folderName}};u.debug("Handling view document",J),z.documentId&&X(z.name)?(u.debug("Selected document",J),R({name:z.name,documentId:z.documentId,url:z.url,folderName:z.folderName})):z.url&&(u.debug("Opening document URL",J),window.open(z.url,"_blank"))},le=z=>{j(J=>({...J,[z]:!J[z]}))},se=z=>{const J={sourceFile:kl,functionName:"toggleFolder",data:{folderName:z}};u.debug("Toggling folder",J),M(D=>({...D,[z]:!D[z]}))},me=lr.useCallback(z=>{const J={sourceFile:kl,functionName:"groupDocumentsByFolder"};u.debug("Running groupDocumentsByFolder",J);const D={};return D["No Folder"]=[],z.forEach($=>{const ne=$.folderName||"No Folder";D[ne]||(D[ne]=[]),D[ne].push($)}),D["No Folder"].length===0&&delete D["No Folder"],D},[u]),te=lr.useMemo(()=>{const z={sourceFile:kl,functionName:"useMemo[groupedFilteredDocuments]"};return u.debug("Computing groupedFilteredDocuments",z),me(V)},[V,me,u]);w.useEffect(()=>{const z={sourceFile:kl,functionName:"useEffect[folderExpansion]"};if(u.debug("Running folder expansion initialization effect",z),V.length>0){const J=Object.keys(te);u.debug(`Found folders: ${J.join(", ")}`,z),M(D=>{const $={...D};let ne=!1;return J.forEach(_e=>{$[_e]===void 0&&($[_e]=!1,ne=!0)}),ne?$:D})}},[te,V.length,u]),w.useEffect(()=>{const z={sourceFile:kl,functionName:"useEffect[initialSelectedDocument]"};c&&(u.debug("Setting initial selected document",{...z,document:c}),R({name:c.name,documentId:c.documentId,url:c.url}))},[c,u]);const G=()=>!B&&!U&&p.length===0?d.jsx("div",{className:"text-gray-500 dark:text-gray-400 text-center py-4",children:"No documents found for this client."}):!B&&!U&&p.length>0?d.jsxs("div",{className:"space-y-4",children:[Y.length>0&&d.jsxs("div",{children:[d.jsxs("button",{onClick:()=>le("contracts"),className:"flex items-center justify-between w-full py-2 text-left font-medium text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-md px-2",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx(Qf,{className:"h-4 w-4 mr-2 text-blue-500 dark:text-blue-400"}),d.jsxs("span",{children:["Contracts (",Y.length,")"]})]}),A.contracts?d.jsx(Sv,{className:"h-4 w-4"}):d.jsx(ys,{className:"h-4 w-4"})]}),A.contracts&&d.jsx("ul",{className:"ml-6 mt-2 space-y-1 text-sm",children:Y.map(z=>d.jsxs("li",{className:"flex items-center gap-2 text-gray-600 dark:text-gray-400",children:[d.jsx("span",{className:"flex-shrink-0",children:de(z.name)}),d.jsx("button",{onClick:()=>we(z),className:"text-blue-600 dark:text-blue-400 hover:underline hover:text-blue-800 dark:hover:text-blue-300 focus:outline-none text-left truncate min-w-0",title:z.name,children:z.name})]},z.documentId))})]}),ce.length>0&&d.jsxs("div",{children:[d.jsxs("button",{onClick:()=>le("payments"),className:"flex items-center justify-between w-full py-2 text-left font-medium text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-md px-2",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx(lB,{className:"h-4 w-4 mr-2 text-green-500 dark:text-green-400"}),d.jsxs("span",{children:["Payments (",ce.length,")"]})]}),A.payments?d.jsx(Sv,{className:"h-4 w-4"}):d.jsx(ys,{className:"h-4 w-4"})]}),A.payments&&d.jsx("ul",{className:"ml-6 mt-2 space-y-1 text-sm",children:ce.map(z=>d.jsxs("li",{className:"flex items-center gap-2 text-gray-600 dark:text-gray-400",children:[d.jsx("span",{className:"flex-shrink-0",children:de(z.name)}),d.jsx("button",{onClick:()=>we(z),className:"text-blue-600 dark:text-blue-400 hover:underline hover:text-blue-800 dark:hover:text-blue-300 focus:outline-none text-left truncate min-w-0",title:z.name,children:z.name})]},z.documentId))})]}),V.length>0&&d.jsxs("div",{children:[d.jsxs("button",{onClick:()=>le("allDocuments"),className:"flex items-center justify-between w-full py-2 text-left font-medium text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-md px-2",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx(Qf,{className:"h-4 w-4 mr-2 text-gray-500 dark:text-gray-400"}),d.jsxs("span",{children:["All Documents (",V.length,")"]})]}),A.allDocuments?d.jsx(Sv,{className:"h-4 w-4"}):d.jsx(ys,{className:"h-4 w-4"})]}),A.allDocuments&&d.jsx("div",{className:"ml-2 mt-2 space-y-2 text-sm",children:Object.entries(te).map(([z,J])=>d.jsxs("div",{children:[d.jsxs("button",{onClick:()=>se(z),className:"flex items-center justify-between w-full py-1 text-left font-medium text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-md px-1",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(hB,{className:"h-4 w-4 text-amber-500 dark:text-amber-400"}),d.jsxs("span",{children:[z," (",J.length,")"]})]}),P[z]?d.jsx(Sv,{className:"h-4 w-4"}):d.jsx(ys,{className:"h-4 w-4"})]}),P[z]&&d.jsx("ul",{className:"ml-6 mt-1 space-y-1",children:J.map(D=>d.jsxs("li",{className:"flex items-center gap-2 text-gray-600 dark:text-gray-400",children:[d.jsx("span",{className:"flex-shrink-0",children:de(D.name)}),d.jsx("button",{onClick:()=>we(D),className:"text-blue-600 dark:text-blue-400 hover:underline hover:text-blue-800 dark:hover:text-blue-300 focus:outline-none text-left truncate min-w-0",title:D.name,children:D.name})]},D.documentId))})]},z))})]})]}):null;return d.jsx("div",{className:"flex flex-col h-full bg-background",children:d.jsx("div",{className:"flex-grow overflow-hidden",children:N?d.jsx(GI,{documentId:N.documentId,documentName:N.name,onBack:()=>R(null)}):B?d.jsxs(fi,{className:"w-full h-full",children:[d.jsx(Gi,{className:"pb-4",children:d.jsxs("div",{className:"flex flex-row items-start gap-3",children:[i&&d.jsx($e,{variant:"ghost",size:"sm",onClick:i,className:"h-8 w-8 p-0 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors shrink-0 mt-0.5","aria-label":"Go back",title:"Go back",children:d.jsx(xm,{className:"h-4 w-4"})}),d.jsx(Wi,{className:"text-base font-semibold leading-relaxed break-words flex-1 min-w-0",children:"Project Documents"})]})}),d.jsx(hi,{className:"flex items-center justify-center h-[80vh]",children:d.jsxs("div",{className:"text-center",children:[d.jsx(qi,{className:"h-8 w-8 animate-spin mx-auto mb-4 text-blue-600 dark:text-blue-400"}),d.jsx("p",{className:"dark:text-gray-200",children:"Loading documents..."})]})})]}):U?d.jsxs("div",{className:"text-red-600 bg-red-50 p-3 rounded-md",children:["Error: ",U]}):d.jsxs(fi,{className:"mb-4",children:[d.jsx(Gi,{className:"pb-2",children:d.jsxs("div",{className:"flex flex-row items-start gap-3",children:[i&&d.jsx($e,{variant:"ghost",size:"sm",onClick:i,className:"h-8 w-8 p-0 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors shrink-0 mt-0.5","aria-label":"Go back",title:"Go back",children:d.jsx(xm,{className:"h-4 w-4"})}),d.jsx(Wi,{className:"text-base font-semibold leading-relaxed break-words flex-1 min-w-0",children:"Project Documents"})]})}),d.jsxs(hi,{className:"px-4 pt-2 pb-4",children:[d.jsxs("div",{className:"relative mb-4",children:[d.jsx(Zs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),d.jsx(rn,{type:"text",placeholder:"Search All Documents...",value:T,onChange:z=>S(z.target.value),className:"w-full pl-9 pr-4 py-2 h-9 text-sm border rounded-md"})]}),d.jsx("div",{className:"overflow-y-auto max-h-[80vh] pb-32",children:G()})]})]})})})};function q9(r){const e=K9(r),t=w.forwardRef((n,s)=>{const{children:i,...c}=n,u=w.Children.toArray(i),p=u.find(J9);if(p){const m=p.props.children,g=u.map(x=>x===p?w.Children.count(m)>1?w.Children.only(null):w.isValidElement(m)?m.props.children:null:x);return d.jsx(e,{...c,ref:s,children:w.isValidElement(m)?w.cloneElement(m,void 0,g):null})}return d.jsx(e,{...c,ref:s,children:i})});return t.displayName=`${r}.Slot`,t}function K9(r){const e=w.forwardRef((t,n)=>{const{children:s,...i}=t;if(w.isValidElement(s)){const c=Q9(s),u=X9(i,s.props);return s.type!==w.Fragment&&(u.ref=n?Yc(n,c):c),w.cloneElement(s,u)}return w.Children.count(s)>1?w.Children.only(null):null});return e.displayName=`${r}.SlotClone`,e}var Y9=Symbol("radix.slottable");function J9(r){return w.isValidElement(r)&&typeof r.type=="function"&&"__radixId"in r.type&&r.type.__radixId===Y9}function X9(r,e){const t={...e};for(const n in e){const s=r[n],i=e[n];/^on[A-Z]/.test(n)?s&&i?t[n]=(...u)=>{const p=i(...u);return s(...u),p}:s&&(t[n]=s):n==="style"?t[n]={...s,...i}:n==="className"&&(t[n]=[s,i].filter(Boolean).join(" "))}return{...r,...t}}function Q9(r){var n,s;let e=(n=Object.getOwnPropertyDescriptor(r.props,"ref"))==null?void 0:n.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=(s=Object.getOwnPropertyDescriptor(r,"ref"))==null?void 0:s.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}var kb=["Enter"," "],Z9=["ArrowDown","PageUp","Home"],WI=["ArrowUp","PageDown","End"],eV=[...Z9,...WI],tV={ltr:[...kb,"ArrowRight"],rtl:[...kb,"ArrowLeft"]},rV={ltr:["ArrowLeft"],rtl:["ArrowRight"]},Qm="Menu",[Mm,nV,sV]=TE(Qm),[ad,VI]=za(Qm,[sV,e0,a0]),c0=e0(),qI=a0(),[oV,ld]=ad(Qm),[iV,Zm]=ad(Qm),KI=r=>{const{__scopeMenu:e,open:t=!1,children:n,dir:s,onOpenChange:i,modal:c=!0}=r,u=c0(e),[p,m]=w.useState(null),g=w.useRef(!1),x=zl(i),b=i0(s);return w.useEffect(()=>{const E=()=>{g.current=!0,document.addEventListener("pointerdown",T,{capture:!0,once:!0}),document.addEventListener("pointermove",T,{capture:!0,once:!0})},T=()=>g.current=!1;return document.addEventListener("keydown",E,{capture:!0}),()=>{document.removeEventListener("keydown",E,{capture:!0}),document.removeEventListener("pointerdown",T,{capture:!0}),document.removeEventListener("pointermove",T,{capture:!0})}},[]),d.jsx(xA,{...u,children:d.jsx(oV,{scope:e,open:t,onOpenChange:x,content:p,onContentChange:m,children:d.jsx(iV,{scope:e,onClose:w.useCallback(()=>x(!1),[x]),isUsingKeyboardRef:g,dir:b,modal:c,children:n})})})};KI.displayName=Qm;var aV="MenuAnchor",AE=w.forwardRef((r,e)=>{const{__scopeMenu:t,...n}=r,s=c0(t);return d.jsx(wA,{...s,...n,ref:e})});AE.displayName=aV;var IE="MenuPortal",[lV,YI]=ad(IE,{forceMount:void 0}),JI=r=>{const{__scopeMenu:e,forceMount:t,children:n,container:s}=r,i=ld(IE,e);return d.jsx(lV,{scope:e,forceMount:t,children:d.jsx(Qi,{present:t||i.open,children:d.jsx(xE,{asChild:!0,container:s,children:n})})})};JI.displayName=IE;var vi="MenuContent",[cV,PE]=ad(vi),XI=w.forwardRef((r,e)=>{const t=YI(vi,r.__scopeMenu),{forceMount:n=t.forceMount,...s}=r,i=ld(vi,r.__scopeMenu),c=Zm(vi,r.__scopeMenu);return d.jsx(Mm.Provider,{scope:r.__scopeMenu,children:d.jsx(Qi,{present:n||i.open,children:d.jsx(Mm.Slot,{scope:r.__scopeMenu,children:c.modal?d.jsx(uV,{...s,ref:e}):d.jsx(dV,{...s,ref:e})})})})}),uV=w.forwardRef((r,e)=>{const t=ld(vi,r.__scopeMenu),n=w.useRef(null),s=Mn(e,n);return w.useEffect(()=>{const i=n.current;if(i)return VA(i)},[]),d.jsx(FE,{...r,ref:s,trapFocus:t.open,disableOutsidePointerEvents:t.open,disableOutsideScroll:!0,onFocusOutside:Pt(r.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>t.onOpenChange(!1)})}),dV=w.forwardRef((r,e)=>{const t=ld(vi,r.__scopeMenu);return d.jsx(FE,{...r,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>t.onOpenChange(!1)})}),fV=q9("MenuContent.ScrollLock"),FE=w.forwardRef((r,e)=>{const{__scopeMenu:t,loop:n=!1,trapFocus:s,onOpenAutoFocus:i,onCloseAutoFocus:c,disableOutsidePointerEvents:u,onEntryFocus:p,onEscapeKeyDown:m,onPointerDownOutside:g,onFocusOutside:x,onInteractOutside:b,onDismiss:E,disableOutsideScroll:T,...S}=r,N=ld(vi,t),R=Zm(vi,t),A=c0(t),j=qI(t),P=nV(t),[M,B]=w.useState(null),U=w.useRef(null),V=Mn(e,U,N.onContentChange),Y=w.useRef(0),ce=w.useRef(""),X=w.useRef(0),de=w.useRef(null),we=w.useRef("right"),le=w.useRef(0),se=T?EE:w.Fragment,me=T?{as:fV,allowPinchZoom:!0}:void 0,te=z=>{var xe,ye;const J=ce.current+z,D=P().filter(ue=>!ue.disabled),$=document.activeElement,ne=(xe=D.find(ue=>ue.ref.current===$))==null?void 0:xe.textValue,_e=D.map(ue=>ue.textValue),q=SV(_e,J,ne),ie=(ye=D.find(ue=>ue.textValue===q))==null?void 0:ye.ref.current;(function ue(ke){ce.current=ke,window.clearTimeout(Y.current),ke!==""&&(Y.current=window.setTimeout(()=>ue(""),1e3))})(J),ie&&setTimeout(()=>ie.focus())};w.useEffect(()=>()=>window.clearTimeout(Y.current),[]),MA();const G=w.useCallback(z=>{var D,$;return we.current===((D=de.current)==null?void 0:D.side)&&kV(z,($=de.current)==null?void 0:$.area)},[]);return d.jsx(cV,{scope:t,searchRef:ce,onItemEnter:w.useCallback(z=>{G(z)&&z.preventDefault()},[G]),onItemLeave:w.useCallback(z=>{var J;G(z)||((J=U.current)==null||J.focus(),B(null))},[G]),onTriggerLeave:w.useCallback(z=>{G(z)&&z.preventDefault()},[G]),pointerGraceTimerRef:X,onPointerGraceIntentChange:w.useCallback(z=>{de.current=z},[]),children:d.jsx(se,{...me,children:d.jsx(_E,{asChild:!0,trapped:s,onMountAutoFocus:Pt(i,z=>{var J;z.preventDefault(),(J=U.current)==null||J.focus({preventScroll:!0})}),onUnmountAutoFocus:c,children:d.jsx(t0,{asChild:!0,disableOutsidePointerEvents:u,onEscapeKeyDown:m,onPointerDownOutside:g,onFocusOutside:x,onInteractOutside:b,onDismiss:E,children:d.jsx(TI,{asChild:!0,...j,dir:R.dir,orientation:"vertical",loop:n,currentTabStopId:M,onCurrentTabStopIdChange:B,onEntryFocus:Pt(p,z=>{R.isUsingKeyboardRef.current||z.preventDefault()}),preventScrollOnEntryFocus:!0,children:d.jsx(bA,{role:"menu","aria-orientation":"vertical","data-state":hP(N.open),"data-radix-menu-content":"",dir:R.dir,...A,...S,ref:V,style:{outline:"none",...S.style},onKeyDown:Pt(S.onKeyDown,z=>{const D=z.target.closest("[data-radix-menu-content]")===z.currentTarget,$=z.ctrlKey||z.altKey||z.metaKey,ne=z.key.length===1;D&&(z.key==="Tab"&&z.preventDefault(),!$&&ne&&te(z.key));const _e=U.current;if(z.target!==_e||!eV.includes(z.key))return;z.preventDefault();const ie=P().filter(xe=>!xe.disabled).map(xe=>xe.ref.current);WI.includes(z.key)&&ie.reverse(),_V(ie)}),onBlur:Pt(r.onBlur,z=>{z.currentTarget.contains(z.target)||(window.clearTimeout(Y.current),ce.current="")}),onPointerMove:Pt(r.onPointerMove,$m(z=>{const J=z.target,D=le.current!==z.clientX;if(z.currentTarget.contains(J)&&D){const $=z.clientX>le.current?"right":"left";we.current=$,le.current=z.clientX}}))})})})})})})});XI.displayName=vi;var hV="MenuGroup",jE=w.forwardRef((r,e)=>{const{__scopeMenu:t,...n}=r;return d.jsx(jr.div,{role:"group",...n,ref:e})});jE.displayName=hV;var pV="MenuLabel",QI=w.forwardRef((r,e)=>{const{__scopeMenu:t,...n}=r;return d.jsx(jr.div,{...n,ref:e})});QI.displayName=pV;var Ry="MenuItem",h1="menu.itemSelect",u0=w.forwardRef((r,e)=>{const{disabled:t=!1,onSelect:n,...s}=r,i=w.useRef(null),c=Zm(Ry,r.__scopeMenu),u=PE(Ry,r.__scopeMenu),p=Mn(e,i),m=w.useRef(!1),g=()=>{const x=i.current;if(!t&&x){const b=new CustomEvent(h1,{bubbles:!0,cancelable:!0});x.addEventListener(h1,E=>n==null?void 0:n(E),{once:!0}),lA(x,b),b.defaultPrevented?m.current=!1:c.onClose()}};return d.jsx(ZI,{...s,ref:p,disabled:t,onClick:Pt(r.onClick,g),onPointerDown:x=>{var b;(b=r.onPointerDown)==null||b.call(r,x),m.current=!0},onPointerUp:Pt(r.onPointerUp,x=>{var b;m.current||(b=x.currentTarget)==null||b.click()}),onKeyDown:Pt(r.onKeyDown,x=>{const b=u.searchRef.current!=="";t||b&&x.key===" "||kb.includes(x.key)&&(x.currentTarget.click(),x.preventDefault())})})});u0.displayName=Ry;var ZI=w.forwardRef((r,e)=>{const{__scopeMenu:t,disabled:n=!1,textValue:s,...i}=r,c=PE(Ry,t),u=qI(t),p=w.useRef(null),m=Mn(e,p),[g,x]=w.useState(!1),[b,E]=w.useState("");return w.useEffect(()=>{const T=p.current;T&&E((T.textContent??"").trim())},[i.children]),d.jsx(Mm.ItemSlot,{scope:t,disabled:n,textValue:s??b,children:d.jsx(RI,{asChild:!0,...u,focusable:!n,children:d.jsx(jr.div,{role:"menuitem","data-highlighted":g?"":void 0,"aria-disabled":n||void 0,"data-disabled":n?"":void 0,...i,ref:m,onPointerMove:Pt(r.onPointerMove,$m(T=>{n?c.onItemLeave(T):(c.onItemEnter(T),T.defaultPrevented||T.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:Pt(r.onPointerLeave,$m(T=>c.onItemLeave(T))),onFocus:Pt(r.onFocus,()=>x(!0)),onBlur:Pt(r.onBlur,()=>x(!1))})})})}),mV="MenuCheckboxItem",eP=w.forwardRef((r,e)=>{const{checked:t=!1,onCheckedChange:n,...s}=r;return d.jsx(oP,{scope:r.__scopeMenu,checked:t,children:d.jsx(u0,{role:"menuitemcheckbox","aria-checked":Ay(t)?"mixed":t,...s,ref:e,"data-state":DE(t),onSelect:Pt(s.onSelect,()=>n==null?void 0:n(Ay(t)?!0:!t),{checkForDefaultPrevented:!1})})})});eP.displayName=mV;var tP="MenuRadioGroup",[gV,vV]=ad(tP,{value:void 0,onValueChange:()=>{}}),rP=w.forwardRef((r,e)=>{const{value:t,onValueChange:n,...s}=r,i=zl(n);return d.jsx(gV,{scope:r.__scopeMenu,value:t,onValueChange:i,children:d.jsx(jE,{...s,ref:e})})});rP.displayName=tP;var nP="MenuRadioItem",sP=w.forwardRef((r,e)=>{const{value:t,...n}=r,s=vV(nP,r.__scopeMenu),i=t===s.value;return d.jsx(oP,{scope:r.__scopeMenu,checked:i,children:d.jsx(u0,{role:"menuitemradio","aria-checked":i,...n,ref:e,"data-state":DE(i),onSelect:Pt(n.onSelect,()=>{var c;return(c=s.onValueChange)==null?void 0:c.call(s,t)},{checkForDefaultPrevented:!1})})})});sP.displayName=nP;var OE="MenuItemIndicator",[oP,yV]=ad(OE,{checked:!1}),iP=w.forwardRef((r,e)=>{const{__scopeMenu:t,forceMount:n,...s}=r,i=yV(OE,t);return d.jsx(Qi,{present:n||Ay(i.checked)||i.checked===!0,children:d.jsx(jr.span,{...s,ref:e,"data-state":DE(i.checked)})})});iP.displayName=OE;var xV="MenuSeparator",aP=w.forwardRef((r,e)=>{const{__scopeMenu:t,...n}=r;return d.jsx(jr.div,{role:"separator","aria-orientation":"horizontal",...n,ref:e})});aP.displayName=xV;var wV="MenuArrow",lP=w.forwardRef((r,e)=>{const{__scopeMenu:t,...n}=r,s=c0(t);return d.jsx(_A,{...s,...n,ref:e})});lP.displayName=wV;var bV="MenuSub",[OK,cP]=ad(bV),fm="MenuSubTrigger",uP=w.forwardRef((r,e)=>{const t=ld(fm,r.__scopeMenu),n=Zm(fm,r.__scopeMenu),s=cP(fm,r.__scopeMenu),i=PE(fm,r.__scopeMenu),c=w.useRef(null),{pointerGraceTimerRef:u,onPointerGraceIntentChange:p}=i,m={__scopeMenu:r.__scopeMenu},g=w.useCallback(()=>{c.current&&window.clearTimeout(c.current),c.current=null},[]);return w.useEffect(()=>g,[g]),w.useEffect(()=>{const x=u.current;return()=>{window.clearTimeout(x),p(null)}},[u,p]),d.jsx(AE,{asChild:!0,...m,children:d.jsx(ZI,{id:s.triggerId,"aria-haspopup":"menu","aria-expanded":t.open,"aria-controls":s.contentId,"data-state":hP(t.open),...r,ref:Yc(e,s.onTriggerChange),onClick:x=>{var b;(b=r.onClick)==null||b.call(r,x),!(r.disabled||x.defaultPrevented)&&(x.currentTarget.focus(),t.open||t.onOpenChange(!0))},onPointerMove:Pt(r.onPointerMove,$m(x=>{i.onItemEnter(x),!x.defaultPrevented&&!r.disabled&&!t.open&&!c.current&&(i.onPointerGraceIntentChange(null),c.current=window.setTimeout(()=>{t.onOpenChange(!0),g()},100))})),onPointerLeave:Pt(r.onPointerLeave,$m(x=>{var E,T;g();const b=(E=t.content)==null?void 0:E.getBoundingClientRect();if(b){const S=(T=t.content)==null?void 0:T.dataset.side,N=S==="right",R=N?-5:5,A=b[N?"left":"right"],j=b[N?"right":"left"];i.onPointerGraceIntentChange({area:[{x:x.clientX+R,y:x.clientY},{x:A,y:b.top},{x:j,y:b.top},{x:j,y:b.bottom},{x:A,y:b.bottom}],side:S}),window.clearTimeout(u.current),u.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(x),x.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:Pt(r.onKeyDown,x=>{var E;const b=i.searchRef.current!=="";r.disabled||b&&x.key===" "||tV[n.dir].includes(x.key)&&(t.onOpenChange(!0),(E=t.content)==null||E.focus(),x.preventDefault())})})})});uP.displayName=fm;var dP="MenuSubContent",fP=w.forwardRef((r,e)=>{const t=YI(vi,r.__scopeMenu),{forceMount:n=t.forceMount,...s}=r,i=ld(vi,r.__scopeMenu),c=Zm(vi,r.__scopeMenu),u=cP(dP,r.__scopeMenu),p=w.useRef(null),m=Mn(e,p);return d.jsx(Mm.Provider,{scope:r.__scopeMenu,children:d.jsx(Qi,{present:n||i.open,children:d.jsx(Mm.Slot,{scope:r.__scopeMenu,children:d.jsx(FE,{id:u.contentId,"aria-labelledby":u.triggerId,...s,ref:m,align:"start",side:c.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:g=>{var x;c.isUsingKeyboardRef.current&&((x=p.current)==null||x.focus()),g.preventDefault()},onCloseAutoFocus:g=>g.preventDefault(),onFocusOutside:Pt(r.onFocusOutside,g=>{g.target!==u.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:Pt(r.onEscapeKeyDown,g=>{c.onClose(),g.preventDefault()}),onKeyDown:Pt(r.onKeyDown,g=>{var E;const x=g.currentTarget.contains(g.target),b=rV[c.dir].includes(g.key);x&&b&&(i.onOpenChange(!1),(E=u.trigger)==null||E.focus(),g.preventDefault())})})})})})});fP.displayName=dP;function hP(r){return r?"open":"closed"}function Ay(r){return r==="indeterminate"}function DE(r){return Ay(r)?"indeterminate":r?"checked":"unchecked"}function _V(r){const e=document.activeElement;for(const t of r)if(t===e||(t.focus(),document.activeElement!==e))return}function EV(r,e){return r.map((t,n)=>r[(e+n)%r.length])}function SV(r,e,t){const s=e.length>1&&Array.from(e).every(m=>m===e[0])?e[0]:e,i=t?r.indexOf(t):-1;let c=EV(r,Math.max(i,0));s.length===1&&(c=c.filter(m=>m!==t));const p=c.find(m=>m.toLowerCase().startsWith(s.toLowerCase()));return p!==t?p:void 0}function CV(r,e){const{x:t,y:n}=r;let s=!1;for(let i=0,c=e.length-1;i<e.length;c=i++){const u=e[i],p=e[c],m=u.x,g=u.y,x=p.x,b=p.y;g>n!=b>n&&t<(x-m)*(n-g)/(b-g)+m&&(s=!s)}return s}function kV(r,e){if(!e)return!1;const t={x:r.clientX,y:r.clientY};return CV(t,e)}function $m(r){return e=>e.pointerType==="mouse"?r(e):void 0}var NV=KI,TV=AE,RV=JI,AV=XI,IV=jE,PV=QI,FV=u0,jV=eP,OV=rP,DV=sP,LV=iP,MV=aP,$V=lP,UV=uP,zV=fP,d0="DropdownMenu",[HV]=za(d0,[VI]),ro=VI(),[BV,pP]=HV(d0),mP=r=>{const{__scopeDropdownMenu:e,children:t,dir:n,open:s,defaultOpen:i,onOpenChange:c,modal:u=!0}=r,p=ro(e),m=w.useRef(null),[g,x]=Jc({prop:s,defaultProp:i??!1,onChange:c,caller:d0});return d.jsx(BV,{scope:e,triggerId:Dl(),triggerRef:m,contentId:Dl(),open:g,onOpenChange:x,onOpenToggle:w.useCallback(()=>x(b=>!b),[x]),modal:u,children:d.jsx(NV,{...p,open:g,onOpenChange:x,dir:n,modal:u,children:t})})};mP.displayName=d0;var gP="DropdownMenuTrigger",vP=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,disabled:n=!1,...s}=r,i=pP(gP,t),c=ro(t);return d.jsx(TV,{asChild:!0,...c,children:d.jsx(jr.button,{type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":n?"":void 0,disabled:n,...s,ref:Yc(e,i.triggerRef),onPointerDown:Pt(r.onPointerDown,u=>{!n&&u.button===0&&u.ctrlKey===!1&&(i.onOpenToggle(),i.open||u.preventDefault())}),onKeyDown:Pt(r.onKeyDown,u=>{n||(["Enter"," "].includes(u.key)&&i.onOpenToggle(),u.key==="ArrowDown"&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(u.key)&&u.preventDefault())})})})});vP.displayName=gP;var GV="DropdownMenuPortal",yP=r=>{const{__scopeDropdownMenu:e,...t}=r,n=ro(e);return d.jsx(RV,{...n,...t})};yP.displayName=GV;var xP="DropdownMenuContent",wP=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=pP(xP,t),i=ro(t),c=w.useRef(!1);return d.jsx(AV,{id:s.contentId,"aria-labelledby":s.triggerId,...i,...n,ref:e,onCloseAutoFocus:Pt(r.onCloseAutoFocus,u=>{var p;c.current||(p=s.triggerRef.current)==null||p.focus(),c.current=!1,u.preventDefault()}),onInteractOutside:Pt(r.onInteractOutside,u=>{const p=u.detail.originalEvent,m=p.button===0&&p.ctrlKey===!0,g=p.button===2||m;(!s.modal||g)&&(c.current=!0)}),style:{...r.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});wP.displayName=xP;var WV="DropdownMenuGroup",VV=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=ro(t);return d.jsx(IV,{...s,...n,ref:e})});VV.displayName=WV;var qV="DropdownMenuLabel",bP=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=ro(t);return d.jsx(PV,{...s,...n,ref:e})});bP.displayName=qV;var KV="DropdownMenuItem",_P=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=ro(t);return d.jsx(FV,{...s,...n,ref:e})});_P.displayName=KV;var YV="DropdownMenuCheckboxItem",EP=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=ro(t);return d.jsx(jV,{...s,...n,ref:e})});EP.displayName=YV;var JV="DropdownMenuRadioGroup",XV=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=ro(t);return d.jsx(OV,{...s,...n,ref:e})});XV.displayName=JV;var QV="DropdownMenuRadioItem",SP=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=ro(t);return d.jsx(DV,{...s,...n,ref:e})});SP.displayName=QV;var ZV="DropdownMenuItemIndicator",CP=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=ro(t);return d.jsx(LV,{...s,...n,ref:e})});CP.displayName=ZV;var eq="DropdownMenuSeparator",kP=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=ro(t);return d.jsx(MV,{...s,...n,ref:e})});kP.displayName=eq;var tq="DropdownMenuArrow",rq=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=ro(t);return d.jsx($V,{...s,...n,ref:e})});rq.displayName=tq;var nq="DropdownMenuSubTrigger",NP=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=ro(t);return d.jsx(UV,{...s,...n,ref:e})});NP.displayName=nq;var sq="DropdownMenuSubContent",TP=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=ro(t);return d.jsx(zV,{...s,...n,ref:e,style:{...r.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});TP.displayName=sq;var oq=mP,iq=vP,aq=yP,RP=wP,AP=bP,IP=_P,PP=EP,FP=SP,jP=CP,OP=kP,DP=NP,LP=TP;const Ls=oq,Ms=iq,lq=w.forwardRef(({className:r,inset:e,children:t,...n},s)=>d.jsxs(DP,{ref:s,className:Rr("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",e&&"pl-8",r),...n,children:[t,d.jsx(Vv,{className:"ml-auto h-4 w-4"})]}));lq.displayName=DP.displayName;const cq=w.forwardRef(({className:r,...e},t)=>d.jsx(LP,{ref:t,className:Rr("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in data-[side=bottom]:slide-in-from-top-1 data-[side=left]:slide-in-from-right-1 data-[side=right]:slide-in-from-left-1 data-[side=top]:slide-in-from-bottom-1",r),...e}));cq.displayName=LP.displayName;const ws=w.forwardRef(({className:r,sideOffset:e=4,...t},n)=>d.jsx(aq,{children:d.jsx(RP,{ref:n,sideOffset:e,className:Rr("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-white dark:bg-card p-1 text-neutral-950 dark:text-card-foreground shadow-md animate-in data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r),...t})}));ws.displayName=RP.displayName;const os=w.forwardRef(({className:r,inset:e,...t},n)=>d.jsx(IP,{ref:n,className:Rr("relative flex cursor-pointer select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors hover:bg-neutral-100 dark:hover:bg-muted focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 dark:text-gray-200",e&&"pl-8",r),...t}));os.displayName=IP.displayName;const uq=w.forwardRef(({className:r,children:e,checked:t,...n},s)=>d.jsxs(PP,{ref:s,className:Rr("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r),checked:t,...n,children:[d.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:d.jsx(jP,{children:d.jsx(iB,{className:"h-4 w-4"})})}),e]}));uq.displayName=PP.displayName;const dq=w.forwardRef(({className:r,children:e,...t},n)=>d.jsxs(FP,{ref:n,className:Rr("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r),...t,children:[d.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:d.jsx(jP,{children:d.jsx("div",{className:"h-2 w-2 rounded-full bg-current"})})}),e]}));dq.displayName=FP.displayName;const fq=w.forwardRef(({className:r,inset:e,...t},n)=>d.jsx(AP,{ref:n,className:Rr("px-2 py-1.5 text-sm font-semibold",e&&"pl-8",r),...t}));fq.displayName=AP.displayName;const Iy=w.forwardRef(({className:r,...e},t)=>d.jsx(OP,{ref:t,className:Rr("-mx-1 my-1 h-px bg-neutral-100",r),...e}));Iy.displayName=OP.displayName;const Qs=({rows:r=2})=>d.jsx("div",{className:"p-1",children:d.jsx("table",{className:"w-full text-sm text-left text-gray-600 dark:text-gray-300",children:d.jsx("tbody",{children:Array.from({length:r}).map((e,t)=>d.jsxs("tr",{className:"bg-card animate-pulse",children:[d.jsx("td",{className:"py-2 px-3 whitespace-normal font-medium w-1/3",children:d.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-3/4"})}),d.jsx("td",{className:"py-2 px-3",children:d.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-full"})})]},t))})})}),hq=({value:r,onChange:e,onSelect:t,suggestions:n,isLoading:s=!1,isValidating:i=!1,isValid:c=null,placeholder:u="Enter contact email",className:p="",disabled:m=!1})=>{const[g,x]=w.useState(0),b=w.useRef(null),E=w.useMemo(()=>{if(!r||r.length<2)return[];const P=r.toLowerCase();return n.filter(M=>{var B;return M.email.toLowerCase().includes(P)||((B=M.name)==null?void 0:B.toLowerCase().includes(P))}).slice(0,6)},[r,n]),T=E.length>0&&r.length>=2;w.useEffect(()=>{x(0)},[E]);const S=P=>P.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),N=(P,M)=>{if(!M)return P;const B=S(M),U=P.split(new RegExp(`(${B})`,"gi"));return d.jsx("span",{children:U.map((V,Y)=>V.toLowerCase()===M.toLowerCase()?d.jsx("span",{className:"font-semibold text-blue-600 dark:text-blue-400",children:V},Y):d.jsx("span",{children:V},Y))})},R=P=>{if(!T){P.key==="Enter"&&(P.preventDefault(),t(r));return}switch(P.key){case"ArrowDown":P.preventDefault(),x(M=>M<E.length-1?M+1:M);break;case"ArrowUp":P.preventDefault(),x(M=>M>0?M-1:M);break;case"Enter":P.preventDefault(),E[g]?A(E[g].email):t(r);break}},A=P=>{e(P),t(P)},j=()=>i?d.jsx(qi,{className:"w-4 h-4 animate-spin text-gray-400"}):c===!0?d.jsx(Hc,{className:"w-4 h-4 text-green-600"}):c===!1?d.jsx(wy,{className:"w-4 h-4 text-red-600"}):null;return d.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[d.jsxs("div",{className:"relative w-full",children:[d.jsx(rn,{ref:b,type:"email",value:r,onChange:P=>e(P.target.value),onKeyDown:R,placeholder:u,className:`pr-8 ${p} ${c===!1?"border-red-300 focus:ring-red-500":""}`,disabled:m}),d.jsx("div",{className:"absolute right-2 top-1/2 -translate-y-1/2 pointer-events-none",children:d.jsx(j,{})})]}),(T||s&&r.length>=2)&&d.jsx("div",{className:"w-full border border-gray-200 dark:border-gray-700 rounded-md max-h-[200px] overflow-y-auto bg-white dark:bg-gray-800",children:s?d.jsxs("div",{className:"flex items-center justify-center py-4",children:[d.jsx(qi,{className:"h-4 w-4 animate-spin text-gray-400"}),d.jsx("span",{className:"ml-2 text-xs text-gray-500",children:"Loading contacts..."})]}):d.jsx("div",{className:"py-1",children:E.map((P,M)=>d.jsx("div",{onClick:B=>{B.preventDefault(),B.stopPropagation(),A(P.email)},onMouseEnter:()=>x(M),className:`px-3 py-2 cursor-pointer transition-colors ${M===g?"bg-blue-50 dark:bg-blue-900/20":"hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:d.jsxs("div",{className:"flex flex-col w-full",children:[P.name&&d.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate",children:N(P.name,r)}),d.jsx("span",{className:`text-xs text-gray-600 dark:text-gray-400 truncate ${P.name?"":"text-sm font-medium text-gray-900 dark:text-gray-100"}`,children:N(P.email,r)})]})},P.email))})})]})},Vu="src/shared/hooks/useFilevineContacts.ts";let Aa=null,jv=null;const pq=1800*1e3,qu=1e4;let Ic=null;function mq(r="filevine"){const[e,t]=w.useState(Aa||[]),[n,s]=w.useState(!1),[i,c]=w.useState(null),u=Ur(),p=w.useCallback(async()=>{if(Aa&&jv&&Date.now()-jv<pq)return Aa.length>qu&&(u.warn("Cached contacts exceed size limit, truncating",{sourceFile:Vu,actual:Aa.length,limit:qu}),Aa=Aa.slice(0,qu)),u.debug("Using cached contacts",{sourceFile:Vu}),t(Aa),Aa;if(Ic){u.debug("Waiting for existing fetch request",{sourceFile:Vu});try{const g=await Ic;return t(g),g}catch(g){throw c(g instanceof Error?g:new Error("Failed to fetch contacts")),g}}return s(!0),c(null),Ic=(async()=>{try{u.debug("Fetching all contacts from server",{sourceFile:Vu});const g=await a8(u,r),x=[];g.clients&&Object.entries(g.clients).forEach(([E,T])=>{var R;const S=Array.isArray(T)?T:[],N=S==null?void 0:S[0];if(N){const A=N.fullName||void 0,j=((R=N.personTypes)==null?void 0:R[0])||void 0;x.push({email:E,name:A,role:j})}else x.push({email:E,name:void 0,role:void 0})}),x.sort((E,T)=>{var R,A;const S=((R=E.name)==null?void 0:R.toLowerCase())||E.email.toLowerCase(),N=((A=T.name)==null?void 0:A.toLowerCase())||T.email.toLowerCase();return S.localeCompare(N)}),u.debug(`Fetched ${x.length} contacts`,{sourceFile:Vu,count:x.length});const b=x.length>qu?x.slice(0,qu):x;return x.length>qu&&u.warn("Contact cache size exceeds limit, truncating",{sourceFile:Vu,actual:x.length,limit:qu}),Aa=b,jv=Date.now(),t(b),s(!1),b}catch(g){const x=g instanceof Error?g:new Error("Failed to fetch contacts");throw u.error("Error fetching contacts",x,{sourceFile:Vu}),c(x),s(!1),x}finally{Ic=null}})(),Ic},[r,u]);return{contacts:e,isLoading:n,error:i,loadContacts:p,refreshContacts:async()=>{if(Ic)try{await Ic}catch{}return Aa=null,jv=null,Ic=null,p()}}}const gq="src/sidepanel/panels/components/FilevineClientInfoBox.tsx",vq=({clientEmail:r,emailParticipants:e,emailParticipantClients:t,tempClientEmail:n,setTempClientEmail:s,setIsManuallySet:i,isManuallySet:c,selectedClientDetails:u,isLoading:p,ClientNavigation:m,setClientEmail:g,isValidClient:x,isTempEmailValid:b,isValidating:E,isProjectManuallySelected:T=!1})=>{const S=Ur(),{isConnected:N,initiateReconnection:R}=Ji(),{platform:A}=ln(),[j,P]=lr.useState(!1),{contacts:M,isLoading:B,loadContacts:U}=mq("filevine");lr.useEffect(()=>{j&&M.length===0&&!B&&U()},[j,M.length,B,U]);const V=()=>d.jsx(Qs,{rows:2}),Y=()=>d.jsxs("div",{className:"p-4 text-center",children:[d.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-3",children:d.jsx(Wc,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"})}),d.jsx("p",{className:"text-sm font-medium text-gray-800 mb-2",children:"Gmail disconnected"}),d.jsx("p",{className:"text-xs text-gray-600 mb-4",children:"Connect Gmail to view email insights"}),d.jsxs($e,{onClick:async()=>{try{await R()}catch(ce){S.error("Failed to reconnect Gmail:",ce,{sourceFile:gq})}},size:"sm",className:"bg-blue-600 hover:bg-blue-700 text-white text-xs px-4 py-2",children:[d.jsx(Co,{className:"h-3 w-3 mr-1"}),"Reconnect Gmail"]})]});return d.jsxs("div",{className:"w-full min-h-[4rem] border border-border/50 rounded-lg shadow-sm bg-card text-card-foreground",title:"Client Information",children:[d.jsxs("div",{className:"flex items-center justify-between p-2 border-b bg-muted",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(by,{className:"w-3.5 h-3.5 text-slate-600 dark:text-gray-300"}),d.jsx("span",{className:"font-medium text-sm text-slate-800 dark:text-white",children:"CONTACT"})]}),d.jsxs(Ls,{open:j,onOpenChange:P,children:[d.jsx(Ms,{asChild:!0,children:d.jsx($e,{variant:"ghost",size:"icon",className:"h-6 w-6",children:d.jsx(Zs,{className:"h-4 w-4"})})}),d.jsx(ws,{align:"end",className:"p-3 w-80",children:d.jsx(hq,{value:n||"",onChange:ce=>s(ce),onSelect:ce=>{g(ce,!0),P(!1)},suggestions:M,isLoading:B,isValidating:E,isValid:b,placeholder:"Search contact by email or name",className:"h-9 text-sm"})})]})]}),p?V():T?d.jsxs("div",{className:"p-4 text-center",children:[d.jsx(Zs,{className:"w-8 h-8 mx-auto mb-2 text-gray-400"}),d.jsx("div",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Project Manually Selected"}),d.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Search for a contact to view full client information"})]}):d.jsxs(d.Fragment,{children:[t.length>0&&!c&&d.jsx(m,{}),c&&r&&d.jsx("div",{className:"px-3 py-2 bg-gray-50 dark:bg-gray-800 border-b dark:border-gray-700",children:d.jsxs("div",{className:"flex flex-col",children:[(()=>{const ce=M.find(X=>X.email===r);return ce!=null&&ce.name?d.jsxs(d.Fragment,{children:[d.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate",children:ce.name}),d.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-400 truncate",children:r})]}):d.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate",children:r})})(),d.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5",children:"(Manually set)"})]})}),E&&e.length>0&&t.length===0&&!c?d.jsx(Qs,{rows:2}):u&&Object.keys(u).length>0?d.jsx(Xc,{details:u}):A==="chrome"&&!N?Y():d.jsx("div",{className:"p-3 text-sm text-gray-600 dark:text-gray-400",children:d.jsx("p",{className:"mb-2",children:c&&r?`No contact information found for ${r}`:e.length>0&&t.length===0?`No contact information available for emails on the selected thread:
                        ${e.join(", ")}`:e.length>0?"No contact information available for the selected email ID":"Select a contact email thread to view contact information"})})]})]})};var f0="Collapsible",[yq,MP]=za(f0),[xq,LE]=yq(f0),$P=w.forwardRef((r,e)=>{const{__scopeCollapsible:t,open:n,defaultOpen:s,disabled:i,onOpenChange:c,...u}=r,[p,m]=Jc({prop:n,defaultProp:s??!1,onChange:c,caller:f0});return d.jsx(xq,{scope:t,disabled:i,contentId:Dl(),open:p,onOpenToggle:w.useCallback(()=>m(g=>!g),[m]),children:d.jsx(jr.div,{"data-state":$E(p),"data-disabled":i?"":void 0,...u,ref:e})})});$P.displayName=f0;var UP="CollapsibleTrigger",zP=w.forwardRef((r,e)=>{const{__scopeCollapsible:t,...n}=r,s=LE(UP,t);return d.jsx(jr.button,{type:"button","aria-controls":s.contentId,"aria-expanded":s.open||!1,"data-state":$E(s.open),"data-disabled":s.disabled?"":void 0,disabled:s.disabled,...n,ref:e,onClick:Pt(r.onClick,s.onOpenToggle)})});zP.displayName=UP;var ME="CollapsibleContent",HP=w.forwardRef((r,e)=>{const{forceMount:t,...n}=r,s=LE(ME,r.__scopeCollapsible);return d.jsx(Qi,{present:t||s.open,children:({present:i})=>d.jsx(wq,{...n,ref:e,present:i})})});HP.displayName=ME;var wq=w.forwardRef((r,e)=>{const{__scopeCollapsible:t,present:n,children:s,...i}=r,c=LE(ME,t),[u,p]=w.useState(n),m=w.useRef(null),g=Mn(e,m),x=w.useRef(0),b=x.current,E=w.useRef(0),T=E.current,S=c.open||u,N=w.useRef(S),R=w.useRef(void 0);return w.useEffect(()=>{const A=requestAnimationFrame(()=>N.current=!1);return()=>cancelAnimationFrame(A)},[]),Ml(()=>{const A=m.current;if(A){R.current=R.current||{transitionDuration:A.style.transitionDuration,animationName:A.style.animationName},A.style.transitionDuration="0s",A.style.animationName="none";const j=A.getBoundingClientRect();x.current=j.height,E.current=j.width,N.current||(A.style.transitionDuration=R.current.transitionDuration,A.style.animationName=R.current.animationName),p(n)}},[c.open,n]),d.jsx(jr.div,{"data-state":$E(c.open),"data-disabled":c.disabled?"":void 0,id:c.contentId,hidden:!S,...i,ref:g,style:{"--radix-collapsible-content-height":b?`${b}px`:void 0,"--radix-collapsible-content-width":T?`${T}px`:void 0,...r.style},children:S&&s})});function $E(r){return r?"open":"closed"}var bq=$P,_q=zP,Eq=HP,ea="Accordion",Sq=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[UE,Cq,kq]=TE(ea),[h0]=za(ea,[kq,MP]),zE=MP(),BP=lr.forwardRef((r,e)=>{const{type:t,...n}=r,s=n,i=n;return d.jsx(UE.Provider,{scope:r.__scopeAccordion,children:t==="multiple"?d.jsx(Aq,{...i,ref:e}):d.jsx(Rq,{...s,ref:e})})});BP.displayName=ea;var[GP,Nq]=h0(ea),[WP,Tq]=h0(ea,{collapsible:!1}),Rq=lr.forwardRef((r,e)=>{const{value:t,defaultValue:n,onValueChange:s=()=>{},collapsible:i=!1,...c}=r,[u,p]=Jc({prop:t,defaultProp:n??"",onChange:s,caller:ea});return d.jsx(GP,{scope:r.__scopeAccordion,value:lr.useMemo(()=>u?[u]:[],[u]),onItemOpen:p,onItemClose:lr.useCallback(()=>i&&p(""),[i,p]),children:d.jsx(WP,{scope:r.__scopeAccordion,collapsible:i,children:d.jsx(VP,{...c,ref:e})})})}),Aq=lr.forwardRef((r,e)=>{const{value:t,defaultValue:n,onValueChange:s=()=>{},...i}=r,[c,u]=Jc({prop:t,defaultProp:n??[],onChange:s,caller:ea}),p=lr.useCallback(g=>u((x=[])=>[...x,g]),[u]),m=lr.useCallback(g=>u((x=[])=>x.filter(b=>b!==g)),[u]);return d.jsx(GP,{scope:r.__scopeAccordion,value:c,onItemOpen:p,onItemClose:m,children:d.jsx(WP,{scope:r.__scopeAccordion,collapsible:!0,children:d.jsx(VP,{...i,ref:e})})})}),[Iq,p0]=h0(ea),VP=lr.forwardRef((r,e)=>{const{__scopeAccordion:t,disabled:n,dir:s,orientation:i="vertical",...c}=r,u=lr.useRef(null),p=Mn(u,e),m=Cq(t),x=i0(s)==="ltr",b=Pt(r.onKeyDown,E=>{var V;if(!Sq.includes(E.key))return;const T=E.target,S=m().filter(Y=>{var ce;return!((ce=Y.ref.current)!=null&&ce.disabled)}),N=S.findIndex(Y=>Y.ref.current===T),R=S.length;if(N===-1)return;E.preventDefault();let A=N;const j=0,P=R-1,M=()=>{A=N+1,A>P&&(A=j)},B=()=>{A=N-1,A<j&&(A=P)};switch(E.key){case"Home":A=j;break;case"End":A=P;break;case"ArrowRight":i==="horizontal"&&(x?M():B());break;case"ArrowDown":i==="vertical"&&M();break;case"ArrowLeft":i==="horizontal"&&(x?B():M());break;case"ArrowUp":i==="vertical"&&B();break}const U=A%R;(V=S[U].ref.current)==null||V.focus()});return d.jsx(Iq,{scope:t,disabled:n,direction:s,orientation:i,children:d.jsx(UE.Slot,{scope:t,children:d.jsx(jr.div,{...c,"data-orientation":i,ref:p,onKeyDown:n?void 0:b})})})}),Py="AccordionItem",[Pq,HE]=h0(Py),qP=lr.forwardRef((r,e)=>{const{__scopeAccordion:t,value:n,...s}=r,i=p0(Py,t),c=Nq(Py,t),u=zE(t),p=Dl(),m=n&&c.value.includes(n)||!1,g=i.disabled||r.disabled;return d.jsx(Pq,{scope:t,open:m,disabled:g,triggerId:p,children:d.jsx(bq,{"data-orientation":i.orientation,"data-state":ZP(m),...u,...s,ref:e,disabled:g,open:m,onOpenChange:x=>{x?c.onItemOpen(n):c.onItemClose(n)}})})});qP.displayName=Py;var KP="AccordionHeader",YP=lr.forwardRef((r,e)=>{const{__scopeAccordion:t,...n}=r,s=p0(ea,t),i=HE(KP,t);return d.jsx(jr.h3,{"data-orientation":s.orientation,"data-state":ZP(i.open),"data-disabled":i.disabled?"":void 0,...n,ref:e})});YP.displayName=KP;var Nb="AccordionTrigger",JP=lr.forwardRef((r,e)=>{const{__scopeAccordion:t,...n}=r,s=p0(ea,t),i=HE(Nb,t),c=Tq(Nb,t),u=zE(t);return d.jsx(UE.ItemSlot,{scope:t,children:d.jsx(_q,{"aria-disabled":i.open&&!c.collapsible||void 0,"data-orientation":s.orientation,id:i.triggerId,...u,...n,ref:e})})});JP.displayName=Nb;var XP="AccordionContent",QP=lr.forwardRef((r,e)=>{const{__scopeAccordion:t,...n}=r,s=p0(ea,t),i=HE(XP,t),c=zE(t);return d.jsx(Eq,{role:"region","aria-labelledby":i.triggerId,"data-orientation":s.orientation,...c,...n,ref:e,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...r.style}})});QP.displayName=XP;function ZP(r){return r?"open":"closed"}var Fq=BP,jq=qP,Oq=YP,eF=JP,tF=QP;const Dq=Fq,rF=w.forwardRef(({className:r,...e},t)=>d.jsx(jq,{ref:t,className:Rr("border-b border-neutral-200 dark:border-border",r),...e}));rF.displayName="AccordionItem";const nF=w.forwardRef(({className:r,children:e,...t},n)=>d.jsx(Oq,{className:"flex",children:d.jsxs(eF,{ref:n,className:Rr("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",r),...t,children:[e,d.jsx(ys,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})}));nF.displayName=eF.displayName;const sF=w.forwardRef(({className:r,children:e,...t},n)=>d.jsx(tF,{ref:n,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...t,children:d.jsx("div",{className:Rr("pb-4 pt-0",r),children:e})}));sF.displayName=tF.displayName;var hm={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */var Lq=hm.exports,p1;function Mq(){return p1||(p1=1,(function(r,e){(function(){var t,n="4.17.23",s=200,i="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",c="Expected a function",u="Invalid `variable` option passed into `_.template`",p="__lodash_hash_undefined__",m=500,g="__lodash_placeholder__",x=1,b=2,E=4,T=1,S=2,N=1,R=2,A=4,j=8,P=16,M=32,B=64,U=128,V=256,Y=512,ce=30,X="...",de=800,we=16,le=1,se=2,me=3,te=1/0,G=9007199254740991,z=17976931348623157e292,J=NaN,D=4294967295,$=D-1,ne=D>>>1,_e=[["ary",U],["bind",N],["bindKey",R],["curry",j],["curryRight",P],["flip",Y],["partial",M],["partialRight",B],["rearg",V]],q="[object Arguments]",ie="[object Array]",xe="[object AsyncFunction]",ye="[object Boolean]",ue="[object Date]",ke="[object DOMException]",He="[object Error]",Ue="[object Function]",Le="[object GeneratorFunction]",Ne="[object Map]",gt="[object Number]",zt="[object Null]",yt="[object Object]",Zt="[object Promise]",Bt="[object Proxy]",or="[object RegExp]",st="[object Set]",Ft="[object String]",er="[object Symbol]",Ae="[object Undefined]",Ze="[object WeakMap]",dt="[object WeakSet]",rt="[object ArrayBuffer]",Lt="[object DataView]",gr="[object Float32Array]",tr="[object Float64Array]",lt="[object Int8Array]",kt="[object Int16Array]",Nt="[object Int32Array]",ze="[object Uint8Array]",vr="[object Uint8ClampedArray]",zr="[object Uint16Array]",Or="[object Uint32Array]",sn=/\b__p \+= '';/g,mn=/\b(__p \+=) '' \+/g,cn=/(__e\(.*?\)|\b__t\)) \+\n'';/g,_n=/&(?:amp|lt|gt|quot|#39);/g,as=/[&<>"']/g,An=RegExp(_n.source),wi=RegExp(as.source),bi=/<%-([\s\S]+?)%>/g,Dr=/<%([\s\S]+?)%>/g,pe=/<%=([\s\S]+?)%>/g,Ye=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,pt=/^\w*$/,Be=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,qt=/[\\^$.*+?()[\]{}|]/g,dr=RegExp(qt.source),Gt=/^\s+/,ot=/\s/,yr=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,un=/\{\n\/\* \[wrapped with (.+)\] \*/,$n=/,? & /,ko=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Ba=/[()=,{}\[\]\/\s]/,$s=/\\(\\)?/g,no=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,_i=/\w*$/,ta=/^[-+]0x[0-9a-f]+$/i,Ga=/^0b[01]+$/i,Wa=/^\[object .+?Constructor\]$/,ut=/^0o[0-7]+$/i,Z=/^(?:0|[1-9]\d*)$/,Oe=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,tt=/($^)/,br=/['\n\r\u2028\u2029\\]/g,Mt="\\ud800-\\udfff",Hr="\\u0300-\\u036f",on="\\ufe20-\\ufe2f",ls="\\u20d0-\\u20ff",In=Hr+on+ls,Ei="\\u2700-\\u27bf",qr="a-z\\xdf-\\xf6\\xf8-\\xff",No="\\xac\\xb1\\xd7\\xf7",En="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",ra="\\u2000-\\u206f",Un=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Qc="A-Z\\xc0-\\xd6\\xd8-\\xde",cd="\\ufe0e\\ufe0f",ud=No+En+ra+Un,na="[']",Bl="["+Mt+"]",sa="["+ud+"]",Si="["+In+"]",dd="\\d+",vh="["+Ei+"]",Ko="["+qr+"]",Va="[^"+Mt+ud+dd+Ei+qr+Qc+"]",qa="\\ud83c[\\udffb-\\udfff]",oa="(?:"+Si+"|"+qa+")",fd="[^"+Mt+"]",Ka="(?:\\ud83c[\\udde6-\\uddff]){2}",fr="[\\ud800-\\udbff][\\udc00-\\udfff]",Ci="["+Qc+"]",Zc="\\u200d",Gl="(?:"+Ko+"|"+Va+")",eu="(?:"+Ci+"|"+Va+")",Wl="(?:"+na+"(?:d|ll|m|re|s|t|ve))?",Ee="(?:"+na+"(?:D|LL|M|RE|S|T|VE))?",Me=oa+"?",Ge="["+cd+"]?",bt="(?:"+Zc+"(?:"+[fd,Ka,fr].join("|")+")"+Ge+Me+")*",xt="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",wt="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",We=Ge+Me+bt,it="(?:"+[vh,Ka,fr].join("|")+")"+We,gn="(?:"+[fd+Si+"?",Si,Ka,fr,Bl].join("|")+")",Yn=RegExp(na,"g"),tu=RegExp(Si,"g"),Ya=RegExp(qa+"(?="+qa+")|"+gn+We,"g"),m0=RegExp([Ci+"?"+Ko+"+"+Wl+"(?="+[sa,Ci,"$"].join("|")+")",eu+"+"+Ee+"(?="+[sa,Ci+Gl,"$"].join("|")+")",Ci+"?"+Gl+"+"+Wl,Ci+"+"+Ee,wt,xt,dd,it].join("|"),"g"),eg=RegExp("["+Zc+Mt+In+cd+"]"),hd=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,tg=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],g0=-1,Tr={};Tr[gr]=Tr[tr]=Tr[lt]=Tr[kt]=Tr[Nt]=Tr[ze]=Tr[vr]=Tr[zr]=Tr[Or]=!0,Tr[q]=Tr[ie]=Tr[rt]=Tr[ye]=Tr[Lt]=Tr[ue]=Tr[He]=Tr[Ue]=Tr[Ne]=Tr[gt]=Tr[yt]=Tr[or]=Tr[st]=Tr[Ft]=Tr[Ze]=!1;var _r={};_r[q]=_r[ie]=_r[rt]=_r[Lt]=_r[ye]=_r[ue]=_r[gr]=_r[tr]=_r[lt]=_r[kt]=_r[Nt]=_r[Ne]=_r[gt]=_r[yt]=_r[or]=_r[st]=_r[Ft]=_r[er]=_r[ze]=_r[vr]=_r[zr]=_r[Or]=!0,_r[He]=_r[Ue]=_r[Ze]=!1;var Vl={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},pd={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},v0={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},y0={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},yh=parseFloat,md=parseInt,gd=typeof pv=="object"&&pv&&pv.Object===Object&&pv,rg=typeof self=="object"&&self&&self.Object===Object&&self,Kr=gd||rg||Function("return this")(),ru=e&&!e.nodeType&&e,Yo=ru&&!0&&r&&!r.nodeType&&r,xh=Yo&&Yo.exports===ru,ql=xh&&gd.process,cs=(function(){try{var oe=Yo&&Yo.require&&Yo.require("util").types;return oe||ql&&ql.binding&&ql.binding("util")}catch{}})(),wh=cs&&cs.isArrayBuffer,_s=cs&&cs.isDate,Ja=cs&&cs.isMap,vd=cs&&cs.isRegExp,Kl=cs&&cs.isSet,ng=cs&&cs.isTypedArray;function us(oe,Se,ge){switch(ge.length){case 0:return oe.call(Se);case 1:return oe.call(Se,ge[0]);case 2:return oe.call(Se,ge[0],ge[1]);case 3:return oe.call(Se,ge[0],ge[1],ge[2])}return oe.apply(Se,ge)}function bh(oe,Se,ge,Je){for(var $t=-1,xr=oe==null?0:oe.length;++$t<xr;){var vn=oe[$t];Se(Je,vn,ge(vn),oe)}return Je}function Jn(oe,Se){for(var ge=-1,Je=oe==null?0:oe.length;++ge<Je&&Se(oe[ge],ge,oe)!==!1;);return oe}function yd(oe,Se){for(var ge=oe==null?0:oe.length;ge--&&Se(oe[ge],ge,oe)!==!1;);return oe}function _h(oe,Se){for(var ge=-1,Je=oe==null?0:oe.length;++ge<Je;)if(!Se(oe[ge],ge,oe))return!1;return!0}function ia(oe,Se){for(var ge=-1,Je=oe==null?0:oe.length,$t=0,xr=[];++ge<Je;){var vn=oe[ge];Se(vn,ge,oe)&&(xr[$t++]=vn)}return xr}function xd(oe,Se){var ge=oe==null?0:oe.length;return!!ge&&Yl(oe,Se,0)>-1}function Eh(oe,Se,ge){for(var Je=-1,$t=oe==null?0:oe.length;++Je<$t;)if(ge(Se,oe[Je]))return!0;return!1}function Lr(oe,Se){for(var ge=-1,Je=oe==null?0:oe.length,$t=Array(Je);++ge<Je;)$t[ge]=Se(oe[ge],ge,oe);return $t}function aa(oe,Se){for(var ge=-1,Je=Se.length,$t=oe.length;++ge<Je;)oe[$t+ge]=Se[ge];return oe}function Sh(oe,Se,ge,Je){var $t=-1,xr=oe==null?0:oe.length;for(Je&&xr&&(ge=oe[++$t]);++$t<xr;)ge=Se(ge,oe[$t],$t,oe);return ge}function x0(oe,Se,ge,Je){var $t=oe==null?0:oe.length;for(Je&&$t&&(ge=oe[--$t]);$t--;)ge=Se(ge,oe[$t],$t,oe);return ge}function Ch(oe,Se){for(var ge=-1,Je=oe==null?0:oe.length;++ge<Je;)if(Se(oe[ge],ge,oe))return!0;return!1}var w0=Nh("length");function sg(oe){return oe.split("")}function b0(oe){return oe.match(ko)||[]}function og(oe,Se,ge){var Je;return ge(oe,function($t,xr,vn){if(Se($t,xr,vn))return Je=xr,!1}),Je}function wd(oe,Se,ge,Je){for(var $t=oe.length,xr=ge+(Je?1:-1);Je?xr--:++xr<$t;)if(Se(oe[xr],xr,oe))return xr;return-1}function Yl(oe,Se,ge){return Se===Se?Ed(oe,Se,ge):wd(oe,ig,ge)}function kh(oe,Se,ge,Je){for(var $t=ge-1,xr=oe.length;++$t<xr;)if(Je(oe[$t],Se))return $t;return-1}function ig(oe){return oe!==oe}function ag(oe,Se){var ge=oe==null?0:oe.length;return ge?Th(oe,Se)/ge:J}function Nh(oe){return function(Se){return Se==null?t:Se[oe]}}function bd(oe){return function(Se){return oe==null?t:oe[Se]}}function lg(oe,Se,ge,Je,$t){return $t(oe,function(xr,vn,Ar){ge=Je?(Je=!1,xr):Se(ge,xr,vn,Ar)}),ge}function _0(oe,Se){var ge=oe.length;for(oe.sort(Se);ge--;)oe[ge]=oe[ge].value;return oe}function Th(oe,Se){for(var ge,Je=-1,$t=oe.length;++Je<$t;){var xr=Se(oe[Je]);xr!==t&&(ge=ge===t?xr:ge+xr)}return ge}function Rh(oe,Se){for(var ge=-1,Je=Array(oe);++ge<oe;)Je[ge]=Se(ge);return Je}function E0(oe,Se){return Lr(Se,function(ge){return[ge,oe[ge]]})}function cg(oe){return oe&&oe.slice(0,Sd(oe)+1).replace(Gt,"")}function Us(oe){return function(Se){return oe(Se)}}function nu(oe,Se){return Lr(Se,function(ge){return oe[ge]})}function ki(oe,Se){return oe.has(Se)}function ug(oe,Se){for(var ge=-1,Je=oe.length;++ge<Je&&Yl(Se,oe[ge],0)>-1;);return ge}function Ah(oe,Se){for(var ge=oe.length;ge--&&Yl(Se,oe[ge],0)>-1;);return ge}function dg(oe,Se){for(var ge=oe.length,Je=0;ge--;)oe[ge]===Se&&++Je;return Je}var fg=bd(Vl),hg=bd(pd);function pg(oe){return"\\"+y0[oe]}function Jl(oe,Se){return oe==null?t:oe[Se]}function Xl(oe){return eg.test(oe)}function S0(oe){return hd.test(oe)}function C0(oe){for(var Se,ge=[];!(Se=oe.next()).done;)ge.push(Se.value);return ge}function _d(oe){var Se=-1,ge=Array(oe.size);return oe.forEach(function(Je,$t){ge[++Se]=[$t,Je]}),ge}function Ih(oe,Se){return function(ge){return oe(Se(ge))}}function so(oe,Se){for(var ge=-1,Je=oe.length,$t=0,xr=[];++ge<Je;){var vn=oe[ge];(vn===Se||vn===g)&&(oe[ge]=g,xr[$t++]=ge)}return xr}function la(oe){var Se=-1,ge=Array(oe.size);return oe.forEach(function(Je){ge[++Se]=Je}),ge}function k0(oe){var Se=-1,ge=Array(oe.size);return oe.forEach(function(Je){ge[++Se]=[Je,Je]}),ge}function Ed(oe,Se,ge){for(var Je=ge-1,$t=oe.length;++Je<$t;)if(oe[Je]===Se)return Je;return-1}function N0(oe,Se,ge){for(var Je=ge+1;Je--;)if(oe[Je]===Se)return Je;return Je}function Xa(oe){return Xl(oe)?gg(oe):w0(oe)}function zs(oe){return Xl(oe)?vg(oe):sg(oe)}function Sd(oe){for(var Se=oe.length;Se--&&ot.test(oe.charAt(Se)););return Se}var mg=bd(v0);function gg(oe){for(var Se=Ya.lastIndex=0;Ya.test(oe);)++Se;return Se}function vg(oe){return oe.match(Ya)||[]}function T0(oe){return oe.match(m0)||[]}var R0=(function oe(Se){Se=Se==null?Kr:Ql.defaults(Kr.Object(),Se,Ql.pick(Kr,tg));var ge=Se.Array,Je=Se.Date,$t=Se.Error,xr=Se.Function,vn=Se.Math,Ar=Se.Object,su=Se.RegExp,A0=Se.String,oo=Se.TypeError,Ni=ge.prototype,Ph=xr.prototype,Jo=Ar.prototype,Zl=Se["__core-js_shared__"],ou=Ph.toString,hr=Jo.hasOwnProperty,ec=0,Cd=(function(){var l=/[^.]+$/.exec(Zl&&Zl.keys&&Zl.keys.IE_PROTO||"");return l?"Symbol(src)_1."+l:""})(),iu=Jo.toString,kd=ou.call(Ar),yg=Kr._,xg=su("^"+ou.call(hr).replace(qt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),au=xh?Se.Buffer:t,Ti=Se.Symbol,lu=Se.Uint8Array,Fh=au?au.allocUnsafe:t,To=Ih(Ar.getPrototypeOf,Ar),Nd=Ar.create,Td=Jo.propertyIsEnumerable,Rd=Ni.splice,wg=Ti?Ti.isConcatSpreadable:t,Ri=Ti?Ti.iterator:t,Qa=Ti?Ti.toStringTag:t,cu=(function(){try{var l=xa(Ar,"defineProperty");return l({},"",{}),l}catch{}})(),bg=Se.clearTimeout!==Kr.clearTimeout&&Se.clearTimeout,Br=Je&&Je.now!==Kr.Date.now&&Je.now,jh=Se.setTimeout!==Kr.setTimeout&&Se.setTimeout,Za=vn.ceil,ca=vn.floor,Ad=Ar.getOwnPropertySymbols,Oh=au?au.isBuffer:t,tc=Se.isFinite,Id=Ni.join,rc=Ih(Ar.keys,Ar),yn=vn.max,Xn=vn.min,I0=Je.now,_g=Se.parseInt,uu=vn.random,Pd=Ni.reverse,du=xa(Se,"DataView"),el=xa(Se,"Map"),fu=xa(Se,"Promise"),ua=xa(Se,"Set"),hu=xa(Se,"WeakMap"),nc=xa(Ar,"create"),Fd=hu&&new hu,sc={},Dh=wa(du),da=wa(el),Eg=wa(fu),oc=wa(ua),Xo=wa(hu),fa=Ti?Ti.prototype:t,Hs=fa?fa.valueOf:t,jd=fa?fa.toString:t;function O(l){if(wn(l)&&!Vt(l)&&!(l instanceof Wt)){if(l instanceof Qn)return l;if(hr.call(l,"__wrapped__"))return Xg(l)}return new Qn(l)}var ic=(function(){function l(){}return function(f){if(!hn(f))return{};if(Nd)return Nd(f);l.prototype=f;var y=new l;return l.prototype=t,y}})();function Qo(){}function Qn(l,f){this.__wrapped__=l,this.__actions__=[],this.__chain__=!!f,this.__index__=0,this.__values__=t}O.templateSettings={escape:bi,evaluate:Dr,interpolate:pe,variable:"",imports:{_:O}},O.prototype=Qo.prototype,O.prototype.constructor=O,Qn.prototype=ic(Qo.prototype),Qn.prototype.constructor=Qn;function Wt(l){this.__wrapped__=l,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=D,this.__views__=[]}function Od(){var l=new Wt(this.__wrapped__);return l.__actions__=fs(this.__actions__),l.__dir__=this.__dir__,l.__filtered__=this.__filtered__,l.__iteratees__=fs(this.__iteratees__),l.__takeCount__=this.__takeCount__,l.__views__=fs(this.__views__),l}function Lh(){if(this.__filtered__){var l=new Wt(this);l.__dir__=-1,l.__filtered__=!0}else l=this.clone(),l.__dir__*=-1;return l}function ac(){var l=this.__wrapped__.value(),f=this.__dir__,y=Vt(l),C=f<0,I=y?l.length:0,L=dp(0,I,this.__views__),K=L.start,ee=L.end,ae=ee-K,Te=C?ee:K-1,Re=this.__iteratees__,Fe=Re.length,Ve=0,mt=Xn(ae,this.__takeCount__);if(!y||!C&&I==ae&&mt==ae)return mc(l,this.__actions__);var Ot=[];e:for(;ae--&&Ve<mt;){Te+=f;for(var Xt=-1,Dt=l[Te];++Xt<Fe;){var ir=Re[Xt],mr=ir.iteratee,Mo=ir.type,qs=mr(Dt);if(Mo==se)Dt=qs;else if(!qs){if(Mo==le)continue e;break e}}Ot[Ve++]=Dt}return Ot}Wt.prototype=ic(Qo.prototype),Wt.prototype.constructor=Wt;function Es(l){var f=-1,y=l==null?0:l.length;for(this.clear();++f<y;){var C=l[f];this.set(C[0],C[1])}}function Gr(){this.__data__=nc?nc(null):{},this.size=0}function Mr(l){var f=this.has(l)&&delete this.__data__[l];return this.size-=f?1:0,f}function ha(l){var f=this.__data__;if(nc){var y=f[l];return y===p?t:y}return hr.call(f,l)?f[l]:t}function Zn(l){var f=this.__data__;return nc?f[l]!==t:hr.call(f,l)}function Ss(l,f){var y=this.__data__;return this.size+=this.has(l)?0:1,y[l]=nc&&f===t?p:f,this}Es.prototype.clear=Gr,Es.prototype.delete=Mr,Es.prototype.get=ha,Es.prototype.has=Zn,Es.prototype.set=Ss;function ds(l){var f=-1,y=l==null?0:l.length;for(this.clear();++f<y;){var C=l[f];this.set(C[0],C[1])}}function lc(){this.__data__=[],this.size=0}function Cs(l){var f=this.__data__,y=ts(f,l);if(y<0)return!1;var C=f.length-1;return y==C?f.pop():Rd.call(f,y,1),--this.size,!0}function Dd(l){var f=this.__data__,y=ts(f,l);return y<0?t:f[y][1]}function Sg(l){return ts(this.__data__,l)>-1}function Cg(l,f){var y=this.__data__,C=ts(y,l);return C<0?(++this.size,y.push([l,f])):y[C][1]=f,this}ds.prototype.clear=lc,ds.prototype.delete=Cs,ds.prototype.get=Dd,ds.prototype.has=Sg,ds.prototype.set=Cg;function io(l){var f=-1,y=l==null?0:l.length;for(this.clear();++f<y;){var C=l[f];this.set(C[0],C[1])}}function kg(){this.size=0,this.__data__={hash:new Es,map:new(el||ds),string:new Es}}function Ai(l){var f=Ru(this,l).delete(l);return this.size-=f?1:0,f}function Ld(l){return Ru(this,l).get(l)}function Mh(l){return Ru(this,l).has(l)}function Ng(l,f){var y=Ru(this,l),C=y.size;return y.set(l,f),this.size+=y.size==C?0:1,this}io.prototype.clear=kg,io.prototype.delete=Ai,io.prototype.get=Ld,io.prototype.has=Mh,io.prototype.set=Ng;function tl(l){var f=-1,y=l==null?0:l.length;for(this.__data__=new io;++f<y;)this.add(l[f])}function pa(l){return this.__data__.set(l,p),this}function cc(l){return this.__data__.has(l)}tl.prototype.add=tl.prototype.push=pa,tl.prototype.has=cc;function es(l){var f=this.__data__=new ds(l);this.size=f.size}function Md(){this.__data__=new ds,this.size=0}function $d(l){var f=this.__data__,y=f.delete(l);return this.size=f.size,y}function ao(l){return this.__data__.get(l)}function lo(l){return this.__data__.has(l)}function rl(l,f){var y=this.__data__;if(y instanceof ds){var C=y.__data__;if(!el||C.length<s-1)return C.push([l,f]),this.size=++y.size,this;y=this.__data__=new io(C)}return y.set(l,f),this.size=y.size,this}es.prototype.clear=Md,es.prototype.delete=$d,es.prototype.get=ao,es.prototype.has=lo,es.prototype.set=rl;function Zo(l,f){var y=Vt(l),C=!y&&zu(l),I=!y&&!C&&Cc(l),L=!y&&!C&&!I&&Rf(l),K=y||C||I||L,ee=K?Rh(l.length,A0):[],ae=ee.length;for(var Te in l)(f||hr.call(l,Te))&&!(K&&(Te=="length"||I&&(Te=="offset"||Te=="parent")||L&&(Te=="buffer"||Te=="byteLength"||Te=="byteOffset")||Jr(Te,ae)))&&ee.push(Te);return ee}function ei(l){var f=l.length;return f?l[hc(0,f-1)]:t}function nl(l,f){return ff(fs(l),Ii(f,0,l.length))}function Tg(l){return ff(fs(l))}function pu(l,f,y){(y!==t&&!zi(l[f],y)||y===t&&!(f in l))&&ti(l,f,y)}function sl(l,f,y){var C=l[f];(!(hr.call(l,f)&&zi(C,y))||y===t&&!(f in l))&&ti(l,f,y)}function ts(l,f){for(var y=l.length;y--;)if(zi(l[y][0],f))return y;return-1}function Bs(l,f,y,C){return ni(l,function(I,L,K){f(C,I,y(I),K)}),C}function Wr(l,f){return l&&Ao(f,ss(f),l)}function Ro(l,f){return l&&Ao(f,yo(f),l)}function ti(l,f,y){f=="__proto__"&&cu?cu(l,f,{configurable:!0,enumerable:!0,value:y,writable:!0}):l[f]=y}function Ud(l,f){for(var y=-1,C=f.length,I=ge(C),L=l==null;++y<C;)I[y]=L?t:tx(l,f[y]);return I}function Ii(l,f,y){return l===l&&(y!==t&&(l=l<=y?l:y),f!==t&&(l=l>=f?l:f)),l}function ks(l,f,y,C,I,L){var K,ee=f&x,ae=f&b,Te=f&E;if(y&&(K=I?y(l,C,I,L):y(l)),K!==t)return K;if(!hn(l))return l;var Re=Vt(l);if(Re){if(K=Iu(l),!ee)return fs(l,K)}else{var Fe=Bn(l),Ve=Fe==Ue||Fe==Le;if(Cc(l))return Zh(l,ee);if(Fe==yt||Fe==q||Ve&&!I){if(K=ae||Ve?{}:Gn(l),!ee)return ae?F0(l,Ro(K,l)):Zd(l,Wr(K,l))}else{if(!_r[Fe])return I?l:{};K=j0(l,Fe,ee)}}L||(L=new es);var mt=L.get(l);if(mt)return mt;L.set(l,K),VE(l)?l.forEach(function(Dt){K.add(ks(Dt,f,y,Dt,l,L))}):GE(l)&&l.forEach(function(Dt,ir){K.set(ir,ks(Dt,f,y,ir,l,L))});var Ot=Te?ae?Tu:Nu:ae?yo:ss,Xt=Re?t:Ot(l);return Jn(Xt||l,function(Dt,ir){Xt&&(ir=Dt,Dt=l[ir]),sl(K,ir,ks(Dt,f,y,ir,l,L))}),K}function Rg(l){var f=ss(l);return function(y){return mu(y,l,f)}}function mu(l,f,y){var C=y.length;if(l==null)return!C;for(l=Ar(l);C--;){var I=y[C],L=f[I],K=l[I];if(K===t&&!(I in l)||!L(K))return!1}return!0}function $h(l,f,y){if(typeof l!="function")throw new oo(c);return _c(function(){l.apply(t,y)},f)}function ri(l,f,y,C){var I=-1,L=xd,K=!0,ee=l.length,ae=[],Te=f.length;if(!ee)return ae;y&&(f=Lr(f,Us(y))),C?(L=Eh,K=!1):f.length>=s&&(L=ki,K=!1,f=new tl(f));e:for(;++I<ee;){var Re=l[I],Fe=y==null?Re:y(Re);if(Re=C||Re!==0?Re:0,K&&Fe===Fe){for(var Ve=Te;Ve--;)if(f[Ve]===Fe)continue e;ae.push(Re)}else L(f,Fe,C)||ae.push(Re)}return ae}var ni=po(Gs),Ag=po(ma,!0);function gu(l,f){var y=!0;return ni(l,function(C,I,L){return y=!!f(C,I,L),y}),y}function ol(l,f,y){for(var C=-1,I=l.length;++C<I;){var L=l[C],K=f(L);if(K!=null&&(ee===t?K===K&&!Lo(K):y(K,ee)))var ee=K,ae=L}return ae}function Ig(l,f,y,C){var I=l.length;for(y=Yt(y),y<0&&(y=-y>I?0:I+y),C=C===t||C>I?I:Yt(C),C<0&&(C+=I),C=y>C?0:KE(C);y<C;)l[y++]=f;return l}function Uh(l,f){var y=[];return ni(l,function(C,I,L){f(C,I,L)&&y.push(C)}),y}function an(l,f,y,C,I){var L=-1,K=l.length;for(y||(y=cf),I||(I=[]);++L<K;){var ee=l[L];f>0&&y(ee)?f>1?an(ee,f-1,y,C,I):aa(I,ee):C||(I[I.length]=ee)}return I}var zd=tf(),vu=tf(!0);function Gs(l,f){return l&&zd(l,f,ss)}function ma(l,f){return l&&vu(l,f,ss)}function uc(l,f){return ia(f,function(y){return yl(l[y])})}function Pi(l,f){f=ii(f,l);for(var y=0,C=f.length;l!=null&&y<C;)l=l[jo(f[y++])];return y&&y==C?l:t}function Hd(l,f,y){var C=f(l);return Vt(l)?C:aa(C,y(l))}function zn(l){return l==null?l===t?Ae:zt:Qa&&Qa in Ar(l)?lf(l):hp(l)}function ga(l,f){return l>f}function co(l,f){return l!=null&&hr.call(l,f)}function il(l,f){return l!=null&&f in Ar(l)}function zh(l,f,y){return l>=Xn(f,y)&&l<yn(f,y)}function Bd(l,f,y){for(var C=y?Eh:xd,I=l[0].length,L=l.length,K=L,ee=ge(L),ae=1/0,Te=[];K--;){var Re=l[K];K&&f&&(Re=Lr(Re,Us(f))),ae=Xn(Re.length,ae),ee[K]=!y&&(f||I>=120&&Re.length>=120)?new tl(K&&Re):t}Re=l[0];var Fe=-1,Ve=ee[0];e:for(;++Fe<I&&Te.length<ae;){var mt=Re[Fe],Ot=f?f(mt):mt;if(mt=y||mt!==0?mt:0,!(Ve?ki(Ve,Ot):C(Te,Ot,y))){for(K=L;--K;){var Xt=ee[K];if(!(Xt?ki(Xt,Ot):C(l[K],Ot,y)))continue e}Ve&&Ve.push(Ot),Te.push(mt)}}return Te}function Fi(l,f,y,C){return Gs(l,function(I,L,K){f(C,y(I),L,K)}),C}function uo(l,f,y){f=ii(f,l),l=Pn(l,f);var C=l==null?l:l[jo(ms(f))];return C==null?t:us(C,l,y)}function Gd(l){return wn(l)&&zn(l)==q}function Pg(l){return wn(l)&&zn(l)==rt}function ji(l){return wn(l)&&zn(l)==ue}function fo(l,f,y,C,I){return l===f?!0:l==null||f==null||!wn(l)&&!wn(f)?l!==l&&f!==f:Wd(l,f,y,C,fo,I)}function Wd(l,f,y,C,I,L){var K=Vt(l),ee=Vt(f),ae=K?ie:Bn(l),Te=ee?ie:Bn(f);ae=ae==q?yt:ae,Te=Te==q?yt:Te;var Re=ae==yt,Fe=Te==yt,Ve=ae==Te;if(Ve&&Cc(l)){if(!Cc(f))return!1;K=!0,Re=!1}if(Ve&&!Re)return L||(L=new es),K||Rf(l)?cp(l,f,y,C,I,L):up(l,f,ae,y,C,I,L);if(!(y&T)){var mt=Re&&hr.call(l,"__wrapped__"),Ot=Fe&&hr.call(f,"__wrapped__");if(mt||Ot){var Xt=mt?l.value():l,Dt=Ot?f.value():f;return L||(L=new es),I(Xt,Dt,y,C,L)}}return Ve?(L||(L=new es),Bg(l,f,y,C,I,L)):!1}function Fg(l){return wn(l)&&Bn(l)==Ne}function dc(l,f,y,C){var I=y.length,L=I,K=!C;if(l==null)return!L;for(l=Ar(l);I--;){var ee=y[I];if(K&&ee[2]?ee[1]!==l[ee[0]]:!(ee[0]in l))return!1}for(;++I<L;){ee=y[I];var ae=ee[0],Te=l[ae],Re=ee[1];if(K&&ee[2]){if(Te===t&&!(ae in l))return!1}else{var Fe=new es;if(C)var Ve=C(Te,Re,ae,l,f,Fe);if(!(Ve===t?fo(Re,Te,T|S,C,Fe):Ve))return!1}}return!0}function Hh(l){if(!hn(l)||Vg(l))return!1;var f=yl(l)?xg:Wa;return f.test(wa(l))}function yu(l){return wn(l)&&zn(l)==or}function si(l){return wn(l)&&Bn(l)==st}function xu(l){return wn(l)&&dv(l.length)&&!!Tr[zn(l)]}function fc(l){return typeof l=="function"?l:l==null?xo:typeof l=="object"?Vt(l)?Yr(l[0],l[1]):Vd(l):oS(l)}function Oi(l){if(!$i(l))return rc(l);var f=[];for(var y in Ar(l))hr.call(l,y)&&y!="constructor"&&f.push(y);return f}function Bh(l){if(!hn(l))return Yg(l);var f=$i(l),y=[];for(var C in l)C=="constructor"&&(f||!hr.call(l,C))||y.push(C);return y}function va(l,f){return l<f}function Gh(l,f){var y=-1,C=vo(l)?ge(l.length):[];return ni(l,function(I,L,K){C[++y]=f(I,L,K)}),C}function Vd(l){var f=Au(l);return f.length==1&&f[0][2]?uf(f[0][0],f[0][1]):function(y){return y===l||dc(y,l,f)}}function Yr(l,f){return nt(l)&&Fu(f)?uf(jo(l),f):function(y){var C=tx(y,l);return C===t&&C===f?rx(y,l):fo(f,C,T|S)}}function al(l,f,y,C,I){l!==f&&zd(f,function(L,K){if(I||(I=new es),hn(L))Wh(l,f,K,y,al,C,I);else{var ee=C?C(ci(l,K),L,K+"",l,f,I):t;ee===t&&(ee=L),pu(l,K,ee)}},yo)}function Wh(l,f,y,C,I,L,K){var ee=ci(l,y),ae=ci(f,y),Te=K.get(ae);if(Te){pu(l,y,Te);return}var Re=L?L(ee,ae,y+"",l,f,K):t,Fe=Re===t;if(Fe){var Ve=Vt(ae),mt=!Ve&&Cc(ae),Ot=!Ve&&!mt&&Rf(ae);Re=ae,Ve||mt||Ot?Vt(ee)?Re=ee:kn(ee)?Re=fs(ee):mt?(Fe=!1,Re=Zh(ae,!0)):Ot?(Fe=!1,Re=Mg(ae,!0)):Re=[]:Ip(ae)||zu(ae)?(Re=ee,zu(ee)?Re=YE(ee):(!hn(ee)||yl(ee))&&(Re=Gn(ae))):Fe=!1}Fe&&(K.set(ae,Re),I(Re,ae,C,L,K),K.delete(ae)),pu(l,y,Re)}function qd(l,f){var y=l.length;if(y)return f+=f<0?y:0,Jr(f,y)?l[f]:t}function wu(l,f,y){f.length?f=Lr(f,function(L){return Vt(L)?function(K){return Pi(K,L.length===1?L[0]:L)}:L}):f=[xo];var C=-1;f=Lr(f,Us(It()));var I=Gh(l,function(L,K,ee){var ae=Lr(f,function(Te){return Te(L)});return{criteria:ae,index:++C,value:L}});return _0(I,function(L,K){return P0(L,K,y)})}function Vh(l,f){return ya(l,f,function(y,C){return rx(l,C)})}function ya(l,f,y){for(var C=-1,I=f.length,L={};++C<I;){var K=f[C],ee=Pi(l,K);y(ee,K)&&cl(L,ii(K,l),ee)}return L}function Qr(l){return function(f){return Pi(f,l)}}function dn(l,f,y,C){var I=C?kh:Yl,L=-1,K=f.length,ee=l;for(l===f&&(f=fs(f)),y&&(ee=Lr(l,Us(y)));++L<K;)for(var ae=0,Te=f[L],Re=y?y(Te):Te;(ae=I(ee,Re,ae,C))>-1;)ee!==l&&Rd.call(ee,ae,1),Rd.call(l,ae,1);return l}function Sn(l,f){for(var y=l?f.length:0,C=y-1;y--;){var I=f[y];if(y==C||I!==L){var L=I;Jr(I)?Rd.call(l,I,1):Jd(l,I)}}return l}function hc(l,f){return l+ca(uu()*(f-l+1))}function bu(l,f,y,C){for(var I=-1,L=yn(Za((f-l)/(y||1)),0),K=ge(L);L--;)K[C?L:++I]=l,l+=y;return K}function ll(l,f){var y="";if(!l||f<1||f>G)return y;do f%2&&(y+=l),f=ca(f/2),f&&(l+=l);while(f);return y}function Kt(l,f){return Ws(df(l,f,xo),l+"")}function rs(l){return ei(Af(l))}function qh(l,f){var y=Af(l);return ff(y,Ii(f,0,y.length))}function cl(l,f,y,C){if(!hn(l))return l;f=ii(f,l);for(var I=-1,L=f.length,K=L-1,ee=l;ee!=null&&++I<L;){var ae=jo(f[I]),Te=y;if(ae==="__proto__"||ae==="constructor"||ae==="prototype")return l;if(I!=K){var Re=ee[ae];Te=C?C(Re,ae,ee):t,Te===t&&(Te=hn(Re)?Re:Jr(f[I+1])?[]:{})}sl(ee,ae,Te),ee=ee[ae]}return l}var Kd=Fd?function(l,f){return Fd.set(l,f),l}:xo,oi=cu?function(l,f){return cu(l,"toString",{configurable:!0,enumerable:!1,value:sx(f),writable:!0})}:xo;function ho(l){return ff(Af(l))}function ns(l,f,y){var C=-1,I=l.length;f<0&&(f=-f>I?0:I+f),y=y>I?I:y,y<0&&(y+=I),I=f>y?0:y-f>>>0,f>>>=0;for(var L=ge(I);++C<I;)L[C]=l[C+f];return L}function Kh(l,f){var y;return ni(l,function(C,I,L){return y=f(C,I,L),!y}),!!y}function pc(l,f,y){var C=0,I=l==null?C:l.length;if(typeof f=="number"&&f===f&&I<=ne){for(;C<I;){var L=C+I>>>1,K=l[L];K!==null&&!Lo(K)&&(y?K<=f:K<f)?C=L+1:I=L}return I}return Yd(l,f,xo,y)}function Yd(l,f,y,C){var I=0,L=l==null?0:l.length;if(L===0)return 0;f=y(f);for(var K=f!==f,ee=f===null,ae=Lo(f),Te=f===t;I<L;){var Re=ca((I+L)/2),Fe=y(l[Re]),Ve=Fe!==t,mt=Fe===null,Ot=Fe===Fe,Xt=Lo(Fe);if(K)var Dt=C||Ot;else Te?Dt=Ot&&(C||Ve):ee?Dt=Ot&&Ve&&(C||!mt):ae?Dt=Ot&&Ve&&!mt&&(C||!Xt):mt||Xt?Dt=!1:Dt=C?Fe<=f:Fe<f;Dt?I=Re+1:L=Re}return Xn(L,$)}function Yh(l,f){for(var y=-1,C=l.length,I=0,L=[];++y<C;){var K=l[y],ee=f?f(K):K;if(!y||!zi(ee,ae)){var ae=ee;L[I++]=K===0?0:K}}return L}function Jh(l){return typeof l=="number"?l:Lo(l)?J:+l}function Ns(l){if(typeof l=="string")return l;if(Vt(l))return Lr(l,Ns)+"";if(Lo(l))return jd?jd.call(l):"";var f=l+"";return f=="0"&&1/l==-te?"-0":f}function Di(l,f,y){var C=-1,I=xd,L=l.length,K=!0,ee=[],ae=ee;if(y)K=!1,I=Eh;else if(L>=s){var Te=f?null:Hg(l);if(Te)return la(Te);K=!1,I=ki,ae=new tl}else ae=f?[]:ee;e:for(;++C<L;){var Re=l[C],Fe=f?f(Re):Re;if(Re=y||Re!==0?Re:0,K&&Fe===Fe){for(var Ve=ae.length;Ve--;)if(ae[Ve]===Fe)continue e;f&&ae.push(Fe),ee.push(Re)}else I(ae,Fe,y)||(ae!==ee&&ae.push(Fe),ee.push(Re))}return ee}function Jd(l,f){f=ii(f,l);var y=-1,C=f.length;if(!C)return!0;for(var I=l==null||typeof l!="object"&&typeof l!="function";++y<C;){var L=f[y];if(typeof L=="string"){if(L==="__proto__"&&!hr.call(l,"__proto__"))return!1;if(L==="constructor"&&y+1<C&&typeof f[y+1]=="string"&&f[y+1]==="prototype"){if(I&&y===0)continue;return!1}}}var K=Pn(l,f);return K==null||delete K[jo(ms(f))]}function Xh(l,f,y,C){return cl(l,f,y(Pi(l,f)),C)}function _u(l,f,y,C){for(var I=l.length,L=C?I:-1;(C?L--:++L<I)&&f(l[L],L,l););return y?ns(l,C?0:L,C?L+1:I):ns(l,C?L+1:0,C?I:L)}function mc(l,f){var y=l;return y instanceof Wt&&(y=y.value()),Sh(f,function(C,I){return I.func.apply(I.thisArg,aa([C],I.args))},y)}function Xd(l,f,y){var C=l.length;if(C<2)return C?Di(l[0]):[];for(var I=-1,L=ge(C);++I<C;)for(var K=l[I],ee=-1;++ee<C;)ee!=I&&(L[I]=ri(L[I]||K,l[ee],f,y));return Di(an(L,1),f,y)}function Eu(l,f,y){for(var C=-1,I=l.length,L=f.length,K={};++C<I;){var ee=C<L?f[C]:t;y(K,l[C],ee)}return K}function gc(l){return kn(l)?l:[]}function Qd(l){return typeof l=="function"?l:xo}function ii(l,f){return Vt(l)?l:nt(l,f)?[l]:gp(Ir(l))}var jg=Kt;function Li(l,f,y){var C=l.length;return y=y===t?C:y,!f&&y>=C?l:ns(l,f,y)}var Qh=bg||function(l){return Kr.clearTimeout(l)};function Zh(l,f){if(f)return l.slice();var y=l.length,C=Fh?Fh(y):new l.constructor(y);return l.copy(C),C}function Su(l){var f=new l.constructor(l.byteLength);return new lu(f).set(new lu(l)),f}function Og(l,f){var y=f?Su(l.buffer):l.buffer;return new l.constructor(y,l.byteOffset,l.byteLength)}function Dg(l){var f=new l.constructor(l.source,_i.exec(l));return f.lastIndex=l.lastIndex,f}function Lg(l){return Hs?Ar(Hs.call(l)):{}}function Mg(l,f){var y=f?Su(l.buffer):l.buffer;return new l.constructor(y,l.byteOffset,l.length)}function ep(l,f){if(l!==f){var y=l!==t,C=l===null,I=l===l,L=Lo(l),K=f!==t,ee=f===null,ae=f===f,Te=Lo(f);if(!ee&&!Te&&!L&&l>f||L&&K&&ae&&!ee&&!Te||C&&K&&ae||!y&&ae||!I)return 1;if(!C&&!L&&!Te&&l<f||Te&&y&&I&&!C&&!L||ee&&y&&I||!K&&I||!ae)return-1}return 0}function P0(l,f,y){for(var C=-1,I=l.criteria,L=f.criteria,K=I.length,ee=y.length;++C<K;){var ae=ep(I[C],L[C]);if(ae){if(C>=ee)return ae;var Te=y[C];return ae*(Te=="desc"?-1:1)}}return l.index-f.index}function $g(l,f,y,C){for(var I=-1,L=l.length,K=y.length,ee=-1,ae=f.length,Te=yn(L-K,0),Re=ge(ae+Te),Fe=!C;++ee<ae;)Re[ee]=f[ee];for(;++I<K;)(Fe||I<L)&&(Re[y[I]]=l[I]);for(;Te--;)Re[ee++]=l[I++];return Re}function tp(l,f,y,C){for(var I=-1,L=l.length,K=-1,ee=y.length,ae=-1,Te=f.length,Re=yn(L-ee,0),Fe=ge(Re+Te),Ve=!C;++I<Re;)Fe[I]=l[I];for(var mt=I;++ae<Te;)Fe[mt+ae]=f[ae];for(;++K<ee;)(Ve||I<L)&&(Fe[mt+y[K]]=l[I++]);return Fe}function fs(l,f){var y=-1,C=l.length;for(f||(f=ge(C));++y<C;)f[y]=l[y];return f}function Ao(l,f,y,C){var I=!y;y||(y={});for(var L=-1,K=f.length;++L<K;){var ee=f[L],ae=C?C(y[ee],l[ee],ee,y,l):t;ae===t&&(ae=l[ee]),I?ti(y,ee,ae):sl(y,ee,ae)}return y}function Zd(l,f){return Ao(l,Io(l),f)}function F0(l,f){return Ao(l,Gg(l),f)}function ef(l,f){return function(y,C){var I=Vt(y)?bh:Bs,L=f?f():{};return I(y,l,It(C,2),L)}}function vc(l){return Kt(function(f,y){var C=-1,I=y.length,L=I>1?y[I-1]:t,K=I>2?y[2]:t;for(L=l.length>3&&typeof L=="function"?(I--,L):t,K&&ps(y[0],y[1],K)&&(L=I<3?t:L,I=1),f=Ar(f);++C<I;){var ee=y[C];ee&&l(f,ee,C,L)}return f})}function po(l,f){return function(y,C){if(y==null)return y;if(!vo(y))return l(y,C);for(var I=y.length,L=f?I:-1,K=Ar(y);(f?L--:++L<I)&&C(K[L],L,K)!==!1;);return y}}function tf(l){return function(f,y,C){for(var I=-1,L=Ar(f),K=C(f),ee=K.length;ee--;){var ae=K[l?ee:++I];if(y(L[ae],ae,L)===!1)break}return f}}function rf(l,f,y){var C=f&N,I=yc(l);function L(){var K=this&&this!==Kr&&this instanceof L?I:l;return K.apply(C?y:this,arguments)}return L}function rp(l){return function(f){f=Ir(f);var y=Xl(f)?zs(f):t,C=y?y[0]:f.charAt(0),I=y?Li(y,1).join(""):f.slice(1);return C[l]()+I}}function ul(l){return function(f){return Sh(nS(rS(f).replace(Yn,"")),l,"")}}function yc(l){return function(){var f=arguments;switch(f.length){case 0:return new l;case 1:return new l(f[0]);case 2:return new l(f[0],f[1]);case 3:return new l(f[0],f[1],f[2]);case 4:return new l(f[0],f[1],f[2],f[3]);case 5:return new l(f[0],f[1],f[2],f[3],f[4]);case 6:return new l(f[0],f[1],f[2],f[3],f[4],f[5]);case 7:return new l(f[0],f[1],f[2],f[3],f[4],f[5],f[6])}var y=ic(l.prototype),C=l.apply(y,f);return hn(C)?C:y}}function np(l,f,y){var C=yc(l);function I(){for(var L=arguments.length,K=ge(L),ee=L,ae=Mi(I);ee--;)K[ee]=arguments[ee];var Te=L<3&&K[0]!==ae&&K[L-1]!==ae?[]:so(K,ae);if(L-=Te.length,L<y)return hs(l,f,xc,I.placeholder,t,K,Te,t,t,y-L);var Re=this&&this!==Kr&&this instanceof I?C:l;return us(Re,this,K)}return I}function dl(l){return function(f,y,C){var I=Ar(f);if(!vo(f)){var L=It(y,3);f=ss(f),y=function(ee){return L(I[ee],ee,I)}}var K=l(f,y,C);return K>-1?I[L?f[K]:K]:t}}function nf(l){return li(function(f){var y=f.length,C=y,I=Qn.prototype.thru;for(l&&f.reverse();C--;){var L=f[C];if(typeof L!="function")throw new oo(c);if(I&&!K&&wc(L)=="wrapper")var K=new Qn([],!0)}for(C=K?C:y;++C<y;){L=f[C];var ee=wc(L),ae=ee=="wrapper"?af(L):t;ae&&Pu(ae[0])&&ae[1]==(U|j|M|V)&&!ae[4].length&&ae[9]==1?K=K[wc(ae[0])].apply(K,ae[3]):K=L.length==1&&Pu(L)?K[ee]():K.thru(L)}return function(){var Te=arguments,Re=Te[0];if(K&&Te.length==1&&Vt(Re))return K.plant(Re).value();for(var Fe=0,Ve=y?f[Fe].apply(this,Te):Re;++Fe<y;)Ve=f[Fe].call(this,Ve);return Ve}})}function xc(l,f,y,C,I,L,K,ee,ae,Te){var Re=f&U,Fe=f&N,Ve=f&R,mt=f&(j|P),Ot=f&Y,Xt=Ve?t:yc(l);function Dt(){for(var ir=arguments.length,mr=ge(ir),Mo=ir;Mo--;)mr[Mo]=arguments[Mo];if(mt)var qs=Mi(Dt),$o=dg(mr,qs);if(C&&(mr=$g(mr,C,I,mt)),L&&(mr=tp(mr,L,K,mt)),ir-=$o,mt&&ir<Te){var Nn=so(mr,qs);return hs(l,f,xc,Dt.placeholder,y,mr,Nn,ee,ae,Te-ir)}var Hi=Fe?y:this,wl=Ve?Hi[l]:l;return ir=mr.length,ee?mr=Po(mr,ee):Ot&&ir>1&&mr.reverse(),Re&&ae<ir&&(mr.length=ae),this&&this!==Kr&&this instanceof Dt&&(wl=Xt||yc(wl)),wl.apply(Hi,mr)}return Dt}function Ug(l,f){return function(y,C){return Fi(y,l,f(C),{})}}function Cu(l,f){return function(y,C){var I;if(y===t&&C===t)return f;if(y!==t&&(I=y),C!==t){if(I===t)return C;typeof y=="string"||typeof C=="string"?(y=Ns(y),C=Ns(C)):(y=Jh(y),C=Jh(C)),I=l(y,C)}return I}}function sf(l){return li(function(f){return f=Lr(f,Us(It())),Kt(function(y){var C=this;return l(f,function(I){return us(I,C,y)})})})}function ku(l,f){f=f===t?" ":Ns(f);var y=f.length;if(y<2)return y?ll(f,l):f;var C=ll(f,Za(l/Xa(f)));return Xl(f)?Li(zs(C),0,l).join(""):C.slice(0,l)}function zg(l,f,y,C){var I=f&N,L=yc(l);function K(){for(var ee=-1,ae=arguments.length,Te=-1,Re=C.length,Fe=ge(Re+ae),Ve=this&&this!==Kr&&this instanceof K?L:l;++Te<Re;)Fe[Te]=C[Te];for(;ae--;)Fe[Te++]=arguments[++ee];return us(Ve,I?y:this,Fe)}return K}function sp(l){return function(f,y,C){return C&&typeof C!="number"&&ps(f,y,C)&&(y=C=t),f=xl(f),y===t?(y=f,f=0):y=xl(y),C=C===t?f<y?1:-1:xl(C),bu(f,y,C,l)}}function of(l){return function(f,y){return typeof f=="string"&&typeof y=="string"||(f=ui(f),y=ui(y)),l(f,y)}}function hs(l,f,y,C,I,L,K,ee,ae,Te){var Re=f&j,Fe=Re?K:t,Ve=Re?t:K,mt=Re?L:t,Ot=Re?t:L;f|=Re?M:B,f&=~(Re?B:M),f&A||(f&=-4);var Xt=[l,f,I,mt,Fe,Ot,Ve,ee,ae,Te],Dt=y.apply(t,Xt);return Pu(l)&&pp(Dt,Xt),Dt.placeholder=C,mp(Dt,l,f)}function Hn(l){var f=vn[l];return function(y,C){if(y=ui(y),C=C==null?0:Xn(Yt(C),292),C&&tc(y)){var I=(Ir(y)+"e").split("e"),L=f(I[0]+"e"+(+I[1]+C));return I=(Ir(L)+"e").split("e"),+(I[0]+"e"+(+I[1]-C))}return f(y)}}var Hg=ua&&1/la(new ua([,-0]))[1]==te?function(l){return new ua(l)}:ax;function op(l){return function(f){var y=Bn(f);return y==Ne?_d(f):y==st?k0(f):E0(f,l(f))}}function ai(l,f,y,C,I,L,K,ee){var ae=f&R;if(!ae&&typeof l!="function")throw new oo(c);var Te=C?C.length:0;if(Te||(f&=-97,C=I=t),K=K===t?K:yn(Yt(K),0),ee=ee===t?ee:Yt(ee),Te-=I?I.length:0,f&B){var Re=C,Fe=I;C=I=t}var Ve=ae?t:af(l),mt=[l,f,y,C,I,Re,Fe,L,K,ee];if(Ve&&Kg(mt,Ve),l=mt[0],f=mt[1],y=mt[2],C=mt[3],I=mt[4],ee=mt[9]=mt[9]===t?ae?0:l.length:yn(mt[9]-Te,0),!ee&&f&(j|P)&&(f&=-25),!f||f==N)var Ot=rf(l,f,y);else f==j||f==P?Ot=np(l,f,ee):(f==M||f==(N|M))&&!I.length?Ot=zg(l,f,y,C):Ot=xc.apply(t,mt);var Xt=Ve?Kd:pp;return mp(Xt(Ot,mt),l,f)}function ip(l,f,y,C){return l===t||zi(l,Jo[y])&&!hr.call(C,y)?f:l}function ap(l,f,y,C,I,L){return hn(l)&&hn(f)&&(L.set(f,l),al(l,f,t,ap,L),L.delete(f)),l}function lp(l){return Ip(l)?t:l}function cp(l,f,y,C,I,L){var K=y&T,ee=l.length,ae=f.length;if(ee!=ae&&!(K&&ae>ee))return!1;var Te=L.get(l),Re=L.get(f);if(Te&&Re)return Te==f&&Re==l;var Fe=-1,Ve=!0,mt=y&S?new tl:t;for(L.set(l,f),L.set(f,l);++Fe<ee;){var Ot=l[Fe],Xt=f[Fe];if(C)var Dt=K?C(Xt,Ot,Fe,f,l,L):C(Ot,Xt,Fe,l,f,L);if(Dt!==t){if(Dt)continue;Ve=!1;break}if(mt){if(!Ch(f,function(ir,mr){if(!ki(mt,mr)&&(Ot===ir||I(Ot,ir,y,C,L)))return mt.push(mr)})){Ve=!1;break}}else if(!(Ot===Xt||I(Ot,Xt,y,C,L))){Ve=!1;break}}return L.delete(l),L.delete(f),Ve}function up(l,f,y,C,I,L,K){switch(y){case Lt:if(l.byteLength!=f.byteLength||l.byteOffset!=f.byteOffset)return!1;l=l.buffer,f=f.buffer;case rt:return!(l.byteLength!=f.byteLength||!L(new lu(l),new lu(f)));case ye:case ue:case gt:return zi(+l,+f);case He:return l.name==f.name&&l.message==f.message;case or:case Ft:return l==f+"";case Ne:var ee=_d;case st:var ae=C&T;if(ee||(ee=la),l.size!=f.size&&!ae)return!1;var Te=K.get(l);if(Te)return Te==f;C|=S,K.set(l,f);var Re=cp(ee(l),ee(f),C,I,L,K);return K.delete(l),Re;case er:if(Hs)return Hs.call(l)==Hs.call(f)}return!1}function Bg(l,f,y,C,I,L){var K=y&T,ee=Nu(l),ae=ee.length,Te=Nu(f),Re=Te.length;if(ae!=Re&&!K)return!1;for(var Fe=ae;Fe--;){var Ve=ee[Fe];if(!(K?Ve in f:hr.call(f,Ve)))return!1}var mt=L.get(l),Ot=L.get(f);if(mt&&Ot)return mt==f&&Ot==l;var Xt=!0;L.set(l,f),L.set(f,l);for(var Dt=K;++Fe<ae;){Ve=ee[Fe];var ir=l[Ve],mr=f[Ve];if(C)var Mo=K?C(mr,ir,Ve,f,l,L):C(ir,mr,Ve,l,f,L);if(!(Mo===t?ir===mr||I(ir,mr,y,C,L):Mo)){Xt=!1;break}Dt||(Dt=Ve=="constructor")}if(Xt&&!Dt){var qs=l.constructor,$o=f.constructor;qs!=$o&&"constructor"in l&&"constructor"in f&&!(typeof qs=="function"&&qs instanceof qs&&typeof $o=="function"&&$o instanceof $o)&&(Xt=!1)}return L.delete(l),L.delete(f),Xt}function li(l){return Ws(df(l,t,pf),l+"")}function Nu(l){return Hd(l,ss,Io)}function Tu(l){return Hd(l,yo,Gg)}var af=Fd?function(l){return Fd.get(l)}:ax;function wc(l){for(var f=l.name+"",y=sc[f],C=hr.call(sc,f)?y.length:0;C--;){var I=y[C],L=I.func;if(L==null||L==l)return I.name}return f}function Mi(l){var f=hr.call(O,"placeholder")?O:l;return f.placeholder}function It(){var l=O.iteratee||ox;return l=l===ox?fc:l,arguments.length?l(arguments[0],arguments[1]):l}function Ru(l,f){var y=l.__data__;return bc(f)?y[typeof f=="string"?"string":"hash"]:y.map}function Au(l){for(var f=ss(l),y=f.length;y--;){var C=f[y],I=l[C];f[y]=[C,I,Fu(I)]}return f}function xa(l,f){var y=Jl(l,f);return Hh(y)?y:t}function lf(l){var f=hr.call(l,Qa),y=l[Qa];try{l[Qa]=t;var C=!0}catch{}var I=iu.call(l);return C&&(f?l[Qa]=y:delete l[Qa]),I}var Io=Ad?function(l){return l==null?[]:(l=Ar(l),ia(Ad(l),function(f){return Td.call(l,f)}))}:lx,Gg=Ad?function(l){for(var f=[];l;)aa(f,Io(l)),l=To(l);return f}:lx,Bn=zn;(du&&Bn(new du(new ArrayBuffer(1)))!=Lt||el&&Bn(new el)!=Ne||fu&&Bn(fu.resolve())!=Zt||ua&&Bn(new ua)!=st||hu&&Bn(new hu)!=Ze)&&(Bn=function(l){var f=zn(l),y=f==yt?l.constructor:t,C=y?wa(y):"";if(C)switch(C){case Dh:return Lt;case da:return Ne;case Eg:return Zt;case oc:return st;case Xo:return Ze}return f});function dp(l,f,y){for(var C=-1,I=y.length;++C<I;){var L=y[C],K=L.size;switch(L.type){case"drop":l+=K;break;case"dropRight":f-=K;break;case"take":f=Xn(f,l+K);break;case"takeRight":l=yn(l,f-K);break}}return{start:l,end:f}}function Wg(l){var f=l.match(un);return f?f[1].split($n):[]}function fp(l,f,y){f=ii(f,l);for(var C=-1,I=f.length,L=!1;++C<I;){var K=jo(f[C]);if(!(L=l!=null&&y(l,K)))break;l=l[K]}return L||++C!=I?L:(I=l==null?0:l.length,!!I&&dv(I)&&Jr(K,I)&&(Vt(l)||zu(l)))}function Iu(l){var f=l.length,y=new l.constructor(f);return f&&typeof l[0]=="string"&&hr.call(l,"index")&&(y.index=l.index,y.input=l.input),y}function Gn(l){return typeof l.constructor=="function"&&!$i(l)?ic(To(l)):{}}function j0(l,f,y){var C=l.constructor;switch(f){case rt:return Su(l);case ye:case ue:return new C(+l);case Lt:return Og(l,y);case gr:case tr:case lt:case kt:case Nt:case ze:case vr:case zr:case Or:return Mg(l,y);case Ne:return new C;case gt:case Ft:return new C(l);case or:return Dg(l);case st:return new C;case er:return Lg(l)}}function O0(l,f){var y=f.length;if(!y)return l;var C=y-1;return f[C]=(y>1?"& ":"")+f[C],f=f.join(y>2?", ":" "),l.replace(yr,`{
/* [wrapped with `+f+`] */
`)}function cf(l){return Vt(l)||zu(l)||!!(wg&&l&&l[wg])}function Jr(l,f){var y=typeof l;return f=f??G,!!f&&(y=="number"||y!="symbol"&&Z.test(l))&&l>-1&&l%1==0&&l<f}function ps(l,f,y){if(!hn(y))return!1;var C=typeof f;return(C=="number"?vo(y)&&Jr(f,y.length):C=="string"&&f in y)?zi(y[f],l):!1}function nt(l,f){if(Vt(l))return!1;var y=typeof l;return y=="number"||y=="symbol"||y=="boolean"||l==null||Lo(l)?!0:pt.test(l)||!Ye.test(l)||f!=null&&l in Ar(f)}function bc(l){var f=typeof l;return f=="string"||f=="number"||f=="symbol"||f=="boolean"?l!=="__proto__":l===null}function Pu(l){var f=wc(l),y=O[f];if(typeof y!="function"||!(f in Wt.prototype))return!1;if(l===y)return!0;var C=af(y);return!!C&&l===C[0]}function Vg(l){return!!Cd&&Cd in l}var D0=Zl?yl:cx;function $i(l){var f=l&&l.constructor,y=typeof f=="function"&&f.prototype||Jo;return l===y}function Fu(l){return l===l&&!hn(l)}function uf(l,f){return function(y){return y==null?!1:y[l]===f&&(f!==t||l in Ar(y))}}function qg(l){var f=he(l,function(C){return y.size===m&&y.clear(),C}),y=f.cache;return f}function Kg(l,f){var y=l[1],C=f[1],I=y|C,L=I<(N|R|U),K=C==U&&y==j||C==U&&y==V&&l[7].length<=f[8]||C==(U|V)&&f[7].length<=f[8]&&y==j;if(!(L||K))return l;C&N&&(l[2]=f[2],I|=y&N?0:A);var ee=f[3];if(ee){var ae=l[3];l[3]=ae?$g(ae,ee,f[4]):ee,l[4]=ae?so(l[3],g):f[4]}return ee=f[5],ee&&(ae=l[5],l[5]=ae?tp(ae,ee,f[6]):ee,l[6]=ae?so(l[5],g):f[6]),ee=f[7],ee&&(l[7]=ee),C&U&&(l[8]=l[8]==null?f[8]:Xn(l[8],f[8])),l[9]==null&&(l[9]=f[9]),l[0]=f[0],l[1]=I,l}function Yg(l){var f=[];if(l!=null)for(var y in Ar(l))f.push(y);return f}function hp(l){return iu.call(l)}function df(l,f,y){return f=yn(f===t?l.length-1:f,0),function(){for(var C=arguments,I=-1,L=yn(C.length-f,0),K=ge(L);++I<L;)K[I]=C[f+I];I=-1;for(var ee=ge(f+1);++I<f;)ee[I]=C[I];return ee[f]=y(K),us(l,this,ee)}}function Pn(l,f){return f.length<2?l:Pi(l,ns(f,0,-1))}function Po(l,f){for(var y=l.length,C=Xn(f.length,y),I=fs(l);C--;){var L=f[C];l[C]=Jr(L,y)?I[L]:t}return l}function ci(l,f){if(!(f==="constructor"&&typeof l[f]=="function")&&f!="__proto__")return l[f]}var pp=Fo(Kd),_c=jh||function(l,f){return Kr.setTimeout(l,f)},Ws=Fo(oi);function mp(l,f,y){var C=f+"";return Ws(l,O0(C,Jg(Wg(C),y)))}function Fo(l){var f=0,y=0;return function(){var C=I0(),I=we-(C-y);if(y=C,I>0){if(++f>=de)return arguments[0]}else f=0;return l.apply(t,arguments)}}function ff(l,f){var y=-1,C=l.length,I=C-1;for(f=f===t?C:f;++y<f;){var L=hc(y,I),K=l[L];l[L]=l[y],l[y]=K}return l.length=f,l}var gp=qg(function(l){var f=[];return l.charCodeAt(0)===46&&f.push(""),l.replace(Be,function(y,C,I,L){f.push(I?L.replace($s,"$1"):C||y)}),f});function jo(l){if(typeof l=="string"||Lo(l))return l;var f=l+"";return f=="0"&&1/l==-te?"-0":f}function wa(l){if(l!=null){try{return ou.call(l)}catch{}try{return l+""}catch{}}return""}function Jg(l,f){return Jn(_e,function(y){var C="_."+y[0];f&y[1]&&!xd(l,C)&&l.push(C)}),l.sort()}function Xg(l){if(l instanceof Wt)return l.clone();var f=new Qn(l.__wrapped__,l.__chain__);return f.__actions__=fs(l.__actions__),f.__index__=l.__index__,f.__values__=l.__values__,f}function hf(l,f,y){(y?ps(l,f,y):f===t)?f=1:f=yn(Yt(f),0);var C=l==null?0:l.length;if(!C||f<1)return[];for(var I=0,L=0,K=ge(Za(C/f));I<C;)K[L++]=ns(l,I,I+=f);return K}function vp(l){for(var f=-1,y=l==null?0:l.length,C=0,I=[];++f<y;){var L=l[f];L&&(I[C++]=L)}return I}function mo(){var l=arguments.length;if(!l)return[];for(var f=ge(l-1),y=arguments[0],C=l;C--;)f[C-1]=arguments[C];return aa(Vt(y)?fs(y):[y],an(f,1))}var pr=Kt(function(l,f){return kn(l)?ri(l,an(f,1,kn,!0)):[]}),Fn=Kt(function(l,f){var y=ms(f);return kn(y)&&(y=t),kn(l)?ri(l,an(f,1,kn,!0),It(y,2)):[]}),xn=Kt(function(l,f){var y=ms(f);return kn(y)&&(y=t),kn(l)?ri(l,an(f,1,kn,!0),t,y):[]});function Wn(l,f,y){var C=l==null?0:l.length;return C?(f=y||f===t?1:Yt(f),ns(l,f<0?0:f,C)):[]}function Vs(l,f,y){var C=l==null?0:l.length;return C?(f=y||f===t?1:Yt(f),f=C-f,ns(l,0,f<0?0:f)):[]}function Ec(l,f){return l&&l.length?_u(l,It(f,3),!0,!0):[]}function Cn(l,f){return l&&l.length?_u(l,It(f,3),!0):[]}function ju(l,f,y,C){var I=l==null?0:l.length;return I?(y&&typeof y!="number"&&ps(l,f,y)&&(y=0,C=I),Ig(l,f,y,C)):[]}function ba(l,f,y){var C=l==null?0:l.length;if(!C)return-1;var I=y==null?0:Yt(y);return I<0&&(I=yn(C+I,0)),wd(l,It(f,3),I)}function Ou(l,f,y){var C=l==null?0:l.length;if(!C)return-1;var I=C-1;return y!==t&&(I=Yt(y),I=y<0?yn(C+I,0):Xn(I,C-1)),wd(l,It(f,3),I,!0)}function pf(l){var f=l==null?0:l.length;return f?an(l,1):[]}function Du(l){var f=l==null?0:l.length;return f?an(l,te):[]}function Ts(l,f){var y=l==null?0:l.length;return y?(f=f===t?1:Yt(f),an(l,f)):[]}function yp(l){for(var f=-1,y=l==null?0:l.length,C={};++f<y;){var I=l[f];C[I[0]]=I[1]}return C}function fl(l){return l&&l.length?l[0]:t}function Ui(l,f,y){var C=l==null?0:l.length;if(!C)return-1;var I=y==null?0:Yt(y);return I<0&&(I=yn(C+I,0)),Yl(l,f,I)}function mf(l){var f=l==null?0:l.length;return f?ns(l,0,-1):[]}var xp=Kt(function(l){var f=Lr(l,gc);return f.length&&f[0]===l[0]?Bd(f):[]}),_a=Kt(function(l){var f=ms(l),y=Lr(l,gc);return f===ms(y)?f=t:y.pop(),y.length&&y[0]===l[0]?Bd(y,It(f,2)):[]}),gf=Kt(function(l){var f=ms(l),y=Lr(l,gc);return f=typeof f=="function"?f:t,f&&y.pop(),y.length&&y[0]===l[0]?Bd(y,t,f):[]});function Ea(l,f){return l==null?"":Id.call(l,f)}function ms(l){var f=l==null?0:l.length;return f?l[f-1]:t}function Lu(l,f,y){var C=l==null?0:l.length;if(!C)return-1;var I=C;return y!==t&&(I=Yt(y),I=I<0?yn(C+I,0):Xn(I,C-1)),f===f?N0(l,f,I):wd(l,ig,I,!0)}function wp(l,f){return l&&l.length?qd(l,Yt(f)):t}var vf=Kt(Mu);function Mu(l,f){return l&&l.length&&f&&f.length?dn(l,f):l}function gs(l,f,y){return l&&l.length&&f&&f.length?dn(l,f,It(y,2)):l}function Sa(l,f,y){return l&&l.length&&f&&f.length?dn(l,f,t,y):l}var Oo=li(function(l,f){var y=l==null?0:l.length,C=Ud(l,f);return Sn(l,Lr(f,function(I){return Jr(I,y)?+I:I}).sort(ep)),C});function Rs(l,f){var y=[];if(!(l&&l.length))return y;var C=-1,I=[],L=l.length;for(f=It(f,3);++C<L;){var K=l[C];f(K,C,l)&&(y.push(K),I.push(C))}return Sn(l,I),y}function yf(l){return l==null?l:Pd.call(l)}function bp(l,f,y){var C=l==null?0:l.length;return C?(y&&typeof y!="number"&&ps(l,f,y)?(f=0,y=C):(f=f==null?0:Yt(f),y=y===t?C:Yt(y)),ns(l,f,y)):[]}function _p(l,f){return pc(l,f)}function L0(l,f,y){return Yd(l,f,It(y,2))}function Ca(l,f){var y=l==null?0:l.length;if(y){var C=pc(l,f);if(C<y&&zi(l[C],f))return C}return-1}function Qg(l,f){return pc(l,f,!0)}function Ep(l,f,y){return Yd(l,f,It(y,2),!0)}function hl(l,f){var y=l==null?0:l.length;if(y){var C=pc(l,f,!0)-1;if(zi(l[C],f))return C}return-1}function Sp(l){return l&&l.length?Yh(l):[]}function pl(l,f){return l&&l.length?Yh(l,It(f,2)):[]}function Zg(l){var f=l==null?0:l.length;return f?ns(l,1,f):[]}function ev(l,f,y){return l&&l.length?(f=y||f===t?1:Yt(f),ns(l,0,f<0?0:f)):[]}function Cp(l,f,y){var C=l==null?0:l.length;return C?(f=y||f===t?1:Yt(f),f=C-f,ns(l,f<0?0:f,C)):[]}function xf(l,f){return l&&l.length?_u(l,It(f,3),!1,!0):[]}function M0(l,f){return l&&l.length?_u(l,It(f,3)):[]}var $0=Kt(function(l){return Di(an(l,1,kn,!0))}),tv=Kt(function(l){var f=ms(l);return kn(f)&&(f=t),Di(an(l,1,kn,!0),It(f,2))}),rv=Kt(function(l){var f=ms(l);return f=typeof f=="function"?f:t,Di(an(l,1,kn,!0),t,f)});function ml(l){return l&&l.length?Di(l):[]}function U0(l,f){return l&&l.length?Di(l,It(f,2)):[]}function Sc(l,f){return f=typeof f=="function"?f:t,l&&l.length?Di(l,t,f):[]}function wf(l){if(!(l&&l.length))return[];var f=0;return l=ia(l,function(y){if(kn(y))return f=yn(y.length,f),!0}),Rh(f,function(y){return Lr(l,Nh(y))})}function Zr(l,f){if(!(l&&l.length))return[];var y=wf(l);return f==null?y:Lr(y,function(C){return us(f,t,C)})}var z0=Kt(function(l,f){return kn(l)?ri(l,f):[]}),nv=Kt(function(l){return Xd(ia(l,kn))}),H0=Kt(function(l){var f=ms(l);return kn(f)&&(f=t),Xd(ia(l,kn),It(f,2))}),B0=Kt(function(l){var f=ms(l);return f=typeof f=="function"?f:t,Xd(ia(l,kn),t,f)}),sv=Kt(wf);function ov(l,f){return Eu(l||[],f||[],sl)}function G0(l,f){return Eu(l||[],f||[],cl)}var go=Kt(function(l){var f=l.length,y=f>1?l[f-1]:t;return y=typeof y=="function"?(l.pop(),y):t,Zr(l,y)});function bf(l){var f=O(l);return f.__chain__=!0,f}function W0(l,f){return f(l),l}function Do(l,f){return f(l)}var _f=li(function(l){var f=l.length,y=f?l[0]:0,C=this.__wrapped__,I=function(L){return Ud(L,l)};return f>1||this.__actions__.length||!(C instanceof Wt)||!Jr(y)?this.thru(I):(C=C.slice(y,+y+(f?1:0)),C.__actions__.push({func:Do,args:[I],thisArg:t}),new Qn(C,this.__chain__).thru(function(L){return f&&!L.length&&L.push(t),L}))});function gl(){return bf(this)}function Ef(){return new Qn(this.value(),this.__chain__)}function kp(){this.__values__===t&&(this.__values__=qE(this.value()));var l=this.__index__>=this.__values__.length,f=l?t:this.__values__[this.__index__++];return{done:l,value:f}}function Np(){return this}function V0(l){for(var f,y=this;y instanceof Qo;){var C=Xg(y);C.__index__=0,C.__values__=t,f?I.__wrapped__=C:f=C;var I=C;y=y.__wrapped__}return I.__wrapped__=l,f}function Tp(){var l=this.__wrapped__;if(l instanceof Wt){var f=l;return this.__actions__.length&&(f=new Wt(this)),f=f.reverse(),f.__actions__.push({func:Do,args:[yf],thisArg:t}),new Qn(f,this.__chain__)}return this.thru(yf)}function q0(){return mc(this.__wrapped__,this.__actions__)}var iv=ef(function(l,f,y){hr.call(l,y)?++l[y]:ti(l,y,1)});function av(l,f,y){var C=Vt(l)?_h:gu;return y&&ps(l,f,y)&&(f=t),C(l,It(f,3))}function Sf(l,f){var y=Vt(l)?ia:Uh;return y(l,It(f,3))}var Cf=dl(ba),lv=dl(Ou);function Rp(l,f){return an(vl(l,f),1)}function K0(l,f){return an(vl(l,f),te)}function cv(l,f,y){return y=y===t?1:Yt(y),an(vl(l,f),y)}function kf(l,f){var y=Vt(l)?Jn:ni;return y(l,It(f,3))}function $u(l,f){var y=Vt(l)?yd:Ag;return y(l,It(f,3))}var Ap=ef(function(l,f,y){hr.call(l,y)?l[y].push(f):ti(l,y,[f])});function Nf(l,f,y,C){l=vo(l)?l:Af(l),y=y&&!C?Yt(y):0;var I=l.length;return y<0&&(y=yn(I+y,0)),fv(l)?y<=I&&l.indexOf(f,y)>-1:!!I&&Yl(l,f,y)>-1}var uv=Kt(function(l,f,y){var C=-1,I=typeof f=="function",L=vo(l)?ge(l.length):[];return ni(l,function(K){L[++C]=I?us(f,K,y):uo(K,f,y)}),L}),Y0=ef(function(l,f,y){ti(l,y,f)});function vl(l,f){var y=Vt(l)?Lr:Gh;return y(l,It(f,3))}function J0(l,f,y,C){return l==null?[]:(Vt(f)||(f=f==null?[]:[f]),y=C?t:y,Vt(y)||(y=y==null?[]:[y]),wu(l,f,y))}var Uu=ef(function(l,f,y){l[y?0:1].push(f)},function(){return[[],[]]});function X0(l,f,y){var C=Vt(l)?Sh:lg,I=arguments.length<3;return C(l,It(f,4),y,I,ni)}function Tf(l,f,y){var C=Vt(l)?x0:lg,I=arguments.length<3;return C(l,It(f,4),y,I,Ag)}function o(l,f){var y=Vt(l)?ia:Uh;return y(l,De(It(f,3)))}function a(l){var f=Vt(l)?ei:rs;return f(l)}function h(l,f,y){(y?ps(l,f,y):f===t)?f=1:f=Yt(f);var C=Vt(l)?nl:qh;return C(l,f)}function v(l){var f=Vt(l)?Tg:ho;return f(l)}function _(l){if(l==null)return 0;if(vo(l))return fv(l)?Xa(l):l.length;var f=Bn(l);return f==Ne||f==st?l.size:Oi(l).length}function k(l,f,y){var C=Vt(l)?Ch:Kh;return y&&ps(l,f,y)&&(f=t),C(l,It(f,3))}var F=Kt(function(l,f){if(l==null)return[];var y=f.length;return y>1&&ps(l,f[0],f[1])?f=[]:y>2&&ps(f[0],f[1],f[2])&&(f=[f[0]]),wu(l,an(f,1),[])}),W=Br||function(){return Kr.Date.now()};function Q(l,f){if(typeof f!="function")throw new oo(c);return l=Yt(l),function(){if(--l<1)return f.apply(this,arguments)}}function ve(l,f,y){return f=y?t:f,f=l&&f==null?l.length:f,ai(l,U,t,t,t,t,f)}function Pe(l,f){var y;if(typeof f!="function")throw new oo(c);return l=Yt(l),function(){return--l>0&&(y=f.apply(this,arguments)),l<=1&&(f=t),y}}var je=Kt(function(l,f,y){var C=N;if(y.length){var I=so(y,Mi(je));C|=M}return ai(l,C,f,y,I)}),Ie=Kt(function(l,f,y){var C=N|R;if(y.length){var I=so(y,Mi(Ie));C|=M}return ai(f,C,l,y,I)});function Xe(l,f,y){f=y?t:f;var C=ai(l,j,t,t,t,t,t,f);return C.placeholder=Xe.placeholder,C}function at(l,f,y){f=y?t:f;var C=ai(l,P,t,t,t,t,t,f);return C.placeholder=at.placeholder,C}function ct(l,f,y){var C,I,L,K,ee,ae,Te=0,Re=!1,Fe=!1,Ve=!0;if(typeof l!="function")throw new oo(c);f=ui(f)||0,hn(y)&&(Re=!!y.leading,Fe="maxWait"in y,L=Fe?yn(ui(y.maxWait)||0,f):L,Ve="trailing"in y?!!y.trailing:Ve);function mt(Nn){var Hi=C,wl=I;return C=I=t,Te=Nn,K=l.apply(wl,Hi),K}function Ot(Nn){return Te=Nn,ee=_c(ir,f),Re?mt(Nn):K}function Xt(Nn){var Hi=Nn-ae,wl=Nn-Te,iS=f-Hi;return Fe?Xn(iS,L-wl):iS}function Dt(Nn){var Hi=Nn-ae,wl=Nn-Te;return ae===t||Hi>=f||Hi<0||Fe&&wl>=L}function ir(){var Nn=W();if(Dt(Nn))return mr(Nn);ee=_c(ir,Xt(Nn))}function mr(Nn){return ee=t,Ve&&C?mt(Nn):(C=I=t,K)}function Mo(){ee!==t&&Qh(ee),Te=0,C=ae=I=ee=t}function qs(){return ee===t?K:mr(W())}function $o(){var Nn=W(),Hi=Dt(Nn);if(C=arguments,I=this,ae=Nn,Hi){if(ee===t)return Ot(ae);if(Fe)return Qh(ee),ee=_c(ir,f),mt(ae)}return ee===t&&(ee=_c(ir,f)),K}return $o.cancel=Mo,$o.flush=qs,$o}var fn=Kt(function(l,f){return $h(l,1,f)}),fe=Kt(function(l,f,y){return $h(l,ui(f)||0,y)});function re(l){return ai(l,Y)}function he(l,f){if(typeof l!="function"||f!=null&&typeof f!="function")throw new oo(c);var y=function(){var C=arguments,I=f?f.apply(this,C):C[0],L=y.cache;if(L.has(I))return L.get(I);var K=l.apply(this,C);return y.cache=L.set(I,K)||L,K};return y.cache=new(he.Cache||io),y}he.Cache=io;function De(l){if(typeof l!="function")throw new oo(c);return function(){var f=arguments;switch(f.length){case 0:return!l.call(this);case 1:return!l.call(this,f[0]);case 2:return!l.call(this,f[0],f[1]);case 3:return!l.call(this,f[0],f[1],f[2])}return!l.apply(this,f)}}function ft(l){return Pe(2,l)}var Tt=jg(function(l,f){f=f.length==1&&Vt(f[0])?Lr(f[0],Us(It())):Lr(an(f,1),Us(It()));var y=f.length;return Kt(function(C){for(var I=-1,L=Xn(C.length,y);++I<L;)C[I]=f[I].call(this,C[I]);return us(l,this,C)})}),_t=Kt(function(l,f){var y=so(f,Mi(_t));return ai(l,M,t,f,y)}),jt=Kt(function(l,f){var y=so(f,Mi(jt));return ai(l,B,t,f,y)}),jn=li(function(l,f){return ai(l,V,t,t,t,f)});function wr(l,f){if(typeof l!="function")throw new oo(c);return f=f===t?f:Yt(f),Kt(l,f)}function ka(l,f){if(typeof l!="function")throw new oo(c);return f=f==null?0:yn(Yt(f),0),Kt(function(y){var C=y[f],I=Li(y,0,f);return C&&aa(I,C),us(l,this,I)})}function Q0(l,f,y){var C=!0,I=!0;if(typeof l!="function")throw new oo(c);return hn(y)&&(C="leading"in y?!!y.leading:C,I="trailing"in y?!!y.trailing:I),ct(l,f,{leading:C,maxWait:f,trailing:I})}function uF(l){return ve(l,1)}function dF(l,f){return _t(Qd(f),l)}function fF(){if(!arguments.length)return[];var l=arguments[0];return Vt(l)?l:[l]}function hF(l){return ks(l,E)}function pF(l,f){return f=typeof f=="function"?f:t,ks(l,E,f)}function mF(l){return ks(l,x|E)}function gF(l,f){return f=typeof f=="function"?f:t,ks(l,x|E,f)}function vF(l,f){return f==null||mu(l,f,ss(f))}function zi(l,f){return l===f||l!==l&&f!==f}var yF=of(ga),xF=of(function(l,f){return l>=f}),zu=Gd((function(){return arguments})())?Gd:function(l){return wn(l)&&hr.call(l,"callee")&&!Td.call(l,"callee")},Vt=ge.isArray,wF=wh?Us(wh):Pg;function vo(l){return l!=null&&dv(l.length)&&!yl(l)}function kn(l){return wn(l)&&vo(l)}function bF(l){return l===!0||l===!1||wn(l)&&zn(l)==ye}var Cc=Oh||cx,_F=_s?Us(_s):ji;function EF(l){return wn(l)&&l.nodeType===1&&!Ip(l)}function SF(l){if(l==null)return!0;if(vo(l)&&(Vt(l)||typeof l=="string"||typeof l.splice=="function"||Cc(l)||Rf(l)||zu(l)))return!l.length;var f=Bn(l);if(f==Ne||f==st)return!l.size;if($i(l))return!Oi(l).length;for(var y in l)if(hr.call(l,y))return!1;return!0}function CF(l,f){return fo(l,f)}function kF(l,f,y){y=typeof y=="function"?y:t;var C=y?y(l,f):t;return C===t?fo(l,f,t,y):!!C}function Z0(l){if(!wn(l))return!1;var f=zn(l);return f==He||f==ke||typeof l.message=="string"&&typeof l.name=="string"&&!Ip(l)}function NF(l){return typeof l=="number"&&tc(l)}function yl(l){if(!hn(l))return!1;var f=zn(l);return f==Ue||f==Le||f==xe||f==Bt}function BE(l){return typeof l=="number"&&l==Yt(l)}function dv(l){return typeof l=="number"&&l>-1&&l%1==0&&l<=G}function hn(l){var f=typeof l;return l!=null&&(f=="object"||f=="function")}function wn(l){return l!=null&&typeof l=="object"}var GE=Ja?Us(Ja):Fg;function TF(l,f){return l===f||dc(l,f,Au(f))}function RF(l,f,y){return y=typeof y=="function"?y:t,dc(l,f,Au(f),y)}function AF(l){return WE(l)&&l!=+l}function IF(l){if(D0(l))throw new $t(i);return Hh(l)}function PF(l){return l===null}function FF(l){return l==null}function WE(l){return typeof l=="number"||wn(l)&&zn(l)==gt}function Ip(l){if(!wn(l)||zn(l)!=yt)return!1;var f=To(l);if(f===null)return!0;var y=hr.call(f,"constructor")&&f.constructor;return typeof y=="function"&&y instanceof y&&ou.call(y)==kd}var ex=vd?Us(vd):yu;function jF(l){return BE(l)&&l>=-G&&l<=G}var VE=Kl?Us(Kl):si;function fv(l){return typeof l=="string"||!Vt(l)&&wn(l)&&zn(l)==Ft}function Lo(l){return typeof l=="symbol"||wn(l)&&zn(l)==er}var Rf=ng?Us(ng):xu;function OF(l){return l===t}function DF(l){return wn(l)&&Bn(l)==Ze}function LF(l){return wn(l)&&zn(l)==dt}var MF=of(va),$F=of(function(l,f){return l<=f});function qE(l){if(!l)return[];if(vo(l))return fv(l)?zs(l):fs(l);if(Ri&&l[Ri])return C0(l[Ri]());var f=Bn(l),y=f==Ne?_d:f==st?la:Af;return y(l)}function xl(l){if(!l)return l===0?l:0;if(l=ui(l),l===te||l===-te){var f=l<0?-1:1;return f*z}return l===l?l:0}function Yt(l){var f=xl(l),y=f%1;return f===f?y?f-y:f:0}function KE(l){return l?Ii(Yt(l),0,D):0}function ui(l){if(typeof l=="number")return l;if(Lo(l))return J;if(hn(l)){var f=typeof l.valueOf=="function"?l.valueOf():l;l=hn(f)?f+"":f}if(typeof l!="string")return l===0?l:+l;l=cg(l);var y=Ga.test(l);return y||ut.test(l)?md(l.slice(2),y?2:8):ta.test(l)?J:+l}function YE(l){return Ao(l,yo(l))}function UF(l){return l?Ii(Yt(l),-G,G):l===0?l:0}function Ir(l){return l==null?"":Ns(l)}var zF=vc(function(l,f){if($i(f)||vo(f)){Ao(f,ss(f),l);return}for(var y in f)hr.call(f,y)&&sl(l,y,f[y])}),JE=vc(function(l,f){Ao(f,yo(f),l)}),hv=vc(function(l,f,y,C){Ao(f,yo(f),l,C)}),HF=vc(function(l,f,y,C){Ao(f,ss(f),l,C)}),BF=li(Ud);function GF(l,f){var y=ic(l);return f==null?y:Wr(y,f)}var WF=Kt(function(l,f){l=Ar(l);var y=-1,C=f.length,I=C>2?f[2]:t;for(I&&ps(f[0],f[1],I)&&(C=1);++y<C;)for(var L=f[y],K=yo(L),ee=-1,ae=K.length;++ee<ae;){var Te=K[ee],Re=l[Te];(Re===t||zi(Re,Jo[Te])&&!hr.call(l,Te))&&(l[Te]=L[Te])}return l}),VF=Kt(function(l){return l.push(t,ap),us(XE,t,l)});function qF(l,f){return og(l,It(f,3),Gs)}function KF(l,f){return og(l,It(f,3),ma)}function YF(l,f){return l==null?l:zd(l,It(f,3),yo)}function JF(l,f){return l==null?l:vu(l,It(f,3),yo)}function XF(l,f){return l&&Gs(l,It(f,3))}function QF(l,f){return l&&ma(l,It(f,3))}function ZF(l){return l==null?[]:uc(l,ss(l))}function ej(l){return l==null?[]:uc(l,yo(l))}function tx(l,f,y){var C=l==null?t:Pi(l,f);return C===t?y:C}function tj(l,f){return l!=null&&fp(l,f,co)}function rx(l,f){return l!=null&&fp(l,f,il)}var rj=Ug(function(l,f,y){f!=null&&typeof f.toString!="function"&&(f=iu.call(f)),l[f]=y},sx(xo)),nj=Ug(function(l,f,y){f!=null&&typeof f.toString!="function"&&(f=iu.call(f)),hr.call(l,f)?l[f].push(y):l[f]=[y]},It),sj=Kt(uo);function ss(l){return vo(l)?Zo(l):Oi(l)}function yo(l){return vo(l)?Zo(l,!0):Bh(l)}function oj(l,f){var y={};return f=It(f,3),Gs(l,function(C,I,L){ti(y,f(C,I,L),C)}),y}function ij(l,f){var y={};return f=It(f,3),Gs(l,function(C,I,L){ti(y,I,f(C,I,L))}),y}var aj=vc(function(l,f,y){al(l,f,y)}),XE=vc(function(l,f,y,C){al(l,f,y,C)}),lj=li(function(l,f){var y={};if(l==null)return y;var C=!1;f=Lr(f,function(L){return L=ii(L,l),C||(C=L.length>1),L}),Ao(l,Tu(l),y),C&&(y=ks(y,x|b|E,lp));for(var I=f.length;I--;)Jd(y,f[I]);return y});function cj(l,f){return QE(l,De(It(f)))}var uj=li(function(l,f){return l==null?{}:Vh(l,f)});function QE(l,f){if(l==null)return{};var y=Lr(Tu(l),function(C){return[C]});return f=It(f),ya(l,y,function(C,I){return f(C,I[0])})}function dj(l,f,y){f=ii(f,l);var C=-1,I=f.length;for(I||(I=1,l=t);++C<I;){var L=l==null?t:l[jo(f[C])];L===t&&(C=I,L=y),l=yl(L)?L.call(l):L}return l}function fj(l,f,y){return l==null?l:cl(l,f,y)}function hj(l,f,y,C){return C=typeof C=="function"?C:t,l==null?l:cl(l,f,y,C)}var ZE=op(ss),eS=op(yo);function pj(l,f,y){var C=Vt(l),I=C||Cc(l)||Rf(l);if(f=It(f,4),y==null){var L=l&&l.constructor;I?y=C?new L:[]:hn(l)?y=yl(L)?ic(To(l)):{}:y={}}return(I?Jn:Gs)(l,function(K,ee,ae){return f(y,K,ee,ae)}),y}function mj(l,f){return l==null?!0:Jd(l,f)}function gj(l,f,y){return l==null?l:Xh(l,f,Qd(y))}function vj(l,f,y,C){return C=typeof C=="function"?C:t,l==null?l:Xh(l,f,Qd(y),C)}function Af(l){return l==null?[]:nu(l,ss(l))}function yj(l){return l==null?[]:nu(l,yo(l))}function xj(l,f,y){return y===t&&(y=f,f=t),y!==t&&(y=ui(y),y=y===y?y:0),f!==t&&(f=ui(f),f=f===f?f:0),Ii(ui(l),f,y)}function wj(l,f,y){return f=xl(f),y===t?(y=f,f=0):y=xl(y),l=ui(l),zh(l,f,y)}function bj(l,f,y){if(y&&typeof y!="boolean"&&ps(l,f,y)&&(f=y=t),y===t&&(typeof f=="boolean"?(y=f,f=t):typeof l=="boolean"&&(y=l,l=t)),l===t&&f===t?(l=0,f=1):(l=xl(l),f===t?(f=l,l=0):f=xl(f)),l>f){var C=l;l=f,f=C}if(y||l%1||f%1){var I=uu();return Xn(l+I*(f-l+yh("1e-"+((I+"").length-1))),f)}return hc(l,f)}var _j=ul(function(l,f,y){return f=f.toLowerCase(),l+(y?tS(f):f)});function tS(l){return nx(Ir(l).toLowerCase())}function rS(l){return l=Ir(l),l&&l.replace(Oe,fg).replace(tu,"")}function Ej(l,f,y){l=Ir(l),f=Ns(f);var C=l.length;y=y===t?C:Ii(Yt(y),0,C);var I=y;return y-=f.length,y>=0&&l.slice(y,I)==f}function Sj(l){return l=Ir(l),l&&wi.test(l)?l.replace(as,hg):l}function Cj(l){return l=Ir(l),l&&dr.test(l)?l.replace(qt,"\\$&"):l}var kj=ul(function(l,f,y){return l+(y?"-":"")+f.toLowerCase()}),Nj=ul(function(l,f,y){return l+(y?" ":"")+f.toLowerCase()}),Tj=rp("toLowerCase");function Rj(l,f,y){l=Ir(l),f=Yt(f);var C=f?Xa(l):0;if(!f||C>=f)return l;var I=(f-C)/2;return ku(ca(I),y)+l+ku(Za(I),y)}function Aj(l,f,y){l=Ir(l),f=Yt(f);var C=f?Xa(l):0;return f&&C<f?l+ku(f-C,y):l}function Ij(l,f,y){l=Ir(l),f=Yt(f);var C=f?Xa(l):0;return f&&C<f?ku(f-C,y)+l:l}function Pj(l,f,y){return y||f==null?f=0:f&&(f=+f),_g(Ir(l).replace(Gt,""),f||0)}function Fj(l,f,y){return(y?ps(l,f,y):f===t)?f=1:f=Yt(f),ll(Ir(l),f)}function jj(){var l=arguments,f=Ir(l[0]);return l.length<3?f:f.replace(l[1],l[2])}var Oj=ul(function(l,f,y){return l+(y?"_":"")+f.toLowerCase()});function Dj(l,f,y){return y&&typeof y!="number"&&ps(l,f,y)&&(f=y=t),y=y===t?D:y>>>0,y?(l=Ir(l),l&&(typeof f=="string"||f!=null&&!ex(f))&&(f=Ns(f),!f&&Xl(l))?Li(zs(l),0,y):l.split(f,y)):[]}var Lj=ul(function(l,f,y){return l+(y?" ":"")+nx(f)});function Mj(l,f,y){return l=Ir(l),y=y==null?0:Ii(Yt(y),0,l.length),f=Ns(f),l.slice(y,y+f.length)==f}function $j(l,f,y){var C=O.templateSettings;y&&ps(l,f,y)&&(f=t),l=Ir(l),f=hv({},f,C,ip);var I=hv({},f.imports,C.imports,ip),L=ss(I),K=nu(I,L),ee,ae,Te=0,Re=f.interpolate||tt,Fe="__p += '",Ve=su((f.escape||tt).source+"|"+Re.source+"|"+(Re===pe?no:tt).source+"|"+(f.evaluate||tt).source+"|$","g"),mt="//# sourceURL="+(hr.call(f,"sourceURL")?(f.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++g0+"]")+`
`;l.replace(Ve,function(Dt,ir,mr,Mo,qs,$o){return mr||(mr=Mo),Fe+=l.slice(Te,$o).replace(br,pg),ir&&(ee=!0,Fe+=`' +
__e(`+ir+`) +
'`),qs&&(ae=!0,Fe+=`';
`+qs+`;
__p += '`),mr&&(Fe+=`' +
((__t = (`+mr+`)) == null ? '' : __t) +
'`),Te=$o+Dt.length,Dt}),Fe+=`';
`;var Ot=hr.call(f,"variable")&&f.variable;if(!Ot)Fe=`with (obj) {
`+Fe+`
}
`;else if(Ba.test(Ot))throw new $t(u);Fe=(ae?Fe.replace(sn,""):Fe).replace(mn,"$1").replace(cn,"$1;"),Fe="function("+(Ot||"obj")+`) {
`+(Ot?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(ee?", __e = _.escape":"")+(ae?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+Fe+`return __p
}`;var Xt=sS(function(){return xr(L,mt+"return "+Fe).apply(t,K)});if(Xt.source=Fe,Z0(Xt))throw Xt;return Xt}function Uj(l){return Ir(l).toLowerCase()}function zj(l){return Ir(l).toUpperCase()}function Hj(l,f,y){if(l=Ir(l),l&&(y||f===t))return cg(l);if(!l||!(f=Ns(f)))return l;var C=zs(l),I=zs(f),L=ug(C,I),K=Ah(C,I)+1;return Li(C,L,K).join("")}function Bj(l,f,y){if(l=Ir(l),l&&(y||f===t))return l.slice(0,Sd(l)+1);if(!l||!(f=Ns(f)))return l;var C=zs(l),I=Ah(C,zs(f))+1;return Li(C,0,I).join("")}function Gj(l,f,y){if(l=Ir(l),l&&(y||f===t))return l.replace(Gt,"");if(!l||!(f=Ns(f)))return l;var C=zs(l),I=ug(C,zs(f));return Li(C,I).join("")}function Wj(l,f){var y=ce,C=X;if(hn(f)){var I="separator"in f?f.separator:I;y="length"in f?Yt(f.length):y,C="omission"in f?Ns(f.omission):C}l=Ir(l);var L=l.length;if(Xl(l)){var K=zs(l);L=K.length}if(y>=L)return l;var ee=y-Xa(C);if(ee<1)return C;var ae=K?Li(K,0,ee).join(""):l.slice(0,ee);if(I===t)return ae+C;if(K&&(ee+=ae.length-ee),ex(I)){if(l.slice(ee).search(I)){var Te,Re=ae;for(I.global||(I=su(I.source,Ir(_i.exec(I))+"g")),I.lastIndex=0;Te=I.exec(Re);)var Fe=Te.index;ae=ae.slice(0,Fe===t?ee:Fe)}}else if(l.indexOf(Ns(I),ee)!=ee){var Ve=ae.lastIndexOf(I);Ve>-1&&(ae=ae.slice(0,Ve))}return ae+C}function Vj(l){return l=Ir(l),l&&An.test(l)?l.replace(_n,mg):l}var qj=ul(function(l,f,y){return l+(y?" ":"")+f.toUpperCase()}),nx=rp("toUpperCase");function nS(l,f,y){return l=Ir(l),f=y?t:f,f===t?S0(l)?T0(l):b0(l):l.match(f)||[]}var sS=Kt(function(l,f){try{return us(l,t,f)}catch(y){return Z0(y)?y:new $t(y)}}),Kj=li(function(l,f){return Jn(f,function(y){y=jo(y),ti(l,y,je(l[y],l))}),l});function Yj(l){var f=l==null?0:l.length,y=It();return l=f?Lr(l,function(C){if(typeof C[1]!="function")throw new oo(c);return[y(C[0]),C[1]]}):[],Kt(function(C){for(var I=-1;++I<f;){var L=l[I];if(us(L[0],this,C))return us(L[1],this,C)}})}function Jj(l){return Rg(ks(l,x))}function sx(l){return function(){return l}}function Xj(l,f){return l==null||l!==l?f:l}var Qj=nf(),Zj=nf(!0);function xo(l){return l}function ox(l){return fc(typeof l=="function"?l:ks(l,x))}function eO(l){return Vd(ks(l,x))}function tO(l,f){return Yr(l,ks(f,x))}var rO=Kt(function(l,f){return function(y){return uo(y,l,f)}}),nO=Kt(function(l,f){return function(y){return uo(l,y,f)}});function ix(l,f,y){var C=ss(f),I=uc(f,C);y==null&&!(hn(f)&&(I.length||!C.length))&&(y=f,f=l,l=this,I=uc(f,ss(f)));var L=!(hn(y)&&"chain"in y)||!!y.chain,K=yl(l);return Jn(I,function(ee){var ae=f[ee];l[ee]=ae,K&&(l.prototype[ee]=function(){var Te=this.__chain__;if(L||Te){var Re=l(this.__wrapped__),Fe=Re.__actions__=fs(this.__actions__);return Fe.push({func:ae,args:arguments,thisArg:l}),Re.__chain__=Te,Re}return ae.apply(l,aa([this.value()],arguments))})}),l}function sO(){return Kr._===this&&(Kr._=yg),this}function ax(){}function oO(l){return l=Yt(l),Kt(function(f){return qd(f,l)})}var iO=sf(Lr),aO=sf(_h),lO=sf(Ch);function oS(l){return nt(l)?Nh(jo(l)):Qr(l)}function cO(l){return function(f){return l==null?t:Pi(l,f)}}var uO=sp(),dO=sp(!0);function lx(){return[]}function cx(){return!1}function fO(){return{}}function hO(){return""}function pO(){return!0}function mO(l,f){if(l=Yt(l),l<1||l>G)return[];var y=D,C=Xn(l,D);f=It(f),l-=D;for(var I=Rh(C,f);++y<l;)f(y);return I}function gO(l){return Vt(l)?Lr(l,jo):Lo(l)?[l]:fs(gp(Ir(l)))}function vO(l){var f=++ec;return Ir(l)+f}var yO=Cu(function(l,f){return l+f},0),xO=Hn("ceil"),wO=Cu(function(l,f){return l/f},1),bO=Hn("floor");function _O(l){return l&&l.length?ol(l,xo,ga):t}function EO(l,f){return l&&l.length?ol(l,It(f,2),ga):t}function SO(l){return ag(l,xo)}function CO(l,f){return ag(l,It(f,2))}function kO(l){return l&&l.length?ol(l,xo,va):t}function NO(l,f){return l&&l.length?ol(l,It(f,2),va):t}var TO=Cu(function(l,f){return l*f},1),RO=Hn("round"),AO=Cu(function(l,f){return l-f},0);function IO(l){return l&&l.length?Th(l,xo):0}function PO(l,f){return l&&l.length?Th(l,It(f,2)):0}return O.after=Q,O.ary=ve,O.assign=zF,O.assignIn=JE,O.assignInWith=hv,O.assignWith=HF,O.at=BF,O.before=Pe,O.bind=je,O.bindAll=Kj,O.bindKey=Ie,O.castArray=fF,O.chain=bf,O.chunk=hf,O.compact=vp,O.concat=mo,O.cond=Yj,O.conforms=Jj,O.constant=sx,O.countBy=iv,O.create=GF,O.curry=Xe,O.curryRight=at,O.debounce=ct,O.defaults=WF,O.defaultsDeep=VF,O.defer=fn,O.delay=fe,O.difference=pr,O.differenceBy=Fn,O.differenceWith=xn,O.drop=Wn,O.dropRight=Vs,O.dropRightWhile=Ec,O.dropWhile=Cn,O.fill=ju,O.filter=Sf,O.flatMap=Rp,O.flatMapDeep=K0,O.flatMapDepth=cv,O.flatten=pf,O.flattenDeep=Du,O.flattenDepth=Ts,O.flip=re,O.flow=Qj,O.flowRight=Zj,O.fromPairs=yp,O.functions=ZF,O.functionsIn=ej,O.groupBy=Ap,O.initial=mf,O.intersection=xp,O.intersectionBy=_a,O.intersectionWith=gf,O.invert=rj,O.invertBy=nj,O.invokeMap=uv,O.iteratee=ox,O.keyBy=Y0,O.keys=ss,O.keysIn=yo,O.map=vl,O.mapKeys=oj,O.mapValues=ij,O.matches=eO,O.matchesProperty=tO,O.memoize=he,O.merge=aj,O.mergeWith=XE,O.method=rO,O.methodOf=nO,O.mixin=ix,O.negate=De,O.nthArg=oO,O.omit=lj,O.omitBy=cj,O.once=ft,O.orderBy=J0,O.over=iO,O.overArgs=Tt,O.overEvery=aO,O.overSome=lO,O.partial=_t,O.partialRight=jt,O.partition=Uu,O.pick=uj,O.pickBy=QE,O.property=oS,O.propertyOf=cO,O.pull=vf,O.pullAll=Mu,O.pullAllBy=gs,O.pullAllWith=Sa,O.pullAt=Oo,O.range=uO,O.rangeRight=dO,O.rearg=jn,O.reject=o,O.remove=Rs,O.rest=wr,O.reverse=yf,O.sampleSize=h,O.set=fj,O.setWith=hj,O.shuffle=v,O.slice=bp,O.sortBy=F,O.sortedUniq=Sp,O.sortedUniqBy=pl,O.split=Dj,O.spread=ka,O.tail=Zg,O.take=ev,O.takeRight=Cp,O.takeRightWhile=xf,O.takeWhile=M0,O.tap=W0,O.throttle=Q0,O.thru=Do,O.toArray=qE,O.toPairs=ZE,O.toPairsIn=eS,O.toPath=gO,O.toPlainObject=YE,O.transform=pj,O.unary=uF,O.union=$0,O.unionBy=tv,O.unionWith=rv,O.uniq=ml,O.uniqBy=U0,O.uniqWith=Sc,O.unset=mj,O.unzip=wf,O.unzipWith=Zr,O.update=gj,O.updateWith=vj,O.values=Af,O.valuesIn=yj,O.without=z0,O.words=nS,O.wrap=dF,O.xor=nv,O.xorBy=H0,O.xorWith=B0,O.zip=sv,O.zipObject=ov,O.zipObjectDeep=G0,O.zipWith=go,O.entries=ZE,O.entriesIn=eS,O.extend=JE,O.extendWith=hv,ix(O,O),O.add=yO,O.attempt=sS,O.camelCase=_j,O.capitalize=tS,O.ceil=xO,O.clamp=xj,O.clone=hF,O.cloneDeep=mF,O.cloneDeepWith=gF,O.cloneWith=pF,O.conformsTo=vF,O.deburr=rS,O.defaultTo=Xj,O.divide=wO,O.endsWith=Ej,O.eq=zi,O.escape=Sj,O.escapeRegExp=Cj,O.every=av,O.find=Cf,O.findIndex=ba,O.findKey=qF,O.findLast=lv,O.findLastIndex=Ou,O.findLastKey=KF,O.floor=bO,O.forEach=kf,O.forEachRight=$u,O.forIn=YF,O.forInRight=JF,O.forOwn=XF,O.forOwnRight=QF,O.get=tx,O.gt=yF,O.gte=xF,O.has=tj,O.hasIn=rx,O.head=fl,O.identity=xo,O.includes=Nf,O.indexOf=Ui,O.inRange=wj,O.invoke=sj,O.isArguments=zu,O.isArray=Vt,O.isArrayBuffer=wF,O.isArrayLike=vo,O.isArrayLikeObject=kn,O.isBoolean=bF,O.isBuffer=Cc,O.isDate=_F,O.isElement=EF,O.isEmpty=SF,O.isEqual=CF,O.isEqualWith=kF,O.isError=Z0,O.isFinite=NF,O.isFunction=yl,O.isInteger=BE,O.isLength=dv,O.isMap=GE,O.isMatch=TF,O.isMatchWith=RF,O.isNaN=AF,O.isNative=IF,O.isNil=FF,O.isNull=PF,O.isNumber=WE,O.isObject=hn,O.isObjectLike=wn,O.isPlainObject=Ip,O.isRegExp=ex,O.isSafeInteger=jF,O.isSet=VE,O.isString=fv,O.isSymbol=Lo,O.isTypedArray=Rf,O.isUndefined=OF,O.isWeakMap=DF,O.isWeakSet=LF,O.join=Ea,O.kebabCase=kj,O.last=ms,O.lastIndexOf=Lu,O.lowerCase=Nj,O.lowerFirst=Tj,O.lt=MF,O.lte=$F,O.max=_O,O.maxBy=EO,O.mean=SO,O.meanBy=CO,O.min=kO,O.minBy=NO,O.stubArray=lx,O.stubFalse=cx,O.stubObject=fO,O.stubString=hO,O.stubTrue=pO,O.multiply=TO,O.nth=wp,O.noConflict=sO,O.noop=ax,O.now=W,O.pad=Rj,O.padEnd=Aj,O.padStart=Ij,O.parseInt=Pj,O.random=bj,O.reduce=X0,O.reduceRight=Tf,O.repeat=Fj,O.replace=jj,O.result=dj,O.round=RO,O.runInContext=oe,O.sample=a,O.size=_,O.snakeCase=Oj,O.some=k,O.sortedIndex=_p,O.sortedIndexBy=L0,O.sortedIndexOf=Ca,O.sortedLastIndex=Qg,O.sortedLastIndexBy=Ep,O.sortedLastIndexOf=hl,O.startCase=Lj,O.startsWith=Mj,O.subtract=AO,O.sum=IO,O.sumBy=PO,O.template=$j,O.times=mO,O.toFinite=xl,O.toInteger=Yt,O.toLength=KE,O.toLower=Uj,O.toNumber=ui,O.toSafeInteger=UF,O.toString=Ir,O.toUpper=zj,O.trim=Hj,O.trimEnd=Bj,O.trimStart=Gj,O.truncate=Wj,O.unescape=Vj,O.uniqueId=vO,O.upperCase=qj,O.upperFirst=nx,O.each=kf,O.eachRight=$u,O.first=fl,ix(O,(function(){var l={};return Gs(O,function(f,y){hr.call(O.prototype,y)||(l[y]=f)}),l})(),{chain:!1}),O.VERSION=n,Jn(["bind","bindKey","curry","curryRight","partial","partialRight"],function(l){O[l].placeholder=O}),Jn(["drop","take"],function(l,f){Wt.prototype[l]=function(y){y=y===t?1:yn(Yt(y),0);var C=this.__filtered__&&!f?new Wt(this):this.clone();return C.__filtered__?C.__takeCount__=Xn(y,C.__takeCount__):C.__views__.push({size:Xn(y,D),type:l+(C.__dir__<0?"Right":"")}),C},Wt.prototype[l+"Right"]=function(y){return this.reverse()[l](y).reverse()}}),Jn(["filter","map","takeWhile"],function(l,f){var y=f+1,C=y==le||y==me;Wt.prototype[l]=function(I){var L=this.clone();return L.__iteratees__.push({iteratee:It(I,3),type:y}),L.__filtered__=L.__filtered__||C,L}}),Jn(["head","last"],function(l,f){var y="take"+(f?"Right":"");Wt.prototype[l]=function(){return this[y](1).value()[0]}}),Jn(["initial","tail"],function(l,f){var y="drop"+(f?"":"Right");Wt.prototype[l]=function(){return this.__filtered__?new Wt(this):this[y](1)}}),Wt.prototype.compact=function(){return this.filter(xo)},Wt.prototype.find=function(l){return this.filter(l).head()},Wt.prototype.findLast=function(l){return this.reverse().find(l)},Wt.prototype.invokeMap=Kt(function(l,f){return typeof l=="function"?new Wt(this):this.map(function(y){return uo(y,l,f)})}),Wt.prototype.reject=function(l){return this.filter(De(It(l)))},Wt.prototype.slice=function(l,f){l=Yt(l);var y=this;return y.__filtered__&&(l>0||f<0)?new Wt(y):(l<0?y=y.takeRight(-l):l&&(y=y.drop(l)),f!==t&&(f=Yt(f),y=f<0?y.dropRight(-f):y.take(f-l)),y)},Wt.prototype.takeRightWhile=function(l){return this.reverse().takeWhile(l).reverse()},Wt.prototype.toArray=function(){return this.take(D)},Gs(Wt.prototype,function(l,f){var y=/^(?:filter|find|map|reject)|While$/.test(f),C=/^(?:head|last)$/.test(f),I=O[C?"take"+(f=="last"?"Right":""):f],L=C||/^find/.test(f);I&&(O.prototype[f]=function(){var K=this.__wrapped__,ee=C?[1]:arguments,ae=K instanceof Wt,Te=ee[0],Re=ae||Vt(K),Fe=function(ir){var mr=I.apply(O,aa([ir],ee));return C&&Ve?mr[0]:mr};Re&&y&&typeof Te=="function"&&Te.length!=1&&(ae=Re=!1);var Ve=this.__chain__,mt=!!this.__actions__.length,Ot=L&&!Ve,Xt=ae&&!mt;if(!L&&Re){K=Xt?K:new Wt(this);var Dt=l.apply(K,ee);return Dt.__actions__.push({func:Do,args:[Fe],thisArg:t}),new Qn(Dt,Ve)}return Ot&&Xt?l.apply(this,ee):(Dt=this.thru(Fe),Ot?C?Dt.value()[0]:Dt.value():Dt)})}),Jn(["pop","push","shift","sort","splice","unshift"],function(l){var f=Ni[l],y=/^(?:push|sort|unshift)$/.test(l)?"tap":"thru",C=/^(?:pop|shift)$/.test(l);O.prototype[l]=function(){var I=arguments;if(C&&!this.__chain__){var L=this.value();return f.apply(Vt(L)?L:[],I)}return this[y](function(K){return f.apply(Vt(K)?K:[],I)})}}),Gs(Wt.prototype,function(l,f){var y=O[f];if(y){var C=y.name+"";hr.call(sc,C)||(sc[C]=[]),sc[C].push({name:f,func:y})}}),sc[xc(t,R).name]=[{name:"wrapper",func:t}],Wt.prototype.clone=Od,Wt.prototype.reverse=Lh,Wt.prototype.value=ac,O.prototype.at=_f,O.prototype.chain=gl,O.prototype.commit=Ef,O.prototype.next=kp,O.prototype.plant=V0,O.prototype.reverse=Tp,O.prototype.toJSON=O.prototype.valueOf=O.prototype.value=q0,O.prototype.first=O.prototype.head,Ri&&(O.prototype[Ri]=Np),O}),Ql=R0();Yo?((Yo.exports=Ql)._=Ql,ru._=Ql):Kr._=Ql}).call(Lq)})(hm,hm.exports)),hm.exports}var Fy=Mq();const Ov="src/shared/components/sidepanel/panels/components/FilevineCaseInfoBox.tsx",$q=({caseSummaryData:r,isCaseSummaryLoading:e,caseSummaryError:t,caseDetails:n,onDocumentView:s})=>{if(e)return d.jsxs("div",{className:"space-y-2",children:[d.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded animate-pulse"}),d.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded animate-pulse"}),d.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded animate-pulse"})]});if(t)return d.jsx("div",{className:"text-sm text-red-600 dark:text-red-400",children:t});if(!r)return null;const i={};return r.caseFacts&&(i["Case Facts"]=r.caseFacts),r.supioLink&&(i["Supio Link"]=r.supioLink),n.incidentDate&&(i["Incident Date"]=new Date(n.incidentDate).toLocaleDateString(void 0,{timeZone:"UTC"})),r.statuteoflimitations&&r.statuteoflimitations.dateValue&&(i["Statute of Limitations (SOL)"]=new Date(r.statuteoflimitations.dateValue).toLocaleDateString(void 0,{timeZone:"UTC"})),r.totalMeds>0&&(i["Total Meds"]=`$${r.totalMeds.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`),r.totalLiens>0&&(i["Total Liens"]=`$${r.totalLiens.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`),d.jsxs("div",{className:"space-y-3",children:[d.jsx(Xc,{details:i}),r.disbursementSheet&&d.jsx("div",{className:"px-3 pb-2",children:d.jsx("table",{className:"w-full text-sm text-left text-gray-700 dark:text-gray-300",children:d.jsx("tbody",{children:d.jsxs("tr",{className:"bg-card",children:[d.jsx("td",{className:"py-4 px-3 whitespace-normal font-medium w-1/3 text-gray-800 dark:text-gray-200",children:"Disbursement Sheet"}),d.jsx("td",{className:"py-2 px-3",children:d.jsxs("button",{onClick:()=>{s&&r.disbursementSheet&&s({name:r.disbursementSheet.filename,documentId:r.disbursementSheet.documentId,url:""})},className:"text-blue-600 dark:text-blue-400 hover:underline inline-flex items-center gap-1 cursor-pointer focus:outline-none",children:[d.jsx(Qf,{className:"w-3 h-3"}),r.disbursementSheet.filename]})})]})})})})]})},Uq=({clientEmail:r,selectedCaseDetails:e,casesForCurrentClient:t,currentCaseIndex:n,caseDetails:s,nextCase:i,prevCase:c,isLoading:u,setCurrentCaseIndex:p,isValidating:m=!1,handleSectionClick:g,projectId:x,onDocumentView:b,onProjectManuallySelected:E,onResetToEmailProject:T,isProjectManuallySelected:S=!1})=>{const N=Ur(),[R,A]=w.useState(""),[j,P]=w.useState(!1),[M,B]=w.useState(null),[U,V]=w.useState(!1),[Y,ce]=w.useState(null),[X,de]=w.useState(""),[we,le]=w.useState([]),[se,me]=w.useState(!1),[te,G]=w.useState(!1),[z,J]=w.useState(null),D=w.useMemo(()=>{if(!R.trim())return t;const ue=R.toLowerCase();return t.filter(ke=>String(ke.projectName||"").toLowerCase().includes(ue))},[t,R]),$=w.useMemo(()=>Fy.debounce(async ue=>{if(!ue.trim()||ue.length<2){le([]),J(null);return}me(!0),J(null);try{const ke=await Wy("filevine",ue,N);le(ke.projects||[]),ke.projects.length===0&&J(`No projects found for "${ue}"`)}catch(ke){N.error("Project search failed",ke,{sourceFile:Ov}),J("Failed to search projects. Please try again."),le([])}finally{me(!1)}},400),[N]),ne=ue=>{var ke,He,Ue;try{const Le={projectId:{native:((ke=ue.projectId)==null?void 0:ke.native)||null,partner:((He=ue.projectId)==null?void 0:He.partner)||null},projectName:ue.projectName||"",projectTypeCode:ue.projectTypeCode||"",projectTypeName:ue.projectTypeName||"",phaseName:ue.phaseName||"",phaseDate:ue.phaseDate||"",firstPrimaryName:ue.firstPrimaryName||"",firstPrimaryUsername:ue.firstPrimaryUsername||"",hashtags:Array.isArray(ue.hashtags)?ue.hashtags.join(", "):"",projectEmailAddress:ue.projectEmailAddress||"",projectUrl:ue.projectUrl||"",incidentDate:ue.incidentDate||""};N.info("Project manually selected via search",{projectId:(Ue=Le.projectId)==null?void 0:Ue.native,projectName:Le.projectName,sourceFile:Ov}),E&&E(Le),G(!1),de(""),le([]),J(null)}catch(Le){N.error("Failed to select project",Le,{sourceFile:Ov})}},_e=ue=>{P(ue),ue||A("")},q=async()=>{if(!(!x||M)){V(!0),ce(null);try{const ue=await s8("filevine",x,N);B(ue)}catch(ue){N.error("Error fetching case summary",ue,{sourceFile:Ov}),ce("Failed to load case summary data")}finally{V(!1)}}};w.useEffect(()=>{B(null),ce(null)},[x]);const ie=()=>d.jsx(Qs,{rows:2}),xe=()=>g?d.jsxs($e,{variant:"ghost",className:"justify-between w-full text-sm px-0 hover:bg-transparent",onClick:()=>g("Project Documents"),children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx(Qf,{className:"h-4 w-4 mr-2 text-blue-500 dark:text-blue-400"}),d.jsx("span",{className:"text-blue-500 dark:text-blue-400",children:"Project Documents"})]}),d.jsx(Oc,{src:"/icons/chevron-right.svg",width:16,height:16,alt:"Chevron right",className:"h-4 w-4"})]}):null,ye=ue=>{if(p)p(ue);else if(ue>n)for(let ke=n;ke<ue;ke++)i();else if(ue<n)for(let ke=n;ke>ue;ke--)c()};return d.jsxs("div",{className:"w-full min-h-[4rem] border border-border/50 rounded-lg shadow-sm bg-card text-card-foreground",title:"Case Information",children:[d.jsxs("div",{className:"flex items-center justify-between p-2 border-b bg-muted",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(YR,{className:"w-3.5 h-3.5 text-slate-600 dark:text-gray-300"}),d.jsx("span",{className:"font-medium text-sm text-slate-800 dark:text-white",children:"PROJECTS"})]}),d.jsxs("div",{className:"flex items-center gap-1",children:[S&&T&&d.jsx($e,{variant:"ghost",size:"icon",className:"h-8 w-8",title:"Reset to email-based project",onClick:T,children:d.jsx(Co,{className:"h-4 w-4"})}),d.jsxs(Ls,{open:te,onOpenChange:G,children:[d.jsx(Ms,{asChild:!0,children:d.jsx($e,{variant:"ghost",size:"icon",className:"h-8 w-8",title:"Search all projects",onClick:ue=>{ue.stopPropagation(),G(!te)},children:d.jsx(Zs,{className:"h-4 w-4"})})}),d.jsxs(ws,{align:"end",className:"w-[320px] p-0",children:[d.jsxs("div",{className:"p-3 border-b border-gray-200 dark:border-gray-700",children:[d.jsx("div",{className:"text-sm font-medium mb-2 text-gray-800 dark:text-gray-200",children:"Search All Projects"}),d.jsxs("div",{className:"relative",children:[d.jsx(Zs,{className:"absolute left-2 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),d.jsx(rn,{placeholder:"Search by project or client name...",value:X,onChange:ue=>{const ke=ue.target.value;de(ke),$(ke)},className:"pl-8 pr-8 h-9 text-sm",autoFocus:!0,onClick:ue=>ue.stopPropagation(),onKeyDown:ue=>ue.stopPropagation()}),X&&d.jsx("button",{onClick:ue=>{ue.stopPropagation(),de(""),le([]),J(null)},className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:d.jsx(gi,{className:"w-4 h-4"})})]})]}),d.jsx("div",{className:"max-h-[300px] overflow-y-auto",children:se?d.jsxs("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 flex items-center gap-2",children:[d.jsx("div",{className:"w-4 h-4 border-2 border-gray-300 border-t-gray-600 rounded-full animate-spin"}),"Searching..."]}):z&&we.length===0?d.jsx("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:z}):we.length>0?we.map(ue=>d.jsxs(os,{className:"flex flex-col items-start p-3 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-800",onClick:()=>ne(ue),children:[d.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-gray-100",children:ue.projectName}),d.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5",children:[ue.phaseName,"  Client: ",ue.clientName]})]},ue.projectId.native)):X.trim()&&!se?d.jsxs("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:['No projects found for "',X,'"']}):d.jsx("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:"Type at least 2 characters to search projects..."})})]})]})]})]}),u?ie():e&&Object.keys(e).length>0?d.jsxs(d.Fragment,{children:[t.length>0&&d.jsxs("div",{className:"flex items-center px-3 py-1 bg-gray-50 dark:bg-gray-800 border-b dark:border-gray-700 gap-2",children:[d.jsxs("div",{className:"flex-1 min-w-0 flex items-center",children:[t.length>1&&d.jsxs(Ls,{open:j,onOpenChange:_e,children:[d.jsx(Ms,{asChild:!0,children:d.jsxs($e,{variant:"ghost",size:"sm",className:"h-8 text-xs text-gray-600 dark:text-gray-300 flex items-center gap-1 px-2 max-w-full",children:[d.jsx("span",{className:"truncate",title:e.Title||"",children:e.Title||"Case"}),d.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400 flex-shrink-0",children:["(",n+1,"/",t.length,")"]}),d.jsx(ys,{className:"w-3 h-3 ml-1 flex-shrink-0"})]})}),d.jsxs(ws,{align:"start",className:"w-[280px] p-0",children:[d.jsxs("div",{className:"p-2 border-b border-gray-200 dark:border-gray-700",children:[d.jsxs("div",{className:"relative",children:[d.jsx(Zs,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),d.jsx(rn,{placeholder:"Search projects...",value:R,onChange:ue=>A(ue.target.value),className:"pl-8 pr-8 h-8 text-xs",autoFocus:!0,onClick:ue=>ue.stopPropagation(),onKeyDown:ue=>ue.stopPropagation()}),R&&d.jsx("button",{onClick:ue=>{ue.stopPropagation(),A("")},className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:d.jsx(gi,{className:"w-4 h-4"})})]}),R&&d.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:["Showing ",D.length," of ",t.length]})]}),d.jsx("div",{className:"max-h-[200px] overflow-y-auto",children:D.length>0?D.map((ue,ke)=>{const He=t.findIndex(Ue=>Ue===ue);return d.jsx(os,{className:`text-xs truncate ${He===n?"bg-gray-100 dark:bg-gray-700 font-medium":""}`,onClick:()=>ye(He),children:String(ue.projectName||`Case ${He+1}`)},He)}):d.jsxs("div",{className:"p-3 text-xs text-center text-gray-500 dark:text-gray-400",children:['No projects match "',R,'"']})})]})]}),t.length===1&&d.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-300 px-2 truncate",title:e.Title||"",children:e.Title||"Case"})]}),s.projectUrl&&d.jsxs("a",{href:s.projectUrl,target:"_blank",rel:"noopener noreferrer",className:"h-8 text-xs text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 border border-blue-200 dark:border-blue-800 px-3 flex-shrink-0 rounded-md inline-flex items-center gap-1 no-underline hover:no-underline",children:[d.jsx(jl,{className:"w-3 h-3"}),"View"]})]}),d.jsx("div",{className:"break-words overflow-hidden",children:d.jsx(Xc,{details:e})}),d.jsx("div",{className:"px-3 border-t",children:xe()}),s.projectTypeCode&&s.projectTypeCode!=="IM"&&d.jsx("div",{className:"border-t",children:d.jsx(Dq,{type:"single",collapsible:!0,onValueChange:ue=>{ue==="view-more"&&q()},children:d.jsxs(rF,{value:"view-more",className:"border-0",children:[d.jsx(nF,{className:"px-3 py-2 hover:no-underline text-sm font-medium",children:"View More"}),d.jsx(sF,{className:"px-3 pb-2",children:d.jsx($q,{caseSummaryData:M,isCaseSummaryLoading:U,caseSummaryError:Y,caseDetails:s,onDocumentView:b})})]})},x)})]}):m?d.jsx(Qs,{rows:2}):d.jsx("div",{className:"p-3 text-sm text-gray-600 dark:text-gray-400",children:r?d.jsx(d.Fragment,{children:d.jsx("p",{className:"mb-2",children:"Select a client email thread to view project information"})}):"Select a client email thread to view case information"})]})},sr="src/sidepanel/mainPanelContent/FilevineInsights.tsx",zq="https://rubypowerslaw.filevineapp.com",Hq=({toggleSection:r,clientEmail:e,setClientEmail:t,setProjectId:n,setDocuments:s,setIsDocumentsLoading:i,setDocumentsError:c,onDocumentView:u,tempClientEmail:p,setTempClientEmail:m,emailParticipants:g,emailParticipantClients:x,currentClientIndex:b,setCurrentClientIndex:E,currentCaseIndex:T,casesForCurrentClient:S,setCasesForCurrentClient:N,isManuallySet:R,setIsManuallySet:A,isProjectManuallySelected:j,setIsProjectManuallySelected:P,isValidClient:M,isTempEmailValid:B,nextCase:U,prevCase:V,handleSetCurrentCaseIndex:Y,ClientNavigation:ce,onClientDataValidated:X,isValidating:de,refreshTrigger:we,integrationSettings:le})=>{const[se,me]=w.useState(!1),[te,G]=w.useState({}),[z,J]=w.useState({}),[D,$]=w.useState({}),[ne,_e]=w.useState(!1),[q,ie]=w.useState(void 0),[xe,ye]=w.useState([]),[ue,ke]=w.useState(!1),[He,Ue]=w.useState(null),Le=w.useRef({}),Ne=Ur(),gt=w.useCallback(Ae=>{if(!Ae||!Ae.client_data)return!1;const Ze=Ae.client_data;return Ze&&typeof Ze=="object"&&Object.keys(Ze).length>0},[]),zt=w.useCallback(Ae=>{Ne.info("selectClientDetails called",{sourceFile:sr,hasDetails:!!Ae,detailsKeys:Ae?Object.keys(Ae):[]});const Ze=rt=>{const Lt=rt.replace(/\D/g,"");return Lt.length===10?`(${Lt.slice(0,3)}) ${Lt.slice(3,6)}-${Lt.slice(6)}`:rt};Ne.debug("Client details received for formatting",{sourceFile:sr,caseNames:Ae.caseNames});const dt={Name:Ae.fullName||"",Phone:Ze(Ae.phoneNumber||""),Address:Ae.fullAddress||""};Ne.info("Client details formatted and set",{sourceFile:sr,selectedDetails:dt,originalDetails:Ae}),J(dt)},[Ne]),yt=w.useCallback(Ae=>{Ne.info("selectCaseDetails called",{sourceFile:sr,hasDetails:!!Ae,detailsKeys:Ae?Object.keys(Ae):[]});let Ze="";if(Ae.projectName){const Lt=Ae.projectName.match(/(\d{2}-\d{3})/);Lt&&Lt[1]&&(Ze=Lt[1])}Ne.debug("Case details received for formatting",{sourceFile:sr});const rt=(Ae.projectTypeCode||"")==="IM"?{Title:Ae.projectName||"","Internal Case ID":Ze,"Assigned To":Ae.firstPrimaryName||"",Phase:Ae.phaseName||"",Tags:Ae.hashtags||"","Filevine Email":Ae.projectEmailAddress||""}:{Title:Ae.projectName||"","Assigned To":Ae.firstPrimaryName||"",Phase:Ae.phaseName||"",Tags:Ae.hashtags||"","Filevine Email":Ae.projectEmailAddress||""};Ne.info("Case details formatted and set",{sourceFile:sr,selectedDetails:rt,originalDetails:Ae}),$(rt)},[Ne]),Zt=w.useCallback(async Ae=>{if(Le.current[Ae]){Ne.debug("Using cached client data",{sourceFile:sr,email:Ae});return}try{Ne.debug("Fetching client data",{sourceFile:sr,email:Ae});const Ze=await Gy("filevine",Ae,Ne);Le.current[Ae]=Ze}catch(Ze){throw Ze instanceof Error&&(Ze.message.includes("Client not found")||Ze.message.includes("(cached)"))?Ne.debug("Client not found for email (including cached)",{sourceFile:sr,email:Ae}):Ne.error(`Error fetching client data for ${Ae}`,Ze,{sourceFile:sr}),Ze}},[Ne]),Bt=w.useCallback(async()=>{if(Ne.info("fetchClientData called",{sourceFile:sr,clientEmail:e,isFilevineConnected:se,hasClientEmail:!!e}),!e||!se){Ne.info("fetchClientData early return",{sourceFile:sr,reason:e?"filevine not connected":"no client email",clientEmail:e,isFilevineConnected:se});return}try{if(_e(!0),Ne.info("fetchClientData starting data fetch",{sourceFile:sr,clientEmail:e,isLoading:!0}),!Le.current[e])try{await Zt(e)}catch(gr){gr instanceof Error&&gr.message.includes("(cached)")?Ne.debug("Using cached knowledge that this client doesn't exist",{sourceFile:sr,clientEmail:e}):Ne.error("Error fetching client data",gr,{sourceFile:sr}),G({}),N([]),J({}),$({}),_e(!1);return}const Ae=Le.current[e];if(!Ae){G({}),N([]),J({}),$({}),_e(!1),X(e,!1);return}const Ze=gt(Ae);if(X(e,Ze),!Ze){Ne.debug("Client data exists but is not valid",{sourceFile:sr,clientEmail:e}),G({}),N([]),J({}),$({}),_e(!1);return}const dt=Ae.client_data;zt(dt);const rt=Ae.case_data||[];N(rt);const Lt=rt.length>0?Object.entries(rt[0]).reduce((gr,[tr,lt])=>(gr[tr]=String(lt),gr),{}):{};G(Lt),yt(Lt)}catch(Ae){Ne.error("Error processing client data",Ae,{sourceFile:sr}),G({}),N([]),e&&X(e,!1)}finally{_e(!1)}},[e,se,Zt,Ne,zt,yt,N,X,gt]);w.useEffect(()=>{Ne.info("FilevineInsights component initialized",{sourceFile:sr,clientEmail:e,emailParticipants:g.length,currentClientIndex:b,currentCaseIndex:T,casesForCurrentClient:S.length}),(async()=>{try{me(!0)}catch(Ze){Ne.error("Error checking Filevine connection",Ze,{sourceFile:sr}),me(!1)}})()},[Ne,S.length,T,b,e,g.length]),w.useEffect(()=>{de&&g.length>0&&(Le.current={},Ne.debug("Cleared component-level client data cache for refresh",{sourceFile:sr}))},[de,g.length,Ne]),w.useEffect(()=>{const Ae=async()=>{if(se){Ne.info("Validating all email participants",{sourceFile:sr,participantCount:g.length});for(const Ze of g)try{await Zt(Ze);const dt=Le.current[Ze],rt=gt(dt);X(Ze,rt),Ne.debug("Participant validation result",{sourceFile:sr,email:Ze,hasValidData:rt})}catch(dt){Ne.debug("Participant validation failed",{sourceFile:sr,email:Ze,error:dt}),X(Ze,!1)}}};g.length>0&&se&&Ae()},[g,se,Zt,gt,X,Ne,we]),w.useEffect(()=>{if(j){Ne.debug("Skipping fetchClientData because project was manually selected",{sourceFile:sr,clientEmail:e,isProjectManuallySelected:j});return}e&&se&&(Bt(),m(e),R&&!g.includes(e.toLowerCase())&&Ne.debug("Manually set email not in participants, validating separately",{sourceFile:sr,clientEmail:e}))},[e,se,Bt,m,R,j,g,Ne]),w.useEffect(()=>{(!e||g.length===0&&!R)&&(m(null),J({}),$({}))},[e,g.length,R,m,J,$]),w.useEffect(()=>{var Ae;if(S.length>0&&T<S.length){const Ze=S[T],dt=Ze?Object.entries(Ze).reduce((Lt,[gr,tr])=>(Lt[gr]=String(tr),Lt),{}):{};G(dt),yt(dt);const rt=(Ae=Ze==null?void 0:Ze.projectId)!=null&&Ae.native?String(Ze.projectId.native):void 0;ie(rt),n&&rt&&n(rt)}},[T,S,yt,n]);const or=w.useCallback(async()=>{var dt;if(!se||S.length===0)return;const Ae=S[T],Ze=((dt=Ae==null?void 0:Ae.projectId)==null?void 0:dt.native)||(Ae==null?void 0:Ae.projectId);if(!Ze){Ne.debug("No project ID found for current case",{sourceFile:sr,currentCaseIndex:T});const rt="No project ID available. Cannot fetch documents.";Ue(rt),c&&c(rt);return}ke(!0),i&&i(!0),Ue(null),c&&c(null);try{const rt=await gT(String(Ze),Ne);if(rt){Ne.debug("Using cached documents for project",{sourceFile:sr,projectId:Ze}),ye(rt),s&&s(rt),ke(!1),i&&i(!1);return}const gr=(await RT("filevine",String(Ze),Ne)).documents.map(tr=>({name:tr.filename,url:`${zq}/docwebviewer/view/${tr.documentId}`,documentId:tr.documentId,folderName:tr.folderName}));await mT(String(Ze),gr,Ne),ye(gr),s&&s(gr)}catch(rt){Ne.error("Error fetching documents",rt,{sourceFile:sr});const Lt="Failed to load documents. Please try again later.";Ue(Lt),c&&c(Lt)}finally{ke(!1),i&&i(!1)}},[se,S,T,s,i,c,Ne]),st=Ae=>{var Ze;try{const dt=((Ze=Ae.projectId)==null?void 0:Ze.native)||Ae.projectId;Ne.info("Project manually selected via search",{projectId:dt,projectName:Ae.projectName,sourceFile:sr}),G(Ae),yt(Ae),N([Ae]),t(""),J({}),P(!0),ie(dt),n&&dt&&n(dt)}catch(dt){Ne.error("Failed to set manually selected project",dt,{sourceFile:sr})}},Ft=()=>{try{if(Ne.info("Resetting to email-based project",{sourceFile:sr}),P(!1),x.length>0){const Ae=x[0];t(Ae),Ne.debug("Restored client email",{sourceFile:sr,clientEmail:Ae})}}catch(Ae){Ne.error("Failed to reset to email-based project",Ae,{sourceFile:sr})}};if(!se)return null;const er=Ae=>{Ne.debug(`[FilevineInfoBox] handleSectionClick called with section: "${Ae}"`,{sourceFile:sr,functionName:"handleSectionClick",data:{section:Ae}}),r?(Ne.debug(`[FilevineInfoBox] Calling toggleSection with section: "${Ae}"`,{sourceFile:sr,functionName:"handleSectionClick",data:{section:Ae}}),r(Ae),Ae.toLowerCase()==="project documents"?(Ne.debug('[FilevineInfoBox] Section is "project documents", calling fetchMatterDocuments',{sourceFile:sr,functionName:"handleSectionClick",data:{section:Ae}}),or()):Ne.debug('[FilevineInfoBox] Section is not "project documents", not calling fetchMatterDocuments',{sourceFile:sr,functionName:"handleSectionClick",data:{section:Ae}})):Ne.warn("[FilevineInfoBox] toggleSection is not defined. Cannot navigate.",{sourceFile:sr,functionName:"handleSectionClick",data:{section:Ae}})};return d.jsxs("div",{className:"space-y-4 overflow-y-auto h-full mt-0",children:[d.jsx(vq,{clientEmail:e,emailParticipants:g,emailParticipantClients:x,currentClientIndex:b,setCurrentClientIndex:E,setClientEmail:t,isManuallySet:R,selectedClientDetails:z,isLoading:ne,ClientNavigation:ce,tempClientEmail:p,setTempClientEmail:m,setIsManuallySet:A,isValidClient:M,isTempEmailValid:B,isValidating:de,isProjectManuallySelected:j}),d.jsx(Uq,{clientEmail:e,selectedCaseDetails:D,casesForCurrentClient:S,currentCaseIndex:T,caseDetails:te,nextCase:U,prevCase:V,isLoading:ne,setCurrentCaseIndex:Y,isValidating:de,handleSectionClick:er,projectId:q,onDocumentView:u,onProjectManuallySelected:st,onResetToEmailProject:Ft,isProjectManuallySelected:j}),d.jsx("div",{className:"h-8"})]})},Bq=cE("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),jy=w.forwardRef(({className:r,variant:e,...t},n)=>d.jsx("div",{ref:n,role:"alert",className:Rr(Bq({variant:e}),r),...t}));jy.displayName="Alert";const Gq=w.forwardRef(({className:r,...e},t)=>d.jsx("h5",{ref:t,className:Rr("mb-1 font-medium leading-none tracking-tight",r),...e}));Gq.displayName="AlertTitle";const Oy=w.forwardRef(({className:r,...e},t)=>d.jsx("div",{ref:t,className:Rr("text-sm [&_p]:leading-relaxed",r),...e}));Oy.displayName="AlertDescription";const Dv="src/shared/components/sidepanel/panels/components/ClioContactCreation.tsx",m1=r=>{if(!r||r.trim()==="")return!0;if(!/^[\d\s+().-]+$/.test(r))return!1;const t=r.replace(/\D/g,"");return t.length>=7&&t.length<=15},Wq=({emailParticipants:r,emailParticipantClients:e,getClientNameFromCache:t,onContactsCreated:n})=>{const s=Ur(),[i,c]=w.useState([]),[u,p]=w.useState(!1),[m,g]=w.useState(!1),[x,b]=w.useState([]),[E,T]=w.useState({}),[S,N]=w.useState([]),[R,A]=w.useState(!1),[j,P]=w.useState(null),[M,B]=w.useState(!1),U=w.useCallback(le=>{const se=le.toLowerCase();return e.some(me=>me.toLowerCase()===se)},[e]);w.useEffect(()=>{const le=r.map((se,me)=>{const te=U(se);let G="";if(te){const z=t(se);z&&(G=z)}return G||(G=se.split("@")[0].split(".").map(J=>J.charAt(0).toUpperCase()+J.slice(1).toLowerCase()).join(" ")),{id:`participant-${me}`,name:G,email:se,inClio:te}});c(le),s.debug("Participants initialized with Clio status",{sourceFile:Dv,totalParticipants:le.length,inClio:le.filter(se=>se.inClio).length,notInClio:le.filter(se=>!se.inClio).length})},[r,e,s,U,t]);const V=i.some(le=>!le.inClio),Y=()=>{p(!0),g(!1);const le={};i.forEach(se=>{if(!se.inClio){const me=se.name.split(" ");le[se.id]={firstName:me[0]||"",lastName:me.slice(1).join(" ")||"",email:se.email,phoneNumber:"",type:"person",companyName:""}}}),T(le)},ce=()=>{p(!1),b([]),P(null)},X=le=>{b(se=>se.includes(le)?se.filter(me=>me!==le):[...se,le])},de=(le,se,me)=>{T(te=>({...te,[le]:{...te[le],[se]:me}}))},we=async()=>{var le,se,me;A(!0),P(null);for(const te of x){const G=E[te];if(!G){P({type:"validation",message:"Contact data is missing. Please try again."}),A(!1);return}if(G.type==="person"){if(!((le=G.firstName)!=null&&le.trim())||!((se=G.lastName)!=null&&se.trim())){P({type:"validation",message:"First and Last name is required for person contacts."}),A(!1);return}}else if(G.type==="company"&&!((me=G.companyName)!=null&&me.trim())){P({type:"validation",message:"Company name is required for company contacts."}),A(!1);return}if(G!=null&&G.phoneNumber&&!m1(G.phoneNumber)){P({type:"validation",message:"Invalid phone number. Please enter 7-15 digits with optional formatting (+, -, spaces, parentheses)."}),A(!1);return}}try{const te=[];for(const z of x){const J=i.find($=>$.id===z),D=E[z];if(!(!J||!D))try{const $=await m8(D,s),ne=D.type==="company"?D.companyName||"":`${D.firstName||""} ${D.lastName||""}`.trim();te.push({id:$.id,name:ne||J.name,email:J.email}),s.info("Contact created successfully in Clio",{sourceFile:Dv,email:J.email})}catch($){if(s.error("Error creating contact in Clio",$,{sourceFile:Dv,email:J.email}),$ instanceof Error&&($.message.includes("duplicate")||$.message.includes("already exists")?P({type:"duplicate",message:"A contact with this email already exists in Clio."}):$.message.includes("permission")?P({type:"permission",message:"You do not have permission to create contacts in Clio. Contact your admin."}):P({type:"network",message:"Something went wrong. Please try again."})),te.length>0){const ne=[...S,...te];N(ne),c(q=>q.map(ie=>{const xe=te.find(ye=>ye.email.toLowerCase()===ie.email.toLowerCase());return xe?{...ie,inClio:!0,name:xe.name}:ie}));const _e=te.map(q=>{var ie;return(ie=i.find(xe=>xe.email.toLowerCase()===q.email.toLowerCase()))==null?void 0:ie.id}).filter(Boolean);b(q=>q.filter(ie=>!_e.includes(ie))),n&&n(ne)}A(!1);return}}B(!0);const G=[...S,...te];N(G),p(!1),b([]),A(!1),c(z=>z.map(J=>{const D=te.find($=>$.email.toLowerCase()===J.email.toLowerCase());return D?{...J,inClio:!0,name:D.name}:J})),n&&n(G)}catch(te){s.error("Unexpected error in contact creation flow",te,{sourceFile:Dv}),P({type:"network",message:"Something went wrong. Please try again."}),A(!1)}};return i.length===0||!V&&S.length===0?null:d.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700",children:d.jsxs("div",{className:"p-4",children:[!M&&d.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 border border-gray-300 dark:border-gray-600 rounded-md p-4",children:[d.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:"Some email participants are not contacts in Clio."}),V&&!u&&d.jsxs("div",{className:"flex items-center gap-3 mt-3",children:[d.jsx($e,{onClick:Y,size:"sm",className:"h-9",children:"Add to Clio"}),d.jsx("button",{onClick:()=>g(!m),className:"text-sm text-blue-600 dark:text-blue-400 hover:underline",children:"How this works"})]}),m&&d.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-3 leading-relaxed",children:"Create a Clio contact from email participants so Candle can show client and matter context."}),u&&d.jsxs("div",{className:"mt-4 border-t dark:border-gray-700 pt-4",children:[d.jsx("h4",{className:"text-sm font-semibold text-gray-800 dark:text-gray-200 mb-1",children:"Add contact to Clio"}),d.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-4",children:"Select people on this email thread"}),j&&d.jsx("div",{role:"alert","aria-live":"assertive",className:"mb-4",children:d.jsx("div",{className:"flex items-start bg-red-50 dark:bg-red-950/30 border border-red-200 dark:border-red-800 text-red-900 dark:text-red-100 rounded-md p-3",children:d.jsxs("div",{className:"flex-1",children:[d.jsx("p",{className:"text-sm",children:j.message}),j.type==="network"&&d.jsx("div",{className:"mt-2",children:d.jsx($e,{onClick:we,size:"sm",variant:"destructive",className:"h-7 text-xs",children:"Retry"})})]})})}),d.jsx("div",{className:"space-y-2 mb-4",children:i.map(le=>d.jsxs("div",{className:`flex items-center gap-3 p-3 border dark:border-gray-600 rounded-md ${le.inClio?"bg-gray-50 dark:bg-gray-800 opacity-60":"bg-white dark:bg-gray-900"}`,children:[d.jsx("input",{type:"checkbox",checked:x.includes(le.id),onChange:()=>X(le.id),disabled:le.inClio,className:"h-4 w-4 text-blue-600"}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate",children:le.name}),d.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:le.email})]}),d.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${le.inClio?"bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-400 border border-green-300 dark:border-green-800":"bg-orange-100 dark:bg-orange-900/30 text-orange-800 dark:text-orange-400 border border-orange-300 dark:border-orange-800"}`,children:le.inClio?"In Clio":"Not in Clio"})]},le.id))}),x.length>0&&d.jsx("div",{className:"border-t dark:border-gray-700 pt-4 space-y-4",children:x.map(le=>{const se=i.find(te=>te.id===le),me=E[le]||{};return se?d.jsxs("div",{className:"space-y-3",children:[d.jsx("div",{className:"text-sm font-semibold text-gray-800 dark:text-gray-200",children:se.name}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Contact type"}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx("button",{onClick:()=>de(le,"type","person"),className:`flex-1 px-3 py-2 text-sm border rounded transition-colors ${me.type==="person"?"bg-blue-600 dark:bg-blue-700 text-white border-blue-600 dark:border-blue-700":"bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 border-gray-300 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:"Person"}),d.jsx("button",{onClick:()=>de(le,"type","company"),className:`flex-1 px-3 py-2 text-sm border rounded transition-colors ${me.type==="company"?"bg-blue-600 dark:bg-blue-700 text-white border-blue-600 dark:border-blue-700":"bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 border-gray-300 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:"Company"})]})]}),me.type==="person"?d.jsxs(d.Fragment,{children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"First name"}),d.jsx(rn,{type:"text",value:me.firstName||"",onChange:te=>de(le,"firstName",te.target.value),className:"h-9 text-sm"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Last name"}),d.jsx(rn,{type:"text",value:me.lastName||"",onChange:te=>de(le,"lastName",te.target.value),className:"h-9 text-sm"})]})]}):d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Company name"}),d.jsx(rn,{type:"text",value:me.companyName||"",onChange:te=>de(le,"companyName",te.target.value),className:"h-9 text-sm"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Phone number (optional)"}),d.jsx(rn,{type:"tel",value:me.phoneNumber||"",onChange:te=>de(le,"phoneNumber",te.target.value),placeholder:"+1 (555) 123-4567",className:"h-9 text-sm"}),me.phoneNumber&&!m1(me.phoneNumber)&&d.jsx("p",{className:"text-xs text-red-600 dark:text-red-400 mt-1",children:"Please enter a valid phone number (7-15 digits)"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Email"}),d.jsx(rn,{type:"text",value:me.email||"",readOnly:!0,disabled:!0,className:"h-9 text-sm"})]})]},le):null})}),d.jsxs("div",{className:"flex gap-2 mt-4 pt-4 border-t dark:border-gray-700",children:[d.jsx($e,{onClick:we,disabled:x.length===0||R,size:"sm",className:"h-9",children:R?"Creating...":"Create contact"}),d.jsx($e,{onClick:ce,variant:"outline",size:"sm",className:"h-9",children:"Cancel"})]})]})]}),M&&d.jsxs("div",{className:"bg-green-50 dark:bg-green-900/30 border border-green-200 dark:border-green-700 rounded-md p-4",children:[d.jsx("h4",{className:"text-sm font-semibold text-green-900 dark:text-green-100 mb-2",children:"This contact has been added in Clio"}),d.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mb-2",children:"Clio may take a few minutes to show updates."}),d.jsx("div",{className:"space-y-2",children:S.map(le=>d.jsxs("div",{className:"flex items-center justify-between p-2 bg-white dark:bg-gray-800 rounded-md border border-gray-200 dark:border-gray-600",children:[d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate",children:le.name}),d.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:le.email})]}),d.jsx("span",{className:"px-2 py-1 text-xs bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-400 border border-green-300 dark:border-green-800 rounded-full",children:"In Clio"})]},le.id))}),d.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-3",children:"Go to the Matter section below to link this contact to a matter."}),V&&d.jsx($e,{onClick:()=>{B(!1),p(!0)},size:"sm",variant:"outline",className:"h-8 text-xs mt-3",children:"Add more contacts"})]})]})})},Vq=({clientEmail:r,emailParticipants:e,emailParticipantClients:t,currentClientIndex:n,setCurrentClientIndex:s,setClientEmail:i,isManuallySet:c,selectedClientDetails:u,linkableFields:p,isLoading:m,ClientNavigation:g,handleSectionClick:x,tempClientEmail:b,setTempClientEmail:E,setIsManuallySet:T,isValidClient:S,isTempEmailValid:N,showClientDocumentsButton:R,isValidating:A,fetchError:j=!1,hasTransientError:P=!1,onContactsCreated:M,getClientNameFromCache:B,isClientDataValidationComplete:U})=>{var we;Ur();const V=()=>d.jsx(Qs,{rows:2}),Y=(we=p.find(le=>le.field==="Name"))==null?void 0:we.url,ce=()=>d.jsxs("div",{className:"flex items-center px-3 py-1 bg-gray-50 dark:bg-gray-800 border-b dark:border-gray-700 gap-2",children:[d.jsx("div",{className:"flex-1 min-w-0 flex items-center",children:d.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-300 truncate",title:b||"",children:[b," (Manually set)"]})}),Y&&d.jsxs("a",{href:Y,target:"_blank",rel:"noopener noreferrer",className:"h-8 text-xs text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 border border-blue-200 dark:border-blue-800 px-3 flex-shrink-0 rounded-md inline-flex items-center gap-1 no-underline hover:no-underline",children:[d.jsx(jl,{className:"w-3 h-3"}),"View"]})]}),X=()=>d.jsx(Xc,{details:u}),de=()=>{let le="Select a client email thread to view client information";return c&&r?le=`No client information found for ${r}`:e.length>0&&(t.length===0?le=`No client information available for emails on the selected thread: ${e.join(", ")}`:le="No client information available for the selected email ID"),d.jsx("div",{className:"p-3 text-sm text-gray-600 dark:text-gray-400",children:d.jsx("p",{className:"mb-2",children:le})})};return d.jsxs("div",{className:"w-full min-h-[4rem] border border-border/50 rounded-lg shadow-sm bg-card text-card-foreground",title:"Client Information",children:[d.jsxs("div",{className:"flex items-center justify-between p-2 border-b bg-muted",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(by,{className:"w-3.5 h-3.5 text-slate-600 dark:text-gray-300"}),d.jsx("span",{className:"font-medium text-sm text-slate-800 dark:text-white",children:"CONTACT"})]}),d.jsxs(Ls,{children:[d.jsx(Ms,{asChild:!0,children:d.jsx($e,{variant:"ghost",size:"icon",className:"h-6 w-6 hidden",children:d.jsx(Zs,{className:"h-4 w-4"})})}),d.jsx(ws,{align:"end",className:"p-2",children:d.jsx("div",{className:"flex flex-col gap-2 w-64",children:d.jsxs("div",{className:"flex gap-2 items-center",children:[d.jsx(rn,{type:"email",value:b||"",onChange:le=>E(le.target.value),placeholder:"Set client email",className:`flex-1 px-2 py-1 h-8 text-xs ${N===!1?"border-red-300 focus:ring-red-500":""}`}),d.jsx($e,{variant:"outline",size:"sm",className:`h-8 text-xs px-2 ${N===!1?"bg-red-50 hover:bg-red-100":""}`,onClick:()=>{i(b||""),T(!0)},disabled:!b,title:N===!1?"Warning: This email is not recognized as a valid client in Clio":"Set email as current client",children:"Search"})]})})})]})]}),m?V():j?d.jsxs(jy,{variant:"destructive",className:"m-2",children:[d.jsx(wy,{className:"h-4 w-4"}),d.jsx(Oy,{className:"ml-2",children:"Failed to fetch contact data. Please refresh to try again."})]}):d.jsxs(d.Fragment,{children:[t.length>0&&!c&&d.jsx(g,{clientUrl:Y}),c&&r&&d.jsx(ce,{}),u&&Object.keys(u).length>0?d.jsx(X,{}):A&&!c?d.jsx(Qs,{rows:2}):P&&!c?d.jsx("div",{className:"flex justify-center p-2",children:d.jsxs(jy,{variant:"default",className:"w-full border-amber-200 bg-amber-50 dark:border-amber-800 dark:bg-amber-950",children:[d.jsx(wy,{className:"h-4 w-4 text-amber-600 dark:text-amber-400"}),d.jsx(Oy,{className:"ml-2 text-amber-800 dark:text-amber-200",children:"Request timed out. Please try again later."})]})}):d.jsx(de,{})]}),U&&!c&&e.length!==t.length&&B&&d.jsx(Wq,{emailParticipants:e,emailParticipantClients:t,getClientNameFromCache:B,onContactsCreated:M})]})},Lv="src/shared/components/sidepanel/panels/components/ClioMatterLinking.tsx",ww=({createdContacts:r,onMatterLinked:e})=>{const t=Ur(),[n,s]=w.useState(!1),[i,c]=w.useState(""),[u,p]=w.useState(!1),[m,g]=w.useState(null),[x,b]=w.useState([]),[E,T]=w.useState([]),[S,N]=w.useState({}),[R,A]=w.useState(!1),[j,P]=w.useState(null),[M,B]=w.useState(null),[U,V]=w.useState(!1),Y=()=>{s(!0),P(null),T(r.map(se=>se.id))},ce=()=>{s(!1),c(""),p(!1),g(null),P(null),N({})},X=async se=>{if(c(se),p(!0),!se){g(null),b([]);return}if(se.length<3){b([]);return}V(!0);try{const te=((await Wy("clio",se,t)).projects||[]).map(G=>{var z;return{id:String(((z=G.projectId)==null?void 0:z.native)||""),name:G.projectName||"",status:G.isArchived?"closed":"open",description:G.projectName||""}});b(te)}catch(me){t.error("Error searching matters",me,{sourceFile:Lv,searchQuery:se})}finally{V(!1)}},de=se=>{g(se),c(se.name),p(!1)},we=se=>{T(me=>me.includes(se)?me.filter(te=>te!==se):[...me,se])},le=async()=>{if(m){A(!0),P(null);try{const se=[];for(const me of E){const te=S[me]||"Related Contact";try{await g8("clio",me,m.id,te,t),se.push(me),t.info("Contact linked to matter successfully",{sourceFile:Lv})}catch(G){t.error("Error linking contact to matter",G,{sourceFile:Lv}),G instanceof Error&&(G.message.includes("permission")?P({type:"permission",message:"You do not have permission to modify matters in Clio. Contact your admin."}):P({type:"network",message:"Something went wrong. Please try again."})),se.length>0&&(T(z=>z.filter(J=>!se.includes(J))),e&&e(m.id)),A(!1);return}}B(m),s(!1),A(!1),e&&e(m.id)}catch(se){t.error("Unexpected error in matter linking flow",se,{sourceFile:Lv}),P({type:"network",message:"Something went wrong. Please try again."}),A(!1)}}};return d.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700",children:d.jsxs("div",{className:"p-2",children:[!n&&!M&&d.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 border border-gray-300 dark:border-gray-600 rounded-md p-4",children:[d.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:"Link the created contact(s) to a matter as related contacts."}),d.jsx($e,{onClick:Y,size:"sm",className:"h-9",children:"Add to a matter"})]}),n&&d.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 border border-gray-300 dark:border-gray-600 rounded-md p-4",children:[d.jsx("h4",{className:"text-sm font-semibold text-gray-800 dark:text-gray-200 mb-1",children:"Link matter as a related contact"}),d.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-4",children:"Add as a related contact in Clio"}),j&&d.jsx("div",{role:"alert","aria-live":"assertive",className:"mb-4",children:d.jsx("div",{className:"flex items-start bg-red-50 dark:bg-red-950/30 border border-red-200 dark:border-red-800 text-red-900 dark:text-red-100 rounded-md p-3",children:d.jsxs("div",{className:"flex-1",children:[d.jsx("p",{className:"text-sm",children:j.message}),j.type==="network"&&d.jsx("div",{className:"mt-2",children:d.jsx($e,{onClick:le,size:"sm",variant:"destructive",className:"h-7 text-xs",children:"Retry"})})]})})}),d.jsxs("div",{className:"mb-4",children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Matter"}),d.jsx(rn,{type:"text",placeholder:"Search matters...",value:i,onChange:se=>X(se.target.value),onFocus:()=>p(!0),className:"h-9 text-sm"}),u&&i&&x.length>0&&d.jsx("div",{className:"mt-1 max-h-48 overflow-y-auto border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 shadow-lg",children:x.map(se=>d.jsxs("div",{onClick:()=>de(se),className:"flex items-center justify-between p-3 hover:bg-gray-50 dark:hover:bg-gray-700 cursor-pointer border-b dark:border-gray-600 last:border-b-0",children:[d.jsx("div",{className:"text-sm text-gray-900 dark:text-gray-100 flex-1 truncate",children:se.name}),d.jsx("span",{className:`ml-2 px-2 py-1 text-xs rounded-full ${se.status==="open"?"bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-400 border border-blue-300 dark:border-blue-800":"bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-300 border border-gray-300 dark:border-gray-700"}`,children:se.status==="open"?"Open":"Closed"})]},se.id))}),U&&d.jsx("div",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400",children:"Searching matters..."})]}),m&&d.jsx(d.Fragment,{children:d.jsxs("div",{className:"mb-4",children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Related contact(s) to add"}),r.map(se=>d.jsxs("div",{className:"mb-4",children:[d.jsxs("div",{className:"flex items-center gap-3 p-3 border dark:border-gray-600 rounded-md bg-white dark:bg-gray-800",children:[d.jsx("input",{type:"checkbox",checked:E.includes(se.id),onChange:()=>we(se.id),className:"h-4 w-4 text-blue-600"}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate",children:se.name}),d.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:se.email})]})]}),E.includes(se.id)&&d.jsxs("div",{className:"mt-2",children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Relationship"}),d.jsx(rn,{type:"text",placeholder:"e.g., Opposing Counsel, Co-Counsel, Employee",value:S[se.id]||"",onChange:me=>N(te=>({...te,[se.id]:me.target.value})),className:"h-9 text-sm"})]})]},se.id))]})}),d.jsxs("div",{className:"flex gap-2 pt-4 border-t dark:border-gray-700",children:[d.jsx($e,{onClick:le,disabled:!m||E.length===0||R,size:"sm",className:"h-9",children:R?"Saving...":"Save"}),d.jsx($e,{onClick:ce,variant:"outline",size:"sm",className:"h-9",children:"Back"})]})]}),M&&!n&&d.jsxs("div",{className:"bg-green-50 dark:bg-green-900/30 border border-green-200 dark:border-green-700 rounded-md p-4",children:[d.jsx("h4",{className:"text-sm font-semibold text-green-900 dark:text-green-100 mb-3",children:"Added to matter"}),d.jsx("div",{className:"mb-3 p-3 bg-white dark:bg-gray-800 rounded-md border border-gray-200 dark:border-gray-600",children:d.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:M.name})}),d.jsx("div",{className:"space-y-2 mb-3",children:r.filter(se=>E.includes(se.id)).map(se=>d.jsxs("div",{className:"flex items-center justify-between p-2 bg-white dark:bg-gray-800 rounded-md border border-gray-200 dark:border-gray-600",children:[d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate",children:se.name}),d.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:S[se.id]||"Related contact"})]}),d.jsxs("a",{href:`https://app.clio.com/nc#/contacts/${se.id}`,target:"_blank",rel:"noopener noreferrer",className:"h-7 text-xs text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 border border-blue-200 dark:border-blue-800 px-2 flex-shrink-0 rounded-md inline-flex items-center gap-1 no-underline hover:no-underline ml-2",children:[d.jsx(jl,{className:"w-3 h-3"}),"View"]})]},se.id))}),d.jsx("div",{className:"flex gap-2",children:d.jsx($e,{onClick:()=>{B(null),s(!0),g(null),c(""),N({})},variant:"outline",size:"sm",className:"h-9 whitespace-nowrap",children:"Link another matter"})})]})]})})},Nl="src/shared/components/sidepanel/panels/components/ClioCaseInfoBox.tsx",qq=({clientEmail:r,selectedCaseDetails:e,casesForCurrentClient:t,currentCaseIndex:n,linkableFields:s,nextCase:i,prevCase:c,isLoading:u,isManuallySet:p,setCurrentCaseIndex:m,calendarEntries:g=[],isValidating:x=!1,caseUrl:b,matterId:E,onMatterManuallySelected:T,fetchError:S=!1,hasTransientError:N=!1,userData:R,createdContacts:A=[],onMatterLinked:j,pageSize:P=5,currentPage:M=1,totalMatters:B,isLoadingPage:U=!1,onNavigateToPage:V})=>{var eu,Wl;const Y=Ur(),ce=id(),[X,de]=w.useState(!1),[we,le]=w.useState(!1),[se,me]=w.useState(!1),[te,G]=w.useState(!1),[z,J]=w.useState(""),[D,$]=w.useState(!1),[ne,_e]=w.useState(""),[q,ie]=w.useState([]),[xe,ye]=w.useState(!1),[ue,ke]=w.useState(!1),[He,Ue]=w.useState(null),[Le,Ne]=w.useState(!1),[gt,zt]=w.useState(""),[yt,Zt]=w.useState(""),[Bt,or]=w.useState(new Date().toISOString().split("T")[0]),[st,Ft]=w.useState("Normal"),[er,Ae]=w.useState(!1),[Ze,dt]=w.useState(!1),[rt,Lt]=w.useState(!1),gr=w.useRef(!1),tr=w.useRef(null),lt=w.useRef(!1),[kt,Nt]=w.useState(null),[ze,vr]=w.useState(null),[zr,Or]=w.useState(!0),[sn,mn]=w.useState(!1),[cn,_n]=w.useState(""),[as,An]=w.useState([]),[wi,bi]=w.useState(!1),[Dr,pe]=w.useState(!1),[Ye,pt]=w.useState(null),[Be,qt]=w.useState(""),[dr,Gt]=w.useState(""),[ot,yr]=w.useState(!1),[un,$n]=w.useState(1),[ko,Ba]=w.useState("Days"),[$s]=w.useState("Email"),[no,_i]=w.useState(!1),[ta,Ga]=w.useState(!0),[Wa,ut]=w.useState(!0),[Z,Oe]=w.useState(!0),[tt,br]=w.useState(!1),[Mt,Hr]=w.useState(""),[on,ls]=w.useState(""),[In,Ei]=w.useState(new Date().toISOString().split("T")[0]),[qr,No]=w.useState(!1),[En,ra]=w.useState(null),Un=()=>{zt(""),Zt(""),or(new Date().toISOString().split("T")[0]),Ft("Normal"),qt((R==null?void 0:R.id)||""),Gt((R==null?void 0:R.name)||""),_n(""),An([]),pt(null),yr(!1),$n(1),Ba("Days"),gr.current=!1,Nt(null),Or(!0),Ga(!0),ut(!0)},Qc=()=>{Hr(""),ls(""),Ei(new Date().toISOString().split("T")[0]),ra(null)};w.useEffect(()=>{vr(null)},[E]),w.useEffect(()=>{if(!kt)return;const Ee=setTimeout(()=>Nt(null),5e3);return()=>clearTimeout(Ee)},[kt]),w.useEffect(()=>{if(!En)return;const Ee=setTimeout(()=>ra(null),5e3);return()=>clearTimeout(Ee)},[En]),w.useEffect(()=>{const Ee=!!(Be&&(R!=null&&R.id)&&Be!==R.id);Oe(!Ee)},[Be,R]),w.useEffect(()=>{A&&A.length>0?mn(!0):mn(!1)},[A]),w.useEffect(()=>{E||(Un(),Ne(!1)),Le||(gr.current=!1)},[Le,E]),w.useEffect(()=>{Le&&R&&!Be&&(qt(R.id),Gt(R.name))},[Le,R,Be]);const cd=w.useMemo(()=>Fy.debounce(async Ee=>{if(!Ee.trim()||Ee.length<2){An([]),pt(null);return}bi(!0),pt(null);try{const Me=await wT(Y),Ge=Ee.toLowerCase();if(Me){const bt=Me.filter(xt=>xt.name.toLowerCase().includes(Ge)).sort((xt,wt)=>{const We=xt.name.toLowerCase().startsWith(Ge),it=wt.name.toLowerCase().startsWith(Ge);return We!==it?We?-1:1:xt.name.localeCompare(wt.name)});An(bt),bt.length===0&&pt(`No users found for "${Ee}"`)}else{lt.current||(lt.current=!0,IT("clio",Y).then(xt=>xT(xt.map(({id:wt,name:We})=>({id:wt,name:We})),Y)).catch(xt=>Y.error("Failed to refresh firm users cache",xt,{sourceFile:Nl})).finally(()=>{lt.current=!1}));const bt=await u8("clio",Ee,Y);An((bt.users||[]).map(({id:xt,name:wt})=>({id:xt,name:wt}))),(bt.users||[]).length===0&&pt(`No users found for "${Ee}"`)}}catch(Me){Y.error("Assignee search failed",Me,{sourceFile:Nl}),pt("Failed to search users. Please try again."),An([])}finally{bi(!1)}},400),[Y]);w.useEffect(()=>{const Ee=async Me=>{if(!Me){Un(),Ne(!1);return}if(Me.threadId!=tr.current){Un(),Ne(!1),tr.current=String(Me.threadId),vr(null);return}};return ce&&(ce.onThreadChanged(Ee),ce.getCurrentThread().then(Me=>{Ee(Me)}).catch(Me=>{Y.error("Error getting initial thread",Me,{sourceFile:"ClioCaseInfoBox.tsx"})})),()=>{ce==null||ce.removeThreadListener(Ee)}},[ce,Y]),w.useEffect(()=>{(async()=>{var Me;if(Le&&!gr.current){gr.current=!0,Ae(!0);try{const Ge=await ce.getCurrentThread();if(Ge&&((Me=Ge==null?void 0:Ge.messages)==null?void 0:Me.length)>0){const bt=Ge.messages[Ge.messages.length-1].subject,xt=Ge.messages[Ge.messages.length-1].body,wt="Subject: "+bt+`
Body: `+xt,We=await f8("clio",wt,Y);zt(We.name),Zt(We.description)}}catch(Ge){Y.error("Failed to generate task description",Ge,{sourceFile:Nl})}finally{Ae(!1)}}})()},[Le,ce,Y]);const ud=async()=>{var Ge;Nt(null);const Ee=[];if(gt.trim()||Ee.push("Task Name"),yt.trim()||Ee.push("Task Description"),E||Ee.push("Matter"),Be||Ee.push("Assign To"),(!Bt||!/^\d{4}-\d{2}-\d{2}$/.test(Bt)||Number.isNaN(Date.parse(Bt)))&&Ee.push("Date"),Ee.length>0){Nt({type:"error",text:`Please fill in the following fields: ${Ee.join(", ")}`});return}dt(!0);try{const bt=Bt?new Date(Bt).toISOString():null;let xt=yt;if(zr){const it=await ce.getCurrentThread();if(!it||((Ge=it==null?void 0:it.messages)==null?void 0:Ge.length)<1){Nt({type:"error",text:"Something went wrong. Please try again"});return}const gn=it.messages[it.messages.length-1].body;xt=yt+`

Referenced Email Below

`+gn}await h8("clio",gt,xt,E,bt,st,Y,Be||void 0,ot?{value:un,unit:ko,method:$s,assigneeId:Be||void 0}:void 0,Z?void 0:{notifyAssignee:ta,notifyCompletion:Wa}),Un(),Ne(!1),Nt({type:"success",text:"Task created successfully!"}),vr({name:gt,description:yt,due_at:Bt,priority:st})}catch(bt){Y.error("Failed to create task",bt,{sourceFile:Nl}),Nt({type:"error",text:"Failed to create task. Please try again."})}finally{dt(!1)}},na=async()=>{No(!0),ra(null);const Ee=[];if(Mt.trim()||Ee.push("Subject"),on.trim()||Ee.push("Note"),E||Ee.push("Matter"),(!In||!/^\d{4}-\d{2}-\d{2}$/.test(In)||Number.isNaN(Date.parse(In)))&&Ee.push("Date"),Ee.length>0){ra({type:"error",text:`Please fill in: ${Ee.join(", ")}`}),No(!1);return}try{const Ge=await p8("clio",Mt,on,In,E,null,Y);Y.info("Note created successfully",{sourceFile:Nl,noteId:Ge.noteId}),Qc(),br(!1),ra({type:"success",text:"Note created successfully!"})}catch(Ge){Y.error("Error creating note",Ge,{sourceFile:Nl}),ra({type:"error",text:Ge instanceof Error?Ge.message:"Failed to create note"})}finally{No(!1)}};w.useMemo(()=>{if(!z.trim())return t;const Ee=z.toLowerCase();return t.filter(Me=>String(Me.description||"").toLowerCase().includes(Ee))},[t,z]);const Bl=Ee=>{$(Ee),Ee||J("")},sa=w.useMemo(()=>Fy.debounce(async Ee=>{if(!Ee.trim()||Ee.length<2){ie([]),Ue(null);return}ye(!0),Ue(null);try{const Me=await Wy("clio",Ee,Y);ie(Me.projects||[]),Me.projects.length===0&&Ue(`No matters found for "${Ee}"`)}catch(Me){Y.error("Matter search failed",Me,{sourceFile:Nl}),Ue("Failed to search matters. Please try again."),ie([])}finally{ye(!1)}},400),[Y]),Si=Ee=>{var Me,Ge;try{const bt={id:((Ge=(Me=Ee.projectId)==null?void 0:Me.native)==null?void 0:Ge.toString())||"",description:Ee.projectName||"",practice_area:Ee.projectTypeName||"",matter_stage:Ee.phaseName||"",status:Ee.isArchived?"Closed":"Open",client_name:Ee.clientName||"",responsible_attorney:Ee.firstPrimaryName||"",url:Ee.projectUrl||"",name:Ee.projectName||""};Y.info("Matter manually selected via search",{matterId:bt.id,matterName:bt.description,sourceFile:Nl}),T&&T(bt),ke(!1),_e(""),ie([]),Ue(null)}catch(bt){Y.error("Failed to select matter",bt,{sourceFile:Nl})}},dd=()=>d.jsx(Qs,{rows:2}),vh=Ee=>{if(m)m(Ee);else if(Ee>n)for(let Me=n;Me<Ee;Me++)i();else if(Ee<n)for(let Me=n;Me>Ee;Me--)c()},Ko=Ee=>{try{const Me=Ee.split("T")[0];if(!Me)return Ee;const[Ge,bt,xt]=Me.split("-").map(Number);return isNaN(Ge)||isNaN(bt)||isNaN(xt)||bt<1||bt>12?Ee:`${["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][bt-1]} ${xt}, ${Ge}`}catch{return Ee}},Va=Ee=>{try{const Me=Ee.split("T")[1];if(!Me)return"";const Ge=Me.split(/[Z+-]/)[0],[bt,xt]=Ge.split(":").map(Number);if(isNaN(bt)||isNaN(xt))return"";const wt=bt>=12?"PM":"AM",We=bt%12||12,it=xt.toString().padStart(2,"0");return`${We}:${it} ${wt}`}catch{return""}},qa=Ee=>Ee?(new DOMParser().parseFromString(Ee,"text/html").body.textContent||"").length>200:!1,oa=Ee=>{const Me=["a","b","br","div","em","i","li","ol","p","s","strong","u","ul"],Ge=["href","rel","type","target"],xt=new DOMParser().parseFromString(Ee,"text/html"),wt=xt.body.getElementsByTagName("*");for(let We=wt.length-1;We>=0;We--){const it=wt[We];Me.includes(it.tagName.toLowerCase())?Array.from(it.attributes).forEach(Yn=>{Ge.includes(Yn.name.toLowerCase())||it.removeAttribute(Yn.name)}):it.replaceWith(document.createTextNode(it.textContent||""))}return xt.body.innerHTML},fd=()=>{if(!t.length||n>=t.length)return[];const Ee=t[n],Me=String(Ee.id||"");return Me?g.filter(Ge=>{var xt;return String(((xt=Ge.matter)==null?void 0:xt.id)||Ge.case_id||"")===Me}):[]},Ka=Ee=>{const Me=String(Ee.start_at||Ee.date||"");if(!Me)return!1;try{return new Date(Me)>=new Date}catch{return!1}},fr=()=>{const Me=fd().filter(Ka).sort((Ge,bt)=>{const xt=new Date(String(Ge.start_at||Ge.date||"")),wt=new Date(String(bt.start_at||bt.date||""));return xt.getTime()-wt.getTime()});return Me.length>0?[Me[0]]:Me},Ci=()=>{const Ee=fr(),Me=t.length>0&&n<t.length?t[n]:null,Ge=Me==null?void 0:Me.id,bt=Ge?`https://app.clio.com/nc/#/matters/${Ge}/calendar`:null;return d.jsxs("div",{className:"border-t bg-card",children:[d.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800",children:[d.jsxs("div",{className:"flex items-center gap-2 cursor-pointer flex-1 hover:opacity-80 transition-opacity",onClick:()=>de(!X),children:[d.jsx(Df,{className:"w-4 h-4 text-slate-600 dark:text-gray-300"}),d.jsx("span",{className:"font-medium text-sm text-slate-800 dark:text-white",children:"Next Event"}),Ee.length>0&&!u&&(X?d.jsx(Vv,{className:"w-4 h-4 text-gray-400"}):d.jsx(ys,{className:"w-4 h-4 text-gray-400"}))]}),bt&&d.jsxs("a",{href:bt,target:"_blank",rel:"noopener noreferrer",className:"h-7 text-xs text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 border border-blue-200 dark:border-blue-800 px-2 flex-shrink-0 rounded-md inline-flex items-center gap-1 no-underline hover:no-underline",onClick:xt=>xt.stopPropagation(),children:[d.jsx(jl,{className:"w-3 h-3"}),"View all"]})]}),!X&&d.jsx(d.Fragment,{children:u?d.jsx(Qs,{rows:2}):Ee.length>0?d.jsx("div",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:Ee.map((xt,wt)=>{const We=String(xt.start_at||xt.date||""),it=String(xt.end_at||""),gn=String(xt.summary||xt.title||"Calendar Event"),Yn=String(xt.location||"");return d.jsxs("div",{className:"p-3 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:[d.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-gray-100 mb-1",children:gn}),d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{className:"space-y-1",children:[d.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600 dark:text-gray-400",children:[d.jsx(Df,{className:"w-3 h-3"}),d.jsx("span",{children:Ko(We)})]}),Yn&&d.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600 dark:text-gray-400",children:[d.jsx(gB,{className:"w-3 h-3"}),d.jsx("span",{children:Yn})]})]}),d.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600 dark:text-gray-400",children:[d.jsx(Cv,{className:"w-3 h-3"}),d.jsxs("span",{children:[Va(We),it&&` - ${Va(it)}`]})]})]})]},wt)})}):d.jsx("div",{className:"p-3 text-sm text-gray-600 dark:text-gray-400",children:r&&t.length>0?d.jsx(d.Fragment,{children:d.jsx("p",{className:"mb-2",children:"No upcoming calendar entries found for this case"})}):"Select a client email thread to view calendar entries"})})]})},Zc=()=>{const Ee=t.length>0&&n<t.length?t[n]:null,Me=Ee==null?void 0:Ee.last_completed_task,Ge=Ee==null?void 0:Ee.next_upcoming_task,bt=Me||Ge,xt=Ee==null?void 0:Ee.id,wt=xt?`https://app.clio.com/nc/#/matters/${xt}/tasks`:null;return d.jsxs("div",{className:"border-t bg-card",children:[d.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800",children:[d.jsxs("div",{className:"flex items-center gap-2 cursor-pointer flex-1 hover:opacity-80 transition-opacity",onClick:()=>le(!we),children:[d.jsx(mB,{className:"w-4 h-4 text-slate-600 dark:text-gray-300"}),d.jsx("span",{className:"font-medium text-sm text-slate-800 dark:text-white",children:"Tasks"}),(bt||Le)&&!u&&(we?d.jsx(Vv,{className:"w-4 h-4 text-gray-400"}):d.jsx(ys,{className:"w-4 h-4 text-gray-400"}))]}),d.jsxs("div",{className:"flex items-center gap-2",children:[E&&(Le?d.jsxs($e,{variant:"ghost",size:"sm",className:"h-7 text-xs text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 px-2",onClick:We=>{We.stopPropagation(),Ne(!1),Un()},children:[d.jsx(Rk,{className:"w-3 h-3 mr-1"}),"Remove"]}):d.jsxs($e,{variant:"ghost",size:"sm",className:"h-7 text-xs text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 px-2",onClick:We=>{We.stopPropagation(),Ne(!0)},children:[d.jsx(Ak,{className:"w-3 h-3 mr-1"}),"Add Task"]})),wt&&d.jsxs("a",{href:wt,target:"_blank",rel:"noopener noreferrer",className:"h-7 text-xs text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 border border-blue-200 dark:border-blue-800 px-2 flex-shrink-0 rounded-md inline-flex items-center gap-1 no-underline hover:no-underline",onClick:We=>We.stopPropagation(),children:[d.jsx(jl,{className:"w-3 h-3"}),"View all"]})]})]}),!we&&d.jsxs(d.Fragment,{children:[Le&&d.jsx("div",{className:"p-3 border-b border-gray-200 dark:border-gray-700 bg-gray-50/50 dark:bg-gray-800/50",children:d.jsxs("div",{className:"space-y-3",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Task Name"}),d.jsx(rn,{disabled:er,placeholder:er?"Generating task name...":"Enter task name...",value:gt,onChange:We=>zt(We.target.value),className:"h-8 text-sm"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Task Description"}),d.jsx("textarea",{placeholder:er?"Generating task description...":"Enter task description...",value:yt,onChange:We=>Zt(We.target.value),disabled:er,className:`w-full min-h-[80px] px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 resize-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${er?"opacity-60 cursor-not-allowed":""}`}),er&&d.jsxs("div",{className:"flex items-center gap-2 mt-1 text-xs text-gray-500 dark:text-gray-400",children:[d.jsx("div",{className:"w-3 h-3 border-2 border-gray-300 border-t-blue-600 rounded-full animate-spin"}),"Generating task from email..."]})]}),d.jsxs("div",{className:"flex gap-3",children:[d.jsxs("div",{className:"flex-1",children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Due At"}),d.jsx(rn,{type:"date",value:Bt,onChange:We=>or(We.target.value),className:"h-8 text-sm"})]}),d.jsxs("div",{className:"flex-1",children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Priority"}),d.jsxs(Ls,{open:rt,onOpenChange:Lt,children:[d.jsx(Ms,{asChild:!0,children:d.jsxs($e,{variant:"outline",className:"w-full h-8 text-sm justify-between font-normal",children:[d.jsx("span",{children:st}),d.jsx(ys,{className:"w-3 h-3 ml-2 flex-shrink-0"})]})}),d.jsx(ws,{align:"start",className:"w-[140px]",children:["High","Normal","Low"].map(We=>d.jsx(os,{className:`cursor-pointer ${st===We?"bg-gray-100 dark:bg-gray-700":""}`,onClick:()=>{Ft(We),Lt(!1)},children:We},We))})]})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Assign To"}),d.jsxs(Ls,{open:Dr,onOpenChange:pe,children:[d.jsx(Ms,{asChild:!0,children:d.jsxs($e,{variant:"outline",className:"w-full h-8 text-sm justify-between font-normal",children:[d.jsx("span",{className:"truncate",children:dr||"Select assignee"}),d.jsx(ys,{className:"w-3 h-3 ml-2 flex-shrink-0"})]})}),d.jsxs(ws,{align:"start",className:"w-[320px] p-0",children:[d.jsxs("div",{className:"p-3 border-b border-gray-200 dark:border-gray-700",children:[d.jsx("div",{className:"text-sm font-medium mb-2 text-gray-800 dark:text-gray-200",children:"Search Users"}),d.jsxs("div",{className:"relative",children:[d.jsx(Zs,{className:"absolute left-2 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),d.jsx(rn,{placeholder:"Search by name...",value:cn,onChange:We=>{const it=We.target.value;_n(it),cd(it)},className:"pl-8 pr-8 h-9 text-sm",autoFocus:!0,onClick:We=>We.stopPropagation(),onKeyDown:We=>We.stopPropagation()}),cn&&d.jsx("button",{onClick:We=>{We.stopPropagation(),_n(""),An([]),pt(null)},className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:d.jsx(gi,{className:"w-4 h-4"})})]})]}),d.jsx("div",{className:"max-h-[300px] overflow-y-auto",children:wi?d.jsxs("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 flex items-center gap-2",children:[d.jsx("div",{className:"w-4 h-4 border-2 border-gray-300 border-t-gray-600 rounded-full animate-spin"}),"Searching..."]}):Ye&&as.length===0?d.jsx("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:Ye}):as.length>0?as.map(We=>d.jsx(os,{className:"flex flex-col items-start p-3 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-800",onClick:()=>{qt(We.id),Gt(We.name),pe(!1),_n(""),An([])},children:d.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-gray-100",children:We.name})},We.id)):cn.trim()&&!wi?d.jsxs("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:['No users found for "',cn,'"']}):d.jsx("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:dr?d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Currently assigned to: ",dr]}),d.jsx("div",{className:"text-xs",children:"Type at least 2 characters to search for other users..."})]}):"Type at least 2 characters to search users..."})})]})]})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("input",{type:"checkbox",id:"hasReminder",checked:ot,onChange:We=>yr(We.target.checked),className:"cursor-pointer"}),d.jsx("label",{htmlFor:"hasReminder",className:"text-xs font-medium text-gray-700 dark:text-gray-300 cursor-pointer",children:"Add Reminder"})]}),ot&&d.jsxs("div",{className:"pl-5 space-y-2 border-l-2 border-gray-200 dark:border-gray-600",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Remind"}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx(rn,{type:"number",min:"1",value:un,onChange:We=>$n(Math.max(1,parseInt(We.target.value)||1)),className:"h-8 text-sm w-20"}),d.jsxs(Ls,{open:no,onOpenChange:_i,children:[d.jsx(Ms,{asChild:!0,children:d.jsxs($e,{variant:"outline",className:"flex-1 h-8 text-sm justify-between font-normal",children:[d.jsx("span",{children:ko}),d.jsx(ys,{className:"w-3 h-3 ml-2 flex-shrink-0"})]})}),d.jsx(ws,{align:"start",className:"w-[140px]",children:["Minutes","Hours","Days","Weeks"].map(We=>d.jsx(os,{className:`cursor-pointer ${ko===We?"bg-gray-100 dark:bg-gray-700":""}`,onClick:()=>{Ba(We),_i(!1)},children:We},We))})]})]}),d.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"before due date"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Delivery Method"}),d.jsx("div",{className:"w-full h-8 px-3 text-sm flex items-center border border-input rounded-md bg-gray-50 dark:bg-gray-800 text-gray-700 dark:text-gray-300",children:"Email"})]})]})]}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("input",{type:"checkbox",id:"appendEmailToDescription",checked:zr,onChange:We=>Or(We.target.checked),className:"cursor-pointer"}),d.jsx("label",{htmlFor:"appendEmailToDescription",className:"text-xs text-gray-700 dark:text-gray-300 cursor-pointer",children:"Append email to Description"})]}),!Z&&d.jsxs("div",{className:"space-y-2 pt-2 border-t border-gray-200 dark:border-gray-700",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("input",{type:"checkbox",id:"notifyAssignee",checked:ta,onChange:We=>Ga(We.target.checked),className:"cursor-pointer"}),d.jsx("label",{htmlFor:"notifyAssignee",className:"text-xs text-gray-700 dark:text-gray-300 cursor-pointer",children:"Notify assignee when task is assigned"})]}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("input",{type:"checkbox",id:"notifyCompletion",checked:Wa,onChange:We=>ut(We.target.checked),className:"cursor-pointer"}),d.jsx("label",{htmlFor:"notifyCompletion",className:"text-xs text-gray-700 dark:text-gray-300 cursor-pointer",children:"Notify me when task is completed"})]})]}),d.jsx($e,{onClick:ud,disabled:Ze,className:"w-full h-8 text-sm",children:Ze?"Creating task in Clio...":"Create Task"})]})}),kt&&d.jsx("div",{className:`p-2 rounded-md text-sm ${kt.type==="success"?"bg-green-50 dark:bg-green-900/20 text-green-700 dark:text-green-400 border border-green-200 dark:border-green-800":"bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-400 border border-red-200 dark:border-red-800"}`,children:kt.text}),ze&&d.jsx("div",{className:"p-3 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:d.jsxs("div",{className:"flex items-start gap-2 mb-2",children:[d.jsx(Cv,{className:"w-4 h-4 text-blue-600 dark:text-blue-400 mt-0.5 flex-shrink-0"}),d.jsxs("div",{className:"flex-1",children:[d.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 font-medium mb-1",children:"Newly Created Task"}),d.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-gray-100 mb-1",children:String(ze.name||"Untitled Task")}),d.jsxs("div",{className:"space-y-1",children:[!!ze.due_at&&d.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600 dark:text-gray-400",children:[d.jsx(Df,{className:"w-3 h-3"}),d.jsxs("span",{children:["Due: ",Ko(String(ze.due_at))]})]}),!!ze.priority&&d.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600 dark:text-gray-400",children:[d.jsx("span",{className:"font-medium",children:"Priority:"}),d.jsx("span",{children:String(ze.priority)})]})]})]})]})}),u?d.jsx(Qs,{rows:2}):bt?d.jsxs("div",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:[Me&&d.jsx("div",{className:"p-3 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:d.jsxs("div",{className:"flex items-start gap-2 mb-2",children:[d.jsx(Hc,{className:"w-4 h-4 text-green-600 dark:text-green-400 mt-0.5 flex-shrink-0"}),d.jsxs("div",{className:"flex-1",children:[d.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 font-medium mb-1",children:"Last Completed Task"}),d.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-gray-100 mb-1",children:String(Me.name||"Untitled Task")}),!!Me.completed_at&&d.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600 dark:text-gray-400",children:[d.jsx(Df,{className:"w-3 h-3"}),d.jsxs("span",{children:["Completed: ",Ko(String(Me.completed_at))]})]})]})]})}),Ge&&d.jsx("div",{className:"p-3 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:d.jsxs("div",{className:"flex items-start gap-2 mb-2",children:[d.jsx(Cv,{className:"w-4 h-4 text-blue-600 dark:text-blue-400 mt-0.5 flex-shrink-0"}),d.jsxs("div",{className:"flex-1",children:[d.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 font-medium mb-1",children:"Next Upcoming Task"}),d.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-gray-100 mb-1",children:String(Ge.name||"Untitled Task")}),d.jsxs("div",{className:"space-y-1",children:[!!Ge.due_at&&d.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600 dark:text-gray-400",children:[d.jsx(Df,{className:"w-3 h-3"}),d.jsxs("span",{children:["Due: ",Ko(String(Ge.due_at))]})]}),!!Ge.priority&&d.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600 dark:text-gray-400",children:[d.jsx("span",{className:"font-medium",children:"Priority:"}),d.jsx("span",{children:String(Ge.priority)})]})]})]})]})})]}):!Le&&!ze?d.jsx("div",{className:"p-3 text-sm text-gray-600 dark:text-gray-400",children:r&&t.length>0?d.jsx(d.Fragment,{children:d.jsx("p",{className:"mb-2",children:"No tasks found for this matter"})}):"Select a client email thread to view tasks"}):null]})]})},Gl=()=>{const Ee=t.length>0&&n<t.length?t[n]:null,Me=Ee==null?void 0:Ee.most_recent_note,Ge=Me&&Me.detail,bt=Ee==null?void 0:Ee.id,xt=bt?`https://app.clio.com/nc/#/matters/${bt}/notes`:null;return d.jsxs("div",{className:"border-t bg-card",children:[d.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800",children:[d.jsxs("div",{className:"flex items-center gap-2 cursor-pointer flex-1 hover:opacity-80 transition-opacity",onClick:()=>me(!se),children:[d.jsx(Qf,{className:"w-4 h-4 text-slate-600 dark:text-gray-300"}),d.jsx("span",{className:"font-medium text-sm text-slate-800 dark:text-white",children:"Latest Note"}),!!Ge&&!u&&d.jsx(d.Fragment,{children:se?d.jsx(Vv,{className:"w-4 h-4 text-gray-400"}):d.jsx(ys,{className:"w-4 h-4 text-gray-400"})})]}),d.jsxs("div",{className:"flex items-center gap-2",children:[bt&&(tt?d.jsxs($e,{variant:"ghost",size:"sm",className:"h-7 text-xs text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 px-2",onClick:wt=>{wt.stopPropagation(),br(!1),Qc()},children:[d.jsx(Rk,{className:"w-3 h-3 mr-1"}),"Remove"]}):d.jsxs($e,{variant:"ghost",size:"sm",className:"h-7 text-xs text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 px-2",onClick:wt=>{wt.stopPropagation(),br(!0)},children:[d.jsx(Ak,{className:"w-3 h-3 mr-1"}),"Add Note"]})),xt&&d.jsxs("a",{href:xt,target:"_blank",rel:"noopener noreferrer",className:"h-7 text-xs text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 border border-blue-200 dark:border-blue-800 px-2 flex-shrink-0 rounded-md inline-flex items-center gap-1 no-underline hover:no-underline",onClick:wt=>wt.stopPropagation(),children:[d.jsx(jl,{className:"w-3 h-3"}),"View all"]})]})]}),tt&&d.jsx("div",{className:"bg-gray-50/50 dark:bg-gray-800/30 p-3 border-b border-gray-200 dark:border-gray-700",children:d.jsxs("div",{className:"space-y-3",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Subject"}),d.jsx(rn,{type:"text",value:Mt,onChange:wt=>Hr(wt.target.value),placeholder:"Enter note subject...",className:"h-9 text-sm"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Note"}),d.jsx("textarea",{value:on,onChange:wt=>ls(wt.target.value),placeholder:"Enter note details...",className:"w-full min-h-[80px] px-3 py-2 text-sm border rounded-md resize-y dark:bg-gray-800 dark:border-gray-600 dark:text-gray-100",rows:3})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Date"}),d.jsx(rn,{type:"date",value:In,onChange:wt=>Ei(wt.target.value),className:"h-9 text-sm"})]}),d.jsx($e,{onClick:na,disabled:qr,className:"w-full h-9",children:qr?"Creating note in Clio...":"Create Note"})]})}),En&&d.jsx("div",{className:`p-2 rounded-md text-sm ${En.type==="success"?"bg-green-50 dark:bg-green-900/20 text-green-700 dark:text-green-400 border border-green-200 dark:border-green-800":"bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-400 border border-red-200 dark:border-red-800"}`,children:En.text}),!se&&d.jsx(d.Fragment,{children:u?d.jsx(Qs,{rows:1}):Ge?d.jsx("div",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:d.jsxs("div",{className:"p-3 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:[d.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-gray-100 mb-2",children:String(Me.subject||"Note")}),d.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600 dark:text-gray-400 mb-2",children:[d.jsx(Df,{className:"w-3 h-3"}),d.jsx("span",{children:Ko(String(Me.created_at))}),(()=>{const wt=Va(String(Me.created_at||""));return wt?d.jsxs(d.Fragment,{children:[d.jsx("span",{children:""}),d.jsx(Cv,{className:"w-3 h-3"}),d.jsx("span",{children:wt})]}):null})()]}),d.jsx("div",{className:"text-sm text-gray-700 dark:text-gray-300",children:(()=>{const wt=String(Me.detail||""),We=qa(wt);return te||!We?d.jsx("div",{className:"prose prose-sm max-w-none dark:prose-invert",dangerouslySetInnerHTML:{__html:oa(wt)}}):d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"line-clamp-3 prose prose-sm max-w-none dark:prose-invert",dangerouslySetInnerHTML:{__html:oa(wt)}}),d.jsx("button",{onClick:it=>{it.stopPropagation(),G(!0)},className:"text-blue-600 dark:text-blue-400 hover:underline mt-1 text-xs font-medium",children:"Expand"})]})})()}),te&&d.jsx("button",{onClick:wt=>{wt.stopPropagation(),G(!1)},className:"text-blue-600 dark:text-blue-400 hover:underline mt-2 text-xs font-medium",children:"Show less"})]})}):d.jsx("div",{className:"p-3 text-sm text-gray-600 dark:text-gray-400",children:r&&t.length>0?"No notes found for this matter":"Select a client email thread to view matter notes"})})]})};return d.jsxs("div",{className:"w-full min-h-[4rem] border border-border/50 rounded-lg shadow-sm bg-card text-card-foreground",title:"Matters and Calendar Information",children:[d.jsxs("div",{className:"flex items-center justify-between p-2 border-b bg-muted",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(YR,{className:"w-3.5 h-3.5 text-slate-600 dark:text-gray-300"}),d.jsx("span",{className:"font-medium text-sm text-slate-800 dark:text-white",children:"MATTERS"})]}),d.jsxs(Ls,{open:ue,onOpenChange:ke,children:[d.jsx(Ms,{asChild:!0,children:d.jsx($e,{variant:"ghost",size:"icon",className:"h-8 w-8 hidden",title:"Search all matters",children:d.jsx(Zs,{className:"h-4 w-4"})})}),d.jsxs(ws,{align:"end",className:"w-[320px] p-0",children:[d.jsxs("div",{className:"p-3 border-b border-gray-200 dark:border-gray-700",children:[d.jsx("div",{className:"text-sm font-medium mb-2 text-gray-800 dark:text-gray-200",children:"Search All Matters"}),d.jsxs("div",{className:"relative",children:[d.jsx(Zs,{className:"absolute left-2 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),d.jsx(rn,{placeholder:"Search by matter or client name...",value:ne,onChange:Ee=>{const Me=Ee.target.value;_e(Me),sa(Me)},className:"pl-8 pr-8 h-9 text-sm",autoFocus:!0,onClick:Ee=>Ee.stopPropagation(),onKeyDown:Ee=>Ee.stopPropagation()}),ne&&d.jsx("button",{onClick:Ee=>{Ee.stopPropagation(),_e(""),ie([]),Ue(null)},className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:d.jsx(gi,{className:"w-4 h-4"})})]})]}),d.jsx("div",{className:"max-h-[300px] overflow-y-auto",children:xe?d.jsxs("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 flex items-center gap-2",children:[d.jsx("div",{className:"w-4 h-4 border-2 border-gray-300 border-t-gray-600 rounded-full animate-spin"}),"Searching..."]}):He&&q.length===0?d.jsx("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:He}):q.length>0?q.map(Ee=>d.jsxs(os,{className:"flex flex-col items-start p-3 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-800",onClick:()=>Si(Ee),children:[d.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-gray-100",children:Ee.projectName}),d.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5",children:[Ee.phaseName,"  Client: ",Ee.clientName]})]},Ee.projectId.native)):ne.trim()&&!xe?d.jsxs("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:['No matters found for "',ne,'"']}):d.jsx("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:"Type at least 2 characters to search matters..."})})]})]})]}),u?dd():S?d.jsxs(jy,{variant:"destructive",className:"m-2",children:[d.jsx(wy,{className:"h-4 w-4"}),d.jsx(Oy,{className:"ml-2",children:"Failed to fetch matter data. Please refresh to try again."})]}):e&&Object.keys(e).length>0?d.jsxs(d.Fragment,{children:[t.length>0&&d.jsxs("div",{className:"flex items-center px-3 py-1 bg-gray-50 dark:bg-gray-800 border-b dark:border-gray-700 gap-2",children:[d.jsx("div",{className:"flex-1 min-w-0 flex items-center",children:(()=>{const Ee=B??t.length,Me=Ee>P,Ge=Me?Math.ceil(Ee/P):1,bt=(M-1)*P+1,xt=Math.min(M*P,Ee),wt=z?t.filter(it=>String(it.description||"").toLowerCase().includes(z.toLowerCase())):t,We=()=>{if(Ge<=5)return Array.from({length:Ge},(gn,Yn)=>Yn+1);const it=[];return M<=3?it.push(1,2,3,"...",Ge):M>=Ge-2?it.push(1,"...",Ge-2,Ge-1,Ge):it.push(1,"...",M,"...",Ge),it};return d.jsx(d.Fragment,{children:t.length>1||Me?d.jsxs(Ls,{open:D,onOpenChange:Bl,children:[d.jsx(Ms,{asChild:!0,children:d.jsxs($e,{variant:"ghost",size:"sm",className:"h-auto text-left text-gray-600 dark:text-gray-300 flex flex-col items-start gap-0 px-2 py-1 max-w-full overflow-hidden",children:[d.jsx("span",{className:"text-sm truncate font-medium w-full",title:e.Title||"",children:e.Title||"Case"}),d.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400 flex items-center gap-1",children:[(M-1)*P+n+1," of ",Ee," matters in Clio",d.jsx(ys,{className:"w-3 h-3"})]})]})}),d.jsxs(ws,{align:"start",className:"w-[320px] p-0",children:[d.jsx("div",{className:"p-2 border-b border-gray-200 dark:border-gray-700",children:d.jsxs("div",{className:"relative",children:[d.jsx(Zs,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),d.jsx(rn,{placeholder:"Search matters...",value:z,onChange:it=>J(it.target.value),className:"pl-8 pr-8 h-8 text-xs",autoFocus:!0,onClick:it=>it.stopPropagation(),onKeyDown:it=>it.stopPropagation()}),z&&d.jsx("button",{onClick:it=>{it.stopPropagation(),J("")},className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:d.jsx(gi,{className:"w-4 h-4"})})]})}),d.jsx("div",{className:"px-3 py-1.5 text-xs text-gray-500 dark:text-gray-400 border-b border-gray-100 dark:border-gray-700",children:"Sorted by: last opened in Clio"}),d.jsx("div",{className:"max-h-[250px] overflow-y-auto",children:wt.length>0?wt.map(it=>{const gn=t.indexOf(it),Yn=gn===n,tu=(M-1)*P+gn+1;return d.jsx(os,{className:`text-sm py-2.5 px-3 truncate ${Yn?"bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400 font-medium":""}`,onClick:()=>vh(gn),children:String(it.description||`Case ${tu}`)},tu)}):d.jsxs("div",{className:"p-3 text-xs text-center text-gray-500 dark:text-gray-400",children:["No matters match ",z,""]})}),Me&&d.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 px-3 py-2",children:[d.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mb-2",children:["Showing ",bt,"-",xt," of ",Ee," matters"]}),d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("button",{onPointerDown:it=>{it.preventDefault(),it.stopPropagation()},onClick:it=>{it.stopPropagation(),V==null||V(M-1)},disabled:M<=1||U,className:"text-xs px-2 py-1 text-gray-600 dark:text-gray-400 border border-gray-300 dark:border-gray-600 rounded hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-40 disabled:cursor-not-allowed",children:" Newer"}),d.jsx("div",{className:"flex items-center gap-1",children:We().map((it,gn)=>it==="..."?d.jsx("span",{className:"text-xs text-gray-400 px-1",children:""},`ellipsis-${gn}`):d.jsx("button",{disabled:it===M||U,className:`text-xs w-6 h-6 rounded flex items-center justify-center ${it===M?"bg-blue-600 text-white font-medium":"text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700"} disabled:opacity-40 disabled:cursor-not-allowed`,onPointerDown:Yn=>{Yn.preventDefault(),Yn.stopPropagation()},onClick:Yn=>{Yn.stopPropagation(),typeof it=="number"&&(V==null||V(it))},children:it},it))}),d.jsx("button",{onPointerDown:it=>{it.preventDefault(),it.stopPropagation()},onClick:it=>{it.stopPropagation(),V==null||V(M+1)},disabled:M>=Ge||U,className:"text-xs px-2 py-1 text-gray-600 dark:text-gray-400 border border-gray-300 dark:border-gray-600 rounded hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-40 disabled:cursor-not-allowed",children:U?d.jsx("span",{className:"flex items-center gap-1",children:d.jsx("span",{className:"animate-spin h-2.5 w-2.5 border-2 border-gray-400 border-t-transparent rounded-full"})}):d.jsx(d.Fragment,{children:"Older "})})]})]})]})]}):d.jsxs("div",{className:"flex flex-col px-2 py-1 overflow-hidden",children:[d.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-300 truncate font-medium w-full",title:e.Title||"",children:e.Title||"Case"}),d.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[(M-1)*P+n+1," of ",Ee," matters in Clio"]})]})})})()}),((eu=s.find(Ee=>Ee.field==="Title"))==null?void 0:eu.url)&&d.jsxs("a",{href:(Wl=s.find(Ee=>Ee.field==="Title"))==null?void 0:Wl.url,target:"_blank",rel:"noopener noreferrer",className:"h-8 text-xs text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 border border-blue-200 dark:border-blue-800 px-3 flex-shrink-0 rounded-md inline-flex items-center gap-1 no-underline hover:no-underline",children:[d.jsx(jl,{className:"w-3 h-3"}),"View"]})]}),sn&&!p&&d.jsx(ww,{createdContacts:A,onMatterLinked:j}),d.jsx("div",{className:"break-words",children:d.jsx(Xc,{details:e})}),Gl(),Ci(),Zc()]}):x?d.jsx(Qs,{rows:2}):d.jsx("div",{className:"p-3 text-sm text-gray-600 dark:text-gray-400",children:r?d.jsxs(d.Fragment,{children:[d.jsx("p",{className:"mb-2",children:"Select a client email thread to view matter information"}),sn&&!p&&d.jsx(ww,{createdContacts:A,onMatterLinked:j})]}):d.jsxs(d.Fragment,{children:[sn&&!p&&d.jsx(ww,{createdContacts:A,onMatterLinked:j}),!sn&&"Select a client email thread to view case information"]})})]})},bw="src/shared/components/sidepanel/panels/components/UnifiedSearch.tsx",Kq=({onMatterSelected:r})=>{const e=Ur(),t=w.useRef(null),[n,s]=w.useState(""),[i,c]=w.useState([]),[u,p]=w.useState(!1),[m,g]=w.useState(!1),[x,b]=w.useState(null);w.useEffect(()=>{const S=N=>{t.current&&!t.current.contains(N.target)&&g(!1)};return document.addEventListener("mousedown",S),()=>{document.removeEventListener("mousedown",S)}},[]);const E=w.useMemo(()=>Fy.debounce(async S=>{if(!S.trim()||S.length<2){c([]),b(null);return}p(!0),b(null);try{const N=await Wy("clio",S,e);c(N.projects||[]),N.projects.length===0&&b(`No matters found for "${S}"`)}catch(N){e.error("Matter search failed",N,{sourceFile:bw}),b("Failed to search matters. Please try again."),c([])}finally{p(!1)}},400),[e]),T=S=>{var N,R;try{e.info("Matter selected via unified search",{matterId:(R=(N=S.projectId)==null?void 0:N.native)==null?void 0:R.toString(),matterName:S.projectName,sourceFile:bw}),r(S),g(!1),s(""),c([]),b(null)}catch(A){e.error("Failed to select matter",A,{sourceFile:bw})}};return d.jsxs("div",{ref:t,className:"w-full mb-3 p-1",children:[d.jsxs("div",{className:"relative",children:[d.jsx(Zs,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400 pointer-events-none z-10"}),d.jsx(rn,{placeholder:"Search clients and matters...",value:n,onChange:S=>{const N=S.target.value;s(N),g(!0),E(N)},onFocus:()=>g(!0),className:"pl-10 pr-10 h-10 text-sm border border-border/50 rounded-lg shadow-sm bg-card"}),n&&d.jsx("button",{onClick:S=>{S.stopPropagation(),s(""),c([]),b(null),g(!1)},className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 z-10",children:d.jsx(gi,{className:"w-4 h-4"})})]}),m&&(n.length>=2||u||i.length>0)&&d.jsx("div",{className:"relative",children:d.jsx("div",{className:"absolute top-2 left-0 right-0 z-50 w-full max-w-full border border-border/50 rounded-lg shadow-lg bg-card",children:d.jsx("div",{className:"max-h-[300px] overflow-y-auto",children:u?d.jsxs("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 flex items-center gap-2",children:[d.jsx("div",{className:"w-4 h-4 border-2 border-gray-300 border-t-gray-600 rounded-full animate-spin"}),"Searching..."]}):x&&i.length===0?d.jsx("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:x}):i.length>0?i.map(S=>d.jsxs("div",{className:"flex flex-col items-start p-3 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-800 border-b border-gray-100 dark:border-gray-700 last:border-b-0",onClick:()=>T(S),children:[d.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-gray-100",children:S.projectName}),d.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5",children:[S.phaseName,"  Client: ",S.clientName]})]},S.projectId.native)):n.trim()&&!u?d.jsxs("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:['No matters found for "',n,'"']}):d.jsx("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:"Type at least 2 characters to search clients and matters..."})})})})]})},bo="src/shared/hooks/useParticipantValidation.ts",Yq=0,_w=1,g1=2e3,v1=3e4;function Jq(r){const e=r.message.toLowerCase();return e.includes("client not found")||e.includes("404")||e.includes("not found")}function Xq(r){const e=r.message.toLowerCase();return e.includes("timed out")||e.includes("timeout")||e.includes("504")||e.includes("503")||e.includes("network")||e.includes("failed to fetch")}function Qq({emailParticipants:r,getClientDetailsForEmail:e,clientDataCache:t,isValidClientData:n,onClientDataValidated:s,refreshTrigger:i,onTransientError:c,onValidationComplete:u}){const p=Ur(),m=w.useRef(null),g=w.useRef(new Set),x=w.useCallback(async(N,R)=>{var U;if(R.aborted)return;const A=N.toLowerCase();if(g.current.has(A)){p.debug("Skipping duplicate in-flight validation",{sourceFile:bo,email:N});return}g.current.add(A);let j,P,M=!1;const B=e(N);try{if(await Promise.race([B,new Promise((ce,X)=>{j=setTimeout(()=>{M=!0,X(new Error(`Request timed out after ${v1}ms`))},v1),P=()=>{clearTimeout(j),X(new DOMException("Aborted","AbortError"))},R.addEventListener("abort",P,{once:!0})})]),R.aborted)return;const V=(U=t.current)==null?void 0:U[N],Y=V?n(V):!1;s(N,Y),p.debug("Participant validation result",{sourceFile:bo,email:N,hasValidData:Y})}catch(V){if(R.aborted)return;V instanceof Error?Jq(V)?(p.debug("Participant not found in system",{sourceFile:bo,email:N,error:V.message}),s(N,!1)):Xq(V)?(p.warn("Participant validation timed out or network error - marking as pending",{sourceFile:bo,email:N,error:V.message}),s(N,!1),c==null||c(N,V),M&&B.then(()=>{var X;if(R.aborted)return;const Y=(X=t.current)==null?void 0:X[N];(Y?n(Y):!1)&&(p.info("Request succeeded after timeout - updating validation",{sourceFile:bo,email:N}),console.log(` [Late Success] Data loaded after timeout for ${N}`),s(N,!0))}).catch(Y=>{R.aborted||p.debug("Request failed after timeout",{sourceFile:bo,email:N,error:Y instanceof Error?Y.message:String(Y)})})):(p.error("Participant validation failed with unexpected error",V,{sourceFile:bo,email:N}),s(N,!1)):(p.error("Participant validation failed with non-Error",new Error(String(V)),{sourceFile:bo,email:N}),s(N,!1))}finally{j!==void 0&&clearTimeout(j),P&&R.removeEventListener("abort",P),g.current.delete(A)}},[e,t,n,s,c,p]),b=w.useCallback(async(N,R)=>{await Promise.all(N.map(A=>x(A,R)))},[x]),E=(N,R)=>new Promise((A,j)=>{if(R.aborted)return j(new DOMException("Aborted","AbortError"));const P=()=>{clearTimeout(M),j(new DOMException("Aborted","AbortError"))},M=setTimeout(()=>{R.removeEventListener("abort",P),A()},N);R.addEventListener("abort",P,{once:!0})}),T=w.useMemo(()=>[...r].sort().join(","),[r]),S=w.useRef(Yq);w.useEffect(()=>{var M;if(r.length===0)return;(M=m.current)==null||M.abort();const N=new AbortController;m.current=N;const R=g.current,A=i>S.current,j=t.current;return A&&j&&(Object.keys(j).forEach(B=>{delete j[B]}),yT(p),$5(),R.clear(),p.debug("Cleared all cache tiers for refresh",{sourceFile:bo,refreshTrigger:i})),S.current=i,(async()=>{const{signal:B}=N;p.info("Validating all email participants (rate-limited)",{sourceFile:bo,participantCount:r.length,batchSize:_w,batchDelayMs:g1});const U=[];for(let V=0;V<r.length;V+=_w)U.push(r.slice(V,V+_w));for(let V=0;V<U.length;V++){if(B.aborted){p.debug("Validation aborted",{sourceFile:bo});return}const Y=U[V];if(p.debug("Processing validation batch",{sourceFile:bo,batchIndex:V+1,totalBatches:U.length,batchEmails:Y}),await b(Y,B),V<U.length-1&&!B.aborted)try{await E(g1,B)}catch(ce){if(ce instanceof DOMException&&ce.name==="AbortError"){p.debug("Validation delay aborted",{sourceFile:bo});return}throw ce}}p.info("Completed validating all participants",{sourceFile:bo,participantCount:r.length}),u==null||u()})(),()=>{N.abort(),R.clear()}},[T,b,p,i,t,u])}const oF=w.createContext(void 0),Zq=({children:r})=>{const[e,t]=w.useState(0),[n,s]=w.useState(!1),i=w.useRef(null),[c,u]=w.useState(!0),p=w.useRef(new Map),m=Hl(),g=async R=>{try{return await m.getLocalItem(`elapsedTime_${R}`)??0}catch(A){return console.warn("Failed to read from storage, using in-memory storage:",A),p.current.get(R)??0}},x=async(R,A)=>{try{await m.setLocalItem(`elapsedTime_${R}`,A)}catch(j){console.warn("Failed to write to storage, using in-memory storage:",j),p.current.set(R,A)}},b=()=>{i.current!==null&&(window.clearInterval(i.current),i.current=null)},E=async R=>{!n&&c&&(s(!0),b(),g(R).then(A=>{t(A)}),i.current=window.setInterval(()=>{t(A=>{const j=A+1;return x(R,j),j})},1e3))},T=async R=>{if(n){s(!1),b();const A=await g(R);x(R,A)}},S=R=>{x(R,0),t(0)},N=async R=>await g(R);return w.useEffect(()=>()=>{b()},[]),d.jsx(oF.Provider,{value:{elapsedTime:e,isTimerRunning:n,startTimer:E,stopTimer:T,resetTimer:S,getElapsedTimeForThread:N,setShouldStartTimer:u,setElapsedTime:t},children:r})},iF=()=>{const r=w.useContext(oF);if(!r)throw new Error("useTimer must be used within a TimerProvider");return r},Ew=r=>{const e=Math.floor(r/3600),t=Math.floor(r%3600/60),n=r%60,s=i=>String(i).padStart(2,"0");return`${s(e)}:${s(t)}:${s(n)}`},eK=({userData:r,clientEmail:e,fileToMatterChecked:t,casesForCurrentClient:n,selectedCase:s,onSave:i,onCancel:c})=>{const u=Ur(),p=id(),{platform:m}=ln(),{elapsedTime:g,stopTimer:x,resetTimer:b}=iF(),[E,T]=w.useState(new Date().toISOString().slice(0,10)),[S,N]=w.useState(Ew(g)),[R,A]=w.useState(""),[j,P]=w.useState(s||n[0]||{}),M=t,[B,U]=w.useState((r==null?void 0:r.rate)||null),[V,Y]=w.useState(!1),[ce,X]=w.useState("Failed to save time entry. Please try again."),[de,we]=w.useState(!1),[le,se]=w.useState(!1),[me,te]=w.useState(!1),[G,z]=w.useState(!1),J=lr.useRef(null),[D,$]=w.useState(!1),ne=async()=>{if(te(!0),!(j!=null&&j.id)){te(!1),z(!0),X("Please select a matter to file the time entry.");return}const q=/^(\d{1,2}):([0-5]\d):([0-5]\d)$/,ie=S.trim().match(q);if(!ie){te(!1),z(!0),X("Please enter a valid duration in HH:MM:SS format.");return}const[,xe,ye,ue]=ie,ke=Number(xe)*3600+Number(ye)*60+Number(ue);if(!E||!/^\d{4}-\d{2}-\d{2}$/.test(E)||Number.isNaN(Date.parse(E))){te(!1),z(!0),X("Please select a valid date (YYYY-MM-DD).");return}if(!J.current){te(!1),z(!0),X("Unable to retrieve email thread information.");return}m==="chrome"&&AT(J.current,u).then(async Ue=>{if(Ue.length!=0)try{const Le=Ue[Ue.length-1],Ne=Le.to.concat(Le.cc),gt=Le.from,zt=Le.subject||"",yt=Le.body||"",Zt=Le.date||"",Bt=Ne,or=R.trim().replace(/[<>]/g,"").substring(0,5e3),st=await ny(e,"clio",E,ke,or,j==null?void 0:j.id,M,zt,yt,Zt,gt,Bt,de,le,B,u);u.info("Time entry successfully written to server",{sourceFile:"TimeEntryModal.tsx",message:st}),X("New email log and time entry created successfully."),te(!1),z(!1),J.current&&(await x(J.current),b(J.current)),i()}catch(Le){u.error("Error writing time entry to server",{error:Le},{sourceFile:"TimeEntryModal.tsx"}),te(!1),z(!0),X("Something went wrong. Please try again.")}}).catch(Ue=>{u.error("Error fetching email details from server",{error:Ue},{sourceFile:"TimeEntryModal.tsx"}),te(!1),z(!0),X("Something went wrong. Please try again.")}),m==="outlook"&&p.getCurrentThread().then(async Ue=>{if(Ue===null){te(!1),z(!0),X("Unable to retrieve email details. Please try again.");return}const Le=Ue.messages[Ue.messages.length-1].from,Ne=Ue.subject||"",gt=Ue.messages[Ue.messages.length-1].body||"",zt=Ue.messages[Ue.messages.length-1].timestamp||"",yt=Ue.participants.filter((or=>or!==Le)),Zt=R.trim().replace(/[<>]/g,"").substring(0,5e3),Bt=await ny(e,"clio",E,ke,Zt,j==null?void 0:j.id,M,Ne,gt,zt,Le,yt,de,le,B,u);u.info("Time entry successfully written to server",{sourceFile:"InsightsTimer.tsx",message:Bt}),X("New email log and time entry created successfully."),te(!1),z(!1),J.current&&(await x(J.current),b(J.current)),i()}).catch(Ue=>{u.error("Error writing time entry to server",{error:Ue},{sourceFile:"TimeEntryModal.tsx"}),te(!1),z(!0),X("Something went wrong. Please try again.")})},_e=q=>{let ie="";const xe=(q==null?void 0:q.messages)||[];let ye=xe;return xe.length>3&&(ye=xe.slice(-3)),ye.forEach((ue,ke)=>{ie+=`Email ${ke} Subject: ${ue.subject||""}
Email ${ke} Body: ${ue.body||""}

`}),ie};return w.useEffect(()=>{const q=async()=>{p==null||p.getCurrentThread().then(xe=>{$(!0);const ye=(xe==null?void 0:xe.threadId)||null;if(!ye){$(!1);return}if(m==="outlook"){const ue=_e(xe);SC(ye,ue,u).then((ke=>{A(ke.description),$(!1)})).catch(ke=>{u.error("Error generating email description summary",ke,{sourceFile:"TimeEntryModal.tsx"}),$(!1)})}m==="chrome"&&SC(ye,null,u).then(ue=>{A(ue.description),$(!1)}).catch(ue=>{u.error("Error generating email description summary",ue,{sourceFile:"TimeEntryModal.tsx"}),$(!1)})})},ie=()=>{p==null||p.getCurrentThread().then(xe=>{J.current=(xe==null?void 0:xe.threadId)||null})};q(),ie()},[M,p,u]),w.useEffect(()=>{var q,ie,xe,ye;(ye=(xe=(ie=(q=j==null?void 0:j.raw_data)==null?void 0:q.custom_rate)==null?void 0:ie.rates)==null?void 0:xe[0])!=null&&ye.rate?U(j.raw_data.custom_rate.rates[0].rate):U((r==null?void 0:r.rate)||0)},[j,r]),d.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 dark:bg-opacity-70 z-50 p-4 overflow-y-auto",onClick:c,children:d.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-lg w-full max-w-lg p-6 my-auto max-h-[90vh] overflow-y-auto",onClick:q=>q.stopPropagation(),children:[d.jsxs("div",{className:"flex justify-between items-center mb-4",children:[d.jsxs("h2",{className:"text-lg font-semibold text-blue-600 dark:text-blue-400",children:["Review Time Entry"," "]}),d.jsx("button",{className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",onClick:c,children:d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),G&&d.jsx("div",{role:"alert","aria-live":"assertive",className:"mb-4",children:d.jsxs("div",{className:"flex items-start bg-red-50 dark:bg-red-950/30 border border-red-200 dark:border-red-800 text-red-900 dark:text-red-100 rounded-md p-3",children:[d.jsx("svg",{className:"w-5 h-5 flex-shrink-0",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:d.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.72-1.36 3.485 0l6.518 11.588c.75 1.334-.213 2.995-1.742 2.995H3.481c-1.529 0-2.492-1.661-1.742-2.995L8.257 3.1zM10 8a1 1 0 10-0 2 1 1 0 000-2zm0 4a1 1 0 01-.993-.883L9 11V9a1 1 0 012 0v2a1 1 0 01-.883.993L10 12z",clipRule:"evenodd"})}),d.jsxs("div",{className:"ml-3 flex-1",children:[d.jsx("p",{className:"font-medium",children:"Error"}),d.jsx("p",{className:"mt-1 text-sm",children:ce})]})]})}),d.jsx("p",{className:"mb-4",children:"Review and edit details before saving."}),d.jsxs("div",{className:"flex gap-4 mb-4 w-full",children:[d.jsxs("div",{className:"shrink-0",children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Date"}),d.jsx("input",{type:"date",value:E,onChange:q=>T(q.target.value),className:"mt-1 block border border-gray-300 dark:border-gray-600 text-gray-600 dark:text-gray-300 bg-white dark:bg-gray-800 rounded-md shadow-sm px-3 py-2 text-sm focus:ring-blue-500 focus:border-blue-500 h-[38px]"})]}),d.jsxs("div",{className:"shrink-0",children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Duration"}),d.jsx("input",{type:"text",value:S,onChange:q=>{const ie=q.target.value,xe=/^(\d{0,2})(:\d{0,2}){0,2}$/;ie.length<=8&&/^[0-9:]*$/.test(ie)&&xe.test(ie)&&N(ie)},onBlur:q=>{const ie=q.target.value.trim(),xe=/^(\d{1,2}):([0-5]\d):([0-5]\d)$/;if(xe.test(ie)){const[,ye,ue,ke]=ie.match(xe),He=Number(ye)*3600+Number(ue)*60+Number(ke);N(Ew(He))}else N(Ew(g))},className:"mt-1 block border border-gray-300 dark:border-gray-600 text-gray-600 dark:text-gray-300 bg-white dark:bg-gray-800 rounded-md shadow-sm px-3 py-2 text-sm focus:ring-blue-500 focus:border-blue-500 h-[38px]",style:{width:"10ch"},"aria-label":"Duration (HH:MM:SS)"})]})]}),d.jsxs("div",{className:"mb-4",children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Description"}),d.jsx("textarea",{disabled:D,value:D?"Generating AI description...":R,onChange:q=>A(q.target.value),className:"mt-1 block w-full border border-gray-300 dark:border-gray-600 text-gray-600 dark:text-gray-300 bg-white dark:bg-gray-800 rounded-md shadow-sm px-3 py-2 text-sm focus:ring-blue-500 focus:border-blue-500",rows:3})]}),d.jsx("div",{className:"bg-gray-50 dark:bg-gray-800/50 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm p-4",children:d.jsxs("div",{className:"flex justify-between items-center mb-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-900 dark:text-gray-100",children:"Billed By"}),d.jsx("p",{className:"mt-1 text-sm font-medium text-gray-900 dark:text-gray-100",children:"Rate"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm text-gray-700 dark:text-gray-300 text-right",children:(r==null?void 0:r.name)||"Unknown"}),d.jsxs("div",{className:"flex items-center justify-end gap-2",children:[d.jsx("input",{value:B??0,onChange:q=>U(Number(q.target.value)||0),onBlur:()=>Y(!1),className:V?"mt-1 text-sm text-right text-gray-700 dark:text-gray-300 border border-gray-200 dark:border-gray-600 rounded bg-white dark:bg-gray-800 inline-block":"mt-1 text-sm text-right text-gray-700 dark:text-gray-300 border border-transparent rounded bg-transparent inline-block","aria-label":"Rate",disabled:!V,style:{width:`${Math.max(String(B??0).length,1)+1}ch`}}),d.jsx("button",{type:"button",className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300","aria-label":"Edit rate",onClick:()=>Y(!V),children:d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536M4 20h4.586a1 1 0 00.707-.293l9.414-9.414a1 1 0 000-1.414L15.121 4.88a1 1 0 00-1.414 0L4 14.586V20z"})})})]})]})]})}),d.jsxs("div",{className:"mb-4 mt-5",children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Matter"}),d.jsxs(Ls,{children:[d.jsx(Ms,{asChild:!0,children:d.jsxs($e,{variant:"ghost",size:"sm",className:"mt-1 h-[38px] text-sm text-gray-600 dark:text-gray-300 flex items-center gap-1 px-3 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm w-full justify-between",children:[d.jsx("span",{className:"truncate",title:String((j==null?void 0:j.description)||"Select a matter"),children:String((j==null?void 0:j.description)||"Select a matter")}),d.jsx(ys,{className:"w-4 h-4 ml-1 flex-shrink-0"})]})}),d.jsx(ws,{align:"start",className:"w-full max-h-[200px] overflow-y-auto",style:{width:"var(--radix-dropdown-menu-trigger-width)"},children:n.map((q,ie)=>d.jsx(os,{className:"text-sm truncate max-w-full",onClick:()=>P(q),title:String((q==null?void 0:q.description)||`Case ${ie+1}`),children:String((q==null?void 0:q.description)||`Case ${ie+1}`)},ie))})]})]}),d.jsxs("div",{className:"mb-4 bg-blue-50 dark:bg-blue-950/30 p-3 rounded-md",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx("input",{type:"checkbox",id:"fileToMatter",checked:de,onChange:q=>we(q.target.checked),className:"cursor-pointer"}),d.jsx("label",{htmlFor:"fileToMatter",className:"ml-2 text-sm font-medium text-blue-600 dark:text-blue-400",children:"Non-billable"})]}),de&&d.jsxs("div",{className:"flex items-center",children:[d.jsx("input",{type:"checkbox",id:"billEntry",checked:le,onChange:q=>se(q.target.checked),className:"cursor-pointer"}),d.jsx("label",{htmlFor:"billEntry",className:"ml-2 text-sm font-medium text-blue-600 dark:text-blue-400",children:"Show this entry on the bill"})]})]}),d.jsxs("div",{className:"flex flex-col gap-3",children:[d.jsx($e,{className:"w-full p-2",disabled:me,onClick:ne,children:me?"Saving...":"Save Time Entry"}),d.jsx("button",{className:"w-full p-2 bg-transparent text-white hover:cursor-pointer hover:bg-transparent shadow-none border-none",disabled:me,onClick:c,children:"Cancel"})]})]})})},tK=r=>{const e=Math.floor(r/3600),t=Math.floor(r%3600/60),n=r%60,s=i=>String(i).padStart(2,"0");return`${s(e)}:${s(t)}:${s(n)}`},rK=({userData:r,clientEmail:e,emailParticipantClients:t,currentCaseIndex:n,casesForCurrentClient:s})=>{const i=Ur(),{elapsedTime:c,isTimerRunning:u,startTimer:p,stopTimer:m,resetTimer:g,setShouldStartTimer:x,setElapsedTime:b}=iF(),E=id(),{platform:T}=ln(),[S,N]=w.useState(s[0]||null),[R,A]=w.useState(!0),[j,P]=w.useState(!1),[M,B]=w.useState(!1),U=lr.useRef(null),[V,Y]=w.useState(s||null),ce=new Date().toISOString().slice(0,10),X="",[de,we]=w.useState("Failed to save time entry. Please try again."),[le,se]=w.useState(!1),[me,te]=w.useState(!1),G=async()=>{if(se(!0),!ce||!/^\d{4}-\d{2}-\d{2}$/.test(ce)||Number.isNaN(Date.parse(ce))){se(!1),te(!0),we("Please select a valid date (YYYY-MM-DD).");return}if(U.current===null){se(!1),te(!0),we("Unable to retrieve email details. Please try again.");return}T==="chrome"&&AT(U.current,i).then(async $=>{if($.length<1){se(!1),te(!0),we("Unable to retrieve email details. Please try again.");return}try{const ne=$[$.length-1],_e=ne.to.concat(ne.cc),q=ne.from,ie=ne.subject||"",xe=ne.body||"",ye=ne.date||"",ue=_e,ke=X.trim().replace(/[<>]/g,"").substring(0,5e3),He=await ny(e,"clio",ce,c,ke,S==null?void 0:S.id,R,ie,xe,ye,q,ue,null,null,null,i);i.info("Time entry successfully written to server",{sourceFile:"InsightsTimer.tsx",message:He}),we("New email log created successfully."),se(!1),te(!1),B(!0),U.current&&(await m(U.current),g(U.current))}catch(ne){i.error("Error writing time entry to server",ne,{sourceFile:"InsightsTimer.tsx"}),se(!1),te(!0),we("Something went wrong. Please try again.")}}).catch($=>{i.error("Error fetching email details from server",$,{sourceFile:"InsightsTimer.tsx"}),se(!1),te(!0),we("Something went wrong. Please try again.")}),T==="outlook"&&E.getCurrentThread().then(async $=>{if($===null||!$.messages||$.messages.length===0){se(!1),te(!0),we("Unable to retrieve email details. Please try again.");return}const ne=$.messages[$.messages.length-1].from,_e=$.subject||"",q=$.messages[$.messages.length-1].body||"",ie=$.messages[$.messages.length-1].timestamp||"",xe=$.participants.filter((ke=>ke!==ne)),ye=X.trim().replace(/[<>]/g,"").substring(0,5e3),ue=await ny(e,"clio",ce,c,ye,S==null?void 0:S.id,R,_e,q,ie,ne,xe,null,null,null,i);i.info("Time entry successfully written to server",{sourceFile:"InsightsTimer.tsx",message:ue}),we("New email log created successfully."),se(!1),te(!1),B(!0),U.current&&(await m(U.current),g(U.current))}).catch($=>{se(!1),te(!0),we("Something went wrong. Please try again."),i.error("Error getting current thread",$,{sourceFile:"InsightsTimer.tsx"})})},z=async()=>{P(!1),B(!0),te(!1),we("Successfully wrote email log and time entry"),U.current&&(await m(U.current),g(U.current))},J=async()=>{P(!1),x(!0),U.current&&await m(U.current)};return w.useEffect(()=>{if(!u)return;(()=>{E==null||E.getCurrentThread().then($=>{U.current=($==null?void 0:$.threadId)||null})})()},[u,E]),w.useEffect(()=>{Y(s),N(s[n]||null),B(!1),P(!1)},[n,s,r]),w.useEffect(()=>{let D=!0;const $=async ye=>{if(!D)return;const ue=(ye==null?void 0:ye.threadId)||null;if(!ue){U.current&&document.visibilityState==="visible"&&(await m(U.current),b(0),i.info("Thread cleared - stopping timer",{sourceFile:"InsightsTimer.tsx"})),U.current=null;return}ue!==U.current&&(i.info("Thread changed - starting timer",{sourceFile:"InsightsTimer.tsx",oldThreadId:U.current,newThreadId:ue}),U.current&&await m(U.current),U.current=ue,x(!0),document.visibilityState==="visible"&&p(ue))};E&&(E.onThreadChanged($),E.getCurrentThread().then(ye=>{$(ye)}).catch(ye=>{i.error("Error getting initial thread",ye,{sourceFile:"InsightsTimer.tsx"})}));const ne=async()=>{U.current&&await m(U.current)},_e=async()=>{try{if(!E)return;const ye=await E.getCurrentThread(),ue=(ye==null?void 0:ye.threadId)||null;if(!ue||u&&U.current===ue)return;U.current=ue,p(ue)}catch(ye){i.error("Error starting timer on visibility/focus",ye,{sourceFile:"InsightsTimer.tsx"})}},q=()=>{document.visibilityState==="hidden"?ne():document.visibilityState==="visible"&&_e()},ie=()=>_e(),xe=()=>ne();return document.addEventListener("visibilitychange",q),window.addEventListener("focus",ie),window.addEventListener("blur",xe),document.visibilityState==="visible"&&_e(),()=>{D=!1,E&&E.removeThreadListener($),document.removeEventListener("visibilitychange",q),window.removeEventListener("focus",ie),window.removeEventListener("blur",xe)}},[E,p,m,x,i]),w.useEffect(()=>{if(M||me){const D=setTimeout(()=>{B(!1),te(!1)},5e3);return()=>clearTimeout(D)}},[M,me]),d.jsxs(d.Fragment,{children:[j&&d.jsx(eK,{userData:r,clientEmail:e,emailParticipantClients:t,fileToMatterChecked:R,casesForCurrentClient:V,selectedCase:S,onSave:z,onCancel:J}),d.jsxs("div",{className:"flex flex-col gap-3 p-2 border rounded-md bg-blue-50 dark:bg-gray-800 border-blue-500 dark:border-gray-600 shadow-sm",children:[d.jsx("h2",{className:"text-sm font-semibold text-gray-700 dark:text-gray-200",children:"File email log"}),d.jsxs("div",{className:"flex items-center gap-1.5 overflow-hidden",children:[d.jsxs("button",{type:"button",onClick:async()=>{U.current&&(u?(x(!1),await m(U.current)):(x(!0),p(U.current)))},className:"flex items-center justify-start gap-1.5 w-[110px] h-[34px] px-2 rounded-md bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors border border-gray-200 dark:border-gray-600 overflow-hidden flex-shrink-0",children:[d.jsx("div",{className:"w-4 h-4 flex items-center justify-center flex-shrink-0",children:u?d.jsx(vB,{className:"w-4 h-4 text-green-700 dark:text-green-400"}):d.jsx(xB,{className:"w-4 h-4 text-gray-700 dark:text-gray-300"})}),d.jsx("span",{className:`text-base font-semibold ${u?"text-green-700 dark:text-green-400":"text-gray-700 dark:text-gray-300"} whitespace-nowrap w-[70px] text-center flex-shrink-0`,children:tK(c)})]}),d.jsxs("label",{className:"flex items-center gap-1 text-xs text-gray-600 dark:text-gray-400 flex-shrink min-w-0",children:[d.jsx("input",{type:"checkbox",id:"fileToMatter",checked:R,onChange:D=>A(D.target.checked),className:"cursor-pointer flex-shrink-0"}),d.jsx("span",{className:"truncate",children:"Add time entry"})]}),d.jsx("div",{className:"min-w-0 flex-1",children:d.jsx($e,{disabled:le,onClick:async()=>{if(U.current){if(R){P(!0),x(!1),await m(U.current);return}se(!0),x(!1),await m(U.current),G()}},size:"sm",className:"h-8 text-xs px-1.5 w-full flex items-center justify-center",children:d.jsx("span",{className:"truncate",children:le?"Saving...":"Save"})})})]}),d.jsx("div",{className:"min-w-0",children:d.jsx("div",{className:"flex items-center gap-2 w-full min-w-0",children:d.jsxs(Ls,{children:[d.jsx(Ms,{asChild:!0,children:d.jsxs($e,{variant:"ghost",size:"sm",className:"h-8 text-xs text-gray-600 dark:text-gray-300 flex items-center gap-1 px-2 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md w-full justify-between min-w-0",children:[d.jsx("span",{className:"truncate",title:String((S==null?void 0:S.description)||"Select a matter"),style:{maxWidth:"24ch",display:"inline-block"},children:String((S==null?void 0:S.description)||"Select a matter")}),d.jsx(ys,{className:"w-3 h-3 ml-1"})]})}),d.jsx(ws,{align:"start",className:"w-full max-h-[200px] overflow-y-auto",style:{width:"100%"},children:V.map((D,$)=>d.jsx(os,{className:"text-xs truncate max-w-full",onClick:()=>N(D),title:String((D==null?void 0:D.description)||`Case ${$+1}`),children:String((D==null?void 0:D.description)||`Case ${$+1}`)},$))})]})})})]}),M&&d.jsx("div",{role:"success","aria-live":"assertive",className:"mt-3",children:d.jsx("div",{className:"flex items-start border rounded-md p-3 border-green-200 dark:border-green-700 text-green-900 dark:text-green-100 bg-green-50 dark:bg-green-900",children:d.jsx("div",{className:"ml-3 flex-1",children:d.jsx("p",{className:"mt-1 text-sm",children:de})})})}),me&&d.jsx("div",{role:"alert","aria-live":"assertive",className:"mt-3",children:d.jsx("div",{className:"flex items-start border rounded-md p-3 border-red-200 dark:border-red-700 text-red-900 dark:text-red-100 bg-red-50 dark:bg-red-900",children:d.jsx("div",{className:"ml-3 flex-1",children:d.jsx("p",{className:"mt-1 text-sm",children:de})})})})]})},Ht="src/sidepanel/panels/ClioInsights.tsx",nK=({clientEmail:r,setClientEmail:e,tempClientEmail:t,setTempClientEmail:n,emailParticipants:s,emailParticipantClients:i,currentClientIndex:c,setCurrentClientIndex:u,currentCaseIndex:p,casesForCurrentClient:m,setCasesForCurrentClient:g,isManuallySet:x,setIsManuallySet:b,isProjectManuallySelected:E,setIsProjectManuallySelected:T,isValidClient:S,isTempEmailValid:N,nextCase:R,prevCase:A,handleSetCurrentCaseIndex:j,ClientNavigation:P,onClientDataValidated:M,onTransientError:B,isValidating:U,refreshTrigger:V,integrationSettings:Y,hasTransientError:ce})=>{const X=Ur(),{platform:de}=ln(),we=Hl(),le=w.useRef(r);le.current=r;const se=pe=>pe!==le.current,[me]=w.useState(!0),[te,G]=w.useState({}),[z,J]=w.useState({}),[D,$]=w.useState({}),[ne,_e]=w.useState({}),[q,ie]=w.useState([]),[xe,ye]=w.useState(!1),[ue,ke]=w.useState(null),[He,Ue]=w.useState(null),[Le,Ne]=w.useState(!1),[gt,zt]=w.useState([]),[yt,Zt]=w.useState(!1),Bt=5,[or,st]=w.useState(1),[Ft,er]=w.useState(0),[Ae,Ze]=w.useState(!1),dt=w.useRef(new Map),rt=w.useRef(null),Lt=w.useRef(!1),gr=w.useRef(null),tr=w.useRef({}),lt=w.useCallback(pe=>{const Ye=typeof pe=="string"?parseFloat(pe):pe;return isNaN(Ye)?"$0.00":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Ye)},[]),kt=w.useCallback(pe=>{if(!pe||!pe.client_data||!Array.isArray(pe.client_data)||pe.client_data.length===0)return!1;const Ye=pe.client_data[0];return Ye&&typeof Ye=="object"&&Object.keys(Ye).length>0},[]),Nt=w.useCallback(pe=>{if(X.info("selectClientDetails called",{sourceFile:Ht,hasDetails:!!pe,detailsKeys:pe?Object.keys(pe):[]}),!pe){X.warn("selectClientDetails called with undefined details",{sourceFile:Ht}),J({}),$({}),G({}),_e({});return}X.info("Client details received for formatting",{sourceFile:Ht,clientDetails:pe});const Ye=Gt=>{const ot=Gt.replace(/\D/g,"");return ot.length===10?`(${ot.slice(0,3)}) ${ot.slice(3,6)}-${ot.slice(6)}`:Gt};let pt="";if(pe.primary_phone_number)pt=pe.primary_phone_number;else if(pe.phone_numbers)try{const Gt=JSON.parse(pe.phone_numbers);Array.isArray(Gt)&&Gt.length>0&&(pt=Gt[0].number||"")}catch{const Gt=pe.phone_numbers;Array.isArray(Gt)&&Gt.length>0&&(pt=Gt[0].number||"")}else pe.phones&&Array.isArray(pe.phones)&&(pt=pe.phones[0]||"");let Be="";if(pe.primary_email_address)Be=pe.primary_email_address;else if(pe.email_addresses)try{const Gt=JSON.parse(pe.email_addresses);Array.isArray(Gt)&&Gt.length>0&&(Be=Gt[0].address||"")}catch{const Gt=pe.email_addresses;Array.isArray(Gt)&&Gt.length>0&&(Be=Gt[0].address||"")}else pe.emails&&Array.isArray(pe.emails)&&(Be=pe.emails[0]||"");let qt="";try{let Gt=[];pe.addresses&&(typeof pe.addresses=="string"?Gt=JSON.parse(pe.addresses):Gt=pe.addresses);const ot=Gt[0];ot&&(qt=`${ot.street?`${ot.street}, `:""}${ot.city?`${ot.city}, `:""}${ot.province?`${ot.province}, `:""}${ot.country?`${ot.country} `:""}${ot.postal_code?`${ot.postal_code}`:""}`.trim())}catch{X.warn("Error formatting address",{sourceFile:Ht})}const dr={Name:pe.name||"",Email:Be||"",Phone:Ye(pt),Address:qt||""};X.info("Client details formatted and set",{sourceFile:Ht,selectedDetails:dr,originalDetails:pe}),J(pe),$(dr)},[X,lt]),ze=w.useCallback(pe=>{X.info("selectCaseDetails called",{sourceFile:Ht,hasDetails:!!pe,detailsKeys:pe?Object.keys(pe):[]}),X.info("Case details received for formatting",{sourceFile:Ht,caseNames:pe});const Ye={"Matter Number":pe.name||"",Title:pe.description||"","Maildrop Address":pe.maildrop_address||"","Practice Area":pe.practice_area||"",Status:pe.status||"",Stage:pe.matter_stage||"","Assigned To":pe.responsible_attorney||"","Rate Type":pe.custom_rate||"","Outstanding Balance":lt(pe.outstanding_balance||pe.balance_outstanding||pe.balance||0)};X.info("Case details formatted and set",{sourceFile:Ht,selectedDetails:Ye,originalDetails:pe}),_e(Ye)},[X,lt]),vr=w.useCallback(async pe=>{X.info("Matter manually selected",{sourceFile:Ht,matterId:pe.id,matterName:pe.description}),e(""),b(!0),T(!0);try{const Ye=await l8("clio",pe.id,X);if(Ye&&Object.keys(Ye).length>0){const pt=Ye.case_data||Ye,Be=Ye.client_data||{};X.info("Complete matter data fetched successfully",{sourceFile:Ht,matterId:pe.id,hasCalendarEntries:!!pt.calendar_entries,hasLastCompletedTask:!!pt.last_completed_task,hasNextUpcomingTask:!!pt.next_upcoming_task,hasClientData:!!Be&&Object.keys(Be).length>0});const qt={};if(Object.entries(pt).forEach(([ot,yr])=>{qt[ot]=String(yr??"")}),G(qt),ze(qt),Be&&Object.keys(Be).length>0){Nt(Be);let ot="";if(Be.primary_email_address)ot=String(Be.primary_email_address);else if(Be.email_addresses)try{const yr=JSON.parse(String(Be.email_addresses));Array.isArray(yr)&&yr.length>0&&(ot=yr[0].address||"")}catch{const yr=Be.email_addresses;Array.isArray(yr)&&yr.length>0&&(ot=yr[0].address||"")}else Be.emails&&Array.isArray(Be.emails)&&(ot=String(Be.emails[0]||""));ot&&n(ot)}const dr=String(pt.id||pe.id||""),Gt=(pt.calendar_entries||[]).map(ot=>({...ot,case_id:dr}));ie(Gt),g([pt]),j(0)}else{X.warn("Failed to fetch complete matter data, using basic data",{sourceFile:Ht,matterId:pe.id});const pt={};Object.entries(pe).forEach(([Be,qt])=>{pt[Be]=String(qt??"")}),G(pt),ze(pt),ie([]),g([pe]),j(0)}}catch(Ye){X.error("Error fetching complete matter data",Ye,{sourceFile:Ht,matterId:pe.id});const pt={};Object.entries(pe).forEach(([Be,qt])=>{pt[Be]=String(qt??"")}),G(pt),ze(pt),ie([]),g([pe]),j(0)}},[X,e,n,b,T,g,j,ze,Nt,ie]),zr=w.useCallback(async pe=>{var pt;if(tr.current[pe]){const Be=tr.current[pe];if("pagination"in Be&&Be.pagination!=null){console.log(` [Cache L1] Component cache HIT for ${pe}`),X.debug("Using cached client data (component cache)",{sourceFile:Ht,email:pe});return}console.log(` [Cache L1] Stale pre-pagination data for ${pe}, refetching`),delete tr.current[pe]}console.log(` [Cache L2] Checking browser storage for ${pe}...`);const Ye=await vT(pe,X);if(Ye){if("pagination"in Ye&&Ye.pagination!=null){console.log(` [Cache L2] Browser storage HIT - SALVAGED data for ${pe}`),X.debug("Using cached client data (browser storage - salvaged)",{sourceFile:Ht,email:pe}),tr.current[pe]=Ye;return}console.log(` [Cache L2] Stale pre-pagination data for ${pe}, clearing and refetching`),await Bv(pe,X)}console.log(` [Cache L2] Browser storage MISS for ${pe}`);try{console.log(` [Cache L3] Fetching from SERVER for ${pe}...`),X.debug("Fetching client data from server",{sourceFile:Ht,email:pe});const Be=await Gy("clio",pe,X,!1,{limit:Bt});if(tr.current[pe]=Be,Be.pagination){if(er(Be.pagination.total_matters),Be.pagination.next_cursor)try{const qt=JSON.parse(atob(Be.pagination.next_cursor));rt.current={contactId:qt.contact_id}}catch{rt.current=null}}else er(((pt=Be.case_data)==null?void 0:pt.length)??0);dt.current.clear(),dt.current.set(1,Be.case_data||[]),st(1)}catch(Be){throw Be instanceof Error&&Be.message.includes("Client not found")?X.debug("Client not found for email",{sourceFile:Ht,email:pe}):X.error(`Error fetching client data for ${pe}`,Be,{sourceFile:Ht}),Be}},[X]),Or=w.useCallback(async()=>{X.info("fetchUserData called",{sourceFile:Ht,clientEmail:r});try{const pe=await c8(X,"clio");Ue(pe)}catch(pe){X.error("Error processing user data",pe,{sourceFile:Ht})}},[]),sn=w.useCallback(async()=>{var pe;if(X.info("fetchClientData called",{sourceFile:Ht,clientEmail:r,hasClientEmail:!!r}),!r){X.info("fetchClientData early return",{sourceFile:Ht,reason:r?"clio not connected":"no client email",clientEmail:r});return}dt.current.clear(),rt.current=null,Lt.current=!1,gr.current=null,Ze(!1),st(1),er(0),j(0);try{if(ye(!0),ke(null),X.info("fetchClientData starting data fetch",{sourceFile:Ht,clientEmail:r,isLoading:!0}),!tr.current[r])try{if(await zr(r),se(r))return}catch(ot){ot instanceof Error&&ot.message.includes("(cached)")?X.debug("Using cached knowledge that this client doesn't exist",{sourceFile:Ht,clientEmail:r}):ot instanceof Error&&ot.message.includes("Client not found")?X.debug("Client not found",{sourceFile:Ht,clientEmail:r}):(X.error("Error fetching client data",ot,{sourceFile:Ht}),ke("both")),G({}),g([]),ie([]),$({}),_e({}),J({}),ye(!1);return}const Ye=tr.current[r];if(Ye!=null&&Ye.pagination){if(er(Ye.pagination.total_matters),Ye.pagination.next_cursor&&!rt.current)try{const ot=JSON.parse(atob(Ye.pagination.next_cursor));rt.current={contactId:ot.contact_id}}catch{rt.current=null}dt.current.set(1,Ye.case_data||[])}else er(((pe=Ye==null?void 0:Ye.case_data)==null?void 0:pe.length)??0),rt.current=null;if(!Ye){G({}),g([]),ie([]),$({}),_e({}),J({}),ye(!1),M(r,!1);return}const pt=kt(Ye);if(M(r,pt),!pt){X.debug("Client data exists but is not valid",{sourceFile:Ht,clientEmail:r}),G({}),g([]),ie([]),$({}),_e({}),J({}),ye(!1);return}if(se(r))return;const Be=Ye.client_data[0];X.debug("Client data received",{sourceFile:Ht,clientDataAsRecord:Be}),Nt(Be);const qt=Ye.case_data||[];g(qt),j(0);const dr=qt.flatMap(ot=>{const yr=String(ot.id||"");return(ot.calendar_entries||[]).map($n=>({...$n,case_id:yr}))});ie(dr);const Gt=qt.length>0?Object.entries(qt[0]).reduce((ot,[yr,un])=>(ot[yr]=String(un),ot),{}):{};G(Gt),ze(Gt)}catch(Ye){X.error("Error processing client data",Ye,{sourceFile:Ht}),ke("both"),G({}),g([]),ie([]),r&&M(r,!1)}finally{ye(!1)}},[r,zr,X,Nt,ze,g,M,kt,j]),mn=w.useCallback(async pe=>{var yr;if(pe===or||pe===gr.current||pe<1||!r)return;const Ye=Math.ceil(Ft/Bt);if(pe>Ye)return;const pt=dt.current.get(pe);if(pt){g(pt),st(pe),j(0);return}const Be=rt.current;if(!Be)return;const qt=(pe-1)*Bt,dr=btoa(JSON.stringify({contact_id:Be.contactId,offset:qt,total_matters:Ft})),Gt=or;gr.current=pe,st(pe),Ze(!0);let ot=!1;try{const un=await n8("clio",r,dr,X,Bt);if(se(r)){ot=!0;return}const $n=un.case_data||[];dt.current.set(pe,$n),g($n),j(0),(yr=un.pagination)!=null&&yr.total_matters&&er(un.pagination.total_matters)}catch(un){if(se(r)){ot=!0;return}st(Gt);const $n=un instanceof Error&&un.message.includes("Invalid pagination cursor");if($n&&!Lt.current){X.warn("Stale cursor detected, force-refreshing from page 1",{sourceFile:Ht,targetPage:pe}),dt.current.clear(),rt.current=null,r&&(delete tr.current[r],await Bv(r,X)),Lt.current=!0;try{await sn()}catch(ko){X.error("Recovery fetch failed",ko,{sourceFile:Ht}),ke("matter")}finally{Lt.current=!1}}else $n?ke("matter"):X.error("Failed to navigate to page",un,{sourceFile:Ht,targetPage:pe})}finally{gr.current=null,ot||Ze(!1)}},[or,r,Ft,X,g,j,sn]);w.useEffect(()=>{const pe=async()=>{if(!await wT(X))try{const Be=(await IT("clio",X)).map(({id:qt,name:dr})=>({id:qt,name:dr}));await xT(Be,X)}catch(pt){X.error("Error fetching firm users",pt,{sourceFile:Ht})}};Or(),pe()},[]),w.useEffect(()=>{(async()=>{var Ye,pt,Be,qt;if(Y&&Y.clio){const dr=((pt=(Ye=Y==null?void 0:Y.clio)==null?void 0:Ye.timeTracking)==null?void 0:pt.enabled)||!1;Ne(dr);return}try{const dr=await we.getLocalItem("integrationSettings");if(dr&&dr.clio){const Gt=((qt=(Be=dr==null?void 0:dr.clio)==null?void 0:Be.timeTracking)==null?void 0:qt.enabled)||!1;Ne(Gt)}else Ne(!1)}catch(dr){X.error("Failed to fetch integration settings from storage",dr,{sourceFile:Ht}),Ne(!1)}})()},[Y]),w.useEffect(()=>{V>0&&(X.info("Clearing component cache due to refresh trigger",{sourceFile:Ht,refreshTrigger:V}),tr.current={},(async()=>(await Promise.all(s.map(Ye=>Bv(Ye,X))),Zt(!1),r&&(X.info("Re-fetching client data after cache clear",{sourceFile:Ht,clientEmail:r}),sn())))())},[V]),w.useEffect(()=>{Zt(!1),s.length===0&&zt([])},[s]);const cn=w.useCallback(()=>{X.info("All participant validations complete",{sourceFile:Ht,participantCount:s.length}),Zt(!0)},[X,s.length]);Qq({emailParticipants:s,getClientDetailsForEmail:zr,clientDataCache:tr,isValidClientData:kt,onClientDataValidated:M,refreshTrigger:V,onTransientError:B,onValidationComplete:cn}),w.useEffect(()=>{X.info("useEffect: client email or connection changed",{sourceFile:Ht,clientEmail:r,willFetchData:!!r}),r&&(X.info("Triggering fetchClientData from useEffect",{sourceFile:Ht,clientEmail:r}),sn(),n(r),x&&!s.includes(r.toLowerCase())&&X.debug("Manually set email not in participants, validating separately",{sourceFile:Ht,clientEmail:r}))},[r,sn,n,x,s,X]),w.useEffect(()=>{(!r||s.length===0&&!x)&&(n(null),$({}),_e({}),ie([]))},[r,s.length,x,n,$,_e]),w.useEffect(()=>{if(X.info("useEffect: case index changed",{sourceFile:Ht,currentCaseIndex:p,casesCount:m.length,willUpdateCaseDetails:m.length>0&&p<m.length}),m.length>0&&p<m.length){const pe=m[p];X.info("Updating case details for index",{sourceFile:Ht,currentCaseIndex:p,caseData:pe?Object.keys(pe):null});const Ye=pe?Object.entries(pe).reduce((pt,[Be,qt])=>(pt[Be]=String(qt),pt),{}):{};G(Ye),ze(Ye),X.info("Case details updated",{sourceFile:Ht,formattedCaseData:Ye})}},[p,m,ze,X]);const _n=w.useCallback(pe=>{X.info("Contacts created, storing for matter linking",{sourceFile:Ht,contactCount:pe.length}),zt(pe)},[X]),as=w.useCallback(pe=>{X.info("Contact linked to matter successfully",{sourceFile:Ht})},[X]),An=w.useCallback(async pe=>{var pt,Be;ye(!0);const Ye={id:((Be=(pt=pe.projectId)==null?void 0:pt.native)==null?void 0:Be.toString())||"",description:pe.projectName||"",practice_area:pe.projectTypeName||"",matter_stage:pe.phaseName||"",status:pe.isArchived?"Closed":"Open",client_name:pe.clientName||"",responsible_attorney:pe.firstPrimaryName||"",url:pe.projectUrl||"",name:pe.projectName||""};await vr(Ye).then(()=>{ye(!1)})},[vr]),wi=w.useCallback(pe=>{const Ye=tr.current[pe]?tr.current[pe]:tr.current[pe.toLowerCase()];if(Ye!=null&&Ye.client_data&&Array.isArray(Ye.client_data)&&Ye.client_data.length>0){const pt=Ye.client_data[0];return String(pt.name||"")}return null},[]),bi=(ue==="client"||ue==="both")&&!xe,Dr=(ue==="matter"||ue==="both")&&!xe;return me?d.jsxs("div",{className:"relative h-full",children:[d.jsxs("div",{className:"space-y-4 overflow-y-auto h-full mt-0 pb-32",children:[d.jsx(Kq,{onMatterSelected:An}),d.jsx(Vq,{clientEmail:r,emailParticipants:s,emailParticipantClients:i,currentClientIndex:c,setCurrentClientIndex:u,setClientEmail:e,isManuallySet:x,selectedClientDetails:D,linkableFields:[{field:"Name",url:z.url||""}].filter(pe=>pe.url),isLoading:xe,ClientNavigation:P,handleSectionClick:()=>{},tempClientEmail:t||"",setTempClientEmail:n,setIsManuallySet:b,isValidClient:S||!1,isTempEmailValid:N||!1,showClientDocumentsButton:!1,isValidating:U,fetchError:bi,hasTransientError:ce,onContactsCreated:_n,getClientNameFromCache:wi,isClientDataValidationComplete:yt}),d.jsx(qq,{clientEmail:r,selectedCaseDetails:ne,casesForCurrentClient:m,currentCaseIndex:p,linkableFields:[{field:"Title",url:te.url||""}].filter(pe=>pe.url),nextCase:R,prevCase:A,isLoading:xe,isManuallySet:x,setCurrentCaseIndex:j,calendarEntries:q,isValidating:U,matterId:te.id||"",onMatterManuallySelected:vr,fetchError:Dr,userData:He,createdContacts:gt,onMatterLinked:as,pageSize:Bt,currentPage:or,totalMatters:Ft,isLoadingPage:Ae,onNavigateToPage:mn})]}),Le&&d.jsx("div",{className:"fixed bottom-5 left-4 right-4 z-10 shadow-[0_-4px_12px_rgba(0,0,0,0.1)]",children:d.jsx(rK,{userData:He,clientEmail:r,emailParticipantClients:i,currentCaseIndex:p,casesForCurrentClient:m})})]}):(X.info("ClioInsights not rendering - Clio not connected",{sourceFile:Ht,isClioConnected:me}),null)},sK=({clientEmail:r,emailParticipants:e,emailParticipantClients:t,currentClientIndex:n,setCurrentClientIndex:s,setClientEmail:i,isManuallySet:c,selectedClientDetails:u,isLoading:p,ClientNavigation:m,handleSectionClick:g,tempClientEmail:x,setTempClientEmail:b,setIsManuallySet:E,isValidClient:T,isTempEmailValid:S,isValidating:N})=>{const R=()=>d.jsx(Qs,{rows:2});return d.jsxs("div",{className:"w-full min-h-[4rem] border border-border/50 rounded-lg shadow-sm bg-card text-card-foreground",title:"Client Information",children:[d.jsxs("div",{className:"flex items-center justify-between p-2 border-b bg-muted",children:[d.jsx("div",{className:"flex items-center gap-2",children:d.jsx("a",{href:"https://global.inszoom.com/CorpAttorney/aty_dashboard.aspx?phn_msg=False&QLogin=Y",target:"_blank",rel:"noopener noreferrer",className:"font-medium text-sm ml-2 hover:opacity-80 text-blue-700 dark:text-blue-400 underline underline-offset-4 decoration-blue-700 dark:decoration-blue-400 transition-opacity cursor-pointer",children:"CLIENT"})}),d.jsxs(Ls,{children:[d.jsx(Ms,{asChild:!0,children:d.jsx($e,{variant:"ghost",size:"icon",className:"h-6 w-6",children:d.jsx(Zs,{className:"h-4 w-4"})})}),d.jsx(ws,{align:"end",className:"p-2",children:d.jsx("div",{className:"flex flex-col gap-2 w-64",children:d.jsxs("div",{className:"flex gap-2 items-center",children:[d.jsx(rn,{type:"email",value:x||"",onChange:A=>b(A.target.value),placeholder:"Set client email",className:`flex-1 px-2 py-1 h-8 text-xs ${S===!1?"border-red-300 focus:ring-red-500":""}`}),d.jsx($e,{variant:"outline",size:"sm",className:`h-8 text-xs px-2 ${S===!1?"bg-red-50 hover:bg-red-100":""}`,onClick:()=>{i(x||"",!0)},disabled:!x,title:S===!1?"Warning: This email is not recognized as a valid client in INSZoom":"Set email as current client",children:"Search"})]})})})]})]}),p?R():d.jsxs(d.Fragment,{children:[t.length>1&&!c&&d.jsx(m,{}),c&&r&&d.jsx("div",{className:"px-3 py-1 bg-gray-50 dark:bg-gray-800 border-b dark:border-gray-700",children:d.jsxs("span",{className:"text-xs text-gray-600 dark:text-gray-300 truncate max-w-[200px]",title:r||"",children:[r," (Manually set)"]})}),N&&e.length>0&&t.length===0&&!c?d.jsx(Qs,{rows:2}):u&&Object.keys(u).length>0?d.jsx(Xc,{details:u}):d.jsx("div",{className:"p-3 text-sm text-gray-600 dark:text-gray-400",children:d.jsx("p",{className:"mb-2",children:c&&r?`No client information found for ${r}`:e.length>0&&t.length===0?`No client information available for emails on the selected thread:
                      ${e.join(", ")}`:e.length>0?"No client information available for the selected email ID":"Select a clientemail thread to view client information"})})]})]})},oK=({clientEmail:r,selectedCaseDetails:e,casesForCurrentClient:t,currentCaseIndex:n,caseDetails:s,nextCase:i,prevCase:c,isLoading:u,setCurrentCaseIndex:p,isValidating:m=!1})=>{const[g,x]=w.useState(""),[b,E]=w.useState(!1),T=w.useMemo(()=>{if(!g.trim())return t;const A=g.toLowerCase();return t.filter(j=>{var M;return String(j.projectName||((M=j.Data)==null?void 0:M.CaseDescription)||"").toLowerCase().includes(A)})},[t,g]),S=A=>{E(A),A||x("")},N=()=>d.jsx(Qs,{rows:2}),R=A=>{if(p)p(A);else if(A>n)for(let j=n;j<A;j++)i();else if(A<n)for(let j=n;j>A;j--)c()};return d.jsxs("div",{className:"w-full min-h-[4rem] border border-border/50 rounded-lg shadow-sm bg-card text-card-foreground",title:"Case Information",children:[d.jsx("div",{className:"flex items-center justify-between p-2 border-b bg-muted",children:d.jsx("div",{className:"flex items-center gap-2",children:d.jsx("a",{href:"https://global.inszoom.com/CorpAttorney/aty_dashboard.aspx?phn_msg=False&QLogin=Y",target:"_blank",rel:"noopener noreferrer",className:"font-medium text-sm ml-2 hover:opacity-80 text-blue-700 dark:text-blue-400 underline underline-offset-4 decoration-blue-700 dark:decoration-blue-400 transition-opacity cursor-pointer",children:"CASES"})})}),u?N():e&&Object.keys(e).length>0?d.jsxs(d.Fragment,{children:[t.length>1&&d.jsx("div",{className:"flex justify-between items-center px-3 py-1 bg-gray-50 dark:bg-gray-800 border-b dark:border-gray-700",children:d.jsx("div",{className:"flex-1 flex items-center",children:d.jsxs(Ls,{open:b,onOpenChange:S,children:[d.jsx(Ms,{asChild:!0,children:d.jsxs($e,{variant:"ghost",size:"sm",className:"h-8 text-sm text-gray-600 dark:text-gray-300 flex items-center gap-1 px-2",children:[d.jsx("span",{className:"truncate max-w-[180px]",title:e.Title||e["Case Description"]||"",children:e.Title||e["Case Description"]||"Case"}),d.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["(",n+1,"/",t.length,")"]}),d.jsx(ys,{className:"w-3 h-3 ml-1"})]})}),d.jsxs(ws,{align:"start",className:"w-[280px] p-0",children:[d.jsxs("div",{className:"p-2 border-b border-gray-200 dark:border-gray-700",children:[d.jsxs("div",{className:"relative",children:[d.jsx(Zs,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),d.jsx(rn,{placeholder:"Search cases...",value:g,onChange:A=>x(A.target.value),className:"pl-8 pr-8 h-8 text-xs",autoFocus:!0,onClick:A=>A.stopPropagation(),onKeyDown:A=>A.stopPropagation()}),g&&d.jsx("button",{onClick:A=>{A.stopPropagation(),x("")},className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:d.jsx(gi,{className:"w-4 h-4"})})]}),g&&d.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:["Showing ",T.length," of ",t.length]})]}),d.jsx("div",{className:"max-h-[200px] overflow-y-auto",children:T.length>0?T.map((A,j)=>{var B;const P=t.findIndex(U=>U===A),M=String(A.projectName||((B=A.Data)==null?void 0:B.CaseDescription)||`Case ${P+1}`);return d.jsx(os,{className:`text-xs truncate ${P===n?"bg-gray-100 dark:bg-gray-700 font-medium":""}`,onClick:()=>R(P),title:M,children:M},P)}):d.jsxs("div",{className:"p-3 text-xs text-center text-gray-500 dark:text-gray-400",children:['No cases match "',g,'"']})})]})]})})}),d.jsx("div",{className:"break-words overflow-hidden",children:d.jsx(Xc,{details:e,linkableFields:[{field:"Title",url:s.projectUrl}]})})]}):m?d.jsx(Qs,{rows:2}):d.jsx("div",{className:"p-3 text-sm text-gray-600 dark:text-gray-400",children:r?d.jsx(d.Fragment,{children:d.jsx("p",{className:"mb-2",children:"Select a client email thread to view case information"})}):"Select a client email thread to view case information"})]})},Sr="src/sidepanel/panels/InsZoomInsights.tsx",zo=r=>{if(!r)return"";try{return new Date(r).toLocaleDateString(void 0,{timeZone:"UTC"})}catch{return r}},y1=r=>{if(console.log("caseData",r),!r||Object.keys(r).length===0)return{};const e=n=>n.replace(/([a-z])([A-Z])/g,"$1 $2");return Object.entries(r).reduce((n,[s,i])=>{if(i!==null&&typeof i=="object"&&!Array.isArray(i)){let c=Object.entries(i);if(s==="report_fields")return console.log("formatting report_fields",c),Object.fromEntries(c),c.filter(([x,b])=>x!=="i797_valid_from"&&x!=="i797_valid_to"&&b!==null&&b!==void 0).forEach(([x,b])=>{let E=x.replace(/_/g," ").replace(/\b\w/g,S=>S.toUpperCase()).replace(/I797/g,"I-797").replace(/H Or L/g,"H/L"),T=String(b);T.includes(" 00:00:00")&&(T=zo(T.split(" ")[0])),n[E]=T}),console.log("promoted report_fields to top level",Object.keys(n)),n;s==="MilestoneCompletedDate"&&(c=c.sort(([,x],[,b])=>{const E=new Date(String(x)),T=new Date(String(b)),S=!isNaN(E.getTime()),N=!isNaN(T.getTime());return S&&N?T.getTime()-E.getTime():S&&!N?-1:!S&&N?1:0}));const u=[],p=[];c.forEach(([x,b])=>{const E=new Date(String(b));!isNaN(E.getTime())?u.push([x,b]):p.push([x,b])});const m=u.map(([x,b])=>`[[${e(x)}]]:
    ((${b}))
`).join(`
`),g=p.length>0?`
[[Not Completed:]]
${p.map(([x])=>`  - ${e(x)}`).join(`
`)}
`:"";n[s]=m+g}else{const c=i!=null?String(i):"";c.includes(`
`)?n[s]=`
  ${c.replace(/\n/g,`
  `)}`:n[s]=c}return n},{})},iK=({clientEmail:r,setClientEmail:e,tempClientEmail:t,setTempClientEmail:n,emailParticipants:s,emailParticipantClients:i,currentClientIndex:c,setCurrentClientIndex:u,currentCaseIndex:p,casesForCurrentClient:m,setCasesForCurrentClient:g,isManuallySet:x,setIsManuallySet:b,isProjectManuallySelected:E,setIsProjectManuallySelected:T,isValidClient:S,isTempEmailValid:N,nextCase:R,prevCase:A,handleSetCurrentCaseIndex:j,ClientNavigation:P,onClientDataValidated:M,isValidating:B,refreshTrigger:U,integrationSettings:V})=>{const Y=Ur(),[ce]=w.useState(!0),[X,de]=w.useState({}),[we,le]=w.useState({}),[se,me]=w.useState({}),[te,G]=w.useState(!1),z=w.useRef({}),J=w.useCallback(q=>{if(!q||!q.client_data)return!1;const ie=q.client_data;return ie&&typeof ie=="object"&&Object.keys(ie).length>0},[]),D=w.useCallback(async(q,ie=!1)=>{if(Y.info("getClientDetailsForEmail called",{sourceFile:Sr,email:q,hasCachedData:!!z.current[q],forceRefresh:ie}),ie&&z.current[q]&&(Y.info("Force refresh requested - clearing component cache",{sourceFile:Sr,email:q}),delete z.current[q]),z.current[q]&&!ie){Y.info("Using cached client data",{sourceFile:Sr,email:q}),Y.debug("Using cached client data",{sourceFile:Sr,email:q});return}try{Y.info("Starting client data fetch from server",{sourceFile:Sr,email:q,forceRefresh:ie}),Y.debug("Fetching client data",{sourceFile:Sr,email:q,forceRefresh:ie});const xe=await Gy("inszoom",q,Y,ie);if(xe&&xe.client_data&&xe.client_data.Data){const ye=xe.client_data.Data;let ue="",ke="",He="",Ue="";ye.ArrivalAndDepartureDetails&&typeof ye.ArrivalAndDepartureDetails=="object"&&ye.ArrivalAndDepartureDetails!==null&&"ImmigrantStatusOnI94"in ye.ArrivalAndDepartureDetails&&(ue=String(ye.ArrivalAndDepartureDetails.ImmigrantStatusOnI94||""),ke=zo(String(ye.ArrivalAndDepartureDetails.I94ValidFrom||"")),He=zo(String(ye.ArrivalAndDepartureDetails.DateOfExpiration||"")),Ue=String(ye.ArrivalAndDepartureDetails.I94Number||""));const Le={...xe.client_data,FirstName:String(ye.FirstName||""),LastName:String(ye.LastName||""),Email:String(ye.Email||q),FileNumber:String(ye.FileNumber||""),Category:String(ye.Category||""),ImmigrantStatusOnI94:ue,I94ValidFrom:ke,I94ValidTo:He,I94Number:Ue,...ye.report_fields&&{report_fields:ye.report_fields}};z.current[q]={client_data:Le,case_data:xe.case_data||[],timestamp:Date.now()}}else z.current[q]={client_data:xe.client_data,case_data:[],timestamp:Date.now()}}catch(xe){throw xe instanceof Error&&(xe.message.includes("Client not found")||xe.message.includes("(cached)"))?Y.debug("Client not found for email (including cached)",{sourceFile:Sr,email:q}):Y.error(`Error fetching client data for ${q}`,xe,{sourceFile:Sr}),xe}},[Y]),$=w.useCallback(q=>{Y.info("selectClientDetails called",{sourceFile:Sr,hasDetails:!!q,detailsKeys:q?Object.keys(q):[]}),Y.debug("Client details received for formatting",{sourceFile:Sr,details:q});const ie=q.FirstName&&q.LastName?`${q.FirstName} ${q.LastName}`:q.fullName||"";let xe="";if(q.visa_details&&typeof q.visa_details=="object"&&q.visa_details!==null){const He=q.visa_details;He.Data&&Array.isArray(He.Data)&&(xe=He.Data.map(Le=>{const Ne=String(Le.VisaType||""),gt=zo(String(Le.IssuanceDate||"")),zt=zo(String(Le.ExpirationDate||""));return`[[${Ne}]]:
${gt} - ${zt}
`}).join(`
`))}let ye="";if(q.passport_details&&typeof q.passport_details=="object"&&q.passport_details!==null){const He=q.passport_details;He.Data&&Array.isArray(He.Data)&&(ye=He.Data.map(Le=>{const Ne=String(Le.PassportNo||""),gt=String(Le.PassportType||""),zt=String(Le.PassportIssuingCountry||""),yt=zo(String(Le.PassportIssuanceDate||"")),Zt=zo(String(Le.PassportExpirationDate||""));return`[[${zt} (${gt})]]
${Ne} :
${yt} - ${Zt}
`}).join(`
`))}let ue="";if(q.report_fields&&typeof q.report_fields=="object"&&q.report_fields!==null){const He=q.report_fields,Ue=He.priority_date_1||"",Le=He.priority_date_1_country||"",Ne=He.priority_date_2||"",gt=He.priority_date_2_country||"",zt=[];if(Ue||Le){const yt=`${Ue}${Le?` [${Le}]`:""}`;zt.push(yt)}if(Ne||gt){const yt=`${Ne}${gt?` [${gt}]`:""}`;zt.push(yt)}zt.length>0&&(ue=zt.join(`
`))}const ke={Name:ie,"Immigration Status":q.ImmigrantStatusOnI94||"","I-94 Number":q.I94Number||"","I-94 Validity":`${q.I94ValidFrom} - ${q.I94ValidTo}`||""};if(q.report_fields&&typeof q.report_fields=="object"&&q.report_fields!==null){const He=q.report_fields,Ue=He.i797_status||"";ke["I-797 Status"]=Ue;const Le=He.i797_valid_from||"",Ne=He.i797_valid_to||"";if(Le&&Le.trim()!==""||Ne&&Ne.trim()!==""){const gt=Le?zo(Le.split(" ")[0]):"",zt=Ne?zo(Ne.split(" ")[0]):"";ke["I-797 Validity"]=`${gt} - ${zt}`}else ke["I-797 Validity"]=""}else ke["I-797 Status"]="",ke["I-797 Validity"]="";if(ke["Passport Details"]=ye,ke["Visa Details"]=xe,q.report_fields&&typeof q.report_fields=="object"&&q.report_fields!==null){const Ue=q.report_fields.h_or_l_max_out_date||"";Ue&&Ue.includes(" 00:00:00")?ke["H/L Maxout Date"]=zo(Ue.split(" ")[0]):ke["H/L Maxout Date"]=Ue}else ke["H/L Maxout Date"]="";if(ke["Priority Dates"]=ue,q.report_fields&&typeof q.report_fields=="object"&&q.report_fields!==null){const Ue=q.report_fields.maxout_date_applicability_notes||"";ke["Maxout Date Applicability and Notes"]=Ue}else ke["Maxout Date Applicability and Notes"]="";Y.info("Client details formatted and set",{sourceFile:Sr,selectedDetails:ke,originalDetails:q}),le(ke)},[Y]),ne=w.useCallback(q=>{Y.info("selectCaseDetails called",{sourceFile:Sr,hasDetails:!!q,details:q||[]});const ie={"Case Description":q.CaseDescription||q.projectName||"","Case Manager":q.WorkingCaseManagers_names||"","Case Status":q.CaseStatus||"","Opened Date":zo(q.CaseOpenedDate)||"","Date Filed":zo(q.DateSentToGovt)||""};ie["Last Step Completed"]=q["Last Step Completed"]||"",ie["Last Step Completed Date"]=zo(q["Last Step Completed Date"])||"",ie["Receipt Number"]=q["Receipt Number"]||"",ie["Case Main Receipt Status"]=q["Case Main Receipt Status"]||"",Y.info("Case details formatted and set",{sourceFile:Sr,selectedDetails:ie,originalDetails:q}),me(ie)},[Y]),_e=w.useCallback(async(q=!1)=>{if(Y.info("fetchClientData called",{sourceFile:Sr,clientEmail:r,isINSZoomConnected:ce,hasClientEmail:!!r,forceRefresh:q}),!r||!ce){Y.info("fetchClientData early return",{sourceFile:Sr,reason:r?"INSZoom not connected":"no client email",clientEmail:r,isINSZoomConnected:ce});return}try{if(G(!0),Y.info("fetchClientData starting data fetch",{sourceFile:Sr,clientEmail:r,isLoading:!0,forceRefresh:q}),q||!z.current[r]||z.current[r].timestamp<Date.now()-1e3*60*60*24)try{await D(r,q)}catch(He){He instanceof Error&&He.message.includes("(cached)")?Y.debug("Using cached knowledge that this client doesn't exist",{sourceFile:Sr,clientEmail:r}):Y.error("Error fetching client data",He,{sourceFile:Sr}),de({}),g([]),le({}),me({}),G(!1);return}const ie=z.current[r];if(!ie){de({}),g([]),le({}),me({}),G(!1),M(r,!1);return}const xe=J(ie);if(M(r,xe),!xe){Y.debug("Client data exists but is not valid",{sourceFile:Sr,clientEmail:r}),de({}),g([]),le({}),me({}),G(!1);return}const ye=ie.client_data;$(ye);const ke=(ie.case_data||[]).sort((He,Ue)=>{const Le=He.Data||He,Ne=Ue.Data||Ue,gt=Le.CaseOpenedDate,zt=Ne.CaseOpenedDate;if(!gt&&!zt)return 0;if(!gt)return 1;if(!zt)return-1;const yt=new Date(gt),Zt=new Date(zt),Bt=!isNaN(yt.getTime()),or=!isNaN(Zt.getTime());return!Bt&&!or?0:Bt?or?Zt.getTime()-yt.getTime():-1:1});if(g(ke),ke.length>0){const He=ke[0].Data||ke[0],Ue=y1(He);de(Ue),ne(Ue)}else de({}),ne({})}catch(ie){Y.error("Error processing client data",ie,{sourceFile:Sr}),de({}),g([]),r&&M(r,!1)}finally{G(!1)}},[r,ce,D,Y,$,ne,g,M,J]);return w.useEffect(()=>{B&&s.length>0&&(z.current={},Y.debug("Cleared component-level client data cache for refresh",{sourceFile:Sr}))},[B,s.length,Y]),w.useEffect(()=>{const q=async()=>{if(ce){Y.info("Validating all email participants",{sourceFile:Sr,participantCount:s.length});for(const ie of s)try{await D(ie);const xe=z.current[ie],ye=J(xe);M(ie,ye),Y.debug("Participant validation result",{sourceFile:Sr,email:ie,hasValidData:ye})}catch(xe){Y.debug("Participant validation failed",{sourceFile:Sr,email:ie,error:xe}),M(ie,!1)}}};s.length>0&&ce&&q()},[s,ce,D,J,M,Y,U]),w.useEffect(()=>{Y.info("useEffect: client email or connection changed",{sourceFile:Sr,clientEmail:r,isINSZoomConnected:ce,willFetchData:!!(r&&ce)}),r&&ce&&(Y.info("Triggering fetchClientData from useEffect",{sourceFile:Sr,clientEmail:r,isManuallySet:x}),_e(x),n(r),x&&!s.includes(r.toLowerCase())&&Y.debug("Manually set email not in participants, validating separately",{sourceFile:Sr,clientEmail:r}))},[r,ce,_e,n,x,s,Y]),w.useEffect(()=>{(!r||s.length===0&&!x)&&(n(null),le({}),me({}))},[r,s.length,x,n,le,me]),w.useEffect(()=>{if(Y.info("useEffect: case index changed",{sourceFile:Sr,currentCaseIndex:p,casesCount:m.length,willUpdateCaseDetails:m.length>0&&p<m.length}),m.length>0&&p<m.length){const q=m[p];Y.info("Updating case details for index",{sourceFile:Sr,currentCaseIndex:p,caseData:q?Object.keys(q):null});const ie=q.Data||q,xe=y1(ie);de(xe),ne(xe),Y.info("Case details updated",{sourceFile:Sr,formattedCaseData:Object.keys(xe)})}},[p,m,ne,Y]),ce?(Y.info("INSZoomInsights rendering components",{sourceFile:Sr,clientEmail:r,selectedClientDetails:Object.keys(we),selectedCaseDetails:Object.keys(se),isLoading:te}),d.jsxs("div",{className:"space-y-4 overflow-y-auto h-full mt-0",children:[d.jsx(sK,{clientEmail:r,emailParticipants:s,emailParticipantClients:i,currentClientIndex:c,setCurrentClientIndex:u,setClientEmail:e,isManuallySet:x,selectedClientDetails:we,isLoading:te,ClientNavigation:P,handleSectionClick:()=>{},tempClientEmail:t,setTempClientEmail:n,setIsManuallySet:b,isValidClient:S,isTempEmailValid:N,isValidating:B}),d.jsx(oK,{clientEmail:r,selectedCaseDetails:se,casesForCurrentClient:m,currentCaseIndex:p,caseDetails:X,nextCase:R,prevCase:A,isLoading:te,setCurrentCaseIndex:j,isValidating:B})]})):(Y.info("INSZoomInsights not rendering - INSZoom not connected",{sourceFile:Sr,isINSZoomConnected:ce}),null)},aK=/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;function lK(r){return r.filter(e=>e&&e.trim().length>0&&aK.test(e.trim())).map(e=>e.trim().toLowerCase())}function cK(r,e){if(!e)return r;const t=e.toLowerCase(),n=t.split("@")[1];return n?["gmail.com","googlemail.com","outlook.com","hotmail.com","live.com","yahoo.com","ymail.com","aol.com","icloud.com","me.com","mac.com","protonmail.com","proton.me","mail.com","zoho.com","gmx.com","gmx.net","trycandle.ai"].includes(n)?r.filter(c=>c.toLowerCase()!==t):r.filter(c=>c.toLowerCase().split("@")[1]!==n):r}const aF={rawParticipants:[],sanitizedParticipants:[],emailsWithValidData:new Set,validatedEmails:new Set,selectedClient:"",currentClientIndex:0,isValidating:!1,isManuallySet:!1,isProjectManuallySelected:!1,refreshTrigger:0,integrationSettings:{},hasTransientError:!1};function uK(r,e){var t,n;switch(e.type){case"SET_RAW_PARTICIPANTS":{const s=lK(e.participants);return console.log(" [Reducer] SET_RAW_PARTICIPANTS:",{rawCount:((t=e.participants)==null?void 0:t.length)??0,sanitizedCount:s.length,raw:e.participants,sanitized:s,filtered:(n=e.participants)==null?void 0:n.filter(i=>!s.includes(i.toLowerCase().trim()))}),JSON.stringify(s)===JSON.stringify(r.sanitizedParticipants)?(console.log(" [Reducer] Participants unchanged, skipping update"),r):{...r,rawParticipants:e.participants,sanitizedParticipants:s,isValidating:s.length>0}}case"MARK_EMAIL_VALIDATED":{const s=new Set(r.validatedEmails);s.add(e.email.toLowerCase());const i=new Set(r.emailsWithValidData),c=e.email.toLowerCase(),u=r.selectedClient&&c===r.selectedClient.toLowerCase();e.isValid?i.add(c):(!r.isValidating||!u)&&i.delete(c);const p=r.sanitizedParticipants.length>0&&s.size>=r.sanitizedParticipants.length;return p&&u&&!e.isValid&&i.delete(c),{...r,validatedEmails:s,emailsWithValidData:i,isValidating:!p}}case"SELECT_CLIENT":return{...r,selectedClient:e.email,currentClientIndex:e.index,isManuallySet:e.isManual};case"SET_PROJECT_MANUALLY_SELECTED":return{...r,isProjectManuallySelected:e.value};case"START_VALIDATION":return{...r,isValidating:!0};case"COMPLETE_VALIDATION":return{...r,isValidating:!1};case"RESET_STATE":return{...aF,refreshTrigger:r.refreshTrigger,hasTransientError:!1};case"REFRESH_DATA":{const s=new Set;return r.selectedClient&&s.add(r.selectedClient.toLowerCase()),{...r,emailsWithValidData:s,validatedEmails:new Set,isValidating:!0,refreshTrigger:r.refreshTrigger+1,hasTransientError:!1}}case"SET_INTEGRATION_SETTINGS":return{...r,integrationSettings:e.settings};case"SET_TRANSIENT_ERROR":return{...r,hasTransientError:e.hasError};default:return r}}function dK({platform:r,dataProvider:e,isIntegrationConnected:t}){const n=Ur(),[s,i]=w.useReducer(uK,aF),c=w.useRef(!1),u=w.useRef(0),p=Hl();w.useEffect(()=>{(async()=>{try{const U=await d8(n);Object.keys(U).length>0&&await p.setLocalItem("integrationSettings",U),i({type:"SET_INTEGRATION_SETTINGS",settings:U})}catch(U){n.error("Failed to fetch integration settings",U,{sourceFile:"src/shared/hooks/useEmailParticipants.ts"})}})()},[n]);const m=s.sanitizedParticipants.filter(B=>s.emailsWithValidData.has(B.toLowerCase())),g=w.useCallback((B,U)=>{n.info("Client data validation result received",{sourceFile:"useEmailParticipants.ts",email:B,isValid:U}),i({type:"MARK_EMAIL_VALIDATED",email:B,isValid:U})},[n]),x=w.useCallback((B,U,V=!1)=>{i({type:"SELECT_CLIENT",email:B,index:U,isManual:V})},[]),b=w.useCallback(B=>{i({type:"SET_PROJECT_MANUALLY_SELECTED",value:B})},[]),E=w.useCallback((B,U)=>{n.warn("Transient error during validation - user should try again later",{sourceFile:"useEmailParticipants.ts",email:B,error:U.message}),i({type:"SET_TRANSIENT_ERROR",hasError:!0})},[n]),T=w.useCallback(()=>{n.debug("Resetting participant state",{sourceFile:"useEmailParticipants.ts"}),i({type:"RESET_STATE"})},[n]),S=w.useCallback(async()=>{const B=Date.now();if(B-u.current<50){n.debug("Debouncing fetchParticipants call",{sourceFile:"useEmailParticipants.ts"});return}u.current=B;try{if(r==="chrome"){const V=await e.getCurrentThreadId();if(V){n.info("Getting participants for Chrome",{sourceFile:"useEmailParticipants.ts",threadId:V}),console.log(` [Participants] Fetching for thread: ${V}`);try{const Y=await o8(V,n);console.log(` [Participants] Server returned ${(Y==null?void 0:Y.length)??0} participants:`,Y),n.info("Received participants from server",{sourceFile:"useEmailParticipants.ts",threadId:V,participantCount:(Y==null?void 0:Y.length)??0,participants:Y==null?void 0:Y.slice(0,5)}),(!Y||Y.length===0)&&(console.warn(` [Participants] No participants returned for thread ${V}`),n.warn("No participants returned from server",{sourceFile:"useEmailParticipants.ts",threadId:V})),i({type:"SET_RAW_PARTICIPANTS",participants:Y||[]})}catch(Y){console.error(` [Participants] Error fetching for thread ${V}:`,Y),n.error("Error fetching participants for Chrome",Y,{sourceFile:"useEmailParticipants.ts",threadId:V}),T()}}else console.warn(" [Participants] No threadId found for Chrome"),n.debug("No threadId found for Chrome",{sourceFile:"useEmailParticipants.ts"}),T()}else if(r==="outlook"){n.debug("Getting participants for Outlook",{sourceFile:"useEmailParticipants.ts"});try{const V=await e.getCurrentThread();if(V){let Y=V.participants;const ce=e.getCurrentUserEmail();if(ce){const X=Y.length;Y=cK(Y,ce),n.debug("Applied domain filtering for Outlook participants",{sourceFile:"useEmailParticipants.ts",userEmail:ce,originalCount:X,filteredCount:Y.length})}else n.warn("Could not get user email, skipping domain filtering",{sourceFile:"useEmailParticipants.ts"});i({type:"SET_RAW_PARTICIPANTS",participants:Y})}else n.debug("No thread found for Outlook",{sourceFile:"useEmailParticipants.ts"}),T()}catch(V){n.error("Error fetching participants for Outlook",V,{sourceFile:"useEmailParticipants.ts"}),T()}}}catch(V){n.error("Error in fetchParticipants",V,{sourceFile:"useEmailParticipants.ts"}),T()}},[r,e,n,T]),N=w.useCallback(async()=>{if(!(s.isValidating||s.sanitizedParticipants.length===0)){n.info("Starting participant data refresh",{sourceFile:"useEmailParticipants.ts",participantCount:s.sanitizedParticipants.length});try{await Promise.all(s.sanitizedParticipants.map(B=>Bv(B,n))),i({type:"REFRESH_DATA"}),n.info("Participant data refresh initiated",{sourceFile:"useEmailParticipants.ts"})}catch(B){n.error("Error refreshing participant data",B,{sourceFile:"useEmailParticipants.ts"})}}},[s.isValidating,s.sanitizedParticipants,n]),R=m.length>0,A=m[0]??"",j=s.selectedClient?m.includes(s.selectedClient):!0,P=R&&!s.selectedClient&&!s.isManuallySet&&!s.isProjectManuallySelected,M=!s.isValidating&&s.selectedClient&&!j&&!s.isManuallySet&&!s.isProjectManuallySelected;return w.useEffect(()=>{P?(n.info("Auto-selecting first validated client",{sourceFile:"useEmailParticipants.ts",selectedClient:A}),i({type:"SELECT_CLIENT",email:A,index:0,isManual:!1})):M&&(n.info("Current client no longer valid, clearing",{sourceFile:"useEmailParticipants.ts",clientEmail:s.selectedClient}),i({type:"SELECT_CLIENT",email:"",index:0,isManual:!1}))},[P,M,A,s.selectedClient,n]),w.useEffect(()=>{if(e!=null&&e.onThreadChanged){const B=U=>{U?(n.debug("Thread changed",{sourceFile:"useEmailParticipants.ts",newThreadId:U.threadId}),i({type:"RESET_STATE"}),S()):(n.info("Thread cleared",{sourceFile:"useEmailParticipants.ts"}),i({type:"RESET_STATE"}))};return e.onThreadChanged(B),()=>{e.removeThreadListener&&e.removeThreadListener(B)}}},[e,S,n]),w.useEffect(()=>{t&&!c.current&&(c.current=!0,S())},[t,S]),{validClients:m,selectedClient:s.selectedClient,currentClientIndex:s.currentClientIndex,sanitizedParticipants:s.sanitizedParticipants,isValidating:s.isValidating,isManuallySet:s.isManuallySet,isProjectManuallySelected:s.isProjectManuallySelected,refreshTrigger:s.refreshTrigger,integrationSettings:s.integrationSettings,hasTransientError:s.hasTransientError,selectClient:x,setProjectManuallySelected:b,handleClientDataValidated:g,handleTransientError:E,refresh:N,resetState:T}}function fK({toggleSection:r,clientEmail:e,setClientEmail:t,setProjectId:n,setDocuments:s,setIsDocumentsLoading:i,setDocumentsError:c,onDocumentView:u}){const p=Ur(),m=ln().platform,g=id();Hl();const{isConnected:x}=Ji(),[b,E]=w.useState([]),[T,S]=w.useState(null),[N,R]=w.useState(!0),[A,j]=w.useState(0),[P,M]=w.useState([]),[B,U]=w.useState(null),[V,Y]=w.useState(null),[ce,X]=w.useState(!1),[de,we]=w.useState(!1),[le,se]=w.useState(!1),me=ce||de||le,{validClients:te,selectedClient:G,currentClientIndex:z,sanitizedParticipants:J,isValidating:D,isManuallySet:$,isProjectManuallySelected:ne,refreshTrigger:_e,integrationSettings:q,hasTransientError:ie,selectClient:xe,setProjectManuallySelected:ye,handleClientDataValidated:ue,handleTransientError:ke,refresh:He}=dK({platform:m,dataProvider:g,isIntegrationConnected:me});w.useEffect(()=>{t(G)},[G,t]),w.useEffect(()=>{(async()=>{await bI(p)})()},[p]);const Ue=w.useCallback(()=>{if(A<P.length-1){const st=A+1;j(st)}},[A,P.length]),Le=w.useCallback(()=>{if(A>0){const st=A-1;j(st)}},[A]),Ne=w.useCallback(st=>{st>=0&&st<P.length&&j(st)},[P.length]);w.useEffect(()=>{j(0)},[G]);const gt=w.useCallback(({className:st="",clientUrl:Ft})=>d.jsxs("div",{className:`flex items-center px-3 py-1 bg-gray-50 dark:bg-gray-800 border-b dark:border-gray-700 gap-2 ${st}`,children:[d.jsx("div",{className:"flex-1 min-w-0 flex items-center",children:d.jsxs(Ls,{children:[d.jsx(Ms,{asChild:!0,children:d.jsxs($e,{variant:"ghost",size:"sm",className:"h-8 text-sm text-gray-600 dark:text-gray-300 flex items-center gap-1 px-2 max-w-full",children:[d.jsx("span",{className:"truncate",title:G||"",children:G||"No client"}),d.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400 flex-shrink-0",children:["(",z+1,"/",te.length,")"]}),d.jsx(ys,{className:"w-3 h-3 ml-1 flex-shrink-0"})]})}),d.jsx(ws,{align:"start",className:"max-h-[200px] overflow-y-auto",children:te.map((er,Ae)=>d.jsx(os,{className:`text-xs ${Ae===z?"bg-gray-100 dark:bg-gray-700 font-medium":""}`,onClick:()=>{xe(er,Ae,!1)},children:er},er))})]})}),Ft&&d.jsxs("a",{href:Ft,target:"_blank",rel:"noopener noreferrer",className:"h-8 text-xs text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 border border-blue-200 dark:border-blue-800 px-3 flex-shrink-0 rounded-md inline-flex items-center gap-1 no-underline hover:no-underline",children:[d.jsx(jl,{className:"w-3 h-3"}),"View"]})]}),[G,z,te,xe]);w.useEffect(()=>{(async()=>{try{const Ft=await _I(p),er=Ft.some(dt=>dt.integration_type==="filevine"),Ae=Ft.some(dt=>dt.integration_type==="clio"),Ze=Ft.some(dt=>dt.integration_type==="inszoom");X(er),we(Ae),se(Ze)}catch(Ft){p.error("Error checking integration connections",Ft,{sourceFile:"src/shared/components/sidepanel/panels/IsngitsPanel.tsx"})}})()},[p]),w.useEffect(()=>{j(0)},[G]),w.useEffect(()=>{(async()=>{try{const Ft=await Bm(p);E(Ft||[]);const er=(Ft==null?void 0:Ft.some(rt=>rt.integration_type.toLowerCase()==="filevine"))||!1,Ae=(Ft==null?void 0:Ft.some(rt=>rt.integration_type.toLowerCase()==="clio"))||!1,Ze=(Ft==null?void 0:Ft.some(rt=>rt.integration_type.toLowerCase()==="inszoom"))||!1;let dt=null;if(er?dt="filevine":Ae?dt="clio":Ze&&(dt="inszoom"),dt){const rt=await NE(dt);S(rt)}else S(null)}catch(Ft){p.error("Error fetching integrations:",Ft,{sourceFile:"src/shared/components/sidepanel/panels/IsngitsPanel.tsx"})}finally{R(!1)}})()},[p]);const zt=b.some(st=>st.integration_type.toLowerCase()==="filevine"),yt=b.some(st=>st.integration_type.toLowerCase()==="clio"),Zt=b.some(st=>st.integration_type.toLowerCase()==="inszoom");w.useEffect(()=>{Y(B?!0:null)},[B]);const Bt={clientEmail:G,setClientEmail:(st,Ft)=>{if(!st)xe("",0,!1);else{const er=te.indexOf(st),Ae=Ft===!0?!0:er<0;xe(st,er>=0?er:0,Ae)}},tempClientEmail:B,setTempClientEmail:U,emailParticipants:J,emailParticipantClients:te,currentClientIndex:z,setCurrentClientIndex:st=>{const Ft=te[st];Ft?xe(Ft,st,!1):(p.warn("Invalid client index",{sourceFile:"src/shared/components/sidepanel/panels/IsngitsPanel.tsx",index:st,availableClients:te.length}),xe("",0,!1))},currentCaseIndex:A,casesForCurrentClient:P,setCasesForCurrentClient:M,isManuallySet:$,setIsManuallySet:st=>{xe(G||"",z,st)},isProjectManuallySelected:ne,setIsProjectManuallySelected:ye,isValidClient:G?!0:null,isTempEmailValid:V,nextCase:Ue,prevCase:Le,handleSetCurrentCaseIndex:Ne,ClientNavigation:gt,onClientDataValidated:ue,onTransientError:ke,isValidating:D,refreshTrigger:_e,integrationSettings:q,hasTransientError:ie},or=m==="chrome"&&!x;return d.jsx("div",{className:"h-full",children:or?d.jsx("div",{className:"p-4",children:d.jsx(bE,{feature:"Insights",description:"Connect your Gmail account to view client insights and case information",benefits:["Automatically identify clients from email participants","View relevant case information and documents","Access client details from your case management system"]})}):N?d.jsxs("div",{className:"flex flex-col items-center justify-center h-full",children:[d.jsx(qi,{className:"h-8 w-8 animate-spin text-blue-600"}),d.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"Loading integrations..."})]}):d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"flex items-center mb-1",children:d.jsx("span",{className:"font-small text-xs text-slate-800 dark:text-gray-400",children:"Data provided by"})}),d.jsxs("div",{className:"flex items-center justify-between mb-2",children:[T&&d.jsxs("a",{href:T.homeUrl,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 hover:opacity-80 text-blue-700 dark:text-blue-400 underline underline-offset-4 decoration-blue-700 dark:decoration-blue-400 transition-opacity cursor-pointer",children:[d.jsx(Oc,{src:T.logo,width:20,height:20,alt:T.name,className:"h-5 w-auto dark:brightness-0 dark:invert"}),d.jsx("span",{className:"font-small text-xs text-slate-800 dark:text-gray-300",children:T.name})]}),d.jsx($e,{size:"icon",variant:"outline",onClick:He,disabled:D||J.length===0,className:"flex items-center h-6 w-6 mr-4",title:D?"Refreshing...":J.length===0?"No participants to refresh":"Refresh participant data",children:d.jsx(Co,{className:`h-3 w-3 ${D?"animate-spin":""}`})})]}),zt&&d.jsx(Hq,{toggleSection:r,setDocuments:s,setIsDocumentsLoading:i,setDocumentsError:c,setProjectId:n,onDocumentView:u,...Bt}),yt&&d.jsx(nK,{...Bt}),Zt&&d.jsx(iK,{...Bt})]})})}const hK={showEmailSummary:!1,showInsightsTab:!0,showComposeTab:!0,showTemplatesTab:!0},pK=()=>hK,mK=r=>pK()[r],gK=({className:r=""})=>{const[e,t]=w.useState(!1),{isConnected:n,wasEverConnected:s,isLoading:i,error:c,status:u,reconnectAttempts:p,initiateReconnection:m,clearError:g}=Ji(),{platform:x}=ln();if(x!=="chrome"||n&&u!=="error"||e)return null;const b=async()=>{try{await m()}catch(j){console.error("Failed to reconnect Gmail:",j)}},E=()=>{t(!0),c&&g()},T=()=>u==="error"?"bg-red-50 border-red-200":s?"bg-yellow-50 border-yellow-200":"bg-blue-50 border-blue-200",S=()=>u==="error"?d.jsx(Zf,{className:"h-4 w-4 text-red-600 flex-shrink-0"}):s?d.jsx(Zf,{className:"h-4 w-4 text-yellow-600 flex-shrink-0"}):d.jsx(Zf,{className:"h-4 w-4 text-blue-600 flex-shrink-0"}),N=()=>u==="error"?c||"Gmail connection error occurred":s?"Gmail connection lost. Some features may not work properly.":"Gmail connection required to access all features.",R=()=>u==="error"?"text-red-800":s?"text-yellow-800":"text-blue-800",A=()=>u==="error"?"bg-red-100 border-red-300 text-red-800 hover:bg-red-200 hover:border-red-400":s?"bg-yellow-100 border-yellow-300 text-yellow-800 hover:bg-yellow-200 hover:border-yellow-400":"bg-blue-100 border-blue-300 text-blue-800 hover:bg-blue-200 hover:border-blue-400";return d.jsxs("div",{className:`flex items-center justify-between ${T()} px-4 py-3 ${r}`,role:"alert","aria-live":"polite","aria-atomic":"true",children:[d.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[S(),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("p",{className:`text-sm ${R()} font-medium`,children:N()}),p>0&&d.jsxs("p",{className:`text-xs ${R()} opacity-75 mt-1`,children:["Reconnect attempts: ",p]})]})]}),d.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[d.jsx($e,{onClick:b,disabled:i,variant:"outline",size:"sm",className:`${A()} text-xs px-3 py-1 h-auto whitespace-nowrap`,"aria-label":i?"Connecting to Gmail...":s?"Reconnect Gmail account":"Connect Gmail account",children:i?d.jsxs(d.Fragment,{children:[d.jsx(Co,{className:"h-3 w-3 mr-1 animate-spin","aria-hidden":"true"}),"Connecting..."]}):s?"Reconnect Gmail":"Connect Gmail"}),d.jsx($e,{onClick:E,variant:"ghost",size:"sm",className:`${u==="error"?"text-red-600 hover:text-red-800 hover:bg-red-100":s?"text-yellow-600 hover:text-yellow-800 hover:bg-yellow-100":"text-blue-600 hover:text-blue-800 hover:bg-blue-100"} p-1 h-auto`,"aria-label":"Dismiss Gmail connection banner",children:d.jsx(gi,{className:"h-4 w-4","aria-hidden":"true"})})]})]})},lF=w.createContext(void 0),cF=()=>{const r=w.useContext(lF);if(r===void 0)throw new Error("useToast must be used within a ToastProvider");return r},vK=({children:r})=>{const[e,t]=w.useState([]),n=w.useCallback(u=>{const p=Math.random().toString(36).substr(2,9),m={...u,id:p};t(x=>[...x,m]);const g=u.duration??5e3;return g>0&&setTimeout(()=>{t(x=>x.filter(b=>b.id!==p))},g),p},[]),s=w.useCallback(u=>{t(p=>p.filter(m=>m.id!==u))},[]),i=w.useCallback(()=>{t([])},[]),c={toasts:e,addToast:n,removeToast:s,clearAll:i};return d.jsxs(lF.Provider,{value:c,children:[r,d.jsx(yK,{})]})},yK=()=>{const{toasts:r,removeToast:e}=cF();return r.length===0?null:d.jsx("div",{className:"fixed top-4 right-4 z-50 flex flex-col gap-2 max-w-sm",children:r.map(t=>d.jsx(xK,{toast:t,onRemove:e},t.id))})},xK=({toast:r,onRemove:e})=>{const t=s=>{switch(s){case"success":return d.jsx(Hc,{className:"h-5 w-5 text-green-600"});case"error":return d.jsx(Zf,{className:"h-5 w-5 text-red-600"});case"warning":return d.jsx(JR,{className:"h-5 w-5 text-amber-600"});case"info":return d.jsx(Wc,{className:"h-5 w-5 text-blue-600"});default:return null}},n=s=>{switch(s){case"success":return"bg-green-50 border-green-200";case"error":return"bg-red-50 border-red-200";case"warning":return"bg-amber-50 border-amber-200";case"info":return"bg-blue-50 border-blue-200";default:return"bg-gray-50 border-gray-200"}};return d.jsxs("div",{className:`flex items-start gap-3 p-4 rounded-lg border shadow-lg animate-in slide-in-from-right-full ${n(r.type)}`,children:[t(r.type),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("p",{className:"text-sm font-medium text-gray-900",children:r.title}),r.description&&d.jsx("p",{className:"text-sm text-gray-600 mt-1",children:r.description}),r.action&&d.jsx($e,{onClick:r.action.onClick,variant:"outline",size:"sm",className:"mt-2 h-7 text-xs",children:r.action.label})]}),d.jsx($e,{onClick:()=>e(r.id),variant:"ghost",size:"sm",className:"p-1 h-auto",children:d.jsx(gi,{className:"h-4 w-4"})})]})},wK=()=>{const{addToast:r}=cF(),e=w.useCallback(()=>{r({type:"success",title:"Gmail Connected",description:"Successfully connected to Gmail. All features are now available.",duration:4e3})},[r]),t=w.useCallback(c=>{r({type:"warning",title:"Gmail Connection Lost",description:"Some features may not work properly until you reconnect.",duration:0,action:c?{label:"Reconnect",onClick:c}:void 0})},[r]),n=w.useCallback((c,u)=>{r({type:"error",title:"Gmail Connection Error",description:c,duration:0,action:u?{label:"Retry",onClick:u}:void 0})},[r]),s=w.useCallback(()=>{r({type:"success",title:"Gmail Reconnected",description:"Successfully reconnected to Gmail.",duration:3e3})},[r]),i=w.useCallback(c=>{r({type:"error",title:"Reconnection Failed",description:"Failed to reconnect to Gmail. Please try again.",duration:0,action:c?{label:"Try Again",onClick:c}:void 0})},[r]);return{showConnectionSuccess:e,showConnectionLost:t,showConnectionError:n,showReconnectionSuccess:s,showReconnectionFailed:i}},bK=()=>{const{status:r,error:e,isConnected:t,initiateReconnection:n}=Ji(),{platform:s}=ln(),{showConnectionSuccess:i,showConnectionLost:c,showConnectionError:u,showReconnectionSuccess:p,showReconnectionFailed:m}=wK(),g=w.useRef("loading"),x=w.useRef(!0),b=w.useRef(!1);return w.useEffect(()=>{if(s!=="chrome")return;const E=g.current,T=x.current,S=b.current;if(!(!S&&r==="loading")){if(!S){b.current=!0,g.current=r,x.current=t;return}if(E!==r||T!==t)switch(r){case"connected":(E==="disconnected"||E==="error"||!T)&&(E==="loading"?p():i());break;case"disconnected":T&&E==="connected"&&c(()=>{n().catch(R=>{console.error("Failed to reconnect from toast:",R)})});break;case"error":u(e||"Unknown connection error occurred",()=>{n().catch(R=>{console.error("Failed to reconnect from toast:",R),m(()=>{n().catch(console.error)})})});break}g.current=r,x.current=t}},[r,e,t,s,n,i,c,u,p,m]),null},_K=({activeSection:r,toggleSection:e})=>{const t=Ur();t.debug(`[MainPanelContent] Rendering with activeSection: "${r}"`,{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx",functionName:"MainPanelContent",data:{activeSection:r}});const n=PT(),s=Hl(),{platform:i}=ln(),{isConnected:c,wasEverConnected:u}=Ji(),p=i==="chrome"&&!c&&u,[m,g]=w.useState(""),[x,b]=w.useState(""),[E,T]=w.useState([]),[S,N]=w.useState(!1),[R,A]=w.useState(null),[j,P]=w.useState(null),[M,B]=w.useState("compose"),[U,V]=w.useState(!1),[Y,ce]=w.useState(!1),[X,de]=w.useState(!1),we=w.useRef(!1),le=w.useRef(!1),se=w.useRef(null),me=w.useCallback(async()=>{try{t.info("Checking authentication status...",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"});const J=await(n==null?void 0:n.isAuthenticated());return t.info("Authentication status checked",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx",authenticated:J}),J||!1}catch(J){return t.error("Failed to check auth status",J,{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"}),!1}},[n,t]);w.useEffect(()=>{t.info("MainPanelContent component loaded",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"});const J=async()=>{const $=await me();ce(!0),de($),$?(t.info("Valid token found. User is authenticated.",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"}),r==="login"&&e("main")):(t.info("No valid token found. Show login page.",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"}),e("login"))},D=$=>{$.token&&(t.info("Token detected in storage, auth state will be updated automatically",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"}),J(),By(t))};return s!=null&&s.onChanged&&s.onChanged(D),J(),()=>{s!=null&&s.removeChangeListener&&s.removeChangeListener(D)}},[n,s,e,t,me,r]),w.useEffect(()=>{t.info("MainPanelContent component loaded",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"})},[s,t]),w.useEffect(()=>{if(!Y||!X||le.current){t.debug("Skipping CMS integration check - auth not ready, not authenticated, or already checked",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx",isAuthChecked:Y,isAuthenticated:X,hasRunInitialCheck:le.current});return}le.current=!0;const J=async()=>{try{t.info("Checking Case Management System connection status",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"});const $=await wI(t);t.info("Case Management System connection status result",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx",connected:$}),V($),we.current||($?(t.info("CMS connected, setting active tab to insights",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"}),B("insights")):(t.info("CMS not connected, setting active tab to compose",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"}),B("compose")),we.current=!0)}catch($){t.error("Error checking Case Management System connection",$,{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"}),V(!1),we.current||(B("compose"),we.current=!0)}},D=$=>{if(!$.integrations)return;t.info("Integrations changed via storage, rechecking CMS connection",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx",oldValue:$.integrations.oldValue,newValue:$.integrations.newValue});const ne=$.integrations.newValue;if(!Array.isArray(ne))return;const _e=["inszoom","filevine","clio"];ne.some(ie=>_e.includes(ie.integration_type))&&(t.info("CMS integration found",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx",newValue:$.integrations.newValue}),V(!0))};return J(),s!=null&&s.onChanged&&s.onChanged(D),()=>{s!=null&&s.removeChangeListener&&s.removeChangeListener(D)}},[Y,X,t,s]);const te=J=>{B(J),e(J==="login"?"login":"main")},G=()=>{t.debug("[MainPanelContent] goBack called. Setting activeSection to null.",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx",functionName:"goBack"}),e("main"),P(null)},z=J=>{t.debug("[MainPanelContent] handleDocumentView called",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx",functionName:"handleDocumentView",data:{document:J}}),P(J),e("Project Documents")};return w.useEffect(()=>{r==="Project Documents"&&se.current&&(se.current.scrollTop=0)},[r]),d.jsxs(vK,{children:[d.jsx(bK,{}),d.jsxs("div",{ref:se,className:`flex flex-col h-full relative ${r==="login"||r==="Project Documents"?"overflow-hidden":"overflow-y-auto"}`,children:[r!=="login"&&d.jsx(gK,{className:"flex-shrink-0"}),d.jsxs("div",{className:"flex flex-col",children:[mK("showEmailSummary")&&d.jsx("div",{className:"flex-shrink-0 border-b-2 border-gray-300",children:d.jsx(E9,{})}),d.jsx("div",{className:"flex-grow flex flex-col",children:p?d.jsx("div",{className:"flex-grow"}):d.jsxs(B9,{defaultValue:U?"insights":"compose",value:M,onValueChange:te,className:"w-full flex flex-col",children:[d.jsxs(BI,{className:`grid ${U?"grid-cols-3":"grid-cols-2"} w-full bg-white dark:bg-card border-b dark:border-border p-0 h-auto flex-shrink-0`,children:[U&&d.jsx(Xv,{value:"insights",className:"m-2 mb-0 text-gray-600 dark:text-gray-200 data-[state=active]:text-blue-600 dark:data-[state=active]:text-blue-400 data-[state=active]:bg-white dark:data-[state=active]:bg-muted data-[state=active]:shadow-sm data-[state=active]:font-medium border-gray-200 dark:border-border data-[state=active]:border-b-2 data-[state=active]:border-b-blue-600 dark:data-[state=active]:border-b-blue-400",children:"Insights"}),d.jsx(Xv,{value:"compose",className:"m-2 mb-0 text-gray-600 dark:text-gray-200 data-[state=active]:text-blue-600 dark:data-[state=active]:text-blue-400 data-[state=active]:bg-white dark:data-[state=active]:bg-muted data-[state=active]:shadow-sm data-[state=active]:font-medium border-gray-200 dark:border-border data-[state=active]:border-b-2 data-[state=active]:border-b-blue-600 dark:data-[state=active]:border-b-blue-400",children:"Compose"}),d.jsx(Xv,{value:"templates",className:"m-2 mb-0 text-gray-600 dark:text-gray-200 data-[state=active]:text-blue-600 dark:data-[state=active]:text-blue-400 data-[state=active]:bg-white dark:data-[state=active]:bg-muted data-[state=active]:shadow-sm data-[state=active]:font-medium border-gray-200 dark:border-border data-[state=active]:border-b-2 data-[state=active]:border-b-blue-600 dark:data-[state=active]:border-b-blue-400",children:"Templates"})]}),d.jsxs("div",{className:"flex-grow mb-0",children:[U&&d.jsx(Qv,{forceMount:!0,value:"insights",className:`p-4 ${M==="insights"?"block":"hidden"}`,children:d.jsx(fK,{toggleSection:e,clientEmail:m,setClientEmail:g,setProjectId:b,setDocuments:T,setIsDocumentsLoading:N,setDocumentsError:A,onDocumentView:z})}),d.jsx(Qv,{forceMount:!0,value:"compose",className:`p-4 ${M==="compose"?"block":"hidden"}`,children:d.jsx(d9,{clientEmail:m})}),d.jsx(Qv,{forceMount:!0,value:"templates",className:`p-4 ${M==="templates"?"block":"hidden"}`,children:d.jsx(C7,{clientEmail:m,isAuthenticated:X})})]})]})})]})," ",r==="login"&&d.jsx("div",{className:"fixed inset-0 bg-white dark:bg-gray-950 z-50",children:d.jsx(f9,{})}),r==="Project Documents"&&(t.debug('[MainPanelContent] activeSection is "Project Documents". Rendering overlay.',{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx",functionName:"MainPanelContent.render",data:{activeSection:r,selectedDocumentToView:j}}),d.jsx("div",{className:"absolute inset-0 bg-white dark:bg-gray-950 z-10",children:j?d.jsx(GI,{documentId:j.documentId,documentName:j.name,onBack:G}):d.jsx(V9,{clientEmail:m,projectId:x,documents:E,isLoading:S,error:R,goBack:G})}))]})]})},EK=()=>{var x;const[r,e]=w.useState(null),t=Ur(),{platform:n}=ln(),s=id(),{isConnected:i}=Ji();if(w.useEffect(()=>{var S,N;if(n!=="chrome")return;const b=async()=>{var R;try{if((R=chrome==null?void 0:chrome.tabs)!=null&&R.query){const[A]=await chrome.tabs.query({active:!0,currentWindow:!0});if(A!=null&&A.id&&(A!=null&&A.windowId)){let j;try{const P=await(s==null?void 0:s.getCurrentThread());j=P==null?void 0:P.subject}catch(P){t.debug("Could not get email thread subject",{sourceFile:"src/shared/components/sidepanel/TabIndicator.tsx",sourceFunction:"getCurrentTabInfo",error:P})}e({tabId:A.id,windowId:A.windowId,title:A.title,url:A.url,emailSubject:j}),t.debug("Updated tab info in indicator",{sourceFile:"src/shared/components/sidepanel/TabIndicator.tsx",sourceFunction:"getCurrentTabInfo",tabId:A.id,windowId:A.windowId,title:A.title,emailSubject:j})}}}catch(A){t.error("Error getting current tab info",A,{sourceFile:"src/shared/components/sidepanel/TabIndicator.tsx",sourceFunction:"getCurrentTabInfo"})}};b();const E=[];if((S=chrome==null?void 0:chrome.tabs)!=null&&S.onActivated){const R=A=>{t.debug("Tab activated in indicator",{sourceFile:"src/shared/components/sidepanel/TabIndicator.tsx",sourceFunction:"handleTabActivated",tabId:A.tabId,windowId:A.windowId}),setTimeout(b,200)};chrome.tabs.onActivated.addListener(R),E.push(()=>{var A,j;(j=(A=chrome==null?void 0:chrome.tabs)==null?void 0:A.onActivated)!=null&&j.removeListener&&chrome.tabs.onActivated.removeListener(R)})}if((N=chrome==null?void 0:chrome.tabs)!=null&&N.onUpdated){const R=(A,j,P)=>{var M;j.url&&P.active&&P.windowId&&(t.debug("Tab URL updated, refreshing tab indicator",{sourceFile:"src/shared/components/sidepanel/TabIndicator.tsx",sourceFunction:"handleTabUpdated",tabId:A,newUrl:j.url}),setTimeout(b,300)),j.status==="complete"&&P.active&&((M=P.url)!=null&&M.includes("mail.google.com"))&&setTimeout(b,500)};chrome.tabs.onUpdated.addListener(R),E.push(()=>{var A,j;(j=(A=chrome==null?void 0:chrome.tabs)==null?void 0:A.onUpdated)!=null&&j.removeListener&&chrome.tabs.onUpdated.removeListener(R)})}if(s!=null&&s.onThreadChanged){const R=()=>{t.debug("Thread data changed, updating tab indicator",{sourceFile:"src/shared/components/sidepanel/TabIndicator.tsx",sourceFunction:"handleThreadChanged"}),setTimeout(b,100)};s.onThreadChanged(R),E.push(()=>{s.removeThreadListener&&s.removeThreadListener(R)})}const T=setInterval(()=>{b()},3e3);return E.push(()=>{clearInterval(T)}),()=>{E.forEach(R=>R())}},[n,t,s]),n!=="chrome"||!r||!i)return null;const c=()=>{var b;return r.emailSubject&&r.emailSubject!=="No Subject"?r.emailSubject.length>50?`${r.emailSubject.substring(0,50)}...`:r.emailSubject:(b=r.url)!=null&&b.includes("mail.google.com")?"Open an email to begin":r.title?r.title.length>30?`${r.title.substring(0,30)}...`:r.title:"No content available"},u=()=>{var b;return r.emailSubject&&r.emailSubject!=="No Subject"?"border-green-400 bg-green-50 dark:border-green-500 dark:bg-green-950":(b=r.url)!=null&&b.includes("mail.google.com")?"border-yellow-400 bg-yellow-50 dark:border-yellow-500 dark:bg-yellow-950":"border-blue-400 bg-blue-50 dark:border-blue-500 dark:bg-blue-950"},p=()=>{var b;return r.emailSubject&&r.emailSubject!=="No Subject"?"bg-green-400 dark:bg-green-500":(b=r.url)!=null&&b.includes("mail.google.com")?"bg-yellow-400 dark:bg-yellow-500":"bg-blue-400 dark:bg-blue-500"},m=()=>{var b;return r.emailSubject&&r.emailSubject!=="No Subject"?"text-green-800 dark:text-green-200":(b=r.url)!=null&&b.includes("mail.google.com")?"text-yellow-800 dark:text-yellow-200":"text-blue-800 dark:text-blue-200"},g=()=>{var b;return r.emailSubject&&r.emailSubject!=="No Subject"?"text-green-600 dark:text-green-300":(b=r.url)!=null&&b.includes("mail.google.com")?"text-yellow-600 dark:text-yellow-300":"text-blue-600 dark:text-blue-300"};return d.jsx("div",{className:`border-l-4 p-3 mb-4 rounded-r-md ${u()}`,children:d.jsxs("div",{className:"flex items-center",children:[d.jsx("div",{className:"flex-shrink-0",children:d.jsx("div",{className:`w-2 h-2 rounded-full animate-pulse ${p()}`})}),d.jsxs("div",{className:"ml-3 flex-1 min-w-0",children:[d.jsx("p",{className:`text-sm font-medium ${m()}`,children:r.emailSubject&&r.emailSubject!=="No Subject"?"Email Opened":(x=r.url)!=null&&x.includes("mail.google.com")?"No Email Selected":"Active Tab"}),d.jsx("p",{className:`text-sm ${g()} truncate`,title:r.emailSubject||r.title,children:c()})]})]})})},SK=()=>{const{activeSection:r,setActiveSection:e}=jT(),t=v8(),n=x8(),s=Ur(),{platform:i}=ln(),c=u=>{if(s.debug(`toggleSection called with section: "${u}"`,{sourceFile:"src/shared/components/sidepanel/SidePanelContent.tsx",section:u,currentActiveSection:r}),r===u){s.debug(`toggleSection called with section: "${u}" but activeSection is already ${r}`,{sourceFile:"src/shared/components/sidepanel/SidePanelContent.tsx",section:u,currentActiveSection:r});return}else s.debug(`toggleSection called with section: "${u}" changing activeSection from ${r}`,{sourceFile:"src/shared/components/sidepanel/SidePanelContent.tsx",section:u,currentActiveSection:r}),e(u)};return w.useEffect(()=>{if(t!=null&&t.onMessage){const u=async p=>{if(p.type==="USER_LOGGED_OUT"&&(s.info("Received logout notification in sidepanel",{sourceFile:"src/shared/components/sidepanel/SidePanelContent.tsx"}),n!=null&&n.closeWindow))try{await n.closeWindow()}catch(m){s.error("Failed to close window",m,{sourceFile:"src/shared/components/sidepanel/SidePanelContent.tsx"})}};return t.onMessage(u),()=>{t.removeMessageListener&&t.removeMessageListener(u)}}},[t,n,s]),w.useEffect(()=>{if(i==="chrome"&&(t!=null&&t.sendMessage))return t.sendMessage({type:"SIDE_PANEL_MOUNTED"}).catch(()=>{}),()=>{t.sendMessage&&t.sendMessage({type:"SIDE_PANEL_UNMOUNTED"}).catch(()=>{})}},[i,t]),d.jsxs("div",{className:"flex flex-col h-full",children:[r!=="login"&&r!=="Project Documents"&&d.jsx(EK,{}),d.jsx("div",{className:"flex-grow min-h-0",children:d.jsx(_K,{activeSection:r,toggleSection:c})})]})},CK=()=>d.jsx(Zq,{children:d.jsx(SK,{})}),kK=({variant:r})=>{const e=`logo ${r?`logo--${r}`:""}`;return d.jsx("div",{className:e,children:"candle"})},NK=({className:r="",variant:e="badge",showLastChecked:t=!1,hideInLogin:n=!1})=>{const[s,i]=w.useState(!1),{isConnected:c,isLoading:u,error:p,status:m,lastChecked:g,reconnectAttempts:x,wasEverConnected:b,initiateReconnection:E,clearError:T,forceRefresh:S}=Ji(),{platform:N}=ln();if(N!=="chrome"||n)return null;const R=U=>{switch(U){case"connected":return d.jsx(Hc,{className:"h-4 w-4 text-green-600"});case"disconnected":return d.jsx(JR,{className:"h-4 w-4 text-amber-600"});case"loading":return d.jsx(qi,{className:"h-4 w-4 animate-spin text-blue-600"});case"error":return d.jsx(Zf,{className:"h-4 w-4 text-red-600"});default:return d.jsx(Wc,{className:"h-4 w-4 text-gray-400"})}},A=U=>{switch(U){case"connected":return"bg-green-50 border-green-200 text-green-800";case"disconnected":return"bg-amber-50 border-amber-200 text-amber-800";case"loading":return"bg-blue-50 border-blue-200 text-blue-800";case"error":return"bg-red-50 border-red-200 text-red-800";default:return"bg-gray-50 border-gray-200 text-gray-600"}},j=U=>{switch(U){case"connected":return"Gmail Connected";case"disconnected":return"Gmail Disconnected";case"loading":return"Checking Connection...";case"error":return"Connection Error";default:return"Unknown Status"}},P=async()=>{try{await E(),i(!1)}catch(U){console.error("Failed to reconnect Gmail:",U)}},M=async()=>{try{await S()}catch(U){console.error("Failed to refresh connection status:",U)}},B=U=>{if(!U)return"Never checked";const Y=new Date().getTime()-U.getTime(),ce=Math.floor(Y/6e4),X=Math.floor(Y%6e4/1e3);return ce<1?`${X}s ago`:ce<60?`${ce}m ago`:`${Math.floor(ce/60)}h ago`};return e==="minimal"?d.jsxs("div",{className:`flex items-center gap-1 ${r}`,title:j(m),children:[d.jsx("div",{className:"cursor-pointer",title:j(m),"aria-label":j(m),children:R(m)}),!c&&!u&&d.jsx($e,{onClick:P,variant:"ghost",size:"sm",className:"h-6 px-2 text-xs",disabled:u,title:b?"Reconnect to Gmail":"Connect to Gmail",children:b?"Reconnect":"Connect"})]}):e==="full"?d.jsxs("div",{className:`flex items-center justify-between p-3 rounded-lg border ${A(m)} ${r}`,children:[d.jsxs("div",{className:"flex items-center gap-3",children:[R(m),d.jsxs("div",{className:"flex-1",children:[d.jsx("p",{className:"text-sm font-medium",children:j(m)}),p&&d.jsx("p",{className:"text-xs mt-1 opacity-80",children:p}),t&&g&&d.jsxs("p",{className:"text-xs mt-1 opacity-60",children:["Last checked: ",B(g)]})]})]}),d.jsxs("div",{className:"flex items-center gap-2",children:[!c&&!u&&d.jsx($e,{onClick:P,variant:"outline",size:"sm",className:"text-xs",disabled:u,children:u?d.jsxs(d.Fragment,{children:[d.jsx(qi,{className:"h-3 w-3 mr-1 animate-spin"}),"Connecting..."]}):b?"Reconnect Gmail":"Connect Gmail"}),d.jsx($e,{onClick:M,variant:"ghost",size:"sm",className:"p-1",disabled:u,children:d.jsx(Co,{className:`h-3 w-3 ${u?"animate-spin":""}`})}),p&&d.jsx($e,{onClick:T,variant:"ghost",size:"sm",className:"p-1",children:d.jsx(gi,{className:"h-3 w-3"})})]})]}):d.jsxs(Ls,{open:s,onOpenChange:i,children:[d.jsx(Ms,{asChild:!0,children:d.jsxs($e,{variant:"ghost",size:"sm",className:`h-8 px-2 flex items-center gap-2 ${A(m)} border hover:opacity-80 ${r}`,"aria-label":`Gmail connection status: ${j(m)}`,"aria-expanded":s,"aria-haspopup":"menu",children:[R(m),d.jsx("span",{className:"text-xs font-medium",children:j(m)})]})}),d.jsxs(ws,{align:"end",className:"w-80",children:[d.jsxs("div",{className:"p-3",children:[d.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[R(m),d.jsx("span",{className:"font-medium text-sm",children:j(m)})]}),p&&d.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-2 mb-3",children:d.jsx("p",{className:"text-xs text-red-800",children:p})}),d.jsxs("div",{className:"text-xs text-gray-600 mb-3",children:[d.jsxs("p",{children:["Last checked: ",B(g)]}),x>0&&d.jsxs("p",{children:["Reconnect attempts: ",x]})]}),m==="connected"&&d.jsx("div",{className:"bg-green-50 border border-green-200 rounded-md p-2 mb-3",children:d.jsx("p",{className:"text-xs text-green-800",children:"Gmail is connected and working properly. All features are available."})}),m==="disconnected"&&d.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-md p-2 mb-3",children:d.jsx("p",{className:"text-xs text-amber-800",children:b?'Gmail connection lost. Some features may not work properly. Click "Reconnect Gmail" to restore connection.':'Gmail connection required. Some features may not work properly. Click "Connect Gmail" to enable all features.'})})]}),d.jsx(Iy,{}),d.jsxs("div",{className:"p-2",children:[d.jsx(os,{asChild:!0,children:d.jsxs($e,{onClick:M,variant:"ghost",size:"sm",className:"w-full justify-start",disabled:u,children:[d.jsx(Co,{className:`h-4 w-4 mr-2 ${u?"animate-spin":""}`}),"Refresh Status"]})}),!c&&d.jsx(os,{asChild:!0,children:d.jsx($e,{onClick:P,variant:"ghost",size:"sm",className:"w-full justify-start",disabled:u,children:u?d.jsxs(d.Fragment,{children:[d.jsx(qi,{className:"h-4 w-4 mr-2 animate-spin"}),"Connecting..."]}):d.jsxs(d.Fragment,{children:[d.jsx(Wc,{className:"h-4 w-4 mr-2"}),b?"Reconnect Gmail":"Connect Gmail"]})})}),p&&d.jsx(os,{asChild:!0,children:d.jsxs($e,{onClick:T,variant:"ghost",size:"sm",className:"w-full justify-start",children:[d.jsx(gi,{className:"h-4 w-4 mr-2"}),"Clear Error"]})})]})]})]})},TK=({className:r="",variant:e="badge",hideInLogin:t=!1})=>{const{platform:n}=ln();if(n!=="outlook"||t)return null;const s="Outlook Connected";return e==="minimal"?d.jsx("div",{className:`flex items-center gap-1 ${r}`,title:s,children:d.jsx("div",{className:"cursor-pointer",title:s,"aria-label":s,children:d.jsx(Hc,{className:"h-4 w-4 text-green-600"})})}):e==="full"?d.jsx("div",{className:`flex items-center justify-between p-3 rounded-lg border bg-green-50 border-green-200 text-green-800 ${r}`,children:d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx(Hc,{className:"h-4 w-4 text-green-600"}),d.jsx("div",{className:"flex-1",children:d.jsx("p",{className:"text-sm font-medium",children:s})})]})}):d.jsxs("div",{className:`h-8 px-2 flex items-center gap-2 bg-green-50 border-green-200 text-green-800 border rounded ${r}`,children:[d.jsx(Hc,{className:"h-4 w-4 text-green-600"}),d.jsx("span",{className:"text-xs font-medium",children:s})]})},Uf="src/shared/components/sidepanel/mainPanelContent/panelHeader.tsx",RK=r=>d.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",width:"18",height:"18",...r,children:[d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),AK=({className:r})=>{const{activeSection:e,setActiveSection:t}=jT(),n=y8(),s=Ur(),i=async()=>{if(n!=null&&n.openOptionsPage)try{await n.openOptionsPage()}catch(p){s.error("Failed to open options page",p,{sourceFile:Uf})}else s.warn("Options page opening not available on this platform",{sourceFile:Uf})},c=async()=>{if(n!=null&&n.openURL)try{await n.openURL(YN,"_blank")}catch(p){s.error("Failed to open feedback form",p,{sourceFile:Uf})}else s.warn("openURL not available on this platform",{sourceFile:Uf})},u=async()=>{s.info("Logout initiated",{sourceFile:Uf});try{await zy(s),await TU(s),await pT(s),t("login")}catch(p){s.error("Failed to logout",p,{sourceFile:Uf})}};return d.jsxs("div",{className:`relative flex items-center justify-between px-3 py-2 bg-blue-600 border-b border-gray-200 text-gray-100 ${r}`,children:[d.jsxs("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2",children:[d.jsx(NK,{variant:"minimal",className:"text-white border-white/20 hover:bg-white/10",hideInLogin:e==="login"}),d.jsx(TK,{variant:"minimal",className:"text-white border-white/20 hover:bg-white/10",hideInLogin:e==="login"})]}),d.jsx("div",{className:"flex-1 flex justify-center",children:d.jsx(kK,{variant:"panel"})}),d.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:d.jsxs(Ls,{children:[d.jsx(Ms,{asChild:!0,children:d.jsx("button",{className:"p-1 rounded hover:bg-white/10 transition-colors",children:d.jsx(RK,{className:"text-white"})})}),d.jsxs(ws,{align:"end",side:"bottom",sideOffset:5,children:[d.jsx(os,{onClick:i,children:"Configure"}),d.jsx(Iy,{}),d.jsx(os,{onClick:c,children:"Feedback"}),d.jsx(Iy,{}),d.jsx(os,{onClick:u,children:"Logout"})]})]})})]})};function Sw(){try{const r=Office.context.officeTheme;if(console.log(" Outlook Theme Detection:",r),r){const e=r.bodyBackgroundColor;if(console.log(" Background Color:",e),e){const t=e.replace("#",""),n=parseInt(t.substring(0,2),16),s=parseInt(t.substring(2,4),16),i=parseInt(t.substring(4,6),16),c=(n+s+i)/3;console.log(` Brightness: ${c} (R:${n}, G:${s}, B:${i})`),c<128?(console.log(" Dark mode detected - applying dark class"),document.documentElement.classList.add("dark")):(console.log(" Light mode detected - removing dark class"),document.documentElement.classList.remove("dark")),console.log(" HTML classes:",document.documentElement.className)}}else console.warn(" Office theme not available")}catch(r){console.error(" Error detecting Outlook theme:",r)}}Office.onReady(()=>{Sw(),Office.context.mailbox&&Office.context.mailbox.addHandlerAsync(Office.EventType.OfficeThemeChanged,r=>{console.log(" Office theme changed event triggered"),Sw()},r=>{r.status===Office.AsyncResultStatus.Succeeded?console.log(" Office theme change listener added successfully"):console.warn(" Failed to add Office theme change listener:",r.error)}),window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>{console.log(" System color scheme changed:",e.matches?"dark":"light"),Sw()}),GO.createRoot(document.getElementById("root")).render(d.jsx(lr.StrictMode,{children:d.jsx(C5,{children:d.jsx(b8,{children:d.jsx(_8,{children:d.jsx(HH,{children:d.jsxs("div",{className:"sidepanel-container",children:[d.jsx(AK,{className:"sticky top-0 z-50 border-b-0"}),d.jsx(CK,{})]})})})})})}))});export{ed as f,Ly as t};
