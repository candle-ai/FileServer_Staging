const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index.DS5eee3c.js","assets/modulepreload-polyfill.B5Qt9EMX.js"])))=>i.map(i=>d[i]);
var MO=Object.defineProperty;var $O=(r,e,t)=>e in r?MO(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var B=(r,e,t)=>$O(r,typeof e!="symbol"?e+"":e,t);import"./modulepreload-polyfill.B5Qt9EMX.js";function UO(r,e){for(var t=0;t<e.length;t++){const n=e[t];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in r)){const i=Object.getOwnPropertyDescriptor(n,s);i&&Object.defineProperty(r,s,i.get?i:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}))}var xv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function _b(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var ox={exports:{}},Lp={},ix={exports:{}},lr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var iE;function zO(){if(iE)return lr;iE=1;var r=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),c=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),x=Symbol.iterator;function b(O){return O===null||typeof O!="object"?null:(O=x&&O[x]||O["@@iterator"],typeof O=="function"?O:null)}var S={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},N=Object.assign,E={};function T(O,U,re){this.props=O,this.context=U,this.refs=E,this.updater=re||S}T.prototype.isReactComponent={},T.prototype.setState=function(O,U){if(typeof O!="object"&&typeof O!="function"&&O!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,O,U,"setState")},T.prototype.forceUpdate=function(O){this.updater.enqueueForceUpdate(this,O,"forceUpdate")};function A(){}A.prototype=T.prototype;function R(O,U,re){this.props=O,this.context=U,this.refs=E,this.updater=re||S}var F=R.prototype=new A;F.constructor=R,N(F,T.prototype),F.isPureReactComponent=!0;var j=Array.isArray,L=Object.prototype.hasOwnProperty,G={current:null},z={key:!0,ref:!0,__self:!0,__source:!0};function q(O,U,re){var Ee,ne={},we=null,K=null;if(U!=null)for(Ee in U.ref!==void 0&&(K=U.ref),U.key!==void 0&&(we=""+U.key),U)L.call(U,Ee)&&!z.hasOwnProperty(Ee)&&(ne[Ee]=U[Ee]);var he=arguments.length-2;if(he===1)ne.children=re;else if(1<he){for(var be=Array(he),Ie=0;Ie<he;Ie++)be[Ie]=arguments[Ie+2];ne.children=be}if(O&&O.defaultProps)for(Ee in he=O.defaultProps,he)ne[Ee]===void 0&&(ne[Ee]=he[Ee]);return{$$typeof:r,type:O,key:we,ref:K,props:ne,_owner:G.current}}function ae(O,U){return{$$typeof:r,type:O.type,key:U,ref:O.ref,props:O.props,_owner:O._owner}}function oe(O){return typeof O=="object"&&O!==null&&O.$$typeof===r}function fe(O){var U={"=":"=0",":":"=2"};return"$"+O.replace(/[=:]/g,function(re){return U[re]})}var H=/\/+/g;function me(O,U){return typeof O=="object"&&O!==null&&O.key!=null?fe(""+O.key):U.toString(36)}function ee(O,U,re,Ee,ne){var we=typeof O;(we==="undefined"||we==="boolean")&&(O=null);var K=!1;if(O===null)K=!0;else switch(we){case"string":case"number":K=!0;break;case"object":switch(O.$$typeof){case r:case e:K=!0}}if(K)return K=O,ne=ne(K),O=Ee===""?"."+me(K,0):Ee,j(ne)?(re="",O!=null&&(re=O.replace(H,"$&/")+"/"),ee(ne,U,re,"",function(Ie){return Ie})):ne!=null&&(oe(ne)&&(ne=ae(ne,re+(!ne.key||K&&K.key===ne.key?"":(""+ne.key).replace(H,"$&/")+"/")+O)),U.push(ne)),1;if(K=0,Ee=Ee===""?".":Ee+":",j(O))for(var he=0;he<O.length;he++){we=O[he];var be=Ee+me(we,he);K+=ee(we,U,re,be,ne)}else if(be=b(O),typeof be=="function")for(O=be.call(O),he=0;!(we=O.next()).done;)we=we.value,be=Ee+me(we,he++),K+=ee(we,U,re,be,ne);else if(we==="object")throw U=String(O),Error("Objects are not valid as a React child (found: "+(U==="[object Object]"?"object with keys {"+Object.keys(O).join(", ")+"}":U)+"). If you meant to render a collection of children, use an array instead.");return K}function se(O,U,re){if(O==null)return O;var Ee=[],ne=0;return ee(O,Ee,"","",function(we){return U.call(re,we,ne++)}),Ee}function de(O){if(O._status===-1){var U=O._result;U=U(),U.then(function(re){(O._status===0||O._status===-1)&&(O._status=1,O._result=re)},function(re){(O._status===0||O._status===-1)&&(O._status=2,O._result=re)}),O._status===-1&&(O._status=0,O._result=U)}if(O._status===1)return O._result.default;throw O._result}var Y={current:null},J={transition:null},$={ReactCurrentDispatcher:Y,ReactCurrentBatchConfig:J,ReactCurrentOwner:G};function X(){throw Error("act(...) is not supported in production builds of React.")}return lr.Children={map:se,forEach:function(O,U,re){se(O,function(){U.apply(this,arguments)},re)},count:function(O){var U=0;return se(O,function(){U++}),U},toArray:function(O){return se(O,function(U){return U})||[]},only:function(O){if(!oe(O))throw Error("React.Children.only expected to receive a single React element child.");return O}},lr.Component=T,lr.Fragment=t,lr.Profiler=s,lr.PureComponent=R,lr.StrictMode=n,lr.Suspense=m,lr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=$,lr.act=X,lr.cloneElement=function(O,U,re){if(O==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+O+".");var Ee=N({},O.props),ne=O.key,we=O.ref,K=O._owner;if(U!=null){if(U.ref!==void 0&&(we=U.ref,K=G.current),U.key!==void 0&&(ne=""+U.key),O.type&&O.type.defaultProps)var he=O.type.defaultProps;for(be in U)L.call(U,be)&&!z.hasOwnProperty(be)&&(Ee[be]=U[be]===void 0&&he!==void 0?he[be]:U[be])}var be=arguments.length-2;if(be===1)Ee.children=re;else if(1<be){he=Array(be);for(var Ie=0;Ie<be;Ie++)he[Ie]=arguments[Ie+2];Ee.children=he}return{$$typeof:r,type:O.type,key:ne,ref:we,props:Ee,_owner:K}},lr.createContext=function(O){return O={$$typeof:c,_currentValue:O,_currentValue2:O,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},O.Provider={$$typeof:i,_context:O},O.Consumer=O},lr.createElement=q,lr.createFactory=function(O){var U=q.bind(null,O);return U.type=O,U},lr.createRef=function(){return{current:null}},lr.forwardRef=function(O){return{$$typeof:d,render:O}},lr.isValidElement=oe,lr.lazy=function(O){return{$$typeof:v,_payload:{_status:-1,_result:O},_init:de}},lr.memo=function(O,U){return{$$typeof:p,type:O,compare:U===void 0?null:U}},lr.startTransition=function(O){var U=J.transition;J.transition={};try{O()}finally{J.transition=U}},lr.unstable_act=X,lr.useCallback=function(O,U){return Y.current.useCallback(O,U)},lr.useContext=function(O){return Y.current.useContext(O)},lr.useDebugValue=function(){},lr.useDeferredValue=function(O){return Y.current.useDeferredValue(O)},lr.useEffect=function(O,U){return Y.current.useEffect(O,U)},lr.useId=function(){return Y.current.useId()},lr.useImperativeHandle=function(O,U,re){return Y.current.useImperativeHandle(O,U,re)},lr.useInsertionEffect=function(O,U){return Y.current.useInsertionEffect(O,U)},lr.useLayoutEffect=function(O,U){return Y.current.useLayoutEffect(O,U)},lr.useMemo=function(O,U){return Y.current.useMemo(O,U)},lr.useReducer=function(O,U,re){return Y.current.useReducer(O,U,re)},lr.useRef=function(O){return Y.current.useRef(O)},lr.useState=function(O){return Y.current.useState(O)},lr.useSyncExternalStore=function(O,U,re){return Y.current.useSyncExternalStore(O,U,re)},lr.useTransition=function(){return Y.current.useTransition()},lr.version="18.3.1",lr}var aE;function Sb(){return aE||(aE=1,ix.exports=zO()),ix.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lE;function HO(){if(lE)return Lp;lE=1;var r=Sb(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function c(d,m,p){var v,x={},b=null,S=null;p!==void 0&&(b=""+p),m.key!==void 0&&(b=""+m.key),m.ref!==void 0&&(S=m.ref);for(v in m)n.call(m,v)&&!i.hasOwnProperty(v)&&(x[v]=m[v]);if(d&&d.defaultProps)for(v in m=d.defaultProps,m)x[v]===void 0&&(x[v]=m[v]);return{$$typeof:e,type:d,key:b,ref:S,props:x,_owner:s.current}}return Lp.Fragment=t,Lp.jsx=c,Lp.jsxs=c,Lp}var cE;function BO(){return cE||(cE=1,ox.exports=HO()),ox.exports}var u=BO(),w=Sb();const _r=_b(w),Eb=UO({__proto__:null,default:_r},[w]);var wv={},ax={exports:{}},Po={},lx={exports:{}},cx={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uE;function GO(){return uE||(uE=1,(function(r){function e(J,$){var X=J.length;J.push($);e:for(;0<X;){var O=X-1>>>1,U=J[O];if(0<s(U,$))J[O]=$,J[X]=U,X=O;else break e}}function t(J){return J.length===0?null:J[0]}function n(J){if(J.length===0)return null;var $=J[0],X=J.pop();if(X!==$){J[0]=X;e:for(var O=0,U=J.length,re=U>>>1;O<re;){var Ee=2*(O+1)-1,ne=J[Ee],we=Ee+1,K=J[we];if(0>s(ne,X))we<U&&0>s(K,ne)?(J[O]=K,J[we]=X,O=we):(J[O]=ne,J[Ee]=X,O=Ee);else if(we<U&&0>s(K,X))J[O]=K,J[we]=X,O=we;else break e}}return $}function s(J,$){var X=J.sortIndex-$.sortIndex;return X!==0?X:J.id-$.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;r.unstable_now=function(){return i.now()}}else{var c=Date,d=c.now();r.unstable_now=function(){return c.now()-d}}var m=[],p=[],v=1,x=null,b=3,S=!1,N=!1,E=!1,T=typeof setTimeout=="function"?setTimeout:null,A=typeof clearTimeout=="function"?clearTimeout:null,R=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function F(J){for(var $=t(p);$!==null;){if($.callback===null)n(p);else if($.startTime<=J)n(p),$.sortIndex=$.expirationTime,e(m,$);else break;$=t(p)}}function j(J){if(E=!1,F(J),!N)if(t(m)!==null)N=!0,de(L);else{var $=t(p);$!==null&&Y(j,$.startTime-J)}}function L(J,$){N=!1,E&&(E=!1,A(q),q=-1),S=!0;var X=b;try{for(F($),x=t(m);x!==null&&(!(x.expirationTime>$)||J&&!fe());){var O=x.callback;if(typeof O=="function"){x.callback=null,b=x.priorityLevel;var U=O(x.expirationTime<=$);$=r.unstable_now(),typeof U=="function"?x.callback=U:x===t(m)&&n(m),F($)}else n(m);x=t(m)}if(x!==null)var re=!0;else{var Ee=t(p);Ee!==null&&Y(j,Ee.startTime-$),re=!1}return re}finally{x=null,b=X,S=!1}}var G=!1,z=null,q=-1,ae=5,oe=-1;function fe(){return!(r.unstable_now()-oe<ae)}function H(){if(z!==null){var J=r.unstable_now();oe=J;var $=!0;try{$=z(!0,J)}finally{$?me():(G=!1,z=null)}}else G=!1}var me;if(typeof R=="function")me=function(){R(H)};else if(typeof MessageChannel<"u"){var ee=new MessageChannel,se=ee.port2;ee.port1.onmessage=H,me=function(){se.postMessage(null)}}else me=function(){T(H,0)};function de(J){z=J,G||(G=!0,me())}function Y(J,$){q=T(function(){J(r.unstable_now())},$)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(J){J.callback=null},r.unstable_continueExecution=function(){N||S||(N=!0,de(L))},r.unstable_forceFrameRate=function(J){0>J||125<J?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ae=0<J?Math.floor(1e3/J):5},r.unstable_getCurrentPriorityLevel=function(){return b},r.unstable_getFirstCallbackNode=function(){return t(m)},r.unstable_next=function(J){switch(b){case 1:case 2:case 3:var $=3;break;default:$=b}var X=b;b=$;try{return J()}finally{b=X}},r.unstable_pauseExecution=function(){},r.unstable_requestPaint=function(){},r.unstable_runWithPriority=function(J,$){switch(J){case 1:case 2:case 3:case 4:case 5:break;default:J=3}var X=b;b=J;try{return $()}finally{b=X}},r.unstable_scheduleCallback=function(J,$,X){var O=r.unstable_now();switch(typeof X=="object"&&X!==null?(X=X.delay,X=typeof X=="number"&&0<X?O+X:O):X=O,J){case 1:var U=-1;break;case 2:U=250;break;case 5:U=1073741823;break;case 4:U=1e4;break;default:U=5e3}return U=X+U,J={id:v++,callback:$,priorityLevel:J,startTime:X,expirationTime:U,sortIndex:-1},X>O?(J.sortIndex=X,e(p,J),t(m)===null&&J===t(p)&&(E?(A(q),q=-1):E=!0,Y(j,X-O))):(J.sortIndex=U,e(m,J),N||S||(N=!0,de(L))),J},r.unstable_shouldYield=fe,r.unstable_wrapCallback=function(J){var $=b;return function(){var X=b;b=$;try{return J.apply(this,arguments)}finally{b=X}}}})(cx)),cx}var dE;function WO(){return dE||(dE=1,lx.exports=GO()),lx.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fE;function VO(){if(fE)return Po;fE=1;var r=Sb(),e=WO();function t(o){for(var a="https://reactjs.org/docs/error-decoder.html?invariant="+o,h=1;h<arguments.length;h++)a+="&args[]="+encodeURIComponent(arguments[h]);return"Minified React error #"+o+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,s={};function i(o,a){c(o,a),c(o+"Capture",a)}function c(o,a){for(s[o]=a,o=0;o<a.length;o++)n.add(a[o])}var d=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),m=Object.prototype.hasOwnProperty,p=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,v={},x={};function b(o){return m.call(x,o)?!0:m.call(v,o)?!1:p.test(o)?x[o]=!0:(v[o]=!0,!1)}function S(o,a,h,g){if(h!==null&&h.type===0)return!1;switch(typeof a){case"function":case"symbol":return!0;case"boolean":return g?!1:h!==null?!h.acceptsBooleans:(o=o.toLowerCase().slice(0,5),o!=="data-"&&o!=="aria-");default:return!1}}function N(o,a,h,g){if(a===null||typeof a>"u"||S(o,a,h,g))return!0;if(g)return!1;if(h!==null)switch(h.type){case 3:return!a;case 4:return a===!1;case 5:return isNaN(a);case 6:return isNaN(a)||1>a}return!1}function E(o,a,h,g,_,k,P){this.acceptsBooleans=a===2||a===3||a===4,this.attributeName=g,this.attributeNamespace=_,this.mustUseProperty=h,this.propertyName=o,this.type=a,this.sanitizeURL=k,this.removeEmptyString=P}var T={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(o){T[o]=new E(o,0,!1,o,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(o){var a=o[0];T[a]=new E(a,1,!1,o[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(o){T[o]=new E(o,2,!1,o.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(o){T[o]=new E(o,2,!1,o,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(o){T[o]=new E(o,3,!1,o.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(o){T[o]=new E(o,3,!0,o,null,!1,!1)}),["capture","download"].forEach(function(o){T[o]=new E(o,4,!1,o,null,!1,!1)}),["cols","rows","size","span"].forEach(function(o){T[o]=new E(o,6,!1,o,null,!1,!1)}),["rowSpan","start"].forEach(function(o){T[o]=new E(o,5,!1,o.toLowerCase(),null,!1,!1)});var A=/[\-:]([a-z])/g;function R(o){return o[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(o){var a=o.replace(A,R);T[a]=new E(a,1,!1,o,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(o){var a=o.replace(A,R);T[a]=new E(a,1,!1,o,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(o){var a=o.replace(A,R);T[a]=new E(a,1,!1,o,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(o){T[o]=new E(o,1,!1,o.toLowerCase(),null,!1,!1)}),T.xlinkHref=new E("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(o){T[o]=new E(o,1,!1,o.toLowerCase(),null,!0,!0)});function F(o,a,h,g){var _=T.hasOwnProperty(a)?T[a]:null;(_!==null?_.type!==0:g||!(2<a.length)||a[0]!=="o"&&a[0]!=="O"||a[1]!=="n"&&a[1]!=="N")&&(N(a,h,_,g)&&(h=null),g||_===null?b(a)&&(h===null?o.removeAttribute(a):o.setAttribute(a,""+h)):_.mustUseProperty?o[_.propertyName]=h===null?_.type===3?!1:"":h:(a=_.attributeName,g=_.attributeNamespace,h===null?o.removeAttribute(a):(_=_.type,h=_===3||_===4&&h===!0?"":""+h,g?o.setAttributeNS(g,a,h):o.setAttribute(a,h))))}var j=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,L=Symbol.for("react.element"),G=Symbol.for("react.portal"),z=Symbol.for("react.fragment"),q=Symbol.for("react.strict_mode"),ae=Symbol.for("react.profiler"),oe=Symbol.for("react.provider"),fe=Symbol.for("react.context"),H=Symbol.for("react.forward_ref"),me=Symbol.for("react.suspense"),ee=Symbol.for("react.suspense_list"),se=Symbol.for("react.memo"),de=Symbol.for("react.lazy"),Y=Symbol.for("react.offscreen"),J=Symbol.iterator;function $(o){return o===null||typeof o!="object"?null:(o=J&&o[J]||o["@@iterator"],typeof o=="function"?o:null)}var X=Object.assign,O;function U(o){if(O===void 0)try{throw Error()}catch(h){var a=h.stack.trim().match(/\n( *(at )?)/);O=a&&a[1]||""}return`
`+O+o}var re=!1;function Ee(o,a){if(!o||re)return"";re=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(a)if(a=function(){throw Error()},Object.defineProperty(a.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(a,[])}catch(xe){var g=xe}Reflect.construct(o,[],a)}else{try{a.call()}catch(xe){g=xe}o.call(a.prototype)}else{try{throw Error()}catch(xe){g=xe}o()}}catch(xe){if(xe&&g&&typeof xe.stack=="string"){for(var _=xe.stack.split(`
`),k=g.stack.split(`
`),P=_.length-1,W=k.length-1;1<=P&&0<=W&&_[P]!==k[W];)W--;for(;1<=P&&0<=W;P--,W--)if(_[P]!==k[W]){if(P!==1||W!==1)do if(P--,W--,0>W||_[P]!==k[W]){var Z=`
`+_[P].replace(" at new "," at ");return o.displayName&&Z.includes("<anonymous>")&&(Z=Z.replace("<anonymous>",o.displayName)),Z}while(1<=P&&0<=W);break}}}finally{re=!1,Error.prepareStackTrace=h}return(o=o?o.displayName||o.name:"")?U(o):""}function ne(o){switch(o.tag){case 5:return U(o.type);case 16:return U("Lazy");case 13:return U("Suspense");case 19:return U("SuspenseList");case 0:case 2:case 15:return o=Ee(o.type,!1),o;case 11:return o=Ee(o.type.render,!1),o;case 1:return o=Ee(o.type,!0),o;default:return""}}function we(o){if(o==null)return null;if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o;switch(o){case z:return"Fragment";case G:return"Portal";case ae:return"Profiler";case q:return"StrictMode";case me:return"Suspense";case ee:return"SuspenseList"}if(typeof o=="object")switch(o.$$typeof){case fe:return(o.displayName||"Context")+".Consumer";case oe:return(o._context.displayName||"Context")+".Provider";case H:var a=o.render;return o=o.displayName,o||(o=a.displayName||a.name||"",o=o!==""?"ForwardRef("+o+")":"ForwardRef"),o;case se:return a=o.displayName||null,a!==null?a:we(o.type)||"Memo";case de:a=o._payload,o=o._init;try{return we(o(a))}catch{}}return null}function K(o){var a=o.type;switch(o.tag){case 24:return"Cache";case 9:return(a.displayName||"Context")+".Consumer";case 10:return(a._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return o=a.render,o=o.displayName||o.name||"",a.displayName||(o!==""?"ForwardRef("+o+")":"ForwardRef");case 7:return"Fragment";case 5:return a;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return we(a);case 8:return a===q?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a}return null}function he(o){switch(typeof o){case"boolean":case"number":case"string":case"undefined":return o;case"object":return o;default:return""}}function be(o){var a=o.type;return(o=o.nodeName)&&o.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function Ie(o){var a=be(o)?"checked":"value",h=Object.getOwnPropertyDescriptor(o.constructor.prototype,a),g=""+o[a];if(!o.hasOwnProperty(a)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var _=h.get,k=h.set;return Object.defineProperty(o,a,{configurable:!0,get:function(){return _.call(this)},set:function(P){g=""+P,k.call(this,P)}}),Object.defineProperty(o,a,{enumerable:h.enumerable}),{getValue:function(){return g},setValue:function(P){g=""+P},stopTracking:function(){o._valueTracker=null,delete o[a]}}}}function _t(o){o._valueTracker||(o._valueTracker=Ie(o))}function Be(o){if(!o)return!1;var a=o._valueTracker;if(!a)return!0;var h=a.getValue(),g="";return o&&(g=be(o)?o.checked?"true":"false":o.value),o=g,o!==h?(a.setValue(o),!0):!1}function Ge(o){if(o=o||(typeof document<"u"?document:void 0),typeof o>"u")return null;try{return o.activeElement||o.body}catch{return o.body}}function qe(o,a){var h=a.checked;return X({},a,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:h??o._wrapperState.initialChecked})}function Ne(o,a){var h=a.defaultValue==null?"":a.defaultValue,g=a.checked!=null?a.checked:a.defaultChecked;h=he(a.value!=null?a.value:h),o._wrapperState={initialChecked:g,initialValue:h,controlled:a.type==="checkbox"||a.type==="radio"?a.checked!=null:a.value!=null}}function St(o,a){a=a.checked,a!=null&&F(o,"checked",a,!1)}function ct(o,a){St(o,a);var h=he(a.value),g=a.type;if(h!=null)g==="number"?(h===0&&o.value===""||o.value!=h)&&(o.value=""+h):o.value!==""+h&&(o.value=""+h);else if(g==="submit"||g==="reset"){o.removeAttribute("value");return}a.hasOwnProperty("value")?Gt(o,a.type,h):a.hasOwnProperty("defaultValue")&&Gt(o,a.type,he(a.defaultValue)),a.checked==null&&a.defaultChecked!=null&&(o.defaultChecked=!!a.defaultChecked)}function Ct(o,a,h){if(a.hasOwnProperty("value")||a.hasOwnProperty("defaultValue")){var g=a.type;if(!(g!=="submit"&&g!=="reset"||a.value!==void 0&&a.value!==null))return;a=""+o._wrapperState.initialValue,h||a===o.value||(o.value=a),o.defaultValue=a}h=o.name,h!==""&&(o.name=""),o.defaultChecked=!!o._wrapperState.initialChecked,h!==""&&(o.name=h)}function Gt(o,a,h){(a!=="number"||Ge(o.ownerDocument)!==o)&&(h==null?o.defaultValue=""+o._wrapperState.initialValue:o.defaultValue!==""+h&&(o.defaultValue=""+h))}var $t=Array.isArray;function Kt(o,a,h,g){if(o=o.options,a){a={};for(var _=0;_<h.length;_++)a["$"+h[_]]=!0;for(h=0;h<o.length;h++)_=a.hasOwnProperty("$"+o[h].value),o[h].selected!==_&&(o[h].selected=_),_&&g&&(o[h].defaultSelected=!0)}else{for(h=""+he(h),a=null,_=0;_<o.length;_++){if(o[_].value===h){o[_].selected=!0,g&&(o[_].defaultSelected=!0);return}a!==null||o[_].disabled||(a=o[_])}a!==null&&(a.selected=!0)}}function hr(o,a){if(a.dangerouslySetInnerHTML!=null)throw Error(t(91));return X({},a,{value:void 0,defaultValue:void 0,children:""+o._wrapperState.initialValue})}function Ur(o,a){var h=a.value;if(h==null){if(h=a.children,a=a.defaultValue,h!=null){if(a!=null)throw Error(t(92));if($t(h)){if(1<h.length)throw Error(t(93));h=h[0]}a=h}a==null&&(a=""),h=a}o._wrapperState={initialValue:he(h)}}function zr(o,a){var h=he(a.value),g=he(a.defaultValue);h!=null&&(h=""+h,h!==o.value&&(o.value=h),a.defaultValue==null&&o.defaultValue!==h&&(o.defaultValue=h)),g!=null&&(o.defaultValue=""+g)}function kr(o){var a=o.textContent;a===o._wrapperState.initialValue&&a!==""&&a!==null&&(o.value=a)}function ge(o){switch(o){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Pe(o,a){return o==null||o==="http://www.w3.org/1999/xhtml"?ge(a):o==="http://www.w3.org/2000/svg"&&a==="foreignObject"?"http://www.w3.org/1999/xhtml":o}var pt,wt=(function(o){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(a,h,g,_){MSApp.execUnsafeLocalFunction(function(){return o(a,h,g,_)})}:o})(function(o,a){if(o.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in o)o.innerHTML=a;else{for(pt=pt||document.createElement("div"),pt.innerHTML="<svg>"+a.valueOf().toString()+"</svg>",a=pt.firstChild;o.firstChild;)o.removeChild(o.firstChild);for(;a.firstChild;)o.appendChild(a.firstChild)}});function ze(o,a){if(a){var h=o.firstChild;if(h&&h===o.lastChild&&h.nodeType===3){h.nodeValue=a;return}}o.textContent=a}var He={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},rt=["Webkit","ms","Moz","O"];Object.keys(He).forEach(function(o){rt.forEach(function(a){a=a+o.charAt(0).toUpperCase()+o.substring(1),He[a]=He[o]})});function Re(o,a,h){return a==null||typeof a=="boolean"||a===""?"":h||typeof a!="number"||a===0||He.hasOwnProperty(o)&&He[o]?(""+a).trim():a+"px"}function ft(o,a){o=o.style;for(var h in a)if(a.hasOwnProperty(h)){var g=h.indexOf("--")===0,_=Re(h,a[h],g);h==="float"&&(h="cssFloat"),g?o.setProperty(h,_):o[h]=_}}var Mt=X({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ue(o,a){if(a){if(Mt[o]&&(a.children!=null||a.dangerouslySetInnerHTML!=null))throw Error(t(137,o));if(a.dangerouslySetInnerHTML!=null){if(a.children!=null)throw Error(t(60));if(typeof a.dangerouslySetInnerHTML!="object"||!("__html"in a.dangerouslySetInnerHTML))throw Error(t(61))}if(a.style!=null&&typeof a.style!="object")throw Error(t(62))}}function rr(o,a){if(o.indexOf("-")===-1)return typeof a.is=="string";switch(o){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var kt=null;function vr(o){return o=o.target||o.srcElement||window,o.correspondingUseElement&&(o=o.correspondingUseElement),o.nodeType===3?o.parentNode:o}var nr=null,Jt=null,$n=null;function Un(o){if(o=es(o)){if(typeof nr!="function")throw Error(t(280));var a=o.stateNode;a&&(a=Ud(a),nr(o.stateNode,o.type,a))}}function Gs(o){Jt?$n?$n.push(o):$n=[o]:Jt=o}function Cs(){if(Jt){var o=Jt,a=$n;if($n=Jt=null,Un(o),a)for(o=0;o<a.length;o++)Un(a[o])}}function Tr(o,a){return o(a)}function yn(){}var go=!1;function Mo(o,a,h){if(go)return o(a,h);go=!0;try{return Tr(o,a,h)}finally{go=!1,(Jt!==null||$n!==null)&&(yn(),Cs())}}function En(o,a){var h=o.stateNode;if(h===null)return null;var g=Ud(h);if(g===null)return null;h=g[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(g=!g.disabled)||(o=o.type,g=!(o==="button"||o==="input"||o==="select"||o==="textarea")),o=!g;break e;default:o=!1}if(o)return null;if(h&&typeof h!="function")throw Error(t(231,a,typeof h));return h}var Ws=!1;if(d)try{var Vs={};Object.defineProperty(Vs,"passive",{get:function(){Ws=!0}}),window.addEventListener("test",Vs,Vs),window.removeEventListener("test",Vs,Vs)}catch{Ws=!1}function Li(o,a,h,g,_,k,P,W,Z){var xe=Array.prototype.slice.call(arguments,3);try{a.apply(h,xe)}catch(je){this.onError(je)}}var cn=!1,ce=null,Ve=!1,gt=null,mt={onError:function(o){cn=!0,ce=o}};function ut(o,a,h,g,_,k,P,W,Z){cn=!1,ce=null,Li.apply(mt,arguments)}function yt(o,a,h,g,_,k,P,W,Z){if(ut.apply(this,arguments),cn){if(cn){var xe=ce;cn=!1,ce=null}else throw Error(t(198));Ve||(Ve=!0,gt=xe)}}function ht(o){var a=o,h=o;if(o.alternate)for(;a.return;)a=a.return;else{o=a;do a=o,(a.flags&4098)!==0&&(h=a.return),o=a.return;while(o)}return a.tag===3?h:null}function Xt(o){if(o.tag===13){var a=o.memoizedState;if(a===null&&(o=o.alternate,o!==null&&(a=o.memoizedState)),a!==null)return a.dehydrated}return null}function Yn(o){if(ht(o)!==o)throw Error(t(188))}function Qr(o){var a=o.alternate;if(!a){if(a=ht(o),a===null)throw Error(t(188));return a!==o?null:o}for(var h=o,g=a;;){var _=h.return;if(_===null)break;var k=_.alternate;if(k===null){if(g=_.return,g!==null){h=g;continue}break}if(_.child===k.child){for(k=_.child;k;){if(k===h)return Yn(_),o;if(k===g)return Yn(_),a;k=k.sibling}throw Error(t(188))}if(h.return!==g.return)h=_,g=k;else{for(var P=!1,W=_.child;W;){if(W===h){P=!0,h=_,g=k;break}if(W===g){P=!0,g=_,h=k;break}W=W.sibling}if(!P){for(W=k.child;W;){if(W===h){P=!0,h=k,g=_;break}if(W===g){P=!0,g=k,h=_;break}W=W.sibling}if(!P)throw Error(t(189))}}if(h.alternate!==g)throw Error(t(190))}if(h.tag!==3)throw Error(t(188));return h.stateNode.current===h?o:a}function ur(o){return o=Qr(o),o!==null?at(o):null}function at(o){if(o.tag===5||o.tag===6)return o;for(o=o.child;o!==null;){var a=at(o);if(a!==null)return a;o=o.sibling}return null}var Q=e.unstable_scheduleCallback,Le=e.unstable_cancelCallback,nt=e.unstable_shouldYield,Fr=e.unstable_requestPaint,Yt=e.unstable_now,Wr=e.unstable_getCurrentPriorityLevel,fn=e.unstable_ImmediatePriority,ls=e.unstable_UserBlockingPriority,ks=e.unstable_NormalPriority,Mi=e.unstable_LowPriority,Vr=e.unstable_IdlePriority,$o=null,Jn=null;function nu(o){if(Jn&&typeof Jn.onCommitFiberRoot=="function")try{Jn.onCommitFiberRoot($o,o,void 0,(o.current.flags&128)===128)}catch{}}var Ns=Math.clz32?Math.clz32:ou,ma=Math.log,su=Math.LN2;function ou(o){return o>>>=0,o===0?32:31-(ma(o)/su|0)|0}var li=64,ci=4194304;function qs(o){switch(o&-o){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return o&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return o}}function Ks(o,a){var h=o.pendingLanes;if(h===0)return 0;var g=0,_=o.suspendedLanes,k=o.pingedLanes,P=h&268435455;if(P!==0){var W=P&~_;W!==0?g=qs(W):(k&=P,k!==0&&(g=qs(k)))}else P=h&~_,P!==0?g=qs(P):k!==0&&(g=qs(k));if(g===0)return 0;if(a!==0&&a!==g&&(a&_)===0&&(_=g&-g,k=a&-a,_>=k||_===16&&(k&4194240)!==0))return a;if((g&4)!==0&&(g|=h&16),a=o.entangledLanes,a!==0)for(o=o.entanglements,a&=g;0<a;)h=31-Ns(a),_=1<<h,g|=o[h],a&=~_;return g}function iu(o,a){switch(o){case 1:case 2:case 4:return a+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Sh(o,a){for(var h=o.suspendedLanes,g=o.pingedLanes,_=o.expirationTimes,k=o.pendingLanes;0<k;){var P=31-Ns(k),W=1<<P,Z=_[P];Z===-1?((W&h)===0||(W&g)!==0)&&(_[P]=iu(W,a)):Z<=a&&(o.expiredLanes|=W),k&=~W}}function Zl(o){return o=o.pendingLanes&-1073741825,o!==0?o:o&1073741824?1073741824:0}function au(){var o=li;return li<<=1,(li&4194240)===0&&(li=64),o}function tl(o){for(var a=[],h=0;31>h;h++)a.push(o);return a}function rl(o,a,h){o.pendingLanes|=a,a!==536870912&&(o.suspendedLanes=0,o.pingedLanes=0),o=o.eventTimes,a=31-Ns(a),o[a]=h}function vd(o,a){var h=o.pendingLanes&~a;o.pendingLanes=a,o.suspendedLanes=0,o.pingedLanes=0,o.expiredLanes&=a,o.mutableReadLanes&=a,o.entangledLanes&=a,a=o.entanglements;var g=o.eventTimes;for(o=o.expirationTimes;0<h;){var _=31-Ns(h),k=1<<_;a[_]=0,g[_]=-1,o[_]=-1,h&=~k}}function nl(o,a){var h=o.entangledLanes|=a;for(o=o.entanglements;h;){var g=31-Ns(h),_=1<<g;_&a|o[g]&a&&(o[g]|=a),h&=~_}}var yr=0;function Ys(o){return o&=-o,1<o?4<o?(o&268435455)!==0?16:536870912:4:1}var sl,ec,lu,cu,uu,tc=!1,ol=[],ui=null,di=null,Uo=null,$i=new Map,_e=new Map,Me=[],Ke="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function At(o,a){switch(o){case"focusin":case"focusout":ui=null;break;case"dragenter":case"dragleave":di=null;break;case"mouseover":case"mouseout":Uo=null;break;case"pointerover":case"pointerout":$i.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":_e.delete(a.pointerId)}}function Nt(o,a,h,g,_,k){return o===null||o.nativeEvent!==k?(o={blockedOn:a,domEventName:h,eventSystemFlags:g,nativeEvent:k,targetContainers:[_]},a!==null&&(a=es(a),a!==null&&ec(a)),o):(o.eventSystemFlags|=g,a=o.targetContainers,_!==null&&a.indexOf(_)===-1&&a.push(_),o)}function Ut(o,a,h,g,_){switch(a){case"focusin":return ui=Nt(ui,o,a,h,g,_),!0;case"dragenter":return di=Nt(di,o,a,h,g,_),!0;case"mouseover":return Uo=Nt(Uo,o,a,h,g,_),!0;case"pointerover":var k=_.pointerId;return $i.set(k,Nt($i.get(k)||null,o,a,h,g,_)),!0;case"gotpointercapture":return k=_.pointerId,_e.set(k,Nt(_e.get(k)||null,o,a,h,g,_)),!0}return!1}function st(o){var a=mi(o.target);if(a!==null){var h=ht(a);if(h!==null){if(a=h.tag,a===13){if(a=Xt(h),a!==null){o.blockedOn=a,uu(o.priority,function(){lu(h)});return}}else if(a===3&&h.stateNode.current.memoizedState.isDehydrated){o.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}o.blockedOn=null}function it(o){if(o.blockedOn!==null)return!1;for(var a=o.targetContainers;0<a.length;){var h=bd(o.domEventName,o.eventSystemFlags,a[0],o.nativeEvent);if(h===null){h=o.nativeEvent;var g=new h.constructor(h.type,h);kt=g,h.target.dispatchEvent(g),kt=null}else return a=es(h),a!==null&&ec(a),o.blockedOn=h,!1;a.shift()}return!0}function Xn(o,a,h){it(o)&&h.delete(a)}function Js(){tc=!1,ui!==null&&it(ui)&&(ui=null),di!==null&&it(di)&&(di=null),Uo!==null&&it(Uo)&&(Uo=null),$i.forEach(Xn),_e.forEach(Xn)}function Sr(o,a){o.blockedOn===a&&(o.blockedOn=null,tc||(tc=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Js)))}function Qt(o){function a(_){return Sr(_,o)}if(0<ol.length){Sr(ol[0],o);for(var h=1;h<ol.length;h++){var g=ol[h];g.blockedOn===o&&(g.blockedOn=null)}}for(ui!==null&&Sr(ui,o),di!==null&&Sr(di,o),Uo!==null&&Sr(Uo,o),$i.forEach(a),_e.forEach(a),h=0;h<Me.length;h++)g=Me[h],g.blockedOn===o&&(g.blockedOn=null);for(;0<Me.length&&(h=Me[0],h.blockedOn===null);)st(h),h.blockedOn===null&&Me.shift()}var ga=j.ReactCurrentBatchConfig,Ui=!0;function yd(o,a,h,g){var _=yr,k=ga.transition;ga.transition=null;try{yr=1,il(o,a,h,g)}finally{yr=_,ga.transition=k}}function xd(o,a,h,g){var _=yr,k=ga.transition;ga.transition=null;try{yr=4,il(o,a,h,g)}finally{yr=_,ga.transition=k}}function il(o,a,h,g){if(Ui){var _=bd(o,a,h,g);if(_===null)Uh(o,a,g,wd,h),At(o,g);else if(Ut(_,o,a,h,g))g.stopPropagation();else if(At(o,g),a&4&&-1<Ke.indexOf(o)){for(;_!==null;){var k=es(_);if(k!==null&&sl(k),k=bd(o,a,h,g),k===null&&Uh(o,a,g,wd,h),k===_)break;_=k}_!==null&&g.stopPropagation()}else Uh(o,a,g,null,h)}}var wd=null;function bd(o,a,h,g){if(wd=null,o=vr(g),o=mi(o),o!==null)if(a=ht(o),a===null)o=null;else if(h=a.tag,h===13){if(o=Xt(a),o!==null)return o;o=null}else if(h===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;o=null}else a!==o&&(o=null);return wd=o,null}function ag(o){switch(o){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Wr()){case fn:return 1;case ls:return 4;case ks:case Mi:return 16;case Vr:return 536870912;default:return 16}default:return 16}}var Zr=null,du=null,fi=null;function Eh(){if(fi)return fi;var o,a=du,h=a.length,g,_="value"in Zr?Zr.value:Zr.textContent,k=_.length;for(o=0;o<h&&a[o]===_[o];o++);var P=h-o;for(g=1;g<=P&&a[h-g]===_[k-g];g++);return fi=_.slice(o,1<g?1-g:void 0)}function rc(o){var a=o.keyCode;return"charCode"in o?(o=o.charCode,o===0&&a===13&&(o=13)):o=a,o===10&&(o=13),32<=o||o===13?o:0}function cs(){return!0}function Ch(){return!1}function Ts(o){function a(h,g,_,k,P){this._reactName=h,this._targetInst=_,this.type=g,this.nativeEvent=k,this.target=P,this.currentTarget=null;for(var W in o)o.hasOwnProperty(W)&&(h=o[W],this[W]=h?h(k):k[W]);return this.isDefaultPrevented=(k.defaultPrevented!=null?k.defaultPrevented:k.returnValue===!1)?cs:Ch,this.isPropagationStopped=Ch,this}return X(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=cs)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=cs)},persist:function(){},isPersistent:cs}),a}var al={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(o){return o.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},_d=Ts(al),nc=X({},al,{view:0,detail:0}),lg=Ts(nc),us,kh,Qn,Sd=X({},nc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ih,button:0,buttons:0,relatedTarget:function(o){return o.relatedTarget===void 0?o.fromElement===o.srcElement?o.toElement:o.fromElement:o.relatedTarget},movementX:function(o){return"movementX"in o?o.movementX:(o!==Qn&&(Qn&&o.type==="mousemove"?(us=o.screenX-Qn.screenX,kh=o.screenY-Qn.screenY):kh=us=0,Qn=o),us)},movementY:function(o){return"movementY"in o?o.movementY:kh}}),Nh=Ts(Sd),va=X({},Sd,{dataTransfer:0}),Ed=Ts(va),Th=X({},nc,{relatedTarget:0}),Hr=Ts(Th),ya=X({},al,{animationName:0,elapsedTime:0,pseudoElement:0}),Ah=Ts(ya),p0=X({},al,{clipboardData:function(o){return"clipboardData"in o?o.clipboardData:window.clipboardData}}),Rh=Ts(p0),m0=X({},al,{data:0}),cg=Ts(m0),g0={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ug={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Cd={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function sc(o){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(o):(o=Cd[o])?!!a[o]:!1}function Ih(){return sc}var dg=X({},nc,{key:function(o){if(o.key){var a=g0[o.key]||o.key;if(a!=="Unidentified")return a}return o.type==="keypress"?(o=rc(o),o===13?"Enter":String.fromCharCode(o)):o.type==="keydown"||o.type==="keyup"?ug[o.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ih,charCode:function(o){return o.type==="keypress"?rc(o):0},keyCode:function(o){return o.type==="keydown"||o.type==="keyup"?o.keyCode:0},which:function(o){return o.type==="keypress"?rc(o):o.type==="keydown"||o.type==="keyup"?o.keyCode:0}}),fg=Ts(dg),Ph=X({},Sd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),kd=Ts(Ph),hg=X({},nc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ih}),v0=Ts(hg),Fh=X({},al,{propertyName:0,elapsedTime:0,pseudoElement:0}),jh=Ts(Fh),y0=X({},Sd,{deltaX:function(o){return"deltaX"in o?o.deltaX:"wheelDeltaX"in o?-o.wheelDeltaX:0},deltaY:function(o){return"deltaY"in o?o.deltaY:"wheelDeltaY"in o?-o.wheelDeltaY:"wheelDelta"in o?-o.wheelDelta:0},deltaZ:0,deltaMode:0}),pg=Ts(y0),Xs=[9,13,27,32],fu=d&&"CompositionEvent"in window,zi=null;d&&"documentMode"in document&&(zi=document.documentMode);var mg=d&&"TextEvent"in window&&!zi,Oh=d&&(!fu||zi&&8<zi&&11>=zi),gg=" ",vg=!1;function yg(o,a){switch(o){case"keyup":return Xs.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function xg(o){return o=o.detail,typeof o=="object"&&"data"in o?o.data:null}var oc=!1;function ic(o,a){switch(o){case"compositionend":return xg(a);case"keypress":return a.which!==32?null:(vg=!0,gg);case"textInput":return o=a.data,o===gg&&vg?null:o;default:return null}}function x0(o,a){if(oc)return o==="compositionend"||!fu&&yg(o,a)?(o=Eh(),fi=du=Zr=null,oc=!1,o):null;switch(o){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return Oh&&a.locale!=="ko"?null:a.data;default:return null}}var w0={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Nd(o){var a=o&&o.nodeName&&o.nodeName.toLowerCase();return a==="input"?!!w0[o.type]:a==="textarea"}function Dh(o,a,h,g){Gs(g),a=Dd(a,"onChange"),0<a.length&&(h=new _d("onChange","change",null,h,g),o.push({event:h,listeners:a}))}var vo=null,xa=null;function b0(o){kg(o,0)}function Td(o){var a=Zt(o);if(Be(a))return o}function _0(o,a){if(o==="change")return a}var ll=!1;if(d){var Qs;if(d){var Ad="oninput"in document;if(!Ad){var wg=document.createElement("div");wg.setAttribute("oninput","return;"),Ad=typeof wg.oninput=="function"}Qs=Ad}else Qs=!1;ll=Qs&&(!document.documentMode||9<document.documentMode)}function bg(){vo&&(vo.detachEvent("onpropertychange",_g),xa=vo=null)}function _g(o){if(o.propertyName==="value"&&Td(xa)){var a=[];Dh(a,xa,o,vr(o)),Mo(b0,a)}}function S0(o,a,h){o==="focusin"?(bg(),vo=a,xa=h,vo.attachEvent("onpropertychange",_g)):o==="focusout"&&bg()}function E0(o){if(o==="selectionchange"||o==="keyup"||o==="keydown")return Td(xa)}function ac(o,a){if(o==="click")return Td(a)}function le(o,a){if(o==="input"||o==="change")return Td(a)}function Ce(o,a){return o===a&&(o!==0||1/o===1/a)||o!==o&&a!==a}var ye=typeof Object.is=="function"?Object.is:Ce;function Qe(o,a){if(ye(o,a))return!0;if(typeof o!="object"||o===null||typeof a!="object"||a===null)return!1;var h=Object.keys(o),g=Object.keys(a);if(h.length!==g.length)return!1;for(g=0;g<h.length;g++){var _=h[g];if(!m.call(a,_)||!ye(o[_],a[_]))return!1}return!0}function Wt(o){for(;o&&o.firstChild;)o=o.firstChild;return o}function Er(o,a){var h=Wt(o);o=0;for(var g;h;){if(h.nodeType===3){if(g=o+h.textContent.length,o<=a&&g>=a)return{node:h,offset:a-o};o=g}e:{for(;h;){if(h.nextSibling){h=h.nextSibling;break e}h=h.parentNode}h=void 0}h=Wt(h)}}function xn(o,a){return o&&a?o===a?!0:o&&o.nodeType===3?!1:a&&a.nodeType===3?xn(o,a.parentNode):"contains"in o?o.contains(a):o.compareDocumentPosition?!!(o.compareDocumentPosition(a)&16):!1:!1}function Or(){for(var o=window,a=Ge();a instanceof o.HTMLIFrameElement;){try{var h=typeof a.contentWindow.location.href=="string"}catch{h=!1}if(h)o=a.contentWindow;else break;a=Ge(o.document)}return a}function hu(o){var a=o&&o.nodeName&&o.nodeName.toLowerCase();return a&&(a==="input"&&(o.type==="text"||o.type==="search"||o.type==="tel"||o.type==="url"||o.type==="password")||a==="textarea"||o.contentEditable==="true")}function C0(o){var a=Or(),h=o.focusedElem,g=o.selectionRange;if(a!==h&&h&&h.ownerDocument&&xn(h.ownerDocument.documentElement,h)){if(g!==null&&hu(h)){if(a=g.start,o=g.end,o===void 0&&(o=a),"selectionStart"in h)h.selectionStart=a,h.selectionEnd=Math.min(o,h.value.length);else if(o=(a=h.ownerDocument||document)&&a.defaultView||window,o.getSelection){o=o.getSelection();var _=h.textContent.length,k=Math.min(g.start,_);g=g.end===void 0?k:Math.min(g.end,_),!o.extend&&k>g&&(_=g,g=k,k=_),_=Er(h,k);var P=Er(h,g);_&&P&&(o.rangeCount!==1||o.anchorNode!==_.node||o.anchorOffset!==_.offset||o.focusNode!==P.node||o.focusOffset!==P.offset)&&(a=a.createRange(),a.setStart(_.node,_.offset),o.removeAllRanges(),k>g?(o.addRange(a),o.extend(P.node,P.offset)):(a.setEnd(P.node,P.offset),o.addRange(a)))}}for(a=[],o=h;o=o.parentNode;)o.nodeType===1&&a.push({element:o,left:o.scrollLeft,top:o.scrollTop});for(typeof h.focus=="function"&&h.focus(),h=0;h<a.length;h++)o=a[h],o.element.scrollLeft=o.left,o.element.scrollTop=o.top}}var yo=d&&"documentMode"in document&&11>=document.documentMode,Hi=null,Lh=null,hi=null,lc=!1;function pu(o,a,h){var g=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;lc||Hi==null||Hi!==Ge(g)||(g=Hi,"selectionStart"in g&&hu(g)?g={start:g.selectionStart,end:g.selectionEnd}:(g=(g.ownerDocument&&g.ownerDocument.defaultView||window).getSelection(),g={anchorNode:g.anchorNode,anchorOffset:g.anchorOffset,focusNode:g.focusNode,focusOffset:g.focusOffset}),hi&&Qe(hi,g)||(hi=g,g=Dd(Lh,"onSelect"),0<g.length&&(a=new _d("onSelect","select",null,a,h),o.push({event:a,listeners:g}),a.target=Hi)))}function xr(o,a){var h={};return h[o.toLowerCase()]=a.toLowerCase(),h["Webkit"+o]="webkit"+a,h["Moz"+o]="moz"+a,h}var cc={animationend:xr("Animation","AnimationEnd"),animationiteration:xr("Animation","AnimationIteration"),animationstart:xr("Animation","AnimationStart"),transitionend:xr("Transition","TransitionEnd")},Rd={},mu={};d&&(mu=document.createElement("div").style,"AnimationEvent"in window||(delete cc.animationend.animation,delete cc.animationiteration.animation,delete cc.animationstart.animation),"TransitionEvent"in window||delete cc.transitionend.transition);function Id(o){if(Rd[o])return Rd[o];if(!cc[o])return o;var a=cc[o],h;for(h in a)if(a.hasOwnProperty(h)&&h in mu)return Rd[o]=a[h];return o}var Sg=Id("animationend"),Eg=Id("animationiteration"),gu=Id("animationstart"),Bi=Id("transitionend"),vu=new Map,Mh="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function zo(o,a){vu.set(o,a),i(a,[o])}for(var Pd=0;Pd<Mh.length;Pd++){var Fd=Mh[Pd],jd=Fd.toLowerCase(),Cg=Fd[0].toUpperCase()+Fd.slice(1);zo(jd,"on"+Cg)}zo(Sg,"onAnimationEnd"),zo(Eg,"onAnimationIteration"),zo(gu,"onAnimationStart"),zo("dblclick","onDoubleClick"),zo("focusin","onFocus"),zo("focusout","onBlur"),zo(Bi,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),i("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),i("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),i("onBeforeInput",["compositionend","keypress","textInput","paste"]),i("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Gi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),cl=new Set("cancel close invalid load scroll toggle".split(" ").concat(Gi));function yu(o,a,h){var g=o.type||"unknown-event";o.currentTarget=h,yt(g,a,void 0,o),o.currentTarget=null}function kg(o,a){a=(a&4)!==0;for(var h=0;h<o.length;h++){var g=o[h],_=g.event;g=g.listeners;e:{var k=void 0;if(a)for(var P=g.length-1;0<=P;P--){var W=g[P],Z=W.instance,xe=W.currentTarget;if(W=W.listener,Z!==k&&_.isPropagationStopped())break e;yu(_,W,xe),k=Z}else for(P=0;P<g.length;P++){if(W=g[P],Z=W.instance,xe=W.currentTarget,W=W.listener,Z!==k&&_.isPropagationStopped())break e;yu(_,W,xe),k=Z}}}if(Ve)throw o=gt,Ve=!1,gt=null,o}function qr(o,a){var h=a[$d];h===void 0&&(h=a[$d]=new Set);var g=o+"__bubble";h.has(g)||(Od(a,o,2,!1),h.add(g))}function $h(o,a,h){var g=0;a&&(g|=4),Od(h,o,g,a)}var ul="_reactListening"+Math.random().toString(36).slice(2);function wa(o){if(!o[ul]){o[ul]=!0,n.forEach(function(h){h!=="selectionchange"&&(cl.has(h)||$h(h,!1,o),$h(h,!0,o))});var a=o.nodeType===9?o:o.ownerDocument;a===null||a[ul]||(a[ul]=!0,$h("selectionchange",!1,a))}}function Od(o,a,h,g){switch(ag(a)){case 1:var _=yd;break;case 4:_=xd;break;default:_=il}h=_.bind(null,a,h,o),_=void 0,!Ws||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(_=!0),g?_!==void 0?o.addEventListener(a,h,{capture:!0,passive:_}):o.addEventListener(a,h,!0):_!==void 0?o.addEventListener(a,h,{passive:_}):o.addEventListener(a,h,!1)}function Uh(o,a,h,g,_){var k=g;if((a&1)===0&&(a&2)===0&&g!==null)e:for(;;){if(g===null)return;var P=g.tag;if(P===3||P===4){var W=g.stateNode.containerInfo;if(W===_||W.nodeType===8&&W.parentNode===_)break;if(P===4)for(P=g.return;P!==null;){var Z=P.tag;if((Z===3||Z===4)&&(Z=P.stateNode.containerInfo,Z===_||Z.nodeType===8&&Z.parentNode===_))return;P=P.return}for(;W!==null;){if(P=mi(W),P===null)return;if(Z=P.tag,Z===5||Z===6){g=k=P;continue e}W=W.parentNode}}g=g.return}Mo(function(){var xe=k,je=vr(h),De=[];e:{var Fe=vu.get(o);if(Fe!==void 0){var Ze=_d,lt=o;switch(o){case"keypress":if(rc(h)===0)break e;case"keydown":case"keyup":Ze=fg;break;case"focusin":lt="focus",Ze=Hr;break;case"focusout":lt="blur",Ze=Hr;break;case"beforeblur":case"afterblur":Ze=Hr;break;case"click":if(h.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ze=Nh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ze=Ed;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ze=v0;break;case Sg:case Eg:case gu:Ze=Ah;break;case Bi:Ze=jh;break;case"scroll":Ze=lg;break;case"wheel":Ze=pg;break;case"copy":case"cut":case"paste":Ze=Rh;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ze=kd}var dt=(a&4)!==0,pn=!dt&&o==="scroll",pe=dt?Fe!==null?Fe+"Capture":null:Fe;dt=[];for(var ie=xe,ve;ie!==null;){ve=ie;var $e=ve.stateNode;if(ve.tag===5&&$e!==null&&(ve=$e,pe!==null&&($e=En(ie,pe),$e!=null&&dt.push(uc(ie,$e,ve)))),pn)break;ie=ie.return}0<dt.length&&(Fe=new Ze(Fe,lt,null,h,je),De.push({event:Fe,listeners:dt}))}}if((a&7)===0){e:{if(Fe=o==="mouseover"||o==="pointerover",Ze=o==="mouseout"||o==="pointerout",Fe&&h!==kt&&(lt=h.relatedTarget||h.fromElement)&&(mi(lt)||lt[Zs]))break e;if((Ze||Fe)&&(Fe=je.window===je?je:(Fe=je.ownerDocument)?Fe.defaultView||Fe.parentWindow:window,Ze?(lt=h.relatedTarget||h.toElement,Ze=xe,lt=lt?mi(lt):null,lt!==null&&(pn=ht(lt),lt!==pn||lt.tag!==5&&lt.tag!==6)&&(lt=null)):(Ze=null,lt=xe),Ze!==lt)){if(dt=Nh,$e="onMouseLeave",pe="onMouseEnter",ie="mouse",(o==="pointerout"||o==="pointerover")&&(dt=kd,$e="onPointerLeave",pe="onPointerEnter",ie="pointer"),pn=Ze==null?Fe:Zt(Ze),ve=lt==null?Fe:Zt(lt),Fe=new dt($e,ie+"leave",Ze,h,je),Fe.target=pn,Fe.relatedTarget=ve,$e=null,mi(je)===xe&&(dt=new dt(pe,ie+"enter",lt,h,je),dt.target=ve,dt.relatedTarget=pn,$e=dt),pn=$e,Ze&&lt)t:{for(dt=Ze,pe=lt,ie=0,ve=dt;ve;ve=dc(ve))ie++;for(ve=0,$e=pe;$e;$e=dc($e))ve++;for(;0<ie-ve;)dt=dc(dt),ie--;for(;0<ve-ie;)pe=dc(pe),ve--;for(;ie--;){if(dt===pe||pe!==null&&dt===pe.alternate)break t;dt=dc(dt),pe=dc(pe)}dt=null}else dt=null;Ze!==null&&wn(De,Fe,Ze,dt,!1),lt!==null&&pn!==null&&wn(De,pn,lt,dt,!0)}}e:{if(Fe=xe?Zt(xe):window,Ze=Fe.nodeName&&Fe.nodeName.toLowerCase(),Ze==="select"||Ze==="input"&&Fe.type==="file")var vt=_0;else if(Nd(Fe))if(ll)vt=le;else{vt=E0;var Ft=S0}else(Ze=Fe.nodeName)&&Ze.toLowerCase()==="input"&&(Fe.type==="checkbox"||Fe.type==="radio")&&(vt=ac);if(vt&&(vt=vt(o,xe))){Dh(De,vt,h,je);break e}Ft&&Ft(o,Fe,xe),o==="focusout"&&(Ft=Fe._wrapperState)&&Ft.controlled&&Fe.type==="number"&&Gt(Fe,"number",Fe.value)}switch(Ft=xe?Zt(xe):window,o){case"focusin":(Nd(Ft)||Ft.contentEditable==="true")&&(Hi=Ft,Lh=xe,hi=null);break;case"focusout":hi=Lh=Hi=null;break;case"mousedown":lc=!0;break;case"contextmenu":case"mouseup":case"dragend":lc=!1,pu(De,h,je);break;case"selectionchange":if(yo)break;case"keydown":case"keyup":pu(De,h,je)}var Tt;if(fu)e:{switch(o){case"compositionstart":var zt="onCompositionStart";break e;case"compositionend":zt="onCompositionEnd";break e;case"compositionupdate":zt="onCompositionUpdate";break e}zt=void 0}else oc?yg(o,h)&&(zt="onCompositionEnd"):o==="keydown"&&h.keyCode===229&&(zt="onCompositionStart");zt&&(Oh&&h.locale!=="ko"&&(oc||zt!=="onCompositionStart"?zt==="onCompositionEnd"&&oc&&(Tt=Eh()):(Zr=je,du="value"in Zr?Zr.value:Zr.textContent,oc=!0)),Ft=Dd(xe,zt),0<Ft.length&&(zt=new cg(zt,o,null,h,je),De.push({event:zt,listeners:Ft}),Tt?zt.data=Tt:(Tt=xg(h),Tt!==null&&(zt.data=Tt)))),(Tt=mg?ic(o,h):x0(o,h))&&(xe=Dd(xe,"onBeforeInput"),0<xe.length&&(je=new cg("onBeforeInput","beforeinput",null,h,je),De.push({event:je,listeners:xe}),je.data=Tt))}kg(De,a)})}function uc(o,a,h){return{instance:o,listener:a,currentTarget:h}}function Dd(o,a){for(var h=a+"Capture",g=[];o!==null;){var _=o,k=_.stateNode;_.tag===5&&k!==null&&(_=k,k=En(o,h),k!=null&&g.unshift(uc(o,k,_)),k=En(o,a),k!=null&&g.push(uc(o,k,_))),o=o.return}return g}function dc(o){if(o===null)return null;do o=o.return;while(o&&o.tag!==5);return o||null}function wn(o,a,h,g,_){for(var k=a._reactName,P=[];h!==null&&h!==g;){var W=h,Z=W.alternate,xe=W.stateNode;if(Z!==null&&Z===g)break;W.tag===5&&xe!==null&&(W=xe,_?(Z=En(h,k),Z!=null&&P.unshift(uc(h,Z,W))):_||(Z=En(h,k),Z!=null&&P.push(uc(h,Z,W)))),h=h.return}P.length!==0&&o.push({event:a,listeners:P})}var Zn=/\r\n?/g,k0=/\u0000|\uFFFD/g;function Ng(o){return(typeof o=="string"?o:""+o).replace(Zn,`
`).replace(k0,"")}function xu(o,a,h){if(a=Ng(a),Ng(o)!==a&&h)throw Error(t(425))}function Ld(){}var wu=null,dl=null;function bu(o,a){return o==="textarea"||o==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var ba=typeof setTimeout=="function"?setTimeout:void 0,_u=typeof clearTimeout=="function"?clearTimeout:void 0,fc=typeof Promise=="function"?Promise:void 0,Md=typeof queueMicrotask=="function"?queueMicrotask:typeof fc<"u"?function(o){return fc.resolve(null).then(o).catch(hc)}:ba;function hc(o){setTimeout(function(){throw o})}function zh(o,a){var h=a,g=0;do{var _=h.nextSibling;if(o.removeChild(h),_&&_.nodeType===8)if(h=_.data,h==="/$"){if(g===0){o.removeChild(_),Qt(a);return}g--}else h!=="$"&&h!=="$?"&&h!=="$!"||g++;h=_}while(h);Qt(a)}function _a(o){for(;o!=null;o=o.nextSibling){var a=o.nodeType;if(a===1||a===3)break;if(a===8){if(a=o.data,a==="$"||a==="$!"||a==="$?")break;if(a==="/$")return null}}return o}function Tg(o){o=o.previousSibling;for(var a=0;o;){if(o.nodeType===8){var h=o.data;if(h==="$"||h==="$!"||h==="$?"){if(a===0)return o;a--}else h==="/$"&&a++}o=o.previousSibling}return null}var pc=Math.random().toString(36).slice(2),pi="__reactFiber$"+pc,Sa="__reactProps$"+pc,Zs="__reactContainer$"+pc,$d="__reactEvents$"+pc,D="__reactListeners$"+pc,mc="__reactHandles$"+pc;function mi(o){var a=o[pi];if(a)return a;for(var h=o.parentNode;h;){if(a=h[Zs]||h[pi]){if(h=a.alternate,a.child!==null||h!==null&&h.child!==null)for(o=Tg(o);o!==null;){if(h=o[pi])return h;o=Tg(o)}return a}o=h,h=o.parentNode}return null}function es(o){return o=o[pi]||o[Zs],!o||o.tag!==5&&o.tag!==6&&o.tag!==13&&o.tag!==3?null:o}function Zt(o){if(o.tag===5||o.tag===6)return o.stateNode;throw Error(t(33))}function Ud(o){return o[Sa]||null}var Hh=[],gc=-1;function As(o){return{current:o}}function Kr(o){0>gc||(o.current=Hh[gc],Hh[gc]=null,gc--)}function Br(o,a){gc++,Hh[gc]=o.current,o.current=a}var Ea={},ts=As(Ea),Rs=As(!1),ds=Ea;function vc(o,a){var h=o.type.contextTypes;if(!h)return Ea;var g=o.stateNode;if(g&&g.__reactInternalMemoizedUnmaskedChildContext===a)return g.__reactInternalMemoizedMaskedChildContext;var _={},k;for(k in h)_[k]=a[k];return g&&(o=o.stateNode,o.__reactInternalMemoizedUnmaskedChildContext=a,o.__reactInternalMemoizedMaskedChildContext=_),_}function Is(o){return o=o.childContextTypes,o!=null}function zd(){Kr(Rs),Kr(ts)}function Ag(o,a,h){if(ts.current!==Ea)throw Error(t(168));Br(ts,a),Br(Rs,h)}function Rg(o,a,h){var g=o.stateNode;if(a=a.childContextTypes,typeof g.getChildContext!="function")return h;g=g.getChildContext();for(var _ in g)if(!(_ in a))throw Error(t(108,K(o)||"Unknown",_));return X({},h,g)}function xo(o){return o=(o=o.stateNode)&&o.__reactInternalMemoizedMergedChildContext||Ea,ds=ts.current,Br(ts,o),Br(Rs,Rs.current),!0}function Ig(o,a,h){var g=o.stateNode;if(!g)throw Error(t(169));h?(o=Rg(o,a,ds),g.__reactInternalMemoizedMergedChildContext=o,Kr(Rs),Kr(ts),Br(ts,o)):Kr(Rs),Br(Rs,h)}var Wi=null,Hd=!1,Bh=!1;function Pg(o){Wi===null?Wi=[o]:Wi.push(o)}function fl(o){Hd=!0,Pg(o)}function Ca(){if(!Bh&&Wi!==null){Bh=!0;var o=0,a=yr;try{var h=Wi;for(yr=1;o<h.length;o++){var g=h[o];do g=g(!0);while(g!==null)}Wi=null,Hd=!1}catch(_){throw Wi!==null&&(Wi=Wi.slice(o+1)),Q(fn,Ca),_}finally{yr=a,Bh=!1}}return null}var yc=[],rs=0,Bd=null,Gd=0,wo=[],bo=0,hl=null,gi=1,vi="";function pl(o,a){yc[rs++]=Gd,yc[rs++]=Bd,Bd=o,Gd=a}function Fg(o,a,h){wo[bo++]=gi,wo[bo++]=vi,wo[bo++]=hl,hl=o;var g=gi;o=vi;var _=32-Ns(g)-1;g&=~(1<<_),h+=1;var k=32-Ns(a)+_;if(30<k){var P=_-_%5;k=(g&(1<<P)-1).toString(32),g>>=P,_-=P,gi=1<<32-Ns(a)+_|h<<_|g,vi=k+o}else gi=1<<k|h<<_|g,vi=o}function Su(o){o.return!==null&&(pl(o,1),Fg(o,1,0))}function ml(o){for(;o===Bd;)Bd=yc[--rs],yc[rs]=null,Gd=yc[--rs],yc[rs]=null;for(;o===hl;)hl=wo[--bo],wo[bo]=null,vi=wo[--bo],wo[bo]=null,gi=wo[--bo],wo[bo]=null}var ns=null,eo=null,Yr=!1,Ho=null;function yi(o,a){var h=To(5,null,null,0);h.elementType="DELETED",h.stateNode=a,h.return=o,a=o.deletions,a===null?(o.deletions=[h],o.flags|=16):a.push(h)}function Wd(o,a){switch(o.tag){case 5:var h=o.type;return a=a.nodeType!==1||h.toLowerCase()!==a.nodeName.toLowerCase()?null:a,a!==null?(o.stateNode=a,ns=o,eo=_a(a.firstChild),!0):!1;case 6:return a=o.pendingProps===""||a.nodeType!==3?null:a,a!==null?(o.stateNode=a,ns=o,eo=null,!0):!1;case 13:return a=a.nodeType!==8?null:a,a!==null?(h=hl!==null?{id:gi,overflow:vi}:null,o.memoizedState={dehydrated:a,treeContext:h,retryLane:1073741824},h=To(18,null,null,0),h.stateNode=a,h.return=o,o.child=h,ns=o,eo=null,!0):!1;default:return!1}}function Vi(o){return(o.mode&1)!==0&&(o.flags&128)===0}function Ps(o){if(Yr){var a=eo;if(a){var h=a;if(!Wd(o,a)){if(Vi(o))throw Error(t(418));a=_a(h.nextSibling);var g=ns;a&&Wd(o,a)?yi(g,h):(o.flags=o.flags&-4097|2,Yr=!1,ns=o)}}else{if(Vi(o))throw Error(t(418));o.flags=o.flags&-4097|2,Yr=!1,ns=o}}}function jg(o){for(o=o.return;o!==null&&o.tag!==5&&o.tag!==3&&o.tag!==13;)o=o.return;ns=o}function Eu(o){if(o!==ns)return!1;if(!Yr)return jg(o),Yr=!0,!1;var a;if((a=o.tag!==3)&&!(a=o.tag!==5)&&(a=o.type,a=a!=="head"&&a!=="body"&&!bu(o.type,o.memoizedProps)),a&&(a=eo)){if(Vi(o))throw Gh(),Error(t(418));for(;a;)yi(o,a),a=_a(a.nextSibling)}if(jg(o),o.tag===13){if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(t(317));e:{for(o=o.nextSibling,a=0;o;){if(o.nodeType===8){var h=o.data;if(h==="/$"){if(a===0){eo=_a(o.nextSibling);break e}a--}else h!=="$"&&h!=="$!"&&h!=="$?"||a++}o=o.nextSibling}eo=null}}else eo=ns?_a(o.stateNode.nextSibling):null;return!0}function Gh(){for(var o=eo;o;)o=_a(o.nextSibling)}function xi(){eo=ns=null,Yr=!1}function wi(o){Ho===null?Ho=[o]:Ho.push(o)}var Og=j.ReactCurrentBatchConfig;function Cu(o,a,h){if(o=h.ref,o!==null&&typeof o!="function"&&typeof o!="object"){if(h._owner){if(h=h._owner,h){if(h.tag!==1)throw Error(t(309));var g=h.stateNode}if(!g)throw Error(t(147,o));var _=g,k=""+o;return a!==null&&a.ref!==null&&typeof a.ref=="function"&&a.ref._stringRef===k?a.ref:(a=function(P){var W=_.refs;P===null?delete W[k]:W[k]=P},a._stringRef=k,a)}if(typeof o!="string")throw Error(t(284));if(!h._owner)throw Error(t(290,o))}return o}function gl(o,a){throw o=Object.prototype.toString.call(a),Error(t(31,o==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":o))}function Dg(o){var a=o._init;return a(o._payload)}function Wh(o){function a(pe,ie){if(o){var ve=pe.deletions;ve===null?(pe.deletions=[ie],pe.flags|=16):ve.push(ie)}}function h(pe,ie){if(!o)return null;for(;ie!==null;)a(pe,ie),ie=ie.sibling;return null}function g(pe,ie){for(pe=new Map;ie!==null;)ie.key!==null?pe.set(ie.key,ie):pe.set(ie.index,ie),ie=ie.sibling;return pe}function _(pe,ie){return pe=Yo(pe,ie),pe.index=0,pe.sibling=null,pe}function k(pe,ie,ve){return pe.index=ve,o?(ve=pe.alternate,ve!==null?(ve=ve.index,ve<ie?(pe.flags|=2,ie):ve):(pe.flags|=2,ie)):(pe.flags|=1048576,ie)}function P(pe){return o&&pe.alternate===null&&(pe.flags|=2),pe}function W(pe,ie,ve,$e){return ie===null||ie.tag!==6?(ie=Ip(ve,pe.mode,$e),ie.return=pe,ie):(ie=_(ie,ve),ie.return=pe,ie)}function Z(pe,ie,ve,$e){var vt=ve.type;return vt===z?je(pe,ie,ve.props.children,$e,ve.key):ie!==null&&(ie.elementType===vt||typeof vt=="object"&&vt!==null&&vt.$$typeof===de&&Dg(vt)===ie.type)?($e=_(ie,ve.props),$e.ref=Cu(pe,ie,ve),$e.return=pe,$e):($e=Nf(ve.type,ve.key,ve.props,null,pe.mode,$e),$e.ref=Cu(pe,ie,ve),$e.return=pe,$e)}function xe(pe,ie,ve,$e){return ie===null||ie.tag!==4||ie.stateNode.containerInfo!==ve.containerInfo||ie.stateNode.implementation!==ve.implementation?(ie=Pp(ve,pe.mode,$e),ie.return=pe,ie):(ie=_(ie,ve.children||[]),ie.return=pe,ie)}function je(pe,ie,ve,$e,vt){return ie===null||ie.tag!==7?(ie=Nl(ve,pe.mode,$e,vt),ie.return=pe,ie):(ie=_(ie,ve),ie.return=pe,ie)}function De(pe,ie,ve){if(typeof ie=="string"&&ie!==""||typeof ie=="number")return ie=Ip(""+ie,pe.mode,ve),ie.return=pe,ie;if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case L:return ve=Nf(ie.type,ie.key,ie.props,null,pe.mode,ve),ve.ref=Cu(pe,null,ie),ve.return=pe,ve;case G:return ie=Pp(ie,pe.mode,ve),ie.return=pe,ie;case de:var $e=ie._init;return De(pe,$e(ie._payload),ve)}if($t(ie)||$(ie))return ie=Nl(ie,pe.mode,ve,null),ie.return=pe,ie;gl(pe,ie)}return null}function Fe(pe,ie,ve,$e){var vt=ie!==null?ie.key:null;if(typeof ve=="string"&&ve!==""||typeof ve=="number")return vt!==null?null:W(pe,ie,""+ve,$e);if(typeof ve=="object"&&ve!==null){switch(ve.$$typeof){case L:return ve.key===vt?Z(pe,ie,ve,$e):null;case G:return ve.key===vt?xe(pe,ie,ve,$e):null;case de:return vt=ve._init,Fe(pe,ie,vt(ve._payload),$e)}if($t(ve)||$(ve))return vt!==null?null:je(pe,ie,ve,$e,null);gl(pe,ve)}return null}function Ze(pe,ie,ve,$e,vt){if(typeof $e=="string"&&$e!==""||typeof $e=="number")return pe=pe.get(ve)||null,W(ie,pe,""+$e,vt);if(typeof $e=="object"&&$e!==null){switch($e.$$typeof){case L:return pe=pe.get($e.key===null?ve:$e.key)||null,Z(ie,pe,$e,vt);case G:return pe=pe.get($e.key===null?ve:$e.key)||null,xe(ie,pe,$e,vt);case de:var Ft=$e._init;return Ze(pe,ie,ve,Ft($e._payload),vt)}if($t($e)||$($e))return pe=pe.get(ve)||null,je(ie,pe,$e,vt,null);gl(ie,$e)}return null}function lt(pe,ie,ve,$e){for(var vt=null,Ft=null,Tt=ie,zt=ie=0,jn=null;Tt!==null&&zt<ve.length;zt++){Tt.index>zt?(jn=Tt,Tt=null):jn=Tt.sibling;var Cr=Fe(pe,Tt,ve[zt],$e);if(Cr===null){Tt===null&&(Tt=jn);break}o&&Tt&&Cr.alternate===null&&a(pe,Tt),ie=k(Cr,ie,zt),Ft===null?vt=Cr:Ft.sibling=Cr,Ft=Cr,Tt=jn}if(zt===ve.length)return h(pe,Tt),Yr&&pl(pe,zt),vt;if(Tt===null){for(;zt<ve.length;zt++)Tt=De(pe,ve[zt],$e),Tt!==null&&(ie=k(Tt,ie,zt),Ft===null?vt=Tt:Ft.sibling=Tt,Ft=Tt);return Yr&&pl(pe,zt),vt}for(Tt=g(pe,Tt);zt<ve.length;zt++)jn=Ze(Tt,pe,zt,ve[zt],$e),jn!==null&&(o&&jn.alternate!==null&&Tt.delete(jn.key===null?zt:jn.key),ie=k(jn,ie,zt),Ft===null?vt=jn:Ft.sibling=jn,Ft=jn);return o&&Tt.forEach(function(La){return a(pe,La)}),Yr&&pl(pe,zt),vt}function dt(pe,ie,ve,$e){var vt=$(ve);if(typeof vt!="function")throw Error(t(150));if(ve=vt.call(ve),ve==null)throw Error(t(151));for(var Ft=vt=null,Tt=ie,zt=ie=0,jn=null,Cr=ve.next();Tt!==null&&!Cr.done;zt++,Cr=ve.next()){Tt.index>zt?(jn=Tt,Tt=null):jn=Tt.sibling;var La=Fe(pe,Tt,Cr.value,$e);if(La===null){Tt===null&&(Tt=jn);break}o&&Tt&&La.alternate===null&&a(pe,Tt),ie=k(La,ie,zt),Ft===null?vt=La:Ft.sibling=La,Ft=La,Tt=jn}if(Cr.done)return h(pe,Tt),Yr&&pl(pe,zt),vt;if(Tt===null){for(;!Cr.done;zt++,Cr=ve.next())Cr=De(pe,Cr.value,$e),Cr!==null&&(ie=k(Cr,ie,zt),Ft===null?vt=Cr:Ft.sibling=Cr,Ft=Cr);return Yr&&pl(pe,zt),vt}for(Tt=g(pe,Tt);!Cr.done;zt++,Cr=ve.next())Cr=Ze(Tt,pe,zt,Cr.value,$e),Cr!==null&&(o&&Cr.alternate!==null&&Tt.delete(Cr.key===null?zt:Cr.key),ie=k(Cr,ie,zt),Ft===null?vt=Cr:Ft.sibling=Cr,Ft=Cr);return o&&Tt.forEach(function(q0){return a(pe,q0)}),Yr&&pl(pe,zt),vt}function pn(pe,ie,ve,$e){if(typeof ve=="object"&&ve!==null&&ve.type===z&&ve.key===null&&(ve=ve.props.children),typeof ve=="object"&&ve!==null){switch(ve.$$typeof){case L:e:{for(var vt=ve.key,Ft=ie;Ft!==null;){if(Ft.key===vt){if(vt=ve.type,vt===z){if(Ft.tag===7){h(pe,Ft.sibling),ie=_(Ft,ve.props.children),ie.return=pe,pe=ie;break e}}else if(Ft.elementType===vt||typeof vt=="object"&&vt!==null&&vt.$$typeof===de&&Dg(vt)===Ft.type){h(pe,Ft.sibling),ie=_(Ft,ve.props),ie.ref=Cu(pe,Ft,ve),ie.return=pe,pe=ie;break e}h(pe,Ft);break}else a(pe,Ft);Ft=Ft.sibling}ve.type===z?(ie=Nl(ve.props.children,pe.mode,$e,ve.key),ie.return=pe,pe=ie):($e=Nf(ve.type,ve.key,ve.props,null,pe.mode,$e),$e.ref=Cu(pe,ie,ve),$e.return=pe,pe=$e)}return P(pe);case G:e:{for(Ft=ve.key;ie!==null;){if(ie.key===Ft)if(ie.tag===4&&ie.stateNode.containerInfo===ve.containerInfo&&ie.stateNode.implementation===ve.implementation){h(pe,ie.sibling),ie=_(ie,ve.children||[]),ie.return=pe,pe=ie;break e}else{h(pe,ie);break}else a(pe,ie);ie=ie.sibling}ie=Pp(ve,pe.mode,$e),ie.return=pe,pe=ie}return P(pe);case de:return Ft=ve._init,pn(pe,ie,Ft(ve._payload),$e)}if($t(ve))return lt(pe,ie,ve,$e);if($(ve))return dt(pe,ie,ve,$e);gl(pe,ve)}return typeof ve=="string"&&ve!==""||typeof ve=="number"?(ve=""+ve,ie!==null&&ie.tag===6?(h(pe,ie.sibling),ie=_(ie,ve),ie.return=pe,pe=ie):(h(pe,ie),ie=Ip(ve,pe.mode,$e),ie.return=pe,pe=ie),P(pe)):h(pe,ie)}return pn}var un=Wh(!0),Vd=Wh(!1),ku=As(null),to=null,ka=null,xc=null;function qi(){xc=ka=to=null}function qd(o){var a=ku.current;Kr(ku),o._currentValue=a}function zn(o,a,h){for(;o!==null;){var g=o.alternate;if((o.childLanes&a)!==a?(o.childLanes|=a,g!==null&&(g.childLanes|=a)):g!==null&&(g.childLanes&a)!==a&&(g.childLanes|=a),o===h)break;o=o.return}}function Na(o,a){to=o,xc=ka=null,o=o.dependencies,o!==null&&o.firstContext!==null&&((o.lanes&a)!==0&&(hs=!0),o.firstContext=null)}function _o(o){var a=o._currentValue;if(xc!==o)if(o={context:o,memoizedValue:a,next:null},ka===null){if(to===null)throw Error(t(308));ka=o,to.dependencies={lanes:0,firstContext:o}}else ka=ka.next=o;return a}var vl=null;function Vh(o){vl===null?vl=[o]:vl.push(o)}function Kd(o,a,h,g){var _=a.interleaved;return _===null?(h.next=h,Vh(a)):(h.next=_.next,_.next=h),a.interleaved=h,Ki(o,g)}function Ki(o,a){o.lanes|=a;var h=o.alternate;for(h!==null&&(h.lanes|=a),h=o,o=o.return;o!==null;)o.childLanes|=a,h=o.alternate,h!==null&&(h.childLanes|=a),h=o,o=o.return;return h.tag===3?h.stateNode:null}var So=!1;function Yd(o){o.updateQueue={baseState:o.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Lg(o,a){o=o.updateQueue,a.updateQueue===o&&(a.updateQueue={baseState:o.baseState,firstBaseUpdate:o.firstBaseUpdate,lastBaseUpdate:o.lastBaseUpdate,shared:o.shared,effects:o.effects})}function Yi(o,a){return{eventTime:o,lane:a,tag:0,payload:null,callback:null,next:null}}function Eo(o,a,h){var g=o.updateQueue;if(g===null)return null;if(g=g.shared,(wr&2)!==0){var _=g.pending;return _===null?a.next=a:(a.next=_.next,_.next=a),g.pending=a,Ki(o,h)}return _=g.interleaved,_===null?(a.next=a,Vh(g)):(a.next=_.next,_.next=a),g.interleaved=a,Ki(o,h)}function Jd(o,a,h){if(a=a.updateQueue,a!==null&&(a=a.shared,(h&4194240)!==0)){var g=a.lanes;g&=o.pendingLanes,h|=g,a.lanes=h,nl(o,h)}}function Mg(o,a){var h=o.updateQueue,g=o.alternate;if(g!==null&&(g=g.updateQueue,h===g)){var _=null,k=null;if(h=h.firstBaseUpdate,h!==null){do{var P={eventTime:h.eventTime,lane:h.lane,tag:h.tag,payload:h.payload,callback:h.callback,next:null};k===null?_=k=P:k=k.next=P,h=h.next}while(h!==null);k===null?_=k=a:k=k.next=a}else _=k=a;h={baseState:g.baseState,firstBaseUpdate:_,lastBaseUpdate:k,shared:g.shared,effects:g.effects},o.updateQueue=h;return}o=h.lastBaseUpdate,o===null?h.firstBaseUpdate=a:o.next=a,h.lastBaseUpdate=a}function wc(o,a,h,g){var _=o.updateQueue;So=!1;var k=_.firstBaseUpdate,P=_.lastBaseUpdate,W=_.shared.pending;if(W!==null){_.shared.pending=null;var Z=W,xe=Z.next;Z.next=null,P===null?k=xe:P.next=xe,P=Z;var je=o.alternate;je!==null&&(je=je.updateQueue,W=je.lastBaseUpdate,W!==P&&(W===null?je.firstBaseUpdate=xe:W.next=xe,je.lastBaseUpdate=Z))}if(k!==null){var De=_.baseState;P=0,je=xe=Z=null,W=k;do{var Fe=W.lane,Ze=W.eventTime;if((g&Fe)===Fe){je!==null&&(je=je.next={eventTime:Ze,lane:0,tag:W.tag,payload:W.payload,callback:W.callback,next:null});e:{var lt=o,dt=W;switch(Fe=a,Ze=h,dt.tag){case 1:if(lt=dt.payload,typeof lt=="function"){De=lt.call(Ze,De,Fe);break e}De=lt;break e;case 3:lt.flags=lt.flags&-65537|128;case 0:if(lt=dt.payload,Fe=typeof lt=="function"?lt.call(Ze,De,Fe):lt,Fe==null)break e;De=X({},De,Fe);break e;case 2:So=!0}}W.callback!==null&&W.lane!==0&&(o.flags|=64,Fe=_.effects,Fe===null?_.effects=[W]:Fe.push(W))}else Ze={eventTime:Ze,lane:Fe,tag:W.tag,payload:W.payload,callback:W.callback,next:null},je===null?(xe=je=Ze,Z=De):je=je.next=Ze,P|=Fe;if(W=W.next,W===null){if(W=_.shared.pending,W===null)break;Fe=W,W=Fe.next,Fe.next=null,_.lastBaseUpdate=Fe,_.shared.pending=null}}while(!0);if(je===null&&(Z=De),_.baseState=Z,_.firstBaseUpdate=xe,_.lastBaseUpdate=je,a=_.shared.interleaved,a!==null){_=a;do P|=_.lane,_=_.next;while(_!==a)}else k===null&&(_.shared.lanes=0);Pa|=P,o.lanes=P,o.memoizedState=De}}function qh(o,a,h){if(o=a.effects,a.effects=null,o!==null)for(a=0;a<o.length;a++){var g=o[a],_=g.callback;if(_!==null){if(g.callback=null,g=h,typeof _!="function")throw Error(t(191,_));_.call(g)}}}var Nu={},bi=As(Nu),Tu=As(Nu),bc=As(Nu);function Ji(o){if(o===Nu)throw Error(t(174));return o}function Kh(o,a){switch(Br(bc,a),Br(Tu,o),Br(bi,Nu),o=a.nodeType,o){case 9:case 11:a=(a=a.documentElement)?a.namespaceURI:Pe(null,"");break;default:o=o===8?a.parentNode:a,a=o.namespaceURI||null,o=o.tagName,a=Pe(a,o)}Kr(bi),Br(bi,a)}function Ta(){Kr(bi),Kr(Tu),Kr(bc)}function Yh(o){Ji(bc.current);var a=Ji(bi.current),h=Pe(a,o.type);a!==h&&(Br(Tu,o),Br(bi,h))}function Xd(o){Tu.current===o&&(Kr(bi),Kr(Tu))}var en=As(0);function yl(o){for(var a=o;a!==null;){if(a.tag===13){var h=a.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||h.data==="$?"||h.data==="$!"))return a}else if(a.tag===19&&a.memoizedProps.revealOrder!==void 0){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===o)break;for(;a.sibling===null;){if(a.return===null||a.return===o)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var Jh=[];function Qd(){for(var o=0;o<Jh.length;o++)Jh[o]._workInProgressVersionPrimary=null;Jh.length=0}var Au=j.ReactCurrentDispatcher,Xh=j.ReactCurrentBatchConfig,Aa=0,nn=null,hn=null,Cn=null,_c=!1,Ru=!1,xl=0,sr=0;function ss(){throw Error(t(321))}function Qh(o,a){if(a===null)return!1;for(var h=0;h<a.length&&h<o.length;h++)if(!ye(o[h],a[h]))return!1;return!0}function wl(o,a,h,g,_,k){if(Aa=k,nn=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,Au.current=o===null||o.memoizedState===null?T0:of,o=h(g,_),Ru){k=0;do{if(Ru=!1,xl=0,25<=k)throw Error(t(301));k+=1,Cn=hn=null,a.updateQueue=null,Au.current=kc,o=h(g,_)}while(Ru)}if(Au.current=sf,a=hn!==null&&hn.next!==null,Aa=0,Cn=hn=nn=null,_c=!1,a)throw Error(t(300));return o}function Zd(){var o=xl!==0;return xl=0,o}function _i(){var o={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Cn===null?nn.memoizedState=Cn=o:Cn=Cn.next=o,Cn}function Co(){if(hn===null){var o=nn.alternate;o=o!==null?o.memoizedState:null}else o=hn.next;var a=Cn===null?nn.memoizedState:Cn.next;if(a!==null)Cn=a,hn=o;else{if(o===null)throw Error(t(310));hn=o,o={memoizedState:hn.memoizedState,baseState:hn.baseState,baseQueue:hn.baseQueue,queue:hn.queue,next:null},Cn===null?nn.memoizedState=Cn=o:Cn=Cn.next=o}return Cn}function os(o,a){return typeof a=="function"?a(o):a}function Zh(o){var a=Co(),h=a.queue;if(h===null)throw Error(t(311));h.lastRenderedReducer=o;var g=hn,_=g.baseQueue,k=h.pending;if(k!==null){if(_!==null){var P=_.next;_.next=k.next,k.next=P}g.baseQueue=_=k,h.pending=null}if(_!==null){k=_.next,g=g.baseState;var W=P=null,Z=null,xe=k;do{var je=xe.lane;if((Aa&je)===je)Z!==null&&(Z=Z.next={lane:0,action:xe.action,hasEagerState:xe.hasEagerState,eagerState:xe.eagerState,next:null}),g=xe.hasEagerState?xe.eagerState:o(g,xe.action);else{var De={lane:je,action:xe.action,hasEagerState:xe.hasEagerState,eagerState:xe.eagerState,next:null};Z===null?(W=Z=De,P=g):Z=Z.next=De,nn.lanes|=je,Pa|=je}xe=xe.next}while(xe!==null&&xe!==k);Z===null?P=g:Z.next=W,ye(g,a.memoizedState)||(hs=!0),a.memoizedState=g,a.baseState=P,a.baseQueue=Z,h.lastRenderedState=g}if(o=h.interleaved,o!==null){_=o;do k=_.lane,nn.lanes|=k,Pa|=k,_=_.next;while(_!==o)}else _===null&&(h.lanes=0);return[a.memoizedState,h.dispatch]}function Sc(o){var a=Co(),h=a.queue;if(h===null)throw Error(t(311));h.lastRenderedReducer=o;var g=h.dispatch,_=h.pending,k=a.memoizedState;if(_!==null){h.pending=null;var P=_=_.next;do k=o(k,P.action),P=P.next;while(P!==_);ye(k,a.memoizedState)||(hs=!0),a.memoizedState=k,a.baseQueue===null&&(a.baseState=k),h.lastRenderedState=k}return[k,g]}function ef(){}function ep(o,a){var h=nn,g=Co(),_=a(),k=!ye(g.memoizedState,_);if(k&&(g.memoizedState=_,hs=!0),g=g.queue,Si(Xi.bind(null,h,g,o),[o]),g.getSnapshot!==a||k||Cn!==null&&Cn.memoizedState.tag&1){if(h.flags|=2048,Ec(9,Fs.bind(null,h,g,_,a),void 0,null),Fn===null)throw Error(t(349));(Aa&30)!==0||tp(h,a,_)}return _}function tp(o,a,h){o.flags|=16384,o={getSnapshot:a,value:h},a=nn.updateQueue,a===null?(a={lastEffect:null,stores:null},nn.updateQueue=a,a.stores=[o]):(h=a.stores,h===null?a.stores=[o]:h.push(o))}function Fs(o,a,h,g){a.value=h,a.getSnapshot=g,tf(a)&&rp(o)}function Xi(o,a,h){return h(function(){tf(a)&&rp(o)})}function tf(o){var a=o.getSnapshot;o=o.value;try{var h=a();return!ye(o,h)}catch{return!0}}function rp(o){var a=Ki(o,1);a!==null&&Ko(a,o,1,-1)}function Iu(o){var a=_i();return typeof o=="function"&&(o=o()),a.memoizedState=a.baseState=o,o={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:os,lastRenderedState:o},a.queue=o,o=o.dispatch=Gg.bind(null,nn,o),[a.memoizedState,o]}function Ec(o,a,h,g){return o={tag:o,create:a,destroy:h,deps:g,next:null},a=nn.updateQueue,a===null?(a={lastEffect:null,stores:null},nn.updateQueue=a,a.lastEffect=o.next=o):(h=a.lastEffect,h===null?a.lastEffect=o.next=o:(g=h.next,h.next=o,o.next=g,a.lastEffect=o)),o}function rf(){return Co().memoizedState}function Pu(o,a,h,g){var _=_i();nn.flags|=o,_.memoizedState=Ec(1|a,h,void 0,g===void 0?null:g)}function Cc(o,a,h,g){var _=Co();g=g===void 0?null:g;var k=void 0;if(hn!==null){var P=hn.memoizedState;if(k=P.destroy,g!==null&&Qh(g,P.deps)){_.memoizedState=Ec(a,h,k,g);return}}nn.flags|=o,_.memoizedState=Ec(1|a,h,k,g)}function nf(o,a){return Pu(8390656,8,o,a)}function Si(o,a){return Cc(2048,8,o,a)}function $g(o,a){return Cc(4,2,o,a)}function Qi(o,a){return Cc(4,4,o,a)}function np(o,a){if(typeof a=="function")return o=o(),a(o),function(){a(null)};if(a!=null)return o=o(),a.current=o,function(){a.current=null}}function sp(o,a,h){return h=h!=null?h.concat([o]):null,Cc(4,4,np.bind(null,a,o),h)}function Fu(){}function Ug(o,a){var h=Co();a=a===void 0?null:a;var g=h.memoizedState;return g!==null&&a!==null&&Qh(a,g[1])?g[0]:(h.memoizedState=[o,a],o)}function zg(o,a){var h=Co();a=a===void 0?null:a;var g=h.memoizedState;return g!==null&&a!==null&&Qh(a,g[1])?g[0]:(o=o(),h.memoizedState=[o,a],o)}function Hg(o,a,h){return(Aa&21)===0?(o.baseState&&(o.baseState=!1,hs=!0),o.memoizedState=h):(ye(h,a)||(h=au(),nn.lanes|=h,Pa|=h,o.baseState=!0),a)}function Bg(o,a){var h=yr;yr=h!==0&&4>h?h:4,o(!0);var g=Xh.transition;Xh.transition={};try{o(!1),a()}finally{yr=h,Xh.transition=g}}function op(){return Co().memoizedState}function N0(o,a,h){var g=Oa(o);if(h={lane:g,action:h,hasEagerState:!1,eagerState:null,next:null},ip(o))fs(a,h);else if(h=Kd(o,a,h,g),h!==null){var _=gs();Ko(h,o,g,_),Bo(h,a,g)}}function Gg(o,a,h){var g=Oa(o),_={lane:g,action:h,hasEagerState:!1,eagerState:null,next:null};if(ip(o))fs(a,_);else{var k=o.alternate;if(o.lanes===0&&(k===null||k.lanes===0)&&(k=a.lastRenderedReducer,k!==null))try{var P=a.lastRenderedState,W=k(P,h);if(_.hasEagerState=!0,_.eagerState=W,ye(W,P)){var Z=a.interleaved;Z===null?(_.next=_,Vh(a)):(_.next=Z.next,Z.next=_),a.interleaved=_;return}}catch{}finally{}h=Kd(o,a,_,g),h!==null&&(_=gs(),Ko(h,o,g,_),Bo(h,a,g))}}function ip(o){var a=o.alternate;return o===nn||a!==null&&a===nn}function fs(o,a){Ru=_c=!0;var h=o.pending;h===null?a.next=a:(a.next=h.next,h.next=a),o.pending=a}function Bo(o,a,h){if((h&4194240)!==0){var g=a.lanes;g&=o.pendingLanes,h|=g,a.lanes=h,nl(o,h)}}var sf={readContext:_o,useCallback:ss,useContext:ss,useEffect:ss,useImperativeHandle:ss,useInsertionEffect:ss,useLayoutEffect:ss,useMemo:ss,useReducer:ss,useRef:ss,useState:ss,useDebugValue:ss,useDeferredValue:ss,useTransition:ss,useMutableSource:ss,useSyncExternalStore:ss,useId:ss,unstable_isNewReconciler:!1},T0={readContext:_o,useCallback:function(o,a){return _i().memoizedState=[o,a===void 0?null:a],o},useContext:_o,useEffect:nf,useImperativeHandle:function(o,a,h){return h=h!=null?h.concat([o]):null,Pu(4194308,4,np.bind(null,a,o),h)},useLayoutEffect:function(o,a){return Pu(4194308,4,o,a)},useInsertionEffect:function(o,a){return Pu(4,2,o,a)},useMemo:function(o,a){var h=_i();return a=a===void 0?null:a,o=o(),h.memoizedState=[o,a],o},useReducer:function(o,a,h){var g=_i();return a=h!==void 0?h(a):a,g.memoizedState=g.baseState=a,o={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:o,lastRenderedState:a},g.queue=o,o=o.dispatch=N0.bind(null,nn,o),[g.memoizedState,o]},useRef:function(o){var a=_i();return o={current:o},a.memoizedState=o},useState:Iu,useDebugValue:Fu,useDeferredValue:function(o){return _i().memoizedState=o},useTransition:function(){var o=Iu(!1),a=o[0];return o=Bg.bind(null,o[1]),_i().memoizedState=o,[a,o]},useMutableSource:function(){},useSyncExternalStore:function(o,a,h){var g=nn,_=_i();if(Yr){if(h===void 0)throw Error(t(407));h=h()}else{if(h=a(),Fn===null)throw Error(t(349));(Aa&30)!==0||tp(g,a,h)}_.memoizedState=h;var k={value:h,getSnapshot:a};return _.queue=k,nf(Xi.bind(null,g,k,o),[o]),g.flags|=2048,Ec(9,Fs.bind(null,g,k,h,a),void 0,null),h},useId:function(){var o=_i(),a=Fn.identifierPrefix;if(Yr){var h=vi,g=gi;h=(g&~(1<<32-Ns(g)-1)).toString(32)+h,a=":"+a+"R"+h,h=xl++,0<h&&(a+="H"+h.toString(32)),a+=":"}else h=sr++,a=":"+a+"r"+h.toString(32)+":";return o.memoizedState=a},unstable_isNewReconciler:!1},of={readContext:_o,useCallback:Ug,useContext:_o,useEffect:Si,useImperativeHandle:sp,useInsertionEffect:$g,useLayoutEffect:Qi,useMemo:zg,useReducer:Zh,useRef:rf,useState:function(){return Zh(os)},useDebugValue:Fu,useDeferredValue:function(o){var a=Co();return Hg(a,hn.memoizedState,o)},useTransition:function(){var o=Zh(os)[0],a=Co().memoizedState;return[o,a]},useMutableSource:ef,useSyncExternalStore:ep,useId:op,unstable_isNewReconciler:!1},kc={readContext:_o,useCallback:Ug,useContext:_o,useEffect:Si,useImperativeHandle:sp,useInsertionEffect:$g,useLayoutEffect:Qi,useMemo:zg,useReducer:Sc,useRef:rf,useState:function(){return Sc(os)},useDebugValue:Fu,useDeferredValue:function(o){var a=Co();return hn===null?a.memoizedState=o:Hg(a,hn.memoizedState,o)},useTransition:function(){var o=Sc(os)[0],a=Co().memoizedState;return[o,a]},useMutableSource:ef,useSyncExternalStore:ep,useId:op,unstable_isNewReconciler:!1};function ko(o,a){if(o&&o.defaultProps){a=X({},a),o=o.defaultProps;for(var h in o)a[h]===void 0&&(a[h]=o[h]);return a}return a}function af(o,a,h,g){a=o.memoizedState,h=h(g,a),h=h==null?a:X({},a,h),o.memoizedState=h,o.lanes===0&&(o.updateQueue.baseState=h)}var lf={isMounted:function(o){return(o=o._reactInternals)?ht(o)===o:!1},enqueueSetState:function(o,a,h){o=o._reactInternals;var g=gs(),_=Oa(o),k=Yi(g,_);k.payload=a,h!=null&&(k.callback=h),a=Eo(o,k,_),a!==null&&(Ko(a,o,_,g),Jd(a,o,_))},enqueueReplaceState:function(o,a,h){o=o._reactInternals;var g=gs(),_=Oa(o),k=Yi(g,_);k.tag=1,k.payload=a,h!=null&&(k.callback=h),a=Eo(o,k,_),a!==null&&(Ko(a,o,_,g),Jd(a,o,_))},enqueueForceUpdate:function(o,a){o=o._reactInternals;var h=gs(),g=Oa(o),_=Yi(h,g);_.tag=2,a!=null&&(_.callback=a),a=Eo(o,_,g),a!==null&&(Ko(a,o,g,h),Jd(a,o,g))}};function ap(o,a,h,g,_,k,P){return o=o.stateNode,typeof o.shouldComponentUpdate=="function"?o.shouldComponentUpdate(g,k,P):a.prototype&&a.prototype.isPureReactComponent?!Qe(h,g)||!Qe(_,k):!0}function bl(o,a,h){var g=!1,_=Ea,k=a.contextType;return typeof k=="object"&&k!==null?k=_o(k):(_=Is(a)?ds:ts.current,g=a.contextTypes,k=(g=g!=null)?vc(o,_):Ea),a=new a(h,k),o.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,a.updater=lf,o.stateNode=a,a._reactInternals=o,g&&(o=o.stateNode,o.__reactInternalMemoizedUnmaskedChildContext=_,o.__reactInternalMemoizedMaskedChildContext=k),a}function Nc(o,a,h,g){o=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(h,g),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(h,g),a.state!==o&&lf.enqueueReplaceState(a,a.state,null)}function lp(o,a,h,g){var _=o.stateNode;_.props=h,_.state=o.memoizedState,_.refs={},Yd(o);var k=a.contextType;typeof k=="object"&&k!==null?_.context=_o(k):(k=Is(a)?ds:ts.current,_.context=vc(o,k)),_.state=o.memoizedState,k=a.getDerivedStateFromProps,typeof k=="function"&&(af(o,a,k,h),_.state=o.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof _.getSnapshotBeforeUpdate=="function"||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(a=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),a!==_.state&&lf.enqueueReplaceState(_,_.state,null),wc(o,h,_,g),_.state=o.memoizedState),typeof _.componentDidMount=="function"&&(o.flags|=4194308)}function _l(o,a){try{var h="",g=a;do h+=ne(g),g=g.return;while(g);var _=h}catch(k){_=`
Error generating stack: `+k.message+`
`+k.stack}return{value:o,source:a,stack:_,digest:null}}function cf(o,a,h){return{value:o,source:null,stack:h??null,digest:a??null}}function Tc(o,a){try{console.error(a.value)}catch(h){setTimeout(function(){throw h})}}var Wg=typeof WeakMap=="function"?WeakMap:Map;function ju(o,a,h){h=Yi(-1,h),h.tag=3,h.payload={element:null};var g=a.value;return h.callback=function(){wf||(wf=!0,Ep=g),Tc(o,a)},h}function uf(o,a,h){h=Yi(-1,h),h.tag=3;var g=o.type.getDerivedStateFromError;if(typeof g=="function"){var _=a.value;h.payload=function(){return g(_)},h.callback=function(){Tc(o,a)}}var k=o.stateNode;return k!==null&&typeof k.componentDidCatch=="function"&&(h.callback=function(){Tc(o,a),typeof g!="function"&&(Fa===null?Fa=new Set([this]):Fa.add(this));var P=a.stack;this.componentDidCatch(a.value,{componentStack:P!==null?P:""})}),h}function Ou(o,a,h){var g=o.pingCache;if(g===null){g=o.pingCache=new Wg;var _=new Set;g.set(a,_)}else _=g.get(a),_===void 0&&(_=new Set,g.set(a,_));_.has(h)||(_.add(h),o=D0.bind(null,o,a,h),a.then(o,o))}function Vg(o){do{var a;if((a=o.tag===13)&&(a=o.memoizedState,a=a!==null?a.dehydrated!==null:!0),a)return o;o=o.return}while(o!==null);return null}function cp(o,a,h,g,_){return(o.mode&1)===0?(o===a?o.flags|=65536:(o.flags|=128,h.flags|=131072,h.flags&=-52805,h.tag===1&&(h.alternate===null?h.tag=17:(a=Yi(-1,1),a.tag=2,Eo(h,a,1))),h.lanes|=1),o):(o.flags|=65536,o.lanes=_,o)}var df=j.ReactCurrentOwner,hs=!1;function Hn(o,a,h,g){a.child=o===null?Vd(a,null,h,g):un(a,o.child,h,g)}function qg(o,a,h,g,_){h=h.render;var k=a.ref;return Na(a,_),g=wl(o,a,h,g,k,_),h=Zd(),o!==null&&!hs?(a.updateQueue=o.updateQueue,a.flags&=-2053,o.lanes&=~_,Go(o,a,_)):(Yr&&h&&Su(a),a.flags|=1,Hn(o,a,g,_),a.child)}function up(o,a,h,g,_){if(o===null){var k=h.type;return typeof k=="function"&&!kf(k)&&k.defaultProps===void 0&&h.compare===null&&h.defaultProps===void 0?(a.tag=15,a.type=k,Ei(o,a,k,g,_)):(o=Nf(h.type,null,g,a,a.mode,_),o.ref=a.ref,o.return=a,a.child=o)}if(k=o.child,(o.lanes&_)===0){var P=k.memoizedProps;if(h=h.compare,h=h!==null?h:Qe,h(P,g)&&o.ref===a.ref)return Go(o,a,_)}return a.flags|=1,o=Yo(k,g),o.ref=a.ref,o.return=a,a.child=o}function Ei(o,a,h,g,_){if(o!==null){var k=o.memoizedProps;if(Qe(k,g)&&o.ref===a.ref)if(hs=!1,a.pendingProps=g=k,(o.lanes&_)!==0)(o.flags&131072)!==0&&(hs=!0);else return a.lanes=o.lanes,Go(o,a,_)}return hp(o,a,h,g,_)}function dp(o,a,h){var g=a.pendingProps,_=g.children,k=o!==null?o.memoizedState:null;if(g.mode==="hidden")if((a.mode&1)===0)a.memoizedState={baseLanes:0,cachePool:null,transitions:null},Br(Pc,no),no|=h;else{if((h&1073741824)===0)return o=k!==null?k.baseLanes|h:h,a.lanes=a.childLanes=1073741824,a.memoizedState={baseLanes:o,cachePool:null,transitions:null},a.updateQueue=null,Br(Pc,no),no|=o,null;a.memoizedState={baseLanes:0,cachePool:null,transitions:null},g=k!==null?k.baseLanes:h,Br(Pc,no),no|=g}else k!==null?(g=k.baseLanes|h,a.memoizedState=null):g=h,Br(Pc,no),no|=g;return Hn(o,a,_,h),a.child}function fp(o,a){var h=a.ref;(o===null&&h!==null||o!==null&&o.ref!==h)&&(a.flags|=512,a.flags|=2097152)}function hp(o,a,h,g,_){var k=Is(h)?ds:ts.current;return k=vc(a,k),Na(a,_),h=wl(o,a,h,g,k,_),g=Zd(),o!==null&&!hs?(a.updateQueue=o.updateQueue,a.flags&=-2053,o.lanes&=~_,Go(o,a,_)):(Yr&&g&&Su(a),a.flags|=1,Hn(o,a,h,_),a.child)}function pp(o,a,h,g,_){if(Is(h)){var k=!0;xo(a)}else k=!1;if(Na(a,_),a.stateNode===null)hf(o,a),bl(a,h,g),lp(a,h,g,_),g=!0;else if(o===null){var P=a.stateNode,W=a.memoizedProps;P.props=W;var Z=P.context,xe=h.contextType;typeof xe=="object"&&xe!==null?xe=_o(xe):(xe=Is(h)?ds:ts.current,xe=vc(a,xe));var je=h.getDerivedStateFromProps,De=typeof je=="function"||typeof P.getSnapshotBeforeUpdate=="function";De||typeof P.UNSAFE_componentWillReceiveProps!="function"&&typeof P.componentWillReceiveProps!="function"||(W!==g||Z!==xe)&&Nc(a,P,g,xe),So=!1;var Fe=a.memoizedState;P.state=Fe,wc(a,g,P,_),Z=a.memoizedState,W!==g||Fe!==Z||Rs.current||So?(typeof je=="function"&&(af(a,h,je,g),Z=a.memoizedState),(W=So||ap(a,h,W,g,Fe,Z,xe))?(De||typeof P.UNSAFE_componentWillMount!="function"&&typeof P.componentWillMount!="function"||(typeof P.componentWillMount=="function"&&P.componentWillMount(),typeof P.UNSAFE_componentWillMount=="function"&&P.UNSAFE_componentWillMount()),typeof P.componentDidMount=="function"&&(a.flags|=4194308)):(typeof P.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=g,a.memoizedState=Z),P.props=g,P.state=Z,P.context=xe,g=W):(typeof P.componentDidMount=="function"&&(a.flags|=4194308),g=!1)}else{P=a.stateNode,Lg(o,a),W=a.memoizedProps,xe=a.type===a.elementType?W:ko(a.type,W),P.props=xe,De=a.pendingProps,Fe=P.context,Z=h.contextType,typeof Z=="object"&&Z!==null?Z=_o(Z):(Z=Is(h)?ds:ts.current,Z=vc(a,Z));var Ze=h.getDerivedStateFromProps;(je=typeof Ze=="function"||typeof P.getSnapshotBeforeUpdate=="function")||typeof P.UNSAFE_componentWillReceiveProps!="function"&&typeof P.componentWillReceiveProps!="function"||(W!==De||Fe!==Z)&&Nc(a,P,g,Z),So=!1,Fe=a.memoizedState,P.state=Fe,wc(a,g,P,_);var lt=a.memoizedState;W!==De||Fe!==lt||Rs.current||So?(typeof Ze=="function"&&(af(a,h,Ze,g),lt=a.memoizedState),(xe=So||ap(a,h,xe,g,Fe,lt,Z)||!1)?(je||typeof P.UNSAFE_componentWillUpdate!="function"&&typeof P.componentWillUpdate!="function"||(typeof P.componentWillUpdate=="function"&&P.componentWillUpdate(g,lt,Z),typeof P.UNSAFE_componentWillUpdate=="function"&&P.UNSAFE_componentWillUpdate(g,lt,Z)),typeof P.componentDidUpdate=="function"&&(a.flags|=4),typeof P.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof P.componentDidUpdate!="function"||W===o.memoizedProps&&Fe===o.memoizedState||(a.flags|=4),typeof P.getSnapshotBeforeUpdate!="function"||W===o.memoizedProps&&Fe===o.memoizedState||(a.flags|=1024),a.memoizedProps=g,a.memoizedState=lt),P.props=g,P.state=lt,P.context=Z,g=xe):(typeof P.componentDidUpdate!="function"||W===o.memoizedProps&&Fe===o.memoizedState||(a.flags|=4),typeof P.getSnapshotBeforeUpdate!="function"||W===o.memoizedProps&&Fe===o.memoizedState||(a.flags|=1024),g=!1)}return mp(o,a,h,g,k,_)}function mp(o,a,h,g,_,k){fp(o,a);var P=(a.flags&128)!==0;if(!g&&!P)return _&&Ig(a,h,!1),Go(o,a,k);g=a.stateNode,df.current=a;var W=P&&typeof h.getDerivedStateFromError!="function"?null:g.render();return a.flags|=1,o!==null&&P?(a.child=un(a,o.child,null,k),a.child=un(a,null,W,k)):Hn(o,a,W,k),a.memoizedState=g.state,_&&Ig(a,h,!0),a.child}function Kg(o){var a=o.stateNode;a.pendingContext?Ag(o,a.pendingContext,a.pendingContext!==a.context):a.context&&Ag(o,a.context,!1),Kh(o,a.containerInfo)}function Ci(o,a,h,g,_){return xi(),wi(_),a.flags|=256,Hn(o,a,h,g),a.child}var Du={dehydrated:null,treeContext:null,retryLane:0};function Lu(o){return{baseLanes:o,cachePool:null,transitions:null}}function ff(o,a,h){var g=a.pendingProps,_=en.current,k=!1,P=(a.flags&128)!==0,W;if((W=P)||(W=o!==null&&o.memoizedState===null?!1:(_&2)!==0),W?(k=!0,a.flags&=-129):(o===null||o.memoizedState!==null)&&(_|=1),Br(en,_&1),o===null)return Ps(a),o=a.memoizedState,o!==null&&(o=o.dehydrated,o!==null)?((a.mode&1)===0?a.lanes=1:o.data==="$!"?a.lanes=8:a.lanes=1073741824,null):(P=g.children,o=g.fallback,k?(g=a.mode,k=a.child,P={mode:"hidden",children:P},(g&1)===0&&k!==null?(k.childLanes=0,k.pendingProps=P):k=Tf(P,g,0,null),o=Nl(o,g,h,null),k.return=a,o.return=a,k.sibling=o,a.child=k,a.child.memoizedState=Lu(h),a.memoizedState=Du,o):Ac(a,P));if(_=o.memoizedState,_!==null&&(W=_.dehydrated,W!==null))return Dt(o,a,P,g,W,_,h);if(k){k=g.fallback,P=a.mode,_=o.child,W=_.sibling;var Z={mode:"hidden",children:g.children};return(P&1)===0&&a.child!==_?(g=a.child,g.childLanes=0,g.pendingProps=Z,a.deletions=null):(g=Yo(_,Z),g.subtreeFlags=_.subtreeFlags&14680064),W!==null?k=Yo(W,k):(k=Nl(k,P,h,null),k.flags|=2),k.return=a,g.return=a,g.sibling=k,a.child=g,g=k,k=a.child,P=o.child.memoizedState,P=P===null?Lu(h):{baseLanes:P.baseLanes|h,cachePool:null,transitions:P.transitions},k.memoizedState=P,k.childLanes=o.childLanes&~h,a.memoizedState=Du,g}return k=o.child,o=k.sibling,g=Yo(k,{mode:"visible",children:g.children}),(a.mode&1)===0&&(g.lanes=h),g.return=a,g.sibling=null,o!==null&&(h=a.deletions,h===null?(a.deletions=[o],a.flags|=16):h.push(o)),a.child=g,a.memoizedState=null,g}function Ac(o,a){return a=Tf({mode:"visible",children:a},o.mode,0,null),a.return=o,o.child=a}function Zi(o,a,h,g){return g!==null&&wi(g),un(a,o.child,null,h),o=Ac(a,a.pendingProps.children),o.flags|=2,a.memoizedState=null,o}function Dt(o,a,h,g,_,k,P){if(h)return a.flags&256?(a.flags&=-257,g=cf(Error(t(422))),Zi(o,a,P,g)):a.memoizedState!==null?(a.child=o.child,a.flags|=128,null):(k=g.fallback,_=a.mode,g=Tf({mode:"visible",children:g.children},_,0,null),k=Nl(k,_,P,null),k.flags|=2,g.return=a,k.return=a,g.sibling=k,a.child=g,(a.mode&1)!==0&&un(a,o.child,null,P),a.child.memoizedState=Lu(P),a.memoizedState=Du,k);if((a.mode&1)===0)return Zi(o,a,P,null);if(_.data==="$!"){if(g=_.nextSibling&&_.nextSibling.dataset,g)var W=g.dgst;return g=W,k=Error(t(419)),g=cf(k,g,void 0),Zi(o,a,P,g)}if(W=(P&o.childLanes)!==0,hs||W){if(g=Fn,g!==null){switch(P&-P){case 4:_=2;break;case 16:_=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:_=32;break;case 536870912:_=268435456;break;default:_=0}_=(_&(g.suspendedLanes|P))!==0?0:_,_!==0&&_!==k.retryLane&&(k.retryLane=_,Ki(o,_),Ko(g,o,_,-1))}return Rp(),g=cf(Error(t(421))),Zi(o,a,P,g)}return _.data==="$?"?(a.flags|=128,a.child=o.child,a=L0.bind(null,o),_._reactRetry=a,null):(o=k.treeContext,eo=_a(_.nextSibling),ns=a,Yr=!0,Ho=null,o!==null&&(wo[bo++]=gi,wo[bo++]=vi,wo[bo++]=hl,gi=o.id,vi=o.overflow,hl=a),a=Ac(a,g.children),a.flags|=4096,a)}function Mu(o,a,h){o.lanes|=a;var g=o.alternate;g!==null&&(g.lanes|=a),zn(o.return,a,h)}function $u(o,a,h,g,_){var k=o.memoizedState;k===null?o.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:g,tail:h,tailMode:_}:(k.isBackwards=a,k.rendering=null,k.renderingStartTime=0,k.last=g,k.tail=h,k.tailMode=_)}function Ra(o,a,h){var g=a.pendingProps,_=g.revealOrder,k=g.tail;if(Hn(o,a,g.children,h),g=en.current,(g&2)!==0)g=g&1|2,a.flags|=128;else{if(o!==null&&(o.flags&128)!==0)e:for(o=a.child;o!==null;){if(o.tag===13)o.memoizedState!==null&&Mu(o,h,a);else if(o.tag===19)Mu(o,h,a);else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===a)break e;for(;o.sibling===null;){if(o.return===null||o.return===a)break e;o=o.return}o.sibling.return=o.return,o=o.sibling}g&=1}if(Br(en,g),(a.mode&1)===0)a.memoizedState=null;else switch(_){case"forwards":for(h=a.child,_=null;h!==null;)o=h.alternate,o!==null&&yl(o)===null&&(_=h),h=h.sibling;h=_,h===null?(_=a.child,a.child=null):(_=h.sibling,h.sibling=null),$u(a,!1,_,h,k);break;case"backwards":for(h=null,_=a.child,a.child=null;_!==null;){if(o=_.alternate,o!==null&&yl(o)===null){a.child=_;break}o=_.sibling,_.sibling=h,h=_,_=o}$u(a,!0,h,null,k);break;case"together":$u(a,!1,null,null,void 0);break;default:a.memoizedState=null}return a.child}function hf(o,a){(a.mode&1)===0&&o!==null&&(o.alternate=null,a.alternate=null,a.flags|=2)}function Go(o,a,h){if(o!==null&&(a.dependencies=o.dependencies),Pa|=a.lanes,(h&a.childLanes)===0)return null;if(o!==null&&a.child!==o.child)throw Error(t(153));if(a.child!==null){for(o=a.child,h=Yo(o,o.pendingProps),a.child=h,h.return=a;o.sibling!==null;)o=o.sibling,h=h.sibling=Yo(o,o.pendingProps),h.return=a;h.sibling=null}return a.child}function Yg(o,a,h){switch(a.tag){case 3:Kg(a),xi();break;case 5:Yh(a);break;case 1:Is(a.type)&&xo(a);break;case 4:Kh(a,a.stateNode.containerInfo);break;case 10:var g=a.type._context,_=a.memoizedProps.value;Br(ku,g._currentValue),g._currentValue=_;break;case 13:if(g=a.memoizedState,g!==null)return g.dehydrated!==null?(Br(en,en.current&1),a.flags|=128,null):(h&a.child.childLanes)!==0?ff(o,a,h):(Br(en,en.current&1),o=Go(o,a,h),o!==null?o.sibling:null);Br(en,en.current&1);break;case 19:if(g=(h&a.childLanes)!==0,(o.flags&128)!==0){if(g)return Ra(o,a,h);a.flags|=128}if(_=a.memoizedState,_!==null&&(_.rendering=null,_.tail=null,_.lastEffect=null),Br(en,en.current),g)break;return null;case 22:case 23:return a.lanes=0,dp(o,a,h)}return Go(o,a,h)}var Bn,gp,Jg,vp;Bn=function(o,a){for(var h=a.child;h!==null;){if(h.tag===5||h.tag===6)o.appendChild(h.stateNode);else if(h.tag!==4&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===a)break;for(;h.sibling===null;){if(h.return===null||h.return===a)return;h=h.return}h.sibling.return=h.return,h=h.sibling}},gp=function(){},Jg=function(o,a,h,g){var _=o.memoizedProps;if(_!==g){o=a.stateNode,Ji(bi.current);var k=null;switch(h){case"input":_=qe(o,_),g=qe(o,g),k=[];break;case"select":_=X({},_,{value:void 0}),g=X({},g,{value:void 0}),k=[];break;case"textarea":_=hr(o,_),g=hr(o,g),k=[];break;default:typeof _.onClick!="function"&&typeof g.onClick=="function"&&(o.onclick=Ld)}Ue(h,g);var P;h=null;for(xe in _)if(!g.hasOwnProperty(xe)&&_.hasOwnProperty(xe)&&_[xe]!=null)if(xe==="style"){var W=_[xe];for(P in W)W.hasOwnProperty(P)&&(h||(h={}),h[P]="")}else xe!=="dangerouslySetInnerHTML"&&xe!=="children"&&xe!=="suppressContentEditableWarning"&&xe!=="suppressHydrationWarning"&&xe!=="autoFocus"&&(s.hasOwnProperty(xe)?k||(k=[]):(k=k||[]).push(xe,null));for(xe in g){var Z=g[xe];if(W=_!=null?_[xe]:void 0,g.hasOwnProperty(xe)&&Z!==W&&(Z!=null||W!=null))if(xe==="style")if(W){for(P in W)!W.hasOwnProperty(P)||Z&&Z.hasOwnProperty(P)||(h||(h={}),h[P]="");for(P in Z)Z.hasOwnProperty(P)&&W[P]!==Z[P]&&(h||(h={}),h[P]=Z[P])}else h||(k||(k=[]),k.push(xe,h)),h=Z;else xe==="dangerouslySetInnerHTML"?(Z=Z?Z.__html:void 0,W=W?W.__html:void 0,Z!=null&&W!==Z&&(k=k||[]).push(xe,Z)):xe==="children"?typeof Z!="string"&&typeof Z!="number"||(k=k||[]).push(xe,""+Z):xe!=="suppressContentEditableWarning"&&xe!=="suppressHydrationWarning"&&(s.hasOwnProperty(xe)?(Z!=null&&xe==="onScroll"&&qr("scroll",o),k||W===Z||(k=[])):(k=k||[]).push(xe,Z))}h&&(k=k||[]).push("style",h);var xe=k;(a.updateQueue=xe)&&(a.flags|=4)}},vp=function(o,a,h,g){h!==g&&(a.flags|=4)};function Uu(o,a){if(!Yr)switch(o.tailMode){case"hidden":a=o.tail;for(var h=null;a!==null;)a.alternate!==null&&(h=a),a=a.sibling;h===null?o.tail=null:h.sibling=null;break;case"collapsed":h=o.tail;for(var g=null;h!==null;)h.alternate!==null&&(g=h),h=h.sibling;g===null?a||o.tail===null?o.tail=null:o.tail.sibling=null:g.sibling=null}}function Gn(o){var a=o.alternate!==null&&o.alternate.child===o.child,h=0,g=0;if(a)for(var _=o.child;_!==null;)h|=_.lanes|_.childLanes,g|=_.subtreeFlags&14680064,g|=_.flags&14680064,_.return=o,_=_.sibling;else for(_=o.child;_!==null;)h|=_.lanes|_.childLanes,g|=_.subtreeFlags,g|=_.flags,_.return=o,_=_.sibling;return o.subtreeFlags|=g,o.childLanes=h,a}function A0(o,a,h){var g=a.pendingProps;switch(ml(a),a.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Gn(a),null;case 1:return Is(a.type)&&zd(),Gn(a),null;case 3:return g=a.stateNode,Ta(),Kr(Rs),Kr(ts),Qd(),g.pendingContext&&(g.context=g.pendingContext,g.pendingContext=null),(o===null||o.child===null)&&(Eu(a)?a.flags|=4:o===null||o.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,Ho!==null&&(Np(Ho),Ho=null))),gp(o,a),Gn(a),null;case 5:Xd(a);var _=Ji(bc.current);if(h=a.type,o!==null&&a.stateNode!=null)Jg(o,a,h,g,_),o.ref!==a.ref&&(a.flags|=512,a.flags|=2097152);else{if(!g){if(a.stateNode===null)throw Error(t(166));return Gn(a),null}if(o=Ji(bi.current),Eu(a)){g=a.stateNode,h=a.type;var k=a.memoizedProps;switch(g[pi]=a,g[Sa]=k,o=(a.mode&1)!==0,h){case"dialog":qr("cancel",g),qr("close",g);break;case"iframe":case"object":case"embed":qr("load",g);break;case"video":case"audio":for(_=0;_<Gi.length;_++)qr(Gi[_],g);break;case"source":qr("error",g);break;case"img":case"image":case"link":qr("error",g),qr("load",g);break;case"details":qr("toggle",g);break;case"input":Ne(g,k),qr("invalid",g);break;case"select":g._wrapperState={wasMultiple:!!k.multiple},qr("invalid",g);break;case"textarea":Ur(g,k),qr("invalid",g)}Ue(h,k),_=null;for(var P in k)if(k.hasOwnProperty(P)){var W=k[P];P==="children"?typeof W=="string"?g.textContent!==W&&(k.suppressHydrationWarning!==!0&&xu(g.textContent,W,o),_=["children",W]):typeof W=="number"&&g.textContent!==""+W&&(k.suppressHydrationWarning!==!0&&xu(g.textContent,W,o),_=["children",""+W]):s.hasOwnProperty(P)&&W!=null&&P==="onScroll"&&qr("scroll",g)}switch(h){case"input":_t(g),Ct(g,k,!0);break;case"textarea":_t(g),kr(g);break;case"select":case"option":break;default:typeof k.onClick=="function"&&(g.onclick=Ld)}g=_,a.updateQueue=g,g!==null&&(a.flags|=4)}else{P=_.nodeType===9?_:_.ownerDocument,o==="http://www.w3.org/1999/xhtml"&&(o=ge(h)),o==="http://www.w3.org/1999/xhtml"?h==="script"?(o=P.createElement("div"),o.innerHTML="<script><\/script>",o=o.removeChild(o.firstChild)):typeof g.is=="string"?o=P.createElement(h,{is:g.is}):(o=P.createElement(h),h==="select"&&(P=o,g.multiple?P.multiple=!0:g.size&&(P.size=g.size))):o=P.createElementNS(o,h),o[pi]=a,o[Sa]=g,Bn(o,a,!1,!1),a.stateNode=o;e:{switch(P=rr(h,g),h){case"dialog":qr("cancel",o),qr("close",o),_=g;break;case"iframe":case"object":case"embed":qr("load",o),_=g;break;case"video":case"audio":for(_=0;_<Gi.length;_++)qr(Gi[_],o);_=g;break;case"source":qr("error",o),_=g;break;case"img":case"image":case"link":qr("error",o),qr("load",o),_=g;break;case"details":qr("toggle",o),_=g;break;case"input":Ne(o,g),_=qe(o,g),qr("invalid",o);break;case"option":_=g;break;case"select":o._wrapperState={wasMultiple:!!g.multiple},_=X({},g,{value:void 0}),qr("invalid",o);break;case"textarea":Ur(o,g),_=hr(o,g),qr("invalid",o);break;default:_=g}Ue(h,_),W=_;for(k in W)if(W.hasOwnProperty(k)){var Z=W[k];k==="style"?ft(o,Z):k==="dangerouslySetInnerHTML"?(Z=Z?Z.__html:void 0,Z!=null&&wt(o,Z)):k==="children"?typeof Z=="string"?(h!=="textarea"||Z!=="")&&ze(o,Z):typeof Z=="number"&&ze(o,""+Z):k!=="suppressContentEditableWarning"&&k!=="suppressHydrationWarning"&&k!=="autoFocus"&&(s.hasOwnProperty(k)?Z!=null&&k==="onScroll"&&qr("scroll",o):Z!=null&&F(o,k,Z,P))}switch(h){case"input":_t(o),Ct(o,g,!1);break;case"textarea":_t(o),kr(o);break;case"option":g.value!=null&&o.setAttribute("value",""+he(g.value));break;case"select":o.multiple=!!g.multiple,k=g.value,k!=null?Kt(o,!!g.multiple,k,!1):g.defaultValue!=null&&Kt(o,!!g.multiple,g.defaultValue,!0);break;default:typeof _.onClick=="function"&&(o.onclick=Ld)}switch(h){case"button":case"input":case"select":case"textarea":g=!!g.autoFocus;break e;case"img":g=!0;break e;default:g=!1}}g&&(a.flags|=4)}a.ref!==null&&(a.flags|=512,a.flags|=2097152)}return Gn(a),null;case 6:if(o&&a.stateNode!=null)vp(o,a,o.memoizedProps,g);else{if(typeof g!="string"&&a.stateNode===null)throw Error(t(166));if(h=Ji(bc.current),Ji(bi.current),Eu(a)){if(g=a.stateNode,h=a.memoizedProps,g[pi]=a,(k=g.nodeValue!==h)&&(o=ns,o!==null))switch(o.tag){case 3:xu(g.nodeValue,h,(o.mode&1)!==0);break;case 5:o.memoizedProps.suppressHydrationWarning!==!0&&xu(g.nodeValue,h,(o.mode&1)!==0)}k&&(a.flags|=4)}else g=(h.nodeType===9?h:h.ownerDocument).createTextNode(g),g[pi]=a,a.stateNode=g}return Gn(a),null;case 13:if(Kr(en),g=a.memoizedState,o===null||o.memoizedState!==null&&o.memoizedState.dehydrated!==null){if(Yr&&eo!==null&&(a.mode&1)!==0&&(a.flags&128)===0)Gh(),xi(),a.flags|=98560,k=!1;else if(k=Eu(a),g!==null&&g.dehydrated!==null){if(o===null){if(!k)throw Error(t(318));if(k=a.memoizedState,k=k!==null?k.dehydrated:null,!k)throw Error(t(317));k[pi]=a}else xi(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;Gn(a),k=!1}else Ho!==null&&(Np(Ho),Ho=null),k=!0;if(!k)return a.flags&65536?a:null}return(a.flags&128)!==0?(a.lanes=h,a):(g=g!==null,g!==(o!==null&&o.memoizedState!==null)&&g&&(a.child.flags|=8192,(a.mode&1)!==0&&(o===null||(en.current&1)!==0?kn===0&&(kn=3):Rp())),a.updateQueue!==null&&(a.flags|=4),Gn(a),null);case 4:return Ta(),gp(o,a),o===null&&wa(a.stateNode.containerInfo),Gn(a),null;case 10:return qd(a.type._context),Gn(a),null;case 17:return Is(a.type)&&zd(),Gn(a),null;case 19:if(Kr(en),k=a.memoizedState,k===null)return Gn(a),null;if(g=(a.flags&128)!==0,P=k.rendering,P===null)if(g)Uu(k,!1);else{if(kn!==0||o!==null&&(o.flags&128)!==0)for(o=a.child;o!==null;){if(P=yl(o),P!==null){for(a.flags|=128,Uu(k,!1),g=P.updateQueue,g!==null&&(a.updateQueue=g,a.flags|=4),a.subtreeFlags=0,g=h,h=a.child;h!==null;)k=h,o=g,k.flags&=14680066,P=k.alternate,P===null?(k.childLanes=0,k.lanes=o,k.child=null,k.subtreeFlags=0,k.memoizedProps=null,k.memoizedState=null,k.updateQueue=null,k.dependencies=null,k.stateNode=null):(k.childLanes=P.childLanes,k.lanes=P.lanes,k.child=P.child,k.subtreeFlags=0,k.deletions=null,k.memoizedProps=P.memoizedProps,k.memoizedState=P.memoizedState,k.updateQueue=P.updateQueue,k.type=P.type,o=P.dependencies,k.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),h=h.sibling;return Br(en,en.current&1|2),a.child}o=o.sibling}k.tail!==null&&Yt()>Sl&&(a.flags|=128,g=!0,Uu(k,!1),a.lanes=4194304)}else{if(!g)if(o=yl(P),o!==null){if(a.flags|=128,g=!0,h=o.updateQueue,h!==null&&(a.updateQueue=h,a.flags|=4),Uu(k,!0),k.tail===null&&k.tailMode==="hidden"&&!P.alternate&&!Yr)return Gn(a),null}else 2*Yt()-k.renderingStartTime>Sl&&h!==1073741824&&(a.flags|=128,g=!0,Uu(k,!1),a.lanes=4194304);k.isBackwards?(P.sibling=a.child,a.child=P):(h=k.last,h!==null?h.sibling=P:a.child=P,k.last=P)}return k.tail!==null?(a=k.tail,k.rendering=a,k.tail=a.sibling,k.renderingStartTime=Yt(),a.sibling=null,h=en.current,Br(en,g?h&1|2:h&1),a):(Gn(a),null);case 22:case 23:return Ap(),g=a.memoizedState!==null,o!==null&&o.memoizedState!==null!==g&&(a.flags|=8192),g&&(a.mode&1)!==0?(no&1073741824)!==0&&(Gn(a),a.subtreeFlags&6&&(a.flags|=8192)):Gn(a),null;case 24:return null;case 25:return null}throw Error(t(156,a.tag))}function R0(o,a){switch(ml(a),a.tag){case 1:return Is(a.type)&&zd(),o=a.flags,o&65536?(a.flags=o&-65537|128,a):null;case 3:return Ta(),Kr(Rs),Kr(ts),Qd(),o=a.flags,(o&65536)!==0&&(o&128)===0?(a.flags=o&-65537|128,a):null;case 5:return Xd(a),null;case 13:if(Kr(en),o=a.memoizedState,o!==null&&o.dehydrated!==null){if(a.alternate===null)throw Error(t(340));xi()}return o=a.flags,o&65536?(a.flags=o&-65537|128,a):null;case 19:return Kr(en),null;case 4:return Ta(),null;case 10:return qd(a.type._context),null;case 22:case 23:return Ap(),null;case 24:return null;default:return null}}var pf=!1,tn=!1,ps=typeof WeakSet=="function"?WeakSet:Set,ot=null;function Rc(o,a){var h=o.ref;if(h!==null)if(typeof h=="function")try{h(null)}catch(g){sn(o,a,g)}else h.current=null}function zu(o,a,h){try{h()}catch(g){sn(o,a,g)}}var Xg=!1;function I0(o,a){if(wu=Ui,o=Or(),hu(o)){if("selectionStart"in o)var h={start:o.selectionStart,end:o.selectionEnd};else e:{h=(h=o.ownerDocument)&&h.defaultView||window;var g=h.getSelection&&h.getSelection();if(g&&g.rangeCount!==0){h=g.anchorNode;var _=g.anchorOffset,k=g.focusNode;g=g.focusOffset;try{h.nodeType,k.nodeType}catch{h=null;break e}var P=0,W=-1,Z=-1,xe=0,je=0,De=o,Fe=null;t:for(;;){for(var Ze;De!==h||_!==0&&De.nodeType!==3||(W=P+_),De!==k||g!==0&&De.nodeType!==3||(Z=P+g),De.nodeType===3&&(P+=De.nodeValue.length),(Ze=De.firstChild)!==null;)Fe=De,De=Ze;for(;;){if(De===o)break t;if(Fe===h&&++xe===_&&(W=P),Fe===k&&++je===g&&(Z=P),(Ze=De.nextSibling)!==null)break;De=Fe,Fe=De.parentNode}De=Ze}h=W===-1||Z===-1?null:{start:W,end:Z}}else h=null}h=h||{start:0,end:0}}else h=null;for(dl={focusedElem:o,selectionRange:h},Ui=!1,ot=a;ot!==null;)if(a=ot,o=a.child,(a.subtreeFlags&1028)!==0&&o!==null)o.return=a,ot=o;else for(;ot!==null;){a=ot;try{var lt=a.alternate;if((a.flags&1024)!==0)switch(a.tag){case 0:case 11:case 15:break;case 1:if(lt!==null){var dt=lt.memoizedProps,pn=lt.memoizedState,pe=a.stateNode,ie=pe.getSnapshotBeforeUpdate(a.elementType===a.type?dt:ko(a.type,dt),pn);pe.__reactInternalSnapshotBeforeUpdate=ie}break;case 3:var ve=a.stateNode.containerInfo;ve.nodeType===1?ve.textContent="":ve.nodeType===9&&ve.documentElement&&ve.removeChild(ve.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch($e){sn(a,a.return,$e)}if(o=a.sibling,o!==null){o.return=a.return,ot=o;break}ot=a.return}return lt=Xg,Xg=!1,lt}function ea(o,a,h){var g=a.updateQueue;if(g=g!==null?g.lastEffect:null,g!==null){var _=g=g.next;do{if((_.tag&o)===o){var k=_.destroy;_.destroy=void 0,k!==void 0&&zu(a,h,k)}_=_.next}while(_!==g)}}function Hu(o,a){if(a=a.updateQueue,a=a!==null?a.lastEffect:null,a!==null){var h=a=a.next;do{if((h.tag&o)===o){var g=h.create;h.destroy=g()}h=h.next}while(h!==a)}}function mf(o){var a=o.ref;if(a!==null){var h=o.stateNode;switch(o.tag){case 5:o=h;break;default:o=h}typeof a=="function"?a(o):a.current=o}}function Qg(o){var a=o.alternate;a!==null&&(o.alternate=null,Qg(a)),o.child=null,o.deletions=null,o.sibling=null,o.tag===5&&(a=o.stateNode,a!==null&&(delete a[pi],delete a[Sa],delete a[$d],delete a[D],delete a[mc])),o.stateNode=null,o.return=null,o.dependencies=null,o.memoizedProps=null,o.memoizedState=null,o.pendingProps=null,o.stateNode=null,o.updateQueue=null}function Zg(o){return o.tag===5||o.tag===3||o.tag===4}function ev(o){e:for(;;){for(;o.sibling===null;){if(o.return===null||Zg(o.return))return null;o=o.return}for(o.sibling.return=o.return,o=o.sibling;o.tag!==5&&o.tag!==6&&o.tag!==18;){if(o.flags&2||o.child===null||o.tag===4)continue e;o.child.return=o,o=o.child}if(!(o.flags&2))return o.stateNode}}function yp(o,a,h){var g=o.tag;if(g===5||g===6)o=o.stateNode,a?h.nodeType===8?h.parentNode.insertBefore(o,a):h.insertBefore(o,a):(h.nodeType===8?(a=h.parentNode,a.insertBefore(o,h)):(a=h,a.appendChild(o)),h=h._reactRootContainer,h!=null||a.onclick!==null||(a.onclick=Ld));else if(g!==4&&(o=o.child,o!==null))for(yp(o,a,h),o=o.sibling;o!==null;)yp(o,a,h),o=o.sibling}function gf(o,a,h){var g=o.tag;if(g===5||g===6)o=o.stateNode,a?h.insertBefore(o,a):h.appendChild(o);else if(g!==4&&(o=o.child,o!==null))for(gf(o,a,h),o=o.sibling;o!==null;)gf(o,a,h),o=o.sibling}var Pn=null,Wo=!1;function ki(o,a,h){for(h=h.child;h!==null;)xp(o,a,h),h=h.sibling}function xp(o,a,h){if(Jn&&typeof Jn.onCommitFiberUnmount=="function")try{Jn.onCommitFiberUnmount($o,h)}catch{}switch(h.tag){case 5:tn||Rc(h,a);case 6:var g=Pn,_=Wo;Pn=null,ki(o,a,h),Pn=g,Wo=_,Pn!==null&&(Wo?(o=Pn,h=h.stateNode,o.nodeType===8?o.parentNode.removeChild(h):o.removeChild(h)):Pn.removeChild(h.stateNode));break;case 18:Pn!==null&&(Wo?(o=Pn,h=h.stateNode,o.nodeType===8?zh(o.parentNode,h):o.nodeType===1&&zh(o,h),Qt(o)):zh(Pn,h.stateNode));break;case 4:g=Pn,_=Wo,Pn=h.stateNode.containerInfo,Wo=!0,ki(o,a,h),Pn=g,Wo=_;break;case 0:case 11:case 14:case 15:if(!tn&&(g=h.updateQueue,g!==null&&(g=g.lastEffect,g!==null))){_=g=g.next;do{var k=_,P=k.destroy;k=k.tag,P!==void 0&&((k&2)!==0||(k&4)!==0)&&zu(h,a,P),_=_.next}while(_!==g)}ki(o,a,h);break;case 1:if(!tn&&(Rc(h,a),g=h.stateNode,typeof g.componentWillUnmount=="function"))try{g.props=h.memoizedProps,g.state=h.memoizedState,g.componentWillUnmount()}catch(W){sn(h,a,W)}ki(o,a,h);break;case 21:ki(o,a,h);break;case 22:h.mode&1?(tn=(g=tn)||h.memoizedState!==null,ki(o,a,h),tn=g):ki(o,a,h);break;default:ki(o,a,h)}}function Ic(o){var a=o.updateQueue;if(a!==null){o.updateQueue=null;var h=o.stateNode;h===null&&(h=o.stateNode=new ps),a.forEach(function(g){var _=M0.bind(null,o,g);h.has(g)||(h.add(g),g.then(_,_))})}}function ro(o,a){var h=a.deletions;if(h!==null)for(var g=0;g<h.length;g++){var _=h[g];try{var k=o,P=a,W=P;e:for(;W!==null;){switch(W.tag){case 5:Pn=W.stateNode,Wo=!1;break e;case 3:Pn=W.stateNode.containerInfo,Wo=!0;break e;case 4:Pn=W.stateNode.containerInfo,Wo=!0;break e}W=W.return}if(Pn===null)throw Error(t(160));xp(k,P,_),Pn=null,Wo=!1;var Z=_.alternate;Z!==null&&(Z.return=null),_.return=null}catch(xe){sn(_,a,xe)}}if(a.subtreeFlags&12854)for(a=a.child;a!==null;)wp(a,o),a=a.sibling}function wp(o,a){var h=o.alternate,g=o.flags;switch(o.tag){case 0:case 11:case 14:case 15:if(ro(a,o),Vo(o),g&4){try{ea(3,o,o.return),Hu(3,o)}catch(dt){sn(o,o.return,dt)}try{ea(5,o,o.return)}catch(dt){sn(o,o.return,dt)}}break;case 1:ro(a,o),Vo(o),g&512&&h!==null&&Rc(h,h.return);break;case 5:if(ro(a,o),Vo(o),g&512&&h!==null&&Rc(h,h.return),o.flags&32){var _=o.stateNode;try{ze(_,"")}catch(dt){sn(o,o.return,dt)}}if(g&4&&(_=o.stateNode,_!=null)){var k=o.memoizedProps,P=h!==null?h.memoizedProps:k,W=o.type,Z=o.updateQueue;if(o.updateQueue=null,Z!==null)try{W==="input"&&k.type==="radio"&&k.name!=null&&St(_,k),rr(W,P);var xe=rr(W,k);for(P=0;P<Z.length;P+=2){var je=Z[P],De=Z[P+1];je==="style"?ft(_,De):je==="dangerouslySetInnerHTML"?wt(_,De):je==="children"?ze(_,De):F(_,je,De,xe)}switch(W){case"input":ct(_,k);break;case"textarea":zr(_,k);break;case"select":var Fe=_._wrapperState.wasMultiple;_._wrapperState.wasMultiple=!!k.multiple;var Ze=k.value;Ze!=null?Kt(_,!!k.multiple,Ze,!1):Fe!==!!k.multiple&&(k.defaultValue!=null?Kt(_,!!k.multiple,k.defaultValue,!0):Kt(_,!!k.multiple,k.multiple?[]:"",!1))}_[Sa]=k}catch(dt){sn(o,o.return,dt)}}break;case 6:if(ro(a,o),Vo(o),g&4){if(o.stateNode===null)throw Error(t(162));_=o.stateNode,k=o.memoizedProps;try{_.nodeValue=k}catch(dt){sn(o,o.return,dt)}}break;case 3:if(ro(a,o),Vo(o),g&4&&h!==null&&h.memoizedState.isDehydrated)try{Qt(a.containerInfo)}catch(dt){sn(o,o.return,dt)}break;case 4:ro(a,o),Vo(o);break;case 13:ro(a,o),Vo(o),_=o.child,_.flags&8192&&(k=_.memoizedState!==null,_.stateNode.isHidden=k,!k||_.alternate!==null&&_.alternate.memoizedState!==null||(Sp=Yt())),g&4&&Ic(o);break;case 22:if(je=h!==null&&h.memoizedState!==null,o.mode&1?(tn=(xe=tn)||je,ro(a,o),tn=xe):ro(a,o),Vo(o),g&8192){if(xe=o.memoizedState!==null,(o.stateNode.isHidden=xe)&&!je&&(o.mode&1)!==0)for(ot=o,je=o.child;je!==null;){for(De=ot=je;ot!==null;){switch(Fe=ot,Ze=Fe.child,Fe.tag){case 0:case 11:case 14:case 15:ea(4,Fe,Fe.return);break;case 1:Rc(Fe,Fe.return);var lt=Fe.stateNode;if(typeof lt.componentWillUnmount=="function"){g=Fe,h=Fe.return;try{a=g,lt.props=a.memoizedProps,lt.state=a.memoizedState,lt.componentWillUnmount()}catch(dt){sn(g,h,dt)}}break;case 5:Rc(Fe,Fe.return);break;case 22:if(Fe.memoizedState!==null){Ia(De);continue}}Ze!==null?(Ze.return=Fe,ot=Ze):Ia(De)}je=je.sibling}e:for(je=null,De=o;;){if(De.tag===5){if(je===null){je=De;try{_=De.stateNode,xe?(k=_.style,typeof k.setProperty=="function"?k.setProperty("display","none","important"):k.display="none"):(W=De.stateNode,Z=De.memoizedProps.style,P=Z!=null&&Z.hasOwnProperty("display")?Z.display:null,W.style.display=Re("display",P))}catch(dt){sn(o,o.return,dt)}}}else if(De.tag===6){if(je===null)try{De.stateNode.nodeValue=xe?"":De.memoizedProps}catch(dt){sn(o,o.return,dt)}}else if((De.tag!==22&&De.tag!==23||De.memoizedState===null||De===o)&&De.child!==null){De.child.return=De,De=De.child;continue}if(De===o)break e;for(;De.sibling===null;){if(De.return===null||De.return===o)break e;je===De&&(je=null),De=De.return}je===De&&(je=null),De.sibling.return=De.return,De=De.sibling}}break;case 19:ro(a,o),Vo(o),g&4&&Ic(o);break;case 21:break;default:ro(a,o),Vo(o)}}function Vo(o){var a=o.flags;if(a&2){try{e:{for(var h=o.return;h!==null;){if(Zg(h)){var g=h;break e}h=h.return}throw Error(t(160))}switch(g.tag){case 5:var _=g.stateNode;g.flags&32&&(ze(_,""),g.flags&=-33);var k=ev(o);gf(o,k,_);break;case 3:case 4:var P=g.stateNode.containerInfo,W=ev(o);yp(o,W,P);break;default:throw Error(t(161))}}catch(Z){sn(o,o.return,Z)}o.flags&=-3}a&4096&&(o.flags&=-4097)}function vf(o,a,h){ot=o,bp(o)}function bp(o,a,h){for(var g=(o.mode&1)!==0;ot!==null;){var _=ot,k=_.child;if(_.tag===22&&g){var P=_.memoizedState!==null||pf;if(!P){var W=_.alternate,Z=W!==null&&W.memoizedState!==null||tn;W=pf;var xe=tn;if(pf=P,(tn=Z)&&!xe)for(ot=_;ot!==null;)P=ot,Z=P.child,P.tag===22&&P.memoizedState!==null?tv(_):Z!==null?(Z.return=P,ot=Z):tv(_);for(;k!==null;)ot=k,bp(k),k=k.sibling;ot=_,pf=W,tn=xe}qo(o)}else(_.subtreeFlags&8772)!==0&&k!==null?(k.return=_,ot=k):qo(o)}}function qo(o){for(;ot!==null;){var a=ot;if((a.flags&8772)!==0){var h=a.alternate;try{if((a.flags&8772)!==0)switch(a.tag){case 0:case 11:case 15:tn||Hu(5,a);break;case 1:var g=a.stateNode;if(a.flags&4&&!tn)if(h===null)g.componentDidMount();else{var _=a.elementType===a.type?h.memoizedProps:ko(a.type,h.memoizedProps);g.componentDidUpdate(_,h.memoizedState,g.__reactInternalSnapshotBeforeUpdate)}var k=a.updateQueue;k!==null&&qh(a,k,g);break;case 3:var P=a.updateQueue;if(P!==null){if(h=null,a.child!==null)switch(a.child.tag){case 5:h=a.child.stateNode;break;case 1:h=a.child.stateNode}qh(a,P,h)}break;case 5:var W=a.stateNode;if(h===null&&a.flags&4){h=W;var Z=a.memoizedProps;switch(a.type){case"button":case"input":case"select":case"textarea":Z.autoFocus&&h.focus();break;case"img":Z.src&&(h.src=Z.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(a.memoizedState===null){var xe=a.alternate;if(xe!==null){var je=xe.memoizedState;if(je!==null){var De=je.dehydrated;De!==null&&Qt(De)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}tn||a.flags&512&&mf(a)}catch(Fe){sn(a,a.return,Fe)}}if(a===o){ot=null;break}if(h=a.sibling,h!==null){h.return=a.return,ot=h;break}ot=a.return}}function Ia(o){for(;ot!==null;){var a=ot;if(a===o){ot=null;break}var h=a.sibling;if(h!==null){h.return=a.return,ot=h;break}ot=a.return}}function tv(o){for(;ot!==null;){var a=ot;try{switch(a.tag){case 0:case 11:case 15:var h=a.return;try{Hu(4,a)}catch(Z){sn(a,h,Z)}break;case 1:var g=a.stateNode;if(typeof g.componentDidMount=="function"){var _=a.return;try{g.componentDidMount()}catch(Z){sn(a,_,Z)}}var k=a.return;try{mf(a)}catch(Z){sn(a,k,Z)}break;case 5:var P=a.return;try{mf(a)}catch(Z){sn(a,P,Z)}}}catch(Z){sn(a,a.return,Z)}if(a===o){ot=null;break}var W=a.sibling;if(W!==null){W.return=a.return,ot=W;break}ot=a.return}}var rv=Math.ceil,yf=j.ReactCurrentDispatcher,_p=j.ReactCurrentOwner,No=j.ReactCurrentBatchConfig,wr=0,Fn=null,bn=null,Wn=0,no=0,Pc=As(0),kn=0,Bu=null,Pa=0,Gu=0,xf=0,Wu=null,js=null,Sp=0,Sl=1/0,ta=null,wf=!1,Ep=null,Fa=null,bf=!1,ja=null,ms=0,Vu=0,Cp=null,_f=-1,qu=0;function gs(){return(wr&6)!==0?Yt():_f!==-1?_f:_f=Yt()}function Oa(o){return(o.mode&1)===0?1:(wr&2)!==0&&Wn!==0?Wn&-Wn:Og.transition!==null?(qu===0&&(qu=au()),qu):(o=yr,o!==0||(o=window.event,o=o===void 0?16:ag(o.type)),o)}function Ko(o,a,h,g){if(50<Vu)throw Vu=0,Cp=null,Error(t(185));rl(o,h,g),((wr&2)===0||o!==Fn)&&(o===Fn&&((wr&2)===0&&(Gu|=h),kn===4&&Da(o,Wn)),Os(o,g),h===1&&wr===0&&(a.mode&1)===0&&(Sl=Yt()+500,Hd&&Ca()))}function Os(o,a){var h=o.callbackNode;Sh(o,a);var g=Ks(o,o===Fn?Wn:0);if(g===0)h!==null&&Le(h),o.callbackNode=null,o.callbackPriority=0;else if(a=g&-g,o.callbackPriority!==a){if(h!=null&&Le(h),a===1)o.tag===0?fl(nv.bind(null,o)):Pg(nv.bind(null,o)),Md(function(){(wr&6)===0&&Ca()}),h=null;else{switch(Ys(g)){case 1:h=fn;break;case 4:h=ls;break;case 16:h=ks;break;case 536870912:h=Vr;break;default:h=ks}h=uv(h,Sf.bind(null,o))}o.callbackPriority=a,o.callbackNode=h}}function Sf(o,a){if(_f=-1,qu=0,(wr&6)!==0)throw Error(t(327));var h=o.callbackNode;if(Fc()&&o.callbackNode!==h)return null;var g=Ks(o,o===Fn?Wn:0);if(g===0)return null;if((g&30)!==0||(g&o.expiredLanes)!==0||a)a=Ef(o,g);else{a=g;var _=wr;wr|=2;var k=ov();(Fn!==o||Wn!==a)&&(ta=null,Sl=Yt()+500,Cl(o,a));do try{j0();break}catch(W){sv(o,W)}while(!0);qi(),yf.current=k,wr=_,bn!==null?a=0:(Fn=null,Wn=0,a=kn)}if(a!==0){if(a===2&&(_=Zl(o),_!==0&&(g=_,a=kp(o,_))),a===1)throw h=Bu,Cl(o,0),Da(o,g),Os(o,Yt()),h;if(a===6)Da(o,g);else{if(_=o.current.alternate,(g&30)===0&&!P0(_)&&(a=Ef(o,g),a===2&&(k=Zl(o),k!==0&&(g=k,a=kp(o,k))),a===1))throw h=Bu,Cl(o,0),Da(o,g),Os(o,Yt()),h;switch(o.finishedWork=_,o.finishedLanes=g,a){case 0:case 1:throw Error(t(345));case 2:kl(o,js,ta);break;case 3:if(Da(o,g),(g&130023424)===g&&(a=Sp+500-Yt(),10<a)){if(Ks(o,0)!==0)break;if(_=o.suspendedLanes,(_&g)!==g){gs(),o.pingedLanes|=o.suspendedLanes&_;break}o.timeoutHandle=ba(kl.bind(null,o,js,ta),a);break}kl(o,js,ta);break;case 4:if(Da(o,g),(g&4194240)===g)break;for(a=o.eventTimes,_=-1;0<g;){var P=31-Ns(g);k=1<<P,P=a[P],P>_&&(_=P),g&=~k}if(g=_,g=Yt()-g,g=(120>g?120:480>g?480:1080>g?1080:1920>g?1920:3e3>g?3e3:4320>g?4320:1960*rv(g/1960))-g,10<g){o.timeoutHandle=ba(kl.bind(null,o,js,ta),g);break}kl(o,js,ta);break;case 5:kl(o,js,ta);break;default:throw Error(t(329))}}}return Os(o,Yt()),o.callbackNode===h?Sf.bind(null,o):null}function kp(o,a){var h=Wu;return o.current.memoizedState.isDehydrated&&(Cl(o,a).flags|=256),o=Ef(o,a),o!==2&&(a=js,js=h,a!==null&&Np(a)),o}function Np(o){js===null?js=o:js.push.apply(js,o)}function P0(o){for(var a=o;;){if(a.flags&16384){var h=a.updateQueue;if(h!==null&&(h=h.stores,h!==null))for(var g=0;g<h.length;g++){var _=h[g],k=_.getSnapshot;_=_.value;try{if(!ye(k(),_))return!1}catch{return!1}}}if(h=a.child,a.subtreeFlags&16384&&h!==null)h.return=a,a=h;else{if(a===o)break;for(;a.sibling===null;){if(a.return===null||a.return===o)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function Da(o,a){for(a&=~xf,a&=~Gu,o.suspendedLanes|=a,o.pingedLanes&=~a,o=o.expirationTimes;0<a;){var h=31-Ns(a),g=1<<h;o[h]=-1,a&=~g}}function nv(o){if((wr&6)!==0)throw Error(t(327));Fc();var a=Ks(o,0);if((a&1)===0)return Os(o,Yt()),null;var h=Ef(o,a);if(o.tag!==0&&h===2){var g=Zl(o);g!==0&&(a=g,h=kp(o,g))}if(h===1)throw h=Bu,Cl(o,0),Da(o,a),Os(o,Yt()),h;if(h===6)throw Error(t(345));return o.finishedWork=o.current.alternate,o.finishedLanes=a,kl(o,js,ta),Os(o,Yt()),null}function Tp(o,a){var h=wr;wr|=1;try{return o(a)}finally{wr=h,wr===0&&(Sl=Yt()+500,Hd&&Ca())}}function El(o){ja!==null&&ja.tag===0&&(wr&6)===0&&Fc();var a=wr;wr|=1;var h=No.transition,g=yr;try{if(No.transition=null,yr=1,o)return o()}finally{yr=g,No.transition=h,wr=a,(wr&6)===0&&Ca()}}function Ap(){no=Pc.current,Kr(Pc)}function Cl(o,a){o.finishedWork=null,o.finishedLanes=0;var h=o.timeoutHandle;if(h!==-1&&(o.timeoutHandle=-1,_u(h)),bn!==null)for(h=bn.return;h!==null;){var g=h;switch(ml(g),g.tag){case 1:g=g.type.childContextTypes,g!=null&&zd();break;case 3:Ta(),Kr(Rs),Kr(ts),Qd();break;case 5:Xd(g);break;case 4:Ta();break;case 13:Kr(en);break;case 19:Kr(en);break;case 10:qd(g.type._context);break;case 22:case 23:Ap()}h=h.return}if(Fn=o,bn=o=Yo(o.current,null),Wn=no=a,kn=0,Bu=null,xf=Gu=Pa=0,js=Wu=null,vl!==null){for(a=0;a<vl.length;a++)if(h=vl[a],g=h.interleaved,g!==null){h.interleaved=null;var _=g.next,k=h.pending;if(k!==null){var P=k.next;k.next=_,g.next=P}h.pending=g}vl=null}return o}function sv(o,a){do{var h=bn;try{if(qi(),Au.current=sf,_c){for(var g=nn.memoizedState;g!==null;){var _=g.queue;_!==null&&(_.pending=null),g=g.next}_c=!1}if(Aa=0,Cn=hn=nn=null,Ru=!1,xl=0,_p.current=null,h===null||h.return===null){kn=1,Bu=a,bn=null;break}e:{var k=o,P=h.return,W=h,Z=a;if(a=Wn,W.flags|=32768,Z!==null&&typeof Z=="object"&&typeof Z.then=="function"){var xe=Z,je=W,De=je.tag;if((je.mode&1)===0&&(De===0||De===11||De===15)){var Fe=je.alternate;Fe?(je.updateQueue=Fe.updateQueue,je.memoizedState=Fe.memoizedState,je.lanes=Fe.lanes):(je.updateQueue=null,je.memoizedState=null)}var Ze=Vg(P);if(Ze!==null){Ze.flags&=-257,cp(Ze,P,W,k,a),Ze.mode&1&&Ou(k,xe,a),a=Ze,Z=xe;var lt=a.updateQueue;if(lt===null){var dt=new Set;dt.add(Z),a.updateQueue=dt}else lt.add(Z);break e}else{if((a&1)===0){Ou(k,xe,a),Rp();break e}Z=Error(t(426))}}else if(Yr&&W.mode&1){var pn=Vg(P);if(pn!==null){(pn.flags&65536)===0&&(pn.flags|=256),cp(pn,P,W,k,a),wi(_l(Z,W));break e}}k=Z=_l(Z,W),kn!==4&&(kn=2),Wu===null?Wu=[k]:Wu.push(k),k=P;do{switch(k.tag){case 3:k.flags|=65536,a&=-a,k.lanes|=a;var pe=ju(k,Z,a);Mg(k,pe);break e;case 1:W=Z;var ie=k.type,ve=k.stateNode;if((k.flags&128)===0&&(typeof ie.getDerivedStateFromError=="function"||ve!==null&&typeof ve.componentDidCatch=="function"&&(Fa===null||!Fa.has(ve)))){k.flags|=65536,a&=-a,k.lanes|=a;var $e=uf(k,W,a);Mg(k,$e);break e}}k=k.return}while(k!==null)}av(h)}catch(vt){a=vt,bn===h&&h!==null&&(bn=h=h.return);continue}break}while(!0)}function ov(){var o=yf.current;return yf.current=sf,o===null?sf:o}function Rp(){(kn===0||kn===3||kn===2)&&(kn=4),Fn===null||(Pa&268435455)===0&&(Gu&268435455)===0||Da(Fn,Wn)}function Ef(o,a){var h=wr;wr|=2;var g=ov();(Fn!==o||Wn!==a)&&(ta=null,Cl(o,a));do try{F0();break}catch(_){sv(o,_)}while(!0);if(qi(),wr=h,yf.current=g,bn!==null)throw Error(t(261));return Fn=null,Wn=0,kn}function F0(){for(;bn!==null;)iv(bn)}function j0(){for(;bn!==null&&!nt();)iv(bn)}function iv(o){var a=cv(o.alternate,o,no);o.memoizedProps=o.pendingProps,a===null?av(o):bn=a,_p.current=null}function av(o){var a=o;do{var h=a.alternate;if(o=a.return,(a.flags&32768)===0){if(h=A0(h,a,no),h!==null){bn=h;return}}else{if(h=R0(h,a),h!==null){h.flags&=32767,bn=h;return}if(o!==null)o.flags|=32768,o.subtreeFlags=0,o.deletions=null;else{kn=6,bn=null;return}}if(a=a.sibling,a!==null){bn=a;return}bn=a=o}while(a!==null);kn===0&&(kn=5)}function kl(o,a,h){var g=yr,_=No.transition;try{No.transition=null,yr=1,O0(o,a,h,g)}finally{No.transition=_,yr=g}return null}function O0(o,a,h,g){do Fc();while(ja!==null);if((wr&6)!==0)throw Error(t(327));h=o.finishedWork;var _=o.finishedLanes;if(h===null)return null;if(o.finishedWork=null,o.finishedLanes=0,h===o.current)throw Error(t(177));o.callbackNode=null,o.callbackPriority=0;var k=h.lanes|h.childLanes;if(vd(o,k),o===Fn&&(bn=Fn=null,Wn=0),(h.subtreeFlags&2064)===0&&(h.flags&2064)===0||bf||(bf=!0,uv(ks,function(){return Fc(),null})),k=(h.flags&15990)!==0,(h.subtreeFlags&15990)!==0||k){k=No.transition,No.transition=null;var P=yr;yr=1;var W=wr;wr|=4,_p.current=null,I0(o,h),wp(h,o),C0(dl),Ui=!!wu,dl=wu=null,o.current=h,vf(h),Fr(),wr=W,yr=P,No.transition=k}else o.current=h;if(bf&&(bf=!1,ja=o,ms=_),k=o.pendingLanes,k===0&&(Fa=null),nu(h.stateNode),Os(o,Yt()),a!==null)for(g=o.onRecoverableError,h=0;h<a.length;h++)_=a[h],g(_.value,{componentStack:_.stack,digest:_.digest});if(wf)throw wf=!1,o=Ep,Ep=null,o;return(ms&1)!==0&&o.tag!==0&&Fc(),k=o.pendingLanes,(k&1)!==0?o===Cp?Vu++:(Vu=0,Cp=o):Vu=0,Ca(),null}function Fc(){if(ja!==null){var o=Ys(ms),a=No.transition,h=yr;try{if(No.transition=null,yr=16>o?16:o,ja===null)var g=!1;else{if(o=ja,ja=null,ms=0,(wr&6)!==0)throw Error(t(331));var _=wr;for(wr|=4,ot=o.current;ot!==null;){var k=ot,P=k.child;if((ot.flags&16)!==0){var W=k.deletions;if(W!==null){for(var Z=0;Z<W.length;Z++){var xe=W[Z];for(ot=xe;ot!==null;){var je=ot;switch(je.tag){case 0:case 11:case 15:ea(8,je,k)}var De=je.child;if(De!==null)De.return=je,ot=De;else for(;ot!==null;){je=ot;var Fe=je.sibling,Ze=je.return;if(Qg(je),je===xe){ot=null;break}if(Fe!==null){Fe.return=Ze,ot=Fe;break}ot=Ze}}}var lt=k.alternate;if(lt!==null){var dt=lt.child;if(dt!==null){lt.child=null;do{var pn=dt.sibling;dt.sibling=null,dt=pn}while(dt!==null)}}ot=k}}if((k.subtreeFlags&2064)!==0&&P!==null)P.return=k,ot=P;else e:for(;ot!==null;){if(k=ot,(k.flags&2048)!==0)switch(k.tag){case 0:case 11:case 15:ea(9,k,k.return)}var pe=k.sibling;if(pe!==null){pe.return=k.return,ot=pe;break e}ot=k.return}}var ie=o.current;for(ot=ie;ot!==null;){P=ot;var ve=P.child;if((P.subtreeFlags&2064)!==0&&ve!==null)ve.return=P,ot=ve;else e:for(P=ie;ot!==null;){if(W=ot,(W.flags&2048)!==0)try{switch(W.tag){case 0:case 11:case 15:Hu(9,W)}}catch(vt){sn(W,W.return,vt)}if(W===P){ot=null;break e}var $e=W.sibling;if($e!==null){$e.return=W.return,ot=$e;break e}ot=W.return}}if(wr=_,Ca(),Jn&&typeof Jn.onPostCommitFiberRoot=="function")try{Jn.onPostCommitFiberRoot($o,o)}catch{}g=!0}return g}finally{yr=h,No.transition=a}}return!1}function Cf(o,a,h){a=_l(h,a),a=ju(o,a,1),o=Eo(o,a,1),a=gs(),o!==null&&(rl(o,1,a),Os(o,a))}function sn(o,a,h){if(o.tag===3)Cf(o,o,h);else for(;a!==null;){if(a.tag===3){Cf(a,o,h);break}else if(a.tag===1){var g=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(Fa===null||!Fa.has(g))){o=_l(h,o),o=uf(a,o,1),a=Eo(a,o,1),o=gs(),a!==null&&(rl(a,1,o),Os(a,o));break}}a=a.return}}function D0(o,a,h){var g=o.pingCache;g!==null&&g.delete(a),a=gs(),o.pingedLanes|=o.suspendedLanes&h,Fn===o&&(Wn&h)===h&&(kn===4||kn===3&&(Wn&130023424)===Wn&&500>Yt()-Sp?Cl(o,0):xf|=h),Os(o,a)}function lv(o,a){a===0&&((o.mode&1)===0?a=1:(a=ci,ci<<=1,(ci&130023424)===0&&(ci=4194304)));var h=gs();o=Ki(o,a),o!==null&&(rl(o,a,h),Os(o,h))}function L0(o){var a=o.memoizedState,h=0;a!==null&&(h=a.retryLane),lv(o,h)}function M0(o,a){var h=0;switch(o.tag){case 13:var g=o.stateNode,_=o.memoizedState;_!==null&&(h=_.retryLane);break;case 19:g=o.stateNode;break;default:throw Error(t(314))}g!==null&&g.delete(a),lv(o,h)}var cv;cv=function(o,a,h){if(o!==null)if(o.memoizedProps!==a.pendingProps||Rs.current)hs=!0;else{if((o.lanes&h)===0&&(a.flags&128)===0)return hs=!1,Yg(o,a,h);hs=(o.flags&131072)!==0}else hs=!1,Yr&&(a.flags&1048576)!==0&&Fg(a,Gd,a.index);switch(a.lanes=0,a.tag){case 2:var g=a.type;hf(o,a),o=a.pendingProps;var _=vc(a,ts.current);Na(a,h),_=wl(null,a,g,o,_,h);var k=Zd();return a.flags|=1,typeof _=="object"&&_!==null&&typeof _.render=="function"&&_.$$typeof===void 0?(a.tag=1,a.memoizedState=null,a.updateQueue=null,Is(g)?(k=!0,xo(a)):k=!1,a.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,Yd(a),_.updater=lf,a.stateNode=_,_._reactInternals=a,lp(a,g,o,h),a=mp(null,a,g,!0,k,h)):(a.tag=0,Yr&&k&&Su(a),Hn(null,a,_,h),a=a.child),a;case 16:g=a.elementType;e:{switch(hf(o,a),o=a.pendingProps,_=g._init,g=_(g._payload),a.type=g,_=a.tag=U0(g),o=ko(g,o),_){case 0:a=hp(null,a,g,o,h);break e;case 1:a=pp(null,a,g,o,h);break e;case 11:a=qg(null,a,g,o,h);break e;case 14:a=up(null,a,g,ko(g.type,o),h);break e}throw Error(t(306,g,""))}return a;case 0:return g=a.type,_=a.pendingProps,_=a.elementType===g?_:ko(g,_),hp(o,a,g,_,h);case 1:return g=a.type,_=a.pendingProps,_=a.elementType===g?_:ko(g,_),pp(o,a,g,_,h);case 3:e:{if(Kg(a),o===null)throw Error(t(387));g=a.pendingProps,k=a.memoizedState,_=k.element,Lg(o,a),wc(a,g,null,h);var P=a.memoizedState;if(g=P.element,k.isDehydrated)if(k={element:g,isDehydrated:!1,cache:P.cache,pendingSuspenseBoundaries:P.pendingSuspenseBoundaries,transitions:P.transitions},a.updateQueue.baseState=k,a.memoizedState=k,a.flags&256){_=_l(Error(t(423)),a),a=Ci(o,a,g,h,_);break e}else if(g!==_){_=_l(Error(t(424)),a),a=Ci(o,a,g,h,_);break e}else for(eo=_a(a.stateNode.containerInfo.firstChild),ns=a,Yr=!0,Ho=null,h=Vd(a,null,g,h),a.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling;else{if(xi(),g===_){a=Go(o,a,h);break e}Hn(o,a,g,h)}a=a.child}return a;case 5:return Yh(a),o===null&&Ps(a),g=a.type,_=a.pendingProps,k=o!==null?o.memoizedProps:null,P=_.children,bu(g,_)?P=null:k!==null&&bu(g,k)&&(a.flags|=32),fp(o,a),Hn(o,a,P,h),a.child;case 6:return o===null&&Ps(a),null;case 13:return ff(o,a,h);case 4:return Kh(a,a.stateNode.containerInfo),g=a.pendingProps,o===null?a.child=un(a,null,g,h):Hn(o,a,g,h),a.child;case 11:return g=a.type,_=a.pendingProps,_=a.elementType===g?_:ko(g,_),qg(o,a,g,_,h);case 7:return Hn(o,a,a.pendingProps,h),a.child;case 8:return Hn(o,a,a.pendingProps.children,h),a.child;case 12:return Hn(o,a,a.pendingProps.children,h),a.child;case 10:e:{if(g=a.type._context,_=a.pendingProps,k=a.memoizedProps,P=_.value,Br(ku,g._currentValue),g._currentValue=P,k!==null)if(ye(k.value,P)){if(k.children===_.children&&!Rs.current){a=Go(o,a,h);break e}}else for(k=a.child,k!==null&&(k.return=a);k!==null;){var W=k.dependencies;if(W!==null){P=k.child;for(var Z=W.firstContext;Z!==null;){if(Z.context===g){if(k.tag===1){Z=Yi(-1,h&-h),Z.tag=2;var xe=k.updateQueue;if(xe!==null){xe=xe.shared;var je=xe.pending;je===null?Z.next=Z:(Z.next=je.next,je.next=Z),xe.pending=Z}}k.lanes|=h,Z=k.alternate,Z!==null&&(Z.lanes|=h),zn(k.return,h,a),W.lanes|=h;break}Z=Z.next}}else if(k.tag===10)P=k.type===a.type?null:k.child;else if(k.tag===18){if(P=k.return,P===null)throw Error(t(341));P.lanes|=h,W=P.alternate,W!==null&&(W.lanes|=h),zn(P,h,a),P=k.sibling}else P=k.child;if(P!==null)P.return=k;else for(P=k;P!==null;){if(P===a){P=null;break}if(k=P.sibling,k!==null){k.return=P.return,P=k;break}P=P.return}k=P}Hn(o,a,_.children,h),a=a.child}return a;case 9:return _=a.type,g=a.pendingProps.children,Na(a,h),_=_o(_),g=g(_),a.flags|=1,Hn(o,a,g,h),a.child;case 14:return g=a.type,_=ko(g,a.pendingProps),_=ko(g.type,_),up(o,a,g,_,h);case 15:return Ei(o,a,a.type,a.pendingProps,h);case 17:return g=a.type,_=a.pendingProps,_=a.elementType===g?_:ko(g,_),hf(o,a),a.tag=1,Is(g)?(o=!0,xo(a)):o=!1,Na(a,h),bl(a,g,_),lp(a,g,_,h),mp(null,a,g,!0,o,h);case 19:return Ra(o,a,h);case 22:return dp(o,a,h)}throw Error(t(156,a.tag))};function uv(o,a){return Q(o,a)}function $0(o,a,h,g){this.tag=o,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function To(o,a,h,g){return new $0(o,a,h,g)}function kf(o){return o=o.prototype,!(!o||!o.isReactComponent)}function U0(o){if(typeof o=="function")return kf(o)?1:0;if(o!=null){if(o=o.$$typeof,o===H)return 11;if(o===se)return 14}return 2}function Yo(o,a){var h=o.alternate;return h===null?(h=To(o.tag,a,o.key,o.mode),h.elementType=o.elementType,h.type=o.type,h.stateNode=o.stateNode,h.alternate=o,o.alternate=h):(h.pendingProps=a,h.type=o.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=o.flags&14680064,h.childLanes=o.childLanes,h.lanes=o.lanes,h.child=o.child,h.memoizedProps=o.memoizedProps,h.memoizedState=o.memoizedState,h.updateQueue=o.updateQueue,a=o.dependencies,h.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},h.sibling=o.sibling,h.index=o.index,h.ref=o.ref,h}function Nf(o,a,h,g,_,k){var P=2;if(g=o,typeof o=="function")kf(o)&&(P=1);else if(typeof o=="string")P=5;else e:switch(o){case z:return Nl(h.children,_,k,a);case q:P=8,_|=8;break;case ae:return o=To(12,h,a,_|2),o.elementType=ae,o.lanes=k,o;case me:return o=To(13,h,a,_),o.elementType=me,o.lanes=k,o;case ee:return o=To(19,h,a,_),o.elementType=ee,o.lanes=k,o;case Y:return Tf(h,_,k,a);default:if(typeof o=="object"&&o!==null)switch(o.$$typeof){case oe:P=10;break e;case fe:P=9;break e;case H:P=11;break e;case se:P=14;break e;case de:P=16,g=null;break e}throw Error(t(130,o==null?o:typeof o,""))}return a=To(P,h,a,_),a.elementType=o,a.type=g,a.lanes=k,a}function Nl(o,a,h,g){return o=To(7,o,g,a),o.lanes=h,o}function Tf(o,a,h,g){return o=To(22,o,g,a),o.elementType=Y,o.lanes=h,o.stateNode={isHidden:!1},o}function Ip(o,a,h){return o=To(6,o,null,a),o.lanes=h,o}function Pp(o,a,h){return a=To(4,o.children!==null?o.children:[],o.key,a),a.lanes=h,a.stateNode={containerInfo:o.containerInfo,pendingChildren:null,implementation:o.implementation},a}function z0(o,a,h,g,_){this.tag=a,this.containerInfo=o,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=tl(0),this.expirationTimes=tl(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=tl(0),this.identifierPrefix=g,this.onRecoverableError=_,this.mutableSourceEagerHydrationData=null}function Fp(o,a,h,g,_,k,P,W,Z){return o=new z0(o,a,h,W,Z),a===1?(a=1,k===!0&&(a|=8)):a=0,k=To(3,null,null,a),o.current=k,k.stateNode=o,k.memoizedState={element:g,isDehydrated:h,cache:null,transitions:null,pendingSuspenseBoundaries:null},Yd(k),o}function H0(o,a,h){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:G,key:g==null?null:""+g,children:o,containerInfo:a,implementation:h}}function dv(o){if(!o)return Ea;o=o._reactInternals;e:{if(ht(o)!==o||o.tag!==1)throw Error(t(170));var a=o;do{switch(a.tag){case 3:a=a.stateNode.context;break e;case 1:if(Is(a.type)){a=a.stateNode.__reactInternalMemoizedMergedChildContext;break e}}a=a.return}while(a!==null);throw Error(t(171))}if(o.tag===1){var h=o.type;if(Is(h))return Rg(o,h,a)}return a}function fv(o,a,h,g,_,k,P,W,Z){return o=Fp(h,g,!0,o,_,k,P,W,Z),o.context=dv(null),h=o.current,g=gs(),_=Oa(h),k=Yi(g,_),k.callback=a??null,Eo(h,k,_),o.current.lanes=_,rl(o,_,g),Os(o,g),o}function Af(o,a,h,g){var _=a.current,k=gs(),P=Oa(_);return h=dv(h),a.context===null?a.context=h:a.pendingContext=h,a=Yi(k,P),a.payload={element:o},g=g===void 0?null:g,g!==null&&(a.callback=g),o=Eo(_,a,P),o!==null&&(Ko(o,_,P,k),Jd(o,_,P)),P}function Rf(o){if(o=o.current,!o.child)return null;switch(o.child.tag){case 5:return o.child.stateNode;default:return o.child.stateNode}}function hv(o,a){if(o=o.memoizedState,o!==null&&o.dehydrated!==null){var h=o.retryLane;o.retryLane=h!==0&&h<a?h:a}}function jp(o,a){hv(o,a),(o=o.alternate)&&hv(o,a)}function B0(){return null}var pv=typeof reportError=="function"?reportError:function(o){console.error(o)};function If(o){this._internalRoot=o}Ku.prototype.render=If.prototype.render=function(o){var a=this._internalRoot;if(a===null)throw Error(t(409));Af(o,a,null,null)},Ku.prototype.unmount=If.prototype.unmount=function(){var o=this._internalRoot;if(o!==null){this._internalRoot=null;var a=o.containerInfo;El(function(){Af(null,o,null,null)}),a[Zs]=null}};function Ku(o){this._internalRoot=o}Ku.prototype.unstable_scheduleHydration=function(o){if(o){var a=cu();o={blockedOn:null,target:o,priority:a};for(var h=0;h<Me.length&&a!==0&&a<Me[h].priority;h++);Me.splice(h,0,o),h===0&&st(o)}};function Op(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11)}function Pf(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11&&(o.nodeType!==8||o.nodeValue!==" react-mount-point-unstable "))}function mv(){}function G0(o,a,h,g,_){if(_){if(typeof g=="function"){var k=g;g=function(){var xe=Rf(P);k.call(xe)}}var P=fv(a,g,o,0,null,!1,!1,"",mv);return o._reactRootContainer=P,o[Zs]=P.current,wa(o.nodeType===8?o.parentNode:o),El(),P}for(;_=o.lastChild;)o.removeChild(_);if(typeof g=="function"){var W=g;g=function(){var xe=Rf(Z);W.call(xe)}}var Z=Fp(o,0,!1,null,null,!1,!1,"",mv);return o._reactRootContainer=Z,o[Zs]=Z.current,wa(o.nodeType===8?o.parentNode:o),El(function(){Af(a,Z,h,g)}),Z}function Tl(o,a,h,g,_){var k=h._reactRootContainer;if(k){var P=k;if(typeof _=="function"){var W=_;_=function(){var Z=Rf(P);W.call(Z)}}Af(a,P,o,_)}else P=G0(h,a,o,_,g);return Rf(P)}sl=function(o){switch(o.tag){case 3:var a=o.stateNode;if(a.current.memoizedState.isDehydrated){var h=qs(a.pendingLanes);h!==0&&(nl(a,h|1),Os(a,Yt()),(wr&6)===0&&(Sl=Yt()+500,Ca()))}break;case 13:El(function(){var g=Ki(o,1);if(g!==null){var _=gs();Ko(g,o,1,_)}}),jp(o,1)}},ec=function(o){if(o.tag===13){var a=Ki(o,134217728);if(a!==null){var h=gs();Ko(a,o,134217728,h)}jp(o,134217728)}},lu=function(o){if(o.tag===13){var a=Oa(o),h=Ki(o,a);if(h!==null){var g=gs();Ko(h,o,a,g)}jp(o,a)}},cu=function(){return yr},uu=function(o,a){var h=yr;try{return yr=o,a()}finally{yr=h}},nr=function(o,a,h){switch(a){case"input":if(ct(o,h),a=h.name,h.type==="radio"&&a!=null){for(h=o;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll("input[name="+JSON.stringify(""+a)+'][type="radio"]'),a=0;a<h.length;a++){var g=h[a];if(g!==o&&g.form===o.form){var _=Ud(g);if(!_)throw Error(t(90));Be(g),ct(g,_)}}}break;case"textarea":zr(o,h);break;case"select":a=h.value,a!=null&&Kt(o,!!h.multiple,a,!1)}},Tr=Tp,yn=El;var W0={usingClientEntryPoint:!1,Events:[es,Zt,Ud,Gs,Cs,Tp]},Yu={findFiberByHostInstance:mi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},V0={bundleType:Yu.bundleType,version:Yu.version,rendererPackageName:Yu.rendererPackageName,rendererConfig:Yu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:j.ReactCurrentDispatcher,findHostInstanceByFiber:function(o){return o=ur(o),o===null?null:o.stateNode},findFiberByHostInstance:Yu.findFiberByHostInstance||B0,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ff=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ff.isDisabled&&Ff.supportsFiber)try{$o=Ff.inject(V0),Jn=Ff}catch{}}return Po.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W0,Po.createPortal=function(o,a){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Op(a))throw Error(t(200));return H0(o,a,null,h)},Po.createRoot=function(o,a){if(!Op(o))throw Error(t(299));var h=!1,g="",_=pv;return a!=null&&(a.unstable_strictMode===!0&&(h=!0),a.identifierPrefix!==void 0&&(g=a.identifierPrefix),a.onRecoverableError!==void 0&&(_=a.onRecoverableError)),a=Fp(o,1,!1,null,null,h,!1,g,_),o[Zs]=a.current,wa(o.nodeType===8?o.parentNode:o),new If(a)},Po.findDOMNode=function(o){if(o==null)return null;if(o.nodeType===1)return o;var a=o._reactInternals;if(a===void 0)throw typeof o.render=="function"?Error(t(188)):(o=Object.keys(o).join(","),Error(t(268,o)));return o=ur(a),o=o===null?null:o.stateNode,o},Po.flushSync=function(o){return El(o)},Po.hydrate=function(o,a,h){if(!Pf(a))throw Error(t(200));return Tl(null,o,a,!0,h)},Po.hydrateRoot=function(o,a,h){if(!Op(o))throw Error(t(405));var g=h!=null&&h.hydratedSources||null,_=!1,k="",P=pv;if(h!=null&&(h.unstable_strictMode===!0&&(_=!0),h.identifierPrefix!==void 0&&(k=h.identifierPrefix),h.onRecoverableError!==void 0&&(P=h.onRecoverableError)),a=fv(a,null,o,1,h??null,_,!1,k,P),o[Zs]=a.current,wa(o),g)for(o=0;o<g.length;o++)h=g[o],_=h._getVersion,_=_(h._source),a.mutableSourceEagerHydrationData==null?a.mutableSourceEagerHydrationData=[h,_]:a.mutableSourceEagerHydrationData.push(h,_);return new Ku(a)},Po.render=function(o,a,h){if(!Pf(a))throw Error(t(200));return Tl(null,o,a,!1,h)},Po.unmountComponentAtNode=function(o){if(!Pf(o))throw Error(t(40));return o._reactRootContainer?(El(function(){Tl(null,null,o,!1,function(){o._reactRootContainer=null,o[Zs]=null})}),!0):!1},Po.unstable_batchedUpdates=Tp,Po.unstable_renderSubtreeIntoContainer=function(o,a,h,g){if(!Pf(h))throw Error(t(200));if(o==null||o._reactInternals===void 0)throw Error(t(38));return Tl(o,a,h,!1,g)},Po.version="18.3.1-next-f1338f8080-20240426",Po}var hE;function y1(){if(hE)return ax.exports;hE=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),ax.exports=VO(),ax.exports}var pE;function qO(){if(pE)return wv;pE=1;var r=y1();return wv.createRoot=r.createRoot,wv.hydrateRoot=r.hydrateRoot,wv}var KO=qO();const YO=_b(KO);class JO{constructor(e){B(this,"logger");B(this,"changeListeners",new Set);var t;this.logger=e,(t=chrome==null?void 0:chrome.storage)!=null&&t.onChanged&&chrome.storage.onChanged.addListener(this.handleStorageChange.bind(this))}async getLocalItem(e){try{const t=await new Promise((n,s)=>{chrome.storage.local.get(e,i=>{chrome.runtime.lastError?s(new Error(chrome.runtime.lastError.message)):n(i)})});try{if(t[e]!==void 0){const n=JSON.parse(t[e]);return this.logger.debug(`Retrieved local item with key: ${e}`,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"getLocalItem"}),n}return null}catch{return this.logger.debug(`Local item with key: ${e} is not JSON, returning as is`,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"getLocalItem"}),t[e]}}catch(t){return this.logger.error(`Error retrieving local item with key: ${e}`,t,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"getLocalItem"}),null}}async setLocalItem(e,t){try{const n={[e]:JSON.stringify(t)};await new Promise((s,i)=>{chrome.storage.local.set(n,()=>{chrome.runtime.lastError?i(new Error(chrome.runtime.lastError.message)):s()})}),this.logger.debug(`Stored local item with key: ${e}`,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"setLocalItem"})}catch(n){throw this.logger.error(`Error storing local item with key: ${e}`,n,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"setLocalItem"}),n}}async removeLocalItem(e){try{await new Promise((t,n)=>{chrome.storage.local.remove(e,()=>{chrome.runtime.lastError?n(new Error(chrome.runtime.lastError.message)):t()})}),this.logger.debug(`Removed local item with key: ${e}`,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"removeLocalItem"})}catch(t){throw this.logger.error(`Error removing local item with key: ${e}`,t,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"removeLocalItem"}),t}}async clearLocal(){try{await new Promise((e,t)=>{chrome.storage.local.clear(()=>{chrome.runtime.lastError?t(new Error(chrome.runtime.lastError.message)):e()})}),this.logger.info("Cleared local storage",{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"clearLocal"})}catch(e){throw this.logger.error("Error clearing local storage",e,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"clearLocal"}),e}}async getAllKeys(){try{const e=await new Promise((n,s)=>{chrome.storage.local.get(null,i=>{chrome.runtime.lastError?s(new Error(chrome.runtime.lastError.message)):n(i)})}),t=Object.keys(e);return this.logger.debug(`Retrieved ${t.length} keys from storage`,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"getAllKeys"}),t}catch(e){return this.logger.error("Error getting all keys",e,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"getAllKeys"}),[]}}onChanged(e){this.changeListeners.add(e)}removeChangeListener(e){this.changeListeners.delete(e)}handleStorageChange(e,t){if((t==="local"||t==="session"||t==="sync")&&this.changeListeners.size>0){const n={};for(const[s,i]of Object.entries(e))try{n[s]={oldValue:i.oldValue?JSON.parse(i.oldValue):void 0,newValue:i.newValue?JSON.parse(i.newValue):void 0}}catch(c){this.logger.debug("Storage change value not JSON",{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"handleStorageChange",key:s,areaName:t,error:c}),n[s]={oldValue:i.oldValue,newValue:i.newValue}}this.changeListeners.forEach(s=>{try{s(n)}catch(i){this.logger.error("Error in storage change callback",i,{sourceFile:"src/platforms/chrome/ChromeStorageProvider.ts",sourceFunction:"handleStorageChange"})}})}}}class XO{constructor(e){B(this,"logger");B(this,"threadListeners",new Set);B(this,"currentThread",null);this.logger=e,this.initializeStorageListeners()}initializeStorageListeners(){var e,t,n;(t=(e=chrome==null?void 0:chrome.storage)==null?void 0:e.local)!=null&&t.onChanged&&chrome.storage.local.onChanged.addListener(s=>{Object.keys(s).some(c=>c.includes("threadId_window_")&&c.includes("_tab_")||c.includes("threadData_window_")&&c.includes("_tab_"))&&(this.logger.debug("Tab-specific thread data changed, triggering update",{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"initializeStorageListeners",changedKeys:Object.keys(s)}),this.handleThreadDataChange())}),(n=chrome==null?void 0:chrome.tabs)!=null&&n.onActivated&&chrome.tabs.onActivated.addListener(s=>{this.logger.debug("Tab activated, updating thread data",{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"initializeStorageListeners",tabId:s.tabId,windowId:s.windowId}),setTimeout(()=>{this.handleThreadDataChange()},100)})}async getCurrentTabInfo(){try{const[e]=await chrome.tabs.query({active:!0,currentWindow:!0});return!(e!=null&&e.id)||!(e!=null&&e.windowId)?(this.logger.warn("No active tab found",{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentTabInfo"}),null):{tabId:e.id,windowId:e.windowId}}catch(e){return this.logger.error("Error getting current tab info",e,{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentTabInfo"}),null}}async handleThreadDataChange(){var e;try{const t=await this.getCurrentTabInfo(),n=await this.getCurrentThread(),s=(n==null?void 0:n.threadId)||null,i=((e=this.currentThread)==null?void 0:e.threadId)||null;s!==i&&(this.logger.info("Notifying thread listeners for tab",{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"handleThreadDataChange",tabId:t==null?void 0:t.tabId,windowId:t==null?void 0:t.windowId,newThreadId:s,currentThreadId:i}),this.currentThread=n,this.notifyThreadListeners(n))}catch(t){this.logger.error("Error handling thread data change",t,{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"handleThreadDataChange"})}}async getCurrentThread(){const e=await this.getCurrentTabInfo();if(!e)return this.logger.warn("No tab info available for getting current thread",{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentThread"}),null;const{tabId:t,windowId:n}=e,s=`threadId_window_${n}_tab_${t}`,i=`threadData_window_${n}_tab_${t}`;return new Promise(c=>{chrome.storage.local.get([s,i],d=>{if(chrome.runtime.lastError){this.logger.error("Error getting thread data",chrome.runtime.lastError,{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentThread",tabId:t,windowId:n}),c(null);return}const m=d[s],p=d[i];if(!m||!p){this.logger.debug(`No thread data found for tab ${t} in window ${n}`,{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentThread",tabId:t,windowId:n,hasThreadId:!!m,hasThreadData:!!p}),c(null);return}try{const v=this.transformToEmailThread(m,p);this.logger.debug(`Retrieved thread data for tab ${t} in window ${n}`,{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentThread",tabId:t,windowId:n,threadId:m}),c(v)}catch(v){this.logger.error("Error transforming thread data",v,{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentThread",tabId:t,windowId:n}),c(null)}})})}async getCurrentThreadId(){const e=await this.getCurrentTabInfo();if(!e)return this.logger.warn("No tab info available for getting current thread ID",{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentThreadId"}),null;const{tabId:t,windowId:n}=e,s=`threadId_window_${n}_tab_${t}`;return new Promise(i=>{chrome.storage.local.get([s],c=>{if(chrome.runtime.lastError){this.logger.error("Error getting thread ID",chrome.runtime.lastError,{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentThreadId",tabId:t,windowId:n}),i(null);return}const d=c[s]||null;this.logger.debug(`Retrieved thread ID for tab ${t} in window ${n}`,{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentThreadId",tabId:t,windowId:n,threadId:d}),i(d)})})}getCurrentUserEmail(){return this.logger.debug("getCurrentUserEmail called for Chrome - not needed, backend handles filtering",{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"getCurrentUserEmail"}),null}onThreadChanged(e){this.threadListeners.add(e)}removeThreadListener(e){this.threadListeners.delete(e)}notifyThreadListeners(e){this.threadListeners.forEach(t=>{try{t(e)}catch(n){this.logger.error("Error in thread change callback",n,{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"notifyThreadListeners"})}})}transformToEmailThread(e,t){var n;if(!t||!Array.isArray(t))return this.logger.warn("Invalid thread data format",{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"transformToEmailThread",threadId:e,threadData:t}),null;try{const s=t.map(c=>({from:c.from||"Unknown",timestamp:c.timestamp||new Date().toISOString(),subject:c.subject||"No Subject",body:c.body||"",html:c.html||c.body||""})),i=new Set;return t.forEach(c=>{c.from&&typeof c.from=="string"&&i.add(c.from),c.to&&Array.isArray(c.to)&&c.to.forEach(d=>{typeof d=="string"&&i.add(d)}),c.cc&&Array.isArray(c.cc)&&c.cc.forEach(d=>{typeof d=="string"&&i.add(d)}),c.bcc&&Array.isArray(c.bcc)&&c.bcc.forEach(d=>{typeof d=="string"&&i.add(d)})}),{threadId:e,messages:s,subject:((n=s[0])==null?void 0:n.subject)||"No Subject",participants:Array.from(i)}}catch(s){return this.logger.error("Error transforming email messages",s,{sourceFile:"src/platforms/chrome/ChromeDataProvider.ts",sourceFunction:"transformToEmailThread",threadId:e,threadData:t}),null}}}const QO="CandleLogsDB",ZO=1,ux="logs";let Mp=null;function e2(){return Mp||(Mp=new Promise((r,e)=>{console.log("[Logger] Initializing IndexedDB...");const t=indexedDB.open(QO,ZO);t.onupgradeneeded=n=>{console.log("[Logger] IndexedDB upgrade needed.");const s=n.target.result;if(!s.objectStoreNames.contains(ux)){console.log(`[Logger] Creating object store: ${ux}`);const i=s.createObjectStore(ux,{keyPath:"id",autoIncrement:!0});console.log("[Logger] Creating indexes: timestamp, level, chromeContext"),i.createIndex("timestamp","timestamp",{unique:!1}),i.createIndex("level","level",{unique:!1}),i.createIndex("chromeContext","chromeContext",{unique:!1})}},t.onsuccess=n=>{console.log("[Logger] IndexedDB initialized successfully."),r(n.target.result)},t.onerror=n=>{console.error("[Logger] IndexedDB initialization failed:",n.target.error),Mp=null,e(n.target.error)},t.onblocked=()=>{console.warn("[Logger] IndexedDB initialization blocked. Close other tabs using the database.")}}),Mp)}e2().catch(r=>console.error("[Logger] Initial DB connection failed:",r));const t2=r=>r!==null&&typeof r=="object"&&!Array.isArray(r),r2=r=>t2(r)?["id_token","access_token","refresh_token","expires_in","token_type"].every(t=>{switch(t){case"expires_in":return typeof r[t]=="number";default:return typeof r[t]=="string"}}):!1,x1=r=>({setHttpHandler(e){r.httpHandler=e},httpHandler(){return r.httpHandler},updateHttpClientConfig(e,t){var n;(n=r.httpHandler)==null||n.updateHttpClientConfig(e,t)},httpHandlerConfigs(){return r.httpHandler.httpHandlerConfigs()}}),w1=r=>({httpHandler:r.httpHandler()});var km;(function(r){r.HTTP="http",r.HTTPS="https"})(km||(km={}));var ny;(function(r){r.MD5="md5",r.CRC32="crc32",r.CRC32C="crc32c",r.SHA1="sha1",r.SHA256="sha256"})(ny||(ny={}));const yw="__smithy_context";class ii{constructor(e){B(this,"method");B(this,"protocol");B(this,"hostname");B(this,"port");B(this,"path");B(this,"query");B(this,"headers");B(this,"username");B(this,"password");B(this,"fragment");B(this,"body");this.method=e.method||"GET",this.hostname=e.hostname||"localhost",this.port=e.port,this.query=e.query||{},this.headers=e.headers||{},this.body=e.body,this.protocol=e.protocol?e.protocol.slice(-1)!==":"?`${e.protocol}:`:e.protocol:"https:",this.path=e.path?e.path.charAt(0)!=="/"?`/${e.path}`:e.path:"/",this.username=e.username,this.password=e.password,this.fragment=e.fragment}static clone(e){const t=new ii({...e,headers:{...e.headers}});return t.query&&(t.query=n2(t.query)),t}static isInstance(e){if(!e)return!1;const t=e;return"method"in t&&"protocol"in t&&"hostname"in t&&"path"in t&&typeof t.query=="object"&&typeof t.headers=="object"}clone(){return ii.clone(this)}}function n2(r){return Object.keys(r).reduce((e,t)=>{const n=r[t];return{...e,[t]:Array.isArray(n)?[...n]:n}},{})}class lh{constructor(e){B(this,"statusCode");B(this,"reason");B(this,"headers");B(this,"body");this.statusCode=e.statusCode,this.reason=e.reason,this.headers=e.headers||{},this.body=e.body}static isInstance(e){if(!e)return!1;const t=e;return typeof t.statusCode=="number"&&typeof t.headers=="object"}}const s2=r=>e=>async t=>{if(!ii.isInstance(t.request))return e(t);const{request:n}=t,{handlerProtocol:s=""}=r.requestHandler.metadata||{};if(s.indexOf("h2")>=0&&!n.headers[":authority"])delete n.headers.host,n.headers[":authority"]=n.hostname+(n.port?":"+n.port:"");else if(!n.headers.host){let i=n.hostname;n.port!=null&&(i+=`:${n.port}`),n.headers.host=i}return e(t)},o2={name:"hostHeaderMiddleware",step:"build",priority:"low",tags:["HOST"],override:!0},b1=r=>({applyToStack:e=>{e.add(s2(r),o2)}}),i2=()=>(r,e)=>async t=>{var n,s;try{const i=await r(t),{clientName:c,commandName:d,logger:m,dynamoDbDocumentClientOptions:p={}}=e,{overrideInputFilterSensitiveLog:v,overrideOutputFilterSensitiveLog:x}=p,b=v??e.inputFilterSensitiveLog,S=x??e.outputFilterSensitiveLog,{$metadata:N,...E}=i.output;return(n=m==null?void 0:m.info)==null||n.call(m,{clientName:c,commandName:d,input:b(t.input),output:S(E),metadata:N}),i}catch(i){const{clientName:c,commandName:d,logger:m,dynamoDbDocumentClientOptions:p={}}=e,{overrideInputFilterSensitiveLog:v}=p,x=v??e.inputFilterSensitiveLog;throw(s=m==null?void 0:m.error)==null||s.call(m,{clientName:c,commandName:d,input:x(t.input),error:i,metadata:i.$metadata}),i}},a2={name:"loggerMiddleware",tags:["LOGGER"],step:"initialize",override:!0},_1=r=>({applyToStack:e=>{e.add(i2(),a2)}}),l2={step:"build",tags:["RECURSION_DETECTION"],name:"recursionDetectionMiddleware",override:!0,priority:"low"},c2=()=>r=>async e=>r(e),S1=r=>({applyToStack:e=>{e.add(c2(),l2)}}),pd=r=>r[yw]||(r[yw]={}),oa=r=>{if(typeof r=="function")return r;const e=Promise.resolve(r);return()=>e},u2=(r,e)=>{if(!e||e.length===0)return r;const t=[];for(const n of e)for(const s of r)s.schemeId.split("#")[1]===n&&t.push(s);for(const n of r)t.find(({schemeId:s})=>s===n.schemeId)||t.push(n);return t};function d2(r){const e=new Map;for(const t of r)e.set(t.schemeId,t);return e}const f2=(r,e)=>(t,n)=>async s=>{var x;const i=r.httpAuthSchemeProvider(await e.httpAuthSchemeParametersProvider(r,n,s.input)),c=r.authSchemePreference?await r.authSchemePreference():[],d=u2(i,c),m=d2(r.httpAuthSchemes),p=pd(n),v=[];for(const b of d){const S=m.get(b.schemeId);if(!S){v.push(`HttpAuthScheme \`${b.schemeId}\` was not enabled for this service.`);continue}const N=S.identityProvider(await e.identityProviderConfigProvider(r));if(!N){v.push(`HttpAuthScheme \`${b.schemeId}\` did not have an IdentityProvider configured.`);continue}const{identityProperties:E={},signingProperties:T={}}=((x=b.propertiesExtractor)==null?void 0:x.call(b,r,n))||{};b.identityProperties=Object.assign(b.identityProperties||{},E),b.signingProperties=Object.assign(b.signingProperties||{},T),p.selectedHttpAuthScheme={httpAuthOption:b,identity:await N(b.identityProperties),signer:S.signer};break}if(!p.selectedHttpAuthScheme)throw new Error(v.join(`
`));return t(s)},h2={step:"serialize",tags:["HTTP_AUTH_SCHEME"],name:"httpAuthSchemeMiddleware",override:!0,relation:"before",toMiddleware:"endpointV2Middleware"},E1=(r,{httpAuthSchemeParametersProvider:e,identityProviderConfigProvider:t})=>({applyToStack:n=>{n.addRelativeTo(f2(r,{httpAuthSchemeParametersProvider:e,identityProviderConfigProvider:t}),h2)}}),p2={name:"serializerMiddleware"},m2=r=>e=>{throw e},g2=(r,e)=>{},v2=r=>(e,t)=>async n=>{if(!ii.isInstance(n.request))return e(n);const i=pd(t).selectedHttpAuthScheme;if(!i)throw new Error("No HttpAuthScheme was selected: unable to sign request");const{httpAuthOption:{signingProperties:c={}},identity:d,signer:m}=i,p=await e({...n,request:await m.sign(n.request,d,c)}).catch((m.errorHandler||m2)(c));return(m.successHandler||g2)(p.response,c),p},y2={step:"finalizeRequest",tags:["HTTP_SIGNING"],name:"httpSigningMiddleware",aliases:["apiKeyMiddleware","tokenMiddleware","awsAuthMiddleware"],override:!0,relation:"after",toMiddleware:"retryMiddleware"},C1=r=>({applyToStack:e=>{e.addRelativeTo(v2(),y2)}}),wm=r=>{if(typeof r=="function")return r;const e=Promise.resolve(r);return()=>e},k1="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",mE=Object.entries(k1).reduce((r,[e,t])=>(r[t]=Number(e),r),{}),x2=k1.split(""),Qf=6,bm=8,w2=63,qm=r=>{let e=r.length/4*3;r.slice(-2)==="=="?e-=2:r.slice(-1)==="="&&e--;const t=new ArrayBuffer(e),n=new DataView(t);for(let s=0;s<r.length;s+=4){let i=0,c=0;for(let p=s,v=s+3;p<=v;p++)if(r[p]!=="="){if(!(r[p]in mE))throw new TypeError(`Invalid character ${r[p]} in base64 string.`);i|=mE[r[p]]<<(v-p)*Qf,c+=Qf}else i>>=Qf;const d=s/4*3;i>>=c%bm;const m=Math.floor(c/bm);for(let p=0;p<m;p++){const v=(m-p-1)*bm;n.setUint8(d+p,(i&255<<v)>>v)}}return new Uint8Array(t)},cd=r=>new TextEncoder().encode(r),Nm=r=>typeof r=="string"?cd(r):ArrayBuffer.isView(r)?new Uint8Array(r.buffer,r.byteOffset,r.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(r),Ly=r=>{if(typeof r=="string")return r;if(typeof r!="object"||typeof r.byteOffset!="number"||typeof r.byteLength!="number")throw new Error("@smithy/util-utf8: toUtf8 encoder function only accepts string | Uint8Array.");return new TextDecoder("utf-8").decode(r)};function Tm(r){let e;typeof r=="string"?e=cd(r):e=r;const t=typeof e=="object"&&typeof e.length=="number",n=typeof e=="object"&&typeof e.byteOffset=="number"&&typeof e.byteLength=="number";if(!t&&!n)throw new Error("@smithy/util-base64: toBase64 encoder function only accepts string | Uint8Array.");let s="";for(let i=0;i<e.length;i+=3){let c=0,d=0;for(let p=i,v=Math.min(i+3,e.length);p<v;p++)c|=e[p]<<(v-p-1)*bm,d+=bm;const m=Math.ceil(d/Qf);c<<=m*Qf-d;for(let p=1;p<=m;p++){const v=(m-p)*Qf;s+=x2[(c&w2<<v)>>v]}s+="==".slice(0,4-m)}return s}class sd extends Uint8Array{static fromString(e,t="utf-8"){if(typeof e=="string")return t==="base64"?sd.mutate(qm(e)):sd.mutate(cd(e));throw new Error(`Unsupported conversion from ${typeof e} to Uint8ArrayBlobAdapter.`)}static mutate(e){return Object.setPrototypeOf(e,sd.prototype),e}transformToString(e="utf-8"){return e==="base64"?Tm(this):Ly(this)}}const od=r=>encodeURIComponent(r).replace(/[!'()*]/g,b2),b2=r=>`%${r.charCodeAt(0).toString(16).toUpperCase()}`;function _2(r){const e=[];for(let t of Object.keys(r).sort()){const n=r[t];if(t=od(t),Array.isArray(n))for(let s=0,i=n.length;s<i;s++)e.push(`${t}=${od(n[s])}`);else{let s=t;(n||typeof n=="string")&&(s+=`=${od(n)}`),e.push(s)}}return e.join("&")}function gE(r,e){return new Request(r,e)}function S2(r=0){return new Promise((e,t)=>{r&&setTimeout(()=>{const n=new Error(`Request did not complete within ${r} ms`);n.name="TimeoutError",t(n)},r)})}const dx={supported:void 0};class My{constructor(e){B(this,"config");B(this,"configProvider");typeof e=="function"?this.configProvider=e().then(t=>t||{}):(this.config=e??{},this.configProvider=Promise.resolve(this.config)),dx.supported===void 0&&(dx.supported=typeof Request<"u"&&"keepalive"in gE("https://[::1]"))}static create(e){return typeof(e==null?void 0:e.handle)=="function"?e:new My(e)}destroy(){}async handle(e,{abortSignal:t,requestTimeout:n}={}){var R;this.config||(this.config=await this.configProvider);const s=n??this.config.requestTimeout,i=this.config.keepAlive===!0,c=this.config.credentials;if(t!=null&&t.aborted){const F=new Error("Request aborted");return F.name="AbortError",Promise.reject(F)}let d=e.path;const m=_2(e.query||{});m&&(d+=`?${m}`),e.fragment&&(d+=`#${e.fragment}`);let p="";if(e.username!=null||e.password!=null){const F=e.username??"",j=e.password??"";p=`${F}:${j}@`}const{port:v,method:x}=e,b=`${e.protocol}//${p}${e.hostname}${v?`:${v}`:""}${d}`,S=x==="GET"||x==="HEAD"?void 0:e.body,N={body:S,headers:new Headers(e.headers),method:x,credentials:c};(R=this.config)!=null&&R.cache&&(N.cache=this.config.cache),S&&(N.duplex="half"),typeof AbortController<"u"&&(N.signal=t),dx.supported&&(N.keepalive=i),typeof this.config.requestInit=="function"&&Object.assign(N,this.config.requestInit(e));let E=()=>{};const T=gE(b,N),A=[fetch(T).then(F=>{const j=F.headers,L={};for(const z of j.entries())L[z[0]]=z[1];return F.body!=null?{response:new lh({headers:L,reason:F.statusText,statusCode:F.status,body:F.body})}:F.blob().then(z=>({response:new lh({headers:L,reason:F.statusText,statusCode:F.status,body:z})}))}),S2(s)];return t&&A.push(new Promise((F,j)=>{const L=()=>{const G=new Error("Request aborted");G.name="AbortError",j(G)};if(typeof t.addEventListener=="function"){const G=t;G.addEventListener("abort",L,{once:!0}),E=()=>G.removeEventListener("abort",L)}else t.onabort=L})),Promise.race(A).finally(E)}updateHttpClientConfig(e,t){this.config=void 0,this.configProvider=this.configProvider.then(n=>(n[e]=t,n))}httpHandlerConfigs(){return this.config??{}}}const N1=async r=>{var e;return typeof Blob=="function"&&r instanceof Blob||((e=r.constructor)==null?void 0:e.name)==="Blob"?Blob.prototype.arrayBuffer!==void 0?new Uint8Array(await r.arrayBuffer()):E2(r):C2(r)};async function E2(r){const e=await k2(r),t=qm(e);return new Uint8Array(t)}async function C2(r){const e=[],t=r.getReader();let n=!1,s=0;for(;!n;){const{done:d,value:m}=await t.read();m&&(e.push(m),s+=m.length),n=d}const i=new Uint8Array(s);let c=0;for(const d of e)i.set(d,c),c+=d.length;return i}function k2(r){return new Promise((e,t)=>{const n=new FileReader;n.onloadend=()=>{if(n.readyState!==2)return t(new Error("Reader aborted too early"));const s=n.result??"",i=s.indexOf(","),c=i>-1?i+1:s.length;e(s.substring(c))},n.onabort=()=>t(new Error("Read aborted")),n.onerror=()=>t(n.error),n.readAsDataURL(r)})}const T1={},xw={};for(let r=0;r<256;r++){let e=r.toString(16).toLowerCase();e.length===1&&(e=`0${e}`),T1[r]=e,xw[e]=r}function N2(r){if(r.length%2!==0)throw new Error("Hex encoded strings must have an even number length");const e=new Uint8Array(r.length/2);for(let t=0;t<r.length;t+=2){const n=r.slice(t,t+2).toLowerCase();if(n in xw)e[t/2]=xw[n];else throw new Error(`Cannot decode unrecognized sequence ${n} as hexadecimal`)}return e}function id(r){let e="";for(let t=0;t<r.byteLength;t++)e+=T1[r[t]];return e}const ww=async(r=new Uint8Array,e)=>{if(r instanceof Uint8Array)return sd.mutate(r);if(!r)return sd.mutate(new Uint8Array);const t=e.streamCollector(r);return sd.mutate(await t)},zv=r=>typeof r=="function"?r():r,A1=(r,e,t,n,s)=>({name:e,namespace:r,traits:t,input:n,output:s}),T2=r=>(e,t)=>async n=>{var x,b,S,N;const{response:s}=await e(n),{operationSchema:i}=pd(t),[,c,d,m,p,v]=i??[];try{const E=await r.protocol.deserializeResponse(A1(c,d,m,p,v),{...r,...t},s);return{response:s,output:E}}catch(E){if(Object.defineProperty(E,"$response",{value:s,enumerable:!1,writable:!1,configurable:!1}),!("$metadata"in E)){const T="Deserialization error: to see the raw response, inspect the hidden field {error}.$response on this object.";try{E.message+=`
  `+T}catch{!t.logger||((b=(x=t.logger)==null?void 0:x.constructor)==null?void 0:b.name)==="NoOpLogger"?console.warn(T):(N=(S=t.logger)==null?void 0:S.warn)==null||N.call(S,T)}typeof E.$responseBodyText<"u"&&E.$response&&(E.$response.body=E.$responseBodyText);try{if(lh.isInstance(s)){const{headers:A={}}=s,R=Object.entries(A);E.$metadata={httpStatusCode:s.statusCode,requestId:fx(/^x-[\w-]+-request-?id$/,R),extendedRequestId:fx(/^x-[\w-]+-id-2$/,R),cfId:fx(/^x-[\w-]+-cf-id$/,R)}}}catch{}}throw E}},fx=(r,e)=>(e.find(([t])=>t.match(r))||[void 0,void 0])[1],A2=r=>(e,t)=>async n=>{var b;const{operationSchema:s}=pd(t),[,i,c,d,m,p]=s??[],v=(b=t.endpointV2)!=null&&b.url&&r.urlParser?async()=>r.urlParser(t.endpointV2.url):r.endpoint,x=await r.protocol.serializeRequest(A1(i,c,d,m,p),n.input,{...r,...t,endpoint:v});return e({...n,request:x})},R2={name:"deserializerMiddleware",step:"deserialize",tags:["DESERIALIZER"],override:!0},I2={name:"serializerMiddleware",step:"serialize",tags:["SERIALIZER"],override:!0};function R1(r){return{applyToStack:e=>{e.add(A2(r),I2),e.add(T2(r),R2),r.protocol.setSerdeContext(r)}}}function am(r){if(typeof r=="object")return r;r=r|0;const e={};let t=0;for(const n of["httpLabel","idempotent","idempotencyToken","sensitive","httpPayload","httpResponseCode","httpQueryParams"])(r>>t++&1)===1&&(e[n]=1);return e}const vE={it:Symbol.for("@smithy/nor-struct-it")},Hc=class Hc{constructor(e,t){B(this,"ref");B(this,"memberName");B(this,"symbol",Hc.symbol);B(this,"name");B(this,"schema");B(this,"_isMemberSchema");B(this,"traits");B(this,"memberTraits");B(this,"normalizedTraits");this.ref=e,this.memberName=t;const n=[];let s=e,i=e;for(this._isMemberSchema=!1;hx(s);)n.push(s[1]),s=s[0],i=zv(s),this._isMemberSchema=!0;if(n.length>0){this.memberTraits={};for(let c=n.length-1;c>=0;--c){const d=n[c];Object.assign(this.memberTraits,am(d))}}else this.memberTraits=0;if(i instanceof Hc){const c=this.memberTraits;Object.assign(this,i),this.memberTraits=Object.assign({},c,i.getMemberTraits(),this.getMemberTraits()),this.normalizedTraits=void 0,this.memberName=t??i.memberName;return}if(this.schema=zv(i),P2(this.schema)?(this.name=`${this.schema[1]}#${this.schema[2]}`,this.traits=this.schema[3]):(this.name=this.memberName??String(i),this.traits=0),this._isMemberSchema&&!t)throw new Error(`@smithy/core/schema - NormalizedSchema member init ${this.getName(!0)} missing member name.`)}static[Symbol.hasInstance](e){const t=this.prototype.isPrototypeOf(e);return!t&&typeof e=="object"&&e!==null?e.symbol===this.symbol:t}static of(e){const t=zv(e);if(t instanceof Hc)return t;if(hx(t)){const[n,s]=t;if(n instanceof Hc)return Object.assign(n.getMergedTraits(),am(s)),n;throw new Error(`@smithy/core/schema - may not init unwrapped member schema=${JSON.stringify(e,null,2)}.`)}return new Hc(t)}getSchema(){const e=this.schema;return Array.isArray(e)&&e[0]===0?e[4]:e}getName(e=!1){const{name:t}=this;return!e&&t&&t.includes("#")?t.split("#")[1]:t||void 0}getMemberName(){return this.memberName}isMemberSchema(){return this._isMemberSchema}isListSchema(){const e=this.getSchema();return typeof e=="number"?e>=64&&e<128:e[0]===1}isMapSchema(){const e=this.getSchema();return typeof e=="number"?e>=128&&e<=255:e[0]===2}isStructSchema(){const e=this.getSchema();if(typeof e!="object")return!1;const t=e[0];return t===3||t===-3||t===4}isUnionSchema(){const e=this.getSchema();return typeof e!="object"?!1:e[0]===4}isBlobSchema(){const e=this.getSchema();return e===21||e===42}isTimestampSchema(){const e=this.getSchema();return typeof e=="number"&&e>=4&&e<=7}isUnitSchema(){return this.getSchema()==="unit"}isDocumentSchema(){return this.getSchema()===15}isStringSchema(){return this.getSchema()===0}isBooleanSchema(){return this.getSchema()===2}isNumericSchema(){return this.getSchema()===1}isBigIntegerSchema(){return this.getSchema()===17}isBigDecimalSchema(){return this.getSchema()===19}isStreaming(){const{streaming:e}=this.getMergedTraits();return!!e||this.getSchema()===42}isIdempotencyToken(){return!!this.getMergedTraits().idempotencyToken}getMergedTraits(){return this.normalizedTraits??(this.normalizedTraits={...this.getOwnTraits(),...this.getMemberTraits()})}getMemberTraits(){return am(this.memberTraits)}getOwnTraits(){return am(this.traits)}getKeySchema(){const[e,t]=[this.isDocumentSchema(),this.isMapSchema()];if(!e&&!t)throw new Error(`@smithy/core/schema - cannot get key for non-map: ${this.getName(!0)}`);const n=this.getSchema(),s=e?15:n[4]??0;return $p([s,0],"key")}getValueSchema(){const e=this.getSchema(),[t,n,s]=[this.isDocumentSchema(),this.isMapSchema(),this.isListSchema()],i=typeof e=="number"?63&e:e&&typeof e=="object"&&(n||s)?e[3+e[0]]:t?15:void 0;if(i!=null)return $p([i,0],n?"value":"member");throw new Error(`@smithy/core/schema - ${this.getName(!0)} has no value member.`)}getMemberSchema(e){const t=this.getSchema();if(this.isStructSchema()&&t[4].includes(e)){const n=t[4].indexOf(e),s=t[5][n];return $p(hx(s)?s:[s,0],e)}if(this.isDocumentSchema())return $p([15,0],e);throw new Error(`@smithy/core/schema - ${this.getName(!0)} has no no member=${e}.`)}getMemberSchemas(){const e={};try{for(const[t,n]of this.structIterator())e[t]=n}catch{}return e}getEventStreamMember(){if(this.isStructSchema()){for(const[e,t]of this.structIterator())if(t.isStreaming()&&t.isStructSchema())return e}return""}*structIterator(){if(this.isUnitSchema())return;if(!this.isStructSchema())throw new Error("@smithy/core/schema - cannot iterate non-struct schema.");const e=this.getSchema(),t=e[4].length;let n=e[vE.it];if(n&&t===n.length){yield*n;return}n=Array(t);for(let s=0;s<t;++s){const i=e[4][s],c=$p([e[5][s],0],i);yield n[s]=[i,c]}e[vE.it]=n}};B(Hc,"symbol",Symbol.for("@smithy/nor"));let Lo=Hc;function $p(r,e){if(r instanceof Lo)return Object.assign(r,{memberName:e,_isMemberSchema:!0});const t=Lo;return new t(r,e)}const hx=r=>Array.isArray(r)&&r.length===2,P2=r=>Array.isArray(r)&&r.length>=5,Ha=class Ha{constructor(e,t=new Map,n=new Map){B(this,"namespace");B(this,"schemas");B(this,"exceptions");this.namespace=e,this.schemas=t,this.exceptions=n}static for(e){return Ha.registries.has(e)||Ha.registries.set(e,new Ha(e)),Ha.registries.get(e)}register(e,t){const n=this.normalizeShapeId(e);Ha.for(n.split("#")[0]).schemas.set(n,t)}getSchema(e){const t=this.normalizeShapeId(e);if(!this.schemas.has(t))throw new Error(`@smithy/core/schema - schema not found for ${t}`);return this.schemas.get(t)}registerError(e,t){const n=e,s=Ha.for(n[1]);s.schemas.set(n[1]+"#"+n[2],n),s.exceptions.set(n,t)}getErrorCtor(e){const t=e;return Ha.for(t[1]).exceptions.get(t)}getBaseException(){for(const e of this.exceptions.keys())if(Array.isArray(e)){const[,t,n]=e,s=t+"#"+n;if(s.startsWith("smithy.ts.sdk.synthetic.")&&s.endsWith("ServiceException"))return e}}find(e){return[...this.schemas.values()].find(e)}clear(){this.schemas.clear(),this.exceptions.clear()}normalizeShapeId(e){return e.includes("#")?e:this.namespace+"#"+e}};B(Ha,"registries",new Map);let xt=Ha;const bw=r=>{if(r!=null){if(typeof r=="string"){const e=parseFloat(r);if(!Number.isNaN(e))return String(e)!==String(r)&&z2.warn(U2(`Expected number but observed string: ${r}`)),e}if(typeof r=="number")return r;throw new TypeError(`Expected number, got ${typeof r}: ${r}`)}},F2=Math.ceil(2**127*(2-2**-23)),yE=r=>{const e=bw(r);if(e!==void 0&&!Number.isNaN(e)&&e!==1/0&&e!==-1/0&&Math.abs(e)>F2)throw new TypeError(`Expected 32-bit float, got ${r}`);return e},j2=r=>{if(r!=null){if(Number.isInteger(r)&&!Number.isNaN(r))return r;throw new TypeError(`Expected integer, got ${typeof r}: ${r}`)}},xE=r=>I1(r,16),wE=r=>I1(r,8),I1=(r,e)=>{const t=j2(r);if(t!==void 0&&O2(t,e)!==t)throw new TypeError(`Expected ${e}-bit integer, got ${r}`);return t},O2=(r,e)=>{switch(e){case 32:return Int32Array.of(r)[0];case 16:return Int16Array.of(r)[0];case 8:return Int8Array.of(r)[0]}},D2=r=>bw(typeof r=="string"?$y(r):r),L2=r=>yE(typeof r=="string"?$y(r):r),M2=/(-?(?:0|[1-9]\d*)(?:\.\d+)?(?:[eE][+-]?\d+)?)|(-?Infinity)|(NaN)/g,$y=r=>{const e=r.match(M2);if(e===null||e[0].length!==r.length)throw new TypeError("Expected real number, got implicit NaN");return parseFloat(r)},sy=r=>xE(typeof r=="string"?$y(r):r),$2=r=>wE(typeof r=="string"?$y(r):r),U2=r=>String(new TypeError(r).stack||r).split(`
`).slice(0,5).filter(e=>!e.includes("stackTraceWarning")).join(`
`),z2={warn:console.warn},H2=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],Cb=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function B2(r){const e=r.getUTCFullYear(),t=r.getUTCMonth(),n=r.getUTCDay(),s=r.getUTCDate(),i=r.getUTCHours(),c=r.getUTCMinutes(),d=r.getUTCSeconds(),m=s<10?`0${s}`:`${s}`,p=i<10?`0${i}`:`${i}`,v=c<10?`0${c}`:`${c}`,x=d<10?`0${d}`:`${d}`;return`${H2[n]}, ${m} ${Cb[t]} ${e} ${p}:${v}:${x} GMT`}const G2=new RegExp(/^(\d{4})-(\d{2})-(\d{2})[tT](\d{2}):(\d{2}):(\d{2})(?:\.(\d+))?(([-+]\d{2}\:\d{2})|[zZ])$/),W2=r=>{if(r==null)return;if(typeof r!="string")throw new TypeError("RFC-3339 date-times must be expressed as strings");const e=G2.exec(r);if(!e)throw new TypeError("Invalid RFC-3339 date-time value");const[t,n,s,i,c,d,m,p,v]=e,x=sy(Am(n)),b=Wc(s,"month",1,12),S=Wc(i,"day",1,31),N=Hv(x,b,S,{hours:c,minutes:d,seconds:m,fractionalMilliseconds:p});return v.toUpperCase()!="Z"&&N.setTime(N.getTime()-sD(v)),N},V2=new RegExp(/^(?:Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d{2}) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d{1,2}):(\d{2}):(\d{2})(?:\.(\d+))? GMT$/),q2=new RegExp(/^(?:Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d{2})-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d{2}) (\d{1,2}):(\d{2}):(\d{2})(?:\.(\d+))? GMT$/),K2=new RegExp(/^(?:Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( [1-9]|\d{2}) (\d{1,2}):(\d{2}):(\d{2})(?:\.(\d+))? (\d{4})$/),Y2=r=>{if(r==null)return;if(typeof r!="string")throw new TypeError("RFC-7231 date-times must be expressed as strings");let e=V2.exec(r);if(e){const[t,n,s,i,c,d,m,p]=e;return Hv(sy(Am(i)),px(s),Wc(n,"day",1,31),{hours:c,minutes:d,seconds:m,fractionalMilliseconds:p})}if(e=q2.exec(r),e){const[t,n,s,i,c,d,m,p]=e;return Z2(Hv(X2(i),px(s),Wc(n,"day",1,31),{hours:c,minutes:d,seconds:m,fractionalMilliseconds:p}))}if(e=K2.exec(r),e){const[t,n,s,i,c,d,m,p]=e;return Hv(sy(Am(p)),px(n),Wc(s.trimLeft(),"day",1,31),{hours:i,minutes:c,seconds:d,fractionalMilliseconds:m})}throw new TypeError("Invalid RFC-7231 date-time value")},J2=r=>{if(r==null)return;let e;if(typeof r=="number")e=r;else if(typeof r=="string")e=D2(r);else if(typeof r=="object"&&r.tag===1)e=r.value;else throw new TypeError("Epoch timestamps must be expressed as floating point numbers or their string representation");if(Number.isNaN(e)||e===1/0||e===-1/0)throw new TypeError("Epoch timestamps must be valid, non-Infinite, non-NaN numerics");return new Date(Math.round(e*1e3))},Hv=(r,e,t,n)=>{const s=e-1;return tD(r,s,t),new Date(Date.UTC(r,s,t,Wc(n.hours,"hour",0,23),Wc(n.minutes,"minute",0,59),Wc(n.seconds,"seconds",0,60),nD(n.fractionalMilliseconds)))},X2=r=>{const e=new Date().getUTCFullYear(),t=Math.floor(e/100)*100+sy(Am(r));return t<e?t+100:t},Q2=50*365*24*60*60*1e3,Z2=r=>r.getTime()-new Date().getTime()>Q2?new Date(Date.UTC(r.getUTCFullYear()-100,r.getUTCMonth(),r.getUTCDate(),r.getUTCHours(),r.getUTCMinutes(),r.getUTCSeconds(),r.getUTCMilliseconds())):r,px=r=>{const e=Cb.indexOf(r);if(e<0)throw new TypeError(`Invalid month: ${r}`);return e+1},eD=[31,28,31,30,31,30,31,31,30,31,30,31],tD=(r,e,t)=>{let n=eD[e];if(e===1&&rD(r)&&(n=29),t>n)throw new TypeError(`Invalid day for ${Cb[e]} in ${r}: ${t}`)},rD=r=>r%4===0&&(r%100!==0||r%400===0),Wc=(r,e,t,n)=>{const s=$2(Am(r));if(s<t||s>n)throw new TypeError(`${e} must be between ${t} and ${n}, inclusive`);return s},nD=r=>r==null?0:L2("0."+r)*1e3,sD=r=>{const e=r[0];let t=1;if(e=="+")t=1;else if(e=="-")t=-1;else throw new TypeError(`Offset direction, ${e}, must be "+" or "-"`);const n=Number(r.substring(1,3)),s=Number(r.substring(4,6));return t*(n*60+s)*60*1e3},Am=r=>{let e=0;for(;e<r.length-1&&r.charAt(e)==="0";)e++;return e===0?r:r.slice(e)},bE=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Ds=Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0")),P1=()=>{if(bE)return bE();const r=new Uint8Array(16);return crypto.getRandomValues(r),r[6]=r[6]&15|64,r[8]=r[8]&63|128,Ds[r[0]]+Ds[r[1]]+Ds[r[2]]+Ds[r[3]]+"-"+Ds[r[4]]+Ds[r[5]]+"-"+Ds[r[6]]+Ds[r[7]]+"-"+Ds[r[8]]+Ds[r[9]]+"-"+Ds[r[10]]+Ds[r[11]]+Ds[r[12]]+Ds[r[13]]+Ds[r[14]]+Ds[r[15]]},Bc=function(e){return Object.assign(new String(e),{deserializeJSON(){return JSON.parse(String(e))},toString(){return String(e)},toJSON(){return String(e)}})};Bc.from=r=>r&&typeof r=="object"&&(r instanceof Bc||"deserializeJSON"in r)?r:typeof r=="string"||Object.getPrototypeOf(r)===String.prototype?Bc(String(r)):Bc(JSON.stringify(r));Bc.fromObject=Bc.from;const _E=/^-?\d*(\.\d+)?$/;class qa{constructor(e,t){B(this,"string");B(this,"type");if(this.string=e,this.type=t,!_E.test(e))throw new Error('@smithy/core/serde - NumericValue must only contain [0-9], at most one decimal point ".", and an optional negation prefix "-".')}toString(){return this.string}static[Symbol.hasInstance](e){if(!e||typeof e!="object")return!1;const t=e;return qa.prototype.isPrototypeOf(e)||t.type==="bigDecimal"&&_E.test(t.string)}}const oD="modulepreload",iD=function(r){return"/FileServer_Staging/dist-outlook-addin/"+r},SE={},_w=function(e,t,n){let s=Promise.resolve();if(t&&t.length>0){let c=function(p){return Promise.all(p.map(v=>Promise.resolve(v).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),m=(d==null?void 0:d.nonce)||(d==null?void 0:d.getAttribute("nonce"));s=c(t.map(p=>{if(p=iD(p),p in SE)return;SE[p]=!0;const v=p.endsWith(".css"),x=v?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${x}`))return;const b=document.createElement("link");if(b.rel=v?"stylesheet":oD,v||(b.as="script"),b.crossOrigin="",b.href=p,m&&b.setAttribute("nonce",m),document.head.appendChild(b),v)return new Promise((S,N)=>{b.addEventListener("load",S),b.addEventListener("error",()=>N(new Error(`Unable to preload CSS for ${p}`)))})}))}function i(c){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=c,window.dispatchEvent(d),!d.defaultPrevented)throw c}return s.then(c=>{for(const d of c||[])d.status==="rejected"&&i(d.reason);return e().catch(i)})};class aD{constructor(){B(this,"serdeContext")}setSerdeContext(e){this.serdeContext=e}}class lD extends aD{constructor(t){super();B(this,"options");this.options=t}getRequestType(){return ii}getResponseType(){return lh}setSerdeContext(t){this.serdeContext=t,this.serializer.setSerdeContext(t),this.deserializer.setSerdeContext(t),this.getPayloadCodec()&&this.getPayloadCodec().setSerdeContext(t)}updateServiceEndpoint(t,n){if("url"in n){t.protocol=n.url.protocol,t.hostname=n.url.hostname,t.port=n.url.port?Number(n.url.port):void 0,t.path=n.url.pathname,t.fragment=n.url.hash||void 0,t.username=n.url.username||void 0,t.password=n.url.password||void 0,t.query||(t.query={});for(const[s,i]of n.url.searchParams.entries())t.query[s]=i;return t}else return t.protocol=n.protocol,t.hostname=n.hostname,t.port=n.port?Number(n.port):void 0,t.path=n.path,t.query={...n.query},t}setHostPrefix(t,n,s){var d,m;if((d=this.serdeContext)!=null&&d.disableHostPrefix)return;const i=Lo.of(n.input),c=am(n.traits??{});if(c.endpoint){let p=(m=c.endpoint)==null?void 0:m[0];if(typeof p=="string"){const v=[...i.structIterator()].filter(([,x])=>x.getMergedTraits().hostLabel);for(const[x]of v){const b=s[x];if(typeof b!="string")throw new Error(`@smithy/core/schema - ${x} in input must be a string as hostLabel.`);p=p.replace(`{${x}}`,b)}t.hostname=p+t.hostname}}}deserializeMetadata(t){return{httpStatusCode:t.statusCode,requestId:t.headers["x-amzn-requestid"]??t.headers["x-amzn-request-id"]??t.headers["x-amz-request-id"],extendedRequestId:t.headers["x-amz-id-2"],cfId:t.headers["x-amz-cf-id"]}}async serializeEventStream({eventStream:t,requestSchema:n,initialRequest:s}){return(await this.loadEventStreamCapability()).serializeEventStream({eventStream:t,requestSchema:n,initialRequest:s})}async deserializeEventStream({response:t,responseSchema:n,initialResponseContainer:s}){return(await this.loadEventStreamCapability()).deserializeEventStream({response:t,responseSchema:n,initialResponseContainer:s})}async loadEventStreamCapability(){const{EventStreamSerde:t}=await _w(async()=>{const{EventStreamSerde:n}=await import("./index.DS5eee3c.js");return{EventStreamSerde:n}},__vite__mapDeps([0,1]));return new t({marshaller:this.getEventStreamMarshaller(),serializer:this.serializer,deserializer:this.deserializer,serdeContext:this.serdeContext,defaultContentType:this.getDefaultContentType()})}getDefaultContentType(){throw new Error(`@smithy/core/protocols - ${this.constructor.name} getDefaultContentType() implementation missing.`)}async deserializeHttpMessage(t,n,s,i,c){return[]}getEventStreamMarshaller(){const t=this.serdeContext;if(!t.eventStreamMarshaller)throw new Error("@smithy/core - HttpProtocol: eventStreamMarshaller missing in serdeContext.");return t.eventStreamMarshaller}}class cD extends lD{async serializeRequest(e,t,n){const s=this.serializer,i={},c={},d=await n.endpoint(),m=Lo.of(e==null?void 0:e.input),p=m.getSchema();let v;const x=new ii({protocol:"",hostname:"",port:void 0,path:"/",fragment:void 0,query:i,headers:c,body:void 0});d&&(this.updateServiceEndpoint(x,d),this.setHostPrefix(x,e,t));const b={...t};if(t){const S=m.getEventStreamMember();if(S){if(b[S]){const N={};for(const[E,T]of m.structIterator())E!==S&&b[E]&&(s.write(T,b[E]),N[E]=s.flush());v=await this.serializeEventStream({eventStream:b[S],requestSchema:m,initialRequest:N})}}else s.write(p,b),v=s.flush()}return x.headers=c,x.query=i,x.body=v,x.method="POST",x}async deserializeResponse(e,t,n){const s=this.deserializer,i=Lo.of(e.output),c={};if(n.statusCode>=300){const m=await ww(n.body,t);throw m.byteLength>0&&Object.assign(c,await s.read(15,m)),await this.handleError(e,t,n,c,this.deserializeMetadata(n)),new Error("@smithy/core/protocols - RPC Protocol error handler failed to throw.")}for(const m in n.headers){const p=n.headers[m];delete n.headers[m],n.headers[m.toLowerCase()]=p}const d=i.getEventStreamMember();if(d)c[d]=await this.deserializeEventStream({response:n,responseSchema:i,initialResponseContainer:c});else{const m=await ww(n.body,t);m.byteLength>0&&Object.assign(c,await s.read(i,m))}return c.$metadata=this.deserializeMetadata(n),c}}function F1(r,e){if(e.timestampFormat.useTrait&&r.isTimestampSchema()&&(r.getSchema()===5||r.getSchema()===6||r.getSchema()===7))return r.getSchema();const{httpLabel:t,httpPrefixHeaders:n,httpHeader:s,httpQuery:i}=r.getMergedTraits();return(e.httpBindings?typeof n=="string"||s?6:i||t?5:void 0:void 0)??e.timestampFormat.default}function uD(r,e,t){r.__smithy_context?r.__smithy_context.features||(r.__smithy_context.features={}):r.__smithy_context={features:{}},r.__smithy_context.features[e]=t}class j1{constructor(e){B(this,"authSchemes",new Map);for(const[t,n]of Object.entries(e))n!==void 0&&this.authSchemes.set(t,n)}getIdentityProvider(e){return this.authSchemes.get(e)}}class O1{async sign(e,t,n){return e}}const dD=r=>function(t){return D1(t)&&t.expiration.getTime()-Date.now()<r},fD=3e5,hD=dD(fD),D1=r=>r.expiration!==void 0,pD=(r,e,t)=>{if(r===void 0)return;const n=typeof r!="function"?async()=>Promise.resolve(r):r;let s,i,c,d=!1;const m=async p=>{i||(i=n(p));try{s=await i,c=!0,d=!1}finally{i=void 0}return s};return e===void 0?async p=>((!c||p!=null&&p.forceRefresh)&&(s=await m(p)),s):async p=>((!c||p!=null&&p.forceRefresh)&&(s=await m(p)),d?s:t(s)?(e(s)&&await m(p),s):(d=!0,s))},mD=void 0;function gD(r){return r===void 0?!0:typeof r=="string"&&r.length<=50}function L1(r){const e=wm(r.userAgentAppId??mD),{customUserAgent:t}=r;return Object.assign(r,{customUserAgent:typeof t=="string"?[[t]]:t,userAgentAppId:async()=>{var s,i;const n=await e();if(!gD(n)){const c=((i=(s=r.logger)==null?void 0:s.constructor)==null?void 0:i.name)==="NoOpLogger"||!r.logger?console:r.logger;typeof n!="string"?c==null||c.warn("userAgentAppId must be a string or undefined."):n.length>50&&(c==null||c.warn("The provided userAgentAppId exceeds the maximum length of 50 characters."))}return n}})}class M1{constructor({size:e,params:t}){B(this,"capacity");B(this,"data",new Map);B(this,"parameters",[]);this.capacity=e??50,t&&(this.parameters=t)}get(e,t){const n=this.hash(e);if(n===!1)return t();if(!this.data.has(n)){if(this.data.size>this.capacity+10){const s=this.data.keys();let i=0;for(;;){const{value:c,done:d}=s.next();if(this.data.delete(c),d||++i>10)break}}this.data.set(n,t())}return this.data.get(n)}size(){return this.data.size}hash(e){let t="";const{parameters:n}=this;if(n.length===0)return!1;for(const s of n){const i=String(e[s]??"");if(i.includes("|;"))return!1;t+=i+"|;"}return t}}const vD=new RegExp("^(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}$"),kb=r=>vD.test(r)||r.startsWith("[")&&r.endsWith("]"),yD=new RegExp("^(?!.*-$)(?!-)[a-zA-Z0-9-]{1,63}$"),Km=(r,e=!1)=>{if(!e)return yD.test(r);const t=r.split(".");for(const n of t)if(!Km(n))return!1;return!0},ch={},Rm="endpoints";function Yc(r){return typeof r!="object"||r==null?r:"ref"in r?`$${Yc(r.ref)}`:"fn"in r?`${r.fn}(${(r.argv||[]).map(Yc).join(", ")})`:JSON.stringify(r,null,2)}class ai extends Error{constructor(e){super(e),this.name="EndpointError"}}const xD=(r,e)=>r===e,wD=r=>{const e=r.split("."),t=[];for(const n of e){const s=n.indexOf("[");if(s!==-1){if(n.indexOf("]")!==n.length-1)throw new ai(`Path: '${r}' does not end with ']'`);const i=n.slice(s+1,-1);if(Number.isNaN(parseInt(i)))throw new ai(`Invalid array index: '${i}' in path: '${r}'`);s!==0&&t.push(n.slice(0,s)),t.push(i)}else t.push(n)}return t},$1=(r,e)=>wD(e).reduce((t,n)=>{if(typeof t!="object")throw new ai(`Index '${n}' in '${e}' not found in '${JSON.stringify(r)}'`);return Array.isArray(t)?t[parseInt(n)]:t[n]},r),bD=r=>r!=null,_D=r=>!r,mx={[km.HTTP]:80,[km.HTTPS]:443},SD=r=>{const e=(()=>{try{if(r instanceof URL)return r;if(typeof r=="object"&&"hostname"in r){const{hostname:b,port:S,protocol:N="",path:E="",query:T={}}=r,A=new URL(`${N}//${b}${S?`:${S}`:""}${E}`);return A.search=Object.entries(T).map(([R,F])=>`${R}=${F}`).join("&"),A}return new URL(r)}catch{return null}})();if(!e)return console.error(`Unable to parse ${JSON.stringify(r)} as a whatwg URL.`),null;const t=e.href,{host:n,hostname:s,pathname:i,protocol:c,search:d}=e;if(d)return null;const m=c.slice(0,-1);if(!Object.values(km).includes(m))return null;const p=kb(s),v=t.includes(`${n}:${mx[m]}`)||typeof r=="string"&&r.includes(`${n}:${mx[m]}`),x=`${n}${v?`:${mx[m]}`:""}`;return{scheme:m,authority:x,path:i,normalizedPath:i.endsWith("/")?i:`${i}/`,isIp:p}},ED=(r,e)=>r===e,CD=(r,e,t,n)=>e>=t||r.length<t?null:n?r.substring(r.length-t,r.length-e):r.substring(e,t),kD=r=>encodeURIComponent(r).replace(/[!*'()]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),ND={booleanEquals:xD,getAttr:$1,isSet:bD,isValidHostLabel:Km,not:_D,parseURL:SD,stringEquals:ED,substring:CD,uriEncode:kD},U1=(r,e)=>{const t=[],n={...e.endpointParams,...e.referenceRecord};let s=0;for(;s<r.length;){const i=r.indexOf("{",s);if(i===-1){t.push(r.slice(s));break}t.push(r.slice(s,i));const c=r.indexOf("}",i);if(c===-1){t.push(r.slice(i));break}r[i+1]==="{"&&r[c+1]==="}"&&(t.push(r.slice(i+1,c)),s=c+2);const d=r.substring(i+1,c);if(d.includes("#")){const[m,p]=d.split("#");t.push($1(n[m],p))}else t.push(n[d]);s=c+1}return t.join("")},TD=({ref:r},e)=>({...e.endpointParams,...e.referenceRecord})[r],Uy=(r,e,t)=>{if(typeof r=="string")return U1(r,t);if(r.fn)return H1.callFunction(r,t);if(r.ref)return TD(r,t);throw new ai(`'${e}': ${String(r)} is not a string, function or reference.`)},z1=({fn:r,argv:e},t)=>{const n=e.map(i=>["boolean","number"].includes(typeof i)?i:H1.evaluateExpression(i,"arg",t)),s=r.split(".");return s[0]in ch&&s[1]!=null?ch[s[0]][s[1]](...n):ND[r](...n)},H1={evaluateExpression:Uy,callFunction:z1},AD=({assign:r,...e},t)=>{var s,i;if(r&&r in t.referenceRecord)throw new ai(`'${r}' is already defined in Reference Record.`);const n=z1(e,t);return(i=(s=t.logger)==null?void 0:s.debug)==null||i.call(s,`${Rm} evaluateCondition: ${Yc(e)} = ${Yc(n)}`),{result:n===""?!0:!!n,...r!=null&&{toAssign:{name:r,value:n}}}},Nb=(r=[],e)=>{var n,s;const t={};for(const i of r){const{result:c,toAssign:d}=AD(i,{...e,referenceRecord:{...e.referenceRecord,...t}});if(!c)return{result:c};d&&(t[d.name]=d.value,(s=(n=e.logger)==null?void 0:n.debug)==null||s.call(n,`${Rm} assign: ${d.name} := ${Yc(d.value)}`))}return{result:!0,referenceRecord:t}},RD=(r,e)=>Object.entries(r).reduce((t,[n,s])=>({...t,[n]:s.map(i=>{const c=Uy(i,"Header value entry",e);if(typeof c!="string")throw new ai(`Header '${n}' value '${c}' is not a string`);return c})}),{}),B1=(r,e)=>Object.entries(r).reduce((t,[n,s])=>({...t,[n]:W1.getEndpointProperty(s,e)}),{}),G1=(r,e)=>{if(Array.isArray(r))return r.map(t=>G1(t,e));switch(typeof r){case"string":return U1(r,e);case"object":if(r===null)throw new ai(`Unexpected endpoint property: ${r}`);return W1.getEndpointProperties(r,e);case"boolean":return r;default:throw new ai(`Unexpected endpoint property type: ${typeof r}`)}},W1={getEndpointProperty:G1,getEndpointProperties:B1},ID=(r,e)=>{const t=Uy(r,"Endpoint URL",e);if(typeof t=="string")try{return new URL(t)}catch(n){throw console.error(`Failed to construct URL with ${t}`,n),n}throw new ai(`Endpoint URL must be a string, got ${typeof t}`)},PD=(r,e)=>{var v,x;const{conditions:t,endpoint:n}=r,{result:s,referenceRecord:i}=Nb(t,e);if(!s)return;const c={...e,referenceRecord:{...e.referenceRecord,...i}},{url:d,properties:m,headers:p}=n;return(x=(v=e.logger)==null?void 0:v.debug)==null||x.call(v,`${Rm} Resolving endpoint from template: ${Yc(n)}`),{...p!=null&&{headers:RD(p,c)},...m!=null&&{properties:B1(m,c)},url:ID(d,c)}},FD=(r,e)=>{const{conditions:t,error:n}=r,{result:s,referenceRecord:i}=Nb(t,e);if(s)throw new ai(Uy(n,"Error",{...e,referenceRecord:{...e.referenceRecord,...i}}))},V1=(r,e)=>{for(const t of r)if(t.type==="endpoint"){const n=PD(t,e);if(n)return n}else if(t.type==="error")FD(t,e);else if(t.type==="tree"){const n=q1.evaluateTreeRule(t,e);if(n)return n}else throw new ai(`Unknown endpoint rule: ${t}`);throw new ai("Rules evaluation failed")},jD=(r,e)=>{const{conditions:t,rules:n}=r,{result:s,referenceRecord:i}=Nb(t,e);if(s)return q1.evaluateRules(n,{...e,referenceRecord:{...e.referenceRecord,...i}})},q1={evaluateRules:V1,evaluateTreeRule:jD},K1=(r,e)=>{var p,v,x,b;const{endpointParams:t,logger:n}=e,{parameters:s,rules:i}=r;(v=(p=e.logger)==null?void 0:p.debug)==null||v.call(p,`${Rm} Initial EndpointParams: ${Yc(t)}`);const c=Object.entries(s).filter(([,S])=>S.default!=null).map(([S,N])=>[S,N.default]);if(c.length>0)for(const[S,N]of c)t[S]=t[S]??N;const d=Object.entries(s).filter(([,S])=>S.required).map(([S])=>S);for(const S of d)if(t[S]==null)throw new ai(`Missing required parameter: '${S}'`);const m=V1(i,{endpointParams:t,logger:n,referenceRecord:{}});return(b=(x=e.logger)==null?void 0:x.debug)==null||b.call(x,`${Rm} Resolved endpoint: ${Yc(m)}`),m},Y1=(r,e=!1)=>{if(e){for(const t of r.split("."))if(!Y1(t))return!1;return!0}return!(!Km(r)||r.length<3||r.length>63||r!==r.toLowerCase()||kb(r))},EE=":",OD="/",DD=r=>{const e=r.split(EE);if(e.length<6)return null;const[t,n,s,i,c,...d]=e;if(t!=="arn"||n===""||s===""||d.join(EE)==="")return null;const m=d.map(p=>p.split(OD)).flat();return{partition:n,service:s,region:i,accountId:c,resourceId:m}},LD=[{id:"aws",outputs:{dnsSuffix:"amazonaws.com",dualStackDnsSuffix:"api.aws",implicitGlobalRegion:"us-east-1",name:"aws",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^(us|eu|ap|sa|ca|me|af|il|mx)\\-\\w+\\-\\d+$",regions:{"af-south-1":{description:"Africa (Cape Town)"},"ap-east-1":{description:"Asia Pacific (Hong Kong)"},"ap-east-2":{description:"Asia Pacific (Taipei)"},"ap-northeast-1":{description:"Asia Pacific (Tokyo)"},"ap-northeast-2":{description:"Asia Pacific (Seoul)"},"ap-northeast-3":{description:"Asia Pacific (Osaka)"},"ap-south-1":{description:"Asia Pacific (Mumbai)"},"ap-south-2":{description:"Asia Pacific (Hyderabad)"},"ap-southeast-1":{description:"Asia Pacific (Singapore)"},"ap-southeast-2":{description:"Asia Pacific (Sydney)"},"ap-southeast-3":{description:"Asia Pacific (Jakarta)"},"ap-southeast-4":{description:"Asia Pacific (Melbourne)"},"ap-southeast-5":{description:"Asia Pacific (Malaysia)"},"ap-southeast-6":{description:"Asia Pacific (New Zealand)"},"ap-southeast-7":{description:"Asia Pacific (Thailand)"},"aws-global":{description:"aws global region"},"ca-central-1":{description:"Canada (Central)"},"ca-west-1":{description:"Canada West (Calgary)"},"eu-central-1":{description:"Europe (Frankfurt)"},"eu-central-2":{description:"Europe (Zurich)"},"eu-north-1":{description:"Europe (Stockholm)"},"eu-south-1":{description:"Europe (Milan)"},"eu-south-2":{description:"Europe (Spain)"},"eu-west-1":{description:"Europe (Ireland)"},"eu-west-2":{description:"Europe (London)"},"eu-west-3":{description:"Europe (Paris)"},"il-central-1":{description:"Israel (Tel Aviv)"},"me-central-1":{description:"Middle East (UAE)"},"me-south-1":{description:"Middle East (Bahrain)"},"mx-central-1":{description:"Mexico (Central)"},"sa-east-1":{description:"South America (Sao Paulo)"},"us-east-1":{description:"US East (N. Virginia)"},"us-east-2":{description:"US East (Ohio)"},"us-west-1":{description:"US West (N. California)"},"us-west-2":{description:"US West (Oregon)"}}},{id:"aws-cn",outputs:{dnsSuffix:"amazonaws.com.cn",dualStackDnsSuffix:"api.amazonwebservices.com.cn",implicitGlobalRegion:"cn-northwest-1",name:"aws-cn",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^cn\\-\\w+\\-\\d+$",regions:{"aws-cn-global":{description:"aws-cn global region"},"cn-north-1":{description:"China (Beijing)"},"cn-northwest-1":{description:"China (Ningxia)"}}},{id:"aws-eusc",outputs:{dnsSuffix:"amazonaws.eu",dualStackDnsSuffix:"api.amazonwebservices.eu",implicitGlobalRegion:"eusc-de-east-1",name:"aws-eusc",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^eusc\\-(de)\\-\\w+\\-\\d+$",regions:{"eusc-de-east-1":{description:"AWS European Sovereign Cloud (Germany)"}}},{id:"aws-iso",outputs:{dnsSuffix:"c2s.ic.gov",dualStackDnsSuffix:"api.aws.ic.gov",implicitGlobalRegion:"us-iso-east-1",name:"aws-iso",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-iso\\-\\w+\\-\\d+$",regions:{"aws-iso-global":{description:"aws-iso global region"},"us-iso-east-1":{description:"US ISO East"},"us-iso-west-1":{description:"US ISO WEST"}}},{id:"aws-iso-b",outputs:{dnsSuffix:"sc2s.sgov.gov",dualStackDnsSuffix:"api.aws.scloud",implicitGlobalRegion:"us-isob-east-1",name:"aws-iso-b",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-isob\\-\\w+\\-\\d+$",regions:{"aws-iso-b-global":{description:"aws-iso-b global region"},"us-isob-east-1":{description:"US ISOB East (Ohio)"},"us-isob-west-1":{description:"US ISOB West"}}},{id:"aws-iso-e",outputs:{dnsSuffix:"cloud.adc-e.uk",dualStackDnsSuffix:"api.cloud-aws.adc-e.uk",implicitGlobalRegion:"eu-isoe-west-1",name:"aws-iso-e",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^eu\\-isoe\\-\\w+\\-\\d+$",regions:{"aws-iso-e-global":{description:"aws-iso-e global region"},"eu-isoe-west-1":{description:"EU ISOE West"}}},{id:"aws-iso-f",outputs:{dnsSuffix:"csp.hci.ic.gov",dualStackDnsSuffix:"api.aws.hci.ic.gov",implicitGlobalRegion:"us-isof-south-1",name:"aws-iso-f",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-isof\\-\\w+\\-\\d+$",regions:{"aws-iso-f-global":{description:"aws-iso-f global region"},"us-isof-east-1":{description:"US ISOF EAST"},"us-isof-south-1":{description:"US ISOF SOUTH"}}},{id:"aws-us-gov",outputs:{dnsSuffix:"amazonaws.com",dualStackDnsSuffix:"api.aws",implicitGlobalRegion:"us-gov-west-1",name:"aws-us-gov",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-gov\\-\\w+\\-\\d+$",regions:{"aws-us-gov-global":{description:"aws-us-gov global region"},"us-gov-east-1":{description:"AWS GovCloud (US-East)"},"us-gov-west-1":{description:"AWS GovCloud (US-West)"}}}],MD={partitions:LD};let $D=MD;const UD=r=>{const{partitions:e}=$D;for(const n of e){const{regions:s,outputs:i}=n;for(const[c,d]of Object.entries(s))if(c===r)return{...i,...d}}for(const n of e){const{regionRegex:s,outputs:i}=n;if(new RegExp(s).test(r))return{...i}}const t=e.find(n=>n.id==="aws");if(!t)throw new Error("Provided region was not found in the partition array or regex, and default partition with id 'aws' doesn't exist.");return{...t.outputs}},zD={isVirtualHostableS3Bucket:Y1,parseArn:DD,partition:UD};ch.aws=zD;function HD(r){const e={};if(r=r.replace(/^\?/,""),r)for(const t of r.split("&")){let[n,s=null]=t.split("=");n=decodeURIComponent(n),s&&(s=decodeURIComponent(s)),n in e?Array.isArray(e[n])?e[n].push(s):e[n]=[e[n],s]:e[n]=s}return e}const Im=r=>{if(typeof r=="string")return Im(new URL(r));const{hostname:e,pathname:t,port:n,protocol:s,search:i}=r;let c;return i&&(c=HD(i)),{hostname:e,port:n?parseInt(n):void 0,protocol:s,path:t,query:c}};function BD(r,e,t){return r.$source||(r.$source={}),r.$source[e]=t,r}function Ma(r,e,t){r.__aws_sdk_context?r.__aws_sdk_context.features||(r.__aws_sdk_context.features={}):r.__aws_sdk_context={features:{}},r.__aws_sdk_context.features[e]=t}const CE=r=>{var e,t;return lh.isInstance(r)?((e=r.headers)==null?void 0:e.date)??((t=r.headers)==null?void 0:t.Date):void 0},J1=r=>new Date(Date.now()+r),GD=(r,e)=>Math.abs(J1(e).getTime()-r)>=3e5,kE=(r,e)=>{const t=Date.parse(r);return GD(t,e)?t-Date.now():e},_m=(r,e)=>{if(!e)throw new Error(`Property \`${r}\` is not resolved for AWS SDK SigV4Auth`);return e},WD=async r=>{var p,v,x;const e=_m("context",r.context),t=_m("config",r.config),n=(x=(v=(p=e.endpointV2)==null?void 0:p.properties)==null?void 0:v.authSchemes)==null?void 0:x[0],i=await _m("signer",t.signer)(n),c=r==null?void 0:r.signingRegion,d=r==null?void 0:r.signingRegionSet,m=r==null?void 0:r.signingName;return{config:t,signer:i,signingRegion:c,signingRegionSet:d,signingName:m}};class X1{async sign(e,t,n){var x;if(!ii.isInstance(e))throw new Error("The request is not an instance of `HttpRequest` and cannot be signed");const s=await WD(n),{config:i,signer:c}=s;let{signingRegion:d,signingName:m}=s;const p=n.context;if(((x=p==null?void 0:p.authSchemes)==null?void 0:x.length)??!1){const[b,S]=p.authSchemes;(b==null?void 0:b.name)==="sigv4a"&&(S==null?void 0:S.name)==="sigv4"&&(d=(S==null?void 0:S.signingRegion)??d,m=(S==null?void 0:S.signingName)??m)}return await c.sign(e,{signingDate:J1(i.systemClockOffset),signingRegion:d,signingService:m})}errorHandler(e){return t=>{const n=t.ServerTime??CE(t.$response);if(n){const s=_m("config",e.config),i=s.systemClockOffset;s.systemClockOffset=kE(n,s.systemClockOffset),s.systemClockOffset!==i&&t.$metadata&&(t.$metadata.clockSkewCorrected=!0)}throw t}}successHandler(e,t){const n=CE(e);if(n){const s=_m("config",t.config);s.systemClockOffset=kE(n,s.systemClockOffset)}}}const VD=(r,e,t)=>{let n,s,i,c=!1;const d=async()=>{s||(s=r());try{n=await s,i=!0,c=!1}finally{s=void 0}return n};return async m=>((!i||m!=null&&m.forceRefresh)&&(n=await d()),n)},qD="X-Amz-Algorithm",KD="X-Amz-Credential",Q1="X-Amz-Date",YD="X-Amz-SignedHeaders",JD="X-Amz-Expires",Z1="X-Amz-Signature",eN="X-Amz-Security-Token",tN="authorization",rN=Q1.toLowerCase(),XD="date",QD=[tN,rN,XD],ZD=Z1.toLowerCase(),Sw="x-amz-content-sha256",eL=eN.toLowerCase(),tL={authorization:!0,"cache-control":!0,connection:!0,expect:!0,from:!0,"keep-alive":!0,"max-forwards":!0,pragma:!0,referer:!0,te:!0,trailer:!0,"transfer-encoding":!0,upgrade:!0,"user-agent":!0,"x-amzn-trace-id":!0},rL=/^proxy-/,nL=/^sec-/,gx="AWS4-HMAC-SHA256",sL="AWS4-HMAC-SHA256-PAYLOAD",oL="UNSIGNED-PAYLOAD",iL=50,nN="aws4_request",aL=3600*24*7,bv={},vx=[],yx=(r,e,t)=>`${r}/${e}/${t}/${nN}`,lL=async(r,e,t,n,s)=>{const i=await NE(r,e.secretAccessKey,e.accessKeyId),c=`${t}:${n}:${s}:${id(i)}:${e.sessionToken}`;if(c in bv)return bv[c];for(vx.push(c);vx.length>iL;)delete bv[vx.shift()];let d=`AWS4${e.secretAccessKey}`;for(const m of[t,n,s,nN])d=await NE(r,d,m);return bv[c]=d},NE=(r,e,t)=>{const n=new r(e);return n.update(Nm(t)),n.digest()},TE=({headers:r},e,t)=>{const n={};for(const s of Object.keys(r).sort()){if(r[s]==null)continue;const i=s.toLowerCase();(i in tL||e!=null&&e.has(i)||rL.test(i)||nL.test(i))&&(!t||t&&!t.has(i))||(n[i]=r[s].trim().replace(/\s+/g," "))}return n},cL=r=>typeof ArrayBuffer=="function"&&r instanceof ArrayBuffer||Object.prototype.toString.call(r)==="[object ArrayBuffer]",xx=async({headers:r,body:e},t)=>{for(const n of Object.keys(r))if(n.toLowerCase()===Sw)return r[n];if(e==null)return"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855";if(typeof e=="string"||ArrayBuffer.isView(e)||cL(e)){const n=new t;return n.update(Nm(e)),id(await n.digest())}return oL};class uL{format(e){const t=[];for(const i of Object.keys(e)){const c=cd(i);t.push(Uint8Array.from([c.byteLength]),c,this.formatHeaderValue(e[i]))}const n=new Uint8Array(t.reduce((i,c)=>i+c.byteLength,0));let s=0;for(const i of t)n.set(i,s),s+=i.byteLength;return n}formatHeaderValue(e){switch(e.type){case"boolean":return Uint8Array.from([e.value?0:1]);case"byte":return Uint8Array.from([2,e.value]);case"short":const t=new DataView(new ArrayBuffer(3));return t.setUint8(0,3),t.setInt16(1,e.value,!1),new Uint8Array(t.buffer);case"integer":const n=new DataView(new ArrayBuffer(5));return n.setUint8(0,4),n.setInt32(1,e.value,!1),new Uint8Array(n.buffer);case"long":const s=new Uint8Array(9);return s[0]=5,s.set(e.value.bytes,1),s;case"binary":const i=new DataView(new ArrayBuffer(3+e.value.byteLength));i.setUint8(0,6),i.setUint16(1,e.value.byteLength,!1);const c=new Uint8Array(i.buffer);return c.set(e.value,3),c;case"string":const d=cd(e.value),m=new DataView(new ArrayBuffer(3+d.byteLength));m.setUint8(0,7),m.setUint16(1,d.byteLength,!1);const p=new Uint8Array(m.buffer);return p.set(d,3),p;case"timestamp":const v=new Uint8Array(9);return v[0]=8,v.set(Tb.fromNumber(e.value.valueOf()).bytes,1),v;case"uuid":if(!dL.test(e.value))throw new Error(`Invalid UUID received: ${e.value}`);const x=new Uint8Array(17);return x[0]=9,x.set(N2(e.value.replace(/\-/g,"")),1),x}}}var AE;(function(r){r[r.boolTrue=0]="boolTrue",r[r.boolFalse=1]="boolFalse",r[r.byte=2]="byte",r[r.short=3]="short",r[r.integer=4]="integer",r[r.long=5]="long",r[r.byteArray=6]="byteArray",r[r.string=7]="string",r[r.timestamp=8]="timestamp",r[r.uuid=9]="uuid"})(AE||(AE={}));const dL=/^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$/;class Tb{constructor(e){B(this,"bytes");if(this.bytes=e,e.byteLength!==8)throw new Error("Int64 buffers must be exactly 8 bytes")}static fromNumber(e){if(e>9223372036854776e3||e<-9223372036854776e3)throw new Error(`${e} is too large (or, if negative, too small) to represent as an Int64`);const t=new Uint8Array(8);for(let n=7,s=Math.abs(Math.round(e));n>-1&&s>0;n--,s/=256)t[n]=s;return e<0&&RE(t),new Tb(t)}valueOf(){const e=this.bytes.slice(0),t=e[0]&128;return t&&RE(e),parseInt(id(e),16)*(t?-1:1)}toString(){return String(this.valueOf())}}function RE(r){for(let e=0;e<8;e++)r[e]^=255;for(let e=7;e>-1&&(r[e]++,r[e]===0);e--);}const fL=(r,e)=>{r=r.toLowerCase();for(const t of Object.keys(e))if(r===t.toLowerCase())return!0;return!1},hL=(r,e={})=>{var s,i;const{headers:t,query:n={}}=ii.clone(r);for(const c of Object.keys(t)){const d=c.toLowerCase();(d.slice(0,6)==="x-amz-"&&!((s=e.unhoistableHeaders)!=null&&s.has(d))||(i=e.hoistableHeaders)!=null&&i.has(d))&&(n[c]=t[c],delete t[c])}return{...r,headers:t,query:n}},IE=r=>{r=ii.clone(r);for(const e of Object.keys(r.headers))QD.indexOf(e.toLowerCase())>-1&&delete r.headers[e];return r},pL=({query:r={}})=>{const e=[],t={};for(const n of Object.keys(r)){if(n.toLowerCase()===ZD)continue;const s=od(n);e.push(s);const i=r[n];typeof i=="string"?t[s]=`${s}=${od(i)}`:Array.isArray(i)&&(t[s]=i.slice(0).reduce((c,d)=>c.concat([`${s}=${od(d)}`]),[]).sort().join("&"))}return e.sort().map(n=>t[n]).filter(n=>n).join("&")},mL=r=>gL(r).toISOString().replace(/\.\d{3}Z$/,"Z"),gL=r=>typeof r=="number"?new Date(r*1e3):typeof r=="string"?Number(r)?new Date(Number(r)*1e3):new Date(r):r;class vL{constructor({applyChecksum:e,credentials:t,region:n,service:s,sha256:i,uriEscapePath:c=!0}){B(this,"service");B(this,"regionProvider");B(this,"credentialProvider");B(this,"sha256");B(this,"uriEscapePath");B(this,"applyChecksum");this.service=s,this.sha256=i,this.uriEscapePath=c,this.applyChecksum=typeof e=="boolean"?e:!0,this.regionProvider=oa(n),this.credentialProvider=oa(t)}createCanonicalRequest(e,t,n){const s=Object.keys(t).sort();return`${e.method}
${this.getCanonicalPath(e)}
${pL(e)}
${s.map(i=>`${i}:${t[i]}`).join(`
`)}

${s.join(";")}
${n}`}async createStringToSign(e,t,n,s){const i=new this.sha256;i.update(Nm(n));const c=await i.digest();return`${s}
${e}
${t}
${id(c)}`}getCanonicalPath({path:e}){if(this.uriEscapePath){const t=[];for(const i of e.split("/"))(i==null?void 0:i.length)!==0&&i!=="."&&(i===".."?t.pop():t.push(i));const n=`${e!=null&&e.startsWith("/")?"/":""}${t.join("/")}${t.length>0&&(e!=null&&e.endsWith("/"))?"/":""}`;return od(n).replace(/%2F/g,"/")}return e}validateResolvedCredentials(e){if(typeof e!="object"||typeof e.accessKeyId!="string"||typeof e.secretAccessKey!="string")throw new Error("Resolved credential object is not valid")}formatDate(e){const t=mL(e).replace(/[\-:]/g,"");return{longDate:t,shortDate:t.slice(0,8)}}getCanonicalHeaderList(e){return Object.keys(e).sort().join(";")}}class PE extends vL{constructor({applyChecksum:t,credentials:n,region:s,service:i,sha256:c,uriEscapePath:d=!0}){super({applyChecksum:t,credentials:n,region:s,service:i,sha256:c,uriEscapePath:d});B(this,"headerFormatter",new uL)}async presign(t,n={}){const{signingDate:s=new Date,expiresIn:i=3600,unsignableHeaders:c,unhoistableHeaders:d,signableHeaders:m,hoistableHeaders:p,signingRegion:v,signingService:x}=n,b=await this.credentialProvider();this.validateResolvedCredentials(b);const S=v??await this.regionProvider(),{longDate:N,shortDate:E}=this.formatDate(s);if(i>aL)return Promise.reject("Signature version 4 presigned URLs must have an expiration date less than one week in the future");const T=yx(E,S,x??this.service),A=hL(IE(t),{unhoistableHeaders:d,hoistableHeaders:p});b.sessionToken&&(A.query[eN]=b.sessionToken),A.query[qD]=gx,A.query[KD]=`${b.accessKeyId}/${T}`,A.query[Q1]=N,A.query[JD]=i.toString(10);const R=TE(A,c,m);return A.query[YD]=this.getCanonicalHeaderList(R),A.query[Z1]=await this.getSignature(N,T,this.getSigningKey(b,S,E,x),this.createCanonicalRequest(A,R,await xx(t,this.sha256))),A}async sign(t,n){return typeof t=="string"?this.signString(t,n):t.headers&&t.payload?this.signEvent(t,n):t.message?this.signMessage(t,n):this.signRequest(t,n)}async signEvent({headers:t,payload:n},{signingDate:s=new Date,priorSignature:i,signingRegion:c,signingService:d}){const m=c??await this.regionProvider(),{shortDate:p,longDate:v}=this.formatDate(s),x=yx(p,m,d??this.service),b=await xx({headers:{},body:n},this.sha256),S=new this.sha256;S.update(t);const N=id(await S.digest()),E=[sL,v,x,i,N,b].join(`
`);return this.signString(E,{signingDate:s,signingRegion:m,signingService:d})}async signMessage(t,{signingDate:n=new Date,signingRegion:s,signingService:i}){return this.signEvent({headers:this.headerFormatter.format(t.message.headers),payload:t.message.body},{signingDate:n,signingRegion:s,signingService:i,priorSignature:t.priorSignature}).then(d=>({message:t.message,signature:d}))}async signString(t,{signingDate:n=new Date,signingRegion:s,signingService:i}={}){const c=await this.credentialProvider();this.validateResolvedCredentials(c);const d=s??await this.regionProvider(),{shortDate:m}=this.formatDate(n),p=new this.sha256(await this.getSigningKey(c,d,m,i));return p.update(Nm(t)),id(await p.digest())}async signRequest(t,{signingDate:n=new Date,signableHeaders:s,unsignableHeaders:i,signingRegion:c,signingService:d}={}){const m=await this.credentialProvider();this.validateResolvedCredentials(m);const p=c??await this.regionProvider(),v=IE(t),{longDate:x,shortDate:b}=this.formatDate(n),S=yx(b,p,d??this.service);v.headers[rN]=x,m.sessionToken&&(v.headers[eL]=m.sessionToken);const N=await xx(v,this.sha256);!fL(Sw,v.headers)&&this.applyChecksum&&(v.headers[Sw]=N);const E=TE(v,i,s),T=await this.getSignature(x,S,this.getSigningKey(m,p,b,d),this.createCanonicalRequest(v,E,N));return v.headers[tN]=`${gx} Credential=${m.accessKeyId}/${S}, SignedHeaders=${this.getCanonicalHeaderList(E)}, Signature=${T}`,v}async getSignature(t,n,s,i){const c=await this.createStringToSign(t,n,i,gx),d=new this.sha256(await s);return d.update(Nm(c)),id(await d.digest())}getSigningKey(t,n,s,i){return lL(this.sha256,t,s,n,i||this.service)}}const sN=r=>{let e=r.credentials,t=!!r.credentials,n;Object.defineProperty(r,"credentials",{set(p){p&&p!==e&&p!==n&&(t=!0),e=p;const v=yL(r,{credentials:e,credentialDefaultProvider:r.credentialDefaultProvider}),x=xL(r,v);if(t&&!x.attributed){const b=typeof e=="object"&&e!==null;n=async S=>{const E=await x(S);return b&&(!E.$source||Object.keys(E.$source).length===0)?BD(E,"CREDENTIALS_CODE","e"):E},n.memoized=x.memoized,n.configBound=x.configBound,n.attributed=!0}else n=x},get(){return n},enumerable:!0,configurable:!0}),r.credentials=e;const{signingEscapePath:s=!0,systemClockOffset:i=r.systemClockOffset||0,sha256:c}=r;let d;return r.signer?d=wm(r.signer):r.regionInfoProvider?d=()=>wm(r.region)().then(async p=>[await r.regionInfoProvider(p,{useFipsEndpoint:await r.useFipsEndpoint(),useDualstackEndpoint:await r.useDualstackEndpoint()})||{},p]).then(([p,v])=>{const{signingRegion:x,signingService:b}=p;r.signingRegion=r.signingRegion||x||v,r.signingName=r.signingName||b||r.serviceId;const S={...r,credentials:r.credentials,region:r.signingRegion,service:r.signingName,sha256:c,uriEscapePath:s},N=r.signerConstructor||PE;return new N(S)}):d=async p=>{p=Object.assign({},{name:"sigv4",signingName:r.signingName||r.defaultSigningName,signingRegion:await wm(r.region)(),properties:{}},p);const v=p.signingRegion,x=p.signingName;r.signingRegion=r.signingRegion||v,r.signingName=r.signingName||x||r.serviceId;const b={...r,credentials:r.credentials,region:r.signingRegion,service:r.signingName,sha256:c,uriEscapePath:s},S=r.signerConstructor||PE;return new S(b)},Object.assign(r,{systemClockOffset:i,signingEscapePath:s,signer:d})};function yL(r,{credentials:e,credentialDefaultProvider:t}){let n;return e?e!=null&&e.memoized?n=e:n=pD(e,hD,D1):t?n=wm(t(Object.assign({},r,{parentClientConfig:r}))):n=async()=>{throw new Error("@aws-sdk/core::resolveAwsSdkSigV4Config - `credentials` not provided and no credentialDefaultProvider was configured.")},n.memoized=!0,n}function xL(r,e){if(e.configBound)return e;const t=async n=>e({...n,callerClientConfig:r});return t.memoized=e.memoized,t.configBound=!0,t}const FE=typeof TextEncoder=="function"?new TextEncoder:null,oN=r=>{if(typeof r=="string"){if(FE)return FE.encode(r).byteLength;let e=r.length;for(let t=e-1;t>=0;t--){const n=r.charCodeAt(t);n>127&&n<=2047?e++:n>2047&&n<=65535&&(e+=2),n>=56320&&n<=57343&&t--}return e}else{if(typeof r.byteLength=="number")return r.byteLength;if(typeof r.size=="number")return r.size}throw new Error(`Body Length computation failed for ${r}`)},Xu=(r,e)=>{const t=[];if(r&&t.push(r),e)for(const n of e)t.push(n);return t},Oc=(r,e)=>`${r||"anonymous"}${e&&e.length>0?` (a.k.a. ${e.join(",")})`:""}`,oy=()=>{let r=[],e=[],t=!1;const n=new Set,s=x=>x.sort((b,S)=>jE[S.step]-jE[b.step]||OE[S.priority||"normal"]-OE[b.priority||"normal"]),i=x=>{let b=!1;const S=N=>{const E=Xu(N.name,N.aliases);if(E.includes(x)){b=!0;for(const T of E)n.delete(T);return!1}return!0};return r=r.filter(S),e=e.filter(S),b},c=x=>{let b=!1;const S=N=>{if(N.middleware===x){b=!0;for(const E of Xu(N.name,N.aliases))n.delete(E);return!1}return!0};return r=r.filter(S),e=e.filter(S),b},d=x=>{var b;return r.forEach(S=>{x.add(S.middleware,{...S})}),e.forEach(S=>{x.addRelativeTo(S.middleware,{...S})}),(b=x.identifyOnResolve)==null||b.call(x,v.identifyOnResolve()),x},m=x=>{const b=[];return x.before.forEach(S=>{S.before.length===0&&S.after.length===0?b.push(S):b.push(...m(S))}),b.push(x),x.after.reverse().forEach(S=>{S.before.length===0&&S.after.length===0?b.push(S):b.push(...m(S))}),b},p=(x=!1)=>{const b=[],S=[],N={};return r.forEach(T=>{const A={...T,before:[],after:[]};for(const R of Xu(A.name,A.aliases))N[R]=A;b.push(A)}),e.forEach(T=>{const A={...T,before:[],after:[]};for(const R of Xu(A.name,A.aliases))N[R]=A;S.push(A)}),S.forEach(T=>{if(T.toMiddleware){const A=N[T.toMiddleware];if(A===void 0){if(x)return;throw new Error(`${T.toMiddleware} is not found when adding ${Oc(T.name,T.aliases)} middleware ${T.relation} ${T.toMiddleware}`)}T.relation==="after"&&A.after.push(T),T.relation==="before"&&A.before.push(T)}}),s(b).map(m).reduce((T,A)=>(T.push(...A),T),[])},v={add:(x,b={})=>{const{name:S,override:N,aliases:E}=b,T={step:"initialize",priority:"normal",middleware:x,...b},A=Xu(S,E);if(A.length>0){if(A.some(R=>n.has(R))){if(!N)throw new Error(`Duplicate middleware name '${Oc(S,E)}'`);for(const R of A){const F=r.findIndex(L=>{var G;return L.name===R||((G=L.aliases)==null?void 0:G.some(z=>z===R))});if(F===-1)continue;const j=r[F];if(j.step!==T.step||T.priority!==j.priority)throw new Error(`"${Oc(j.name,j.aliases)}" middleware with ${j.priority} priority in ${j.step} step cannot be overridden by "${Oc(S,E)}" middleware with ${T.priority} priority in ${T.step} step.`);r.splice(F,1)}}for(const R of A)n.add(R)}r.push(T)},addRelativeTo:(x,b)=>{const{name:S,override:N,aliases:E}=b,T={middleware:x,...b},A=Xu(S,E);if(A.length>0){if(A.some(R=>n.has(R))){if(!N)throw new Error(`Duplicate middleware name '${Oc(S,E)}'`);for(const R of A){const F=e.findIndex(L=>{var G;return L.name===R||((G=L.aliases)==null?void 0:G.some(z=>z===R))});if(F===-1)continue;const j=e[F];if(j.toMiddleware!==T.toMiddleware||j.relation!==T.relation)throw new Error(`"${Oc(j.name,j.aliases)}" middleware ${j.relation} "${j.toMiddleware}" middleware cannot be overridden by "${Oc(S,E)}" middleware ${T.relation} "${T.toMiddleware}" middleware.`);e.splice(F,1)}}for(const R of A)n.add(R)}e.push(T)},clone:()=>d(oy()),use:x=>{x.applyToStack(v)},remove:x=>typeof x=="string"?i(x):c(x),removeByTag:x=>{let b=!1;const S=N=>{const{tags:E,name:T,aliases:A}=N;if(E&&E.includes(x)){const R=Xu(T,A);for(const F of R)n.delete(F);return b=!0,!1}return!0};return r=r.filter(S),e=e.filter(S),b},concat:x=>{var S;const b=d(oy());return b.use(x),b.identifyOnResolve(t||b.identifyOnResolve()||(((S=x.identifyOnResolve)==null?void 0:S.call(x))??!1)),b},applyToStack:d,identify:()=>p(!0).map(x=>{const b=x.step??x.relation+" "+x.toMiddleware;return Oc(x.name,x.aliases)+" - "+b}),identifyOnResolve(x){return typeof x=="boolean"&&(t=x),t},resolve:(x,b)=>{for(const S of p().map(N=>N.middleware).reverse())x=S(x,b);return t&&console.log(v.identify()),x}};return v},jE={initialize:5,serialize:4,build:3,finalizeRequest:2,deserialize:1},OE={high:3,normal:2,low:1};class iN{constructor(e){B(this,"config");B(this,"middlewareStack",oy());B(this,"initConfig");B(this,"handlers");this.config=e;const{protocol:t,protocolSettings:n}=e;n&&typeof t=="function"&&(e.protocol=new t(n))}send(e,t,n){const s=typeof t!="function"?t:void 0,i=typeof t=="function"?t:n,c=s===void 0&&this.config.cacheMiddleware===!0;let d;if(c){this.handlers||(this.handlers=new WeakMap);const m=this.handlers;m.has(e.constructor)?d=m.get(e.constructor):(d=e.resolveMiddleware(this.middlewareStack,this.config,s),m.set(e.constructor,d))}else delete this.handlers,d=e.resolveMiddleware(this.middlewareStack,this.config,s);if(i)d(e).then(m=>i(null,m.output),m=>i(m)).catch(()=>{});else return d(e).then(m=>m.output)}destroy(){var e,t,n;(n=(t=(e=this.config)==null?void 0:e.requestHandler)==null?void 0:t.destroy)==null||n.call(t),delete this.handlers}}const wx="***SensitiveInformation***";function Ew(r,e){if(e==null)return e;const t=Lo.of(r);if(t.getMergedTraits().sensitive)return wx;if(t.isListSchema()){if(!!t.getValueSchema().getMergedTraits().sensitive)return wx}else if(t.isMapSchema()){if(!!t.getKeySchema().getMergedTraits().sensitive||!!t.getValueSchema().getMergedTraits().sensitive)return wx}else if(t.isStructSchema()&&typeof e=="object"){const n=e,s={};for(const[i,c]of t.structIterator())n[i]!=null&&(s[i]=Ew(c,n[i]));return s}return e}class aN{constructor(){B(this,"middlewareStack",oy());B(this,"schema")}static classBuilder(){return new wL}resolveMiddlewareWithContext(e,t,n,{middlewareFn:s,clientName:i,commandName:c,inputFilterSensitiveLog:d,outputFilterSensitiveLog:m,smithyContext:p,additionalContext:v,CommandCtor:x}){for(const T of s.bind(this)(x,e,t,n))this.middlewareStack.use(T);const b=e.concat(this.middlewareStack),{logger:S}=t,N={logger:S,clientName:i,commandName:c,inputFilterSensitiveLog:d,outputFilterSensitiveLog:m,[yw]:{commandInstance:this,...p},...v},{requestHandler:E}=t;return b.resolve(T=>E.handle(T.request,n||{}),N)}}class wL{constructor(){B(this,"_init",()=>{});B(this,"_ep",{});B(this,"_middlewareFn",()=>[]);B(this,"_commandName","");B(this,"_clientName","");B(this,"_additionalContext",{});B(this,"_smithyContext",{});B(this,"_inputFilterSensitiveLog");B(this,"_outputFilterSensitiveLog");B(this,"_serializer",null);B(this,"_deserializer",null);B(this,"_operationSchema")}init(e){this._init=e}ep(e){return this._ep=e,this}m(e){return this._middlewareFn=e,this}s(e,t,n={}){return this._smithyContext={service:e,operation:t,...n},this}c(e={}){return this._additionalContext=e,this}n(e,t){return this._clientName=e,this._commandName=t,this}f(e=n=>n,t=n=>n){return this._inputFilterSensitiveLog=e,this._outputFilterSensitiveLog=t,this}ser(e){return this._serializer=e,this}de(e){return this._deserializer=e,this}sc(e){return this._operationSchema=e,this._smithyContext.operationSchema=e,this}build(){const e=this;let t;return t=class extends aN{constructor(...[s]){super();B(this,"input");B(this,"serialize",e._serializer);B(this,"deserialize",e._deserializer);this.input=s??{},e._init(this),this.schema=e._operationSchema}static getEndpointParameterInstructions(){return e._ep}resolveMiddleware(s,i,c){const d=e._operationSchema,m=(d==null?void 0:d[4])??(d==null?void 0:d.input),p=(d==null?void 0:d[5])??(d==null?void 0:d.output);return this.resolveMiddlewareWithContext(s,i,c,{CommandCtor:t,middlewareFn:e._middlewareFn,clientName:e._clientName,commandName:e._commandName,inputFilterSensitiveLog:e._inputFilterSensitiveLog??(d?Ew.bind(null,m):v=>v),outputFilterSensitiveLog:e._outputFilterSensitiveLog??(d?Ew.bind(null,p):v=>v),smithyContext:e._smithyContext,additionalContext:e._additionalContext})}}}}class Kf extends Error{constructor(t){super(t.message);B(this,"$fault");B(this,"$response");B(this,"$retryable");B(this,"$metadata");Object.setPrototypeOf(this,Object.getPrototypeOf(this).constructor.prototype),this.name=t.name,this.$fault=t.$fault,this.$metadata=t.$metadata}static isInstance(t){if(!t)return!1;const n=t;return Kf.prototype.isPrototypeOf(n)||!!n.$fault&&!!n.$metadata&&(n.$fault==="client"||n.$fault==="server")}static[Symbol.hasInstance](t){if(!t)return!1;const n=t;return this===Kf?Kf.isInstance(t):Kf.isInstance(t)?n.name&&this.name?this.prototype.isPrototypeOf(t)||n.name===this.name:this.prototype.isPrototypeOf(t):!1}}const DE=(r,e={})=>{Object.entries(e).filter(([,n])=>n!==void 0).forEach(([n,s])=>{(r[n]==null||r[n]==="")&&(r[n]=s)});const t=r.message||r.Message||"UnknownError";return r.message=t,delete r.Message,r},lN=r=>{switch(r){case"standard":return{retryMode:"standard",connectionTimeout:3100};case"in-region":return{retryMode:"standard",connectionTimeout:1100};case"cross-region":return{retryMode:"standard",connectionTimeout:3100};case"mobile":return{retryMode:"standard",connectionTimeout:3e4};default:return{}}},bL=r=>{const e=[];for(const t in ny){const n=ny[t];r[n]!==void 0&&e.push({algorithmId:()=>n,checksumConstructor:()=>r[n]})}return{addChecksumAlgorithm(t){e.push(t)},checksumAlgorithms(){return e}}},_L=r=>{const e={};return r.checksumAlgorithms().forEach(t=>{e[t.algorithmId()]=t.checksumConstructor()}),e},SL=r=>({setRetryStrategy(e){r.retryStrategy=e},retryStrategy(){return r.retryStrategy}}),EL=r=>{const e={};return e.retryStrategy=r.retryStrategy(),e},cN=r=>Object.assign(bL(r),SL(r)),uN=r=>Object.assign(_L(r),EL(r));class Ab{trace(){}debug(){}info(){}warn(){}error(){}}class CL{constructor(e=!1){B(this,"queryCompat");this.queryCompat=e}resolveRestContentType(e,t){const n=t.getMemberSchemas(),s=Object.values(n).find(i=>!!i.getMergedTraits().httpPayload);if(s){const i=s.getMergedTraits().mediaType;return i||(s.isStringSchema()?"text/plain":s.isBlobSchema()?"application/octet-stream":e)}else if(!t.isUnitSchema()&&Object.values(n).find(c=>{const{httpQuery:d,httpQueryParams:m,httpHeader:p,httpLabel:v,httpPrefixHeaders:x}=c.getMergedTraits();return!d&&!m&&!p&&!v&&x===void 0}))return e}async getErrorSchemaOrThrowBaseException(e,t,n,s,i,c){let d=t,m=e;e.includes("#")&&([d,m]=e.split("#"));const p={$metadata:i,$fault:n.statusCode<500?"client":"server"},v=xt.for(d);try{return{errorSchema:(c==null?void 0:c(v,m))??v.getSchema(e),errorMetadata:p}}catch{s.message=s.message??s.Message??"UnknownError";const b=xt.for("smithy.ts.sdk.synthetic."+d),S=b.getBaseException();if(S){const N=b.getErrorCtor(S)??Error;throw this.decorateServiceException(Object.assign(new N({name:m}),p),s)}throw this.decorateServiceException(Object.assign(new Error(m),p),s)}}decorateServiceException(e,t={}){if(this.queryCompat){const n=e.Message??t.Message,s=DE(e,t);n&&(s.message=n),s.Error={...s.Error,Type:s.Error.Type,Code:s.Error.Code,Message:s.Error.message??s.Error.Message??n};const i=s.$metadata.requestId;return i&&(s.RequestId=i),s}return DE(e,t)}setQueryCompatError(e,t){var s;const n=(s=t.headers)==null?void 0:s["x-amzn-query-error"];if(e!==void 0&&n!=null){const[i,c]=n.split(";"),d=Object.entries(e),m={Code:i,Type:c};Object.assign(e,m);for(const[p,v]of d)m[p==="message"?"Message":p]=v;delete m.__type,e.Error=m}}queryCompatOutput(e,t){e.Error&&(t.Error=e.Error),e.Type&&(t.Type=e.Type),e.Code&&(t.Code=e.Code)}findQueryCompatibleError(e,t){try{return e.getSchema(t)}catch{return e.find(s=>{var i;return((i=Lo.of(s).getMergedTraits().awsQueryError)==null?void 0:i[0])===t})}}}class Rb{constructor(){B(this,"serdeContext")}setSerdeContext(e){this.serdeContext=e}}class kL{constructor(e,t){B(this,"from");B(this,"to");B(this,"keys");this.from=e,this.to=t,this.keys=new Set(Object.keys(this.from).filter(n=>n!=="__type"))}mark(e){this.keys.delete(e)}hasUnknown(){return this.keys.size===1&&Object.keys(this.to).length===0}writeUnknown(){if(this.hasUnknown()){const e=this.keys.values().next().value,t=this.from[e];this.to.$unknown=[e,t]}}}function NL(r,e,t){if(t!=null&&t.source){const n=t.source;if(typeof e=="number"&&(e>Number.MAX_SAFE_INTEGER||e<Number.MIN_SAFE_INTEGER||n!==String(e)))return n.includes(".")?new qa(n,"bigDecimal"):BigInt(n)}return e}const TL=(r,e)=>ww(r,e).then(t=>((e==null?void 0:e.utf8Encoder)??Ly)(t)),AL=(r,e)=>TL(r,e).then(t=>{if(t.length)try{return JSON.parse(t)}catch(n){throw(n==null?void 0:n.name)==="SyntaxError"&&Object.defineProperty(n,"$responseBodyText",{value:t}),n}return{}}),RL=(r,e)=>{const t=(i,c)=>Object.keys(i).find(d=>d.toLowerCase()===c.toLowerCase()),n=i=>{let c=i;return typeof c=="number"&&(c=c.toString()),c.indexOf(",")>=0&&(c=c.split(",")[0]),c.indexOf(":")>=0&&(c=c.split(":")[0]),c.indexOf("#")>=0&&(c=c.split("#")[1]),c},s=t(r.headers,"x-amzn-errortype");if(s!==void 0)return n(r.headers[s]);if(e&&typeof e=="object"){const i=t(e,"code");if(i&&e[i]!==void 0)return n(e[i]);if(e.__type!==void 0)return n(e.__type)}};class IL extends Rb{constructor(t){super();B(this,"settings");this.settings=t}async read(t,n){return this._read(t,typeof n=="string"?JSON.parse(n,NL):await AL(n,this.serdeContext))}readObject(t,n){return this._read(t,n)}_read(t,n){const s=n!==null&&typeof n=="object",i=Lo.of(t);if(s){if(i.isStructSchema()){const d=n,m=i.isUnionSchema(),p={};let v;const{jsonName:x}=this.settings;x&&(v={});let b;m&&(b=new kL(d,p));for(const[S,N]of i.structIterator()){let E=S;x&&(E=N.getMergedTraits().jsonName??E,v[E]=S),m&&b.mark(E),d[E]!=null&&(p[S]=this._read(N,d[E]))}if(m)b.writeUnknown();else if(typeof d.__type=="string")for(const[S,N]of Object.entries(d)){const E=x?v[S]??S:S;E in p||(p[E]=N)}return p}if(Array.isArray(n)&&i.isListSchema()){const d=i.getValueSchema(),m=[],p=!!i.getMergedTraits().sparse;for(const v of n)(p||v!=null)&&m.push(this._read(d,v));return m}if(i.isMapSchema()){const d=i.getValueSchema(),m={},p=!!i.getMergedTraits().sparse;for(const[v,x]of Object.entries(n))(p||x!=null)&&(m[v]=this._read(d,x));return m}}if(i.isBlobSchema()&&typeof n=="string")return qm(n);const c=i.getMergedTraits().mediaType;if(i.isStringSchema()&&typeof n=="string"&&c)return c==="application/json"||c.endsWith("+json")?Bc.from(n):n;if(i.isTimestampSchema()&&n!=null)switch(F1(i,this.settings)){case 5:return W2(n);case 6:return Y2(n);case 7:return J2(n);default:return console.warn("Missing timestamp format, parsing value with Date constructor:",n),new Date(n)}if(i.isBigIntegerSchema()&&(typeof n=="number"||typeof n=="string"))return BigInt(n);if(i.isBigDecimalSchema()&&n!=null){if(n instanceof qa)return n;const d=n;return d.type==="bigDecimal"&&"string"in d?new qa(d.string,d.type):new qa(String(n),"bigDecimal")}if(i.isNumericSchema()&&typeof n=="string"){switch(n){case"Infinity":return 1/0;case"-Infinity":return-1/0;case"NaN":return NaN}return n}if(i.isDocumentSchema())if(s){const d=Array.isArray(n)?[]:{};for(const[m,p]of Object.entries(n))p instanceof qa?d[m]=p:d[m]=this._read(i,p);return d}else return structuredClone(n);return n}}const LE="";class PL{constructor(){B(this,"values",new Map);B(this,"counter",0);B(this,"stage",0)}createReplacer(){if(this.stage===1)throw new Error("@aws-sdk/core/protocols - JsonReplacer already created.");if(this.stage===2)throw new Error("@aws-sdk/core/protocols - JsonReplacer exhausted.");return this.stage=1,(e,t)=>{if(t instanceof qa){const n=`${LE+"nv"+this.counter++}_`+t.string;return this.values.set(`"${n}"`,t.string),n}if(typeof t=="bigint"){const n=t.toString(),s=`${LE+"b"+this.counter++}_`+n;return this.values.set(`"${s}"`,n),s}return t}}replaceInJson(e){if(this.stage===0)throw new Error("@aws-sdk/core/protocols - JsonReplacer not created yet.");if(this.stage===2)throw new Error("@aws-sdk/core/protocols - JsonReplacer exhausted.");if(this.stage=2,this.counter===0)return e;for(const[t,n]of this.values)e=e.replace(t,n);return e}}class FL extends Rb{constructor(t){super();B(this,"settings");B(this,"buffer");B(this,"useReplacer",!1);B(this,"rootSchema");this.settings=t}write(t,n){this.rootSchema=Lo.of(t),this.buffer=this._write(this.rootSchema,n)}writeDiscriminatedDocument(t,n){this.write(t,n),typeof this.buffer=="object"&&(this.buffer.__type=Lo.of(t).getName(!0))}flush(){const{rootSchema:t,useReplacer:n}=this;if(this.rootSchema=void 0,this.useReplacer=!1,t!=null&&t.isStructSchema()||t!=null&&t.isDocumentSchema()){if(!n)return JSON.stringify(this.buffer);const s=new PL;return s.replaceInJson(JSON.stringify(this.buffer,s.createReplacer(),0))}return this.buffer}_write(t,n,s){var d,m;const i=n!==null&&typeof n=="object",c=Lo.of(t);if(i){if(c.isStructSchema()){const p=n,v={},{jsonName:x}=this.settings;let b;x&&(b={});for(const[S,N]of c.structIterator()){const E=this._write(N,p[S],c);if(E!==void 0){let T=S;x&&(T=N.getMergedTraits().jsonName??S,b[S]=T),v[T]=E}}if(c.isUnionSchema()&&Object.keys(v).length===0){const{$unknown:S}=p;if(Array.isArray(S)){const[N,E]=S;v[N]=this._write(15,E)}}else if(typeof p.__type=="string")for(const[S,N]of Object.entries(p)){const E=x?b[S]??S:S;E in v||(v[E]=this._write(15,N))}return v}if(Array.isArray(n)&&c.isListSchema()){const p=c.getValueSchema(),v=[],x=!!c.getMergedTraits().sparse;for(const b of n)(x||b!=null)&&v.push(this._write(p,b));return v}if(c.isMapSchema()){const p=c.getValueSchema(),v={},x=!!c.getMergedTraits().sparse;for(const[b,S]of Object.entries(n))(x||S!=null)&&(v[b]=this._write(p,S));return v}if(n instanceof Uint8Array&&(c.isBlobSchema()||c.isDocumentSchema()))return c===this.rootSchema?n:(((d=this.serdeContext)==null?void 0:d.base64Encoder)??Tm)(n);if(n instanceof Date&&(c.isTimestampSchema()||c.isDocumentSchema()))switch(F1(c,this.settings)){case 5:return n.toISOString().replace(".000Z","Z");case 6:return B2(n);case 7:return n.getTime()/1e3;default:return console.warn("Missing timestamp format, using epoch seconds",n),n.getTime()/1e3}n instanceof qa&&(this.useReplacer=!0)}if(!(n===null&&(s!=null&&s.isStructSchema()))){if(c.isStringSchema()){if(typeof n>"u"&&c.isIdempotencyToken())return P1();const p=c.getMergedTraits().mediaType;return n!=null&&p&&(p==="application/json"||p.endsWith("+json"))?Bc.from(n):n}if(typeof n=="number"&&c.isNumericSchema())return Math.abs(n)===1/0||isNaN(n)?String(n):n;if(typeof n=="string"&&c.isBlobSchema())return c===this.rootSchema?n:(((m=this.serdeContext)==null?void 0:m.base64Encoder)??Tm)(n);if(typeof n=="bigint"&&(this.useReplacer=!0),c.isDocumentSchema())if(i){const p=Array.isArray(n)?[]:{};for(const[v,x]of Object.entries(n))x instanceof qa?(this.useReplacer=!0,p[v]=x):p[v]=this._write(c,x);return p}else return structuredClone(n);return n}}}class jL extends Rb{constructor(t){super();B(this,"settings");this.settings=t}createSerializer(){const t=new FL(this.settings);return t.setSerdeContext(this.serdeContext),t}createDeserializer(){const t=new IL(this.settings);return t.setSerdeContext(this.serdeContext),t}}class OL extends cD{constructor({defaultNamespace:t,serviceTarget:n,awsQueryCompatible:s,jsonCodec:i}){super({defaultNamespace:t});B(this,"serializer");B(this,"deserializer");B(this,"serviceTarget");B(this,"codec");B(this,"mixin");B(this,"awsQueryCompatible");this.serviceTarget=n,this.codec=i??new jL({timestampFormat:{useTrait:!0,default:7},jsonName:!1}),this.serializer=this.codec.createSerializer(),this.deserializer=this.codec.createDeserializer(),this.awsQueryCompatible=!!s,this.mixin=new CL(this.awsQueryCompatible)}async serializeRequest(t,n,s){const i=await super.serializeRequest(t,n,s);return i.path.endsWith("/")||(i.path+="/"),Object.assign(i.headers,{"content-type":`application/x-amz-json-${this.getJsonRpcVersion()}`,"x-amz-target":`${this.serviceTarget}.${t.name}`}),this.awsQueryCompatible&&(i.headers["x-amzn-query-mode"]="true"),(zv(t.input)==="unit"||!i.body)&&(i.body="{}"),i}getPayloadCodec(){return this.codec}async handleError(t,n,s,i,c){this.awsQueryCompatible&&this.mixin.setQueryCompatError(i,s);const d=RL(s,i)??"Unknown",{errorSchema:m,errorMetadata:p}=await this.mixin.getErrorSchemaOrThrowBaseException(d,this.options.defaultNamespace,s,i,c,this.awsQueryCompatible?this.mixin.findQueryCompatibleError:void 0),v=Lo.of(m),x=i.message??i.Message??"Unknown",b=xt.for(m[1]).getErrorCtor(m)??Error,S=new b(x),N={};for(const[E,T]of v.structIterator())i[E]!=null&&(N[E]=this.codec.createDeserializer().readObject(T,i[E]));throw this.awsQueryCompatible&&this.mixin.queryCompatOutput(i,N),this.mixin.decorateServiceException(Object.assign(S,p,{$fault:v.getMergedTraits().error,message:x},N),i)}}class dN extends OL{constructor({defaultNamespace:e,serviceTarget:t,awsQueryCompatible:n,jsonCodec:s}){super({defaultNamespace:e,serviceTarget:t,awsQueryCompatible:n,jsonCodec:s})}getShapeId(){return"aws.protocols#awsJson1_1"}getJsonRpcVersion(){return"1.1"}getDefaultContentType(){return"application/x-amz-json-1.1"}}const DL=/\d{12}\.ddb/;async function LL(r,e,t){var i,c,d,m,p,v,x;const n=t.request;if(((i=n==null?void 0:n.headers)==null?void 0:i["smithy-protocol"])==="rpc-v2-cbor"&&Ma(r,"PROTOCOL_RPC_V2_CBOR","M"),typeof e.retryStrategy=="function"){const b=await e.retryStrategy();typeof b.acquireInitialRetryToken=="function"?(d=(c=b.constructor)==null?void 0:c.name)!=null&&d.includes("Adaptive")?Ma(r,"RETRY_MODE_ADAPTIVE","F"):Ma(r,"RETRY_MODE_STANDARD","E"):Ma(r,"RETRY_MODE_LEGACY","D")}if(typeof e.accountIdEndpointMode=="function"){const b=r.endpointV2;switch(String((m=b==null?void 0:b.url)==null?void 0:m.hostname).match(DL)&&Ma(r,"ACCOUNT_ID_ENDPOINT","O"),await((p=e.accountIdEndpointMode)==null?void 0:p.call(e))){case"disabled":Ma(r,"ACCOUNT_ID_MODE_DISABLED","Q");break;case"preferred":Ma(r,"ACCOUNT_ID_MODE_PREFERRED","P");break;case"required":Ma(r,"ACCOUNT_ID_MODE_REQUIRED","R");break}}const s=(x=(v=r.__smithy_context)==null?void 0:v.selectedHttpAuthScheme)==null?void 0:x.identity;if(s!=null&&s.$source){const b=s;b.accountId&&Ma(r,"RESOLVED_ACCOUNT_ID","T");for(const[S,N]of Object.entries(b.$source??{}))Ma(r,S,N)}}const ME="user-agent",bx="x-amz-user-agent",$E=" ",_x="/",ML=/[^!$%&'*+\-.^_`|~\w]/g,$L=/[^!$%&'*+\-.^_`|~\w#]/g,UE="-",UL=1024;function zL(r){let e="";for(const t in r){const n=r[t];if(e.length+n.length+1<=UL){e.length?e+=","+n:e+=n;continue}break}return e}const HL=r=>(e,t)=>async n=>{var S,N,E,T;const{request:s}=n;if(!ii.isInstance(s))return e(n);const{headers:i}=s,c=((S=t==null?void 0:t.userAgent)==null?void 0:S.map(_v))||[],d=(await r.defaultUserAgentProvider()).map(_v);await LL(t,r,n);const m=t;d.push(`m/${zL(Object.assign({},(N=t.__smithy_context)==null?void 0:N.features,(E=m.__aws_sdk_context)==null?void 0:E.features))}`);const p=((T=r==null?void 0:r.customUserAgent)==null?void 0:T.map(_v))||[],v=await r.userAgentAppId();v&&d.push(_v(["app",`${v}`]));const x=[].concat([...d,...c,...p]).join($E),b=[...d.filter(A=>A.startsWith("aws-sdk-")),...p].join($E);return r.runtime!=="browser"?(b&&(i[bx]=i[bx]?`${i[ME]} ${b}`:b),i[ME]=x):i[bx]=x,e({...n,request:s})},_v=r=>{var c;const e=r[0].split(_x).map(d=>d.replace(ML,UE)).join(_x),t=(c=r[1])==null?void 0:c.replace($L,UE),n=e.indexOf(_x),s=e.substring(0,n);let i=e.substring(n+1);return s==="api"&&(i=i.toLowerCase()),[s,i,t].filter(d=>d&&d.length>0).reduce((d,m,p)=>{switch(p){case 0:return m;case 1:return`${d}/${m}`;default:return`${d}#${m}`}},"")},BL={name:"getUserAgentMiddleware",step:"build",priority:"low",tags:["SET_USER_AGENT","USER_AGENT"],override:!0},fN=r=>({applyToStack:e=>{e.add(HL(r),BL)}}),hN=!1,pN=!1,zE=new Set,GL=(r,e=Km)=>{if(!zE.has(r)&&!e(r))if(r==="*")console.warn('@smithy/config-resolver WARN - Please use the caller region instead of "*". See "sigv4a" in https://github.com/aws/aws-sdk-js-v3/blob/main/supplemental-docs/CLIENTS.md.');else throw new Error(`Region not accepted: region="${r}" is not a valid hostname component.`);else zE.add(r)},mN=r=>typeof r=="string"&&(r.startsWith("fips-")||r.endsWith("-fips")),WL=r=>mN(r)?["fips-aws-global","aws-fips"].includes(r)?"us-east-1":r.replace(/fips-(dkr-|prod-)?|-fips/,""):r,gN=r=>{const{region:e,useFipsEndpoint:t}=r;if(!e)throw new Error("Region is missing");return Object.assign(r,{region:async()=>{const n=typeof e=="function"?await e():e,s=WL(n);return GL(s),s},useFipsEndpoint:async()=>{const n=typeof e=="string"?e:await e();return mN(n)?!0:typeof t!="function"?Promise.resolve(!!t):t()}})},HE="content-length";function VL(r){return e=>async t=>{const n=t.request;if(ii.isInstance(n)){const{body:s,headers:i}=n;if(s&&Object.keys(i).map(c=>c.toLowerCase()).indexOf(HE)===-1)try{const c=r(s);n.headers={...n.headers,[HE]:String(c)}}catch{}}return e({...t,request:n})}}const qL={step:"build",tags:["SET_CONTENT_LENGTH","CONTENT_LENGTH"],name:"contentLengthMiddleware",override:!0},vN=r=>({applyToStack:e=>{e.add(VL(r.bodyLengthChecker),qL)}}),KL=async r=>{const e=(r==null?void 0:r.Bucket)||"";if(typeof r.Bucket=="string"&&(r.Bucket=e.replace(/#/g,encodeURIComponent("#")).replace(/\?/g,encodeURIComponent("?"))),ZL(e)){if(r.ForcePathStyle===!0)throw new Error("Path-style addressing cannot be used with ARN buckets")}else(!QL(e)||e.indexOf(".")!==-1&&!String(r.Endpoint).startsWith("http:")||e.toLowerCase()!==e||e.length<3)&&(r.ForcePathStyle=!0);return r.DisableMultiRegionAccessPoints&&(r.disableMultiRegionAccessPoints=!0,r.DisableMRAP=!0),r},YL=/^[a-z0-9][a-z0-9\.\-]{1,61}[a-z0-9]$/,JL=/(\d+\.){3}\d+/,XL=/\.\./,QL=r=>YL.test(r)&&!JL.test(r)&&!XL.test(r),ZL=r=>{const[e,t,n,,,s]=r.split(":"),i=e==="arn"&&r.split(":").length>=6,c=!!(i&&t&&n&&s);if(i&&!c)throw new Error(`Invalid ARN: ${r} was an invalid ARN.`);return c},eM=(r,e,t,n=!1)=>{const s=async()=>{let i;if(n){const c=t.clientContextParams;i=(c==null?void 0:c[r])??t[r]??t[e]}else i=t[r]??t[e];return typeof i=="function"?i():i};return r==="credentialScope"||e==="CredentialScope"?async()=>{const i=typeof t.credentials=="function"?await t.credentials():t.credentials;return(i==null?void 0:i.credentialScope)??(i==null?void 0:i.CredentialScope)}:r==="accountId"||e==="AccountId"?async()=>{const i=typeof t.credentials=="function"?await t.credentials():t.credentials;return(i==null?void 0:i.accountId)??(i==null?void 0:i.AccountId)}:r==="endpoint"||e==="endpoint"?async()=>{if(t.isCustomEndpoint===!1)return;const i=await s();if(i&&typeof i=="object"){if("url"in i)return i.url.href;if("hostname"in i){const{protocol:c,hostname:d,port:m,path:p}=i;return`${c}//${d}${m?":"+m:""}${p}`}}return i}:s},yN=async r=>{},xN=r=>typeof r=="object"?"url"in r?Im(r.url):r:Im(r),tM=async(r,e,t,n)=>{if(!t.isCustomEndpoint){let c;t.serviceConfiguredEndpoint?c=await t.serviceConfiguredEndpoint():c=await yN(t.serviceId),c&&(t.endpoint=()=>Promise.resolve(xN(c)),t.isCustomEndpoint=!0)}const s=await rM(r,e,t);if(typeof t.endpointProvider!="function")throw new Error("config.endpointProvider is not set.");return t.endpointProvider(s,n)},rM=async(r,e,t)=>{var i;const n={},s=((i=e==null?void 0:e.getEndpointParameterInstructions)==null?void 0:i.call(e))||{};for(const[c,d]of Object.entries(s))switch(d.type){case"staticContextParams":n[c]=d.value;break;case"contextParams":n[c]=r[d.name];break;case"clientContextParams":case"builtInParams":n[c]=await eM(d.name,c,t,d.type!=="builtInParams")();break;case"operationContextParams":n[c]=d.get(r);break;default:throw new Error("Unrecognized endpoint parameter instruction: "+JSON.stringify(d))}return Object.keys(s).length===0&&Object.assign(n,t),String(t.serviceId).toLowerCase()==="s3"&&await KL(n),n},nM=({config:r,instructions:e})=>(t,n)=>async s=>{var d,m,p;r.isCustomEndpoint&&uD(n,"ENDPOINT_OVERRIDE","N");const i=await tM(s.input,{getEndpointParameterInstructions(){return e}},{...r},n);n.endpointV2=i,n.authSchemes=(d=i.properties)==null?void 0:d.authSchemes;const c=(m=n.authSchemes)==null?void 0:m[0];if(c){n.signing_region=c.signingRegion,n.signing_service=c.signingName;const v=pd(n),x=(p=v==null?void 0:v.selectedHttpAuthScheme)==null?void 0:p.httpAuthOption;x&&(x.signingProperties=Object.assign(x.signingProperties||{},{signing_region:c.signingRegion,signingRegion:c.signingRegion,signing_service:c.signingName,signingName:c.signingName,signingRegionSet:c.signingRegionSet},c.properties))}return t({...s})},sM={step:"serialize",tags:["ENDPOINT_PARAMETERS","ENDPOINT_V2","ENDPOINT"],name:"endpointV2Middleware",override:!0,relation:"before",toMiddleware:p2.name},oM=(r,e)=>({applyToStack:t=>{t.addRelativeTo(nM({config:r,instructions:e}),sM)}}),wN=r=>{const e=r.tls??!0,{endpoint:t,useDualstackEndpoint:n,useFipsEndpoint:s}=r,i=t!=null?async()=>xN(await oa(t)()):void 0,d=Object.assign(r,{endpoint:i,tls:e,isCustomEndpoint:!!t,useDualstackEndpoint:oa(n??!1),useFipsEndpoint:oa(s??!1)});let m;return d.serviceConfiguredEndpoint=async()=>(r.serviceId&&!m&&(m=yN(r.serviceId)),m),d};var uh;(function(r){r.STANDARD="standard",r.ADAPTIVE="adaptive"})(uh||(uh={}));const Pm=3,bN=uh.STANDARD,iM=["BandwidthLimitExceeded","EC2ThrottledException","LimitExceededException","PriorRequestNotComplete","ProvisionedThroughputExceededException","RequestLimitExceeded","RequestThrottled","RequestThrottledException","SlowDown","ThrottledException","Throttling","ThrottlingException","TooManyRequestsException","TransactionInProgressException"],aM=["TimeoutError","RequestTimeout","RequestTimeoutException"],lM=[500,502,503,504],cM=["ECONNRESET","ECONNREFUSED","EPIPE","ETIMEDOUT"],uM=["EHOSTUNREACH","ENETUNREACH","ENOTFOUND"],dM=r=>(r==null?void 0:r.$retryable)!==void 0,fM=r=>{var e;return(e=r.$metadata)==null?void 0:e.clockSkewCorrected},hM=r=>{const e=new Set(["Failed to fetch","NetworkError when attempting to fetch resource","The Internet connection appears to be offline","Load failed","Network request failed"]);return r&&r instanceof TypeError?e.has(r.message):!1},_N=r=>{var e,t;return((e=r.$metadata)==null?void 0:e.httpStatusCode)===429||iM.includes(r.name)||((t=r.$retryable)==null?void 0:t.throttling)==!0},Ib=(r,e=0)=>{var t;return dM(r)||fM(r)||aM.includes(r.name)||cM.includes((r==null?void 0:r.code)||"")||uM.includes((r==null?void 0:r.code)||"")||lM.includes(((t=r.$metadata)==null?void 0:t.httpStatusCode)||0)||hM(r)||r.cause!==void 0&&e<=10&&Ib(r.cause,e+1)},pM=r=>{var e;if(((e=r.$metadata)==null?void 0:e.httpStatusCode)!==void 0){const t=r.$metadata.httpStatusCode;return 500<=t&&t<=599&&!Ib(r)}return!1},Dy=class Dy{constructor(e){B(this,"beta");B(this,"minCapacity");B(this,"minFillRate");B(this,"scaleConstant");B(this,"smooth");B(this,"currentCapacity",0);B(this,"enabled",!1);B(this,"lastMaxRate",0);B(this,"measuredTxRate",0);B(this,"requestCount",0);B(this,"fillRate");B(this,"lastThrottleTime");B(this,"lastTimestamp",0);B(this,"lastTxRateBucket");B(this,"maxCapacity");B(this,"timeWindow",0);this.beta=(e==null?void 0:e.beta)??.7,this.minCapacity=(e==null?void 0:e.minCapacity)??1,this.minFillRate=(e==null?void 0:e.minFillRate)??.5,this.scaleConstant=(e==null?void 0:e.scaleConstant)??.4,this.smooth=(e==null?void 0:e.smooth)??.8;const t=this.getCurrentTimeInSeconds();this.lastThrottleTime=t,this.lastTxRateBucket=Math.floor(this.getCurrentTimeInSeconds()),this.fillRate=this.minFillRate,this.maxCapacity=this.minCapacity}getCurrentTimeInSeconds(){return Date.now()/1e3}async getSendToken(){return this.acquireTokenBucket(1)}async acquireTokenBucket(e){if(this.enabled){if(this.refillTokenBucket(),e>this.currentCapacity){const t=(e-this.currentCapacity)/this.fillRate*1e3;await new Promise(n=>Dy.setTimeoutFn(n,t))}this.currentCapacity=this.currentCapacity-e}}refillTokenBucket(){const e=this.getCurrentTimeInSeconds();if(!this.lastTimestamp){this.lastTimestamp=e;return}const t=(e-this.lastTimestamp)*this.fillRate;this.currentCapacity=Math.min(this.maxCapacity,this.currentCapacity+t),this.lastTimestamp=e}updateClientSendingRate(e){let t;if(this.updateMeasuredRate(),_N(e)){const s=this.enabled?Math.min(this.measuredTxRate,this.fillRate):this.measuredTxRate;this.lastMaxRate=s,this.calculateTimeWindow(),this.lastThrottleTime=this.getCurrentTimeInSeconds(),t=this.cubicThrottle(s),this.enableTokenBucket()}else this.calculateTimeWindow(),t=this.cubicSuccess(this.getCurrentTimeInSeconds());const n=Math.min(t,2*this.measuredTxRate);this.updateTokenBucketRate(n)}calculateTimeWindow(){this.timeWindow=this.getPrecise(Math.pow(this.lastMaxRate*(1-this.beta)/this.scaleConstant,1/3))}cubicThrottle(e){return this.getPrecise(e*this.beta)}cubicSuccess(e){return this.getPrecise(this.scaleConstant*Math.pow(e-this.lastThrottleTime-this.timeWindow,3)+this.lastMaxRate)}enableTokenBucket(){this.enabled=!0}updateTokenBucketRate(e){this.refillTokenBucket(),this.fillRate=Math.max(e,this.minFillRate),this.maxCapacity=Math.max(e,this.minCapacity),this.currentCapacity=Math.min(this.currentCapacity,this.maxCapacity)}updateMeasuredRate(){const e=this.getCurrentTimeInSeconds(),t=Math.floor(e*2)/2;if(this.requestCount++,t>this.lastTxRateBucket){const n=this.requestCount/(t-this.lastTxRateBucket);this.measuredTxRate=this.getPrecise(n*this.smooth+this.measuredTxRate*(1-this.smooth)),this.requestCount=0,this.lastTxRateBucket=t}}getPrecise(e){return parseFloat(e.toFixed(8))}};B(Dy,"setTimeoutFn",setTimeout);let Cw=Dy;const kw=100,SN=20*1e3,mM=500,BE=500,gM=5,vM=10,yM=1,xM="amz-sdk-invocation-id",wM="amz-sdk-request",bM=()=>{let r=kw;return{computeNextBackoffDelay:n=>Math.floor(Math.min(SN,Math.random()*2**n*r)),setDelayBase:n=>{r=n}}},GE=({retryDelay:r,retryCount:e,retryCost:t})=>({getRetryCount:()=>e,getRetryDelay:()=>Math.min(SN,r),getRetryCost:()=>t});class EN{constructor(e){B(this,"maxAttempts");B(this,"mode",uh.STANDARD);B(this,"capacity",BE);B(this,"retryBackoffStrategy",bM());B(this,"maxAttemptsProvider");this.maxAttempts=e,this.maxAttemptsProvider=typeof e=="function"?e:async()=>e}async acquireInitialRetryToken(e){return GE({retryDelay:kw,retryCount:0})}async refreshRetryTokenForRetry(e,t){const n=await this.getMaxAttempts();if(this.shouldRetry(e,t,n)){const s=t.errorType;this.retryBackoffStrategy.setDelayBase(s==="THROTTLING"?mM:kw);const i=this.retryBackoffStrategy.computeNextBackoffDelay(e.getRetryCount()),c=t.retryAfterHint?Math.max(t.retryAfterHint.getTime()-Date.now()||0,i):i,d=this.getCapacityCost(s);return this.capacity-=d,GE({retryDelay:c,retryCount:e.getRetryCount()+1,retryCost:d})}throw new Error("No retry token available")}recordSuccess(e){this.capacity=Math.max(BE,this.capacity+(e.getRetryCost()??yM))}getCapacity(){return this.capacity}async getMaxAttempts(){try{return await this.maxAttemptsProvider()}catch{return console.warn(`Max attempts provider could not resolve. Using default of ${Pm}`),Pm}}shouldRetry(e,t,n){return e.getRetryCount()+1<n&&this.capacity>=this.getCapacityCost(t.errorType)&&this.isRetryableError(t.errorType)}getCapacityCost(e){return e==="TRANSIENT"?vM:gM}isRetryableError(e){return e==="THROTTLING"||e==="TRANSIENT"}}class _M{constructor(e,t){B(this,"maxAttemptsProvider");B(this,"rateLimiter");B(this,"standardRetryStrategy");B(this,"mode",uh.ADAPTIVE);this.maxAttemptsProvider=e;const{rateLimiter:n}=t??{};this.rateLimiter=n??new Cw,this.standardRetryStrategy=new EN(e)}async acquireInitialRetryToken(e){return await this.rateLimiter.getSendToken(),this.standardRetryStrategy.acquireInitialRetryToken(e)}async refreshRetryTokenForRetry(e,t){return this.rateLimiter.updateClientSendingRate(t),this.standardRetryStrategy.refreshRetryTokenForRetry(e,t)}recordSuccess(e){this.rateLimiter.updateClientSendingRate({}),this.standardRetryStrategy.recordSuccess(e)}}const SM=r=>r instanceof Error?r:r instanceof Object?Object.assign(new Error,r):typeof r=="string"?new Error(r):new Error(`AWS SDK error wrapper for ${r}`),CN=r=>{const{retryStrategy:e,retryMode:t,maxAttempts:n}=r,s=oa(n??Pm);return Object.assign(r,{maxAttempts:s,retryStrategy:async()=>e||(await oa(t)()===uh.ADAPTIVE?new _M(s):new EN(s))})},EM=r=>(r==null?void 0:r.body)instanceof ReadableStream,CM=r=>(e,t)=>async n=>{var c;let s=await r.retryStrategy();const i=await r.maxAttempts();if(kM(s)){s=s;let d=await s.acquireInitialRetryToken(t.partition_id),m=new Error,p=0,v=0;const{request:x}=n,b=ii.isInstance(x);for(b&&(x.headers[xM]=P1());;)try{b&&(x.headers[wM]=`attempt=${p+1}; max=${i}`);const{response:S,output:N}=await e(n);return s.recordSuccess(d),N.$metadata.attempts=p+1,N.$metadata.totalRetryDelay=v,{response:S,output:N}}catch(S){const N=NM(S);if(m=SM(S),b&&EM(x))throw(c=t.logger instanceof Ab?console:t.logger)==null||c.warn("An error was encountered in a non-retryable streaming request."),m;try{d=await s.refreshRetryTokenForRetry(d,N)}catch{throw m.$metadata||(m.$metadata={}),m.$metadata.attempts=p+1,m.$metadata.totalRetryDelay=v,m}p=d.getRetryCount();const E=d.getRetryDelay();v+=E,await new Promise(T=>setTimeout(T,E))}}else return s=s,s!=null&&s.mode&&(t.userAgent=[...t.userAgent||[],["cfg/retry-mode",s.mode]]),s.retry(e,n)},kM=r=>typeof r.acquireInitialRetryToken<"u"&&typeof r.refreshRetryTokenForRetry<"u"&&typeof r.recordSuccess<"u",NM=r=>{const e={error:r,errorType:TM(r)},t=RM(r.$response);return t&&(e.retryAfterHint=t),e},TM=r=>_N(r)?"THROTTLING":Ib(r)?"TRANSIENT":pM(r)?"SERVER_ERROR":"CLIENT_ERROR",AM={name:"retryMiddleware",tags:["RETRY"],step:"finalizeRequest",priority:"high",override:!0},kN=r=>({applyToStack:e=>{e.add(CM(r),AM)}}),RM=r=>{if(!lh.isInstance(r))return;const e=Object.keys(r.headers).find(i=>i.toLowerCase()==="retry-after");if(!e)return;const t=r.headers[e],n=Number(t);return Number.isNaN(n)?new Date(t):new Date(n*1e3)},IM=async(r,e,t)=>({operation:pd(e).operation,region:await oa(r.region)()||(()=>{throw new Error("expected `region` to be configured for `aws.auth#sigv4`")})()});function PM(r){return{schemeId:"aws.auth#sigv4",signingProperties:{name:"cognito-idp",region:r.region},propertiesExtractor:(e,t)=>({signingProperties:{config:e,context:t}})}}function Ar(r){return{schemeId:"smithy.api#noAuth"}}const FM=r=>{const e=[];switch(r.operation){case"AssociateSoftwareToken":{e.push(Ar());break}case"ChangePassword":{e.push(Ar());break}case"CompleteWebAuthnRegistration":{e.push(Ar());break}case"ConfirmDevice":{e.push(Ar());break}case"ConfirmForgotPassword":{e.push(Ar());break}case"ConfirmSignUp":{e.push(Ar());break}case"DeleteUser":{e.push(Ar());break}case"DeleteUserAttributes":{e.push(Ar());break}case"DeleteWebAuthnCredential":{e.push(Ar());break}case"ForgetDevice":{e.push(Ar());break}case"ForgotPassword":{e.push(Ar());break}case"GetDevice":{e.push(Ar());break}case"GetTokensFromRefreshToken":{e.push(Ar());break}case"GetUser":{e.push(Ar());break}case"GetUserAttributeVerificationCode":{e.push(Ar());break}case"GetUserAuthFactors":{e.push(Ar());break}case"GlobalSignOut":{e.push(Ar());break}case"InitiateAuth":{e.push(Ar());break}case"ListDevices":{e.push(Ar());break}case"ListWebAuthnCredentials":{e.push(Ar());break}case"ResendConfirmationCode":{e.push(Ar());break}case"RespondToAuthChallenge":{e.push(Ar());break}case"RevokeToken":{e.push(Ar());break}case"SetUserMFAPreference":{e.push(Ar());break}case"SetUserSettings":{e.push(Ar());break}case"SignUp":{e.push(Ar());break}case"StartWebAuthnRegistration":{e.push(Ar());break}case"UpdateAuthEventFeedback":{e.push(Ar());break}case"UpdateDeviceStatus":{e.push(Ar());break}case"UpdateUserAttributes":{e.push(Ar());break}case"VerifySoftwareToken":{e.push(Ar());break}case"VerifyUserAttribute":{e.push(Ar());break}default:e.push(PM(r))}return e},jM=r=>{const e=sN(r);return Object.assign(e,{authSchemePreference:oa(r.authSchemePreference??[])})},OM=r=>Object.assign(r,{useDualstackEndpoint:r.useDualstackEndpoint??!1,useFipsEndpoint:r.useFipsEndpoint??!1,defaultSigningName:"cognito-idp"}),DM={UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}},LM="3.981.0",MM={version:LM},$M=r=>new TextEncoder().encode(r);var UM=typeof Buffer<"u"&&Buffer.from?function(r){return Buffer.from(r,"utf8")}:$M;function Fm(r){return r instanceof Uint8Array?r:typeof r=="string"?UM(r):ArrayBuffer.isView(r)?new Uint8Array(r.buffer,r.byteOffset,r.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(r)}function Nw(r){return typeof r=="string"?r.length===0:r.byteLength===0}var NN={name:"SHA-256"},WE={name:"HMAC",hash:NN},zM=new Uint8Array([227,176,196,66,152,252,28,20,154,251,244,200,153,111,185,36,39,174,65,228,100,155,147,76,164,149,153,27,120,82,184,85]);const HM={};function Bv(){return typeof window<"u"?window:typeof self<"u"?self:HM}var BM=(function(){function r(e){this.toHash=new Uint8Array(0),this.secret=e,this.reset()}return r.prototype.update=function(e){if(!Nw(e)){var t=Fm(e),n=new Uint8Array(this.toHash.byteLength+t.byteLength);n.set(this.toHash,0),n.set(t,this.toHash.byteLength),this.toHash=n}},r.prototype.digest=function(){var e=this;return this.key?this.key.then(function(t){return Bv().crypto.subtle.sign(WE,t,e.toHash).then(function(n){return new Uint8Array(n)})}):Nw(this.toHash)?Promise.resolve(zM):Promise.resolve().then(function(){return Bv().crypto.subtle.digest(NN,e.toHash)}).then(function(t){return Promise.resolve(new Uint8Array(t))})},r.prototype.reset=function(){var e=this;this.toHash=new Uint8Array(0),this.secret&&this.secret!==void 0&&(this.key=new Promise(function(t,n){Bv().crypto.subtle.importKey("raw",Fm(e.secret),WE,!1,["sign"]).then(t,n)}),this.key.catch(function(){}))},r})(),Ba=function(){return Ba=Object.assign||function(e){for(var t,n=1,s=arguments.length;n<s;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},Ba.apply(this,arguments)};function TN(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(r);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(r,n[s])&&(t[n[s]]=r[n[s]]);return t}function GM(r,e,t,n){function s(i){return i instanceof t?i:new t(function(c){c(i)})}return new(t||(t=Promise))(function(i,c){function d(v){try{p(n.next(v))}catch(x){c(x)}}function m(v){try{p(n.throw(v))}catch(x){c(x)}}function p(v){v.done?i(v.value):s(v.value).then(d,m)}p((n=n.apply(r,e||[])).next())})}function WM(r,e){var t={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,c=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return c.next=d(0),c.throw=d(1),c.return=d(2),typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function d(p){return function(v){return m([p,v])}}function m(p){if(n)throw new TypeError("Generator is already executing.");for(;c&&(c=0,p[0]&&(t=0)),t;)try{if(n=1,s&&(i=p[0]&2?s.return:p[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,p[1])).done)return i;switch(s=0,i&&(p=[p[0]&2,i.value]),p[0]){case 0:case 1:i=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,s=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(i=t.trys,!(i=i.length>0&&i[i.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!i||p[1]>i[0]&&p[1]<i[3])){t.label=p[1];break}if(p[0]===6&&t.label<i[1]){t.label=i[1],i=p;break}if(i&&t.label<i[2]){t.label=i[2],t.ops.push(p);break}i[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(r,t)}catch(v){p=[6,v],s=0}finally{n=i=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function VM(r,e,t){if(t||arguments.length===2)for(var n=0,s=e.length,i;n<s;n++)(i||!(n in e))&&(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return r.concat(i||Array.prototype.slice.call(e))}var Ti=64,qM=32,KM=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),YM=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],JM=Math.pow(2,53)-1,Gv=(function(){function r(){this.state=Int32Array.from(YM),this.temp=new Int32Array(64),this.buffer=new Uint8Array(64),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}return r.prototype.update=function(e){if(this.finished)throw new Error("Attempted to update an already finished hash.");var t=0,n=e.byteLength;if(this.bytesHashed+=n,this.bytesHashed*8>JM)throw new Error("Cannot hash more than 2^53 - 1 bits");for(;n>0;)this.buffer[this.bufferLength++]=e[t++],n--,this.bufferLength===Ti&&(this.hashBuffer(),this.bufferLength=0)},r.prototype.digest=function(){if(!this.finished){var e=this.bytesHashed*8,t=new DataView(this.buffer.buffer,this.buffer.byteOffset,this.buffer.byteLength),n=this.bufferLength;if(t.setUint8(this.bufferLength++,128),n%Ti>=Ti-8){for(var s=this.bufferLength;s<Ti;s++)t.setUint8(s,0);this.hashBuffer(),this.bufferLength=0}for(var s=this.bufferLength;s<Ti-8;s++)t.setUint8(s,0);t.setUint32(Ti-8,Math.floor(e/4294967296),!0),t.setUint32(Ti-4,e),this.hashBuffer(),this.finished=!0}for(var i=new Uint8Array(qM),s=0;s<8;s++)i[s*4]=this.state[s]>>>24&255,i[s*4+1]=this.state[s]>>>16&255,i[s*4+2]=this.state[s]>>>8&255,i[s*4+3]=this.state[s]>>>0&255;return i},r.prototype.hashBuffer=function(){for(var e=this,t=e.buffer,n=e.state,s=n[0],i=n[1],c=n[2],d=n[3],m=n[4],p=n[5],v=n[6],x=n[7],b=0;b<Ti;b++){if(b<16)this.temp[b]=(t[b*4]&255)<<24|(t[b*4+1]&255)<<16|(t[b*4+2]&255)<<8|t[b*4+3]&255;else{var S=this.temp[b-2],N=(S>>>17|S<<15)^(S>>>19|S<<13)^S>>>10;S=this.temp[b-15];var E=(S>>>7|S<<25)^(S>>>18|S<<14)^S>>>3;this.temp[b]=(N+this.temp[b-7]|0)+(E+this.temp[b-16]|0)}var T=(((m>>>6|m<<26)^(m>>>11|m<<21)^(m>>>25|m<<7))+(m&p^~m&v)|0)+(x+(KM[b]+this.temp[b]|0)|0)|0,A=((s>>>2|s<<30)^(s>>>13|s<<19)^(s>>>22|s<<10))+(s&i^s&c^i&c)|0;x=v,v=p,p=m,m=d+T|0,d=c,c=i,i=s,s=T+A|0}n[0]+=s,n[1]+=i,n[2]+=c,n[3]+=d,n[4]+=m,n[5]+=p,n[6]+=v,n[7]+=x},r})(),XM=(function(){function r(e){this.secret=e,this.hash=new Gv,this.reset()}return r.prototype.update=function(e){if(!(Nw(e)||this.error))try{this.hash.update(Fm(e))}catch(t){this.error=t}},r.prototype.digestSync=function(){if(this.error)throw this.error;return this.outer?(this.outer.finished||this.outer.update(this.hash.digest()),this.outer.digest()):this.hash.digest()},r.prototype.digest=function(){return GM(this,void 0,void 0,function(){return WM(this,function(e){return[2,this.digestSync()]})})},r.prototype.reset=function(){if(this.hash=new Gv,this.secret){this.outer=new Gv;var e=QM(this.secret),t=new Uint8Array(Ti);t.set(e);for(var n=0;n<Ti;n++)e[n]^=54,t[n]^=92;this.hash.update(e),this.outer.update(t);for(var n=0;n<e.byteLength;n++)e[n]=0}},r})();function QM(r){var e=Fm(r);if(e.byteLength>Ti){var t=new Gv;t.update(e),e=t.digest()}var n=new Uint8Array(Ti);return n.set(e),n}var ZM=["decrypt","digest","encrypt","exportKey","generateKey","importKey","sign","verify"];function e$(r){if(t$(r)&&typeof r.crypto.subtle=="object"){var e=r.crypto.subtle;return r$(e)}return!1}function t$(r){if(typeof r=="object"&&typeof r.crypto=="object"){var e=r.crypto.getRandomValues;return typeof e=="function"}return!1}function r$(r){return r&&ZM.every(function(e){return typeof r[e]=="function"})}var AN=(function(){function r(e){e$(Bv())?this.hash=new BM(e):this.hash=new XM(e)}return r.prototype.update=function(e,t){this.hash.update(Fm(e))},r.prototype.digest=function(){return this.hash.digest()},r.prototype.reset=function(){this.hash.reset()},r})();const RN=({serviceId:r,clientVersion:e})=>async t=>{var S,N,E;const n=typeof window<"u"?window.navigator:void 0,s=(n==null?void 0:n.userAgent)??"",i=((S=n==null?void 0:n.userAgentData)==null?void 0:S.platform)??VE.os(s)??"other",c=void 0,d=((N=n==null?void 0:n.userAgentData)==null?void 0:N.brands)??[],m=d[d.length-1],p=(m==null?void 0:m.brand)??VE.browser(s)??"unknown",v=(m==null?void 0:m.version)??"unknown",x=[["aws-sdk-js",e],["ua","2.1"],[`os/${i}`,c],["lang/js"],["md/browser",`${p}_${v}`]];r&&x.push([`api/${r}`,e]);const b=await((E=t==null?void 0:t.userAgentAppId)==null?void 0:E.call(t));return b&&x.push([`app/${b}`]),x},VE={os(r){if(/iPhone|iPad|iPod/.test(r))return"iOS";if(/Macintosh|Mac OS X/.test(r))return"macOS";if(/Windows NT/.test(r))return"Windows";if(/Android/.test(r))return"Android";if(/Linux/.test(r))return"Linux"},browser(r){if(/EdgiOS|EdgA|Edg\//.test(r))return"Microsoft Edge";if(/Firefox\//.test(r))return"Firefox";if(/Chrome\//.test(r))return"Chrome";if(/Safari\//.test(r))return"Safari"}},IN=r=>()=>Promise.reject(r),n$=["in-region","cross-region","mobile","standard","legacy"],PN=({defaultsMode:r}={})=>VD(async()=>{const e=typeof r=="function"?await r():r;switch(e==null?void 0:e.toLowerCase()){case"auto":return Promise.resolve(s$()?"mobile":"standard");case"mobile":case"in-region":case"cross-region":case"standard":case"legacy":return Promise.resolve(e==null?void 0:e.toLocaleLowerCase());case void 0:return Promise.resolve("legacy");default:throw new Error(`Invalid parameter for "defaultsMode", expect ${n$.join(", ")}, got ${e}`)}}),s$=()=>{var e;const r=window==null?void 0:window.navigator;if(r!=null&&r.connection){const{effectiveType:t,rtt:n,downlink:s}=r==null?void 0:r.connection;if(typeof t=="string"&&t!=="4g"||Number(n)>100||Number(s)<10)return!0}return((e=r==null?void 0:r.userAgentData)==null?void 0:e.mobile)||typeof(r==null?void 0:r.maxTouchPoints)=="number"&&(r==null?void 0:r.maxTouchPoints)>1},FN=(r,e=!1)=>{if(e){for(const t of r.split("."))if(!FN(t))return!1;return!0}return!(!Km(r)||r.length<3||r.length>63||r!==r.toLowerCase()||kb(r))},qE=":",o$="/",i$=r=>{const e=r.split(qE);if(e.length<6)return null;const[t,n,s,i,c,...d]=e;if(t!=="arn"||n===""||s===""||d.join(qE)==="")return null;const m=d.map(p=>p.split(o$)).flat();return{partition:n,service:s,region:i,accountId:c,resourceId:m}},a$=[{id:"aws",outputs:{dnsSuffix:"amazonaws.com",dualStackDnsSuffix:"api.aws",implicitGlobalRegion:"us-east-1",name:"aws",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^(us|eu|ap|sa|ca|me|af|il|mx)\\-\\w+\\-\\d+$",regions:{"af-south-1":{description:"Africa (Cape Town)"},"ap-east-1":{description:"Asia Pacific (Hong Kong)"},"ap-east-2":{description:"Asia Pacific (Taipei)"},"ap-northeast-1":{description:"Asia Pacific (Tokyo)"},"ap-northeast-2":{description:"Asia Pacific (Seoul)"},"ap-northeast-3":{description:"Asia Pacific (Osaka)"},"ap-south-1":{description:"Asia Pacific (Mumbai)"},"ap-south-2":{description:"Asia Pacific (Hyderabad)"},"ap-southeast-1":{description:"Asia Pacific (Singapore)"},"ap-southeast-2":{description:"Asia Pacific (Sydney)"},"ap-southeast-3":{description:"Asia Pacific (Jakarta)"},"ap-southeast-4":{description:"Asia Pacific (Melbourne)"},"ap-southeast-5":{description:"Asia Pacific (Malaysia)"},"ap-southeast-6":{description:"Asia Pacific (New Zealand)"},"ap-southeast-7":{description:"Asia Pacific (Thailand)"},"aws-global":{description:"aws global region"},"ca-central-1":{description:"Canada (Central)"},"ca-west-1":{description:"Canada West (Calgary)"},"eu-central-1":{description:"Europe (Frankfurt)"},"eu-central-2":{description:"Europe (Zurich)"},"eu-north-1":{description:"Europe (Stockholm)"},"eu-south-1":{description:"Europe (Milan)"},"eu-south-2":{description:"Europe (Spain)"},"eu-west-1":{description:"Europe (Ireland)"},"eu-west-2":{description:"Europe (London)"},"eu-west-3":{description:"Europe (Paris)"},"il-central-1":{description:"Israel (Tel Aviv)"},"me-central-1":{description:"Middle East (UAE)"},"me-south-1":{description:"Middle East (Bahrain)"},"mx-central-1":{description:"Mexico (Central)"},"sa-east-1":{description:"South America (Sao Paulo)"},"us-east-1":{description:"US East (N. Virginia)"},"us-east-2":{description:"US East (Ohio)"},"us-west-1":{description:"US West (N. California)"},"us-west-2":{description:"US West (Oregon)"}}},{id:"aws-cn",outputs:{dnsSuffix:"amazonaws.com.cn",dualStackDnsSuffix:"api.amazonwebservices.com.cn",implicitGlobalRegion:"cn-northwest-1",name:"aws-cn",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^cn\\-\\w+\\-\\d+$",regions:{"aws-cn-global":{description:"aws-cn global region"},"cn-north-1":{description:"China (Beijing)"},"cn-northwest-1":{description:"China (Ningxia)"}}},{id:"aws-eusc",outputs:{dnsSuffix:"amazonaws.eu",dualStackDnsSuffix:"api.amazonwebservices.eu",implicitGlobalRegion:"eusc-de-east-1",name:"aws-eusc",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^eusc\\-(de)\\-\\w+\\-\\d+$",regions:{"eusc-de-east-1":{description:"AWS European Sovereign Cloud (Germany)"}}},{id:"aws-iso",outputs:{dnsSuffix:"c2s.ic.gov",dualStackDnsSuffix:"api.aws.ic.gov",implicitGlobalRegion:"us-iso-east-1",name:"aws-iso",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-iso\\-\\w+\\-\\d+$",regions:{"aws-iso-global":{description:"aws-iso global region"},"us-iso-east-1":{description:"US ISO East"},"us-iso-west-1":{description:"US ISO WEST"}}},{id:"aws-iso-b",outputs:{dnsSuffix:"sc2s.sgov.gov",dualStackDnsSuffix:"api.aws.scloud",implicitGlobalRegion:"us-isob-east-1",name:"aws-iso-b",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-isob\\-\\w+\\-\\d+$",regions:{"aws-iso-b-global":{description:"aws-iso-b global region"},"us-isob-east-1":{description:"US ISOB East (Ohio)"},"us-isob-west-1":{description:"US ISOB West"}}},{id:"aws-iso-e",outputs:{dnsSuffix:"cloud.adc-e.uk",dualStackDnsSuffix:"api.cloud-aws.adc-e.uk",implicitGlobalRegion:"eu-isoe-west-1",name:"aws-iso-e",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^eu\\-isoe\\-\\w+\\-\\d+$",regions:{"aws-iso-e-global":{description:"aws-iso-e global region"},"eu-isoe-west-1":{description:"EU ISOE West"}}},{id:"aws-iso-f",outputs:{dnsSuffix:"csp.hci.ic.gov",dualStackDnsSuffix:"api.aws.hci.ic.gov",implicitGlobalRegion:"us-isof-south-1",name:"aws-iso-f",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-isof\\-\\w+\\-\\d+$",regions:{"aws-iso-f-global":{description:"aws-iso-f global region"},"us-isof-east-1":{description:"US ISOF EAST"},"us-isof-south-1":{description:"US ISOF SOUTH"}}},{id:"aws-us-gov",outputs:{dnsSuffix:"amazonaws.com",dualStackDnsSuffix:"api.aws",implicitGlobalRegion:"us-gov-west-1",name:"aws-us-gov",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-gov\\-\\w+\\-\\d+$",regions:{"aws-us-gov-global":{description:"aws-us-gov global region"},"us-gov-east-1":{description:"AWS GovCloud (US-East)"},"us-gov-west-1":{description:"AWS GovCloud (US-West)"}}}],l$={partitions:a$};let c$=l$;const u$=r=>{const{partitions:e}=c$;for(const n of e){const{regions:s,outputs:i}=n;for(const[c,d]of Object.entries(s))if(c===r)return{...i,...d}}for(const n of e){const{regionRegex:s,outputs:i}=n;if(new RegExp(s).test(r))return{...i}}const t=e.find(n=>n.id==="aws");if(!t)throw new Error("Provided region was not found in the partition array or regex, and default partition with id 'aws' doesn't exist.");return{...t.outputs}},Pb={isVirtualHostableS3Bucket:FN,parseArn:i$,partition:u$};ch.aws=Pb;const jN="required",$s="fn",Us="argv",mh="ref",KE=!0,YE="isSet",jm="booleanEquals",Df="error",$a="endpoint",Pl="tree",Fb="PartitionResult",jb="getAttr",Up="stringEquals",JE={[jN]:!1,type:"string"},XE={[jN]:!0,default:!1,type:"boolean"},QE={[mh]:"Endpoint"},ON={[$s]:jm,[Us]:[{[mh]:"UseFIPS"},!0]},DN={[$s]:jm,[Us]:[{[mh]:"UseDualStack"},!0]},On={},lm={[mh]:"Region"},ZE={[$s]:jb,[Us]:[{[mh]:Fb},"supportsFIPS"]},LN={[mh]:Fb},eC={[$s]:jm,[Us]:[!0,{[$s]:jb,[Us]:[LN,"supportsDualStack"]}]},tC=[ON],rC=[DN],nC=[lm],d$={parameters:{Region:JE,UseDualStack:XE,UseFIPS:XE,Endpoint:JE},rules:[{conditions:[{[$s]:YE,[Us]:[QE]}],rules:[{conditions:tC,error:"Invalid Configuration: FIPS and custom endpoint are not supported",type:Df},{conditions:rC,error:"Invalid Configuration: Dualstack and custom endpoint are not supported",type:Df},{endpoint:{url:QE,properties:On,headers:On},type:$a}],type:Pl},{conditions:[{[$s]:YE,[Us]:nC}],rules:[{conditions:[{[$s]:"aws.partition",[Us]:nC,assign:Fb}],rules:[{conditions:[ON,DN],rules:[{conditions:[{[$s]:jm,[Us]:[KE,ZE]},eC],rules:[{conditions:[{[$s]:Up,[Us]:[lm,"us-east-1"]}],endpoint:{url:"https://cognito-idp-fips.us-east-1.amazonaws.com",properties:On,headers:On},type:$a},{conditions:[{[$s]:Up,[Us]:[lm,"us-east-2"]}],endpoint:{url:"https://cognito-idp-fips.us-east-2.amazonaws.com",properties:On,headers:On},type:$a},{conditions:[{[$s]:Up,[Us]:[lm,"us-west-1"]}],endpoint:{url:"https://cognito-idp-fips.us-west-1.amazonaws.com",properties:On,headers:On},type:$a},{conditions:[{[$s]:Up,[Us]:[lm,"us-west-2"]}],endpoint:{url:"https://cognito-idp-fips.us-west-2.amazonaws.com",properties:On,headers:On},type:$a},{endpoint:{url:"https://cognito-idp-fips.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:On,headers:On},type:$a}],type:Pl},{error:"FIPS and DualStack are enabled, but this partition does not support one or both",type:Df}],type:Pl},{conditions:tC,rules:[{conditions:[{[$s]:jm,[Us]:[ZE,KE]}],rules:[{endpoint:{url:"https://cognito-idp-fips.{Region}.{PartitionResult#dnsSuffix}",properties:On,headers:On},type:$a}],type:Pl},{error:"FIPS is enabled but this partition does not support FIPS",type:Df}],type:Pl},{conditions:rC,rules:[{conditions:[eC],rules:[{conditions:[{[$s]:Up,[Us]:["aws",{[$s]:jb,[Us]:[LN,"name"]}]}],endpoint:{url:"https://cognito-idp.{Region}.amazonaws.com",properties:On,headers:On},type:$a},{endpoint:{url:"https://cognito-idp.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:On,headers:On},type:$a}],type:Pl},{error:"DualStack is enabled but this partition does not support DualStack",type:Df}],type:Pl},{endpoint:{url:"https://cognito-idp.{Region}.{PartitionResult#dnsSuffix}",properties:On,headers:On},type:$a}],type:Pl}],type:Pl},{error:"Invalid Configuration: Missing Region",type:Df}]},f$=d$,h$=new M1({size:50,params:["Endpoint","Region","UseDualStack","UseFIPS"]}),p$=(r,e={})=>h$.get(r,()=>K1(f$,{endpointParams:r,logger:e.logger}));ch.aws=Pb;const m$=r=>({apiVersion:"2016-04-18",base64Decoder:(r==null?void 0:r.base64Decoder)??qm,base64Encoder:(r==null?void 0:r.base64Encoder)??Tm,disableHostPrefix:(r==null?void 0:r.disableHostPrefix)??!1,endpointProvider:(r==null?void 0:r.endpointProvider)??p$,extensions:(r==null?void 0:r.extensions)??[],httpAuthSchemeProvider:(r==null?void 0:r.httpAuthSchemeProvider)??FM,httpAuthSchemes:(r==null?void 0:r.httpAuthSchemes)??[{schemeId:"aws.auth#sigv4",identityProvider:e=>e.getIdentityProvider("aws.auth#sigv4"),signer:new X1},{schemeId:"smithy.api#noAuth",identityProvider:e=>e.getIdentityProvider("smithy.api#noAuth")||(async()=>({})),signer:new O1}],logger:(r==null?void 0:r.logger)??new Ab,protocol:(r==null?void 0:r.protocol)??dN,protocolSettings:(r==null?void 0:r.protocolSettings)??{defaultNamespace:"com.amazonaws.cognitoidentityprovider",xmlNamespace:"http://cognito-idp.amazonaws.com/doc/2016-04-18/",version:"2016-04-18",serviceTarget:"AWSCognitoIdentityProviderService"},serviceId:(r==null?void 0:r.serviceId)??"Cognito Identity Provider",urlParser:(r==null?void 0:r.urlParser)??Im,utf8Decoder:(r==null?void 0:r.utf8Decoder)??cd,utf8Encoder:(r==null?void 0:r.utf8Encoder)??Ly}),g$=r=>{const e=PN(r),t=()=>e().then(lN),n=m$(r);return{...n,...r,runtime:"browser",defaultsMode:e,bodyLengthChecker:(r==null?void 0:r.bodyLengthChecker)??oN,credentialDefaultProvider:(r==null?void 0:r.credentialDefaultProvider)??(s=>()=>Promise.reject(new Error("Credential is missing"))),defaultUserAgentProvider:(r==null?void 0:r.defaultUserAgentProvider)??RN({serviceId:n.serviceId,clientVersion:MM.version}),maxAttempts:(r==null?void 0:r.maxAttempts)??Pm,region:(r==null?void 0:r.region)??IN("Region is missing"),requestHandler:My.create((r==null?void 0:r.requestHandler)??t),retryMode:(r==null?void 0:r.retryMode)??(async()=>(await t()).retryMode||bN),sha256:(r==null?void 0:r.sha256)??AN,streamCollector:(r==null?void 0:r.streamCollector)??N1,useDualstackEndpoint:(r==null?void 0:r.useDualstackEndpoint)??(()=>Promise.resolve(hN)),useFipsEndpoint:(r==null?void 0:r.useFipsEndpoint)??(()=>Promise.resolve(pN))}},MN=r=>({setRegion(e){r.region=e},region(){return r.region}}),$N=r=>({region:r.region()}),v$=r=>{const e=r.httpAuthSchemes;let t=r.httpAuthSchemeProvider,n=r.credentials;return{setHttpAuthScheme(s){const i=e.findIndex(c=>c.schemeId===s.schemeId);i===-1?e.push(s):e.splice(i,1,s)},httpAuthSchemes(){return e},setHttpAuthSchemeProvider(s){t=s},httpAuthSchemeProvider(){return t},setCredentials(s){n=s},credentials(){return n}}},y$=r=>({httpAuthSchemes:r.httpAuthSchemes(),httpAuthSchemeProvider:r.httpAuthSchemeProvider(),credentials:r.credentials()}),x$=(r,e)=>{const t=Object.assign(MN(r),cN(r),x1(r),v$(r));return e.forEach(n=>n.configure(t)),Object.assign(r,$N(t),uN(t),w1(t),y$(t))};class Ob extends iN{constructor(...[t]){const n=g$(t||{});super(n);B(this,"config");this.initConfig=n;const s=OM(n),i=L1(s),c=CN(i),d=gN(c),m=d,p=wN(m),v=jM(p),x=x$(v,(t==null?void 0:t.extensions)||[]);this.config=x,this.middlewareStack.use(R1(this.config)),this.middlewareStack.use(fN(this.config)),this.middlewareStack.use(kN(this.config)),this.middlewareStack.use(vN(this.config)),this.middlewareStack.use(b1(this.config)),this.middlewareStack.use(_1(this.config)),this.middlewareStack.use(S1(this.config)),this.middlewareStack.use(E1(this.config,{httpAuthSchemeParametersProvider:IM,identityProviderConfigProvider:async b=>new j1({"aws.auth#sigv4":b.credentials})})),this.middlewareStack.use(C1(this.config))}destroy(){super.destroy()}}class Et extends Kf{constructor(e){super(e),Object.setPrototypeOf(this,Et.prototype)}}class Db extends Et{constructor(t){super({name:"InternalErrorException",$fault:"server",...t});B(this,"name","InternalErrorException");B(this,"$fault","server");Object.setPrototypeOf(this,Db.prototype)}}class Lb extends Et{constructor(t){super({name:"InvalidParameterException",$fault:"client",...t});B(this,"name","InvalidParameterException");B(this,"$fault","client");B(this,"reasonCode");Object.setPrototypeOf(this,Lb.prototype),this.reasonCode=t.reasonCode}}class Mb extends Et{constructor(t){super({name:"NotAuthorizedException",$fault:"client",...t});B(this,"name","NotAuthorizedException");B(this,"$fault","client");Object.setPrototypeOf(this,Mb.prototype)}}class $b extends Et{constructor(t){super({name:"ResourceNotFoundException",$fault:"client",...t});B(this,"name","ResourceNotFoundException");B(this,"$fault","client");Object.setPrototypeOf(this,$b.prototype)}}class Ub extends Et{constructor(t){super({name:"TooManyRequestsException",$fault:"client",...t});B(this,"name","TooManyRequestsException");B(this,"$fault","client");Object.setPrototypeOf(this,Ub.prototype)}}class zb extends Et{constructor(t){super({name:"UserImportInProgressException",$fault:"client",...t});B(this,"name","UserImportInProgressException");B(this,"$fault","client");Object.setPrototypeOf(this,zb.prototype)}}class Hb extends Et{constructor(t){super({name:"UserNotFoundException",$fault:"client",...t});B(this,"name","UserNotFoundException");B(this,"$fault","client");Object.setPrototypeOf(this,Hb.prototype)}}class Bb extends Et{constructor(t){super({name:"InvalidLambdaResponseException",$fault:"client",...t});B(this,"name","InvalidLambdaResponseException");B(this,"$fault","client");Object.setPrototypeOf(this,Bb.prototype)}}class Gb extends Et{constructor(t){super({name:"LimitExceededException",$fault:"client",...t});B(this,"name","LimitExceededException");B(this,"$fault","client");Object.setPrototypeOf(this,Gb.prototype)}}class Wb extends Et{constructor(t){super({name:"TooManyFailedAttemptsException",$fault:"client",...t});B(this,"name","TooManyFailedAttemptsException");B(this,"$fault","client");Object.setPrototypeOf(this,Wb.prototype)}}class Vb extends Et{constructor(t){super({name:"UnexpectedLambdaException",$fault:"client",...t});B(this,"name","UnexpectedLambdaException");B(this,"$fault","client");Object.setPrototypeOf(this,Vb.prototype)}}class qb extends Et{constructor(t){super({name:"UserLambdaValidationException",$fault:"client",...t});B(this,"name","UserLambdaValidationException");B(this,"$fault","client");Object.setPrototypeOf(this,qb.prototype)}}class Kb extends Et{constructor(t){super({name:"CodeDeliveryFailureException",$fault:"client",...t});B(this,"name","CodeDeliveryFailureException");B(this,"$fault","client");Object.setPrototypeOf(this,Kb.prototype)}}class Yb extends Et{constructor(t){super({name:"InvalidPasswordException",$fault:"client",...t});B(this,"name","InvalidPasswordException");B(this,"$fault","client");Object.setPrototypeOf(this,Yb.prototype)}}class Jb extends Et{constructor(t){super({name:"InvalidSmsRoleAccessPolicyException",$fault:"client",...t});B(this,"name","InvalidSmsRoleAccessPolicyException");B(this,"$fault","client");Object.setPrototypeOf(this,Jb.prototype)}}class Xb extends Et{constructor(t){super({name:"InvalidSmsRoleTrustRelationshipException",$fault:"client",...t});B(this,"name","InvalidSmsRoleTrustRelationshipException");B(this,"$fault","client");Object.setPrototypeOf(this,Xb.prototype)}}class Qb extends Et{constructor(t){super({name:"PreconditionNotMetException",$fault:"client",...t});B(this,"name","PreconditionNotMetException");B(this,"$fault","client");Object.setPrototypeOf(this,Qb.prototype)}}class Zb extends Et{constructor(t){super({name:"UnsupportedUserStateException",$fault:"client",...t});B(this,"name","UnsupportedUserStateException");B(this,"$fault","client");Object.setPrototypeOf(this,Zb.prototype)}}class e_ extends Et{constructor(t){super({name:"UsernameExistsException",$fault:"client",...t});B(this,"name","UsernameExistsException");B(this,"$fault","client");Object.setPrototypeOf(this,e_.prototype)}}class t_ extends Et{constructor(t){super({name:"AliasExistsException",$fault:"client",...t});B(this,"name","AliasExistsException");B(this,"$fault","client");Object.setPrototypeOf(this,t_.prototype)}}class r_ extends Et{constructor(t){super({name:"InvalidUserPoolConfigurationException",$fault:"client",...t});B(this,"name","InvalidUserPoolConfigurationException");B(this,"$fault","client");Object.setPrototypeOf(this,r_.prototype)}}class n_ extends Et{constructor(t){super({name:"InvalidEmailRoleAccessPolicyException",$fault:"client",...t});B(this,"name","InvalidEmailRoleAccessPolicyException");B(this,"$fault","client");Object.setPrototypeOf(this,n_.prototype)}}class s_ extends Et{constructor(t){super({name:"MFAMethodNotFoundException",$fault:"client",...t});B(this,"name","MFAMethodNotFoundException");B(this,"$fault","client");Object.setPrototypeOf(this,s_.prototype)}}class o_ extends Et{constructor(t){super({name:"PasswordResetRequiredException",$fault:"client",...t});B(this,"name","PasswordResetRequiredException");B(this,"$fault","client");Object.setPrototypeOf(this,o_.prototype)}}class i_ extends Et{constructor(t){super({name:"UnsupportedOperationException",$fault:"client",...t});B(this,"name","UnsupportedOperationException");B(this,"$fault","client");Object.setPrototypeOf(this,i_.prototype)}}class a_ extends Et{constructor(t){super({name:"UserNotConfirmedException",$fault:"client",...t});B(this,"name","UserNotConfirmedException");B(this,"$fault","client");Object.setPrototypeOf(this,a_.prototype)}}class l_ extends Et{constructor(t){super({name:"UserPoolAddOnNotEnabledException",$fault:"client",...t});B(this,"name","UserPoolAddOnNotEnabledException");B(this,"$fault","client");Object.setPrototypeOf(this,l_.prototype)}}class c_ extends Et{constructor(t){super({name:"CodeMismatchException",$fault:"client",...t});B(this,"name","CodeMismatchException");B(this,"$fault","client");Object.setPrototypeOf(this,c_.prototype)}}class u_ extends Et{constructor(t){super({name:"ExpiredCodeException",$fault:"client",...t});B(this,"name","ExpiredCodeException");B(this,"$fault","client");Object.setPrototypeOf(this,u_.prototype)}}class d_ extends Et{constructor(t){super({name:"PasswordHistoryPolicyViolationException",$fault:"client",...t});B(this,"name","PasswordHistoryPolicyViolationException");B(this,"$fault","client");Object.setPrototypeOf(this,d_.prototype)}}class f_ extends Et{constructor(t){super({name:"SoftwareTokenMFANotFoundException",$fault:"client",...t});B(this,"name","SoftwareTokenMFANotFoundException");B(this,"$fault","client");Object.setPrototypeOf(this,f_.prototype)}}class h_ extends Et{constructor(t){super({name:"ConcurrentModificationException",$fault:"client",...t});B(this,"name","ConcurrentModificationException");B(this,"$fault","client");Object.setPrototypeOf(this,h_.prototype)}}class p_ extends Et{constructor(t){super({name:"ForbiddenException",$fault:"client",...t});B(this,"name","ForbiddenException");B(this,"$fault","client");Object.setPrototypeOf(this,p_.prototype)}}class m_ extends Et{constructor(t){super({name:"WebAuthnChallengeNotFoundException",$fault:"client",...t});B(this,"name","WebAuthnChallengeNotFoundException");B(this,"$fault","client");Object.setPrototypeOf(this,m_.prototype)}}class g_ extends Et{constructor(t){super({name:"WebAuthnClientMismatchException",$fault:"client",...t});B(this,"name","WebAuthnClientMismatchException");B(this,"$fault","client");Object.setPrototypeOf(this,g_.prototype)}}class v_ extends Et{constructor(t){super({name:"WebAuthnCredentialNotSupportedException",$fault:"client",...t});B(this,"name","WebAuthnCredentialNotSupportedException");B(this,"$fault","client");Object.setPrototypeOf(this,v_.prototype)}}class y_ extends Et{constructor(t){super({name:"WebAuthnNotEnabledException",$fault:"client",...t});B(this,"name","WebAuthnNotEnabledException");B(this,"$fault","client");Object.setPrototypeOf(this,y_.prototype)}}class x_ extends Et{constructor(t){super({name:"WebAuthnOriginNotAllowedException",$fault:"client",...t});B(this,"name","WebAuthnOriginNotAllowedException");B(this,"$fault","client");Object.setPrototypeOf(this,x_.prototype)}}class w_ extends Et{constructor(t){super({name:"WebAuthnRelyingPartyMismatchException",$fault:"client",...t});B(this,"name","WebAuthnRelyingPartyMismatchException");B(this,"$fault","client");Object.setPrototypeOf(this,w_.prototype)}}class b_ extends Et{constructor(t){super({name:"DeviceKeyExistsException",$fault:"client",...t});B(this,"name","DeviceKeyExistsException");B(this,"$fault","client");Object.setPrototypeOf(this,b_.prototype)}}class __ extends Et{constructor(t){super({name:"GroupExistsException",$fault:"client",...t});B(this,"name","GroupExistsException");B(this,"$fault","client");Object.setPrototypeOf(this,__.prototype)}}class S_ extends Et{constructor(t){super({name:"DuplicateProviderException",$fault:"client",...t});B(this,"name","DuplicateProviderException");B(this,"$fault","client");Object.setPrototypeOf(this,S_.prototype)}}class E_ extends Et{constructor(t){super({name:"ManagedLoginBrandingExistsException",$fault:"client",...t});B(this,"name","ManagedLoginBrandingExistsException");B(this,"$fault","client");Object.setPrototypeOf(this,E_.prototype)}}class C_ extends Et{constructor(t){super({name:"TermsExistsException",$fault:"client",...t});B(this,"name","TermsExistsException");B(this,"$fault","client");Object.setPrototypeOf(this,C_.prototype)}}class k_ extends Et{constructor(t){super({name:"FeatureUnavailableInTierException",$fault:"client",...t});B(this,"name","FeatureUnavailableInTierException");B(this,"$fault","client");Object.setPrototypeOf(this,k_.prototype)}}class N_ extends Et{constructor(t){super({name:"TierChangeNotAllowedException",$fault:"client",...t});B(this,"name","TierChangeNotAllowedException");B(this,"$fault","client");Object.setPrototypeOf(this,N_.prototype)}}class T_ extends Et{constructor(t){super({name:"UserPoolTaggingException",$fault:"client",...t});B(this,"name","UserPoolTaggingException");B(this,"$fault","client");Object.setPrototypeOf(this,T_.prototype)}}class A_ extends Et{constructor(t){super({name:"InvalidOAuthFlowException",$fault:"client",...t});B(this,"name","InvalidOAuthFlowException");B(this,"$fault","client");Object.setPrototypeOf(this,A_.prototype)}}class R_ extends Et{constructor(t){super({name:"ScopeDoesNotExistException",$fault:"client",...t});B(this,"name","ScopeDoesNotExistException");B(this,"$fault","client");Object.setPrototypeOf(this,R_.prototype)}}class I_ extends Et{constructor(t){super({name:"UnsupportedIdentityProviderException",$fault:"client",...t});B(this,"name","UnsupportedIdentityProviderException");B(this,"$fault","client");Object.setPrototypeOf(this,I_.prototype)}}class P_ extends Et{constructor(t){super({name:"RefreshTokenReuseException",$fault:"client",...t});B(this,"name","RefreshTokenReuseException");B(this,"$fault","client");Object.setPrototypeOf(this,P_.prototype)}}class F_ extends Et{constructor(t){super({name:"UnauthorizedException",$fault:"client",...t});B(this,"name","UnauthorizedException");B(this,"$fault","client");Object.setPrototypeOf(this,F_.prototype)}}class j_ extends Et{constructor(t){super({name:"UnsupportedTokenTypeException",$fault:"client",...t});B(this,"name","UnsupportedTokenTypeException");B(this,"$fault","client");Object.setPrototypeOf(this,j_.prototype)}}class O_ extends Et{constructor(t){super({name:"WebAuthnConfigurationMissingException",$fault:"client",...t});B(this,"name","WebAuthnConfigurationMissingException");B(this,"$fault","client");Object.setPrototypeOf(this,O_.prototype)}}class D_ extends Et{constructor(t){super({name:"EnableSoftwareTokenMFAException",$fault:"client",...t});B(this,"name","EnableSoftwareTokenMFAException");B(this,"$fault","client");Object.setPrototypeOf(this,D_.prototype)}}const w$="AvailableChallenges",b$="AliasExistsException",_$="AnalyticsEndpointId",S$="AuthFlow",E$="AnalyticsMetadata",C$="AnalyticsMetadataType",k$="AuthParameters",N$="AuthParametersType",T$="AuthenticationResult",A$="AuthenticationResultType",R$="AccessToken",I$="CodeDeliveryFailureException",P$="ClientId",F$="ClientIdType",j$="ClientMetadata",O$="CodeMismatchException",D$="ConcurrentModificationException",L$="ChallengeName",M$="ChallengeParameters",$$="DeviceGroupKey",U$="DeviceKey",z$="DeviceKeyExistsException",H$="DuplicateProviderException",B$="ExpiredCodeException",G$="EncodedData",W$="ExpiresIn",V$="EnableSoftwareTokenMFAException",q$="ForbiddenException",K$="FeatureUnavailableInTierException",Y$="GroupExistsException",J$="IpAddress",X$="InitiateAuthRequest",Q$="InitiateAuthResponse",Z$="InitiateAuth",e4="InternalErrorException",t4="InvalidEmailRoleAccessPolicyException",r4="InvalidLambdaResponseException",n4="InvalidOAuthFlowException",s4="InvalidParameterException",o4="InvalidPasswordException",i4="InvalidSmsRoleAccessPolicyException",a4="InvalidSmsRoleTrustRelationshipException",l4="IdToken",c4="InvalidUserPoolConfigurationException",u4="LimitExceededException",d4="MFAMethodNotFoundException",f4="ManagedLoginBrandingExistsException",h4="NotAuthorizedException",p4="NewDeviceMetadata",m4="NewDeviceMetadataType",g4="PasswordHistoryPolicyViolationException",v4="PreconditionNotMetException",y4="PasswordResetRequiredException",x4="ResourceNotFoundException",w4="RefreshToken",b4="RefreshTokenReuseException",UN="Session",_4="ScopeDoesNotExistException",S4="SessionType",E4="SoftwareTokenMFANotFoundException",C4="TierChangeNotAllowedException",k4="TermsExistsException",N4="TooManyFailedAttemptsException",T4="TooManyRequestsException",A4="TokenModelType",R4="TokenType",I4="UserContextDataType",P4="UserContextData",F4="UnauthorizedException",j4="UsernameExistsException",O4="UserImportInProgressException",D4="UnsupportedIdentityProviderException",L4="UnexpectedLambdaException",M4="UserLambdaValidationException",$4="UserNotConfirmedException",U4="UserNotFoundException",z4="UnsupportedOperationException",H4="UserPoolAddOnNotEnabledException",B4="UserPoolTaggingException",G4="UnsupportedTokenTypeException",W4="UnsupportedUserStateException",V4="WebAuthnClientMismatchException",q4="WebAuthnConfigurationMissingException",K4="WebAuthnChallengeNotFoundException",Y4="WebAuthnCredentialNotSupportedException",J4="WebAuthnNotEnabledException",X4="WebAuthnOriginNotAllowedException",Q4="WebAuthnRelyingPartyMismatchException",jt="client",It="error",Ot="httpError",Pt="message",Z4="reasonCode",e3="server",zN="smithy.ts.sdk.synthetic.com.amazonaws.cognitoidentityprovider",ke="com.amazonaws.cognitoidentityprovider";var t3=[0,ke,F$,8,0],HN=[0,ke,S4,8,0],Sx=[0,ke,A4,8,0],r3=[-3,ke,b$,{[It]:jt,[Ot]:400},[Pt],[0]];xt.for(ke).registerError(r3,t_);var n3=[3,ke,C$,0,[_$],[0]],s3=[3,ke,A$,0,[R$,W$,R4,w4,l4,p4],[[()=>Sx,0],1,0,[()=>Sx,0],[()=>Sx,0],()=>A3]],o3=[-3,ke,I$,{[It]:jt,[Ot]:400},[Pt],[0]];xt.for(ke).registerError(o3,Kb);var i3=[-3,ke,O$,{[It]:jt,[Ot]:400},[Pt],[0]];xt.for(ke).registerError(i3,c_);var a3=[-3,ke,D$,{[It]:jt,[Ot]:400},[Pt],[0]];xt.for(ke).registerError(a3,h_);var l3=[-3,ke,z$,{[It]:jt,[Ot]:400},[Pt],[0]];xt.for(ke).registerError(l3,b_);var c3=[-3,ke,H$,{[It]:jt,[Ot]:400},[Pt],[0]];xt.for(ke).registerError(c3,S_);var u3=[-3,ke,V$,{[It]:jt,[Ot]:400},[Pt],[0]];xt.for(ke).registerError(u3,D_);var d3=[-3,ke,B$,{[It]:jt,[Ot]:400},[Pt],[0]];xt.for(ke).registerError(d3,u_);var f3=[-3,ke,K$,{[It]:jt,[Ot]:403},[Pt],[0]];xt.for(ke).registerError(f3,k_);var h3=[-3,ke,q$,{[It]:jt,[Ot]:403},[Pt],[0]];xt.for(ke).registerError(h3,p_);var p3=[-3,ke,Y$,{[It]:jt,[Ot]:400},[Pt],[0]];xt.for(ke).registerError(p3,__);var m3=[3,ke,X$,0,[S$,P$,k$,j$,E$,P4,UN],[0,[()=>t3,0],[()=>uU,0],128,()=>n3,[()=>K3,0],[()=>HN,0]],2],g3=[3,ke,Q$,0,[L$,UN,M$,T$,w$],[0,[()=>HN,0],128,[()=>s3,0],64]],v3=[-3,ke,e4,{[It]:e3},[Pt],[0]];xt.for(ke).registerError(v3,Db);var y3=[-3,ke,t4,{[It]:jt,[Ot]:400},[Pt],[0]];xt.for(ke).registerError(y3,n_);var x3=[-3,ke,r4,{[It]:jt,[Ot]:400},[Pt],[0]];xt.for(ke).registerError(x3,Bb);var w3=[-3,ke,n4,{[It]:jt,[Ot]:400},[Pt],[0]];xt.for(ke).registerError(w3,A_);var b3=[-3,ke,s4,{[It]:jt,[Ot]:400},[Pt,Z4],[0,0]];xt.for(ke).registerError(b3,Lb);var _3=[-3,ke,o4,{[It]:jt,[Ot]:400},[Pt],[0]];xt.for(ke).registerError(_3,Yb);var S3=[-3,ke,i4,{[It]:jt,[Ot]:400},[Pt],[0]];xt.for(ke).registerError(S3,Jb);var E3=[-3,ke,a4,{[It]:jt,[Ot]:400},[Pt],[0]];xt.for(ke).registerError(E3,Xb);var C3=[-3,ke,c4,{[It]:jt,[Ot]:400},[Pt],[0]];xt.for(ke).registerError(C3,r_);var k3=[-3,ke,u4,{[It]:jt,[Ot]:400},[Pt],[0]];xt.for(ke).registerError(k3,Gb);var N3=[-3,ke,f4,{[It]:jt,[Ot]:400},[Pt],[0]];xt.for(ke).registerError(N3,E_);var T3=[-3,ke,d4,{[It]:jt,[Ot]:400},[Pt],[0]];xt.for(ke).registerError(T3,s_);var A3=[3,ke,m4,0,[U$,$$],[0,0]],R3=[-3,ke,h4,{[It]:jt,[Ot]:403},[Pt],[0]];xt.for(ke).registerError(R3,Mb);var I3=[-3,ke,g4,{[It]:jt,[Ot]:400},[Pt],[0]];xt.for(ke).registerError(I3,d_);var P3=[-3,ke,y4,{[It]:jt,[Ot]:400},[Pt],[0]];xt.for(ke).registerError(P3,o_);var F3=[-3,ke,v4,{[It]:jt,[Ot]:400},[Pt],[0]];xt.for(ke).registerError(F3,Qb);var j3=[-3,ke,b4,{[It]:jt,[Ot]:400},[Pt],[0]];xt.for(ke).registerError(j3,P_);var O3=[-3,ke,x4,{[It]:jt,[Ot]:404},[Pt],[0]];xt.for(ke).registerError(O3,$b);var D3=[-3,ke,_4,{[It]:jt,[Ot]:400},[Pt],[0]];xt.for(ke).registerError(D3,R_);var L3=[-3,ke,E4,{[It]:jt,[Ot]:400},[Pt],[0]];xt.for(ke).registerError(L3,f_);var M3=[-3,ke,k4,{[It]:jt,[Ot]:400},[Pt],[0]];xt.for(ke).registerError(M3,C_);var $3=[-3,ke,C4,{[It]:jt,[Ot]:403},[Pt],[0]];xt.for(ke).registerError($3,N_);var U3=[-3,ke,N4,{[It]:jt,[Ot]:400},[Pt],[0]];xt.for(ke).registerError(U3,Wb);var z3=[-3,ke,T4,{[It]:jt,[Ot]:429},[Pt],[0]];xt.for(ke).registerError(z3,Ub);var H3=[-3,ke,F4,{[It]:jt,[Ot]:401},[Pt],[0]];xt.for(ke).registerError(H3,F_);var B3=[-3,ke,L4,{[It]:jt,[Ot]:400},[Pt],[0]];xt.for(ke).registerError(B3,Vb);var G3=[-3,ke,D4,{[It]:jt,[Ot]:400},[Pt],[0]];xt.for(ke).registerError(G3,I_);var W3=[-3,ke,z4,{[It]:jt,[Ot]:400},[Pt],[0]];xt.for(ke).registerError(W3,i_);var V3=[-3,ke,G4,{[It]:jt,[Ot]:400},[Pt],[0]];xt.for(ke).registerError(V3,j_);var q3=[-3,ke,W4,{[It]:jt,[Ot]:400},[Pt],[0]];xt.for(ke).registerError(q3,Zb);var K3=[3,ke,I4,8,[J$,G$],[0,0]],Y3=[-3,ke,O4,{[It]:jt,[Ot]:400},[Pt],[0]];xt.for(ke).registerError(Y3,zb);var J3=[-3,ke,M4,{[It]:jt,[Ot]:400},[Pt],[0]];xt.for(ke).registerError(J3,qb);var X3=[-3,ke,j4,{[It]:jt,[Ot]:400},[Pt],[0]];xt.for(ke).registerError(X3,e_);var Q3=[-3,ke,$4,{[It]:jt,[Ot]:400},[Pt],[0]];xt.for(ke).registerError(Q3,a_);var Z3=[-3,ke,U4,{[It]:jt,[Ot]:404},[Pt],[0]];xt.for(ke).registerError(Z3,Hb);var eU=[-3,ke,H4,{[It]:jt,[Ot]:400},[Pt],[0]];xt.for(ke).registerError(eU,l_);var tU=[-3,ke,B4,{[It]:jt,[Ot]:400},[Pt],[0]];xt.for(ke).registerError(tU,T_);var rU=[-3,ke,K4,{[It]:jt,[Ot]:400},[Pt],[0]];xt.for(ke).registerError(rU,m_);var nU=[-3,ke,V4,{[It]:jt,[Ot]:400},[Pt],[0]];xt.for(ke).registerError(nU,g_);var sU=[-3,ke,q4,{[It]:jt,[Ot]:400},[Pt],[0]];xt.for(ke).registerError(sU,O_);var oU=[-3,ke,Y4,{[It]:jt,[Ot]:400},[Pt],[0]];xt.for(ke).registerError(oU,v_);var iU=[-3,ke,J4,{[It]:jt,[Ot]:400},[Pt],[0]];xt.for(ke).registerError(iU,y_);var aU=[-3,ke,X4,{[It]:jt,[Ot]:400},[Pt],[0]];xt.for(ke).registerError(aU,x_);var lU=[-3,ke,Q4,{[It]:jt,[Ot]:400},[Pt],[0]];xt.for(ke).registerError(lU,w_);var cU=[-3,zN,"CognitoIdentityProviderServiceException",0,[],[]];xt.for(zN).registerError(cU,Et);var uU=[2,ke,N$,8,0,0],dU=[9,ke,Z$,0,()=>m3,()=>g3];class L_ extends aN.classBuilder().ep(DM).m(function(e,t,n,s){return[oM(n,e.getEndpointParameterInstructions())]}).s("AWSCognitoIdentityProviderService","InitiateAuth",{}).n("CognitoIdentityProviderClient","InitiateAuthCommand").sc(dU).build(){}const fU="0.0.0",BN="staging",hU="outlook-addin",pU="staging-outlook-app-id",mU="https://candle-ai.github.io/FileServer_Staging/dist-outlook-addin/manifest.xml",gU="https://appsforoffice.microsoft.com/lib/1/hosted/office.js",vU="https://candle-ai.github.io/FileServer_Staging/dist-outlook-addin/src/apps/outlook-addin/auth-dialog-pkce.html",yU=!0,Tw="https://candle-ai.github.io/FileServer_Staging/dist-outlook-addin/src/apps/outlook-addin/auth-dialog-pkce.html?callback=true",xU="https://candle-ai.github.io/FileServer_Staging/dist-outlook-addin/options",M_="https://candle-ai.github.io/FileServer_Staging/dist-outlook-addin/auth/gmail/callback",Pr="https://vixpby8nfc.execute-api.us-east-1.amazonaws.com/prod",wU="https://vixpby8nfc.execute-api.us-east-1.amazonaws.com/prod",GN="https://candle-ai.github.io/FileServer_Staging/dist-outlook-addin",WN="https://candle-565393026129-us-east-1.auth.us-east-1.amazoncognito.com",gh="22pj09tqppmia7sh207a3ufaq9",VN=r=>`${WN}/login?client_id=${gh}&response_type=code&scope=email+openid+profile&redirect_uri=${r}`,qN="https://candle-565393026129-us-east-1.auth.us-east-1.amazoncognito.com/oauth2/token",bU="https://candle-565393026129-us-east-1.auth.us-east-1.amazoncognito.com/oauth2/userInfo",Zf="https://app.staging.trycandle.ai",KN="https://forms.gle/QFFz1rbFVmwJ96At6",_U="00db376f-0fb4-48b3-8844-c2cb1ba88920",YN="https://accounts.google.com/o/oauth2",JN="74023389454-6cal15ik3pu0p55rm5mr3go8kgro0gv8.apps.googleusercontent.com",$_=r=>`${YN}/auth?client_id=${JN}&redirect_uri=${r}&response_type=code&scope=https://www.googleapis.com/auth/gmail.readonly&access_type=offline&prompt=consent`,U_="https://vixpby8nfc.execute-api.us-east-1.amazonaws.com/prod/oauth/login/",Aw="phc_RZCAfsv2zW9fB7Pdb8b50InaGRQJl7f8DPbD1lkxmZP",XN="https://us.i.posthog.com",SU="outlook",QN="staging",ZN={buildTime:"2026-02-26T20:51:01.105Z",environment:"staging",configSource:"outlook_config.tsx",authMethod:"PKCE"},EU=Object.freeze(Object.defineProperty({__proto__:null,API_BASE_URL:wU,API_SERVER:Pr,AUTH_DIALOG_URL:vU,AWS_CLIENT_ID:gh,AWS_COGNITO_DOMAIN:WN,AWS_LOGIN_PAGE_URI:VN,AWS_OAUTH_TOKEN_URI:qN,AWS_USERINFO_URI:bU,BASE_DOMAIN:GN,BUILD_ENV:QN,CONFIG_VERIFICATION:ZN,FEEDBACK_FORM:KN,GMAIL_INTEGRATION_CLIENT_ID:JN,GMAIL_INTEGRATION_DOMAIN:YN,GMAIL_INTEGRATION_PAGE_URI:$_,GMAIL_INTEGRATION_REDIRECT_URI:M_,INTEGRATION_AUTH_URL_PREFIX:U_,LOGIN_REDIRECT_URI:Tw,MANIFEST_URL:mU,MODE:BN,OFFICE_JS_CDN:gU,OUTLOOK_APP_ID:pU,OUTLOOK_CLIENT_ID:_U,PLATFORM:SU,POSTHOG_HOST:XN,POSTHOG_KEY:Aw,POST_LOGIN_REDIRECT_URI:xU,SETTINGS_PAGE_URL:Zf,TYPE:hU,USE_PKCE_AUTH:yU,VERSION:fU},Symbol.toStringTag,{value:"Module"})),rd="src/platforms/helpers/chromeAuthUtils.ts",z_=r=>new Promise(e=>{chrome.storage.local.set({token:JSON.stringify(r)},()=>{e()})}),CU=()=>new Promise(r=>{chrome.storage.local.get("token",e=>{const t=e.token?JSON.parse(e.token):null;r(t)})}),kU=()=>new Promise(r=>{chrome.storage.local.set({token:null},()=>{r()})});async function NU(r,e,t){const n="refreshAuthToken",s=new Ob({region:"us-east-1"});try{t.info("Preparing for REFRESH_TOKEN_AUTH",{sourceFile:rd,functionName:n}),t.debug("AuthFlow: REFRESH_TOKEN_AUTH",{sourceFile:rd,functionName:n}),t.info("Refreshing auth token...",{sourceFile:rd,functionName:n});const i=new L_({ClientId:gh,AuthFlow:"REFRESH_TOKEN_AUTH",AuthParameters:{REFRESH_TOKEN:r.refresh_token}}),d=(await s.send(i)).AuthenticationResult;if(!d)throw new Error("AuthenticationResult is missing in the response.");const{IdToken:m,AccessToken:p,RefreshToken:v,ExpiresIn:x,TokenType:b}=d;if(!m||!p||!x||!b)throw new Error("Missing required fields in AuthenticationResult.");const S={id_token:m,access_token:p,refresh_token:v||r.refresh_token,expires_in:x,token_type:b,fetched_at:e};return await z_(S),S}catch(i){throw t.error("Error refreshing auth token",i,{sourceFile:rd,functionName:n}),new Error("Failed to refresh authentication token.")}}async function TU(r){const e="handleLoginFlow";try{r.info("Starting OAuth flow in popup...",{sourceFile:rd,functionName:e});const t=VN(Tw);r.info("Auth URL",{sourceFile:rd,functionName:e,authUrl:t});const n=await chrome.identity.launchWebAuthFlow({url:t,interactive:!0});if(!n)throw new Error("Authentication was cancelled or failed");const i=new URL(n).searchParams.get("code");if(!i)throw new Error("No authorization code received");const c={grant_type:"authorization_code",code:i,redirect_uri:Tw,client_id:gh},d=await fetch(qN,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(c).toString()});if(!d.ok)throw new Error(`Token exchange failed: ${d.statusText}`);const m=await d.json();if(!r2(m))throw new Error("Invalid token response format");const p={...m,fetched_at:Math.floor(Date.now())};return await z_(p),{success:!0}}catch(t){return r.error("Authentication failed",t,{sourceFile:rd,functionName:e}),{success:!1,error:t instanceof Error?t.message:"Unknown error occurred"}}}class AU{constructor(e){B(this,"logger");B(this,"authListeners",new Set);this.logger=e}async login(){try{const e=await TU(this.logger);if(!e.success)throw new Error(e.error||"Login failed");const t=await this.getToken();if(!t)throw new Error("Token not found after login");return this.notifyAuthListeners(!0),t}catch(e){throw this.logger.error("Login failed",e,{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"login"}),e}}async logout(){var e;try{if(await this.deleteToken(),this.notifyAuthListeners(!1),(e=chrome==null?void 0:chrome.runtime)!=null&&e.sendMessage)try{await chrome.runtime.sendMessage({type:"USER_LOGGED_OUT"})}catch(t){this.logger.warn("Could not send logout message",{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"logout",error:t})}}catch(t){throw this.logger.error("Logout failed",t,{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"logout"}),t}}async getToken(){try{return await CU()}catch(e){return this.logger.error("Error getting auth token",e,{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"getToken"}),null}}async saveToken(e){try{const t={...e,fetched_at:Math.floor(Date.now())};await z_(t)}catch(t){throw this.logger.error("Error saving auth token",t,{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"saveToken"}),t}}async deleteToken(){try{await kU()}catch(e){throw this.logger.error("Error deleting auth token",e,{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"deleteToken"}),e}}isTokenValid(e){if(!e||!e.expires_in)return!1;const t=e;return t.fetched_at?Math.floor(Date.now())+6e4-t.fetched_at<t.expires_in*1e3:!1}async refreshToken(e){try{const t=e,n=Math.floor(Date.now())+6e4;return await NU(t,n,this.logger)}catch(t){throw this.logger.error("Error refreshing auth token",t,{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"refreshToken"}),t}}async isAuthenticated(){try{const e=await this.getToken();if(this.logger.debug("Checking authentication status",{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"isAuthenticated",token:e}),!e)return this.logger.debug("No token found - user is not authenticated",{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"isAuthenticated"}),!1;const t=this.isTokenValid(e);if(this.logger.debug("Authentication status checked",{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"isAuthenticated",isValid:t,token:e}),!t){this.logger.debug("Token is not valid - user is not authenticated",{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"isAuthenticated"});const n=await this.refreshToken(e);return this.logger.debug("Refreshed token",{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"isAuthenticated",refreshedToken:n}),this.isTokenValid(n)}return this.logger.debug("Token is valid - user is authenticated",{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"isAuthenticated"}),!0}catch(e){return this.logger.error("Error checking authentication status",e,{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"isAuthenticated"}),!1}}onAuthStateChanged(e){this.authListeners.add(e)}removeAuthStateListener(e){this.authListeners.delete(e)}notifyAuthListeners(e){this.logger.info("Notifying auth listeners",{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"notifyAuthListeners",isAuthenticated:e}),this.authListeners.forEach(t=>{try{t(e)}catch(n){this.logger.error("Error in auth state callback",n,{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"notifyAuthListeners"})}})}}class RU{constructor(e){B(this,"logger");B(this,"messageListeners",new Set);this.logger=e,this.setupMessageListeners()}setupMessageListeners(){var e;(e=chrome==null?void 0:chrome.runtime)!=null&&e.onMessage&&chrome.runtime.onMessage.addListener((t,n,s)=>{this.messageListeners.forEach(i=>{try{i(t)}catch(c){this.logger.error("Error in message callback",c,{sourceFile:"src/platforms/chrome/ChromeMessagingProvider.ts",sourceFunction:"setupMessageListeners"})}})})}async sendMessage(e){return new Promise((t,n)=>{var s;if(!((s=chrome==null?void 0:chrome.runtime)!=null&&s.sendMessage)){n(new Error("Chrome runtime not available"));return}chrome.runtime.sendMessage(e,i=>{var c;chrome.runtime.lastError?(this.logger.error("Error sending message",chrome.runtime.lastError,{sourceFile:"src/platforms/chrome/ChromeMessagingProvider.ts",sourceFunction:"sendMessage",message:e}),n(new Error(((c=chrome.runtime.lastError)==null?void 0:c.message)||"Unknown error"))):t(i)})})}onMessage(e){var n;const t=s=>{e(s)};this.messageListeners.add(t),(n=chrome==null?void 0:chrome.runtime)!=null&&n.onMessage&&chrome.runtime.onMessage.addListener(t)}removeMessageListener(e){this.messageListeners.forEach(t=>{var n;(n=chrome==null?void 0:chrome.runtime)!=null&&n.onMessage&&chrome.runtime.onMessage.removeListener(t)}),this.messageListeners.clear()}async sendTabMessage(e,t){return new Promise((n,s)=>{var i;if(!((i=chrome==null?void 0:chrome.tabs)!=null&&i.sendMessage)){s(new Error("Chrome tabs API not available"));return}chrome.tabs.sendMessage(e,t,c=>{var d;chrome.runtime.lastError?(this.logger.error("Error sending tab message",chrome.runtime.lastError,{sourceFile:"src/platforms/chrome/ChromeMessagingProvider.ts",sourceFunction:"sendTabMessage",message:t}),s(new Error(((d=chrome.runtime.lastError)==null?void 0:d.message)||"Unknown error"))):n(c)})})}}class IU{constructor(e){B(this,"logger");B(this,"eventListeners",new Map);B(this,"isInitialized",!1);this.logger=e}async initialize(){if(this.isInitialized){this.logger.info("Chrome platform already initialized",{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"initialize"});return}try{this.logger.info("Initializing Chrome platform...",{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"initialize"}),this.setupChromeEventListeners(),this.isInitialized=!0,this.logger.info("Chrome platform initialized successfully",{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"initialize"})}catch(e){throw this.logger.error("Failed to initialize Chrome platform",e,{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"initialize"}),e}}async cleanup(){try{this.logger.info("Cleaning up Chrome platform...",{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"cleanup"}),this.eventListeners.clear(),this.isInitialized=!1,this.logger.info("Chrome platform cleanup completed",{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"cleanup"})}catch(e){throw this.logger.error("Failed to cleanup Chrome platform",e,{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"cleanup"}),e}}async closeWindow(){try{typeof chrome<"u"&&chrome.sidePanel&&window.close(),this.logger.debug("Window close requested",{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"closeWindow"})}catch(e){throw this.logger.error("Failed to close window",e,{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"closeWindow"}),e}}onPlatformEvent(e,t){var n,s;switch(e){case"runtime.onInstalled":(n=chrome==null?void 0:chrome.runtime)!=null&&n.onInstalled&&chrome.runtime.onInstalled.addListener(t);break;case"runtime.onStartup":(s=chrome==null?void 0:chrome.runtime)!=null&&s.onStartup&&chrome.runtime.onStartup.addListener(t);break;default:this.logger.warn("Unknown platform event",{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"onPlatformEvent",event:e})}}setupChromeEventListeners(){var e,t,n;(e=chrome==null?void 0:chrome.runtime)!=null&&e.onStartup&&chrome.runtime.onStartup.addListener(()=>{this.emitPlatformEvent("startup")}),(t=chrome==null?void 0:chrome.runtime)!=null&&t.onSuspend&&chrome.runtime.onSuspend.addListener(()=>{this.emitPlatformEvent("suspend")}),(n=chrome==null?void 0:chrome.runtime)!=null&&n.onInstalled&&chrome.runtime.onInstalled.addListener(s=>{this.emitPlatformEvent("installed",s)})}emitPlatformEvent(e,...t){const n=this.eventListeners.get(e);n&&n.forEach(s=>{try{s(...t)}catch(i){this.logger.error(`Error in platform event callback for ${e}`,i,{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"emitPlatformEvent",event:e})}})}handleExtensionMessage(e,t,n){return this.logger.debug("Extension message received",{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"handleExtensionMessage",message:e,sender:t}),!0}handleContextMenuClick(e,t){this.logger.debug("Context menu clicked",{sourceFile:"src/platforms/chrome/ChromeLifecycleProvider.ts",sourceFunction:"handleContextMenuClick",info:e,tab:t})}}const Oi=async r=>{try{return(await Kn.createServices()).storage}catch(e){return r.warn("Platform detection failed, falling back to Chrome storage",{sourceFile:"src/shared/lib/utils/storageUtils.tsx",error:e}),null}},PU=async r=>{const e=await Oi(r);e&&await e.clearLocal()},FU=async(r,e)=>{try{const t=await Kn.createServices();if(Kn.getCurrentPlatform()==="outlook"){r.debug("Token saving handled by OutlookAuthProvider",{sourceFile:"src/shared/lib/utils/storageUtils.tsx",sourceFunction:"saveAuthTokenPlatform"});return}const n=t.storage;n&&await n.setLocalItem("token",e)}catch(t){throw r.error("Failed to save auth token",t,{sourceFile:"src/shared/lib/utils/storageUtils.tsx",sourceFunction:"saveAuthTokenPlatform"}),t}},Om=async r=>{try{const e=await Kn.createServices();if(Kn.getCurrentPlatform()==="outlook"){const n=await e.auth.getToken();return n?(r.info("Auth token retrieved from auth provider",{sourceFile:"src/shared/lib/utils/storageUtils.tsx",sourceFunction:"getAuthTokenPlatform",authToken:n}),n):null}const t=e.storage;return t?await t.getLocalItem("token"):null}catch(e){return r.error("Failed to get auth token",e,{sourceFile:"src/shared/lib/utils/storageUtils.tsx",sourceFunction:"getAuthTokenPlatform"}),null}},zy=async r=>{try{const e=await Kn.createServices();if(Kn.getCurrentPlatform()==="outlook"){await e.auth.logout();return}const t=e.storage;t&&await t.removeLocalItem("token")}catch(e){r.error("Failed to delete auth token",e,{sourceFile:"src/shared/lib/utils/storageUtils.tsx",sourceFunction:"deleteAuthTokenPlatform"})}},eT=async(r,e)=>{const t=await Oi(r);if(t){const n={...e};(!n.id||n.id==="")&&(n.id=String(Date.now())),await t.setLocalItem("configuration",n)}},iy=async r=>{const e=await Oi(r);return e?await e.getLocalItem("configuration")||{id:"",preferences:{theme:"",notificationsEnabled:!1,language:""},profile:{name:"",organization:"",role:""},templateConfiguration:{tags:[],fieldSubstitutions:{}},integrations:[]}:{id:"",preferences:{theme:"",notificationsEnabled:!1,language:""},profile:{name:"",organization:"",role:""},templateConfiguration:{tags:[],fieldSubstitutions:{}},integrations:[]}},jU=async(r,e)=>{const t=await Oi(r);t&&await t.setLocalItem("emailTemplates",e)},tT=async r=>{const e=await Oi(r);return e?await e.getLocalItem("emailTemplates")||[]:[]},Ym=async(r,e)=>{const t=await Oi(r);t&&await t.setLocalItem("integrations",e)},Jm=async r=>{const e=await Oi(r);return e?await e.getLocalItem("integrations")||[]:[]},OU=async(r,e)=>{const t=await Oi(r);t&&await t.setLocalItem("orgTemplates",e)},rT=async r=>{const e=await Oi(r);return e?await e.getLocalItem("orgTemplates")||[]:[]},DU=async(r,e)=>{const t=await Oi(r);if(t){const n=new Date().toISOString();await t.setLocalItem("gmailConnectionStatus",e),await t.setLocalItem("gmailConnectionStatusTimestamp",n),r.debug("Saved Gmail connection status to storage",{sourceFile:"src/shared/lib/utils/storageUtils.tsx",isConnected:e,timestamp:n})}},LU=async r=>{const e=await Oi(r);if(e){const t=await e.getLocalItem("gmailConnectionStatus"),n=await e.getLocalItem("gmailConnectionStatusTimestamp");return r.debug("Retrieved Gmail connection status from storage",{sourceFile:"src/shared/lib/utils/storageUtils.tsx",isConnected:t,timestamp:n}),{isConnected:t,timestamp:n}}return{isConnected:null,timestamp:null}},nT=async r=>{const e=await Oi(r);e&&(await e.removeLocalItem("clients"),await e.removeLocalItem("integrations"))},lo="src/lib/utils/authUtils.tsx";async function sT(r,e,t,n){const s="withLock";if(r.current)return n.info(`${t} already in progress, waiting for completion...`,{sourceFile:lo,functionName:s}),await r.current;r.current=e();try{return await r.current}finally{r.current=null}}const MU={current:null};async function Rw(r){return sT(MU,()=>$U(r),"Token validation",r)}async function $U(r){const e="performTokenValidation";let t=await Om(r);if(!t)throw new Error("No authentication token found.");const n=Math.floor(Date.now()),s=t.expires_in*1e3+(t.fetched_at||0);if(r.info("Token expiry check",{sourceFile:lo,functionName:e,tokenExpiry:new Date(s).toISOString(),currentTime:new Date(n).toISOString(),timeUntilExpiry:s-n}),s-n<3e5)try{r.info("Token expired. Refreshing...",{sourceFile:lo,functionName:e}),t=await oT(t,n,r),r.info("New token received",{sourceFile:lo,functionName:e})}catch(i){throw r.error("Token refresh failed",i,{sourceFile:lo,functionName:e}),await zy(r),new Error("Unauthorized: Failed to refresh token.")}return t}const Ex=20,UU=500;function zU(r){return new Promise(e=>setTimeout(e,r))}function HU(r){var s;const e=r,t=(s=e==null?void 0:e.$metadata)==null?void 0:s.httpStatusCode;if(typeof t=="number")return t>=500||t===429||t===408;const n=["TimeoutError","NetworkError"];return typeof(e==null?void 0:e.name)=="string"&&n.includes(e.name),!0}async function oT(r,e,t){const n="refreshAuthToken",s=new Ob({region:"us-east-1"});for(let i=1;i<=Ex;i++)try{t.info(`Refreshing auth token (attempt ${i})...`,{sourceFile:lo,functionName:n});const c=new L_({ClientId:gh,AuthFlow:"REFRESH_TOKEN_AUTH",AuthParameters:{REFRESH_TOKEN:r.refresh_token}}),m=(await s.send(c)).AuthenticationResult;if(!m)throw new Error("AuthenticationResult is missing in the response.");const{IdToken:p,AccessToken:v,RefreshToken:x,ExpiresIn:b,TokenType:S}=m;if(!p||!v||!b||!S)throw new Error("Missing required fields in AuthenticationResult.");const N={id_token:p,access_token:v,refresh_token:x||r.refresh_token,expires_in:b,token_type:S,fetched_at:e};return await FU(t,N),N}catch(c){const d=HU(c);if(t.error(`Error refreshing auth token (attempt ${i}/${Ex})`,c,{sourceFile:lo,functionName:n,isTransient:d}),!d||i===Ex)throw await zy(t),new Error("Failed to refresh authentication token.");const m=UU*2**(i-1);t.warn(`Transient error refreshing token  retrying in ${m}ms`,{sourceFile:lo,functionName:n,attempt:i}),await zU(m)}throw new Error("Failed to refresh authentication token.")}const BU={current:null};async function GU(r){return sT(BU,()=>WU(r),"Force token refresh",r)}async function WU(r){const e="performForceTokenRefresh",t=await Om(r);if(!t)throw new Error("No authentication token found.");const n=Math.floor(Date.now());r.info("Force refreshing token before opening options page",{sourceFile:lo,functionName:e,currentTime:new Date(n).toISOString()});const s=await oT(t,n,r);return r.info("Token force refresh successful",{sourceFile:lo,functionName:e}),s}async function Xr(r,e={},t){const n="fetchWithAuth",s=Date.now(),i=Date.now();let c=await Rw(t);const d=Date.now()-i;e.headers={...e.headers,Authorization:`${c.id_token}`};const m=Date.now(),p=await fetch(r,e),v=Date.now()-m;if(t.info("fetchWithAuth completed",{sourceFile:lo,functionName:n,url:r.pathname,status:p.status,tokenValidationMs:d,networkFetchMs:v,totalMs:Date.now()-s}),p.status===401)try{t.info("Received 401, getting fresh token...",{sourceFile:lo,functionName:n});const x=Date.now();c=await Rw(t);const b=Date.now()-x;t.info("New token received for retry",{sourceFile:lo,functionName:n,retryTokenMs:b}),e.headers&&typeof e.headers=="object"&&!Array.isArray(e.headers)&&(e.headers.Authorization=`${c.id_token}`);const S=Date.now(),N=await fetch(r,e),E=Date.now()-S;return t.info("fetchWithAuth retry completed",{sourceFile:lo,functionName:n,url:r.pathname,status:N.status,retryTokenMs:b,retryFetchMs:E,totalMs:Date.now()-s}),N}catch(x){throw t.error("Token refresh failed",x,{sourceFile:lo,functionName:n}),await zy(t),new Error("Unauthorized: Failed to refresh token.")}return p}class VU{constructor(e){B(this,"logger");this.logger=e}getResourceURL(e){return chrome.runtime.getURL(e)}async queryTabs(e={}){return new Promise(t=>{chrome.tabs.query(e,n=>{t(n.map(s=>({id:s.id,url:s.url,active:s.active})))})})}async updateTab(e,t){return new Promise(n=>{chrome.tabs.update(e,t,()=>{n()})})}async reloadTab(e){return new Promise(t=>{chrome.tabs.reload(e,void 0,()=>{t()})})}async openOptionsPage(){return new Promise(async e=>{try{const t=await GU(this.logger);let n=Zf;t!=null&&t.id_token&&(n+=`?token=${encodeURIComponent(t.id_token)}`),this.logger.info("Opening external options page",{sourceFile:"src/platforms/chrome/ChromeTabsProvider.ts",functionName:"openOptionsPage",url:Zf,hasToken:!!(t!=null&&t.id_token)}),chrome.tabs.create({url:n},()=>{e()})}catch(t){this.logger.error("Failed to open options page",t,{sourceFile:"src/platforms/chrome/ChromeTabsProvider.ts",functionName:"openOptionsPage"}),chrome.tabs.create({url:Zf},()=>{e()})}})}async openURL(e,t="_blank"){return new Promise(n=>{t==="_blank"?chrome.tabs.create({url:e},()=>{n()}):(window.open(e,t),n())})}}function Wv(r){const t=new DOMParser().parseFromString(r,"text/html"),n={white:"#ffffff",black:"#000000",red:"#e60000",orange:"#f90",yellow:"#ff0",green:"#008a00",blue:"#06c",purple:"#93f"};t.querySelectorAll("[class]").forEach(p=>{const v=p.classList,x={},b=[],S=p.getAttribute("style");S&&S.split(";").forEach(E=>{const[T,A]=E.split(":").map(R=>R.trim());T&&A&&(x[T]=A)});for(const E of["left","center","right","justify"]){const T=`ql-align-${E}`;if(v.contains(T)){const A=p.tagName.toLowerCase();A==="li"?E==="center"?(x["text-align"]="center",x["list-style-position"]="inside"):E==="right"?(x["text-align"]="right",x["list-style-position"]="inside"):E==="left"?x["text-align"]="left":E==="justify"&&(x["text-align"]="justify"):A==="ol"||A==="ul"?E==="center"?(x["margin-left"]="auto",x["margin-right"]="auto",x["padding-left"]="40px",x.width="fit-content"):E==="right"?(x["margin-left"]="auto",x["margin-right"]="0",x["padding-left"]="40px",x.width="fit-content"):E==="left"&&(x["margin-left"]="0",x["margin-right"]="auto"):x["text-align"]=E,b.push(T)}}v.contains("ql-font-serif")&&(x["font-family"]="Georgia, Times New Roman, serif",b.push("ql-font-serif")),v.contains("ql-font-monospace")&&(x["font-family"]="Monaco, Courier New, monospace",b.push("ql-font-monospace"));const N={"ql-size-small":"0.75em","ql-size-large":"1.5em","ql-size-huge":"2.5em"};for(const[E,T]of Object.entries(N))v.contains(E)&&(x["font-size"]=T,b.push(E));for(const[E,T]of Object.entries(n)){const A=`ql-color-${E}`;v.contains(A)&&(x.color=T,b.push(A))}for(const[E,T]of Object.entries(n)){const A=`ql-bg-${E}`;v.contains(A)&&(x["background-color"]=T,b.push(A))}if(Object.keys(x).length>0){const E=Object.entries(x).map(([T,A])=>`${T}: ${A}`).join("; ");p.setAttribute("style",E)}b.forEach(E=>{v.remove(E)}),v.length===0&&p.removeAttribute("class")});const i=t.createTreeWalker(t.body,NodeFilter.SHOW_TEXT,null),c=[];let d;for(;d=i.nextNode();)if(d.nodeValue&&d.nodeValue.includes("	")){const p=d.nodeValue.replace(/\t/g,"");c.push({node:d,newValue:p})}return c.forEach(({node:p,newValue:v})=>{p.nodeValue=v}),t.querySelectorAll("ul, ol").forEach(p=>{var S,N;const v=Array.from(p.children);if(v.length===0)return;const x=v.some(E=>E.getAttribute("data-list")==="bullet"),b=v.some(E=>E.getAttribute("data-list")==="ordered");if(x&&b){const E=t.createDocumentFragment();let T=null,A=null;v.forEach(R=>{const F=R.getAttribute("data-list")||"bullet";if(A!==F||!T){T=t.createElement(F==="ordered"?"ol":"ul");const j=p.getAttribute("style");j&&T.setAttribute("style",j);const L=p.getAttribute("class");L&&T.setAttribute("class",L),E.appendChild(T),A=F}T.appendChild(R.cloneNode(!0))}),(S=p.parentNode)==null||S.replaceChild(E,p)}else if(b&&p.tagName.toLowerCase()==="ul"){const E=t.createElement("ol");for(Array.from(p.attributes).forEach(T=>{E.setAttribute(T.name,T.value)});p.firstChild;)E.appendChild(p.firstChild);(N=p.parentNode)==null||N.replaceChild(E,p)}}),t.body.innerHTML}class qU{constructor(e){B(this,"logger");this.logger=e}async executeScript(e){var t;try{return(t=(await chrome.scripting.executeScript({target:e.target,func:e.func,args:e.args}))[0])==null?void 0:t.result}catch(n){throw this.logger.error("Error executing script",n,{sourceFile:"src/platforms/chrome/ChromeContentScriptProvider.ts",sourceFunction:"executeScript"}),n}}async insertContentIntoComposeBox(e){try{const t=Wv(e),s=(await chrome.tabs.query({active:!0,currentWindow:!0}))[0];if(!(s!=null&&s.id))throw new Error("No active tab found or tab ID is undefined");await chrome.scripting.executeScript({target:{tabId:s.id},func:i=>{function c(){return document.querySelector('div[role="textbox"][aria-label="Message Body"]')||document.querySelector('div[aria-label="Message body, press Alt+F10 to exit"]')}function d(x){var E;const b=window.getSelection();let S=null,N=0;if(b&&b.rangeCount>0&&(S=b.getRangeAt(0).cloneRange(),x.contains(S.startContainer)||x===S.startContainer)){const T=document.createTreeWalker(x,NodeFilter.SHOW_TEXT,null,!1);let A=0,R;for(;R=T.nextNode();)if(R===S.startContainer){A+=S.startOffset;break}else A+=((E=R.textContent)==null?void 0:E.length)||0;N=A}return{selection:b,range:S,offset:N}}function m(x,b){var S;try{const{selection:N,range:E,offset:T}=b;if(!N)return;if(E&&x.contains(E.startContainer)){N.removeAllRanges(),N.addRange(E);return}if(T>0){const R=document.createTreeWalker(x,NodeFilter.SHOW_TEXT,null,!1);let F=0,j;for(;j=R.nextNode();){const L=((S=j.textContent)==null?void 0:S.length)||0;if(F+L>=T){const G=document.createRange();G.setStart(j,T-F),G.collapse(!0),N.removeAllRanges(),N.addRange(G);return}F+=L}}const A=document.createRange();A.selectNodeContents(x),A.collapse(!1),N.removeAllRanges(),N.addRange(A)}catch(N){console.warn("Could not restore cursor position:",N)}}function p(x,b){document.execCommand("insertHTML",!1,b)}const v=c();if(!v)throw new Error("Compose box not found");try{const x=d(v);v.focus(),m(v,x),navigator.clipboard&&navigator.clipboard.writeText?navigator.clipboard.writeText(i).then(()=>{document.execCommand("paste")}).catch(()=>{p(v,i)}):p(v,i)}catch(x){throw new Error("Error during paste operation: "+x)}},args:[t]})}catch(t){throw this.logger.error("Error inserting content into compose box",t,{sourceFile:"src/platforms/chrome/ChromeContentScriptProvider.ts",sourceFunction:"insertContentIntoComposeBox"}),t}}}class KU{constructor(e){B(this,"logger");this.logger=e}async launchWebAuthFlow(e){try{const t=await chrome.identity.launchWebAuthFlow(e);if(!t)throw new Error("Authentication was cancelled or failed");return t}catch(t){throw this.logger.error("Error launching web auth flow",t,{sourceFile:"src/platforms/chrome/ChromeIdentityProvider.ts",sourceFunction:"launchWebAuthFlow"}),t}}async initiateOAuth(e,t){return this.launchWebAuthFlow({url:e,interactive:!0})}}const YU="CandleLogsDB",JU=1,nd="logs",XU=5e3,QU=500,sC={ERROR:1,WARN:2,INFO:3,DEBUG:4};let zp=null;function Iw(){return zp||(zp=new Promise((r,e)=>{console.log("[Logger] Initializing IndexedDB...");const t=indexedDB.open(YU,JU);t.onupgradeneeded=n=>{console.log("[Logger] IndexedDB upgrade needed.");const s=n.target.result;if(!s.objectStoreNames.contains(nd)){console.log(`[Logger] Creating object store: ${nd}`);const i=s.createObjectStore(nd,{keyPath:"id",autoIncrement:!0});console.log("[Logger] Creating indexes: timestamp, level, chromeContext"),i.createIndex("timestamp","timestamp",{unique:!1}),i.createIndex("level","level",{unique:!1}),i.createIndex("chromeContext","chromeContext",{unique:!1})}},t.onsuccess=n=>{console.log("[Logger] IndexedDB initialized successfully."),r(n.target.result)},t.onerror=n=>{console.error("[Logger] IndexedDB initialization failed:",n.target.error),zp=null,e(n.target.error)},t.onblocked=()=>{console.warn("[Logger] IndexedDB initialization blocked. Close other tabs using the database.")}}),zp)}Iw().catch(r=>console.error("[Logger] Initial DB connection failed:",r));const ti=class ti{constructor(e){B(this,"context");B(this,"minLevel","INFO");this.context=e||"unknown"}async writeLog(e,t,n,s){if(sC[e]>sC[this.minLevel])return;const i=(n==null?void 0:n.sourceFile)||"unknown",c=n==null?void 0:n.sourceFunction;let d;s&&(s instanceof Error?d={name:s.name,message:s.message,stack:s.stack}:d=s);const{sourceFile:m,sourceFunction:p,...v}=n||{},x={...d?{error:d}:{},...v};{const N=[`[${e}] [${this.context}] [${i}${c?` (${c})`:""}]: ${t}`];switch(s&&N.push(s),Object.keys(v).length>0&&N.push(v),e){case"DEBUG":console.debug(...N);break;case"INFO":console.info(...N);break;case"WARN":console.warn(...N);break;case"ERROR":console.error(...N);break}}const b={timestamp:new Date().toISOString(),level:e,message:t,chromeContext:this.context,sourceFile:i,...c&&{sourceFunction:c},details:Object.keys(x).length>0?x:void 0};try{const N=(await Iw()).transaction(nd,"readwrite"),T=N.objectStore(nd).add(b);return new Promise((A,R)=>{T.onsuccess=()=>{A()},T.onerror=F=>{console.error("[Logger] Failed to write log to IndexedDB:",F.target.error,b),R(F.target.error)},N.onerror=F=>{console.error("[Logger] Transaction error writing log:",F.target.error,b),R(F.target.error)},N.onabort=F=>{console.warn("[Logger] Transaction aborted writing log:",F.target.error,b),R(new Error("Transaction aborted"))}})}catch(S){throw console.error("[Logger] Error obtaining DB or starting transaction:",S,b),S}}static async _cleanupOldLogs(){if(this._isCleaning){console.info("[Logger] Cleanup already in progress, skipping.");return}console.info("[Logger] Starting log cleanup check..."),this._isCleaning=!0;try{const t=(await Iw()).transaction(nd,"readwrite"),n=t.objectStore(nd),s=n.count(),i=await new Promise((p,v)=>{s.onsuccess=()=>p(s.result),s.onerror=x=>{console.error("[Logger] Failed to count logs for cleanup:",x.target.error),v(x.target.error)}});if(i<=this.MAX_LOG_ENTRIES){console.info(`[Logger] Log count (${i}) within limit (${this.MAX_LOG_ENTRIES}). No cleanup needed.`);return}let c=i-this.MAX_LOG_ENTRIES;console.warn(`[Logger] Log count (${i}) exceeds limit (${this.MAX_LOG_ENTRIES}). Deleting ${c} oldest logs.`);const d=n.openCursor();let m=0;await new Promise((p,v)=>{d.onsuccess=x=>{const b=x.target.result;if(b&&c>0){const S=b.delete();S.onsuccess=()=>{m++,c--,c>0?b.continue():p()},S.onerror=N=>{console.error("[Logger] Error deleting log entry during cleanup:",N.target.error,"Key:",b.primaryKey),b.continue()}}else p()},d.onerror=x=>{console.error("[Logger] Error opening cursor for cleanup:",x.target.error),v(x.target.error)}}),await new Promise((p,v)=>{t.oncomplete=()=>{console.info(`[Logger] Log cleanup finished. Deleted ${m} entries.`),p()},t.onerror=x=>{console.error("[Logger] Transaction error during cleanup:",x.target.error),v(x.target.error)},t.onabort=x=>{console.warn("[Logger] Transaction aborted during cleanup:",x.target.error),v(new Error("Cleanup transaction aborted"))}})}catch(e){console.error("[Logger] Error during log cleanup process:",e)}finally{this._isCleaning=!1,console.info("[Logger] Log cleanup check finished.")}}_triggerCleanupCheck(){if(ti._writeCount++,ti._writeCount>=ti.CLEANUP_TRIGGER_COUNT&&!ti._isCleaning){const e=ti._writeCount;ti._writeCount=0,console.info(`[Logger] Write count reached ${e}. Triggering background cleanup.`),ti._cleanupOldLogs().catch(t=>{console.error("[Logger] Background cleanup process failed:",t)})}}async debug(e,t){try{await this.writeLog("DEBUG",e,t),this._triggerCleanupCheck()}catch{}}async info(e,t){try{await this.writeLog("INFO",e,t),this._triggerCleanupCheck()}catch{}}async warn(e,t){try{await this.writeLog("WARN",e,t),this._triggerCleanupCheck()}catch{}}async error(e,t,n){try{await this.writeLog("ERROR",e,n,t),this._triggerCleanupCheck()}catch{}}};B(ti,"_writeCount",0),B(ti,"_isCleaning",!1),B(ti,"MAX_LOG_ENTRIES",XU),B(ti,"CLEANUP_TRIGGER_COUNT",QU);let Pw=ti;class ZU{constructor(e){B(this,"logger");this.logger=new Pw(e)}async debug(e,t){return this.logger.debug(e,t)}async info(e,t){return this.logger.info(e,t)}async warn(e,t){return this.logger.warn(e,t)}async error(e,t,n){return this.logger.error(e,t,n)}setMinLevel(e){console.warn("[ChromeLoggingProvider] setMinLevel not yet implemented - using hardcoded INFO level")}getMinLevel(){return"INFO"}}function e5(r="unknown"){const e=new ZU(r==="background"?"background":"options");return{storage:new JO(e),data:new XO(e),auth:new AU(e),messaging:new RU(e),lifecycle:new IU(e),tabs:new VU(e),contentScript:new qU(e),identity:new KU(e),logging:e}}class t5{constructor(e){B(this,"logger");B(this,"_changeListeners",[]);B(this,"onChanged",e=>{this.logger.warn("onChanged listener not fully supported with Office roaming settings. Callbacks will be stored but not automatically invoked.",{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"onChanged"}),this._changeListeners.push(e)});B(this,"removeChangeListener",e=>{this.logger.warn("removeChangeListener not fully supported with Office roaming settings.",{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"removeChangeListener"}),this._changeListeners=this._changeListeners.filter(t=>t!==e)});this.logger=e}async getLocalItem(e){var t;try{if(typeof localStorage<"u"){const n=localStorage.getItem(e);if(n){const s=JSON.parse(n);return this.logger.debug(`Retrieved local item with key: ${e}`,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"getLocalItem"}),s}}else if((t=Office==null?void 0:Office.context)!=null&&t.roamingSettings){const n=Office.context.roamingSettings.get(e);if(n){const s=JSON.parse(n);return this.logger.debug(`Retrieved item from roaming settings with key: ${e}`,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"getLocalItem"}),s}}return null}catch(n){return this.logger.error(`Error retrieving local item with key: ${e}`,n,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"getLocalItem"}),null}}async setLocalItem(e,t){var n;try{if(typeof localStorage<"u")localStorage.setItem(e,JSON.stringify(t)),this.logger.debug(`Stored local item with key: ${e}`,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"setLocalItem"}),this._notifyChangeListeners({[e]:{newValue:t}});else if((n=Office==null?void 0:Office.context)!=null&&n.roamingSettings)Office.context.roamingSettings.set(e,JSON.stringify(t)),await new Promise((s,i)=>{Office.context.roamingSettings.saveAsync(c=>{var d;c.status===Office.AsyncResultStatus.Succeeded?(this.logger.debug(`Stored item in roaming settings with key: ${e}`,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"setLocalItem"}),s()):i(new Error(((d=c.error)==null?void 0:d.message)||"Failed to save roaming settings"))})}),this._notifyChangeListeners({[e]:{newValue:t}});else throw new Error("No storage mechanism available")}catch(s){throw this.logger.error(`Error storing local item with key: ${e}`,s,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"setLocalItem"}),s}}async removeLocalItem(e){var t;try{const n=await this.getLocalItem(e);if(typeof localStorage<"u")localStorage.removeItem(e),this.logger.debug(`Removed local item with key: ${e}`,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"removeLocalItem"}),this._notifyChangeListeners({[e]:{oldValue:n,newValue:void 0}});else if((t=Office==null?void 0:Office.context)!=null&&t.roamingSettings)Office.context.roamingSettings.remove(e),await new Promise((s,i)=>{Office.context.roamingSettings.saveAsync(c=>{var d;c.status===Office.AsyncResultStatus.Succeeded?(this.logger.debug(`Removed item from roaming settings with key: ${e}`,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"removeLocalItem"}),s()):i(new Error(((d=c.error)==null?void 0:d.message)||"Failed to save roaming settings"))})}),this._notifyChangeListeners({[e]:{oldValue:n,newValue:void 0}});else throw new Error("No storage mechanism available")}catch(n){throw this.logger.error(`Error removing local item with key: ${e}`,n,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"removeLocalItem"}),n}}async clearLocal(){var e;try{if(typeof localStorage<"u")localStorage.clear(),this.logger.info("Cleared local storage",{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"clearLocal"}),this._notifyChangeListeners({});else if((e=Office==null?void 0:Office.context)!=null&&e.roamingSettings){const t=await this.getAllKeys(),n={};for(const s of t){const i=await this.getLocalItem(s);Office.context.roamingSettings.remove(s),n[s]={oldValue:i,newValue:void 0}}await new Promise((s,i)=>{Office.context.roamingSettings.saveAsync(c=>{var d;c.status===Office.AsyncResultStatus.Succeeded?(this.logger.info("Cleared all roaming settings",{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"clearLocal"}),s()):i(new Error(((d=c.error)==null?void 0:d.message)||"Failed to save roaming settings"))})}),this._notifyChangeListeners(n)}else throw new Error("No storage mechanism available")}catch(t){throw this.logger.error("Error clearing local storage",t,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"clearLocal"}),t}}async getAllKeys(){var e;try{if(typeof localStorage<"u"){const t=Object.keys(localStorage);return this.logger.debug(`Retrieved ${t.length} keys from storage`,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"getAllKeys"}),t}else if((e=Office==null?void 0:Office.context)!=null&&e.roamingSettings)return this.logger.warn("getAllKeys not fully supported with Office roaming settings",{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"getAllKeys"}),[];return[]}catch(t){return this.logger.error("Error getting all keys",t,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"getAllKeys"}),[]}}_notifyChangeListeners(e){this._changeListeners.forEach(t=>{try{t(e)}catch(n){this.logger.error("Error in storage change callback",n,{sourceFile:"src/platforms/outlook/OutlookStorageProvider.ts",sourceFunction:"_notifyChangeListeners"})}})}}class r5{constructor(e){B(this,"logger");B(this,"threadListeners",new Set);B(this,"currentThread",null);B(this,"lastKnownThreadId");B(this,"debounceTimer",null);this.logger=e,this.initializeOutlookListeners()}initializeOutlookListeners(){var e,t,n,s;(t=(e=Office==null?void 0:Office.context)==null?void 0:e.mailbox)!=null&&t.addHandlerAsync&&Office.context.mailbox.addHandlerAsync(Office.EventType.ItemChanged,this.debouncedHandleItemChanged.bind(this)),(s=(n=Office==null?void 0:Office.context)==null?void 0:n.mailbox)!=null&&s.item&&setTimeout(()=>this.handleItemChanged(),100)}debouncedHandleItemChanged(){this.debounceTimer&&clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout(()=>{this.handleItemChanged(),this.debounceTimer=null},50)}async handleItemChanged(){var e,t;try{const n=await this.getCurrentThread(),s=n==null?void 0:n.threadId,i=s!==((e=this.currentThread)==null?void 0:e.threadId);if(n&&this.currentThread&&!i){const c=JSON.stringify(this.currentThread.participants.sort()),d=JSON.stringify(n.participants.sort());if(c===d)return}i||!this.currentThread&&n?(this.logger.info("Thread changed or initialized",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"handleItemChanged",oldThreadId:(t=this.currentThread)==null?void 0:t.threadId,newThreadId:s}),this.currentThread=n,this.lastKnownThreadId=s,this.notifyThreadListeners(n)):n&&this.currentThread?this.hasThreadContentChanged(this.currentThread,n)?(this.logger.info("Thread content updated",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"handleItemChanged",threadId:s}),this.currentThread=n,this.notifyThreadListeners(n)):this.currentThread=n:this.logger.info("No meaningful thread change detected",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"handleItemChanged",hasNewThread:!!n,hasCurrentThread:!!this.currentThread})}catch(n){this.logger.error("Error handling item change",n,{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"handleItemChanged"})}}hasThreadContentChanged(e,t){var i,c;if(e.subject!==t.subject)return!0;if(e.messages.length!==t.messages.length)return t.messages.length>e.messages.length;const n=new Set(e.participants),s=new Set(t.participants);if(n.size!==s.size)return!0;for(const d of n)if(!s.has(d))return!0;for(let d=0;d<Math.min(e.messages.length,t.messages.length);d++){const m=e.messages[d],p=t.messages[d],v=((i=m.body)==null?void 0:i.trim())||"",x=((c=p.body)==null?void 0:c.trim())||"";if(v!==x&&v.length>0&&x.length>0||m.from!==p.from)return!0}return!1}shouldPreserveThreadHistory(e){var t,n,s;return!!(this.currentThread&&this.currentThread.threadId===e&&this.currentThread.messages.length>0&&((n=(t=Office==null?void 0:Office.context)==null?void 0:t.mailbox)!=null&&n.item)&&(Office.context.mailbox.item.itemType==="message"||(s=Office.context.mailbox.item.itemClass)!=null&&s.includes("IPM.Note")))}async getCurrentThread(){return new Promise(e=>{var t,n;if(!((n=(t=Office==null?void 0:Office.context)==null?void 0:t.mailbox)!=null&&n.item)){this.logger.info("No Office context or mailbox item available",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getCurrentThread"}),e(null);return}try{const s=Office.context.mailbox.item;this.logger.info("Getting current thread",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getCurrentThread",itemType:s.itemType,itemClass:s.itemClass,subject:s.subject,hasConversationId:!!s.conversationId,hasGetConversationIndexAsync:!!s.getConversationIndexAsync,hasCurrentThread:!!this.currentThread,lastKnownThreadId:this.lastKnownThreadId}),this.getThreadId(s).then(i=>{if(i)return this.getItemDetails(s,i);this.logger.warn("Could not determine thread ID",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getCurrentThread"}),e(null)}).then(i=>e(i||null)).catch(i=>{this.logger.error("Error getting current thread",i,{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getCurrentThread"}),e(null)})}catch(s){this.logger.error("Error in getCurrentThread",s,{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getCurrentThread"}),e(null)}})}normalizeSubject(e){return e?e.replace(/^((re|fw|fwd):\s*)+/i,"").trim():""}async getThreadId(e){return new Promise(t=>{if(e.conversationId){const n=e.conversationId;this.logger.info("Using conversationId as thread ID",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getThreadId",conversationId:n}),this.lastKnownThreadId=n,t(n);return}if(e.getConversationIndexAsync)e.getConversationIndexAsync(n=>{if(n.status===Office.AsyncResultStatus.Succeeded&&n.value)this.logger.info("Using conversation index as thread ID",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getThreadId",conversationIndex:n.value}),this.lastKnownThreadId=n.value,t(n.value);else{this.logger.info("getConversationIndexAsync failed, trying other methods",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getThreadId",error:n.error});const s=e.subject,i=this.currentThread?this.normalizeSubject(this.currentThread.subject):"",c=this.normalizeSubject(s);if(s&&this.currentThread&&i===c&&this.lastKnownThreadId){this.logger.info("Using cached thread ID based on normalized subject match (async failed)",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getThreadId",subject:s,cachedThreadId:this.lastKnownThreadId}),t(this.lastKnownThreadId);return}const d=e.itemId||this.lastKnownThreadId||"unknown";t(d)}});else{const n=e.subject,s=this.currentThread?this.normalizeSubject(this.currentThread.subject):"",i=this.normalizeSubject(n);if(n&&this.currentThread&&s===i&&this.lastKnownThreadId)this.logger.info("Using cached thread ID based on normalized subject match (no async method)",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getThreadId",subject:n,cachedThreadId:this.lastKnownThreadId}),t(this.lastKnownThreadId||null);else{const c=e.itemId||this.lastKnownThreadId||"unknown";this.logger.info("Using final fallback ID as thread ID",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getThreadId",fallbackId:c}),t(c)}}})}async getCurrentThreadId(){return new Promise(e=>{var n,s;if(!((s=(n=Office==null?void 0:Office.context)==null?void 0:n.mailbox)!=null&&s.item)){e(this.lastKnownThreadId||null);return}const t=Office.context.mailbox.item;this.getThreadId(t).then(e).catch(()=>e(this.lastKnownThreadId||null))})}onThreadChanged(e){this.threadListeners.add(e)}removeThreadListener(e){this.threadListeners.delete(e)}destroy(){this.debounceTimer&&(clearTimeout(this.debounceTimer),this.debounceTimer=null),this.threadListeners.clear()}notifyThreadListeners(e){this.threadListeners.forEach(t=>{try{t(e)}catch(n){this.logger.error("Error in thread change callback",n,{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"notifyThreadListeners"})}})}async getItemDetails(e,t){return new Promise(async n=>{var s;try{const i=e;let c="No Subject";if(typeof i.subject=="string")c=i.subject||"No Subject";else if(i.subject&&typeof i.subject.getAsync=="function")try{c=await new Promise((v,x)=>{i.subject.getAsync(b=>{b.status===Office.AsyncResultStatus.Succeeded?v(b.value):x(b.error)})})||"No Subject"}catch{}let d=this.extractParticipants(i);try{const p=await this.extractAsyncParticipants(i),v=new Set([...d,...p]);d=Array.from(v)}catch(p){this.logger.warn("Could not extract async participants",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getItemDetails",error:p})}const m={from:this.getFromAddress(i),timestamp:this.getTimestamp(i),subject:c,body:"",html:""};if(i.body&&i.body.getAsync)i.body.getAsync(Office.CoercionType.Html,p=>{var x;p.status===Office.AsyncResultStatus.Succeeded&&(m.html=p.value,m.body=this.stripHtml(p.value));const v=this.shouldPreserveThreadHistory(t)?[...((x=this.currentThread)==null?void 0:x.messages)||[],m]:[m];n({threadId:t,messages:v,subject:c,participants:d})});else{const p=this.shouldPreserveThreadHistory(t)?[...((s=this.currentThread)==null?void 0:s.messages)||[],m]:[m];n({threadId:t,messages:p,subject:c,participants:d})}}catch(i){this.logger.error("Error getting item details",i,{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getItemDetails",threadId:t}),n(null)}})}extractParticipants(e){const t=new Set;try{const n=this.getFromAddress(e);n&&n!=="Unknown"&&t.add(n),e.sender&&e.sender.emailAddress&&t.add(e.sender.emailAddress),e.to&&Array.isArray(e.to)&&e.to.forEach(s=>{s.emailAddress&&t.add(s.emailAddress)}),e.cc&&Array.isArray(e.cc)&&e.cc.forEach(s=>{s.emailAddress&&t.add(s.emailAddress)}),e.bcc&&Array.isArray(e.bcc)&&e.bcc.forEach(s=>{s.emailAddress&&t.add(s.emailAddress)})}catch(n){this.logger.warn("Error extracting participants",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"extractParticipants",error:n})}return Array.from(t)}async extractAsyncParticipants(e){const t=new Set;try{const n=[];e.to&&typeof e.to.getAsync=="function"&&n.push(this.getRecipientsAsync(e.to,"to")),e.cc&&typeof e.cc.getAsync=="function"&&n.push(this.getRecipientsAsync(e.cc,"cc")),e.bcc&&typeof e.bcc.getAsync=="function"&&n.push(this.getRecipientsAsync(e.bcc,"bcc")),(await Promise.allSettled(n)).forEach(i=>{i.status==="fulfilled"&&i.value.forEach(c=>t.add(c))})}catch(n){this.logger.warn("Error extracting async participants",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"extractAsyncParticipants",error:n})}return Array.from(t)}getRecipientsAsync(e,t){return new Promise(n=>{e.getAsync(s=>{if(s.status===Office.AsyncResultStatus.Succeeded){const i=s.value.map(c=>c.emailAddress).filter(c=>c);n(i)}else this.logger.warn(`Error getting ${t} recipients`,{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getRecipientsAsync",error:s.error}),n([])})})}getFromAddress(e){try{return e.from&&e.from.emailAddress?e.from.emailAddress:e.sender&&e.sender.emailAddress?e.sender.emailAddress:"Unknown"}catch(t){return this.logger.warn("Error getting from address",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getFromAddress",error:t}),"Unknown"}}getCurrentUserEmail(){var e,t,n;try{if((n=(t=(e=Office==null?void 0:Office.context)==null?void 0:e.mailbox)==null?void 0:t.userProfile)!=null&&n.emailAddress){const s=Office.context.mailbox.userProfile.emailAddress;return this.logger.info("Retrieved current user email from Outlook API",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getCurrentUserEmail",userEmail:s}),s}return this.logger.warn("userProfile.emailAddress not available",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getCurrentUserEmail"}),null}catch(s){return this.logger.error("Error getting current user email",s,{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getCurrentUserEmail"}),null}}getTimestamp(e){try{return e.dateTimeCreated?e.dateTimeCreated.toISOString():e.dateTimeModified?e.dateTimeModified.toISOString():new Date().toISOString()}catch(t){return this.logger.warn("Error getting timestamp",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"getTimestamp",error:t}),new Date().toISOString()}}stripHtml(e){try{return e.replace(/<[^>]*>/g,"").trim()}catch(t){return this.logger.warn("Error stripping HTML",{sourceFile:"src/platforms/outlook/OutlookDataProvider.ts",sourceFunction:"stripHtml",error:t}),e}}}const n5=async(r,e,t)=>({operation:pd(e).operation,region:await oa(r.region)()||(()=>{throw new Error("expected `region` to be configured for `aws.auth#sigv4`")})()});function s5(r){return{schemeId:"aws.auth#sigv4",signingProperties:{name:"cognito-identity",region:r.region},propertiesExtractor:(e,t)=>({signingProperties:{config:e,context:t}})}}function Sv(r){return{schemeId:"smithy.api#noAuth"}}const o5=r=>{const e=[];switch(r.operation){case"GetCredentialsForIdentity":{e.push(Sv());break}case"GetId":{e.push(Sv());break}case"GetOpenIdToken":{e.push(Sv());break}case"UnlinkIdentity":{e.push(Sv());break}default:e.push(s5(r))}return e},i5=r=>{const e=sN(r);return Object.assign(e,{authSchemePreference:oa(r.authSchemePreference??[])})},a5=r=>Object.assign(r,{useDualstackEndpoint:r.useDualstackEndpoint??!1,useFipsEndpoint:r.useFipsEndpoint??!1,defaultSigningName:"cognito-identity"}),l5="3.981.0",c5={version:l5},iT="required",zs="fn",Hs="argv",vh="ref",oC=!0,iC="isSet",Dm="booleanEquals",Lf="error",Ua="endpoint",Fl="tree",H_="PartitionResult",B_="getAttr",Hp="stringEquals",aC={[iT]:!1,type:"string"},lC={[iT]:!0,default:!1,type:"boolean"},cC={[vh]:"Endpoint"},aT={[zs]:Dm,[Hs]:[{[vh]:"UseFIPS"},!0]},lT={[zs]:Dm,[Hs]:[{[vh]:"UseDualStack"},!0]},Dn={},cm={[vh]:"Region"},uC={[zs]:B_,[Hs]:[{[vh]:H_},"supportsFIPS"]},cT={[vh]:H_},dC={[zs]:Dm,[Hs]:[!0,{[zs]:B_,[Hs]:[cT,"supportsDualStack"]}]},fC=[aT],hC=[lT],pC=[cm],u5={parameters:{Region:aC,UseDualStack:lC,UseFIPS:lC,Endpoint:aC},rules:[{conditions:[{[zs]:iC,[Hs]:[cC]}],rules:[{conditions:fC,error:"Invalid Configuration: FIPS and custom endpoint are not supported",type:Lf},{conditions:hC,error:"Invalid Configuration: Dualstack and custom endpoint are not supported",type:Lf},{endpoint:{url:cC,properties:Dn,headers:Dn},type:Ua}],type:Fl},{conditions:[{[zs]:iC,[Hs]:pC}],rules:[{conditions:[{[zs]:"aws.partition",[Hs]:pC,assign:H_}],rules:[{conditions:[aT,lT],rules:[{conditions:[{[zs]:Dm,[Hs]:[oC,uC]},dC],rules:[{conditions:[{[zs]:Hp,[Hs]:[cm,"us-east-1"]}],endpoint:{url:"https://cognito-identity-fips.us-east-1.amazonaws.com",properties:Dn,headers:Dn},type:Ua},{conditions:[{[zs]:Hp,[Hs]:[cm,"us-east-2"]}],endpoint:{url:"https://cognito-identity-fips.us-east-2.amazonaws.com",properties:Dn,headers:Dn},type:Ua},{conditions:[{[zs]:Hp,[Hs]:[cm,"us-west-1"]}],endpoint:{url:"https://cognito-identity-fips.us-west-1.amazonaws.com",properties:Dn,headers:Dn},type:Ua},{conditions:[{[zs]:Hp,[Hs]:[cm,"us-west-2"]}],endpoint:{url:"https://cognito-identity-fips.us-west-2.amazonaws.com",properties:Dn,headers:Dn},type:Ua},{endpoint:{url:"https://cognito-identity-fips.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:Dn,headers:Dn},type:Ua}],type:Fl},{error:"FIPS and DualStack are enabled, but this partition does not support one or both",type:Lf}],type:Fl},{conditions:fC,rules:[{conditions:[{[zs]:Dm,[Hs]:[uC,oC]}],rules:[{endpoint:{url:"https://cognito-identity-fips.{Region}.{PartitionResult#dnsSuffix}",properties:Dn,headers:Dn},type:Ua}],type:Fl},{error:"FIPS is enabled but this partition does not support FIPS",type:Lf}],type:Fl},{conditions:hC,rules:[{conditions:[dC],rules:[{conditions:[{[zs]:Hp,[Hs]:["aws",{[zs]:B_,[Hs]:[cT,"name"]}]}],endpoint:{url:"https://cognito-identity.{Region}.amazonaws.com",properties:Dn,headers:Dn},type:Ua},{endpoint:{url:"https://cognito-identity.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:Dn,headers:Dn},type:Ua}],type:Fl},{error:"DualStack is enabled but this partition does not support DualStack",type:Lf}],type:Fl},{endpoint:{url:"https://cognito-identity.{Region}.{PartitionResult#dnsSuffix}",properties:Dn,headers:Dn},type:Ua}],type:Fl}],type:Fl},{error:"Invalid Configuration: Missing Region",type:Lf}]},d5=u5,f5=new M1({size:50,params:["Endpoint","Region","UseDualStack","UseFIPS"]}),h5=(r,e={})=>f5.get(r,()=>K1(d5,{endpointParams:r,logger:e.logger}));ch.aws=Pb;const p5=r=>({apiVersion:"2014-06-30",base64Decoder:(r==null?void 0:r.base64Decoder)??qm,base64Encoder:(r==null?void 0:r.base64Encoder)??Tm,disableHostPrefix:(r==null?void 0:r.disableHostPrefix)??!1,endpointProvider:(r==null?void 0:r.endpointProvider)??h5,extensions:(r==null?void 0:r.extensions)??[],httpAuthSchemeProvider:(r==null?void 0:r.httpAuthSchemeProvider)??o5,httpAuthSchemes:(r==null?void 0:r.httpAuthSchemes)??[{schemeId:"aws.auth#sigv4",identityProvider:e=>e.getIdentityProvider("aws.auth#sigv4"),signer:new X1},{schemeId:"smithy.api#noAuth",identityProvider:e=>e.getIdentityProvider("smithy.api#noAuth")||(async()=>({})),signer:new O1}],logger:(r==null?void 0:r.logger)??new Ab,protocol:(r==null?void 0:r.protocol)??dN,protocolSettings:(r==null?void 0:r.protocolSettings)??{defaultNamespace:"com.amazonaws.cognitoidentity",xmlNamespace:"http://cognito-identity.amazonaws.com/doc/2014-06-30/",version:"2014-06-30",serviceTarget:"AWSCognitoIdentityService"},serviceId:(r==null?void 0:r.serviceId)??"Cognito Identity",urlParser:(r==null?void 0:r.urlParser)??Im,utf8Decoder:(r==null?void 0:r.utf8Decoder)??cd,utf8Encoder:(r==null?void 0:r.utf8Encoder)??Ly}),m5=r=>{const e=PN(r),t=()=>e().then(lN),n=p5(r);return{...n,...r,runtime:"browser",defaultsMode:e,bodyLengthChecker:(r==null?void 0:r.bodyLengthChecker)??oN,credentialDefaultProvider:(r==null?void 0:r.credentialDefaultProvider)??(s=>()=>Promise.reject(new Error("Credential is missing"))),defaultUserAgentProvider:(r==null?void 0:r.defaultUserAgentProvider)??RN({serviceId:n.serviceId,clientVersion:c5.version}),maxAttempts:(r==null?void 0:r.maxAttempts)??Pm,region:(r==null?void 0:r.region)??IN("Region is missing"),requestHandler:My.create((r==null?void 0:r.requestHandler)??t),retryMode:(r==null?void 0:r.retryMode)??(async()=>(await t()).retryMode||bN),sha256:(r==null?void 0:r.sha256)??AN,streamCollector:(r==null?void 0:r.streamCollector)??N1,useDualstackEndpoint:(r==null?void 0:r.useDualstackEndpoint)??(()=>Promise.resolve(hN)),useFipsEndpoint:(r==null?void 0:r.useFipsEndpoint)??(()=>Promise.resolve(pN))}},g5=r=>{const e=r.httpAuthSchemes;let t=r.httpAuthSchemeProvider,n=r.credentials;return{setHttpAuthScheme(s){const i=e.findIndex(c=>c.schemeId===s.schemeId);i===-1?e.push(s):e.splice(i,1,s)},httpAuthSchemes(){return e},setHttpAuthSchemeProvider(s){t=s},httpAuthSchemeProvider(){return t},setCredentials(s){n=s},credentials(){return n}}},v5=r=>({httpAuthSchemes:r.httpAuthSchemes(),httpAuthSchemeProvider:r.httpAuthSchemeProvider(),credentials:r.credentials()}),y5=(r,e)=>{const t=Object.assign(MN(r),cN(r),x1(r),g5(r));return e.forEach(n=>n.configure(t)),Object.assign(r,$N(t),uN(t),w1(t),v5(t))};class x5 extends iN{constructor(...[t]){const n=m5(t||{});super(n);B(this,"config");this.initConfig=n;const s=a5(n),i=L1(s),c=CN(i),d=gN(c),m=d,p=wN(m),v=i5(p),x=y5(v,(t==null?void 0:t.extensions)||[]);this.config=x,this.middlewareStack.use(R1(this.config)),this.middlewareStack.use(fN(this.config)),this.middlewareStack.use(kN(this.config)),this.middlewareStack.use(vN(this.config)),this.middlewareStack.use(b1(this.config)),this.middlewareStack.use(_1(this.config)),this.middlewareStack.use(S1(this.config)),this.middlewareStack.use(E1(this.config,{httpAuthSchemeParametersProvider:n5,identityProviderConfigProvider:async b=>new j1({"aws.auth#sigv4":b.credentials})})),this.middlewareStack.use(C1(this.config))}destroy(){super.destroy()}}var uT=(r=>(r.Succeeded="succeeded",r.Failed="failed",r))(uT||{}),Fw=(r=>(r.DialogMessageReceived="dialogMessageReceived",r.DialogEventReceived="dialogEventReceived",r))(Fw||{});class dT{constructor(e){B(this,"logger");this.logger=e}async launchWebAuthFlow(e){return this.logger.warn("launchWebAuthFlow using basic window.open approach in Outlook context",{sourceFile:"src/platforms/outlook/OutlookIdentityProvider.ts",sourceFunction:"launchWebAuthFlow"}),this.initiateOAuth(e.url,"")}async initiateOAuth(e,t){var n;try{const s=window.Office;return(n=s==null?void 0:s.ui)!=null&&n.displayDialogAsync?(this.logger.info("Using Office.ui.displayDialogAsync for OAuth",{sourceFile:"src/platforms/outlook/OutlookIdentityProvider.ts",sourceFunction:"initiateOAuth"}),new Promise((i,c)=>{s.ui.displayDialogAsync(e,{height:60,width:60},d=>{var m;if(d.status===uT.Succeeded){const p=d.value;p.addEventHandler(Fw.DialogMessageReceived,v=>{p.close(),i(v.message||"")}),p.addEventHandler(Fw.DialogEventReceived,v=>{p.close(),v.error===12006?c(new Error("Authentication was cancelled by user")):c(new Error(`Authentication dialog failed with error: ${v.error}`))})}else c(new Error(`Failed to open authentication dialog: ${((m=d.error)==null?void 0:m.message)||"Unknown error"}`))})})):(this.logger.warn("Office.ui not available, using window.open fallback",{sourceFile:"src/platforms/outlook/OutlookIdentityProvider.ts",sourceFunction:"initiateOAuth"}),new Promise((i,c)=>{const d=window.open(e,"_blank","width=500,height=600,scrollbars=yes,resizable=yes");if(!d){c(new Error("Failed to open authentication window. Please check popup blockers."));return}const m=setInterval(()=>{try{if(d.closed){clearInterval(m),c(new Error("Authentication was cancelled by user"));return}try{const p=d.location.href;if(p&&p.includes("access_token=")){clearInterval(m),d.close(),i(p);return}}catch{}}catch{clearInterval(m),d==null||d.close(),c(new Error("Error during authentication process"))}},1e3);setTimeout(()=>{clearInterval(m),d.closed||d.close(),c(new Error("Authentication timeout - please try again"))},3e5)}))}catch(s){throw this.logger.error("Error initiating OAuth",s,{sourceFile:"src/platforms/outlook/OutlookIdentityProvider.ts",sourceFunction:"initiateOAuth"}),s}}}const w5=()=>{const r=window.location.hostname,e=window.location.pathname;if(r==="localhost"){const n=QN.match(/^(dev2|demo)/),s=n?`?env=${n[1]}`:"";return{environment:n?`${n[1]}-local`:"local",DIALOG_URL:`https://localhost:5174/auth-dialog-pkce.html${s}`}}else return e.includes("FileServer_Staging")?{environment:"staging",DIALOG_URL:"https://candle-ai.github.io/FileServer_Staging/dist-outlook-addin/src/apps/outlook-addin/auth-dialog-pkce.html"}:e.includes("FileServer_Prod")?{environment:"prod",DIALOG_URL:"https://candle-ai.github.io/FileServer_Prod/dist-outlook-addin/src/apps/outlook-addin/auth-dialog-pkce.html"}:{environment:"dev",DIALOG_URL:"https://candle-ai.github.io/FileServer/dist-outlook-addin/src/apps/outlook-addin/auth-dialog-pkce.html"}};async function b5(){const r=w5();return new Promise((e,t)=>{let n=!1;console.log(`Starting PKCE authentication in ${r.environment} environment with dialog:`,r.DIALOG_URL),Office.context.ui.displayDialogAsync(r.DIALOG_URL,{height:70,width:50,promptBeforeOpen:!1},s=>{if(s.status!==Office.AsyncResultStatus.Succeeded)return console.error("Failed to open auth dialog:",s.error),t(new Error(`Failed to open authentication dialog: ${s.error.message}`));const i=s.value;console.log("Auth dialog opened successfully"),i.addEventHandler(Office.EventType.DialogMessageReceived,c=>{try{if(!n&&"message"in c){let d;if(typeof c.message=="string")d=JSON.parse(c.message);else if(typeof c.message=="object")d=c.message;else{console.log("Unknown message type:",typeof c.message,c.message);return}if(console.log(`Received message from auth dialog (${r.environment}):`,d.type),d.type==="AUTH_SUCCESS"){if(console.log(`Authentication successful in ${r.environment} environment`),n=!0,i.close(),!d.tokens||!d.tokens.access_token){t(new Error("Invalid token response from authentication dialog"));return}const m={access_token:d.tokens.access_token,refresh_token:d.tokens.refresh_token,id_token:d.tokens.id_token,expires_in:d.tokens.expires_in,token_type:d.tokens.token_type,fetched_at:d.tokens.fetched_at};console.log(`Tokens received successfully in ${r.environment} environment`),e(m)}else d.type==="AUTH_ERROR"&&(console.log(`Authentication error in ${r.environment}:`,d.error),n=!0,i.close(),t(new Error(`Authentication failed: ${d.error}`)))}}catch(d){console.error("Error handling dialog message:",d),n||(n=!0,i.close(),t(new Error("Error processing authentication response")))}}),i.addEventHandler(Office.EventType.DialogEventReceived,c=>{if(console.log("Dialog event received:",c),!n&&"error"in c){const d=c.error;d===12006?(console.log("User cancelled authentication"),n=!0,t(new Error("Authentication cancelled by user"))):d===12005?console.log("Dialog navigation occurred (normal during OAuth)"):(console.error("Dialog error:",d),n=!0,t(new Error(`Authentication dialog error: ${d}`)))}}),setTimeout(()=>{n||(console.log(`Authentication timeout in ${r.environment} environment`),n=!0,i.close(),t(new Error("Authentication timeout - please try again")))},300*1e3)})})}const mC="us-east-1";class _5{constructor(e,t){B(this,"logger");B(this,"authListeners",new Set);B(this,"cachedToken",null);B(this,"cognitoClient");B(this,"identityProvider");B(this,"storageProvider");this.logger=e,this.storageProvider=t,this.cognitoClient=new x5({region:mC}),this.identityProvider=new dT(e)}async login(){try{const e=await b5();return this.logger.info("Token received",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"login",token:e}),this.cachedToken=e,await this.saveToken(e),this.notifyAuthListeners(!0),e}catch(e){throw this.logger.error("Login failed",e,{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"login"}),e}}async logout(){this.cachedToken=null,await this.deleteToken(),this.notifyAuthListeners(!1)}async getToken(){if(this.logger.debug("Getting token",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"getToken",hasCachedToken:!!this.cachedToken}),this.cachedToken)return this.logger.debug("Returning cached token",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"getToken"}),this.cachedToken;const e=await this.loadTokenFromStorage();return e?(this.logger.debug("Token loaded from storage, caching it",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"getToken"}),this.cachedToken=e,e):(this.logger.debug("No token found in cache or storage",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"getToken"}),null)}onAuthStateChanged(e){this.authListeners.add(e)}removeAuthStateListener(e){this.authListeners.delete(e)}notifyAuthListeners(e){this.authListeners.forEach(t=>{try{t(e)}catch(n){this.logger.error("Error in auth state callback",n,{sourceFile:"src/platforms/chrome/ChromeAuthProvider.ts",sourceFunction:"notifyAuthListeners"})}})}async isAuthenticated(){console.log(" [OutlookAuthProvider] Checking authentication status"),this.logger.info("Checking authentication status",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"isAuthenticated"});const e=await this.getToken();if(!e)return console.log(" [OutlookAuthProvider] No token found"),this.logger.info("No token found - user is not authenticated",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"isAuthenticated"}),!1;const t=this.isTokenValid(e);if(console.log(" [OutlookAuthProvider] Token valid?",t),!t){console.log(" [OutlookAuthProvider] Token is expired or expiring soon, attempting refresh"),this.logger.info("Token is expired or expiring soon, attempting refresh",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"isAuthenticated",tokenExpiry:e.expires_in,fetchedAt:e.fetched_at});try{return console.log(" [OutlookAuthProvider] Calling refreshToken()..."),await this.refreshToken(e),console.log(" [OutlookAuthProvider] Token refreshed successfully!"),this.logger.info("Token refreshed successfully during authentication check",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"isAuthenticated"}),!0}catch(n){return console.error(" [OutlookAuthProvider] Token refresh failed:",n),this.logger.error("Token refresh failed during authentication check",n,{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"isAuthenticated"}),!1}}return this.logger.info("Authentication status checked - token is valid",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"isAuthenticated",hasToken:!!e,isValid:t,tokenExpiry:e.expires_in,fetchedAt:e.fetched_at}),!0}async validateToken(e){const t=await this.getToken();return t?this.isTokenValid(t):!1}isTokenValid(e){if(!e||!e.expires_in)return!1;const t=Math.floor(Date.now()),n=e.fetched_at||0,s=n+e.expires_in*1e3,i=s-t<3e5;return this.logger.debug("Token validation",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"isTokenValid",currentTime:t,fetchedAt:n,expiresIn:e.expires_in,tokenExpiry:s,isExpired:i,timeUntilExpiry:s-t}),!i}async refreshToken(e){console.log(" [OutlookAuthProvider.refreshToken] Starting token refresh using REFRESH_TOKEN_AUTH"),this.logger.info("Refreshing token using refresh_token",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"refreshToken"});try{const t=new Ob({region:mC}),n=new L_({ClientId:gh,AuthFlow:"REFRESH_TOKEN_AUTH",AuthParameters:{REFRESH_TOKEN:e.refresh_token}});console.log(" [OutlookAuthProvider.refreshToken] Sending refresh request to AWS Cognito"),this.logger.debug("Sending refresh token request to Cognito",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"refreshToken"});const s=await t.send(n);console.log(" [OutlookAuthProvider.refreshToken] Received response from Cognito");const i=s.AuthenticationResult;if(!i)throw new Error("AuthenticationResult is missing in the response.");const{IdToken:c,AccessToken:d,RefreshToken:m,ExpiresIn:p,TokenType:v}=i;if(!c||!d||!p||!v)throw new Error("Missing required fields in AuthenticationResult.");const x={id_token:c,access_token:d,refresh_token:m||e.refresh_token,expires_in:p,token_type:v,fetched_at:Math.floor(Date.now())};return this.logger.info("Token refreshed successfully",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"refreshToken",newExpiresIn:p}),this.cachedToken=x,await this.saveToken(x),this.notifyAuthListeners(!0),x}catch(t){return this.logger.error("Token refresh failed, falling back to full re-login",t,{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"refreshToken"}),this.login()}}async saveToken(e){await this.storageProvider.setLocalItem("token",e)}async loadTokenFromStorage(){this.logger.debug("Loading token from storage",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"loadTokenFromStorage"});try{const e=await this.storageProvider.getLocalItem("token");if(!e)return this.logger.debug("No token found in storage",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"loadTokenFromStorage"}),null;const t=e;return this.logger.debug("Token successfully loaded from storage",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"loadTokenFromStorage",hasToken:!!t,fetchedAt:t==null?void 0:t.fetched_at,expiresIn:t==null?void 0:t.expires_in}),t}catch(e){return this.logger.warn("Failed to load token from storage",{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"loadTokenFromStorage",error:e}),null}}async deleteToken(){await this.storageProvider.removeLocalItem("token")}parseAccessTokenFromOAuthResponse(e){try{let t=e;e.includes("#")&&(t=e.split("#")[1]);const n=new URLSearchParams(t),s=n.get("access_token");if(!s)return this.logger.error("No access_token found in OAuth response",new Error("Missing access token"),{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"parseAccessTokenFromOAuthResponse",responseUrl:e,fragment:t}),null;const i=n.get("error");if(i){const c=n.get("error_description")||"Unknown OAuth error";throw new Error(`OAuth error: ${i} - ${c}`)}return s}catch(t){return this.logger.error("Failed to parse OAuth response",t,{sourceFile:"OutlookAuthProvider.ts",sourceFunction:"parseAccessTokenFromOAuthResponse",responseUrl:e}),null}}}class S5{constructor(e){B(this,"logger");this.logger=e}async sendMessage(e){return this.logger.debug("Sending message in Outlook context",{sourceFile:"src/platforms/outlook/OutlookMessagingProvider.ts",sourceFunction:"sendMessage",message:e}),Promise.resolve(e)}onMessage(e){this.logger.debug("Registering message callback in Outlook context",{sourceFile:"src/platforms/outlook/OutlookMessagingProvider.ts",sourceFunction:"onMessage"})}removeMessageListener(e){this.logger.debug("Removing message listener in Outlook context",{sourceFile:"src/platforms/outlook/OutlookMessagingProvider.ts",sourceFunction:"removeMessageListener"})}async sendOfficeNotification(e){try{typeof Office<"u"&&Office.context&&Office.context.ui&&Office.context.ui.displayDialogAsync(`data:text/html,<html><body><p>${e}</p></body></html>`,{height:20,width:40},t=>{t.status===Office.AsyncResultStatus.Succeeded&&setTimeout(()=>t.value.close(),3e3)})}catch(t){this.logger.error("Error showing Office notification",t,{sourceFile:"src/platforms/outlook/OutlookMessagingProvider.ts",sourceFunction:"sendOfficeNotification"})}}}class E5{constructor(e){B(this,"logger");B(this,"eventListeners",new Map);B(this,"isInitialized",!1);this.logger=e}async initialize(){if(this.isInitialized){this.logger.info("Outlook platform already initialized",{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"initialize"});return}try{this.logger.info("Initializing Outlook platform...",{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"initialize"}),await this.waitForOfficeReady(),this.setupOutlookEventListeners();try{const e=JSON.stringify(ZN);localStorage.setItem("CONFIG_VERIFICATION",e),this.logger.info(`[Debug] Saved CONFIG_VERIFICATION='${e}' to localStorage.`,{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"initialize"})}catch(e){this.logger.warn("[Debug] Could not save CONFIG_VERIFICATION to localStorage.",e,{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"initialize"})}this.isInitialized=!0,this.logger.info("Outlook platform initialized successfully",{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"initialize"})}catch(e){throw this.logger.error("Failed to initialize Outlook platform",e,{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"initialize"}),e}}async cleanup(){try{this.logger.info("Cleaning up Outlook platform...",{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"cleanup"}),this.eventListeners.clear(),this.isInitialized=!1,this.logger.info("Outlook platform cleanup completed",{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"cleanup"})}catch(e){throw this.logger.error("Failed to cleanup Outlook platform",e,{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"cleanup"}),e}}async closeWindow(){this.logger.debug("Window close requested (no-op for Outlook)",{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"closeWindow"})}onPlatformEvent(e,t){this.eventListeners.has(e)||this.eventListeners.set(e,new Set),this.eventListeners.get(e).add(t)}async waitForOfficeReady(){return new Promise(e=>{typeof Office<"u"&&Office.onReady?Office.onReady(()=>{e()}):e()})}setupOutlookEventListeners(){var e;typeof Office<"u"&&Office.context&&(e=Office.context.mailbox)!=null&&e.addHandlerAsync&&Office.context.mailbox.addHandlerAsync(Office.EventType.ItemChanged,this.handleItemChanged.bind(this),t=>{t.status===Office.AsyncResultStatus.Failed&&this.logger.error("Failed to add item changed handler",t.error,{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"setupOutlookEventListeners"})})}handleItemChanged(){this.emitPlatformEvent("itemChanged")}emitPlatformEvent(e,...t){const n=this.eventListeners.get(e);n&&n.forEach(s=>{try{s(...t)}catch(i){this.logger.error(`Error in platform event callback for ${e}`,i,{sourceFile:"src/platforms/outlook/OutlookLifecycleProvider.ts",sourceFunction:"emitPlatformEvent",event:e})}})}}class C5{constructor(e){B(this,"logger");this.logger=e}getResourceURL(e){return this.logger.debug("getResourceURL called in Outlook context",{sourceFile:"src/platforms/outlook/OutlookTabsProvider.ts",sourceFunction:"getResourceURL",path:e}),e.includes("options.html")?Zf:""}async getCurrentTab(){return this.logger.debug("getCurrentTab called in Outlook context",{sourceFile:"src/platforms/outlook/OutlookTabsProvider.ts",sourceFunction:"getCurrentTab"}),{id:1,windowId:1,index:0,url:window.location.href,title:document.title||"Outlook Add-in",active:!0,highlighted:!0,pinned:!1,incognito:!1}}async createTab(e,t){return this.logger.debug("createTab called in Outlook context",{sourceFile:"src/platforms/outlook/OutlookTabsProvider.ts",sourceFunction:"createTab",url:e}),window.open(e,"_blank"),{id:Date.now(),windowId:1,index:0,url:e,title:"New Tab",active:!0,highlighted:!0,pinned:!1,incognito:!1}}async updateTab(e,t){this.logger.debug("updateTab called in Outlook context - this is a no-op",{sourceFile:"src/platforms/outlook/OutlookTabsProvider.ts",sourceFunction:"updateTab"})}async closeTab(e){this.logger.debug("closeTab called in Outlook context - this is a no-op",{sourceFile:"src/platforms/outlook/OutlookTabsProvider.ts",sourceFunction:"closeTab"})}onTabUpdated(e){this.logger.debug("onTabUpdated called in Outlook context - this is a no-op",{sourceFile:"src/platforms/outlook/OutlookTabsProvider.ts",sourceFunction:"onTabUpdated"})}removeTabUpdateListener(e){this.logger.debug("removeTabUpdateListener called in Outlook context - this is a no-op",{sourceFile:"src/platforms/outlook/OutlookTabsProvider.ts",sourceFunction:"removeTabUpdateListener"})}async openURL(e,t="_blank"){this.logger.debug("openURL called in Outlook context",{sourceFile:"src/platforms/outlook/OutlookTabsProvider.ts",sourceFunction:"openURL",url:e,target:t}),window.open(e,t)}async openOptionsPage(){this.logger.debug("openOptionsPage called in Outlook context",{sourceFile:"src/platforms/outlook/OutlookTabsProvider.ts",sourceFunction:"openOptionsPage"});const e=await Rw(this.logger);let t=Zf;e!=null&&e.id_token&&(t+=`?token=${e.id_token}`),window.open(t,"_blank")}}const Cx=32*1024;class k5{constructor(e){B(this,"logger");this.logger=e}truncateHtmlForReplyForm(e){const n=new TextEncoder().encode(e);if(n.length<=Cx)return e;this.logger.warn("HTML content exceeds 32 KB limit for reply form, truncating",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"truncateHtmlForReplyForm",originalSize:n.length,maxSize:Cx});let i=new TextDecoder().decode(n.slice(0,Cx-100));const c=Math.max(i.lastIndexOf("</p>"),i.lastIndexOf("</div>"),i.lastIndexOf("</li>"),i.lastIndexOf("<br>"));return c>i.length/2&&(i=i.substring(0,c+(i.includes("</p>")?4:i.includes("</div>")?6:i.includes("</li>")?5:4))),i+='<p style="color: gray; font-style: italic;">[Content truncated due to size limit]</p>',i}detectItemMode(){var e,t;try{if(!((t=(e=Office==null?void 0:Office.context)==null?void 0:e.mailbox)!=null&&t.item))return"unknown";const n=Office.context.mailbox.item;if(!n.itemId)return this.logger.debug("Detected compose mode (no itemId)",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"detectItemMode"}),"compose";const s=n.to;return s&&typeof s.setAsync=="function"?(this.logger.debug("Detected compose mode (to.setAsync exists)",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"detectItemMode"}),"compose"):(this.logger.debug("Detected read mode",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"detectItemMode"}),"read")}catch(n){return this.logger.warn("Error detecting item mode",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"detectItemMode",error:n}),"unknown"}}async executeScript(e){throw this.logger.warn("Script execution not implemented for Outlook context",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"executeScript"}),new Error("Script execution not available in Outlook context")}async injectScript(e){this.logger.warn("Script injection not applicable in Outlook context",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"injectScript"})}async insertContentIntoComposeBox(e){var t;try{const n=Wv(e);if(typeof Office<"u"&&Office.context&&Office.context.mailbox){const s=this.detectItemMode();this.logger.debug("Inserting content into compose box",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"insertContentIntoComposeBox",mode:s}),s==="compose"?(t=Office.context.mailbox.item)==null||t.body.setSelectedDataAsync(n,{coercionType:Office.CoercionType.Html},i=>{i.status===Office.AsyncResultStatus.Failed?(this.logger.error("Failed to insert content using setSelectedDataAsync, falling back to reply-all",i.error,{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"insertContentIntoComposeBox"}),this.replyAllWithContent(e)):this.logger.info("Successfully inserted content at cursor position",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"insertContentIntoComposeBox"})}):(this.logger.info("In read mode - creating reply-all with content",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"insertContentIntoComposeBox"}),await this.replyAllWithContent(e))}else this.logger.warn("Office.js context not available",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"insertContentIntoComposeBox"})}catch(n){throw this.logger.error("Error inserting content into compose box",n,{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"insertContentIntoComposeBox"}),n}}async replyWithContent(e){try{const t=Wv(e),n=this.truncateHtmlForReplyForm(t);if(typeof Office<"u"&&Office.context&&Office.context.mailbox&&Office.context.mailbox.item){const s=Office.context.mailbox.item;if(typeof s.displayReplyFormAsync=="function")return new Promise((i,c)=>{s.displayReplyFormAsync(n,d=>{d.status===Office.AsyncResultStatus.Succeeded?(this.logger.info("Successfully displayed reply form with content (async)",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyWithContent"}),i()):(this.logger.error("Failed to display reply form (async)",d.error,{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyWithContent"}),c(d.error))})});s.displayReplyForm(n),this.logger.info("Successfully displayed reply form with content",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyWithContent"})}else this.logger.warn("Office.js context not available",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyWithContent"})}catch(t){throw this.logger.error("Error displaying reply form with content",t,{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyWithContent"}),t}}async replyAllWithContent(e){try{const t=Wv(e),n=this.truncateHtmlForReplyForm(t);if(this.logger.debug("Attempting to display reply all form",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyAllWithContent",contentLength:n.length,contentPreview:n.substring(0,200)}),typeof Office<"u"&&Office.context&&Office.context.mailbox&&Office.context.mailbox.item){const s=Office.context.mailbox.item;if(typeof s.displayReplyAllFormAsync=="function")return new Promise((i,c)=>{s.displayReplyAllFormAsync(n,d=>{d.status===Office.AsyncResultStatus.Succeeded?(this.logger.info("Successfully displayed reply all form with content (async)",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyAllWithContent"}),i()):(this.logger.error("Failed to display reply all form (async)",d.error,{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyAllWithContent"}),c(d.error))})});s.displayReplyAllForm(n),this.logger.info("Successfully displayed reply all form with content",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyAllWithContent"})}else this.logger.warn("Office.js context not available",{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyAllWithContent"})}catch(t){throw this.logger.error("Error displaying reply all form with content",t,{sourceFile:"src/platforms/outlook/OutlookContentScriptProvider.ts",sourceFunction:"replyAllWithContent"}),t}}}const gC={ERROR:1,WARN:2,INFO:3,DEBUG:4};class N5{constructor(e){B(this,"context");B(this,"minLevel");this.context=e||"unknown",this.minLevel="INFO"}shouldLog(e){return gC[e]<=gC[this.minLevel]}formatMessage(e,t,n){const s=(n==null?void 0:n.sourceFile)||"unknown",i=n==null?void 0:n.sourceFunction;return`[${e}] [Outlook:${this.context}] [${s}${i?` (${i})`:""}]: ${t}`}async debug(e,t){if(!this.shouldLog("DEBUG"))return;const n=this.formatMessage("DEBUG",e,t),{sourceFile:s,sourceFunction:i,...c}=t||{},d=[n];Object.keys(c).length>0&&d.push(c),console.debug(...d)}async info(e,t){if(!this.shouldLog("INFO"))return;const n=this.formatMessage("INFO",e,t),{sourceFile:s,sourceFunction:i,...c}=t||{},d=[n];Object.keys(c).length>0&&d.push(c),console.info(...d)}async warn(e,t){if(!this.shouldLog("WARN"))return;const n=this.formatMessage("WARN",e,t),{sourceFile:s,sourceFunction:i,...c}=t||{},d=[n];Object.keys(c).length>0&&d.push(c),console.warn(...d)}async error(e,t,n){if(!this.shouldLog("ERROR"))return;const s=this.formatMessage("ERROR",e,n),{sourceFile:i,sourceFunction:c,...d}=n||{},m=[s];t&&m.push(t),Object.keys(d).length>0&&m.push(d),console.error(...m)}setMinLevel(e){this.minLevel=e}getMinLevel(){return this.minLevel}getUnderlyingLogger(){return{context:this.context,minLevel:this.minLevel,writeLog:async(e,t,n,s)=>{switch(e){case"DEBUG":return this.debug(t,n);case"INFO":return this.info(t,n);case"WARN":return this.warn(t,n);case"ERROR":return this.error(t,s,n)}},_triggerCleanupCheck:()=>{},debug:(e,t)=>this.debug(e,t),info:(e,t)=>this.info(e,t),warn:(e,t)=>this.warn(e,t),error:(e,t,n)=>this.error(e,t,n)}}}function T5(){const r=new N5("background"),e=new t5(r);return{storage:e,data:new r5(r),auth:new _5(r,e),messaging:new S5(r),lifecycle:new E5(r),tabs:new C5(r),contentScript:new k5(r),identity:new dT(r),logging:r}}const Ms=class Ms{static async createServices(e){const t=e||Ms.detectPlatform();if(Ms.instance&&Ms.currentPlatform===t)return Ms.instance;let n;if(t==="chrome"){const s=Ms.detectExecutionContext();n=e5(s)}else if(t==="outlook")n=T5();else throw new Error(`Unsupported platform: ${t}`);return await n.lifecycle.initialize(),Ms.instance=n,Ms.currentPlatform=t,n}static detectPlatform(){if(typeof chrome<"u"&&chrome.runtime&&chrome.runtime.id)return"chrome";if(typeof Office<"u"&&Office.context)return"outlook";throw new Error("Unable to detect platform. Neither Chrome nor Office APIs available.")}static detectExecutionContext(){if(typeof chrome<"u"&&chrome.runtime&&chrome.runtime.id){if(typeof document>"u")return"background";try{if(typeof window<"u"&&window.location){const e=window.location.href;return e.includes("options.html")?"options":e.includes("popup.html")?"popup":"content"}}catch{return"content"}return"content"}return"unknown"}static getCurrentPlatform(){return Ms.currentPlatform}static async resetInstance(){Ms.instance&&(await Ms.instance.lifecycle.cleanup(),Ms.instance=null,Ms.currentPlatform=null)}};B(Ms,"instance",null),B(Ms,"currentPlatform",null);let Kn=Ms;const G_=w.createContext({platform:"unassigned",services:null,isLoading:!0,error:null});function A5({children:r}){const[e,t]=w.useState("unassigned"),[n,s]=w.useState(null),[i,c]=w.useState(!0),[d,m]=w.useState(null),p=w.useCallback(async v=>{if(v!=null&&v.lifecycle)try{await v.lifecycle.cleanup()}catch(x){console.error("Error during platform cleanup",x,{sourceFile:"src/platforms/PlatformContext.tsx",sourceFunction:"cleanup"})}},[]);return w.useEffect(()=>{let v=null;async function x(){try{console.info("Initializing platform services...",{sourceFile:"src/platforms/PlatformContext.tsx",sourceFunction:"initializePlatform"});const b=await Kn.createServices();if(v=b,t(Kn.getCurrentPlatform()||"unassigned"),Kn.getCurrentPlatform()==="unassigned")throw new Error("Platform not supported");await b.lifecycle.initialize(),s(b),m(null),console.info("Platform services initialized successfully",{sourceFile:"src/platforms/PlatformContext.tsx",sourceFunction:"initializePlatform"})}catch(b){const S=b instanceof Error?b.message:"Unknown error occurred";console.error("Failed to initialize platform services",b,{sourceFile:"src/platforms/PlatformContext.tsx",sourceFunction:"initializePlatform"}),m(S)}finally{c(!1)}}return x(),()=>{v&&p(v)}},[p]),u.jsx(G_.Provider,{value:{platform:e,services:n,isLoading:i,error:d},children:i?u.jsx("div",{className:"flex items-center justify-center h-full",children:u.jsx("div",{className:"text-sm text-gray-600",children:"Initializing platform..."})}):d?u.jsx("div",{className:"flex items-center justify-center h-full",children:u.jsxs("div",{className:"text-sm text-red-600",children:["Error: ",d]})}):r})}const fT=w.createContext(void 0),Di=()=>{const r=w.useContext(fT);if(r===void 0)throw console.error("useGmailConnection hook called outside of GmailConnectionProvider"),console.error("Component stack:",new Error().stack),new Error("useGmailConnection must be used within a GmailConnectionProvider. Check that the component using this hook is properly wrapped in the provider hierarchy.");return r},gr="src/lib/utils/cacheUtils.ts",R5=100,I5=1440*60*1e3,P5=100,F5=3600*1e3,j5=100,O5=1440*60*1e3,D5=100,L5=3600*1e3,M5=50,$5=1800*1e3,U5=3600*1e3*24,qt={EMAIL_SUMMARY:"cache_email_summary_",EMAIL_SUMMARY_INDEX:"cache_email_summary_index",DOCUMENTS:"cache_documents_",DOCUMENTS_INDEX:"cache_documents_index",PROJECT_DOCUMENTS:"cache_project_documents_",PROJECT_DOCUMENTS_INDEX:"cache_project_documents_index",NON_EXISTENT_CLIENT:"cache_non_existent_client_",NON_EXISTENT_CLIENT_INDEX:"cache_non_existent_client_index",CLIENT:"cache_client_",CLIENT_INDEX:"cache_client_index",GENERATED_RESPONSE:"cache_generated_response_",GENERATED_RESPONSE_INDEX:"cache_generated_response_index",FIRM_USERS:"firm_users"},z5=30*1e3,Lm=new Map;function H5(r){const e=r.toLowerCase(),t=Lm.get(e);return t?Date.now()-t.timestamp>z5?(Lm.delete(e),{inCache:!1}):{inCache:!0,errorType:t.errorType}:{inCache:!1}}function vC(r,e){const t=r.toLowerCase();Lm.set(t,{timestamp:Date.now(),errorType:e})}function hT(r){const e=r.toLowerCase();Lm.delete(e)}function B5(){Lm.clear()}async function as(r){try{return(await Kn.createServices()).storage}catch(e){return r.warn("Platform detection failed, storage unavailable",{sourceFile:gr,error:e}),null}}async function Xm(r,e,t,n,s){try{const i=await r.getLocalItem(e)||[];if(i.length>=n){i.sort((d,m)=>d.timestamp-m.timestamp);const c=i.splice(0,i.length-n+1);for(const d of c)await r.removeLocalItem(d.key);await r.setLocalItem(e,i)}}catch(i){s.warn("Error managing cache size",{sourceFile:gr,error:i})}}async function Qm(r,e,t,n,s){try{const i=await r.getLocalItem(e)||[],c=i.findIndex(d=>d.key===t);c!==-1&&i.splice(c,1),i.push({key:t,timestamp:n}),await r.setLocalItem(e,i)}catch(i){s.warn("Error updating cache index",{sourceFile:gr,error:i})}}async function pT(r){await Promise.all([V5(r),q5(r),J5(r),yT(r),Q5(r)])}async function G5(r,e,t,n){try{const s=await as(n);if(!s)return;const i=`${qt.EMAIL_SUMMARY}${r}`,c=Date.now();await Xm(s,qt.EMAIL_SUMMARY_INDEX,qt.EMAIL_SUMMARY,R5,n);const d={summary:e,importantDetails:t,timestamp:c};await s.setLocalItem(i,d),await Qm(s,qt.EMAIL_SUMMARY_INDEX,i,c,n),n.debug("Added to summary cache",{sourceFile:gr,functionName:"addToSummaryCache",threadId:r})}catch(s){n.warn("Error adding to summary cache",{sourceFile:gr,functionName:"addToSummaryCache",threadId:r,error:s})}}async function W5(r,e){try{const t=await as(e);if(!t)return null;const n=`${qt.EMAIL_SUMMARY}${r}`,s=await t.getLocalItem(n);return s?Date.now()-s.timestamp>I5?(await t.removeLocalItem(n),null):s:null}catch(t){return e.warn("Error getting from summary cache",{sourceFile:gr,functionName:"getFromSummaryCache",threadId:r,error:t}),null}}async function V5(r){try{const e=await as(r);if(!e)return;const t=await e.getLocalItem(qt.EMAIL_SUMMARY_INDEX)||[];for(const n of t)await e.removeLocalItem(n.key);await e.removeLocalItem(qt.EMAIL_SUMMARY_INDEX),r.debug("Summary cache cleared",{sourceFile:gr,functionName:"clearSummaryCache"})}catch(e){r.warn("Error clearing summary cache",{sourceFile:gr,functionName:"clearSummaryCache",error:e})}}async function mT(r,e,t){try{const n=await as(t);if(!n)return;const s=`${qt.PROJECT_DOCUMENTS}${r}`,i=Date.now();await Xm(n,qt.PROJECT_DOCUMENTS_INDEX,qt.PROJECT_DOCUMENTS,P5,t);const c={documents:e,timestamp:i};await n.setLocalItem(s,c),await Qm(n,qt.PROJECT_DOCUMENTS_INDEX,s,i,t),t.debug("Added to project document cache",{sourceFile:gr,functionName:"addToProjectDocumentCache",projectId:r})}catch(n){t.warn("Error adding to project document cache",{sourceFile:gr,functionName:"addToProjectDocumentCache",projectId:r,error:n})}}async function gT(r,e){try{const t=await as(e);if(!t)return null;e.debug("Getting documents from project document cache",{sourceFile:gr,functionName:"getFromProjectDocumentCache",projectId:r});const n=`${qt.PROJECT_DOCUMENTS}${r}`,s=await t.getLocalItem(n);return s?Date.now()-s.timestamp>F5?(await t.removeLocalItem(n),null):s.documents:null}catch(t){return e.warn("Error getting from project document cache",{sourceFile:gr,functionName:"getFromProjectDocumentCache",projectId:r,error:t}),null}}async function q5(r){try{const e=await as(r);if(!e)return;const t=await e.getLocalItem(qt.DOCUMENTS_INDEX)||[];for(const n of t)await e.removeLocalItem(n.key);await e.removeLocalItem(qt.DOCUMENTS_INDEX),r.debug("Document cache cleared",{sourceFile:gr,functionName:"clearDocumentCache"})}catch(e){r.warn("Error clearing document cache",{sourceFile:gr,functionName:"clearDocumentCache",error:e})}}async function K5(r,e){try{const t=await as(e);if(!t)return;const n=r.toLowerCase(),s=`${qt.NON_EXISTENT_CLIENT}${n}`,i=Date.now();await Xm(t,qt.NON_EXISTENT_CLIENT_INDEX,qt.NON_EXISTENT_CLIENT,j5,e),await t.setLocalItem(s,i),await Qm(t,qt.NON_EXISTENT_CLIENT_INDEX,s,i,e),e.debug("Added to non-existent client cache",{sourceFile:gr,functionName:"addToNonExistentClientCache",email:n})}catch(t){e.warn("Error adding to non-existent client cache",{sourceFile:gr,functionName:"addToNonExistentClientCache",email:r,error:t})}}async function Y5(r,e){try{const t=await as(e);if(!t)return!1;const n=r.toLowerCase(),s=`${qt.NON_EXISTENT_CLIENT}${n}`,i=await t.getLocalItem(s);return i?Date.now()-i>O5?(await t.removeLocalItem(s),!1):!0:!1}catch(t){return e.warn("Error checking non-existent client cache",{sourceFile:gr,functionName:"isInNonExistentClientCache",email:r,error:t}),!1}}async function J5(r){try{const e=await as(r);if(!e)return;const t=await e.getLocalItem(qt.NON_EXISTENT_CLIENT_INDEX)||[];for(const n of t)await e.removeLocalItem(n.key);await e.removeLocalItem(qt.NON_EXISTENT_CLIENT_INDEX),r.debug("Non-existent client cache cleared",{sourceFile:gr,functionName:"clearNonExistentClientCache"})}catch(e){r.warn("Error clearing non-existent client cache",{sourceFile:gr,functionName:"clearNonExistentClientCache",error:e})}}async function vT(r,e,t){try{const n=await as(t);if(!n)return;const s=r.toLowerCase(),i=`${qt.CLIENT}${s}`,c=Date.now();await Xm(n,qt.CLIENT_INDEX,qt.CLIENT,D5,t);const d={data:e,timestamp:c};await n.setLocalItem(i,d),await Qm(n,qt.CLIENT_INDEX,i,c,t),t.debug("Added to client cache",{sourceFile:gr,functionName:"addToClientCache",clientEmail:s})}catch(n){t.warn("Error adding to client cache",{sourceFile:gr,functionName:"addToClientCache",clientEmail:r,error:n})}}async function Mm(r,e){try{const t=await as(e);if(!t)return null;const n=r.toLowerCase();e.debug("Getting client info from client cache",{sourceFile:gr,functionName:"getFromClientCache",clientEmail:n});const s=`${qt.CLIENT}${n}`,i=await t.getLocalItem(s);return i?Date.now()-i.timestamp>L5?(await t.removeLocalItem(s),null):i.data:null}catch(t){return e.warn("Error getting from client cache",{sourceFile:gr,functionName:"getFromClientCache",clientEmail:r,error:t}),null}}async function yT(r){try{const e=await as(r);if(!e)return;const t=await e.getLocalItem(qt.CLIENT_INDEX)||[];for(const n of t)await e.removeLocalItem(n.key);await e.removeLocalItem(qt.CLIENT_INDEX),r.debug("Client cache cleared",{sourceFile:gr,functionName:"clearClientCache"})}catch(e){r.warn("Error clearing client cache",{sourceFile:gr,functionName:"clearClientCache",error:e})}}async function jw(r,e){try{const t=await as(e);if(!t)return;const n=r.toLowerCase();hT(n);const s=`${qt.CLIENT}${n}`;await t.removeLocalItem(s);const i=await t.getLocalItem(qt.CLIENT_INDEX)||[],c=i.filter(S=>S.key!==s);c.length!==i.length&&await t.setLocalItem(qt.CLIENT_INDEX,c);const d=`${qt.NON_EXISTENT_CLIENT}${n}`;await t.removeLocalItem(d);const m=await t.getLocalItem(qt.NON_EXISTENT_CLIENT_INDEX)||[],p=m.filter(S=>S.key!==d);p.length!==m.length&&await t.setLocalItem(qt.NON_EXISTENT_CLIENT_INDEX,p);const v=`${qt.DOCUMENTS}${n}`;await t.removeLocalItem(v);const x=await t.getLocalItem(qt.DOCUMENTS_INDEX)||[],b=x.filter(S=>S.key!==v);b.length!==x.length&&await t.setLocalItem(qt.DOCUMENTS_INDEX,b),e.debug("Cleared all cached data for client email",{sourceFile:gr,functionName:"clearClientDataForEmail",clientEmail:n})}catch(t){e.warn("Error clearing client data for email",{sourceFile:gr,functionName:"clearClientDataForEmail",clientEmail:r,error:t})}}async function yC(r,e,t,n,s,i,c){try{const d=await as(s);if(!d)return;const m=`${qt.GENERATED_RESPONSE}${r}`,p=Date.now();await Xm(d,qt.GENERATED_RESPONSE_INDEX,qt.GENERATED_RESPONSE,M5,s);const v={response:e,references:t,cmsData:n,rawCmsData:i,refreshed:c,timestamp:p};await d.setLocalItem(m,v),await Qm(d,qt.GENERATED_RESPONSE_INDEX,m,p,s),s.debug("Added to generated response cache",{sourceFile:gr,functionName:"addToGeneratedResponseCache",cacheKey:r})}catch(d){s.warn("Error adding to generated response cache",{sourceFile:gr,functionName:"addToGeneratedResponseCache",cacheKey:r,error:d})}}async function X5(r,e){try{const t=await as(e);if(!t)return null;e.debug("Getting generated response from cache",{sourceFile:gr,functionName:"getFromGeneratedResponseCache",cacheKey:r});const n=`${qt.GENERATED_RESPONSE}${r}`,s=await t.getLocalItem(n);return s?Date.now()-s.timestamp>$5?(await t.removeLocalItem(n),null):s:null}catch(t){return e.warn("Error getting from generated response cache",{sourceFile:gr,functionName:"getFromGeneratedResponseCache",cacheKey:r,error:t}),null}}async function xT(r,e){try{const t=await as(e);if(!t)return;const n={users:r,timestamp:Date.now()};await t.setLocalItem(qt.FIRM_USERS,n),e.debug("Added to firm users cache",{sourceFile:gr,functionName:"addToFirmUsersCache",count:r.length})}catch(t){e.warn("Error adding to firm users cache",{sourceFile:gr,functionName:"addToFirmUsersCache",error:t})}}async function wT(r){try{const e=await as(r);if(!e)return null;const t=await e.getLocalItem(qt.FIRM_USERS);return t?Date.now()-t.timestamp>U5?(await e.removeLocalItem(qt.FIRM_USERS),null):t.users:null}catch(e){return r.warn("Error getting from firm users cache",{sourceFile:gr,functionName:"getFromFirmUsersCache",error:e}),null}}async function Q5(r){try{const e=await as(r);if(!e)return;const t=await e.getLocalItem(qt.GENERATED_RESPONSE_INDEX)||[];for(const n of t)await e.removeLocalItem(n.key);await e.removeLocalItem(qt.GENERATED_RESPONSE_INDEX),r.debug("Generated response cache cleared",{sourceFile:gr,functionName:"clearGeneratedResponseCache"})}catch(e){r.warn("Error clearing generated response cache",{sourceFile:gr,functionName:"clearGeneratedResponseCache",error:e})}}function bT(r){var e,t,n="";if(typeof r=="string"||typeof r=="number")n+=r;else if(typeof r=="object")if(Array.isArray(r)){var s=r.length;for(e=0;e<s;e++)r[e]&&(t=bT(r[e]))&&(n&&(n+=" "),n+=t)}else for(t in r)r[t]&&(n&&(n+=" "),n+=t);return n}function _T(){for(var r,e,t=0,n="",s=arguments.length;t<s;t++)(r=arguments[t])&&(e=bT(r))&&(n&&(n+=" "),n+=e);return n}const W_="-",Z5=r=>{const e=t6(r),{conflictingClassGroups:t,conflictingClassGroupModifiers:n}=r;return{getClassGroupId:c=>{const d=c.split(W_);return d[0]===""&&d.length!==1&&d.shift(),ST(d,e)||e6(c)},getConflictingClassGroupIds:(c,d)=>{const m=t[c]||[];return d&&n[c]?[...m,...n[c]]:m}}},ST=(r,e)=>{var c;if(r.length===0)return e.classGroupId;const t=r[0],n=e.nextPart.get(t),s=n?ST(r.slice(1),n):void 0;if(s)return s;if(e.validators.length===0)return;const i=r.join(W_);return(c=e.validators.find(({validator:d})=>d(i)))==null?void 0:c.classGroupId},xC=/^\[(.+)\]$/,e6=r=>{if(xC.test(r)){const e=xC.exec(r)[1],t=e==null?void 0:e.substring(0,e.indexOf(":"));if(t)return"arbitrary.."+t}},t6=r=>{const{theme:e,prefix:t}=r,n={nextPart:new Map,validators:[]};return n6(Object.entries(r.classGroups),t).forEach(([i,c])=>{Ow(c,n,i,e)}),n},Ow=(r,e,t,n)=>{r.forEach(s=>{if(typeof s=="string"){const i=s===""?e:wC(e,s);i.classGroupId=t;return}if(typeof s=="function"){if(r6(s)){Ow(s(n),e,t,n);return}e.validators.push({validator:s,classGroupId:t});return}Object.entries(s).forEach(([i,c])=>{Ow(c,wC(e,i),t,n)})})},wC=(r,e)=>{let t=r;return e.split(W_).forEach(n=>{t.nextPart.has(n)||t.nextPart.set(n,{nextPart:new Map,validators:[]}),t=t.nextPart.get(n)}),t},r6=r=>r.isThemeGetter,n6=(r,e)=>e?r.map(([t,n])=>{const s=n.map(i=>typeof i=="string"?e+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([c,d])=>[e+c,d])):i);return[t,s]}):r,s6=r=>{if(r<1)return{get:()=>{},set:()=>{}};let e=0,t=new Map,n=new Map;const s=(i,c)=>{t.set(i,c),e++,e>r&&(e=0,n=t,t=new Map)};return{get(i){let c=t.get(i);if(c!==void 0)return c;if((c=n.get(i))!==void 0)return s(i,c),c},set(i,c){t.has(i)?t.set(i,c):s(i,c)}}},ET="!",o6=r=>{const{separator:e,experimentalParseClassName:t}=r,n=e.length===1,s=e[0],i=e.length,c=d=>{const m=[];let p=0,v=0,x;for(let T=0;T<d.length;T++){let A=d[T];if(p===0){if(A===s&&(n||d.slice(T,T+i)===e)){m.push(d.slice(v,T)),v=T+i;continue}if(A==="/"){x=T;continue}}A==="["?p++:A==="]"&&p--}const b=m.length===0?d:d.substring(v),S=b.startsWith(ET),N=S?b.substring(1):b,E=x&&x>v?x-v:void 0;return{modifiers:m,hasImportantModifier:S,baseClassName:N,maybePostfixModifierPosition:E}};return t?d=>t({className:d,parseClassName:c}):c},i6=r=>{if(r.length<=1)return r;const e=[];let t=[];return r.forEach(n=>{n[0]==="["?(e.push(...t.sort(),n),t=[]):t.push(n)}),e.push(...t.sort()),e},a6=r=>({cache:s6(r.cacheSize),parseClassName:o6(r),...Z5(r)}),l6=/\s+/,c6=(r,e)=>{const{parseClassName:t,getClassGroupId:n,getConflictingClassGroupIds:s}=e,i=[],c=r.trim().split(l6);let d="";for(let m=c.length-1;m>=0;m-=1){const p=c[m],{modifiers:v,hasImportantModifier:x,baseClassName:b,maybePostfixModifierPosition:S}=t(p);let N=!!S,E=n(N?b.substring(0,S):b);if(!E){if(!N){d=p+(d.length>0?" "+d:d);continue}if(E=n(b),!E){d=p+(d.length>0?" "+d:d);continue}N=!1}const T=i6(v).join(":"),A=x?T+ET:T,R=A+E;if(i.includes(R))continue;i.push(R);const F=s(E,N);for(let j=0;j<F.length;++j){const L=F[j];i.push(A+L)}d=p+(d.length>0?" "+d:d)}return d};function u6(){let r=0,e,t,n="";for(;r<arguments.length;)(e=arguments[r++])&&(t=CT(e))&&(n&&(n+=" "),n+=t);return n}const CT=r=>{if(typeof r=="string")return r;let e,t="";for(let n=0;n<r.length;n++)r[n]&&(e=CT(r[n]))&&(t&&(t+=" "),t+=e);return t};function d6(r,...e){let t,n,s,i=c;function c(m){const p=e.reduce((v,x)=>x(v),r());return t=a6(p),n=t.cache.get,s=t.cache.set,i=d,d(m)}function d(m){const p=n(m);if(p)return p;const v=c6(m,t);return s(m,v),v}return function(){return i(u6.apply(null,arguments))}}const on=r=>{const e=t=>t[r]||[];return e.isThemeGetter=!0,e},kT=/^\[(?:([a-z-]+):)?(.+)\]$/i,f6=/^\d+\/\d+$/,h6=new Set(["px","full","screen"]),p6=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,m6=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,g6=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,v6=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,y6=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,jl=r=>eh(r)||h6.has(r)||f6.test(r),Dc=r=>yh(r,"length",k6),eh=r=>!!r&&!Number.isNaN(Number(r)),kx=r=>yh(r,"number",eh),Bp=r=>!!r&&Number.isInteger(Number(r)),x6=r=>r.endsWith("%")&&eh(r.slice(0,-1)),ir=r=>kT.test(r),Lc=r=>p6.test(r),w6=new Set(["length","size","percentage"]),b6=r=>yh(r,w6,NT),_6=r=>yh(r,"position",NT),S6=new Set(["image","url"]),E6=r=>yh(r,S6,T6),C6=r=>yh(r,"",N6),Gp=()=>!0,yh=(r,e,t)=>{const n=kT.exec(r);return n?n[1]?typeof e=="string"?n[1]===e:e.has(n[1]):t(n[2]):!1},k6=r=>m6.test(r)&&!g6.test(r),NT=()=>!1,N6=r=>v6.test(r),T6=r=>y6.test(r),A6=()=>{const r=on("colors"),e=on("spacing"),t=on("blur"),n=on("brightness"),s=on("borderColor"),i=on("borderRadius"),c=on("borderSpacing"),d=on("borderWidth"),m=on("contrast"),p=on("grayscale"),v=on("hueRotate"),x=on("invert"),b=on("gap"),S=on("gradientColorStops"),N=on("gradientColorStopPositions"),E=on("inset"),T=on("margin"),A=on("opacity"),R=on("padding"),F=on("saturate"),j=on("scale"),L=on("sepia"),G=on("skew"),z=on("space"),q=on("translate"),ae=()=>["auto","contain","none"],oe=()=>["auto","hidden","clip","visible","scroll"],fe=()=>["auto",ir,e],H=()=>[ir,e],me=()=>["",jl,Dc],ee=()=>["auto",eh,ir],se=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],de=()=>["solid","dashed","dotted","double","none"],Y=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],J=()=>["start","end","center","between","around","evenly","stretch"],$=()=>["","0",ir],X=()=>["auto","avoid","all","avoid-page","page","left","right","column"],O=()=>[eh,ir];return{cacheSize:500,separator:":",theme:{colors:[Gp],spacing:[jl,Dc],blur:["none","",Lc,ir],brightness:O(),borderColor:[r],borderRadius:["none","","full",Lc,ir],borderSpacing:H(),borderWidth:me(),contrast:O(),grayscale:$(),hueRotate:O(),invert:$(),gap:H(),gradientColorStops:[r],gradientColorStopPositions:[x6,Dc],inset:fe(),margin:fe(),opacity:O(),padding:H(),saturate:O(),scale:O(),sepia:$(),skew:O(),space:H(),translate:H()},classGroups:{aspect:[{aspect:["auto","square","video",ir]}],container:["container"],columns:[{columns:[Lc]}],"break-after":[{"break-after":X()}],"break-before":[{"break-before":X()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...se(),ir]}],overflow:[{overflow:oe()}],"overflow-x":[{"overflow-x":oe()}],"overflow-y":[{"overflow-y":oe()}],overscroll:[{overscroll:ae()}],"overscroll-x":[{"overscroll-x":ae()}],"overscroll-y":[{"overscroll-y":ae()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[E]}],"inset-x":[{"inset-x":[E]}],"inset-y":[{"inset-y":[E]}],start:[{start:[E]}],end:[{end:[E]}],top:[{top:[E]}],right:[{right:[E]}],bottom:[{bottom:[E]}],left:[{left:[E]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Bp,ir]}],basis:[{basis:fe()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",ir]}],grow:[{grow:$()}],shrink:[{shrink:$()}],order:[{order:["first","last","none",Bp,ir]}],"grid-cols":[{"grid-cols":[Gp]}],"col-start-end":[{col:["auto",{span:["full",Bp,ir]},ir]}],"col-start":[{"col-start":ee()}],"col-end":[{"col-end":ee()}],"grid-rows":[{"grid-rows":[Gp]}],"row-start-end":[{row:["auto",{span:[Bp,ir]},ir]}],"row-start":[{"row-start":ee()}],"row-end":[{"row-end":ee()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",ir]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",ir]}],gap:[{gap:[b]}],"gap-x":[{"gap-x":[b]}],"gap-y":[{"gap-y":[b]}],"justify-content":[{justify:["normal",...J()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...J(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...J(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[R]}],px:[{px:[R]}],py:[{py:[R]}],ps:[{ps:[R]}],pe:[{pe:[R]}],pt:[{pt:[R]}],pr:[{pr:[R]}],pb:[{pb:[R]}],pl:[{pl:[R]}],m:[{m:[T]}],mx:[{mx:[T]}],my:[{my:[T]}],ms:[{ms:[T]}],me:[{me:[T]}],mt:[{mt:[T]}],mr:[{mr:[T]}],mb:[{mb:[T]}],ml:[{ml:[T]}],"space-x":[{"space-x":[z]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[z]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",ir,e]}],"min-w":[{"min-w":[ir,e,"min","max","fit"]}],"max-w":[{"max-w":[ir,e,"none","full","min","max","fit","prose",{screen:[Lc]},Lc]}],h:[{h:[ir,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[ir,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[ir,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[ir,e,"auto","min","max","fit"]}],"font-size":[{text:["base",Lc,Dc]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",kx]}],"font-family":[{font:[Gp]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",ir]}],"line-clamp":[{"line-clamp":["none",eh,kx]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",jl,ir]}],"list-image":[{"list-image":["none",ir]}],"list-style-type":[{list:["none","disc","decimal",ir]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[r]}],"placeholder-opacity":[{"placeholder-opacity":[A]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[r]}],"text-opacity":[{"text-opacity":[A]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...de(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",jl,Dc]}],"underline-offset":[{"underline-offset":["auto",jl,ir]}],"text-decoration-color":[{decoration:[r]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:H()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",ir]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",ir]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[A]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...se(),_6]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",b6]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},E6]}],"bg-color":[{bg:[r]}],"gradient-from-pos":[{from:[N]}],"gradient-via-pos":[{via:[N]}],"gradient-to-pos":[{to:[N]}],"gradient-from":[{from:[S]}],"gradient-via":[{via:[S]}],"gradient-to":[{to:[S]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[d]}],"border-w-x":[{"border-x":[d]}],"border-w-y":[{"border-y":[d]}],"border-w-s":[{"border-s":[d]}],"border-w-e":[{"border-e":[d]}],"border-w-t":[{"border-t":[d]}],"border-w-r":[{"border-r":[d]}],"border-w-b":[{"border-b":[d]}],"border-w-l":[{"border-l":[d]}],"border-opacity":[{"border-opacity":[A]}],"border-style":[{border:[...de(),"hidden"]}],"divide-x":[{"divide-x":[d]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[d]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[A]}],"divide-style":[{divide:de()}],"border-color":[{border:[s]}],"border-color-x":[{"border-x":[s]}],"border-color-y":[{"border-y":[s]}],"border-color-s":[{"border-s":[s]}],"border-color-e":[{"border-e":[s]}],"border-color-t":[{"border-t":[s]}],"border-color-r":[{"border-r":[s]}],"border-color-b":[{"border-b":[s]}],"border-color-l":[{"border-l":[s]}],"divide-color":[{divide:[s]}],"outline-style":[{outline:["",...de()]}],"outline-offset":[{"outline-offset":[jl,ir]}],"outline-w":[{outline:[jl,Dc]}],"outline-color":[{outline:[r]}],"ring-w":[{ring:me()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[r]}],"ring-opacity":[{"ring-opacity":[A]}],"ring-offset-w":[{"ring-offset":[jl,Dc]}],"ring-offset-color":[{"ring-offset":[r]}],shadow:[{shadow:["","inner","none",Lc,C6]}],"shadow-color":[{shadow:[Gp]}],opacity:[{opacity:[A]}],"mix-blend":[{"mix-blend":[...Y(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":Y()}],filter:[{filter:["","none"]}],blur:[{blur:[t]}],brightness:[{brightness:[n]}],contrast:[{contrast:[m]}],"drop-shadow":[{"drop-shadow":["","none",Lc,ir]}],grayscale:[{grayscale:[p]}],"hue-rotate":[{"hue-rotate":[v]}],invert:[{invert:[x]}],saturate:[{saturate:[F]}],sepia:[{sepia:[L]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[t]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[m]}],"backdrop-grayscale":[{"backdrop-grayscale":[p]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[v]}],"backdrop-invert":[{"backdrop-invert":[x]}],"backdrop-opacity":[{"backdrop-opacity":[A]}],"backdrop-saturate":[{"backdrop-saturate":[F]}],"backdrop-sepia":[{"backdrop-sepia":[L]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[c]}],"border-spacing-x":[{"border-spacing-x":[c]}],"border-spacing-y":[{"border-spacing-y":[c]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",ir]}],duration:[{duration:O()}],ease:[{ease:["linear","in","out","in-out",ir]}],delay:[{delay:O()}],animate:[{animate:["none","spin","ping","pulse","bounce",ir]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[j]}],"scale-x":[{"scale-x":[j]}],"scale-y":[{"scale-y":[j]}],rotate:[{rotate:[Bp,ir]}],"translate-x":[{"translate-x":[q]}],"translate-y":[{"translate-y":[q]}],"skew-x":[{"skew-x":[G]}],"skew-y":[{"skew-y":[G]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",ir]}],accent:[{accent:["auto",r]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",ir]}],"caret-color":[{caret:[r]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":H()}],"scroll-mx":[{"scroll-mx":H()}],"scroll-my":[{"scroll-my":H()}],"scroll-ms":[{"scroll-ms":H()}],"scroll-me":[{"scroll-me":H()}],"scroll-mt":[{"scroll-mt":H()}],"scroll-mr":[{"scroll-mr":H()}],"scroll-mb":[{"scroll-mb":H()}],"scroll-ml":[{"scroll-ml":H()}],"scroll-p":[{"scroll-p":H()}],"scroll-px":[{"scroll-px":H()}],"scroll-py":[{"scroll-py":H()}],"scroll-ps":[{"scroll-ps":H()}],"scroll-pe":[{"scroll-pe":H()}],"scroll-pt":[{"scroll-pt":H()}],"scroll-pr":[{"scroll-pr":H()}],"scroll-pb":[{"scroll-pb":H()}],"scroll-pl":[{"scroll-pl":H()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",ir]}],fill:[{fill:[r,"none"]}],"stroke-w":[{stroke:[jl,Dc,kx]}],stroke:[{stroke:[r,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},R6=d6(A6);function jr(...r){return R6(_T(r))}async function Nx(r){let e;if(r instanceof File)e=await r.arrayBuffer();else if(r instanceof ArrayBuffer)e=r;else if(r instanceof Uint8Array)e=r.buffer;else throw new Error("Unsupported data type for checksum calculation");const t=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(t)).map(i=>i.toString(16).padStart(2,"0")).join("")}const Nr="src/lib/utils/serverUtils.tsx",Tx=new Map,Mf=3,bC=1e3;function _C(r){if(r instanceof Error){const e=r.message.toLowerCase();return e.includes("timeout")||e.includes("network")||e.includes("failed to fetch")||e.includes("504")||e.includes("503")}return!1}function Hy(r){const e=["x-trace-id","x-request-id","x-correlation-id","x-amzn-request-id","x-amzn-requestid","x-amzn-trace-id","request-id","trace-id","correlation-id"];for(const t of e){const n=r.headers.get(t);if(n)return n}return null}new URL(Pr+"/email-template");const I6=new URL(Pr+"/email-templates"),P6=new URL(Pr+"/email/generate"),F6=new URL(Pr+"/email/generate_for_outlook"),j6=new URL(Pr+"/email/reformat"),O6=new URL(Pr+"/email/participants"),D6=new URL(Pr+"/email/participants_with_category");new URL(Pr+"/email/register");new URL(Pr+"/email/unregister");const L6=new URL(Pr+"/email/get_registration"),M6=new URL(Pr+"/email/summarization"),$6=new URL(Pr+"/email/description_summarization"),U6=new URL(Pr+"/email/summarization_for_outlook");new URL(Pr+"/integration");const z6=new URL(Pr+"/integrations"),H6=new URL(Pr+"/integrations/client"),B6=new URL(Pr+"/integrations/document");new URL(Pr+"/integrations/clients");const G6=new URL(Pr+"/integrations/project_documents"),W6=new URL(Pr+"/integrations/case_summary");new URL(Pr+"/integrations/uscis/case");const V6=new URL(Pr+"/integrations/user"),TT=new URL(Pr+"/integrations/users"),Zm=new URL(Pr+"/integrations/write"),q6=new URL(Pr+"/integrations/projects"),K6=new URL(Pr+"/integrations/project");new URL(Pr+"/integrations/contacts");const Y6=new URL(Pr+"/integrations/settings"),J6=new URL(Pr+"/email/generate_task_description");new URL(Pr+"/admin/users");new URL(Pr+"/admin/user");const X6="CANDLE_ERROR_TOKEN_NOT_FOUND",Q6="CANDLE_ERROR_TOKEN_REFRESH_FAILED";function eu(r,e){const t={sourceFile:Nr};e.status===404?e.json().then(n=>{(n.error_code===X6||n.error_code===Q6)&&(r.warn("404 error, Gmail might be disconnected from server, checking...",{...t,data:n}),By(r).then(s=>{s||r.error("Gmail has been disconnected from server unexpectedly!",new Error("Gmail has been disconnected from server, syncing..."),{...t,data:n})}))}):r.warn("HTTP error! status: "+e.status,{...t,data:e})}async function Z6(r){const e={sourceFile:Nr};r.debug("Starting to fetch response...",e);const t=await Xr(I6,{method:"GET",headers:{"Content-Type":"application/json"}},r);if(r.debug("Response received:",{...e,data:t}),!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const n=t.headers.get("content-type");if(r.debug("Content-Type:",{...e,data:n}),n&&n.includes("application/json")){r.debug("Content-Type is JSON, parsing...",e);const s=await t.json();r.debug("Parsed JSON response:",{...e,data:s}),s.user_templates&&s.user_templates.length>0&&r.debug("First user template tags:",{...e,data:s.user_templates[0].tags}),s.org_templates&&s.org_templates.length>0&&r.debug("First org template tags:",{...e,data:s.org_templates[0].tags});const i=s.user_templates.map(d=>({...d,source:"SCOPE_USER"})),c=s.org_templates.map(d=>({...d,source:"SCOPE_TENANT"}));return r.debug("Enhanced user templates with source:",{...e,data:i}),r.debug("Enhanced org templates with source:",{...e,data:c}),{user_templates:i,org_templates:c}}else{r.debug("Content-Type is not JSON, handling as text...",e);const s=await t.text();throw r.error("Received non-JSON response:",s,e),new Error("Received non-JSON response from server")}}async function AT(r,e,t,n,s,i=[],c,d=!1){const m={sourceFile:Nr};c.debug("Starting to fetch response...",m),d?c.info("Force refresh flag is TRUE - will bypass backend cache",{...m,forceRefresh:!0}):c.debug("Force refresh flag is FALSE - will use cache-first",{...m,forceRefresh:!1});const p=[{role:"user",content:"Here's some additional relevant context to help with your response:"+t},{role:"user",content:"This is the specific email in the thread to respond to:"+e}],v={WEB_SOURCES:{PUBLIC:i}};try{const x=await Xr(P6,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email_thread_id:r,datasources:v,format_instruction:s+" "+n,additional_context:p,force_refresh:d})},c);if(c.debug("Response received:",{...m,data:x}),!x.ok)throw eu(c,x),new Error(`HTTP error! status: ${x.status}`);const b=x.headers.get("content-type");c.debug("Content-Type:",{...m,data:b});let S;if(b&&b.includes("application/json"))c.debug("Content-Type is JSON, parsing...",m),S=await x.json();else{c.debug("Content-Type is not JSON, handling as text...",m);const G=await x.text();throw c.error("Received non-JSON response:",G,m),new Error("Received non-JSON response from server")}c.info("Parsed JSON response:",{...m,data:S});const N=S.response,E=S.references,T=S.cms_fields_used,A=S.cms_data,R=S.raw_cms_data;c.info("Result response:",{...m,data:N}),c.info("Result references:",{...m,data:E});const L=new DOMParser().parseFromString(N,"text/html").body.innerHTML;return c.debug("Extracted HTML body content:",{...m,data:L}),{response:L,references:E,cms_fields_used:T,cms_data:A,raw_cms_data:R,refreshed:S.refreshed??!1}}catch(x){return c.error("Error caught:",x,m),{response:"error",references:[],cms_fields_used:[],cms_data:[]}}}async function RT(r,e,t,n,s,i,c,d=!1){const m={sourceFile:Nr};c.debug("Starting to fetch response for Outlook...",m),d?c.info("Force refresh flag is TRUE - will bypass backend cache",{...m,forceRefresh:!0}):c.debug("Force refresh flag is FALSE - will use cache-first",{...m,forceRefresh:!1});const p=[{role:"user",content:"Here's some additional relevant context to help with your response:"+t}];try{const v=await Xr(F6,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({thread_id:r,full_thread:e,email_participants:i,format_instruction:s+" "+n,additional_context:p,force_refresh:d})},c);if(c.debug("Response received:",{...m,data:v}),!v.ok)throw new Error(`HTTP error! status: ${v.status}`);const x=v.headers.get("content-type");c.debug("Content-Type:",{...m,data:x});let b;if(x&&x.includes("application/json"))c.debug("Content-Type is JSON, parsing...",m),b=await v.json();else{c.debug("Content-Type is not JSON, handling as text...",m);const L=await v.text();throw c.error("Received non-JSON response:",L,m),new Error("Received non-JSON response from server")}c.info("Parsed JSON response:",{...m,data:b});const S=b.response,N=b.references,E=b.cms_fields_used,T=b.cms_data,A=b.raw_cms_data;c.debug("Result response:",{...m,data:S}),c.debug("Result references:",{...m,data:N});const j=new DOMParser().parseFromString(S,"text/html").body.innerHTML;return c.debug("Extracted HTML body content:",{...m,data:j}),{response:j,references:N,cms_fields_used:E,cms_data:T,raw_cms_data:A,refreshed:b.refreshed??!1}}catch(v){return c.error("Error caught:",v,m),{response:"error",references:[],cms_fields_used:[],cms_data:[]}}}async function e8(r,e){const t=r==null?void 0:r.case_management_systems_data;if(!t||typeof t!="object")return;const n=Object.entries(t);if(n.length>100){e.warn("Skipping cache prefill: raw_cms_data exceeds 100 entries",{sourceFile:Nr,count:n.length});return}for(const[s,i]of n)if(!(!s||typeof s!="string"||!i||typeof i!="object"||await Mm(s,e)))for(const[,d]of Object.entries(i))!d||typeof d!="object"||await vT(s,{client_data:Array.isArray(d.client_data)?d.client_data:[],case_data:d.case_data||[],pagination:d.pagination},e)}async function IT(r,e,t){const n={sourceFile:Nr};t.debug("Starting to fetch response...",n);const s=await Xr(j6,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({reformat_instruction:e,chat_history:[{content:"Here's the HTML Content. Respond with only the HTML content for the revised email response:"+r}]})},t);if(t.debug("Response received:",{...n,data:s}),!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const i=s.headers.get("content-type");if(t.debug("Content-Type:",{...n,data:i}),i&&i.includes("application/json")){t.debug("Content-Type is JSON, parsing...",n);const c=await s.json();t.debug("Parsed JSON response:",{...n,data:c});const d=c.replace(/^```html\s*/,"");t.debug("Cleaned data:",{...n,data:d});const v=new DOMParser().parseFromString(d,"text/html").body.innerHTML;return t.debug("Extracted HTML body content:",{...n,data:v}),v}else{t.debug("Content-Type is not JSON, handling as text...",n);const c=await s.text();throw t.error("Received non-JSON response:",c,n),new Error("Received non-JSON response from server")}}async function Jc(r,e){const t={sourceFile:Nr};e.debug("Starting to list integrations...",t);const n=new URL(z6);n.searchParams.append("integration_scope",r);try{const s=await Xr(n,{method:"GET",headers:{"Content-Type":"application/json"}},e);if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const i=s.headers.get("content-type");if(i&&i.includes("application/json")){const c=await s.json();e.debug("Integrations:",{...t,data:c.integrations});const d=c.integrations.map(m=>({integration_type:m.integration_type,tenantId_userId:m.tenantId_userId,scope:r}));return await Ym(e,d),d||[]}else throw new Error("Received non-JSON response from server")}catch(s){throw e.error("Error listing integrations:",s,t),s}}async function By(r){const e={sourceFile:Nr};r.debug("Starting to check if Gmail integration is connected...",e);try{const t=await Xr(L6,{method:"GET",headers:{"Content-Type":"application/json"}},r);r.debug("Response received:",{...e,data:t});let n=!1;if(t.ok){const s=await t.json();r.debug("Parsed JSON response:",{...e,data:s}),n=s.is_registered===!0}return await DU(r,n),n}catch(t){r.error("Error checking Gmail connection status:",t,e);try{const n=await LU(r);if(n.isConnected!==null)return r.debug("Returning cached Gmail connection status due to error",{...e,cachedStatus:n.isConnected,cachedTimestamp:n.timestamp}),n.isConnected}catch(n){r.error("Error retrieving cached Gmail connection status:",n,e)}return!1}}async function t8(r,e){const t={sourceFile:Nr};try{const n=await Xr(M6,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email_thread_id:r})},e);if(e.debug("Response received:",{...t,data:n}),!n.ok)throw eu(e,n),new Error(`HTTP error! status: ${n.status}`);const s=n.headers.get("content-type");if(s&&s.includes("application/json")){const i=await n.json();if(!i||!i.message)throw new Error("Summary not found in response");let c=null;if(i.message.important_details)try{typeof i.message.important_details=="object"?(e.debug("Important details is already an object, using it directly...",t),c=i.message.important_details):typeof i.message.important_details=="string"&&(e.debug("Important details is a JSON string, parsing...",t),c=JSON.parse(i.message.important_details)),e.debug("Parsed important details:",{...t,data:c})}catch(d){e.error("Error parsing important details:",d,t),c=null}return{summary:i.message.summary,importantDetails:c,topicsDiscussed:i.message.topics_discussed,actionItems:i.message.action_items}}else throw new Error("Received non-JSON response from server")}catch(n){return e.error("Error caught:",n,t),{summary:"Error fetching email summary: "+n,importantDetails:null,topicsDiscussed:"",actionItems:""}}}async function SC(r,e,t){const n={sourceFile:Nr};try{const s=await Xr($6,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email_thread_id:r,email_thread_content:e})},t);if(t.debug("Response received:",{...n,data:s}),!s.ok)throw eu(t,s),new Error(`HTTP error! status: ${s.status}`);const i=s.headers.get("content-type");if(i&&i.includes("application/json")){const c=await s.json();if(!c||!c.message)throw new Error("Summary not found in response");return{description:c.message}}else throw new Error("Received non-JSON response from server")}catch(s){return t.error("Error caught:",s,n),{description:""}}}async function r8(r,e){const t={sourceFile:Nr};try{const n=await Xr(U6,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({full_thread:r})},e);if(e.debug("Response received:",{...t,data:n}),!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const s=n.headers.get("content-type");if(s&&s.includes("application/json")){const i=await n.json();if(!i||!i.message)throw new Error("Summary not found in response");let c=null;if(i.message.important_details)try{typeof i.message.important_details=="object"?(e.debug("Important details is already an object, using it directly...",t),c=i.message.important_details):typeof i.message.important_details=="string"&&(e.debug("Important details is a JSON string, parsing...",t),c=JSON.parse(i.message.important_details)),e.debug("Parsed important details:",{...t,data:c})}catch(d){e.error("Error parsing important details:",d,t),c=null}return{summary:i.message.summary,importantDetails:c,topicsDiscussed:i.message.topics_discussed,actionItems:i.message.action_items}}else throw new Error("Received non-JSON response from server")}catch(n){return e.error("Error caught:",n,t),{summary:"Error fetching email summary: "+n,importantDetails:null,topicsDiscussed:"",actionItems:""}}}async function V_(r,e,t,n=!1,s,i){const c={sourceFile:Nr,functionName:"getClientDataFromServer"},d=e.toLowerCase(),m=s!=null&&s.cursor?`:cursor_${s.cursor}`:"",p=`${r}:${d}${m}`,v=Tx.get(p);if(v)return t.debug("Returning existing in-flight request",{...c,clientEmail:e}),console.log(` [${r.toUpperCase()}] Deduplicating request for ${e} - returning in-flight promise`),v;const x=Dw(r,e,t,n,s,i);return Tx.set(p,x),x.finally(()=>{Tx.delete(p)})}async function Dw(r,e,t,n=!1,s,i,c=0){const d={sourceFile:Nr,functionName:"fetchClientDataInternal"},m=Date.now();if(console.group(` [${r.toUpperCase()}] getClientDataFromServer - ${e}${c>0?` (retry ${c})`:""}`),console.time("getClientDataFromServer:total"),console.log("Integration:",r),console.log("Client Email:",e),t.info("Starting client data fetch",{...d,clientEmail:e,integrationType:r,retryCount:c}),c===0){const T=H5(e);if(T.inCache)throw console.log(` Timeout cache hit: Email recently failed with ${T.errorType}`),console.timeEnd("getClientDataFromServer:total"),console.groupEnd(),t.info("Email in timeout cache, skipping API call to prevent retry storm",{...d,clientEmail:e,errorType:T.errorType,totalMs:Date.now()-m}),new Error(`Request recently failed (${T.errorType}) - try again later`)}console.time("getClientDataFromServer:nonExistentCacheCheck");const p=Date.now(),v=await Y5(e,t),x=Date.now()-p;if(console.timeEnd("getClientDataFromServer:nonExistentCacheCheck"),v)throw console.log(" Non-existent cache hit: Email known to have no client data"),console.timeEnd("getClientDataFromServer:total"),console.groupEnd(),t.info("Email in non-existent cache, skipping API call",{...d,clientEmail:e,nonExistentCacheCheckMs:x,totalMs:Date.now()-m}),new Error("Client not found (cached)");console.time("getClientDataFromServer:clientCacheCheck");const b=Date.now(),S=s!=null&&s.cursor?null:await Mm(e,t),N=Date.now()-b;if(console.timeEnd("getClientDataFromServer:clientCacheCheck"),S)return console.log(" Cache hit: Client data found in cache"),console.timeEnd("getClientDataFromServer:total"),console.groupEnd(),t.info("Client data found in cache",{...d,clientEmail:e,nonExistentCacheCheckMs:x,clientCacheCheckMs:N,totalMs:Date.now()-m}),S;const E=new URL(H6);E.searchParams.append("integration_type",r),E.searchParams.append("client_email",e),E.searchParams.append("data_type","client_data"),s&&(E.searchParams.append("limit",String(s.limit||10)),s.cursor&&E.searchParams.append("cursor",s.cursor)),i&&E.searchParams.append("thread_id",i),n&&E.searchParams.append("force_refresh","true");try{console.time("getClientDataFromServer:apiCall"),console.log(" Making API request to:",E.toString());const T=Date.now(),A=await Xr(E,{method:"GET",headers:{"Content-Type":"application/json"}},t),R=Date.now()-T,F=Hy(A);if(console.timeEnd("getClientDataFromServer:apiCall"),console.log(" Response status:",A.status,`(${R}ms)`),console.log(" Trace ID:",F||"N/A"),A.status===504||A.status===503)if(console.error(` ${A.status} Gateway Timeout - API call took too long`),console.log("Request URL:",E.toString()),console.log("Time elapsed before timeout:",R,"ms"),console.log(" Trace ID for debugging:",F||"N/A"),c<Mf){const L=bC*Math.pow(2,c);return console.log(` Retrying in ${L}ms (attempt ${c+1}/${Mf})`),console.timeEnd("getClientDataFromServer:total"),console.groupEnd(),t.info("Retrying after timeout",{...d,clientEmail:e,status:A.status,retryCount:c+1,delayMs:L,traceId:F}),await new Promise(G=>setTimeout(G,L)),Dw(r,e,t,n,s,i,c+1)}else vC(e,`${A.status}`),console.log(` Max retries (${Mf}) exhausted, added to timeout cache`),t.warn("Max retries exhausted for timeout error, added to timeout cache",{...d,clientEmail:e,status:A.status,retryCount:c,traceId:F});if(t.info("API response received",{...d,clientEmail:e,status:A.status,apiMs:R,nonExistentCacheCheckMs:x,clientCacheCheckMs:N,traceId:F,retryCount:c}),!A.ok){if(A.status===404&&(await K5(e,t),eu(t,A)),A.status===429)try{const L=await A.json(),G=Array.isArray(L==null?void 0:L.client_data)?L.client_data.length>0:(L==null?void 0:L.client_data)&&Object.keys(L.client_data).length>0,z=Array.isArray(L==null?void 0:L.case_data)?L.case_data.length>0:(L==null?void 0:L.case_data)&&Object.keys(L.case_data).length>0;return t.info("Rate limited response received",{sourceFile:Nr,hasCachedData:G||z,source:L==null?void 0:L.source,retryAfter:L==null?void 0:L.retry_after}),console.timeEnd("getClientDataFromServer:total"),console.groupEnd(),{client_data:Array.isArray(L==null?void 0:L.client_data)?L.client_data:[],case_data:Array.isArray(L==null?void 0:L.case_data)?L.case_data:[],pagination:L==null?void 0:L.pagination,_rate_limited:!0,_retry_after:L==null?void 0:L.retry_after}}catch{}if(console.error(" API error:",A.status),console.timeEnd("getClientDataFromServer:total"),console.groupEnd(),A.status===400)try{const L=await A.json();if(L!=null&&L.error)throw new Error(`HTTP error! status: 400 - ${L.error}`)}catch(L){if(L instanceof Error&&L.message.startsWith("HTTP error!"))throw L}throw new Error(`HTTP error! status: ${A.status}`)}const j=A.headers.get("content-type");if(j&&j.includes("application/json")){console.time("getClientDataFromServer:parseJson");const L=Date.now(),G=await A.json(),z=Date.now()-L;console.timeEnd("getClientDataFromServer:parseJson");const q=G.requestId,ae=G.traceId,oe=q||F;q&&console.log(" Request ID (from body):",q),ae&&console.log(" Trace ID (from body):",ae);const fe={client_data:G.client_data||{},case_data:G.case_data||[],pagination:G.pagination||void 0};console.time("getClientDataFromServer:cacheWrite");const H=Date.now();s!=null&&s.cursor||await vT(e,fe,t);const me=Date.now()-H;console.timeEnd("getClientDataFromServer:cacheWrite"),hT(e);const ee=Date.now()-m;return console.log(" Client data fetch completed"),console.log(" Timing breakdown:",{nonExistentCacheCheck:`${x}ms`,clientCacheCheck:`${N}ms`,apiCall:`${R}ms`,parseJson:`${z}ms`,cacheWrite:`${me}ms`,total:`${ee}ms`}),console.timeEnd("getClientDataFromServer:total"),console.groupEnd(),t.info("Client data fetch completed",{...d,clientEmail:e,nonExistentCacheCheckMs:x,clientCacheCheckMs:N,apiMs:R,parseMs:z,cacheWriteMs:me,totalMs:ee,retryCount:c,requestId:oe,traceId:ae||F}),fe}else throw console.error(" Received non-JSON response"),console.timeEnd("getClientDataFromServer:total"),console.groupEnd(),new Error("Received non-JSON response from server")}catch(T){const A=Date.now()-m;if(c<Mf&&_C(T)){const R=bC*Math.pow(2,c);return console.log(` Retrying after error in ${R}ms (attempt ${c+1}/${Mf})`),console.timeEnd("getClientDataFromServer:total"),console.groupEnd(),t.info("Retrying after network error",{...d,clientEmail:e,error:T instanceof Error?T.message:String(T),retryCount:c+1,delayMs:R}),await new Promise(F=>setTimeout(F,R)),Dw(r,e,t,n,s,i,c+1)}if(_C(T)){const R=T instanceof Error?T.message.includes("timeout")?"timeout":"network":"unknown";vC(e,R),console.log(` Max retries (${Mf}) exhausted for ${R} error, added to timeout cache`),t.warn("Max retries exhausted for network error, added to timeout cache",{...d,clientEmail:e,errorType:R,retryCount:c})}throw console.error(" Client data fetch failed:",T instanceof Error?T.message:String(T)),console.log(" Timing at failure:",{nonExistentCacheCheck:`${x}ms`,clientCacheCheck:`${N}ms`,total:`${A}ms`}),console.timeEnd("getClientDataFromServer:total"),console.groupEnd(),t.info("Client data fetch failed",{...d,clientEmail:e,error:T instanceof Error?T.message:String(T),nonExistentCacheCheckMs:x,clientCacheCheckMs:N,totalMs:A,retryCount:c}),T}}async function PT(r,e,t){const n={sourceFile:Nr,functionName:"getDocumentListForProject"};t.debug("Starting to fetch project documents...",{...n,projectId:e});const s=new URL(G6);s.searchParams.append("integration_type",r),s.searchParams.append("project_id",e);try{const i=await Xr(s,{method:"GET",headers:{"Content-Type":"application/json"}},t);if(t.debug("Response received:",{...n,data:i}),!i.ok){if(i.status===404)return eu(t,i),{documents:[]};throw new Error(`HTTP error! status: ${i.status}`)}const c=i.headers.get("content-type");if(c&&c.includes("application/json")){const d=await i.json();return t.debug("Parsed JSON response:",{...n,data:d}),{documents:d.documents||[]}}else throw new Error("Received non-JSON response from server")}catch(i){throw t.debug("Error fetching project documents:",{...n,error:i}),i}}async function n8(r,e,t){const n={sourceFile:Nr,functionName:"getCaseSummaryForProject"};t.debug("Starting to fetch case summary...",{...n,projectId:e});const s=new URL(W6);s.searchParams.append("integration_type",r),s.searchParams.append("project_id",e);try{const i=await Xr(s,{method:"GET",headers:{"Content-Type":"application/json"}},t);if(t.debug("Response received:",{...n,data:i}),!i.ok){if(i.status===404)return eu(t,i),null;throw new Error(`HTTP error! status: ${i.status}`)}const c=i.headers.get("content-type");if(c&&c.includes("application/json")){const d=await i.json();return t.debug("Parsed JSON response:",{...n,data:d}),{caseFacts:d.caseFacts||"",supioLink:d.supioLink||"",statuteoflimitations:d.statuteoflimitations||{dateValue:"",doneDate:null},disbursementSheet:d.disbursementSheet||null,totalMeds:d.totalMeds||0,totalLiens:d.totalLiens||0}}else throw new Error("Received non-JSON response from server")}catch(i){return t.debug("Error fetching case summary:",{...n,error:i}),null}}async function s8(r,e){const t={sourceFile:Nr,functionName:"getEmailParticipantsFromServer"};e.debug("Starting to fetch response...",t);const n={email_thread_id:r};try{const s=await Xr(O6,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)},e);if(e.debug("Response received:",{...t,data:s}),!s.ok)throw eu(e,s),new Error(`HTTP error! status: ${s.status}`);const i=s.headers.get("content-type");if(i&&i.includes("application/json")){const c=await s.json();return e.debug("Parsed JSON response:",{...t,data:c}),c.email_participants}else throw new Error("Received non-JSON response from server")}catch(s){throw e.error("Error fetching email participants:",s,t),s}}async function FT(r,e){const t={sourceFile:Nr,functionName:"getEmailParticipantsFromServer"};e.debug("Starting to fetch response...",t);const n={email_thread_id:r};try{const s=await Xr(D6,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)},e);if(e.debug("Response received:",{...t,data:s}),!s.ok)throw eu(e,s),new Error(`HTTP error! status: ${s.status}`);const i=s.headers.get("content-type");if(i&&i.includes("application/json")){const c=await s.json();return e.debug("Parsed JSON response:",{...t,data:c}),c.email_details}else throw new Error("Received non-JSON response from server")}catch(s){throw e.error("Error fetching email participants:",s,t),s}}async function o8(r,e,t){const n={sourceFile:Nr,functionName:"getDocumentURLFromServer"};t.debug("Starting to fetch document data...",n);const s=new URL(B6);s.searchParams.append("integration_type",r),s.searchParams.append("document_id",e);try{const i=await Xr(s,{method:"GET",headers:{"Content-Type":"application/json"}},t);if(t.debug("Response received:",{...n,data:i}),!i.ok)throw i.status===404?new Error("Document not found or integration not configured"):new Error(`HTTP error! status: ${i.status}`);const c=i.headers.get("content-type");if(c&&c.includes("application/json")){const d=await i.json();if(t.debug("Parsed JSON response:",{...n,data:d}),!d.url)throw new Error("Document URL not found in response");return{documentId:parseInt(e),url:d.url}}else throw new Error("Received non-JSON response from server")}catch(i){throw t.error("Error fetching document data:",i,n),i}}async function q_(r,e,t){var i,c;const n={sourceFile:Nr},s=Date.now();console.group(` [${r.toUpperCase()}] searchProjectsFromServer - "${e}"`),console.time("searchProjectsFromServer:total"),console.log("Integration:",r),console.log("Search Term:",e);try{t.info("Searching projects",{...n,integrationType:r,searchTerm:e});const d=new URL(q6);d.searchParams.append("integration_type",r),d.searchParams.append("search_term",e),d.searchParams.append("exclude_archived","true"),d.searchParams.append("limit","10"),console.time("searchProjectsFromServer:apiCall"),console.log(" Making API request to:",d.toString());const m=Date.now(),p=await Xr(d,{method:"GET",headers:{"Content-Type":"application/json"}},t),v=Date.now()-m,x=Hy(p);if(console.timeEnd("searchProjectsFromServer:apiCall"),console.log(" Response status:",p.status,`(${v}ms)`),console.log(" Trace ID:",x||"N/A"),p.status===504&&(console.error(" 504 Gateway Timeout - API call took too long"),console.log("Request URL:",d.toString()),console.log("Time elapsed before timeout:",v,"ms"),console.log(" Trace ID for debugging:",x||"N/A")),!p.ok){if(p.status===404)return console.log(" No projects found (404)"),console.timeEnd("searchProjectsFromServer:total"),console.groupEnd(),t.debug("No projects found",{...n,traceId:x}),{projects:[],total:0,hasMore:!1};throw console.error(" API error:",p.status),console.timeEnd("searchProjectsFromServer:total"),console.groupEnd(),new Error(`Search failed: ${p.status}`)}const b=p.headers.get("content-type");if(b&&b.includes("application/json")){console.time("searchProjectsFromServer:parseJson");const S=await p.json();console.timeEnd("searchProjectsFromServer:parseJson");const N=Date.now()-s;return console.log(" Project search completed"),console.log(" Results:",((i=S.projects)==null?void 0:i.length)||0,"projects found"),console.log(" Timing breakdown:",{apiCall:`${v}ms`,total:`${N}ms`}),console.timeEnd("searchProjectsFromServer:total"),console.groupEnd(),t.info("Project search successful",{...n,resultCount:((c=S.projects)==null?void 0:c.length)||0}),S}else throw console.error(" Received non-JSON response"),console.timeEnd("searchProjectsFromServer:total"),console.groupEnd(),new Error("Received non-JSON response from server")}catch(d){const m=Date.now()-s;throw console.error(" Project search failed:",d instanceof Error?d.message:String(d)),console.log(" Timing at failure:",{total:`${m}ms`}),console.timeEnd("searchProjectsFromServer:total"),console.groupEnd(),t.error("Error searching projects",d,{...n,integrationType:r,searchTerm:e}),d}}async function i8(r,e,t){var i,c,d,m;const n={sourceFile:Nr},s=Date.now();console.group(` [${r.toUpperCase()}] getProjectDataById - ${e}`),console.time("getProjectDataById:total"),console.log("Integration:",r),console.log("Project ID:",e);try{t.info("Fetching project data by ID",{...n,integrationType:r,projectId:e});const p=new URL(K6);p.searchParams.append("integration_type",r),p.searchParams.append("project_id",e),console.time("getProjectDataById:apiCall"),console.log(" Making API request to:",p.toString());const v=Date.now(),x=await Xr(p,{method:"GET",headers:{"Content-Type":"application/json"}},t),b=Date.now()-v,S=Hy(x);if(console.timeEnd("getProjectDataById:apiCall"),console.log(" Response status:",x.status,`(${b}ms)`),console.log(" Trace ID:",S||"N/A"),x.status===504&&(console.error(" 504 Gateway Timeout - API call took too long"),console.log("Request URL:",p.toString()),console.log("Time elapsed before timeout:",b,"ms"),console.log(" Trace ID for debugging:",S||"N/A")),!x.ok){if(x.status===404)return console.log(" Project not found (404)"),console.timeEnd("getProjectDataById:total"),console.groupEnd(),t.debug("Project not found",{...n,traceId:S}),{};throw console.error(" API error:",x.status),console.timeEnd("getProjectDataById:total"),console.groupEnd(),new Error(`Failed to fetch project: ${x.status}`)}const N=x.headers.get("content-type");if(N&&N.includes("application/json")){console.time("getProjectDataById:parseJson");const E=await x.json();console.timeEnd("getProjectDataById:parseJson");const T=E.project||{},A=Date.now()-s;return console.log(" Project data fetched successfully"),console.log(" Data includes:",{hasCalendarEntries:!!((i=T.case_data)!=null&&i.calendar_entries||T.calendar_entries),hasNotes:!!((c=T.case_data)!=null&&c.notes||T.notes),hasTasks:!!((d=T.case_data)!=null&&d.last_completed_task||(m=T.case_data)!=null&&m.next_upcoming_task)}),console.log(" Timing breakdown:",{apiCall:`${b}ms`,total:`${A}ms`}),console.timeEnd("getProjectDataById:total"),console.groupEnd(),t.info("Project data fetched successfully",{...n,projectId:e}),T}else throw console.error(" Received non-JSON response"),console.timeEnd("getProjectDataById:total"),console.groupEnd(),new Error("Received non-JSON response from server")}catch(p){const v=Date.now()-s;throw console.error(" Project data fetch failed:",p instanceof Error?p.message:String(p)),console.log(" Timing at failure:",{total:`${v}ms`}),console.timeEnd("getProjectDataById:total"),console.groupEnd(),t.error("Error fetching project by ID",p,{...n,integrationType:r,projectId:e}),p}}async function a8(r,e){const t={sourceFile:Nr,functionName:"getUserDataFromServer"},n=Date.now(),s=`getUserDataFromServer:${n}`;r.debug("Starting to fetch user data...",t);const i=new URL(V6);i.searchParams.append("integration_type",e);try{const c=await Xr(i,{method:"GET",headers:{"Content-Type":"application/json"}},r),d=Hy(c);if(console.timeEnd("getUserDataFromServer:apiCall"),c.status===504&&console.error(" 504 Gateway Timeout - API call took too long"),r.debug("Response received:",{...t,data:c,traceId:d}),!c.ok)throw c.status===400?(console.error(" API error: 400 - Missing required parameters"),new Error("Missing required parameters")):c.status===404?(console.error(" API error: 404 - No integration found"),new Error("No integration found for the specified type")):(console.error(" API error:",c.status),new Error(`HTTP error! status: ${c.status}`));const m=c.headers.get("content-type");if(m&&m.includes("application/json")){console.time("getUserDataFromServer:parseJson");const p=await c.json();return console.timeEnd("getUserDataFromServer:parseJson"),console.timeEnd(s),console.groupEnd(),r.debug("Parsed JSON response:",{...t,data:p}),{id:p.id||null,name:p.name||null,rate:p.rate||0}}else throw console.error(" Received non-JSON response"),new Error("Received non-JSON response from server")}catch(c){const d=Date.now()-n;throw console.error(" User data fetch failed:",c instanceof Error?c.message:String(c)),console.log(" Timing at failure:",{total:`${d}ms`}),console.timeEnd(s),console.groupEnd(),r.error("Error fetching user data:",c,t),c}}async function l8(r,e,t){var i,c;const n={sourceFile:Nr,functionName:"searchFirmUsersFromServer"};t.debug("Starting to search firm users...",{...n,integrationType:r,searchTerm:e});const s=new URL(TT);s.searchParams.append("integration_type",r),s.searchParams.append("request_function","search_firm_users"),s.searchParams.append("search_term",e),s.searchParams.append("limit","10");try{const d=await Xr(s,{method:"GET",headers:{"Content-Type":"application/json"}},t);if(t.debug("Response received:",{...n,status:d.status}),!d.ok){if(d.status===404)return t.debug("No users found",n),{users:[],total:0,hasMore:!1};throw new Error(`HTTP error! status: ${d.status}`)}const m=d.headers.get("content-type");if(m&&m.includes("application/json")){const p=await d.json();return t.debug("Parsed JSON response:",{...n,usersCount:((i=p.users)==null?void 0:i.length)||0}),{users:p.users||[],total:p.total||((c=p.users)==null?void 0:c.length)||0,hasMore:p.has_more||!1}}else throw new Error("Received non-JSON response from server")}catch(d){throw t.error("Error searching firm users:",d,n),d}}async function jT(r,e){var s;const t={sourceFile:Nr,functionName:"getFirmUsersFromServer"};e.debug("Starting to fetch firm users...",{...t,integrationType:r});const n=new URL(TT);n.searchParams.append("integration_type",r),n.searchParams.append("request_function","get_firm_users");try{const i=await Xr(n,{method:"GET",headers:{"Content-Type":"application/json"}},e);if(e.debug("Response received:",{...t,status:i.status}),!i.ok)throw new Error(`HTTP error! status: ${i.status}`);const c=i.headers.get("content-type");if(c&&c.includes("application/json")){const d=await i.json();return e.debug("Parsed JSON response:",{...t,usersCount:((s=d.users)==null?void 0:s.length)||0}),d.users||[]}else throw new Error("Received non-JSON response from server")}catch(i){throw e.error("Error fetching firm users:",i,t),i}}async function ay(r,e,t,n,s,i,c,d,m,p,v,x,b,S,N,E){const T={sourceFile:Nr,functionName:"writeTimeEntryToServer"};E.debug("Starting to write time entry to server...",T);try{const A=await Xr(Zm,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_email:r,function:"write_time_entry_to_clio",integration_type:e,date:t,quantity:n,description:s,matter_id:i,write_time_entry:c,email_subject:d,email_body:m,sent_at:p,sender_email:v,recipient_emails:x,non_billable:b,no_charge:S,price:N})},E);if(E.debug("Response received:",{...T,data:A,sourceFile:Nr}),!A.ok)throw new Error(`HTTP error! status: ${A.status}`);const R=A.headers.get("content-type");if(R&&R.includes("application/json")){const F=await A.json();return E.debug("Parsed JSON response:",{...T,data:F}),F.message||"Time entry written successfully"}else throw new Error("Received non-JSON response from server")}catch(A){throw E.error("Error writing time entry:",A,{...T,sourceFile:Nr}),A}}async function OT(r){const e={sourceFile:Nr,functionName:"getIntegrationSettingsFromServer"};r.debug("Starting to fetch integration settings...",{...e});const t=new URL(Y6);try{const n=await Xr(t,{method:"GET",headers:{"Content-Type":"application/json"}},r);if(r.debug("Response received:",{...e,data:n}),!n.ok){if(n.status===404)return r.debug("No settings found, returning defaults",e),{};throw new Error(`HTTP error! status: ${n.status}`)}const s=n.headers.get("content-type");if(s&&s.includes("application/json")){const i=await n.json();return r.debug("Parsed JSON response:",{...e,data:i}),i.integration_settings||{}}else throw new Error("Received non-JSON response from server")}catch(n){return r.error("Error fetching integration settings:",n,e),{}}}async function c8(r,e,t){const n={sourceFile:Nr,functionName:"generateTaskDescriptionFromEmail"};t.debug("Starting to generate task description from email...",n);try{const s=await Xr(J6,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({integration_type:r,email_content:e})},t);if(t.debug("Response received:",{...n,data:s}),!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const i=s.headers.get("content-type");if(i&&i.includes("application/json")){const c=await s.json();return t.debug("Parsed JSON response:",{...n,data:c}),{name:c.name||"",description:c.description||""}}else throw new Error("Received non-JSON response from server")}catch(s){throw t.error("Error generating task description:",s,n),s}}async function u8(r,e,t,n,s,i,c,d,m,p){const v={sourceFile:Nr,functionName:"createClioTask"};c.debug("Starting to create Clio task...",{...v,taskName:e,matterId:n,dueAt:s,priority:i,assigneeId:d,reminder:m,notificationFlags:p});try{const x={function:"write_task_to_clio",integration_type:r,name:e,description:t,matter_id:n,due_at:s,priority:i};d&&(x.assignee_id=d),m&&(x.reminder=m),p&&(x.notify_assignee=p.notifyAssignee,x.notify_completion=p.notifyCompletion);const b=await Xr(Zm,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(x)},c);if(c.debug("Response received:",{...v,data:b}),!b.ok)throw new Error(`HTTP error! status: ${b.status}`);const S=b.headers.get("content-type");if(S&&S.includes("application/json")){const N=await b.json();return c.debug("Parsed JSON response:",{...v,data:N}),{taskId:N.task_id||"",message:N.message||"Task created successfully"}}else throw new Error("Received non-JSON response from server")}catch(x){throw c.error("Error creating Clio task:",x,v),x}}async function d8(r,e,t,n,s,i,c){const d={sourceFile:Nr,functionName:"createClioNote"};try{const p=await Xr(Zm,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({function:"write_note_to_clio",integration_type:r,subject:e,detail:t,date:n,matter_id:s,contact_id:i})},c);if(!p.ok){const x=await p.json();throw new Error(x.message||`HTTP error! status: ${p.status}`)}const v=await p.json();return c.info("Note created successfully",{...d,noteId:v.note_id}),{noteId:v.note_id,message:v.message||"Note created successfully"}}catch(m){throw c.error("Error creating note",m,d),m}}async function f8(r,e){const t={sourceFile:Nr,functionName:"createContactInClio"};e.debug("Starting to create Clio contact...",{...t,email:r.email});try{const n=await Xr(Zm,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({function:"create_contact_in_clio",integration_type:"clio",first_name:r.firstName,last_name:r.lastName,email:r.email,phone_number:r.phoneNumber,contact_type:r.type,company_name:r.companyName})},e);if(e.debug("Response received:",{...t,data:n}),!n.ok){const c=(await n.json().catch(()=>({}))).error||`HTTP error! status: ${n.status}`;throw new Error(c)}const s=n.headers.get("content-type");if(s&&s.includes("application/json")){const i=await n.json();return e.debug("Parsed JSON response:",{...t,data:i}),{id:i.contact_id||i.id||"",message:i.message||"Contact created successfully"}}else throw new Error("Received non-JSON response from server")}catch(n){throw e.error("Error creating Clio contact:",n,t),n}}async function h8(r,e,t,n,s){const i={sourceFile:Nr,functionName:"linkContactToMatter"};s.debug("Starting to link contact to matter...",{...i,contactId:e,matterId:t,relationship:n});try{const c=await Xr(Zm,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({function:"link_contact_to_matter",integration_type:r,contact_id:e,matter_id:t,relationship:n})},s);if(s.debug("Response received:",{...i,data:c}),!c.ok){const p=(await c.json().catch(()=>({}))).error||`HTTP error! status: ${c.status}`;throw new Error(p)}const d=c.headers.get("content-type");if(d&&d.includes("application/json")){const m=await c.json();return s.debug("Parsed JSON response:",{...i,data:m}),{message:m.message||"Contact linked to matter successfully"}}else throw new Error("Received non-JSON response from server")}catch(c){throw s.error("Error linking contact to matter:",c,i),c}}function dn(){const r=w.useContext(G_);if(!r)throw new Error("usePlatform must be used within a PlatformProvider");if(!r.services)throw new Error("Platform services are not available. Services may still be loading or failed to initialize.");return r}const Qa=()=>dn().services.storage,ua=()=>dn().services.data,DT=()=>dn().services.auth,p8=()=>dn().services.messaging,m8=()=>dn().services.tabs,g8=()=>dn().services.lifecycle,v8=()=>dn().services.logging,y8=({children:r})=>{const[e,t]=w.useState(!0),[n,s]=w.useState(!1),[i,c]=w.useState(!1),[d,m]=w.useState(null),[p,v]=w.useState("loading"),[x,b]=w.useState(null),[S,N]=w.useState(0),E=v8(),{platform:T}=dn(),A=Qa(),R=w.useCallback(async()=>{if(T!=="chrome"){t(!1),v("disconnected"),b(new Date);return}c(!0),v("loading"),m(null);try{const z=await By(E);t(z),v(z?"connected":"disconnected"),b(new Date),z&&(N(0),n||(s(!0),A&&A.setLocalItem("wasEverConnectedGmail",!0).catch(q=>{E.error("Failed to save wasEverConnected to storage",q,{sourceFile:"src/shared/contexts/GmailConnectionContext/GmailConnectionProvider.tsx"})}))),E.debug("Gmail connection status checked",{sourceFile:"src/shared/contexts/GmailConnectionContext/GmailConnectionProvider.tsx",connected:z,status:z?"connected":"disconnected"})}catch(z){const q=z instanceof Error?z.message:"Unknown error occurred";m(q),t(!1),v("error"),b(new Date),E.error("Error checking Gmail connection",z,{sourceFile:"src/shared/contexts/GmailConnectionContext/GmailConnectionProvider.tsx"})}finally{c(!1)}},[E,T,n,A]),F=w.useCallback(async()=>{try{N(ee=>ee+1),v("loading"),m(null);const{initiateIntegration:z,findIntegrationById:q}=await _w(async()=>{const{initiateIntegration:ee,findIntegrationById:se}=await Promise.resolve().then(()=>T9);return{initiateIntegration:ee,findIntegrationById:se}},void 0),{GMAIL_INTEGRATION_PAGE_URI:ae,GMAIL_INTEGRATION_REDIRECT_URI:oe}=await _w(async()=>{const{GMAIL_INTEGRATION_PAGE_URI:ee,GMAIL_INTEGRATION_REDIRECT_URI:se}=await Promise.resolve().then(()=>EU);return{GMAIL_INTEGRATION_PAGE_URI:ee,GMAIL_INTEGRATION_REDIRECT_URI:se}},void 0),fe=ae(oe),H=await q("gmail");if(!H)throw new Error("Gmail integration not found");const me=await z(E,H,fe);return me?await R():v("disconnected"),me}catch(z){const q=z instanceof Error?z.message:"Failed to reconnect Gmail";throw m(q),v("error"),E.error("Failed to reconnect Gmail:",z,{sourceFile:"src/shared/contexts/GmailConnectionContext/GmailConnectionProvider.tsx",attemptNumber:S+1}),z}},[E,R,S]),j=w.useCallback(()=>{m(null),p==="error"&&v(e?"connected":"disconnected")},[p,e]),L=w.useCallback(async()=>{await R()},[R]);w.useEffect(()=>{if(T!=="chrome")return;const z=setInterval(()=>{R()},36e5);return()=>clearInterval(z)},[R,T]),w.useEffect(()=>{if(T!=="chrome")return;const q=(async()=>{try{const oe=(await Kn.createServices()).storage;if(oe.onChanged){const fe=H=>{if(H.gmailConnectionStatus){const me=H.gmailConnectionStatus.newValue;E.debug("Gmail connection status changed via storage",{sourceFile:"src/shared/contexts/GmailConnectionContext/GmailConnectionProvider.tsx",newStatus:me,oldStatus:H.gmailConnectionStatus.oldValue}),me!==void 0&&(t(me),v(me?"connected":"disconnected"),b(new Date),me&&d&&m(null))}};return oe.onChanged(fe),()=>{oe.removeChangeListener&&oe.removeChangeListener(fe)}}}catch(ae){E.error("Failed to set up Gmail connection storage listener:",ae,{sourceFile:"src/shared/contexts/GmailConnectionContext/GmailConnectionProvider.tsx"})}})();return()=>{q.then(ae=>ae==null?void 0:ae())}},[T,E,d]),w.useEffect(()=>{(async()=>{if(!(T!=="chrome"||!A))try{const q=await A.getLocalItem("wasEverConnectedGmail");q!==null&&(s(q),E.debug("Loaded wasEverConnected from storage",{sourceFile:"src/shared/contexts/GmailConnectionContext/GmailConnectionProvider.tsx",wasEverConnected:q}))}catch(q){E.error("Failed to load wasEverConnected from storage",q,{sourceFile:"src/shared/contexts/GmailConnectionContext/GmailConnectionProvider.tsx"})}})()},[T,A,E]),w.useEffect(()=>{R()},[R]);const G={isConnected:e,wasEverConnected:n,isLoading:i,error:d,status:p,lastChecked:x,reconnectAttempts:S,checkConnection:R,initiateReconnection:F,clearError:j,forceRefresh:L};return u.jsx(fT.Provider,{value:G,children:r})},LT=w.createContext(void 0),MT=()=>{const r=w.useContext(LT);if(!r)throw new Error("useActiveSection must be used within an ActiveSectionProvider");return r},x8=({children:r})=>{const[e,t]=w.useState("main");return u.jsx(LT.Provider,{value:{activeSection:e,setActiveSection:t},children:r})};var Se=typeof window<"u"?window:void 0,_s=typeof globalThis<"u"?globalThis:Se;typeof self>"u"&&(_s.self=_s),typeof File>"u"&&(_s.File=function(){});var $T=Array.prototype,EC=$T.forEach,CC=$T.indexOf,ni=_s==null?void 0:_s.navigator,Je=_s==null?void 0:_s.document,ws=_s==null?void 0:_s.location,Lw=_s==null?void 0:_s.fetch,Mw=_s!=null&&_s.XMLHttpRequest&&"withCredentials"in new _s.XMLHttpRequest?_s.XMLHttpRequest:void 0,kC=_s==null?void 0:_s.AbortController,Fo=ni==null?void 0:ni.userAgent,Rt=Se??{},Ul={DEBUG:!1,LIB_VERSION:"1.343.2"};function NC(r,e,t,n,s,i,c){try{var d=r[i](c),m=d.value}catch(p){return void t(p)}d.done?e(m):Promise.resolve(m).then(n,s)}function Yf(r){return function(){var e=this,t=arguments;return new Promise((function(n,s){var i=r.apply(e,t);function c(m){NC(i,n,s,c,d,"next",m)}function d(m){NC(i,n,s,c,d,"throw",m)}c(void 0)}))}}function tt(){return tt=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)({}).hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},tt.apply(null,arguments)}function UT(r,e){if(r==null)return{};var t={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(e.indexOf(n)!==-1)continue;t[n]=r[n]}return t}var w8=["amazonbot","amazonproductbot","app.hypefactors.com","applebot","archive.org_bot","awariobot","backlinksextendedbot","baiduspider","bingbot","bingpreview","chrome-lighthouse","dataforseobot","deepscan","duckduckbot","facebookexternal","facebookcatalog","http://yandex.com/bots","hubspot","ia_archiver","leikibot","linkedinbot","meta-externalagent","mj12bot","msnbot","nessus","petalbot","pinterest","prerender","rogerbot","screaming frog","sebot-wa","sitebulb","slackbot","slurp","trendictionbot","turnitin","twitterbot","vercel-screenshot","vercelbot","yahoo! slurp","yandexbot","zoombot","bot.htm","bot.php","(bot;","bot/","crawler","ahrefsbot","ahrefssiteaudit","semrushbot","siteauditbot","splitsignalbot","gptbot","oai-searchbot","chatgpt-user","perplexitybot","better uptime bot","sentryuptimebot","uptimerobot","headlesschrome","cypress","google-hoteladsverifier","adsbot-google","apis-google","duplexweb-google","feedfetcher-google","google favicon","google web preview","google-read-aloud","googlebot","googleother","google-cloudvertexbot","googleweblight","mediapartners-google","storebot-google","google-inspectiontool","bytespider"],TC=function(r,e){if(e===void 0&&(e=[]),!r)return!1;var t=r.toLowerCase();return w8.concat(e).some((n=>{var s=n.toLowerCase();return t.indexOf(s)!==-1}))},b8=["$snapshot","$pageview","$pageleave","$set","survey dismissed","survey sent","survey shown","$identify","$groupidentify","$create_alias","$$client_ingestion_warning","$web_experiment_applied","$feature_enrollment_update","$feature_flag_called"];function fr(r,e){return r.indexOf(e)!==-1}var Gy=function(r){return r.trim()},$w=function(r){return r.replace(/^\$/,"")},_8=Array.isArray,zT=Object.prototype,HT=zT.hasOwnProperty,Wy=zT.toString,Mr=_8||function(r){return Wy.call(r)==="[object Array]"},Vc=r=>typeof r=="function",Vn=r=>r===Object(r)&&!Mr(r),Jf=r=>{if(Vn(r)){for(var e in r)if(HT.call(r,e))return!1;return!0}return!1},Xe=r=>r===void 0,qn=r=>Wy.call(r)=="[object String]",Uw=r=>qn(r)&&r.trim().length===0,da=r=>r===null,mr=r=>Xe(r)||da(r),ql=r=>Wy.call(r)=="[object Number]"&&r==r,Vf=r=>ql(r)&&r>0,Wl=r=>Wy.call(r)==="[object Boolean]",S8=r=>r instanceof FormData,E8=r=>fr(b8,r);function zw(r){return r===null||typeof r!="object"}function ly(r,e){return Object.prototype.toString.call(r)==="[object "+e+"]"}function BT(r){return!Xe(Event)&&(function(e,t){try{return e instanceof t}catch{return!1}})(r,Event)}var C8=[!0,"true",1,"1","yes"],Ax=r=>fr(C8,r),k8=[!1,"false",0,"0","no"];function Ka(r,e,t,n,s){return e>t&&(n.warn("min cannot be greater than max."),e=t),ql(r)?r>t?(n.warn(" cannot be  greater than max: "+t+". Using max value instead."),t):r<e?(n.warn(" cannot be less than min: "+e+". Using min value instead."),e):r:(n.warn(" must be a number. using max or fallback. max: "+t+", fallback: "+s),Ka(s||t,e,t,n))}class N8{constructor(e){this.t={},this.i=e.i,this.o=Ka(e.bucketSize,0,100,e.h),this.m=Ka(e.refillRate,0,this.o,e.h),this.$=Ka(e.refillInterval,0,864e5,e.h)}S(e,t){var n=t-e.lastAccess,s=Math.floor(n/this.$);if(s>0){var i=s*this.m;e.tokens=Math.min(e.tokens+i,this.o),e.lastAccess=e.lastAccess+s*this.$}}consumeRateLimit(e){var t,n=Date.now(),s=String(e),i=this.t[s];return i?this.S(i,n):(i={tokens:this.o,lastAccess:n},this.t[s]=i),i.tokens===0||(i.tokens--,i.tokens===0&&((t=this.i)==null||t.call(this,e)),i.tokens===0)}stop(){this.t={}}}var Ii="Mobile",cy="iOS",Gl="Android",$m="Tablet",GT=Gl+" "+$m,WT="iPad",VT="Apple",qT=VT+" Watch",Um="Safari",dh="BlackBerry",KT="Samsung",YT=KT+"Browser",JT=KT+" Internet",ud="Chrome",T8=ud+" OS",XT=ud+" "+cy,K_="Internet Explorer",QT=K_+" "+Ii,Y_="Opera",A8=Y_+" Mini",J_="Edge",ZT="Microsoft "+J_,th="Firefox",eA=th+" "+cy,zm="Nintendo",Hm="PlayStation",rh="Xbox",tA=Gl+" "+Ii,rA=Ii+" "+Um,um="Windows",Hw=um+" Phone",AC="Nokia",Bw="Ouya",nA="Generic",R8=nA+" "+Ii.toLowerCase(),sA=nA+" "+$m.toLowerCase(),Gw="Konqueror",ao="(\\d+(\\.\\d+)?)",Rx=new RegExp("Version/"+ao),I8=new RegExp(rh,"i"),P8=new RegExp(Hm+" \\w+","i"),F8=new RegExp(zm+" \\w+","i"),X_=new RegExp(dh+"|PlayBook|BB10","i"),j8={"NT3.51":"NT 3.11","NT4.0":"NT 4.0","5.0":"2000",5.1:"XP",5.2:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1",6.4:"10","10.0":"10"},Ev,RC,Ix,O8=(r,e)=>e&&fr(e,VT)||(function(t){return fr(t,Um)&&!fr(t,ud)&&!fr(t,Gl)})(r),oA=function(r,e){return e=e||"",fr(r," OPR/")&&fr(r,"Mini")?A8:fr(r," OPR/")?Y_:X_.test(r)?dh:fr(r,"IE"+Ii)||fr(r,"WPDesktop")?QT:fr(r,YT)?JT:fr(r,J_)||fr(r,"Edg/")?ZT:fr(r,"FBIOS")?"Facebook "+Ii:fr(r,"UCWEB")||fr(r,"UCBrowser")?"UC Browser":fr(r,"CriOS")?XT:fr(r,"CrMo")||fr(r,ud)?ud:fr(r,Gl)&&fr(r,Um)?tA:fr(r,"FxiOS")?eA:fr(r.toLowerCase(),Gw.toLowerCase())?Gw:O8(r,e)?fr(r,Ii)?rA:Um:fr(r,th)?th:fr(r,"MSIE")||fr(r,"Trident/")?K_:fr(r,"Gecko")?th:""},D8={[QT]:[new RegExp("rv:"+ao)],[ZT]:[new RegExp(J_+"?\\/"+ao)],[ud]:[new RegExp("("+ud+"|CrMo)\\/"+ao)],[XT]:[new RegExp("CriOS\\/"+ao)],"UC Browser":[new RegExp("(UCBrowser|UCWEB)\\/"+ao)],[Um]:[Rx],[rA]:[Rx],[Y_]:[new RegExp("(Opera|OPR)\\/"+ao)],[th]:[new RegExp(th+"\\/"+ao)],[eA]:[new RegExp("FxiOS\\/"+ao)],[Gw]:[new RegExp("Konqueror[:/]?"+ao,"i")],[dh]:[new RegExp(dh+" "+ao),Rx],[tA]:[new RegExp("android\\s"+ao,"i")],[JT]:[new RegExp(YT+"\\/"+ao)],[K_]:[new RegExp("(rv:|MSIE )"+ao)],Mozilla:[new RegExp("rv:"+ao)]},L8=function(r,e){var t=oA(r,e),n=D8[t];if(Xe(n))return null;for(var s=0;s<n.length;s++){var i=n[s],c=r.match(i);if(c)return parseFloat(c[c.length-2])}return null},IC=[[new RegExp(rh+"; "+rh+" (.*?)[);]","i"),r=>[rh,r&&r[1]||""]],[new RegExp(zm,"i"),[zm,""]],[new RegExp(Hm,"i"),[Hm,""]],[X_,[dh,""]],[new RegExp(um,"i"),(r,e)=>{if(/Phone/.test(e)||/WPDesktop/.test(e))return[Hw,""];if(new RegExp(Ii).test(e)&&!/IEMobile\b/.test(e))return[um+" "+Ii,""];var t=/Windows NT ([0-9.]+)/i.exec(e);if(t&&t[1]){var n=t[1],s=j8[n]||"";return/arm/i.test(e)&&(s="RT"),[um,s]}return[um,""]}],[/((iPhone|iPad|iPod).*?OS (\d+)_(\d+)_?(\d+)?|iPhone)/,r=>{if(r&&r[3]){var e=[r[3],r[4],r[5]||"0"];return[cy,e.join(".")]}return[cy,""]}],[/(watch.*\/(\d+\.\d+\.\d+)|watch os,(\d+\.\d+),)/i,r=>{var e="";return r&&r.length>=3&&(e=Xe(r[2])?r[3]:r[2]),["watchOS",e]}],[new RegExp("("+Gl+" (\\d+)\\.(\\d+)\\.?(\\d+)?|"+Gl+")","i"),r=>{if(r&&r[2]){var e=[r[2],r[3],r[4]||"0"];return[Gl,e.join(".")]}return[Gl,""]}],[/Mac OS X (\d+)[_.](\d+)[_.]?(\d+)?/i,r=>{var e=["Mac OS X",""];if(r&&r[1]){var t=[r[1],r[2],r[3]||"0"];e[1]=t.join(".")}return e}],[/Mac/i,["Mac OS X",""]],[/CrOS/,[T8,""]],[/Linux|debian/i,["Linux",""]]],PC=function(r){return F8.test(r)?zm:P8.test(r)?Hm:I8.test(r)?rh:new RegExp(Bw,"i").test(r)?Bw:new RegExp("("+Hw+"|WPDesktop)","i").test(r)?Hw:/iPad/.test(r)?WT:/iPod/.test(r)?"iPod Touch":/iPhone/.test(r)?"iPhone":/(watch)(?: ?os[,/]|\d,\d\/)[\d.]+/i.test(r)?qT:X_.test(r)?dh:/(kobo)\s(ereader|touch)/i.test(r)?"Kobo":new RegExp(AC,"i").test(r)?AC:/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i.test(r)||/(kf[a-z]+)( bui|\)).+silk\//i.test(r)?"Kindle Fire":/(Android|ZTE)/i.test(r)?new RegExp(Ii).test(r)&&!/(9138B|TB782B|Nexus [97]|pixel c|HUAWEISHT|BTV|noble nook|smart ultra 6)/i.test(r)||/pixel[\daxl ]{1,6}/i.test(r)&&!/pixel c/i.test(r)||/(huaweimed-al00|tah-|APA|SM-G92|i980|zte|U304AA)/i.test(r)||/lmy47v/i.test(r)&&!/QTAQZ3/i.test(r)?Gl:GT:new RegExp("(pda|"+Ii+")","i").test(r)?R8:new RegExp($m,"i").test(r)&&!new RegExp($m+" pc","i").test(r)?sA:""},M8=r=>r instanceof Error;function $8(r){var e=globalThis._posthogChunkIds;if(e){var t=Object.keys(e);return Ix&&t.length===RC||(RC=t.length,Ix=t.reduce(((n,s)=>{Ev||(Ev={});var i=Ev[s];if(i)n[i[0]]=i[1];else for(var c=r(s),d=c.length-1;d>=0;d--){var m=c[d],p=m==null?void 0:m.filename,v=e[s];if(p&&v){n[p]=v,Ev[s]=[p,v];break}}return n}),{})),Ix}}class U8{constructor(e,t,n){n===void 0&&(n=[]),this.coercers=e,this.stackParser=t,this.modifiers=n}buildFromUnknown(e,t){t===void 0&&(t={});var n=t&&t.mechanism||{handled:!0,type:"generic"},s=this.buildCoercingContext(n,t,0).apply(e),i=this.buildParsingContext(t),c=this.parseStacktrace(s,i);return{$exception_list:this.convertToExceptionList(c,n),$exception_level:"error"}}modifyFrames(e){var t=this;return Yf((function*(){for(var n of e)n.stacktrace&&n.stacktrace.frames&&Mr(n.stacktrace.frames)&&(n.stacktrace.frames=yield t.applyModifiers(n.stacktrace.frames));return e}))()}coerceFallback(e){var t;return{type:"Error",value:"Unknown error",stack:(t=e.syntheticException)==null?void 0:t.stack,synthetic:!0}}parseStacktrace(e,t){var n,s;return e.cause!=null&&(n=this.parseStacktrace(e.cause,t)),e.stack!=""&&e.stack!=null&&(s=this.applyChunkIds(this.stackParser(e.stack,e.synthetic?t.skipFirstLines:0),t.chunkIdMap)),tt({},e,{cause:n,stack:s})}applyChunkIds(e,t){return e.map((n=>(n.filename&&t&&(n.chunk_id=t[n.filename]),n)))}applyCoercers(e,t){for(var n of this.coercers)if(n.match(e))return n.coerce(e,t);return this.coerceFallback(t)}applyModifiers(e){var t=this;return Yf((function*(){var n=e;for(var s of t.modifiers)n=yield s(n);return n}))()}convertToExceptionList(e,t){var n,s,i,c={type:e.type,value:e.value,mechanism:{type:(n=t.type)!==null&&n!==void 0?n:"generic",handled:(s=t.handled)===null||s===void 0||s,synthetic:(i=e.synthetic)!==null&&i!==void 0&&i}};e.stack&&(c.stacktrace={type:"raw",frames:e.stack});var d=[c];return e.cause!=null&&d.push(...this.convertToExceptionList(e.cause,tt({},t,{handled:!0}))),d}buildParsingContext(e){var t;return{chunkIdMap:$8(this.stackParser),skipFirstLines:(t=e.skipFirstLines)!==null&&t!==void 0?t:1}}buildCoercingContext(e,t,n){n===void 0&&(n=0);var s=(i,c)=>{if(c<=4){var d=this.buildCoercingContext(e,t,c);return this.applyCoercers(i,d)}};return tt({},t,{syntheticException:n==0?t.syntheticException:void 0,mechanism:e,apply:i=>s(i,n),next:i=>s(i,n+1)})}}var fh="?";function Ww(r,e,t,n,s){var i={platform:r,filename:e,function:t==="<anonymous>"?fh:t,in_app:!0};return Xe(n)||(i.lineno=n),Xe(s)||(i.colno=s),i}var iA=(r,e)=>{var t=r.indexOf("safari-extension")!==-1,n=r.indexOf("safari-web-extension")!==-1;return t||n?[r.indexOf("@")!==-1?r.split("@")[0]:fh,t?"safari-extension:"+e:"safari-web-extension:"+e]:[r,e]},z8=/^\s*at (\S+?)(?::(\d+))(?::(\d+))\s*$/i,H8=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,B8=/\((\S*)(?::(\d+))(?::(\d+))\)/,G8=(r,e)=>{var t=z8.exec(r);if(t){var[,n,s,i]=t;return Ww(e,n,fh,+s,+i)}var c=H8.exec(r);if(c){if(c[2]&&c[2].indexOf("eval")===0){var d=B8.exec(c[2]);d&&(c[2]=d[1],c[3]=d[2],c[4]=d[3])}var[m,p]=iA(c[1]||fh,c[2]);return Ww(e,p,m,c[3]?+c[3]:void 0,c[4]?+c[4]:void 0)}},W8=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,V8=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,q8=(r,e)=>{var t=W8.exec(r);if(t){if(t[3]&&t[3].indexOf(" > eval")>-1){var n=V8.exec(t[3]);n&&(t[1]=t[1]||"eval",t[3]=n[1],t[4]=n[2],t[5]="")}var s=t[3],i=t[1]||fh;return[i,s]=iA(i,s),Ww(e,s,i,t[4]?+t[4]:void 0,t[5]?+t[5]:void 0)}},FC=/\(error: (.*)\)/,jC=50;function K8(){return(function(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return function(s,i){i===void 0&&(i=0);for(var c=[],d=s.split(`
`),m=i;m<d.length;m++){var p=d[m];if(!(p.length>1024)){var v=FC.test(p)?p.replace(FC,"$1"):p;if(!v.match(/\S*Error: /)){for(var x of t){var b=x(v,r);if(b){c.push(b);break}}if(c.length>=jC)break}}}return(function(S){if(!S.length)return[];var N=Array.from(S);return N.reverse(),N.slice(0,jC).map((E=>{return tt({},E,{filename:E.filename||(T=N,T[T.length-1]||{}).filename,function:E.function||fh});var T}))})(c)}})("web:javascript",G8,q8)}class Y8{match(e){return this.isDOMException(e)||this.isDOMError(e)}coerce(e,t){var n=qn(e.stack);return{type:this.getType(e),value:this.getValue(e),stack:n?e.stack:void 0,cause:e.cause?t.next(e.cause):void 0,synthetic:!1}}getType(e){return this.isDOMError(e)?"DOMError":"DOMException"}getValue(e){var t=e.name||(this.isDOMError(e)?"DOMError":"DOMException");return e.message?t+": "+e.message:t}isDOMException(e){return ly(e,"DOMException")}isDOMError(e){return ly(e,"DOMError")}}class J8{match(e){return(t=>t instanceof Error)(e)}coerce(e,t){return{type:this.getType(e),value:this.getMessage(e,t),stack:this.getStack(e),cause:e.cause?t.next(e.cause):void 0,synthetic:!1}}getType(e){return e.name||e.constructor.name}getMessage(e,t){var n=e.message;return n.error&&typeof n.error.message=="string"?String(n.error.message):String(n)}getStack(e){return e.stacktrace||e.stack||void 0}}class X8{constructor(){}match(e){return ly(e,"ErrorEvent")&&e.error!=null}coerce(e,t){var n,s=t.apply(e.error);return s||{type:"ErrorEvent",value:e.message,stack:(n=t.syntheticException)==null?void 0:n.stack,synthetic:!0}}}var Q8=/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/i;class Z8{match(e){return typeof e=="string"}coerce(e,t){var n,[s,i]=this.getInfos(e);return{type:s??"Error",value:i??e,stack:(n=t.syntheticException)==null?void 0:n.stack,synthetic:!0}}getInfos(e){var t="Error",n=e,s=e.match(Q8);return s&&(t=s[1],n=s[2]),[t,n]}}var ez=["fatal","error","warning","log","info","debug"];function aA(r,e){e===void 0&&(e=40);var t=Object.keys(r);if(t.sort(),!t.length)return"[object has no keys]";for(var n=t.length;n>0;n--){var s=t.slice(0,n).join(", ");if(!(s.length>e))return n===t.length||s.length<=e?s:s.slice(0,e)+"..."}return""}class tz{match(e){return typeof e=="object"&&e!==null}coerce(e,t){var n,s=this.getErrorPropertyFromObject(e);return s?t.apply(s):{type:this.getType(e),value:this.getValue(e),stack:(n=t.syntheticException)==null?void 0:n.stack,level:this.isSeverityLevel(e.level)?e.level:"error",synthetic:!0}}getType(e){return BT(e)?e.constructor.name:"Error"}getValue(e){if("name"in e&&typeof e.name=="string"){var t="'"+e.name+"' captured as exception";return"message"in e&&typeof e.message=="string"&&(t+=" with message: '"+e.message+"'"),t}if("message"in e&&typeof e.message=="string")return e.message;var n=this.getObjectClassName(e);return(n&&n!=="Object"?"'"+n+"'":"Object")+" captured as exception with keys: "+aA(e)}isSeverityLevel(e){return qn(e)&&!Uw(e)&&ez.indexOf(e)>=0}getErrorPropertyFromObject(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var n=e[t];if(M8(n))return n}}getObjectClassName(e){try{var t=Object.getPrototypeOf(e);return t?t.constructor.name:void 0}catch{return}}}class rz{match(e){return BT(e)}coerce(e,t){var n,s=e.constructor.name;return{type:s,value:s+" captured as exception with keys: "+aA(e),stack:(n=t.syntheticException)==null?void 0:n.stack,synthetic:!0}}}class nz{match(e){return zw(e)}coerce(e,t){var n;return{type:"Error",value:"Primitive value captured as exception: "+String(e),stack:(n=t.syntheticException)==null?void 0:n.stack,synthetic:!0}}}class sz{match(e){return ly(e,"PromiseRejectionEvent")}coerce(e,t){var n,s=this.getUnhandledRejectionReason(e);return zw(s)?{type:"UnhandledRejection",value:"Non-Error promise rejection captured with value: "+String(s),stack:(n=t.syntheticException)==null?void 0:n.stack,synthetic:!0}:t.apply(s)}getUnhandledRejectionReason(e){if(zw(e))return e;try{if("reason"in e)return e.reason;if("detail"in e&&"reason"in e.detail)return e.detail.reason}catch{}return e}}var lA=function(r,e){var{debugEnabled:t}=e===void 0?{}:e,n={k:function(s){if(Se&&(Ul.DEBUG||Rt.POSTHOG_DEBUG||t)&&!Xe(Se.console)&&Se.console){for(var i=("__rrweb_original__"in Se.console[s])?Se.console[s].__rrweb_original__:Se.console[s],c=arguments.length,d=new Array(c>1?c-1:0),m=1;m<c;m++)d[m-1]=arguments[m];i(r,...d)}},info:function(){for(var s=arguments.length,i=new Array(s),c=0;c<s;c++)i[c]=arguments[c];n.k("log",...i)},warn:function(){for(var s=arguments.length,i=new Array(s),c=0;c<s;c++)i[c]=arguments[c];n.k("warn",...i)},error:function(){for(var s=arguments.length,i=new Array(s),c=0;c<s;c++)i[c]=arguments[c];n.k("error",...i)},critical:function(){for(var s=arguments.length,i=new Array(s),c=0;c<s;c++)i[c]=arguments[c];console.error(r,...i)},uninitializedWarning:s=>{n.error("You must initialize PostHog before calling "+s)},createLogger:(s,i)=>lA(r+" "+s,i)};return n},et=lA("[PostHog.js]"),Sn=et.createLogger,oz=Sn("[ExternalScriptsLoader]"),OC=(r,e,t)=>{if(r.config.disable_external_dependency_loading)return oz.warn(e+" was requested but loading of external scripts is disabled."),t("Loading of external scripts is disabled");var n=Je==null?void 0:Je.querySelectorAll("script");if(n){for(var s,i=function(){if(n[c].src===e){var m=n[c];return m.__posthog_loading_callback_fired?{v:t()}:(m.addEventListener("load",(p=>{m.__posthog_loading_callback_fired=!0,t(void 0,p)})),m.onerror=p=>t(p),{v:void 0})}},c=0;c<n.length;c++)if(s=i())return s.v}var d=()=>{if(!Je)return t("document not found");var m=Je.createElement("script");if(m.type="text/javascript",m.crossOrigin="anonymous",m.src=e,m.onload=x=>{m.__posthog_loading_callback_fired=!0,t(void 0,x)},m.onerror=x=>t(x),r.config.prepare_external_dependency_script&&(m=r.config.prepare_external_dependency_script(m)),!m)return t("prepare_external_dependency_script returned null");if(r.config.external_scripts_inject_target==="head")Je.head.appendChild(m);else{var p,v=Je.querySelectorAll("body > script");v.length>0?(p=v[0].parentNode)==null||p.insertBefore(m,v[0]):Je.body.appendChild(m)}};Je!=null&&Je.body?d():Je==null||Je.addEventListener("DOMContentLoaded",d)};Rt.__PosthogExtensions__=Rt.__PosthogExtensions__||{},Rt.__PosthogExtensions__.loadExternalDependency=(r,e,t)=>{var n="/static/"+e+".js?v="+r.version;if(e==="remote-config"&&(n="/array/"+r.config.token+"/config.js"),e==="toolbar"){var s=3e5;n=n+"&t="+Math.floor(Date.now()/s)*s}var i=r.requestRouter.endpointFor("assets",n);OC(r,i,t)},Rt.__PosthogExtensions__.loadSiteApp=(r,e,t)=>{var n=r.requestRouter.endpointFor("api",e);OC(r,n,t)};var uy={};function qc(r,e,t){if(Mr(r)){if(EC&&r.forEach===EC)r.forEach(e,t);else if("length"in r&&r.length===+r.length){for(var n=0,s=r.length;n<s;n++)if(n in r&&e.call(t,r[n],n)===uy)return}}}function rn(r,e,t){if(!mr(r)){if(Mr(r))return qc(r,e,t);if(S8(r)){for(var n of r.entries())if(e.call(t,n[1],n[0])===uy)return}else for(var s in r)if(HT.call(r,s)&&e.call(t,r[s],s)===uy)return}}var In=function(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return qc(t,(function(s){for(var i in s)s[i]!==void 0&&(r[i]=s[i])})),r},xh=function(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return qc(t,(function(s){qc(s,(function(i){r.push(i)}))})),r};function Vv(r){for(var e=Object.keys(r),t=e.length,n=new Array(t);t--;)n[t]=[e[t],r[e[t]]];return n}var DC=function(r){try{return r()}catch{return}},iz=function(r){return function(){try{for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.apply(this,t)}catch(s){et.critical("Implementation error. Please turn on debug mode and open a ticket on https://app.posthog.com/home#panel=support%3Asupport%3A."),et.critical(s)}}},Q_=function(r){var e={};return rn(r,(function(t,n){(qn(t)&&t.length>0||ql(t))&&(e[n]=t)})),e};function az(r,e){return t=r,n=i=>qn(i)&&!da(e)?i.slice(0,e):i,s=new Set,(function i(c,d){return c!==Object(c)?n?n(c,d):c:s.has(c)?void 0:(s.add(c),Mr(c)?(m=[],qc(c,(p=>{m.push(i(p))}))):(m={},rn(c,((p,v)=>{s.has(p)||(m[v]=i(p,v))}))),m);var m})(t);var t,n,s}var lz=["herokuapp.com","vercel.app","netlify.app"];function cz(r){var e=r==null?void 0:r.hostname;if(!qn(e))return!1;var t=e.split(".").slice(-2).join(".");for(var n of lz)if(t===n)return!1;return!0}function cA(r,e){for(var t=0;t<r.length;t++)if(e(r[t]))return r[t]}function Ln(r,e,t,n){var{capture:s=!1,passive:i=!0}=n??{};r==null||r.addEventListener(e,t,{capture:s,passive:i})}var uA="$people_distinct_id",dm="__alias",fm="__timers",LC="$autocapture_disabled_server_side",Vw="$heatmaps_enabled_server_side",MC="$exception_capture_enabled_server_side",qw="$error_tracking_suppression_rules",$C="$error_tracking_capture_extension_exceptions",UC="$web_vitals_enabled_server_side",dA="$dead_clicks_enabled_server_side",zC="$product_tours_enabled_server_side",HC="$web_vitals_allowed_metrics",Px="$session_recording_remote_config",dy="$sesid",fA="$session_is_sampled",Xf="$enabled_feature_flags",hm="$early_access_features",Kw="$feature_flag_details",pm="$stored_person_properties",td="$stored_group_properties",Yw="$surveys",fy="$flag_call_reported",zl="$user_state",Jw="$client_session_props",Xw="$capture_rate_limit",Qw="$initial_campaign_params",Zw="$initial_referrer_info",hy="$initial_person_info",py="$epp",hA="__POSTHOG_TOOLBAR__",Wp="$posthog_cookieless",uz=[uA,dm,"__cmpns",fm,"$session_recording_enabled_server_side",Vw,dy,Xf,qw,zl,hm,Kw,td,pm,Yw,fy,Jw,Xw,Qw,Zw,py,hy,"$conversations_widget_session_id","$conversations_ticket_id","$conversations_widget_state","$conversations_user_traits"];function BC(r){return r instanceof Element&&(r.id===hA||!(r.closest==null||!r.closest(".toolbar-global-fade-container")))}function Vy(r){return!!r&&r.nodeType===1}function Kc(r,e){return!!r&&!!r.tagName&&r.tagName.toLowerCase()===e.toLowerCase()}function pA(r){return!!r&&r.nodeType===3}function mA(r){return!!r&&r.nodeType===11}function Z_(r){return r?Gy(r).split(/\s+/):[]}function GC(r){var e=Se==null?void 0:Se.location.href;return!!(e&&r&&r.some((t=>e.match(t))))}function my(r){var e="";switch(typeof r.className){case"string":e=r.className;break;case"object":e=(r.className&&"baseVal"in r.className?r.className.baseVal:null)||r.getAttribute("class")||"";break;default:e=""}return Z_(e)}function gA(r){return mr(r)?null:Gy(r).split(/(\s+)/).filter((e=>Bm(e))).join("").replace(/[\r\n]/g," ").replace(/[ ]+/g," ").substring(0,255)}function eg(r){var e="";return eb(r)&&!bA(r)&&r.childNodes&&r.childNodes.length&&rn(r.childNodes,(function(t){var n;pA(t)&&t.textContent&&(e+=(n=gA(t.textContent))!==null&&n!==void 0?n:"")})),Gy(e)}function vA(r){return Xe(r.target)?r.srcElement||null:(e=r.target)!=null&&e.shadowRoot?r.composedPath()[0]||null:r.target||null;var e}var eS=["a","button","form","input","select","textarea","label"];function yA(r,e){if(Xe(e))return!0;var t,n=function(i){if(e.some((c=>i.matches(c))))return{v:!0}};for(var s of r)if(t=n(s))return t.v;return!1}function xA(r){var e=r.parentNode;return!(!e||!Vy(e))&&e}var dz=["next","previous","prev",">","<"],WC=10,VC=[".ph-no-rageclick",".ph-no-capture"];function fz(r,e){if(!Se||tS(r))return!1;var t,n,s;if(Wl(e)?(t=!!e&&VC,n=void 0):(t=(s=e==null?void 0:e.css_selector_ignorelist)!==null&&s!==void 0?s:VC,n=e==null?void 0:e.content_ignorelist),t===!1)return!1;var{targetElementList:i}=wA(r,!1);return!(function(c,d){if(c===!1||Xe(c))return!1;var m;if(c===!0)m=dz;else{if(!Mr(c))return!1;if(c.length>WC)return et.error("[PostHog] content_ignorelist array cannot exceed "+WC+" items. Use css_selector_ignorelist for more complex matching."),!1;m=c.map((p=>p.toLowerCase()))}return d.some((p=>{var{safeText:v,ariaLabel:x}=p;return m.some((b=>v.includes(b)||x.includes(b)))}))})(n,i.map((c=>{var d;return{safeText:eg(c).toLowerCase(),ariaLabel:((d=c.getAttribute("aria-label"))==null?void 0:d.toLowerCase().trim())||""}})))&&!yA(i,t)}var tS=r=>!r||Kc(r,"html")||!Vy(r),wA=(r,e)=>{if(!Se||tS(r))return{parentIsUsefulElement:!1,targetElementList:[]};for(var t=!1,n=[r],s=r;s.parentNode&&!Kc(s,"body");)if(mA(s.parentNode))n.push(s.parentNode.host),s=s.parentNode.host;else{var i=xA(s);if(!i)break;if(e||eS.indexOf(i.tagName.toLowerCase())>-1)t=!0;else{var c=Se.getComputedStyle(i);c&&c.getPropertyValue("cursor")==="pointer"&&(t=!0)}n.push(i),s=i}return{parentIsUsefulElement:t,targetElementList:n}};function hz(r,e,t,n,s){var i,c,d,m;if(t===void 0&&(t=void 0),!Se||tS(r)||(i=t)!=null&&i.url_allowlist&&!GC(t.url_allowlist)||(c=t)!=null&&c.url_ignorelist&&GC(t.url_ignorelist))return!1;if((d=t)!=null&&d.dom_event_allowlist){var p=t.dom_event_allowlist;if(p&&!p.some((N=>e.type===N)))return!1}var{parentIsUsefulElement:v,targetElementList:x}=wA(r,n);if(!(function(N,E){var T=E==null?void 0:E.element_allowlist;if(Xe(T))return!0;var A,R=function(j){if(T.some((L=>j.tagName.toLowerCase()===L)))return{v:!0}};for(var F of N)if(A=R(F))return A.v;return!1})(x,t)||!yA(x,(m=t)==null?void 0:m.css_selector_allowlist))return!1;var b=Se.getComputedStyle(r);if(b&&b.getPropertyValue("cursor")==="pointer"&&e.type==="click")return!0;var S=r.tagName.toLowerCase();switch(S){case"html":return!1;case"form":return(s||["submit"]).indexOf(e.type)>=0;case"input":case"select":case"textarea":return(s||["change","click"]).indexOf(e.type)>=0;default:return v?(s||["click"]).indexOf(e.type)>=0:(s||["click"]).indexOf(e.type)>=0&&(eS.indexOf(S)>-1||r.getAttribute("contenteditable")==="true")}}function eb(r){for(var e=r;e.parentNode&&!Kc(e,"body");e=e.parentNode){var t=my(e);if(fr(t,"ph-sensitive")||fr(t,"ph-no-capture"))return!1}if(fr(my(r),"ph-include"))return!0;var n=r.type||"";if(qn(n))switch(n.toLowerCase()){case"hidden":case"password":return!1}var s=r.name||r.id||"";return!(qn(s)&&/^cc|cardnum|ccnum|creditcard|csc|cvc|cvv|exp|pass|pwd|routing|seccode|securitycode|securitynum|socialsec|socsec|ssn/i.test(s.replace(/[^a-zA-Z0-9]/g,"")))}function bA(r){return!!(Kc(r,"input")&&!["button","checkbox","submit","reset"].includes(r.type)||Kc(r,"select")||Kc(r,"textarea")||r.getAttribute("contenteditable")==="true")}var _A="(4[0-9]{12}(?:[0-9]{3})?)|(5[1-5][0-9]{14})|(6(?:011|5[0-9]{2})[0-9]{12})|(3[47][0-9]{13})|(3(?:0[0-5]|[68][0-9])[0-9]{11})|((?:2131|1800|35[0-9]{3})[0-9]{11})",pz=new RegExp("^(?:"+_A+")$"),mz=new RegExp(_A),SA="\\d{3}-?\\d{2}-?\\d{4}",gz=new RegExp("^("+SA+")$"),vz=new RegExp("("+SA+")");function Bm(r,e){return e===void 0&&(e=!0),!(mr(r)||qn(r)&&(r=Gy(r),(e?pz:mz).test((r||"").replace(/[- ]/g,""))||(e?gz:vz).test(r)))}function EA(r){var e=eg(r);return Bm(e=(e+" "+CA(r)).trim())?e:""}function CA(r){var e="";return r&&r.childNodes&&r.childNodes.length&&rn(r.childNodes,(function(t){var n;if(t&&((n=t.tagName)==null?void 0:n.toLowerCase())==="span")try{var s=eg(t);e=(e+" "+s).trim(),t.childNodes&&t.childNodes.length&&(e=(e+" "+CA(t)).trim())}catch(i){et.error("[AutoCapture]",i)}})),e}function yz(r){return(function(e){var t=e.map((n=>{var s,i,c="";if(n.tag_name&&(c+=n.tag_name),n.attr_class)for(var d of(n.attr_class.sort(),n.attr_class))c+="."+d.replace(/"/g,"");var m=tt({},n.text?{text:n.text}:{},{"nth-child":(s=n.nth_child)!==null&&s!==void 0?s:0,"nth-of-type":(i=n.nth_of_type)!==null&&i!==void 0?i:0},n.href?{href:n.href}:{},n.attr_id?{attr_id:n.attr_id}:{},n.attributes),p={};return Vv(m).sort(((v,x)=>{var[b]=v,[S]=x;return b.localeCompare(S)})).forEach((v=>{var[x,b]=v;return p[qC(x.toString())]=qC(b.toString())})),c+=":",c+=Vv(p).map((v=>{var[x,b]=v;return x+'="'+b+'"'})).join("")}));return t.join(";")})((function(e){return e.map((t=>{var n,s,i={text:(n=t.$el_text)==null?void 0:n.slice(0,400),tag_name:t.tag_name,href:(s=t.attr__href)==null?void 0:s.slice(0,2048),attr_class:xz(t),attr_id:t.attr__id,nth_child:t.nth_child,nth_of_type:t.nth_of_type,attributes:{}};return Vv(t).filter((c=>{var[d]=c;return d.indexOf("attr__")===0})).forEach((c=>{var[d,m]=c;return i.attributes[d]=m})),i}))})(r))}function qC(r){return r.replace(/"|\\"/g,'\\"')}function xz(r){var e=r.attr__class;return e?Mr(e)?e:Z_(e):void 0}class kA{constructor(e){this.disabled=e===!1;var t=Vn(e)?e:{};this.thresholdPx=t.threshold_px||30,this.timeoutMs=t.timeout_ms||1e3,this.clickCount=t.click_count||3,this.clicks=[]}isRageClick(e,t,n){if(this.disabled)return!1;var s=this.clicks[this.clicks.length-1];if(s&&Math.abs(e-s.x)+Math.abs(t-s.y)<this.thresholdPx&&n-s.timestamp<this.timeoutMs){if(this.clicks.push({x:e,y:t,timestamp:n}),this.clicks.length===this.clickCount)return!0}else this.clicks=[{x:e,y:t,timestamp:n}];return!1}}var gy=r=>{var e=Je==null?void 0:Je.createElement("a");return Xe(e)?null:(e.href=r,e)},wz=function(r,e){var t,n;e===void 0&&(e="&");var s=[];return rn(r,(function(i,c){Xe(i)||Xe(c)||c==="undefined"||(t=encodeURIComponent((d=>d instanceof File)(i)?i.name:i.toString()),n=encodeURIComponent(c),s[s.length]=n+"="+t)})),s.join(e)},vy=function(r,e){for(var t,n=((r.split("#")[0]||"").split(/\?(.*)/)[1]||"").replace(/^\?+/g,"").split("&"),s=0;s<n.length;s++){var i=n[s].split("=");if(i[0]===e){t=i;break}}if(!Mr(t)||t.length<2)return"";var c=t[1];try{c=decodeURIComponent(c)}catch{et.error("Skipping decoding for malformed query param: "+c)}return c.replace(/\+/g," ")},tg=function(r,e,t){if(!r||!e||!e.length)return r;for(var n=r.split("#"),s=n[0]||"",i=n[1],c=s.split("?"),d=c[1],m=c[0],p=(d||"").split("&"),v=[],x=0;x<p.length;x++){var b=p[x].split("=");Mr(b)&&(e.includes(b[0])?v.push(b[0]+"="+t):v.push(p[x]))}var S=m;return d!=null&&(S+="?"+v.join("&")),i!=null&&(S+="#"+i),S},yy=function(r,e){var t=r.match(new RegExp(e+"=([^&]*)"));return t?t[1]:null},Fx="$copy_autocapture",KC=Sn("[AutoCapture]");function jx(r,e){return e.length>r?e.slice(0,r)+"...":e}function bz(r){if(r.previousElementSibling)return r.previousElementSibling;var e=r;do e=e.previousSibling;while(e&&!Vy(e));return e}function _z(r,e,t,n){var s=r.tagName.toLowerCase(),i={tag_name:s};eS.indexOf(s)>-1&&!t&&(s.toLowerCase()==="a"||s.toLowerCase()==="button"?i.$el_text=jx(1024,EA(r)):i.$el_text=jx(1024,eg(r)));var c=my(r);c.length>0&&(i.classes=c.filter((function(v){return v!==""}))),rn(r.attributes,(function(v){var x;if((!bA(r)||["name","id","class","aria-label"].indexOf(v.name)!==-1)&&(n==null||!n.includes(v.name))&&!e&&Bm(v.value)&&(x=v.name,!qn(x)||x.substring(0,10)!=="_ngcontent"&&x.substring(0,7)!=="_nghost")){var b=v.value;v.name==="class"&&(b=Z_(b).join(" ")),i["attr__"+v.name]=jx(1024,b)}}));for(var d=1,m=1,p=r;p=bz(p);)d++,p.tagName===r.tagName&&m++;return i.nth_child=d,i.nth_of_type=m,i}function Sz(r,e){for(var t,n,{e:s,maskAllElementAttributes:i,maskAllText:c,elementAttributeIgnoreList:d,elementsChainAsString:m}=e,p=[r],v=r;v.parentNode&&!Kc(v,"body");)mA(v.parentNode)?(p.push(v.parentNode.host),v=v.parentNode.host):(p.push(v.parentNode),v=v.parentNode);var x,b=[],S={},N=!1,E=!1;if(rn(p,(j=>{var L=eb(j);j.tagName.toLowerCase()==="a"&&(N=j.getAttribute("href"),N=L&&N&&Bm(N)&&N),fr(my(j),"ph-no-capture")&&(E=!0),b.push(_z(j,i,c,d));var G=(function(z){if(!eb(z))return{};var q={};return rn(z.attributes,(function(ae){if(ae.name&&ae.name.indexOf("data-ph-capture-attribute")===0){var oe=ae.name.replace("data-ph-capture-attribute-",""),fe=ae.value;oe&&fe&&Bm(fe)&&(q[oe]=fe)}})),q})(j);In(S,G)})),E)return{props:{},explicitNoCapture:E};if(c||(r.tagName.toLowerCase()==="a"||r.tagName.toLowerCase()==="button"?b[0].$el_text=EA(r):b[0].$el_text=eg(r)),N){var T,A;b[0].attr__href=N;var R=(T=gy(N))==null?void 0:T.host,F=Se==null||(A=Se.location)==null?void 0:A.host;R&&F&&R!==F&&(x=N)}return{props:In({$event_type:s.type,$ce_version:1},m?{}:{$elements:b},{$elements_chain:yz(b)},(t=b[0])!=null&&t.$el_text?{$el_text:(n=b[0])==null?void 0:n.$el_text}:{},x&&s.type==="click"?{$external_click_url:x}:{},S)}}class Ez{constructor(e){this.P=!1,this.T=null,this.I=!1,this.instance=e,this.rageclicks=new kA(e.config.rageclick),this.C=null}get R(){var e,t,n=Vn(this.instance.config.autocapture)?this.instance.config.autocapture:{};return n.url_allowlist=(e=n.url_allowlist)==null?void 0:e.map((s=>new RegExp(s))),n.url_ignorelist=(t=n.url_ignorelist)==null?void 0:t.map((s=>new RegExp(s))),n}F(){if(this.isBrowserSupported()){if(Se&&Je){var e=n=>{n=n||(Se==null?void 0:Se.event);try{this.O(n)}catch(s){KC.error("Failed to capture event",s)}};if(Ln(Je,"submit",e,{capture:!0}),Ln(Je,"change",e,{capture:!0}),Ln(Je,"click",e,{capture:!0}),this.R.capture_copied_text){var t=n=>{n=n||(Se==null?void 0:Se.event),this.O(n,Fx)};Ln(Je,"copy",t,{capture:!0}),Ln(Je,"cut",t,{capture:!0})}}}else KC.info("Disabling Automatic Event Collection because this browser is not supported")}startIfEnabled(){this.isEnabled&&!this.P&&(this.F(),this.P=!0)}onRemoteConfig(e){e.elementsChainAsString&&(this.I=e.elementsChainAsString),this.instance.persistence&&this.instance.persistence.register({[LC]:!!e.autocapture_opt_out}),this.T=!!e.autocapture_opt_out,this.startIfEnabled()}setElementSelectors(e){this.C=e}getElementSelectors(e){var t,n=[];return(t=this.C)==null||t.forEach((s=>{var i=Je==null?void 0:Je.querySelectorAll(s);i==null||i.forEach((c=>{e===c&&n.push(s)}))})),n}get isEnabled(){var e,t,n=(e=this.instance.persistence)==null?void 0:e.props[LC],s=this.T;if(da(s)&&!Wl(n)&&!this.instance.M())return!1;var i=(t=this.T)!==null&&t!==void 0?t:!!n;return!!this.instance.config.autocapture&&!i}O(e,t){if(t===void 0&&(t="$autocapture"),this.isEnabled){var n,s=vA(e);pA(s)&&(s=s.parentNode||null),t==="$autocapture"&&e.type==="click"&&e instanceof MouseEvent&&this.instance.config.rageclick&&(n=this.rageclicks)!=null&&n.isRageClick(e.clientX,e.clientY,e.timeStamp||new Date().getTime())&&fz(s,this.instance.config.rageclick)&&this.O(e,"$rageclick");var i=t===Fx;if(s&&hz(s,e,this.R,i,i?["copy","cut"]:void 0)){var{props:c,explicitNoCapture:d}=Sz(s,{e,maskAllElementAttributes:this.instance.config.mask_all_element_attributes,maskAllText:this.instance.config.mask_all_text,elementAttributeIgnoreList:this.R.element_attribute_ignorelist,elementsChainAsString:this.I});if(d)return!1;var m=this.getElementSelectors(s);if(m&&m.length>0&&(c.$element_selectors=m),t===Fx){var p,v=gA(Se==null||(p=Se.getSelection())==null?void 0:p.toString()),x=e.type||"clipboard";if(!v)return!1;c.$selected_content=v,c.$copy_type=x}return this.instance.capture(t,c),!0}}}isBrowserSupported(){return Vc(Je==null?void 0:Je.querySelectorAll)}}Math.trunc||(Math.trunc=function(r){return r<0?Math.ceil(r):Math.floor(r)}),Number.isInteger||(Number.isInteger=function(r){return ql(r)&&isFinite(r)&&Math.floor(r)===r});var YC="0123456789abcdef";class xy{constructor(e){if(this.bytes=e,e.length!==16)throw new TypeError("not 128-bit length")}static fromFieldsV7(e,t,n,s){if(!Number.isInteger(e)||!Number.isInteger(t)||!Number.isInteger(n)||!Number.isInteger(s)||e<0||t<0||n<0||s<0||e>0xffffffffffff||t>4095||n>1073741823||s>4294967295)throw new RangeError("invalid field value");var i=new Uint8Array(16);return i[0]=e/Math.pow(2,40),i[1]=e/Math.pow(2,32),i[2]=e/Math.pow(2,24),i[3]=e/Math.pow(2,16),i[4]=e/Math.pow(2,8),i[5]=e,i[6]=112|t>>>8,i[7]=t,i[8]=128|n>>>24,i[9]=n>>>16,i[10]=n>>>8,i[11]=n,i[12]=s>>>24,i[13]=s>>>16,i[14]=s>>>8,i[15]=s,new xy(i)}toString(){for(var e="",t=0;t<this.bytes.length;t++)e=e+YC.charAt(this.bytes[t]>>>4)+YC.charAt(15&this.bytes[t]),t!==3&&t!==5&&t!==7&&t!==9||(e+="-");if(e.length!==36)throw new Error("Invalid UUIDv7 was generated");return e}clone(){return new xy(this.bytes.slice(0))}equals(e){return this.compareTo(e)===0}compareTo(e){for(var t=0;t<16;t++){var n=this.bytes[t]-e.bytes[t];if(n!==0)return Math.sign(n)}return 0}}class Cz{constructor(){this.A=0,this.j=0,this.D=new kz}generate(){var e=this.generateOrAbort();if(Xe(e)){this.A=0;var t=this.generateOrAbort();if(Xe(t))throw new Error("Could not generate UUID after timestamp reset");return t}return e}generateOrAbort(){var e=Date.now();if(e>this.A)this.A=e,this.L();else{if(!(e+1e4>this.A))return;this.j++,this.j>4398046511103&&(this.A++,this.L())}return xy.fromFieldsV7(this.A,Math.trunc(this.j/Math.pow(2,30)),this.j&Math.pow(2,30)-1,this.D.nextUint32())}L(){this.j=1024*this.D.nextUint32()+(1023&this.D.nextUint32())}}var JC,NA=r=>{if(typeof UUIDV7_DENY_WEAK_RNG<"u"&&UUIDV7_DENY_WEAK_RNG)throw new Error("no cryptographically strong RNG available");for(var e=0;e<r.length;e++)r[e]=65536*Math.trunc(65536*Math.random())+Math.trunc(65536*Math.random());return r};Se&&!Xe(Se.crypto)&&crypto.getRandomValues&&(NA=r=>crypto.getRandomValues(r));class kz{constructor(){this.N=new Uint32Array(8),this.U=1/0}nextUint32(){return this.U>=this.N.length&&(NA(this.N),this.U=0),this.N[this.U++]}}var Gc=()=>Nz().toString(),Nz=()=>(JC||(JC=new Cz)).generate(),Vp="",Tz=/[a-z0-9][a-z0-9-]+\.[a-z]{2,}$/i;function Az(r,e){if(e){var t=(function(s,i){if(i===void 0&&(i=Je),Vp)return Vp;if(!i||["localhost","127.0.0.1"].includes(s))return"";for(var c=s.split("."),d=Math.min(c.length,8),m="dmn_chk_"+Gc();!Vp&&d--;){var p=c.slice(d).join("."),v=m+"=1;domain=."+p+";path=/";i.cookie=v+";max-age=3",i.cookie.includes(m)&&(i.cookie=v+";max-age=0",Vp=p)}return Vp})(r);if(!t){var n=(s=>{var i=s.match(Tz);return i?i[0]:""})(r);n!==t&&et.info("Warning: cookie subdomain discovery mismatch",n,t),t=n}return t?"; domain=."+t:""}return""}var Ga={H:()=>!!Je,B:function(r){et.error("cookieStore error: "+r)},q:function(r){if(Je){try{for(var e=r+"=",t=Je.cookie.split(";").filter((i=>i.length)),n=0;n<t.length;n++){for(var s=t[n];s.charAt(0)==" ";)s=s.substring(1,s.length);if(s.indexOf(e)===0)return decodeURIComponent(s.substring(e.length,s.length))}}catch{}return null}},W:function(r){var e;try{e=JSON.parse(Ga.q(r))||{}}catch{}return e},G:function(r,e,t,n,s){if(Je)try{var i="",c="",d=Az(Je.location.hostname,n);if(t){var m=new Date;m.setTime(m.getTime()+24*t*60*60*1e3),i="; expires="+m.toUTCString()}s&&(c="; secure");var p=r+"="+encodeURIComponent(JSON.stringify(e))+i+"; SameSite=Lax; path=/"+d+c;return p.length>3686.4&&et.warn("cookieStore warning: large cookie, len="+p.length),Je.cookie=p,p}catch{return}},V:function(r,e){if(Je!=null&&Je.cookie)try{Ga.G(r,"",-1,e)}catch{return}}},Ox=null,gn={H:function(){if(!da(Ox))return Ox;var r=!0;if(Xe(Se))r=!1;else try{var e="__mplssupport__";gn.G(e,"xyz"),gn.q(e)!=='"xyz"'&&(r=!1),gn.V(e)}catch{r=!1}return r||et.error("localStorage unsupported; falling back to cookie store"),Ox=r,r},B:function(r){et.error("localStorage error: "+r)},q:function(r){try{return Se==null?void 0:Se.localStorage.getItem(r)}catch(e){gn.B(e)}return null},W:function(r){try{return JSON.parse(gn.q(r))||{}}catch{}return null},G:function(r,e){try{Se==null||Se.localStorage.setItem(r,JSON.stringify(e))}catch(t){gn.B(t)}},V:function(r){try{Se==null||Se.localStorage.removeItem(r)}catch(e){gn.B(e)}}},Rz=["$device_id","distinct_id",dy,fA,py,hy],Cv={},Iz={H:function(){return!0},B:function(r){et.error("memoryStorage error: "+r)},q:function(r){return Cv[r]||null},W:function(r){return Cv[r]||null},G:function(r,e){Cv[r]=e},V:function(r){delete Cv[r]}},Qu=null,ys={H:function(){if(!da(Qu))return Qu;if(Qu=!0,Xe(Se))Qu=!1;else try{var r="__support__";ys.G(r,"xyz"),ys.q(r)!=='"xyz"'&&(Qu=!1),ys.V(r)}catch{Qu=!1}return Qu},B:function(r){et.error("sessionStorage error: ",r)},q:function(r){try{return Se==null?void 0:Se.sessionStorage.getItem(r)}catch(e){ys.B(e)}return null},W:function(r){try{return JSON.parse(ys.q(r))||null}catch{}return null},G:function(r,e){try{Se==null||Se.sessionStorage.setItem(r,JSON.stringify(e))}catch(t){ys.B(t)}},V:function(r){try{Se==null||Se.sessionStorage.removeItem(r)}catch(e){ys.B(e)}}},Hl=(function(r){return r[r.PENDING=-1]="PENDING",r[r.DENIED=0]="DENIED",r[r.GRANTED=1]="GRANTED",r})({});class Pz{constructor(e){this._instance=e}get R(){return this._instance.config}get consent(){return this.J()?Hl.DENIED:this.K}isOptedOut(){return this.R.cookieless_mode==="always"||this.consent===Hl.DENIED||this.consent===Hl.PENDING&&(this.R.opt_out_capturing_by_default||this.R.cookieless_mode==="on_reject")}isOptedIn(){return!this.isOptedOut()}isExplicitlyOptedOut(){return this.consent===Hl.DENIED}optInOut(e){this.Y.G(this.X,e?1:0,this.R.cookie_expiration,this.R.cross_subdomain_cookie,this.R.secure_cookie)}reset(){this.Y.V(this.X,this.R.cross_subdomain_cookie)}get X(){var{token:e,opt_out_capturing_cookie_prefix:t,consent_persistence_name:n}=this._instance.config;return n||(t?t+e:"__ph_opt_in_out_"+e)}get K(){var e=this.Y.q(this.X);return Ax(e)?Hl.GRANTED:fr(k8,e)?Hl.DENIED:Hl.PENDING}get Y(){if(!this.Z){var e=this.R.opt_out_capturing_persistence_type;this.Z=e==="localStorage"?gn:Ga;var t=e==="localStorage"?Ga:gn;t.q(this.X)&&(this.Z.q(this.X)||this.optInOut(Ax(t.q(this.X))),t.V(this.X,this.R.cross_subdomain_cookie))}return this.Z}J(){return!!this.R.respect_dnt&&!!cA([ni==null?void 0:ni.doNotTrack,ni==null?void 0:ni.msDoNotTrack,Rt.doNotTrack],(e=>Ax(e)))}}var kv=Sn("[Dead Clicks]"),Fz=()=>!0,jz=r=>{var e,t=!((e=r.instance.persistence)==null||!e.get_property(dA)),n=r.instance.config.capture_dead_clicks;return Wl(n)?n:!!Vn(n)||t};class TA{get lazyLoadedDeadClicksAutocapture(){return this.tt}constructor(e,t,n){this.instance=e,this.isEnabled=t,this.onCapture=n,this.startIfEnabled()}onRemoteConfig(e){this.instance.persistence&&this.instance.persistence.register({[dA]:e==null?void 0:e.captureDeadClicks}),this.startIfEnabled()}startIfEnabled(){this.isEnabled(this)&&this.it((()=>{this.et()}))}it(e){var t,n;(t=Rt.__PosthogExtensions__)!=null&&t.initDeadClicksAutocapture&&e(),(n=Rt.__PosthogExtensions__)==null||n.loadExternalDependency==null||n.loadExternalDependency(this.instance,"dead-clicks-autocapture",(s=>{s?kv.error("failed to load script",s):e()}))}et(){var e;if(Je){if(!this.tt&&(e=Rt.__PosthogExtensions__)!=null&&e.initDeadClicksAutocapture){var t=Vn(this.instance.config.capture_dead_clicks)?this.instance.config.capture_dead_clicks:{};t.__onCapture=this.onCapture,this.tt=Rt.__PosthogExtensions__.initDeadClicksAutocapture(this.instance,t),this.tt.start(Je),kv.info("starting...")}}else kv.error("`document` not found. Cannot start.")}stop(){this.tt&&(this.tt.stop(),this.tt=void 0,kv.info("stopping..."))}}var qp=Sn("[ExceptionAutocapture]");class Oz{constructor(e){var t,n,s;this.rt=()=>{var i;if(Se&&this.isEnabled&&(i=Rt.__PosthogExtensions__)!=null&&i.errorWrappingFunctions){var c=Rt.__PosthogExtensions__.errorWrappingFunctions.wrapOnError,d=Rt.__PosthogExtensions__.errorWrappingFunctions.wrapUnhandledRejection,m=Rt.__PosthogExtensions__.errorWrappingFunctions.wrapConsoleError;try{!this.st&&this.R.capture_unhandled_errors&&(this.st=c(this.captureException.bind(this))),!this.nt&&this.R.capture_unhandled_rejections&&(this.nt=d(this.captureException.bind(this))),!this.ot&&this.R.capture_console_errors&&(this.ot=m(this.captureException.bind(this)))}catch(p){qp.error("failed to start",p),this.ut()}}},this._instance=e,this.ht=!((t=this._instance.persistence)==null||!t.props[MC]),this.dt=new N8({refillRate:(n=this._instance.config.error_tracking.__exceptionRateLimiterRefillRate)!==null&&n!==void 0?n:1,bucketSize:(s=this._instance.config.error_tracking.__exceptionRateLimiterBucketSize)!==null&&s!==void 0?s:10,refillInterval:1e4,h:qp}),this.R=this.vt(),this.startIfEnabledOrStop()}vt(){var e=this._instance.config.capture_exceptions,t={capture_unhandled_errors:!1,capture_unhandled_rejections:!1,capture_console_errors:!1};return Vn(e)?t=tt({},t,e):(Xe(e)?this.ht:e)&&(t=tt({},t,{capture_unhandled_errors:!0,capture_unhandled_rejections:!0})),t}get isEnabled(){return this.R.capture_console_errors||this.R.capture_unhandled_errors||this.R.capture_unhandled_rejections}startIfEnabledOrStop(){this.isEnabled?(qp.info("enabled"),this.ut(),this.it(this.rt)):this.ut()}it(e){var t,n;(t=Rt.__PosthogExtensions__)!=null&&t.errorWrappingFunctions&&e(),(n=Rt.__PosthogExtensions__)==null||n.loadExternalDependency==null||n.loadExternalDependency(this._instance,"exception-autocapture",(s=>{if(s)return qp.error("failed to load script",s);e()}))}ut(){var e,t,n;(e=this.st)==null||e.call(this),this.st=void 0,(t=this.nt)==null||t.call(this),this.nt=void 0,(n=this.ot)==null||n.call(this),this.ot=void 0}onRemoteConfig(e){var t=e.autocaptureExceptions;this.ht=!!t||!1,this._instance.persistence&&this._instance.persistence.register({[MC]:this.ht}),this.R=this.vt(),this.startIfEnabledOrStop()}onConfigChange(){this.R=this.vt()}captureException(e){var t,n,s=(t=e==null||(n=e.$exception_list)==null||(n=n[0])==null?void 0:n.type)!==null&&t!==void 0?t:"Exception";this.dt.consumeRateLimit(s)?qp.info("Skipping exception capture because of client rate limiting.",{exception:s}):this._instance.exceptions.sendExceptionEvent(e)}}function XC(r,e,t){try{if(!(e in r))return()=>{};var n=r[e],s=t(n);return Vc(s)&&(s.prototype=s.prototype||{},Object.defineProperties(s,{__posthog_wrapped__:{enumerable:!1,value:!0}})),r[e]=s,()=>{r[e]=n}}catch{return()=>{}}}class Dz{constructor(e){var t;this._instance=e,this.ct=(Se==null||(t=Se.location)==null?void 0:t.pathname)||""}get isEnabled(){return this._instance.config.capture_pageview==="history_change"}startIfEnabled(){this.isEnabled&&(et.info("History API monitoring enabled, starting..."),this.monitorHistoryChanges())}stop(){this.ft&&this.ft(),this.ft=void 0,et.info("History API monitoring stopped")}monitorHistoryChanges(){var e,t;if(Se&&Se.history){var n=this;(e=Se.history.pushState)!=null&&e.__posthog_wrapped__||XC(Se.history,"pushState",(s=>function(i,c,d){s.call(this,i,c,d),n._t("pushState")})),(t=Se.history.replaceState)!=null&&t.__posthog_wrapped__||XC(Se.history,"replaceState",(s=>function(i,c,d){s.call(this,i,c,d),n._t("replaceState")})),this.bt()}}_t(e){try{var t,n=Se==null||(t=Se.location)==null?void 0:t.pathname;if(!n)return;n!==this.ct&&this.isEnabled&&this._instance.capture("$pageview",{navigation_type:e}),this.ct=n}catch(s){et.error("Error capturing "+e+" pageview",s)}}bt(){if(!this.ft){var e=()=>{this._t("popstate")};Ln(Se,"popstate",e),this.ft=()=>{Se&&Se.removeEventListener("popstate",e)}}}}var Dx=Sn("[SegmentIntegration]");function Lz(r,e){var t=r.config.segment;if(!t)return e();(function(n,s){var i=n.config.segment;if(!i)return s();var c=m=>{var p=()=>m.anonymousId()||Gc();n.config.get_device_id=p,m.id()&&(n.register({distinct_id:m.id(),$device_id:p()}),n.persistence.set_property(zl,"identified")),s()},d=i.user();"then"in d&&Vc(d.then)?d.then(c):c(d)})(r,(()=>{t.register((n=>{Promise&&Promise.resolve||Dx.warn("This browser does not have Promise support, and can not use the segment integration");var s=(i,c)=>{if(!c)return i;i.event.userId||i.event.anonymousId===n.get_distinct_id()||(Dx.info("No userId set, resetting PostHog"),n.reset()),i.event.userId&&i.event.userId!==n.get_distinct_id()&&(Dx.info("UserId set, identifying with PostHog"),n.identify(i.event.userId));var d=n.calculateEventProperties(c,i.event.properties);return i.event.properties=Object.assign({},d,i.event.properties),i};return{name:"PostHog JS",type:"enrichment",version:"1.0.0",isLoaded:()=>!0,load:()=>Promise.resolve(),track:i=>s(i,i.event.event),page:i=>s(i,"$pageview"),identify:i=>s(i,"$identify"),screen:i=>s(i,"$screen")}})(r)).then((()=>{e()}))}))}var AA="posthog-js";function RA(r,e){var{organization:t,projectId:n,prefix:s,severityAllowList:i=["error"],sendExceptionsToPostHog:c=!0}=e===void 0?{}:e;return d=>{var m,p,v,x,b;if(!(i==="*"||i.includes(d.level))||!r.__loaded)return d;d.tags||(d.tags={});var S=r.requestRouter.endpointFor("ui","/project/"+r.config.token+"/person/"+r.get_distinct_id());d.tags["PostHog Person URL"]=S,r.sessionRecordingStarted()&&(d.tags["PostHog Recording URL"]=r.get_session_replay_url({withTimestamp:!0}));var N=((m=d.exception)==null?void 0:m.values)||[],E=N.map((A=>tt({},A,{stacktrace:A.stacktrace?tt({},A.stacktrace,{type:"raw",frames:(A.stacktrace.frames||[]).map((R=>tt({},R,{platform:"web:javascript"})))}):void 0}))),T={$exception_message:((p=N[0])==null?void 0:p.value)||d.message,$exception_type:(v=N[0])==null?void 0:v.type,$exception_level:d.level,$exception_list:E,$sentry_event_id:d.event_id,$sentry_exception:d.exception,$sentry_exception_message:((x=N[0])==null?void 0:x.value)||d.message,$sentry_exception_type:(b=N[0])==null?void 0:b.type,$sentry_tags:d.tags};return t&&n&&(T.$sentry_url=(s||"https://sentry.io/organizations/")+t+"/issues/?project="+n+"&query="+d.event_id),c&&r.exceptions.sendExceptionEvent(T),d}}class Mz{constructor(e,t,n,s,i,c){this.name=AA,this.setupOnce=function(d){d(RA(e,{organization:t,projectId:n,prefix:s,severityAllowList:i,sendExceptionsToPostHog:c==null||c}))}}}var $z=Se!=null&&Se.location?yy(Se.location.hash,"__posthog")||yy(location.hash,"state"):null,QC="_postHogToolbarParams",ZC=Sn("[Toolbar]"),Uc=(function(r){return r[r.UNINITIALIZED=0]="UNINITIALIZED",r[r.LOADING=1]="LOADING",r[r.LOADED=2]="LOADED",r})(Uc||{});class Uz{constructor(e){this.instance=e}yt(e){Rt.ph_toolbar_state=e}wt(){var e;return(e=Rt.ph_toolbar_state)!==null&&e!==void 0?e:Uc.UNINITIALIZED}maybeLoadToolbar(e,t,n){if(e===void 0&&(e=void 0),t===void 0&&(t=void 0),n===void 0&&(n=void 0),!Se||!Je)return!1;e=e??Se.location,n=n??Se.history;try{if(!t){try{Se.localStorage.setItem("test","test"),Se.localStorage.removeItem("test")}catch{return!1}t=Se==null?void 0:Se.localStorage}var s,i=$z||yy(e.hash,"__posthog")||yy(e.hash,"state"),c=i?DC((()=>JSON.parse(atob(decodeURIComponent(i)))))||DC((()=>JSON.parse(decodeURIComponent(i)))):null;return c&&c.action==="ph_authorize"?((s=c).source="url",s&&Object.keys(s).length>0&&(c.desiredHash?e.hash=c.desiredHash:n?n.replaceState(n.state,"",e.pathname+e.search):e.hash="")):((s=JSON.parse(t.getItem(QC)||"{}")).source="localstorage",delete s.userIntent),!(!s.token||this.instance.config.token!==s.token)&&(this.loadToolbar(s),!0)}catch{return!1}}xt(e){var t=Rt.ph_load_toolbar||Rt.ph_load_editor;!mr(t)&&Vc(t)?t(e,this.instance):ZC.warn("No toolbar load function found")}loadToolbar(e){var t=!(Je==null||!Je.getElementById(hA));if(!Se||t)return!1;var n=this.instance.requestRouter.region==="custom"&&this.instance.config.advanced_disable_toolbar_metrics,s=tt({token:this.instance.config.token},e,{apiURL:this.instance.requestRouter.endpointFor("ui")},n?{instrument:!1}:{});if(Se.localStorage.setItem(QC,JSON.stringify(tt({},s,{source:void 0}))),this.wt()===Uc.LOADED)this.xt(s);else if(this.wt()===Uc.UNINITIALIZED){var i;this.yt(Uc.LOADING),(i=Rt.__PosthogExtensions__)==null||i.loadExternalDependency==null||i.loadExternalDependency(this.instance,"toolbar",(c=>{if(c)return ZC.error("[Toolbar] Failed to load",c),void this.yt(Uc.UNINITIALIZED);this.yt(Uc.LOADED),this.xt(s)})),Ln(Se,"turbolinks:load",(()=>{this.yt(Uc.UNINITIALIZED),this.loadToolbar(s)}))}return!0}Et(e){return this.loadToolbar(e)}maybeLoadEditor(e,t,n){return e===void 0&&(e=void 0),t===void 0&&(t=void 0),n===void 0&&(n=void 0),this.maybeLoadToolbar(e,t,n)}}var zz=Sn("[TracingHeaders]");class Hz{constructor(e){this.$t=void 0,this.St=void 0,this.rt=()=>{var t,n;Xe(this.$t)&&((t=Rt.__PosthogExtensions__)==null||(t=t.tracingHeadersPatchFns)==null||t._patchXHR(this._instance.config.__add_tracing_headers||[],this._instance.get_distinct_id(),this._instance.sessionManager)),Xe(this.St)&&((n=Rt.__PosthogExtensions__)==null||(n=n.tracingHeadersPatchFns)==null||n._patchFetch(this._instance.config.__add_tracing_headers||[],this._instance.get_distinct_id(),this._instance.sessionManager))},this._instance=e}it(e){var t,n;(t=Rt.__PosthogExtensions__)!=null&&t.tracingHeadersPatchFns&&e(),(n=Rt.__PosthogExtensions__)==null||n.loadExternalDependency==null||n.loadExternalDependency(this._instance,"tracing-headers",(s=>{if(s)return zz.error("failed to load script",s);e()}))}startIfEnabledOrStop(){var e,t;this._instance.config.__add_tracing_headers?this.it(this.rt):((e=this.$t)==null||e.call(this),(t=this.St)==null||t.call(this),this.$t=void 0,this.St=void 0)}}var Nv="https?://(.*)",wh=["gclid","gclsrc","dclid","gbraid","wbraid","fbclid","msclkid","twclid","li_fat_id","igshid","ttclid","rdt_cid","epik","qclid","sccid","irclid","_kx"],Bz=xh(["utm_source","utm_medium","utm_campaign","utm_content","utm_term","gad_source","mc_cid"],wh),rg="<masked>",Gz=["li_fat_id"];function IA(r,e,t){if(!Je)return{};var n,s=e?xh([],wh,t||[]):[],i=PA(tg(Je.URL,s,rg),r),c=(n={},rn(Gz,(function(d){var m=Ga.q(d);n[d]=m||null})),n);return In(c,i)}function PA(r,e){var t=Bz.concat(e||[]),n={};return rn(t,(function(s){var i=vy(r,s);n[s]=i||null})),n}function FA(r){var e=(function(i){return i?i.search(Nv+"google.([^/?]*)")===0?"google":i.search(Nv+"bing.com")===0?"bing":i.search(Nv+"yahoo.com")===0?"yahoo":i.search(Nv+"duckduckgo.com")===0?"duckduckgo":null:null})(r),t=e!="yahoo"?"q":"p",n={};if(!da(e)){n.$search_engine=e;var s=Je?vy(Je.referrer,t):"";s.length&&(n.ph_keyword=s)}return n}function ek(){return navigator.language||navigator.userLanguage}function jA(){return(Je==null?void 0:Je.referrer)||"$direct"}function OA(r,e){var t=r?xh([],wh,e||[]):[],n=ws==null?void 0:ws.href.substring(0,1e3);return{r:jA().substring(0,1e3),u:n?tg(n,t,rg):void 0}}function DA(r){var e,{r:t,u:n}=r,s={$referrer:t,$referring_domain:t==null?void 0:t=="$direct"?"$direct":(e=gy(t))==null?void 0:e.host};if(n){s.$current_url=n;var i=gy(n);s.$host=i==null?void 0:i.host,s.$pathname=i==null?void 0:i.pathname;var c=PA(n);In(s,c)}if(t){var d=FA(t);In(s,d)}return s}function LA(){try{return Intl.DateTimeFormat().resolvedOptions().timeZone}catch{return}}function Wz(){try{return new Date().getTimezoneOffset()}catch{return}}function Vz(r,e){if(!Fo)return{};var t,n,s,i=r?xh([],wh,e||[]):[],[c,d]=(function(m){for(var p=0;p<IC.length;p++){var[v,x]=IC[p],b=v.exec(m),S=b&&(Vc(x)?x(b,m):x);if(S)return S}return["",""]})(Fo);return In(Q_({$os:c,$os_version:d,$browser:oA(Fo,navigator.vendor),$device:PC(Fo),$device_type:(n=Fo,s=PC(n),s===WT||s===GT||s==="Kobo"||s==="Kindle Fire"||s===sA?$m:s===zm||s===rh||s===Hm||s===Bw?"Console":s===qT?"Wearable":s?Ii:"Desktop"),$timezone:LA(),$timezone_offset:Wz()}),{$current_url:tg(ws==null?void 0:ws.href,i,rg),$host:ws==null?void 0:ws.host,$pathname:ws==null?void 0:ws.pathname,$raw_user_agent:Fo.length>1e3?Fo.substring(0,997)+"...":Fo,$browser_version:L8(Fo,navigator.vendor),$browser_language:ek(),$browser_language_prefix:(t=ek(),typeof t=="string"?t.split("-")[0]:void 0),$screen_height:Se==null?void 0:Se.screen.height,$screen_width:Se==null?void 0:Se.screen.width,$viewport_height:Se==null?void 0:Se.innerHeight,$viewport_width:Se==null?void 0:Se.innerWidth,$lib:"web",$lib_version:Ul.LIB_VERSION,$insert_id:Math.random().toString(36).substring(2,10)+Math.random().toString(36).substring(2,10),$time:Date.now()/1e3})}var Mc=Sn("[Web Vitals]"),tk=9e5;class qz{constructor(e){var t;this.kt=!1,this.P=!1,this.N={url:void 0,metrics:[],firstMetricTimestamp:void 0},this.Pt=()=>{clearTimeout(this.Tt),this.N.metrics.length!==0&&(this._instance.capture("$web_vitals",this.N.metrics.reduce(((n,s)=>tt({},n,{["$web_vitals_"+s.name+"_event"]:tt({},s),["$web_vitals_"+s.name+"_value"]:s.value})),{})),this.N={url:void 0,metrics:[],firstMetricTimestamp:void 0})},this.It=n=>{var s,i=(s=this._instance.sessionManager)==null?void 0:s.checkAndGetSessionAndWindowId(!0);if(Xe(i))Mc.error("Could not read session ID. Dropping metrics!");else{this.N=this.N||{url:void 0,metrics:[],firstMetricTimestamp:void 0};var c=this.Ct();Xe(c)||(mr(n==null?void 0:n.name)||mr(n==null?void 0:n.value)?Mc.error("Invalid metric received",n):this.Rt&&n.value>=this.Rt?Mc.error("Ignoring metric with value >= "+this.Rt,n):(this.N.url!==c&&(this.Pt(),this.Tt=setTimeout(this.Pt,this.flushToCaptureTimeoutMs)),Xe(this.N.url)&&(this.N.url=c),this.N.firstMetricTimestamp=Xe(this.N.firstMetricTimestamp)?Date.now():this.N.firstMetricTimestamp,n.attribution&&n.attribution.interactionTargetElement&&(n.attribution.interactionTargetElement=void 0),this.N.metrics.push(tt({},n,{$current_url:c,$session_id:i.sessionId,$window_id:i.windowId,timestamp:Date.now()})),this.N.metrics.length===this.allowedMetrics.length&&this.Pt()))}},this.rt=()=>{if(!this.P){var n,s,i,c,d=Rt.__PosthogExtensions__;Xe(d)||Xe(d.postHogWebVitalsCallbacks)||({onLCP:n,onCLS:s,onFCP:i,onINP:c}=d.postHogWebVitalsCallbacks),n&&s&&i&&c?(this.allowedMetrics.indexOf("LCP")>-1&&n(this.It.bind(this)),this.allowedMetrics.indexOf("CLS")>-1&&s(this.It.bind(this)),this.allowedMetrics.indexOf("FCP")>-1&&i(this.It.bind(this)),this.allowedMetrics.indexOf("INP")>-1&&c(this.It.bind(this)),this.P=!0):Mc.error("web vitals callbacks not loaded - not starting")}},this._instance=e,this.kt=!((t=this._instance.persistence)==null||!t.props[UC]),this.startIfEnabled()}get allowedMetrics(){var e,t,n=Vn(this._instance.config.capture_performance)?(e=this._instance.config.capture_performance)==null?void 0:e.web_vitals_allowed_metrics:void 0;return mr(n)?((t=this._instance.persistence)==null?void 0:t.props[HC])||["CLS","FCP","INP","LCP"]:n}get flushToCaptureTimeoutMs(){return(Vn(this._instance.config.capture_performance)?this._instance.config.capture_performance.web_vitals_delayed_flush_ms:void 0)||5e3}get useAttribution(){var e=Vn(this._instance.config.capture_performance)?this._instance.config.capture_performance.web_vitals_attribution:void 0;return e!=null&&e}get Rt(){var e=Vn(this._instance.config.capture_performance)&&ql(this._instance.config.capture_performance.__web_vitals_max_value)?this._instance.config.capture_performance.__web_vitals_max_value:tk;return 0<e&&e<=6e4?tk:e}get isEnabled(){var e=ws==null?void 0:ws.protocol;if(e!=="http:"&&e!=="https:")return Mc.info("Web Vitals are disabled on non-http/https protocols"),!1;var t=Vn(this._instance.config.capture_performance)?this._instance.config.capture_performance.web_vitals:Wl(this._instance.config.capture_performance)?this._instance.config.capture_performance:void 0;return Wl(t)?t:this.kt}startIfEnabled(){this.isEnabled&&!this.P&&(Mc.info("enabled, starting..."),this.it(this.rt))}onRemoteConfig(e){var t=Vn(e.capturePerformance)&&!!e.capturePerformance.web_vitals,n=Vn(e.capturePerformance)?e.capturePerformance.web_vitals_allowed_metrics:void 0;this._instance.persistence&&(this._instance.persistence.register({[UC]:t}),this._instance.persistence.register({[HC]:n})),this.kt=t,this.startIfEnabled()}it(e){var t,n;if((t=Rt.__PosthogExtensions__)!=null&&t.postHogWebVitalsCallbacks)e();else{var s=this.useAttribution?"web-vitals-with-attribution":"web-vitals";(n=Rt.__PosthogExtensions__)==null||n.loadExternalDependency==null||n.loadExternalDependency(this._instance,s,(i=>{i?Mc.error("failed to load script",i):e()}))}}Ct(){var e=Se?Se.location.href:void 0;if(e){var t=this._instance.config.mask_personal_data_properties,n=this._instance.config.custom_personal_data_properties,s=t?xh([],wh,n||[]):[];return tg(e,s,rg)}Mc.error("Could not determine current URL")}}var Kz=Sn("[Heatmaps]");function rk(r){return Vn(r)&&"clientX"in r&&"clientY"in r&&ql(r.clientX)&&ql(r.clientY)}class Yz{constructor(e){var t;this.kt=!1,this.P=!1,this.Ft=null,this.instance=e,this.kt=!((t=this.instance.persistence)==null||!t.props[Vw]),this.rageclicks=new kA(e.config.rageclick)}get flushIntervalMilliseconds(){var e=5e3;return Vn(this.instance.config.capture_heatmaps)&&this.instance.config.capture_heatmaps.flush_interval_milliseconds&&(e=this.instance.config.capture_heatmaps.flush_interval_milliseconds),e}get isEnabled(){return mr(this.instance.config.capture_heatmaps)?mr(this.instance.config.enable_heatmaps)?this.kt:this.instance.config.enable_heatmaps:this.instance.config.capture_heatmaps!==!1}startIfEnabled(){if(this.isEnabled){if(this.P)return;Kz.info("starting..."),this.Ot(),this.Mt()}else{var e;clearInterval((e=this.Ft)!==null&&e!==void 0?e:void 0),this.At(),this.getAndClearBuffer()}}onRemoteConfig(e){var t=!!e.heatmaps;this.instance.persistence&&this.instance.persistence.register({[Vw]:t}),this.kt=t,this.startIfEnabled()}getAndClearBuffer(){var e=this.N;return this.N=void 0,e}jt(e){this.Dt(e.originalEvent,"deadclick")}Mt(){this.Ft&&clearInterval(this.Ft),this.Ft=(function(e){return(e==null?void 0:e.visibilityState)==="visible"})(Je)?setInterval(this.Lt.bind(this),this.flushIntervalMilliseconds):null}Ot(){Se&&Je&&(this.Nt=this.Lt.bind(this),Ln(Se,"beforeunload",this.Nt),this.Ut=e=>this.Dt(e||(Se==null?void 0:Se.event)),Ln(Je,"click",this.Ut,{capture:!0}),this.zt=e=>this.Ht(e||(Se==null?void 0:Se.event)),Ln(Je,"mousemove",this.zt,{capture:!0}),this.Bt=new TA(this.instance,Fz,this.jt.bind(this)),this.Bt.startIfEnabled(),this.qt=this.Mt.bind(this),Ln(Je,"visibilitychange",this.qt),this.P=!0)}At(){var e;Se&&Je&&(this.Nt&&Se.removeEventListener("beforeunload",this.Nt),this.Ut&&Je.removeEventListener("click",this.Ut,{capture:!0}),this.zt&&Je.removeEventListener("mousemove",this.zt,{capture:!0}),this.qt&&Je.removeEventListener("visibilitychange",this.qt),clearTimeout(this.Wt),(e=this.Bt)==null||e.stop(),this.P=!1)}Gt(e,t){var n=this.instance.scrollManager.scrollY(),s=this.instance.scrollManager.scrollX(),i=this.instance.scrollManager.scrollElement(),c=(function(d,m,p){for(var v=d;v&&Vy(v)&&!Kc(v,"body");){if(v===p)return!1;if(fr(m,Se==null?void 0:Se.getComputedStyle(v).position))return!0;v=xA(v)}return!1})(vA(e),["fixed","sticky"],i);return{x:e.clientX+(c?0:s),y:e.clientY+(c?0:n),target_fixed:c,type:t}}Dt(e,t){var n;if(t===void 0&&(t="click"),!BC(e.target)&&rk(e)){var s=this.Gt(e,t);(n=this.rageclicks)!=null&&n.isRageClick(e.clientX,e.clientY,new Date().getTime())&&this.Vt(tt({},s,{type:"rageclick"})),this.Vt(s)}}Ht(e){!BC(e.target)&&rk(e)&&(clearTimeout(this.Wt),this.Wt=setTimeout((()=>{this.Vt(this.Gt(e,"mousemove"))}),500))}Vt(e){if(Se){var t=Se.location.href,n=this.instance.config.mask_personal_data_properties,s=this.instance.config.custom_personal_data_properties,i=n?xh([],wh,s||[]):[],c=tg(t,i,rg);this.N=this.N||{},this.N[c]||(this.N[c]=[]),this.N[c].push(e)}}Lt(){this.N&&!Jf(this.N)&&this.instance.capture("$$heatmap",{$heatmap_data:this.getAndClearBuffer()})}}class nk{constructor(e){this.Jt=(t,n,s)=>{s&&(s.noSessionId||s.activityTimeout||s.sessionPastMaximumLength)&&(et.info("[PageViewManager] Session rotated, clearing pageview state",{sessionId:t,changeReason:s}),this.Kt=void 0,this._instance.scrollManager.resetContext())},this._instance=e,this.Yt()}Yt(){var e;this.Xt=(e=this._instance.sessionManager)==null?void 0:e.onSessionId(this.Jt)}destroy(){var e;(e=this.Xt)==null||e.call(this),this.Xt=void 0}doPageView(e,t){var n,s=this.Qt(e,t);return this.Kt={pathname:(n=Se==null?void 0:Se.location.pathname)!==null&&n!==void 0?n:"",pageViewId:t,timestamp:e},this._instance.scrollManager.resetContext(),s}doPageLeave(e){var t;return this.Qt(e,(t=this.Kt)==null?void 0:t.pageViewId)}doEvent(){var e;return{$pageview_id:(e=this.Kt)==null?void 0:e.pageViewId}}Qt(e,t){var n=this.Kt;if(!n)return{$pageview_id:t};var s={$pageview_id:t,$prev_pageview_id:n.pageViewId},i=this._instance.scrollManager.getContext();if(i&&!this._instance.config.disable_scroll_properties){var{maxScrollHeight:c,lastScrollY:d,maxScrollY:m,maxContentHeight:p,lastContentY:v,maxContentY:x}=i;if(!(Xe(c)||Xe(d)||Xe(m)||Xe(p)||Xe(v)||Xe(x))){c=Math.ceil(c),d=Math.ceil(d),m=Math.ceil(m),p=Math.ceil(p),v=Math.ceil(v),x=Math.ceil(x);var b=c<=1?1:Ka(d/c,0,1,et),S=c<=1?1:Ka(m/c,0,1,et),N=p<=1?1:Ka(v/p,0,1,et),E=p<=1?1:Ka(x/p,0,1,et);s=In(s,{$prev_pageview_last_scroll:d,$prev_pageview_last_scroll_percentage:b,$prev_pageview_max_scroll:m,$prev_pageview_max_scroll_percentage:S,$prev_pageview_last_content:v,$prev_pageview_last_content_percentage:N,$prev_pageview_max_content:x,$prev_pageview_max_content_percentage:E})}}return n.pathname&&(s.$prev_pageview_pathname=n.pathname),n.timestamp&&(s.$prev_pageview_duration=(e.getTime()-n.timestamp.getTime())/1e3),s}}var Bl=(function(r){return r.GZipJS="gzip-js",r.Base64="base64",r})({}),Pi=Uint8Array,Do=Uint16Array,hh=Uint32Array,rS=new Pi([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),nS=new Pi([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),sk=new Pi([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),MA=function(r,e){for(var t=new Do(31),n=0;n<31;++n)t[n]=e+=1<<r[n-1];var s=new hh(t[30]);for(n=1;n<30;++n)for(var i=t[n];i<t[n+1];++i)s[i]=i-t[n]<<5|n;return[t,s]},$A=MA(rS,2),Jz=$A[0],tb=$A[1];Jz[28]=258,tb[258]=28;for(var ok=MA(nS,0)[1],UA=new Do(32768),ln=0;ln<32768;++ln){var Zu=(43690&ln)>>>1|(21845&ln)<<1;Zu=(61680&(Zu=(52428&Zu)>>>2|(13107&Zu)<<2))>>>4|(3855&Zu)<<4,UA[ln]=((65280&Zu)>>>8|(255&Zu)<<8)>>>1}var Sm=function(r,e,t){for(var n=r.length,s=0,i=new Do(e);s<n;++s)++i[r[s]-1];var c,d=new Do(e);for(s=0;s<e;++s)d[s]=d[s-1]+i[s-1]<<1;for(c=new Do(n),s=0;s<n;++s)c[s]=UA[d[r[s]-1]++]>>>15-r[s];return c},dd=new Pi(288);for(ln=0;ln<144;++ln)dd[ln]=8;for(ln=144;ln<256;++ln)dd[ln]=9;for(ln=256;ln<280;++ln)dd[ln]=7;for(ln=280;ln<288;++ln)dd[ln]=8;var wy=new Pi(32);for(ln=0;ln<32;++ln)wy[ln]=5;var Xz=Sm(dd,9),Qz=Sm(wy,5),zA=function(r){return(r/8>>0)+(7&r&&1)},HA=function(r,e,t){(t==null||t>r.length)&&(t=r.length);var n=new(r instanceof Do?Do:r instanceof hh?hh:Pi)(t-e);return n.set(r.subarray(e,t)),n},Ol=function(r,e,t){t<<=7&e;var n=e/8>>0;r[n]|=t,r[n+1]|=t>>>8},Kp=function(r,e,t){t<<=7&e;var n=e/8>>0;r[n]|=t,r[n+1]|=t>>>8,r[n+2]|=t>>>16},Lx=function(r,e){for(var t=[],n=0;n<r.length;++n)r[n]&&t.push({s:n,f:r[n]});var s=t.length,i=t.slice();if(!s)return[new Pi(0),0];if(s==1){var c=new Pi(t[0].s+1);return c[t[0].s]=1,[c,1]}t.sort((function(L,G){return L.f-G.f})),t.push({s:-1,f:25001});var d=t[0],m=t[1],p=0,v=1,x=2;for(t[0]={s:-1,f:d.f+m.f,l:d,r:m};v!=s-1;)d=t[t[p].f<t[x].f?p++:x++],m=t[p!=v&&t[p].f<t[x].f?p++:x++],t[v++]={s:-1,f:d.f+m.f,l:d,r:m};var b=i[0].s;for(n=1;n<s;++n)i[n].s>b&&(b=i[n].s);var S=new Do(b+1),N=rb(t[v-1],S,0);if(N>e){n=0;var E=0,T=N-e,A=1<<T;for(i.sort((function(L,G){return S[G.s]-S[L.s]||L.f-G.f}));n<s;++n){var R=i[n].s;if(!(S[R]>e))break;E+=A-(1<<N-S[R]),S[R]=e}for(E>>>=T;E>0;){var F=i[n].s;S[F]<e?E-=1<<e-S[F]++-1:++n}for(;n>=0&&E;--n){var j=i[n].s;S[j]==e&&(--S[j],++E)}N=e}return[new Pi(S),N]},rb=function(r,e,t){return r.s==-1?Math.max(rb(r.l,e,t+1),rb(r.r,e,t+1)):e[r.s]=t},ik=function(r){for(var e=r.length;e&&!r[--e];);for(var t=new Do(++e),n=0,s=r[0],i=1,c=function(m){t[n++]=m},d=1;d<=e;++d)if(r[d]==s&&d!=e)++i;else{if(!s&&i>2){for(;i>138;i-=138)c(32754);i>2&&(c(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(c(s),--i;i>6;i-=6)c(8304);i>2&&(c(i-3<<5|8208),i=0)}for(;i--;)c(s);i=1,s=r[d]}return[t.subarray(0,n),e]},Yp=function(r,e){for(var t=0,n=0;n<e.length;++n)t+=r[n]*e[n];return t},nb=function(r,e,t){var n=t.length,s=zA(e+2);r[s]=255&n,r[s+1]=n>>>8,r[s+2]=255^r[s],r[s+3]=255^r[s+1];for(var i=0;i<n;++i)r[s+i+4]=t[i];return 8*(s+4+n)},ak=function(r,e,t,n,s,i,c,d,m,p,v){Ol(e,v++,t),++s[256];for(var x=Lx(s,15),b=x[0],S=x[1],N=Lx(i,15),E=N[0],T=N[1],A=ik(b),R=A[0],F=A[1],j=ik(E),L=j[0],G=j[1],z=new Do(19),q=0;q<R.length;++q)z[31&R[q]]++;for(q=0;q<L.length;++q)z[31&L[q]]++;for(var ae=Lx(z,7),oe=ae[0],fe=ae[1],H=19;H>4&&!oe[sk[H-1]];--H);var me,ee,se,de,Y=p+5<<3,J=Yp(s,dd)+Yp(i,wy)+c,$=Yp(s,b)+Yp(i,E)+c+14+3*H+Yp(z,oe)+(2*z[16]+3*z[17]+7*z[18]);if(Y<=J&&Y<=$)return nb(e,v,r.subarray(m,m+p));if(Ol(e,v,1+($<J)),v+=2,$<J){me=Sm(b,S),ee=b,se=Sm(E,T),de=E;var X=Sm(oe,fe);for(Ol(e,v,F-257),Ol(e,v+5,G-1),Ol(e,v+10,H-4),v+=14,q=0;q<H;++q)Ol(e,v+3*q,oe[sk[q]]);v+=3*H;for(var O=[R,L],U=0;U<2;++U){var re=O[U];for(q=0;q<re.length;++q){var Ee=31&re[q];Ol(e,v,X[Ee]),v+=oe[Ee],Ee>15&&(Ol(e,v,re[q]>>>5&127),v+=re[q]>>>12)}}}else me=Xz,ee=dd,se=Qz,de=wy;for(q=0;q<d;++q)if(n[q]>255){Ee=n[q]>>>18&31,Kp(e,v,me[Ee+257]),v+=ee[Ee+257],Ee>7&&(Ol(e,v,n[q]>>>23&31),v+=rS[Ee]);var ne=31&n[q];Kp(e,v,se[ne]),v+=de[ne],ne>3&&(Kp(e,v,n[q]>>>5&8191),v+=nS[ne])}else Kp(e,v,me[n[q]]),v+=ee[n[q]];return Kp(e,v,me[256]),v+ee[256]},Zz=new hh([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),eH=(function(){for(var r=new hh(256),e=0;e<256;++e){for(var t=e,n=9;--n;)t=(1&t&&3988292384)^t>>>1;r[e]=t}return r})(),tH=function(r,e,t,n,s){return(function(i,c,d,m,p,v){var x=i.length,b=new Pi(m+x+5*(1+Math.floor(x/7e3))+p),S=b.subarray(m,b.length-p),N=0;if(!c||x<8)for(var E=0;E<=x;E+=65535){var T=E+65535;T<x?N=nb(S,N,i.subarray(E,T)):(S[E]=v,N=nb(S,N,i.subarray(E,x)))}else{for(var A=Zz[c-1],R=A>>>13,F=8191&A,j=(1<<d)-1,L=new Do(32768),G=new Do(j+1),z=Math.ceil(d/3),q=2*z,ae=function(ct){return(i[ct]^i[ct+1]<<z^i[ct+2]<<q)&j},oe=new hh(25e3),fe=new Do(288),H=new Do(32),me=0,ee=0,se=(E=0,0),de=0,Y=0;E<x;++E){var J=ae(E),$=32767&E,X=G[J];if(L[$]=X,G[J]=$,de<=E){var O=x-E;if((me>7e3||se>24576)&&O>423){N=ak(i,S,0,oe,fe,H,ee,se,Y,E-Y,N),se=me=ee=0,Y=E;for(var U=0;U<286;++U)fe[U]=0;for(U=0;U<30;++U)H[U]=0}var re=2,Ee=0,ne=F,we=$-X&32767;if(O>2&&J==ae(E-we))for(var K=Math.min(R,O)-1,he=Math.min(32767,E),be=Math.min(258,O);we<=he&&--ne&&$!=X;){if(i[E+re]==i[E+re-we]){for(var Ie=0;Ie<be&&i[E+Ie]==i[E+Ie-we];++Ie);if(Ie>re){if(re=Ie,Ee=we,Ie>K)break;var _t=Math.min(we,Ie-2),Be=0;for(U=0;U<_t;++U){var Ge=E-we+U+32768&32767,qe=Ge-L[Ge]+32768&32767;qe>Be&&(Be=qe,X=Ge)}}}we+=($=X)-(X=L[$])+32768&32767}if(Ee){oe[se++]=268435456|tb[re]<<18|ok[Ee];var Ne=31&tb[re],St=31&ok[Ee];ee+=rS[Ne]+nS[St],++fe[257+Ne],++H[St],de=E+re,++me}else oe[se++]=i[E],++fe[i[E]]}}N=ak(i,S,v,oe,fe,H,ee,se,Y,E-Y,N)}return HA(b,0,m+zA(N)+p)})(r,e.level==null?6:e.level,e.mem==null?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(r.length)))):12+e.mem,t,n,!0)},Mx=function(r,e,t){for(;t;++e)r[e]=t,t>>>=8};function rH(r,e){e===void 0&&(e={});var t=(function(){var d=4294967295;return{p:function(m){for(var p=d,v=0;v<m.length;++v)p=eH[255&p^m[v]]^p>>>8;d=p},d:function(){return 4294967295^d}}})(),n=r.length;t.p(r);var s,i=tH(r,e,10+((s=e).filename&&s.filename.length+1||0),8),c=i.length;return(function(d,m){var p=m.filename;if(d[0]=31,d[1]=139,d[2]=8,d[8]=m.level<2?4:m.level==9?2:0,d[9]=3,m.mtime!=0&&Mx(d,4,Math.floor(new Date(m.mtime||Date.now())/1e3)),p){d[3]=8;for(var v=0;v<=p.length;++v)d[v+10]=p.charCodeAt(v)}})(i,e),Mx(i,c-8,t.d()),Mx(i,c-4,n),i}var nH=function(r){var e,t,n,s,i="";for(e=t=0,n=(r=(r+"").replace(/\r\n/g,`
`).replace(/\r/g,`
`)).length,s=0;s<n;s++){var c=r.charCodeAt(s),d=null;c<128?t++:d=c>127&&c<2048?String.fromCharCode(c>>6|192,63&c|128):String.fromCharCode(c>>12|224,c>>6&63|128,63&c|128),da(d)||(t>e&&(i+=r.substring(e,t)),i+=d,e=t=s+1)}return t>e&&(i+=r.substring(e,r.length)),i},sH=!!Mw||!!Lw,lk="text/plain",by=function(r,e,t){var n;t===void 0&&(t=!0);var[s,i]=r.split("?"),c=tt({},e),d=(n=i==null?void 0:i.split("&").map((p=>{var v,[x,b]=p.split("="),S=t&&(v=c[x])!==null&&v!==void 0?v:b;return delete c[x],x+"="+S})))!==null&&n!==void 0?n:[],m=wz(c);return m&&d.push(m),s+"?"+d.join("&")},mm=(r,e)=>JSON.stringify(r,((t,n)=>typeof n=="bigint"?n.toString():n),e),$x=r=>{var{data:e,compression:t}=r;if(e){if(t===Bl.GZipJS){var n=rH((function(m,p){var v=m.length;if(typeof TextEncoder<"u")return new TextEncoder().encode(m);for(var x=new Pi(m.length+(m.length>>>1)),b=0,S=function(A){x[b++]=A},N=0;N<v;++N){if(b+5>x.length){var E=new Pi(b+8+(v-N<<1));E.set(x),x=E}var T=m.charCodeAt(N);T<128||p?S(T):T<2048?(S(192|T>>>6),S(128|63&T)):T>55295&&T<57344?(S(240|(T=65536+(1047552&T)|1023&m.charCodeAt(++N))>>>18),S(128|T>>>12&63),S(128|T>>>6&63),S(128|63&T)):(S(224|T>>>12),S(128|T>>>6&63),S(128|63&T))}return HA(x,0,b)})(mm(e)),{mtime:0}),s=new Blob([n],{type:lk});return{contentType:lk,body:s,estimatedSize:s.size}}if(t===Bl.Base64){var i=(function(m){var p,v,x,b,S,N="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",E=0,T=0,A="",R=[];if(!m)return m;m=nH(m);do p=(S=m.charCodeAt(E++)<<16|m.charCodeAt(E++)<<8|m.charCodeAt(E++))>>18&63,v=S>>12&63,x=S>>6&63,b=63&S,R[T++]=N.charAt(p)+N.charAt(v)+N.charAt(x)+N.charAt(b);while(E<m.length);switch(A=R.join(""),m.length%3){case 1:A=A.slice(0,-2)+"==";break;case 2:A=A.slice(0,-1)+"="}return A})(mm(e)),c=(m=>"data="+encodeURIComponent(typeof m=="string"?m:mm(m)))(i);return{contentType:"application/x-www-form-urlencoded",body:c,estimatedSize:new Blob([c]).size}}var d=mm(e);return{contentType:"application/json",body:d,estimatedSize:new Blob([d]).size}}},qv=[];Lw&&qv.push({transport:"fetch",method:r=>{var e,t,{contentType:n,body:s,estimatedSize:i}=(e=$x(r))!==null&&e!==void 0?e:{},c=new Headers;rn(r.headers,(function(v,x){c.append(x,v)})),n&&c.append("Content-Type",n);var d=r.url,m=null;if(kC){var p=new kC;m={signal:p.signal,timeout:setTimeout((()=>p.abort()),r.timeout)}}Lw(d,tt({method:(r==null?void 0:r.method)||"GET",headers:c,keepalive:r.method==="POST"&&(i||0)<52428.8,body:s,signal:(t=m)==null?void 0:t.signal},r.fetchOptions)).then((v=>v.text().then((x=>{var b={statusCode:v.status,text:x};if(v.status===200)try{b.json=JSON.parse(x)}catch(S){et.error(S)}r.callback==null||r.callback(b)})))).catch((v=>{et.error(v),r.callback==null||r.callback({statusCode:0,text:v})})).finally((()=>m?clearTimeout(m.timeout):null))}}),Mw&&qv.push({transport:"XHR",method:r=>{var e,t=new Mw;t.open(r.method||"GET",r.url,!0);var{contentType:n,body:s}=(e=$x(r))!==null&&e!==void 0?e:{};rn(r.headers,(function(i,c){t.setRequestHeader(c,i)})),n&&t.setRequestHeader("Content-Type",n),r.timeout&&(t.timeout=r.timeout),r.disableXHRCredentials||(t.withCredentials=!0),t.onreadystatechange=()=>{if(t.readyState===4){var i={statusCode:t.status,text:t.responseText};if(t.status===200)try{i.json=JSON.parse(t.responseText)}catch{}r.callback==null||r.callback(i)}},t.send(s)}}),ni!=null&&ni.sendBeacon&&qv.push({transport:"sendBeacon",method:r=>{var e=by(r.url,{beacon:"1"});try{var t,{contentType:n,body:s}=(t=$x(r))!==null&&t!==void 0?t:{},i=typeof s=="string"?new Blob([s],{type:n}):s;ni.sendBeacon(e,i)}catch{}}});var _y=function(r,e){if(!(function(t){try{new RegExp(t)}catch{return!1}return!0})(e))return!1;try{return new RegExp(e).test(r)}catch{return!1}};function ck(r,e,t){return mm({distinct_id:r,userPropertiesToSet:e,userPropertiesToSetOnce:t})}var BA={exact:(r,e)=>e.some((t=>r.some((n=>t===n)))),is_not:(r,e)=>e.every((t=>r.every((n=>t!==n)))),regex:(r,e)=>e.some((t=>r.some((n=>_y(t,n))))),not_regex:(r,e)=>e.every((t=>r.every((n=>!_y(t,n))))),icontains:(r,e)=>e.map(Tv).some((t=>r.map(Tv).some((n=>t.includes(n))))),not_icontains:(r,e)=>e.map(Tv).every((t=>r.map(Tv).every((n=>!t.includes(n))))),gt:(r,e)=>e.some((t=>{var n=parseFloat(t);return!isNaN(n)&&r.some((s=>n>parseFloat(s)))})),lt:(r,e)=>e.some((t=>{var n=parseFloat(t);return!isNaN(n)&&r.some((s=>n<parseFloat(s)))}))},Tv=r=>r.toLowerCase();function GA(r,e){return!r||Object.entries(r).every((t=>{var[n,s]=t,i=e==null?void 0:e[n];if(Xe(i)||da(i))return!1;var c=[String(i)],d=BA[s.operator];return!!d&&d(s.values,c)}))}var Ux=Sn("[Error tracking]");class oH{constructor(e){var t,n;this.Zt=[],this.ti=new U8([new Y8,new sz,new X8,new J8,new rz,new tz,new Z8,new nz],K8()),this._instance=e,this.Zt=(t=(n=this._instance.persistence)==null?void 0:n.get_property(qw))!==null&&t!==void 0?t:[]}onRemoteConfig(e){var t,n,s,i=(t=(n=e.errorTracking)==null?void 0:n.suppressionRules)!==null&&t!==void 0?t:[],c=(s=e.errorTracking)==null?void 0:s.captureExtensionExceptions;this.Zt=i,this._instance.persistence&&this._instance.persistence.register({[qw]:this.Zt,[$C]:c})}get ii(){var e,t=!!this._instance.get_property($C),n=this._instance.config.error_tracking.captureExtensionExceptions;return(e=n??t)!==null&&e!==void 0&&e}buildProperties(e,t){return this.ti.buildFromUnknown(e,{syntheticException:t==null?void 0:t.syntheticException,mechanism:{handled:t==null?void 0:t.handled}})}sendExceptionEvent(e){var t=e.$exception_list;if(this.ei(t)){if(this.ri(t))return void Ux.info("Skipping exception capture because a suppression rule matched");if(!this.ii&&this.si(t))return void Ux.info("Skipping exception capture because it was thrown by an extension");if(!this._instance.config.error_tracking.__capturePostHogExceptions&&this.ni(t))return void Ux.info("Skipping exception capture because it was thrown by the PostHog SDK")}return this._instance.capture("$exception",e,{_noTruncate:!0,_batchKey:"exceptionEvent"})}ri(e){if(e.length===0)return!1;var t=e.reduce(((n,s)=>{var{type:i,value:c}=s;return qn(i)&&i.length>0&&n.$exception_types.push(i),qn(c)&&c.length>0&&n.$exception_values.push(c),n}),{$exception_types:[],$exception_values:[]});return this.Zt.some((n=>{var s=n.values.map((i=>{var c,d=BA[i.operator],m=Mr(i.value)?i.value:[i.value],p=(c=t[i.key])!==null&&c!==void 0?c:[];return m.length>0&&d(m,p)}));return n.type==="OR"?s.some(Boolean):s.every(Boolean)}))}si(e){return e.flatMap((t=>{var n,s;return(n=(s=t.stacktrace)==null?void 0:s.frames)!==null&&n!==void 0?n:[]})).some((t=>t.filename&&t.filename.startsWith("chrome-extension://")))}ni(e){if(e.length>0){var t,n,s,i,c=(t=(n=e[0].stacktrace)==null?void 0:n.frames)!==null&&t!==void 0?t:[],d=c[c.length-1];return(s=d==null||(i=d.filename)==null?void 0:i.includes("posthog.com/static"))!==null&&s!==void 0&&s}return!1}ei(e){return!mr(e)&&Mr(e)}}var Zo=Sn("[FeatureFlags]"),Jp=Sn("[FeatureFlags]",{debugEnabled:!0}),zx="$active_feature_flags",$f="$override_feature_flags",uk="$feature_flag_payloads",Xp="$override_feature_flag_payloads",dk="$feature_flag_request_id",fk="$feature_flag_evaluated_at",hk=r=>{var e={};for(var[t,n]of Vv(r||{}))n&&(e[t]=n);return e},iH=r=>{var e=r.flags;return e?(r.featureFlags=Object.fromEntries(Object.keys(e).map((t=>{var n;return[t,(n=e[t].variant)!==null&&n!==void 0?n:e[t].enabled]}))),r.featureFlagPayloads=Object.fromEntries(Object.keys(e).filter((t=>e[t].enabled)).filter((t=>{var n;return(n=e[t].metadata)==null?void 0:n.payload})).map((t=>{var n;return[t,(n=e[t].metadata)==null?void 0:n.payload]})))):Zo.warn("Using an older version of the feature flags endpoint. Please upgrade your PostHog server to the latest version"),r},aH=(function(r){return r.FeatureFlags="feature_flags",r.Recordings="recordings",r})({});class lH{constructor(e){this.oi=!1,this.ai=!1,this.li=!1,this.ui=!1,this.hi=!1,this.di=!1,this.vi=!1,this.ci=!1,this._instance=e,this.featureFlagEventHandlers=[]}fi(){var e,t=(e=this._instance.config.evaluation_contexts)!==null&&e!==void 0?e:this._instance.config.evaluation_environments;return!this._instance.config.evaluation_environments||this._instance.config.evaluation_contexts||this.ci||(Zo.warn("evaluation_environments is deprecated. Use evaluation_contexts instead. evaluation_environments will be removed in a future version."),this.ci=!0),t!=null&&t.length?t.filter((n=>{var s=n&&typeof n=="string"&&n.trim().length>0;return s||Zo.error("Invalid evaluation context found:",n,"Expected non-empty string"),s})):[]}pi(){return this.fi().length>0}flags(){if(this._instance.config.__preview_remote_config)this.di=!0;else{var e=!this.gi&&(this._instance.config.advanced_disable_feature_flags||this._instance.config.advanced_disable_feature_flags_on_first_load);this.mi({disableFlags:e})}}get hasLoadedFlags(){return this.ai}getFlags(){return Object.keys(this.getFlagVariants())}getFlagsWithDetails(){var e=this._instance.get_property(Kw),t=this._instance.get_property($f),n=this._instance.get_property(Xp);if(!n&&!t)return e||{};var s=In({},e||{}),i=[...new Set([...Object.keys(n||{}),...Object.keys(t||{})])];for(var c of i){var d,m,p=s[c],v=t==null?void 0:t[c],x=Xe(v)?(d=p==null?void 0:p.enabled)!==null&&d!==void 0&&d:!!v,b=Xe(v)?p.variant:typeof v=="string"?v:void 0,S=n==null?void 0:n[c],N=tt({},p,{enabled:x,variant:x?b??(p==null?void 0:p.variant):void 0});x!==(p==null?void 0:p.enabled)&&(N.original_enabled=p==null?void 0:p.enabled),b!==(p==null?void 0:p.variant)&&(N.original_variant=p==null?void 0:p.variant),S&&(N.metadata=tt({},p==null?void 0:p.metadata,{payload:S,original_payload:p==null||(m=p.metadata)==null?void 0:m.payload})),s[c]=N}return this.oi||(Zo.warn(" Overriding feature flag details!",{flagDetails:e,overriddenPayloads:n,finalDetails:s}),this.oi=!0),s}getFlagVariants(){var e=this._instance.get_property(Xf),t=this._instance.get_property($f);if(!t)return e||{};for(var n=In({},e),s=Object.keys(t),i=0;i<s.length;i++)n[s[i]]=t[s[i]];return this.oi||(Zo.warn(" Overriding feature flags!",{enabledFlags:e,overriddenFlags:t,finalFlags:n}),this.oi=!0),n}getFlagPayloads(){var e=this._instance.get_property(uk),t=this._instance.get_property(Xp);if(!t)return e||{};for(var n=In({},e||{}),s=Object.keys(t),i=0;i<s.length;i++)n[s[i]]=t[s[i]];return this.oi||(Zo.warn(" Overriding feature flag payloads!",{flagPayloads:e,overriddenPayloads:t,finalPayloads:n}),this.oi=!0),n}reloadFeatureFlags(){this.ui||this._instance.config.advanced_disable_feature_flags||this.gi||(this._instance.bi.emit("featureFlagsReloading",!0),this.gi=setTimeout((()=>{this.mi()}),5))}yi(){clearTimeout(this.gi),this.gi=void 0}ensureFlagsLoaded(){this.ai||this.li||this.gi||this.reloadFeatureFlags()}setAnonymousDistinctId(e){this.$anon_distinct_id=e}setReloadingPaused(e){this.ui=e}mi(e){var t;if(this.yi(),!this._instance.M())if(this.li)this.hi=!0;else{var n=this._instance.config.token,s=this._instance.get_property("$device_id"),i={token:n,distinct_id:this._instance.get_distinct_id(),groups:this._instance.getGroups(),$anon_distinct_id:this.$anon_distinct_id,person_properties:tt({},((t=this._instance.persistence)==null?void 0:t.get_initial_props())||{},this._instance.get_property(pm)||{}),group_properties:this._instance.get_property(td)};da(s)||Xe(s)||(i.$device_id=s),(e!=null&&e.disableFlags||this._instance.config.advanced_disable_feature_flags)&&(i.disable_flags=!0),this.pi()&&(i.evaluation_contexts=this.fi());var c=this._instance.config.__preview_remote_config,d=c?"/flags/?v=2":"/flags/?v=2&config=true",m=this._instance.config.advanced_only_evaluate_survey_feature_flags?"&only_evaluate_survey_feature_flags=true":"",p=this._instance.requestRouter.endpointFor("flags",d+m);c&&(i.timezone=LA()),this.li=!0,this._instance._send_request({method:"POST",url:p,data:i,compression:this._instance.config.disable_compression?void 0:Bl.Base64,timeout:this._instance.config.feature_flag_request_timeout_ms,callback:v=>{var x,b,S=!0;if(v.statusCode===200&&(this.hi||(this.$anon_distinct_id=void 0),S=!1),this.li=!1,this.di||(this.di=!0,this._instance.wi((b=v.json)!==null&&b!==void 0?b:{})),!i.disable_flags||this.hi)if(this.vi=!S,v.json&&(x=v.json.quotaLimited)!=null&&x.includes(aH.FeatureFlags))Zo.warn("You have hit your feature flags quota limit, and will not be able to load feature flags until the quota is reset.  Please visit https://posthog.com/docs/billing/limits-alerts to learn more.");else{var N;i.disable_flags||this.receivedFeatureFlags((N=v.json)!==null&&N!==void 0?N:{},S),this.hi&&(this.hi=!1,this.mi())}}})}}getFeatureFlag(e,t){var n;if(t===void 0&&(t={}),this.ai||this.getFlags()&&this.getFlags().length>0){var s=this.getFeatureFlagResult(e,t);return(n=s==null?void 0:s.variant)!==null&&n!==void 0?n:s==null?void 0:s.enabled}Zo.warn('getFeatureFlag for key "'+e+`" failed. Feature flags didn't load in time.`)}getFeatureFlagDetails(e){return this.getFlagsWithDetails()[e]}getFeatureFlagPayload(e){var t=this.getFeatureFlagResult(e,{send_event:!1});return t==null?void 0:t.payload}getFeatureFlagResult(e,t){if(t===void 0&&(t={}),this.ai||this.getFlags()&&this.getFlags().length>0){var n=this.getFlagVariants(),s=e in n,i=n[e],c=this.getFlagPayloads()[e],d=String(i),m=this._instance.get_property(dk)||void 0,p=this._instance.get_property(fk)||void 0,v=this._instance.get_property(fy)||{};if((t.send_event||!("send_event"in t))&&(!(e in v)||!v[e].includes(d))){var x,b,S,N,E,T,A,R,F;Mr(v[e])?v[e].push(d):v[e]=[d],(x=this._instance.persistence)==null||x.register({[fy]:v});var j=this.getFeatureFlagDetails(e),L={$feature_flag:e,$feature_flag_response:i,$feature_flag_payload:c||null,$feature_flag_request_id:m,$feature_flag_evaluated_at:p,$feature_flag_bootstrapped_response:((b=this._instance.config.bootstrap)==null||(b=b.featureFlags)==null?void 0:b[e])||null,$feature_flag_bootstrapped_payload:((S=this._instance.config.bootstrap)==null||(S=S.featureFlagPayloads)==null?void 0:S[e])||null,$used_bootstrap_value:!this.vi};Xe(j==null||(N=j.metadata)==null?void 0:N.version)||(L.$feature_flag_version=j.metadata.version);var G,z=(E=j==null||(T=j.reason)==null?void 0:T.description)!==null&&E!==void 0?E:j==null||(A=j.reason)==null?void 0:A.code;z&&(L.$feature_flag_reason=z),j!=null&&(R=j.metadata)!=null&&R.id&&(L.$feature_flag_id=j.metadata.id),Xe(j==null?void 0:j.original_variant)&&Xe(j==null?void 0:j.original_enabled)||(L.$feature_flag_original_response=Xe(j.original_variant)?j.original_enabled:j.original_variant),j!=null&&(F=j.metadata)!=null&&F.original_payload&&(L.$feature_flag_original_payload=j==null||(G=j.metadata)==null?void 0:G.original_payload),this._instance.capture("$feature_flag_called",L)}if(s){var q=c;if(!Xe(c))try{q=JSON.parse(c)}catch{}return{key:e,enabled:!!i,variant:typeof i=="string"?i:void 0,payload:q}}}else Zo.warn('getFeatureFlagResult for key "'+e+`" failed. Feature flags didn't load in time.`)}getRemoteConfigPayload(e,t){var n=this._instance.config.token,s={distinct_id:this._instance.get_distinct_id(),token:n};this.pi()&&(s.evaluation_contexts=this.fi()),this._instance._send_request({method:"POST",url:this._instance.requestRouter.endpointFor("flags","/flags/?v=2&config=true"),data:s,compression:this._instance.config.disable_compression?void 0:Bl.Base64,timeout:this._instance.config.feature_flag_request_timeout_ms,callback:i=>{var c,d=(c=i.json)==null?void 0:c.featureFlagPayloads;t((d==null?void 0:d[e])||void 0)}})}isFeatureEnabled(e,t){if(t===void 0&&(t={}),this.ai||this.getFlags()&&this.getFlags().length>0){var n=this.getFeatureFlag(e,t);return Xe(n)?void 0:!!n}Zo.warn('isFeatureEnabled for key "'+e+`" failed. Feature flags didn't load in time.`)}addFeatureFlagsHandler(e){this.featureFlagEventHandlers.push(e)}removeFeatureFlagsHandler(e){this.featureFlagEventHandlers=this.featureFlagEventHandlers.filter((t=>t!==e))}receivedFeatureFlags(e,t){if(this._instance.persistence){this.ai=!0;var n=this.getFlagVariants(),s=this.getFlagPayloads(),i=this.getFlagsWithDetails();(function(c,d,m,p,v){m===void 0&&(m={}),p===void 0&&(p={}),v===void 0&&(v={});var x=iH(c),b=x.flags,S=x.featureFlags,N=x.featureFlagPayloads;if(S){var E=c.requestId,T=c.evaluatedAt;if(Mr(S)){Zo.warn("v1 of the feature flags endpoint is deprecated. Please use the latest version.");var A={};if(S)for(var R=0;R<S.length;R++)A[S[R]]=!0;d&&d.register({[zx]:S,[Xf]:A})}else{var F=S,j=N,L=b;if(c.errorsWhileComputingFlags)if(b){var G=new Set(Object.keys(b).filter((z=>{var q;return!((q=b[z])!=null&&q.failed)})));F=tt({},m,Object.fromEntries(Object.entries(F).filter((z=>{var[q]=z;return G.has(q)})))),j=tt({},p,Object.fromEntries(Object.entries(j||{}).filter((z=>{var[q]=z;return G.has(q)})))),L=tt({},v,Object.fromEntries(Object.entries(L||{}).filter((z=>{var[q]=z;return G.has(q)}))))}else F=tt({},m,F),j=tt({},p,j),L=tt({},v,L);d&&d.register(tt({[zx]:Object.keys(hk(F)),[Xf]:F||{},[uk]:j||{},[Kw]:L||{}},E?{[dk]:E}:{},T?{[fk]:T}:{}))}}})(e,this._instance.persistence,n,s,i),this.xi(t)}}override(e,t){t===void 0&&(t=!1),Zo.warn("override is deprecated. Please use overrideFeatureFlags instead."),this.overrideFeatureFlags({flags:e,suppressWarning:t})}overrideFeatureFlags(e){if(!this._instance.__loaded||!this._instance.persistence)return Zo.uninitializedWarning("posthog.featureFlags.overrideFeatureFlags");if(e===!1)return this._instance.persistence.unregister($f),this._instance.persistence.unregister(Xp),this.xi(),Jp.info("All overrides cleared");if(e&&typeof e=="object"&&("flags"in e||"payloads"in e)){var t,n=e;if(this.oi=!!((t=n.suppressWarning)!==null&&t!==void 0&&t),"flags"in n){if(n.flags===!1)this._instance.persistence.unregister($f),Jp.info("Flag overrides cleared");else if(n.flags){if(Mr(n.flags)){for(var s={},i=0;i<n.flags.length;i++)s[n.flags[i]]=!0;this._instance.persistence.register({[$f]:s})}else this._instance.persistence.register({[$f]:n.flags});Jp.info("Flag overrides set",{flags:n.flags})}}return"payloads"in n&&(n.payloads===!1?(this._instance.persistence.unregister(Xp),Jp.info("Payload overrides cleared")):n.payloads&&(this._instance.persistence.register({[Xp]:n.payloads}),Jp.info("Payload overrides set",{payloads:n.payloads}))),void this.xi()}this.xi()}onFeatureFlags(e){if(this.addFeatureFlagsHandler(e),this.ai){var{flags:t,flagVariants:n}=this.Ei();e(t,n)}return()=>this.removeFeatureFlagsHandler(e)}updateEarlyAccessFeatureEnrollment(e,t,n){var s,i=(this._instance.get_property(hm)||[]).find((p=>p.flagKey===e)),c={["$feature_enrollment/"+e]:t},d={$feature_flag:e,$feature_enrollment:t,$set:c};i&&(d.$early_access_feature_name=i.name),n&&(d.$feature_enrollment_stage=n),this._instance.capture("$feature_enrollment_update",d),this.setPersonPropertiesForFlags(c,!1);var m=tt({},this.getFlagVariants(),{[e]:t});(s=this._instance.persistence)==null||s.register({[zx]:Object.keys(hk(m)),[Xf]:m}),this.xi()}getEarlyAccessFeatures(e,t,n){t===void 0&&(t=!1);var s=this._instance.get_property(hm),i=n?"&"+n.map((c=>"stage="+c)).join("&"):"";if(s&&!t)return e(s);this._instance._send_request({url:this._instance.requestRouter.endpointFor("api","/api/early_access_features/?token="+this._instance.config.token+i),method:"GET",callback:c=>{var d,m;if(c.json){var p=c.json.earlyAccessFeatures;return(d=this._instance.persistence)==null||d.unregister(hm),(m=this._instance.persistence)==null||m.register({[hm]:p}),e(p)}}})}Ei(){var e=this.getFlags(),t=this.getFlagVariants();return{flags:e.filter((n=>t[n])),flagVariants:Object.keys(t).filter((n=>t[n])).reduce(((n,s)=>(n[s]=t[s],n)),{})}}xi(e){var{flags:t,flagVariants:n}=this.Ei();this.featureFlagEventHandlers.forEach((s=>s(t,n,{errorsLoading:e})))}setPersonPropertiesForFlags(e,t){t===void 0&&(t=!0);var n=this._instance.get_property(pm)||{};this._instance.register({[pm]:tt({},n,e)}),t&&this._instance.reloadFeatureFlags()}resetPersonPropertiesForFlags(){this._instance.unregister(pm)}setGroupPropertiesForFlags(e,t){t===void 0&&(t=!0);var n=this._instance.get_property(td)||{};Object.keys(n).length!==0&&Object.keys(n).forEach((s=>{n[s]=tt({},n[s],e[s]),delete e[s]})),this._instance.register({[td]:tt({},n,e)}),t&&this._instance.reloadFeatureFlags()}resetGroupPropertiesForFlags(e){if(e){var t=this._instance.get_property(td)||{};this._instance.register({[td]:tt({},t,{[e]:{}})})}else this._instance.unregister(td)}reset(){this.ai=!1,this.li=!1,this.ui=!1,this.hi=!1,this.di=!1,this.vi=!1,this.$anon_distinct_id=void 0,this.yi(),this.oi=!1}}var cH=["cookie","localstorage","localstorage+cookie","sessionstorage","memory"];class Hx{constructor(e,t){this.R=e,this.props={},this.$i=!1,this.Si=(n=>{var s="";return n.token&&(s=n.token.replace(/\+/g,"PL").replace(/\//g,"SL").replace(/=/g,"EQ")),n.persistence_name?"ph_"+n.persistence_name:"ph_"+s+"_posthog"})(e),this.Y=this.ki(e),this.load(),e.debug&&et.info("Persistence loaded",e.persistence,tt({},this.props)),this.update_config(e,e,t),this.save()}isDisabled(){return!!this.Pi}ki(e){cH.indexOf(e.persistence.toLowerCase())===-1&&(et.critical("Unknown persistence type "+e.persistence+"; falling back to localStorage+cookie"),e.persistence="localStorage+cookie");var t=(function(s){s===void 0&&(s=[]);var i=[...Rz,...s];return tt({},gn,{W:function(c){try{var d={};try{d=Ga.W(c)||{}}catch{}var m=In(d,JSON.parse(gn.q(c)||"{}"));return gn.G(c,m),m}catch{}return null},G:function(c,d,m,p,v,x){try{gn.G(c,d,void 0,void 0,x);var b={};i.forEach((S=>{d[S]&&(b[S]=d[S])})),Object.keys(b).length&&Ga.G(c,b,m,p,v,x)}catch(S){gn.B(S)}},V:function(c,d){try{Se==null||Se.localStorage.removeItem(c),Ga.V(c,d)}catch(m){gn.B(m)}}})})(e.cookie_persisted_properties||[]),n=e.persistence.toLowerCase();return n==="localstorage"&&gn.H()?gn:n==="localstorage+cookie"&&t.H()?t:n==="sessionstorage"&&ys.H()?ys:n==="memory"?Iz:n==="cookie"?Ga:t.H()?t:Ga}properties(){var e={};return rn(this.props,(function(t,n){if(n===Xf&&Vn(t))for(var s=Object.keys(t),i=0;i<s.length;i++)e["$feature/"+s[i]]=t[s[i]];else d=n,m=!1,(da(c=uz)?m:CC&&c.indexOf===CC?c.indexOf(d)!=-1:(rn(c,(function(p){if(m||(m=p===d))return uy})),m))||(e[n]=t);var c,d,m})),e}load(){if(!this.Pi){var e=this.Y.W(this.Si);e&&(this.props=In({},e))}}save(){this.Pi||this.Y.G(this.Si,this.props,this.Ti,this.Ii,this.Ci,this.R.debug)}remove(){this.Y.V(this.Si,!1),this.Y.V(this.Si,!0)}clear(){this.remove(),this.props={}}register_once(e,t,n){if(Vn(e)){Xe(t)&&(t="None"),this.Ti=Xe(n)?this.Ri:n;var s=!1;if(rn(e,((i,c)=>{this.props.hasOwnProperty(c)&&this.props[c]!==t||(this.props[c]=i,s=!0)})),s)return this.save(),!0}return!1}register(e,t){if(Vn(e)){this.Ti=Xe(t)?this.Ri:t;var n=!1;if(rn(e,((s,i)=>{e.hasOwnProperty(i)&&this.props[i]!==s&&(this.props[i]=s,n=!0)})),n)return this.save(),!0}return!1}unregister(e){e in this.props&&(delete this.props[e],this.save())}update_campaign_params(){if(!this.$i){var e=IA(this.R.custom_campaign_params,this.R.mask_personal_data_properties,this.R.custom_personal_data_properties);Jf(Q_(e))||this.register(e),this.$i=!0}}update_search_keyword(){var e;this.register((e=Je==null?void 0:Je.referrer)?FA(e):{})}update_referrer_info(){var e;this.register_once({$referrer:jA(),$referring_domain:Je!=null&&Je.referrer&&((e=gy(Je.referrer))==null?void 0:e.host)||"$direct"},void 0)}set_initial_person_info(){this.props[Qw]||this.props[Zw]||this.register_once({[hy]:OA(this.R.mask_personal_data_properties,this.R.custom_personal_data_properties)},void 0)}get_initial_props(){var e={};rn([Zw,Qw],(c=>{var d=this.props[c];d&&rn(d,(function(m,p){e["$initial_"+$w(p)]=m}))}));var t,n,s=this.props[hy];if(s){var i=(t=DA(s),n={},rn(t,(function(c,d){n["$initial_"+$w(d)]=c})),n);In(e,i)}return e}safe_merge(e){return rn(this.props,(function(t,n){n in e||(e[n]=t)})),e}update_config(e,t,n){if(this.Ri=this.Ti=e.cookie_expiration,this.set_disabled(e.disable_persistence||!!n),this.set_cross_subdomain(e.cross_subdomain_cookie),this.set_secure(e.secure_cookie),e.persistence!==t.persistence||!((c,d)=>{if(c.length!==d.length)return!1;var m=[...c].sort(),p=[...d].sort();return m.every(((v,x)=>v===p[x]))})(e.cookie_persisted_properties||[],t.cookie_persisted_properties||[])){var s=this.ki(e),i=this.props;this.clear(),this.Y=s,this.props=i,this.save()}}set_disabled(e){this.Pi=e,this.Pi?this.remove():this.save()}set_cross_subdomain(e){e!==this.Ii&&(this.Ii=e,this.remove(),this.save())}set_secure(e){e!==this.Ci&&(this.Ci=e,this.remove(),this.save())}set_event_timer(e,t){var n=this.props[fm]||{};n[e]=t,this.props[fm]=n,this.save()}remove_event_timer(e){var t=(this.props[fm]||{})[e];return Xe(t)||(delete this.props[fm][e],this.save()),t}get_property(e){return this.props[e]}set_property(e,t){this.props[e]=t,this.save()}}var pk=Sn("[Product Tours]"),Bx="ph_product_tours";class uH{constructor(e){this.Fi=null,this.Oi=null,this._instance=e}onRemoteConfig(e){this._instance.persistence&&this._instance.persistence.register({[zC]:!(e==null||!e.productTours)}),this.loadIfEnabled()}loadIfEnabled(){var e,t;this.Fi||(e=this._instance).config.disable_product_tours||(t=e.persistence)==null||!t.get_property(zC)||this.it((()=>this.Mi()))}it(e){var t,n;(t=Rt.__PosthogExtensions__)!=null&&t.generateProductTours?e():(n=Rt.__PosthogExtensions__)==null||n.loadExternalDependency==null||n.loadExternalDependency(this._instance,"product-tours",(s=>{s?pk.error("Could not load product tours script",s):e()}))}Mi(){var e;!this.Fi&&(e=Rt.__PosthogExtensions__)!=null&&e.generateProductTours&&(this.Fi=Rt.__PosthogExtensions__.generateProductTours(this._instance,!0))}getProductTours(e,t){if(t===void 0&&(t=!1),!Mr(this.Oi)||t){var n=this._instance.persistence;if(n){var s=n.props[Bx];if(Mr(s)&&!t)return this.Oi=s,void e(s,{isLoaded:!0})}this._instance._send_request({url:this._instance.requestRouter.endpointFor("api","/api/product_tours/?token="+this._instance.config.token),method:"GET",callback:i=>{var c=i.statusCode;if(c!==200||!i.json){var d="Product Tours API could not be loaded, status: "+c;return pk.error(d),void e([],{isLoaded:!1,error:d})}var m=Mr(i.json.product_tours)?i.json.product_tours:[];this.Oi=m,n&&n.register({[Bx]:m}),e(m,{isLoaded:!0})}})}else e(this.Oi,{isLoaded:!0})}getActiveProductTours(e){mr(this.Fi)?e([],{isLoaded:!1,error:"Product tours not loaded"}):this.Fi.getActiveProductTours(e)}showProductTour(e){var t;(t=this.Fi)==null||t.showTourById(e)}previewTour(e){this.Fi?this.Fi.previewTour(e):this.it((()=>{var t;this.Mi(),(t=this.Fi)==null||t.previewTour(e)}))}dismissProductTour(){var e;(e=this.Fi)==null||e.dismissTour("user_clicked_skip")}nextStep(){var e;(e=this.Fi)==null||e.nextStep()}previousStep(){var e;(e=this.Fi)==null||e.previousStep()}clearCache(){var e;this.Oi=null,(e=this._instance.persistence)==null||e.unregister(Bx)}resetTour(e){var t;(t=this.Fi)==null||t.resetTour(e)}resetAllTours(){var e;(e=this.Fi)==null||e.resetAllTours()}cancelPendingTour(e){var t;(t=this.Fi)==null||t.cancelPendingTour(e)}}var Qp=(function(r){return r.Activation="events",r.Cancellation="cancelEvents",r})({});(function(r){return r.Button="button",r.Tab="tab",r.Selector="selector",r})({});(function(r){return r.TopLeft="top_left",r.TopRight="top_right",r.TopCenter="top_center",r.MiddleLeft="middle_left",r.MiddleRight="middle_right",r.MiddleCenter="middle_center",r.Left="left",r.Center="center",r.Right="right",r.NextToTrigger="next_to_trigger",r})({});(function(r){return r.Top="top",r.Left="left",r.Right="right",r.Bottom="bottom",r})({});var Gx=(function(r){return r.Popover="popover",r.API="api",r.Widget="widget",r.ExternalSurvey="external_survey",r})({});(function(r){return r.Open="open",r.MultipleChoice="multiple_choice",r.SingleChoice="single_choice",r.Rating="rating",r.Link="link",r})({});(function(r){return r.NextQuestion="next_question",r.End="end",r.ResponseBased="response_based",r.SpecificQuestion="specific_question",r})({});(function(r){return r.Once="once",r.Recurring="recurring",r.Always="always",r})({});var gm=(function(r){return r.SHOWN="survey shown",r.DISMISSED="survey dismissed",r.SENT="survey sent",r.ABANDONED="survey abandoned",r})({}),Wx=(function(r){return r.SURVEY_ID="$survey_id",r.SURVEY_NAME="$survey_name",r.SURVEY_RESPONSE="$survey_response",r.SURVEY_ITERATION="$survey_iteration",r.SURVEY_ITERATION_START_DATE="$survey_iteration_start_date",r.SURVEY_PARTIALLY_COMPLETED="$survey_partially_completed",r.SURVEY_SUBMISSION_ID="$survey_submission_id",r.SURVEY_QUESTIONS="$survey_questions",r.SURVEY_COMPLETED="$survey_completed",r.PRODUCT_TOUR_ID="$product_tour_id",r.SURVEY_LAST_SEEN_DATE="$survey_last_seen_date",r})({}),sb=(function(r){return r.Popover="popover",r.Inline="inline",r})({}),Jr=Sn("[Surveys]"),WA="seenSurvey_",dH=(r,e)=>{var t="$survey_"+e+"/"+r.id;return r.current_iteration&&r.current_iteration>0&&(t="$survey_"+e+"/"+r.id+"/"+r.current_iteration),t},mk=r=>((e,t)=>{var n=""+e+t.id;return t.current_iteration&&t.current_iteration>0&&(n=""+e+t.id+"_"+t.current_iteration),n})(WA,r),fH=[Gx.Popover,Gx.Widget,Gx.API],hH={ignoreConditions:!1,ignoreDelay:!1,displayType:sb.Popover};class sS{constructor(){this.Ai={},this.Ai={}}on(e,t){return this.Ai[e]||(this.Ai[e]=[]),this.Ai[e].push(t),()=>{this.Ai[e]=this.Ai[e].filter((n=>n!==t))}}emit(e,t){for(var n of this.Ai[e]||[])n(t);for(var s of this.Ai["*"]||[])s(e,t)}}function Uf(r,e,t){if(mr(r))return!1;switch(t){case"exact":return r===e;case"contains":var n=e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/_/g,".").replace(/%/g,".*");return new RegExp(n,"i").test(r);case"regex":try{return new RegExp(e).test(r)}catch{return!1}default:return!1}}class pH{constructor(e){this.ji=new sS,this.Di=(t,n)=>this.Li(t,n)&&this.Ni(t,n)&&this.Ui(t,n)&&this.zi(t,n),this.Li=(t,n)=>n==null||!n.event||(t==null?void 0:t.event)===(n==null?void 0:n.event),this._instance=e,this.Hi=new Set,this.Bi=new Set}init(){var e;if(!Xe((e=this._instance)==null?void 0:e._addCaptureHook)){var t;(t=this._instance)==null||t._addCaptureHook(((n,s)=>{this.on(n,s)}))}}register(e){var t,n;if(!Xe((t=this._instance)==null?void 0:t._addCaptureHook)&&(e.forEach((c=>{var d,m;(d=this.Bi)==null||d.add(c),(m=c.steps)==null||m.forEach((p=>{var v;(v=this.Hi)==null||v.add((p==null?void 0:p.event)||"")}))})),(n=this._instance)!=null&&n.autocapture)){var s,i=new Set;e.forEach((c=>{var d;(d=c.steps)==null||d.forEach((m=>{m!=null&&m.selector&&i.add(m==null?void 0:m.selector)}))})),(s=this._instance)==null||s.autocapture.setElementSelectors(i)}}on(e,t){var n;t!=null&&e.length!=0&&(this.Hi.has(e)||this.Hi.has(t==null?void 0:t.event))&&this.Bi&&((n=this.Bi)==null?void 0:n.size)>0&&this.Bi.forEach((s=>{this.qi(t,s)&&this.ji.emit("actionCaptured",s.name)}))}Wi(e){this.onAction("actionCaptured",(t=>e(t)))}qi(e,t){if((t==null?void 0:t.steps)==null)return!1;for(var n of t.steps)if(this.Di(e,n))return!0;return!1}onAction(e,t){return this.ji.on(e,t)}Ni(e,t){if(t!=null&&t.url){var n,s=e==null||(n=e.properties)==null?void 0:n.$current_url;if(!s||typeof s!="string"||!Uf(s,t.url,t.url_matching||"contains"))return!1}return!0}Ui(e,t){return!!this.Gi(e,t)&&!!this.Vi(e,t)&&!!this.Ji(e,t)}Gi(e,t){var n;if(t==null||!t.href)return!0;var s=this.Ki(e);if(s.length>0)return s.some((d=>Uf(d.href,t.href,t.href_matching||"exact")));var i,c=(e==null||(n=e.properties)==null?void 0:n.$elements_chain)||"";return!!c&&Uf((i=c.match(/(?::|")href="(.*?)"/))?i[1]:"",t.href,t.href_matching||"exact")}Vi(e,t){var n;if(t==null||!t.text)return!0;var s=this.Ki(e);if(s.length>0)return s.some((p=>Uf(p.text,t.text,t.text_matching||"exact")||Uf(p.$el_text,t.text,t.text_matching||"exact")));var i,c,d,m=(e==null||(n=e.properties)==null?void 0:n.$elements_chain)||"";return!!m&&(i=(function(p){for(var v,x=[],b=/(?::|")text="(.*?)"/g;!mr(v=b.exec(p));)x.includes(v[1])||x.push(v[1]);return x})(m),c=t.text,d=t.text_matching||"exact",i.some((p=>Uf(p,c,d))))}Ji(e,t){var n,s;if(t==null||!t.selector)return!0;var i=e==null||(n=e.properties)==null?void 0:n.$element_selectors;if(i!=null&&i.includes(t.selector))return!0;var c=(e==null||(s=e.properties)==null?void 0:s.$elements_chain)||"";if(t.selector_regex&&c)try{return new RegExp(t.selector_regex).test(c)}catch{return!1}return!1}Ki(e){var t;return(e==null||(t=e.properties)==null?void 0:t.$elements)==null?[]:e==null?void 0:e.properties.$elements}zi(e,t){return t==null||!t.properties||t.properties.length===0||GA(t.properties.reduce(((n,s)=>{var i=Mr(s.value)?s.value.map(String):s.value!=null?[String(s.value)]:[];return n[s.key]={values:i,operator:s.operator||"exact"},n}),{}),e==null?void 0:e.properties)}}class mH{constructor(e){this._instance=e,this.Yi=new Map,this.Xi=new Map,this.Qi=new Map}Zi(e,t){return!!e&&GA(e.propertyFilters,t==null?void 0:t.properties)}te(e,t){var n=new Map;return e.forEach((s=>{var i;(i=s.conditions)==null||(i=i[t])==null||(i=i.values)==null||i.forEach((c=>{if(c!=null&&c.name){var d=n.get(c.name)||[];d.push(s.id),n.set(c.name,d)}}))})),n}ie(e,t,n){var s=(n===Qp.Activation?this.Yi:this.Xi).get(e),i=[];return this.ee((c=>{i=c.filter((d=>s==null?void 0:s.includes(d.id)))})),i.filter((c=>{var d,m=(d=c.conditions)==null||(d=d[n])==null||(d=d.values)==null?void 0:d.find((p=>p.name===e));return this.Zi(m,t)}))}register(e){var t;Xe((t=this._instance)==null?void 0:t._addCaptureHook)||(this.re(e),this.se(e))}se(e){var t=e.filter((n=>{var s,i;return((s=n.conditions)==null?void 0:s.actions)&&((i=n.conditions)==null||(i=i.actions)==null||(i=i.values)==null?void 0:i.length)>0}));t.length!==0&&(this.ne==null&&(this.ne=new pH(this._instance),this.ne.init(),this.ne.Wi((n=>{this.onAction(n)}))),t.forEach((n=>{var s,i,c,d,m;n.conditions&&(s=n.conditions)!=null&&s.actions&&(i=n.conditions)!=null&&(i=i.actions)!=null&&i.values&&((c=n.conditions)==null||(c=c.actions)==null||(c=c.values)==null?void 0:c.length)>0&&((d=this.ne)==null||d.register(n.conditions.actions.values),(m=n.conditions)==null||(m=m.actions)==null||(m=m.values)==null||m.forEach((p=>{if(p&&p.name){var v=this.Qi.get(p.name);v&&v.push(n.id),this.Qi.set(p.name,v||[n.id])}})))})))}re(e){var t,n=e.filter((i=>{var c,d;return((c=i.conditions)==null?void 0:c.events)&&((d=i.conditions)==null||(d=d.events)==null||(d=d.values)==null?void 0:d.length)>0})),s=e.filter((i=>{var c,d;return((c=i.conditions)==null?void 0:c.cancelEvents)&&((d=i.conditions)==null||(d=d.cancelEvents)==null||(d=d.values)==null?void 0:d.length)>0}));(n.length!==0||s.length!==0)&&((t=this._instance)==null||t._addCaptureHook(((i,c)=>{this.onEvent(i,c)})),this.Yi=this.te(e,Qp.Activation),this.Xi=this.te(e,Qp.Cancellation))}onEvent(e,t){var n,s=this.oe(),i=this.ae(),c=this.le(),d=((n=this._instance)==null||(n=n.persistence)==null?void 0:n.props[i])||[];if(c===e&&t&&d.length>0){var m,p;s.info("event matched, removing item from activated items",{event:e,eventPayload:t,existingActivatedItems:d});var v=(t==null||(m=t.properties)==null?void 0:m.$survey_id)||(t==null||(p=t.properties)==null?void 0:p.$product_tour_id);if(v){var x=d.indexOf(v);x>=0&&(d.splice(x,1),this.ue(d))}}else{if(this.Xi.has(e)){var b=this.ie(e,t,Qp.Cancellation);b.length>0&&(s.info("cancel event matched, cancelling items",{event:e,itemsToCancel:b.map((N=>N.id))}),b.forEach((N=>{var E=d.indexOf(N.id);E>=0&&d.splice(E,1),this.he(N.id)})),this.ue(d))}if(this.Yi.has(e)){s.info("event name matched",{event:e,eventPayload:t,items:this.Yi.get(e)});var S=this.ie(e,t,Qp.Activation);this.ue(d.concat(S.map((N=>N.id))||[]))}}}onAction(e){var t,n=this.ae(),s=((t=this._instance)==null||(t=t.persistence)==null?void 0:t.props[n])||[];this.Qi.has(e)&&this.ue(s.concat(this.Qi.get(e)||[]))}ue(e){var t,n=this.oe(),s=this.ae(),i=[...new Set(e)].filter((c=>!this.de(c)));n.info("updating activated items",{activatedItems:i}),(t=this._instance)==null||(t=t.persistence)==null||t.register({[s]:i})}getActivatedIds(){var e,t=this.ae(),n=(e=this._instance)==null||(e=e.persistence)==null?void 0:e.props[t];return n||[]}getEventToItemsMap(){return this.Yi}ve(){return this.ne}}class gH extends mH{constructor(e){super(e)}ae(){return"$surveys_activated"}le(){return gm.SHOWN}ee(e){var t;(t=this._instance)==null||t.getSurveys(e)}he(e){var t;(t=this._instance)==null||t.cancelPendingSurvey(e)}oe(){return Jr}de(){return!1}getSurveys(){return this.getActivatedIds()}getEventToSurveys(){return this.getEventToItemsMap()}}class vH{constructor(e){this.ce=void 0,this._surveyManager=null,this.fe=!1,this.pe=[],this.ge=null,this._instance=e,this._surveyEventReceiver=null}onRemoteConfig(e){if(!this._instance.config.disable_surveys){var t=e.surveys;if(mr(t))return Jr.warn("Flags not loaded yet. Not loading surveys.");var n=Mr(t);this.ce=n?t.length>0:t,Jr.info("flags response received, isSurveysEnabled: "+this.ce),this.loadIfEnabled()}}reset(){localStorage.removeItem("lastSeenSurveyDate");for(var e=[],t=0;t<localStorage.length;t++){var n=localStorage.key(t);(n!=null&&n.startsWith(WA)||n!=null&&n.startsWith("inProgressSurvey_"))&&e.push(n)}e.forEach((s=>localStorage.removeItem(s)))}loadIfEnabled(){if(!this._surveyManager)if(this.fe)Jr.info("Already initializing surveys, skipping...");else if(this._instance.config.disable_surveys)Jr.info("Disabled. Not loading surveys.");else if(this._instance.config.cookieless_mode&&this._instance.consent.isOptedOut())Jr.info("Not loading surveys in cookieless mode without consent.");else{var e=Rt==null?void 0:Rt.__PosthogExtensions__;if(e){if(!Xe(this.ce)||this._instance.config.advanced_enable_surveys){var t=this.ce||this._instance.config.advanced_enable_surveys;this.fe=!0;try{var n=e.generateSurveys;if(n)return void this._e(n,t);var s=e.loadExternalDependency;if(!s)return void this.me("PostHog loadExternalDependency extension not found.");s(this._instance,"surveys",(i=>{i||!e.generateSurveys?this.me("Could not load surveys script",i):this._e(e.generateSurveys,t)}))}catch(i){throw this.me("Error initializing surveys",i),i}finally{this.fe=!1}}}else Jr.error("PostHog Extensions not found.")}}_e(e,t){this._surveyManager=e(this._instance,t),this._surveyEventReceiver=new gH(this._instance),Jr.info("Surveys loaded successfully"),this.be({isLoaded:!0})}me(e,t){Jr.error(e,t),this.be({isLoaded:!1,error:e})}onSurveysLoaded(e){return this.pe.push(e),this._surveyManager&&this.be({isLoaded:!0}),()=>{this.pe=this.pe.filter((t=>t!==e))}}getSurveys(e,t){if(t===void 0&&(t=!1),this._instance.config.disable_surveys)return Jr.info("Disabled. Not loading surveys."),e([]);var n,s=this._instance.get_property(Yw);if(s&&!t)return e(s,{isLoaded:!0});typeof Promise<"u"&&this.ge?this.ge.then((i=>{var{surveys:c,context:d}=i;return e(c,d)})):(typeof Promise<"u"&&(this.ge=new Promise((i=>{n=i}))),this._instance._send_request({url:this._instance.requestRouter.endpointFor("api","/api/surveys/?token="+this._instance.config.token),method:"GET",timeout:this._instance.config.surveys_request_timeout_ms,callback:i=>{var c;this.ge=null;var d=i.statusCode;if(d!==200||!i.json){var m="Surveys API could not be loaded, status: "+d;Jr.error(m);var p={isLoaded:!1,error:m};return e([],p),void(n==null||n({surveys:[],context:p}))}var v,x=i.json.surveys||[],b=x.filter((N=>(function(E){return!(!E.start_date||E.end_date)})(N)&&((function(E){var T;return!((T=E.conditions)==null||(T=T.events)==null||(T=T.values)==null||!T.length)})(N)||(function(E){var T;return!((T=E.conditions)==null||(T=T.actions)==null||(T=T.values)==null||!T.length)})(N))));b.length>0&&((v=this._surveyEventReceiver)==null||v.register(b)),(c=this._instance.persistence)==null||c.register({[Yw]:x});var S={isLoaded:!0};e(x,S),n==null||n({surveys:x,context:S})}}))}be(e){for(var t of this.pe)try{if(!e.isLoaded)return t([],e);this.getSurveys(t)}catch(n){Jr.error("Error in survey callback",n)}}getActiveMatchingSurveys(e,t){if(t===void 0&&(t=!1),!mr(this._surveyManager))return this._surveyManager.getActiveMatchingSurveys(e,t);Jr.warn("init was not called")}ye(e){var t=null;return this.getSurveys((n=>{var s;t=(s=n.find((i=>i.id===e)))!==null&&s!==void 0?s:null})),t}we(e){if(mr(this._surveyManager))return{eligible:!1,reason:"SDK is not enabled or survey functionality is not yet loaded"};var t=typeof e=="string"?this.ye(e):e;return t?this._surveyManager.checkSurveyEligibility(t):{eligible:!1,reason:"Survey not found"}}canRenderSurvey(e){if(mr(this._surveyManager))return Jr.warn("init was not called"),{visible:!1,disabledReason:"SDK is not enabled or survey functionality is not yet loaded"};var t=this.we(e);return{visible:t.eligible,disabledReason:t.reason}}canRenderSurveyAsync(e,t){return mr(this._surveyManager)?(Jr.warn("init was not called"),Promise.resolve({visible:!1,disabledReason:"SDK is not enabled or survey functionality is not yet loaded"})):new Promise((n=>{this.getSurveys((s=>{var i,c=(i=s.find((m=>m.id===e)))!==null&&i!==void 0?i:null;if(c){var d=this.we(c);n({visible:d.eligible,disabledReason:d.reason})}else n({visible:!1,disabledReason:"Survey not found"})}),t)}))}renderSurvey(e,t,n){var s;if(mr(this._surveyManager))Jr.warn("init was not called");else{var i=typeof e=="string"?this.ye(e):e;if(i!=null&&i.id)if(fH.includes(i.type)){var c=Je==null?void 0:Je.querySelector(t);if(c)return(s=i.appearance)!=null&&s.surveyPopupDelaySeconds?(Jr.info("Rendering survey "+i.id+" with delay of "+i.appearance.surveyPopupDelaySeconds+" seconds"),void setTimeout((()=>{var d,m;Jr.info("Rendering survey "+i.id+" with delay of "+((d=i.appearance)==null?void 0:d.surveyPopupDelaySeconds)+" seconds"),(m=this._surveyManager)==null||m.renderSurvey(i,c,n),Jr.info("Survey "+i.id+" rendered")}),1e3*i.appearance.surveyPopupDelaySeconds)):void this._surveyManager.renderSurvey(i,c,n);Jr.warn("Survey element not found")}else Jr.warn("Surveys of type "+i.type+" cannot be rendered in the app");else Jr.warn("Survey not found")}}displaySurvey(e,t){var n;if(mr(this._surveyManager))Jr.warn("init was not called");else{var s=this.ye(e);if(s){var i=s;if((n=s.appearance)!=null&&n.surveyPopupDelaySeconds&&t.ignoreDelay&&(i=tt({},s,{appearance:tt({},s.appearance,{surveyPopupDelaySeconds:0})})),t.displayType!==sb.Popover&&t.initialResponses&&Jr.warn("initialResponses is only supported for popover surveys. prefill will not be applied."),t.ignoreConditions===!1){var c=this.canRenderSurvey(s);if(!c.visible)return void Jr.warn("Survey is not eligible to be displayed: ",c.disabledReason)}t.displayType!==sb.Inline?this._surveyManager.handlePopoverSurvey(i,t):this.renderSurvey(i,t.selector,t.properties)}else Jr.warn("Survey not found")}}cancelPendingSurvey(e){mr(this._surveyManager)?Jr.warn("init was not called"):this._surveyManager.cancelSurvey(e)}handlePageUnload(){var e;(e=this._surveyManager)==null||e.handlePageUnload()}}var Dl=Sn("[Conversations]");class yH{constructor(e){this.xe=void 0,this._conversationsManager=null,this.Ee=!1,this.$e=null,this._instance=e}onRemoteConfig(e){if(!this._instance.config.disable_conversations){var t=e.conversations;mr(t)||(Wl(t)?this.xe=t:(this.xe=t.enabled,this.$e=t),this.loadIfEnabled())}}reset(){var e;(e=this._conversationsManager)==null||e.reset(),this._conversationsManager=null,this.xe=void 0,this.$e=null}loadIfEnabled(){if(!this._conversationsManager&&!this.Ee&&!(this._instance.config.disable_conversations||this._instance.config.cookieless_mode&&this._instance.consent.isOptedOut())){var e=Rt==null?void 0:Rt.__PosthogExtensions__;if(e&&!Xe(this.xe)&&this.xe)if(this.$e&&this.$e.token){this.Ee=!0;try{var t=e.initConversations;if(t)return this.Se(t),void(this.Ee=!1);var n=e.loadExternalDependency;if(!n)return void this.ke("PostHog loadExternalDependency extension not found.");n(this._instance,"conversations",(s=>{s||!e.initConversations?this.ke("Could not load conversations script",s):this.Se(e.initConversations),this.Ee=!1}))}catch(s){this.ke("Error initializing conversations",s),this.Ee=!1}}else Dl.error("Conversations enabled but missing token in remote config.")}}Se(e){if(this.$e)try{this._conversationsManager=e(this.$e,this._instance),Dl.info("Conversations loaded successfully")}catch(t){this.ke("Error completing conversations initialization",t)}else Dl.error("Cannot complete initialization: remote config is null")}ke(e,t){Dl.error(e,t),this._conversationsManager=null,this.Ee=!1}show(){this._conversationsManager?this._conversationsManager.show():Dl.warn("Conversations not loaded yet.")}hide(){this._conversationsManager&&this._conversationsManager.hide()}isAvailable(){return this.xe===!0&&!da(this._conversationsManager)}isVisible(){var e,t;return(e=(t=this._conversationsManager)==null?void 0:t.isVisible())!==null&&e!==void 0&&e}sendMessage(e,t,n){var s=this;return Yf((function*(){return s._conversationsManager?s._conversationsManager.sendMessage(e,t,n):(Dl.warn("Conversations not available yet."),null)}))()}getMessages(e,t){var n=this;return Yf((function*(){return n._conversationsManager?n._conversationsManager.getMessages(e,t):(Dl.warn("Conversations not available yet."),null)}))()}markAsRead(e){var t=this;return Yf((function*(){return t._conversationsManager?t._conversationsManager.markAsRead(e):(Dl.warn("Conversations not available yet."),null)}))()}getTickets(e){var t=this;return Yf((function*(){return t._conversationsManager?t._conversationsManager.getTickets(e):(Dl.warn("Conversations not available yet."),null)}))()}getCurrentTicketId(){var e,t;return(e=(t=this._conversationsManager)==null?void 0:t.getCurrentTicketId())!==null&&e!==void 0?e:null}getWidgetSessionId(){var e,t;return(e=(t=this._conversationsManager)==null?void 0:t.getWidgetSessionId())!==null&&e!==void 0?e:null}}class xH{constructor(e){var t;this.Pe=!1,this.Te=!1,this._instance=e,this._instance&&(t=this._instance.config.logs)!=null&&t.captureConsoleLogs&&(this.Pe=!0)}onRemoteConfig(e){var t,n=(t=e.logs)==null?void 0:t.captureConsoleLogs;!mr(n)&&n&&(this.Pe=!0,this.loadIfEnabled())}reset(){}loadIfEnabled(){if(this.Pe&&!this.Te){var e=Sn("[logs]"),t=Rt==null?void 0:Rt.__PosthogExtensions__;if(t){var n=t.loadExternalDependency;n?n(this._instance,"logs",(s=>{var i;s||(i=t.logs)==null||!i.initializeLogs?e.error("Could not load logs script",s):(t.logs.initializeLogs(this._instance),this.Te=!0)})):e.error("PostHog loadExternalDependency extension not found.")}else e.error("PostHog Extensions not found.")}}}var gk=Sn("[RateLimiter]");class wH{constructor(e){this.serverLimits={},this.lastEventRateLimited=!1,this.checkForLimiting=t=>{var n=t.text;if(n&&n.length)try{(JSON.parse(n).quota_limited||[]).forEach((s=>{gk.info((s||"events")+" is quota limited."),this.serverLimits[s]=new Date().getTime()+6e4}))}catch(s){return void gk.warn('could not rate limit - continuing. Error: "'+(s==null?void 0:s.message)+'"',{text:n})}},this.instance=e,this.lastEventRateLimited=this.clientRateLimitContext(!0).isRateLimited}get captureEventsPerSecond(){var e;return((e=this.instance.config.rate_limiting)==null?void 0:e.events_per_second)||10}get captureEventsBurstLimit(){var e;return Math.max(((e=this.instance.config.rate_limiting)==null?void 0:e.events_burst_limit)||10*this.captureEventsPerSecond,this.captureEventsPerSecond)}clientRateLimitContext(e){var t,n,s;e===void 0&&(e=!1);var{captureEventsBurstLimit:i,captureEventsPerSecond:c}=this,d=new Date().getTime(),m=(t=(n=this.instance.persistence)==null?void 0:n.get_property(Xw))!==null&&t!==void 0?t:{tokens:i,last:d};m.tokens+=(d-m.last)/1e3*c,m.last=d,m.tokens>i&&(m.tokens=i);var p=m.tokens<1;return p||e||(m.tokens=Math.max(0,m.tokens-1)),!p||this.lastEventRateLimited||e||this.instance.capture("$$client_ingestion_warning",{$$client_ingestion_warning_message:"posthog-js client rate limited. Config is set to "+c+" events per second and "+i+" events burst limit."},{skip_client_rate_limiting:!0}),this.lastEventRateLimited=p,(s=this.instance.persistence)==null||s.set_property(Xw,m),{isRateLimited:p,remainingTokens:m.tokens}}isServerRateLimited(e){var t=this.serverLimits[e||"events"]||!1;return t!==!1&&new Date().getTime()<t}}var ed=Sn("[RemoteConfig]");class bH{constructor(e){this._instance=e}get remoteConfig(){var e;return(e=Rt._POSTHOG_REMOTE_CONFIG)==null||(e=e[this._instance.config.token])==null?void 0:e.config}Ie(e){var t,n;(t=Rt.__PosthogExtensions__)!=null&&t.loadExternalDependency?(n=Rt.__PosthogExtensions__)==null||n.loadExternalDependency==null||n.loadExternalDependency(this._instance,"remote-config",(()=>e(this.remoteConfig))):(ed.error("PostHog Extensions not found. Cannot load remote config."),e())}Ce(e){this._instance._send_request({method:"GET",url:this._instance.requestRouter.endpointFor("assets","/array/"+this._instance.config.token+"/config"),callback:t=>{e(t.json)}})}load(){try{if(this.remoteConfig)return ed.info("Using preloaded remote config",this.remoteConfig),void this.wi(this.remoteConfig);if(this._instance.M())return void ed.warn("Remote config is disabled. Falling back to local config.");this.Ie((e=>{if(!e)return ed.info("No config found after loading remote JS config. Falling back to JSON."),void this.Ce((t=>{this.wi(t)}));this.wi(e)}))}catch(e){ed.error("Error loading remote config",e)}}wi(e){e?this._instance.config.__preview_remote_config?(this._instance.wi(e),e.hasFeatureFlags!==!1&&this._instance.featureFlags.ensureFlagsLoaded()):ed.info("__preview_remote_config is disabled. Logging config instead",e):ed.error("Failed to fetch remote config from PostHog.")}}var ob=3e3;class _H{constructor(e,t){this.Re=!0,this.Fe=[],this.Oe=Ka((t==null?void 0:t.flush_interval_ms)||ob,250,5e3,et.createLogger("flush interval"),ob),this.Me=e}enqueue(e){this.Fe.push(e),this.Ae||this.je()}unload(){this.De();var e=this.Fe.length>0?this.Le():{},t=Object.values(e);[...t.filter((n=>n.url.indexOf("/e")===0)),...t.filter((n=>n.url.indexOf("/e")!==0))].map((n=>{this.Me(tt({},n,{transport:"sendBeacon"}))}))}enable(){this.Re=!1,this.je()}je(){var e=this;this.Re||(this.Ae=setTimeout((()=>{if(this.De(),this.Fe.length>0){var t=this.Le(),n=function(){var i=t[s],c=new Date().getTime();i.data&&Mr(i.data)&&rn(i.data,(d=>{d.offset=Math.abs(d.timestamp-c),delete d.timestamp})),e.Me(i)};for(var s in t)n()}}),this.Oe))}De(){clearTimeout(this.Ae),this.Ae=void 0}Le(){var e={};return rn(this.Fe,(t=>{var n,s=t,i=(s?s.batchKey:null)||s.url;Xe(e[i])&&(e[i]=tt({},s,{data:[]})),(n=e[i].data)==null||n.push(s.data)})),this.Fe=[],e}}var SH=["retriesPerformedSoFar"];class EH{constructor(e){this.Ne=!1,this.Ue=3e3,this.Fe=[],this._instance=e,this.Fe=[],this.ze=!0,!Xe(Se)&&"onLine"in Se.navigator&&(this.ze=Se.navigator.onLine,this.He=()=>{this.ze=!0,this.Lt()},this.Be=()=>{this.ze=!1},Ln(Se,"online",this.He),Ln(Se,"offline",this.Be))}get length(){return this.Fe.length}retriableRequest(e){var{retriesPerformedSoFar:t}=e,n=UT(e,SH);Vf(t)&&(n.url=by(n.url,{retry_count:t})),this._instance._send_request(tt({},n,{callback:s=>{s.statusCode!==200&&(s.statusCode<400||s.statusCode>=500)&&(t??0)<10?this.qe(tt({retriesPerformedSoFar:t},n)):n.callback==null||n.callback(s)}}))}qe(e){var t=e.retriesPerformedSoFar||0;e.retriesPerformedSoFar=t+1;var n=(function(c){var d=3e3*Math.pow(2,c),m=d/2,p=Math.min(18e5,d),v=(Math.random()-.5)*(p-m);return Math.ceil(p+v)})(t),s=Date.now()+n;this.Fe.push({retryAt:s,requestOptions:e});var i="Enqueued failed request for retry in "+n;navigator.onLine||(i+=" (Browser is offline)"),et.warn(i),this.Ne||(this.Ne=!0,this.We())}We(){if(this.Ge&&clearTimeout(this.Ge),this.Fe.length===0)return this.Ne=!1,void(this.Ge=void 0);this.Ge=setTimeout((()=>{this.ze&&this.Fe.length>0&&this.Lt(),this.We()}),this.Ue)}Lt(){var e=Date.now(),t=[],n=this.Fe.filter((i=>i.retryAt<e||(t.push(i),!1)));if(this.Fe=t,n.length>0)for(var{requestOptions:s}of n)this.retriableRequest(s)}unload(){for(var{requestOptions:e}of(this.Ge&&(clearTimeout(this.Ge),this.Ge=void 0),this.Ne=!1,Xe(Se)||(this.He&&(Se.removeEventListener("online",this.He),this.He=void 0),this.Be&&(Se.removeEventListener("offline",this.Be),this.Be=void 0)),this.Fe))try{this._instance._send_request(tt({},e,{transport:"sendBeacon"}))}catch(t){et.error(t)}this.Fe=[]}}class CH{constructor(e){this.Ve=()=>{var t,n,s,i;this.Je||(this.Je={});var c=this.scrollElement(),d=this.scrollY(),m=c?Math.max(0,c.scrollHeight-c.clientHeight):0,p=d+((c==null?void 0:c.clientHeight)||0),v=(c==null?void 0:c.scrollHeight)||0;this.Je.lastScrollY=Math.ceil(d),this.Je.maxScrollY=Math.max(d,(t=this.Je.maxScrollY)!==null&&t!==void 0?t:0),this.Je.maxScrollHeight=Math.max(m,(n=this.Je.maxScrollHeight)!==null&&n!==void 0?n:0),this.Je.lastContentY=p,this.Je.maxContentY=Math.max(p,(s=this.Je.maxContentY)!==null&&s!==void 0?s:0),this.Je.maxContentHeight=Math.max(v,(i=this.Je.maxContentHeight)!==null&&i!==void 0?i:0)},this._instance=e}getContext(){return this.Je}resetContext(){var e=this.Je;return setTimeout(this.Ve,0),e}startMeasuringScrollPosition(){Ln(Se,"scroll",this.Ve,{capture:!0}),Ln(Se,"scrollend",this.Ve,{capture:!0}),Ln(Se,"resize",this.Ve)}scrollElement(){if(!this._instance.config.scroll_root_selector)return Se==null?void 0:Se.document.documentElement;var e=Mr(this._instance.config.scroll_root_selector)?this._instance.config.scroll_root_selector:[this._instance.config.scroll_root_selector];for(var t of e){var n=Se==null?void 0:Se.document.querySelector(t);if(n)return n}}scrollY(){if(this._instance.config.scroll_root_selector){var e=this.scrollElement();return e&&e.scrollTop||0}return Se&&(Se.scrollY||Se.pageYOffset||Se.document.documentElement.scrollTop)||0}scrollX(){if(this._instance.config.scroll_root_selector){var e=this.scrollElement();return e&&e.scrollLeft||0}return Se&&(Se.scrollX||Se.pageXOffset||Se.document.documentElement.scrollLeft)||0}}var kH=r=>OA(r==null?void 0:r.config.mask_personal_data_properties,r==null?void 0:r.config.custom_personal_data_properties);class vk{constructor(e,t,n,s){this.Ke=i=>{var c=this.Ye();if(!c||c.sessionId!==i){var d={sessionId:i,props:this.Xe(this._instance)};this.Qe.register({[Jw]:d})}},this._instance=e,this.Ze=t,this.Qe=n,this.Xe=s||kH,this.Ze.onSessionId(this.Ke)}Ye(){return this.Qe.props[Jw]}getSetOnceProps(){var e,t=(e=this.Ye())==null?void 0:e.props;return t?"r"in t?DA(t):{$referring_domain:t.referringDomain,$pathname:t.initialPathName,utm_source:t.utm_source,utm_campaign:t.utm_campaign,utm_medium:t.utm_medium,utm_content:t.utm_content,utm_term:t.utm_term}:{}}getSessionProps(){var e={};return rn(Q_(this.getSetOnceProps()),((t,n)=>{n==="$current_url"&&(n="url"),e["$session_entry_"+$w(n)]=t})),e}}var Vx=Sn("[SessionId]");class yk{on(e,t){return this.tr.on(e,t)}constructor(e,t,n){var s;if(this.ir=[],this.er=void 0,this.tr=new sS,this.rr=(v,x)=>!(!Vf(v)||!Vf(x))&&Math.abs(v-x)>this.sessionTimeoutMs,!e.persistence)throw new Error("SessionIdManager requires a PostHogPersistence instance");if(e.config.cookieless_mode==="always")throw new Error('SessionIdManager cannot be used with cookieless_mode="always"');this.R=e.config,this.Qe=e.persistence,this.sr=void 0,this.nr=void 0,this._sessionStartTimestamp=null,this._sessionActivityTimestamp=null,this.ar=t||Gc,this.lr=n||Gc;var i=this.R.persistence_name||this.R.token,c=this.R.session_idle_timeout_seconds||1800;if(this._sessionTimeoutMs=1e3*Ka(c,60,36e3,Vx.createLogger("session_idle_timeout_seconds"),1800),e.register({$configured_session_timeout_ms:this._sessionTimeoutMs}),this.ur(),this.hr="ph_"+i+"_window_id",this.dr="ph_"+i+"_primary_window_exists",this.vr()){var d=ys.W(this.hr),m=ys.W(this.dr);d&&!m?this.sr=d:ys.V(this.hr),ys.G(this.dr,!0)}if((s=this.R.bootstrap)!=null&&s.sessionID)try{var p=(v=>{var x=v.replace(/-/g,"");if(x.length!==32)throw new Error("Not a valid UUID");if(x[12]!=="7")throw new Error("Not a UUIDv7");return parseInt(x.substring(0,12),16)})(this.R.bootstrap.sessionID);this.cr(this.R.bootstrap.sessionID,new Date().getTime(),p)}catch(v){Vx.error("Invalid sessionID in bootstrap",v)}this.pr()}get sessionTimeoutMs(){return this._sessionTimeoutMs}onSessionId(e){return Xe(this.ir)&&(this.ir=[]),this.ir.push(e),this.nr&&e(this.nr,this.sr),()=>{this.ir=this.ir.filter((t=>t!==e))}}vr(){return this.R.persistence!=="memory"&&!this.Qe.Pi&&ys.H()}gr(e){e!==this.sr&&(this.sr=e,this.vr()&&ys.G(this.hr,e))}_r(){return this.sr?this.sr:this.vr()?ys.W(this.hr):null}cr(e,t,n){e===this.nr&&t===this._sessionActivityTimestamp&&n===this._sessionStartTimestamp||(this._sessionStartTimestamp=n,this._sessionActivityTimestamp=t,this.nr=e,this.Qe.register({[dy]:[t,e,n]}))}mr(){var e=this.Qe.props[dy];return Mr(e)&&e.length===2&&e.push(e[0]),e||[0,null,0]}resetSessionId(){this.cr(null,null,null)}destroy(){clearTimeout(this.br),this.br=void 0,this.er&&Se&&(Se.removeEventListener("beforeunload",this.er,{capture:!1}),this.er=void 0),this.ir=[]}pr(){this.er=()=>{this.vr()&&ys.V(this.dr)},Ln(Se,"beforeunload",this.er,{capture:!1})}checkAndGetSessionAndWindowId(e,t){if(e===void 0&&(e=!1),t===void 0&&(t=null),this.R.cookieless_mode==="always")throw new Error('checkAndGetSessionAndWindowId should not be called with cookieless_mode="always"');var n=t||new Date().getTime(),[s,i,c]=this.mr(),d=this._r(),m=Vf(c)&&Math.abs(n-c)>864e5,p=!1,v=!i,x=!v&&!e&&this.rr(n,s);v||x||m?(i=this.ar(),d=this.lr(),Vx.info("new session ID generated",{sessionId:i,windowId:d,changeReason:{noSessionId:v,activityTimeout:x,sessionPastMaximumLength:m}}),c=n,p=!0):d||(d=this.lr(),p=!0);var b=Vf(s)&&e&&!m?s:n,S=Vf(c)?c:new Date().getTime();return this.gr(d),this.cr(i,b,S),e||this.ur(),p&&this.ir.forEach((N=>N(i,d,p?{noSessionId:v,activityTimeout:x,sessionPastMaximumLength:m}:void 0))),{sessionId:i,windowId:d,sessionStartTimestamp:S,changeReason:p?{noSessionId:v,activityTimeout:x,sessionPastMaximumLength:m}:void 0,lastActivityTimestamp:s}}ur(){clearTimeout(this.br),this.br=setTimeout((()=>{var[e]=this.mr();if(this.rr(new Date().getTime(),e)){var t=this.nr;this.resetSessionId(),this.tr.emit("forcedIdleReset",{idleSessionId:t})}}),1.1*this.sessionTimeoutMs)}}var NH=["$set_once","$set"],$c=Sn("[SiteApps]");class TH{constructor(e){this._instance=e,this.yr=[],this.apps={}}get isEnabled(){return!!this._instance.config.opt_in_site_apps}wr(e,t){if(t){var n=this.globalsForEvent(t);this.yr.push(n),this.yr.length>1e3&&(this.yr=this.yr.slice(10))}}get siteAppLoaders(){var e;return(e=Rt._POSTHOG_REMOTE_CONFIG)==null||(e=e[this._instance.config.token])==null?void 0:e.siteApps}init(){if(this.isEnabled){var e=this._instance._addCaptureHook(this.wr.bind(this));this.Er=()=>{e(),this.yr=[],this.Er=void 0}}}globalsForEvent(e){var t,n,s,i,c,d,m;if(!e)throw new Error("Event payload is required");var p={},v=this._instance.get_property("$groups")||[],x=this._instance.get_property("$stored_group_properties")||{};for(var[b,S]of Object.entries(x))p[b]={id:v[b],type:b,properties:S};var{$set_once:N,$set:E}=e;return{event:tt({},UT(e,NH),{properties:tt({},e.properties,E?{$set:tt({},(t=(n=e.properties)==null?void 0:n.$set)!==null&&t!==void 0?t:{},E)}:{},N?{$set_once:tt({},(s=(i=e.properties)==null?void 0:i.$set_once)!==null&&s!==void 0?s:{},N)}:{}),elements_chain:(c=(d=e.properties)==null?void 0:d.$elements_chain)!==null&&c!==void 0?c:"",distinct_id:(m=e.properties)==null?void 0:m.distinct_id}),person:{properties:this._instance.get_property("$stored_person_properties")},groups:p}}setupSiteApp(e){var t=this.apps[e.id],n=()=>{var d;!t.errored&&this.yr.length&&($c.info("Processing "+this.yr.length+" events for site app with id "+e.id),this.yr.forEach((m=>t.processEvent==null?void 0:t.processEvent(m))),t.processedBuffer=!0),Object.values(this.apps).every((m=>m.processedBuffer||m.errored))&&((d=this.Er)==null||d.call(this))},s=!1,i=d=>{t.errored=!d,t.loaded=!0,$c.info("Site app with id "+e.id+" "+(d?"loaded":"errored")),s&&n()};try{var{processEvent:c}=e.init({posthog:this._instance,callback:d=>{i(d)}});c&&(t.processEvent=c),s=!0}catch(d){$c.error("Error while initializing PostHog app with config id "+e.id,d),i(!1)}if(s&&t.loaded)try{n()}catch(d){$c.error("Error while processing buffered events PostHog app with config id "+e.id,d),t.errored=!0}}$r(){var e=this.siteAppLoaders||[];for(var t of e)this.apps[t.id]={id:t.id,loaded:!1,errored:!1,processedBuffer:!1};for(var n of e)this.setupSiteApp(n)}Sr(e){if(Object.keys(this.apps).length!==0){var t=this.globalsForEvent(e);for(var n of Object.values(this.apps))try{n.processEvent==null||n.processEvent(t)}catch(s){$c.error("Error while processing event "+e.event+" for site app "+n.id,s)}}}onRemoteConfig(e){var t,n,s,i=this;if((t=this.siteAppLoaders)!=null&&t.length)return this.isEnabled?(this.$r(),void this._instance.on("eventCaptured",(p=>this.Sr(p)))):void $c.error('PostHog site apps are disabled. Enable the "opt_in_site_apps" config to proceed.');if((n=this.Er)==null||n.call(this),(s=e.siteApps)!=null&&s.length)if(this.isEnabled){var c=function(p){var v;Rt["__$$ph_site_app_"+p]=i._instance,(v=Rt.__PosthogExtensions__)==null||v.loadSiteApp==null||v.loadSiteApp(i._instance,m,(x=>{if(x)return $c.error("Error while initializing PostHog app with config id "+p,x)}))};for(var{id:d,url:m}of e.siteApps)c(d)}else $c.error('PostHog site apps are disabled. Enable the "opt_in_site_apps" config to proceed.')}}var VA=function(r,e){if(!r)return!1;var t=r.userAgent;if(t&&TC(t,e))return!0;try{var n=r==null?void 0:r.userAgentData;if(n!=null&&n.brands&&n.brands.some((s=>TC(s==null?void 0:s.brand,e))))return!0}catch{}return!!r.webdriver},vm=(function(r){return r.US="us",r.EU="eu",r.CUSTOM="custom",r})({}),xk="i.posthog.com";class AH{constructor(e){this.kr={},this.instance=e}get apiHost(){var e=this.instance.config.api_host.trim().replace(/\/$/,"");return e==="https://app.posthog.com"?"https://us.i.posthog.com":e}get flagsApiHost(){var e=this.instance.config.flags_api_host;return e?e.trim().replace(/\/$/,""):this.apiHost}get uiHost(){var e,t=(e=this.instance.config.ui_host)==null?void 0:e.replace(/\/$/,"");return t||(t=this.apiHost.replace("."+xk,".posthog.com")),t==="https://app.posthog.com"?"https://us.posthog.com":t}get region(){return this.kr[this.apiHost]||(/https:\/\/(app|us|us-assets)(\.i)?\.posthog\.com/i.test(this.apiHost)?this.kr[this.apiHost]=vm.US:/https:\/\/(eu|eu-assets)(\.i)?\.posthog\.com/i.test(this.apiHost)?this.kr[this.apiHost]=vm.EU:this.kr[this.apiHost]=vm.CUSTOM),this.kr[this.apiHost]}endpointFor(e,t){if(t===void 0&&(t=""),t&&(t=t[0]==="/"?t:"/"+t),e==="ui")return this.uiHost+t;if(e==="flags")return this.flagsApiHost+t;if(this.region===vm.CUSTOM)return this.apiHost+t;var n=xk+t;switch(e){case"assets":return"https://"+this.region+"-assets."+n;case"api":return"https://"+this.region+"."+n}}}var RH={icontains:(r,e)=>!!Se&&e.href.toLowerCase().indexOf(r.toLowerCase())>-1,not_icontains:(r,e)=>!!Se&&e.href.toLowerCase().indexOf(r.toLowerCase())===-1,regex:(r,e)=>!!Se&&_y(e.href,r),not_regex:(r,e)=>!!Se&&!_y(e.href,r),exact:(r,e)=>e.href===r,is_not:(r,e)=>e.href!==r};class Ls{constructor(e){var t=this;this.getWebExperimentsAndEvaluateDisplayLogic=function(n){n===void 0&&(n=!1),t.getWebExperiments((s=>{Ls.Pr("retrieved web experiments from the server"),t.Tr=new Map,s.forEach((i=>{if(i.feature_flag_key){var c;t.Tr&&(Ls.Pr("setting flag key ",i.feature_flag_key," to web experiment ",i),(c=t.Tr)==null||c.set(i.feature_flag_key,i));var d=t._instance.getFeatureFlag(i.feature_flag_key);qn(d)&&i.variants[d]&&t.Ir(i.name,d,i.variants[d].transforms)}else if(i.variants)for(var m in i.variants){var p=i.variants[m];Ls.Cr(p)&&t.Ir(i.name,m,p.transforms)}}))}),n)},this._instance=e,this._instance.onFeatureFlags((n=>{this.onFeatureFlags(n)}))}onFeatureFlags(e){if(this._is_bot())Ls.Pr("Refusing to render web experiment since the viewer is a likely bot");else if(!this._instance.config.disable_web_experiments){if(mr(this.Tr))return this.Tr=new Map,this.loadIfEnabled(),void this.previewWebExperiment();Ls.Pr("applying feature flags",e),e.forEach((t=>{var n;if(this.Tr&&(n=this.Tr)!=null&&n.has(t)){var s,i=this._instance.getFeatureFlag(t),c=(s=this.Tr)==null?void 0:s.get(t);i&&c!=null&&c.variants[i]&&this.Ir(c.name,i,c.variants[i].transforms)}}))}}previewWebExperiment(){var e=Ls.getWindowLocation();if(e!=null&&e.search){var t=vy(e==null?void 0:e.search,"__experiment_id"),n=vy(e==null?void 0:e.search,"__experiment_variant");t&&n&&(Ls.Pr("previewing web experiments "+t+" && "+n),this.getWebExperiments((s=>{this.Rr(parseInt(t),n,s)}),!1,!0))}}loadIfEnabled(){this._instance.config.disable_web_experiments||this.getWebExperimentsAndEvaluateDisplayLogic()}getWebExperiments(e,t,n){if(this._instance.config.disable_web_experiments&&!n)return e([]);var s=this._instance.get_property("$web_experiments");if(s&&!t)return e(s);this._instance._send_request({url:this._instance.requestRouter.endpointFor("api","/api/web_experiments/?token="+this._instance.config.token),method:"GET",callback:i=>{if(i.statusCode!==200||!i.json)return e([]);var c=i.json.experiments||[];return e(c)}})}Rr(e,t,n){var s=n.filter((i=>i.id===e));s&&s.length>0&&(Ls.Pr("Previewing web experiment ["+s[0].name+"] with variant ["+t+"]"),this.Ir(s[0].name,t,s[0].variants[t].transforms))}static Cr(e){return!mr(e.conditions)&&Ls.Fr(e)&&Ls.Or(e)}static Fr(e){var t;if(mr(e.conditions)||mr((t=e.conditions)==null?void 0:t.url))return!0;var n,s,i,c=Ls.getWindowLocation();return!!c&&((n=e.conditions)==null||!n.url||RH[(s=(i=e.conditions)==null?void 0:i.urlMatchType)!==null&&s!==void 0?s:"icontains"](e.conditions.url,c))}static getWindowLocation(){return Se==null?void 0:Se.location}static Or(e){var t;if(mr(e.conditions)||mr((t=e.conditions)==null?void 0:t.utm))return!0;var n=IA();if(n.utm_source){var s,i,c,d,m,p,v,x,b=(s=e.conditions)==null||(s=s.utm)==null||!s.utm_campaign||((i=e.conditions)==null||(i=i.utm)==null?void 0:i.utm_campaign)==n.utm_campaign,S=(c=e.conditions)==null||(c=c.utm)==null||!c.utm_source||((d=e.conditions)==null||(d=d.utm)==null?void 0:d.utm_source)==n.utm_source,N=(m=e.conditions)==null||(m=m.utm)==null||!m.utm_medium||((p=e.conditions)==null||(p=p.utm)==null?void 0:p.utm_medium)==n.utm_medium,E=(v=e.conditions)==null||(v=v.utm)==null||!v.utm_term||((x=e.conditions)==null||(x=x.utm)==null?void 0:x.utm_term)==n.utm_term;return b&&N&&E&&S}return!1}static Pr(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];et.info("[WebExperiments] "+e,n)}Ir(e,t,n){this._is_bot()?Ls.Pr("Refusing to render web experiment since the viewer is a likely bot"):t!=="control"?n.forEach((s=>{if(s.selector){var i;Ls.Pr("applying transform of variant "+t+" for experiment "+e+" ",s);var c=(i=document)==null?void 0:i.querySelectorAll(s.selector);c==null||c.forEach((d=>{var m=d;s.html&&(m.innerHTML=s.html),s.css&&m.setAttribute("style",s.css)}))}})):Ls.Pr("Control variants leave the page unmodified.")}_is_bot(){return ni&&this._instance?VA(ni,this._instance.config.custom_blocked_useragents):void 0}}var IH=Sn("[PostHog ExternalIntegrations]"),PH={intercom:"intercom-integration",crispChat:"crisp-chat-integration"};class FH{constructor(e){this._instance=e}it(e,t){var n;(n=Rt.__PosthogExtensions__)==null||n.loadExternalDependency==null||n.loadExternalDependency(this._instance,e,(s=>{if(s)return IH.error("failed to load script",s);t()}))}startIfEnabledOrStop(){var e=this,t=function(c){var d,m,p;!s||(d=Rt.__PosthogExtensions__)!=null&&(d=d.integrations)!=null&&d[c]||e.it(PH[c],(()=>{var v;(v=Rt.__PosthogExtensions__)==null||(v=v.integrations)==null||(v=v[c])==null||v.start(e._instance)})),!s&&(m=Rt.__PosthogExtensions__)!=null&&(m=m.integrations)!=null&&m[c]&&((p=Rt.__PosthogExtensions__)==null||(p=p.integrations)==null||(p=p[c])==null||p.stop())};for(var[n,s]of Object.entries((i=this._instance.config.integrations)!==null&&i!==void 0?i:{})){var i;t(n)}}}var ib="[SessionRecording]",Zp=Sn(ib);class wk{get started(){var e;return!((e=this.Mr)==null||!e.isStarted)}get status(){return this.Mr?this.Mr.status:this.Ar&&!this.jr?"disabled":"lazy_loading"}constructor(e){if(this._forceAllowLocalhostNetworkCapture=!1,this.Ar=!1,this.Dr=void 0,this._instance=e,!this._instance.sessionManager)throw Zp.error("started without valid sessionManager"),new Error(ib+" started without valid sessionManager. This is a bug.");if(this._instance.config.cookieless_mode==="always")throw new Error(ib+' cannot be used with cookieless_mode="always"')}get jr(){var e,t=!((e=this._instance.get_property(Px))==null||!e.enabled),n=!this._instance.config.disable_session_recording,s=this._instance.config.disable_session_recording||this._instance.consent.isOptedOut();return Se&&t&&n&&!s}startIfEnabledOrStop(e){var t;if(!this.jr||(t=this.Mr)==null||!t.isStarted){var n=!Xe(Object.assign)&&!Xe(Array.from);this.jr&&n?(this.Lr(e),Zp.info("starting")):this.stopRecording()}}Lr(e){var t,n,s;this.jr&&(Rt!=null&&(t=Rt.__PosthogExtensions__)!=null&&(t=t.rrweb)!=null&&t.record&&(n=Rt.__PosthogExtensions__)!=null&&n.initSessionRecording?this.Nr(e):(s=Rt.__PosthogExtensions__)==null||s.loadExternalDependency==null||s.loadExternalDependency(this._instance,this.Ur,(i=>{if(i)return Zp.error("could not load recorder",i);this.Nr(e)})))}stopRecording(){var e,t;(e=this.Dr)==null||e.call(this),this.Dr=void 0,(t=this.Mr)==null||t.stop()}zr(){var e;(e=this._instance.persistence)==null||e.unregister(fA)}Hr(e){if(this._instance.persistence){var t,n,s=this._instance.persistence,i=()=>{var c=e.sessionRecording===!1?void 0:e.sessionRecording,d=c==null?void 0:c.sampleRate,m=mr(d)?null:parseFloat(d);mr(m)&&this.zr();var p=c==null?void 0:c.minimumDurationMilliseconds;s.register({[Px]:tt({cache_timestamp:Date.now(),enabled:!!c},c,{networkPayloadCapture:tt({capturePerformance:e.capturePerformance},c==null?void 0:c.networkPayloadCapture),canvasRecording:{enabled:c==null?void 0:c.recordCanvas,fps:c==null?void 0:c.canvasFps,quality:c==null?void 0:c.canvasQuality},sampleRate:m,minimumDurationMilliseconds:Xe(p)?null:p,endpoint:c==null?void 0:c.endpoint,triggerMatchType:c==null?void 0:c.triggerMatchType,masking:c==null?void 0:c.masking,urlTriggers:c==null?void 0:c.urlTriggers})})};i(),(t=this.Dr)==null||t.call(this),this.Dr=(n=this._instance.sessionManager)==null?void 0:n.onSessionId(i)}}onRemoteConfig(e){"sessionRecording"in e?e.sessionRecording!==!1?(this.Hr(e),this.Ar=!0,this.startIfEnabledOrStop()):this.Ar=!0:Zp.info("skipping remote config with no sessionRecording",e)}log(e,t){var n;t===void 0&&(t="log"),(n=this.Mr)!=null&&n.log?this.Mr.log(e,t):Zp.warn("log called before recorder was ready")}get Ur(){var e,t,n=(e=this._instance)==null||(e=e.persistence)==null?void 0:e.get_property(Px);return(n==null||(t=n.scriptConfig)==null?void 0:t.script)||"lazy-recorder"}Nr(e){var t,n;if((t=Rt.__PosthogExtensions__)==null||!t.initSessionRecording)throw Error("Called on script loaded before session recording is available");this.Mr||(this.Mr=(n=Rt.__PosthogExtensions__)==null?void 0:n.initSessionRecording(this._instance),this.Mr._forceAllowLocalhostNetworkCapture=this._forceAllowLocalhostNetworkCapture),this.Mr.start(e)}onRRwebEmit(e){var t;(t=this.Mr)==null||t.onRRwebEmit==null||t.onRRwebEmit(e)}overrideLinkedFlag(){var e,t;this.Mr||(t=this._instance.persistence)==null||t.register({$replay_override_linked_flag:!0}),(e=this.Mr)==null||e.overrideLinkedFlag()}overrideSampling(){var e,t;this.Mr||(t=this._instance.persistence)==null||t.register({$replay_override_sampling:!0}),(e=this.Mr)==null||e.overrideSampling()}overrideTrigger(e){var t,n;this.Mr||(n=this._instance.persistence)==null||n.register({[e==="url"?"$replay_override_url_trigger":"$replay_override_event_trigger"]:!0}),(t=this.Mr)==null||t.overrideTrigger(e)}get sdkDebugProperties(){var e;return((e=this.Mr)==null?void 0:e.sdkDebugProperties)||{$recording_status:this.status}}tryAddCustomEvent(e,t){var n;return!((n=this.Mr)==null||!n.tryAddCustomEvent(e,t))}}var Em={},ab=()=>{},qf="posthog",qA=!sH&&(Fo==null?void 0:Fo.indexOf("MSIE"))===-1&&(Fo==null?void 0:Fo.indexOf("Mozilla"))===-1,bk=r=>{var e;return tt({api_host:"https://us.i.posthog.com",flags_api_host:null,ui_host:null,token:"",autocapture:!0,cross_subdomain_cookie:cz(Je==null?void 0:Je.location),persistence:"localStorage+cookie",persistence_name:"",cookie_persisted_properties:[],loaded:ab,save_campaign_params:!0,custom_campaign_params:[],custom_blocked_useragents:[],save_referrer:!0,capture_pageleave:"if_capture_pageview",defaults:r??"unset",__preview_deferred_init_extensions:!1,debug:ws&&qn(ws==null?void 0:ws.search)&&ws.search.indexOf("__posthog_debug=true")!==-1||!1,cookie_expiration:365,upgrade:!1,disable_session_recording:!1,disable_persistence:!1,disable_web_experiments:!0,disable_surveys:!1,disable_surveys_automatic_display:!1,disable_conversations:!1,disable_product_tours:!0,disable_external_dependency_loading:!1,enable_recording_console_log:void 0,secure_cookie:(Se==null||(e=Se.location)==null?void 0:e.protocol)==="https:",ip:!1,opt_out_capturing_by_default:!1,opt_out_persistence_by_default:!1,opt_out_useragent_filter:!1,opt_out_capturing_persistence_type:"localStorage",consent_persistence_name:null,opt_out_capturing_cookie_prefix:null,opt_in_site_apps:!1,property_denylist:[],respect_dnt:!1,sanitize_properties:null,request_headers:{},request_batching:!0,properties_string_max_length:65535,mask_all_element_attributes:!1,mask_all_text:!1,mask_personal_data_properties:!1,custom_personal_data_properties:[],advanced_disable_flags:!1,advanced_disable_decide:!1,advanced_disable_feature_flags:!1,advanced_disable_feature_flags_on_first_load:!1,advanced_only_evaluate_survey_feature_flags:!1,advanced_enable_surveys:!1,advanced_disable_toolbar_metrics:!1,feature_flag_request_timeout_ms:3e3,surveys_request_timeout_ms:1e4,on_request_error:t=>{var n="Bad HTTP status: "+t.statusCode+" "+t.text;et.error(n)},get_device_id:t=>t,capture_performance:void 0,name:"posthog",bootstrap:{},disable_compression:!1,session_idle_timeout_seconds:1800,person_profiles:"identified_only",before_send:void 0,request_queue_config:{flush_interval_ms:ob},error_tracking:{},_onCapture:ab,__preview_eager_load_replay:!1},(t=>({rageclick:!(t&&t>="2025-11-30")||{content_ignorelist:!0},capture_pageview:!(t&&t>="2025-05-24")||"history_change",session_recording:t&&t>="2025-11-30"?{strictMinimumDuration:!0}:{},external_scripts_inject_target:t&&t>="2026-01-30"?"head":"body",internal_or_test_user_hostname:t&&t>="2026-01-30"?/^(localhost|127\.0\.0\.1)$/:void 0}))(r))},_k=r=>{var e={};Xe(r.process_person)||(e.person_profiles=r.process_person),Xe(r.xhr_headers)||(e.request_headers=r.xhr_headers),Xe(r.cookie_name)||(e.persistence_name=r.cookie_name),Xe(r.disable_cookie)||(e.disable_persistence=r.disable_cookie),Xe(r.store_google)||(e.save_campaign_params=r.store_google),Xe(r.verbose)||(e.debug=r.verbose);var t=In({},e,r);return Mr(r.property_blacklist)&&(Xe(r.property_denylist)?t.property_denylist=r.property_blacklist:Mr(r.property_denylist)?t.property_denylist=[...r.property_blacklist,...r.property_denylist]:et.error("Invalid value for property_denylist config: "+r.property_denylist)),t};class jH{constructor(){this.__forceAllowLocalhost=!1}get Br(){return this.__forceAllowLocalhost}set Br(e){et.error("WebPerformanceObserver is deprecated and has no impact on network capture. Use `_forceAllowLocalhostNetworkCapture` on `posthog.sessionRecording`"),this.__forceAllowLocalhost=e}}class qy{get decideEndpointWasHit(){var e,t;return(e=(t=this.featureFlags)==null?void 0:t.hasLoadedFlags)!==null&&e!==void 0&&e}get flagsEndpointWasHit(){var e,t;return(e=(t=this.featureFlags)==null?void 0:t.hasLoadedFlags)!==null&&e!==void 0&&e}constructor(){this.webPerformance=new jH,this.qr=!1,this.version=Ul.LIB_VERSION,this.bi=new sS,this._calculate_event_properties=this.calculateEventProperties.bind(this),this.config=bk(),this.SentryIntegration=Mz,this.sentryIntegration=e=>(function(t,n){var s=RA(t,n);return{name:AA,processEvent:i=>s(i)}})(this,e),this.__request_queue=[],this.__loaded=!1,this.analyticsDefaultEndpoint="/e/",this.Wr=!1,this.Gr=null,this.Vr=null,this.Jr=null,this.featureFlags=new lH(this),this.toolbar=new Uz(this),this.scrollManager=new CH(this),this.pageViewManager=new nk(this),this.surveys=new vH(this),this.conversations=new yH(this),this.logs=new xH(this),this.experiments=new Ls(this),this.exceptions=new oH(this),this.rateLimiter=new wH(this),this.requestRouter=new AH(this),this.consent=new Pz(this),this.externalIntegrations=new FH(this),this.people={set:(e,t,n)=>{var s=qn(e)?{[e]:t}:e;this.setPersonProperties(s),n==null||n({})},set_once:(e,t,n)=>{var s=qn(e)?{[e]:t}:e;this.setPersonProperties(void 0,s),n==null||n({})}},this.on("eventCaptured",(e=>et.info('send "'+(e==null?void 0:e.event)+'"',e)))}init(e,t,n){if(n&&n!==qf){var s,i=(s=Em[n])!==null&&s!==void 0?s:new qy;return i._init(e,t,n),Em[n]=i,Em[qf][n]=i,i}return this._init(e,t,n)}_init(e,t,n){var s;if(t===void 0&&(t={}),Xe(e)||Uw(e))return et.critical("PostHog was initialized without a token. This likely indicates a misconfiguration. Please check the first argument passed to posthog.init()"),this;if(this.__loaded)return console.warn("[PostHog.js]","You have already initialized PostHog! Re-initializing is a no-op"),this;this.__loaded=!0,this.config={},t.debug=this.Kr(t.debug),this.Yr=t,this.Xr=[],t.person_profiles&&(this.Vr=t.person_profiles),this.set_config(In({},bk(t.defaults),_k(t),{name:n,token:e})),this.config.on_xhr_error&&et.error("on_xhr_error is deprecated. Use on_request_error instead"),this.compression=t.disable_compression?void 0:Bl.GZipJS;var i=this.Qr();this.persistence=new Hx(this.config,i),this.sessionPersistence=this.config.persistence==="sessionStorage"||this.config.persistence==="memory"?this.persistence:new Hx(tt({},this.config,{persistence:"sessionStorage"}),i);var c=tt({},this.persistence.props),d=tt({},this.sessionPersistence.props);this.register({$initialization_time:new Date().toISOString()}),this.Zr=new _H((R=>this.ts(R)),this.config.request_queue_config),this.es=new EH(this),this.__request_queue=[];var m=this.config.cookieless_mode==="always"||this.config.cookieless_mode==="on_reject"&&this.consent.isExplicitlyOptedOut();if(m||(this.sessionManager=new yk(this),this.sessionPropsManager=new vk(this,this.sessionManager,this.persistence)),this.config.__preview_deferred_init_extensions?(et.info("Deferring extension initialization to improve startup performance"),setTimeout((()=>{this.rs(m)}),0)):(et.info("Initializing extensions synchronously"),this.rs(m)),Ul.DEBUG=Ul.DEBUG||this.config.debug,Ul.DEBUG&&et.info("Starting in debug mode",{this:this,config:t,thisC:tt({},this.config),p:c,s:d}),((s=t.bootstrap)==null?void 0:s.distinctID)!==void 0){var p,v,x=this.config.get_device_id(Gc()),b=(p=t.bootstrap)!=null&&p.isIdentifiedID?x:t.bootstrap.distinctID;this.persistence.set_property(zl,(v=t.bootstrap)!=null&&v.isIdentifiedID?"identified":"anonymous"),this.register({distinct_id:t.bootstrap.distinctID,$device_id:b})}if(this.ss()){var S,N,E=Object.keys(((S=t.bootstrap)==null?void 0:S.featureFlags)||{}).filter((R=>{var F;return!((F=t.bootstrap)==null||(F=F.featureFlags)==null||!F[R])})).reduce(((R,F)=>{var j;return R[F]=((j=t.bootstrap)==null||(j=j.featureFlags)==null?void 0:j[F])||!1,R}),{}),T=Object.keys(((N=t.bootstrap)==null?void 0:N.featureFlagPayloads)||{}).filter((R=>E[R])).reduce(((R,F)=>{var j,L;return(j=t.bootstrap)!=null&&(j=j.featureFlagPayloads)!=null&&j[F]&&(R[F]=(L=t.bootstrap)==null||(L=L.featureFlagPayloads)==null?void 0:L[F]),R}),{});this.featureFlags.receivedFeatureFlags({featureFlags:E,featureFlagPayloads:T})}if(m)this.register_once({distinct_id:Wp,$device_id:null},"");else if(!this.get_distinct_id()){var A=this.config.get_device_id(Gc());this.register_once({distinct_id:A,$device_id:A},""),this.persistence.set_property(zl,"anonymous")}return Ln(Se,"onpagehide"in self?"pagehide":"unload",this._handle_unload.bind(this),{passive:!1}),this.toolbar.maybeLoadToolbar(),t.segment?Lz(this,(()=>this.ns())):this.ns(),Vc(this.config._onCapture)&&this.config._onCapture!==ab&&(et.warn("onCapture is deprecated. Please use `before_send` instead"),this.on("eventCaptured",(R=>this.config._onCapture(R.event,R)))),this.config.ip&&et.warn('The `ip` config option has NO EFFECT AT ALL and has been deprecated. Use a custom transformation or "Discard IP data" project setting instead. See https://posthog.com/tutorials/web-redact-properties#hiding-customer-ip-address for more information.'),this}rs(e){var t=performance.now();this.historyAutocapture=new Dz(this),this.historyAutocapture.startIfEnabled();var n=[];n.push((()=>{new Hz(this).startIfEnabledOrStop()})),n.push((()=>{var s;this.siteApps=new TH(this),(s=this.siteApps)==null||s.init()})),e||n.push((()=>{this.sessionRecording=new wk(this),this.sessionRecording.startIfEnabledOrStop()})),this.config.disable_scroll_properties||n.push((()=>{this.scrollManager.startMeasuringScrollPosition()})),n.push((()=>{this.autocapture=new Ez(this),this.autocapture.startIfEnabled()})),n.push((()=>{this.surveys.loadIfEnabled()})),n.push((()=>{this.logs.loadIfEnabled()})),n.push((()=>{this.conversations.loadIfEnabled()})),n.push((()=>{this.productTours=new uH(this),this.productTours.loadIfEnabled()})),n.push((()=>{this.heatmaps=new Yz(this),this.heatmaps.startIfEnabled()})),n.push((()=>{this.webVitalsAutocapture=new qz(this)})),n.push((()=>{this.exceptionObserver=new Oz(this),this.exceptionObserver.startIfEnabledOrStop()})),n.push((()=>{this.deadClicksAutocapture=new TA(this,jz),this.deadClicksAutocapture.startIfEnabled()})),n.push((()=>{if(this.os){var s=this.os;this.os=void 0,this.wi(s)}})),this.ls(n,t)}ls(e,t){for(;e.length>0;){if(this.config.__preview_deferred_init_extensions&&performance.now()-t>=30&&e.length>0)return void setTimeout((()=>{this.ls(e,t)}),0);var n=e.shift();if(n)try{n()}catch(i){et.error("Error initializing extension:",i)}}var s=Math.round(performance.now()-t);this.register_for_session({$sdk_debug_extensions_init_method:this.config.__preview_deferred_init_extensions?"deferred":"synchronous",$sdk_debug_extensions_init_time_ms:s}),this.config.__preview_deferred_init_extensions&&et.info("PostHog extensions initialized ("+s+"ms)")}wi(e){var t,n,s,i,c,d,m,p,v;if(!Je||!Je.body)return et.info("document not ready yet, trying again in 500 milliseconds..."),void setTimeout((()=>{this.wi(e)}),500);this.config.__preview_deferred_init_extensions&&(this.os=e),this.compression=void 0,e.supportedCompression&&!this.config.disable_compression&&(this.compression=fr(e.supportedCompression,Bl.GZipJS)?Bl.GZipJS:fr(e.supportedCompression,Bl.Base64)?Bl.Base64:void 0),(t=e.analytics)!=null&&t.endpoint&&(this.analyticsDefaultEndpoint=e.analytics.endpoint),this.set_config({person_profiles:this.Vr?this.Vr:"identified_only"}),(n=this.siteApps)==null||n.onRemoteConfig(e),(s=this.sessionRecording)==null||s.onRemoteConfig(e),(i=this.autocapture)==null||i.onRemoteConfig(e),(c=this.heatmaps)==null||c.onRemoteConfig(e),this.surveys.onRemoteConfig(e),this.logs.onRemoteConfig(e),this.conversations.onRemoteConfig(e),(d=this.productTours)==null||d.onRemoteConfig(e),(m=this.webVitalsAutocapture)==null||m.onRemoteConfig(e),(p=this.exceptionObserver)==null||p.onRemoteConfig(e),this.exceptions.onRemoteConfig(e),(v=this.deadClicksAutocapture)==null||v.onRemoteConfig(e)}ns(){try{this.config.loaded(this)}catch(n){et.critical("`loaded` function failed",n)}if(this.us(),this.config.internal_or_test_user_hostname&&ws!=null&&ws.hostname){var e=ws.hostname,t=this.config.internal_or_test_user_hostname;(typeof t=="string"?e===t:t.test(e))&&this.setInternalOrTestUser()}this.config.capture_pageview&&setTimeout((()=>{(this.consent.isOptedIn()||this.config.cookieless_mode==="always")&&this.hs()}),1),new bH(this).load(),this.featureFlags.flags()}us(){var e;this.is_capturing()&&this.config.request_batching&&((e=this.Zr)==null||e.enable())}_dom_loaded(){this.is_capturing()&&qc(this.__request_queue,(e=>this.ts(e))),this.__request_queue=[],this.us()}_handle_unload(){var e,t;this.surveys.handlePageUnload(),this.config.request_batching?(this.ds()&&this.capture("$pageleave"),(e=this.Zr)==null||e.unload(),(t=this.es)==null||t.unload()):this.ds()&&this.capture("$pageleave",null,{transport:"sendBeacon"})}_send_request(e){this.__loaded&&(qA?this.__request_queue.push(e):this.rateLimiter.isServerRateLimited(e.batchKey)||(e.transport=e.transport||this.config.api_transport,e.url=by(e.url,{ip:this.config.ip?1:0}),e.headers=tt({},this.config.request_headers,e.headers),e.compression=e.compression==="best-available"?this.compression:e.compression,e.disableXHRCredentials=this.config.__preview_disable_xhr_credentials,this.config.__preview_disable_beacon&&(e.disableTransport=["sendBeacon"]),e.fetchOptions=e.fetchOptions||this.config.fetch_options,(t=>{var n,s,i,c=tt({},t);c.timeout=c.timeout||6e4,c.url=by(c.url,{_:new Date().getTime().toString(),ver:Ul.LIB_VERSION,compression:c.compression});var d=(n=c.transport)!==null&&n!==void 0?n:"fetch",m=qv.filter((v=>!c.disableTransport||!v.transport||!c.disableTransport.includes(v.transport))),p=(s=(i=cA(m,(v=>v.transport===d)))==null?void 0:i.method)!==null&&s!==void 0?s:m[0].method;if(!p)throw new Error("No available transport method");p(c)})(tt({},e,{callback:t=>{var n,s;this.rateLimiter.checkForLimiting(t),t.statusCode>=400&&((n=(s=this.config).on_request_error)==null||n.call(s,t)),e.callback==null||e.callback(t)}}))))}ts(e){this.es?this.es.retriableRequest(e):this._send_request(e)}_execute_array(e){var t,n=[],s=[],i=[];qc(e,(d=>{d&&(t=d[0],Mr(t)?i.push(d):Vc(d)?d.call(this):Mr(d)&&t==="alias"?n.push(d):Mr(d)&&t.indexOf("capture")!==-1&&Vc(this[t])?i.push(d):s.push(d))}));var c=function(d,m){qc(d,(function(p){if(Mr(p[0])){var v=m;rn(p,(function(x){v=v[x[0]].apply(v,x.slice(1))}))}else this[p[0]].apply(this,p.slice(1))}),m)};c(n,this),c(s,this),c(i,this)}ss(){var e,t;return((e=this.config.bootstrap)==null?void 0:e.featureFlags)&&Object.keys((t=this.config.bootstrap)==null?void 0:t.featureFlags).length>0||!1}push(e){this._execute_array([e])}capture(e,t,n){var s;if(this.__loaded&&this.persistence&&this.sessionPersistence&&this.Zr){if(this.is_capturing())if(!Xe(e)&&qn(e)){var i=!this.config.opt_out_useragent_filter&&this._is_bot();if(!(i&&!this.config.__preview_capture_bot_pageviews)){var c=n!=null&&n.skip_client_rate_limiting?void 0:this.rateLimiter.clientRateLimitContext();if(c==null||!c.isRateLimited){t!=null&&t.$current_url&&!qn(t==null?void 0:t.$current_url)&&(et.error("Invalid `$current_url` property provided to `posthog.capture`. Input must be a string. Ignoring provided value."),t==null||delete t.$current_url),this.sessionPersistence.update_search_keyword(),this.config.save_campaign_params&&this.sessionPersistence.update_campaign_params(),this.config.save_referrer&&this.sessionPersistence.update_referrer_info(),(this.config.save_campaign_params||this.config.save_referrer)&&this.persistence.set_initial_person_info();var d=new Date,m=(n==null?void 0:n.timestamp)||d,p=Gc(),v={uuid:p,event:e,properties:this.calculateEventProperties(e,t||{},m,p)};e==="$pageview"&&this.config.__preview_capture_bot_pageviews&&i&&(v.event="$bot_pageview",v.properties.$browser_type="bot"),c&&(v.properties.$lib_rate_limit_remaining_tokens=c.remainingTokens),n!=null&&n.$set&&(v.$set=n==null?void 0:n.$set);var x,b=e!=="$groupidentify",S=this.vs(n==null?void 0:n.$set_once,b);if(S&&(v.$set_once=S),(v=az(v,n!=null&&n._noTruncate?null:this.config.properties_string_max_length)).timestamp=m,Xe(n==null?void 0:n.timestamp)||(v.properties.$event_time_override_provided=!0,v.properties.$event_time_override_system_time=d),e===gm.DISMISSED||e===gm.SENT){var N=t==null?void 0:t[Wx.SURVEY_ID],E=t==null?void 0:t[Wx.SURVEY_ITERATION];x={id:N,current_iteration:E},localStorage.getItem(mk(x))||localStorage.setItem(mk(x),"true"),v.$set=tt({},v.$set,{[dH({id:N,current_iteration:E},e===gm.SENT?"responded":"dismissed")]:!0})}else e===gm.SHOWN&&(v.$set=tt({},v.$set,{[Wx.SURVEY_LAST_SEEN_DATE]:new Date().toISOString()}));var T=tt({},v.properties.$set,v.$set);if(Jf(T)||this.setPersonPropertiesForFlags(T),!mr(this.config.before_send)){var A=this.cs(v);if(!A)return;v=A}this.bi.emit("eventCaptured",v);var R={method:"POST",url:(s=n==null?void 0:n._url)!==null&&s!==void 0?s:this.requestRouter.endpointFor("api",this.analyticsDefaultEndpoint),data:v,compression:"best-available",batchKey:n==null?void 0:n._batchKey};return!this.config.request_batching||n&&(n==null||!n._batchKey)||n!=null&&n.send_instantly?this.ts(R):this.Zr.enqueue(R),v}et.critical("This capture call is ignored due to client rate limiting.")}}else et.error("No event name provided to posthog.capture")}else et.uninitializedWarning("posthog.capture")}_addCaptureHook(e){return this.on("eventCaptured",(t=>e(t.event,t)))}calculateEventProperties(e,t,n,s,i){if(n=n||new Date,!this.persistence||!this.sessionPersistence)return t;var c=i?void 0:this.persistence.remove_event_timer(e),d=tt({},t);if(d.token=this.config.token,d.$config_defaults=this.config.defaults,(this.config.cookieless_mode=="always"||this.config.cookieless_mode=="on_reject"&&this.consent.isExplicitlyOptedOut())&&(d.$cookieless_mode=!0),e==="$snapshot"){var m=tt({},this.persistence.properties(),this.sessionPersistence.properties());return d.distinct_id=m.distinct_id,(!qn(d.distinct_id)&&!ql(d.distinct_id)||Uw(d.distinct_id))&&et.error("Invalid distinct_id for replay event. This indicates a bug in your implementation"),d}var p,v=Vz(this.config.mask_personal_data_properties,this.config.custom_personal_data_properties);if(this.sessionManager){var{sessionId:x,windowId:b}=this.sessionManager.checkAndGetSessionAndWindowId(i,n.getTime());d.$session_id=x,d.$window_id=b}this.sessionPropsManager&&In(d,this.sessionPropsManager.getSessionProps());try{var S;this.sessionRecording&&In(d,this.sessionRecording.sdkDebugProperties),d.$sdk_debug_retry_queue_size=(S=this.es)==null?void 0:S.length}catch(A){d.$sdk_debug_error_capturing_properties=String(A)}if(this.requestRouter.region===vm.CUSTOM&&(d.$lib_custom_api_host=this.config.api_host),p=e!=="$pageview"||i?e!=="$pageleave"||i?this.pageViewManager.doEvent():this.pageViewManager.doPageLeave(n):this.pageViewManager.doPageView(n,s),d=In(d,p),e==="$pageview"&&Je&&(d.title=Je.title),!Xe(c)){var N=n.getTime()-c;d.$duration=parseFloat((N/1e3).toFixed(3))}Fo&&this.config.opt_out_useragent_filter&&(d.$browser_type=this._is_bot()?"bot":"browser"),(d=In({},v,this.persistence.properties(),this.sessionPersistence.properties(),d)).$is_identified=this._isIdentified(),Mr(this.config.property_denylist)?rn(this.config.property_denylist,(function(A){delete d[A]})):et.error("Invalid value for property_denylist config: "+this.config.property_denylist+" or property_blacklist config: "+this.config.property_blacklist);var E=this.config.sanitize_properties;E&&(et.error("sanitize_properties is deprecated. Use before_send instead"),d=E(d,e));var T=this.fs();return d.$process_person_profile=T,T&&!i&&this.ps("_calculate_event_properties"),d}vs(e,t){var n;if(t===void 0&&(t=!0),!this.persistence||!this.fs()||this.qr)return e;var s=this.persistence.get_initial_props(),i=(n=this.sessionPropsManager)==null?void 0:n.getSetOnceProps(),c=In({},s,i||{},e||{}),d=this.config.sanitize_properties;return d&&(et.error("sanitize_properties is deprecated. Use before_send instead"),c=d(c,"$set_once")),t&&(this.qr=!0),Jf(c)?void 0:c}register(e,t){var n;(n=this.persistence)==null||n.register(e,t)}register_once(e,t,n){var s;(s=this.persistence)==null||s.register_once(e,t,n)}register_for_session(e){var t;(t=this.sessionPersistence)==null||t.register(e)}unregister(e){var t;(t=this.persistence)==null||t.unregister(e)}unregister_for_session(e){var t;(t=this.sessionPersistence)==null||t.unregister(e)}gs(e,t){this.register({[e]:t})}getFeatureFlag(e,t){return this.featureFlags.getFeatureFlag(e,t)}getFeatureFlagPayload(e){return this.featureFlags.getFeatureFlagPayload(e)}getFeatureFlagResult(e,t){return this.featureFlags.getFeatureFlagResult(e,t)}isFeatureEnabled(e,t){return this.featureFlags.isFeatureEnabled(e,t)}reloadFeatureFlags(){this.featureFlags.reloadFeatureFlags()}updateFlags(e,t,n){var s=n!=null&&n.merge?this.featureFlags.getFlagVariants():{},i=n!=null&&n.merge?this.featureFlags.getFlagPayloads():{},c=tt({},s,e),d=tt({},i,t),m={};for(var[p,v]of Object.entries(c)){var x=typeof v=="string";m[p]={key:p,enabled:!!x||!!v,variant:x?v:void 0,reason:void 0,metadata:Xe(d==null?void 0:d[p])?void 0:{id:0,version:void 0,description:void 0,payload:d[p]}}}this.featureFlags.receivedFeatureFlags({flags:m})}updateEarlyAccessFeatureEnrollment(e,t,n){this.featureFlags.updateEarlyAccessFeatureEnrollment(e,t,n)}getEarlyAccessFeatures(e,t,n){return t===void 0&&(t=!1),this.featureFlags.getEarlyAccessFeatures(e,t,n)}on(e,t){return this.bi.on(e,t)}onFeatureFlags(e){return this.featureFlags.onFeatureFlags(e)}onSurveysLoaded(e){return this.surveys.onSurveysLoaded(e)}onSessionId(e){var t,n;return(t=(n=this.sessionManager)==null?void 0:n.onSessionId(e))!==null&&t!==void 0?t:()=>{}}getSurveys(e,t){t===void 0&&(t=!1),this.surveys.getSurveys(e,t)}getActiveMatchingSurveys(e,t){t===void 0&&(t=!1),this.surveys.getActiveMatchingSurveys(e,t)}renderSurvey(e,t){this.surveys.renderSurvey(e,t)}displaySurvey(e,t){t===void 0&&(t=hH),this.surveys.displaySurvey(e,t)}cancelPendingSurvey(e){this.surveys.cancelPendingSurvey(e)}canRenderSurvey(e){return this.surveys.canRenderSurvey(e)}canRenderSurveyAsync(e,t){return t===void 0&&(t=!1),this.surveys.canRenderSurveyAsync(e,t)}identify(e,t,n){if(!this.__loaded||!this.persistence)return et.uninitializedWarning("posthog.identify");if(ql(e)&&(e=e.toString(),et.warn("The first argument to posthog.identify was a number, but it should be a string. It has been converted to a string.")),e)if(["distinct_id","distinctid"].includes(e.toLowerCase()))et.critical('The string "'+e+'" was set in posthog.identify which indicates an error. This ID should be unique to the user and not a hardcoded string.');else if(e!==Wp){if(this.ps("posthog.identify")){var s=this.get_distinct_id();if(this.register({$user_id:e}),!this.get_property("$device_id")){var i=s;this.register_once({$had_persisted_distinct_id:!0,$device_id:i},"")}e!==s&&e!==this.get_property(dm)&&(this.unregister(dm),this.register({distinct_id:e}));var c=(this.persistence.get_property(zl)||"anonymous")==="anonymous";e!==s&&c?(this.persistence.set_property(zl,"identified"),this.setPersonPropertiesForFlags(tt({},n||{},t||{}),!1),this.capture("$identify",{distinct_id:e,$anon_distinct_id:s},{$set:t||{},$set_once:n||{}}),this.Jr=ck(e,t,n),this.featureFlags.setAnonymousDistinctId(s)):(t||n)&&this.setPersonProperties(t,n),e!==s&&(this.reloadFeatureFlags(),this.unregister(fy))}}else et.critical('The string "'+Wp+'" was set in posthog.identify which indicates an error. This ID is only used as a sentinel value.');else et.error("Unique user id has not been set in posthog.identify")}setPersonProperties(e,t){if((e||t)&&this.ps("posthog.setPersonProperties")){var n=ck(this.get_distinct_id(),e,t);this.Jr!==n?(this.setPersonPropertiesForFlags(tt({},t||{},e||{})),this.capture("$set",{$set:e||{},$set_once:t||{}}),this.Jr=n):et.info("A duplicate setPersonProperties call was made with the same properties. It has been ignored.")}}group(e,t,n){if(e&&t){var s=this.getGroups();s[e]!==t&&this.resetGroupPropertiesForFlags(e),this.register({$groups:tt({},s,{[e]:t})}),n&&(this.capture("$groupidentify",{$group_type:e,$group_key:t,$group_set:n}),this.setGroupPropertiesForFlags({[e]:n})),s[e]===t||n||this.reloadFeatureFlags()}else et.error("posthog.group requires a group type and group key")}resetGroups(){this.register({$groups:{}}),this.resetGroupPropertiesForFlags(),this.reloadFeatureFlags()}setPersonPropertiesForFlags(e,t){t===void 0&&(t=!0),this.featureFlags.setPersonPropertiesForFlags(e,t)}resetPersonPropertiesForFlags(){this.featureFlags.resetPersonPropertiesForFlags()}setGroupPropertiesForFlags(e,t){t===void 0&&(t=!0),this.ps("posthog.setGroupPropertiesForFlags")&&this.featureFlags.setGroupPropertiesForFlags(e,t)}resetGroupPropertiesForFlags(e){this.featureFlags.resetGroupPropertiesForFlags(e)}reset(e){var t,n,s,i;if(et.info("reset"),!this.__loaded)return et.uninitializedWarning("posthog.reset");var c=this.get_property("$device_id");if(this.consent.reset(),(t=this.persistence)==null||t.clear(),(n=this.sessionPersistence)==null||n.clear(),this.surveys.reset(),this.featureFlags.reset(),(s=this.persistence)==null||s.set_property(zl,"anonymous"),(i=this.sessionManager)==null||i.resetSessionId(),this.Jr=null,this.config.cookieless_mode==="always")this.register_once({distinct_id:Wp,$device_id:null},"");else{var d=this.config.get_device_id(Gc());this.register_once({distinct_id:d,$device_id:e?d:c},"")}this.register({$last_posthog_reset:new Date().toISOString()},1)}get_distinct_id(){return this.get_property("distinct_id")}getGroups(){return this.get_property("$groups")||{}}get_session_id(){var e,t;return(e=(t=this.sessionManager)==null?void 0:t.checkAndGetSessionAndWindowId(!0).sessionId)!==null&&e!==void 0?e:""}get_session_replay_url(e){if(!this.sessionManager)return"";var{sessionId:t,sessionStartTimestamp:n}=this.sessionManager.checkAndGetSessionAndWindowId(!0),s=this.requestRouter.endpointFor("ui","/project/"+this.config.token+"/replay/"+t);if(e!=null&&e.withTimestamp&&n){var i,c=(i=e.timestampLookBack)!==null&&i!==void 0?i:10;if(!n)return s;s+="?t="+Math.max(Math.floor((new Date().getTime()-n)/1e3)-c,0)}return s}alias(e,t){return e===this.get_property(uA)?(et.critical("Attempting to create alias for existing People user - aborting."),-2):this.ps("posthog.alias")?(Xe(t)&&(t=this.get_distinct_id()),e!==t?(this.gs(dm,e),this.capture("$create_alias",{alias:e,distinct_id:t})):(et.warn("alias matches current distinct_id - skipping api call."),this.identify(e),-1)):void 0}set_config(e){var t=tt({},this.config);if(Vn(e)){var n,s,i,c,d,m,p;In(this.config,_k(e));var v=this.Qr();(n=this.persistence)==null||n.update_config(this.config,t,v),this.sessionPersistence=this.config.persistence==="sessionStorage"||this.config.persistence==="memory"?this.persistence:new Hx(tt({},this.config,{persistence:"sessionStorage"}),v);var x=this.Kr(this.config.debug);Wl(x)&&(this.config.debug=x),Wl(this.config.debug)&&(this.config.debug?(Ul.DEBUG=!0,gn.H()&&gn.G("ph_debug","true"),et.info("set_config",{config:e,oldConfig:t,newConfig:tt({},this.config)})):(Ul.DEBUG=!1,gn.H()&&gn.V("ph_debug"))),(s=this.exceptionObserver)==null||s.onConfigChange(),(i=this.sessionRecording)==null||i.startIfEnabledOrStop(),(c=this.autocapture)==null||c.startIfEnabled(),(d=this.heatmaps)==null||d.startIfEnabled(),(m=this.exceptionObserver)==null||m.startIfEnabledOrStop(),this.surveys.loadIfEnabled(),this._s(),(p=this.externalIntegrations)==null||p.startIfEnabledOrStop()}}startSessionRecording(e){var t=e===!0,n={sampling:t||!(e==null||!e.sampling),linked_flag:t||!(e==null||!e.linked_flag),url_trigger:t||!(e==null||!e.url_trigger),event_trigger:t||!(e==null||!e.event_trigger)};if(Object.values(n).some(Boolean)){var s,i,c,d,m;(s=this.sessionManager)==null||s.checkAndGetSessionAndWindowId(),n.sampling&&((i=this.sessionRecording)==null||i.overrideSampling()),n.linked_flag&&((c=this.sessionRecording)==null||c.overrideLinkedFlag()),n.url_trigger&&((d=this.sessionRecording)==null||d.overrideTrigger("url")),n.event_trigger&&((m=this.sessionRecording)==null||m.overrideTrigger("event"))}this.set_config({disable_session_recording:!1})}stopSessionRecording(){this.set_config({disable_session_recording:!0})}sessionRecordingStarted(){var e;return!((e=this.sessionRecording)==null||!e.started)}captureException(e,t){var n=new Error("PostHog syntheticException"),s=this.exceptions.buildProperties(e,{handled:!0,syntheticException:n});return this.exceptions.sendExceptionEvent(tt({},s,t))}startExceptionAutocapture(e){this.set_config({capture_exceptions:e==null||e})}stopExceptionAutocapture(){this.set_config({capture_exceptions:!1})}loadToolbar(e){return this.toolbar.loadToolbar(e)}get_property(e){var t;return(t=this.persistence)==null?void 0:t.props[e]}getSessionProperty(e){var t;return(t=this.sessionPersistence)==null?void 0:t.props[e]}toString(){var e,t=(e=this.config.name)!==null&&e!==void 0?e:qf;return t!==qf&&(t=qf+"."+t),t}_isIdentified(){var e,t;return((e=this.persistence)==null?void 0:e.get_property(zl))==="identified"||((t=this.sessionPersistence)==null?void 0:t.get_property(zl))==="identified"}fs(){var e,t;return!(this.config.person_profiles==="never"||this.config.person_profiles==="identified_only"&&!this._isIdentified()&&Jf(this.getGroups())&&((e=this.persistence)==null||(e=e.props)==null||!e[dm])&&((t=this.persistence)==null||(t=t.props)==null||!t[py]))}ds(){return this.config.capture_pageleave===!0||this.config.capture_pageleave==="if_capture_pageview"&&(this.config.capture_pageview===!0||this.config.capture_pageview==="history_change")}createPersonProfile(){this.fs()||this.ps("posthog.createPersonProfile")&&this.setPersonProperties({},{})}setInternalOrTestUser(){this.ps("posthog.setInternalOrTestUser")&&this.setPersonProperties({$internal_or_test_user:!0})}ps(e){return this.config.person_profiles==="never"?(et.error(e+' was called, but process_person is set to "never". This call will be ignored.'),!1):(this.gs(py,!0),!0)}Qr(){if(this.config.cookieless_mode==="always")return!0;var e=this.consent.isOptedOut(),t=this.config.opt_out_persistence_by_default||this.config.cookieless_mode==="on_reject";return this.config.disable_persistence||e&&!!t}_s(){var e,t,n,s,i=this.Qr();return((e=this.persistence)==null?void 0:e.Pi)!==i&&((n=this.persistence)==null||n.set_disabled(i)),((t=this.sessionPersistence)==null?void 0:t.Pi)!==i&&((s=this.sessionPersistence)==null||s.set_disabled(i)),i}opt_in_capturing(e){var t;if(this.config.cookieless_mode!=="always"){var n,s,i;this.config.cookieless_mode==="on_reject"&&this.consent.isExplicitlyOptedOut()&&(this.reset(!0),(n=this.sessionManager)==null||n.destroy(),(s=this.pageViewManager)==null||s.destroy(),this.sessionManager=new yk(this),this.pageViewManager=new nk(this),this.persistence&&(this.sessionPropsManager=new vk(this,this.sessionManager,this.persistence)),this.sessionRecording=new wk(this),this.sessionRecording.startIfEnabledOrStop()),this.consent.optInOut(!0),this._s(),this.us(),(t=this.sessionRecording)==null||t.startIfEnabledOrStop(),this.config.cookieless_mode=="on_reject"&&this.surveys.loadIfEnabled(),(Xe(e==null?void 0:e.captureEventName)||e!=null&&e.captureEventName)&&this.capture((i=e==null?void 0:e.captureEventName)!==null&&i!==void 0?i:"$opt_in",e==null?void 0:e.captureProperties,{send_instantly:!0}),this.config.capture_pageview&&this.hs()}else et.warn('Consent opt in/out is not valid with cookieless_mode="always" and will be ignored')}opt_out_capturing(){var e,t,n;this.config.cookieless_mode!=="always"?(this.config.cookieless_mode==="on_reject"&&this.consent.isOptedIn()&&this.reset(!0),this.consent.optInOut(!1),this._s(),this.config.cookieless_mode==="on_reject"&&(this.register({distinct_id:Wp,$device_id:null}),(e=this.sessionManager)==null||e.destroy(),(t=this.pageViewManager)==null||t.destroy(),this.sessionManager=void 0,this.sessionPropsManager=void 0,(n=this.sessionRecording)==null||n.stopRecording(),this.sessionRecording=void 0,this.hs())):et.warn('Consent opt in/out is not valid with cookieless_mode="always" and will be ignored')}has_opted_in_capturing(){return this.consent.isOptedIn()}has_opted_out_capturing(){return this.consent.isOptedOut()}get_explicit_consent_status(){var e=this.consent.consent;return e===Hl.GRANTED?"granted":e===Hl.DENIED?"denied":"pending"}is_capturing(){return this.config.cookieless_mode==="always"||(this.config.cookieless_mode==="on_reject"?this.consent.isExplicitlyOptedOut()||this.consent.isOptedIn():!this.has_opted_out_capturing())}clear_opt_in_out_capturing(){this.consent.reset(),this._s()}_is_bot(){return ni?VA(ni,this.config.custom_blocked_useragents):void 0}hs(){Je&&(Je.visibilityState==="visible"?this.Wr||(this.Wr=!0,this.capture("$pageview",{title:Je.title},{send_instantly:!0}),this.Gr&&(Je.removeEventListener("visibilitychange",this.Gr),this.Gr=null)):this.Gr||(this.Gr=this.hs.bind(this),Ln(Je,"visibilitychange",this.Gr)))}debug(e){e===!1?(Se==null||Se.console.log("You've disabled debug mode."),this.set_config({debug:!1})):(Se==null||Se.console.log("You're now in debug mode. All calls to PostHog will be logged in your console.\nYou can disable this with `posthog.debug(false)`."),this.set_config({debug:!0}))}M(){var e,t,n,s,i,c,d,m=this.Yr||{};return"advanced_disable_flags"in m?!!m.advanced_disable_flags:this.config.advanced_disable_flags!==!1?!!this.config.advanced_disable_flags:this.config.advanced_disable_decide===!0?(et.warn("Config field 'advanced_disable_decide' is deprecated. Please use 'advanced_disable_flags' instead. The old field will be removed in a future major version."),!0):(n="advanced_disable_decide",s=!1,i=et,c=(t="advanced_disable_flags")in(e=m)&&!mr(e[t]),d=n in e&&!mr(e[n]),c?e[t]:d?(i&&i.warn("Config field '"+n+"' is deprecated. Please use '"+t+"' instead. The old field will be removed in a future major version."),e[n]):s)}cs(e){if(mr(this.config.before_send))return e;var t=Mr(this.config.before_send)?this.config.before_send:[this.config.before_send],n=e;for(var s of t){if(n=s(n),mr(n)){var i="Event '"+e.event+"' was rejected in beforeSend function";return E8(e.event)?et.warn(i+". This can cause unexpected behavior."):et.info(i),null}n.properties&&!Jf(n.properties)||et.warn("Event '"+e.event+"' has no properties after beforeSend function, this is likely an error.")}return n}getPageViewId(){var e;return(e=this.pageViewManager.Kt)==null?void 0:e.pageViewId}captureTraceFeedback(e,t){this.capture("$ai_feedback",{$ai_trace_id:String(e),$ai_feedback_text:t})}captureTraceMetric(e,t,n){this.capture("$ai_metric",{$ai_trace_id:String(e),$ai_metric_name:t,$ai_metric_value:String(n)})}Kr(e){var t=Wl(e)&&!e,n=gn.H()&&gn.q("ph_debug")==="true";return!t&&(!!n||e)}}(function(r,e){for(var t=0;t<e.length;t++)r.prototype[e[t]]=iz(r.prototype[e[t]])})(qy,["identify"]);var Sk,Wa=(Sk=Em[qf]=new qy,(function(){function r(){r.done||(r.done=!0,qA=!1,rn(Em,(function(e){e._dom_loaded()})))}Je!=null&&Je.addEventListener?Je.readyState==="complete"?r():Ln(Je,"DOMContentLoaded",r,{capture:!1}):Se&&et.error("Browser doesn't support `document.addEventListener` so PostHog couldn't be initialized")})(),Sk),KA=w.createContext({client:Wa,bootstrap:void 0});function YA(r,e,t){if(t===void 0&&(t=new WeakMap),r===e)return!0;if(typeof r!="object"||r===null||typeof e!="object"||e===null)return!1;if(t.has(r)&&t.get(r)===e)return!0;t.set(r,e);var n=Object.keys(r),s=Object.keys(e);if(n.length!==s.length)return!1;for(var i=0,c=n;i<c.length;i++){var d=c[i];if(!s.includes(d)||!YA(r[d],e[d],t))return!1}return!0}function OH(r){var e,t,n=r.children,s=r.client,i=r.apiKey,c=r.options,d=w.useRef(null),m=w.useMemo(function(){return s?(i&&console.warn("[PostHog.js] You have provided both `client` and `apiKey` to `PostHogProvider`. `apiKey` will be ignored in favour of `client`."),c&&console.warn("[PostHog.js] You have provided both `client` and `options` to `PostHogProvider`. `options` will be ignored in favour of `client`."),s):(i||console.warn("[PostHog.js] No `apiKey` or `client` were provided to `PostHogProvider`. Using default global `window.posthog` instance. You must initialize it manually. This is not recommended behavior."),Wa)},[s,i,JSON.stringify(c)]);return w.useEffect(function(){if(!s){var p=d.current;p?(i!==p.apiKey&&console.warn("[PostHog.js] You have provided a different `apiKey` to `PostHogProvider` than the one that was already initialized. This is not supported by our provider and we'll keep using the previous key. If you need to toggle between API Keys you need to control the `client` yourself and pass it in as a prop rather than an `apiKey` prop."),c&&!YA(c,p.options)&&Wa.set_config(c),d.current={apiKey:i,options:c??{}}):(Wa.__loaded&&console.warn("[PostHog.js] `posthog` was already loaded elsewhere. This may cause issues."),Wa.init(i,c),d.current={apiKey:i,options:c??{}})}},[s,i,JSON.stringify(c)]),_r.createElement(KA.Provider,{value:{client:m,bootstrap:(e=c==null?void 0:c.bootstrap)!==null&&e!==void 0?e:(t=s==null?void 0:s.config)===null||t===void 0?void 0:t.bootstrap}},n)}var qx=function(r){return typeof r=="function"},lb=function(r,e){return lb=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])},lb(r,e)};function DH(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");lb(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var LH={componentStack:null,exceptionEvent:null,error:null},MH={INVALID_FALLBACK:"[PostHog.js][PostHogErrorBoundary] Invalid fallback prop, provide a valid React element or a function that returns a valid React element."};(function(r){DH(e,r);function e(t){var n=r.call(this,t)||this;return n.state=LH,n}return e.prototype.componentDidCatch=function(t,n){var s=this.props.additionalProperties,i;qx(s)?i=s(t):typeof s=="object"&&(i=s);var c=this.context.client,d=c.captureException(t,i),m=n.componentStack;this.setState({error:t,componentStack:m??null,exceptionEvent:d})},e.prototype.render=function(){var t=this.props,n=t.children,s=t.fallback,i=this.state;if(i.componentStack==null)return qx(n)?n():n;var c=qx(s)?_r.createElement(s,{error:i.error,componentStack:i.componentStack,exceptionEvent:i.exceptionEvent}):s;return _r.isValidElement(c)?c:(console.warn(MH.INVALID_FALLBACK),_r.createElement(_r.Fragment,null))},e.contextType=KA,e})(_r.Component);function Gr(){var e;const r=w.useContext(G_);if(r.isLoading)return{debug:async()=>{},info:async()=>{},warn:async()=>{},error:async()=>{}};if(!((e=r.services)!=null&&e.logging))throw new Error("Logging provider not available. Make sure PlatformProvider is wrapping your component.");return r.services.logging}function Ek(r){try{const e=r.split(".")[1];return JSON.parse(atob(e.replace(/-/g,"+").replace(/_/g,"/"))).email??null}catch{return null}}const $H=({children:r})=>{const e=Qa(),t=Gr();return w.useEffect(()=>{if(typeof window>"u"||!Aw){console.warn(" PostHog: Not initialized - missing or invalid key");return}(async()=>{const s=await Om(t),i=s!=null&&s.id_token?Ek(s.id_token):null;Wa.init(Aw,{api_host:XN,autocapture:!0,capture_pageview:!0,capture_pageleave:!0,capture_dead_clicks:!1,disable_session_recording:!0,loaded:c=>{i&&c.identify(i,{email:i}),console.log("PostHog: Initialized successfully")},debug:BN==="dev"})})()},[]),w.useEffect(()=>{var s;const n=i=>{"token"in i&&(i.token.newValue?Om(t).then(c=>{const d=c!=null&&c.id_token?Ek(c.id_token):null;d&&Wa.identify(d,{email:d})}):Wa.reset())};return(s=e==null?void 0:e.onChanged)==null||s.call(e,n),()=>{var i;(i=e==null?void 0:e.removeChangeListener)==null||i.call(e,n)}},[e,t]),u.jsx(OH,{client:Wa,children:r})},vn=w.forwardRef(({className:r,type:e,...t},n)=>u.jsx("input",{type:e,className:jr("flex h-10 w-full rounded-md border border-neutral-200 bg-white px-3 py-2 text-base text-neutral-950 ring-offset-white file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-neutral-950 placeholder:text-neutral-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm dark:border-border dark:bg-card dark:text-gray-100 dark:ring-offset-neutral-950 dark:file:text-neutral-50 dark:placeholder:text-neutral-400 dark:focus-visible:ring-primary",r),ref:n,...t}));vn.displayName="Input";const Ck=r=>typeof r=="boolean"?`${r}`:r===0?"0":r,kk=_T,oS=(r,e)=>t=>{var n;if((e==null?void 0:e.variants)==null)return kk(r,t==null?void 0:t.class,t==null?void 0:t.className);const{variants:s,defaultVariants:i}=e,c=Object.keys(s).map(p=>{const v=t==null?void 0:t[p],x=i==null?void 0:i[p];if(v===null)return null;const b=Ck(v)||Ck(x);return s[p][b]}),d=t&&Object.entries(t).reduce((p,v)=>{let[x,b]=v;return b===void 0||(p[x]=b),p},{}),m=e==null||(n=e.compoundVariants)===null||n===void 0?void 0:n.reduce((p,v)=>{let{class:x,className:b,...S}=v;return Object.entries(S).every(N=>{let[E,T]=N;return Array.isArray(T)?T.includes({...i,...d}[E]):{...i,...d}[E]===T})?[...p,x,b]:p},[]);return kk(r,c,m,t==null?void 0:t.class,t==null?void 0:t.className)},UH=oS("rounded-lg border border-neutral-200 bg-white text-neutral-950 shadow-sm dark:border-border dark:bg-card dark:text-card-foreground",{variants:{variant:{default:"",TemplateCard:"",ReferenceSourcesCard:"",IntegrationsCard:""}},defaultVariants:{variant:"default"}}),Ss=w.forwardRef(({className:r,variant:e,...t},n)=>u.jsx("div",{ref:n,className:jr(UH({variant:e,className:r})),...t}));Ss.displayName="Card";const uo=w.forwardRef(({className:r,cardVariant:e,...t},n)=>u.jsx("div",{ref:n,className:jr(e==="TemplateCard"?"flex flex-col space-y-1 p-4":"flex flex-col space-y-1.5 p-6",r),...t}));uo.displayName="CardHeader";const fo=w.forwardRef(({className:r,...e},t)=>u.jsx("h3",{ref:t,className:jr("font-semibold leading-none tracking-tight",r),...e}));fo.displayName="CardTitle";const zH=w.forwardRef(({className:r,...e},t)=>u.jsx("p",{ref:t,className:jr("text-sm text-neutral-500 dark:text-neutral-400",r),...e}));zH.displayName="CardDescription";const Es=w.forwardRef(({className:r,cardVariant:e,...t},n)=>u.jsx("div",{ref:n,className:jr(e==="TemplateCard"?"p-0 pt-0":"p-6 pt-0",r),...t}));Es.displayName="CardContent";const HH=w.forwardRef(({className:r,...e},t)=>u.jsx("div",{ref:t,className:jr("flex items-center p-6 pt-0",r),...e}));HH.displayName="CardFooter";function Nk(r,e){if(typeof r=="function")return r(e);r!=null&&(r.current=e)}function tu(...r){return e=>{let t=!1;const n=r.map(s=>{const i=Nk(s,e);return!t&&typeof i=="function"&&(t=!0),i});if(t)return()=>{for(let s=0;s<n.length;s++){const i=n[s];typeof i=="function"?i():Nk(r[s],null)}}}}function Mn(...r){return w.useCallback(tu(...r),r)}var BH=Symbol.for("react.lazy"),Sy=Eb[" use ".trim().toString()];function GH(r){return typeof r=="object"&&r!==null&&"then"in r}function JA(r){return r!=null&&typeof r=="object"&&"$$typeof"in r&&r.$$typeof===BH&&"_payload"in r&&GH(r._payload)}function WH(r){const e=qH(r),t=w.forwardRef((n,s)=>{let{children:i,...c}=n;JA(i)&&typeof Sy=="function"&&(i=Sy(i._payload));const d=w.Children.toArray(i),m=d.find(YH);if(m){const p=m.props.children,v=d.map(x=>x===m?w.Children.count(p)>1?w.Children.only(null):w.isValidElement(p)?p.props.children:null:x);return u.jsx(e,{...c,ref:s,children:w.isValidElement(p)?w.cloneElement(p,void 0,v):null})}return u.jsx(e,{...c,ref:s,children:i})});return t.displayName=`${r}.Slot`,t}var VH=WH("Slot");function qH(r){const e=w.forwardRef((t,n)=>{let{children:s,...i}=t;if(JA(s)&&typeof Sy=="function"&&(s=Sy(s._payload)),w.isValidElement(s)){const c=XH(s),d=JH(i,s.props);return s.type!==w.Fragment&&(d.ref=n?tu(n,c):c),w.cloneElement(s,d)}return w.Children.count(s)>1?w.Children.only(null):null});return e.displayName=`${r}.SlotClone`,e}var KH=Symbol("radix.slottable");function YH(r){return w.isValidElement(r)&&typeof r.type=="function"&&"__radixId"in r.type&&r.type.__radixId===KH}function JH(r,e){const t={...e};for(const n in e){const s=r[n],i=e[n];/^on[A-Z]/.test(n)?s&&i?t[n]=(...d)=>{const m=i(...d);return s(...d),m}:s&&(t[n]=s):n==="style"?t[n]={...s,...i}:n==="className"&&(t[n]=[s,i].filter(Boolean).join(" "))}return{...r,...t}}function XH(r){var n,s;let e=(n=Object.getOwnPropertyDescriptor(r.props,"ref"))==null?void 0:n.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=(s=Object.getOwnPropertyDescriptor(r,"ref"))==null?void 0:s.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}const QH=oS("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-white transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 dark:ring-offset-neutral-950 dark:focus-visible:ring-primary",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90 dark:bg-primary dark:text-primary-foreground dark:hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90 dark:bg-destructive dark:text-destructive-foreground dark:hover:bg-destructive/90",outline:"border border-neutral-200 bg-background hover:bg-accent hover:text-accent-foreground dark:border-neutral-800 dark:bg-background dark:hover:bg-accent dark:hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80 dark:bg-secondary dark:text-secondary-foreground dark:hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent dark:hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline dark:text-primary"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),We=w.forwardRef(({className:r,variant:e,size:t,asChild:n=!1,...s},i)=>{const c=n?VH:"button";return u.jsx(c,{className:jr(QH({variant:e,size:t,className:r})),ref:i,...s})});We.displayName="Button";/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZH=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),XA=(...r)=>r.filter((e,t,n)=>!!e&&n.indexOf(e)===t).join(" ");/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var eB={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tB=w.forwardRef(({color:r="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:n,className:s="",children:i,iconNode:c,...d},m)=>w.createElement("svg",{ref:m,...eB,width:e,height:e,stroke:r,strokeWidth:n?Number(t)*24/Number(e):t,className:XA("lucide",s),...d},[...c.map(([p,v])=>w.createElement(p,v)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tr=(r,e)=>{const t=w.forwardRef(({className:n,...s},i)=>w.createElement(tB,{ref:i,iconNode:e,className:XA(`lucide-${ZH(r)}`,n),...s}));return t.displayName=`${r}`,t};/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QA=tr("ArrowDownToLine",[["path",{d:"M12 17V3",key:"1cwfxf"}],["path",{d:"m6 11 6 6 6-6",key:"12ii2o"}],["path",{d:"M19 21H5",key:"150jfl"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cm=tr("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rB=tr("ArrowRightToLine",[["path",{d:"M17 12H3",key:"8awo09"}],["path",{d:"m11 18 6-6-6-6",key:"8c2y43"}],["path",{d:"M21 5v14",key:"nzette"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nB=tr("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZA=tr("Briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kx=tr("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zf=tr("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sB=tr("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xs=tr("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kv=tr("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Av=tr("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nh=tr("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ad=tr("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oB=tr("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rv=tr("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iB=tr("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aB=tr("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Va=tr("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lB=tr("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cB=tr("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ld=tr("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uB=tr("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yx=tr("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dB=tr("Folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fB=tr("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hB=tr("ListTodo",[["rect",{x:"3",y:"5",width:"6",height:"6",rx:"1",key:"1defrl"}],["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ia=tr("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xc=tr("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pB=tr("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tk=tr("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mB=tr("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gB=tr("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vB=tr("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ak=tr("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yB=tr("Presentation",[["path",{d:"M2 3h20",key:"91anmk"}],["path",{d:"M21 3v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V3",key:"2k9sn8"}],["path",{d:"m7 21 5-5 5 5",key:"bip4we"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const si=tr("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xB=tr("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ri=tr("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sh=tr("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ey=tr("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eR=tr("WifiOff",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.445.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aa=tr("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function Lt(r,e,{checkForDefaultPrevented:t=!0}={}){return function(s){if(r==null||r(s),t===!1||!s.defaultPrevented)return e==null?void 0:e(s)}}function wB(r,e){const t=w.createContext(e),n=i=>{const{children:c,...d}=i,m=w.useMemo(()=>d,Object.values(d));return u.jsx(t.Provider,{value:m,children:c})};n.displayName=r+"Provider";function s(i){const c=w.useContext(t);if(c)return c;if(e!==void 0)return e;throw new Error(`\`${i}\` must be used within \`${r}\``)}return[n,s]}function Za(r,e=[]){let t=[];function n(i,c){const d=w.createContext(c),m=t.length;t=[...t,c];const p=x=>{var A;const{scope:b,children:S,...N}=x,E=((A=b==null?void 0:b[r])==null?void 0:A[m])||d,T=w.useMemo(()=>N,Object.values(N));return u.jsx(E.Provider,{value:T,children:S})};p.displayName=i+"Provider";function v(x,b){var E;const S=((E=b==null?void 0:b[r])==null?void 0:E[m])||d,N=w.useContext(S);if(N)return N;if(c!==void 0)return c;throw new Error(`\`${x}\` must be used within \`${i}\``)}return[p,v]}const s=()=>{const i=t.map(c=>w.createContext(c));return function(d){const m=(d==null?void 0:d[r])||i;return w.useMemo(()=>({[`__scope${r}`]:{...d,[r]:m}}),[d,m])}};return s.scopeName=r,[n,bB(s,...e)]}function bB(...r){const e=r[0];if(r.length===1)return e;const t=()=>{const n=r.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const c=n.reduce((d,{useScope:m,scopeName:p})=>{const x=m(i)[`__scope${p}`];return{...d,...x}},{});return w.useMemo(()=>({[`__scope${e.scopeName}`]:c}),[c])}};return t.scopeName=e.scopeName,t}var Kl=globalThis!=null&&globalThis.document?w.useLayoutEffect:()=>{},_B=Eb[" useInsertionEffect ".trim().toString()]||Kl;function ru({prop:r,defaultProp:e,onChange:t=()=>{},caller:n}){const[s,i,c]=SB({defaultProp:e,onChange:t}),d=r!==void 0,m=d?r:s;{const v=w.useRef(r!==void 0);w.useEffect(()=>{const x=v.current;x!==d&&console.warn(`${n} is changing from ${x?"controlled":"uncontrolled"} to ${d?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),v.current=d},[d,n])}const p=w.useCallback(v=>{var x;if(d){const b=EB(v)?v(r):v;b!==r&&((x=c.current)==null||x.call(c,b))}else i(v)},[d,r,i,c]);return[m,p]}function SB({defaultProp:r,onChange:e}){const[t,n]=w.useState(r),s=w.useRef(t),i=w.useRef(e);return _B(()=>{i.current=e},[e]),w.useEffect(()=>{var c;s.current!==t&&((c=i.current)==null||c.call(i,t),s.current=t)},[t,s]),[t,n,i]}function EB(r){return typeof r=="function"}const CB=["top","right","bottom","left"],Qc=Math.min,ri=Math.max,Cy=Math.round,Iv=Math.floor,Ja=r=>({x:r,y:r}),kB={left:"right",right:"left",bottom:"top",top:"bottom"},NB={start:"end",end:"start"};function cb(r,e,t){return ri(r,Qc(e,t))}function Yl(r,e){return typeof r=="function"?r(e):r}function Jl(r){return r.split("-")[0]}function bh(r){return r.split("-")[1]}function iS(r){return r==="x"?"y":"x"}function aS(r){return r==="y"?"height":"width"}const TB=new Set(["top","bottom"]);function Ya(r){return TB.has(Jl(r))?"y":"x"}function lS(r){return iS(Ya(r))}function AB(r,e,t){t===void 0&&(t=!1);const n=bh(r),s=lS(r),i=aS(s);let c=s==="x"?n===(t?"end":"start")?"right":"left":n==="start"?"bottom":"top";return e.reference[i]>e.floating[i]&&(c=ky(c)),[c,ky(c)]}function RB(r){const e=ky(r);return[ub(r),e,ub(e)]}function ub(r){return r.replace(/start|end/g,e=>NB[e])}const Rk=["left","right"],Ik=["right","left"],IB=["top","bottom"],PB=["bottom","top"];function FB(r,e,t){switch(r){case"top":case"bottom":return t?e?Ik:Rk:e?Rk:Ik;case"left":case"right":return e?IB:PB;default:return[]}}function jB(r,e,t,n){const s=bh(r);let i=FB(Jl(r),t==="start",n);return s&&(i=i.map(c=>c+"-"+s),e&&(i=i.concat(i.map(ub)))),i}function ky(r){return r.replace(/left|right|bottom|top/g,e=>kB[e])}function OB(r){return{top:0,right:0,bottom:0,left:0,...r}}function tR(r){return typeof r!="number"?OB(r):{top:r,right:r,bottom:r,left:r}}function Ny(r){const{x:e,y:t,width:n,height:s}=r;return{width:n,height:s,top:t,left:e,right:e+n,bottom:t+s,x:e,y:t}}function Pk(r,e,t){let{reference:n,floating:s}=r;const i=Ya(e),c=lS(e),d=aS(c),m=Jl(e),p=i==="y",v=n.x+n.width/2-s.width/2,x=n.y+n.height/2-s.height/2,b=n[d]/2-s[d]/2;let S;switch(m){case"top":S={x:v,y:n.y-s.height};break;case"bottom":S={x:v,y:n.y+n.height};break;case"right":S={x:n.x+n.width,y:x};break;case"left":S={x:n.x-s.width,y:x};break;default:S={x:n.x,y:n.y}}switch(bh(e)){case"start":S[c]-=b*(t&&p?-1:1);break;case"end":S[c]+=b*(t&&p?-1:1);break}return S}async function DB(r,e){var t;e===void 0&&(e={});const{x:n,y:s,platform:i,rects:c,elements:d,strategy:m}=r,{boundary:p="clippingAncestors",rootBoundary:v="viewport",elementContext:x="floating",altBoundary:b=!1,padding:S=0}=Yl(e,r),N=tR(S),T=d[b?x==="floating"?"reference":"floating":x],A=Ny(await i.getClippingRect({element:(t=await(i.isElement==null?void 0:i.isElement(T)))==null||t?T:T.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(d.floating)),boundary:p,rootBoundary:v,strategy:m})),R=x==="floating"?{x:n,y:s,width:c.floating.width,height:c.floating.height}:c.reference,F=await(i.getOffsetParent==null?void 0:i.getOffsetParent(d.floating)),j=await(i.isElement==null?void 0:i.isElement(F))?await(i.getScale==null?void 0:i.getScale(F))||{x:1,y:1}:{x:1,y:1},L=Ny(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:d,rect:R,offsetParent:F,strategy:m}):R);return{top:(A.top-L.top+N.top)/j.y,bottom:(L.bottom-A.bottom+N.bottom)/j.y,left:(A.left-L.left+N.left)/j.x,right:(L.right-A.right+N.right)/j.x}}const LB=async(r,e,t)=>{const{placement:n="bottom",strategy:s="absolute",middleware:i=[],platform:c}=t,d=i.filter(Boolean),m=await(c.isRTL==null?void 0:c.isRTL(e));let p=await c.getElementRects({reference:r,floating:e,strategy:s}),{x:v,y:x}=Pk(p,n,m),b=n,S={},N=0;for(let T=0;T<d.length;T++){var E;const{name:A,fn:R}=d[T],{x:F,y:j,data:L,reset:G}=await R({x:v,y:x,initialPlacement:n,placement:b,strategy:s,middlewareData:S,rects:p,platform:{...c,detectOverflow:(E=c.detectOverflow)!=null?E:DB},elements:{reference:r,floating:e}});v=F??v,x=j??x,S={...S,[A]:{...S[A],...L}},G&&N<=50&&(N++,typeof G=="object"&&(G.placement&&(b=G.placement),G.rects&&(p=G.rects===!0?await c.getElementRects({reference:r,floating:e,strategy:s}):G.rects),{x:v,y:x}=Pk(p,b,m)),T=-1)}return{x:v,y:x,placement:b,strategy:s,middlewareData:S}},MB=r=>({name:"arrow",options:r,async fn(e){const{x:t,y:n,placement:s,rects:i,platform:c,elements:d,middlewareData:m}=e,{element:p,padding:v=0}=Yl(r,e)||{};if(p==null)return{};const x=tR(v),b={x:t,y:n},S=lS(s),N=aS(S),E=await c.getDimensions(p),T=S==="y",A=T?"top":"left",R=T?"bottom":"right",F=T?"clientHeight":"clientWidth",j=i.reference[N]+i.reference[S]-b[S]-i.floating[N],L=b[S]-i.reference[S],G=await(c.getOffsetParent==null?void 0:c.getOffsetParent(p));let z=G?G[F]:0;(!z||!await(c.isElement==null?void 0:c.isElement(G)))&&(z=d.floating[F]||i.floating[N]);const q=j/2-L/2,ae=z/2-E[N]/2-1,oe=Qc(x[A],ae),fe=Qc(x[R],ae),H=oe,me=z-E[N]-fe,ee=z/2-E[N]/2+q,se=cb(H,ee,me),de=!m.arrow&&bh(s)!=null&&ee!==se&&i.reference[N]/2-(ee<H?oe:fe)-E[N]/2<0,Y=de?ee<H?ee-H:ee-me:0;return{[S]:b[S]+Y,data:{[S]:se,centerOffset:ee-se-Y,...de&&{alignmentOffset:Y}},reset:de}}}),$B=function(r){return r===void 0&&(r={}),{name:"flip",options:r,async fn(e){var t,n;const{placement:s,middlewareData:i,rects:c,initialPlacement:d,platform:m,elements:p}=e,{mainAxis:v=!0,crossAxis:x=!0,fallbackPlacements:b,fallbackStrategy:S="bestFit",fallbackAxisSideDirection:N="none",flipAlignment:E=!0,...T}=Yl(r,e);if((t=i.arrow)!=null&&t.alignmentOffset)return{};const A=Jl(s),R=Ya(d),F=Jl(d)===d,j=await(m.isRTL==null?void 0:m.isRTL(p.floating)),L=b||(F||!E?[ky(d)]:RB(d)),G=N!=="none";!b&&G&&L.push(...jB(d,E,N,j));const z=[d,...L],q=await m.detectOverflow(e,T),ae=[];let oe=((n=i.flip)==null?void 0:n.overflows)||[];if(v&&ae.push(q[A]),x){const ee=AB(s,c,j);ae.push(q[ee[0]],q[ee[1]])}if(oe=[...oe,{placement:s,overflows:ae}],!ae.every(ee=>ee<=0)){var fe,H;const ee=(((fe=i.flip)==null?void 0:fe.index)||0)+1,se=z[ee];if(se&&(!(x==="alignment"?R!==Ya(se):!1)||oe.every(J=>Ya(J.placement)===R?J.overflows[0]>0:!0)))return{data:{index:ee,overflows:oe},reset:{placement:se}};let de=(H=oe.filter(Y=>Y.overflows[0]<=0).sort((Y,J)=>Y.overflows[1]-J.overflows[1])[0])==null?void 0:H.placement;if(!de)switch(S){case"bestFit":{var me;const Y=(me=oe.filter(J=>{if(G){const $=Ya(J.placement);return $===R||$==="y"}return!0}).map(J=>[J.placement,J.overflows.filter($=>$>0).reduce(($,X)=>$+X,0)]).sort((J,$)=>J[1]-$[1])[0])==null?void 0:me[0];Y&&(de=Y);break}case"initialPlacement":de=d;break}if(s!==de)return{reset:{placement:de}}}return{}}}};function Fk(r,e){return{top:r.top-e.height,right:r.right-e.width,bottom:r.bottom-e.height,left:r.left-e.width}}function jk(r){return CB.some(e=>r[e]>=0)}const UB=function(r){return r===void 0&&(r={}),{name:"hide",options:r,async fn(e){const{rects:t,platform:n}=e,{strategy:s="referenceHidden",...i}=Yl(r,e);switch(s){case"referenceHidden":{const c=await n.detectOverflow(e,{...i,elementContext:"reference"}),d=Fk(c,t.reference);return{data:{referenceHiddenOffsets:d,referenceHidden:jk(d)}}}case"escaped":{const c=await n.detectOverflow(e,{...i,altBoundary:!0}),d=Fk(c,t.floating);return{data:{escapedOffsets:d,escaped:jk(d)}}}default:return{}}}}},rR=new Set(["left","top"]);async function zB(r,e){const{placement:t,platform:n,elements:s}=r,i=await(n.isRTL==null?void 0:n.isRTL(s.floating)),c=Jl(t),d=bh(t),m=Ya(t)==="y",p=rR.has(c)?-1:1,v=i&&m?-1:1,x=Yl(e,r);let{mainAxis:b,crossAxis:S,alignmentAxis:N}=typeof x=="number"?{mainAxis:x,crossAxis:0,alignmentAxis:null}:{mainAxis:x.mainAxis||0,crossAxis:x.crossAxis||0,alignmentAxis:x.alignmentAxis};return d&&typeof N=="number"&&(S=d==="end"?N*-1:N),m?{x:S*v,y:b*p}:{x:b*p,y:S*v}}const HB=function(r){return r===void 0&&(r=0),{name:"offset",options:r,async fn(e){var t,n;const{x:s,y:i,placement:c,middlewareData:d}=e,m=await zB(e,r);return c===((t=d.offset)==null?void 0:t.placement)&&(n=d.arrow)!=null&&n.alignmentOffset?{}:{x:s+m.x,y:i+m.y,data:{...m,placement:c}}}}},BB=function(r){return r===void 0&&(r={}),{name:"shift",options:r,async fn(e){const{x:t,y:n,placement:s,platform:i}=e,{mainAxis:c=!0,crossAxis:d=!1,limiter:m={fn:A=>{let{x:R,y:F}=A;return{x:R,y:F}}},...p}=Yl(r,e),v={x:t,y:n},x=await i.detectOverflow(e,p),b=Ya(Jl(s)),S=iS(b);let N=v[S],E=v[b];if(c){const A=S==="y"?"top":"left",R=S==="y"?"bottom":"right",F=N+x[A],j=N-x[R];N=cb(F,N,j)}if(d){const A=b==="y"?"top":"left",R=b==="y"?"bottom":"right",F=E+x[A],j=E-x[R];E=cb(F,E,j)}const T=m.fn({...e,[S]:N,[b]:E});return{...T,data:{x:T.x-t,y:T.y-n,enabled:{[S]:c,[b]:d}}}}}},GB=function(r){return r===void 0&&(r={}),{options:r,fn(e){const{x:t,y:n,placement:s,rects:i,middlewareData:c}=e,{offset:d=0,mainAxis:m=!0,crossAxis:p=!0}=Yl(r,e),v={x:t,y:n},x=Ya(s),b=iS(x);let S=v[b],N=v[x];const E=Yl(d,e),T=typeof E=="number"?{mainAxis:E,crossAxis:0}:{mainAxis:0,crossAxis:0,...E};if(m){const F=b==="y"?"height":"width",j=i.reference[b]-i.floating[F]+T.mainAxis,L=i.reference[b]+i.reference[F]-T.mainAxis;S<j?S=j:S>L&&(S=L)}if(p){var A,R;const F=b==="y"?"width":"height",j=rR.has(Jl(s)),L=i.reference[x]-i.floating[F]+(j&&((A=c.offset)==null?void 0:A[x])||0)+(j?0:T.crossAxis),G=i.reference[x]+i.reference[F]+(j?0:((R=c.offset)==null?void 0:R[x])||0)-(j?T.crossAxis:0);N<L?N=L:N>G&&(N=G)}return{[b]:S,[x]:N}}}},WB=function(r){return r===void 0&&(r={}),{name:"size",options:r,async fn(e){var t,n;const{placement:s,rects:i,platform:c,elements:d}=e,{apply:m=()=>{},...p}=Yl(r,e),v=await c.detectOverflow(e,p),x=Jl(s),b=bh(s),S=Ya(s)==="y",{width:N,height:E}=i.floating;let T,A;x==="top"||x==="bottom"?(T=x,A=b===(await(c.isRTL==null?void 0:c.isRTL(d.floating))?"start":"end")?"left":"right"):(A=x,T=b==="end"?"top":"bottom");const R=E-v.top-v.bottom,F=N-v.left-v.right,j=Qc(E-v[T],R),L=Qc(N-v[A],F),G=!e.middlewareData.shift;let z=j,q=L;if((t=e.middlewareData.shift)!=null&&t.enabled.x&&(q=F),(n=e.middlewareData.shift)!=null&&n.enabled.y&&(z=R),G&&!b){const oe=ri(v.left,0),fe=ri(v.right,0),H=ri(v.top,0),me=ri(v.bottom,0);S?q=N-2*(oe!==0||fe!==0?oe+fe:ri(v.left,v.right)):z=E-2*(H!==0||me!==0?H+me:ri(v.top,v.bottom))}await m({...e,availableWidth:q,availableHeight:z});const ae=await c.getDimensions(d.floating);return N!==ae.width||E!==ae.height?{reset:{rects:!0}}:{}}}};function Ky(){return typeof window<"u"}function _h(r){return nR(r)?(r.nodeName||"").toLowerCase():"#document"}function oi(r){var e;return(r==null||(e=r.ownerDocument)==null?void 0:e.defaultView)||window}function el(r){var e;return(e=(nR(r)?r.ownerDocument:r.document)||window.document)==null?void 0:e.documentElement}function nR(r){return Ky()?r instanceof Node||r instanceof oi(r).Node:!1}function la(r){return Ky()?r instanceof Element||r instanceof oi(r).Element:!1}function Xa(r){return Ky()?r instanceof HTMLElement||r instanceof oi(r).HTMLElement:!1}function Ok(r){return!Ky()||typeof ShadowRoot>"u"?!1:r instanceof ShadowRoot||r instanceof oi(r).ShadowRoot}const VB=new Set(["inline","contents"]);function ng(r){const{overflow:e,overflowX:t,overflowY:n,display:s}=ca(r);return/auto|scroll|overlay|hidden|clip/.test(e+n+t)&&!VB.has(s)}const qB=new Set(["table","td","th"]);function KB(r){return qB.has(_h(r))}const YB=[":popover-open",":modal"];function Yy(r){return YB.some(e=>{try{return r.matches(e)}catch{return!1}})}const JB=["transform","translate","scale","rotate","perspective"],XB=["transform","translate","scale","rotate","perspective","filter"],QB=["paint","layout","strict","content"];function cS(r){const e=uS(),t=la(r)?ca(r):r;return JB.some(n=>t[n]?t[n]!=="none":!1)||(t.containerType?t.containerType!=="normal":!1)||!e&&(t.backdropFilter?t.backdropFilter!=="none":!1)||!e&&(t.filter?t.filter!=="none":!1)||XB.some(n=>(t.willChange||"").includes(n))||QB.some(n=>(t.contain||"").includes(n))}function ZB(r){let e=Zc(r);for(;Xa(e)&&!ph(e);){if(cS(e))return e;if(Yy(e))return null;e=Zc(e)}return null}function uS(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const eG=new Set(["html","body","#document"]);function ph(r){return eG.has(_h(r))}function ca(r){return oi(r).getComputedStyle(r)}function Jy(r){return la(r)?{scrollLeft:r.scrollLeft,scrollTop:r.scrollTop}:{scrollLeft:r.scrollX,scrollTop:r.scrollY}}function Zc(r){if(_h(r)==="html")return r;const e=r.assignedSlot||r.parentNode||Ok(r)&&r.host||el(r);return Ok(e)?e.host:e}function sR(r){const e=Zc(r);return ph(e)?r.ownerDocument?r.ownerDocument.body:r.body:Xa(e)&&ng(e)?e:sR(e)}function Gm(r,e,t){var n;e===void 0&&(e=[]),t===void 0&&(t=!0);const s=sR(r),i=s===((n=r.ownerDocument)==null?void 0:n.body),c=oi(s);if(i){const d=db(c);return e.concat(c,c.visualViewport||[],ng(s)?s:[],d&&t?Gm(d):[])}return e.concat(s,Gm(s,[],t))}function db(r){return r.parent&&Object.getPrototypeOf(r.parent)?r.frameElement:null}function oR(r){const e=ca(r);let t=parseFloat(e.width)||0,n=parseFloat(e.height)||0;const s=Xa(r),i=s?r.offsetWidth:t,c=s?r.offsetHeight:n,d=Cy(t)!==i||Cy(n)!==c;return d&&(t=i,n=c),{width:t,height:n,$:d}}function dS(r){return la(r)?r:r.contextElement}function oh(r){const e=dS(r);if(!Xa(e))return Ja(1);const t=e.getBoundingClientRect(),{width:n,height:s,$:i}=oR(e);let c=(i?Cy(t.width):t.width)/n,d=(i?Cy(t.height):t.height)/s;return(!c||!Number.isFinite(c))&&(c=1),(!d||!Number.isFinite(d))&&(d=1),{x:c,y:d}}const tG=Ja(0);function iR(r){const e=oi(r);return!uS()||!e.visualViewport?tG:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function rG(r,e,t){return e===void 0&&(e=!1),!t||e&&t!==oi(r)?!1:e}function fd(r,e,t,n){e===void 0&&(e=!1),t===void 0&&(t=!1);const s=r.getBoundingClientRect(),i=dS(r);let c=Ja(1);e&&(n?la(n)&&(c=oh(n)):c=oh(r));const d=rG(i,t,n)?iR(i):Ja(0);let m=(s.left+d.x)/c.x,p=(s.top+d.y)/c.y,v=s.width/c.x,x=s.height/c.y;if(i){const b=oi(i),S=n&&la(n)?oi(n):n;let N=b,E=db(N);for(;E&&n&&S!==N;){const T=oh(E),A=E.getBoundingClientRect(),R=ca(E),F=A.left+(E.clientLeft+parseFloat(R.paddingLeft))*T.x,j=A.top+(E.clientTop+parseFloat(R.paddingTop))*T.y;m*=T.x,p*=T.y,v*=T.x,x*=T.y,m+=F,p+=j,N=oi(E),E=db(N)}}return Ny({width:v,height:x,x:m,y:p})}function Xy(r,e){const t=Jy(r).scrollLeft;return e?e.left+t:fd(el(r)).left+t}function aR(r,e){const t=r.getBoundingClientRect(),n=t.left+e.scrollLeft-Xy(r,t),s=t.top+e.scrollTop;return{x:n,y:s}}function nG(r){let{elements:e,rect:t,offsetParent:n,strategy:s}=r;const i=s==="fixed",c=el(n),d=e?Yy(e.floating):!1;if(n===c||d&&i)return t;let m={scrollLeft:0,scrollTop:0},p=Ja(1);const v=Ja(0),x=Xa(n);if((x||!x&&!i)&&((_h(n)!=="body"||ng(c))&&(m=Jy(n)),Xa(n))){const S=fd(n);p=oh(n),v.x=S.x+n.clientLeft,v.y=S.y+n.clientTop}const b=c&&!x&&!i?aR(c,m):Ja(0);return{width:t.width*p.x,height:t.height*p.y,x:t.x*p.x-m.scrollLeft*p.x+v.x+b.x,y:t.y*p.y-m.scrollTop*p.y+v.y+b.y}}function sG(r){return Array.from(r.getClientRects())}function oG(r){const e=el(r),t=Jy(r),n=r.ownerDocument.body,s=ri(e.scrollWidth,e.clientWidth,n.scrollWidth,n.clientWidth),i=ri(e.scrollHeight,e.clientHeight,n.scrollHeight,n.clientHeight);let c=-t.scrollLeft+Xy(r);const d=-t.scrollTop;return ca(n).direction==="rtl"&&(c+=ri(e.clientWidth,n.clientWidth)-s),{width:s,height:i,x:c,y:d}}const Dk=25;function iG(r,e){const t=oi(r),n=el(r),s=t.visualViewport;let i=n.clientWidth,c=n.clientHeight,d=0,m=0;if(s){i=s.width,c=s.height;const v=uS();(!v||v&&e==="fixed")&&(d=s.offsetLeft,m=s.offsetTop)}const p=Xy(n);if(p<=0){const v=n.ownerDocument,x=v.body,b=getComputedStyle(x),S=v.compatMode==="CSS1Compat"&&parseFloat(b.marginLeft)+parseFloat(b.marginRight)||0,N=Math.abs(n.clientWidth-x.clientWidth-S);N<=Dk&&(i-=N)}else p<=Dk&&(i+=p);return{width:i,height:c,x:d,y:m}}const aG=new Set(["absolute","fixed"]);function lG(r,e){const t=fd(r,!0,e==="fixed"),n=t.top+r.clientTop,s=t.left+r.clientLeft,i=Xa(r)?oh(r):Ja(1),c=r.clientWidth*i.x,d=r.clientHeight*i.y,m=s*i.x,p=n*i.y;return{width:c,height:d,x:m,y:p}}function Lk(r,e,t){let n;if(e==="viewport")n=iG(r,t);else if(e==="document")n=oG(el(r));else if(la(e))n=lG(e,t);else{const s=iR(r);n={x:e.x-s.x,y:e.y-s.y,width:e.width,height:e.height}}return Ny(n)}function lR(r,e){const t=Zc(r);return t===e||!la(t)||ph(t)?!1:ca(t).position==="fixed"||lR(t,e)}function cG(r,e){const t=e.get(r);if(t)return t;let n=Gm(r,[],!1).filter(d=>la(d)&&_h(d)!=="body"),s=null;const i=ca(r).position==="fixed";let c=i?Zc(r):r;for(;la(c)&&!ph(c);){const d=ca(c),m=cS(c);!m&&d.position==="fixed"&&(s=null),(i?!m&&!s:!m&&d.position==="static"&&!!s&&aG.has(s.position)||ng(c)&&!m&&lR(r,c))?n=n.filter(v=>v!==c):s=d,c=Zc(c)}return e.set(r,n),n}function uG(r){let{element:e,boundary:t,rootBoundary:n,strategy:s}=r;const c=[...t==="clippingAncestors"?Yy(e)?[]:cG(e,this._c):[].concat(t),n],d=c[0],m=c.reduce((p,v)=>{const x=Lk(e,v,s);return p.top=ri(x.top,p.top),p.right=Qc(x.right,p.right),p.bottom=Qc(x.bottom,p.bottom),p.left=ri(x.left,p.left),p},Lk(e,d,s));return{width:m.right-m.left,height:m.bottom-m.top,x:m.left,y:m.top}}function dG(r){const{width:e,height:t}=oR(r);return{width:e,height:t}}function fG(r,e,t){const n=Xa(e),s=el(e),i=t==="fixed",c=fd(r,!0,i,e);let d={scrollLeft:0,scrollTop:0};const m=Ja(0);function p(){m.x=Xy(s)}if(n||!n&&!i)if((_h(e)!=="body"||ng(s))&&(d=Jy(e)),n){const S=fd(e,!0,i,e);m.x=S.x+e.clientLeft,m.y=S.y+e.clientTop}else s&&p();i&&!n&&s&&p();const v=s&&!n&&!i?aR(s,d):Ja(0),x=c.left+d.scrollLeft-m.x-v.x,b=c.top+d.scrollTop-m.y-v.y;return{x,y:b,width:c.width,height:c.height}}function Jx(r){return ca(r).position==="static"}function Mk(r,e){if(!Xa(r)||ca(r).position==="fixed")return null;if(e)return e(r);let t=r.offsetParent;return el(r)===t&&(t=t.ownerDocument.body),t}function cR(r,e){const t=oi(r);if(Yy(r))return t;if(!Xa(r)){let s=Zc(r);for(;s&&!ph(s);){if(la(s)&&!Jx(s))return s;s=Zc(s)}return t}let n=Mk(r,e);for(;n&&KB(n)&&Jx(n);)n=Mk(n,e);return n&&ph(n)&&Jx(n)&&!cS(n)?t:n||ZB(r)||t}const hG=async function(r){const e=this.getOffsetParent||cR,t=this.getDimensions,n=await t(r.floating);return{reference:fG(r.reference,await e(r.floating),r.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function pG(r){return ca(r).direction==="rtl"}const mG={convertOffsetParentRelativeRectToViewportRelativeRect:nG,getDocumentElement:el,getClippingRect:uG,getOffsetParent:cR,getElementRects:hG,getClientRects:sG,getDimensions:dG,getScale:oh,isElement:la,isRTL:pG};function uR(r,e){return r.x===e.x&&r.y===e.y&&r.width===e.width&&r.height===e.height}function gG(r,e){let t=null,n;const s=el(r);function i(){var d;clearTimeout(n),(d=t)==null||d.disconnect(),t=null}function c(d,m){d===void 0&&(d=!1),m===void 0&&(m=1),i();const p=r.getBoundingClientRect(),{left:v,top:x,width:b,height:S}=p;if(d||e(),!b||!S)return;const N=Iv(x),E=Iv(s.clientWidth-(v+b)),T=Iv(s.clientHeight-(x+S)),A=Iv(v),F={rootMargin:-N+"px "+-E+"px "+-T+"px "+-A+"px",threshold:ri(0,Qc(1,m))||1};let j=!0;function L(G){const z=G[0].intersectionRatio;if(z!==m){if(!j)return c();z?c(!1,z):n=setTimeout(()=>{c(!1,1e-7)},1e3)}z===1&&!uR(p,r.getBoundingClientRect())&&c(),j=!1}try{t=new IntersectionObserver(L,{...F,root:s.ownerDocument})}catch{t=new IntersectionObserver(L,F)}t.observe(r)}return c(!0),i}function vG(r,e,t,n){n===void 0&&(n={});const{ancestorScroll:s=!0,ancestorResize:i=!0,elementResize:c=typeof ResizeObserver=="function",layoutShift:d=typeof IntersectionObserver=="function",animationFrame:m=!1}=n,p=dS(r),v=s||i?[...p?Gm(p):[],...Gm(e)]:[];v.forEach(A=>{s&&A.addEventListener("scroll",t,{passive:!0}),i&&A.addEventListener("resize",t)});const x=p&&d?gG(p,t):null;let b=-1,S=null;c&&(S=new ResizeObserver(A=>{let[R]=A;R&&R.target===p&&S&&(S.unobserve(e),cancelAnimationFrame(b),b=requestAnimationFrame(()=>{var F;(F=S)==null||F.observe(e)})),t()}),p&&!m&&S.observe(p),S.observe(e));let N,E=m?fd(r):null;m&&T();function T(){const A=fd(r);E&&!uR(E,A)&&t(),E=A,N=requestAnimationFrame(T)}return t(),()=>{var A;v.forEach(R=>{s&&R.removeEventListener("scroll",t),i&&R.removeEventListener("resize",t)}),x==null||x(),(A=S)==null||A.disconnect(),S=null,m&&cancelAnimationFrame(N)}}const yG=HB,xG=BB,wG=$B,bG=WB,_G=UB,$k=MB,SG=GB,EG=(r,e,t)=>{const n=new Map,s={platform:mG,...t},i={...s.platform,_c:n};return LB(r,e,{...s,platform:i})};var fS=y1();const CG=_b(fS);var kG=typeof document<"u",NG=function(){},Yv=kG?w.useLayoutEffect:NG;function Ty(r,e){if(r===e)return!0;if(typeof r!=typeof e)return!1;if(typeof r=="function"&&r.toString()===e.toString())return!0;let t,n,s;if(r&&e&&typeof r=="object"){if(Array.isArray(r)){if(t=r.length,t!==e.length)return!1;for(n=t;n--!==0;)if(!Ty(r[n],e[n]))return!1;return!0}if(s=Object.keys(r),t=s.length,t!==Object.keys(e).length)return!1;for(n=t;n--!==0;)if(!{}.hasOwnProperty.call(e,s[n]))return!1;for(n=t;n--!==0;){const i=s[n];if(!(i==="_owner"&&r.$$typeof)&&!Ty(r[i],e[i]))return!1}return!0}return r!==r&&e!==e}function dR(r){return typeof window>"u"?1:(r.ownerDocument.defaultView||window).devicePixelRatio||1}function Uk(r,e){const t=dR(r);return Math.round(e*t)/t}function Xx(r){const e=w.useRef(r);return Yv(()=>{e.current=r}),e}function TG(r){r===void 0&&(r={});const{placement:e="bottom",strategy:t="absolute",middleware:n=[],platform:s,elements:{reference:i,floating:c}={},transform:d=!0,whileElementsMounted:m,open:p}=r,[v,x]=w.useState({x:0,y:0,strategy:t,placement:e,middlewareData:{},isPositioned:!1}),[b,S]=w.useState(n);Ty(b,n)||S(n);const[N,E]=w.useState(null),[T,A]=w.useState(null),R=w.useCallback(J=>{J!==G.current&&(G.current=J,E(J))},[]),F=w.useCallback(J=>{J!==z.current&&(z.current=J,A(J))},[]),j=i||N,L=c||T,G=w.useRef(null),z=w.useRef(null),q=w.useRef(v),ae=m!=null,oe=Xx(m),fe=Xx(s),H=Xx(p),me=w.useCallback(()=>{if(!G.current||!z.current)return;const J={placement:e,strategy:t,middleware:b};fe.current&&(J.platform=fe.current),EG(G.current,z.current,J).then($=>{const X={...$,isPositioned:H.current!==!1};ee.current&&!Ty(q.current,X)&&(q.current=X,fS.flushSync(()=>{x(X)}))})},[b,e,t,fe,H]);Yv(()=>{p===!1&&q.current.isPositioned&&(q.current.isPositioned=!1,x(J=>({...J,isPositioned:!1})))},[p]);const ee=w.useRef(!1);Yv(()=>(ee.current=!0,()=>{ee.current=!1}),[]),Yv(()=>{if(j&&(G.current=j),L&&(z.current=L),j&&L){if(oe.current)return oe.current(j,L,me);me()}},[j,L,me,oe,ae]);const se=w.useMemo(()=>({reference:G,floating:z,setReference:R,setFloating:F}),[R,F]),de=w.useMemo(()=>({reference:j,floating:L}),[j,L]),Y=w.useMemo(()=>{const J={position:t,left:0,top:0};if(!de.floating)return J;const $=Uk(de.floating,v.x),X=Uk(de.floating,v.y);return d?{...J,transform:"translate("+$+"px, "+X+"px)",...dR(de.floating)>=1.5&&{willChange:"transform"}}:{position:t,left:$,top:X}},[t,d,de.floating,v.x,v.y]);return w.useMemo(()=>({...v,update:me,refs:se,elements:de,floatingStyles:Y}),[v,me,se,de,Y])}const AG=r=>{function e(t){return{}.hasOwnProperty.call(t,"current")}return{name:"arrow",options:r,fn(t){const{element:n,padding:s}=typeof r=="function"?r(t):r;return n&&e(n)?n.current!=null?$k({element:n.current,padding:s}).fn(t):{}:n?$k({element:n,padding:s}).fn(t):{}}}},RG=(r,e)=>({...yG(r),options:[r,e]}),IG=(r,e)=>({...xG(r),options:[r,e]}),PG=(r,e)=>({...SG(r),options:[r,e]}),FG=(r,e)=>({...wG(r),options:[r,e]}),jG=(r,e)=>({...bG(r),options:[r,e]}),OG=(r,e)=>({..._G(r),options:[r,e]}),DG=(r,e)=>({...AG(r),options:[r,e]});function LG(r){const e=MG(r),t=w.forwardRef((n,s)=>{const{children:i,...c}=n,d=w.Children.toArray(i),m=d.find(UG);if(m){const p=m.props.children,v=d.map(x=>x===m?w.Children.count(p)>1?w.Children.only(null):w.isValidElement(p)?p.props.children:null:x);return u.jsx(e,{...c,ref:s,children:w.isValidElement(p)?w.cloneElement(p,void 0,v):null})}return u.jsx(e,{...c,ref:s,children:i})});return t.displayName=`${r}.Slot`,t}function MG(r){const e=w.forwardRef((t,n)=>{const{children:s,...i}=t;if(w.isValidElement(s)){const c=HG(s),d=zG(i,s.props);return s.type!==w.Fragment&&(d.ref=n?tu(n,c):c),w.cloneElement(s,d)}return w.Children.count(s)>1?w.Children.only(null):null});return e.displayName=`${r}.SlotClone`,e}var $G=Symbol("radix.slottable");function UG(r){return w.isValidElement(r)&&typeof r.type=="function"&&"__radixId"in r.type&&r.type.__radixId===$G}function zG(r,e){const t={...e};for(const n in e){const s=r[n],i=e[n];/^on[A-Z]/.test(n)?s&&i?t[n]=(...d)=>{const m=i(...d);return s(...d),m}:s&&(t[n]=s):n==="style"?t[n]={...s,...i}:n==="className"&&(t[n]=[s,i].filter(Boolean).join(" "))}return{...r,...t}}function HG(r){var n,s;let e=(n=Object.getOwnPropertyDescriptor(r.props,"ref"))==null?void 0:n.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=(s=Object.getOwnPropertyDescriptor(r,"ref"))==null?void 0:s.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}var BG=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],$r=BG.reduce((r,e)=>{const t=LG(`Primitive.${e}`),n=w.forwardRef((s,i)=>{const{asChild:c,...d}=s,m=c?t:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),u.jsx(m,{...d,ref:i})});return n.displayName=`Primitive.${e}`,{...r,[e]:n}},{});function fR(r,e){r&&fS.flushSync(()=>r.dispatchEvent(e))}var GG="Arrow",hR=w.forwardRef((r,e)=>{const{children:t,width:n=10,height:s=5,...i}=r;return u.jsx($r.svg,{...i,ref:e,width:n,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:r.asChild?t:u.jsx("polygon",{points:"0,0 30,0 15,10"})})});hR.displayName=GG;var WG=hR;function Xl(r){const e=w.useRef(r);return w.useEffect(()=>{e.current=r}),w.useMemo(()=>(...t)=>{var n;return(n=e.current)==null?void 0:n.call(e,...t)},[])}function VG(r){const[e,t]=w.useState(void 0);return Kl(()=>{if(r){t({width:r.offsetWidth,height:r.offsetHeight});const n=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const i=s[0];let c,d;if("borderBoxSize"in i){const m=i.borderBoxSize,p=Array.isArray(m)?m[0]:m;c=p.inlineSize,d=p.blockSize}else c=r.offsetWidth,d=r.offsetHeight;t({width:c,height:d})});return n.observe(r,{box:"border-box"}),()=>n.unobserve(r)}else t(void 0)},[r]),e}var hS="Popper",[pR,Qy]=Za(hS),[qG,mR]=pR(hS),gR=r=>{const{__scopePopper:e,children:t}=r,[n,s]=w.useState(null);return u.jsx(qG,{scope:e,anchor:n,onAnchorChange:s,children:t})};gR.displayName=hS;var vR="PopperAnchor",yR=w.forwardRef((r,e)=>{const{__scopePopper:t,virtualRef:n,...s}=r,i=mR(vR,t),c=w.useRef(null),d=Mn(e,c),m=w.useRef(null);return w.useEffect(()=>{const p=m.current;m.current=(n==null?void 0:n.current)||c.current,p!==m.current&&i.onAnchorChange(m.current)}),n?null:u.jsx($r.div,{...s,ref:d})});yR.displayName=vR;var pS="PopperContent",[KG,YG]=pR(pS),xR=w.forwardRef((r,e)=>{var K,he,be,Ie,_t,Be;const{__scopePopper:t,side:n="bottom",sideOffset:s=0,align:i="center",alignOffset:c=0,arrowPadding:d=0,avoidCollisions:m=!0,collisionBoundary:p=[],collisionPadding:v=0,sticky:x="partial",hideWhenDetached:b=!1,updatePositionStrategy:S="optimized",onPlaced:N,...E}=r,T=mR(pS,t),[A,R]=w.useState(null),F=Mn(e,Ge=>R(Ge)),[j,L]=w.useState(null),G=VG(j),z=(G==null?void 0:G.width)??0,q=(G==null?void 0:G.height)??0,ae=n+(i!=="center"?"-"+i:""),oe=typeof v=="number"?v:{top:0,right:0,bottom:0,left:0,...v},fe=Array.isArray(p)?p:[p],H=fe.length>0,me={padding:oe,boundary:fe.filter(XG),altBoundary:H},{refs:ee,floatingStyles:se,placement:de,isPositioned:Y,middlewareData:J}=TG({strategy:"fixed",placement:ae,whileElementsMounted:(...Ge)=>vG(...Ge,{animationFrame:S==="always"}),elements:{reference:T.anchor},middleware:[RG({mainAxis:s+q,alignmentAxis:c}),m&&IG({mainAxis:!0,crossAxis:!1,limiter:x==="partial"?PG():void 0,...me}),m&&FG({...me}),jG({...me,apply:({elements:Ge,rects:qe,availableWidth:Ne,availableHeight:St})=>{const{width:ct,height:Ct}=qe.reference,Gt=Ge.floating.style;Gt.setProperty("--radix-popper-available-width",`${Ne}px`),Gt.setProperty("--radix-popper-available-height",`${St}px`),Gt.setProperty("--radix-popper-anchor-width",`${ct}px`),Gt.setProperty("--radix-popper-anchor-height",`${Ct}px`)}}),j&&DG({element:j,padding:d}),QG({arrowWidth:z,arrowHeight:q}),b&&OG({strategy:"referenceHidden",...me})]}),[$,X]=_R(de),O=Xl(N);Kl(()=>{Y&&(O==null||O())},[Y,O]);const U=(K=J.arrow)==null?void 0:K.x,re=(he=J.arrow)==null?void 0:he.y,Ee=((be=J.arrow)==null?void 0:be.centerOffset)!==0,[ne,we]=w.useState();return Kl(()=>{A&&we(window.getComputedStyle(A).zIndex)},[A]),u.jsx("div",{ref:ee.setFloating,"data-radix-popper-content-wrapper":"",style:{...se,transform:Y?se.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:ne,"--radix-popper-transform-origin":[(Ie=J.transformOrigin)==null?void 0:Ie.x,(_t=J.transformOrigin)==null?void 0:_t.y].join(" "),...((Be=J.hide)==null?void 0:Be.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:r.dir,children:u.jsx(KG,{scope:t,placedSide:$,onArrowChange:L,arrowX:U,arrowY:re,shouldHideArrow:Ee,children:u.jsx($r.div,{"data-side":$,"data-align":X,...E,ref:F,style:{...E.style,animation:Y?void 0:"none"}})})})});xR.displayName=pS;var wR="PopperArrow",JG={top:"bottom",right:"left",bottom:"top",left:"right"},bR=w.forwardRef(function(e,t){const{__scopePopper:n,...s}=e,i=YG(wR,n),c=JG[i.placedSide];return u.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[c]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:u.jsx(WG,{...s,ref:t,style:{...s.style,display:"block"}})})});bR.displayName=wR;function XG(r){return r!==null}var QG=r=>({name:"transformOrigin",options:r,fn(e){var T,A,R;const{placement:t,rects:n,middlewareData:s}=e,c=((T=s.arrow)==null?void 0:T.centerOffset)!==0,d=c?0:r.arrowWidth,m=c?0:r.arrowHeight,[p,v]=_R(t),x={start:"0%",center:"50%",end:"100%"}[v],b=(((A=s.arrow)==null?void 0:A.x)??0)+d/2,S=(((R=s.arrow)==null?void 0:R.y)??0)+m/2;let N="",E="";return p==="bottom"?(N=c?x:`${b}px`,E=`${-m}px`):p==="top"?(N=c?x:`${b}px`,E=`${n.floating.height+m}px`):p==="right"?(N=`${-m}px`,E=c?x:`${S}px`):p==="left"&&(N=`${n.floating.width+m}px`,E=c?x:`${S}px`),{data:{x:N,y:E}}}});function _R(r){const[e,t="center"]=r.split("-");return[e,t]}var SR=gR,ER=yR,CR=xR,kR=bR,ZG="Portal",mS=w.forwardRef((r,e)=>{var d;const{container:t,...n}=r,[s,i]=w.useState(!1);Kl(()=>i(!0),[]);const c=t||s&&((d=globalThis==null?void 0:globalThis.document)==null?void 0:d.body);return c?CG.createPortal(u.jsx($r.div,{...n,ref:e}),c):null});mS.displayName=ZG;function e7(r,e){return w.useReducer((t,n)=>e[t][n]??t,r)}var fa=r=>{const{present:e,children:t}=r,n=t7(e),s=typeof t=="function"?t({present:n.isPresent}):w.Children.only(t),i=Mn(n.ref,r7(s));return typeof t=="function"||n.isPresent?w.cloneElement(s,{ref:i}):null};fa.displayName="Presence";function t7(r){const[e,t]=w.useState(),n=w.useRef(null),s=w.useRef(r),i=w.useRef("none"),c=r?"mounted":"unmounted",[d,m]=e7(c,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return w.useEffect(()=>{const p=Pv(n.current);i.current=d==="mounted"?p:"none"},[d]),Kl(()=>{const p=n.current,v=s.current;if(v!==r){const b=i.current,S=Pv(p);r?m("MOUNT"):S==="none"||(p==null?void 0:p.display)==="none"?m("UNMOUNT"):m(v&&b!==S?"ANIMATION_OUT":"UNMOUNT"),s.current=r}},[r,m]),Kl(()=>{if(e){let p;const v=e.ownerDocument.defaultView??window,x=S=>{const E=Pv(n.current).includes(CSS.escape(S.animationName));if(S.target===e&&E&&(m("ANIMATION_END"),!s.current)){const T=e.style.animationFillMode;e.style.animationFillMode="forwards",p=v.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=T)})}},b=S=>{S.target===e&&(i.current=Pv(n.current))};return e.addEventListener("animationstart",b),e.addEventListener("animationcancel",x),e.addEventListener("animationend",x),()=>{v.clearTimeout(p),e.removeEventListener("animationstart",b),e.removeEventListener("animationcancel",x),e.removeEventListener("animationend",x)}}else m("ANIMATION_END")},[e,m]),{isPresent:["mounted","unmountSuspended"].includes(d),ref:w.useCallback(p=>{n.current=p?getComputedStyle(p):null,t(p)},[])}}function Pv(r){return(r==null?void 0:r.animationName)||"none"}function r7(r){var n,s;let e=(n=Object.getOwnPropertyDescriptor(r.props,"ref"))==null?void 0:n.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=(s=Object.getOwnPropertyDescriptor(r,"ref"))==null?void 0:s.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}function n7(r,e=globalThis==null?void 0:globalThis.document){const t=Xl(r);w.useEffect(()=>{const n=s=>{s.key==="Escape"&&t(s)};return e.addEventListener("keydown",n,{capture:!0}),()=>e.removeEventListener("keydown",n,{capture:!0})},[t,e])}var s7="DismissableLayer",fb="dismissableLayer.update",o7="dismissableLayer.pointerDownOutside",i7="dismissableLayer.focusOutside",zk,NR=w.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Zy=w.forwardRef((r,e)=>{const{disableOutsidePointerEvents:t=!1,onEscapeKeyDown:n,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:c,onDismiss:d,...m}=r,p=w.useContext(NR),[v,x]=w.useState(null),b=(v==null?void 0:v.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,S]=w.useState({}),N=Mn(e,z=>x(z)),E=Array.from(p.layers),[T]=[...p.layersWithOutsidePointerEventsDisabled].slice(-1),A=E.indexOf(T),R=v?E.indexOf(v):-1,F=p.layersWithOutsidePointerEventsDisabled.size>0,j=R>=A,L=c7(z=>{const q=z.target,ae=[...p.branches].some(oe=>oe.contains(q));!j||ae||(s==null||s(z),c==null||c(z),z.defaultPrevented||d==null||d())},b),G=u7(z=>{const q=z.target;[...p.branches].some(oe=>oe.contains(q))||(i==null||i(z),c==null||c(z),z.defaultPrevented||d==null||d())},b);return n7(z=>{R===p.layers.size-1&&(n==null||n(z),!z.defaultPrevented&&d&&(z.preventDefault(),d()))},b),w.useEffect(()=>{if(v)return t&&(p.layersWithOutsidePointerEventsDisabled.size===0&&(zk=b.body.style.pointerEvents,b.body.style.pointerEvents="none"),p.layersWithOutsidePointerEventsDisabled.add(v)),p.layers.add(v),Hk(),()=>{t&&p.layersWithOutsidePointerEventsDisabled.size===1&&(b.body.style.pointerEvents=zk)}},[v,b,t,p]),w.useEffect(()=>()=>{v&&(p.layers.delete(v),p.layersWithOutsidePointerEventsDisabled.delete(v),Hk())},[v,p]),w.useEffect(()=>{const z=()=>S({});return document.addEventListener(fb,z),()=>document.removeEventListener(fb,z)},[]),u.jsx($r.div,{...m,ref:N,style:{pointerEvents:F?j?"auto":"none":void 0,...r.style},onFocusCapture:Lt(r.onFocusCapture,G.onFocusCapture),onBlurCapture:Lt(r.onBlurCapture,G.onBlurCapture),onPointerDownCapture:Lt(r.onPointerDownCapture,L.onPointerDownCapture)})});Zy.displayName=s7;var a7="DismissableLayerBranch",l7=w.forwardRef((r,e)=>{const t=w.useContext(NR),n=w.useRef(null),s=Mn(e,n);return w.useEffect(()=>{const i=n.current;if(i)return t.branches.add(i),()=>{t.branches.delete(i)}},[t.branches]),u.jsx($r.div,{...r,ref:s})});l7.displayName=a7;function c7(r,e=globalThis==null?void 0:globalThis.document){const t=Xl(r),n=w.useRef(!1),s=w.useRef(()=>{});return w.useEffect(()=>{const i=d=>{if(d.target&&!n.current){let m=function(){TR(o7,t,p,{discrete:!0})};const p={originalEvent:d};d.pointerType==="touch"?(e.removeEventListener("click",s.current),s.current=m,e.addEventListener("click",s.current,{once:!0})):m()}else e.removeEventListener("click",s.current);n.current=!1},c=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(c),e.removeEventListener("pointerdown",i),e.removeEventListener("click",s.current)}},[e,t]),{onPointerDownCapture:()=>n.current=!0}}function u7(r,e=globalThis==null?void 0:globalThis.document){const t=Xl(r),n=w.useRef(!1);return w.useEffect(()=>{const s=i=>{i.target&&!n.current&&TR(i7,t,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",s),()=>e.removeEventListener("focusin",s)},[e,t]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function Hk(){const r=new CustomEvent(fb);document.dispatchEvent(r)}function TR(r,e,t,{discrete:n}){const s=t.originalEvent.target,i=new CustomEvent(r,{bubbles:!1,cancelable:!0,detail:t});e&&s.addEventListener(r,e,{once:!0}),n?fR(s,i):s.dispatchEvent(i)}var Qx,e0="HoverCard",[AR]=Za(e0,[Qy]),t0=Qy(),[d7,gS]=AR(e0),RR=r=>{const{__scopeHoverCard:e,children:t,open:n,defaultOpen:s,onOpenChange:i,openDelay:c=700,closeDelay:d=300}=r,m=t0(e),p=w.useRef(0),v=w.useRef(0),x=w.useRef(!1),b=w.useRef(!1),[S,N]=ru({prop:n,defaultProp:s??!1,onChange:i,caller:e0}),E=w.useCallback(()=>{clearTimeout(v.current),p.current=window.setTimeout(()=>N(!0),c)},[c,N]),T=w.useCallback(()=>{clearTimeout(p.current),!x.current&&!b.current&&(v.current=window.setTimeout(()=>N(!1),d))},[d,N]),A=w.useCallback(()=>N(!1),[N]);return w.useEffect(()=>()=>{clearTimeout(p.current),clearTimeout(v.current)},[]),u.jsx(d7,{scope:e,open:S,onOpenChange:N,onOpen:E,onClose:T,onDismiss:A,hasSelectionRef:x,isPointerDownOnContentRef:b,children:u.jsx(SR,{...m,children:t})})};RR.displayName=e0;var IR="HoverCardTrigger",PR=w.forwardRef((r,e)=>{const{__scopeHoverCard:t,...n}=r,s=gS(IR,t),i=t0(t);return u.jsx(ER,{asChild:!0,...i,children:u.jsx($r.a,{"data-state":s.open?"open":"closed",...n,ref:e,onPointerEnter:Lt(r.onPointerEnter,Ry(s.onOpen)),onPointerLeave:Lt(r.onPointerLeave,Ry(s.onClose)),onFocus:Lt(r.onFocus,s.onOpen),onBlur:Lt(r.onBlur,s.onClose),onTouchStart:Lt(r.onTouchStart,c=>c.preventDefault())})})});PR.displayName=IR;var f7="HoverCardPortal",[DK,h7]=AR(f7,{forceMount:void 0}),Ay="HoverCardContent",FR=w.forwardRef((r,e)=>{const t=h7(Ay,r.__scopeHoverCard),{forceMount:n=t.forceMount,...s}=r,i=gS(Ay,r.__scopeHoverCard);return u.jsx(fa,{present:n||i.open,children:u.jsx(p7,{"data-state":i.open?"open":"closed",...s,onPointerEnter:Lt(r.onPointerEnter,Ry(i.onOpen)),onPointerLeave:Lt(r.onPointerLeave,Ry(i.onClose)),ref:e})})});FR.displayName=Ay;var p7=w.forwardRef((r,e)=>{const{__scopeHoverCard:t,onEscapeKeyDown:n,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:c,...d}=r,m=gS(Ay,t),p=t0(t),v=w.useRef(null),x=Mn(e,v),[b,S]=w.useState(!1);return w.useEffect(()=>{if(b){const N=document.body;return Qx=N.style.userSelect||N.style.webkitUserSelect,N.style.userSelect="none",N.style.webkitUserSelect="none",()=>{N.style.userSelect=Qx,N.style.webkitUserSelect=Qx}}},[b]),w.useEffect(()=>{if(v.current){const N=()=>{S(!1),m.isPointerDownOnContentRef.current=!1,setTimeout(()=>{var T;((T=document.getSelection())==null?void 0:T.toString())!==""&&(m.hasSelectionRef.current=!0)})};return document.addEventListener("pointerup",N),()=>{document.removeEventListener("pointerup",N),m.hasSelectionRef.current=!1,m.isPointerDownOnContentRef.current=!1}}},[m.isPointerDownOnContentRef,m.hasSelectionRef]),w.useEffect(()=>{v.current&&g7(v.current).forEach(E=>E.setAttribute("tabindex","-1"))}),u.jsx(Zy,{asChild:!0,disableOutsidePointerEvents:!1,onInteractOutside:c,onEscapeKeyDown:n,onPointerDownOutside:s,onFocusOutside:Lt(i,N=>{N.preventDefault()}),onDismiss:m.onDismiss,children:u.jsx(CR,{...p,...d,onPointerDown:Lt(d.onPointerDown,N=>{N.currentTarget.contains(N.target)&&S(!0),m.hasSelectionRef.current=!1,m.isPointerDownOnContentRef.current=!0}),ref:x,style:{...d.style,userSelect:b?"text":void 0,WebkitUserSelect:b?"text":void 0,"--radix-hover-card-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-hover-card-content-available-width":"var(--radix-popper-available-width)","--radix-hover-card-content-available-height":"var(--radix-popper-available-height)","--radix-hover-card-trigger-width":"var(--radix-popper-anchor-width)","--radix-hover-card-trigger-height":"var(--radix-popper-anchor-height)"}})})}),m7="HoverCardArrow",jR=w.forwardRef((r,e)=>{const{__scopeHoverCard:t,...n}=r,s=t0(t);return u.jsx(kR,{...s,...n,ref:e})});jR.displayName=m7;function Ry(r){return e=>e.pointerType==="touch"?void 0:r()}function g7(r){const e=[],t=document.createTreeWalker(r,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP});for(;t.nextNode();)e.push(t.currentNode);return e}var v7=RR,y7=PR,x7=FR,w7=jR;const hb="src/lib/utils/emailUtils.tsx";async function vS(r,e){try{await(await Kn.createServices()).contentScript.insertContentIntoComposeBox(r)}catch(t){e.error("Error inserting content into compose box",t,{sourceFile:hb,functionName:"insertHtmlIntoComposeBox"}),b7(r,e)}}function b7(r,e){const t=r.replace(/<([^>]+)class="ql-align-([^"]+)"([^>]*)>/g,'<$1style="text-align: $2"$3>');chrome.tabs.query({active:!0,currentWindow:!0},n=>{const s=n[0];if(!(s!=null&&s.id)){e.error("No active tab found or tab ID is undefined",void 0,{sourceFile:hb,functionName:"insertHtmlIntoComposeBoxLegacy"});return}chrome.scripting.executeScript({target:{tabId:s.id},func:i=>{console.debug("Script executing in tab context");function c(){return document.querySelector('div[role="textbox"][aria-label="Message Body"]')||document.querySelector('div[aria-label="Message body, press Alt+F10 to exit"]')}function d(p,v){document.execCommand("insertHTML",!1,v),console.debug("Inserted using execCommand fallback")}const m=c();if(m)console.debug("found composeBox: ",m);else{console.error("Compose box not found");return}try{m.focus(),navigator.clipboard&&navigator.clipboard.writeText?navigator.clipboard.writeText(i).then(()=>{document.execCommand("paste"),console.debug("Pasted using Clipboard API")}).catch(p=>{console.warn("Clipboard API failed, using fallback:",p),d(m,i)}):d(m,i)}catch(p){console.error("Error during paste operation:",p)}},args:[t]}).catch(i=>{e.error("Error executing script",i,{sourceFile:hb,functionName:"insertHtmlIntoComposeBoxLegacy"})})})}const _7="src/lib/types/Template.ts",Bk=async(r,e)=>{const t="GetTemplateWithContentFromServerTemplate";try{const n=r.source;if(!n)throw new Error("Source value is undefined");const s={...r,source:n};return{id:s.template_id,timeStamp:Date.now(),title:s.templateName,description:s.templateDescription,tags:s.tags||[],source:s.source==="SCOPE_USER"?"personal":"org",content:s.templateBody}}catch(n){throw e.error("Error getting template content",n,{sourceFile:_7,functionName:t,templateId:r.template_id}),n}},$l="src/lib/utils/templateUtils.tsx",Gk=async(r,e=!0)=>{const t="getAllTemplatesWithContent";try{const n=await Z6(r);r.debug("Templates from server",{sourceFile:$l,functionName:t,userCount:n.user_templates.length,orgCount:n.org_templates.length});const s=async v=>{const x="fetchPersonalTemplateWithErrorHandling";try{const b={...v,source:v.source||"SCOPE_USER"};return r.debug("Fetching personal template",{sourceFile:$l,functionName:x,templateId:b.template_id,scope:b.source}),await Bk(b,r)}catch(b){return r.error("Failed to load personal template",b,{sourceFile:$l,functionName:x,templateId:v.template_id}),null}},i=async v=>{const x="fetchOrgTemplateWithErrorHandling";try{const b={...v,source:v.source||"SCOPE_TENANT"};return r.debug("Fetching org template",{sourceFile:$l,functionName:x,templateId:b.template_id,scope:b.source}),await Bk(b,r)}catch(b){return r.error("Failed to load org template",b,{sourceFile:$l,functionName:x,templateId:v.template_id}),null}};let c=[];e&&(c=await Promise.all(n.user_templates.map(s)));const d=c.filter(Boolean),p=(await Promise.all(n.org_templates.map(i))).filter(Boolean);return r.info("Loaded templates",{sourceFile:$l,functionName:t,personalLoaded:d.length,personalTotal:n.user_templates.length,orgLoaded:p.length,orgTotal:n.org_templates.length}),e&&await jU(r,d),await OU(r,p),[...d,...p]}catch(n){r.error("Error in getAllTemplatesWithContent",n,{sourceFile:$l,functionName:t}),r.info("Falling back to cached templates from local storage",{sourceFile:$l,functionName:t});const s=await tT(r),i=await rT(r);return[...s,...i]}},S7=async r=>{const e="getTemplatesFromLocalStorage";try{const[t,n]=await Promise.all([tT(r),rT(r)]);return[...t,...n]}catch(t){return r.error("Error getting templates from local storage",t,{sourceFile:$l,functionName:e}),[]}};async function Wk(r,{signalType:e,signalValue:t}){localStorage.setItem(e,t);try{const s=(await Kn.createServices()).tabs;s.openOptionsPage?await s.openOptionsPage():r.error("Tabs provider does not support options page",new Error("Tabs provider does not support options page"),{sourceFile:"src/shared/lib/utils/optionsUtils.ts",sourceFunction:"openOrFocusOptionsPage"})}catch(n){r.error("Error opening options page",n,{sourceFile:"src/shared/lib/utils/optionsUtils.ts",sourceFunction:"openOrFocusOptionsPage"})}}const r0=({feature:r,description:e,benefits:t=[],className:n="",variant:s="card"})=>{const{isConnected:i,isLoading:c,error:d,status:m,initiateReconnection:p}=Di(),{platform:v}=dn();if(v!=="chrome"||i)return null;const x=async()=>{try{await p()}catch(N){console.error("Failed to reconnect Gmail:",N)}},b=()=>m==="loading"?u.jsx(si,{className:"h-5 w-5 text-blue-600 animate-spin"}):m==="error"?u.jsx(sh,{className:"h-5 w-5 text-red-600"}):u.jsx(Xc,{className:"h-5 w-5 text-amber-600"}),S=()=>m==="loading"?"Checking Gmail connection...":m==="error"?d||"Gmail connection error occurred":"Gmail connection required";return s==="banner"?u.jsxs("div",{className:`flex items-center justify-between bg-amber-50 border border-amber-200 px-4 py-3 rounded-lg ${n}`,children:[u.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[b(),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("p",{className:"text-sm font-medium text-amber-800",children:S()}),u.jsx("p",{className:"text-sm text-amber-700 mt-1",children:e||`Connect Gmail to access ${r} features.`})]})]}),u.jsx(We,{onClick:x,disabled:c,variant:"outline",size:"sm",className:"bg-amber-100 border-amber-300 text-amber-800 hover:bg-amber-200 hover:border-amber-400 whitespace-nowrap ml-4",children:c?u.jsxs(u.Fragment,{children:[u.jsx(si,{className:"h-4 w-4 mr-2 animate-spin"}),"Connecting..."]}):"Connect Gmail"})]}):s==="inline"?u.jsxs("div",{className:`flex items-center gap-2 text-amber-700 ${n}`,children:[b(),u.jsx("span",{className:"text-sm",children:S()}),u.jsx(We,{onClick:x,disabled:c,variant:"link",size:"sm",className:"h-auto p-0 text-amber-700 hover:text-amber-800",children:"Connect Gmail"})]}):u.jsx(Ss,{className:`${n}`,children:u.jsx(Es,{className:"p-6",children:u.jsxs("div",{className:"flex items-start gap-4",children:[u.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-amber-100 rounded-full flex items-center justify-center",children:b()}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("h3",{className:"text-base font-semibold text-gray-900 mb-2",children:"Gmail Connection Required"}),u.jsx("p",{className:"text-gray-600 mb-4",children:e||`To access ${r}, you need to connect your Gmail account first.`}),t.length>0&&u.jsxs("div",{className:"mb-4",children:[u.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"What you'll get with Gmail connected:"}),u.jsx("ul",{className:"text-sm text-gray-600 space-y-1",children:t.map((N,E)=>u.jsxs("li",{className:"flex items-start gap-2",children:[u.jsx(ad,{className:"h-4 w-4 text-green-600 mt-0.5 flex-shrink-0"}),u.jsx("span",{children:N})]},E))})]}),d&&u.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-3 mb-4",children:u.jsx("p",{className:"text-sm text-red-800",children:d})}),u.jsx("div",{className:"flex items-center gap-3",children:u.jsx(We,{onClick:x,disabled:c,className:"bg-blue-600 hover:bg-blue-700",children:c?u.jsxs(u.Fragment,{children:[u.jsx(si,{className:"h-4 w-4 mr-2 animate-spin"}),"Connecting..."]}):u.jsxs(u.Fragment,{children:[u.jsx(Xc,{className:"h-4 w-4 mr-2"}),"Connect Gmail"]})})})]})]})})})},oo="src/sidepanel/panels/TemplatesPanel.tsx",E7=({clientEmail:r,isAuthenticated:e})=>{const t=Gr(),{platform:n}=dn(),{isConnected:s}=Di(),[i,c]=w.useState(""),[d,m]=w.useState([]),[p,v]=w.useState(!1),[x,b]=w.useState([]),[S,N]=w.useState([]),[E,T]=w.useState("all"),[A,R]=w.useState([]),[F,j]=w.useState(!0),[L,G]=w.useState(!1),[z,q]=w.useState(null),ae=w.useRef(null),oe=w.useRef(null);w.useEffect(()=>{function U(re){p&&ae.current&&!ae.current.contains(re.target)&&oe.current&&!oe.current.contains(re.target)&&v(!1)}return document.addEventListener("mousedown",U),()=>{document.removeEventListener("mousedown",U)}},[p]),w.useEffect(()=>{function U(re){z&&!re.target.closest("[data-radix-hover-card-content]")&&q(null)}return z&&document.addEventListener("mousedown",U),()=>{document.removeEventListener("mousedown",U)}},[z]),w.useEffect(()=>{if(A.length>0){const U=A.filter(re=>{var Ee,ne,we,K,he;return(E==="all"||E==="org"&&re.source==="org"||E==="personal"&&re.source!=="org")&&(((Ee=re.title)==null?void 0:Ee.toLowerCase().includes(i.toLowerCase()))||((ne=re.content)==null?void 0:ne.toLowerCase().includes(i.toLowerCase()))||((we=re.tags)==null?void 0:we.some(be=>be.toLowerCase().includes(i.toLowerCase())))||((K=re.description)==null?void 0:K.toLowerCase().includes(i.toLowerCase())))&&(x.length===0||((he=re.tags)==null?void 0:he.some(be=>x.includes(be))))});if(i.trim()){const re=U.sort((Ee,ne)=>{const we=i.toLowerCase(),K=Ie=>{var _t,Be,Ge,qe;return(_t=Ie.tags)!=null&&_t.some(Ne=>Ne.toLowerCase().includes(we))?1:(Be=Ie.title)!=null&&Be.toLowerCase().includes(we)?2:(Ge=Ie.description)!=null&&Ge.toLowerCase().includes(we)?3:(qe=Ie.content)!=null&&qe.toLowerCase().includes(we)?4:5},he=K(Ee),be=K(ne);return he!==be?he-be:(Ee.title||"").localeCompare(ne.title||"")});m(re)}else m(U)}},[A,i,x,E]),w.useEffect(()=>{if(!e){t.debug("Skipping template loading - user not authenticated",{sourceFile:oo,isAuthenticated:e});return}const U=async()=>{j(!0);const re="loadTemplatesDirectly";try{t.info("Loading templates directly from server (like options page)",{sourceFile:oo,functionName:re});const Ee=await Gk(t,!0);if(Ee.length>0){t.info("Templates loaded successfully",{sourceFile:oo,functionName:re,count:Ee.length}),R(Ee);const ne=await iy(t);let we=[];ne.id!==""&&(we=ne.templateConfiguration.tags||[]);const K=new Set(we);Ee.forEach(he=>{he.tags&&Array.isArray(he.tags)&&he.tags.forEach(be=>K.add(be))}),N(Array.from(K))}else t.info("No templates found!",{sourceFile:oo,functionName:re}),R([])}catch(Ee){t.error("Error loading templates directly from server",Ee,{sourceFile:oo,functionName:re});try{const ne=await S7(t);t.info("Fallback to local storage successful",{sourceFile:oo,functionName:re,count:ne.length}),R(ne)}catch(ne){t.error("Fallback to local storage also failed",ne,{sourceFile:oo,functionName:re}),R([])}}finally{j(!1)}};t.info("TemplatesPanel initialized, loading templates directly from server",{sourceFile:oo,isAuthenticated:e}),U()},[t,e]);const fe=w.useCallback(async()=>{if(L)return;G(!0);const U="refreshTemplates";t.info("Starting template refresh from server",{sourceFile:oo,functionName:U});try{const re=await iy(t);let Ee=[];re.id!==""?(t.debug("configuration loaded from storage",{sourceFile:oo,functionName:U,config:re}),Ee=re.templateConfiguration.tags||[]):t.warn("No configuration found in storage",{sourceFile:oo,functionName:U}),t.info("Calling getAllTemplatesWithContent",{sourceFile:oo,functionName:U});const ne=await Gk(t,!0);t.info("getAllTemplatesWithContent completed",{sourceFile:oo,functionName:U,templateCount:ne.length});const we=new Set(Ee);ne.forEach(he=>{he.tags&&Array.isArray(he.tags)&&he.tags.forEach(be=>we.add(be))});const K=Array.from(we);t.info("Template refresh successful",{sourceFile:oo,functionName:U,templateCount:ne.length,tagsCount:K.length,templates:ne.map(he=>({title:he.title,tags:he.tags,source:he.source}))}),N(K),R(ne)}catch(re){t.error("Error refreshing templates from server",re,{sourceFile:oo,functionName:U}),console.error("Template loading failed:",re)}finally{G(!1)}},[L,t]),H=()=>{v(!p)},me=U=>{b(re=>re.includes(U)?re.filter(Ee=>Ee!==U):[...re,U])},ee=U=>{q(re=>re===U?null:U)},[se,de]=w.useState(!1),Y=w.useRef(null),J=w.useRef(null);w.useEffect(()=>{function U(re){se&&Y.current&&!Y.current.contains(re.target)&&J.current&&!J.current.contains(re.target)&&de(!1)}return document.addEventListener("mousedown",U),()=>{document.removeEventListener("mousedown",U)}},[se]);const $=()=>{de(!se)},X=U=>{T(U),de(!1)};return n==="chrome"&&!s?u.jsx("div",{className:"p-4",children:u.jsx(r0,{feature:"Templates",description:"Connect your Gmail account to access and insert email templates",benefits:["Access all your personal and organization templates","Insert template content directly into compose box","Search and filter templates by tags and content"]})}):u.jsxs("div",{className:"space-y-4 h-full",children:[u.jsxs("div",{className:"relative",children:[u.jsx(vn,{type:"text",placeholder:"Search templates...",value:i,onChange:U=>c(U.target.value),className:"pl-10 pr-12"}),u.jsx(Ri,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:18}),u.jsx(We,{ref:oe,variant:"outline",className:"absolute right-0 top-1/2 transform -translate-y-1/2",onClick:H,children:u.jsx(Yx,{})}),p&&u.jsx("div",{ref:ae,className:"absolute right-0 mt-2 w-48 bg-white dark:bg-card border dark:border-border rounded shadow-lg z-10",children:S.length>0?S.map(U=>u.jsxs("label",{className:"block px-4 py-2 hover:bg-gray-50 dark:hover:bg-muted cursor-pointer text-gray-900 dark:text-gray-200",children:[u.jsx("input",{type:"checkbox",className:"mr-2",checked:x.includes(U),onChange:()=>me(U)}),U]},U)):u.jsx("div",{className:"px-4 py-2 text-gray-500",children:"No tags available"})})]}),u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"relative",children:[u.jsxs(We,{ref:J,variant:"outline",size:"sm",onClick:$,className:"flex items-center hover:bg-blue-50",children:[E==="all"&&u.jsxs(u.Fragment,{children:[u.jsx(Yx,{className:"mr-2 h-4 w-4"}),"All Templates (",d.length,")"]}),E==="personal"&&u.jsxs(u.Fragment,{children:[u.jsx(Ey,{className:"mr-2 h-4 w-4"}),"Personal Only (",d.length,")"]}),E==="org"&&u.jsxs(u.Fragment,{children:[u.jsx(Kx,{className:"mr-2 h-4 w-4"}),"Org Only (",d.length,")"]})]}),se&&u.jsxs("div",{ref:Y,className:"absolute left-0 mt-1 w-40 bg-white dark:bg-card border dark:border-border rounded shadow-lg z-10",children:[E!=="all"&&u.jsxs("div",{className:"px-4 py-2 hover:bg-gray-50 dark:hover:bg-muted cursor-pointer flex items-center text-gray-900 dark:text-gray-200",onClick:()=>X("all"),children:[u.jsx(Yx,{className:"mr-2 h-4 w-4"}),"All Templates"]}),E!=="personal"&&u.jsxs("div",{className:"px-4 py-2 hover:bg-gray-50 dark:hover:bg-muted cursor-pointer flex items-center text-gray-900 dark:text-gray-200",onClick:()=>X("personal"),children:[u.jsx(Ey,{className:"mr-2 h-4 w-4"}),"Personal Only"]}),E!=="org"&&A.filter(U=>U.source==="org").length>0&&u.jsxs("div",{className:"px-4 py-2 hover:bg-gray-50 dark:hover:bg-muted cursor-pointer flex items-center text-gray-900 dark:text-gray-200",onClick:()=>X("org"),children:[u.jsx(Kx,{className:"mr-2 h-4 w-4"}),"Org Only"]})]})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(We,{size:"icon",className:"rounded-lg bg-blue-600 text-white hover:bg-blue-700 hover:text-white dark:bg-blue-600 dark:text-white dark:hover:bg-blue-700 border border-blue-600 dark:border-blue-600",title:"Add Template",onClick:()=>{Wk(t,{signalType:"openCreateTemplate",signalValue:"true"})},children:u.jsx(oB,{className:"w-5 h-5"})}),u.jsx(We,{variant:"outline",size:"icon",className:"rounded-lg hover:bg-blue-50",title:"Refresh Templates",onClick:fe,disabled:L||F,children:u.jsx(si,{className:`w-5 h-5 ${L?"animate-spin":""}`})})]})]}),F?u.jsxs("div",{className:"flex justify-center items-center py-12",children:[u.jsx(ia,{className:"h-8 w-8 animate-spin text-blue-600"}),u.jsx("span",{className:"ml-2 text-gray-600",children:"Loading templates..."})]}):u.jsxs("div",{className:"overflow-y-auto h-full pb-2",children:[d.map(U=>u.jsxs(Ss,{className:"animate-fadeIn relative mb-2",children:[u.jsxs(uo,{children:[u.jsx(fo,{className:"text-sm flex items-center",children:U.title}),U.tags&&U.tags.length>0&&u.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:U.tags.map((re,Ee)=>u.jsx("span",{className:"inline-block bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full",children:re},Ee))})]}),u.jsxs(Es,{children:[u.jsx("p",{className:"text-xs mb-2 overflow-hidden text-ellipsis max-h-[50px]",children:U.description}),u.jsxs("div",{className:"flex space-x-2",children:[u.jsx(We,{className:"flex-1 text-xs py-1 bg-blue-600 text-white hover:bg-blue-700 hover:text-white dark:bg-blue-600 dark:text-white dark:hover:bg-blue-700 w-1/2 border border-blue-600 dark:border-blue-600",onClick:()=>{vS(U.content,t)},children:u.jsxs("span",{className:"flex items-center justify-center w-full",children:[u.jsx(QA,{className:"w-4 h-4 flex-shrink-0 mr-1 rotate-90"}),u.jsx("span",{className:"hide-text-when-narrow",children:"Insert"})]})}),u.jsxs(v7,{open:z===U.id?!0:void 0,onOpenChange:re=>{!re&&z===U.id&&q(null)},openDelay:0,closeDelay:100,children:[u.jsx(y7,{asChild:!0,children:u.jsx(We,{variant:"outline",className:`text-xs py-1 bg-white dark:bg-card text-black dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-muted hover:text-blue-600 dark:hover:text-blue-400 w-1/4 ${z===U.id?"bg-gray-100 dark:bg-muted text-blue-600 dark:text-blue-400":""}`,onClick:re=>{re.preventDefault(),ee(U.id)},children:u.jsxs("span",{className:"flex items-center justify-center w-full",children:[u.jsx(lB,{className:"w-4 h-4 flex-shrink-0 mr-1"}),u.jsx("span",{className:"hide-text-when-narrow",children:"View"})]})})}),u.jsxs(x7,{className:"bg-white dark:bg-card border-2 mt-8 mr-8 border-gray-200 dark:border-border rounded-md text-gray-700 dark:text-gray-200 p-4 z-50 overflow-auto",align:"center",side:"top",style:{maxHeight:"40vh",maxWidth:"80vw",width:"auto",height:"auto",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.15)"},children:[u.jsx("div",{dangerouslySetInnerHTML:{__html:U.content}}),u.jsx(w7,{className:"fill-blue-500"})]})]}),U.source==="org"?u.jsx("div",{className:"w-1/4 flex items-center",title:"Organization templates can only be edited by an admin.",children:u.jsxs("span",{className:"text-xs py-1 px-2 bg-blue-100 text-blue-800 border border-blue-300 flex items-center justify-center w-full rounded-full",children:[u.jsx(Kx,{className:"w-4 h-4 flex-shrink-0 mr-1"}),u.jsx("span",{className:"hide-text-when-narrow",children:"Org"})]})}):u.jsx(We,{variant:"outline",className:"text-xs py-1 bg-white dark:bg-card text-black dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-muted w-1/4",title:"Edit Template",onClick:()=>{Wk(t,{signalType:"editTemplateId",signalValue:U.id})},children:u.jsxs("span",{className:"flex items-center justify-center w-full",children:[u.jsx(gB,{className:"w-4 h-4 flex-shrink-0 mr-1"}),u.jsx("span",{className:"hide-text-when-narrow",children:"Edit"})]})})]})]})]},U.id)),d.length===0&&u.jsxs("div",{className:"mt-8 text-center text-gray-500",children:[u.jsx("p",{children:"No templates found matching your criteria."}),u.jsx("p",{className:"text-sm mt-2",children:"Try adjusting your filters or search terms."})]})]})]})},Ai=({src:r,width:e,height:t,alt:n,className:s})=>{const i=r.startsWith("/")?`${GN}${r}`:r;return u.jsx("img",{src:i,width:e,height:t,alt:n,className:s})},ih=({options:r,value:e,onChange:t})=>u.jsx("div",{className:"flex rounded-md shadow-sm",role:"radiogroup",children:r.map(n=>u.jsx(We,{role:"radio","aria-checked":e===n,variant:e===n?"default":"outline",className:`flex-1 text-xs ${e===n?"":"text-muted-foreground"}`,onClick:()=>t(n),children:n},n))});/*! @license DOMPurify 3.3.1 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.1/LICENSE */const{entries:OR,setPrototypeOf:Vk,isFrozen:C7,getPrototypeOf:k7,getOwnPropertyDescriptor:N7}=Object;let{freeze:ho,seal:ji,create:pb}=Object,{apply:mb,construct:gb}=typeof Reflect<"u"&&Reflect;ho||(ho=function(e){return e});ji||(ji=function(e){return e});mb||(mb=function(e,t){for(var n=arguments.length,s=new Array(n>2?n-2:0),i=2;i<n;i++)s[i-2]=arguments[i];return e.apply(t,s)});gb||(gb=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];return new e(...n)});const Fv=po(Array.prototype.forEach),T7=po(Array.prototype.lastIndexOf),qk=po(Array.prototype.pop),em=po(Array.prototype.push),A7=po(Array.prototype.splice),Jv=po(String.prototype.toLowerCase),Zx=po(String.prototype.toString),ew=po(String.prototype.match),tm=po(String.prototype.replace),R7=po(String.prototype.indexOf),I7=po(String.prototype.trim),sa=po(Object.prototype.hasOwnProperty),io=po(RegExp.prototype.test),rm=P7(TypeError);function po(r){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];return mb(r,e,n)}}function P7(r){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return gb(r,t)}}function cr(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Jv;Vk&&Vk(r,null);let n=e.length;for(;n--;){let s=e[n];if(typeof s=="string"){const i=t(s);i!==s&&(C7(e)||(e[n]=i),s=i)}r[s]=!0}return r}function F7(r){for(let e=0;e<r.length;e++)sa(r,e)||(r[e]=null);return r}function za(r){const e=pb(null);for(const[t,n]of OR(r))sa(r,t)&&(Array.isArray(n)?e[t]=F7(n):n&&typeof n=="object"&&n.constructor===Object?e[t]=za(n):e[t]=n);return e}function nm(r,e){for(;r!==null;){const n=N7(r,e);if(n){if(n.get)return po(n.get);if(typeof n.value=="function")return po(n.value)}r=k7(r)}function t(){return null}return t}const Kk=ho(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),tw=ho(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),rw=ho(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),j7=ho(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),nw=ho(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),O7=ho(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Yk=ho(["#text"]),Jk=ho(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),sw=ho(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Xk=ho(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),jv=ho(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),D7=ji(/\{\{[\w\W]*|[\w\W]*\}\}/gm),L7=ji(/<%[\w\W]*|[\w\W]*%>/gm),M7=ji(/\$\{[\w\W]*/gm),$7=ji(/^data-[\-\w.\u00B7-\uFFFF]+$/),U7=ji(/^aria-[\-\w]+$/),DR=ji(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),z7=ji(/^(?:\w+script|data):/i),H7=ji(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),LR=ji(/^html$/i),B7=ji(/^[a-z][.\w]*(-[.\w]+)+$/i);var Qk=Object.freeze({__proto__:null,ARIA_ATTR:U7,ATTR_WHITESPACE:H7,CUSTOM_ELEMENT:B7,DATA_ATTR:$7,DOCTYPE_NAME:LR,ERB_EXPR:L7,IS_ALLOWED_URI:DR,IS_SCRIPT_OR_DATA:z7,MUSTACHE_EXPR:D7,TMPLIT_EXPR:M7});const sm={element:1,text:3,progressingInstruction:7,comment:8,document:9},G7=function(){return typeof window>"u"?null:window},W7=function(e,t){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let n=null;const s="data-tt-policy-suffix";t&&t.hasAttribute(s)&&(n=t.getAttribute(s));const i="dompurify"+(n?"#"+n:"");try{return e.createPolicy(i,{createHTML(c){return c},createScriptURL(c){return c}})}catch{return console.warn("TrustedTypes policy "+i+" could not be created."),null}},Zk=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function MR(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:G7();const e=at=>MR(at);if(e.version="3.3.1",e.removed=[],!r||!r.document||r.document.nodeType!==sm.document||!r.Element)return e.isSupported=!1,e;let{document:t}=r;const n=t,s=n.currentScript,{DocumentFragment:i,HTMLTemplateElement:c,Node:d,Element:m,NodeFilter:p,NamedNodeMap:v=r.NamedNodeMap||r.MozNamedAttrMap,HTMLFormElement:x,DOMParser:b,trustedTypes:S}=r,N=m.prototype,E=nm(N,"cloneNode"),T=nm(N,"remove"),A=nm(N,"nextSibling"),R=nm(N,"childNodes"),F=nm(N,"parentNode");if(typeof c=="function"){const at=t.createElement("template");at.content&&at.content.ownerDocument&&(t=at.content.ownerDocument)}let j,L="";const{implementation:G,createNodeIterator:z,createDocumentFragment:q,getElementsByTagName:ae}=t,{importNode:oe}=n;let fe=Zk();e.isSupported=typeof OR=="function"&&typeof F=="function"&&G&&G.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:H,ERB_EXPR:me,TMPLIT_EXPR:ee,DATA_ATTR:se,ARIA_ATTR:de,IS_SCRIPT_OR_DATA:Y,ATTR_WHITESPACE:J,CUSTOM_ELEMENT:$}=Qk;let{IS_ALLOWED_URI:X}=Qk,O=null;const U=cr({},[...Kk,...tw,...rw,...nw,...Yk]);let re=null;const Ee=cr({},[...Jk,...sw,...Xk,...jv]);let ne=Object.seal(pb(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),we=null,K=null;const he=Object.seal(pb(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let be=!0,Ie=!0,_t=!1,Be=!0,Ge=!1,qe=!0,Ne=!1,St=!1,ct=!1,Ct=!1,Gt=!1,$t=!1,Kt=!0,hr=!1;const Ur="user-content-";let zr=!0,kr=!1,ge={},Pe=null;const pt=cr({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let wt=null;const ze=cr({},["audio","video","img","source","image","track"]);let He=null;const rt=cr({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Re="http://www.w3.org/1998/Math/MathML",ft="http://www.w3.org/2000/svg",Mt="http://www.w3.org/1999/xhtml";let Ue=Mt,rr=!1,kt=null;const vr=cr({},[Re,ft,Mt],Zx);let nr=cr({},["mi","mo","mn","ms","mtext"]),Jt=cr({},["annotation-xml"]);const $n=cr({},["title","style","font","a","script"]);let Un=null;const Gs=["application/xhtml+xml","text/html"],Cs="text/html";let Tr=null,yn=null;const go=t.createElement("form"),Mo=function(Q){return Q instanceof RegExp||Q instanceof Function},En=function(){let Q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(yn&&yn===Q)){if((!Q||typeof Q!="object")&&(Q={}),Q=za(Q),Un=Gs.indexOf(Q.PARSER_MEDIA_TYPE)===-1?Cs:Q.PARSER_MEDIA_TYPE,Tr=Un==="application/xhtml+xml"?Zx:Jv,O=sa(Q,"ALLOWED_TAGS")?cr({},Q.ALLOWED_TAGS,Tr):U,re=sa(Q,"ALLOWED_ATTR")?cr({},Q.ALLOWED_ATTR,Tr):Ee,kt=sa(Q,"ALLOWED_NAMESPACES")?cr({},Q.ALLOWED_NAMESPACES,Zx):vr,He=sa(Q,"ADD_URI_SAFE_ATTR")?cr(za(rt),Q.ADD_URI_SAFE_ATTR,Tr):rt,wt=sa(Q,"ADD_DATA_URI_TAGS")?cr(za(ze),Q.ADD_DATA_URI_TAGS,Tr):ze,Pe=sa(Q,"FORBID_CONTENTS")?cr({},Q.FORBID_CONTENTS,Tr):pt,we=sa(Q,"FORBID_TAGS")?cr({},Q.FORBID_TAGS,Tr):za({}),K=sa(Q,"FORBID_ATTR")?cr({},Q.FORBID_ATTR,Tr):za({}),ge=sa(Q,"USE_PROFILES")?Q.USE_PROFILES:!1,be=Q.ALLOW_ARIA_ATTR!==!1,Ie=Q.ALLOW_DATA_ATTR!==!1,_t=Q.ALLOW_UNKNOWN_PROTOCOLS||!1,Be=Q.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Ge=Q.SAFE_FOR_TEMPLATES||!1,qe=Q.SAFE_FOR_XML!==!1,Ne=Q.WHOLE_DOCUMENT||!1,Ct=Q.RETURN_DOM||!1,Gt=Q.RETURN_DOM_FRAGMENT||!1,$t=Q.RETURN_TRUSTED_TYPE||!1,ct=Q.FORCE_BODY||!1,Kt=Q.SANITIZE_DOM!==!1,hr=Q.SANITIZE_NAMED_PROPS||!1,zr=Q.KEEP_CONTENT!==!1,kr=Q.IN_PLACE||!1,X=Q.ALLOWED_URI_REGEXP||DR,Ue=Q.NAMESPACE||Mt,nr=Q.MATHML_TEXT_INTEGRATION_POINTS||nr,Jt=Q.HTML_INTEGRATION_POINTS||Jt,ne=Q.CUSTOM_ELEMENT_HANDLING||{},Q.CUSTOM_ELEMENT_HANDLING&&Mo(Q.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(ne.tagNameCheck=Q.CUSTOM_ELEMENT_HANDLING.tagNameCheck),Q.CUSTOM_ELEMENT_HANDLING&&Mo(Q.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(ne.attributeNameCheck=Q.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),Q.CUSTOM_ELEMENT_HANDLING&&typeof Q.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(ne.allowCustomizedBuiltInElements=Q.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Ge&&(Ie=!1),Gt&&(Ct=!0),ge&&(O=cr({},Yk),re=[],ge.html===!0&&(cr(O,Kk),cr(re,Jk)),ge.svg===!0&&(cr(O,tw),cr(re,sw),cr(re,jv)),ge.svgFilters===!0&&(cr(O,rw),cr(re,sw),cr(re,jv)),ge.mathMl===!0&&(cr(O,nw),cr(re,Xk),cr(re,jv))),Q.ADD_TAGS&&(typeof Q.ADD_TAGS=="function"?he.tagCheck=Q.ADD_TAGS:(O===U&&(O=za(O)),cr(O,Q.ADD_TAGS,Tr))),Q.ADD_ATTR&&(typeof Q.ADD_ATTR=="function"?he.attributeCheck=Q.ADD_ATTR:(re===Ee&&(re=za(re)),cr(re,Q.ADD_ATTR,Tr))),Q.ADD_URI_SAFE_ATTR&&cr(He,Q.ADD_URI_SAFE_ATTR,Tr),Q.FORBID_CONTENTS&&(Pe===pt&&(Pe=za(Pe)),cr(Pe,Q.FORBID_CONTENTS,Tr)),Q.ADD_FORBID_CONTENTS&&(Pe===pt&&(Pe=za(Pe)),cr(Pe,Q.ADD_FORBID_CONTENTS,Tr)),zr&&(O["#text"]=!0),Ne&&cr(O,["html","head","body"]),O.table&&(cr(O,["tbody"]),delete we.tbody),Q.TRUSTED_TYPES_POLICY){if(typeof Q.TRUSTED_TYPES_POLICY.createHTML!="function")throw rm('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof Q.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw rm('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');j=Q.TRUSTED_TYPES_POLICY,L=j.createHTML("")}else j===void 0&&(j=W7(S,s)),j!==null&&typeof L=="string"&&(L=j.createHTML(""));ho&&ho(Q),yn=Q}},Ws=cr({},[...tw,...rw,...j7]),Vs=cr({},[...nw,...O7]),Li=function(Q){let Le=F(Q);(!Le||!Le.tagName)&&(Le={namespaceURI:Ue,tagName:"template"});const nt=Jv(Q.tagName),Fr=Jv(Le.tagName);return kt[Q.namespaceURI]?Q.namespaceURI===ft?Le.namespaceURI===Mt?nt==="svg":Le.namespaceURI===Re?nt==="svg"&&(Fr==="annotation-xml"||nr[Fr]):!!Ws[nt]:Q.namespaceURI===Re?Le.namespaceURI===Mt?nt==="math":Le.namespaceURI===ft?nt==="math"&&Jt[Fr]:!!Vs[nt]:Q.namespaceURI===Mt?Le.namespaceURI===ft&&!Jt[Fr]||Le.namespaceURI===Re&&!nr[Fr]?!1:!Vs[nt]&&($n[nt]||!Ws[nt]):!!(Un==="application/xhtml+xml"&&kt[Q.namespaceURI]):!1},cn=function(Q){em(e.removed,{element:Q});try{F(Q).removeChild(Q)}catch{T(Q)}},ce=function(Q,Le){try{em(e.removed,{attribute:Le.getAttributeNode(Q),from:Le})}catch{em(e.removed,{attribute:null,from:Le})}if(Le.removeAttribute(Q),Q==="is")if(Ct||Gt)try{cn(Le)}catch{}else try{Le.setAttribute(Q,"")}catch{}},Ve=function(Q){let Le=null,nt=null;if(ct)Q="<remove></remove>"+Q;else{const Wr=ew(Q,/^[\r\n\t ]+/);nt=Wr&&Wr[0]}Un==="application/xhtml+xml"&&Ue===Mt&&(Q='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+Q+"</body></html>");const Fr=j?j.createHTML(Q):Q;if(Ue===Mt)try{Le=new b().parseFromString(Fr,Un)}catch{}if(!Le||!Le.documentElement){Le=G.createDocument(Ue,"template",null);try{Le.documentElement.innerHTML=rr?L:Fr}catch{}}const Yt=Le.body||Le.documentElement;return Q&&nt&&Yt.insertBefore(t.createTextNode(nt),Yt.childNodes[0]||null),Ue===Mt?ae.call(Le,Ne?"html":"body")[0]:Ne?Le.documentElement:Yt},gt=function(Q){return z.call(Q.ownerDocument||Q,Q,p.SHOW_ELEMENT|p.SHOW_COMMENT|p.SHOW_TEXT|p.SHOW_PROCESSING_INSTRUCTION|p.SHOW_CDATA_SECTION,null)},mt=function(Q){return Q instanceof x&&(typeof Q.nodeName!="string"||typeof Q.textContent!="string"||typeof Q.removeChild!="function"||!(Q.attributes instanceof v)||typeof Q.removeAttribute!="function"||typeof Q.setAttribute!="function"||typeof Q.namespaceURI!="string"||typeof Q.insertBefore!="function"||typeof Q.hasChildNodes!="function")},ut=function(Q){return typeof d=="function"&&Q instanceof d};function yt(at,Q,Le){Fv(at,nt=>{nt.call(e,Q,Le,yn)})}const ht=function(Q){let Le=null;if(yt(fe.beforeSanitizeElements,Q,null),mt(Q))return cn(Q),!0;const nt=Tr(Q.nodeName);if(yt(fe.uponSanitizeElement,Q,{tagName:nt,allowedTags:O}),qe&&Q.hasChildNodes()&&!ut(Q.firstElementChild)&&io(/<[/\w!]/g,Q.innerHTML)&&io(/<[/\w!]/g,Q.textContent)||Q.nodeType===sm.progressingInstruction||qe&&Q.nodeType===sm.comment&&io(/<[/\w]/g,Q.data))return cn(Q),!0;if(!(he.tagCheck instanceof Function&&he.tagCheck(nt))&&(!O[nt]||we[nt])){if(!we[nt]&&Yn(nt)&&(ne.tagNameCheck instanceof RegExp&&io(ne.tagNameCheck,nt)||ne.tagNameCheck instanceof Function&&ne.tagNameCheck(nt)))return!1;if(zr&&!Pe[nt]){const Fr=F(Q)||Q.parentNode,Yt=R(Q)||Q.childNodes;if(Yt&&Fr){const Wr=Yt.length;for(let fn=Wr-1;fn>=0;--fn){const ls=E(Yt[fn],!0);ls.__removalCount=(Q.__removalCount||0)+1,Fr.insertBefore(ls,A(Q))}}}return cn(Q),!0}return Q instanceof m&&!Li(Q)||(nt==="noscript"||nt==="noembed"||nt==="noframes")&&io(/<\/no(script|embed|frames)/i,Q.innerHTML)?(cn(Q),!0):(Ge&&Q.nodeType===sm.text&&(Le=Q.textContent,Fv([H,me,ee],Fr=>{Le=tm(Le,Fr," ")}),Q.textContent!==Le&&(em(e.removed,{element:Q.cloneNode()}),Q.textContent=Le)),yt(fe.afterSanitizeElements,Q,null),!1)},Xt=function(Q,Le,nt){if(Kt&&(Le==="id"||Le==="name")&&(nt in t||nt in go))return!1;if(!(Ie&&!K[Le]&&io(se,Le))){if(!(be&&io(de,Le))){if(!(he.attributeCheck instanceof Function&&he.attributeCheck(Le,Q))){if(!re[Le]||K[Le]){if(!(Yn(Q)&&(ne.tagNameCheck instanceof RegExp&&io(ne.tagNameCheck,Q)||ne.tagNameCheck instanceof Function&&ne.tagNameCheck(Q))&&(ne.attributeNameCheck instanceof RegExp&&io(ne.attributeNameCheck,Le)||ne.attributeNameCheck instanceof Function&&ne.attributeNameCheck(Le,Q))||Le==="is"&&ne.allowCustomizedBuiltInElements&&(ne.tagNameCheck instanceof RegExp&&io(ne.tagNameCheck,nt)||ne.tagNameCheck instanceof Function&&ne.tagNameCheck(nt))))return!1}else if(!He[Le]){if(!io(X,tm(nt,J,""))){if(!((Le==="src"||Le==="xlink:href"||Le==="href")&&Q!=="script"&&R7(nt,"data:")===0&&wt[Q])){if(!(_t&&!io(Y,tm(nt,J,"")))){if(nt)return!1}}}}}}}return!0},Yn=function(Q){return Q!=="annotation-xml"&&ew(Q,$)},Qr=function(Q){yt(fe.beforeSanitizeAttributes,Q,null);const{attributes:Le}=Q;if(!Le||mt(Q))return;const nt={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:re,forceKeepAttr:void 0};let Fr=Le.length;for(;Fr--;){const Yt=Le[Fr],{name:Wr,namespaceURI:fn,value:ls}=Yt,ks=Tr(Wr),Mi=ls;let Vr=Wr==="value"?Mi:I7(Mi);if(nt.attrName=ks,nt.attrValue=Vr,nt.keepAttr=!0,nt.forceKeepAttr=void 0,yt(fe.uponSanitizeAttribute,Q,nt),Vr=nt.attrValue,hr&&(ks==="id"||ks==="name")&&(ce(Wr,Q),Vr=Ur+Vr),qe&&io(/((--!?|])>)|<\/(style|title|textarea)/i,Vr)){ce(Wr,Q);continue}if(ks==="attributename"&&ew(Vr,"href")){ce(Wr,Q);continue}if(nt.forceKeepAttr)continue;if(!nt.keepAttr){ce(Wr,Q);continue}if(!Be&&io(/\/>/i,Vr)){ce(Wr,Q);continue}Ge&&Fv([H,me,ee],Jn=>{Vr=tm(Vr,Jn," ")});const $o=Tr(Q.nodeName);if(!Xt($o,ks,Vr)){ce(Wr,Q);continue}if(j&&typeof S=="object"&&typeof S.getAttributeType=="function"&&!fn)switch(S.getAttributeType($o,ks)){case"TrustedHTML":{Vr=j.createHTML(Vr);break}case"TrustedScriptURL":{Vr=j.createScriptURL(Vr);break}}if(Vr!==Mi)try{fn?Q.setAttributeNS(fn,Wr,Vr):Q.setAttribute(Wr,Vr),mt(Q)?cn(Q):qk(e.removed)}catch{ce(Wr,Q)}}yt(fe.afterSanitizeAttributes,Q,null)},ur=function at(Q){let Le=null;const nt=gt(Q);for(yt(fe.beforeSanitizeShadowDOM,Q,null);Le=nt.nextNode();)yt(fe.uponSanitizeShadowNode,Le,null),ht(Le),Qr(Le),Le.content instanceof i&&at(Le.content);yt(fe.afterSanitizeShadowDOM,Q,null)};return e.sanitize=function(at){let Q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Le=null,nt=null,Fr=null,Yt=null;if(rr=!at,rr&&(at="<!-->"),typeof at!="string"&&!ut(at))if(typeof at.toString=="function"){if(at=at.toString(),typeof at!="string")throw rm("dirty is not a string, aborting")}else throw rm("toString is not a function");if(!e.isSupported)return at;if(St||En(Q),e.removed=[],typeof at=="string"&&(kr=!1),kr){if(at.nodeName){const ls=Tr(at.nodeName);if(!O[ls]||we[ls])throw rm("root node is forbidden and cannot be sanitized in-place")}}else if(at instanceof d)Le=Ve("<!---->"),nt=Le.ownerDocument.importNode(at,!0),nt.nodeType===sm.element&&nt.nodeName==="BODY"||nt.nodeName==="HTML"?Le=nt:Le.appendChild(nt);else{if(!Ct&&!Ge&&!Ne&&at.indexOf("<")===-1)return j&&$t?j.createHTML(at):at;if(Le=Ve(at),!Le)return Ct?null:$t?L:""}Le&&ct&&cn(Le.firstChild);const Wr=gt(kr?at:Le);for(;Fr=Wr.nextNode();)ht(Fr),Qr(Fr),Fr.content instanceof i&&ur(Fr.content);if(kr)return at;if(Ct){if(Gt)for(Yt=q.call(Le.ownerDocument);Le.firstChild;)Yt.appendChild(Le.firstChild);else Yt=Le;return(re.shadowroot||re.shadowrootmode)&&(Yt=oe.call(n,Yt,!0)),Yt}let fn=Ne?Le.outerHTML:Le.innerHTML;return Ne&&O["!doctype"]&&Le.ownerDocument&&Le.ownerDocument.doctype&&Le.ownerDocument.doctype.name&&io(LR,Le.ownerDocument.doctype.name)&&(fn="<!DOCTYPE "+Le.ownerDocument.doctype.name+`>
`+fn),Ge&&Fv([H,me,ee],ls=>{fn=tm(fn,ls," ")}),j&&$t?j.createHTML(fn):fn},e.setConfig=function(){let at=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};En(at),St=!0},e.clearConfig=function(){yn=null,St=!1},e.isValidAttribute=function(at,Q,Le){yn||En({});const nt=Tr(at),Fr=Tr(Q);return Xt(nt,Fr,Le)},e.addHook=function(at,Q){typeof Q=="function"&&em(fe[at],Q)},e.removeHook=function(at,Q){if(Q!==void 0){const Le=T7(fe[at],Q);return Le===-1?void 0:A7(fe[at],Le,1)[0]}return qk(fe[at])},e.removeHooks=function(at){fe[at]=[]},e.removeAllHooks=function(){fe=Zk()},e}var yS=MR();const Xv=r=>{var s;const e=r.replace(/^```html\s*/,""),t=document.createElement("div");return t.innerHTML=e.replace(/style="[^"]*"/g,""),(((s=t.textContent)==null?void 0:s.replace(/(\n{2,}|[ \t]+\n+|\n+[ \t]+)/g,`
`))||"").trim()},vb=r=>r.replace(/&quot;/g,'"').replace(/\\"/g,'"').replace(/\\n/g,`
`).replace(/\n{3,}/g,`

`).replace(/\\n/g,`
`).replace(/\\'/g,"'").replace(/\\"/g,'"').replace(/\\\\/g,"\\").replace(/```html/g,"").replace(/```/g,"").replace(/^"/,"").replace(/"$/,"").replace(/\u2019/g,"'").replace(/\u2018/g,"'").replace(/\u201A/g,"'").replace(/\u201B/g,"'"),$R=({htmlString:r})=>{const e=()=>({__html:yS.sanitize(r,{USE_PROFILES:{html:!0}})});return u.jsx("div",{className:"rich-text-content text-gray-800 dark:text-gray-200",style:{fontSize:"14px",lineHeight:"1.6",fontFamily:"Arial, sans-serif"},dangerouslySetInnerHTML:e()})},UR=w.forwardRef(({value:r,onChange:e,className:t,...n},s)=>{const i=w.useRef(null);w.useImperativeHandle(s,()=>i.current);const c=()=>{const d=i.current;d&&(d.style.height="auto",d.style.height=`${d.scrollHeight}px`)};return w.useEffect(()=>{c()},[r]),u.jsx("textarea",{ref:i,value:r,onChange:d=>{e&&e(d)},className:`auto-resizing-textarea ${t||""}`,...n})});UR.displayName="AutoResizingTextarea";var V7=Eb[" useId ".trim().toString()]||(()=>{}),q7=0;function Vl(r){const[e,t]=w.useState(V7());return Kl(()=>{t(n=>n??String(q7++))},[r]),e?`radix-${e}`:""}var ow="focusScope.autoFocusOnMount",iw="focusScope.autoFocusOnUnmount",e1={bubbles:!1,cancelable:!0},K7="FocusScope",xS=w.forwardRef((r,e)=>{const{loop:t=!1,trapped:n=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...c}=r,[d,m]=w.useState(null),p=Xl(s),v=Xl(i),x=w.useRef(null),b=Mn(e,E=>m(E)),S=w.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;w.useEffect(()=>{if(n){let E=function(F){if(S.paused||!d)return;const j=F.target;d.contains(j)?x.current=j:zc(x.current,{select:!0})},T=function(F){if(S.paused||!d)return;const j=F.relatedTarget;j!==null&&(d.contains(j)||zc(x.current,{select:!0}))},A=function(F){if(document.activeElement===document.body)for(const L of F)L.removedNodes.length>0&&zc(d)};document.addEventListener("focusin",E),document.addEventListener("focusout",T);const R=new MutationObserver(A);return d&&R.observe(d,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",E),document.removeEventListener("focusout",T),R.disconnect()}}},[n,d,S.paused]),w.useEffect(()=>{if(d){r1.add(S);const E=document.activeElement;if(!d.contains(E)){const A=new CustomEvent(ow,e1);d.addEventListener(ow,p),d.dispatchEvent(A),A.defaultPrevented||(Y7(eW(zR(d)),{select:!0}),document.activeElement===E&&zc(d))}return()=>{d.removeEventListener(ow,p),setTimeout(()=>{const A=new CustomEvent(iw,e1);d.addEventListener(iw,v),d.dispatchEvent(A),A.defaultPrevented||zc(E??document.body,{select:!0}),d.removeEventListener(iw,v),r1.remove(S)},0)}}},[d,p,v,S]);const N=w.useCallback(E=>{if(!t&&!n||S.paused)return;const T=E.key==="Tab"&&!E.altKey&&!E.ctrlKey&&!E.metaKey,A=document.activeElement;if(T&&A){const R=E.currentTarget,[F,j]=J7(R);F&&j?!E.shiftKey&&A===j?(E.preventDefault(),t&&zc(F,{select:!0})):E.shiftKey&&A===F&&(E.preventDefault(),t&&zc(j,{select:!0})):A===R&&E.preventDefault()}},[t,n,S.paused]);return u.jsx($r.div,{tabIndex:-1,...c,ref:b,onKeyDown:N})});xS.displayName=K7;function Y7(r,{select:e=!1}={}){const t=document.activeElement;for(const n of r)if(zc(n,{select:e}),document.activeElement!==t)return}function J7(r){const e=zR(r),t=t1(e,r),n=t1(e.reverse(),r);return[t,n]}function zR(r){const e=[],t=document.createTreeWalker(r,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const s=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||s?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;t.nextNode();)e.push(t.currentNode);return e}function t1(r,e){for(const t of r)if(!X7(t,{upTo:e}))return t}function X7(r,{upTo:e}){if(getComputedStyle(r).visibility==="hidden")return!0;for(;r;){if(e!==void 0&&r===e)return!1;if(getComputedStyle(r).display==="none")return!0;r=r.parentElement}return!1}function Q7(r){return r instanceof HTMLInputElement&&"select"in r}function zc(r,{select:e=!1}={}){if(r&&r.focus){const t=document.activeElement;r.focus({preventScroll:!0}),r!==t&&Q7(r)&&e&&r.select()}}var r1=Z7();function Z7(){let r=[];return{add(e){const t=r[0];e!==t&&(t==null||t.pause()),r=n1(r,e),r.unshift(e)},remove(e){var t;r=n1(r,e),(t=r[0])==null||t.resume()}}}function n1(r,e){const t=[...r],n=t.indexOf(e);return n!==-1&&t.splice(n,1),t}function eW(r){return r.filter(e=>e.tagName!=="A")}var aw=0;function HR(){w.useEffect(()=>{const r=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",r[0]??s1()),document.body.insertAdjacentElement("beforeend",r[1]??s1()),aw++,()=>{aw===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),aw--}},[])}function s1(){const r=document.createElement("span");return r.setAttribute("data-radix-focus-guard",""),r.tabIndex=0,r.style.outline="none",r.style.opacity="0",r.style.position="fixed",r.style.pointerEvents="none",r}var Qv="right-scroll-bar-position",Zv="width-before-scroll-bar",tW="with-scroll-bars-hidden",rW="--removed-body-scroll-bar-size";function lw(r,e){return typeof r=="function"?r(e):r&&(r.current=e),r}function nW(r,e){var t=w.useState(function(){return{value:r,callback:e,facade:{get current(){return t.value},set current(n){var s=t.value;s!==n&&(t.value=n,t.callback(n,s))}}}})[0];return t.callback=e,t.facade}var sW=typeof window<"u"?w.useLayoutEffect:w.useEffect,o1=new WeakMap;function oW(r,e){var t=nW(null,function(n){return r.forEach(function(s){return lw(s,n)})});return sW(function(){var n=o1.get(t);if(n){var s=new Set(n),i=new Set(r),c=t.current;s.forEach(function(d){i.has(d)||lw(d,null)}),i.forEach(function(d){s.has(d)||lw(d,c)})}o1.set(t,r)},[r]),t}function iW(r){return r}function aW(r,e){e===void 0&&(e=iW);var t=[],n=!1,s={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return t.length?t[t.length-1]:r},useMedium:function(i){var c=e(i,n);return t.push(c),function(){t=t.filter(function(d){return d!==c})}},assignSyncMedium:function(i){for(n=!0;t.length;){var c=t;t=[],c.forEach(i)}t={push:function(d){return i(d)},filter:function(){return t}}},assignMedium:function(i){n=!0;var c=[];if(t.length){var d=t;t=[],d.forEach(i),c=t}var m=function(){var v=c;c=[],v.forEach(i)},p=function(){return Promise.resolve().then(m)};p(),t={push:function(v){c.push(v),p()},filter:function(v){return c=c.filter(v),t}}}};return s}function lW(r){r===void 0&&(r={});var e=aW(null);return e.options=Ba({async:!0,ssr:!1},r),e}var BR=function(r){var e=r.sideCar,t=TN(r,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=e.read();if(!n)throw new Error("Sidecar medium not found");return w.createElement(n,Ba({},t))};BR.isSideCarExport=!0;function cW(r,e){return r.useMedium(e),BR}var GR=lW(),cw=function(){},n0=w.forwardRef(function(r,e){var t=w.useRef(null),n=w.useState({onScrollCapture:cw,onWheelCapture:cw,onTouchMoveCapture:cw}),s=n[0],i=n[1],c=r.forwardProps,d=r.children,m=r.className,p=r.removeScrollBar,v=r.enabled,x=r.shards,b=r.sideCar,S=r.noRelative,N=r.noIsolation,E=r.inert,T=r.allowPinchZoom,A=r.as,R=A===void 0?"div":A,F=r.gapMode,j=TN(r,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),L=b,G=oW([t,e]),z=Ba(Ba({},j),s);return w.createElement(w.Fragment,null,v&&w.createElement(L,{sideCar:GR,removeScrollBar:p,shards:x,noRelative:S,noIsolation:N,inert:E,setCallbacks:i,allowPinchZoom:!!T,lockRef:t,gapMode:F}),c?w.cloneElement(w.Children.only(d),Ba(Ba({},z),{ref:G})):w.createElement(R,Ba({},z,{className:m,ref:G}),d))});n0.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};n0.classNames={fullWidth:Zv,zeroRight:Qv};var uW=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function dW(){if(!document)return null;var r=document.createElement("style");r.type="text/css";var e=uW();return e&&r.setAttribute("nonce",e),r}function fW(r,e){r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}function hW(r){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(r)}var pW=function(){var r=0,e=null;return{add:function(t){r==0&&(e=dW())&&(fW(e,t),hW(e)),r++},remove:function(){r--,!r&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},mW=function(){var r=pW();return function(e,t){w.useEffect(function(){return r.add(e),function(){r.remove()}},[e&&t])}},WR=function(){var r=mW(),e=function(t){var n=t.styles,s=t.dynamic;return r(n,s),null};return e},gW={left:0,top:0,right:0,gap:0},uw=function(r){return parseInt(r||"",10)||0},vW=function(r){var e=window.getComputedStyle(document.body),t=e[r==="padding"?"paddingLeft":"marginLeft"],n=e[r==="padding"?"paddingTop":"marginTop"],s=e[r==="padding"?"paddingRight":"marginRight"];return[uw(t),uw(n),uw(s)]},yW=function(r){if(r===void 0&&(r="margin"),typeof window>"u")return gW;var e=vW(r),t=document.documentElement.clientWidth,n=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,n-t+e[2]-e[0])}},xW=WR(),ah="data-scroll-locked",wW=function(r,e,t,n){var s=r.left,i=r.top,c=r.right,d=r.gap;return t===void 0&&(t="margin"),`
  .`.concat(tW,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(d,"px ").concat(n,`;
  }
  body[`).concat(ah,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(n,";"),t==="margin"&&`
    padding-left: `.concat(s,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(c,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(d,"px ").concat(n,`;
    `),t==="padding"&&"padding-right: ".concat(d,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Qv,` {
    right: `).concat(d,"px ").concat(n,`;
  }
  
  .`).concat(Zv,` {
    margin-right: `).concat(d,"px ").concat(n,`;
  }
  
  .`).concat(Qv," .").concat(Qv,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(Zv," .").concat(Zv,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(ah,`] {
    `).concat(rW,": ").concat(d,`px;
  }
`)},i1=function(){var r=parseInt(document.body.getAttribute(ah)||"0",10);return isFinite(r)?r:0},bW=function(){w.useEffect(function(){return document.body.setAttribute(ah,(i1()+1).toString()),function(){var r=i1()-1;r<=0?document.body.removeAttribute(ah):document.body.setAttribute(ah,r.toString())}},[])},_W=function(r){var e=r.noRelative,t=r.noImportant,n=r.gapMode,s=n===void 0?"margin":n;bW();var i=w.useMemo(function(){return yW(s)},[s]);return w.createElement(xW,{styles:wW(i,!e,s,t?"":"!important")})},yb=!1;if(typeof window<"u")try{var Ov=Object.defineProperty({},"passive",{get:function(){return yb=!0,!0}});window.addEventListener("test",Ov,Ov),window.removeEventListener("test",Ov,Ov)}catch{yb=!1}var Hf=yb?{passive:!1}:!1,SW=function(r){return r.tagName==="TEXTAREA"},VR=function(r,e){if(!(r instanceof Element))return!1;var t=window.getComputedStyle(r);return t[e]!=="hidden"&&!(t.overflowY===t.overflowX&&!SW(r)&&t[e]==="visible")},EW=function(r){return VR(r,"overflowY")},CW=function(r){return VR(r,"overflowX")},a1=function(r,e){var t=e.ownerDocument,n=e;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var s=qR(r,n);if(s){var i=KR(r,n),c=i[1],d=i[2];if(c>d)return!0}n=n.parentNode}while(n&&n!==t.body);return!1},kW=function(r){var e=r.scrollTop,t=r.scrollHeight,n=r.clientHeight;return[e,t,n]},NW=function(r){var e=r.scrollLeft,t=r.scrollWidth,n=r.clientWidth;return[e,t,n]},qR=function(r,e){return r==="v"?EW(e):CW(e)},KR=function(r,e){return r==="v"?kW(e):NW(e)},TW=function(r,e){return r==="h"&&e==="rtl"?-1:1},AW=function(r,e,t,n,s){var i=TW(r,window.getComputedStyle(e).direction),c=i*n,d=t.target,m=e.contains(d),p=!1,v=c>0,x=0,b=0;do{if(!d)break;var S=KR(r,d),N=S[0],E=S[1],T=S[2],A=E-T-i*N;(N||A)&&qR(r,d)&&(x+=A,b+=N);var R=d.parentNode;d=R&&R.nodeType===Node.DOCUMENT_FRAGMENT_NODE?R.host:R}while(!m&&d!==document.body||m&&(e.contains(d)||e===d));return(v&&Math.abs(x)<1||!v&&Math.abs(b)<1)&&(p=!0),p},Dv=function(r){return"changedTouches"in r?[r.changedTouches[0].clientX,r.changedTouches[0].clientY]:[0,0]},l1=function(r){return[r.deltaX,r.deltaY]},c1=function(r){return r&&"current"in r?r.current:r},RW=function(r,e){return r[0]===e[0]&&r[1]===e[1]},IW=function(r){return`
  .block-interactivity-`.concat(r,` {pointer-events: none;}
  .allow-interactivity-`).concat(r,` {pointer-events: all;}
`)},PW=0,Bf=[];function FW(r){var e=w.useRef([]),t=w.useRef([0,0]),n=w.useRef(),s=w.useState(PW++)[0],i=w.useState(WR)[0],c=w.useRef(r);w.useEffect(function(){c.current=r},[r]),w.useEffect(function(){if(r.inert){document.body.classList.add("block-interactivity-".concat(s));var E=VM([r.lockRef.current],(r.shards||[]).map(c1),!0).filter(Boolean);return E.forEach(function(T){return T.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),E.forEach(function(T){return T.classList.remove("allow-interactivity-".concat(s))})}}},[r.inert,r.lockRef.current,r.shards]);var d=w.useCallback(function(E,T){if("touches"in E&&E.touches.length===2||E.type==="wheel"&&E.ctrlKey)return!c.current.allowPinchZoom;var A=Dv(E),R=t.current,F="deltaX"in E?E.deltaX:R[0]-A[0],j="deltaY"in E?E.deltaY:R[1]-A[1],L,G=E.target,z=Math.abs(F)>Math.abs(j)?"h":"v";if("touches"in E&&z==="h"&&G.type==="range")return!1;var q=window.getSelection(),ae=q&&q.anchorNode,oe=ae?ae===G||ae.contains(G):!1;if(oe)return!1;var fe=a1(z,G);if(!fe)return!0;if(fe?L=z:(L=z==="v"?"h":"v",fe=a1(z,G)),!fe)return!1;if(!n.current&&"changedTouches"in E&&(F||j)&&(n.current=L),!L)return!0;var H=n.current||L;return AW(H,T,E,H==="h"?F:j)},[]),m=w.useCallback(function(E){var T=E;if(!(!Bf.length||Bf[Bf.length-1]!==i)){var A="deltaY"in T?l1(T):Dv(T),R=e.current.filter(function(L){return L.name===T.type&&(L.target===T.target||T.target===L.shadowParent)&&RW(L.delta,A)})[0];if(R&&R.should){T.cancelable&&T.preventDefault();return}if(!R){var F=(c.current.shards||[]).map(c1).filter(Boolean).filter(function(L){return L.contains(T.target)}),j=F.length>0?d(T,F[0]):!c.current.noIsolation;j&&T.cancelable&&T.preventDefault()}}},[]),p=w.useCallback(function(E,T,A,R){var F={name:E,delta:T,target:A,should:R,shadowParent:jW(A)};e.current.push(F),setTimeout(function(){e.current=e.current.filter(function(j){return j!==F})},1)},[]),v=w.useCallback(function(E){t.current=Dv(E),n.current=void 0},[]),x=w.useCallback(function(E){p(E.type,l1(E),E.target,d(E,r.lockRef.current))},[]),b=w.useCallback(function(E){p(E.type,Dv(E),E.target,d(E,r.lockRef.current))},[]);w.useEffect(function(){return Bf.push(i),r.setCallbacks({onScrollCapture:x,onWheelCapture:x,onTouchMoveCapture:b}),document.addEventListener("wheel",m,Hf),document.addEventListener("touchmove",m,Hf),document.addEventListener("touchstart",v,Hf),function(){Bf=Bf.filter(function(E){return E!==i}),document.removeEventListener("wheel",m,Hf),document.removeEventListener("touchmove",m,Hf),document.removeEventListener("touchstart",v,Hf)}},[]);var S=r.removeScrollBar,N=r.inert;return w.createElement(w.Fragment,null,N?w.createElement(i,{styles:IW(s)}):null,S?w.createElement(_W,{noRelative:r.noRelative,gapMode:r.gapMode}):null)}function jW(r){for(var e=null;r!==null;)r instanceof ShadowRoot&&(e=r.host,r=r.host),r=r.parentNode;return e}const OW=cW(GR,FW);var wS=w.forwardRef(function(r,e){return w.createElement(n0,Ba({},r,{ref:e,sideCar:OW}))});wS.classNames=n0.classNames;var DW=function(r){if(typeof document>"u")return null;var e=Array.isArray(r)?r[0]:r;return e.ownerDocument.body},Gf=new WeakMap,Lv=new WeakMap,Mv={},dw=0,YR=function(r){return r&&(r.host||YR(r.parentNode))},LW=function(r,e){return e.map(function(t){if(r.contains(t))return t;var n=YR(t);return n&&r.contains(n)?n:(console.error("aria-hidden",t,"in not contained inside",r,". Doing nothing"),null)}).filter(function(t){return!!t})},MW=function(r,e,t,n){var s=LW(e,Array.isArray(r)?r:[r]);Mv[t]||(Mv[t]=new WeakMap);var i=Mv[t],c=[],d=new Set,m=new Set(s),p=function(x){!x||d.has(x)||(d.add(x),p(x.parentNode))};s.forEach(p);var v=function(x){!x||m.has(x)||Array.prototype.forEach.call(x.children,function(b){if(d.has(b))v(b);else try{var S=b.getAttribute(n),N=S!==null&&S!=="false",E=(Gf.get(b)||0)+1,T=(i.get(b)||0)+1;Gf.set(b,E),i.set(b,T),c.push(b),E===1&&N&&Lv.set(b,!0),T===1&&b.setAttribute(t,"true"),N||b.setAttribute(n,"true")}catch(A){console.error("aria-hidden: cannot operate on ",b,A)}})};return v(e),d.clear(),dw++,function(){c.forEach(function(x){var b=Gf.get(x)-1,S=i.get(x)-1;Gf.set(x,b),i.set(x,S),b||(Lv.has(x)||x.removeAttribute(n),Lv.delete(x)),S||x.removeAttribute(t)}),dw--,dw||(Gf=new WeakMap,Gf=new WeakMap,Lv=new WeakMap,Mv={})}},JR=function(r,e,t){t===void 0&&(t="data-aria-hidden");var n=Array.from(Array.isArray(r)?r:[r]),s=DW(r);return s?(n.push.apply(n,Array.from(s.querySelectorAll("[aria-live], script"))),MW(n,s,t,"aria-hidden")):function(){return null}};function $W(r){const e=UW(r),t=w.forwardRef((n,s)=>{const{children:i,...c}=n,d=w.Children.toArray(i),m=d.find(HW);if(m){const p=m.props.children,v=d.map(x=>x===m?w.Children.count(p)>1?w.Children.only(null):w.isValidElement(p)?p.props.children:null:x);return u.jsx(e,{...c,ref:s,children:w.isValidElement(p)?w.cloneElement(p,void 0,v):null})}return u.jsx(e,{...c,ref:s,children:i})});return t.displayName=`${r}.Slot`,t}function UW(r){const e=w.forwardRef((t,n)=>{const{children:s,...i}=t;if(w.isValidElement(s)){const c=GW(s),d=BW(i,s.props);return s.type!==w.Fragment&&(d.ref=n?tu(n,c):c),w.cloneElement(s,d)}return w.Children.count(s)>1?w.Children.only(null):null});return e.displayName=`${r}.SlotClone`,e}var zW=Symbol("radix.slottable");function HW(r){return w.isValidElement(r)&&typeof r.type=="function"&&"__radixId"in r.type&&r.type.__radixId===zW}function BW(r,e){const t={...e};for(const n in e){const s=r[n],i=e[n];/^on[A-Z]/.test(n)?s&&i?t[n]=(...d)=>{const m=i(...d);return s(...d),m}:s&&(t[n]=s):n==="style"?t[n]={...s,...i}:n==="className"&&(t[n]=[s,i].filter(Boolean).join(" "))}return{...r,...t}}function GW(r){var n,s;let e=(n=Object.getOwnPropertyDescriptor(r.props,"ref"))==null?void 0:n.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=(s=Object.getOwnPropertyDescriptor(r,"ref"))==null?void 0:s.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}var s0="Dialog",[XR]=Za(s0),[WW,ha]=XR(s0),QR=r=>{const{__scopeDialog:e,children:t,open:n,defaultOpen:s,onOpenChange:i,modal:c=!0}=r,d=w.useRef(null),m=w.useRef(null),[p,v]=ru({prop:n,defaultProp:s??!1,onChange:i,caller:s0});return u.jsx(WW,{scope:e,triggerRef:d,contentRef:m,contentId:Vl(),titleId:Vl(),descriptionId:Vl(),open:p,onOpenChange:v,onOpenToggle:w.useCallback(()=>v(x=>!x),[v]),modal:c,children:t})};QR.displayName=s0;var ZR="DialogTrigger",VW=w.forwardRef((r,e)=>{const{__scopeDialog:t,...n}=r,s=ha(ZR,t),i=Mn(e,s.triggerRef);return u.jsx($r.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":SS(s.open),...n,ref:i,onClick:Lt(r.onClick,s.onOpenToggle)})});VW.displayName=ZR;var bS="DialogPortal",[qW,eI]=XR(bS,{forceMount:void 0}),tI=r=>{const{__scopeDialog:e,forceMount:t,children:n,container:s}=r,i=ha(bS,e);return u.jsx(qW,{scope:e,forceMount:t,children:w.Children.map(n,c=>u.jsx(fa,{present:t||i.open,children:u.jsx(mS,{asChild:!0,container:s,children:c})}))})};tI.displayName=bS;var Iy="DialogOverlay",rI=w.forwardRef((r,e)=>{const t=eI(Iy,r.__scopeDialog),{forceMount:n=t.forceMount,...s}=r,i=ha(Iy,r.__scopeDialog);return i.modal?u.jsx(fa,{present:n||i.open,children:u.jsx(YW,{...s,ref:e})}):null});rI.displayName=Iy;var KW=$W("DialogOverlay.RemoveScroll"),YW=w.forwardRef((r,e)=>{const{__scopeDialog:t,...n}=r,s=ha(Iy,t);return u.jsx(wS,{as:KW,allowPinchZoom:!0,shards:[s.contentRef],children:u.jsx($r.div,{"data-state":SS(s.open),...n,ref:e,style:{pointerEvents:"auto",...n.style}})})}),hd="DialogContent",nI=w.forwardRef((r,e)=>{const t=eI(hd,r.__scopeDialog),{forceMount:n=t.forceMount,...s}=r,i=ha(hd,r.__scopeDialog);return u.jsx(fa,{present:n||i.open,children:i.modal?u.jsx(JW,{...s,ref:e}):u.jsx(XW,{...s,ref:e})})});nI.displayName=hd;var JW=w.forwardRef((r,e)=>{const t=ha(hd,r.__scopeDialog),n=w.useRef(null),s=Mn(e,t.contentRef,n);return w.useEffect(()=>{const i=n.current;if(i)return JR(i)},[]),u.jsx(sI,{...r,ref:s,trapFocus:t.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Lt(r.onCloseAutoFocus,i=>{var c;i.preventDefault(),(c=t.triggerRef.current)==null||c.focus()}),onPointerDownOutside:Lt(r.onPointerDownOutside,i=>{const c=i.detail.originalEvent,d=c.button===0&&c.ctrlKey===!0;(c.button===2||d)&&i.preventDefault()}),onFocusOutside:Lt(r.onFocusOutside,i=>i.preventDefault())})}),XW=w.forwardRef((r,e)=>{const t=ha(hd,r.__scopeDialog),n=w.useRef(!1),s=w.useRef(!1);return u.jsx(sI,{...r,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var c,d;(c=r.onCloseAutoFocus)==null||c.call(r,i),i.defaultPrevented||(n.current||(d=t.triggerRef.current)==null||d.focus(),i.preventDefault()),n.current=!1,s.current=!1},onInteractOutside:i=>{var m,p;(m=r.onInteractOutside)==null||m.call(r,i),i.defaultPrevented||(n.current=!0,i.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const c=i.target;((p=t.triggerRef.current)==null?void 0:p.contains(c))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&s.current&&i.preventDefault()}})}),sI=w.forwardRef((r,e)=>{const{__scopeDialog:t,trapFocus:n,onOpenAutoFocus:s,onCloseAutoFocus:i,...c}=r,d=ha(hd,t),m=w.useRef(null),p=Mn(e,m);return HR(),u.jsxs(u.Fragment,{children:[u.jsx(xS,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:s,onUnmountAutoFocus:i,children:u.jsx(Zy,{role:"dialog",id:d.contentId,"aria-describedby":d.descriptionId,"aria-labelledby":d.titleId,"data-state":SS(d.open),...c,ref:p,onDismiss:()=>d.onOpenChange(!1)})}),u.jsxs(u.Fragment,{children:[u.jsx(QW,{titleId:d.titleId}),u.jsx(e9,{contentRef:m,descriptionId:d.descriptionId})]})]})}),_S="DialogTitle",oI=w.forwardRef((r,e)=>{const{__scopeDialog:t,...n}=r,s=ha(_S,t);return u.jsx($r.h2,{id:s.titleId,...n,ref:e})});oI.displayName=_S;var iI="DialogDescription",aI=w.forwardRef((r,e)=>{const{__scopeDialog:t,...n}=r,s=ha(iI,t);return u.jsx($r.p,{id:s.descriptionId,...n,ref:e})});aI.displayName=iI;var lI="DialogClose",cI=w.forwardRef((r,e)=>{const{__scopeDialog:t,...n}=r,s=ha(lI,t);return u.jsx($r.button,{type:"button",...n,ref:e,onClick:Lt(r.onClick,()=>s.onOpenChange(!1))})});cI.displayName=lI;function SS(r){return r?"open":"closed"}var uI="DialogTitleWarning",[LK,dI]=wB(uI,{contentName:hd,titleName:_S,docsSlug:"dialog"}),QW=({titleId:r})=>{const e=dI(uI),t=`\`${e.contentName}\` requires a \`${e.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${e.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${e.docsSlug}`;return w.useEffect(()=>{r&&(document.getElementById(r)||console.error(t))},[t,r]),null},ZW="DialogDescriptionWarning",e9=({contentRef:r,descriptionId:e})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${dI(ZW).contentName}}.`;return w.useEffect(()=>{var i;const s=(i=r.current)==null?void 0:i.getAttribute("aria-describedby");e&&s&&(document.getElementById(e)||console.warn(n))},[n,r,e]),null},t9=QR,r9=tI,fI=rI,hI=nI,pI=oI,mI=aI,n9=cI;const s9=t9,o9=r9,gI=w.forwardRef(({className:r,...e},t)=>u.jsx(fI,{ref:t,className:jr("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",r),...e}));gI.displayName=fI.displayName;const vI=w.forwardRef(({className:r,children:e,...t},n)=>u.jsxs(o9,{children:[u.jsx(gI,{}),u.jsxs(hI,{ref:n,className:jr("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",r),...t,children:[e,u.jsxs(n9,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[u.jsx(aa,{className:"h-4 w-4"}),u.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));vI.displayName=hI.displayName;const yI=({className:r,...e})=>u.jsx("div",{className:jr("flex flex-col space-y-1.5 text-center sm:text-left",r),...e});yI.displayName="DialogHeader";const xI=({className:r,...e})=>u.jsx("div",{className:jr("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",r),...e});xI.displayName="DialogFooter";const wI=w.forwardRef(({className:r,...e},t)=>u.jsx(pI,{ref:t,className:jr("text-lg font-semibold leading-none tracking-tight",r),...e}));wI.displayName=pI.displayName;const bI=w.forwardRef(({className:r,...e},t)=>u.jsx(mI,{ref:t,className:jr("text-sm text-muted-foreground",r),...e}));bI.displayName=mI.displayName;const i9=({isOpen:r,onClose:e,title:t="Gmail Connection Required",description:n="This feature requires an active Gmail connection. Please connect your Gmail account to continue.",actionText:s="the requested action"})=>{const[i,c]=w.useState(!1),{initiateReconnection:d,wasEverConnected:m}=Di(),p=async()=>{c(!0);try{await d(),e()}catch(v){console.error("Failed to reconnect Gmail:",v)}finally{c(!1)}};return u.jsx(s9,{open:r,onOpenChange:e,children:u.jsxs(vI,{className:"sm:max-w-md",children:[u.jsxs(yI,{children:[u.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[u.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:u.jsx(Xc,{className:"h-5 w-5 text-blue-600"})}),u.jsx(wI,{className:"text-lg font-semibold",children:t})]}),u.jsx(bI,{className:"text-sm text-gray-600 leading-relaxed",children:n})]}),u.jsx("div",{className:"bg-gray-50 rounded-lg p-4 my-4",children:u.jsxs("div",{className:"flex items-start gap-3",children:[u.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full mt-2 flex-shrink-0"}),u.jsxs("div",{className:"text-sm text-gray-700",children:[u.jsx("p",{className:"font-medium mb-1",children:"What happens next:"}),u.jsxs("p",{children:["You'll be redirected to Gmail's authorization page to ",m?"reconnect":"connect"," your account securely."]})]})]})}),u.jsxs(xI,{className:"flex gap-2 sm:gap-2",children:[u.jsx(We,{variant:"outline",onClick:e,disabled:i,className:"flex-1",children:"Cancel"}),u.jsx(We,{onClick:p,disabled:i,className:"flex-1 bg-blue-600 hover:bg-blue-700",children:i?u.jsxs(u.Fragment,{children:[u.jsx(si,{className:"h-4 w-4 mr-2 animate-spin"}),"Connecting..."]}):m?"Reconnect Gmail":"Connect Gmail"})]})]})})},an="src/shared/components/sidepanel/panels/GenerateEmailDraftPanel.tsx",a9=()=>`The response should just be the email body with salutation at the beginning. Do not include a subject line in your response draft. 
    Do not add links to the references in your response draft. Do not add citation numbers in your response draft.
    Do not list the references in your response draft, since they will be added in a different section in the JSON response.
    Do not add a complimentary closing or a signature as this will be added later.`.trim(),l9=(r,e,t)=>{let n="";switch(r){case"Casual":n+="Keep the tone casual. ";break;case"Neutral":n+="Maintain a neutral tone. ";break;case"Formal":n+="Keep the tone formal. ";break}switch(e){case"Low":n+="Show low empathy. ";break;case"Neutral":n+="Maintain neutral empathy. ";break;case"High":n+="Show high empathy. ";break}switch(t){case"Simple":n+="Keep it simple amd use simple words. ";break;case"Neutral":n+="Maintain neutral complexity. ";break;case"Detailed":n+="Provide detailed information and you're free to use harder words. ";break}return n.trim()},c9=({clientEmail:r})=>{const e=Gr(),t=Qa(),n=ua(),s=dn().platform,{isConnected:i}=Di(),[c,d]=w.useState(!1),[m,p]=w.useState(!1),[v,x]=w.useState(""),b=w.useRef(null),[S,N]=w.useState(!0),[E,T]=w.useState(""),[A,R]=w.useState([]),[F,j]=w.useState(0),[L,G]=w.useState(""),[z,q]=w.useState(!1),[ae,oe]=w.useState(!0),[fe,H]=w.useState(!0),[me,ee]=w.useState(!0),[se,de]=w.useState(null),[Y,J]=w.useState(null),[$,X]=w.useState([]),O=w.useRef(null),[U,re]=w.useState(""),[Ee,ne]=w.useState("Neutral"),[we,K]=w.useState("Neutral"),[he,be]=w.useState("Neutral"),Ie=w.useRef(null),[_t,Be]=w.useState(!1),[Ge,qe]=w.useState(!1),[Ne,St]=w.useState([]),[ct,Ct]=w.useState(!0),[Gt,$t]=w.useState(!1),Kt="25dc68db26595a7485917129d6993f96",hr="c1c8e460f2105029b2b4563f9222161c",Ur=["Analyzing email thread...","Pulling relevant information...","Structuring your response...","Preparing personalized reply...","Finalizing your draft..."],zr=w.useCallback(async ze=>{const He="fetchFromStorageProvider";if(!t)return"";try{const rt=await t.getLocalItem(ze);return rt&&e.debug("Loaded additional context from storage",{sourceFile:an,functionName:He}),rt||""}catch(rt){return e.error("Error loading additional context from storage",rt,{sourceFile:an,functionName:He}),""}},[t,e]);w.useEffect(()=>{let ze;const He=()=>{if(c){const rt=Math.floor(Math.random()*2e3)+1e3;ze=setTimeout(()=>{j(Re=>(Re+1)%Ur.length),He()},rt)}};return c&&He(),()=>{ze&&clearTimeout(ze)}},[c,Ur.length]),w.useEffect(()=>{const ze="useEffect[threadDataListener]";if(!n){e.debug("DataProvider not available yet",{sourceFile:an,functionName:ze});return}const He=async Re=>{const ft=Re!==null&&Re.threadId!==O.current;if(Re){if(e.debug("Thread changed via platform abstraction",{sourceFile:an,functionName:ze,threadId:Re.threadId,isThreadChanged:ft}),J(Re.threadId),X(Re.participants||[]),Re.messages&&Array.isArray(Re.messages)&&Re.messages.length>0&&Re.messages[0]&&typeof Re.messages[0]=="object"){const Ue=Re.messages.map((kt,vr)=>({body:kt.body||kt.html||"",html:kt.html||kt.body||"",from:kt.from||"",timestamp:kt.timestamp||"",subject:vr===0&&Re.subject||""}));de(Ue);const rr=Ue.length>0?Xv(Ue[0].body):"";G(rr)}if(ft){T(""),R([]),St([]),p(!1),d(!1),ne("Neutral"),K("Neutral"),be("Neutral"),re("");const Ue=`toneSettings_${Re.threadId}`,rr=await zr(Ue);if(rr)try{const kt=JSON.parse(rr),vr=["Casual","Neutral","Formal"],nr=["Low","Neutral","High"],Jt=["Simple","Neutral","Detailed"];vr.includes(kt.formality)&&ne(kt.formality),nr.includes(kt.empathy)&&K(kt.empathy),Jt.includes(kt.complexity)&&be(kt.complexity)}catch{}}O.current=Re.threadId;const Mt=`additionalContext_${Re.threadId}`;re(await zr(Mt))}else{e.debug("Thread cleared via platform abstraction",{sourceFile:an,functionName:ze});const Mt=O.current!==null;J(null),de(null),X([]),G(""),T(""),R([]),St([]),p(!1),d(!1),Mt&&(re(""),O.current=null)}};return n.onThreadChanged(He),(async()=>{try{const Re=await n.getCurrentThread();await He(Re)}catch(Re){e.error("Error loading current thread",Re,{sourceFile:an,functionName:"loadCurrentThread"})}})(),()=>{n.removeThreadListener(He)}},[n,e]),w.useEffect(()=>{const He=setTimeout(async()=>{const rt="useEffect[saveAdditionalContext]";if(!(!Y||!t))try{const Re=`additionalContext_${Y}`;await t.setLocalItem(Re,U)}catch(Re){e.error("Error saving additional context to storage",Re,{sourceFile:an,functionName:rt,threadId:Y})}},500);return()=>clearTimeout(He)},[U,Y,t,e]),w.useEffect(()=>{if(!Y||!t)return;const He=setTimeout(async()=>{try{const rt=`toneSettings_${Y}`;await t.setLocalItem(rt,JSON.stringify({formality:Ee,empathy:we,complexity:he}))}catch(rt){e.error("Error saving tone settings to storage",rt,{sourceFile:an,functionName:"useEffect[saveToneSettings]",threadId:Y})}},500);return()=>clearTimeout(He)},[Ee,we,he,Y,t,e]);const kr=w.useCallback(async ze=>{try{if(!Y)return e.debug("No thread ID available for cache check",{sourceFile:an,functionName:ze}),!1;const He=ge(Y),rt=await X5(He,e);return rt?(e.debug("Found cached response for thread",{sourceFile:an,functionName:ze,cacheKey:He,threadId:Y}),T(rt.response),R(rt.references),St(rt.cmsData),d(!1),p(!0),!0):(e.debug("No cached response found for thread",{sourceFile:an,functionName:ze,cacheKey:He,threadId:Y}),!1)}catch(He){return e.warn("Error checking for cached response",{sourceFile:an,functionName:ze,error:He}),!1}},[Y,e]);w.useEffect(()=>{const He=setTimeout(async()=>{const rt="checkForCachedResponse";!Y||E||c||await kr(rt)},500);return()=>clearTimeout(He)},[Y,kr,E,c]),w.useEffect(()=>{(async()=>{const He="checkCachedResponseOnReady";S||!Y||!se||E||c||(e.debug("Component ready, checking for cached response immediately",{sourceFile:an,functionName:He,threadId:Y,hasThreadData:!!se,isLoading:S,hasResponse:!!E}),await kr(He))})()},[S,Y,se,kr,E,c,e]),w.useEffect(()=>{if(m&&b.current){const ze=setTimeout(()=>{var He;(He=b.current)==null||He.focus()},100);return()=>clearTimeout(ze)}},[m]),w.useEffect(()=>{const ze=async()=>{try{if(!t)return;const Re=await t.getLocalItem("useUscis");Be(Re??!1),e.debug("uscisIsEnabled loaded from storage via platform abstraction",{sourceFile:an,functionName:"initializeUscisState",uscisEnabled:Re??!1})}catch(Re){e.error("Error loading USCIS state",Re,{sourceFile:an,functionName:"initializeUscisState"})}},He=async()=>{try{if(!t)return;const Re=await t.getLocalItem("useOregon");qe(Re??!1),e.debug("oregonIsEnabled loaded from storage via platform abstraction",{sourceFile:an,functionName:"initializeOregonState",oregonEnabled:Re??!1})}catch(Re){e.error("Error loading Oregon state",Re,{sourceFile:an,functionName:"initializeOregonState"})}},rt=async Re=>{try{Re.useUscis!==void 0&&(Be(Re.useUscis),e.debug("USCIS setting changed via platform abstraction",{sourceFile:an,functionName:"handleStorageChange",useUscis:Re.useUscis})),Re.useOregon!==void 0&&(qe(Re.useOregon),e.debug("Oregon setting changed via platform abstraction",{sourceFile:an,functionName:"handleStorageChange",useOregon:Re.useOregon}))}catch(ft){e.error("Error handling storage changes",ft,{sourceFile:an,functionName:"handleStorageChange"})}};return ze(),He(),t!=null&&t.onChanged&&t.onChanged(rt),N(!1),()=>{t!=null&&t.removeChangeListener&&rt&&t.removeChangeListener(rt)}},[t,e]),w.useEffect(()=>{if(E&&Ie.current){const ze=Ie.current,rt=(ze.scrollHeight-ze.clientHeight)*.8;ze.scrollTo({top:rt,behavior:"smooth"}),e.debug("Scrolling to 90% of bottom after response generation",{sourceFile:an,functionName:"useEffect[fullResponse]"})}},[E,e]);const ge=ze=>`response_${ze}`,Pe=async(ze,He)=>{d(!0),T("Reformatting..."),p(!1);const rt="regenerateResponse";try{if(!Y){e.error("Thread ID is not set for regeneration",void 0,{sourceFile:an,functionName:rt}),d(!1);return}const Re=ge(Y),ft=await IT(He,ze,e);T(ft),d(!1),p(!0),await yC(Re,ft,[],[],e)}catch(Re){e.error("Error regenerating response",Re,{sourceFile:an,functionName:rt}),d(!1),p(!0)}},pt=async()=>{if(s==="chrome"&&!i){$t(!0);return}d(!0),p(!1);const ze="handleGenerateResponse";try{const He=(se==null?void 0:se.map(vr=>`From: ${vr.from}
Timestamp: ${vr.timestamp}
Body: ${Xv(vr.body)}

`).join(""))||"",rt=[];if(_t&&rt.push(Kt),Ge&&rt.push(hr),!Y){e.error("Thread ID is not set",void 0,{sourceFile:an,functionName:ze}),d(!1);return}const Re=l9(Ee,we,he),ft=a9(),Mt=ge(Y);let Ue;s==="outlook"?Ue=await RT(Y,He,U,Re,ft,$,e):Ue=await AT(Y,He,U,Re,ft,rt,e);const rr=Ue.response,kt=vb(rr);T(kt),R(Ue.references),St(Ue.cms_data||[]),d(!1),p(!0),await yC(Mt,kt,Ue.references,Ue.cms_data||[],e)}catch(He){e.error("Error generating response",He,{sourceFile:an,functionName:ze}),d(!1)}};return s==="chrome"&&!i?u.jsx("div",{className:"p-4",children:u.jsx(r0,{feature:"Email Composition",description:"Connect your Gmail account to generate personalized email responses",benefits:["Analyze email threads and context automatically","Generate contextually relevant responses","Insert generated content directly into compose box"]})}):u.jsxs("div",{className:"space-y-4 h-full overflow-y-auto overflow-x-hidden",ref:Ie,children:[u.jsxs(Ss,{className:"overflow-hidden shadow-sm mb-4",children:[u.jsx(uo,{className:"p-3 border-b dark:border-border cursor-pointer",onClick:()=>H(!fe),children:u.jsxs("div",{className:"flex items-center justify-between w-full",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx(fo,{className:"text-sm font-semibold pr-1",children:"Current Email"}),u.jsxs("div",{className:"relative group",children:[u.jsx(Ai,{src:"/icons/info-circled.svg",width:16,height:16,alt:"Info",className:"h-4 w-4 text-muted-foreground dark:brightness-0 dark:invert"}),u.jsx("div",{className:"absolute left-0 top-full mt-2 w-48 p-2 bg-white dark:bg-gray-800 text-black dark:text-white text-xs rounded shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-opacity z-50 border dark:border-border",children:"This is the email Candle AI is responding to."})]})]}),u.jsx(Ai,{src:"/icons/chevron-down.svg",width:20,height:20,alt:"Chevron down",className:`h-5 w-5 text-muted-foreground dark:brightness-0 dark:invert transition-transform duration-200 ${fe?"transform rotate-180":""}`})]})}),fe&&u.jsx(Es,{className:"p-0.5",children:u.jsx("textarea",{value:S?"Loading...":se?Xv(se[0].body):s==="chrome"&&!i?"Gmail disconnected. Connect Gmail to view email content.":"Please select an email thread",disabled:!0,className:"w-full border dark:border-border rounded p-4 min-h-[100px] text-xs bg-white dark:bg-card text-gray-900 dark:text-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400"})})]}),u.jsxs(Ss,{className:"overflow-hidden shadow-sm mb-4",children:[u.jsx(uo,{className:"p-3 border-b dark:border-border cursor-pointer",onClick:()=>oe(!ae),children:u.jsxs("div",{className:"flex items-center justify-between w-full",children:[u.jsx(fo,{className:"text-sm font-semibold",children:"Anything specific you want the response to include?"}),u.jsx(Ai,{src:"/icons/chevron-down.svg",width:20,height:20,alt:"Chevron down",className:`h-5 w-5 text-muted-foreground dark:brightness-0 dark:invert transition-transform duration-200 ${ae?"transform rotate-180":""}`})]})}),ae&&u.jsx(Es,{className:"p-0.5",children:u.jsx("textarea",{className:"w-full border dark:border-border rounded p-4 min-h-[100px] text-sm bg-white dark:bg-card text-gray-900 dark:text-gray-200 placeholder:text-gray-400 dark:placeholder:text-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400",placeholder:`Examples: 'This client's visa is expiring soon. Suggest they renew it soon.'
'Respond in Spanish.'`,value:U,onChange:ze=>re(ze.target.value)})})]}),u.jsxs(Ss,{className:"overflow-hidden shadow-sm mb-4",children:[u.jsx(uo,{className:"p-3 border-b dark:border-border cursor-pointer",onClick:()=>q(!z),children:u.jsxs("div",{className:"flex items-center justify-between w-full",children:[u.jsx(fo,{className:"text-sm font-semibold",children:"Tone"}),u.jsx(Ai,{src:"/icons/chevron-down.svg",width:20,height:20,alt:"Chevron down",className:`h-5 w-5 text-muted-foreground dark:brightness-0 dark:invert transition-transform duration-200 ${z?"transform rotate-180":""}`})]})}),z&&u.jsxs(Es,{className:"p-4 space-y-4",children:[u.jsxs("div",{className:"space-y-2",children:[u.jsx("p",{className:"text-xs font-semibold text-neutral-700 dark:text-gray-300",children:"Formality"}),u.jsx(ih,{options:["Casual","Neutral","Formal"],value:Ee,onChange:ne})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("p",{className:"text-xs font-semibold text-neutral-700 dark:text-gray-300",children:"Empathy"}),u.jsx(ih,{options:["Low","Neutral","High"],value:we,onChange:K})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("p",{className:"text-xs font-semibold text-neutral-700 dark:text-gray-300",children:"Complexity"}),u.jsx(ih,{options:["Simple","Neutral","Detailed"],value:he,onChange:be})]})]})]}),u.jsx(We,{className:"w-full bg-blue-600 hover:bg-blue-700 text-white py-4 mt-2",onClick:pt,disabled:c||!Y&&s!=="chrome"||s==="chrome"&&!i&&!Y,children:c?"Generating...":s==="chrome"&&!i?"Connect Gmail to Generate Response":Y?"Generate Response":"Select a thread"}),c&&u.jsxs("div",{className:"flex flex-col items-center justify-center",children:[u.jsx(ia,{className:"h-8 w-8 animate-spin text-blue-600"}),u.jsx("p",{className:"mt-2 text-sm text-gray-500",children:Ur[F]})]}),u.jsxs("div",{className:"mb-24",children:[u.jsx(i9,{isOpen:Gt,onClose:()=>$t(!1),title:"Gmail Connection Required",description:"Generate Response requires an active Gmail connection to analyze your email thread and create personalized responses.",actionText:"generate email responses"}),E&&!c&&u.jsxs(Ss,{className:"animate-slide-fade-in mb-2 origin-top",children:[u.jsx(uo,{className:"p-3 border-b dark:border-border cursor-pointer",children:u.jsxs(fo,{className:"flex items-center py-0 my-0 text-sm font-semibold",children:[u.jsx(Ai,{src:"/icons/email-icon.svg",width:16,height:16,alt:"Generated Response",className:"h-4 w-4 text-muted-foreground dark:brightness-0 dark:invert mr-2"}),u.jsx("p",{className:"text-sm font-semibold",children:"Generated Response"}),u.jsxs(We,{className:"ml-auto bg-blue-600 hover:bg-blue-700 text-white",size:"sm",onClick:()=>{vS(yS.sanitize(E),e)},children:[u.jsx(QA,{className:"w-4 h-4 flex-shrink-0 mr-1 rotate-90"}),"Insert"]})]})}),u.jsx(Es,{className:"p-6",children:u.jsx($R,{htmlString:E})})]}),m&&u.jsx("div",{className:"animate-fadeIn mb-2",children:u.jsxs("div",{className:"rounded-lg border-2 border-neutral-200 dark:border-border bg-neutral-50/50 dark:bg-card/50 overflow-hidden transition-all duration-200 focus-within:!border-blue-500 dark:focus-within:!border-blue-400 focus-within:ring-2 focus-within:ring-blue-500/20 dark:focus-within:ring-blue-400/20 focus-within:bg-white dark:focus-within:bg-card",children:[u.jsx("div",{className:"p-3 bg-white dark:bg-card",children:u.jsx(UR,{ref:b,placeholder:"Customize this response",value:v,className:"text-sm w-full bg-transparent text-gray-900 dark:text-gray-200 !border-0 !ring-0 !outline-none focus:!border-0 focus:!ring-0 focus:!outline-none focus-visible:!ring-0 focus-visible:!ring-offset-0 focus-visible:!outline-none min-h-[40px] max-h-40 py-0 px-0 placeholder:text-neutral-400 dark:placeholder:text-gray-500 resize-none",onChange:ze=>x(ze.target.value),onKeyDown:ze=>{ze.key==="Enter"&&!ze.shiftKey&&v.trim()&&(ze.preventDefault(),Pe(v,E),x(""))}})}),u.jsx("div",{className:"h-[1px] bg-neutral-200 dark:bg-border"}),u.jsxs("div",{className:"flex gap-0 bg-white dark:bg-card border-t dark:border-border",children:[u.jsx(We,{onClick:()=>{Pe("More empathetic",E)},variant:"ghost",className:"flex-1 rounded-none text-xs text-neutral-700 dark:text-gray-300 hover:bg-neutral-50 dark:hover:bg-muted py-2.5 h-auto font-normal",children:"More empathetic"}),u.jsx("div",{className:"w-[1px] bg-neutral-200 dark:bg-border my-1.5"}),u.jsx(We,{onClick:()=>{Pe("Make it shorter",E)},variant:"ghost",className:"flex-1 rounded-none text-xs text-neutral-700 dark:text-gray-300 hover:bg-neutral-50 dark:hover:bg-muted py-2.5 h-auto font-normal",children:"Make it shorter"}),u.jsx("div",{className:"w-[1px] bg-neutral-200 dark:bg-border my-1.5"}),u.jsx(We,{onClick:()=>{v&&(Pe(v,E),x(""))},disabled:!v.trim(),size:"icon",className:"h-auto w-12 rounded-none bg-blue-600 text-white hover:bg-blue-700 disabled:bg-blue-600/50 disabled:text-white/90 disabled:cursor-not-allowed transition-all duration-200",children:u.jsx(nB,{className:"h-4 w-4"})})]})]})})]})]})},u9=({isOpen:r,onToggle:e,value:t,onChange:n,onRefine:s,onRefineInstructionChange:i,hasGeneratedResponse:c=!1})=>{const[d,m]=w.useState(""),p=c&&!!s,v=p?d:t,x=N=>{p?(m(N),i==null||i(N)):n(N)},b=()=>{d.trim()&&s&&(s(d.trim()),m(""))},S=N=>{N.key==="Enter"&&!N.shiftKey&&d.trim()&&(N.preventDefault(),b())};return u.jsxs(Ss,{className:"overflow-hidden shadow-sm mb-4",children:[u.jsx(uo,{className:"p-3 border-b dark:border-border cursor-pointer",onClick:e,role:"button","aria-expanded":r,tabIndex:0,onKeyDown:N=>{(N.key==="Enter"||N.key===" ")&&(N.preventDefault(),e())},children:u.jsxs("div",{className:"flex items-center justify-between w-full",children:[u.jsx("div",{className:"flex items-center gap-2",children:u.jsx(fo,{className:"text-sm font-semibold",children:p?u.jsxs(u.Fragment,{children:["Refine this draft"," ",u.jsx("span",{className:"text-gray-500 dark:text-gray-300 text-xs",children:"Optional"})]}):"Additional context"})}),u.jsx(Ai,{src:"/icons/chevron-down.svg",width:20,height:20,alt:"Chevron down",className:`h-5 w-5 text-muted-foreground dark:brightness-0 dark:invert transition-transform duration-200 ${r?"transform rotate-180":""}`})]})}),r&&u.jsxs(Es,{className:"p-2",children:[u.jsx("div",{className:"rounded-lg border-2 border-neutral-200 dark:border-border bg-neutral-50/50 dark:bg-card/50 overflow-hidden transition-all duration-200 focus-within:!border-blue-500 dark:focus-within:!border-blue-400 focus-within:ring-2 focus-within:ring-blue-500/20 dark:focus-within:ring-blue-400/20 focus-within:bg-white dark:focus-within:bg-card",children:u.jsx("div",{className:"p-3 bg-white dark:bg-card",children:u.jsx("textarea",{className:"text-sm w-full bg-transparent text-gray-900 dark:text-gray-200 !border-0 !ring-0 !outline-none focus:!border-0 focus:!ring-0 focus:!outline-none focus-visible:!ring-0 focus-visible:!ring-offset-0 focus-visible:!outline-none min-h-[100px] max-h-40 py-0 px-0 placeholder:text-neutral-400 dark:placeholder:text-gray-500 resize-none",placeholder:"Anything specific you want to change or add to the draft?","aria-label":"Additional context for draft generation",value:v,onChange:N=>x(N.target.value),onKeyDown:p?S:void 0})})}),u.jsx("div",{className:"pb-3 pt-2",children:u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:'Examples: "Make this shorter." "Respond in Spanish." "Mention our meeting tomorrow."'})})]})]})},d9=({isOpen:r,onToggle:e,formality:t,empathy:n,complexity:s,onFormalityChange:i,onEmpathyChange:c,onComplexityChange:d})=>u.jsxs(Ss,{className:"overflow-hidden shadow-sm mb-4",children:[u.jsx(uo,{className:"p-3 border-b dark:border-border cursor-pointer",onClick:e,role:"button","aria-expanded":r,tabIndex:0,onKeyDown:m=>{(m.key==="Enter"||m.key===" ")&&(m.preventDefault(),e())},children:u.jsxs("div",{className:"flex items-center justify-between w-full",children:[u.jsxs(fo,{className:"text-sm font-semibold",children:["Adjust tone ",u.jsx("span",{className:"text-gray-500 dark:text-gray-300 text-xs",children:"Optional"})]}),u.jsx(Ai,{src:"/icons/chevron-down.svg",width:20,height:20,alt:"Chevron down",className:`h-5 w-5 text-muted-foreground dark:brightness-0 dark:invert transition-transform duration-200 ${r?"transform rotate-180":""}`})]})}),r&&u.jsxs(Es,{className:"p-4 space-y-4",children:[u.jsxs("div",{className:"space-y-2",children:[u.jsx("p",{className:"text-xs font-semibold text-neutral-700 dark:text-gray-300",children:"Formality"}),u.jsx(ih,{options:["Casual","Neutral","Formal"],value:t,onChange:m=>i(m)})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("p",{className:"text-xs font-semibold text-neutral-700 dark:text-gray-300",children:"Empathy"}),u.jsx(ih,{options:["Low","Neutral","High"],value:n,onChange:m=>c(m)})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("p",{className:"text-xs font-semibold text-neutral-700 dark:text-gray-300",children:"Complexity"}),u.jsx(ih,{options:["Simple","Neutral","Detailed"],value:s,onChange:m=>d(m)})]})]})]}),f9={loading:"Checking for updated information",success:"Case information refreshed just now","no-changes":"No updates found. Draft is up to date.",error:"Couldnt check for updates right now. Draft unchanged."},h9=({fullResponse:r,isGenerating:e,hasError:t,onInsert:n,onRefresh:s,onCreateDraft:i,refreshStatus:c,isRefreshed:d,hasPendingChanges:m,onApplyChanges:p,showApplySuccess:v})=>{if(t&&!r&&!e)return u.jsx(Ss,{className:"mb-2",children:u.jsxs(Es,{className:"p-6 text-center",children:[u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4",children:"Draft not available yet."}),u.jsx(We,{className:"bg-blue-600 hover:bg-blue-700 text-white",onClick:i,children:"Create draft"})]})});if(e)return u.jsxs(Ss,{className:"mb-2",children:[u.jsx(uo,{className:"p-3 border-b dark:border-border",children:u.jsxs(fo,{className:"flex items-center py-0 my-0 text-sm font-semibold",children:[u.jsx(Ai,{src:"/icons/email-icon.svg",width:16,height:16,alt:"Draft",className:"h-4 w-4 text-muted-foreground dark:brightness-0 dark:invert mr-2"}),u.jsx("p",{className:"text-sm font-semibold",children:"Draft"})]})}),u.jsxs(Es,{className:"p-6",children:[u.jsxs("div",{className:"space-y-3 animate-pulse",role:"status","aria-label":"Loading draft",children:[u.jsx("div",{className:"h-3 bg-gray-200 dark:bg-gray-700 rounded w-3/4"}),u.jsx("div",{className:"h-3 bg-gray-200 dark:bg-gray-700 rounded w-full"}),u.jsx("div",{className:"h-3 bg-gray-200 dark:bg-gray-700 rounded w-5/6"}),u.jsx("div",{className:"h-3 bg-gray-200 dark:bg-gray-700 rounded w-2/3"})]}),u.jsxs("div",{className:"flex items-center justify-center mt-4",children:[u.jsx(ia,{className:"h-4 w-4 animate-spin text-blue-600 mr-2"}),u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Preparing your draft"})]})]})]});if(!r)return null;const x=c!=="idle"?f9[c]:d?"Case information refreshed":null;return u.jsxs(Ss,{className:"animate-slide-fade-in mb-2 origin-top",children:[u.jsx(uo,{className:"p-3 border-b dark:border-border",children:u.jsxs(fo,{className:"flex items-center py-0 my-0 text-sm font-semibold",children:[u.jsx(Ai,{src:"/icons/email-icon.svg",width:16,height:16,alt:"Draft",className:"h-4 w-4 text-muted-foreground dark:brightness-0 dark:invert mr-2"}),u.jsx("p",{className:"text-sm font-semibold",children:"Draft"}),u.jsxs(We,{className:"ml-auto bg-blue-600 hover:bg-blue-700 text-white",size:"sm",onClick:n,children:[u.jsx(rB,{className:"w-4 h-4 flex-shrink-0 mr-1"}),"Insert"]})]})}),u.jsxs(Es,{className:"p-6",children:[v?u.jsx("div",{className:"mb-4 flex items-center rounded-md bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 px-3 py-2",children:u.jsx("p",{className:"text-xs text-green-700 dark:text-green-400",children:"Draft updated just now"})}):u.jsxs("div",{className:"mb-4 text-xs text-gray-600 dark:text-gray-400 items-center",children:[x??u.jsx("p",{children:"Based on case information available when this email was received."}),c!=="loading"&&u.jsxs(u.Fragment,{children:[" ",u.jsx("button",{onClick:s,className:"text-blue-600 dark:text-blue-400",title:"Refresh with latest data","aria-label":"Refresh with latest data",children:"Refresh with latest data"})]}),c==="loading"&&u.jsx(ia,{className:"h-3 w-3 animate-spin text-blue-600 ml-2"})]}),u.jsx($R,{htmlString:r}),m&&p&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700 my-4"}),u.jsx(We,{className:"w-full bg-blue-600 hover:bg-blue-700 text-white",size:"sm",onClick:p,children:"Apply changes"}),u.jsx("p",{className:"text-xs text-center text-gray-500 dark:text-gray-400 mt-2",children:"Applies tone and refine settings below"})]})]})]})},An="src/shared/components/sidepanel/panels/GenerateEmailDraftPanelWithPrefetch.tsx",p9="25dc68db26595a7485917129d6993f96",m9="c1c8e460f2105029b2b4563f9222161c",g9=()=>`The response should just be the email body with salutation at the beginning. Do not include a subject line in your response draft.
    Do not add links to the references in your response draft. Do not add citation numbers in your response draft.
    Do not list the references in your response draft, since they will be added in a different section in the JSON response.
    Do not add a complimentary closing or a signature as this will be added later.`.trim(),om=(r,e,t)=>{let n="";switch(r){case"Casual":n+="Keep the tone casual. ";break;case"Neutral":n+="Maintain a neutral tone. ";break;case"Formal":n+="Keep the tone formal. ";break}switch(e){case"Low":n+="Show low empathy. ";break;case"Neutral":n+="Maintain neutral empathy. ";break;case"High":n+="Show high empathy. ";break}switch(t){case"Simple":n+="Keep it simple and use simple words. ";break;case"Neutral":n+="Maintain neutral complexity. ";break;case"Detailed":n+="Provide detailed information and you're free to use harder words. ";break}return n.trim()},v9=({clientEmail:r,onCmsRefresh:e,onGenerateRefreshReady:t})=>{const n=Gr(),s=Qa(),i=ua(),c=dn().platform,{isConnected:d}=Di(),[m,p]=w.useState(!1),[v,x]=w.useState(!1),[b,S]=w.useState("idle"),[N,E]=w.useState(!1),[T,A]=w.useState(!1),[R,F]=w.useState(!0),[j,L]=w.useState(""),[G,z]=w.useState(!1),[q,ae]=w.useState(!0),[oe,fe]=w.useState(null),[H,me]=w.useState(null),[ee,se]=w.useState([]),de=w.useRef(null),[Y,J]=w.useState(""),[$,X]=w.useState("Neutral"),[O,U]=w.useState("Neutral"),[re,Ee]=w.useState("Neutral"),ne=w.useRef(null),we=w.useRef(0),K=w.useRef(0),[he,be]=w.useState(om($,O,re)),[Ie,_t]=w.useState(Y),[Be,Ge]=w.useState(!1),[qe,Ne]=w.useState(!1),[St,ct]=w.useState(""),Ct=w.useMemo(()=>om($,O,re),[$,O,re]),Gt=w.useMemo(()=>g9(),[]),$t=()=>ae(Re=>!Re),Kt=()=>z(Re=>!Re),hr=w.useCallback(async Re=>{const ft="fetchFromStorageProvider";if(!s)return"";try{const Mt=await s.getLocalItem(Re);return Mt&&n.debug("Loaded additional context from storage",{sourceFile:An,functionName:ft}),Mt||""}catch(Mt){return n.error("Error loading additional context from storage",Mt,{sourceFile:An,functionName:ft}),""}},[s,n]);w.useEffect(()=>{const Re="useEffect[threadDataListener]";if(!i){n.debug("DataProvider not available yet",{sourceFile:An,functionName:Re});return}const ft=async Ue=>{const rr=Ue!==null&&Ue.threadId!==de.current;if(Ue){if(n.debug("Thread changed via platform abstraction",{sourceFile:An,functionName:Re,threadId:Ue.threadId,isThreadChanged:rr}),me(Ue.threadId),se(Ue.participants||[]),Ue.messages&&Array.isArray(Ue.messages)&&Ue.messages.length>0&&Ue.messages[0]&&typeof Ue.messages[0]=="object"){const vr=Ue.messages.map((nr,Jt)=>({body:nr.body||nr.html||"",html:nr.html||nr.body||"",from:nr.from||"",timestamp:nr.timestamp||"",subject:Jt===0&&Ue.subject||""}));fe(vr)}const kt=++K.current;if(rr){L(""),p(!1),x(!1),S("idle"),E(!1),ct(""),X("Neutral"),U("Neutral"),Ee("Neutral"),J(""),_t("");const vr=`toneSettings_${Ue.threadId}`,nr=await hr(vr);if(kt!==K.current)return;if(nr)try{const Jt=JSON.parse(nr),$n=["Casual","Neutral","Formal"],Un=["Low","Neutral","High"],Gs=["Simple","Neutral","Detailed"],Cs=$n.includes(Jt.formality)?Jt.formality:"Neutral",Tr=Un.includes(Jt.empathy)?Jt.empathy:"Neutral",yn=Gs.includes(Jt.complexity)?Jt.complexity:"Neutral";X(Cs),U(Tr),Ee(yn),be(om(Cs,Tr,yn))}catch{be(om("Neutral","Neutral","Neutral"))}else be(om("Neutral","Neutral","Neutral"))}if(de.current=Ue.threadId,rr){const vr=`additionalContext_${Ue.threadId}`,nr=await hr(vr);if(kt!==K.current)return;J(nr),_t(nr)}else{const vr=`additionalContext_${Ue.threadId}`,nr=await hr(vr);if(kt!==K.current)return;J(nr)}}else{n.debug("Thread cleared via platform abstraction",{sourceFile:An,functionName:Re});const kt=de.current!==null;me(null),fe(null),se([]),L(""),p(!1),x(!1),S("idle"),E(!1),kt&&(J(""),de.current=null)}};return i.onThreadChanged(ft),(async()=>{try{const Ue=await i.getCurrentThread();await ft(Ue)}catch(Ue){n.error("Error loading current thread",Ue,{sourceFile:An,functionName:"loadCurrentThread"})}})(),()=>{i.removeThreadListener(ft)}},[i,n]),w.useEffect(()=>{const ft=setTimeout(async()=>{const Mt="useEffect[saveAdditionalContext]";if(!(!H||!s))try{const Ue=`additionalContext_${H}`;await s.setLocalItem(Ue,Y)}catch(Ue){n.error("Error saving additional context to storage",Ue,{sourceFile:An,functionName:Mt,threadId:H})}},500);return()=>clearTimeout(ft)},[Y,H,s,n]),w.useEffect(()=>{if(!H||!s)return;const ft=setTimeout(async()=>{try{const Mt=`toneSettings_${H}`;await s.setLocalItem(Mt,JSON.stringify({formality:$,empathy:O,complexity:re}))}catch(Mt){n.error("Error saving tone settings to storage",Mt,{sourceFile:An,functionName:"useEffect[saveToneSettings]",threadId:H})}},500);return()=>clearTimeout(ft)},[$,O,re,H,s,n]),w.useEffect(()=>{const Re=async()=>{try{if(!s)return;const Ue=await s.getLocalItem("useUscis");Ge(Ue??!1),n.debug("uscisIsEnabled loaded from storage via platform abstraction",{sourceFile:An,functionName:"initializeUscisState",uscisEnabled:Ue??!1})}catch(Ue){n.error("Error loading USCIS state",Ue,{sourceFile:An,functionName:"initializeUscisState"})}},ft=async()=>{try{if(!s)return;const Ue=await s.getLocalItem("useOregon");Ne(Ue??!1),n.debug("oregonIsEnabled loaded from storage via platform abstraction",{sourceFile:An,functionName:"initializeOregonState",oregonEnabled:Ue??!1})}catch(Ue){n.error("Error loading Oregon state",Ue,{sourceFile:An,functionName:"initializeOregonState"})}},Mt=async Ue=>{try{Ue.useUscis!==void 0&&(Ge(Ue.useUscis),n.debug("USCIS setting changed via platform abstraction",{sourceFile:An,functionName:"handleStorageChange",useUscis:Ue.useUscis})),Ue.useOregon!==void 0&&(Ne(Ue.useOregon),n.debug("Oregon setting changed via platform abstraction",{sourceFile:An,functionName:"handleStorageChange",useOregon:Ue.useOregon}))}catch(rr){n.error("Error handling storage changes",rr,{sourceFile:An,functionName:"handleStorageChange"})}};return Re(),ft(),s!=null&&s.onChanged&&s.onChanged(Mt),F(!1),()=>{s!=null&&s.removeChangeListener&&Mt&&s.removeChangeListener(Mt)}},[s,n]),w.useEffect(()=>{if(j&&ne.current){const Re=ne.current,Mt=(Re.scrollHeight-Re.clientHeight)*.8;Re.scrollTo({top:Mt,behavior:"smooth"}),n.debug("Scrolling to 90% of bottom after response generation",{sourceFile:An,functionName:"useEffect[fullResponse]"})}},[j,n]);const Ur=w.useCallback(async(Re,ft)=>{p(!0);const Mt="regenerateResponse";try{if(!H){n.error("Thread ID is not set for regeneration",void 0,{sourceFile:An,functionName:Mt}),p(!1);return}const Ue=await IT(ft,Re,n);L(vb(Ue)),p(!1)}catch(Ue){n.error("Error regenerating response",Ue,{sourceFile:An,functionName:Mt}),p(!1)}},[H,n]),zr=w.useCallback(()=>{vS(yS.sanitize(j),n)},[j,n]),kr=w.useCallback(Re=>{ct(Re)},[]),ge=w.useCallback(async Re=>{const ft=++we.current;p(!0);const Mt="handleGenerateResponse";try{const Ue=(oe==null?void 0:oe.map(Jt=>`From: ${Jt.from}
Timestamp: ${Jt.timestamp}
Body: ${Xv(Jt.body)}

`).join(""))||"",rr=[];if(Be&&rr.push(p9),qe&&rr.push(m9),!H){n.error("Thread ID is not set",void 0,{sourceFile:An,functionName:Mt}),p(!1);return}let kt;const vr=(Re==null?void 0:Re.skipCache)??!1;if(c==="outlook"?kt=await RT(H,Ue,Y,Ct,Gt,ee,n,vr):kt=await AT(H,Ue,Y,Ct,Gt,rr,n,vr),ft!==we.current)return;if(kt.response==="error")throw new Error("Server returned error response");const nr=vb(kt.response);L(nr),p(!1),S(Jt=>Jt==="loading"?"success":Jt),kt.refreshed===!0&&E(!0),be(Ct),_t(Y),kt.raw_cms_data&&(e8(kt.raw_cms_data,n),e==null||e())}catch(Ue){n.error("Error generating response",Ue,{sourceFile:An,functionName:Mt}),p(!1),x(!0),S(rr=>rr==="loading"?"error":rr)}},[c,oe,Y,Ct,Gt,Be,qe,H,ee,n,e]),Pe=w.useCallback(async()=>{S("loading"),await ge({skipCache:!0}),e==null||e()},[ge,e]),pt=w.useCallback(async()=>{S("loading"),await ge({skipCache:!0})},[ge]);w.useEffect(()=>{t==null||t(pt)},[t,pt]);const wt=w.useCallback(()=>{x(!1),ge()},[ge]),ze=w.useCallback(async()=>{try{if(Y!==Ie){L(""),await ge({skipCache:!0}),be(Ct),_t(Y),ct(""),A(!0);return}const ft=[];if(Ct!==he&&ft.push(`Rewrite this email draft applying the following tone: ${Ct}`),St.trim()&&ft.push(St.trim()),ft.length===0)return;await Ur(ft.join(`

Also: `),j),be(Ct),ct(""),A(!0)}catch(Re){n.error("Error applying changes",Re,{sourceFile:An,functionName:"handleApplyChanges"})}},[Y,Ct,St,j,Ur,ge,Ie,he,n]),He=(Ct!==he||Y!==Ie||St.trim().length>0)&&!!j&&!m;return w.useEffect(()=>{if(R||!H||!oe||j||m||v||c==="chrome"&&!d)return;let Re=!1;return(()=>{Re||ge()})(),()=>{Re=!0}},[R,H,oe,j,m,v,c,d,ge,n]),w.useEffect(()=>{if(b!=="idle"&&b!=="loading"){const Re=setTimeout(()=>S("idle"),5e3);return()=>clearTimeout(Re)}},[b]),w.useEffect(()=>{if(T){const Re=setTimeout(()=>A(!1),5e3);return()=>clearTimeout(Re)}},[T]),c==="chrome"&&!d?u.jsx("div",{className:"p-4",children:u.jsx(r0,{feature:"Email Composition",description:"Connect your Gmail account to generate personalized email responses",benefits:["Analyze email threads and context automatically","Generate contextually relevant responses","Insert generated content directly into compose box"]})}):u.jsxs("div",{className:"space-y-4 h-full overflow-y-auto overflow-x-hidden",ref:ne,children:[u.jsx(h9,{fullResponse:j,isGenerating:m,hasError:v,onInsert:zr,onRefresh:Pe,onCreateDraft:wt,refreshStatus:b,isRefreshed:N,hasPendingChanges:He,onApplyChanges:ze,showApplySuccess:T}),u.jsx(d9,{isOpen:G,onToggle:Kt,formality:$,empathy:O,complexity:re,onFormalityChange:X,onEmpathyChange:U,onComplexityChange:Ee}),u.jsx(u9,{isOpen:q,onToggle:$t,value:Y,onChange:J,onRefine:kr,onRefineInstructionChange:ct,hasGeneratedResponse:!!j}),u.jsx("div",{className:"mb-24"})]})},y9=()=>{const[r,e]=w.useState(!1),t=Qa(),n=Gr(),s=DT();w.useEffect(()=>{n.info("LoginPanel component loaded",{sourceFile:"src/sidepanel/panels/LoginPanel.tsx"});const c=d=>{d.token&&(e(!1),n.info("Token detected in storage, auth state will be updated automatically",{sourceFile:"src/sidepanel/panels/LoginPanel.tsx"}))};return t!=null&&t.onChanged&&t.onChanged(c),()=>{t!=null&&t.removeChangeListener&&t.removeChangeListener(c)}},[t,n]);const i=async()=>{n.info("Login button clicked",{sourceFile:"src/sidepanel/panels/LoginPanel.tsx"}),e(!0);try{await s.login(),n.info("Login completed successfully",{sourceFile:"src/sidepanel/panels/LoginPanel.tsx"}),e(!1)}catch(c){n.error("Login failed",c,{sourceFile:"src/sidepanel/panels/LoginPanel.tsx"}),e(!1)}};return u.jsxs("div",{className:"flex flex-col items-center justify-center h-full px-6 bg-gradient-to-b from-blue-50/30 to-white dark:from-gray-900 dark:to-gray-950 animate-fade-in",children:[u.jsx("div",{className:"flex items-center justify-center max-w-md w-full mb-8",children:u.jsxs("svg",{width:"400",height:"200",viewBox:"0 0 400 300",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"w-full h-auto max-h-[200px] drop-shadow-lg",children:[u.jsxs("defs",{children:[u.jsxs("linearGradient",{id:"emailGradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[u.jsx("stop",{offset:"0%",style:{stopColor:"#EEF2FF",stopOpacity:1}}),u.jsx("stop",{offset:"100%",style:{stopColor:"#E0E7FF",stopOpacity:1}})]}),u.jsxs("linearGradient",{id:"glowGradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[u.jsx("stop",{offset:"0%",style:{stopColor:"#818CF8",stopOpacity:.6}}),u.jsx("stop",{offset:"100%",style:{stopColor:"#4F46E5",stopOpacity:.3}})]}),u.jsxs("filter",{id:"glow",children:[u.jsx("feGaussianBlur",{stdDeviation:"4",result:"coloredBlur"}),u.jsxs("feMerge",{children:[u.jsx("feMergeNode",{in:"coloredBlur"}),u.jsx("feMergeNode",{in:"SourceGraphic"})]})]})]}),u.jsx("circle",{cx:"200",cy:"150",r:"120",fill:"url(#glowGradient)",opacity:"0.3",className:"animate-pulse-slow"}),u.jsx("circle",{cx:"200",cy:"150",r:"80",fill:"url(#glowGradient)",opacity:"0.2",className:"animate-pulse-slow",style:{animationDelay:"0.5s"}}),u.jsxs("g",{className:"animate-float",children:[u.jsx("rect",{x:"100",y:"80",width:"200",height:"140",rx:"8",fill:"url(#emailGradient)",stroke:"#6366F1",strokeWidth:"2"}),u.jsx("line",{x1:"120",y1:"110",x2:"240",y2:"110",stroke:"#94A3B8",strokeWidth:"2",strokeLinecap:"round"}),u.jsx("line",{x1:"120",y1:"130",x2:"260",y2:"130",stroke:"#94A3B8",strokeWidth:"2",strokeLinecap:"round"}),u.jsx("line",{x1:"120",y1:"150",x2:"230",y2:"150",stroke:"#94A3B8",strokeWidth:"2",strokeLinecap:"round"}),u.jsx("line",{x1:"120",y1:"170",x2:"250",y2:"170",stroke:"#94A3B8",strokeWidth:"2",strokeLinecap:"round"}),u.jsx("line",{x1:"120",y1:"190",x2:"210",y2:"190",stroke:"#94A3B8",strokeWidth:"2",strokeLinecap:"round"})]}),u.jsxs("g",{className:"animate-sparkle",children:[u.jsx("circle",{cx:"80",cy:"60",r:"4",fill:"#818CF8",filter:"url(#glow)"}),u.jsx("path",{d:"M 80 50 L 82 58 L 90 60 L 82 62 L 80 70 L 78 62 L 70 60 L 78 58 Z",fill:"#818CF8",filter:"url(#glow)"})]}),u.jsxs("g",{className:"animate-sparkle",style:{animationDelay:"0.7s"},children:[u.jsx("circle",{cx:"320",cy:"80",r:"3",fill:"#4F46E5",filter:"url(#glow)"}),u.jsx("path",{d:"M 320 72 L 321.5 78 L 328 80 L 321.5 82 L 320 88 L 318.5 82 L 312 80 L 318.5 78 Z",fill:"#4F46E5",filter:"url(#glow)"})]}),u.jsxs("g",{className:"animate-sparkle",style:{animationDelay:"1.4s"},children:[u.jsx("circle",{cx:"310",cy:"230",r:"3.5",fill:"#818CF8",filter:"url(#glow)"}),u.jsx("path",{d:"M 310 221 L 311.8 227.5 L 319 230 L 311.8 232.5 L 310 239 L 308.2 232.5 L 301 230 L 308.2 227.5 Z",fill:"#818CF8",filter:"url(#glow)"})]}),u.jsxs("g",{className:"animate-sparkle",style:{animationDelay:"0.3s"},children:[u.jsx("circle",{cx:"90",cy:"240",r:"3",fill:"#6366F1",filter:"url(#glow)"}),u.jsx("path",{d:"M 90 233 L 91.5 238 L 97 240 L 91.5 242 L 90 247 L 88.5 242 L 83 240 L 88.5 238 Z",fill:"#6366F1",filter:"url(#glow)"})]}),u.jsxs("g",{className:"animate-sparkle",style:{animationDelay:"1s"},children:[u.jsx("circle",{cx:"320",cy:"150",r:"5",fill:"#4F46E5",filter:"url(#glow)"}),u.jsx("path",{d:"M 320 138 L 323 147 L 333 150 L 323 153 L 320 162 L 317 153 L 307 150 L 317 147 Z",fill:"#4F46E5",filter:"url(#glow)"})]}),u.jsx("circle",{cx:"85",cy:"150",r:"2.5",fill:"#818CF8",opacity:"0.6",className:"animate-sparkle"}),u.jsx("circle",{cx:"315",cy:"200",r:"2",fill:"#6366F1",opacity:"0.5",className:"animate-sparkle",style:{animationDelay:"0.5s"}}),u.jsx("circle",{cx:"280",cy:"70",r:"2",fill:"#4F46E5",opacity:"0.6",className:"animate-sparkle",style:{animationDelay:"1s"}})]})}),u.jsxs("div",{className:"text-center mb-6 space-y-3 animate-slide-up",children:[u.jsxs("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white leading-tight",children:["Legal emails,",u.jsx("br",{}),"effortlessly handled"]}),u.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 max-w-xs mx-auto",children:"AI-powered email assistant for legal professionals"})]}),u.jsx("div",{className:"w-full max-w-xs animate-slide-up",style:{animationDelay:"0.2s"},children:u.jsx(We,{onClick:i,className:"w-full h-12 text-base font-medium shadow-lg hover:shadow-xl transition-all duration-200 hover:scale-[1.02] bg-blue-600 hover:bg-blue-700 dark:bg-blue-600 dark:hover:bg-blue-700",disabled:r,children:r?u.jsxs("span",{className:"flex items-center justify-center gap-2",children:[u.jsxs("svg",{className:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[u.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),u.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Logging in..."]}):"Get Started"})})]})},x9=[{available:!0,id:"gmail",name:"Gmail",description:"Connect your Gmail account to access your email",authMethod:"oauth",authUrl:$_(M_),logo:"/gmail.svg",homeUrl:"https://mail.google.com",isConnected:!1,category:"email"},{available:!0,id:"filevine",name:"Filevine",description:"Connect your Filevine account to access case status",authMethod:"custom",authUrl:"https://identity.filevine.com/",customAuthFields:[{id:"clientId",displayName:"Client ID",type:"text"},{id:"clientSecret",displayName:"Client Secret",type:"text"},{id:"PAT",displayName:"Personal Access Token",type:"text"},{id:"organizationId",displayName:"Organization ID",type:"text"},{id:"userId",displayName:"User ID",type:"text"}],logo:"/filevine.svg",homeUrl:"https://identity.filevine.com/",isConnected:!1,category:"case_management"},{available:!0,id:"clio",name:"Clio",description:"Connect your Clio account to access case status",authMethod:"server",authUrl:U_+"clio",logo:"/clio.svg",homeUrl:"https://app.clio.com",isConnected:!1,category:"case_management"},{available:!1,id:"drive",name:"Google Drive",description:"Connect your Google account to access files on Drive",authMethod:"oauth",authUrl:"/api/auth/google",logo:"/google.svg",homeUrl:"https://drive.google.com",isConnected:!1,category:"data_management"},{available:!1,id:"onedrive",name:"OneDrive",description:"Connect your Microsoft account to access files on OneDrive",authMethod:"oauth",authUrl:"/api/auth/onedrive",logo:"/onedrive.svg",homeUrl:"https://onedrive.live.com",isConnected:!1,category:"data_management"}],_I=[{available:!0,id:"inszoom",name:"INSZoom",description:"Connect your INSZoom account to access case status",authMethod:"custom",authUrl:"https://global.inszoom.com/",logo:"/inszoom.ico",customAuthFields:[{id:"auth_key",displayName:"Authorization Key",type:"text"},{id:"subscription_key",displayName:"Subscription Key",type:"text"},{id:"case_status_report",displayName:"Latest Case Status Report",type:"file"}],homeUrl:"https://global.inszoom.com",isConnected:!1,category:"case_management"},{available:!1,id:"drive",name:"Google Drive",description:"Connect your Google account to access files on Drive",authMethod:"oauth",authUrl:"/api/auth/google",logo:"/google.svg",homeUrl:"https://drive.google.com",isConnected:!1,category:"data_management"},{available:!1,id:"onedrive",name:"OneDrive",description:"Connect your Microsoft account to access files on OneDrive",authMethod:"oauth",authUrl:"/api/auth/onedrive",logo:"/onedrive.svg",homeUrl:"https://onedrive.live.com",isConnected:!1,category:"data_management"}],Ir="src/lib/utils/integrationUtils.tsx";async function ES(r){const e=x9.find(n=>n.id===r);return e||_I.find(n=>n.id===r)||null}async function w9(r){return _I.find(e=>e.id===r)||null}async function SI(r,e,t,n,s){if(e.authMethod==="server")throw new Error("Integration is a server integration which shouldn't be initiated by the extension");r.info("Initiating integration process for integration:",{sourceFile:Ir,integrationId:e});try{let i;if(s&&Object.keys(s).length>0){r.info("Starting file serialization process",{sourceFile:Ir,fileCount:Object.keys(s).length});const d=100*1024*1024;for(const[m,p]of Object.entries(s))if(p.size>d){const v=`File "${p.name}" exceeds 100MB limit. File size: ${(p.size/1048576).toFixed(2)}MB`;throw r.error("File size validation failed",new Error(v),{sourceFile:Ir,fieldId:m,fileName:p.name,fileSize:p.size,maxSize:d}),new Error(v)}i={};for(const[m,p]of Object.entries(s)){const v=await Nx(p);r.info("Original file checksum calculated",{sourceFile:Ir,fieldId:m,fileName:p.name,fileSize:p.size,fileType:p.type,originalChecksum:v});const x=await p.arrayBuffer(),b=new Uint8Array(x),S=await Nx(x);r.info("ArrayBuffer checksum calculated",{sourceFile:Ir,fieldId:m,fileName:p.name,bufferChecksum:S,bufferSize:x.byteLength,checksumMatch:v===S});let N="";const E=8192;for(let L=0;L<b.length;L+=E){const G=b.slice(L,L+E);N+=String.fromCharCode(...G)}const T=btoa(N),A=atob(T),R=new ArrayBuffer(A.length),F=new Uint8Array(R);for(let L=0;L<A.length;L++)F[L]=A.charCodeAt(L);const j=await Nx(R);i[m]={name:p.name,type:p.type,size:p.size,data:T},r.info("File serialization completed",{sourceFile:Ir,fieldId:m,fileName:p.name,fileSize:p.size,base64Length:T.length,originalChecksum:v,bufferChecksum:S,decodedChecksum:j,allChecksumsMatch:v===S&&S===j})}r.info("All files serialized successfully",{sourceFile:Ir,serializedFileCount:Object.keys(i).length})}const c=await Kn.createServices();if(c.messaging.sendMessage){const d=await c.messaging.sendMessage({type:"INITIATE_INTEGRATION",integration:e,authUrl:t,credentials:n,files:i});if(!d.success)throw new Error(d.error||"Integration failed");return r.info("Integration initiated successfully",{sourceFile:Ir}),d.success}else{const d=await chrome.runtime.sendMessage({type:"INITIATE_INTEGRATION",integration:e,authUrl:t,credentials:n,files:i});if(!d.success)throw new Error(d.error||"Integration failed");return r.info("Integration initiated successfully",{sourceFile:Ir}),d.success}}catch(i){throw r.error("Integration failed:",i,{sourceFile:Ir}),i}}async function b9(r,e){try{const t=await Kn.createServices();if(t.messaging.sendMessage){const n=await t.messaging.sendMessage({type:"DISCONNECT_INTEGRATION",integration:e});if(!n.success)throw new Error(n.error||"Disconnection failed");return r.info("Integration disconnected successfully",{sourceFile:Ir}),n.success}else{const n=await chrome.runtime.sendMessage({type:"DISCONNECT_INTEGRATION",integration:e});if(!n.success)throw new Error(n.error||"Disconnection failed");return r.info("Integration disconnected successfully",{sourceFile:Ir}),n.success}}catch(t){throw r.error("Disconnection failed:",t,{sourceFile:Ir}),t}}async function EI(r){const e="isCaseManagementSystemIntegrationConnected";try{r.debug("Starting CMS integration check",{sourceFile:Ir,functionName:e});const t=await Jm(r);r.debug("Local integrations retrieved",{sourceFile:Ir,functionName:e,count:t.length,integrations:t.map(p=>p.integration_type)});const n=t.some(p=>p.integration_type==="filevine"||p.integration_type==="clio"||p.integration_type==="inszoom");if(r.debug("Local CMS integration check result",{sourceFile:Ir,functionName:e,isConnectedLocally:n}),n)return r.info("CMS integration found in local storage",{sourceFile:Ir,functionName:e}),!0;const[s,i]=await Promise.all([Jc("user",r).catch(()=>[]),Jc("tenant",r).catch(()=>[])]),c=s.map(p=>({integration_type:p.integration_type,tenantId_userId:p.tenantId_userId,scope:"user"})),d=i.map(p=>({integration_type:p.integration_type,tenantId_userId:p.tenantId_userId,scope:"tenant"})),m=[...c,...d];return await Ym(r,m),m.some(p=>p.integration_type==="filevine"||p.integration_type==="clio"||p.integration_type==="inszoom");return r.info("Final CMS integration check result",{sourceFile:Ir,functionName:e,isConnectedOnServer}),isConnectedOnServer}catch(t){return r.error("Failed to check if CMS integration is connected",t,{sourceFile:Ir,functionName:e}),!1}}async function _9(r,e){try{if((await Jm(r)).some(p=>p.integration_type===e))return!0;const[s,i]=await Promise.all([Jc("user",r).catch(()=>[]),Jc("tenant",r).catch(()=>[])]),c=s.map(p=>({integration_type:p.integration_type,tenantId_userId:p.tenantId_userId,scope:"user"})),d=i.map(p=>({integration_type:p.integration_type,tenantId_userId:p.tenantId_userId,scope:"tenant"})),m=[...c,...d];return await Ym(r,m),m.some(p=>p.integration_type===e)||!1}catch(t){return r.warn("Failed to check if integration is connected:",{sourceFile:Ir,integrationId:e,error:t}),!1}}async function CI(r){try{r.info("Refreshing integrations from server",{sourceFile:Ir}),await nT(r);const[e,t]=await Promise.all([Jc("user",r).catch(()=>[]),Jc("tenant",r).catch(()=>[])]),n=e.map(c=>({integration_type:c.integration_type,tenantId_userId:c.tenantId_userId,scope:"user"})),s=t.map(c=>({integration_type:c.integration_type,tenantId_userId:c.tenantId_userId,scope:"tenant"})),i=[...n,...s];return await Ym(r,i),r.info("Refreshed integrations from server",{sourceFile:Ir,userCount:n.length,tenantCount:s.length,totalCount:i.length}),!0}catch(e){return r.warn("Failed to refresh integrations:",{sourceFile:Ir,error:e}),!1}}async function kI(r){try{const e=await Jm(r);if(e.length>0)return e;const[t,n]=await Promise.all([Jc("user",r).catch(d=>(r.warn("Failed to fetch user integrations:",{sourceFile:Ir,error:d}),[])),Jc("tenant",r).catch(d=>(r.warn("Failed to fetch tenant integrations:",{sourceFile:Ir,error:d}),[]))]),s=t.map(d=>({...d,scope:"user"})),i=n.map(d=>({...d,scope:"tenant"})),c=[...s,...i];return await Ym(r,c),r.info("Saved merged integrations to local storage",{sourceFile:Ir,userCount:s.length,tenantCount:i.length,totalCount:c.length,integrations:c}),c}catch(e){return r.error("Failed to list integrations:",e,{sourceFile:Ir}),[]}}async function S9(r,e){try{return(await Jm(r)).find(n=>n.integration_type===e)||null}catch(t){return r.error("Failed to get integration details:",t,{sourceFile:Ir}),null}}async function E9(r,e){var i;const t=await iy(r),n=((i=t.integrations)==null?void 0:i.filter(c=>c.integration_type!==e.integration_type))||[];n.push(e);const s={...t,integrations:n};await eT(r,s)}async function C9(r,e){var i;const t=await iy(r),n=((i=t.integrations)==null?void 0:i.filter(c=>c.integration_type!==e))||[],s={...t,integrations:n};await eT(r,s)}async function k9(r,e){if(!e)throw new Error("Integration not found");if(e.authMethod!=="server")throw new Error("Integration is not a server integration");try{const t=await Om(r);if(!t)throw r.warn("Failed to get authentication token",{sourceFile:Ir}),new Error("Authentication required. Please log in first.");const n=`${U_}${e.id}?token=${encodeURIComponent(t.id_token)}`;r.debug("Opening server auth page",{sourceFile:Ir,integrationId:e.id}),window.open(n,"_blank")}catch(t){throw r.error("Failed to open server auth page:",t,{sourceFile:Ir}),t}}async function N9(r){try{return await nT(r),await pT(r),!0}catch(e){return r.error("Failed to clear integration data:",e,{sourceFile:Ir}),!1}}const T9=Object.freeze(Object.defineProperty({__proto__:null,clearIntegrationData:N9,disconnectIntegration:b9,findIntegrationById:ES,findOrgIntegrationById:w9,getIntegrationDetails:S9,initiateIntegration:SI,isCaseManagementSystemIntegrationConnected:EI,isIntegrationConnected:_9,listIntegrations:kI,openServerAuthPageForIntegration:k9,refreshIntegrations:CI,removeIntegrationDetails:C9,saveIntegrationDetails:E9},Symbol.toStringTag,{value:"Module"})),im="src/components/ui/DetailsTable.tsx",u1=r=>u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",width:"16",height:"16",...r,className:`inline-block w-4 h-4 ${r.className||""}`,children:[u.jsx("path",{d:"M11 3a1 1 0 100 2h2.586l-6.293 6.293a1 1 0 101.414 1.414L15 6.414V9a1 1 0 102 0V4a1 1 0 00-1-1h-5z"}),u.jsx("path",{d:"M5 5a2 2 0 00-2 2v8a2 2 0 002 2h8a2 2 0 002-2v-3a1 1 0 10-2 0v3H5V7h3a1 1 0 000-2H5z"})]}),Ql=({details:r,linkableFields:e})=>{const t=Gr(),[n,s]=_r.useState(new Set),[i,c]=_r.useState(new Set),d=80;if(!r)return t.debug("No important details to render",{sourceFile:im}),null;if(Object.keys(r).length===0)return t.debug("No important details to render",{sourceFile:im}),null;const m=N=>{const E=document.createElement("textarea");E.value=N,E.style.position="fixed",E.style.opacity="0",document.body.appendChild(E),E.select();const T=document.execCommand("copy");return document.body.removeChild(E),T},p=(N,E)=>{navigator.clipboard.writeText(N).then(()=>{t.debug("Copied to clipboard",{sourceFile:im,copiedValue:N}),c(T=>new Set([...T,E])),setTimeout(()=>{c(T=>{const A=new Set(T);return A.delete(E),A})},2e3)}).catch(T=>{t.error("Failed to copy with navigator.clipboard.writeText",T,{sourceFile:im});try{m(N)&&(c(A=>new Set([...A,E])),setTimeout(()=>{c(A=>{const R=new Set(A);return R.delete(E),R})},2e3))}catch(A){t.error("Failed to copy with document.execCommand",A,{sourceFile:im})}})},v=N=>{const E=new Set(n);E.has(N)?E.delete(N):E.add(N),s(E)},x=N=>{if(!N)return"";try{return new Date(N).toLocaleDateString(void 0,{timeZone:"UTC"})}catch{return N}},b=N=>{try{const E=new URL(N);return E.protocol==="http:"||E.protocol==="https:"}catch{return!1}},S=N=>N.split(/(\[\[.*?\]\]|\(\(.*?\)\))/g).map((T,A)=>{if(T.startsWith("[[")&&T.endsWith("]]")){const R=T.slice(2,-2);return u.jsx("span",{className:"font-semibold",children:R},A)}else if(T.startsWith("((")&&T.endsWith("))")){const R=T.slice(2,-2);return/^\d{4}-\d{2}-\d{2}/.test(R)?u.jsx("span",{className:"text-base",children:x(R)},A):u.jsx("span",{className:"text-base",children:R},A)}return T});return u.jsx("div",{className:"p-1",children:u.jsx("table",{className:"w-full text-sm text-left text-gray-700 dark:text-gray-300 table-fixed",children:u.jsx("tbody",{children:Object.entries(r).map(([N,E],T)=>{let A;E===""||E===null||E===void 0?A="":typeof E=="string"||typeof E=="number"?A=String(E):A=JSON.stringify(E);const R=e==null?void 0:e.find(z=>z.field===N),F=b(A),j=A.length>d,L=n.has(T),G=j&&!L?A.substring(0,d)+"...":A;return u.jsxs("tr",{className:"bg-card",children:[u.jsx("td",{className:"py-2 px-3 whitespace-normal font-medium w-2/5 text-gray-800 dark:text-gray-200",children:R?u.jsxs("a",{href:R.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 dark:text-blue-400 hover:underline whitespace-normal hover:text-blue-800 dark:hover:text-blue-300 flex items-center gap-1",children:[N,u.jsx(u1,{})]}):N}),u.jsx("td",{className:`py-2 px-3 whitespace-pre-wrap break-words ${F?"":"hover:bg-gray-100 dark:hover:bg-muted"}`,style:F?{}:{cursor:`url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>') 10 10, copy`},onClick:()=>!F&&!j&&p(A,T),title:F?"Click to open link":j?"":"Click to copy",children:F?u.jsxs("a",{href:A,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 dark:text-blue-400 hover:underline break-words flex items-center gap-1",children:[S(A),u.jsx(u1,{className:"flex-shrink-0"})]}):u.jsxs("div",{children:[u.jsxs("div",{className:"relative",children:[u.jsx("span",{className:"break-words text-gray-700 dark:text-gray-300",onClick:()=>!j&&p(A,T),children:S(G)}),i.has(T)&&u.jsx("span",{className:"absolute -top-1 -right-1 bg-white dark:bg-gray-700 text-black dark:text-white text-xs px-2 py-1 rounded-full shadow-lg border border-gray-300 dark:border-gray-600",children:"Copied!"})]}),j&&u.jsx("div",{className:"mt-1",children:u.jsx("button",{onClick:z=>{z.stopPropagation(),v(T)},className:"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 underline text-sm",children:L?"show less":"show more"})})]})})]},T)})})})})},Rn="src/shared/components/sidepanel/mainPanelContent/EmailSummaryBox.tsx",A9=()=>{const[r,e]=w.useState(""),[t,n]=w.useState(null),[s,i]=w.useState(null),[c,d]=w.useState(!1),[m,p]=w.useState(!0),[v,x]=w.useState(!1),[b,S]=w.useState("summary"),[N,E]=w.useState(null),[T,A]=w.useState(null),[R,F]=w.useState(0),{platform:j}=dn(),L=ua(),G=Gr(),z=w.useRef(null),q=w.useRef(null),ae=w.useRef(!1),oe=["Analyzing email content...","Extracting key information...","Identifying important details...","Generating summary...","Finalizing insights..."];w.useEffect(()=>{let Y;const J=()=>{if(c){const $=Math.floor(Math.random()*1500)+500;Y=setTimeout(()=>{F(X=>(X+1)%oe.length),J()},$)}};return c&&J(),()=>{Y&&clearTimeout(Y)}},[c,oe.length]);const fe=w.useCallback(async Y=>{if(ae.current&&z.current===Y){G.debug("Already loading summary for thread:",{threadId:Y,sourceFile:Rn});return}z.current=Y,d(!0),ae.current=!0;try{const J=await t8(Y,G);z.current===Y?(G.debug("Summary response:",{summaryResponse:J,sourceFile:Rn}),e(J.summary),E(J.importantDetails),d(!1),ae.current=!1):G.debug("Ignoring summary response for outdated thread:",{threadId:Y,sourceFile:Rn})}catch(J){G.error("Error fetching email summary:",J,{sourceFile:Rn}),z.current===Y&&(d(!1),ae.current=!1)}},[G]),H=w.useCallback(async(Y,J)=>{if(ae.current&&z.current===Y){G.debug("Already loading summary for thread:",{threadId:Y,sourceFile:Rn});return}z.current=Y,d(!0),ae.current=!0;const $=await W5(Y,G);if($){G.debug("Using cached summary for thread:",{threadId:Y,sourceFile:Rn}),e($.summary),E($.importantDetails),d(!1),ae.current=!1;return}try{if(!J){G.warn("No thread data found",{sourceFile:Rn,functionName:"fetchEmailSummaryForOutlook"}),d(!1),ae.current=!1;return}const X=await r8(J,G);z.current===Y?(G.debug("Summary response:",{summaryResponse:X,sourceFile:Rn}),await G5(Y,X.summary,X.importantDetails,G),e(X.summary),E(X.importantDetails),d(!1),ae.current=!1):G.debug("Ignoring summary response for outdated thread:",{threadId:Y,sourceFile:Rn})}catch(X){G.error("Error fetching email summary for Outlook:",X,{sourceFile:Rn}),z.current===Y&&(d(!1),ae.current=!1,e("Error fetching email summary. Please try again."))}},[G]);w.useEffect(()=>{const Y=async()=>{G.info("Checking if Gmail is connected",{sourceFile:Rn});const $=await By(G);G.info("Gmail connection check result",{connected:$,sourceFile:Rn}),p($)},J=async()=>{try{const X=(await Kn.createServices()).storage;if(X.onChanged){const O=U=>{if(U.gmailConnectionStatus){const re=U.gmailConnectionStatus.newValue;G.info("Gmail connection status changed via storage",{sourceFile:Rn,newStatus:re,oldStatus:U.gmailConnectionStatus.oldValue}),p(!0)}};return X.onChanged(O),()=>{X.removeChangeListener&&X.removeChangeListener(O)}}}catch($){G.error("Failed to set up storage listener:",$,{sourceFile:Rn})}};if(j==="chrome"){const X=(async()=>(await Y(),await J()))();return()=>{X.then(O=>O==null?void 0:O())}}else j==="outlook"&&(p(!1),console.log("Not calling checkGmailConnection for Outlook"))},[j,G]),w.useEffect(()=>{if(L!=null&&L.onThreadChanged){const Y=$=>{if(G.debug("Thread change received",{sourceFile:Rn,functionName:"handleThreadChange",hasThread:!!$,threadId:$==null?void 0:$.threadId,platform:j}),!$){G.debug("No thread provided, keeping current state",{sourceFile:Rn}),n(null),i(null);return}if(n($.threadId||null),G.debug("Thread ID set",{sourceFile:Rn,threadId:$.threadId}),$.messages&&Array.isArray($.messages)&&$.messages.length>0&&$.messages[0]&&typeof $.messages[0]=="object"){const X=$.messages.map((O,U)=>({body:O.body||O.html||"",html:O.html||O.body||"",from:O.from||"",timestamp:O.timestamp||"",subject:U===0&&$.subject||""}));i(JSON.stringify(X)),G.debug("Thread data converted and set",{sourceFile:Rn,messageCount:X.length})}};return L.onThreadChanged(Y),(async()=>{try{const $=await L.getCurrentThread();Y($)}catch($){G.error("Error loading current thread",$,{sourceFile:Rn,functionName:"loadCurrentThread"})}})(),()=>{L.removeThreadListener&&L.removeThreadListener(Y)}}},[L,j,G]),w.useEffect(()=>{t&&m&&j==="chrome"?(t!==z.current||!ae.current)&&fe(t):!m&&j==="chrome"?(e("Connect to Gmail to enable email summaries"),E(null),S("summary"),z.current=null,ae.current=!1,d(!1)):!m&&j==="outlook"&&s&&t?(t!==z.current||!ae.current)&&H(t||"",s):(e("Select a thread to summarize"),E(null),S("summary"),z.current=null,ae.current=!1,d(!1))},[t,m,fe,H,j,s]);const me=async()=>{try{x(!0);const Y=$_(M_),J=await ES("gmail");if(!J){G.error("Gmail integration not found",new Error("Gmail integration not found"),{sourceFile:Rn});return}await SI(G,J,Y)&&(p(!0),t&&fe(t))}catch(Y){G.error("Failed to connect to Gmail:",Y,{sourceFile:Rn}),e("Failed to connect to Gmail. Please try again.")}finally{x(!1)}},ee=()=>N?u.jsx(Ql,{details:N}):null,se=()=>{b==="summary"&&q.current&&(A(q.current.offsetHeight),S("details"))},de=N!==null&&Object.keys(N).length>0;return w.useEffect(()=>{de||S("summary")},[de]),w.useEffect(()=>{T&&document.documentElement.style.setProperty("--content-height",`${T}px`)},[T]),u.jsxs("div",{className:"w-full max-w-full min-h-[3rem] border rounded-lg shadow-sm bg-white mx-2 mt-1 mb-2 overflow-hidden box-border border-b-0",title:"Email Summary",style:{maxWidth:"calc(100% - 1rem)"},children:[u.jsx("div",{className:"flex items-center justify-center py-1 px-2 border-b bg-gray-150 min-w-0",children:u.jsxs("div",{className:"flex items-center gap-1 bg-gray-150 p-1 rounded-full",children:[u.jsxs("button",{className:`px-3 py-1.5 rounded-full text-sm font-medium transition-colors whitespace-nowrap flex items-center gap-1.5 ${b==="summary"?"text-blue-700 border bg-white border-blue-200":"bg-gray-75 text-gray-600 hover:bg-gray-100 border border-gray-200"}`,onClick:()=>S("summary"),children:[u.jsx(Xc,{className:"w-3.5 h-3.5"}),"Summary"]}),de&&u.jsxs("button",{className:`px-3 py-1.5 rounded-full text-sm font-medium transition-colors flex items-center gap-1.5 whitespace-nowrap ${b==="details"?"text-blue-700 border bg-white border-blue-200":"bg-gray-75 text-gray-600 hover:bg-gray-100 border border-gray-200"}`,onClick:se,children:[u.jsx(Ai,{src:"/icons/info-circled.svg",width:14,height:14,alt:"Info",className:"w-3.5 h-3.5"}),"Key Points"]})]})}),u.jsx("div",{className:"w-full min-w-0",children:c?u.jsxs("div",{className:"w-full border rounded flex flex-col items-center justify-center bg-gray-50 p-4",children:[u.jsx(ia,{className:"h-8 w-8 animate-spin text-blue-600"}),u.jsx("div",{className:"text-center text-sm text-gray-500",children:oe[R]})]}):!m&&j==="chrome"?u.jsxs("div",{className:"w-full p-4 flex flex-col items-center justify-center",children:[u.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Connect to Gmail to enable email summaries"}),u.jsx(We,{onClick:me,className:"w-full bg-blue-600 hover:bg-blue-700 text-white py-4 mt-2",disabled:v,children:v?"Connecting...":"Connect Gmail"})]}):u.jsx("div",{className:"w-full min-w-0 overflow-hidden",children:b==="summary"?u.jsx("div",{ref:q,className:"p-3 text-sm text-gray-600 whitespace-pre-wrap break-words overflow-wrap-anywhere",children:r}):u.jsx("div",{className:"overflow-y-auto",children:ee()})})})]})};function d1(r){const e=R9(r),t=w.forwardRef((n,s)=>{const{children:i,...c}=n,d=w.Children.toArray(i),m=d.find(P9);if(m){const p=m.props.children,v=d.map(x=>x===m?w.Children.count(p)>1?w.Children.only(null):w.isValidElement(p)?p.props.children:null:x);return u.jsx(e,{...c,ref:s,children:w.isValidElement(p)?w.cloneElement(p,void 0,v):null})}return u.jsx(e,{...c,ref:s,children:i})});return t.displayName=`${r}.Slot`,t}function R9(r){const e=w.forwardRef((t,n)=>{const{children:s,...i}=t;if(w.isValidElement(s)){const c=j9(s),d=F9(i,s.props);return s.type!==w.Fragment&&(d.ref=n?tu(n,c):c),w.cloneElement(s,d)}return w.Children.count(s)>1?w.Children.only(null):null});return e.displayName=`${r}.SlotClone`,e}var I9=Symbol("radix.slottable");function P9(r){return w.isValidElement(r)&&typeof r.type=="function"&&"__radixId"in r.type&&r.type.__radixId===I9}function F9(r,e){const t={...e};for(const n in e){const s=r[n],i=e[n];/^on[A-Z]/.test(n)?s&&i?t[n]=(...d)=>{const m=i(...d);return s(...d),m}:s&&(t[n]=s):n==="style"?t[n]={...s,...i}:n==="className"&&(t[n]=[s,i].filter(Boolean).join(" "))}return{...r,...t}}function j9(r){var n,s;let e=(n=Object.getOwnPropertyDescriptor(r.props,"ref"))==null?void 0:n.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=(s=Object.getOwnPropertyDescriptor(r,"ref"))==null?void 0:s.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}function CS(r){const e=r+"CollectionProvider",[t,n]=Za(e),[s,i]=t(e,{collectionRef:{current:null},itemMap:new Map}),c=E=>{const{scope:T,children:A}=E,R=_r.useRef(null),F=_r.useRef(new Map).current;return u.jsx(s,{scope:T,itemMap:F,collectionRef:R,children:A})};c.displayName=e;const d=r+"CollectionSlot",m=d1(d),p=_r.forwardRef((E,T)=>{const{scope:A,children:R}=E,F=i(d,A),j=Mn(T,F.collectionRef);return u.jsx(m,{ref:j,children:R})});p.displayName=d;const v=r+"CollectionItemSlot",x="data-radix-collection-item",b=d1(v),S=_r.forwardRef((E,T)=>{const{scope:A,children:R,...F}=E,j=_r.useRef(null),L=Mn(T,j),G=i(v,A);return _r.useEffect(()=>(G.itemMap.set(j,{ref:j,...F}),()=>void G.itemMap.delete(j))),u.jsx(b,{[x]:"",ref:L,children:R})});S.displayName=v;function N(E){const T=i(r+"CollectionConsumer",E);return _r.useCallback(()=>{const R=T.collectionRef.current;if(!R)return[];const F=Array.from(R.querySelectorAll(`[${x}]`));return Array.from(T.itemMap.values()).sort((G,z)=>F.indexOf(G.ref.current)-F.indexOf(z.ref.current))},[T.collectionRef,T.itemMap])}return[{Provider:c,Slot:p,ItemSlot:S},N,n]}var O9=w.createContext(void 0);function o0(r){const e=w.useContext(O9);return r||e||"ltr"}var fw="rovingFocusGroup.onEntryFocus",D9={bubbles:!1,cancelable:!0},sg="RovingFocusGroup",[xb,NI,L9]=CS(sg),[M9,i0]=Za(sg,[L9]),[$9,U9]=M9(sg),TI=w.forwardRef((r,e)=>u.jsx(xb.Provider,{scope:r.__scopeRovingFocusGroup,children:u.jsx(xb.Slot,{scope:r.__scopeRovingFocusGroup,children:u.jsx(z9,{...r,ref:e})})}));TI.displayName=sg;var z9=w.forwardRef((r,e)=>{const{__scopeRovingFocusGroup:t,orientation:n,loop:s=!1,dir:i,currentTabStopId:c,defaultCurrentTabStopId:d,onCurrentTabStopIdChange:m,onEntryFocus:p,preventScrollOnEntryFocus:v=!1,...x}=r,b=w.useRef(null),S=Mn(e,b),N=o0(i),[E,T]=ru({prop:c,defaultProp:d??null,onChange:m,caller:sg}),[A,R]=w.useState(!1),F=Xl(p),j=NI(t),L=w.useRef(!1),[G,z]=w.useState(0);return w.useEffect(()=>{const q=b.current;if(q)return q.addEventListener(fw,F),()=>q.removeEventListener(fw,F)},[F]),u.jsx($9,{scope:t,orientation:n,dir:N,loop:s,currentTabStopId:E,onItemFocus:w.useCallback(q=>T(q),[T]),onItemShiftTab:w.useCallback(()=>R(!0),[]),onFocusableItemAdd:w.useCallback(()=>z(q=>q+1),[]),onFocusableItemRemove:w.useCallback(()=>z(q=>q-1),[]),children:u.jsx($r.div,{tabIndex:A||G===0?-1:0,"data-orientation":n,...x,ref:S,style:{outline:"none",...r.style},onMouseDown:Lt(r.onMouseDown,()=>{L.current=!0}),onFocus:Lt(r.onFocus,q=>{const ae=!L.current;if(q.target===q.currentTarget&&ae&&!A){const oe=new CustomEvent(fw,D9);if(q.currentTarget.dispatchEvent(oe),!oe.defaultPrevented){const fe=j().filter(de=>de.focusable),H=fe.find(de=>de.active),me=fe.find(de=>de.id===E),se=[H,me,...fe].filter(Boolean).map(de=>de.ref.current);II(se,v)}}L.current=!1}),onBlur:Lt(r.onBlur,()=>R(!1))})})}),AI="RovingFocusGroupItem",RI=w.forwardRef((r,e)=>{const{__scopeRovingFocusGroup:t,focusable:n=!0,active:s=!1,tabStopId:i,children:c,...d}=r,m=Vl(),p=i||m,v=U9(AI,t),x=v.currentTabStopId===p,b=NI(t),{onFocusableItemAdd:S,onFocusableItemRemove:N,currentTabStopId:E}=v;return w.useEffect(()=>{if(n)return S(),()=>N()},[n,S,N]),u.jsx(xb.ItemSlot,{scope:t,id:p,focusable:n,active:s,children:u.jsx($r.span,{tabIndex:x?0:-1,"data-orientation":v.orientation,...d,ref:e,onMouseDown:Lt(r.onMouseDown,T=>{n?v.onItemFocus(p):T.preventDefault()}),onFocus:Lt(r.onFocus,()=>v.onItemFocus(p)),onKeyDown:Lt(r.onKeyDown,T=>{if(T.key==="Tab"&&T.shiftKey){v.onItemShiftTab();return}if(T.target!==T.currentTarget)return;const A=G9(T,v.orientation,v.dir);if(A!==void 0){if(T.metaKey||T.ctrlKey||T.altKey||T.shiftKey)return;T.preventDefault();let F=b().filter(j=>j.focusable).map(j=>j.ref.current);if(A==="last")F.reverse();else if(A==="prev"||A==="next"){A==="prev"&&F.reverse();const j=F.indexOf(T.currentTarget);F=v.loop?W9(F,j+1):F.slice(j+1)}setTimeout(()=>II(F))}}),children:typeof c=="function"?c({isCurrentTabStop:x,hasTabStop:E!=null}):c})})});RI.displayName=AI;var H9={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function B9(r,e){return e!=="rtl"?r:r==="ArrowLeft"?"ArrowRight":r==="ArrowRight"?"ArrowLeft":r}function G9(r,e,t){const n=B9(r.key,t);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return H9[n]}function II(r,e=!1){const t=document.activeElement;for(const n of r)if(n===t||(n.focus({preventScroll:e}),document.activeElement!==t))return}function W9(r,e){return r.map((t,n)=>r[(e+n)%r.length])}var PI=TI,FI=RI,a0="Tabs",[V9]=Za(a0,[i0]),jI=i0(),[q9,kS]=V9(a0),OI=w.forwardRef((r,e)=>{const{__scopeTabs:t,value:n,onValueChange:s,defaultValue:i,orientation:c="horizontal",dir:d,activationMode:m="automatic",...p}=r,v=o0(d),[x,b]=ru({prop:n,onChange:s,defaultProp:i??"",caller:a0});return u.jsx(q9,{scope:t,baseId:Vl(),value:x,onValueChange:b,orientation:c,dir:v,activationMode:m,children:u.jsx($r.div,{dir:v,"data-orientation":c,...p,ref:e})})});OI.displayName=a0;var DI="TabsList",LI=w.forwardRef((r,e)=>{const{__scopeTabs:t,loop:n=!0,...s}=r,i=kS(DI,t),c=jI(t);return u.jsx(PI,{asChild:!0,...c,orientation:i.orientation,dir:i.dir,loop:n,children:u.jsx($r.div,{role:"tablist","aria-orientation":i.orientation,...s,ref:e})})});LI.displayName=DI;var MI="TabsTrigger",$I=w.forwardRef((r,e)=>{const{__scopeTabs:t,value:n,disabled:s=!1,...i}=r,c=kS(MI,t),d=jI(t),m=HI(c.baseId,n),p=BI(c.baseId,n),v=n===c.value;return u.jsx(FI,{asChild:!0,...d,focusable:!s,active:v,children:u.jsx($r.button,{type:"button",role:"tab","aria-selected":v,"aria-controls":p,"data-state":v?"active":"inactive","data-disabled":s?"":void 0,disabled:s,id:m,...i,ref:e,onMouseDown:Lt(r.onMouseDown,x=>{!s&&x.button===0&&x.ctrlKey===!1?c.onValueChange(n):x.preventDefault()}),onKeyDown:Lt(r.onKeyDown,x=>{[" ","Enter"].includes(x.key)&&c.onValueChange(n)}),onFocus:Lt(r.onFocus,()=>{const x=c.activationMode!=="manual";!v&&!s&&x&&c.onValueChange(n)})})})});$I.displayName=MI;var UI="TabsContent",zI=w.forwardRef((r,e)=>{const{__scopeTabs:t,value:n,forceMount:s,children:i,...c}=r,d=kS(UI,t),m=HI(d.baseId,n),p=BI(d.baseId,n),v=n===d.value,x=w.useRef(v);return w.useEffect(()=>{const b=requestAnimationFrame(()=>x.current=!1);return()=>cancelAnimationFrame(b)},[]),u.jsx(fa,{present:s||v,children:({present:b})=>u.jsx($r.div,{"data-state":v?"active":"inactive","data-orientation":d.orientation,role:"tabpanel","aria-labelledby":m,hidden:!b,id:p,tabIndex:0,...c,ref:e,style:{...r.style,animationDuration:x.current?"0s":void 0},children:b&&i})})});zI.displayName=UI;function HI(r,e){return`${r}-trigger-${e}`}function BI(r,e){return`${r}-content-${e}`}var K9=OI,GI=LI,WI=$I,VI=zI;const Y9=K9,qI=w.forwardRef(({className:r,...e},t)=>u.jsx(GI,{ref:t,className:jr("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",r),...e}));qI.displayName=GI.displayName;const ey=w.forwardRef(({className:r,...e},t)=>u.jsx(WI,{ref:t,className:jr("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm overflow-x-hidden",r),...e}));ey.displayName=WI.displayName;const ty=w.forwardRef(({className:r,...e},t)=>u.jsx(VI,{ref:t,className:jr("ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",r),...e}));ty.displayName=VI.displayName;const J9="https://rubypowerslaw.filevineapp.com",Lr="src/sidepanel/panels/DocViewerPanel.tsx",KI=({documentId:r,documentName:e,onBack:t})=>{const n=Gr();n.info(`[DocViewerPanel] Initializing with documentId: ${r}, documentName: ${e}`,{sourceFile:Lr});const[s,i]=w.useState(null),[c,d]=w.useState(!0),[m,p]=w.useState(null),[v,x]=w.useState("other"),[b,S]=w.useState(!0),[N,E]=w.useState(!1),[T,A]=w.useState(0),[R,F]=w.useState(!1),j=w.useRef(null),L=w.useCallback(H=>{n.info(`[DocViewerPanel] getDocumentType called with extension: ${H}`,{sourceFile:Lr});const me=["jpg","jpeg","png","gif","bmp","webp","svg","tiff"],ee=["pdf"],se=["doc","docx","xls","xlsx","ppt","pptx","odt","ods","odp","rtf"],de=["txt","md","csv","json","xml","html","htm"];let Y="other";return me.includes(H)?Y="image":ee.includes(H)?Y="pdf":se.includes(H)?Y="office":de.includes(H)&&(Y="text"),n.info(`[DocViewerPanel] Document type determined: ${Y} for extension: ${H}`,{sourceFile:Lr}),Y},[n]);w.useEffect(()=>{(async()=>{var me;if(n.info(`[DocViewerPanel] Starting fetchDocumentUrl for documentId: ${r}`,{sourceFile:Lr}),!r){n.warn("[DocViewerPanel] No document ID provided",{sourceFile:Lr,error:"No document ID provided"}),p("No document ID provided"),d(!1);return}d(!0),p(null);try{n.info(`[DocViewerPanel] Fetching document URL from server for documentId: ${r}`,{sourceFile:Lr});const ee=await o8("filevine",r.toString(),n);if(n.info("[DocViewerPanel] Received document data:",{sourceFile:Lr,documentData:ee}),!ee.url){const Y=new Error("Document URL not found in response");throw n.error("[DocViewerPanel] Document URL not found in response",Y,{sourceFile:Lr}),Y}n.info(`[DocViewerPanel] Setting document URL: ${ee.url}`,{sourceFile:Lr}),i(ee.url);const se=((me=e.split(".").pop())==null?void 0:me.toLowerCase())||"";n.info(`[DocViewerPanel] Detected file extension: ${se}`,{sourceFile:Lr});const de=L(se);n.info(`[DocViewerPanel] Determined document type: ${de}`,{sourceFile:Lr}),x(de)}catch(ee){n.error("[DocViewerPanel] Error fetching document URL:",ee,{sourceFile:Lr}),p("Failed to load document. Please try again later.")}finally{d(!1)}})()},[r,e,T,n,L]),w.useEffect(()=>(j.current&&(clearTimeout(j.current),j.current=null),F(!1),!c&&b&&v!=="image"&&(n.info("[DocViewerPanel] Setting loading timeout for document",{sourceFile:Lr}),j.current=setTimeout(()=>{n.info("[DocViewerPanel] Document loading is taking too long",{sourceFile:Lr}),F(!0)},1e4)),()=>{j.current&&(clearTimeout(j.current),j.current=null)}),[c,b,v,n]);const G=()=>{n.info("[DocViewerPanel] iframe loaded successfully",{sourceFile:Lr}),S(!1),E(!1),F(!1),j.current&&(clearTimeout(j.current),j.current=null)},z=H=>{n.error("[DocViewerPanel] iframe error:",H,{sourceFile:Lr}),S(!1),E(!0),F(!1),j.current&&(clearTimeout(j.current),j.current=null)},q=()=>{n.info("[DocViewerPanel] Retrying document load",{sourceFile:Lr}),S(!0),E(!1),F(!1),A(H=>H+1)},ae=()=>{if(r){const H=`${J9}/docwebviewer/view/${r}`;n.info(`[DocViewerPanel] Opening document in new tab with original URL: ${H}`,{sourceFile:Lr}),window.open(H,"_blank")}},oe=()=>{if(!s){n.warn("[DocViewerPanel] No document URL available for download",{sourceFile:Lr});return}try{n.info(`[DocViewerPanel] Starting download for: ${e}`,{sourceFile:Lr});const H=new URL(s);H.searchParams.set("response-content-disposition",`attachment; filename="${encodeURIComponent(e)}"`);const me=document.createElement("a");me.href=H.toString(),me.download=e,me.target="_blank",me.rel="noopener noreferrer",document.body.appendChild(me),me.click(),setTimeout(()=>{document.body.removeChild(me)},100),n.info(`[DocViewerPanel] Download initiated for: ${e}`,{sourceFile:Lr})}catch(H){n.error("[DocViewerPanel] Error downloading document:",H,{sourceFile:Lr})}};if(c)return n.info("[DocViewerPanel] Rendering loading state",{sourceFile:Lr}),u.jsxs(Ss,{className:"w-full h-full",children:[u.jsx(uo,{className:"pb-4",children:u.jsxs("div",{className:"flex flex-row items-start gap-3",children:[u.jsx(We,{variant:"ghost",size:"sm",onClick:t,className:"h-8 w-8 p-0 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors shrink-0 mt-0.5","aria-label":"Go back",title:"Go back",children:u.jsx(Cm,{className:"h-4 w-4"})}),u.jsx(fo,{className:"text-base font-semibold leading-relaxed break-words flex-1 min-w-0",children:e})]})}),u.jsx(Es,{className:"flex items-center justify-center h-[80vh]",children:u.jsxs("div",{className:"text-center",children:[u.jsx(ia,{className:"h-8 w-8 animate-spin mx-auto mb-4 text-blue-600 dark:text-blue-400"}),u.jsx("p",{className:"dark:text-gray-200",children:"Loading document..."})]})})]});if(m)return n.info(`[DocViewerPanel] Rendering error state: ${m}`,{sourceFile:Lr}),u.jsxs(Ss,{className:"w-full h-full",children:[u.jsx(uo,{className:"pb-4",children:u.jsxs("div",{className:"flex flex-row items-start gap-3",children:[u.jsx(We,{variant:"ghost",size:"sm",onClick:t,className:"h-8 w-8 p-0 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors shrink-0 mt-0.5","aria-label":"Go back",title:"Go back",children:u.jsx(Cm,{className:"h-4 w-4"})}),u.jsx(fo,{className:"text-base font-semibold leading-relaxed break-words flex-1 min-w-0",children:e})]})}),u.jsx(Es,{className:"flex items-center justify-center h-[80vh]",children:u.jsxs("div",{className:"text-center text-red-500",children:[u.jsx("p",{children:m}),u.jsxs(We,{variant:"outline",className:"mt-4",onClick:q,children:[u.jsx(si,{className:"h-4 w-4 mr-2"}),"Retry"]})]})})]});const fe=()=>{if(n.info(`[DocViewerPanel] renderDocumentViewer called with documentType: ${v}, documentUrl: ${s}`,{sourceFile:Lr}),!s)return n.info("[DocViewerPanel] No document URL available, returning null",{sourceFile:Lr}),null;const H=`https://docs.google.com/viewer?url=${encodeURIComponent(s||"")}&embedded=true`;n.info(`[DocViewerPanel] Google Docs Viewer URL: ${H}`,{sourceFile:Lr});const me=v==="pdf"?"PDF":v==="office"?"Office document":v==="text"?"Text document":v==="image"?"Image":"Document";return v==="image"?(n.info("[DocViewerPanel] Rendering image viewer",{sourceFile:Lr}),u.jsx("div",{className:"w-full h-full flex items-center justify-center overflow-auto",children:u.jsx("img",{src:s,alt:e,className:"max-w-full max-h-full object-contain",onLoad:()=>S(!1),onError:()=>{S(!1),E(!0)}})})):(n.info(`[DocViewerPanel] Rendering ${me} viewer with Google Docs for: ${e}`,{sourceFile:Lr}),u.jsxs("div",{className:"w-full h-full relative",children:[b&&u.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white dark:bg-gray-900 bg-opacity-80 dark:bg-opacity-80 z-10",children:u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 dark:border-gray-100 mx-auto mb-4"}),u.jsxs("p",{className:"dark:text-gray-200",children:["Loading ",me.toLowerCase(),"..."]}),u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-2",children:"This may take a moment for large files"}),R&&u.jsxs("div",{className:"mt-4 p-4 bg-yellow-50 border border-yellow-200 rounded-md",children:[u.jsx("p",{className:"text-amber-700 font-medium",children:"This is taking longer than expected."}),u.jsx("p",{className:"text-sm text-amber-600 mt-1",children:v==="office"?"Office documents can sometimes be slow to load in the viewer.":"This document might be large or complex."}),u.jsxs("div",{className:"mt-3 flex justify-center space-x-3",children:[u.jsxs(We,{variant:"outline",size:"sm",onClick:q,children:[u.jsx(si,{className:"h-3 w-3 mr-1"}),"Retry"]}),u.jsx(We,{variant:"default",size:"sm",onClick:ae,children:"Open in new tab"})]})]})]})}),N&&u.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white dark:bg-gray-900 z-10",children:u.jsxs("div",{className:"text-center text-red-500 dark:text-red-400",children:[u.jsxs("p",{children:["Failed to load ",me.toLowerCase(),"."]}),u.jsx("p",{className:"text-sm mt-2 dark:text-gray-400",children:"The document might be too large or in an unsupported format."}),u.jsxs("div",{className:"mt-4 flex justify-center space-x-3",children:[u.jsxs(We,{variant:"outline",onClick:q,children:[u.jsx(si,{className:"h-4 w-4 mr-2"}),"Retry"]}),u.jsx(We,{variant:"default",onClick:ae,children:"Open in new tab"})]})]})}),u.jsx("iframe",{src:H,className:"w-full h-full border-none",title:e,sandbox:"allow-scripts allow-same-origin allow-forms allow-popups allow-popups-to-escape-sandbox",onLoad:G,onError:z})]}))};return n.info(`[DocViewerPanel] Rendering main component with documentType: ${v}`,{sourceFile:Lr}),u.jsxs(Ss,{className:"w-full h-full",children:[u.jsxs(uo,{className:"pb-4",children:[u.jsxs("div",{className:"flex flex-row items-start gap-3",children:[u.jsx(We,{variant:"ghost",size:"sm",onClick:t,className:"h-8 w-8 p-0 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors shrink-0 mt-0.5","aria-label":"Go back",title:"Go back",children:u.jsx(Cm,{className:"h-4 w-4"})}),u.jsx(fo,{className:"text-base font-semibold leading-relaxed break-words flex-1 min-w-0",children:e})]}),!c&&u.jsxs("div",{className:"flex gap-2 pl-8 pr-6",children:[u.jsxs(We,{variant:"outline",size:"sm",onClick:oe,className:"h-9 px-4","aria-label":"Download file",children:[u.jsx(aB,{className:"h-4 w-4 mr-2"}),"Download"]}),u.jsxs(We,{variant:"outline",size:"sm",onClick:ae,className:"h-9 px-4","aria-label":"Open in new tab",children:[u.jsx(Va,{className:"h-4 w-4 mr-2"}),"Open in new tab"]})]})]}),u.jsx(Es,{className:"h-[80vh] overflow-hidden",children:fe()})]})},Ll="src/sidepanel/panels/ClientDocumentsPanel.tsx",X9="https://rubypowerslaw.filevineapp.com",Q9=({clientEmail:r,projectId:e,documents:t,isLoading:n,error:s,goBack:i,initialSelectedDocument:c})=>{const d=Gr(),[m,p]=w.useState([]),[v,x]=w.useState(!1),[b,S]=w.useState(null),[N,E]=w.useState(""),[T,A]=w.useState(null),[R,F]=w.useState({contracts:!1,payments:!1,allDocuments:!0}),[j,L]=w.useState({});w.useEffect(()=>{const $={sourceFile:Ll,functionName:"useEffect[fetchData]"};if(t&&t.length>0||n){t&&p(t);return}(async()=>{if(!e){S("No project ID provided. Please select a valid project.");return}x(!0),S(null);try{const O=await gT(e,d);if(O){d.debug("Using cached documents for project",{...$,data:{projectId:e}}),p(O),x(!1);return}d.debug("ClientDocumentsPanel: Fetching documents from server for project",{...$,data:{projectId:e}});const re=(await PT("filevine",e,d)).documents.map(Ee=>({name:Ee.filename,url:`${X9}/docwebviewer/view/${Ee.documentId}`,documentId:Ee.documentId,folderName:Ee.folderName}));await mT(e,re,d),p(re)}catch(O){d.error("Error fetching documents:",O,$),S("Failed to load documents. Please try again later.")}finally{x(!1)}})()},[e,t,n,d]);const G=n!==void 0?n:v,z=s!==void 0?s:b,q=_r.useMemo(()=>{const $={sourceFile:Ll,functionName:"useMemo[filteredDocuments]"};return d.debug("Computing filteredDocuments",$),m.filter(X=>X.name.toLowerCase().includes(N.toLowerCase()))},[m,N,d]),ae=m.filter($=>$.folderName&&$.folderName.toLowerCase().includes("contract")),oe=m.filter($=>$.folderName&&$.folderName.toLowerCase().includes("payment")),fe=$=>{var re;const X={sourceFile:Ll,functionName:"isViewableDocument",data:{filename:$}},O=(re=$.split(".").pop())==null?void 0:re.toLowerCase(),U=["pdf","jpg","jpeg","png","gif","bmp","webp","doc","docx","xls","xlsx","ppt","pptx","odt","ods","odp","rtf","txt"];return d.debug(`File extension: ${O}`,X),d.debug(`Viewable extensions: ${U}`,X),U.includes(O||"")},H=$=>{var O;const X=((O=$.split(".").pop())==null?void 0:O.toLowerCase())||"";return["jpg","jpeg","png","gif","bmp","webp","svg","tiff"].includes(X)?u.jsx(fB,{className:"h-4 w-4 text-purple-500 dark:text-purple-400"}):["xls","xlsx","csv","ods"].includes(X)?u.jsx(cB,{className:"h-4 w-4 text-green-500 dark:text-green-400"}):["ppt","pptx","odp"].includes(X)?u.jsx(yB,{className:"h-4 w-4 text-orange-500 dark:text-orange-400"}):["pdf","doc","docx","txt","rtf","odt"].includes(X)?u.jsx(ld,{className:"h-4 w-4 text-blue-500 dark:text-blue-400"}):u.jsx(uB,{className:"h-4 w-4 text-gray-500 dark:text-gray-400"})},me=$=>{const X={sourceFile:Ll,functionName:"handleViewDocument",data:{docName:$.name,docId:$.documentId,url:$.url,folder:$.folderName}};d.debug("Handling view document",X),$.documentId&&fe($.name)?(d.debug("Selected document",X),A({name:$.name,documentId:$.documentId,url:$.url,folderName:$.folderName})):$.url&&(d.debug("Opening document URL",X),window.open($.url,"_blank"))},ee=$=>{F(X=>({...X,[$]:!X[$]}))},se=$=>{const X={sourceFile:Ll,functionName:"toggleFolder",data:{folderName:$}};d.debug("Toggling folder",X),L(O=>({...O,[$]:!O[$]}))},de=_r.useCallback($=>{const X={sourceFile:Ll,functionName:"groupDocumentsByFolder"};d.debug("Running groupDocumentsByFolder",X);const O={};return O["No Folder"]=[],$.forEach(U=>{const re=U.folderName||"No Folder";O[re]||(O[re]=[]),O[re].push(U)}),O["No Folder"].length===0&&delete O["No Folder"],O},[d]),Y=_r.useMemo(()=>{const $={sourceFile:Ll,functionName:"useMemo[groupedFilteredDocuments]"};return d.debug("Computing groupedFilteredDocuments",$),de(q)},[q,de,d]);w.useEffect(()=>{const $={sourceFile:Ll,functionName:"useEffect[folderExpansion]"};if(d.debug("Running folder expansion initialization effect",$),q.length>0){const X=Object.keys(Y);d.debug(`Found folders: ${X.join(", ")}`,$),L(O=>{const U={...O};let re=!1;return X.forEach(Ee=>{U[Ee]===void 0&&(U[Ee]=!1,re=!0)}),re?U:O})}},[Y,q.length,d]),w.useEffect(()=>{const $={sourceFile:Ll,functionName:"useEffect[initialSelectedDocument]"};c&&(d.debug("Setting initial selected document",{...$,document:c}),A({name:c.name,documentId:c.documentId,url:c.url}))},[c,d]);const J=()=>!G&&!z&&m.length===0?u.jsx("div",{className:"text-gray-500 dark:text-gray-400 text-center py-4",children:"No documents found for this client."}):!G&&!z&&m.length>0?u.jsxs("div",{className:"space-y-4",children:[ae.length>0&&u.jsxs("div",{children:[u.jsxs("button",{onClick:()=>ee("contracts"),className:"flex items-center justify-between w-full py-2 text-left font-medium text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-md px-2",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx(ld,{className:"h-4 w-4 mr-2 text-blue-500 dark:text-blue-400"}),u.jsxs("span",{children:["Contracts (",ae.length,")"]})]}),R.contracts?u.jsx(Av,{className:"h-4 w-4"}):u.jsx(xs,{className:"h-4 w-4"})]}),R.contracts&&u.jsx("ul",{className:"ml-6 mt-2 space-y-1 text-sm",children:ae.map($=>u.jsxs("li",{className:"flex items-center gap-2 text-gray-600 dark:text-gray-400",children:[u.jsx("span",{className:"flex-shrink-0",children:H($.name)}),u.jsx("button",{onClick:()=>me($),className:"text-blue-600 dark:text-blue-400 hover:underline hover:text-blue-800 dark:hover:text-blue-300 focus:outline-none text-left truncate min-w-0",title:$.name,children:$.name})]},$.documentId))})]}),oe.length>0&&u.jsxs("div",{children:[u.jsxs("button",{onClick:()=>ee("payments"),className:"flex items-center justify-between w-full py-2 text-left font-medium text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-md px-2",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx(iB,{className:"h-4 w-4 mr-2 text-green-500 dark:text-green-400"}),u.jsxs("span",{children:["Payments (",oe.length,")"]})]}),R.payments?u.jsx(Av,{className:"h-4 w-4"}):u.jsx(xs,{className:"h-4 w-4"})]}),R.payments&&u.jsx("ul",{className:"ml-6 mt-2 space-y-1 text-sm",children:oe.map($=>u.jsxs("li",{className:"flex items-center gap-2 text-gray-600 dark:text-gray-400",children:[u.jsx("span",{className:"flex-shrink-0",children:H($.name)}),u.jsx("button",{onClick:()=>me($),className:"text-blue-600 dark:text-blue-400 hover:underline hover:text-blue-800 dark:hover:text-blue-300 focus:outline-none text-left truncate min-w-0",title:$.name,children:$.name})]},$.documentId))})]}),q.length>0&&u.jsxs("div",{children:[u.jsxs("button",{onClick:()=>ee("allDocuments"),className:"flex items-center justify-between w-full py-2 text-left font-medium text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-md px-2",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx(ld,{className:"h-4 w-4 mr-2 text-gray-500 dark:text-gray-400"}),u.jsxs("span",{children:["All Documents (",q.length,")"]})]}),R.allDocuments?u.jsx(Av,{className:"h-4 w-4"}):u.jsx(xs,{className:"h-4 w-4"})]}),R.allDocuments&&u.jsx("div",{className:"ml-2 mt-2 space-y-2 text-sm",children:Object.entries(Y).map(([$,X])=>u.jsxs("div",{children:[u.jsxs("button",{onClick:()=>se($),className:"flex items-center justify-between w-full py-1 text-left font-medium text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-md px-1",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(dB,{className:"h-4 w-4 text-amber-500 dark:text-amber-400"}),u.jsxs("span",{children:[$," (",X.length,")"]})]}),j[$]?u.jsx(Av,{className:"h-4 w-4"}):u.jsx(xs,{className:"h-4 w-4"})]}),j[$]&&u.jsx("ul",{className:"ml-6 mt-1 space-y-1",children:X.map(O=>u.jsxs("li",{className:"flex items-center gap-2 text-gray-600 dark:text-gray-400",children:[u.jsx("span",{className:"flex-shrink-0",children:H(O.name)}),u.jsx("button",{onClick:()=>me(O),className:"text-blue-600 dark:text-blue-400 hover:underline hover:text-blue-800 dark:hover:text-blue-300 focus:outline-none text-left truncate min-w-0",title:O.name,children:O.name})]},O.documentId))})]},$))})]})]}):null;return u.jsx("div",{className:"flex flex-col h-full bg-background",children:u.jsx("div",{className:"flex-grow overflow-hidden",children:T?u.jsx(KI,{documentId:T.documentId,documentName:T.name,onBack:()=>A(null)}):G?u.jsxs(Ss,{className:"w-full h-full",children:[u.jsx(uo,{className:"pb-4",children:u.jsxs("div",{className:"flex flex-row items-start gap-3",children:[i&&u.jsx(We,{variant:"ghost",size:"sm",onClick:i,className:"h-8 w-8 p-0 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors shrink-0 mt-0.5","aria-label":"Go back",title:"Go back",children:u.jsx(Cm,{className:"h-4 w-4"})}),u.jsx(fo,{className:"text-base font-semibold leading-relaxed break-words flex-1 min-w-0",children:"Project Documents"})]})}),u.jsx(Es,{className:"flex items-center justify-center h-[80vh]",children:u.jsxs("div",{className:"text-center",children:[u.jsx(ia,{className:"h-8 w-8 animate-spin mx-auto mb-4 text-blue-600 dark:text-blue-400"}),u.jsx("p",{className:"dark:text-gray-200",children:"Loading documents..."})]})})]}):z?u.jsxs("div",{className:"text-red-600 bg-red-50 p-3 rounded-md",children:["Error: ",z]}):u.jsxs(Ss,{className:"mb-4",children:[u.jsx(uo,{className:"pb-2",children:u.jsxs("div",{className:"flex flex-row items-start gap-3",children:[i&&u.jsx(We,{variant:"ghost",size:"sm",onClick:i,className:"h-8 w-8 p-0 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors shrink-0 mt-0.5","aria-label":"Go back",title:"Go back",children:u.jsx(Cm,{className:"h-4 w-4"})}),u.jsx(fo,{className:"text-base font-semibold leading-relaxed break-words flex-1 min-w-0",children:"Project Documents"})]})}),u.jsxs(Es,{className:"px-4 pt-2 pb-4",children:[u.jsxs("div",{className:"relative mb-4",children:[u.jsx(Ri,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),u.jsx(vn,{type:"text",placeholder:"Search All Documents...",value:N,onChange:$=>E($.target.value),className:"w-full pl-9 pr-4 py-2 h-9 text-sm border rounded-md"})]}),u.jsx("div",{className:"overflow-y-auto max-h-[80vh] pb-32",children:J()})]})]})})})};function Z9(r){const e=eV(r),t=w.forwardRef((n,s)=>{const{children:i,...c}=n,d=w.Children.toArray(i),m=d.find(rV);if(m){const p=m.props.children,v=d.map(x=>x===m?w.Children.count(p)>1?w.Children.only(null):w.isValidElement(p)?p.props.children:null:x);return u.jsx(e,{...c,ref:s,children:w.isValidElement(p)?w.cloneElement(p,void 0,v):null})}return u.jsx(e,{...c,ref:s,children:i})});return t.displayName=`${r}.Slot`,t}function eV(r){const e=w.forwardRef((t,n)=>{const{children:s,...i}=t;if(w.isValidElement(s)){const c=sV(s),d=nV(i,s.props);return s.type!==w.Fragment&&(d.ref=n?tu(n,c):c),w.cloneElement(s,d)}return w.Children.count(s)>1?w.Children.only(null):null});return e.displayName=`${r}.SlotClone`,e}var tV=Symbol("radix.slottable");function rV(r){return w.isValidElement(r)&&typeof r.type=="function"&&"__radixId"in r.type&&r.type.__radixId===tV}function nV(r,e){const t={...e};for(const n in e){const s=r[n],i=e[n];/^on[A-Z]/.test(n)?s&&i?t[n]=(...d)=>{const m=i(...d);return s(...d),m}:s&&(t[n]=s):n==="style"?t[n]={...s,...i}:n==="className"&&(t[n]=[s,i].filter(Boolean).join(" "))}return{...r,...t}}function sV(r){var n,s;let e=(n=Object.getOwnPropertyDescriptor(r.props,"ref"))==null?void 0:n.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=(s=Object.getOwnPropertyDescriptor(r,"ref"))==null?void 0:s.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}var wb=["Enter"," "],oV=["ArrowDown","PageUp","Home"],YI=["ArrowUp","PageDown","End"],iV=[...oV,...YI],aV={ltr:[...wb,"ArrowRight"],rtl:[...wb,"ArrowLeft"]},lV={ltr:["ArrowLeft"],rtl:["ArrowRight"]},og="Menu",[Wm,cV,uV]=CS(og),[md,JI]=Za(og,[uV,Qy,i0]),l0=Qy(),XI=i0(),[dV,gd]=md(og),[fV,ig]=md(og),QI=r=>{const{__scopeMenu:e,open:t=!1,children:n,dir:s,onOpenChange:i,modal:c=!0}=r,d=l0(e),[m,p]=w.useState(null),v=w.useRef(!1),x=Xl(i),b=o0(s);return w.useEffect(()=>{const S=()=>{v.current=!0,document.addEventListener("pointerdown",N,{capture:!0,once:!0}),document.addEventListener("pointermove",N,{capture:!0,once:!0})},N=()=>v.current=!1;return document.addEventListener("keydown",S,{capture:!0}),()=>{document.removeEventListener("keydown",S,{capture:!0}),document.removeEventListener("pointerdown",N,{capture:!0}),document.removeEventListener("pointermove",N,{capture:!0})}},[]),u.jsx(SR,{...d,children:u.jsx(dV,{scope:e,open:t,onOpenChange:x,content:m,onContentChange:p,children:u.jsx(fV,{scope:e,onClose:w.useCallback(()=>x(!1),[x]),isUsingKeyboardRef:v,dir:b,modal:c,children:n})})})};QI.displayName=og;var hV="MenuAnchor",NS=w.forwardRef((r,e)=>{const{__scopeMenu:t,...n}=r,s=l0(t);return u.jsx(ER,{...s,...n,ref:e})});NS.displayName=hV;var TS="MenuPortal",[pV,ZI]=md(TS,{forceMount:void 0}),eP=r=>{const{__scopeMenu:e,forceMount:t,children:n,container:s}=r,i=gd(TS,e);return u.jsx(pV,{scope:e,forceMount:t,children:u.jsx(fa,{present:t||i.open,children:u.jsx(mS,{asChild:!0,container:s,children:n})})})};eP.displayName=TS;var Fi="MenuContent",[mV,AS]=md(Fi),tP=w.forwardRef((r,e)=>{const t=ZI(Fi,r.__scopeMenu),{forceMount:n=t.forceMount,...s}=r,i=gd(Fi,r.__scopeMenu),c=ig(Fi,r.__scopeMenu);return u.jsx(Wm.Provider,{scope:r.__scopeMenu,children:u.jsx(fa,{present:n||i.open,children:u.jsx(Wm.Slot,{scope:r.__scopeMenu,children:c.modal?u.jsx(gV,{...s,ref:e}):u.jsx(vV,{...s,ref:e})})})})}),gV=w.forwardRef((r,e)=>{const t=gd(Fi,r.__scopeMenu),n=w.useRef(null),s=Mn(e,n);return w.useEffect(()=>{const i=n.current;if(i)return JR(i)},[]),u.jsx(RS,{...r,ref:s,trapFocus:t.open,disableOutsidePointerEvents:t.open,disableOutsideScroll:!0,onFocusOutside:Lt(r.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>t.onOpenChange(!1)})}),vV=w.forwardRef((r,e)=>{const t=gd(Fi,r.__scopeMenu);return u.jsx(RS,{...r,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>t.onOpenChange(!1)})}),yV=Z9("MenuContent.ScrollLock"),RS=w.forwardRef((r,e)=>{const{__scopeMenu:t,loop:n=!1,trapFocus:s,onOpenAutoFocus:i,onCloseAutoFocus:c,disableOutsidePointerEvents:d,onEntryFocus:m,onEscapeKeyDown:p,onPointerDownOutside:v,onFocusOutside:x,onInteractOutside:b,onDismiss:S,disableOutsideScroll:N,...E}=r,T=gd(Fi,t),A=ig(Fi,t),R=l0(t),F=XI(t),j=cV(t),[L,G]=w.useState(null),z=w.useRef(null),q=Mn(e,z,T.onContentChange),ae=w.useRef(0),oe=w.useRef(""),fe=w.useRef(0),H=w.useRef(null),me=w.useRef("right"),ee=w.useRef(0),se=N?wS:w.Fragment,de=N?{as:yV,allowPinchZoom:!0}:void 0,Y=$=>{var K,he;const X=oe.current+$,O=j().filter(be=>!be.disabled),U=document.activeElement,re=(K=O.find(be=>be.ref.current===U))==null?void 0:K.textValue,Ee=O.map(be=>be.textValue),ne=RV(Ee,X,re),we=(he=O.find(be=>be.textValue===ne))==null?void 0:he.ref.current;(function be(Ie){oe.current=Ie,window.clearTimeout(ae.current),Ie!==""&&(ae.current=window.setTimeout(()=>be(""),1e3))})(X),we&&setTimeout(()=>we.focus())};w.useEffect(()=>()=>window.clearTimeout(ae.current),[]),HR();const J=w.useCallback($=>{var O,U;return me.current===((O=H.current)==null?void 0:O.side)&&PV($,(U=H.current)==null?void 0:U.area)},[]);return u.jsx(mV,{scope:t,searchRef:oe,onItemEnter:w.useCallback($=>{J($)&&$.preventDefault()},[J]),onItemLeave:w.useCallback($=>{var X;J($)||((X=z.current)==null||X.focus(),G(null))},[J]),onTriggerLeave:w.useCallback($=>{J($)&&$.preventDefault()},[J]),pointerGraceTimerRef:fe,onPointerGraceIntentChange:w.useCallback($=>{H.current=$},[]),children:u.jsx(se,{...de,children:u.jsx(xS,{asChild:!0,trapped:s,onMountAutoFocus:Lt(i,$=>{var X;$.preventDefault(),(X=z.current)==null||X.focus({preventScroll:!0})}),onUnmountAutoFocus:c,children:u.jsx(Zy,{asChild:!0,disableOutsidePointerEvents:d,onEscapeKeyDown:p,onPointerDownOutside:v,onFocusOutside:x,onInteractOutside:b,onDismiss:S,children:u.jsx(PI,{asChild:!0,...F,dir:A.dir,orientation:"vertical",loop:n,currentTabStopId:L,onCurrentTabStopIdChange:G,onEntryFocus:Lt(m,$=>{A.isUsingKeyboardRef.current||$.preventDefault()}),preventScrollOnEntryFocus:!0,children:u.jsx(CR,{role:"menu","aria-orientation":"vertical","data-state":vP(T.open),"data-radix-menu-content":"",dir:A.dir,...R,...E,ref:q,style:{outline:"none",...E.style},onKeyDown:Lt(E.onKeyDown,$=>{const O=$.target.closest("[data-radix-menu-content]")===$.currentTarget,U=$.ctrlKey||$.altKey||$.metaKey,re=$.key.length===1;O&&($.key==="Tab"&&$.preventDefault(),!U&&re&&Y($.key));const Ee=z.current;if($.target!==Ee||!iV.includes($.key))return;$.preventDefault();const we=j().filter(K=>!K.disabled).map(K=>K.ref.current);YI.includes($.key)&&we.reverse(),TV(we)}),onBlur:Lt(r.onBlur,$=>{$.currentTarget.contains($.target)||(window.clearTimeout(ae.current),oe.current="")}),onPointerMove:Lt(r.onPointerMove,Vm($=>{const X=$.target,O=ee.current!==$.clientX;if($.currentTarget.contains(X)&&O){const U=$.clientX>ee.current?"right":"left";me.current=U,ee.current=$.clientX}}))})})})})})})});tP.displayName=Fi;var xV="MenuGroup",IS=w.forwardRef((r,e)=>{const{__scopeMenu:t,...n}=r;return u.jsx($r.div,{role:"group",...n,ref:e})});IS.displayName=xV;var wV="MenuLabel",rP=w.forwardRef((r,e)=>{const{__scopeMenu:t,...n}=r;return u.jsx($r.div,{...n,ref:e})});rP.displayName=wV;var Py="MenuItem",f1="menu.itemSelect",c0=w.forwardRef((r,e)=>{const{disabled:t=!1,onSelect:n,...s}=r,i=w.useRef(null),c=ig(Py,r.__scopeMenu),d=AS(Py,r.__scopeMenu),m=Mn(e,i),p=w.useRef(!1),v=()=>{const x=i.current;if(!t&&x){const b=new CustomEvent(f1,{bubbles:!0,cancelable:!0});x.addEventListener(f1,S=>n==null?void 0:n(S),{once:!0}),fR(x,b),b.defaultPrevented?p.current=!1:c.onClose()}};return u.jsx(nP,{...s,ref:m,disabled:t,onClick:Lt(r.onClick,v),onPointerDown:x=>{var b;(b=r.onPointerDown)==null||b.call(r,x),p.current=!0},onPointerUp:Lt(r.onPointerUp,x=>{var b;p.current||(b=x.currentTarget)==null||b.click()}),onKeyDown:Lt(r.onKeyDown,x=>{const b=d.searchRef.current!=="";t||b&&x.key===" "||wb.includes(x.key)&&(x.currentTarget.click(),x.preventDefault())})})});c0.displayName=Py;var nP=w.forwardRef((r,e)=>{const{__scopeMenu:t,disabled:n=!1,textValue:s,...i}=r,c=AS(Py,t),d=XI(t),m=w.useRef(null),p=Mn(e,m),[v,x]=w.useState(!1),[b,S]=w.useState("");return w.useEffect(()=>{const N=m.current;N&&S((N.textContent??"").trim())},[i.children]),u.jsx(Wm.ItemSlot,{scope:t,disabled:n,textValue:s??b,children:u.jsx(FI,{asChild:!0,...d,focusable:!n,children:u.jsx($r.div,{role:"menuitem","data-highlighted":v?"":void 0,"aria-disabled":n||void 0,"data-disabled":n?"":void 0,...i,ref:p,onPointerMove:Lt(r.onPointerMove,Vm(N=>{n?c.onItemLeave(N):(c.onItemEnter(N),N.defaultPrevented||N.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:Lt(r.onPointerLeave,Vm(N=>c.onItemLeave(N))),onFocus:Lt(r.onFocus,()=>x(!0)),onBlur:Lt(r.onBlur,()=>x(!1))})})})}),bV="MenuCheckboxItem",sP=w.forwardRef((r,e)=>{const{checked:t=!1,onCheckedChange:n,...s}=r;return u.jsx(cP,{scope:r.__scopeMenu,checked:t,children:u.jsx(c0,{role:"menuitemcheckbox","aria-checked":Fy(t)?"mixed":t,...s,ref:e,"data-state":FS(t),onSelect:Lt(s.onSelect,()=>n==null?void 0:n(Fy(t)?!0:!t),{checkForDefaultPrevented:!1})})})});sP.displayName=bV;var oP="MenuRadioGroup",[_V,SV]=md(oP,{value:void 0,onValueChange:()=>{}}),iP=w.forwardRef((r,e)=>{const{value:t,onValueChange:n,...s}=r,i=Xl(n);return u.jsx(_V,{scope:r.__scopeMenu,value:t,onValueChange:i,children:u.jsx(IS,{...s,ref:e})})});iP.displayName=oP;var aP="MenuRadioItem",lP=w.forwardRef((r,e)=>{const{value:t,...n}=r,s=SV(aP,r.__scopeMenu),i=t===s.value;return u.jsx(cP,{scope:r.__scopeMenu,checked:i,children:u.jsx(c0,{role:"menuitemradio","aria-checked":i,...n,ref:e,"data-state":FS(i),onSelect:Lt(n.onSelect,()=>{var c;return(c=s.onValueChange)==null?void 0:c.call(s,t)},{checkForDefaultPrevented:!1})})})});lP.displayName=aP;var PS="MenuItemIndicator",[cP,EV]=md(PS,{checked:!1}),uP=w.forwardRef((r,e)=>{const{__scopeMenu:t,forceMount:n,...s}=r,i=EV(PS,t);return u.jsx(fa,{present:n||Fy(i.checked)||i.checked===!0,children:u.jsx($r.span,{...s,ref:e,"data-state":FS(i.checked)})})});uP.displayName=PS;var CV="MenuSeparator",dP=w.forwardRef((r,e)=>{const{__scopeMenu:t,...n}=r;return u.jsx($r.div,{role:"separator","aria-orientation":"horizontal",...n,ref:e})});dP.displayName=CV;var kV="MenuArrow",fP=w.forwardRef((r,e)=>{const{__scopeMenu:t,...n}=r,s=l0(t);return u.jsx(kR,{...s,...n,ref:e})});fP.displayName=kV;var NV="MenuSub",[MK,hP]=md(NV),ym="MenuSubTrigger",pP=w.forwardRef((r,e)=>{const t=gd(ym,r.__scopeMenu),n=ig(ym,r.__scopeMenu),s=hP(ym,r.__scopeMenu),i=AS(ym,r.__scopeMenu),c=w.useRef(null),{pointerGraceTimerRef:d,onPointerGraceIntentChange:m}=i,p={__scopeMenu:r.__scopeMenu},v=w.useCallback(()=>{c.current&&window.clearTimeout(c.current),c.current=null},[]);return w.useEffect(()=>v,[v]),w.useEffect(()=>{const x=d.current;return()=>{window.clearTimeout(x),m(null)}},[d,m]),u.jsx(NS,{asChild:!0,...p,children:u.jsx(nP,{id:s.triggerId,"aria-haspopup":"menu","aria-expanded":t.open,"aria-controls":s.contentId,"data-state":vP(t.open),...r,ref:tu(e,s.onTriggerChange),onClick:x=>{var b;(b=r.onClick)==null||b.call(r,x),!(r.disabled||x.defaultPrevented)&&(x.currentTarget.focus(),t.open||t.onOpenChange(!0))},onPointerMove:Lt(r.onPointerMove,Vm(x=>{i.onItemEnter(x),!x.defaultPrevented&&!r.disabled&&!t.open&&!c.current&&(i.onPointerGraceIntentChange(null),c.current=window.setTimeout(()=>{t.onOpenChange(!0),v()},100))})),onPointerLeave:Lt(r.onPointerLeave,Vm(x=>{var S,N;v();const b=(S=t.content)==null?void 0:S.getBoundingClientRect();if(b){const E=(N=t.content)==null?void 0:N.dataset.side,T=E==="right",A=T?-5:5,R=b[T?"left":"right"],F=b[T?"right":"left"];i.onPointerGraceIntentChange({area:[{x:x.clientX+A,y:x.clientY},{x:R,y:b.top},{x:F,y:b.top},{x:F,y:b.bottom},{x:R,y:b.bottom}],side:E}),window.clearTimeout(d.current),d.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(x),x.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:Lt(r.onKeyDown,x=>{var S;const b=i.searchRef.current!=="";r.disabled||b&&x.key===" "||aV[n.dir].includes(x.key)&&(t.onOpenChange(!0),(S=t.content)==null||S.focus(),x.preventDefault())})})})});pP.displayName=ym;var mP="MenuSubContent",gP=w.forwardRef((r,e)=>{const t=ZI(Fi,r.__scopeMenu),{forceMount:n=t.forceMount,...s}=r,i=gd(Fi,r.__scopeMenu),c=ig(Fi,r.__scopeMenu),d=hP(mP,r.__scopeMenu),m=w.useRef(null),p=Mn(e,m);return u.jsx(Wm.Provider,{scope:r.__scopeMenu,children:u.jsx(fa,{present:n||i.open,children:u.jsx(Wm.Slot,{scope:r.__scopeMenu,children:u.jsx(RS,{id:d.contentId,"aria-labelledby":d.triggerId,...s,ref:p,align:"start",side:c.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:v=>{var x;c.isUsingKeyboardRef.current&&((x=m.current)==null||x.focus()),v.preventDefault()},onCloseAutoFocus:v=>v.preventDefault(),onFocusOutside:Lt(r.onFocusOutside,v=>{v.target!==d.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:Lt(r.onEscapeKeyDown,v=>{c.onClose(),v.preventDefault()}),onKeyDown:Lt(r.onKeyDown,v=>{var S;const x=v.currentTarget.contains(v.target),b=lV[c.dir].includes(v.key);x&&b&&(i.onOpenChange(!1),(S=d.trigger)==null||S.focus(),v.preventDefault())})})})})})});gP.displayName=mP;function vP(r){return r?"open":"closed"}function Fy(r){return r==="indeterminate"}function FS(r){return Fy(r)?"indeterminate":r?"checked":"unchecked"}function TV(r){const e=document.activeElement;for(const t of r)if(t===e||(t.focus(),document.activeElement!==e))return}function AV(r,e){return r.map((t,n)=>r[(e+n)%r.length])}function RV(r,e,t){const s=e.length>1&&Array.from(e).every(p=>p===e[0])?e[0]:e,i=t?r.indexOf(t):-1;let c=AV(r,Math.max(i,0));s.length===1&&(c=c.filter(p=>p!==t));const m=c.find(p=>p.toLowerCase().startsWith(s.toLowerCase()));return m!==t?m:void 0}function IV(r,e){const{x:t,y:n}=r;let s=!1;for(let i=0,c=e.length-1;i<e.length;c=i++){const d=e[i],m=e[c],p=d.x,v=d.y,x=m.x,b=m.y;v>n!=b>n&&t<(x-p)*(n-v)/(b-v)+p&&(s=!s)}return s}function PV(r,e){if(!e)return!1;const t={x:r.clientX,y:r.clientY};return IV(t,e)}function Vm(r){return e=>e.pointerType==="mouse"?r(e):void 0}var FV=QI,jV=NS,OV=eP,DV=tP,LV=IS,MV=rP,$V=c0,UV=sP,zV=iP,HV=lP,BV=uP,GV=dP,WV=fP,VV=pP,qV=gP,u0="DropdownMenu",[KV]=Za(u0,[JI]),mo=JI(),[YV,yP]=KV(u0),xP=r=>{const{__scopeDropdownMenu:e,children:t,dir:n,open:s,defaultOpen:i,onOpenChange:c,modal:d=!0}=r,m=mo(e),p=w.useRef(null),[v,x]=ru({prop:s,defaultProp:i??!1,onChange:c,caller:u0});return u.jsx(YV,{scope:e,triggerId:Vl(),triggerRef:p,contentId:Vl(),open:v,onOpenChange:x,onOpenToggle:w.useCallback(()=>x(b=>!b),[x]),modal:d,children:u.jsx(FV,{...m,open:v,onOpenChange:x,dir:n,modal:d,children:t})})};xP.displayName=u0;var wP="DropdownMenuTrigger",bP=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,disabled:n=!1,...s}=r,i=yP(wP,t),c=mo(t);return u.jsx(jV,{asChild:!0,...c,children:u.jsx($r.button,{type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":n?"":void 0,disabled:n,...s,ref:tu(e,i.triggerRef),onPointerDown:Lt(r.onPointerDown,d=>{!n&&d.button===0&&d.ctrlKey===!1&&(i.onOpenToggle(),i.open||d.preventDefault())}),onKeyDown:Lt(r.onKeyDown,d=>{n||(["Enter"," "].includes(d.key)&&i.onOpenToggle(),d.key==="ArrowDown"&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(d.key)&&d.preventDefault())})})})});bP.displayName=wP;var JV="DropdownMenuPortal",_P=r=>{const{__scopeDropdownMenu:e,...t}=r,n=mo(e);return u.jsx(OV,{...n,...t})};_P.displayName=JV;var SP="DropdownMenuContent",EP=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=yP(SP,t),i=mo(t),c=w.useRef(!1);return u.jsx(DV,{id:s.contentId,"aria-labelledby":s.triggerId,...i,...n,ref:e,onCloseAutoFocus:Lt(r.onCloseAutoFocus,d=>{var m;c.current||(m=s.triggerRef.current)==null||m.focus(),c.current=!1,d.preventDefault()}),onInteractOutside:Lt(r.onInteractOutside,d=>{const m=d.detail.originalEvent,p=m.button===0&&m.ctrlKey===!0,v=m.button===2||p;(!s.modal||v)&&(c.current=!0)}),style:{...r.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});EP.displayName=SP;var XV="DropdownMenuGroup",QV=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=mo(t);return u.jsx(LV,{...s,...n,ref:e})});QV.displayName=XV;var ZV="DropdownMenuLabel",CP=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=mo(t);return u.jsx(MV,{...s,...n,ref:e})});CP.displayName=ZV;var eq="DropdownMenuItem",kP=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=mo(t);return u.jsx($V,{...s,...n,ref:e})});kP.displayName=eq;var tq="DropdownMenuCheckboxItem",NP=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=mo(t);return u.jsx(UV,{...s,...n,ref:e})});NP.displayName=tq;var rq="DropdownMenuRadioGroup",nq=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=mo(t);return u.jsx(zV,{...s,...n,ref:e})});nq.displayName=rq;var sq="DropdownMenuRadioItem",TP=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=mo(t);return u.jsx(HV,{...s,...n,ref:e})});TP.displayName=sq;var oq="DropdownMenuItemIndicator",AP=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=mo(t);return u.jsx(BV,{...s,...n,ref:e})});AP.displayName=oq;var iq="DropdownMenuSeparator",RP=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=mo(t);return u.jsx(GV,{...s,...n,ref:e})});RP.displayName=iq;var aq="DropdownMenuArrow",lq=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=mo(t);return u.jsx(WV,{...s,...n,ref:e})});lq.displayName=aq;var cq="DropdownMenuSubTrigger",IP=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=mo(t);return u.jsx(VV,{...s,...n,ref:e})});IP.displayName=cq;var uq="DropdownMenuSubContent",PP=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,s=mo(t);return u.jsx(qV,{...s,...n,ref:e,style:{...r.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});PP.displayName=uq;var dq=xP,fq=bP,hq=_P,FP=EP,jP=CP,OP=kP,DP=NP,LP=TP,MP=AP,$P=RP,UP=IP,zP=PP;const jo=dq,Oo=fq,pq=w.forwardRef(({className:r,inset:e,children:t,...n},s)=>u.jsxs(UP,{ref:s,className:jr("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",e&&"pl-8",r),...n,children:[t,u.jsx(Kv,{className:"ml-auto h-4 w-4"})]}));pq.displayName=UP.displayName;const mq=w.forwardRef(({className:r,...e},t)=>u.jsx(zP,{ref:t,className:jr("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in data-[side=bottom]:slide-in-from-top-1 data-[side=left]:slide-in-from-right-1 data-[side=right]:slide-in-from-left-1 data-[side=top]:slide-in-from-bottom-1",r),...e}));mq.displayName=zP.displayName;const co=w.forwardRef(({className:r,sideOffset:e=4,...t},n)=>u.jsx(hq,{children:u.jsx(FP,{ref:n,sideOffset:e,className:jr("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-white dark:bg-card p-1 text-neutral-950 dark:text-card-foreground shadow-md animate-in data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r),...t})}));co.displayName=FP.displayName;const bs=w.forwardRef(({className:r,inset:e,...t},n)=>u.jsx(OP,{ref:n,className:jr("relative flex cursor-pointer select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors hover:bg-neutral-100 dark:hover:bg-muted focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 dark:text-gray-200",e&&"pl-8",r),...t}));bs.displayName=OP.displayName;const gq=w.forwardRef(({className:r,children:e,checked:t,...n},s)=>u.jsxs(DP,{ref:s,className:jr("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r),checked:t,...n,children:[u.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:u.jsx(MP,{children:u.jsx(sB,{className:"h-4 w-4"})})}),e]}));gq.displayName=DP.displayName;const vq=w.forwardRef(({className:r,children:e,...t},n)=>u.jsxs(LP,{ref:n,className:jr("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r),...t,children:[u.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:u.jsx(MP,{children:u.jsx("div",{className:"h-2 w-2 rounded-full bg-current"})})}),e]}));vq.displayName=LP.displayName;const yq=w.forwardRef(({className:r,inset:e,...t},n)=>u.jsx(jP,{ref:n,className:jr("px-2 py-1.5 text-sm font-semibold",e&&"pl-8",r),...t}));yq.displayName=jP.displayName;const jy=w.forwardRef(({className:r,...e},t)=>u.jsx($P,{ref:t,className:jr("-mx-1 my-1 h-px bg-neutral-100",r),...e}));jy.displayName=$P.displayName;var xm={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */var xq=xm.exports,h1;function wq(){return h1||(h1=1,(function(r,e){(function(){var t,n="4.17.23",s=200,i="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",c="Expected a function",d="Invalid `variable` option passed into `_.template`",m="__lodash_hash_undefined__",p=500,v="__lodash_placeholder__",x=1,b=2,S=4,N=1,E=2,T=1,A=2,R=4,F=8,j=16,L=32,G=64,z=128,q=256,ae=512,oe=30,fe="...",H=800,me=16,ee=1,se=2,de=3,Y=1/0,J=9007199254740991,$=17976931348623157e292,X=NaN,O=4294967295,U=O-1,re=O>>>1,Ee=[["ary",z],["bind",T],["bindKey",A],["curry",F],["curryRight",j],["flip",ae],["partial",L],["partialRight",G],["rearg",q]],ne="[object Arguments]",we="[object Array]",K="[object AsyncFunction]",he="[object Boolean]",be="[object Date]",Ie="[object DOMException]",_t="[object Error]",Be="[object Function]",Ge="[object GeneratorFunction]",qe="[object Map]",Ne="[object Number]",St="[object Null]",ct="[object Object]",Ct="[object Promise]",Gt="[object Proxy]",$t="[object RegExp]",Kt="[object Set]",hr="[object String]",Ur="[object Symbol]",zr="[object Undefined]",kr="[object WeakMap]",ge="[object WeakSet]",Pe="[object ArrayBuffer]",pt="[object DataView]",wt="[object Float32Array]",ze="[object Float64Array]",He="[object Int8Array]",rt="[object Int16Array]",Re="[object Int32Array]",ft="[object Uint8Array]",Mt="[object Uint8ClampedArray]",Ue="[object Uint16Array]",rr="[object Uint32Array]",kt=/\b__p \+= '';/g,vr=/\b(__p \+=) '' \+/g,nr=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Jt=/&(?:amp|lt|gt|quot|#39);/g,$n=/[&<>"']/g,Un=RegExp(Jt.source),Gs=RegExp($n.source),Cs=/<%-([\s\S]+?)%>/g,Tr=/<%([\s\S]+?)%>/g,yn=/<%=([\s\S]+?)%>/g,go=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Mo=/^\w*$/,En=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ws=/[\\^$.*+?()[\]{}|]/g,Vs=RegExp(Ws.source),Li=/^\s+/,cn=/\s/,ce=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Ve=/\{\n\/\* \[wrapped with (.+)\] \*/,gt=/,? & /,mt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ut=/[()=,{}\[\]\/\s]/,yt=/\\(\\)?/g,ht=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Xt=/\w*$/,Yn=/^[-+]0x[0-9a-f]+$/i,Qr=/^0b[01]+$/i,ur=/^\[object .+?Constructor\]$/,at=/^0o[0-7]+$/i,Q=/^(?:0|[1-9]\d*)$/,Le=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,nt=/($^)/,Fr=/['\n\r\u2028\u2029\\]/g,Yt="\\ud800-\\udfff",Wr="\\u0300-\\u036f",fn="\\ufe20-\\ufe2f",ls="\\u20d0-\\u20ff",ks=Wr+fn+ls,Mi="\\u2700-\\u27bf",Vr="a-z\\xdf-\\xf6\\xf8-\\xff",$o="\\xac\\xb1\\xd7\\xf7",Jn="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",nu="\\u2000-\\u206f",Ns=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",ma="A-Z\\xc0-\\xd6\\xd8-\\xde",su="\\ufe0e\\ufe0f",ou=$o+Jn+nu+Ns,li="[']",ci="["+Yt+"]",qs="["+ou+"]",Ks="["+ks+"]",iu="\\d+",Sh="["+Mi+"]",Zl="["+Vr+"]",au="[^"+Yt+ou+iu+Mi+Vr+ma+"]",tl="\\ud83c[\\udffb-\\udfff]",rl="(?:"+Ks+"|"+tl+")",vd="[^"+Yt+"]",nl="(?:\\ud83c[\\udde6-\\uddff]){2}",yr="[\\ud800-\\udbff][\\udc00-\\udfff]",Ys="["+ma+"]",sl="\\u200d",ec="(?:"+Zl+"|"+au+")",lu="(?:"+Ys+"|"+au+")",cu="(?:"+li+"(?:d|ll|m|re|s|t|ve))?",uu="(?:"+li+"(?:D|LL|M|RE|S|T|VE))?",tc=rl+"?",ol="["+su+"]?",ui="(?:"+sl+"(?:"+[vd,nl,yr].join("|")+")"+ol+tc+")*",di="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Uo="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",$i=ol+tc+ui,_e="(?:"+[Sh,nl,yr].join("|")+")"+$i,Me="(?:"+[vd+Ks+"?",Ks,nl,yr,ci].join("|")+")",Ke=RegExp(li,"g"),At=RegExp(Ks,"g"),Nt=RegExp(tl+"(?="+tl+")|"+Me+$i,"g"),Ut=RegExp([Ys+"?"+Zl+"+"+cu+"(?="+[qs,Ys,"$"].join("|")+")",lu+"+"+uu+"(?="+[qs,Ys+ec,"$"].join("|")+")",Ys+"?"+ec+"+"+cu,Ys+"+"+uu,Uo,di,iu,_e].join("|"),"g"),st=RegExp("["+sl+Yt+ks+su+"]"),it=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Xn=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Js=-1,Sr={};Sr[wt]=Sr[ze]=Sr[He]=Sr[rt]=Sr[Re]=Sr[ft]=Sr[Mt]=Sr[Ue]=Sr[rr]=!0,Sr[ne]=Sr[we]=Sr[Pe]=Sr[he]=Sr[pt]=Sr[be]=Sr[_t]=Sr[Be]=Sr[qe]=Sr[Ne]=Sr[ct]=Sr[$t]=Sr[Kt]=Sr[hr]=Sr[kr]=!1;var Qt={};Qt[ne]=Qt[we]=Qt[Pe]=Qt[pt]=Qt[he]=Qt[be]=Qt[wt]=Qt[ze]=Qt[He]=Qt[rt]=Qt[Re]=Qt[qe]=Qt[Ne]=Qt[ct]=Qt[$t]=Qt[Kt]=Qt[hr]=Qt[Ur]=Qt[ft]=Qt[Mt]=Qt[Ue]=Qt[rr]=!0,Qt[_t]=Qt[Be]=Qt[kr]=!1;var ga={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},Ui={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},yd={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},xd={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},il=parseFloat,wd=parseInt,bd=typeof xv=="object"&&xv&&xv.Object===Object&&xv,ag=typeof self=="object"&&self&&self.Object===Object&&self,Zr=bd||ag||Function("return this")(),du=e&&!e.nodeType&&e,fi=du&&!0&&r&&!r.nodeType&&r,Eh=fi&&fi.exports===du,rc=Eh&&bd.process,cs=(function(){try{var le=fi&&fi.require&&fi.require("util").types;return le||rc&&rc.binding&&rc.binding("util")}catch{}})(),Ch=cs&&cs.isArrayBuffer,Ts=cs&&cs.isDate,al=cs&&cs.isMap,_d=cs&&cs.isRegExp,nc=cs&&cs.isSet,lg=cs&&cs.isTypedArray;function us(le,Ce,ye){switch(ye.length){case 0:return le.call(Ce);case 1:return le.call(Ce,ye[0]);case 2:return le.call(Ce,ye[0],ye[1]);case 3:return le.call(Ce,ye[0],ye[1],ye[2])}return le.apply(Ce,ye)}function kh(le,Ce,ye,Qe){for(var Wt=-1,Er=le==null?0:le.length;++Wt<Er;){var xn=le[Wt];Ce(Qe,xn,ye(xn),le)}return Qe}function Qn(le,Ce){for(var ye=-1,Qe=le==null?0:le.length;++ye<Qe&&Ce(le[ye],ye,le)!==!1;);return le}function Sd(le,Ce){for(var ye=le==null?0:le.length;ye--&&Ce(le[ye],ye,le)!==!1;);return le}function Nh(le,Ce){for(var ye=-1,Qe=le==null?0:le.length;++ye<Qe;)if(!Ce(le[ye],ye,le))return!1;return!0}function va(le,Ce){for(var ye=-1,Qe=le==null?0:le.length,Wt=0,Er=[];++ye<Qe;){var xn=le[ye];Ce(xn,ye,le)&&(Er[Wt++]=xn)}return Er}function Ed(le,Ce){var ye=le==null?0:le.length;return!!ye&&sc(le,Ce,0)>-1}function Th(le,Ce,ye){for(var Qe=-1,Wt=le==null?0:le.length;++Qe<Wt;)if(ye(Ce,le[Qe]))return!0;return!1}function Hr(le,Ce){for(var ye=-1,Qe=le==null?0:le.length,Wt=Array(Qe);++ye<Qe;)Wt[ye]=Ce(le[ye],ye,le);return Wt}function ya(le,Ce){for(var ye=-1,Qe=Ce.length,Wt=le.length;++ye<Qe;)le[Wt+ye]=Ce[ye];return le}function Ah(le,Ce,ye,Qe){var Wt=-1,Er=le==null?0:le.length;for(Qe&&Er&&(ye=le[++Wt]);++Wt<Er;)ye=Ce(ye,le[Wt],Wt,le);return ye}function p0(le,Ce,ye,Qe){var Wt=le==null?0:le.length;for(Qe&&Wt&&(ye=le[--Wt]);Wt--;)ye=Ce(ye,le[Wt],Wt,le);return ye}function Rh(le,Ce){for(var ye=-1,Qe=le==null?0:le.length;++ye<Qe;)if(Ce(le[ye],ye,le))return!0;return!1}var m0=Ph("length");function cg(le){return le.split("")}function g0(le){return le.match(mt)||[]}function ug(le,Ce,ye){var Qe;return ye(le,function(Wt,Er,xn){if(Ce(Wt,Er,xn))return Qe=Er,!1}),Qe}function Cd(le,Ce,ye,Qe){for(var Wt=le.length,Er=ye+(Qe?1:-1);Qe?Er--:++Er<Wt;)if(Ce(le[Er],Er,le))return Er;return-1}function sc(le,Ce,ye){return Ce===Ce?Td(le,Ce,ye):Cd(le,dg,ye)}function Ih(le,Ce,ye,Qe){for(var Wt=ye-1,Er=le.length;++Wt<Er;)if(Qe(le[Wt],Ce))return Wt;return-1}function dg(le){return le!==le}function fg(le,Ce){var ye=le==null?0:le.length;return ye?Fh(le,Ce)/ye:X}function Ph(le){return function(Ce){return Ce==null?t:Ce[le]}}function kd(le){return function(Ce){return le==null?t:le[Ce]}}function hg(le,Ce,ye,Qe,Wt){return Wt(le,function(Er,xn,Or){ye=Qe?(Qe=!1,Er):Ce(ye,Er,xn,Or)}),ye}function v0(le,Ce){var ye=le.length;for(le.sort(Ce);ye--;)le[ye]=le[ye].value;return le}function Fh(le,Ce){for(var ye,Qe=-1,Wt=le.length;++Qe<Wt;){var Er=Ce(le[Qe]);Er!==t&&(ye=ye===t?Er:ye+Er)}return ye}function jh(le,Ce){for(var ye=-1,Qe=Array(le);++ye<le;)Qe[ye]=Ce(ye);return Qe}function y0(le,Ce){return Hr(Ce,function(ye){return[ye,le[ye]]})}function pg(le){return le&&le.slice(0,Ad(le)+1).replace(Li,"")}function Xs(le){return function(Ce){return le(Ce)}}function fu(le,Ce){return Hr(Ce,function(ye){return le[ye]})}function zi(le,Ce){return le.has(Ce)}function mg(le,Ce){for(var ye=-1,Qe=le.length;++ye<Qe&&sc(Ce,le[ye],0)>-1;);return ye}function Oh(le,Ce){for(var ye=le.length;ye--&&sc(Ce,le[ye],0)>-1;);return ye}function gg(le,Ce){for(var ye=le.length,Qe=0;ye--;)le[ye]===Ce&&++Qe;return Qe}var vg=kd(ga),yg=kd(Ui);function xg(le){return"\\"+xd[le]}function oc(le,Ce){return le==null?t:le[Ce]}function ic(le){return st.test(le)}function x0(le){return it.test(le)}function w0(le){for(var Ce,ye=[];!(Ce=le.next()).done;)ye.push(Ce.value);return ye}function Nd(le){var Ce=-1,ye=Array(le.size);return le.forEach(function(Qe,Wt){ye[++Ce]=[Wt,Qe]}),ye}function Dh(le,Ce){return function(ye){return le(Ce(ye))}}function vo(le,Ce){for(var ye=-1,Qe=le.length,Wt=0,Er=[];++ye<Qe;){var xn=le[ye];(xn===Ce||xn===v)&&(le[ye]=v,Er[Wt++]=ye)}return Er}function xa(le){var Ce=-1,ye=Array(le.size);return le.forEach(function(Qe){ye[++Ce]=Qe}),ye}function b0(le){var Ce=-1,ye=Array(le.size);return le.forEach(function(Qe){ye[++Ce]=[Qe,Qe]}),ye}function Td(le,Ce,ye){for(var Qe=ye-1,Wt=le.length;++Qe<Wt;)if(le[Qe]===Ce)return Qe;return-1}function _0(le,Ce,ye){for(var Qe=ye+1;Qe--;)if(le[Qe]===Ce)return Qe;return Qe}function ll(le){return ic(le)?bg(le):m0(le)}function Qs(le){return ic(le)?_g(le):cg(le)}function Ad(le){for(var Ce=le.length;Ce--&&cn.test(le.charAt(Ce)););return Ce}var wg=kd(yd);function bg(le){for(var Ce=Nt.lastIndex=0;Nt.test(le);)++Ce;return Ce}function _g(le){return le.match(Nt)||[]}function S0(le){return le.match(Ut)||[]}var E0=(function le(Ce){Ce=Ce==null?Zr:ac.defaults(Zr.Object(),Ce,ac.pick(Zr,Xn));var ye=Ce.Array,Qe=Ce.Date,Wt=Ce.Error,Er=Ce.Function,xn=Ce.Math,Or=Ce.Object,hu=Ce.RegExp,C0=Ce.String,yo=Ce.TypeError,Hi=ye.prototype,Lh=Er.prototype,hi=Or.prototype,lc=Ce["__core-js_shared__"],pu=Lh.toString,xr=hi.hasOwnProperty,cc=0,Rd=(function(){var l=/[^.]+$/.exec(lc&&lc.keys&&lc.keys.IE_PROTO||"");return l?"Symbol(src)_1."+l:""})(),mu=hi.toString,Id=pu.call(Or),Sg=Zr._,Eg=hu("^"+pu.call(xr).replace(Ws,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),gu=Eh?Ce.Buffer:t,Bi=Ce.Symbol,vu=Ce.Uint8Array,Mh=gu?gu.allocUnsafe:t,zo=Dh(Or.getPrototypeOf,Or),Pd=Or.create,Fd=hi.propertyIsEnumerable,jd=Hi.splice,Cg=Bi?Bi.isConcatSpreadable:t,Gi=Bi?Bi.iterator:t,cl=Bi?Bi.toStringTag:t,yu=(function(){try{var l=Ra(Or,"defineProperty");return l({},"",{}),l}catch{}})(),kg=Ce.clearTimeout!==Zr.clearTimeout&&Ce.clearTimeout,qr=Qe&&Qe.now!==Zr.Date.now&&Qe.now,$h=Ce.setTimeout!==Zr.setTimeout&&Ce.setTimeout,ul=xn.ceil,wa=xn.floor,Od=Or.getOwnPropertySymbols,Uh=gu?gu.isBuffer:t,uc=Ce.isFinite,Dd=Hi.join,dc=Dh(Or.keys,Or),wn=xn.max,Zn=xn.min,k0=Qe.now,Ng=Ce.parseInt,xu=xn.random,Ld=Hi.reverse,wu=Ra(Ce,"DataView"),dl=Ra(Ce,"Map"),bu=Ra(Ce,"Promise"),ba=Ra(Ce,"Set"),_u=Ra(Ce,"WeakMap"),fc=Ra(Or,"create"),Md=_u&&new _u,hc={},zh=Ia(wu),_a=Ia(dl),Tg=Ia(bu),pc=Ia(ba),pi=Ia(_u),Sa=Bi?Bi.prototype:t,Zs=Sa?Sa.valueOf:t,$d=Sa?Sa.toString:t;function D(l){if(_n(l)&&!er(l)&&!(l instanceof Zt)){if(l instanceof es)return l;if(xr.call(l,"__wrapped__"))return rv(l)}return new es(l)}var mc=(function(){function l(){}return function(f){if(!mn(f))return{};if(Pd)return Pd(f);l.prototype=f;var y=new l;return l.prototype=t,y}})();function mi(){}function es(l,f){this.__wrapped__=l,this.__actions__=[],this.__chain__=!!f,this.__index__=0,this.__values__=t}D.templateSettings={escape:Cs,evaluate:Tr,interpolate:yn,variable:"",imports:{_:D}},D.prototype=mi.prototype,D.prototype.constructor=D,es.prototype=mc(mi.prototype),es.prototype.constructor=es;function Zt(l){this.__wrapped__=l,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=O,this.__views__=[]}function Ud(){var l=new Zt(this.__wrapped__);return l.__actions__=fs(this.__actions__),l.__dir__=this.__dir__,l.__filtered__=this.__filtered__,l.__iteratees__=fs(this.__iteratees__),l.__takeCount__=this.__takeCount__,l.__views__=fs(this.__views__),l}function Hh(){if(this.__filtered__){var l=new Zt(this);l.__dir__=-1,l.__filtered__=!0}else l=this.clone(),l.__dir__*=-1;return l}function gc(){var l=this.__wrapped__.value(),f=this.__dir__,y=er(l),C=f<0,I=y?l.length:0,M=gp(0,I,this.__views__),V=M.start,te=M.end,ue=te-V,Te=C?te:V-1,Ae=this.__iteratees__,Oe=Ae.length,Ye=0,bt=Zn(ue,this.__takeCount__);if(!y||!C&&I==ue&&bt==ue)return Ec(l,this.__actions__);var Ht=[];e:for(;ue--&&Ye<bt;){Te+=f;for(var ar=-1,Bt=l[Te];++ar<Oe;){var dr=Ae[ar],br=dr.iteratee,Xo=dr.type,so=br(Bt);if(Xo==se)Bt=so;else if(!so){if(Xo==ee)continue e;break e}}Ht[Ye++]=Bt}return Ht}Zt.prototype=mc(mi.prototype),Zt.prototype.constructor=Zt;function As(l){var f=-1,y=l==null?0:l.length;for(this.clear();++f<y;){var C=l[f];this.set(C[0],C[1])}}function Kr(){this.__data__=fc?fc(null):{},this.size=0}function Br(l){var f=this.has(l)&&delete this.__data__[l];return this.size-=f?1:0,f}function Ea(l){var f=this.__data__;if(fc){var y=f[l];return y===m?t:y}return xr.call(f,l)?f[l]:t}function ts(l){var f=this.__data__;return fc?f[l]!==t:xr.call(f,l)}function Rs(l,f){var y=this.__data__;return this.size+=this.has(l)?0:1,y[l]=fc&&f===t?m:f,this}As.prototype.clear=Kr,As.prototype.delete=Br,As.prototype.get=Ea,As.prototype.has=ts,As.prototype.set=Rs;function ds(l){var f=-1,y=l==null?0:l.length;for(this.clear();++f<y;){var C=l[f];this.set(C[0],C[1])}}function vc(){this.__data__=[],this.size=0}function Is(l){var f=this.__data__,y=ns(f,l);if(y<0)return!1;var C=f.length-1;return y==C?f.pop():jd.call(f,y,1),--this.size,!0}function zd(l){var f=this.__data__,y=ns(f,l);return y<0?t:f[y][1]}function Ag(l){return ns(this.__data__,l)>-1}function Rg(l,f){var y=this.__data__,C=ns(y,l);return C<0?(++this.size,y.push([l,f])):y[C][1]=f,this}ds.prototype.clear=vc,ds.prototype.delete=Is,ds.prototype.get=zd,ds.prototype.has=Ag,ds.prototype.set=Rg;function xo(l){var f=-1,y=l==null?0:l.length;for(this.clear();++f<y;){var C=l[f];this.set(C[0],C[1])}}function Ig(){this.size=0,this.__data__={hash:new As,map:new(dl||ds),string:new As}}function Wi(l){var f=Mu(this,l).delete(l);return this.size-=f?1:0,f}function Hd(l){return Mu(this,l).get(l)}function Bh(l){return Mu(this,l).has(l)}function Pg(l,f){var y=Mu(this,l),C=y.size;return y.set(l,f),this.size+=y.size==C?0:1,this}xo.prototype.clear=Ig,xo.prototype.delete=Wi,xo.prototype.get=Hd,xo.prototype.has=Bh,xo.prototype.set=Pg;function fl(l){var f=-1,y=l==null?0:l.length;for(this.__data__=new xo;++f<y;)this.add(l[f])}function Ca(l){return this.__data__.set(l,m),this}function yc(l){return this.__data__.has(l)}fl.prototype.add=fl.prototype.push=Ca,fl.prototype.has=yc;function rs(l){var f=this.__data__=new ds(l);this.size=f.size}function Bd(){this.__data__=new ds,this.size=0}function Gd(l){var f=this.__data__,y=f.delete(l);return this.size=f.size,y}function wo(l){return this.__data__.get(l)}function bo(l){return this.__data__.has(l)}function hl(l,f){var y=this.__data__;if(y instanceof ds){var C=y.__data__;if(!dl||C.length<s-1)return C.push([l,f]),this.size=++y.size,this;y=this.__data__=new xo(C)}return y.set(l,f),this.size=y.size,this}rs.prototype.clear=Bd,rs.prototype.delete=Gd,rs.prototype.get=wo,rs.prototype.has=bo,rs.prototype.set=hl;function gi(l,f){var y=er(l),C=!y&&Ju(l),I=!y&&!C&&jc(l),M=!y&&!C&&!I&&jf(l),V=y||C||I||M,te=V?jh(l.length,C0):[],ue=te.length;for(var Te in l)(f||xr.call(l,Te))&&!(V&&(Te=="length"||I&&(Te=="offset"||Te=="parent")||M&&(Te=="buffer"||Te=="byteLength"||Te=="byteOffset")||tn(Te,ue)))&&te.push(Te);return te}function vi(l){var f=l.length;return f?l[_c(0,f-1)]:t}function pl(l,f){return vf(fs(l),Vi(f,0,l.length))}function Fg(l){return vf(fs(l))}function Su(l,f,y){(y!==t&&!ra(l[f],y)||y===t&&!(f in l))&&yi(l,f,y)}function ml(l,f,y){var C=l[f];(!(xr.call(l,f)&&ra(C,y))||y===t&&!(f in l))&&yi(l,f,y)}function ns(l,f){for(var y=l.length;y--;)if(ra(l[y][0],f))return y;return-1}function eo(l,f,y,C){return wi(l,function(I,M,V){f(C,I,y(I),V)}),C}function Yr(l,f){return l&&Bo(f,is(f),l)}function Ho(l,f){return l&&Bo(f,Ro(f),l)}function yi(l,f,y){f=="__proto__"&&yu?yu(l,f,{configurable:!0,enumerable:!0,value:y,writable:!0}):l[f]=y}function Wd(l,f){for(var y=-1,C=f.length,I=ye(C),M=l==null;++y<C;)I[y]=M?t:J0(l,f[y]);return I}function Vi(l,f,y){return l===l&&(y!==t&&(l=l<=y?l:y),f!==t&&(l=l>=f?l:f)),l}function Ps(l,f,y,C,I,M){var V,te=f&x,ue=f&b,Te=f&S;if(y&&(V=I?y(l,C,I,M):y(l)),V!==t)return V;if(!mn(l))return l;var Ae=er(l);if(Ae){if(V=Uu(l),!te)return fs(l,V)}else{var Oe=Bn(l),Ye=Oe==Be||Oe==Ge;if(jc(l))return sp(l,te);if(Oe==ct||Oe==ne||Ye&&!I){if(V=ue||Ye?{}:Gn(l),!te)return ue?T0(l,Ho(V,l)):sf(l,Yr(V,l))}else{if(!Qt[Oe])return I?l:{};V=A0(l,Oe,te)}}M||(M=new rs);var bt=M.get(l);if(bt)return bt;M.set(l,V),WS(l)?l.forEach(function(Bt){V.add(Ps(Bt,f,y,Bt,l,M))}):BS(l)&&l.forEach(function(Bt,dr){V.set(dr,Ps(Bt,f,y,dr,l,M))});var Ht=Te?ue?Lu:Du:ue?Ro:is,ar=Ae?t:Ht(l);return Qn(ar||l,function(Bt,dr){ar&&(dr=Bt,Bt=l[dr]),ml(V,dr,Ps(Bt,f,y,dr,l,M))}),V}function jg(l){var f=is(l);return function(y){return Eu(y,l,f)}}function Eu(l,f,y){var C=y.length;if(l==null)return!C;for(l=Or(l);C--;){var I=y[C],M=f[I],V=l[I];if(V===t&&!(I in l)||!M(V))return!1}return!0}function Gh(l,f,y){if(typeof l!="function")throw new yo(c);return Ic(function(){l.apply(t,y)},f)}function xi(l,f,y,C){var I=-1,M=Ed,V=!0,te=l.length,ue=[],Te=f.length;if(!te)return ue;y&&(f=Hr(f,Xs(y))),C?(M=Th,V=!1):f.length>=s&&(M=zi,V=!1,f=new fl(f));e:for(;++I<te;){var Ae=l[I],Oe=y==null?Ae:y(Ae);if(Ae=C||Ae!==0?Ae:0,V&&Oe===Oe){for(var Ye=Te;Ye--;)if(f[Ye]===Oe)continue e;ue.push(Ae)}else M(f,Oe,C)||ue.push(Ae)}return ue}var wi=ko(to),Og=ko(ka,!0);function Cu(l,f){var y=!0;return wi(l,function(C,I,M){return y=!!f(C,I,M),y}),y}function gl(l,f,y){for(var C=-1,I=l.length;++C<I;){var M=l[C],V=f(M);if(V!=null&&(te===t?V===V&&!Jo(V):y(V,te)))var te=V,ue=M}return ue}function Dg(l,f,y,C){var I=l.length;for(y=or(y),y<0&&(y=-y>I?0:I+y),C=C===t||C>I?I:or(C),C<0&&(C+=I),C=y>C?0:qS(C);y<C;)l[y++]=f;return l}function Wh(l,f){var y=[];return wi(l,function(C,I,M){f(C,I,M)&&y.push(C)}),y}function un(l,f,y,C,I){var M=-1,V=l.length;for(y||(y=pf),I||(I=[]);++M<V;){var te=l[M];f>0&&y(te)?f>1?un(te,f-1,y,C,I):ya(I,te):C||(I[I.length]=te)}return I}var Vd=af(),ku=af(!0);function to(l,f){return l&&Vd(l,f,is)}function ka(l,f){return l&&ku(l,f,is)}function xc(l,f){return va(f,function(y){return Al(l[y])})}function qi(l,f){f=Si(f,l);for(var y=0,C=f.length;l!=null&&y<C;)l=l[qo(f[y++])];return y&&y==C?l:t}function qd(l,f,y){var C=f(l);return er(l)?C:ya(C,y(l))}function zn(l){return l==null?l===t?zr:St:cl&&cl in Or(l)?hf(l):yp(l)}function Na(l,f){return l>f}function _o(l,f){return l!=null&&xr.call(l,f)}function vl(l,f){return l!=null&&f in Or(l)}function Vh(l,f,y){return l>=Zn(f,y)&&l<wn(f,y)}function Kd(l,f,y){for(var C=y?Th:Ed,I=l[0].length,M=l.length,V=M,te=ye(M),ue=1/0,Te=[];V--;){var Ae=l[V];V&&f&&(Ae=Hr(Ae,Xs(f))),ue=Zn(Ae.length,ue),te[V]=!y&&(f||I>=120&&Ae.length>=120)?new fl(V&&Ae):t}Ae=l[0];var Oe=-1,Ye=te[0];e:for(;++Oe<I&&Te.length<ue;){var bt=Ae[Oe],Ht=f?f(bt):bt;if(bt=y||bt!==0?bt:0,!(Ye?zi(Ye,Ht):C(Te,Ht,y))){for(V=M;--V;){var ar=te[V];if(!(ar?zi(ar,Ht):C(l[V],Ht,y)))continue e}Ye&&Ye.push(Ht),Te.push(bt)}}return Te}function Ki(l,f,y,C){return to(l,function(I,M,V){f(C,y(I),M,V)}),C}function So(l,f,y){f=Si(f,l),l=Pn(l,f);var C=l==null?l:l[qo(ms(f))];return C==null?t:us(C,l,y)}function Yd(l){return _n(l)&&zn(l)==ne}function Lg(l){return _n(l)&&zn(l)==Pe}function Yi(l){return _n(l)&&zn(l)==be}function Eo(l,f,y,C,I){return l===f?!0:l==null||f==null||!_n(l)&&!_n(f)?l!==l&&f!==f:Jd(l,f,y,C,Eo,I)}function Jd(l,f,y,C,I,M){var V=er(l),te=er(f),ue=V?we:Bn(l),Te=te?we:Bn(f);ue=ue==ne?ct:ue,Te=Te==ne?ct:Te;var Ae=ue==ct,Oe=Te==ct,Ye=ue==Te;if(Ye&&jc(l)){if(!jc(f))return!1;V=!0,Ae=!1}if(Ye&&!Ae)return M||(M=new rs),V||jf(l)?pp(l,f,y,C,I,M):mp(l,f,ue,y,C,I,M);if(!(y&N)){var bt=Ae&&xr.call(l,"__wrapped__"),Ht=Oe&&xr.call(f,"__wrapped__");if(bt||Ht){var ar=bt?l.value():l,Bt=Ht?f.value():f;return M||(M=new rs),I(ar,Bt,y,C,M)}}return Ye?(M||(M=new rs),Kg(l,f,y,C,I,M)):!1}function Mg(l){return _n(l)&&Bn(l)==qe}function wc(l,f,y,C){var I=y.length,M=I,V=!C;if(l==null)return!M;for(l=Or(l);I--;){var te=y[I];if(V&&te[2]?te[1]!==l[te[0]]:!(te[0]in l))return!1}for(;++I<M;){te=y[I];var ue=te[0],Te=l[ue],Ae=te[1];if(V&&te[2]){if(Te===t&&!(ue in l))return!1}else{var Oe=new rs;if(C)var Ye=C(Te,Ae,ue,l,f,Oe);if(!(Ye===t?Eo(Ae,Te,N|E,C,Oe):Ye))return!1}}return!0}function qh(l){if(!mn(l)||Xg(l))return!1;var f=Al(l)?Eg:ur;return f.test(Ia(l))}function Nu(l){return _n(l)&&zn(l)==$t}function bi(l){return _n(l)&&Bn(l)==Kt}function Tu(l){return _n(l)&&gv(l.length)&&!!Sr[zn(l)]}function bc(l){return typeof l=="function"?l:l==null?Io:typeof l=="object"?er(l)?en(l[0],l[1]):Xd(l):sE(l)}function Ji(l){if(!ea(l))return dc(l);var f=[];for(var y in Or(l))xr.call(l,y)&&y!="constructor"&&f.push(y);return f}function Kh(l){if(!mn(l))return ev(l);var f=ea(l),y=[];for(var C in l)C=="constructor"&&(f||!xr.call(l,C))||y.push(C);return y}function Ta(l,f){return l<f}function Yh(l,f){var y=-1,C=Ao(l)?ye(l.length):[];return wi(l,function(I,M,V){C[++y]=f(I,M,V)}),C}function Xd(l){var f=$u(l);return f.length==1&&f[0][2]?mf(f[0][0],f[0][1]):function(y){return y===l||wc(y,l,f)}}function en(l,f){return ot(l)&&Hu(f)?mf(qo(l),f):function(y){var C=J0(y,l);return C===t&&C===f?X0(y,l):Eo(f,C,N|E)}}function yl(l,f,y,C,I){l!==f&&Vd(f,function(M,V){if(I||(I=new rs),mn(M))Jh(l,f,V,y,yl,C,I);else{var te=C?C(ki(l,V),M,V+"",l,f,I):t;te===t&&(te=M),Su(l,V,te)}},Ro)}function Jh(l,f,y,C,I,M,V){var te=ki(l,y),ue=ki(f,y),Te=V.get(ue);if(Te){Su(l,y,Te);return}var Ae=M?M(te,ue,y+"",l,f,V):t,Oe=Ae===t;if(Oe){var Ye=er(ue),bt=!Ye&&jc(ue),Ht=!Ye&&!bt&&jf(ue);Ae=ue,Ye||bt||Ht?er(te)?Ae=te:Nn(te)?Ae=fs(te):bt?(Oe=!1,Ae=sp(ue,!0)):Ht?(Oe=!1,Ae=Bg(ue,!0)):Ae=[]:Dp(ue)||Ju(ue)?(Ae=te,Ju(te)?Ae=KS(te):(!mn(te)||Al(te))&&(Ae=Gn(ue))):Oe=!1}Oe&&(V.set(ue,Ae),I(Ae,ue,C,M,V),V.delete(ue)),Su(l,y,Ae)}function Qd(l,f){var y=l.length;if(y)return f+=f<0?y:0,tn(f,y)?l[f]:t}function Au(l,f,y){f.length?f=Hr(f,function(M){return er(M)?function(V){return qi(V,M.length===1?M[0]:M)}:M}):f=[Io];var C=-1;f=Hr(f,Xs(Dt()));var I=Yh(l,function(M,V,te){var ue=Hr(f,function(Te){return Te(M)});return{criteria:ue,index:++C,value:M}});return v0(I,function(M,V){return N0(M,V,y)})}function Xh(l,f){return Aa(l,f,function(y,C){return X0(l,C)})}function Aa(l,f,y){for(var C=-1,I=f.length,M={};++C<I;){var V=f[C],te=qi(l,V);y(te,V)&&wl(M,Si(V,l),te)}return M}function nn(l){return function(f){return qi(f,l)}}function hn(l,f,y,C){var I=C?Ih:sc,M=-1,V=f.length,te=l;for(l===f&&(f=fs(f)),y&&(te=Hr(l,Xs(y)));++M<V;)for(var ue=0,Te=f[M],Ae=y?y(Te):Te;(ue=I(te,Ae,ue,C))>-1;)te!==l&&jd.call(te,ue,1),jd.call(l,ue,1);return l}function Cn(l,f){for(var y=l?f.length:0,C=y-1;y--;){var I=f[y];if(y==C||I!==M){var M=I;tn(I)?jd.call(l,I,1):tf(l,I)}}return l}function _c(l,f){return l+wa(xu()*(f-l+1))}function Ru(l,f,y,C){for(var I=-1,M=wn(ul((f-l)/(y||1)),0),V=ye(M);M--;)V[C?M:++I]=l,l+=y;return V}function xl(l,f){var y="";if(!l||f<1||f>J)return y;do f%2&&(y+=l),f=wa(f/2),f&&(l+=l);while(f);return y}function sr(l,f){return ro(gf(l,f,Io),l+"")}function ss(l){return vi(Of(l))}function Qh(l,f){var y=Of(l);return vf(y,Vi(f,0,y.length))}function wl(l,f,y,C){if(!mn(l))return l;f=Si(f,l);for(var I=-1,M=f.length,V=M-1,te=l;te!=null&&++I<M;){var ue=qo(f[I]),Te=y;if(ue==="__proto__"||ue==="constructor"||ue==="prototype")return l;if(I!=V){var Ae=te[ue];Te=C?C(Ae,ue,te):t,Te===t&&(Te=mn(Ae)?Ae:tn(f[I+1])?[]:{})}ml(te,ue,Te),te=te[ue]}return l}var Zd=Md?function(l,f){return Md.set(l,f),l}:Io,_i=yu?function(l,f){return yu(l,"toString",{configurable:!0,enumerable:!1,value:Z0(f),writable:!0})}:Io;function Co(l){return vf(Of(l))}function os(l,f,y){var C=-1,I=l.length;f<0&&(f=-f>I?0:I+f),y=y>I?I:y,y<0&&(y+=I),I=f>y?0:y-f>>>0,f>>>=0;for(var M=ye(I);++C<I;)M[C]=l[C+f];return M}function Zh(l,f){var y;return wi(l,function(C,I,M){return y=f(C,I,M),!y}),!!y}function Sc(l,f,y){var C=0,I=l==null?C:l.length;if(typeof f=="number"&&f===f&&I<=re){for(;C<I;){var M=C+I>>>1,V=l[M];V!==null&&!Jo(V)&&(y?V<=f:V<f)?C=M+1:I=M}return I}return ef(l,f,Io,y)}function ef(l,f,y,C){var I=0,M=l==null?0:l.length;if(M===0)return 0;f=y(f);for(var V=f!==f,te=f===null,ue=Jo(f),Te=f===t;I<M;){var Ae=wa((I+M)/2),Oe=y(l[Ae]),Ye=Oe!==t,bt=Oe===null,Ht=Oe===Oe,ar=Jo(Oe);if(V)var Bt=C||Ht;else Te?Bt=Ht&&(C||Ye):te?Bt=Ht&&Ye&&(C||!bt):ue?Bt=Ht&&Ye&&!bt&&(C||!ar):bt||ar?Bt=!1:Bt=C?Oe<=f:Oe<f;Bt?I=Ae+1:M=Ae}return Zn(M,U)}function ep(l,f){for(var y=-1,C=l.length,I=0,M=[];++y<C;){var V=l[y],te=f?f(V):V;if(!y||!ra(te,ue)){var ue=te;M[I++]=V===0?0:V}}return M}function tp(l){return typeof l=="number"?l:Jo(l)?X:+l}function Fs(l){if(typeof l=="string")return l;if(er(l))return Hr(l,Fs)+"";if(Jo(l))return $d?$d.call(l):"";var f=l+"";return f=="0"&&1/l==-Y?"-0":f}function Xi(l,f,y){var C=-1,I=Ed,M=l.length,V=!0,te=[],ue=te;if(y)V=!1,I=Th;else if(M>=s){var Te=f?null:qg(l);if(Te)return xa(Te);V=!1,I=zi,ue=new fl}else ue=f?[]:te;e:for(;++C<M;){var Ae=l[C],Oe=f?f(Ae):Ae;if(Ae=y||Ae!==0?Ae:0,V&&Oe===Oe){for(var Ye=ue.length;Ye--;)if(ue[Ye]===Oe)continue e;f&&ue.push(Oe),te.push(Ae)}else I(ue,Oe,y)||(ue!==te&&ue.push(Oe),te.push(Ae))}return te}function tf(l,f){f=Si(f,l);var y=-1,C=f.length;if(!C)return!0;for(var I=l==null||typeof l!="object"&&typeof l!="function";++y<C;){var M=f[y];if(typeof M=="string"){if(M==="__proto__"&&!xr.call(l,"__proto__"))return!1;if(M==="constructor"&&y+1<C&&typeof f[y+1]=="string"&&f[y+1]==="prototype"){if(I&&y===0)continue;return!1}}}var V=Pn(l,f);return V==null||delete V[qo(ms(f))]}function rp(l,f,y,C){return wl(l,f,y(qi(l,f)),C)}function Iu(l,f,y,C){for(var I=l.length,M=C?I:-1;(C?M--:++M<I)&&f(l[M],M,l););return y?os(l,C?0:M,C?M+1:I):os(l,C?M+1:0,C?I:M)}function Ec(l,f){var y=l;return y instanceof Zt&&(y=y.value()),Ah(f,function(C,I){return I.func.apply(I.thisArg,ya([C],I.args))},y)}function rf(l,f,y){var C=l.length;if(C<2)return C?Xi(l[0]):[];for(var I=-1,M=ye(C);++I<C;)for(var V=l[I],te=-1;++te<C;)te!=I&&(M[I]=xi(M[I]||V,l[te],f,y));return Xi(un(M,1),f,y)}function Pu(l,f,y){for(var C=-1,I=l.length,M=f.length,V={};++C<I;){var te=C<M?f[C]:t;y(V,l[C],te)}return V}function Cc(l){return Nn(l)?l:[]}function nf(l){return typeof l=="function"?l:Io}function Si(l,f){return er(l)?l:ot(l,f)?[l]:bp(Dr(l))}var $g=sr;function Qi(l,f,y){var C=l.length;return y=y===t?C:y,!f&&y>=C?l:os(l,f,y)}var np=kg||function(l){return Zr.clearTimeout(l)};function sp(l,f){if(f)return l.slice();var y=l.length,C=Mh?Mh(y):new l.constructor(y);return l.copy(C),C}function Fu(l){var f=new l.constructor(l.byteLength);return new vu(f).set(new vu(l)),f}function Ug(l,f){var y=f?Fu(l.buffer):l.buffer;return new l.constructor(y,l.byteOffset,l.byteLength)}function zg(l){var f=new l.constructor(l.source,Xt.exec(l));return f.lastIndex=l.lastIndex,f}function Hg(l){return Zs?Or(Zs.call(l)):{}}function Bg(l,f){var y=f?Fu(l.buffer):l.buffer;return new l.constructor(y,l.byteOffset,l.length)}function op(l,f){if(l!==f){var y=l!==t,C=l===null,I=l===l,M=Jo(l),V=f!==t,te=f===null,ue=f===f,Te=Jo(f);if(!te&&!Te&&!M&&l>f||M&&V&&ue&&!te&&!Te||C&&V&&ue||!y&&ue||!I)return 1;if(!C&&!M&&!Te&&l<f||Te&&y&&I&&!C&&!M||te&&y&&I||!V&&I||!ue)return-1}return 0}function N0(l,f,y){for(var C=-1,I=l.criteria,M=f.criteria,V=I.length,te=y.length;++C<V;){var ue=op(I[C],M[C]);if(ue){if(C>=te)return ue;var Te=y[C];return ue*(Te=="desc"?-1:1)}}return l.index-f.index}function Gg(l,f,y,C){for(var I=-1,M=l.length,V=y.length,te=-1,ue=f.length,Te=wn(M-V,0),Ae=ye(ue+Te),Oe=!C;++te<ue;)Ae[te]=f[te];for(;++I<V;)(Oe||I<M)&&(Ae[y[I]]=l[I]);for(;Te--;)Ae[te++]=l[I++];return Ae}function ip(l,f,y,C){for(var I=-1,M=l.length,V=-1,te=y.length,ue=-1,Te=f.length,Ae=wn(M-te,0),Oe=ye(Ae+Te),Ye=!C;++I<Ae;)Oe[I]=l[I];for(var bt=I;++ue<Te;)Oe[bt+ue]=f[ue];for(;++V<te;)(Ye||I<M)&&(Oe[bt+y[V]]=l[I++]);return Oe}function fs(l,f){var y=-1,C=l.length;for(f||(f=ye(C));++y<C;)f[y]=l[y];return f}function Bo(l,f,y,C){var I=!y;y||(y={});for(var M=-1,V=f.length;++M<V;){var te=f[M],ue=C?C(y[te],l[te],te,y,l):t;ue===t&&(ue=l[te]),I?yi(y,te,ue):ml(y,te,ue)}return y}function sf(l,f){return Bo(l,Go(l),f)}function T0(l,f){return Bo(l,Yg(l),f)}function of(l,f){return function(y,C){var I=er(y)?kh:eo,M=f?f():{};return I(y,l,Dt(C,2),M)}}function kc(l){return sr(function(f,y){var C=-1,I=y.length,M=I>1?y[I-1]:t,V=I>2?y[2]:t;for(M=l.length>3&&typeof M=="function"?(I--,M):t,V&&ps(y[0],y[1],V)&&(M=I<3?t:M,I=1),f=Or(f);++C<I;){var te=y[C];te&&l(f,te,C,M)}return f})}function ko(l,f){return function(y,C){if(y==null)return y;if(!Ao(y))return l(y,C);for(var I=y.length,M=f?I:-1,V=Or(y);(f?M--:++M<I)&&C(V[M],M,V)!==!1;);return y}}function af(l){return function(f,y,C){for(var I=-1,M=Or(f),V=C(f),te=V.length;te--;){var ue=V[l?te:++I];if(y(M[ue],ue,M)===!1)break}return f}}function lf(l,f,y){var C=f&T,I=Nc(l);function M(){var V=this&&this!==Zr&&this instanceof M?I:l;return V.apply(C?y:this,arguments)}return M}function ap(l){return function(f){f=Dr(f);var y=ic(f)?Qs(f):t,C=y?y[0]:f.charAt(0),I=y?Qi(y,1).join(""):f.slice(1);return C[l]()+I}}function bl(l){return function(f){return Ah(rE(tE(f).replace(Ke,"")),l,"")}}function Nc(l){return function(){var f=arguments;switch(f.length){case 0:return new l;case 1:return new l(f[0]);case 2:return new l(f[0],f[1]);case 3:return new l(f[0],f[1],f[2]);case 4:return new l(f[0],f[1],f[2],f[3]);case 5:return new l(f[0],f[1],f[2],f[3],f[4]);case 6:return new l(f[0],f[1],f[2],f[3],f[4],f[5]);case 7:return new l(f[0],f[1],f[2],f[3],f[4],f[5],f[6])}var y=mc(l.prototype),C=l.apply(y,f);return mn(C)?C:y}}function lp(l,f,y){var C=Nc(l);function I(){for(var M=arguments.length,V=ye(M),te=M,ue=Zi(I);te--;)V[te]=arguments[te];var Te=M<3&&V[0]!==ue&&V[M-1]!==ue?[]:vo(V,ue);if(M-=Te.length,M<y)return hs(l,f,Tc,I.placeholder,t,V,Te,t,t,y-M);var Ae=this&&this!==Zr&&this instanceof I?C:l;return us(Ae,this,V)}return I}function _l(l){return function(f,y,C){var I=Or(f);if(!Ao(f)){var M=Dt(y,3);f=is(f),y=function(te){return M(I[te],te,I)}}var V=l(f,y,C);return V>-1?I[M?f[V]:V]:t}}function cf(l){return Ci(function(f){var y=f.length,C=y,I=es.prototype.thru;for(l&&f.reverse();C--;){var M=f[C];if(typeof M!="function")throw new yo(c);if(I&&!V&&Ac(M)=="wrapper")var V=new es([],!0)}for(C=V?C:y;++C<y;){M=f[C];var te=Ac(M),ue=te=="wrapper"?ff(M):t;ue&&zu(ue[0])&&ue[1]==(z|F|L|q)&&!ue[4].length&&ue[9]==1?V=V[Ac(ue[0])].apply(V,ue[3]):V=M.length==1&&zu(M)?V[te]():V.thru(M)}return function(){var Te=arguments,Ae=Te[0];if(V&&Te.length==1&&er(Ae))return V.plant(Ae).value();for(var Oe=0,Ye=y?f[Oe].apply(this,Te):Ae;++Oe<y;)Ye=f[Oe].call(this,Ye);return Ye}})}function Tc(l,f,y,C,I,M,V,te,ue,Te){var Ae=f&z,Oe=f&T,Ye=f&A,bt=f&(F|j),Ht=f&ae,ar=Ye?t:Nc(l);function Bt(){for(var dr=arguments.length,br=ye(dr),Xo=dr;Xo--;)br[Xo]=arguments[Xo];if(bt)var so=Zi(Bt),Qo=gg(br,so);if(C&&(br=Gg(br,C,I,bt)),M&&(br=ip(br,M,V,bt)),dr-=Qo,bt&&dr<Te){var Tn=vo(br,so);return hs(l,f,Tc,Bt.placeholder,y,br,Tn,te,ue,Te-dr)}var na=Oe?y:this,Il=Ye?na[l]:l;return dr=br.length,te?br=Wo(br,te):Ht&&dr>1&&br.reverse(),Ae&&ue<dr&&(br.length=ue),this&&this!==Zr&&this instanceof Bt&&(Il=ar||Nc(Il)),Il.apply(na,br)}return Bt}function Wg(l,f){return function(y,C){return Ki(y,l,f(C),{})}}function ju(l,f){return function(y,C){var I;if(y===t&&C===t)return f;if(y!==t&&(I=y),C!==t){if(I===t)return C;typeof y=="string"||typeof C=="string"?(y=Fs(y),C=Fs(C)):(y=tp(y),C=tp(C)),I=l(y,C)}return I}}function uf(l){return Ci(function(f){return f=Hr(f,Xs(Dt())),sr(function(y){var C=this;return l(f,function(I){return us(I,C,y)})})})}function Ou(l,f){f=f===t?" ":Fs(f);var y=f.length;if(y<2)return y?xl(f,l):f;var C=xl(f,ul(l/ll(f)));return ic(f)?Qi(Qs(C),0,l).join(""):C.slice(0,l)}function Vg(l,f,y,C){var I=f&T,M=Nc(l);function V(){for(var te=-1,ue=arguments.length,Te=-1,Ae=C.length,Oe=ye(Ae+ue),Ye=this&&this!==Zr&&this instanceof V?M:l;++Te<Ae;)Oe[Te]=C[Te];for(;ue--;)Oe[Te++]=arguments[++te];return us(Ye,I?y:this,Oe)}return V}function cp(l){return function(f,y,C){return C&&typeof C!="number"&&ps(f,y,C)&&(y=C=t),f=Rl(f),y===t?(y=f,f=0):y=Rl(y),C=C===t?f<y?1:-1:Rl(C),Ru(f,y,C,l)}}function df(l){return function(f,y){return typeof f=="string"&&typeof y=="string"||(f=Ni(f),y=Ni(y)),l(f,y)}}function hs(l,f,y,C,I,M,V,te,ue,Te){var Ae=f&F,Oe=Ae?V:t,Ye=Ae?t:V,bt=Ae?M:t,Ht=Ae?t:M;f|=Ae?L:G,f&=~(Ae?G:L),f&R||(f&=-4);var ar=[l,f,I,bt,Oe,Ht,Ye,te,ue,Te],Bt=y.apply(t,ar);return zu(l)&&xp(Bt,ar),Bt.placeholder=C,wp(Bt,l,f)}function Hn(l){var f=xn[l];return function(y,C){if(y=Ni(y),C=C==null?0:Zn(or(C),292),C&&uc(y)){var I=(Dr(y)+"e").split("e"),M=f(I[0]+"e"+(+I[1]+C));return I=(Dr(M)+"e").split("e"),+(I[0]+"e"+(+I[1]-C))}return f(y)}}var qg=ba&&1/xa(new ba([,-0]))[1]==Y?function(l){return new ba(l)}:rx;function up(l){return function(f){var y=Bn(f);return y==qe?Nd(f):y==Kt?b0(f):y0(f,l(f))}}function Ei(l,f,y,C,I,M,V,te){var ue=f&A;if(!ue&&typeof l!="function")throw new yo(c);var Te=C?C.length:0;if(Te||(f&=-97,C=I=t),V=V===t?V:wn(or(V),0),te=te===t?te:or(te),Te-=I?I.length:0,f&G){var Ae=C,Oe=I;C=I=t}var Ye=ue?t:ff(l),bt=[l,f,y,C,I,Ae,Oe,M,V,te];if(Ye&&Zg(bt,Ye),l=bt[0],f=bt[1],y=bt[2],C=bt[3],I=bt[4],te=bt[9]=bt[9]===t?ue?0:l.length:wn(bt[9]-Te,0),!te&&f&(F|j)&&(f&=-25),!f||f==T)var Ht=lf(l,f,y);else f==F||f==j?Ht=lp(l,f,te):(f==L||f==(T|L))&&!I.length?Ht=Vg(l,f,y,C):Ht=Tc.apply(t,bt);var ar=Ye?Zd:xp;return wp(ar(Ht,bt),l,f)}function dp(l,f,y,C){return l===t||ra(l,hi[y])&&!xr.call(C,y)?f:l}function fp(l,f,y,C,I,M){return mn(l)&&mn(f)&&(M.set(f,l),yl(l,f,t,fp,M),M.delete(f)),l}function hp(l){return Dp(l)?t:l}function pp(l,f,y,C,I,M){var V=y&N,te=l.length,ue=f.length;if(te!=ue&&!(V&&ue>te))return!1;var Te=M.get(l),Ae=M.get(f);if(Te&&Ae)return Te==f&&Ae==l;var Oe=-1,Ye=!0,bt=y&E?new fl:t;for(M.set(l,f),M.set(f,l);++Oe<te;){var Ht=l[Oe],ar=f[Oe];if(C)var Bt=V?C(ar,Ht,Oe,f,l,M):C(Ht,ar,Oe,l,f,M);if(Bt!==t){if(Bt)continue;Ye=!1;break}if(bt){if(!Rh(f,function(dr,br){if(!zi(bt,br)&&(Ht===dr||I(Ht,dr,y,C,M)))return bt.push(br)})){Ye=!1;break}}else if(!(Ht===ar||I(Ht,ar,y,C,M))){Ye=!1;break}}return M.delete(l),M.delete(f),Ye}function mp(l,f,y,C,I,M,V){switch(y){case pt:if(l.byteLength!=f.byteLength||l.byteOffset!=f.byteOffset)return!1;l=l.buffer,f=f.buffer;case Pe:return!(l.byteLength!=f.byteLength||!M(new vu(l),new vu(f)));case he:case be:case Ne:return ra(+l,+f);case _t:return l.name==f.name&&l.message==f.message;case $t:case hr:return l==f+"";case qe:var te=Nd;case Kt:var ue=C&N;if(te||(te=xa),l.size!=f.size&&!ue)return!1;var Te=V.get(l);if(Te)return Te==f;C|=E,V.set(l,f);var Ae=pp(te(l),te(f),C,I,M,V);return V.delete(l),Ae;case Ur:if(Zs)return Zs.call(l)==Zs.call(f)}return!1}function Kg(l,f,y,C,I,M){var V=y&N,te=Du(l),ue=te.length,Te=Du(f),Ae=Te.length;if(ue!=Ae&&!V)return!1;for(var Oe=ue;Oe--;){var Ye=te[Oe];if(!(V?Ye in f:xr.call(f,Ye)))return!1}var bt=M.get(l),Ht=M.get(f);if(bt&&Ht)return bt==f&&Ht==l;var ar=!0;M.set(l,f),M.set(f,l);for(var Bt=V;++Oe<ue;){Ye=te[Oe];var dr=l[Ye],br=f[Ye];if(C)var Xo=V?C(br,dr,Ye,f,l,M):C(dr,br,Ye,l,f,M);if(!(Xo===t?dr===br||I(dr,br,y,C,M):Xo)){ar=!1;break}Bt||(Bt=Ye=="constructor")}if(ar&&!Bt){var so=l.constructor,Qo=f.constructor;so!=Qo&&"constructor"in l&&"constructor"in f&&!(typeof so=="function"&&so instanceof so&&typeof Qo=="function"&&Qo instanceof Qo)&&(ar=!1)}return M.delete(l),M.delete(f),ar}function Ci(l){return ro(gf(l,t,xf),l+"")}function Du(l){return qd(l,is,Go)}function Lu(l){return qd(l,Ro,Yg)}var ff=Md?function(l){return Md.get(l)}:rx;function Ac(l){for(var f=l.name+"",y=hc[f],C=xr.call(hc,f)?y.length:0;C--;){var I=y[C],M=I.func;if(M==null||M==l)return I.name}return f}function Zi(l){var f=xr.call(D,"placeholder")?D:l;return f.placeholder}function Dt(){var l=D.iteratee||ex;return l=l===ex?bc:l,arguments.length?l(arguments[0],arguments[1]):l}function Mu(l,f){var y=l.__data__;return Rc(f)?y[typeof f=="string"?"string":"hash"]:y.map}function $u(l){for(var f=is(l),y=f.length;y--;){var C=f[y],I=l[C];f[y]=[C,I,Hu(I)]}return f}function Ra(l,f){var y=oc(l,f);return qh(y)?y:t}function hf(l){var f=xr.call(l,cl),y=l[cl];try{l[cl]=t;var C=!0}catch{}var I=mu.call(l);return C&&(f?l[cl]=y:delete l[cl]),I}var Go=Od?function(l){return l==null?[]:(l=Or(l),va(Od(l),function(f){return Fd.call(l,f)}))}:nx,Yg=Od?function(l){for(var f=[];l;)ya(f,Go(l)),l=zo(l);return f}:nx,Bn=zn;(wu&&Bn(new wu(new ArrayBuffer(1)))!=pt||dl&&Bn(new dl)!=qe||bu&&Bn(bu.resolve())!=Ct||ba&&Bn(new ba)!=Kt||_u&&Bn(new _u)!=kr)&&(Bn=function(l){var f=zn(l),y=f==ct?l.constructor:t,C=y?Ia(y):"";if(C)switch(C){case zh:return pt;case _a:return qe;case Tg:return Ct;case pc:return Kt;case pi:return kr}return f});function gp(l,f,y){for(var C=-1,I=y.length;++C<I;){var M=y[C],V=M.size;switch(M.type){case"drop":l+=V;break;case"dropRight":f-=V;break;case"take":f=Zn(f,l+V);break;case"takeRight":l=wn(l,f-V);break}}return{start:l,end:f}}function Jg(l){var f=l.match(Ve);return f?f[1].split(gt):[]}function vp(l,f,y){f=Si(f,l);for(var C=-1,I=f.length,M=!1;++C<I;){var V=qo(f[C]);if(!(M=l!=null&&y(l,V)))break;l=l[V]}return M||++C!=I?M:(I=l==null?0:l.length,!!I&&gv(I)&&tn(V,I)&&(er(l)||Ju(l)))}function Uu(l){var f=l.length,y=new l.constructor(f);return f&&typeof l[0]=="string"&&xr.call(l,"index")&&(y.index=l.index,y.input=l.input),y}function Gn(l){return typeof l.constructor=="function"&&!ea(l)?mc(zo(l)):{}}function A0(l,f,y){var C=l.constructor;switch(f){case Pe:return Fu(l);case he:case be:return new C(+l);case pt:return Ug(l,y);case wt:case ze:case He:case rt:case Re:case ft:case Mt:case Ue:case rr:return Bg(l,y);case qe:return new C;case Ne:case hr:return new C(l);case $t:return zg(l);case Kt:return new C;case Ur:return Hg(l)}}function R0(l,f){var y=f.length;if(!y)return l;var C=y-1;return f[C]=(y>1?"& ":"")+f[C],f=f.join(y>2?", ":" "),l.replace(ce,`{
/* [wrapped with `+f+`] */
`)}function pf(l){return er(l)||Ju(l)||!!(Cg&&l&&l[Cg])}function tn(l,f){var y=typeof l;return f=f??J,!!f&&(y=="number"||y!="symbol"&&Q.test(l))&&l>-1&&l%1==0&&l<f}function ps(l,f,y){if(!mn(y))return!1;var C=typeof f;return(C=="number"?Ao(y)&&tn(f,y.length):C=="string"&&f in y)?ra(y[f],l):!1}function ot(l,f){if(er(l))return!1;var y=typeof l;return y=="number"||y=="symbol"||y=="boolean"||l==null||Jo(l)?!0:Mo.test(l)||!go.test(l)||f!=null&&l in Or(f)}function Rc(l){var f=typeof l;return f=="string"||f=="number"||f=="symbol"||f=="boolean"?l!=="__proto__":l===null}function zu(l){var f=Ac(l),y=D[f];if(typeof y!="function"||!(f in Zt.prototype))return!1;if(l===y)return!0;var C=ff(y);return!!C&&l===C[0]}function Xg(l){return!!Rd&&Rd in l}var I0=lc?Al:sx;function ea(l){var f=l&&l.constructor,y=typeof f=="function"&&f.prototype||hi;return l===y}function Hu(l){return l===l&&!mn(l)}function mf(l,f){return function(y){return y==null?!1:y[l]===f&&(f!==t||l in Or(y))}}function Qg(l){var f=ve(l,function(C){return y.size===p&&y.clear(),C}),y=f.cache;return f}function Zg(l,f){var y=l[1],C=f[1],I=y|C,M=I<(T|A|z),V=C==z&&y==F||C==z&&y==q&&l[7].length<=f[8]||C==(z|q)&&f[7].length<=f[8]&&y==F;if(!(M||V))return l;C&T&&(l[2]=f[2],I|=y&T?0:R);var te=f[3];if(te){var ue=l[3];l[3]=ue?Gg(ue,te,f[4]):te,l[4]=ue?vo(l[3],v):f[4]}return te=f[5],te&&(ue=l[5],l[5]=ue?ip(ue,te,f[6]):te,l[6]=ue?vo(l[5],v):f[6]),te=f[7],te&&(l[7]=te),C&z&&(l[8]=l[8]==null?f[8]:Zn(l[8],f[8])),l[9]==null&&(l[9]=f[9]),l[0]=f[0],l[1]=I,l}function ev(l){var f=[];if(l!=null)for(var y in Or(l))f.push(y);return f}function yp(l){return mu.call(l)}function gf(l,f,y){return f=wn(f===t?l.length-1:f,0),function(){for(var C=arguments,I=-1,M=wn(C.length-f,0),V=ye(M);++I<M;)V[I]=C[f+I];I=-1;for(var te=ye(f+1);++I<f;)te[I]=C[I];return te[f]=y(V),us(l,this,te)}}function Pn(l,f){return f.length<2?l:qi(l,os(f,0,-1))}function Wo(l,f){for(var y=l.length,C=Zn(f.length,y),I=fs(l);C--;){var M=f[C];l[C]=tn(M,y)?I[M]:t}return l}function ki(l,f){if(!(f==="constructor"&&typeof l[f]=="function")&&f!="__proto__")return l[f]}var xp=Vo(Zd),Ic=$h||function(l,f){return Zr.setTimeout(l,f)},ro=Vo(_i);function wp(l,f,y){var C=f+"";return ro(l,R0(C,tv(Jg(C),y)))}function Vo(l){var f=0,y=0;return function(){var C=k0(),I=me-(C-y);if(y=C,I>0){if(++f>=H)return arguments[0]}else f=0;return l.apply(t,arguments)}}function vf(l,f){var y=-1,C=l.length,I=C-1;for(f=f===t?C:f;++y<f;){var M=_c(y,I),V=l[M];l[M]=l[y],l[y]=V}return l.length=f,l}var bp=Qg(function(l){var f=[];return l.charCodeAt(0)===46&&f.push(""),l.replace(En,function(y,C,I,M){f.push(I?M.replace(yt,"$1"):C||y)}),f});function qo(l){if(typeof l=="string"||Jo(l))return l;var f=l+"";return f=="0"&&1/l==-Y?"-0":f}function Ia(l){if(l!=null){try{return pu.call(l)}catch{}try{return l+""}catch{}}return""}function tv(l,f){return Qn(Ee,function(y){var C="_."+y[0];f&y[1]&&!Ed(l,C)&&l.push(C)}),l.sort()}function rv(l){if(l instanceof Zt)return l.clone();var f=new es(l.__wrapped__,l.__chain__);return f.__actions__=fs(l.__actions__),f.__index__=l.__index__,f.__values__=l.__values__,f}function yf(l,f,y){(y?ps(l,f,y):f===t)?f=1:f=wn(or(f),0);var C=l==null?0:l.length;if(!C||f<1)return[];for(var I=0,M=0,V=ye(ul(C/f));I<C;)V[M++]=os(l,I,I+=f);return V}function _p(l){for(var f=-1,y=l==null?0:l.length,C=0,I=[];++f<y;){var M=l[f];M&&(I[C++]=M)}return I}function No(){var l=arguments.length;if(!l)return[];for(var f=ye(l-1),y=arguments[0],C=l;C--;)f[C-1]=arguments[C];return ya(er(y)?fs(y):[y],un(f,1))}var wr=sr(function(l,f){return Nn(l)?xi(l,un(f,1,Nn,!0)):[]}),Fn=sr(function(l,f){var y=ms(f);return Nn(y)&&(y=t),Nn(l)?xi(l,un(f,1,Nn,!0),Dt(y,2)):[]}),bn=sr(function(l,f){var y=ms(f);return Nn(y)&&(y=t),Nn(l)?xi(l,un(f,1,Nn,!0),t,y):[]});function Wn(l,f,y){var C=l==null?0:l.length;return C?(f=y||f===t?1:or(f),os(l,f<0?0:f,C)):[]}function no(l,f,y){var C=l==null?0:l.length;return C?(f=y||f===t?1:or(f),f=C-f,os(l,0,f<0?0:f)):[]}function Pc(l,f){return l&&l.length?Iu(l,Dt(f,3),!0,!0):[]}function kn(l,f){return l&&l.length?Iu(l,Dt(f,3),!0):[]}function Bu(l,f,y,C){var I=l==null?0:l.length;return I?(y&&typeof y!="number"&&ps(l,f,y)&&(y=0,C=I),Dg(l,f,y,C)):[]}function Pa(l,f,y){var C=l==null?0:l.length;if(!C)return-1;var I=y==null?0:or(y);return I<0&&(I=wn(C+I,0)),Cd(l,Dt(f,3),I)}function Gu(l,f,y){var C=l==null?0:l.length;if(!C)return-1;var I=C-1;return y!==t&&(I=or(y),I=y<0?wn(C+I,0):Zn(I,C-1)),Cd(l,Dt(f,3),I,!0)}function xf(l){var f=l==null?0:l.length;return f?un(l,1):[]}function Wu(l){var f=l==null?0:l.length;return f?un(l,Y):[]}function js(l,f){var y=l==null?0:l.length;return y?(f=f===t?1:or(f),un(l,f)):[]}function Sp(l){for(var f=-1,y=l==null?0:l.length,C={};++f<y;){var I=l[f];C[I[0]]=I[1]}return C}function Sl(l){return l&&l.length?l[0]:t}function ta(l,f,y){var C=l==null?0:l.length;if(!C)return-1;var I=y==null?0:or(y);return I<0&&(I=wn(C+I,0)),sc(l,f,I)}function wf(l){var f=l==null?0:l.length;return f?os(l,0,-1):[]}var Ep=sr(function(l){var f=Hr(l,Cc);return f.length&&f[0]===l[0]?Kd(f):[]}),Fa=sr(function(l){var f=ms(l),y=Hr(l,Cc);return f===ms(y)?f=t:y.pop(),y.length&&y[0]===l[0]?Kd(y,Dt(f,2)):[]}),bf=sr(function(l){var f=ms(l),y=Hr(l,Cc);return f=typeof f=="function"?f:t,f&&y.pop(),y.length&&y[0]===l[0]?Kd(y,t,f):[]});function ja(l,f){return l==null?"":Dd.call(l,f)}function ms(l){var f=l==null?0:l.length;return f?l[f-1]:t}function Vu(l,f,y){var C=l==null?0:l.length;if(!C)return-1;var I=C;return y!==t&&(I=or(y),I=I<0?wn(C+I,0):Zn(I,C-1)),f===f?_0(l,f,I):Cd(l,dg,I,!0)}function Cp(l,f){return l&&l.length?Qd(l,or(f)):t}var _f=sr(qu);function qu(l,f){return l&&l.length&&f&&f.length?hn(l,f):l}function gs(l,f,y){return l&&l.length&&f&&f.length?hn(l,f,Dt(y,2)):l}function Oa(l,f,y){return l&&l.length&&f&&f.length?hn(l,f,t,y):l}var Ko=Ci(function(l,f){var y=l==null?0:l.length,C=Wd(l,f);return Cn(l,Hr(f,function(I){return tn(I,y)?+I:I}).sort(op)),C});function Os(l,f){var y=[];if(!(l&&l.length))return y;var C=-1,I=[],M=l.length;for(f=Dt(f,3);++C<M;){var V=l[C];f(V,C,l)&&(y.push(V),I.push(C))}return Cn(l,I),y}function Sf(l){return l==null?l:Ld.call(l)}function kp(l,f,y){var C=l==null?0:l.length;return C?(y&&typeof y!="number"&&ps(l,f,y)?(f=0,y=C):(f=f==null?0:or(f),y=y===t?C:or(y)),os(l,f,y)):[]}function Np(l,f){return Sc(l,f)}function P0(l,f,y){return ef(l,f,Dt(y,2))}function Da(l,f){var y=l==null?0:l.length;if(y){var C=Sc(l,f);if(C<y&&ra(l[C],f))return C}return-1}function nv(l,f){return Sc(l,f,!0)}function Tp(l,f,y){return ef(l,f,Dt(y,2),!0)}function El(l,f){var y=l==null?0:l.length;if(y){var C=Sc(l,f,!0)-1;if(ra(l[C],f))return C}return-1}function Ap(l){return l&&l.length?ep(l):[]}function Cl(l,f){return l&&l.length?ep(l,Dt(f,2)):[]}function sv(l){var f=l==null?0:l.length;return f?os(l,1,f):[]}function ov(l,f,y){return l&&l.length?(f=y||f===t?1:or(f),os(l,0,f<0?0:f)):[]}function Rp(l,f,y){var C=l==null?0:l.length;return C?(f=y||f===t?1:or(f),f=C-f,os(l,f<0?0:f,C)):[]}function Ef(l,f){return l&&l.length?Iu(l,Dt(f,3),!1,!0):[]}function F0(l,f){return l&&l.length?Iu(l,Dt(f,3)):[]}var j0=sr(function(l){return Xi(un(l,1,Nn,!0))}),iv=sr(function(l){var f=ms(l);return Nn(f)&&(f=t),Xi(un(l,1,Nn,!0),Dt(f,2))}),av=sr(function(l){var f=ms(l);return f=typeof f=="function"?f:t,Xi(un(l,1,Nn,!0),t,f)});function kl(l){return l&&l.length?Xi(l):[]}function O0(l,f){return l&&l.length?Xi(l,Dt(f,2)):[]}function Fc(l,f){return f=typeof f=="function"?f:t,l&&l.length?Xi(l,t,f):[]}function Cf(l){if(!(l&&l.length))return[];var f=0;return l=va(l,function(y){if(Nn(y))return f=wn(y.length,f),!0}),jh(f,function(y){return Hr(l,Ph(y))})}function sn(l,f){if(!(l&&l.length))return[];var y=Cf(l);return f==null?y:Hr(y,function(C){return us(f,t,C)})}var D0=sr(function(l,f){return Nn(l)?xi(l,f):[]}),lv=sr(function(l){return rf(va(l,Nn))}),L0=sr(function(l){var f=ms(l);return Nn(f)&&(f=t),rf(va(l,Nn),Dt(f,2))}),M0=sr(function(l){var f=ms(l);return f=typeof f=="function"?f:t,rf(va(l,Nn),t,f)}),cv=sr(Cf);function uv(l,f){return Pu(l||[],f||[],ml)}function $0(l,f){return Pu(l||[],f||[],wl)}var To=sr(function(l){var f=l.length,y=f>1?l[f-1]:t;return y=typeof y=="function"?(l.pop(),y):t,sn(l,y)});function kf(l){var f=D(l);return f.__chain__=!0,f}function U0(l,f){return f(l),l}function Yo(l,f){return f(l)}var Nf=Ci(function(l){var f=l.length,y=f?l[0]:0,C=this.__wrapped__,I=function(M){return Wd(M,l)};return f>1||this.__actions__.length||!(C instanceof Zt)||!tn(y)?this.thru(I):(C=C.slice(y,+y+(f?1:0)),C.__actions__.push({func:Yo,args:[I],thisArg:t}),new es(C,this.__chain__).thru(function(M){return f&&!M.length&&M.push(t),M}))});function Nl(){return kf(this)}function Tf(){return new es(this.value(),this.__chain__)}function Ip(){this.__values__===t&&(this.__values__=VS(this.value()));var l=this.__index__>=this.__values__.length,f=l?t:this.__values__[this.__index__++];return{done:l,value:f}}function Pp(){return this}function z0(l){for(var f,y=this;y instanceof mi;){var C=rv(y);C.__index__=0,C.__values__=t,f?I.__wrapped__=C:f=C;var I=C;y=y.__wrapped__}return I.__wrapped__=l,f}function Fp(){var l=this.__wrapped__;if(l instanceof Zt){var f=l;return this.__actions__.length&&(f=new Zt(this)),f=f.reverse(),f.__actions__.push({func:Yo,args:[Sf],thisArg:t}),new es(f,this.__chain__)}return this.thru(Sf)}function H0(){return Ec(this.__wrapped__,this.__actions__)}var dv=of(function(l,f,y){xr.call(l,y)?++l[y]:yi(l,y,1)});function fv(l,f,y){var C=er(l)?Nh:Cu;return y&&ps(l,f,y)&&(f=t),C(l,Dt(f,3))}function Af(l,f){var y=er(l)?va:Wh;return y(l,Dt(f,3))}var Rf=_l(Pa),hv=_l(Gu);function jp(l,f){return un(Tl(l,f),1)}function B0(l,f){return un(Tl(l,f),Y)}function pv(l,f,y){return y=y===t?1:or(y),un(Tl(l,f),y)}function If(l,f){var y=er(l)?Qn:wi;return y(l,Dt(f,3))}function Ku(l,f){var y=er(l)?Sd:Og;return y(l,Dt(f,3))}var Op=of(function(l,f,y){xr.call(l,y)?l[y].push(f):yi(l,y,[f])});function Pf(l,f,y,C){l=Ao(l)?l:Of(l),y=y&&!C?or(y):0;var I=l.length;return y<0&&(y=wn(I+y,0)),vv(l)?y<=I&&l.indexOf(f,y)>-1:!!I&&sc(l,f,y)>-1}var mv=sr(function(l,f,y){var C=-1,I=typeof f=="function",M=Ao(l)?ye(l.length):[];return wi(l,function(V){M[++C]=I?us(f,V,y):So(V,f,y)}),M}),G0=of(function(l,f,y){yi(l,y,f)});function Tl(l,f){var y=er(l)?Hr:Yh;return y(l,Dt(f,3))}function W0(l,f,y,C){return l==null?[]:(er(f)||(f=f==null?[]:[f]),y=C?t:y,er(y)||(y=y==null?[]:[y]),Au(l,f,y))}var Yu=of(function(l,f,y){l[y?0:1].push(f)},function(){return[[],[]]});function V0(l,f,y){var C=er(l)?Ah:hg,I=arguments.length<3;return C(l,Dt(f,4),y,I,wi)}function Ff(l,f,y){var C=er(l)?p0:hg,I=arguments.length<3;return C(l,Dt(f,4),y,I,Og)}function o(l,f){var y=er(l)?va:Wh;return y(l,$e(Dt(f,3)))}function a(l){var f=er(l)?vi:ss;return f(l)}function h(l,f,y){(y?ps(l,f,y):f===t)?f=1:f=or(f);var C=er(l)?pl:Qh;return C(l,f)}function g(l){var f=er(l)?Fg:Co;return f(l)}function _(l){if(l==null)return 0;if(Ao(l))return vv(l)?ll(l):l.length;var f=Bn(l);return f==qe||f==Kt?l.size:Ji(l).length}function k(l,f,y){var C=er(l)?Rh:Zh;return y&&ps(l,f,y)&&(f=t),C(l,Dt(f,3))}var P=sr(function(l,f){if(l==null)return[];var y=f.length;return y>1&&ps(l,f[0],f[1])?f=[]:y>2&&ps(f[0],f[1],f[2])&&(f=[f[0]]),Au(l,un(f,1),[])}),W=qr||function(){return Zr.Date.now()};function Z(l,f){if(typeof f!="function")throw new yo(c);return l=or(l),function(){if(--l<1)return f.apply(this,arguments)}}function xe(l,f,y){return f=y?t:f,f=l&&f==null?l.length:f,Ei(l,z,t,t,t,t,f)}function je(l,f){var y;if(typeof f!="function")throw new yo(c);return l=or(l),function(){return--l>0&&(y=f.apply(this,arguments)),l<=1&&(f=t),y}}var De=sr(function(l,f,y){var C=T;if(y.length){var I=vo(y,Zi(De));C|=L}return Ei(l,C,f,y,I)}),Fe=sr(function(l,f,y){var C=T|A;if(y.length){var I=vo(y,Zi(Fe));C|=L}return Ei(f,C,l,y,I)});function Ze(l,f,y){f=y?t:f;var C=Ei(l,F,t,t,t,t,t,f);return C.placeholder=Ze.placeholder,C}function lt(l,f,y){f=y?t:f;var C=Ei(l,j,t,t,t,t,t,f);return C.placeholder=lt.placeholder,C}function dt(l,f,y){var C,I,M,V,te,ue,Te=0,Ae=!1,Oe=!1,Ye=!0;if(typeof l!="function")throw new yo(c);f=Ni(f)||0,mn(y)&&(Ae=!!y.leading,Oe="maxWait"in y,M=Oe?wn(Ni(y.maxWait)||0,f):M,Ye="trailing"in y?!!y.trailing:Ye);function bt(Tn){var na=C,Il=I;return C=I=t,Te=Tn,V=l.apply(Il,na),V}function Ht(Tn){return Te=Tn,te=Ic(dr,f),Ae?bt(Tn):V}function ar(Tn){var na=Tn-ue,Il=Tn-Te,oE=f-na;return Oe?Zn(oE,M-Il):oE}function Bt(Tn){var na=Tn-ue,Il=Tn-Te;return ue===t||na>=f||na<0||Oe&&Il>=M}function dr(){var Tn=W();if(Bt(Tn))return br(Tn);te=Ic(dr,ar(Tn))}function br(Tn){return te=t,Ye&&C?bt(Tn):(C=I=t,V)}function Xo(){te!==t&&np(te),Te=0,C=ue=I=te=t}function so(){return te===t?V:br(W())}function Qo(){var Tn=W(),na=Bt(Tn);if(C=arguments,I=this,ue=Tn,na){if(te===t)return Ht(ue);if(Oe)return np(te),te=Ic(dr,f),bt(ue)}return te===t&&(te=Ic(dr,f)),V}return Qo.cancel=Xo,Qo.flush=so,Qo}var pn=sr(function(l,f){return Gh(l,1,f)}),pe=sr(function(l,f,y){return Gh(l,Ni(f)||0,y)});function ie(l){return Ei(l,ae)}function ve(l,f){if(typeof l!="function"||f!=null&&typeof f!="function")throw new yo(c);var y=function(){var C=arguments,I=f?f.apply(this,C):C[0],M=y.cache;if(M.has(I))return M.get(I);var V=l.apply(this,C);return y.cache=M.set(I,V)||M,V};return y.cache=new(ve.Cache||xo),y}ve.Cache=xo;function $e(l){if(typeof l!="function")throw new yo(c);return function(){var f=arguments;switch(f.length){case 0:return!l.call(this);case 1:return!l.call(this,f[0]);case 2:return!l.call(this,f[0],f[1]);case 3:return!l.call(this,f[0],f[1],f[2])}return!l.apply(this,f)}}function vt(l){return je(2,l)}var Ft=$g(function(l,f){f=f.length==1&&er(f[0])?Hr(f[0],Xs(Dt())):Hr(un(f,1),Xs(Dt()));var y=f.length;return sr(function(C){for(var I=-1,M=Zn(C.length,y);++I<M;)C[I]=f[I].call(this,C[I]);return us(l,this,C)})}),Tt=sr(function(l,f){var y=vo(f,Zi(Tt));return Ei(l,L,t,f,y)}),zt=sr(function(l,f){var y=vo(f,Zi(zt));return Ei(l,G,t,f,y)}),jn=Ci(function(l,f){return Ei(l,q,t,t,t,f)});function Cr(l,f){if(typeof l!="function")throw new yo(c);return f=f===t?f:or(f),sr(l,f)}function La(l,f){if(typeof l!="function")throw new yo(c);return f=f==null?0:wn(or(f),0),sr(function(y){var C=y[f],I=Qi(y,0,f);return C&&ya(I,C),us(l,this,I)})}function q0(l,f,y){var C=!0,I=!0;if(typeof l!="function")throw new yo(c);return mn(y)&&(C="leading"in y?!!y.leading:C,I="trailing"in y?!!y.trailing:I),dt(l,f,{leading:C,maxWait:f,trailing:I})}function mF(l){return xe(l,1)}function gF(l,f){return Tt(nf(f),l)}function vF(){if(!arguments.length)return[];var l=arguments[0];return er(l)?l:[l]}function yF(l){return Ps(l,S)}function xF(l,f){return f=typeof f=="function"?f:t,Ps(l,S,f)}function wF(l){return Ps(l,x|S)}function bF(l,f){return f=typeof f=="function"?f:t,Ps(l,x|S,f)}function _F(l,f){return f==null||Eu(l,f,is(f))}function ra(l,f){return l===f||l!==l&&f!==f}var SF=df(Na),EF=df(function(l,f){return l>=f}),Ju=Yd((function(){return arguments})())?Yd:function(l){return _n(l)&&xr.call(l,"callee")&&!Fd.call(l,"callee")},er=ye.isArray,CF=Ch?Xs(Ch):Lg;function Ao(l){return l!=null&&gv(l.length)&&!Al(l)}function Nn(l){return _n(l)&&Ao(l)}function kF(l){return l===!0||l===!1||_n(l)&&zn(l)==he}var jc=Uh||sx,NF=Ts?Xs(Ts):Yi;function TF(l){return _n(l)&&l.nodeType===1&&!Dp(l)}function AF(l){if(l==null)return!0;if(Ao(l)&&(er(l)||typeof l=="string"||typeof l.splice=="function"||jc(l)||jf(l)||Ju(l)))return!l.length;var f=Bn(l);if(f==qe||f==Kt)return!l.size;if(ea(l))return!Ji(l).length;for(var y in l)if(xr.call(l,y))return!1;return!0}function RF(l,f){return Eo(l,f)}function IF(l,f,y){y=typeof y=="function"?y:t;var C=y?y(l,f):t;return C===t?Eo(l,f,t,y):!!C}function K0(l){if(!_n(l))return!1;var f=zn(l);return f==_t||f==Ie||typeof l.message=="string"&&typeof l.name=="string"&&!Dp(l)}function PF(l){return typeof l=="number"&&uc(l)}function Al(l){if(!mn(l))return!1;var f=zn(l);return f==Be||f==Ge||f==K||f==Gt}function HS(l){return typeof l=="number"&&l==or(l)}function gv(l){return typeof l=="number"&&l>-1&&l%1==0&&l<=J}function mn(l){var f=typeof l;return l!=null&&(f=="object"||f=="function")}function _n(l){return l!=null&&typeof l=="object"}var BS=al?Xs(al):Mg;function FF(l,f){return l===f||wc(l,f,$u(f))}function jF(l,f,y){return y=typeof y=="function"?y:t,wc(l,f,$u(f),y)}function OF(l){return GS(l)&&l!=+l}function DF(l){if(I0(l))throw new Wt(i);return qh(l)}function LF(l){return l===null}function MF(l){return l==null}function GS(l){return typeof l=="number"||_n(l)&&zn(l)==Ne}function Dp(l){if(!_n(l)||zn(l)!=ct)return!1;var f=zo(l);if(f===null)return!0;var y=xr.call(f,"constructor")&&f.constructor;return typeof y=="function"&&y instanceof y&&pu.call(y)==Id}var Y0=_d?Xs(_d):Nu;function $F(l){return HS(l)&&l>=-J&&l<=J}var WS=nc?Xs(nc):bi;function vv(l){return typeof l=="string"||!er(l)&&_n(l)&&zn(l)==hr}function Jo(l){return typeof l=="symbol"||_n(l)&&zn(l)==Ur}var jf=lg?Xs(lg):Tu;function UF(l){return l===t}function zF(l){return _n(l)&&Bn(l)==kr}function HF(l){return _n(l)&&zn(l)==ge}var BF=df(Ta),GF=df(function(l,f){return l<=f});function VS(l){if(!l)return[];if(Ao(l))return vv(l)?Qs(l):fs(l);if(Gi&&l[Gi])return w0(l[Gi]());var f=Bn(l),y=f==qe?Nd:f==Kt?xa:Of;return y(l)}function Rl(l){if(!l)return l===0?l:0;if(l=Ni(l),l===Y||l===-Y){var f=l<0?-1:1;return f*$}return l===l?l:0}function or(l){var f=Rl(l),y=f%1;return f===f?y?f-y:f:0}function qS(l){return l?Vi(or(l),0,O):0}function Ni(l){if(typeof l=="number")return l;if(Jo(l))return X;if(mn(l)){var f=typeof l.valueOf=="function"?l.valueOf():l;l=mn(f)?f+"":f}if(typeof l!="string")return l===0?l:+l;l=pg(l);var y=Qr.test(l);return y||at.test(l)?wd(l.slice(2),y?2:8):Yn.test(l)?X:+l}function KS(l){return Bo(l,Ro(l))}function WF(l){return l?Vi(or(l),-J,J):l===0?l:0}function Dr(l){return l==null?"":Fs(l)}var VF=kc(function(l,f){if(ea(f)||Ao(f)){Bo(f,is(f),l);return}for(var y in f)xr.call(f,y)&&ml(l,y,f[y])}),YS=kc(function(l,f){Bo(f,Ro(f),l)}),yv=kc(function(l,f,y,C){Bo(f,Ro(f),l,C)}),qF=kc(function(l,f,y,C){Bo(f,is(f),l,C)}),KF=Ci(Wd);function YF(l,f){var y=mc(l);return f==null?y:Yr(y,f)}var JF=sr(function(l,f){l=Or(l);var y=-1,C=f.length,I=C>2?f[2]:t;for(I&&ps(f[0],f[1],I)&&(C=1);++y<C;)for(var M=f[y],V=Ro(M),te=-1,ue=V.length;++te<ue;){var Te=V[te],Ae=l[Te];(Ae===t||ra(Ae,hi[Te])&&!xr.call(l,Te))&&(l[Te]=M[Te])}return l}),XF=sr(function(l){return l.push(t,fp),us(JS,t,l)});function QF(l,f){return ug(l,Dt(f,3),to)}function ZF(l,f){return ug(l,Dt(f,3),ka)}function ej(l,f){return l==null?l:Vd(l,Dt(f,3),Ro)}function tj(l,f){return l==null?l:ku(l,Dt(f,3),Ro)}function rj(l,f){return l&&to(l,Dt(f,3))}function nj(l,f){return l&&ka(l,Dt(f,3))}function sj(l){return l==null?[]:xc(l,is(l))}function oj(l){return l==null?[]:xc(l,Ro(l))}function J0(l,f,y){var C=l==null?t:qi(l,f);return C===t?y:C}function ij(l,f){return l!=null&&vp(l,f,_o)}function X0(l,f){return l!=null&&vp(l,f,vl)}var aj=Wg(function(l,f,y){f!=null&&typeof f.toString!="function"&&(f=mu.call(f)),l[f]=y},Z0(Io)),lj=Wg(function(l,f,y){f!=null&&typeof f.toString!="function"&&(f=mu.call(f)),xr.call(l,f)?l[f].push(y):l[f]=[y]},Dt),cj=sr(So);function is(l){return Ao(l)?gi(l):Ji(l)}function Ro(l){return Ao(l)?gi(l,!0):Kh(l)}function uj(l,f){var y={};return f=Dt(f,3),to(l,function(C,I,M){yi(y,f(C,I,M),C)}),y}function dj(l,f){var y={};return f=Dt(f,3),to(l,function(C,I,M){yi(y,I,f(C,I,M))}),y}var fj=kc(function(l,f,y){yl(l,f,y)}),JS=kc(function(l,f,y,C){yl(l,f,y,C)}),hj=Ci(function(l,f){var y={};if(l==null)return y;var C=!1;f=Hr(f,function(M){return M=Si(M,l),C||(C=M.length>1),M}),Bo(l,Lu(l),y),C&&(y=Ps(y,x|b|S,hp));for(var I=f.length;I--;)tf(y,f[I]);return y});function pj(l,f){return XS(l,$e(Dt(f)))}var mj=Ci(function(l,f){return l==null?{}:Xh(l,f)});function XS(l,f){if(l==null)return{};var y=Hr(Lu(l),function(C){return[C]});return f=Dt(f),Aa(l,y,function(C,I){return f(C,I[0])})}function gj(l,f,y){f=Si(f,l);var C=-1,I=f.length;for(I||(I=1,l=t);++C<I;){var M=l==null?t:l[qo(f[C])];M===t&&(C=I,M=y),l=Al(M)?M.call(l):M}return l}function vj(l,f,y){return l==null?l:wl(l,f,y)}function yj(l,f,y,C){return C=typeof C=="function"?C:t,l==null?l:wl(l,f,y,C)}var QS=up(is),ZS=up(Ro);function xj(l,f,y){var C=er(l),I=C||jc(l)||jf(l);if(f=Dt(f,4),y==null){var M=l&&l.constructor;I?y=C?new M:[]:mn(l)?y=Al(M)?mc(zo(l)):{}:y={}}return(I?Qn:to)(l,function(V,te,ue){return f(y,V,te,ue)}),y}function wj(l,f){return l==null?!0:tf(l,f)}function bj(l,f,y){return l==null?l:rp(l,f,nf(y))}function _j(l,f,y,C){return C=typeof C=="function"?C:t,l==null?l:rp(l,f,nf(y),C)}function Of(l){return l==null?[]:fu(l,is(l))}function Sj(l){return l==null?[]:fu(l,Ro(l))}function Ej(l,f,y){return y===t&&(y=f,f=t),y!==t&&(y=Ni(y),y=y===y?y:0),f!==t&&(f=Ni(f),f=f===f?f:0),Vi(Ni(l),f,y)}function Cj(l,f,y){return f=Rl(f),y===t?(y=f,f=0):y=Rl(y),l=Ni(l),Vh(l,f,y)}function kj(l,f,y){if(y&&typeof y!="boolean"&&ps(l,f,y)&&(f=y=t),y===t&&(typeof f=="boolean"?(y=f,f=t):typeof l=="boolean"&&(y=l,l=t)),l===t&&f===t?(l=0,f=1):(l=Rl(l),f===t?(f=l,l=0):f=Rl(f)),l>f){var C=l;l=f,f=C}if(y||l%1||f%1){var I=xu();return Zn(l+I*(f-l+il("1e-"+((I+"").length-1))),f)}return _c(l,f)}var Nj=bl(function(l,f,y){return f=f.toLowerCase(),l+(y?eE(f):f)});function eE(l){return Q0(Dr(l).toLowerCase())}function tE(l){return l=Dr(l),l&&l.replace(Le,vg).replace(At,"")}function Tj(l,f,y){l=Dr(l),f=Fs(f);var C=l.length;y=y===t?C:Vi(or(y),0,C);var I=y;return y-=f.length,y>=0&&l.slice(y,I)==f}function Aj(l){return l=Dr(l),l&&Gs.test(l)?l.replace($n,yg):l}function Rj(l){return l=Dr(l),l&&Vs.test(l)?l.replace(Ws,"\\$&"):l}var Ij=bl(function(l,f,y){return l+(y?"-":"")+f.toLowerCase()}),Pj=bl(function(l,f,y){return l+(y?" ":"")+f.toLowerCase()}),Fj=ap("toLowerCase");function jj(l,f,y){l=Dr(l),f=or(f);var C=f?ll(l):0;if(!f||C>=f)return l;var I=(f-C)/2;return Ou(wa(I),y)+l+Ou(ul(I),y)}function Oj(l,f,y){l=Dr(l),f=or(f);var C=f?ll(l):0;return f&&C<f?l+Ou(f-C,y):l}function Dj(l,f,y){l=Dr(l),f=or(f);var C=f?ll(l):0;return f&&C<f?Ou(f-C,y)+l:l}function Lj(l,f,y){return y||f==null?f=0:f&&(f=+f),Ng(Dr(l).replace(Li,""),f||0)}function Mj(l,f,y){return(y?ps(l,f,y):f===t)?f=1:f=or(f),xl(Dr(l),f)}function $j(){var l=arguments,f=Dr(l[0]);return l.length<3?f:f.replace(l[1],l[2])}var Uj=bl(function(l,f,y){return l+(y?"_":"")+f.toLowerCase()});function zj(l,f,y){return y&&typeof y!="number"&&ps(l,f,y)&&(f=y=t),y=y===t?O:y>>>0,y?(l=Dr(l),l&&(typeof f=="string"||f!=null&&!Y0(f))&&(f=Fs(f),!f&&ic(l))?Qi(Qs(l),0,y):l.split(f,y)):[]}var Hj=bl(function(l,f,y){return l+(y?" ":"")+Q0(f)});function Bj(l,f,y){return l=Dr(l),y=y==null?0:Vi(or(y),0,l.length),f=Fs(f),l.slice(y,y+f.length)==f}function Gj(l,f,y){var C=D.templateSettings;y&&ps(l,f,y)&&(f=t),l=Dr(l),f=yv({},f,C,dp);var I=yv({},f.imports,C.imports,dp),M=is(I),V=fu(I,M),te,ue,Te=0,Ae=f.interpolate||nt,Oe="__p += '",Ye=hu((f.escape||nt).source+"|"+Ae.source+"|"+(Ae===yn?ht:nt).source+"|"+(f.evaluate||nt).source+"|$","g"),bt="//# sourceURL="+(xr.call(f,"sourceURL")?(f.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Js+"]")+`
`;l.replace(Ye,function(Bt,dr,br,Xo,so,Qo){return br||(br=Xo),Oe+=l.slice(Te,Qo).replace(Fr,xg),dr&&(te=!0,Oe+=`' +
__e(`+dr+`) +
'`),so&&(ue=!0,Oe+=`';
`+so+`;
__p += '`),br&&(Oe+=`' +
((__t = (`+br+`)) == null ? '' : __t) +
'`),Te=Qo+Bt.length,Bt}),Oe+=`';
`;var Ht=xr.call(f,"variable")&&f.variable;if(!Ht)Oe=`with (obj) {
`+Oe+`
}
`;else if(ut.test(Ht))throw new Wt(d);Oe=(ue?Oe.replace(kt,""):Oe).replace(vr,"$1").replace(nr,"$1;"),Oe="function("+(Ht||"obj")+`) {
`+(Ht?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(te?", __e = _.escape":"")+(ue?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+Oe+`return __p
}`;var ar=nE(function(){return Er(M,bt+"return "+Oe).apply(t,V)});if(ar.source=Oe,K0(ar))throw ar;return ar}function Wj(l){return Dr(l).toLowerCase()}function Vj(l){return Dr(l).toUpperCase()}function qj(l,f,y){if(l=Dr(l),l&&(y||f===t))return pg(l);if(!l||!(f=Fs(f)))return l;var C=Qs(l),I=Qs(f),M=mg(C,I),V=Oh(C,I)+1;return Qi(C,M,V).join("")}function Kj(l,f,y){if(l=Dr(l),l&&(y||f===t))return l.slice(0,Ad(l)+1);if(!l||!(f=Fs(f)))return l;var C=Qs(l),I=Oh(C,Qs(f))+1;return Qi(C,0,I).join("")}function Yj(l,f,y){if(l=Dr(l),l&&(y||f===t))return l.replace(Li,"");if(!l||!(f=Fs(f)))return l;var C=Qs(l),I=mg(C,Qs(f));return Qi(C,I).join("")}function Jj(l,f){var y=oe,C=fe;if(mn(f)){var I="separator"in f?f.separator:I;y="length"in f?or(f.length):y,C="omission"in f?Fs(f.omission):C}l=Dr(l);var M=l.length;if(ic(l)){var V=Qs(l);M=V.length}if(y>=M)return l;var te=y-ll(C);if(te<1)return C;var ue=V?Qi(V,0,te).join(""):l.slice(0,te);if(I===t)return ue+C;if(V&&(te+=ue.length-te),Y0(I)){if(l.slice(te).search(I)){var Te,Ae=ue;for(I.global||(I=hu(I.source,Dr(Xt.exec(I))+"g")),I.lastIndex=0;Te=I.exec(Ae);)var Oe=Te.index;ue=ue.slice(0,Oe===t?te:Oe)}}else if(l.indexOf(Fs(I),te)!=te){var Ye=ue.lastIndexOf(I);Ye>-1&&(ue=ue.slice(0,Ye))}return ue+C}function Xj(l){return l=Dr(l),l&&Un.test(l)?l.replace(Jt,wg):l}var Qj=bl(function(l,f,y){return l+(y?" ":"")+f.toUpperCase()}),Q0=ap("toUpperCase");function rE(l,f,y){return l=Dr(l),f=y?t:f,f===t?x0(l)?S0(l):g0(l):l.match(f)||[]}var nE=sr(function(l,f){try{return us(l,t,f)}catch(y){return K0(y)?y:new Wt(y)}}),Zj=Ci(function(l,f){return Qn(f,function(y){y=qo(y),yi(l,y,De(l[y],l))}),l});function eO(l){var f=l==null?0:l.length,y=Dt();return l=f?Hr(l,function(C){if(typeof C[1]!="function")throw new yo(c);return[y(C[0]),C[1]]}):[],sr(function(C){for(var I=-1;++I<f;){var M=l[I];if(us(M[0],this,C))return us(M[1],this,C)}})}function tO(l){return jg(Ps(l,x))}function Z0(l){return function(){return l}}function rO(l,f){return l==null||l!==l?f:l}var nO=cf(),sO=cf(!0);function Io(l){return l}function ex(l){return bc(typeof l=="function"?l:Ps(l,x))}function oO(l){return Xd(Ps(l,x))}function iO(l,f){return en(l,Ps(f,x))}var aO=sr(function(l,f){return function(y){return So(y,l,f)}}),lO=sr(function(l,f){return function(y){return So(l,y,f)}});function tx(l,f,y){var C=is(f),I=xc(f,C);y==null&&!(mn(f)&&(I.length||!C.length))&&(y=f,f=l,l=this,I=xc(f,is(f)));var M=!(mn(y)&&"chain"in y)||!!y.chain,V=Al(l);return Qn(I,function(te){var ue=f[te];l[te]=ue,V&&(l.prototype[te]=function(){var Te=this.__chain__;if(M||Te){var Ae=l(this.__wrapped__),Oe=Ae.__actions__=fs(this.__actions__);return Oe.push({func:ue,args:arguments,thisArg:l}),Ae.__chain__=Te,Ae}return ue.apply(l,ya([this.value()],arguments))})}),l}function cO(){return Zr._===this&&(Zr._=Sg),this}function rx(){}function uO(l){return l=or(l),sr(function(f){return Qd(f,l)})}var dO=uf(Hr),fO=uf(Nh),hO=uf(Rh);function sE(l){return ot(l)?Ph(qo(l)):nn(l)}function pO(l){return function(f){return l==null?t:qi(l,f)}}var mO=cp(),gO=cp(!0);function nx(){return[]}function sx(){return!1}function vO(){return{}}function yO(){return""}function xO(){return!0}function wO(l,f){if(l=or(l),l<1||l>J)return[];var y=O,C=Zn(l,O);f=Dt(f),l-=O;for(var I=jh(C,f);++y<l;)f(y);return I}function bO(l){return er(l)?Hr(l,qo):Jo(l)?[l]:fs(bp(Dr(l)))}function _O(l){var f=++cc;return Dr(l)+f}var SO=ju(function(l,f){return l+f},0),EO=Hn("ceil"),CO=ju(function(l,f){return l/f},1),kO=Hn("floor");function NO(l){return l&&l.length?gl(l,Io,Na):t}function TO(l,f){return l&&l.length?gl(l,Dt(f,2),Na):t}function AO(l){return fg(l,Io)}function RO(l,f){return fg(l,Dt(f,2))}function IO(l){return l&&l.length?gl(l,Io,Ta):t}function PO(l,f){return l&&l.length?gl(l,Dt(f,2),Ta):t}var FO=ju(function(l,f){return l*f},1),jO=Hn("round"),OO=ju(function(l,f){return l-f},0);function DO(l){return l&&l.length?Fh(l,Io):0}function LO(l,f){return l&&l.length?Fh(l,Dt(f,2)):0}return D.after=Z,D.ary=xe,D.assign=VF,D.assignIn=YS,D.assignInWith=yv,D.assignWith=qF,D.at=KF,D.before=je,D.bind=De,D.bindAll=Zj,D.bindKey=Fe,D.castArray=vF,D.chain=kf,D.chunk=yf,D.compact=_p,D.concat=No,D.cond=eO,D.conforms=tO,D.constant=Z0,D.countBy=dv,D.create=YF,D.curry=Ze,D.curryRight=lt,D.debounce=dt,D.defaults=JF,D.defaultsDeep=XF,D.defer=pn,D.delay=pe,D.difference=wr,D.differenceBy=Fn,D.differenceWith=bn,D.drop=Wn,D.dropRight=no,D.dropRightWhile=Pc,D.dropWhile=kn,D.fill=Bu,D.filter=Af,D.flatMap=jp,D.flatMapDeep=B0,D.flatMapDepth=pv,D.flatten=xf,D.flattenDeep=Wu,D.flattenDepth=js,D.flip=ie,D.flow=nO,D.flowRight=sO,D.fromPairs=Sp,D.functions=sj,D.functionsIn=oj,D.groupBy=Op,D.initial=wf,D.intersection=Ep,D.intersectionBy=Fa,D.intersectionWith=bf,D.invert=aj,D.invertBy=lj,D.invokeMap=mv,D.iteratee=ex,D.keyBy=G0,D.keys=is,D.keysIn=Ro,D.map=Tl,D.mapKeys=uj,D.mapValues=dj,D.matches=oO,D.matchesProperty=iO,D.memoize=ve,D.merge=fj,D.mergeWith=JS,D.method=aO,D.methodOf=lO,D.mixin=tx,D.negate=$e,D.nthArg=uO,D.omit=hj,D.omitBy=pj,D.once=vt,D.orderBy=W0,D.over=dO,D.overArgs=Ft,D.overEvery=fO,D.overSome=hO,D.partial=Tt,D.partialRight=zt,D.partition=Yu,D.pick=mj,D.pickBy=XS,D.property=sE,D.propertyOf=pO,D.pull=_f,D.pullAll=qu,D.pullAllBy=gs,D.pullAllWith=Oa,D.pullAt=Ko,D.range=mO,D.rangeRight=gO,D.rearg=jn,D.reject=o,D.remove=Os,D.rest=Cr,D.reverse=Sf,D.sampleSize=h,D.set=vj,D.setWith=yj,D.shuffle=g,D.slice=kp,D.sortBy=P,D.sortedUniq=Ap,D.sortedUniqBy=Cl,D.split=zj,D.spread=La,D.tail=sv,D.take=ov,D.takeRight=Rp,D.takeRightWhile=Ef,D.takeWhile=F0,D.tap=U0,D.throttle=q0,D.thru=Yo,D.toArray=VS,D.toPairs=QS,D.toPairsIn=ZS,D.toPath=bO,D.toPlainObject=KS,D.transform=xj,D.unary=mF,D.union=j0,D.unionBy=iv,D.unionWith=av,D.uniq=kl,D.uniqBy=O0,D.uniqWith=Fc,D.unset=wj,D.unzip=Cf,D.unzipWith=sn,D.update=bj,D.updateWith=_j,D.values=Of,D.valuesIn=Sj,D.without=D0,D.words=rE,D.wrap=gF,D.xor=lv,D.xorBy=L0,D.xorWith=M0,D.zip=cv,D.zipObject=uv,D.zipObjectDeep=$0,D.zipWith=To,D.entries=QS,D.entriesIn=ZS,D.extend=YS,D.extendWith=yv,tx(D,D),D.add=SO,D.attempt=nE,D.camelCase=Nj,D.capitalize=eE,D.ceil=EO,D.clamp=Ej,D.clone=yF,D.cloneDeep=wF,D.cloneDeepWith=bF,D.cloneWith=xF,D.conformsTo=_F,D.deburr=tE,D.defaultTo=rO,D.divide=CO,D.endsWith=Tj,D.eq=ra,D.escape=Aj,D.escapeRegExp=Rj,D.every=fv,D.find=Rf,D.findIndex=Pa,D.findKey=QF,D.findLast=hv,D.findLastIndex=Gu,D.findLastKey=ZF,D.floor=kO,D.forEach=If,D.forEachRight=Ku,D.forIn=ej,D.forInRight=tj,D.forOwn=rj,D.forOwnRight=nj,D.get=J0,D.gt=SF,D.gte=EF,D.has=ij,D.hasIn=X0,D.head=Sl,D.identity=Io,D.includes=Pf,D.indexOf=ta,D.inRange=Cj,D.invoke=cj,D.isArguments=Ju,D.isArray=er,D.isArrayBuffer=CF,D.isArrayLike=Ao,D.isArrayLikeObject=Nn,D.isBoolean=kF,D.isBuffer=jc,D.isDate=NF,D.isElement=TF,D.isEmpty=AF,D.isEqual=RF,D.isEqualWith=IF,D.isError=K0,D.isFinite=PF,D.isFunction=Al,D.isInteger=HS,D.isLength=gv,D.isMap=BS,D.isMatch=FF,D.isMatchWith=jF,D.isNaN=OF,D.isNative=DF,D.isNil=MF,D.isNull=LF,D.isNumber=GS,D.isObject=mn,D.isObjectLike=_n,D.isPlainObject=Dp,D.isRegExp=Y0,D.isSafeInteger=$F,D.isSet=WS,D.isString=vv,D.isSymbol=Jo,D.isTypedArray=jf,D.isUndefined=UF,D.isWeakMap=zF,D.isWeakSet=HF,D.join=ja,D.kebabCase=Ij,D.last=ms,D.lastIndexOf=Vu,D.lowerCase=Pj,D.lowerFirst=Fj,D.lt=BF,D.lte=GF,D.max=NO,D.maxBy=TO,D.mean=AO,D.meanBy=RO,D.min=IO,D.minBy=PO,D.stubArray=nx,D.stubFalse=sx,D.stubObject=vO,D.stubString=yO,D.stubTrue=xO,D.multiply=FO,D.nth=Cp,D.noConflict=cO,D.noop=rx,D.now=W,D.pad=jj,D.padEnd=Oj,D.padStart=Dj,D.parseInt=Lj,D.random=kj,D.reduce=V0,D.reduceRight=Ff,D.repeat=Mj,D.replace=$j,D.result=gj,D.round=jO,D.runInContext=le,D.sample=a,D.size=_,D.snakeCase=Uj,D.some=k,D.sortedIndex=Np,D.sortedIndexBy=P0,D.sortedIndexOf=Da,D.sortedLastIndex=nv,D.sortedLastIndexBy=Tp,D.sortedLastIndexOf=El,D.startCase=Hj,D.startsWith=Bj,D.subtract=OO,D.sum=DO,D.sumBy=LO,D.template=Gj,D.times=wO,D.toFinite=Rl,D.toInteger=or,D.toLength=qS,D.toLower=Wj,D.toNumber=Ni,D.toSafeInteger=WF,D.toString=Dr,D.toUpper=Vj,D.trim=qj,D.trimEnd=Kj,D.trimStart=Yj,D.truncate=Jj,D.unescape=Xj,D.uniqueId=_O,D.upperCase=Qj,D.upperFirst=Q0,D.each=If,D.eachRight=Ku,D.first=Sl,tx(D,(function(){var l={};return to(D,function(f,y){xr.call(D.prototype,y)||(l[y]=f)}),l})(),{chain:!1}),D.VERSION=n,Qn(["bind","bindKey","curry","curryRight","partial","partialRight"],function(l){D[l].placeholder=D}),Qn(["drop","take"],function(l,f){Zt.prototype[l]=function(y){y=y===t?1:wn(or(y),0);var C=this.__filtered__&&!f?new Zt(this):this.clone();return C.__filtered__?C.__takeCount__=Zn(y,C.__takeCount__):C.__views__.push({size:Zn(y,O),type:l+(C.__dir__<0?"Right":"")}),C},Zt.prototype[l+"Right"]=function(y){return this.reverse()[l](y).reverse()}}),Qn(["filter","map","takeWhile"],function(l,f){var y=f+1,C=y==ee||y==de;Zt.prototype[l]=function(I){var M=this.clone();return M.__iteratees__.push({iteratee:Dt(I,3),type:y}),M.__filtered__=M.__filtered__||C,M}}),Qn(["head","last"],function(l,f){var y="take"+(f?"Right":"");Zt.prototype[l]=function(){return this[y](1).value()[0]}}),Qn(["initial","tail"],function(l,f){var y="drop"+(f?"":"Right");Zt.prototype[l]=function(){return this.__filtered__?new Zt(this):this[y](1)}}),Zt.prototype.compact=function(){return this.filter(Io)},Zt.prototype.find=function(l){return this.filter(l).head()},Zt.prototype.findLast=function(l){return this.reverse().find(l)},Zt.prototype.invokeMap=sr(function(l,f){return typeof l=="function"?new Zt(this):this.map(function(y){return So(y,l,f)})}),Zt.prototype.reject=function(l){return this.filter($e(Dt(l)))},Zt.prototype.slice=function(l,f){l=or(l);var y=this;return y.__filtered__&&(l>0||f<0)?new Zt(y):(l<0?y=y.takeRight(-l):l&&(y=y.drop(l)),f!==t&&(f=or(f),y=f<0?y.dropRight(-f):y.take(f-l)),y)},Zt.prototype.takeRightWhile=function(l){return this.reverse().takeWhile(l).reverse()},Zt.prototype.toArray=function(){return this.take(O)},to(Zt.prototype,function(l,f){var y=/^(?:filter|find|map|reject)|While$/.test(f),C=/^(?:head|last)$/.test(f),I=D[C?"take"+(f=="last"?"Right":""):f],M=C||/^find/.test(f);I&&(D.prototype[f]=function(){var V=this.__wrapped__,te=C?[1]:arguments,ue=V instanceof Zt,Te=te[0],Ae=ue||er(V),Oe=function(dr){var br=I.apply(D,ya([dr],te));return C&&Ye?br[0]:br};Ae&&y&&typeof Te=="function"&&Te.length!=1&&(ue=Ae=!1);var Ye=this.__chain__,bt=!!this.__actions__.length,Ht=M&&!Ye,ar=ue&&!bt;if(!M&&Ae){V=ar?V:new Zt(this);var Bt=l.apply(V,te);return Bt.__actions__.push({func:Yo,args:[Oe],thisArg:t}),new es(Bt,Ye)}return Ht&&ar?l.apply(this,te):(Bt=this.thru(Oe),Ht?C?Bt.value()[0]:Bt.value():Bt)})}),Qn(["pop","push","shift","sort","splice","unshift"],function(l){var f=Hi[l],y=/^(?:push|sort|unshift)$/.test(l)?"tap":"thru",C=/^(?:pop|shift)$/.test(l);D.prototype[l]=function(){var I=arguments;if(C&&!this.__chain__){var M=this.value();return f.apply(er(M)?M:[],I)}return this[y](function(V){return f.apply(er(V)?V:[],I)})}}),to(Zt.prototype,function(l,f){var y=D[f];if(y){var C=y.name+"";xr.call(hc,C)||(hc[C]=[]),hc[C].push({name:f,func:y})}}),hc[Tc(t,A).name]=[{name:"wrapper",func:t}],Zt.prototype.clone=Ud,Zt.prototype.reverse=Hh,Zt.prototype.value=gc,D.prototype.at=Nf,D.prototype.chain=Nl,D.prototype.commit=Tf,D.prototype.next=Ip,D.prototype.plant=z0,D.prototype.reverse=Fp,D.prototype.toJSON=D.prototype.valueOf=D.prototype.value=H0,D.prototype.first=D.prototype.head,Gi&&(D.prototype[Gi]=Pp),D}),ac=E0();fi?((fi.exports=ac)._=ac,du._=ac):Zr._=ac}).call(xq)})(xm,xm.exports)),xm.exports}var ry=wq();const hw="src/shared/components/sidepanel/panels/components/UnifiedSearch.tsx",HP=({onMatterSelected:r,integrationType:e="clio"})=>{const t=Gr(),n=w.useRef(null),[s,i]=w.useState(""),[c,d]=w.useState([]),[m,p]=w.useState(!1),[v,x]=w.useState(!1),[b,S]=w.useState(null);w.useEffect(()=>{const T=A=>{n.current&&!n.current.contains(A.target)&&x(!1)};return document.addEventListener("mousedown",T),()=>{document.removeEventListener("mousedown",T)}},[]);const N=w.useMemo(()=>ry.debounce(async T=>{if(!T.trim()||T.length<2){d([]),S(null);return}p(!0),S(null);try{const A=await q_(e,T,t);d(A.projects||[]),A.projects.length===0&&S(`No matters found for "${T}"`)}catch(A){t.error("Matter search failed",A,{sourceFile:hw}),S("Failed to search matters. Please try again."),d([])}finally{p(!1)}},400),[t,e]),E=T=>{var A,R;try{t.info("Matter selected via unified search",{matterId:(R=(A=T.projectId)==null?void 0:A.native)==null?void 0:R.toString(),matterName:T.projectName,sourceFile:hw}),r(T),x(!1),i(""),d([]),S(null)}catch(F){t.error("Failed to select matter",F,{sourceFile:hw})}};return u.jsxs("div",{ref:n,className:"w-full mb-3 p-1",children:[u.jsxs("div",{className:"relative",children:[u.jsx(Ri,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400 pointer-events-none z-10"}),u.jsx(vn,{placeholder:e==="filevine"?"Search projects in Filevine...":"Search matters in Clio...",value:s,onChange:T=>{const A=T.target.value;i(A),x(!0),N(A)},onFocus:()=>x(!0),className:"pl-10 pr-10 h-10 text-sm border border-border/50 rounded-lg shadow-sm bg-card"}),s&&u.jsx("button",{onClick:T=>{T.stopPropagation(),i(""),d([]),S(null),x(!1)},className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 z-10",children:u.jsx(aa,{className:"w-4 h-4"})})]}),v&&(s.length>=2||m||c.length>0)&&u.jsx("div",{className:"relative",children:u.jsx("div",{className:"absolute top-2 left-0 right-0 z-50 w-full max-w-full border border-border/50 rounded-lg shadow-lg bg-card",children:u.jsx("div",{className:"max-h-[300px] overflow-y-auto",children:m?u.jsxs("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 flex items-center gap-2",children:[u.jsx("div",{className:"w-4 h-4 border-2 border-gray-300 border-t-gray-600 rounded-full animate-spin"}),"Searching..."]}):b&&c.length===0?u.jsx("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:b}):c.length>0?c.map(T=>u.jsxs("div",{className:"flex flex-col items-start p-3 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-800 border-b border-gray-100 dark:border-gray-700 last:border-b-0",onClick:()=>E(T),children:[u.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-gray-100",children:T.projectName}),u.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5",children:[T.phaseName,"  Client: ",T.clientName]})]},T.projectId.native)):s.trim()&&!m?u.jsxs("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:['No matters found for "',s,'"']}):u.jsx("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:e==="filevine"?"Type at least 2 characters to search projects...":"Type at least 2 characters to search matters..."})})})})]})},Bs=({rows:r=2})=>u.jsx("div",{className:"p-1",children:u.jsx("table",{className:"w-full text-sm text-left text-gray-600 dark:text-gray-300",children:u.jsx("tbody",{children:Array.from({length:r}).map((e,t)=>u.jsxs("tr",{className:"bg-card animate-pulse",children:[u.jsx("td",{className:"py-2 px-3 whitespace-normal font-medium w-1/3",children:u.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-3/4"})}),u.jsx("td",{className:"py-2 px-3",children:u.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-full"})})]},t))})})}),bq="src/sidepanel/panels/components/FilevineClientInfoBox.tsx",_q=({clientEmail:r,emailParticipants:e,emailParticipantClients:t,tempClientEmail:n,setTempClientEmail:s,setIsManuallySet:i,isManuallySet:c,selectedClientDetails:d,isLoading:m,ClientNavigation:p,setClientEmail:v,isValidClient:x,isTempEmailValid:b,isValidating:S,isProjectManuallySelected:N=!1})=>{const E=Gr(),{isConnected:T,initiateReconnection:A}=Di(),{platform:R}=dn(),F=()=>u.jsx(Bs,{rows:2}),j=()=>u.jsxs("div",{className:"p-4 text-center",children:[u.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-3",children:u.jsx(Xc,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"})}),u.jsx("p",{className:"text-sm font-medium text-gray-800 mb-2",children:"Gmail disconnected"}),u.jsx("p",{className:"text-xs text-gray-600 mb-4",children:"Connect Gmail to view email insights"}),u.jsxs(We,{onClick:async()=>{try{await A()}catch(L){E.error("Failed to reconnect Gmail:",L,{sourceFile:bq})}},size:"sm",className:"bg-blue-600 hover:bg-blue-700 text-white text-xs px-4 py-2",children:[u.jsx(si,{className:"h-3 w-3 mr-1"}),"Reconnect Gmail"]})]});return u.jsxs("div",{className:"w-full min-h-[4rem] border border-border/50 rounded-lg shadow-sm bg-card text-card-foreground",title:"Client Information",children:[u.jsx("div",{className:"flex items-center justify-between p-2 border-b bg-muted",children:u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(Ey,{className:"w-3.5 h-3.5 text-slate-600 dark:text-gray-300"}),u.jsx("span",{className:"font-medium text-sm text-slate-800 dark:text-white",children:"CONTACT"})]})}),m?F():N?d&&Object.keys(d).length>0?u.jsx(Ql,{details:d}):u.jsxs("div",{className:"p-4 text-center",children:[u.jsx(Ri,{className:"w-8 h-8 mx-auto mb-2 text-gray-400"}),u.jsx("div",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Project Manually Selected"}),u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"No contact information available for this project"})]}):u.jsxs(u.Fragment,{children:[t.length>0&&!c&&u.jsx(p,{}),c&&r&&u.jsx("div",{className:"px-3 py-2 bg-gray-50 dark:bg-gray-800 border-b dark:border-gray-700",children:u.jsxs("div",{className:"flex flex-col",children:[u.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate",children:r}),u.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5",children:"(Manually set)"})]})}),S&&e.length>0&&t.length===0&&!c?u.jsx(Bs,{rows:2}):d&&Object.keys(d).length>0?u.jsx(Ql,{details:d}):R==="chrome"&&!T?j():u.jsx("div",{className:"p-3 text-sm text-gray-600 dark:text-gray-400",children:u.jsx("p",{className:"mb-2",children:c&&r?`No contact information found for ${r}`:e.length>0&&t.length===0?`No contact information available for emails on the selected thread:
                        ${e.join(", ")}`:e.length>0?"No contact information available for the selected email ID":"Select a contact email thread to view contact information"})})]})]})};var d0="Collapsible",[Sq,BP]=Za(d0),[Eq,jS]=Sq(d0),GP=w.forwardRef((r,e)=>{const{__scopeCollapsible:t,open:n,defaultOpen:s,disabled:i,onOpenChange:c,...d}=r,[m,p]=ru({prop:n,defaultProp:s??!1,onChange:c,caller:d0});return u.jsx(Eq,{scope:t,disabled:i,contentId:Vl(),open:m,onOpenToggle:w.useCallback(()=>p(v=>!v),[p]),children:u.jsx($r.div,{"data-state":DS(m),"data-disabled":i?"":void 0,...d,ref:e})})});GP.displayName=d0;var WP="CollapsibleTrigger",VP=w.forwardRef((r,e)=>{const{__scopeCollapsible:t,...n}=r,s=jS(WP,t);return u.jsx($r.button,{type:"button","aria-controls":s.contentId,"aria-expanded":s.open||!1,"data-state":DS(s.open),"data-disabled":s.disabled?"":void 0,disabled:s.disabled,...n,ref:e,onClick:Lt(r.onClick,s.onOpenToggle)})});VP.displayName=WP;var OS="CollapsibleContent",qP=w.forwardRef((r,e)=>{const{forceMount:t,...n}=r,s=jS(OS,r.__scopeCollapsible);return u.jsx(fa,{present:t||s.open,children:({present:i})=>u.jsx(Cq,{...n,ref:e,present:i})})});qP.displayName=OS;var Cq=w.forwardRef((r,e)=>{const{__scopeCollapsible:t,present:n,children:s,...i}=r,c=jS(OS,t),[d,m]=w.useState(n),p=w.useRef(null),v=Mn(e,p),x=w.useRef(0),b=x.current,S=w.useRef(0),N=S.current,E=c.open||d,T=w.useRef(E),A=w.useRef(void 0);return w.useEffect(()=>{const R=requestAnimationFrame(()=>T.current=!1);return()=>cancelAnimationFrame(R)},[]),Kl(()=>{const R=p.current;if(R){A.current=A.current||{transitionDuration:R.style.transitionDuration,animationName:R.style.animationName},R.style.transitionDuration="0s",R.style.animationName="none";const F=R.getBoundingClientRect();x.current=F.height,S.current=F.width,T.current||(R.style.transitionDuration=A.current.transitionDuration,R.style.animationName=A.current.animationName),m(n)}},[c.open,n]),u.jsx($r.div,{"data-state":DS(c.open),"data-disabled":c.disabled?"":void 0,id:c.contentId,hidden:!E,...i,ref:v,style:{"--radix-collapsible-content-height":b?`${b}px`:void 0,"--radix-collapsible-content-width":N?`${N}px`:void 0,...r.style},children:E&&s})});function DS(r){return r?"open":"closed"}var kq=GP,Nq=VP,Tq=qP,pa="Accordion",Aq=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[LS,Rq,Iq]=CS(pa),[f0]=Za(pa,[Iq,BP]),MS=BP(),KP=_r.forwardRef((r,e)=>{const{type:t,...n}=r,s=n,i=n;return u.jsx(LS.Provider,{scope:r.__scopeAccordion,children:t==="multiple"?u.jsx(Oq,{...i,ref:e}):u.jsx(jq,{...s,ref:e})})});KP.displayName=pa;var[YP,Pq]=f0(pa),[JP,Fq]=f0(pa,{collapsible:!1}),jq=_r.forwardRef((r,e)=>{const{value:t,defaultValue:n,onValueChange:s=()=>{},collapsible:i=!1,...c}=r,[d,m]=ru({prop:t,defaultProp:n??"",onChange:s,caller:pa});return u.jsx(YP,{scope:r.__scopeAccordion,value:_r.useMemo(()=>d?[d]:[],[d]),onItemOpen:m,onItemClose:_r.useCallback(()=>i&&m(""),[i,m]),children:u.jsx(JP,{scope:r.__scopeAccordion,collapsible:i,children:u.jsx(XP,{...c,ref:e})})})}),Oq=_r.forwardRef((r,e)=>{const{value:t,defaultValue:n,onValueChange:s=()=>{},...i}=r,[c,d]=ru({prop:t,defaultProp:n??[],onChange:s,caller:pa}),m=_r.useCallback(v=>d((x=[])=>[...x,v]),[d]),p=_r.useCallback(v=>d((x=[])=>x.filter(b=>b!==v)),[d]);return u.jsx(YP,{scope:r.__scopeAccordion,value:c,onItemOpen:m,onItemClose:p,children:u.jsx(JP,{scope:r.__scopeAccordion,collapsible:!0,children:u.jsx(XP,{...i,ref:e})})})}),[Dq,h0]=f0(pa),XP=_r.forwardRef((r,e)=>{const{__scopeAccordion:t,disabled:n,dir:s,orientation:i="vertical",...c}=r,d=_r.useRef(null),m=Mn(d,e),p=Rq(t),x=o0(s)==="ltr",b=Lt(r.onKeyDown,S=>{var q;if(!Aq.includes(S.key))return;const N=S.target,E=p().filter(ae=>{var oe;return!((oe=ae.ref.current)!=null&&oe.disabled)}),T=E.findIndex(ae=>ae.ref.current===N),A=E.length;if(T===-1)return;S.preventDefault();let R=T;const F=0,j=A-1,L=()=>{R=T+1,R>j&&(R=F)},G=()=>{R=T-1,R<F&&(R=j)};switch(S.key){case"Home":R=F;break;case"End":R=j;break;case"ArrowRight":i==="horizontal"&&(x?L():G());break;case"ArrowDown":i==="vertical"&&L();break;case"ArrowLeft":i==="horizontal"&&(x?G():L());break;case"ArrowUp":i==="vertical"&&G();break}const z=R%A;(q=E[z].ref.current)==null||q.focus()});return u.jsx(Dq,{scope:t,disabled:n,direction:s,orientation:i,children:u.jsx(LS.Slot,{scope:t,children:u.jsx($r.div,{...c,"data-orientation":i,ref:m,onKeyDown:n?void 0:b})})})}),Oy="AccordionItem",[Lq,$S]=f0(Oy),QP=_r.forwardRef((r,e)=>{const{__scopeAccordion:t,value:n,...s}=r,i=h0(Oy,t),c=Pq(Oy,t),d=MS(t),m=Vl(),p=n&&c.value.includes(n)||!1,v=i.disabled||r.disabled;return u.jsx(Lq,{scope:t,open:p,disabled:v,triggerId:m,children:u.jsx(kq,{"data-orientation":i.orientation,"data-state":sF(p),...d,...s,ref:e,disabled:v,open:p,onOpenChange:x=>{x?c.onItemOpen(n):c.onItemClose(n)}})})});QP.displayName=Oy;var ZP="AccordionHeader",eF=_r.forwardRef((r,e)=>{const{__scopeAccordion:t,...n}=r,s=h0(pa,t),i=$S(ZP,t);return u.jsx($r.h3,{"data-orientation":s.orientation,"data-state":sF(i.open),"data-disabled":i.disabled?"":void 0,...n,ref:e})});eF.displayName=ZP;var bb="AccordionTrigger",tF=_r.forwardRef((r,e)=>{const{__scopeAccordion:t,...n}=r,s=h0(pa,t),i=$S(bb,t),c=Fq(bb,t),d=MS(t);return u.jsx(LS.ItemSlot,{scope:t,children:u.jsx(Nq,{"aria-disabled":i.open&&!c.collapsible||void 0,"data-orientation":s.orientation,id:i.triggerId,...d,...n,ref:e})})});tF.displayName=bb;var rF="AccordionContent",nF=_r.forwardRef((r,e)=>{const{__scopeAccordion:t,...n}=r,s=h0(pa,t),i=$S(rF,t),c=MS(t);return u.jsx(Tq,{role:"region","aria-labelledby":i.triggerId,"data-orientation":s.orientation,...c,...n,ref:e,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...r.style}})});nF.displayName=rF;function sF(r){return r?"open":"closed"}var Mq=KP,$q=QP,Uq=eF,oF=tF,iF=nF;const zq=Mq,aF=w.forwardRef(({className:r,...e},t)=>u.jsx($q,{ref:t,className:jr("border-b border-neutral-200 dark:border-border",r),...e}));aF.displayName="AccordionItem";const lF=w.forwardRef(({className:r,children:e,...t},n)=>u.jsx(Uq,{className:"flex",children:u.jsxs(oF,{ref:n,className:jr("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",r),...t,children:[e,u.jsx(xs,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})}));lF.displayName=oF.displayName;const cF=w.forwardRef(({className:r,children:e,...t},n)=>u.jsx(iF,{ref:n,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...t,children:u.jsx("div",{className:jr("pb-4 pt-0",r),children:e})}));cF.displayName=iF.displayName;const Hq="src/shared/components/sidepanel/panels/components/FilevineCaseInfoBox.tsx",Bq=({caseSummaryData:r,isCaseSummaryLoading:e,caseSummaryError:t,caseDetails:n,onDocumentView:s})=>{if(e)return u.jsxs("div",{className:"space-y-2",children:[u.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded animate-pulse"}),u.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded animate-pulse"}),u.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded animate-pulse"})]});if(t)return u.jsx("div",{className:"text-sm text-red-600 dark:text-red-400",children:t});if(!r)return null;const i={};return r.caseFacts&&(i["Case Facts"]=r.caseFacts),r.supioLink&&(i["Supio Link"]=r.supioLink),n.incidentDate&&(i["Incident Date"]=new Date(n.incidentDate).toLocaleDateString(void 0,{timeZone:"UTC"})),r.statuteoflimitations&&r.statuteoflimitations.dateValue&&(i["Statute of Limitations (SOL)"]=new Date(r.statuteoflimitations.dateValue).toLocaleDateString(void 0,{timeZone:"UTC"})),r.totalMeds>0&&(i["Total Meds"]=`$${r.totalMeds.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`),r.totalLiens>0&&(i["Total Liens"]=`$${r.totalLiens.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`),u.jsxs("div",{className:"space-y-3",children:[u.jsx(Ql,{details:i}),r.disbursementSheet&&u.jsx("div",{className:"px-3 pb-2",children:u.jsx("table",{className:"w-full text-sm text-left text-gray-700 dark:text-gray-300",children:u.jsx("tbody",{children:u.jsxs("tr",{className:"bg-card",children:[u.jsx("td",{className:"py-4 px-3 whitespace-normal font-medium w-1/3 text-gray-800 dark:text-gray-200",children:"Disbursement Sheet"}),u.jsx("td",{className:"py-2 px-3",children:u.jsxs("button",{onClick:()=>{s&&r.disbursementSheet&&s({name:r.disbursementSheet.filename,documentId:r.disbursementSheet.documentId,url:""})},className:"text-blue-600 dark:text-blue-400 hover:underline inline-flex items-center gap-1 cursor-pointer focus:outline-none",children:[u.jsx(ld,{className:"w-3 h-3"}),r.disbursementSheet.filename]})})]})})})})]})},Gq=({clientEmail:r,selectedCaseDetails:e,casesForCurrentClient:t,currentCaseIndex:n,caseDetails:s,nextCase:i,prevCase:c,isLoading:d,setCurrentCaseIndex:m,isValidating:p=!1,handleSectionClick:v,projectId:x,onDocumentView:b})=>{const S=Gr(),[N,E]=w.useState(""),[T,A]=w.useState(!1),[R,F]=w.useState(null),[j,L]=w.useState(!1),[G,z]=w.useState(null),q=w.useMemo(()=>{if(!N.trim())return t;const ee=N.toLowerCase();return t.filter(se=>String(se.projectName||"").toLowerCase().includes(ee))},[t,N]),ae=ee=>{A(ee),ee||E("")},oe=async()=>{if(!(!x||R)){L(!0),z(null);try{const ee=await n8("filevine",x,S);F(ee)}catch(ee){S.error("Error fetching case summary",ee,{sourceFile:Hq}),z("Failed to load case summary data")}finally{L(!1)}}};w.useEffect(()=>{F(null),z(null)},[x]);const fe=()=>u.jsx(Bs,{rows:2}),H=()=>v?u.jsxs(We,{variant:"ghost",className:"justify-between w-full text-sm px-0 hover:bg-transparent",onClick:()=>v("Project Documents"),children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx(ld,{className:"h-4 w-4 mr-2 text-blue-500 dark:text-blue-400"}),u.jsx("span",{className:"text-blue-500 dark:text-blue-400",children:"Project Documents"})]}),u.jsx(Ai,{src:"/icons/chevron-right.svg",width:16,height:16,alt:"Chevron right",className:"h-4 w-4"})]}):null,me=ee=>{if(m)m(ee);else if(ee>n)for(let se=n;se<ee;se++)i();else if(ee<n)for(let se=n;se>ee;se--)c()};return u.jsxs("div",{className:"w-full min-h-[4rem] border border-border/50 rounded-lg shadow-sm bg-card text-card-foreground",title:"Case Information",children:[u.jsx("div",{className:"flex items-center justify-between p-2 border-b bg-muted",children:u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(ZA,{className:"w-3.5 h-3.5 text-slate-600 dark:text-gray-300"}),u.jsx("span",{className:"font-medium text-sm text-slate-800 dark:text-white",children:"PROJECTS"})]})}),d?fe():e&&Object.keys(e).length>0?u.jsxs(u.Fragment,{children:[t.length>0&&u.jsxs("div",{className:"flex items-center px-3 py-1 bg-gray-50 dark:bg-gray-800 border-b dark:border-gray-700 gap-2",children:[u.jsxs("div",{className:"flex-1 min-w-0 flex items-center",children:[t.length>1&&u.jsxs(jo,{open:T,onOpenChange:ae,children:[u.jsx(Oo,{asChild:!0,children:u.jsxs(We,{variant:"ghost",size:"sm",className:"h-8 text-xs text-gray-600 dark:text-gray-300 flex items-center gap-1 px-2 max-w-full",children:[u.jsx("span",{className:"truncate",title:e.Title||"",children:e.Title||"Case"}),u.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400 flex-shrink-0",children:["(",n+1,"/",t.length,")"]}),u.jsx(xs,{className:"w-3 h-3 ml-1 flex-shrink-0"})]})}),u.jsxs(co,{align:"start",className:"w-[280px] p-0",children:[u.jsxs("div",{className:"p-2 border-b border-gray-200 dark:border-gray-700",children:[u.jsxs("div",{className:"relative",children:[u.jsx(Ri,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),u.jsx(vn,{placeholder:"Search projects...",value:N,onChange:ee=>E(ee.target.value),className:"pl-8 pr-8 h-8 text-xs",autoFocus:!0,onClick:ee=>ee.stopPropagation(),onKeyDown:ee=>ee.stopPropagation()}),N&&u.jsx("button",{onClick:ee=>{ee.stopPropagation(),E("")},className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:u.jsx(aa,{className:"w-4 h-4"})})]}),N&&u.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:["Showing ",q.length," of ",t.length]})]}),u.jsx("div",{className:"max-h-[200px] overflow-y-auto",children:q.length>0?q.map((ee,se)=>{const de=t.findIndex(Y=>Y===ee);return u.jsx(bs,{className:`text-xs truncate ${de===n?"bg-gray-100 dark:bg-gray-700 font-medium":""}`,onClick:()=>me(de),children:String(ee.projectName||`Case ${de+1}`)},de)}):u.jsxs("div",{className:"p-3 text-xs text-center text-gray-500 dark:text-gray-400",children:['No projects match "',N,'"']})})]})]}),t.length===1&&u.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-300 px-2 truncate",title:e.Title||"",children:e.Title||"Case"})]}),s.projectUrl&&u.jsxs("a",{href:s.projectUrl,target:"_blank",rel:"noopener noreferrer",className:"h-8 text-xs text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 border border-blue-200 dark:border-blue-800 px-3 flex-shrink-0 rounded-md inline-flex items-center gap-1 no-underline hover:no-underline",children:[u.jsx(Va,{className:"w-3 h-3"}),"View"]})]}),u.jsx("div",{className:"break-words overflow-hidden",children:u.jsx(Ql,{details:e})}),u.jsx("div",{className:"px-3 border-t",children:H()}),s.projectTypeCode&&s.projectTypeCode!=="IM"&&u.jsx("div",{className:"border-t",children:u.jsx(zq,{type:"single",collapsible:!0,onValueChange:ee=>{ee==="view-more"&&oe()},children:u.jsxs(aF,{value:"view-more",className:"border-0",children:[u.jsx(lF,{className:"px-3 py-2 hover:no-underline text-sm font-medium",children:"View More"}),u.jsx(cF,{className:"px-3 pb-2",children:u.jsx(Bq,{caseSummaryData:R,isCaseSummaryLoading:j,caseSummaryError:G,caseDetails:s,onDocumentView:b})})]})},x)})]}):p?u.jsx(Bs,{rows:2}):u.jsx("div",{className:"p-3 text-sm text-gray-600 dark:text-gray-400",children:r?u.jsx(u.Fragment,{children:u.jsx("p",{className:"mb-2",children:"Select a client email thread to view project information"})}):"Select a client email thread to view case information"})]})},pr="src/sidepanel/mainPanelContent/FilevineInsights.tsx",Wq="https://rubypowerslaw.filevineapp.com",Vq=({toggleSection:r,clientEmail:e,setClientEmail:t,setProjectId:n,setDocuments:s,setIsDocumentsLoading:i,setDocumentsError:c,onDocumentView:d,tempClientEmail:m,setTempClientEmail:p,emailParticipants:v,emailParticipantClients:x,currentClientIndex:b,setCurrentClientIndex:S,currentCaseIndex:N,casesForCurrentClient:E,setCasesForCurrentClient:T,isManuallySet:A,setIsManuallySet:R,isProjectManuallySelected:F,setIsProjectManuallySelected:j,isValidClient:L,isTempEmailValid:G,nextCase:z,prevCase:q,handleSetCurrentCaseIndex:ae,ClientNavigation:oe,onClientDataValidated:fe,isValidating:H,refreshTrigger:me,integrationSettings:ee,isPrefetchEnabled:se})=>{const[de,Y]=w.useState(!1),[J,$]=w.useState({}),[X,O]=w.useState({}),[U,re]=w.useState({}),[Ee,ne]=w.useState(!1),[we,K]=w.useState(void 0),[he,be]=w.useState([]),[Ie,_t]=w.useState(!1),[Be,Ge]=w.useState(null),qe=w.useRef({}),Ne=Gr(),St=ua(),ct=w.useCallback(ge=>{if(!ge||!ge.client_data)return!1;const Pe=ge.client_data;return Pe&&typeof Pe=="object"&&Object.keys(Pe).length>0},[]),Ct=w.useCallback(ge=>{Ne.info("selectClientDetails called",{sourceFile:pr,hasDetails:!!ge,detailsKeys:ge?Object.keys(ge):[]});const Pe=wt=>{const ze=wt.replace(/\D/g,"");return ze.length===10?`(${ze.slice(0,3)}) ${ze.slice(3,6)}-${ze.slice(6)}`:wt};Ne.debug("Client details received for formatting",{sourceFile:pr,caseNames:ge.caseNames});const pt={Name:ge.fullName||"",Phone:Pe(ge.phoneNumber||""),Address:ge.fullAddress||""};Ne.info("Client details formatted and set",{sourceFile:pr,selectedDetails:pt,originalDetails:ge}),O(pt)},[Ne]),Gt=w.useCallback(ge=>{Ne.info("selectCaseDetails called",{sourceFile:pr,hasDetails:!!ge,detailsKeys:ge?Object.keys(ge):[]});let Pe="";if(ge.projectName){const ze=ge.projectName.match(/(\d{2}-\d{3})/);ze&&ze[1]&&(Pe=ze[1])}Ne.debug("Case details received for formatting",{sourceFile:pr});const wt=(ge.projectTypeCode||"")==="IM"?{Title:ge.projectName||"","Internal Case ID":Pe,"Assigned To":ge.firstPrimaryName||"",Phase:ge.phaseName||"",Tags:ge.hashtags||"","Filevine Email":ge.projectEmailAddress||""}:{Title:ge.projectName||"","Assigned To":ge.firstPrimaryName||"",Phase:ge.phaseName||"",Tags:ge.hashtags||"","Filevine Email":ge.projectEmailAddress||""};Ne.info("Case details formatted and set",{sourceFile:pr,selectedDetails:wt,originalDetails:ge}),re(wt)},[Ne]),$t=w.useCallback(async ge=>{if(qe.current[ge]){Ne.debug("Using cached client data",{sourceFile:pr,email:ge});return}try{Ne.debug("Fetching client data",{sourceFile:pr,email:ge});const Pe=await St.getCurrentThreadId(),pt=await V_("filevine",ge,Ne,!1,void 0,Pe);qe.current[ge]=pt}catch(Pe){throw Pe instanceof Error&&(Pe.message.includes("Client not found")||Pe.message.includes("(cached)"))?Ne.debug("Client not found for email (including cached)",{sourceFile:pr,email:ge}):Ne.error(`Error fetching client data for ${ge}`,Pe,{sourceFile:pr}),Pe}},[Ne,St]),Kt=w.useCallback(async()=>{if(Ne.info("fetchClientData called",{sourceFile:pr,clientEmail:e,isFilevineConnected:de,hasClientEmail:!!e}),!e||!de){Ne.info("fetchClientData early return",{sourceFile:pr,reason:e?"filevine not connected":"no client email",clientEmail:e,isFilevineConnected:de});return}try{if(ne(!0),Ne.info("fetchClientData: fetching from server",{sourceFile:pr,clientEmail:e}),!qe.current[e])try{await $t(e)}catch(He){He instanceof Error&&He.message.includes("(cached)")?Ne.debug("Using cached knowledge that this client doesn't exist",{sourceFile:pr,clientEmail:e}):Ne.error("Error fetching client data",He,{sourceFile:pr}),$({}),T([]),O({}),re({}),ne(!1);return}const ge=qe.current[e];if(!ge){$({}),T([]),O({}),re({}),ne(!1),fe(e,!1);return}const Pe=ct(ge);if(fe(e,Pe),!Pe){Ne.debug("Client data exists but is not valid",{sourceFile:pr,clientEmail:e}),$({}),T([]),O({}),re({}),ne(!1);return}const pt=ge.client_data;Ct(pt);const wt=ge.case_data||[];T(wt);const ze=wt.length>0?Object.entries(wt[0]).reduce((He,[rt,Re])=>(He[rt]=String(Re),He),{}):{};$(ze),Gt(ze)}catch(ge){Ne.error("Error processing client data",ge,{sourceFile:pr}),$({}),T([]),e&&fe(e,!1)}finally{ne(!1)}},[e,de,$t,Ne,Ct,Gt,T,fe,ct]);w.useEffect(()=>{Ne.info("FilevineInsights component initialized",{sourceFile:pr,clientEmail:e,emailParticipants:v.length,currentClientIndex:b,currentCaseIndex:N,casesForCurrentClient:E.length}),(async()=>{try{Y(!0)}catch(Pe){Ne.error("Error checking Filevine connection",Pe,{sourceFile:pr}),Y(!1)}})()},[Ne,E.length,N,b,e,v.length]),w.useEffect(()=>{H&&v.length>0&&(qe.current={},Ne.debug("Cleared component-level client data cache for refresh",{sourceFile:pr}))},[H,v.length,Ne]),w.useEffect(()=>{const ge=async()=>{if(de){Ne.info("Validating all email participants",{sourceFile:pr,participantCount:v.length});for(const Pe of v)try{await $t(Pe);const pt=qe.current[Pe],wt=ct(pt);fe(Pe,wt),Ne.debug("Participant validation result",{sourceFile:pr,email:Pe,hasValidData:wt})}catch(pt){Ne.debug("Participant validation failed",{sourceFile:pr,email:Pe,error:pt}),fe(Pe,!1)}}};v.length>0&&de&&ge()},[v,de,$t,ct,fe,Ne,me]),w.useEffect(()=>{if(F){Ne.debug("Skipping fetchClientData because project was manually selected",{sourceFile:pr,clientEmail:e,isProjectManuallySelected:F});return}e&&de&&(Ne.info("Fetching client data for email",{sourceFile:pr,clientEmail:e,isPrefetchEnabled:se}),Kt(),p(e),A&&!v.includes(e.toLowerCase())&&Ne.debug("Manually set email not in participants, validating separately",{sourceFile:pr,clientEmail:e}))},[e,de,Kt,p,A,F,v,Ne,se]),w.useEffect(()=>{F||(!e||v.length===0&&!A)&&(p(null),O({}),re({}))},[e,v.length,A,F,p,O,re]),w.useEffect(()=>{var ge;if(E.length>0&&N<E.length){const Pe=E[N],pt=Pe?Object.entries(Pe).reduce((ze,[He,rt])=>(ze[He]=String(rt),ze),{}):{};$(pt),Gt(pt);const wt=(ge=Pe==null?void 0:Pe.projectId)!=null&&ge.native?String(Pe.projectId.native):void 0;K(wt),n&&wt&&n(wt)}},[N,E,Gt,n]);const hr=w.useCallback(async()=>{var pt;if(!de||E.length===0)return;const ge=E[N],Pe=((pt=ge==null?void 0:ge.projectId)==null?void 0:pt.native)||(ge==null?void 0:ge.projectId);if(!Pe){Ne.debug("No project ID found for current case",{sourceFile:pr,currentCaseIndex:N});const wt="No project ID available. Cannot fetch documents.";Ge(wt),c&&c(wt);return}_t(!0),i&&i(!0),Ge(null),c&&c(null);try{const wt=await gT(String(Pe),Ne);if(wt){Ne.debug("Using cached documents for project",{sourceFile:pr,projectId:Pe}),be(wt),s&&s(wt),_t(!1),i&&i(!1);return}const He=(await PT("filevine",String(Pe),Ne)).documents.map(rt=>({name:rt.filename,url:`${Wq}/docwebviewer/view/${rt.documentId}`,documentId:rt.documentId,folderName:rt.folderName}));await mT(String(Pe),He,Ne),be(He),s&&s(He)}catch(wt){Ne.error("Error fetching documents",wt,{sourceFile:pr});const ze="Failed to load documents. Please try again later.";Ge(ze),c&&c(ze)}finally{_t(!1),i&&i(!1)}},[de,E,N,s,i,c,Ne]),Ur=w.useCallback((ge,Pe)=>{var pt;try{const wt=((pt=ge.projectId)==null?void 0:pt.native)||ge.projectId;Ne.info("Project manually selected via search",{projectId:wt,projectName:ge.projectName,sourceFile:pr}),$(ge),Gt(ge),T([ge]),t(""),O(Pe?{Name:Pe}:{}),j(!0),K(wt),n&&wt&&n(wt)}catch(wt){Ne.error("Failed to set manually selected project",wt,{sourceFile:pr})}},[Ne,Gt,T,t,j,n]),zr=w.useCallback(ge=>{var pt,wt;const Pe={projectId:{native:((pt=ge.projectId)==null?void 0:pt.native)||null,partner:((wt=ge.projectId)==null?void 0:wt.partner)||null},projectName:ge.projectName||"",projectTypeCode:ge.projectTypeCode||"",projectTypeName:ge.projectTypeName||"",phaseName:ge.phaseName||"",phaseDate:ge.phaseDate||"",firstPrimaryName:ge.firstPrimaryName||"",firstPrimaryUsername:ge.firstPrimaryUsername||"",hashtags:Array.isArray(ge.hashtags)?ge.hashtags.join(", "):"",projectEmailAddress:ge.projectEmailAddress||"",projectUrl:ge.projectUrl||"",incidentDate:ge.incidentDate||""};Ur(Pe,ge.clientName||"")},[Ur]);if(!de)return null;const kr=ge=>{Ne.debug(`[FilevineInfoBox] handleSectionClick called with section: "${ge}"`,{sourceFile:pr,functionName:"handleSectionClick",data:{section:ge}}),r?(Ne.debug(`[FilevineInfoBox] Calling toggleSection with section: "${ge}"`,{sourceFile:pr,functionName:"handleSectionClick",data:{section:ge}}),r(ge),ge.toLowerCase()==="project documents"?(Ne.debug('[FilevineInfoBox] Section is "project documents", calling fetchMatterDocuments',{sourceFile:pr,functionName:"handleSectionClick",data:{section:ge}}),hr()):Ne.debug('[FilevineInfoBox] Section is not "project documents", not calling fetchMatterDocuments',{sourceFile:pr,functionName:"handleSectionClick",data:{section:ge}})):Ne.warn("[FilevineInfoBox] toggleSection is not defined. Cannot navigate.",{sourceFile:pr,functionName:"handleSectionClick",data:{section:ge}})};return u.jsxs("div",{className:"space-y-4 overflow-y-auto h-full mt-0",children:[u.jsx(HP,{onMatterSelected:zr,integrationType:"filevine"}),u.jsx(_q,{clientEmail:e,emailParticipants:v,emailParticipantClients:x,currentClientIndex:b,setCurrentClientIndex:S,setClientEmail:t,isManuallySet:A,selectedClientDetails:X,isLoading:Ee,ClientNavigation:oe,tempClientEmail:m,setTempClientEmail:p,setIsManuallySet:R,isValidClient:L,isTempEmailValid:G,isValidating:H,isProjectManuallySelected:F}),u.jsx(Gq,{clientEmail:e,selectedCaseDetails:U,casesForCurrentClient:E,currentCaseIndex:N,caseDetails:J,nextCase:z,prevCase:q,isLoading:Ee,setCurrentCaseIndex:ae,isValidating:H,handleSectionClick:kr,projectId:we,onDocumentView:d}),u.jsx("div",{className:"h-8"})]})},qq=oS("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),US=w.forwardRef(({className:r,variant:e,...t},n)=>u.jsx("div",{ref:n,role:"alert",className:jr(qq({variant:e}),r),...t}));US.displayName="Alert";const Kq=w.forwardRef(({className:r,...e},t)=>u.jsx("h5",{ref:t,className:jr("mb-1 font-medium leading-none tracking-tight",r),...e}));Kq.displayName="AlertTitle";const zS=w.forwardRef(({className:r,...e},t)=>u.jsx("div",{ref:t,className:jr("text-sm [&_p]:leading-relaxed",r),...e}));zS.displayName="AlertDescription";const $v="src/shared/components/sidepanel/panels/components/ClioContactCreation.tsx",p1=r=>{if(!r||r.trim()==="")return!0;if(!/^[\d\s+().-]+$/.test(r))return!1;const t=r.replace(/\D/g,"");return t.length>=7&&t.length<=15},Yq=({emailParticipants:r,emailParticipantClients:e,getClientNameFromCache:t,onContactsCreated:n})=>{const s=Gr(),[i,c]=w.useState([]),[d,m]=w.useState(!1),[p,v]=w.useState(!1),[x,b]=w.useState([]),[S,N]=w.useState({}),[E,T]=w.useState([]),[A,R]=w.useState(!1),[F,j]=w.useState(null),[L,G]=w.useState(!1),z=w.useCallback(ee=>{const se=ee.toLowerCase();return e.some(de=>de.toLowerCase()===se)},[e]);w.useEffect(()=>{const ee=r.map((se,de)=>{const Y=z(se);let J="";if(Y){const $=t(se);$&&(J=$)}return J||(J=se.split("@")[0].split(".").map(X=>X.charAt(0).toUpperCase()+X.slice(1).toLowerCase()).join(" ")),{id:`participant-${de}`,name:J,email:se,inClio:Y}});c(ee),s.debug("Participants initialized with Clio status",{sourceFile:$v,totalParticipants:ee.length,inClio:ee.filter(se=>se.inClio).length,notInClio:ee.filter(se=>!se.inClio).length})},[r,e,s,z,t]);const q=i.some(ee=>!ee.inClio),ae=()=>{m(!0),v(!1);const ee={};i.forEach(se=>{if(!se.inClio){const de=se.name.split(" ");ee[se.id]={firstName:de[0]||"",lastName:de.slice(1).join(" ")||"",email:se.email,phoneNumber:"",type:"person",companyName:""}}}),N(ee)},oe=()=>{m(!1),b([]),j(null)},fe=ee=>{b(se=>se.includes(ee)?se.filter(de=>de!==ee):[...se,ee])},H=(ee,se,de)=>{N(Y=>({...Y,[ee]:{...Y[ee],[se]:de}}))},me=async()=>{var ee,se,de;R(!0),j(null);for(const Y of x){const J=S[Y];if(!J){j({type:"validation",message:"Contact data is missing. Please try again."}),R(!1);return}if(J.type==="person"){if(!((ee=J.firstName)!=null&&ee.trim())||!((se=J.lastName)!=null&&se.trim())){j({type:"validation",message:"First and Last name is required for person contacts."}),R(!1);return}}else if(J.type==="company"&&!((de=J.companyName)!=null&&de.trim())){j({type:"validation",message:"Company name is required for company contacts."}),R(!1);return}if(J!=null&&J.phoneNumber&&!p1(J.phoneNumber)){j({type:"validation",message:"Invalid phone number. Please enter 7-15 digits with optional formatting (+, -, spaces, parentheses)."}),R(!1);return}}try{const Y=[];for(const $ of x){const X=i.find(U=>U.id===$),O=S[$];if(!(!X||!O))try{const U=await f8(O,s),re=O.type==="company"?O.companyName||"":`${O.firstName||""} ${O.lastName||""}`.trim();Y.push({id:U.id,name:re||X.name,email:X.email}),s.info("Contact created successfully in Clio",{sourceFile:$v,email:X.email})}catch(U){if(s.error("Error creating contact in Clio",U,{sourceFile:$v,email:X.email}),U instanceof Error&&(U.message.includes("duplicate")||U.message.includes("already exists")?j({type:"duplicate",message:"A contact with this email already exists in Clio."}):U.message.includes("permission")?j({type:"permission",message:"You do not have permission to create contacts in Clio. Contact your admin."}):j({type:"network",message:"Something went wrong. Please try again."})),Y.length>0){const re=[...E,...Y];T(re),c(ne=>ne.map(we=>{const K=Y.find(he=>he.email.toLowerCase()===we.email.toLowerCase());return K?{...we,inClio:!0,name:K.name}:we}));const Ee=Y.map(ne=>{var we;return(we=i.find(K=>K.email.toLowerCase()===ne.email.toLowerCase()))==null?void 0:we.id}).filter(Boolean);b(ne=>ne.filter(we=>!Ee.includes(we))),n&&n(re)}R(!1);return}}G(!0);const J=[...E,...Y];T(J),m(!1),b([]),R(!1),c($=>$.map(X=>{const O=Y.find(U=>U.email.toLowerCase()===X.email.toLowerCase());return O?{...X,inClio:!0,name:O.name}:X})),n&&n(J)}catch(Y){s.error("Unexpected error in contact creation flow",Y,{sourceFile:$v}),j({type:"network",message:"Something went wrong. Please try again."}),R(!1)}};return i.length===0||!q&&E.length===0?null:u.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700",children:u.jsxs("div",{className:"p-4",children:[!L&&u.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 border border-gray-300 dark:border-gray-600 rounded-md p-4",children:[u.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:"Some email participants are not contacts in Clio."}),q&&!d&&u.jsxs("div",{className:"flex items-center gap-3 mt-3",children:[u.jsx(We,{onClick:ae,size:"sm",className:"h-9",children:"Add to Clio"}),u.jsx("button",{onClick:()=>v(!p),className:"text-sm text-blue-600 dark:text-blue-400 hover:underline",children:"How this works"})]}),p&&u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-3 leading-relaxed",children:"Create a Clio contact from email participants so Candle can show client and matter context."}),d&&u.jsxs("div",{className:"mt-4 border-t dark:border-gray-700 pt-4",children:[u.jsx("h4",{className:"text-sm font-semibold text-gray-800 dark:text-gray-200 mb-1",children:"Add contact to Clio"}),u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-4",children:"Select people on this email thread"}),F&&u.jsx("div",{role:"alert","aria-live":"assertive",className:"mb-4",children:u.jsx("div",{className:"flex items-start bg-red-50 dark:bg-red-950/30 border border-red-200 dark:border-red-800 text-red-900 dark:text-red-100 rounded-md p-3",children:u.jsxs("div",{className:"flex-1",children:[u.jsx("p",{className:"text-sm",children:F.message}),F.type==="network"&&u.jsx("div",{className:"mt-2",children:u.jsx(We,{onClick:me,size:"sm",variant:"destructive",className:"h-7 text-xs",children:"Retry"})})]})})}),u.jsx("div",{className:"space-y-2 mb-4",children:i.map(ee=>u.jsxs("div",{className:`flex items-center gap-3 p-3 border dark:border-gray-600 rounded-md ${ee.inClio?"bg-gray-50 dark:bg-gray-800 opacity-60":"bg-white dark:bg-gray-900"}`,children:[u.jsx("input",{type:"checkbox",checked:x.includes(ee.id),onChange:()=>fe(ee.id),disabled:ee.inClio,className:"h-4 w-4 text-blue-600"}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate",children:ee.name}),u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:ee.email})]}),u.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${ee.inClio?"bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-400 border border-green-300 dark:border-green-800":"bg-orange-100 dark:bg-orange-900/30 text-orange-800 dark:text-orange-400 border border-orange-300 dark:border-orange-800"}`,children:ee.inClio?"In Clio":"Not in Clio"})]},ee.id))}),x.length>0&&u.jsx("div",{className:"border-t dark:border-gray-700 pt-4 space-y-4",children:x.map(ee=>{const se=i.find(Y=>Y.id===ee),de=S[ee]||{};return se?u.jsxs("div",{className:"space-y-3",children:[u.jsx("div",{className:"text-sm font-semibold text-gray-800 dark:text-gray-200",children:se.name}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Contact type"}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{onClick:()=>H(ee,"type","person"),className:`flex-1 px-3 py-2 text-sm border rounded transition-colors ${de.type==="person"?"bg-blue-600 dark:bg-blue-700 text-white border-blue-600 dark:border-blue-700":"bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 border-gray-300 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:"Person"}),u.jsx("button",{onClick:()=>H(ee,"type","company"),className:`flex-1 px-3 py-2 text-sm border rounded transition-colors ${de.type==="company"?"bg-blue-600 dark:bg-blue-700 text-white border-blue-600 dark:border-blue-700":"bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 border-gray-300 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:"Company"})]})]}),de.type==="person"?u.jsxs(u.Fragment,{children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"First name"}),u.jsx(vn,{type:"text",value:de.firstName||"",onChange:Y=>H(ee,"firstName",Y.target.value),className:"h-9 text-sm"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Last name"}),u.jsx(vn,{type:"text",value:de.lastName||"",onChange:Y=>H(ee,"lastName",Y.target.value),className:"h-9 text-sm"})]})]}):u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Company name"}),u.jsx(vn,{type:"text",value:de.companyName||"",onChange:Y=>H(ee,"companyName",Y.target.value),className:"h-9 text-sm"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Phone number (optional)"}),u.jsx(vn,{type:"tel",value:de.phoneNumber||"",onChange:Y=>H(ee,"phoneNumber",Y.target.value),placeholder:"+1 (555) 123-4567",className:"h-9 text-sm"}),de.phoneNumber&&!p1(de.phoneNumber)&&u.jsx("p",{className:"text-xs text-red-600 dark:text-red-400 mt-1",children:"Please enter a valid phone number (7-15 digits)"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Email"}),u.jsx(vn,{type:"text",value:de.email||"",readOnly:!0,disabled:!0,className:"h-9 text-sm"})]})]},ee):null})}),u.jsxs("div",{className:"flex gap-2 mt-4 pt-4 border-t dark:border-gray-700",children:[u.jsx(We,{onClick:me,disabled:x.length===0||A,size:"sm",className:"h-9",children:A?"Creating...":"Create contact"}),u.jsx(We,{onClick:oe,variant:"outline",size:"sm",className:"h-9",children:"Cancel"})]})]})]}),L&&u.jsxs("div",{className:"bg-green-50 dark:bg-green-900/30 border border-green-200 dark:border-green-700 rounded-md p-4",children:[u.jsx("h4",{className:"text-sm font-semibold text-green-900 dark:text-green-100 mb-2",children:"This contact has been added in Clio"}),u.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mb-2",children:"Clio may take a few minutes to show updates."}),u.jsx("div",{className:"space-y-2",children:E.map(ee=>u.jsxs("div",{className:"flex items-center justify-between p-2 bg-white dark:bg-gray-800 rounded-md border border-gray-200 dark:border-gray-600",children:[u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate",children:ee.name}),u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:ee.email})]}),u.jsx("span",{className:"px-2 py-1 text-xs bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-400 border border-green-300 dark:border-green-800 rounded-full",children:"In Clio"})]},ee.id))}),u.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-3",children:"Go to the Matter section below to link this contact to a matter."}),q&&u.jsx(We,{onClick:()=>{G(!1),m(!0)},size:"sm",variant:"outline",className:"h-8 text-xs mt-3",children:"Add more contacts"})]})]})})},Jq=({clientEmail:r,emailParticipants:e,emailParticipantClients:t,currentClientIndex:n,setCurrentClientIndex:s,setClientEmail:i,isManuallySet:c,selectedClientDetails:d,linkableFields:m,isLoading:p,ClientNavigation:v,handleSectionClick:x,tempClientEmail:b,setTempClientEmail:S,setIsManuallySet:N,isValidClient:E,isTempEmailValid:T,showClientDocumentsButton:A,isValidating:R,fetchError:F=!1,isRateLimited:j=!1,hasTransientError:L=!1,onContactsCreated:G,getClientNameFromCache:z,isClientDataValidationComplete:q})=>{var ee;Gr();const ae=()=>u.jsx(Bs,{rows:2}),oe=(ee=m.find(se=>se.field==="Name"))==null?void 0:ee.url,fe=()=>u.jsxs("div",{className:"flex items-center px-3 py-1 bg-gray-50 dark:bg-gray-800 border-b dark:border-gray-700 gap-2",children:[u.jsx("div",{className:"flex-1 min-w-0 flex items-center",children:u.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-300 truncate",title:b||"",children:[b," (Manually set)"]})}),oe&&u.jsxs("a",{href:oe,target:"_blank",rel:"noopener noreferrer",className:"h-8 text-xs text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 border border-blue-200 dark:border-blue-800 px-3 flex-shrink-0 rounded-md inline-flex items-center gap-1 no-underline hover:no-underline",children:[u.jsx(Va,{className:"w-3 h-3"}),"View"]})]}),H=()=>u.jsx(Ql,{details:d}),me=()=>{let se="Select a client email thread to view client information";return c&&r?se=`No client information found for ${r}`:e.length>0&&(t.length===0?se=`No client information available for emails on the selected thread: ${e.join(", ")}`:se="No client information available for the selected email ID"),u.jsx("div",{className:"p-3 text-sm text-gray-600 dark:text-gray-400",children:u.jsx("p",{className:"mb-2",children:se})})};return u.jsxs("div",{className:"w-full min-h-[4rem] border border-border/50 rounded-lg shadow-sm bg-card text-card-foreground",title:"Client Information",children:[u.jsxs("div",{className:"flex items-center justify-between p-2 border-b bg-muted",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(Ey,{className:"w-3.5 h-3.5 text-slate-600 dark:text-gray-300"}),u.jsx("span",{className:"font-medium text-sm text-slate-800 dark:text-white",children:"CONTACT"})]}),u.jsxs(jo,{children:[u.jsx(Oo,{asChild:!0,children:u.jsx(We,{variant:"ghost",size:"icon",className:"h-6 w-6 hidden",children:u.jsx(Ri,{className:"h-4 w-4"})})}),u.jsx(co,{align:"end",className:"p-2",children:u.jsx("div",{className:"flex flex-col gap-2 w-64",children:u.jsxs("div",{className:"flex gap-2 items-center",children:[u.jsx(vn,{type:"email",value:b||"",onChange:se=>S(se.target.value),placeholder:"Set client email",className:`flex-1 px-2 py-1 h-8 text-xs ${T===!1?"border-red-300 focus:ring-red-500":""}`}),u.jsx(We,{variant:"outline",size:"sm",className:`h-8 text-xs px-2 ${T===!1?"bg-red-50 hover:bg-red-100":""}`,onClick:()=>{i(b||""),N(!0)},disabled:!b,title:T===!1?"Warning: This email is not recognized as a valid client in Clio":"Set email as current client",children:"Search"})]})})})]})]}),p?ae():F?u.jsxs("div",{className:"flex items-center gap-1.5 px-3 py-2 text-xs text-amber-700 dark:text-amber-400",children:[u.jsx(nh,{className:"h-3.5 w-3.5 flex-shrink-0"}),u.jsx("span",{children:j?"Failed to refresh. Please try again later.":"Failed to fetch contact data. Please try again later."})]}):u.jsxs(u.Fragment,{children:[j&&u.jsxs("div",{className:"flex items-center gap-1.5 px-3 py-2 text-xs text-amber-700 dark:text-amber-400",children:[u.jsx(nh,{className:"h-3.5 w-3.5 flex-shrink-0"}),u.jsx("span",{children:"Failed to refresh. Try again later."})]}),t.length>0&&!c&&u.jsx(v,{clientUrl:oe}),c&&r&&u.jsx(fe,{}),d&&Object.keys(d).length>0?u.jsx(H,{}):R&&!c?u.jsx(Bs,{rows:2}):L&&!c?u.jsx("div",{className:"flex justify-center p-2",children:u.jsxs(US,{variant:"default",className:"w-full border-amber-200 bg-amber-50 dark:border-amber-800 dark:bg-amber-950",children:[u.jsx(nh,{className:"h-4 w-4 text-amber-600 dark:text-amber-400"}),u.jsx(zS,{className:"ml-2 text-amber-800 dark:text-amber-200",children:"Failed to fetch contact data. Please try again later."})]})}):u.jsx(me,{})]}),q&&!c&&!L&&e.length!==t.length&&z&&u.jsx(Yq,{emailParticipants:e,emailParticipantClients:t,getClientNameFromCache:z,onContactsCreated:G})]})},Uv="src/shared/components/sidepanel/panels/components/ClioMatterLinking.tsx",pw=({createdContacts:r,onMatterLinked:e})=>{const t=Gr(),[n,s]=w.useState(!1),[i,c]=w.useState(""),[d,m]=w.useState(!1),[p,v]=w.useState(null),[x,b]=w.useState([]),[S,N]=w.useState([]),[E,T]=w.useState({}),[A,R]=w.useState(!1),[F,j]=w.useState(null),[L,G]=w.useState(null),[z,q]=w.useState(!1),ae=()=>{s(!0),j(null),N(r.map(se=>se.id))},oe=()=>{s(!1),c(""),m(!1),v(null),j(null),T({})},fe=async se=>{if(c(se),m(!0),!se){v(null),b([]);return}if(se.length<3){b([]);return}q(!0);try{const Y=((await q_("clio",se,t)).projects||[]).map(J=>{var $;return{id:String((($=J.projectId)==null?void 0:$.native)||""),name:J.projectName||"",status:J.isArchived?"closed":"open",description:J.projectName||""}});b(Y)}catch(de){t.error("Error searching matters",de,{sourceFile:Uv,searchQuery:se})}finally{q(!1)}},H=se=>{v(se),c(se.name),m(!1)},me=se=>{N(de=>de.includes(se)?de.filter(Y=>Y!==se):[...de,se])},ee=async()=>{if(p){R(!0),j(null);try{const se=[];for(const de of S){const Y=E[de]||"Related Contact";try{await h8("clio",de,p.id,Y,t),se.push(de),t.info("Contact linked to matter successfully",{sourceFile:Uv})}catch(J){t.error("Error linking contact to matter",J,{sourceFile:Uv}),J instanceof Error&&(J.message.includes("permission")?j({type:"permission",message:"You do not have permission to modify matters in Clio. Contact your admin."}):j({type:"network",message:"Something went wrong. Please try again."})),se.length>0&&(N($=>$.filter(X=>!se.includes(X))),e&&e(p.id)),R(!1);return}}G(p),s(!1),R(!1),e&&e(p.id)}catch(se){t.error("Unexpected error in matter linking flow",se,{sourceFile:Uv}),j({type:"network",message:"Something went wrong. Please try again."}),R(!1)}}};return u.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700",children:u.jsxs("div",{className:"p-2",children:[!n&&!L&&u.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 border border-gray-300 dark:border-gray-600 rounded-md p-4",children:[u.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:"Link the created contact(s) to a matter as related contacts."}),u.jsx(We,{onClick:ae,size:"sm",className:"h-9",children:"Add to a matter"})]}),n&&u.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 border border-gray-300 dark:border-gray-600 rounded-md p-4",children:[u.jsx("h4",{className:"text-sm font-semibold text-gray-800 dark:text-gray-200 mb-1",children:"Link matter as a related contact"}),u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-4",children:"Add as a related contact in Clio"}),F&&u.jsx("div",{role:"alert","aria-live":"assertive",className:"mb-4",children:u.jsx("div",{className:"flex items-start bg-red-50 dark:bg-red-950/30 border border-red-200 dark:border-red-800 text-red-900 dark:text-red-100 rounded-md p-3",children:u.jsxs("div",{className:"flex-1",children:[u.jsx("p",{className:"text-sm",children:F.message}),F.type==="network"&&u.jsx("div",{className:"mt-2",children:u.jsx(We,{onClick:ee,size:"sm",variant:"destructive",className:"h-7 text-xs",children:"Retry"})})]})})}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Matter"}),u.jsx(vn,{type:"text",placeholder:"Search matters...",value:i,onChange:se=>fe(se.target.value),onFocus:()=>m(!0),className:"h-9 text-sm"}),d&&i&&x.length>0&&u.jsx("div",{className:"mt-1 max-h-48 overflow-y-auto border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 shadow-lg",children:x.map(se=>u.jsxs("div",{onClick:()=>H(se),className:"flex items-center justify-between p-3 hover:bg-gray-50 dark:hover:bg-gray-700 cursor-pointer border-b dark:border-gray-600 last:border-b-0",children:[u.jsx("div",{className:"text-sm text-gray-900 dark:text-gray-100 flex-1 truncate",children:se.name}),u.jsx("span",{className:`ml-2 px-2 py-1 text-xs rounded-full ${se.status==="open"?"bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-400 border border-blue-300 dark:border-blue-800":"bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-300 border border-gray-300 dark:border-gray-700"}`,children:se.status==="open"?"Open":"Closed"})]},se.id))}),z&&u.jsx("div",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400",children:"Searching matters..."})]}),p&&u.jsx(u.Fragment,{children:u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Related contact(s) to add"}),r.map(se=>u.jsxs("div",{className:"mb-4",children:[u.jsxs("div",{className:"flex items-center gap-3 p-3 border dark:border-gray-600 rounded-md bg-white dark:bg-gray-800",children:[u.jsx("input",{type:"checkbox",checked:S.includes(se.id),onChange:()=>me(se.id),className:"h-4 w-4 text-blue-600"}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate",children:se.name}),u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:se.email})]})]}),S.includes(se.id)&&u.jsxs("div",{className:"mt-2",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Relationship"}),u.jsx(vn,{type:"text",placeholder:"e.g., Opposing Counsel, Co-Counsel, Employee",value:E[se.id]||"",onChange:de=>T(Y=>({...Y,[se.id]:de.target.value})),className:"h-9 text-sm"})]})]},se.id))]})}),u.jsxs("div",{className:"flex gap-2 pt-4 border-t dark:border-gray-700",children:[u.jsx(We,{onClick:ee,disabled:!p||S.length===0||A,size:"sm",className:"h-9",children:A?"Saving...":"Save"}),u.jsx(We,{onClick:oe,variant:"outline",size:"sm",className:"h-9",children:"Back"})]})]}),L&&!n&&u.jsxs("div",{className:"bg-green-50 dark:bg-green-900/30 border border-green-200 dark:border-green-700 rounded-md p-4",children:[u.jsx("h4",{className:"text-sm font-semibold text-green-900 dark:text-green-100 mb-3",children:"Added to matter"}),u.jsx("div",{className:"mb-3 p-3 bg-white dark:bg-gray-800 rounded-md border border-gray-200 dark:border-gray-600",children:u.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:L.name})}),u.jsx("div",{className:"space-y-2 mb-3",children:r.filter(se=>S.includes(se.id)).map(se=>u.jsxs("div",{className:"flex items-center justify-between p-2 bg-white dark:bg-gray-800 rounded-md border border-gray-200 dark:border-gray-600",children:[u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate",children:se.name}),u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:E[se.id]||"Related contact"})]}),u.jsxs("a",{href:`https://app.clio.com/nc#/contacts/${se.id}`,target:"_blank",rel:"noopener noreferrer",className:"h-7 text-xs text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 border border-blue-200 dark:border-blue-800 px-2 flex-shrink-0 rounded-md inline-flex items-center gap-1 no-underline hover:no-underline ml-2",children:[u.jsx(Va,{className:"w-3 h-3"}),"View"]})]},se.id))}),u.jsx("div",{className:"flex gap-2",children:u.jsx(We,{onClick:()=>{G(null),s(!0),v(null),c(""),T({})},variant:"outline",size:"sm",className:"h-9 whitespace-nowrap",children:"Link another matter"})})]})]})})},Ml="src/shared/components/sidepanel/panels/components/ClioCaseInfoBox.tsx",Xq=({clientEmail:r,selectedCaseDetails:e,casesForCurrentClient:t,currentCaseIndex:n,linkableFields:s,nextCase:i,prevCase:c,isLoading:d,isManuallySet:m,setCurrentCaseIndex:p,calendarEntries:v=[],isValidating:x=!1,caseUrl:b,matterId:S,onMatterManuallySelected:N,fetchError:E=!1,isRateLimited:T=!1,hasTransientError:A=!1,userData:R,createdContacts:F=[],onMatterLinked:j,pageSize:L=5,currentPage:G=1,totalMatters:z,onNavigateToPage:q,allMatterSummaries:ae=[],isLoadingMatterDetails:oe=!1,matterDetailError:fe=!1})=>{var Uo,$i;const H=Gr(),me=ua(),[ee,se]=w.useState(!1),[de,Y]=w.useState(!1),[J,$]=w.useState(!1),[X,O]=w.useState(!1),[U,re]=w.useState(""),[Ee,ne]=w.useState(!1),we=w.useRef(!1),[K,he]=w.useState(""),[be,Ie]=w.useState([]),[_t,Be]=w.useState(!1),[Ge,qe]=w.useState(!1),[Ne,St]=w.useState(null),[ct,Ct]=w.useState(null),Gt=w.useMemo(()=>{if(ae.length>0&&S){const _e=ae.findIndex(Me=>Me.id===S);if(_e!==-1)return _e+1}return(G-1)*L+n+1},[ae,S,G,L,n]),[$t,Kt]=w.useState(!1),[hr,Ur]=w.useState(""),[zr,kr]=w.useState(""),[ge,Pe]=w.useState(new Date().toISOString().split("T")[0]),[pt,wt]=w.useState("Normal"),[ze,He]=w.useState(!1),[rt,Re]=w.useState(!1),[ft,Mt]=w.useState(!1),Ue=w.useRef(!1),rr=w.useRef(null),kt=w.useRef(!1),[vr,nr]=w.useState(null),[Jt,$n]=w.useState(null),[Un,Gs]=w.useState(!0),[Cs,Tr]=w.useState(!1),[yn,go]=w.useState(""),[Mo,En]=w.useState([]),[Ws,Vs]=w.useState(!1),[Li,cn]=w.useState(!1),[ce,Ve]=w.useState(null),[gt,mt]=w.useState(""),[ut,yt]=w.useState(""),[ht,Xt]=w.useState(!1),[Yn,Qr]=w.useState(1),[ur,at]=w.useState("Days"),[Q]=w.useState("Email"),[Le,nt]=w.useState(!1),[Fr,Yt]=w.useState(!0),[Wr,fn]=w.useState(!0),[ls,ks]=w.useState(!0),[Mi,Vr]=w.useState(!1),[$o,Jn]=w.useState(""),[nu,Ns]=w.useState(""),[ma,su]=w.useState(new Date().toISOString().split("T")[0]),[ou,li]=w.useState(!1),[ci,qs]=w.useState(null),Ks=()=>{Ur(""),kr(""),Pe(new Date().toISOString().split("T")[0]),wt("Normal"),mt((R==null?void 0:R.id)||""),yt((R==null?void 0:R.name)||""),go(""),En([]),Ve(null),Xt(!1),Qr(1),at("Days"),Ue.current=!1,nr(null),Gs(!0),Yt(!0),fn(!0)},iu=()=>{Jn(""),Ns(""),su(new Date().toISOString().split("T")[0]),qs(null)};w.useEffect(()=>{$n(null)},[S]),w.useEffect(()=>{if(!vr)return;const _e=setTimeout(()=>nr(null),5e3);return()=>clearTimeout(_e)},[vr]),w.useEffect(()=>{if(!ci)return;const _e=setTimeout(()=>qs(null),5e3);return()=>clearTimeout(_e)},[ci]),w.useEffect(()=>{const _e=!!(gt&&(R!=null&&R.id)&&gt!==R.id);ks(!_e)},[gt,R]),w.useEffect(()=>{F&&F.length>0?Tr(!0):Tr(!1)},[F]),w.useEffect(()=>{S||(Ks(),Kt(!1)),$t||(Ue.current=!1)},[$t,S]),w.useEffect(()=>{$t&&R&&!gt&&(mt(R.id),yt(R.name))},[$t,R,gt]);const Sh=w.useMemo(()=>ry.debounce(async _e=>{if(!_e.trim()||_e.length<2){En([]),Ve(null);return}Vs(!0),Ve(null);try{const Me=await wT(H),Ke=_e.toLowerCase();if(Me){const At=Me.filter(Nt=>Nt.name.toLowerCase().includes(Ke)).sort((Nt,Ut)=>{const st=Nt.name.toLowerCase().startsWith(Ke),it=Ut.name.toLowerCase().startsWith(Ke);return st!==it?st?-1:1:Nt.name.localeCompare(Ut.name)});En(At),At.length===0&&Ve(`No users found for "${_e}"`)}else{kt.current||(kt.current=!0,jT("clio",H).then(Nt=>xT(Nt.map(({id:Ut,name:st})=>({id:Ut,name:st})),H)).catch(Nt=>H.error("Failed to refresh firm users cache",Nt,{sourceFile:Ml})).finally(()=>{kt.current=!1}));const At=await l8("clio",_e,H);En((At.users||[]).map(({id:Nt,name:Ut})=>({id:Nt,name:Ut}))),(At.users||[]).length===0&&Ve(`No users found for "${_e}"`)}}catch(Me){H.error("Assignee search failed",Me,{sourceFile:Ml}),Ve("Failed to search users. Please try again."),En([])}finally{Vs(!1)}},400),[H]);w.useEffect(()=>{const _e=async Me=>{if(!Me){Ks(),Kt(!1);return}if(Me.threadId!=rr.current){Ks(),Kt(!1),rr.current=String(Me.threadId),$n(null);return}};return me&&(me.onThreadChanged(_e),me.getCurrentThread().then(Me=>{_e(Me)}).catch(Me=>{H.error("Error getting initial thread",Me,{sourceFile:"ClioCaseInfoBox.tsx"})})),()=>{me==null||me.removeThreadListener(_e)}},[me,H]),w.useEffect(()=>{(async()=>{var Me;if($t&&!Ue.current){Ue.current=!0,He(!0);try{const Ke=await me.getCurrentThread();if(Ke&&((Me=Ke==null?void 0:Ke.messages)==null?void 0:Me.length)>0){const At=Ke.messages[Ke.messages.length-1].subject,Nt=Ke.messages[Ke.messages.length-1].body,Ut="Subject: "+At+`
Body: `+Nt,st=await c8("clio",Ut,H);Ur(st.name),kr(st.description)}}catch(Ke){H.error("Failed to generate task description",Ke,{sourceFile:Ml})}finally{He(!1)}}})()},[$t,me,H]);const Zl=async()=>{var Ke;nr(null);const _e=[];if(hr.trim()||_e.push("Task Name"),zr.trim()||_e.push("Task Description"),S||_e.push("Matter"),gt||_e.push("Assign To"),(!ge||!/^\d{4}-\d{2}-\d{2}$/.test(ge)||Number.isNaN(Date.parse(ge)))&&_e.push("Date"),_e.length>0){nr({type:"error",text:`Please fill in the following fields: ${_e.join(", ")}`});return}Re(!0);try{const At=ge?new Date(ge).toISOString():null;let Nt=zr;if(Un){const it=await me.getCurrentThread();if(!it||((Ke=it==null?void 0:it.messages)==null?void 0:Ke.length)<1){nr({type:"error",text:"Something went wrong. Please try again"});return}const Xn=it.messages[it.messages.length-1].body;Nt=zr+`

Referenced Email Below

`+Xn}await u8("clio",hr,Nt,S,At,pt,H,gt||void 0,ht?{value:Yn,unit:ur,method:Q,assigneeId:gt||void 0}:void 0,ls?void 0:{notifyAssignee:Fr,notifyCompletion:Wr}),Ks(),Kt(!1),nr({type:"success",text:"Task created successfully!"}),$n({name:hr,description:zr,due_at:ge,priority:pt})}catch(At){H.error("Failed to create task",At,{sourceFile:Ml}),nr({type:"error",text:"Failed to create task. Please try again."})}finally{Re(!1)}},au=async()=>{li(!0),qs(null);const _e=[];if($o.trim()||_e.push("Subject"),nu.trim()||_e.push("Note"),S||_e.push("Matter"),(!ma||!/^\d{4}-\d{2}-\d{2}$/.test(ma)||Number.isNaN(Date.parse(ma)))&&_e.push("Date"),_e.length>0){qs({type:"error",text:`Please fill in: ${_e.join(", ")}`}),li(!1);return}try{const Ke=await d8("clio",$o,nu,ma,S,null,H);H.info("Note created successfully",{sourceFile:Ml,noteId:Ke.noteId}),iu(),Vr(!1),qs({type:"success",text:"Note created successfully!"})}catch(Ke){H.error("Error creating note",Ke,{sourceFile:Ml}),qs({type:"error",text:Ke instanceof Error?Ke.message:"Failed to create note"})}finally{li(!1)}};w.useMemo(()=>{if(!U.trim())return t;const _e=U.toLowerCase();return t.filter(Me=>String(Me.description||"").toLowerCase().includes(_e))},[t,U]);const tl=_e=>{if(ne(_e),we.current){_e&&(we.current=!1);return}const Me=ct||S;if(_e&&ae.length>0&&Me){const Ke=ae.findIndex(At=>At.id===Me);if(Ke!==-1){const At=Math.floor(Ke/L)+1;At!==G&&q&&q(At)}}_e||re("")},rl=w.useMemo(()=>ry.debounce(async _e=>{if(!_e.trim()||_e.length<2){Ie([]),St(null);return}Be(!0),St(null);try{const Me=await q_("clio",_e,H);Ie(Me.projects||[]),Me.projects.length===0&&St(`No matters found for "${_e}"`)}catch(Me){H.error("Matter search failed",Me,{sourceFile:Ml}),St("Failed to search matters. Please try again."),Ie([])}finally{Be(!1)}},400),[H]),vd=_e=>{var Me,Ke;try{const At={id:((Ke=(Me=_e.projectId)==null?void 0:Me.native)==null?void 0:Ke.toString())||"",description:_e.projectName||"",practice_area:_e.projectTypeName||"",matter_stage:_e.phaseName||"",status:_e.isArchived?"Closed":"Open",client_name:_e.clientName||"",responsible_attorney:_e.firstPrimaryName||"",url:_e.projectUrl||"",name:_e.projectName||""};H.info("Matter manually selected via search",{matterId:At.id,matterName:At.description,sourceFile:Ml}),N&&N(At),qe(!1),he(""),Ie([]),St(null)}catch(At){H.error("Failed to select matter",At,{sourceFile:Ml})}},nl=()=>u.jsx(Bs,{rows:2}),yr=_e=>{if(Ct(null),p)p(_e);else if(_e>n)for(let Me=n;Me<_e;Me++)i();else if(_e<n)for(let Me=n;Me>_e;Me--)c()},Ys=_e=>{try{const Me=_e.split("T")[0];if(!Me)return _e;const[Ke,At,Nt]=Me.split("-").map(Number);return isNaN(Ke)||isNaN(At)||isNaN(Nt)||At<1||At>12?_e:`${["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][At-1]} ${Nt}, ${Ke}`}catch{return _e}},sl=_e=>{try{const Me=_e.split("T")[1];if(!Me)return"";const Ke=Me.split(/[Z+-]/)[0],[At,Nt]=Ke.split(":").map(Number);if(isNaN(At)||isNaN(Nt))return"";const Ut=At>=12?"PM":"AM",st=At%12||12,it=Nt.toString().padStart(2,"0");return`${st}:${it} ${Ut}`}catch{return""}},ec=_e=>_e?(new DOMParser().parseFromString(_e,"text/html").body.textContent||"").length>200:!1,lu=_e=>{const Me=["a","b","br","div","em","i","li","ol","p","s","strong","u","ul"],Ke=["href","rel","type","target"],Nt=new DOMParser().parseFromString(_e,"text/html"),Ut=Nt.body.getElementsByTagName("*");for(let st=Ut.length-1;st>=0;st--){const it=Ut[st];Me.includes(it.tagName.toLowerCase())?Array.from(it.attributes).forEach(Js=>{Ke.includes(Js.name.toLowerCase())||it.removeAttribute(Js.name)}):it.replaceWith(document.createTextNode(it.textContent||""))}return Nt.body.innerHTML},cu=()=>{if(!t.length||n>=t.length)return[];const _e=t[n],Me=String(_e.id||"");return Me?v.filter(Ke=>{var Nt;return String(((Nt=Ke.matter)==null?void 0:Nt.id)||Ke.case_id||"")===Me}):[]},uu=_e=>{const Me=String(_e.start_at||_e.date||"");if(!Me)return!1;try{return new Date(Me)>=new Date}catch{return!1}},tc=()=>{const Me=cu().filter(uu).sort((Ke,At)=>{const Nt=new Date(String(Ke.start_at||Ke.date||"")),Ut=new Date(String(At.start_at||At.date||""));return Nt.getTime()-Ut.getTime()});return Me.length>0?[Me[0]]:Me},ol=()=>{const _e=tc(),Me=t.length>0&&n<t.length?t[n]:null,Ke=Me==null?void 0:Me.id,At=Ke?`https://app.clio.com/nc/#/matters/${Ke}/calendar`:null;return u.jsxs("div",{className:"border-t bg-card",children:[u.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800",children:[u.jsxs("div",{className:"flex items-center gap-2 cursor-pointer flex-1 hover:opacity-80 transition-opacity",onClick:()=>se(!ee),children:[u.jsx(zf,{className:"w-4 h-4 text-slate-600 dark:text-gray-300"}),u.jsx("span",{className:"font-medium text-sm text-slate-800 dark:text-white",children:"Next Event"}),_e.length>0&&!d&&(ee?u.jsx(Kv,{className:"w-4 h-4 text-gray-400"}):u.jsx(xs,{className:"w-4 h-4 text-gray-400"}))]}),At&&u.jsxs("a",{href:At,target:"_blank",rel:"noopener noreferrer",className:"h-7 text-xs text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 border border-blue-200 dark:border-blue-800 px-2 flex-shrink-0 rounded-md inline-flex items-center gap-1 no-underline hover:no-underline",onClick:Nt=>Nt.stopPropagation(),children:[u.jsx(Va,{className:"w-3 h-3"}),"View all"]})]}),!ee&&u.jsx(u.Fragment,{children:d?u.jsx(Bs,{rows:2}):_e.length>0?u.jsx("div",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:_e.map((Nt,Ut)=>{const st=String(Nt.start_at||Nt.date||""),it=String(Nt.end_at||""),Xn=String(Nt.summary||Nt.title||"Calendar Event"),Js=String(Nt.location||"");return u.jsxs("div",{className:"p-3 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:[u.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-gray-100 mb-1",children:Xn}),u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"space-y-1",children:[u.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600 dark:text-gray-400",children:[u.jsx(zf,{className:"w-3 h-3"}),u.jsx("span",{children:Ys(st)})]}),Js&&u.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600 dark:text-gray-400",children:[u.jsx(pB,{className:"w-3 h-3"}),u.jsx("span",{children:Js})]})]}),u.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600 dark:text-gray-400",children:[u.jsx(Rv,{className:"w-3 h-3"}),u.jsxs("span",{children:[sl(st),it&&` - ${sl(it)}`]})]})]})]},Ut)})}):u.jsx("div",{className:"p-3 text-sm text-gray-600 dark:text-gray-400",children:r&&t.length>0?u.jsx(u.Fragment,{children:u.jsx("p",{className:"mb-2",children:"No upcoming calendar entries found for this case"})}):"Select a client email thread to view calendar entries"})})]})},ui=()=>{const _e=t.length>0&&n<t.length?t[n]:null,Me=_e==null?void 0:_e.last_completed_task,Ke=_e==null?void 0:_e.next_upcoming_task,At=Me||Ke,Nt=_e==null?void 0:_e.id,Ut=Nt?`https://app.clio.com/nc/#/matters/${Nt}/tasks`:null;return u.jsxs("div",{className:"border-t bg-card",children:[u.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800",children:[u.jsxs("div",{className:"flex items-center gap-2 cursor-pointer flex-1 hover:opacity-80 transition-opacity",onClick:()=>Y(!de),children:[u.jsx(hB,{className:"w-4 h-4 text-slate-600 dark:text-gray-300"}),u.jsx("span",{className:"font-medium text-sm text-slate-800 dark:text-white",children:"Tasks"}),(At||$t)&&!d&&(de?u.jsx(Kv,{className:"w-4 h-4 text-gray-400"}):u.jsx(xs,{className:"w-4 h-4 text-gray-400"}))]}),u.jsxs("div",{className:"flex items-center gap-2",children:[S&&($t?u.jsxs(We,{variant:"ghost",size:"sm",className:"h-7 text-xs text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 px-2",onClick:st=>{st.stopPropagation(),Kt(!1),Ks()},children:[u.jsx(Tk,{className:"w-3 h-3 mr-1"}),"Remove"]}):u.jsxs(We,{variant:"ghost",size:"sm",className:"h-7 text-xs text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 px-2",onClick:st=>{st.stopPropagation(),Kt(!0)},children:[u.jsx(Ak,{className:"w-3 h-3 mr-1"}),"Add Task"]})),Ut&&u.jsxs("a",{href:Ut,target:"_blank",rel:"noopener noreferrer",className:"h-7 text-xs text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 border border-blue-200 dark:border-blue-800 px-2 flex-shrink-0 rounded-md inline-flex items-center gap-1 no-underline hover:no-underline",onClick:st=>st.stopPropagation(),children:[u.jsx(Va,{className:"w-3 h-3"}),"View all"]})]})]}),!de&&u.jsxs(u.Fragment,{children:[$t&&u.jsx("div",{className:"p-3 border-b border-gray-200 dark:border-gray-700 bg-gray-50/50 dark:bg-gray-800/50",children:u.jsxs("div",{className:"space-y-3",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Task Name"}),u.jsx(vn,{disabled:ze,placeholder:ze?"Generating task name...":"Enter task name...",value:hr,onChange:st=>Ur(st.target.value),className:"h-8 text-sm"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Task Description"}),u.jsx("textarea",{placeholder:ze?"Generating task description...":"Enter task description...",value:zr,onChange:st=>kr(st.target.value),disabled:ze,className:`w-full min-h-[80px] px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 resize-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${ze?"opacity-60 cursor-not-allowed":""}`}),ze&&u.jsxs("div",{className:"flex items-center gap-2 mt-1 text-xs text-gray-500 dark:text-gray-400",children:[u.jsx("div",{className:"w-3 h-3 border-2 border-gray-300 border-t-blue-600 rounded-full animate-spin"}),"Generating task from email..."]})]}),u.jsxs("div",{className:"flex gap-3",children:[u.jsxs("div",{className:"flex-1",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Due At"}),u.jsx(vn,{type:"date",value:ge,onChange:st=>Pe(st.target.value),className:"h-8 text-sm"})]}),u.jsxs("div",{className:"flex-1",children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Priority"}),u.jsxs(jo,{open:ft,onOpenChange:Mt,children:[u.jsx(Oo,{asChild:!0,children:u.jsxs(We,{variant:"outline",className:"w-full h-8 text-sm justify-between font-normal",children:[u.jsx("span",{children:pt}),u.jsx(xs,{className:"w-3 h-3 ml-2 flex-shrink-0"})]})}),u.jsx(co,{align:"start",className:"w-[140px]",children:["High","Normal","Low"].map(st=>u.jsx(bs,{className:`cursor-pointer ${pt===st?"bg-gray-100 dark:bg-gray-700":""}`,onClick:()=>{wt(st),Mt(!1)},children:st},st))})]})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Assign To"}),u.jsxs(jo,{open:Li,onOpenChange:cn,children:[u.jsx(Oo,{asChild:!0,children:u.jsxs(We,{variant:"outline",className:"w-full h-8 text-sm justify-between font-normal",children:[u.jsx("span",{className:"truncate",children:ut||"Select assignee"}),u.jsx(xs,{className:"w-3 h-3 ml-2 flex-shrink-0"})]})}),u.jsxs(co,{align:"start",className:"w-[320px] p-0",children:[u.jsxs("div",{className:"p-3 border-b border-gray-200 dark:border-gray-700",children:[u.jsx("div",{className:"text-sm font-medium mb-2 text-gray-800 dark:text-gray-200",children:"Search Users"}),u.jsxs("div",{className:"relative",children:[u.jsx(Ri,{className:"absolute left-2 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),u.jsx(vn,{placeholder:"Search by name...",value:yn,onChange:st=>{const it=st.target.value;go(it),Sh(it)},className:"pl-8 pr-8 h-9 text-sm",autoFocus:!0,onClick:st=>st.stopPropagation(),onKeyDown:st=>st.stopPropagation()}),yn&&u.jsx("button",{onClick:st=>{st.stopPropagation(),go(""),En([]),Ve(null)},className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:u.jsx(aa,{className:"w-4 h-4"})})]})]}),u.jsx("div",{className:"max-h-[300px] overflow-y-auto",children:Ws?u.jsxs("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 flex items-center gap-2",children:[u.jsx("div",{className:"w-4 h-4 border-2 border-gray-300 border-t-gray-600 rounded-full animate-spin"}),"Searching..."]}):ce&&Mo.length===0?u.jsx("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:ce}):Mo.length>0?Mo.map(st=>u.jsx(bs,{className:"flex flex-col items-start p-3 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-800",onClick:()=>{mt(st.id),yt(st.name),cn(!1),go(""),En([])},children:u.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-gray-100",children:st.name})},st.id)):yn.trim().length>=2&&!Ws?u.jsxs("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:['No users found for "',yn,'"']}):u.jsx("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:ut?u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Currently assigned to: ",ut]}),u.jsx("div",{className:"text-xs",children:"Type at least 2 characters to search for other users..."})]}):"Type at least 2 characters to search users..."})})]})]})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("input",{type:"checkbox",id:"hasReminder",checked:ht,onChange:st=>Xt(st.target.checked),className:"cursor-pointer"}),u.jsx("label",{htmlFor:"hasReminder",className:"text-xs font-medium text-gray-700 dark:text-gray-300 cursor-pointer",children:"Add Reminder"})]}),ht&&u.jsxs("div",{className:"pl-5 space-y-2 border-l-2 border-gray-200 dark:border-gray-600",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Remind"}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx(vn,{type:"number",min:"1",value:Yn,onChange:st=>Qr(Math.max(1,parseInt(st.target.value)||1)),className:"h-8 text-sm w-20"}),u.jsxs(jo,{open:Le,onOpenChange:nt,children:[u.jsx(Oo,{asChild:!0,children:u.jsxs(We,{variant:"outline",className:"flex-1 h-8 text-sm justify-between font-normal",children:[u.jsx("span",{children:ur}),u.jsx(xs,{className:"w-3 h-3 ml-2 flex-shrink-0"})]})}),u.jsx(co,{align:"start",className:"w-[140px]",children:["Minutes","Hours","Days","Weeks"].map(st=>u.jsx(bs,{className:`cursor-pointer ${ur===st?"bg-gray-100 dark:bg-gray-700":""}`,onClick:()=>{at(st),nt(!1)},children:st},st))})]})]}),u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"before due date"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Delivery Method"}),u.jsx("div",{className:"w-full h-8 px-3 text-sm flex items-center border border-input rounded-md bg-gray-50 dark:bg-gray-800 text-gray-700 dark:text-gray-300",children:"Email"})]})]})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("input",{type:"checkbox",id:"appendEmailToDescription",checked:Un,onChange:st=>Gs(st.target.checked),className:"cursor-pointer"}),u.jsx("label",{htmlFor:"appendEmailToDescription",className:"text-xs text-gray-700 dark:text-gray-300 cursor-pointer",children:"Append email to Description"})]}),!ls&&u.jsxs("div",{className:"space-y-2 pt-2 border-t border-gray-200 dark:border-gray-700",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("input",{type:"checkbox",id:"notifyAssignee",checked:Fr,onChange:st=>Yt(st.target.checked),className:"cursor-pointer"}),u.jsx("label",{htmlFor:"notifyAssignee",className:"text-xs text-gray-700 dark:text-gray-300 cursor-pointer",children:"Notify assignee when task is assigned"})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("input",{type:"checkbox",id:"notifyCompletion",checked:Wr,onChange:st=>fn(st.target.checked),className:"cursor-pointer"}),u.jsx("label",{htmlFor:"notifyCompletion",className:"text-xs text-gray-700 dark:text-gray-300 cursor-pointer",children:"Notify me when task is completed"})]})]}),u.jsx(We,{onClick:Zl,disabled:rt,className:"w-full h-8 text-sm",children:rt?"Creating task in Clio...":"Create Task"})]})}),vr&&u.jsx("div",{className:`p-2 rounded-md text-sm ${vr.type==="success"?"bg-green-50 dark:bg-green-900/20 text-green-700 dark:text-green-400 border border-green-200 dark:border-green-800":"bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-400 border border-red-200 dark:border-red-800"}`,children:vr.text}),Jt&&u.jsx("div",{className:"p-3 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:u.jsxs("div",{className:"flex items-start gap-2 mb-2",children:[u.jsx(Rv,{className:"w-4 h-4 text-blue-600 dark:text-blue-400 mt-0.5 flex-shrink-0"}),u.jsxs("div",{className:"flex-1",children:[u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 font-medium mb-1",children:"Newly Created Task"}),u.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-gray-100 mb-1",children:String(Jt.name||"Untitled Task")}),u.jsxs("div",{className:"space-y-1",children:[!!Jt.due_at&&u.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600 dark:text-gray-400",children:[u.jsx(zf,{className:"w-3 h-3"}),u.jsxs("span",{children:["Due: ",Ys(String(Jt.due_at))]})]}),!!Jt.priority&&u.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600 dark:text-gray-400",children:[u.jsx("span",{className:"font-medium",children:"Priority:"}),u.jsx("span",{children:String(Jt.priority)})]})]})]})]})}),d?u.jsx(Bs,{rows:2}):At?u.jsxs("div",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:[Me&&u.jsx("div",{className:"p-3 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:u.jsxs("div",{className:"flex items-start gap-2 mb-2",children:[u.jsx(ad,{className:"w-4 h-4 text-green-600 dark:text-green-400 mt-0.5 flex-shrink-0"}),u.jsxs("div",{className:"flex-1",children:[u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 font-medium mb-1",children:"Last Completed Task"}),u.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-gray-100 mb-1",children:String(Me.name||"Untitled Task")}),!!Me.completed_at&&u.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600 dark:text-gray-400",children:[u.jsx(zf,{className:"w-3 h-3"}),u.jsxs("span",{children:["Completed: ",Ys(String(Me.completed_at))]})]})]})]})}),Ke&&u.jsx("div",{className:"p-3 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:u.jsxs("div",{className:"flex items-start gap-2 mb-2",children:[u.jsx(Rv,{className:"w-4 h-4 text-blue-600 dark:text-blue-400 mt-0.5 flex-shrink-0"}),u.jsxs("div",{className:"flex-1",children:[u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 font-medium mb-1",children:"Next Upcoming Task"}),u.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-gray-100 mb-1",children:String(Ke.name||"Untitled Task")}),u.jsxs("div",{className:"space-y-1",children:[!!Ke.due_at&&u.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600 dark:text-gray-400",children:[u.jsx(zf,{className:"w-3 h-3"}),u.jsxs("span",{children:["Due: ",Ys(String(Ke.due_at))]})]}),!!Ke.priority&&u.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600 dark:text-gray-400",children:[u.jsx("span",{className:"font-medium",children:"Priority:"}),u.jsx("span",{children:ry.capitalize(String(Ke.priority))})]})]})]})]})})]}):!$t&&!Jt?u.jsx("div",{className:"p-3 text-sm text-gray-600 dark:text-gray-400",children:r&&t.length>0?u.jsx(u.Fragment,{children:u.jsx("p",{className:"mb-2",children:"No tasks found for this matter"})}):"Select a client email thread to view tasks"}):null]})]})},di=()=>{const _e=t.length>0&&n<t.length?t[n]:null,Me=_e==null?void 0:_e.most_recent_note,Ke=Me&&Me.detail,At=_e==null?void 0:_e.id,Nt=At?`https://app.clio.com/nc/#/matters/${At}/notes`:null;return u.jsxs("div",{className:"border-t bg-card",children:[u.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800",children:[u.jsxs("div",{className:"flex items-center gap-2 cursor-pointer flex-1 hover:opacity-80 transition-opacity",onClick:()=>$(!J),children:[u.jsx(ld,{className:"w-4 h-4 text-slate-600 dark:text-gray-300"}),u.jsx("span",{className:"font-medium text-sm text-slate-800 dark:text-white",children:"Latest Note"}),!!Ke&&!d&&u.jsx(u.Fragment,{children:J?u.jsx(Kv,{className:"w-4 h-4 text-gray-400"}):u.jsx(xs,{className:"w-4 h-4 text-gray-400"})})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[At&&(Mi?u.jsxs(We,{variant:"ghost",size:"sm",className:"h-7 text-xs text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 px-2",onClick:Ut=>{Ut.stopPropagation(),Vr(!1),iu()},children:[u.jsx(Tk,{className:"w-3 h-3 mr-1"}),"Remove"]}):u.jsxs(We,{variant:"ghost",size:"sm",className:"h-7 text-xs text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 px-2",onClick:Ut=>{Ut.stopPropagation(),Vr(!0)},children:[u.jsx(Ak,{className:"w-3 h-3 mr-1"}),"Add Note"]})),Nt&&u.jsxs("a",{href:Nt,target:"_blank",rel:"noopener noreferrer",className:"h-7 text-xs text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 border border-blue-200 dark:border-blue-800 px-2 flex-shrink-0 rounded-md inline-flex items-center gap-1 no-underline hover:no-underline",onClick:Ut=>Ut.stopPropagation(),children:[u.jsx(Va,{className:"w-3 h-3"}),"View all"]})]})]}),Mi&&u.jsx("div",{className:"bg-gray-50/50 dark:bg-gray-800/30 p-3 border-b border-gray-200 dark:border-gray-700",children:u.jsxs("div",{className:"space-y-3",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Subject"}),u.jsx(vn,{type:"text",value:$o,onChange:Ut=>Jn(Ut.target.value),placeholder:"Enter note subject...",className:"h-9 text-sm"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Note"}),u.jsx("textarea",{value:nu,onChange:Ut=>Ns(Ut.target.value),placeholder:"Enter note details...",className:"w-full min-h-[80px] px-3 py-2 text-sm border rounded-md resize-y dark:bg-gray-800 dark:border-gray-600 dark:text-gray-100",rows:3})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Date"}),u.jsx(vn,{type:"date",value:ma,onChange:Ut=>su(Ut.target.value),className:"h-9 text-sm"})]}),u.jsx(We,{onClick:au,disabled:ou,className:"w-full h-9",children:ou?"Creating note in Clio...":"Create Note"})]})}),ci&&u.jsx("div",{className:`p-2 rounded-md text-sm ${ci.type==="success"?"bg-green-50 dark:bg-green-900/20 text-green-700 dark:text-green-400 border border-green-200 dark:border-green-800":"bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-400 border border-red-200 dark:border-red-800"}`,children:ci.text}),!J&&u.jsx(u.Fragment,{children:d?u.jsx(Bs,{rows:1}):Ke?u.jsx("div",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:u.jsxs("div",{className:"p-3 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:[u.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-gray-100 mb-2",children:String(Me.subject||"Note")}),u.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600 dark:text-gray-400 mb-2",children:[u.jsx(zf,{className:"w-3 h-3"}),u.jsx("span",{children:Ys(String(Me.created_at))}),(()=>{const Ut=sl(String(Me.created_at||""));return Ut?u.jsxs(u.Fragment,{children:[u.jsx("span",{children:""}),u.jsx(Rv,{className:"w-3 h-3"}),u.jsx("span",{children:Ut})]}):null})()]}),u.jsx("div",{className:"text-sm text-gray-700 dark:text-gray-300",children:(()=>{const Ut=String(Me.detail||""),st=ec(Ut);return X||!st?u.jsx("div",{className:"prose prose-sm max-w-none dark:prose-invert",dangerouslySetInnerHTML:{__html:lu(Ut)}}):u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"line-clamp-3 prose prose-sm max-w-none dark:prose-invert",dangerouslySetInnerHTML:{__html:lu(Ut)}}),u.jsx("button",{onClick:it=>{it.stopPropagation(),O(!0)},className:"text-blue-600 dark:text-blue-400 hover:underline mt-1 text-xs font-medium",children:"Expand"})]})})()}),X&&u.jsx("button",{onClick:Ut=>{Ut.stopPropagation(),O(!1)},className:"text-blue-600 dark:text-blue-400 hover:underline mt-2 text-xs font-medium",children:"Show less"})]})}):u.jsx("div",{className:"p-3 text-sm text-gray-600 dark:text-gray-400",children:r&&t.length>0?"No notes found for this matter":"Select a client email thread to view matter notes"})})]})};return u.jsxs("div",{className:"w-full min-h-[4rem] border border-border/50 rounded-lg shadow-sm bg-card text-card-foreground",title:"Matters and Calendar Information",children:[u.jsxs("div",{className:"flex items-center justify-between p-2 border-b bg-muted",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(ZA,{className:"w-3.5 h-3.5 text-slate-600 dark:text-gray-300"}),u.jsx("span",{className:"font-medium text-sm text-slate-800 dark:text-white",children:"MATTERS"})]}),u.jsxs(jo,{open:Ge,onOpenChange:qe,children:[u.jsx(Oo,{asChild:!0,children:u.jsx(We,{variant:"ghost",size:"icon",className:"h-8 w-8 hidden",title:"Search all matters",children:u.jsx(Ri,{className:"h-4 w-4"})})}),u.jsxs(co,{align:"end",className:"w-[320px] p-0",children:[u.jsxs("div",{className:"p-3 border-b border-gray-200 dark:border-gray-700",children:[u.jsx("div",{className:"text-sm font-medium mb-2 text-gray-800 dark:text-gray-200",children:"Search All Matters"}),u.jsxs("div",{className:"relative",children:[u.jsx(Ri,{className:"absolute left-2 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),u.jsx(vn,{placeholder:"Search by matter or client name...",value:K,onChange:_e=>{const Me=_e.target.value;he(Me),rl(Me)},className:"pl-8 pr-8 h-9 text-sm",autoFocus:!0,onClick:_e=>_e.stopPropagation(),onKeyDown:_e=>_e.stopPropagation()}),K&&u.jsx("button",{onClick:_e=>{_e.stopPropagation(),he(""),Ie([]),St(null)},className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:u.jsx(aa,{className:"w-4 h-4"})})]})]}),u.jsx("div",{className:"max-h-[300px] overflow-y-auto",children:_t?u.jsxs("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 flex items-center gap-2",children:[u.jsx("div",{className:"w-4 h-4 border-2 border-gray-300 border-t-gray-600 rounded-full animate-spin"}),"Searching..."]}):Ne&&be.length===0?u.jsx("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:Ne}):be.length>0?be.map(_e=>u.jsxs(bs,{className:"flex flex-col items-start p-3 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-800",onClick:()=>vd(_e),children:[u.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-gray-100",children:_e.projectName}),u.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5",children:[_e.phaseName,"  Client: ",_e.clientName]})]},_e.projectId.native)):K.trim()&&!_t?u.jsxs("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:['No matters found for "',K,'"']}):u.jsx("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400 text-center",children:"Type at least 2 characters to search matters..."})})]})]})]}),d?nl():E?u.jsxs("div",{className:"flex items-center gap-1.5 px-3 py-2 text-xs text-amber-700 dark:text-amber-400",children:[u.jsx(nh,{className:"h-3.5 w-3.5 flex-shrink-0"}),u.jsx("span",{children:T?"Failed to refresh. Please try again later.":"Failed to fetch matter data. Please try again later."})]}):e&&Object.keys(e).length>0?u.jsxs(u.Fragment,{children:[T&&u.jsxs("div",{className:"flex items-center gap-1.5 px-3 py-2 text-xs text-amber-700 dark:text-amber-400",children:[u.jsx(nh,{className:"h-3.5 w-3.5 flex-shrink-0"}),u.jsx("span",{children:"Failed to refresh. Try again later."})]}),t.length>0&&u.jsxs("div",{className:"flex items-center px-3 py-1 bg-gray-50 dark:bg-gray-800 border-b dark:border-gray-700 gap-2",children:[u.jsx("div",{className:"flex-1 min-w-0 flex items-center",children:(()=>{const _e=z??t.length,Me=_e>L,Ke=Me?Math.ceil(_e/L):1,At=(G-1)*L+1,Nt=Math.min(G*L,_e),Ut=(()=>{if(!U.trim())return t;const it=U.toLowerCase();return ae.length>0&&U.length>=2?ae.filter(Xn=>(Xn.description||"").toLowerCase().includes(it)):t.filter(Xn=>String(Xn.description||"").toLowerCase().includes(it))})(),st=()=>{if(Ke<=5)return Array.from({length:Ke},(Xn,Js)=>Js+1);const it=[];return G<=3?it.push(1,2,3,"...",Ke):G>=Ke-2?it.push(1,"...",Ke-2,Ke-1,Ke):it.push(1,"...",G,"...",Ke),it};return u.jsx(u.Fragment,{children:t.length>1||Me?u.jsxs(jo,{open:Ee,onOpenChange:tl,children:[u.jsx(Oo,{asChild:!0,children:u.jsxs(We,{variant:"ghost",size:"sm",className:"h-auto text-left text-gray-600 dark:text-gray-300 flex flex-col items-start gap-0 px-2 py-1 max-w-full overflow-hidden",children:[u.jsx("span",{className:"text-sm truncate font-medium w-full",title:e.Title||"",children:e.Title||"Case"}),u.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400 flex items-center gap-1",children:[Gt," of ",_e," matters in Clio",u.jsx(xs,{className:"w-3 h-3"})]})]})}),u.jsxs(co,{align:"start",className:"w-[320px] p-0",children:[u.jsx("div",{className:"p-2 border-b border-gray-200 dark:border-gray-700",children:u.jsxs("div",{className:"relative",children:[u.jsx(Ri,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),u.jsx(vn,{placeholder:"Search matters...",value:U,onChange:it=>re(it.target.value),className:"pl-8 pr-8 h-8 text-xs",autoFocus:!0,onClick:it=>it.stopPropagation(),onKeyDown:it=>it.stopPropagation()}),U&&u.jsx("button",{onClick:it=>{it.stopPropagation(),re("")},className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:u.jsx(aa,{className:"w-4 h-4"})})]})}),!U.trim()&&G===1&&u.jsx("div",{className:"px-3 py-1.5 text-xs text-gray-500 dark:text-gray-400 border-b border-gray-100 dark:border-gray-700",children:"Sorted by: Last opened in Clio"}),U.trim()&&ae.length>0&&U.length>=2&&u.jsxs("div",{className:"px-3 py-1.5 text-xs text-gray-500 dark:text-gray-400 border-b border-gray-100 dark:border-gray-700",children:["Searching all ",_e," matters"]}),u.jsx("div",{className:"max-h-[250px] overflow-y-auto",children:Ut.length>0?Ut.map(it=>{const Xn=U.length>=2&&ae.length>0,Js=t.indexOf(it),Sr=Js!==-1,Qt=String(it.id||""),ga=ct?Qt===ct:Sr&&Js===n,Ui=String(it.description||"Case"),yd=ga?"bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400 font-medium":"";return Xn?u.jsx("button",{type:"button",className:`relative flex w-full cursor-pointer select-none items-center rounded-sm text-sm outline-none transition-colors hover:bg-neutral-100 dark:hover:bg-muted dark:text-gray-200 py-2.5 px-3 truncate text-left ${yd}`,onClick:()=>{if(N&&Qt){Ct(Qt);const xd=ae.findIndex(il=>il.id===Qt);if(xd!==-1&&q){const il=Math.floor(xd/L)+1;q(il)}N({id:Qt,description:String(it.description||""),name:String(it.name||"")},{preservePagination:!0}),ne(!1),re("")}},children:Ui},Qt||Ui):u.jsx(bs,{className:`text-sm py-2.5 px-3 truncate ${yd}`,onClick:()=>{Sr?yr(Js):N&&Qt&&(Ct(Qt),ne(!1),N({id:Qt,description:String(it.description||""),name:String(it.name||"")},{preservePagination:!0}))},children:Ui},Qt||Ui)}):u.jsxs("div",{className:"p-3 text-xs text-center text-gray-500 dark:text-gray-400",children:["No matters match ",U,""]})}),Me&&!(U.trim()&&ae.length>0&&U.length>=2)&&u.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 px-3 py-2",onPointerDown:it=>{it.preventDefault(),it.stopPropagation()},onClick:it=>it.stopPropagation(),children:[u.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mb-2",children:["Showing ",At,"-",Nt," of ",_e," matters"]}),u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("button",{onClick:()=>{we.current=!0,q==null||q(G-1)},disabled:G<=1,className:"text-xs px-2 py-1 text-gray-600 dark:text-gray-400 border border-gray-300 dark:border-gray-600 rounded hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-40 disabled:cursor-not-allowed",children:" Newer"}),u.jsx("div",{className:"flex items-center gap-1",children:st().map((it,Xn)=>it==="..."?u.jsx("span",{className:"text-xs text-gray-400 px-1",children:""},`ellipsis-${Xn}`):u.jsx("button",{disabled:it===G,className:`text-xs w-6 h-6 rounded flex items-center justify-center ${it===G?"bg-blue-600 text-white font-medium":"text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700"} disabled:cursor-not-allowed`,onClick:()=>{typeof it=="number"&&(we.current=!0,q==null||q(it))},children:it},it))}),u.jsx("button",{onClick:()=>{we.current=!0,q==null||q(G+1)},disabled:G>=Ke,className:"text-xs px-2 py-1 text-gray-600 dark:text-gray-400 border border-gray-300 dark:border-gray-600 rounded hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-40 disabled:cursor-not-allowed",children:"Older "})]})]})]})]}):u.jsxs("div",{className:"flex flex-col px-2 py-1 overflow-hidden",children:[u.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-300 truncate font-medium w-full",title:e.Title||"",children:e.Title||"Case"}),!m&&u.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[Gt," of ",_e," matters in Clio"]})]})})})()}),((Uo=s.find(_e=>_e.field==="Title"))==null?void 0:Uo.url)&&u.jsxs("a",{href:($i=s.find(_e=>_e.field==="Title"))==null?void 0:$i.url,target:"_blank",rel:"noopener noreferrer",className:"h-8 text-xs text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 border border-blue-200 dark:border-blue-800 px-3 flex-shrink-0 rounded-md inline-flex items-center gap-1 no-underline hover:no-underline",children:[u.jsx(Va,{className:"w-3 h-3"}),"View"]})]}),Cs&&!m&&u.jsx(pw,{createdContacts:F,onMatterLinked:j}),fe&&u.jsxs(US,{variant:"destructive",className:"m-2",children:[u.jsx(nh,{className:"h-4 w-4"}),u.jsx(zS,{className:"ml-2",children:"Failed to load matter details. Previous details shown below."})]}),oe?u.jsx(Bs,{rows:5}):u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"break-words",children:u.jsx(Ql,{details:e})}),S&&u.jsx("div",{className:"border-t bg-card p-3",children:u.jsxs("a",{href:`https://app.clio.com/nc/#/matters/${S}/documents`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-sm text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 hover:underline transition-colors",children:[u.jsx(ld,{className:"w-4 h-4 text-blue-500"}),u.jsx("span",{children:"View all documents in Clio"}),u.jsx(Va,{className:"w-3 h-3"})]})}),di(),ol(),ui()]})]}):x?u.jsx(Bs,{rows:2}):u.jsx("div",{className:"p-3 text-sm text-gray-600 dark:text-gray-400",children:r?u.jsxs(u.Fragment,{children:[u.jsx("p",{className:"mb-2",children:"Select a client email thread to view matter information"}),Cs&&!m&&u.jsx(pw,{createdContacts:F,onMatterLinked:j})]}):u.jsxs(u.Fragment,{children:[Cs&&!m&&u.jsx(pw,{createdContacts:F,onMatterLinked:j}),!Cs&&"Select a client email thread to view case information"]})})]})},vs="src/shared/hooks/useParticipantValidation.ts",Qq=0,mw=1,m1=2e3,g1=3e4;function Zq(r){const e=r.message.toLowerCase();return e.includes("client not found")||e.includes("404")||e.includes("not found")}function eK(r){const e=r.message.toLowerCase();return e.includes("timed out")||e.includes("timeout")||e.includes("504")||e.includes("503")||e.includes("429")||e.includes("network")||e.includes("failed to fetch")}function tK({emailParticipants:r,getClientDetailsForEmail:e,clientDataCache:t,isValidClientData:n,onClientDataValidated:s,refreshTrigger:i,onTransientError:c,isRateLimitedData:d,onValidationComplete:m}){const p=Gr(),v=w.useRef(null),x=w.useRef(new Set),b=w.useCallback(async(A,R,F=!1)=>{var fe,H;if(R.aborted)return;const j=A.toLowerCase();if(x.current.has(j)){p.debug("Skipping duplicate in-flight validation",{sourceFile:vs,email:A});return}const L=(fe=t.current)==null?void 0:fe[A];if(L&&typeof L=="object"&&"pagination"in L&&L.pagination!=null){const me=n(L);s(A,me),p.debug("Participant validated from L1 cache (skipped API call)",{sourceFile:vs,email:A,hasValidData:me});return}const G=await Mm(A,p);if(G&&"pagination"in G&&G.pagination!=null){t.current&&(t.current[A]=G);const me=n(G);s(A,me),p.debug("Participant validated from L2 cache (skipped API call)",{sourceFile:vs,email:A,hasValidData:me});return}x.current.add(j);let z,q,ae=!1;const oe=e(A,F);try{if(await Promise.race([oe,new Promise((se,de)=>{z=setTimeout(()=>{ae=!0,de(new Error(`Request timed out after ${g1}ms`))},g1),q=()=>{clearTimeout(z),de(new DOMException("Aborted","AbortError"))},R.addEventListener("abort",q,{once:!0})})]),R.aborted)return;const me=(H=t.current)==null?void 0:H[A],ee=me?n(me):!1;!ee&&me&&(d!=null&&d(me))?(p.warn("Participant rate-limited during validation  treating as transient, not invalid",{sourceFile:vs,email:A}),s(A,!1),c==null||c(A,new Error("Rate limited  please try again shortly"))):s(A,ee),p.debug("Participant validation result",{sourceFile:vs,email:A,hasValidData:ee})}catch(me){if(R.aborted)return;me instanceof Error?Zq(me)?(p.debug("Participant not found in system",{sourceFile:vs,email:A,error:me.message}),s(A,!1)):eK(me)?(p.warn("Participant validation timed out or network error - marking as pending",{sourceFile:vs,email:A,error:me.message}),s(A,!1),c==null||c(A,me),ae&&oe.then(()=>{var de;if(R.aborted)return;const ee=(de=t.current)==null?void 0:de[A];(ee?n(ee):!1)&&(p.info("Request succeeded after timeout - updating validation",{sourceFile:vs,email:A}),console.log(` [Late Success] Data loaded after timeout for ${A}`),s(A,!0))}).catch(ee=>{R.aborted||p.debug("Request failed after timeout",{sourceFile:vs,email:A,error:ee instanceof Error?ee.message:String(ee)})})):(p.error("Participant validation failed with unexpected error",me,{sourceFile:vs,email:A}),s(A,!1)):(p.error("Participant validation failed with non-Error",new Error(String(me)),{sourceFile:vs,email:A}),s(A,!1))}finally{z!==void 0&&clearTimeout(z),q&&R.removeEventListener("abort",q),x.current.delete(j)}},[e,t,n,s,c,d,p]),S=w.useCallback(async(A,R,F=!1)=>{await Promise.all(A.map(j=>b(j,R,F)))},[b]),N=(A,R)=>new Promise((F,j)=>{if(R.aborted)return j(new DOMException("Aborted","AbortError"));const L=()=>{clearTimeout(G),j(new DOMException("Aborted","AbortError"))},G=setTimeout(()=>{R.removeEventListener("abort",L),F()},A);R.addEventListener("abort",L,{once:!0})}),E=w.useMemo(()=>[...r].sort().join(","),[r]),T=w.useRef(Qq);w.useEffect(()=>{var G;if(r.length===0)return;(G=v.current)==null||G.abort();const A=new AbortController;v.current=A;const R=x.current,F=i>T.current,j=t.current;return F&&j&&(Object.keys(j).forEach(z=>{delete j[z]}),yT(p),B5(),R.clear(),p.debug("Cleared all cache tiers for refresh",{sourceFile:vs,refreshTrigger:i})),T.current=i,(async()=>{const{signal:z}=A;p.info("Validating all email participants (rate-limited)",{sourceFile:vs,participantCount:r.length,batchSize:mw,batchDelayMs:m1});const q=[];for(let ae=0;ae<r.length;ae+=mw)q.push(r.slice(ae,ae+mw));for(let ae=0;ae<q.length;ae++){if(z.aborted){p.debug("Validation aborted",{sourceFile:vs});return}const oe=q[ae];if(p.debug("Processing validation batch",{sourceFile:vs,batchIndex:ae+1,totalBatches:q.length,batchEmails:oe}),await S(oe,z,F),ae<q.length-1&&!z.aborted)try{await N(m1,z)}catch(fe){if(fe instanceof DOMException&&fe.name==="AbortError"){p.debug("Validation delay aborted",{sourceFile:vs});return}throw fe}}p.info("Completed validating all participants",{sourceFile:vs,participantCount:r.length}),m==null||m()})(),()=>{A.abort(),R.clear()}},[E,S,p,i,t,m])}const uF=w.createContext(void 0),rK=({children:r})=>{const[e,t]=w.useState(0),[n,s]=w.useState(!1),i=w.useRef(null),[c,d]=w.useState(!0),m=w.useRef(new Map),p=Qa(),v=async A=>{try{return await p.getLocalItem(`elapsedTime_${A}`)??0}catch(R){return console.warn("Failed to read from storage, using in-memory storage:",R),m.current.get(A)??0}},x=async(A,R)=>{try{await p.setLocalItem(`elapsedTime_${A}`,R)}catch(F){console.warn("Failed to write to storage, using in-memory storage:",F),m.current.set(A,R)}},b=()=>{i.current!==null&&(window.clearInterval(i.current),i.current=null)},S=async A=>{!n&&c&&(s(!0),b(),v(A).then(R=>{t(R)}),i.current=window.setInterval(()=>{t(R=>{const F=R+1;return x(A,F),F})},1e3))},N=async A=>{if(n){s(!1),b();const R=await v(A);x(A,R)}},E=A=>{x(A,0),t(0)},T=async A=>await v(A);return w.useEffect(()=>()=>{b()},[]),u.jsx(uF.Provider,{value:{elapsedTime:e,isTimerRunning:n,startTimer:S,stopTimer:N,resetTimer:E,getElapsedTimeForThread:T,setShouldStartTimer:d,setElapsedTime:t},children:r})},dF=()=>{const r=w.useContext(uF);if(!r)throw new Error("useTimer must be used within a TimerProvider");return r},gw=r=>{const e=Math.floor(r/3600),t=Math.floor(r%3600/60),n=r%60,s=i=>String(i).padStart(2,"0");return`${s(e)}:${s(t)}:${s(n)}`},nK=({userData:r,clientEmail:e,fileToMatterChecked:t,casesForCurrentClient:n,selectedCase:s,onSave:i,onCancel:c})=>{const d=Gr(),m=ua(),{platform:p}=dn(),{elapsedTime:v,stopTimer:x,resetTimer:b}=dF(),[S,N]=w.useState(new Date().toISOString().slice(0,10)),[E,T]=w.useState(gw(v)),[A,R]=w.useState(""),[F,j]=w.useState(s||n[0]||{}),L=t,[G,z]=w.useState((r==null?void 0:r.rate)||null),[q,ae]=w.useState(!1),[oe,fe]=w.useState("Failed to save time entry. Please try again."),[H,me]=w.useState(!1),[ee,se]=w.useState(!1),[de,Y]=w.useState(!1),[J,$]=w.useState(!1),X=_r.useRef(null),[O,U]=w.useState(!1),re=async()=>{if(Y(!0),!(F!=null&&F.id)){Y(!1),$(!0),fe("Please select a matter to file the time entry.");return}const ne=/^(\d{1,2}):([0-5]\d):([0-5]\d)$/,we=E.trim().match(ne);if(!we){Y(!1),$(!0),fe("Please enter a valid duration in HH:MM:SS format.");return}const[,K,he,be]=we,Ie=Number(K)*3600+Number(he)*60+Number(be);if(!S||!/^\d{4}-\d{2}-\d{2}$/.test(S)||Number.isNaN(Date.parse(S))){Y(!1),$(!0),fe("Please select a valid date (YYYY-MM-DD).");return}if(!X.current){Y(!1),$(!0),fe("Unable to retrieve email thread information.");return}p==="chrome"&&FT(X.current,d).then(async Be=>{if(Be.length!=0)try{const Ge=Be[Be.length-1],qe=Ge.to.concat(Ge.cc),Ne=Ge.from,St=Ge.subject||"",ct=Ge.body||"",Ct=Ge.date||"",Gt=qe,$t=A.trim().replace(/[<>]/g,"").substring(0,5e3),Kt=await ay(e,"clio",S,Ie,$t,F==null?void 0:F.id,L,St,ct,Ct,Ne,Gt,H,ee,G,d);d.info("Time entry successfully written to server",{sourceFile:"TimeEntryModal.tsx",message:Kt}),fe("New email log and time entry created successfully."),Y(!1),$(!1),X.current&&(await x(X.current),b(X.current)),i()}catch(Ge){d.error("Error writing time entry to server",{error:Ge},{sourceFile:"TimeEntryModal.tsx"}),Y(!1),$(!0),fe("Something went wrong. Please try again.")}}).catch(Be=>{d.error("Error fetching email details from server",{error:Be},{sourceFile:"TimeEntryModal.tsx"}),Y(!1),$(!0),fe("Something went wrong. Please try again.")}),p==="outlook"&&m.getCurrentThread().then(async Be=>{if(Be===null){Y(!1),$(!0),fe("Unable to retrieve email details. Please try again.");return}const Ge=Be.messages[Be.messages.length-1].from,qe=Be.subject||"",Ne=Be.messages[Be.messages.length-1].body||"",St=Be.messages[Be.messages.length-1].timestamp||"",ct=Be.participants.filter(($t=>$t!==Ge)),Ct=A.trim().replace(/[<>]/g,"").substring(0,5e3),Gt=await ay(e,"clio",S,Ie,Ct,F==null?void 0:F.id,L,qe,Ne,St,Ge,ct,H,ee,G,d);d.info("Time entry successfully written to server",{sourceFile:"InsightsTimer.tsx",message:Gt}),fe("New email log and time entry created successfully."),Y(!1),$(!1),X.current&&(await x(X.current),b(X.current)),i()}).catch(Be=>{d.error("Error writing time entry to server",{error:Be},{sourceFile:"TimeEntryModal.tsx"}),Y(!1),$(!0),fe("Something went wrong. Please try again.")})},Ee=ne=>{let we="";const K=(ne==null?void 0:ne.messages)||[];let he=K;return K.length>3&&(he=K.slice(-3)),he.forEach((be,Ie)=>{we+=`Email ${Ie} Subject: ${be.subject||""}
Email ${Ie} Body: ${be.body||""}

`}),we};return w.useEffect(()=>{const ne=async()=>{m==null||m.getCurrentThread().then(K=>{U(!0);const he=(K==null?void 0:K.threadId)||null;if(!he){U(!1);return}if(p==="outlook"){const be=Ee(K);SC(he,be,d).then((Ie=>{R(Ie.description),U(!1)})).catch(Ie=>{d.error("Error generating email description summary",Ie,{sourceFile:"TimeEntryModal.tsx"}),U(!1)})}p==="chrome"&&SC(he,null,d).then(be=>{R(be.description),U(!1)}).catch(be=>{d.error("Error generating email description summary",be,{sourceFile:"TimeEntryModal.tsx"}),U(!1)})})},we=()=>{m==null||m.getCurrentThread().then(K=>{X.current=(K==null?void 0:K.threadId)||null})};ne(),we()},[L,m,d]),w.useEffect(()=>{var ne,we,K,he;(he=(K=(we=(ne=F==null?void 0:F.raw_data)==null?void 0:ne.custom_rate)==null?void 0:we.rates)==null?void 0:K[0])!=null&&he.rate?z(F.raw_data.custom_rate.rates[0].rate):z((r==null?void 0:r.rate)||0)},[F,r]),u.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 dark:bg-opacity-70 z-50 p-4 overflow-y-auto",onClick:c,children:u.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-lg w-full max-w-lg p-6 my-auto max-h-[90vh] overflow-y-auto",onClick:ne=>ne.stopPropagation(),children:[u.jsxs("div",{className:"flex justify-between items-center mb-4",children:[u.jsxs("h2",{className:"text-lg font-semibold text-blue-600 dark:text-blue-400",children:["Review Time Entry"," "]}),u.jsx("button",{className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",onClick:c,children:u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),J&&u.jsx("div",{role:"alert","aria-live":"assertive",className:"mb-4",children:u.jsxs("div",{className:"flex items-start bg-red-50 dark:bg-red-950/30 border border-red-200 dark:border-red-800 text-red-900 dark:text-red-100 rounded-md p-3",children:[u.jsx("svg",{className:"w-5 h-5 flex-shrink-0",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:u.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.72-1.36 3.485 0l6.518 11.588c.75 1.334-.213 2.995-1.742 2.995H3.481c-1.529 0-2.492-1.661-1.742-2.995L8.257 3.1zM10 8a1 1 0 10-0 2 1 1 0 000-2zm0 4a1 1 0 01-.993-.883L9 11V9a1 1 0 012 0v2a1 1 0 01-.883.993L10 12z",clipRule:"evenodd"})}),u.jsxs("div",{className:"ml-3 flex-1",children:[u.jsx("p",{className:"font-medium",children:"Error"}),u.jsx("p",{className:"mt-1 text-sm",children:oe})]})]})}),u.jsx("p",{className:"mb-4",children:"Review and edit details before saving."}),u.jsxs("div",{className:"flex gap-4 mb-4 w-full",children:[u.jsxs("div",{className:"shrink-0",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Date"}),u.jsx("input",{type:"date",value:S,onChange:ne=>N(ne.target.value),className:"mt-1 block border border-gray-300 dark:border-gray-600 text-gray-600 dark:text-gray-300 bg-white dark:bg-gray-800 rounded-md shadow-sm px-3 py-2 text-sm focus:ring-blue-500 focus:border-blue-500 h-[38px]"})]}),u.jsxs("div",{className:"shrink-0",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Duration"}),u.jsx("input",{type:"text",value:E,onChange:ne=>{const we=ne.target.value,K=/^(\d{0,2})(:\d{0,2}){0,2}$/;we.length<=8&&/^[0-9:]*$/.test(we)&&K.test(we)&&T(we)},onBlur:ne=>{const we=ne.target.value.trim(),K=/^(\d{1,2}):([0-5]\d):([0-5]\d)$/;if(K.test(we)){const[,he,be,Ie]=we.match(K),_t=Number(he)*3600+Number(be)*60+Number(Ie);T(gw(_t))}else T(gw(v))},className:"mt-1 block border border-gray-300 dark:border-gray-600 text-gray-600 dark:text-gray-300 bg-white dark:bg-gray-800 rounded-md shadow-sm px-3 py-2 text-sm focus:ring-blue-500 focus:border-blue-500 h-[38px]",style:{width:"10ch"},"aria-label":"Duration (HH:MM:SS)"})]})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Description"}),u.jsx("textarea",{disabled:O,value:O?"Generating AI description...":A,onChange:ne=>R(ne.target.value),className:"mt-1 block w-full border border-gray-300 dark:border-gray-600 text-gray-600 dark:text-gray-300 bg-white dark:bg-gray-800 rounded-md shadow-sm px-3 py-2 text-sm focus:ring-blue-500 focus:border-blue-500",rows:3})]}),u.jsx("div",{className:"bg-gray-50 dark:bg-gray-800/50 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm p-4",children:u.jsxs("div",{className:"flex justify-between items-center mb-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-900 dark:text-gray-100",children:"Billed By"}),u.jsx("p",{className:"mt-1 text-sm font-medium text-gray-900 dark:text-gray-100",children:"Rate"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm text-gray-700 dark:text-gray-300 text-right",children:(r==null?void 0:r.name)||"Unknown"}),u.jsxs("div",{className:"flex items-center justify-end gap-2",children:[u.jsx("input",{value:G??0,onChange:ne=>z(Number(ne.target.value)||0),onBlur:()=>ae(!1),className:q?"mt-1 text-sm text-right text-gray-700 dark:text-gray-300 border border-gray-200 dark:border-gray-600 rounded bg-white dark:bg-gray-800 inline-block":"mt-1 text-sm text-right text-gray-700 dark:text-gray-300 border border-transparent rounded bg-transparent inline-block","aria-label":"Rate",disabled:!q,style:{width:`${Math.max(String(G??0).length,1)+1}ch`}}),u.jsx("button",{type:"button",className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300","aria-label":"Edit rate",onClick:()=>ae(!q),children:u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536M4 20h4.586a1 1 0 00.707-.293l9.414-9.414a1 1 0 000-1.414L15.121 4.88a1 1 0 00-1.414 0L4 14.586V20z"})})})]})]})]})}),u.jsxs("div",{className:"mb-4 mt-5",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Matter"}),u.jsxs(jo,{children:[u.jsx(Oo,{asChild:!0,children:u.jsxs(We,{variant:"ghost",size:"sm",className:"mt-1 h-[38px] text-sm text-gray-600 dark:text-gray-300 flex items-center gap-1 px-3 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm w-full justify-between",children:[u.jsx("span",{className:"truncate",title:String((F==null?void 0:F.description)||"Select a matter"),children:String((F==null?void 0:F.description)||"Select a matter")}),u.jsx(xs,{className:"w-4 h-4 ml-1 flex-shrink-0"})]})}),u.jsx(co,{align:"start",className:"w-full max-h-[200px] overflow-y-auto",style:{width:"var(--radix-dropdown-menu-trigger-width)"},children:n.map((ne,we)=>u.jsx(bs,{className:"text-sm truncate max-w-full",onClick:()=>j(ne),title:String((ne==null?void 0:ne.description)||`Case ${we+1}`),children:String((ne==null?void 0:ne.description)||`Case ${we+1}`)},we))})]})]}),u.jsxs("div",{className:"mb-4 bg-blue-50 dark:bg-blue-950/30 p-3 rounded-md",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx("input",{type:"checkbox",id:"fileToMatter",checked:H,onChange:ne=>me(ne.target.checked),className:"cursor-pointer"}),u.jsx("label",{htmlFor:"fileToMatter",className:"ml-2 text-sm font-medium text-blue-600 dark:text-blue-400",children:"Non-billable"})]}),H&&u.jsxs("div",{className:"flex items-center",children:[u.jsx("input",{type:"checkbox",id:"billEntry",checked:ee,onChange:ne=>se(ne.target.checked),className:"cursor-pointer"}),u.jsx("label",{htmlFor:"billEntry",className:"ml-2 text-sm font-medium text-blue-600 dark:text-blue-400",children:"Show this entry on the bill"})]})]}),u.jsxs("div",{className:"flex flex-col gap-3",children:[u.jsx(We,{className:"w-full p-2",disabled:de,onClick:re,children:de?"Saving...":"Save Time Entry"}),u.jsx("button",{className:"w-full p-2 bg-transparent text-white hover:cursor-pointer hover:bg-transparent shadow-none border-none",disabled:de,onClick:c,children:"Cancel"})]})]})})},sK=r=>{const e=Math.floor(r/3600),t=Math.floor(r%3600/60),n=r%60,s=i=>String(i).padStart(2,"0");return`${s(e)}:${s(t)}:${s(n)}`},oK=({userData:r,clientEmail:e,emailParticipantClients:t,currentCaseIndex:n,casesForCurrentClient:s})=>{const i=Gr(),{elapsedTime:c,isTimerRunning:d,startTimer:m,stopTimer:p,resetTimer:v,setShouldStartTimer:x,setElapsedTime:b}=dF(),S=ua(),{platform:N}=dn(),[E,T]=w.useState(s[0]||null),[A,R]=w.useState(!0),[F,j]=w.useState(!1),[L,G]=w.useState(!1),z=_r.useRef(null),[q,ae]=w.useState(s||null),oe=new Date().toISOString().slice(0,10),fe="",[H,me]=w.useState("Failed to save time entry. Please try again."),[ee,se]=w.useState(!1),[de,Y]=w.useState(!1),J=async()=>{if(se(!0),!oe||!/^\d{4}-\d{2}-\d{2}$/.test(oe)||Number.isNaN(Date.parse(oe))){se(!1),Y(!0),me("Please select a valid date (YYYY-MM-DD).");return}if(z.current===null){se(!1),Y(!0),me("Unable to retrieve email details. Please try again.");return}N==="chrome"&&FT(z.current,i).then(async U=>{if(U.length<1){se(!1),Y(!0),me("Unable to retrieve email details. Please try again.");return}try{const re=U[U.length-1],Ee=re.to.concat(re.cc),ne=re.from,we=re.subject||"",K=re.body||"",he=re.date||"",be=Ee,Ie=fe.trim().replace(/[<>]/g,"").substring(0,5e3),_t=await ay(e,"clio",oe,c,Ie,E==null?void 0:E.id,A,we,K,he,ne,be,null,null,null,i);i.info("Time entry successfully written to server",{sourceFile:"InsightsTimer.tsx",message:_t}),me("New email log created successfully."),se(!1),Y(!1),G(!0),z.current&&(await p(z.current),v(z.current))}catch(re){i.error("Error writing time entry to server",re,{sourceFile:"InsightsTimer.tsx"}),se(!1),Y(!0),me("Something went wrong. Please try again.")}}).catch(U=>{i.error("Error fetching email details from server",U,{sourceFile:"InsightsTimer.tsx"}),se(!1),Y(!0),me("Something went wrong. Please try again.")}),N==="outlook"&&S.getCurrentThread().then(async U=>{if(U===null||!U.messages||U.messages.length===0){se(!1),Y(!0),me("Unable to retrieve email details. Please try again.");return}const re=U.messages[U.messages.length-1].from,Ee=U.subject||"",ne=U.messages[U.messages.length-1].body||"",we=U.messages[U.messages.length-1].timestamp||"",K=U.participants.filter((Ie=>Ie!==re)),he=fe.trim().replace(/[<>]/g,"").substring(0,5e3),be=await ay(e,"clio",oe,c,he,E==null?void 0:E.id,A,Ee,ne,we,re,K,null,null,null,i);i.info("Time entry successfully written to server",{sourceFile:"InsightsTimer.tsx",message:be}),me("New email log created successfully."),se(!1),Y(!1),G(!0),z.current&&(await p(z.current),v(z.current))}).catch(U=>{se(!1),Y(!0),me("Something went wrong. Please try again."),i.error("Error getting current thread",U,{sourceFile:"InsightsTimer.tsx"})})},$=async()=>{j(!1),G(!0),Y(!1),me("Successfully wrote email log and time entry"),z.current&&(await p(z.current),v(z.current))},X=async()=>{j(!1),x(!0),z.current&&await p(z.current)};return w.useEffect(()=>{if(!d)return;(()=>{S==null||S.getCurrentThread().then(U=>{z.current=(U==null?void 0:U.threadId)||null})})()},[d,S]),w.useEffect(()=>{ae(s),T(s[n]||null),G(!1),j(!1)},[n,s,r]),w.useEffect(()=>{let O=!0;const U=async he=>{if(!O)return;const be=(he==null?void 0:he.threadId)||null;if(!be){z.current&&document.visibilityState==="visible"&&(await p(z.current),b(0),i.info("Thread cleared - stopping timer",{sourceFile:"InsightsTimer.tsx"})),z.current=null;return}be!==z.current&&(i.info("Thread changed - starting timer",{sourceFile:"InsightsTimer.tsx",oldThreadId:z.current,newThreadId:be}),z.current&&await p(z.current),z.current=be,x(!0),document.visibilityState==="visible"&&m(be))};S&&(S.onThreadChanged(U),S.getCurrentThread().then(he=>{U(he)}).catch(he=>{i.error("Error getting initial thread",he,{sourceFile:"InsightsTimer.tsx"})}));const re=async()=>{z.current&&await p(z.current)},Ee=async()=>{try{if(!S)return;const he=await S.getCurrentThread(),be=(he==null?void 0:he.threadId)||null;if(!be||d&&z.current===be)return;z.current=be,m(be)}catch(he){i.error("Error starting timer on visibility/focus",he,{sourceFile:"InsightsTimer.tsx"})}},ne=()=>{document.visibilityState==="hidden"?re():document.visibilityState==="visible"&&Ee()},we=()=>Ee(),K=()=>re();return document.addEventListener("visibilitychange",ne),window.addEventListener("focus",we),window.addEventListener("blur",K),document.visibilityState==="visible"&&Ee(),()=>{O=!1,S&&S.removeThreadListener(U),document.removeEventListener("visibilitychange",ne),window.removeEventListener("focus",we),window.removeEventListener("blur",K)}},[S,m,p,x,i]),w.useEffect(()=>{if(L||de){const O=setTimeout(()=>{G(!1),Y(!1)},5e3);return()=>clearTimeout(O)}},[L,de]),u.jsxs(u.Fragment,{children:[F&&u.jsx(nK,{userData:r,clientEmail:e,emailParticipantClients:t,fileToMatterChecked:A,casesForCurrentClient:q,selectedCase:E,onSave:$,onCancel:X}),u.jsxs("div",{className:"flex flex-col gap-3 p-2 border rounded-md bg-blue-50 dark:bg-gray-800 border-blue-500 dark:border-gray-600 shadow-sm",children:[u.jsx("h2",{className:"text-sm font-semibold text-gray-700 dark:text-gray-200",children:"File email log"}),u.jsxs("div",{className:"flex items-center gap-1.5 overflow-hidden",children:[u.jsxs("button",{type:"button",onClick:async()=>{z.current&&(d?(x(!1),await p(z.current)):(x(!0),m(z.current)))},className:"flex items-center justify-start gap-1.5 w-[110px] h-[34px] px-2 rounded-md bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors border border-gray-200 dark:border-gray-600 overflow-hidden flex-shrink-0",children:[u.jsx("div",{className:"w-4 h-4 flex items-center justify-center flex-shrink-0",children:d?u.jsx(mB,{className:"w-4 h-4 text-green-700 dark:text-green-400"}):u.jsx(vB,{className:"w-4 h-4 text-gray-700 dark:text-gray-300"})}),u.jsx("span",{className:`text-base font-semibold ${d?"text-green-700 dark:text-green-400":"text-gray-700 dark:text-gray-300"} whitespace-nowrap w-[70px] text-center flex-shrink-0`,children:sK(c)})]}),u.jsxs("label",{className:"flex items-center gap-1 text-xs text-gray-600 dark:text-gray-400 flex-shrink min-w-0",children:[u.jsx("input",{type:"checkbox",id:"fileToMatter",checked:A,onChange:O=>R(O.target.checked),className:"cursor-pointer flex-shrink-0"}),u.jsx("span",{className:"truncate",children:"Add time entry"})]}),u.jsx("div",{className:"min-w-0 flex-1",children:u.jsx(We,{disabled:ee,onClick:async()=>{if(z.current){if(A){j(!0),x(!1),await p(z.current);return}se(!0),x(!1),await p(z.current),J()}},size:"sm",className:"h-8 text-xs px-1.5 w-full flex items-center justify-center gap-1",children:ee?u.jsx("span",{className:"truncate",children:"Saving..."}):u.jsxs(u.Fragment,{children:[u.jsx(xB,{className:"w-3.5 h-3.5 flex-shrink-0"}),u.jsx("span",{className:"hidden min-[340px]:inline",children:"Save"})]})})})]}),u.jsx("div",{className:"min-w-0",children:u.jsx("div",{className:"flex items-center gap-2 w-full min-w-0",children:u.jsxs(jo,{children:[u.jsx(Oo,{asChild:!0,children:u.jsxs(We,{variant:"ghost",size:"sm",className:"h-8 text-xs text-gray-600 dark:text-gray-300 flex items-center gap-1 px-2 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md w-full justify-between min-w-0",children:[u.jsx("span",{className:"truncate",title:String((E==null?void 0:E.description)||"Select a matter"),style:{maxWidth:"24ch",display:"inline-block"},children:String((E==null?void 0:E.description)||"Select a matter")}),u.jsx(xs,{className:"w-3 h-3 ml-1"})]})}),u.jsx(co,{align:"start",className:"w-full max-h-[200px] overflow-y-auto",style:{width:"100%"},children:q.map((O,U)=>u.jsx(bs,{className:"text-xs truncate max-w-full",onClick:()=>T(O),title:String((O==null?void 0:O.description)||`Case ${U+1}`),children:String((O==null?void 0:O.description)||`Case ${U+1}`)},U))})]})})})]}),L&&u.jsx("div",{role:"success","aria-live":"assertive",className:"mt-3",children:u.jsx("div",{className:"flex items-start border rounded-md p-3 border-green-200 dark:border-green-700 text-green-900 dark:text-green-100 bg-green-50 dark:bg-green-900",children:u.jsx("div",{className:"ml-3 flex-1",children:u.jsx("p",{className:"mt-1 text-sm",children:H})})})}),de&&u.jsx("div",{role:"alert","aria-live":"assertive",className:"mt-3",children:u.jsx("div",{className:"flex items-start border rounded-md p-3 border-red-200 dark:border-red-700 text-red-900 dark:text-red-100 bg-red-50 dark:bg-red-900",children:u.jsx("div",{className:"ml-3 flex-1",children:u.jsx("p",{className:"mt-1 text-sm",children:H})})})})]})},Vt="src/sidepanel/panels/ClioInsights.tsx",iK=({clientEmail:r,setClientEmail:e,tempClientEmail:t,setTempClientEmail:n,emailParticipants:s,emailParticipantClients:i,currentClientIndex:c,setCurrentClientIndex:d,currentCaseIndex:m,casesForCurrentClient:p,setCasesForCurrentClient:v,isManuallySet:x,setIsManuallySet:b,isProjectManuallySelected:S,setIsProjectManuallySelected:N,isValidClient:E,isTempEmailValid:T,nextCase:A,prevCase:R,handleSetCurrentCaseIndex:F,ClientNavigation:j,onClientDataValidated:L,onTransientError:G,isValidating:z,refreshTrigger:q,integrationSettings:ae,hasTransientError:oe,isPrefetchEnabled:fe})=>{const H=Gr(),me=Qa(),ee=ua(),se=w.useRef(r);se.current=r;const de=ce=>ce!==se.current,[Y]=w.useState(!0),[J,$]=w.useState({}),[X,O]=w.useState({}),[U,re]=w.useState({}),[Ee,ne]=w.useState({}),[we,K]=w.useState([]),[he,be]=w.useState(!1),[Ie,_t]=w.useState(null),[Be,Ge]=w.useState(!1),[qe,Ne]=w.useState(null),[St,ct]=w.useState(!1),[Ct,Gt]=w.useState([]),[$t,Kt]=w.useState(!1),hr=5,[Ur,zr]=w.useState(1),[kr,ge]=w.useState(0),[Pe,pt]=w.useState(!1),[wt,ze]=w.useState(!1),He=w.useRef(new Map),[rt,Re]=w.useState([]),ft=w.useRef({}),Mt=w.useCallback(ce=>{const Ve=typeof ce=="string"?parseFloat(ce):ce;return isNaN(Ve)?"$0.00":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Ve)},[]),Ue=w.useCallback(ce=>{if(!ce||!ce.client_data||!Array.isArray(ce.client_data)||ce.client_data.length===0)return!1;const Ve=ce.client_data[0];return Ve&&typeof Ve=="object"&&Object.keys(Ve).length>0},[]),rr=w.useCallback(ce=>{if(H.info("selectClientDetails called",{sourceFile:Vt,hasDetails:!!ce,detailsKeys:ce?Object.keys(ce):[]}),!ce){H.warn("selectClientDetails called with undefined details",{sourceFile:Vt}),O({}),re({}),$({}),ne({});return}H.info("Client details received for formatting",{sourceFile:Vt,clientDetails:ce});const Ve=ht=>{const Xt=ht.replace(/\D/g,"");return Xt.length===10?`(${Xt.slice(0,3)}) ${Xt.slice(3,6)}-${Xt.slice(6)}`:ht};let gt="";if(ce.primary_phone_number)gt=ce.primary_phone_number;else if(ce.phone_numbers)try{const ht=JSON.parse(ce.phone_numbers);Array.isArray(ht)&&ht.length>0&&(gt=ht[0].number||"")}catch{const ht=ce.phone_numbers;Array.isArray(ht)&&ht.length>0&&(gt=ht[0].number||"")}else ce.phones&&Array.isArray(ce.phones)&&(gt=ce.phones[0]||"");let mt="";if(ce.primary_email_address)mt=ce.primary_email_address;else if(ce.email_addresses)try{const ht=JSON.parse(ce.email_addresses);Array.isArray(ht)&&ht.length>0&&(mt=ht[0].address||"")}catch{const ht=ce.email_addresses;Array.isArray(ht)&&ht.length>0&&(mt=ht[0].address||"")}else ce.emails&&Array.isArray(ce.emails)&&(mt=ce.emails[0]||"");let ut="";try{let ht=[];ce.addresses&&(typeof ce.addresses=="string"?ht=JSON.parse(ce.addresses):ht=ce.addresses);const Xt=ht[0];Xt&&(ut=`${Xt.street?`${Xt.street}, `:""}${Xt.city?`${Xt.city}, `:""}${Xt.province?`${Xt.province}, `:""}${Xt.country?`${Xt.country} `:""}${Xt.postal_code?`${Xt.postal_code}`:""}`.trim())}catch{H.warn("Error formatting address",{sourceFile:Vt})}const yt={Name:ce.name||"",Email:mt||"",Phone:Ve(gt),Address:ut||""};H.info("Client details formatted and set",{sourceFile:Vt,selectedDetails:yt,originalDetails:ce}),O(ce),re(yt)},[H,Mt]),kt=w.useCallback(ce=>{H.info("selectCaseDetails called",{sourceFile:Vt,hasDetails:!!ce,detailsKeys:ce?Object.keys(ce):[]}),H.info("Case details received for formatting",{sourceFile:Vt,caseNames:ce});const Ve={"Matter Number":ce.name||"",Title:ce.description||"","Maildrop Address":ce.maildrop_address||"","Practice Area":ce.practice_area||"",Status:ce.status||"",Stage:ce.matter_stage||"","Assigned To":ce.responsible_attorney||"","Rate Type":ce.custom_rate||"","Outstanding Balance":Mt(ce.outstanding_balance||ce.balance_outstanding||ce.balance||0)};H.info("Case details formatted and set",{sourceFile:Vt,selectedDetails:Ve,originalDetails:ce}),ne(Ve)},[H,Mt]),vr=w.useCallback(ce=>{for(const Ve of He.current.values()){const gt=Ve.find(mt=>String(mt.id)===ce);if(gt&&gt.calendar_entries!==void 0)return gt}return null},[]),nr=w.useCallback(async(ce,Ve)=>{H.info("Matter manually selected",{sourceFile:Vt,matterId:ce.id,matterName:ce.description}),Ve!=null&&Ve.preservePagination||(e(""),b(!0)),N(!0),Ve!=null&&Ve.preservePagination||(zr(1),ge(1),He.current.clear());const gt=vr(ce.id);if(gt){H.info("Using cached matter data from page cache",{sourceFile:Vt,matterId:ce.id});const mt={};Object.entries(gt).forEach(([ht,Xt])=>{mt[ht]=String(Xt??"")}),$(mt),kt(mt);const ut=String(gt.id||ce.id||""),yt=(gt.calendar_entries||[]).map(ht=>({...ht,case_id:ut}));K(yt),Ve!=null&&Ve.preservePagination||(v([gt]),F(0));return}pt(!0),ze(!1);try{const mt=await i8("clio",ce.id,H);if(mt&&Object.keys(mt).length>0){const ut=mt.case_data||mt,yt=mt.client_data||{};H.info("Complete matter data fetched successfully",{sourceFile:Vt,matterId:ce.id,hasCalendarEntries:!!ut.calendar_entries,hasLastCompletedTask:!!ut.last_completed_task,hasNextUpcomingTask:!!ut.next_upcoming_task,hasClientData:!!yt&&Object.keys(yt).length>0});const ht={};if(Object.entries(ut).forEach(([Qr,ur])=>{ht[Qr]=String(ur??"")}),$(ht),kt(ht),yt&&Object.keys(yt).length>0){rr(yt);let Qr="";if(yt.primary_email_address)Qr=String(yt.primary_email_address);else if(yt.email_addresses)try{const ur=JSON.parse(String(yt.email_addresses));Array.isArray(ur)&&ur.length>0&&(Qr=ur[0].address||"")}catch{const ur=yt.email_addresses;Array.isArray(ur)&&ur.length>0&&(Qr=ur[0].address||"")}else yt.emails&&Array.isArray(yt.emails)&&(Qr=String(yt.emails[0]||""));Qr&&n(Qr)}const Xt=String(ut.id||ce.id||""),Yn=(ut.calendar_entries||[]).map(Qr=>({...Qr,case_id:Xt}));K(Yn),Ve!=null&&Ve.preservePagination||(v([ut]),F(0))}else{H.warn("Failed to fetch complete matter data, using basic data",{sourceFile:Vt,matterId:ce.id});const ut={};Object.entries(ce).forEach(([yt,ht])=>{ut[yt]=String(ht??"")}),$(ut),kt(ut),K([]),Ve!=null&&Ve.preservePagination||(v([ce]),F(0))}}catch(mt){H.error("Error fetching complete matter data",mt,{sourceFile:Vt,matterId:ce.id}),ze(!0);const ut={};Object.entries(ce).forEach(([yt,ht])=>{ut[yt]=String(ht??"")}),$(ut),kt(ut),K([]),Ve!=null&&Ve.preservePagination||(v([ce]),F(0))}finally{pt(!1)}},[H,e,n,b,N,v,F,kt,rr,K,vr]),Jt=w.useCallback(async(ce,Ve=!1)=>{if(ft.current[ce]){const mt=ft.current[ce];if("pagination"in mt&&mt.pagination!=null){console.log(` [Cache L1] Component cache HIT for ${ce}`),H.debug("Using cached client data (component cache)",{sourceFile:Vt,email:ce});return}console.log(` [Cache L1] Stale pre-pagination data for ${ce}, refetching`),delete ft.current[ce]}console.log(` [Cache L2] Checking browser storage for ${ce}...`);const gt=await Mm(ce,H);if(gt){if("pagination"in gt&&gt.pagination!=null){console.log(` [Cache L2] Browser storage HIT - SALVAGED data for ${ce}`),H.debug("Using cached client data (browser storage - salvaged)",{sourceFile:Vt,email:ce}),ft.current[ce]=gt;return}console.log(` [Cache L2] Stale pre-pagination data for ${ce}, clearing and refetching`),await jw(ce,H)}console.log(` [Cache L2] Browser storage MISS for ${ce}`);try{console.log(` [Cache L3] Fetching from SERVER for ${ce}...`),H.debug("Fetching client data from server",{sourceFile:Vt,email:ce});const mt=await ee.getCurrentThreadId(),ut=await V_("clio",ce,H,Ve,{limit:hr},mt);ft.current[ce]=ut}catch(mt){throw mt instanceof Error&&mt.message.includes("Client not found")?H.debug("Client not found for email",{sourceFile:Vt,email:ce}):H.error(`Error fetching client data for ${ce}`,mt,{sourceFile:Vt}),mt}},[H,ee]),$n=w.useCallback(async()=>{H.info("fetchUserData called",{sourceFile:Vt,clientEmail:r});try{const ce=await a8(H,"clio");Ne(ce)}catch(ce){H.error("Error processing user data",ce,{sourceFile:Vt})}},[H]),Un=w.useCallback(ce=>{var ht;ce.pagination?(ge(ce.pagination.total_matters),ce.pagination.matter_summaries&&Re(ce.pagination.matter_summaries),He.current.set(1,ce.case_data||[])):(ge(((ht=ce.case_data)==null?void 0:ht.length)??0),Re([]));const Ve=Ue(ce);if(L(r,Ve),!Ve){H.debug("Cached client data is not valid",{sourceFile:Vt,clientEmail:r}),$({}),v([]),K([]),re({}),ne({}),O({});return}const gt=ce.client_data[0];rr(gt);const mt=ce.case_data||[];v(mt),F(0);const ut=mt.flatMap(Xt=>{const Yn=String(Xt.id||"");return(Xt.calendar_entries||[]).map(ur=>({...ur,case_id:Yn}))});K(ut);const yt=mt.length>0?Object.entries(mt[0]).reduce((Xt,[Yn,Qr])=>(Xt[Yn]=String(Qr),Xt),{}):{};$(yt),kt(yt),_t(null)},[r,Ue,L,H,rr,kt,v,F]),Gs=w.useCallback(async(ce=!1)=>{var mt;if(H.info("fetchClientData called",{sourceFile:Vt,clientEmail:r,hasClientEmail:!!r}),!r){H.info("fetchClientData early return",{sourceFile:Vt,reason:r?"clio not connected":"no client email",clientEmail:r});return}ce&&delete ft.current[r];const Ve=ft.current[r];if(!ce&&Ve&&"pagination"in Ve&&Ve.pagination!=null){H.info("fetchClientData: L1 cache hit, restoring from component cache",{sourceFile:Vt,clientEmail:r}),Un(Ve);return}const gt=ce?null:await Mm(r,H);if(gt&&"pagination"in gt&&gt.pagination!=null){H.info("fetchClientData: L2 cache hit, restoring from browser cache",{sourceFile:Vt,clientEmail:r}),ft.current[r]=gt,Un(gt);return}He.current.clear(),zr(1),ge(0),Re([]),F(0);try{if(be(!0),_t(null),ce&&Ge(!1),H.info("fetchClientData: cache miss, fetching from server",{sourceFile:Vt,clientEmail:r}),!ft.current[r])try{if(await Jt(r,ce),de(r))return}catch(ur){ur instanceof Error&&ur.message.includes("(cached)")?H.debug("Using cached knowledge that this client doesn't exist",{sourceFile:Vt,clientEmail:r}):ur instanceof Error&&ur.message.includes("Client not found")?H.debug("Client not found",{sourceFile:Vt,clientEmail:r}):(H.error("Error fetching client data",ur,{sourceFile:Vt}),_t("both")),$({}),v([]),K([]),re({}),ne({}),O({}),be(!1);return}const ut=ft.current[r];if(ut!=null&&ut.pagination?(ge(ut.pagination.total_matters),ut.pagination.matter_summaries&&Re(ut.pagination.matter_summaries),He.current.set(1,ut.case_data||[])):(ge(((mt=ut==null?void 0:ut.case_data)==null?void 0:mt.length)??0),Re([])),!ut){$({}),v([]),K([]),re({}),ne({}),O({}),be(!1),L(r,!1);return}const yt=Ue(ut);if(!yt&&ut._rate_limited){Ge(!0),_t("rate_limited"),$({}),v([]),K([]),re({}),ne({}),O({}),be(!1);return}if(L(r,yt),!yt){H.debug("Client data exists but is not valid",{sourceFile:Vt,clientEmail:r}),$({}),v([]),K([]),re({}),ne({}),O({}),be(!1);return}if(de(r))return;const ht=ut.client_data[0];H.debug("Client data received",{sourceFile:Vt,clientDataAsRecord:ht}),rr(ht);const Xt=ut.case_data||[];v(Xt),F(0);const Yn=Xt.flatMap(ur=>{const at=String(ur.id||"");return(ur.calendar_entries||[]).map(Le=>({...Le,case_id:at}))});K(Yn);const Qr=Xt.length>0?Object.entries(Xt[0]).reduce((ur,[at,Q])=>(ur[at]=String(Q),ur),{}):{};if($(Qr),kt(Qr),ut._rate_limited){const ur=ut.client_data.length>0||ut.case_data.length>0;H.info("Rate-limited response",{sourceFile:Vt,clientEmail:r,hasCachedData:ur,retryAfter:ut._retry_after}),Ge(!0),ur||_t("rate_limited")}}catch(ut){H.error("Error processing client data",ut,{sourceFile:Vt}),_t("both"),$({}),v([]),K([]),r&&L(r,!1)}finally{be(!1)}},[r,Jt,H,rr,kt,v,L,Ue,F,Un]),Cs=w.useCallback(ce=>{if(ce===Ur||ce<1)return;const Ve=rt.length>0?rt.length:kr,gt=Math.ceil(Ve/hr);if(!(ce>gt)){if(ce===1&&He.current.get(1))v(He.current.get(1));else{const mt=(ce-1)*hr,yt=rt.slice(mt,mt+hr).map(ht=>({id:ht.id,description:ht.description,display_number:ht.display_number}));v(yt)}zr(ce),F(0),rt.length>0&&ge(rt.length)}},[Ur,rt,kr,v,F]);w.useEffect(()=>{const ce=async()=>{if(!await wT(H))try{const mt=(await jT("clio",H)).map(({id:ut,name:yt})=>({id:ut,name:yt}));await xT(mt,H)}catch(gt){H.error("Error fetching firm users",gt,{sourceFile:Vt})}};$n(),ce()},[]),w.useEffect(()=>{(async()=>{var Ve,gt,mt,ut;if(ae&&ae.clio){const yt=((gt=(Ve=ae==null?void 0:ae.clio)==null?void 0:Ve.timeTracking)==null?void 0:gt.enabled)||!1;ct(yt);return}try{const yt=await me.getLocalItem("integrationSettings");if(yt&&yt.clio){const ht=((ut=(mt=yt==null?void 0:yt.clio)==null?void 0:mt.timeTracking)==null?void 0:ut.enabled)||!1;ct(ht)}else ct(!1)}catch(yt){H.error("Failed to fetch integration settings from storage",yt,{sourceFile:Vt}),ct(!1)}})()},[ae]),w.useEffect(()=>{q>0&&(H.info("Clearing component cache due to refresh trigger",{sourceFile:Vt,refreshTrigger:q}),ft.current={},Promise.all(s.map(ce=>jw(ce,H))).catch(ce=>{H.error("Failed to clear L2 cache during refresh",ce,{sourceFile:Vt})}),Kt(!1),r&&Gs(!0))},[q]),w.useEffect(()=>{Kt(!1),s.length===0&&Gt([])},[s]);const Tr=w.useCallback(()=>{H.info("All participant validations complete",{sourceFile:Vt,participantCount:s.length}),Kt(!0)},[H,s.length]),yn=w.useCallback(ce=>!!ce._rate_limited,[]);tK({emailParticipants:s,getClientDetailsForEmail:Jt,clientDataCache:ft,isValidClientData:Ue,onClientDataValidated:L,refreshTrigger:q,onTransientError:G,onValidationComplete:Tr,isRateLimitedData:yn}),w.useEffect(()=>{H.info("useEffect: client email or connection changed",{sourceFile:Vt,clientEmail:r,willFetchData:!!r}),r&&(H.info("Fetching client data for email",{sourceFile:Vt,clientEmail:r,isPrefetchEnabled:fe}),Gs(),n(r),x&&!s.includes(r.toLowerCase())&&H.debug("Manually set email not in participants, validating separately",{sourceFile:Vt,clientEmail:r}))},[r,Gs,n,x,s,H,fe]),w.useEffect(()=>{!x&&(!r||s.length===0)&&(n(null),re({}),ne({}),K([]))},[r,s.length,x,n,re,ne]),w.useEffect(()=>{if(H.info("useEffect: case index changed",{sourceFile:Vt,currentCaseIndex:m,casesCount:p.length,willUpdateCaseDetails:p.length>0&&m<p.length}),p.length>0&&m<p.length){const ce=p[m];H.info("Updating case details for index",{sourceFile:Vt,currentCaseIndex:m,caseData:ce?Object.keys(ce):null});const Ve=ce?Object.entries(ce).reduce((gt,[mt,ut])=>(gt[mt]=String(ut),gt),{}):{};$(Ve),kt(Ve),H.info("Case details updated",{sourceFile:Vt,formattedCaseData:Ve})}},[m,p,kt,H]);const go=w.useCallback(ce=>{H.info("Contacts created, storing for matter linking",{sourceFile:Vt,contactCount:ce.length}),Gt(ce)},[H]),Mo=w.useCallback(ce=>{H.info("Contact linked to matter successfully",{sourceFile:Vt})},[H]),En=w.useCallback(async ce=>{var gt,mt;be(!0);const Ve={id:((mt=(gt=ce.projectId)==null?void 0:gt.native)==null?void 0:mt.toString())||"",description:ce.projectName||"",practice_area:ce.projectTypeName||"",matter_stage:ce.phaseName||"",status:ce.isArchived?"Closed":"Open",client_name:ce.clientName||"",responsible_attorney:ce.firstPrimaryName||"",url:ce.projectUrl||"",name:ce.projectName||""};await nr(Ve).then(()=>{be(!1)})},[nr]),Ws=w.useCallback(ce=>{const Ve=ft.current[ce]?ft.current[ce]:ft.current[ce.toLowerCase()];if(Ve!=null&&Ve.client_data&&Array.isArray(Ve.client_data)&&Ve.client_data.length>0){const gt=Ve.client_data[0];return String(gt.name||"")}return null},[]),Vs=(Ie==="client"||Ie==="both"||Ie==="rate_limited")&&!he,Li=(Ie==="matter"||Ie==="both"||Ie==="rate_limited")&&!he,cn=(Ie==="rate_limited"||Be)&&!he;return Y?u.jsxs("div",{className:"relative h-full",children:[u.jsxs("div",{className:"space-y-4 overflow-y-auto h-full mt-0 pb-32",children:[u.jsx(HP,{onMatterSelected:En}),u.jsx(Jq,{clientEmail:r,emailParticipants:s,emailParticipantClients:i,currentClientIndex:c,setCurrentClientIndex:d,setClientEmail:e,isManuallySet:x,selectedClientDetails:U,linkableFields:[{field:"Name",url:X.url||""}].filter(ce=>ce.url),isLoading:he,ClientNavigation:j,handleSectionClick:()=>{},tempClientEmail:t||"",setTempClientEmail:n,setIsManuallySet:b,isValidClient:E||!1,isTempEmailValid:T||!1,showClientDocumentsButton:!1,isValidating:z,fetchError:Vs,isRateLimited:cn,hasTransientError:oe,onContactsCreated:go,getClientNameFromCache:Ws,isClientDataValidationComplete:$t}),u.jsx(Xq,{clientEmail:r,selectedCaseDetails:Ee,casesForCurrentClient:p,currentCaseIndex:m,linkableFields:[{field:"Title",url:J.url||""}].filter(ce=>ce.url),nextCase:A,prevCase:R,isLoading:he,isManuallySet:x,setCurrentCaseIndex:F,calendarEntries:we,isValidating:z,matterId:J.id||"",onMatterManuallySelected:nr,fetchError:Li,isRateLimited:cn,userData:qe,createdContacts:Ct,onMatterLinked:Mo,pageSize:hr,currentPage:Ur,totalMatters:kr,onNavigateToPage:Cs,allMatterSummaries:rt,isLoadingMatterDetails:Pe,matterDetailError:wt})]}),St&&u.jsx("div",{className:"fixed bottom-5 left-4 right-4 z-10 shadow-[0_-4px_12px_rgba(0,0,0,0.1)]",children:u.jsx(oK,{userData:qe,clientEmail:r,emailParticipantClients:i,currentCaseIndex:m,casesForCurrentClient:p})})]}):(H.info("ClioInsights not rendering - Clio not connected",{sourceFile:Vt,isClioConnected:Y}),null)},aK=({clientEmail:r,emailParticipants:e,emailParticipantClients:t,currentClientIndex:n,setCurrentClientIndex:s,setClientEmail:i,isManuallySet:c,selectedClientDetails:d,isLoading:m,ClientNavigation:p,handleSectionClick:v,tempClientEmail:x,setTempClientEmail:b,setIsManuallySet:S,isValidClient:N,isTempEmailValid:E,isValidating:T})=>{const A=()=>u.jsx(Bs,{rows:2});return u.jsxs("div",{className:"w-full min-h-[4rem] border border-border/50 rounded-lg shadow-sm bg-card text-card-foreground",title:"Client Information",children:[u.jsxs("div",{className:"flex items-center justify-between p-2 border-b bg-muted",children:[u.jsx("div",{className:"flex items-center gap-2",children:u.jsx("a",{href:"https://global.inszoom.com/CorpAttorney/aty_dashboard.aspx?phn_msg=False&QLogin=Y",target:"_blank",rel:"noopener noreferrer",className:"font-medium text-sm ml-2 hover:opacity-80 text-blue-700 dark:text-blue-400 underline underline-offset-4 decoration-blue-700 dark:decoration-blue-400 transition-opacity cursor-pointer",children:"CLIENT"})}),u.jsxs(jo,{children:[u.jsx(Oo,{asChild:!0,children:u.jsx(We,{variant:"ghost",size:"icon",className:"h-6 w-6",children:u.jsx(Ri,{className:"h-4 w-4"})})}),u.jsx(co,{align:"end",className:"p-2",children:u.jsx("div",{className:"flex flex-col gap-2 w-64",children:u.jsxs("div",{className:"flex gap-2 items-center",children:[u.jsx(vn,{type:"email",value:x||"",onChange:R=>b(R.target.value),placeholder:"Set client email",className:`flex-1 px-2 py-1 h-8 text-xs ${E===!1?"border-red-300 focus:ring-red-500":""}`}),u.jsx(We,{variant:"outline",size:"sm",className:`h-8 text-xs px-2 ${E===!1?"bg-red-50 hover:bg-red-100":""}`,onClick:()=>{i(x||"",!0)},disabled:!x,title:E===!1?"Warning: This email is not recognized as a valid client in INSZoom":"Set email as current client",children:"Search"})]})})})]})]}),m?A():u.jsxs(u.Fragment,{children:[t.length>1&&!c&&u.jsx(p,{}),c&&r&&u.jsx("div",{className:"px-3 py-1 bg-gray-50 dark:bg-gray-800 border-b dark:border-gray-700",children:u.jsxs("span",{className:"text-xs text-gray-600 dark:text-gray-300 truncate max-w-[200px]",title:r||"",children:[r," (Manually set)"]})}),T&&e.length>0&&t.length===0&&!c?u.jsx(Bs,{rows:2}):d&&Object.keys(d).length>0?u.jsx(Ql,{details:d}):u.jsx("div",{className:"p-3 text-sm text-gray-600 dark:text-gray-400",children:u.jsx("p",{className:"mb-2",children:c&&r?`No client information found for ${r}`:e.length>0&&t.length===0?`No client information available for emails on the selected thread:
                      ${e.join(", ")}`:e.length>0?"No client information available for the selected email ID":"Select a clientemail thread to view client information"})})]})]})},lK=({clientEmail:r,selectedCaseDetails:e,casesForCurrentClient:t,currentCaseIndex:n,caseDetails:s,nextCase:i,prevCase:c,isLoading:d,setCurrentCaseIndex:m,isValidating:p=!1})=>{const[v,x]=w.useState(""),[b,S]=w.useState(!1),N=w.useMemo(()=>{if(!v.trim())return t;const R=v.toLowerCase();return t.filter(F=>{var L;return String(F.projectName||((L=F.Data)==null?void 0:L.CaseDescription)||"").toLowerCase().includes(R)})},[t,v]),E=R=>{S(R),R||x("")},T=()=>u.jsx(Bs,{rows:2}),A=R=>{if(m)m(R);else if(R>n)for(let F=n;F<R;F++)i();else if(R<n)for(let F=n;F>R;F--)c()};return u.jsxs("div",{className:"w-full min-h-[4rem] border border-border/50 rounded-lg shadow-sm bg-card text-card-foreground",title:"Case Information",children:[u.jsx("div",{className:"flex items-center justify-between p-2 border-b bg-muted",children:u.jsx("div",{className:"flex items-center gap-2",children:u.jsx("a",{href:"https://global.inszoom.com/CorpAttorney/aty_dashboard.aspx?phn_msg=False&QLogin=Y",target:"_blank",rel:"noopener noreferrer",className:"font-medium text-sm ml-2 hover:opacity-80 text-blue-700 dark:text-blue-400 underline underline-offset-4 decoration-blue-700 dark:decoration-blue-400 transition-opacity cursor-pointer",children:"CASES"})})}),d?T():e&&Object.keys(e).length>0?u.jsxs(u.Fragment,{children:[t.length>1&&u.jsx("div",{className:"flex justify-between items-center px-3 py-1 bg-gray-50 dark:bg-gray-800 border-b dark:border-gray-700",children:u.jsx("div",{className:"flex-1 flex items-center",children:u.jsxs(jo,{open:b,onOpenChange:E,children:[u.jsx(Oo,{asChild:!0,children:u.jsxs(We,{variant:"ghost",size:"sm",className:"h-8 text-sm text-gray-600 dark:text-gray-300 flex items-center gap-1 px-2",children:[u.jsx("span",{className:"truncate max-w-[180px]",title:e.Title||e["Case Description"]||"",children:e.Title||e["Case Description"]||"Case"}),u.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["(",n+1,"/",t.length,")"]}),u.jsx(xs,{className:"w-3 h-3 ml-1"})]})}),u.jsxs(co,{align:"start",className:"w-[280px] p-0",children:[u.jsxs("div",{className:"p-2 border-b border-gray-200 dark:border-gray-700",children:[u.jsxs("div",{className:"relative",children:[u.jsx(Ri,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),u.jsx(vn,{placeholder:"Search cases...",value:v,onChange:R=>x(R.target.value),className:"pl-8 pr-8 h-8 text-xs",autoFocus:!0,onClick:R=>R.stopPropagation(),onKeyDown:R=>R.stopPropagation()}),v&&u.jsx("button",{onClick:R=>{R.stopPropagation(),x("")},className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:u.jsx(aa,{className:"w-4 h-4"})})]}),v&&u.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:["Showing ",N.length," of ",t.length]})]}),u.jsx("div",{className:"max-h-[200px] overflow-y-auto",children:N.length>0?N.map((R,F)=>{var G;const j=t.findIndex(z=>z===R),L=String(R.projectName||((G=R.Data)==null?void 0:G.CaseDescription)||`Case ${j+1}`);return u.jsx(bs,{className:`text-xs truncate ${j===n?"bg-gray-100 dark:bg-gray-700 font-medium":""}`,onClick:()=>A(j),title:L,children:L},j)}):u.jsxs("div",{className:"p-3 text-xs text-center text-gray-500 dark:text-gray-400",children:['No cases match "',v,'"']})})]})]})})}),u.jsx("div",{className:"break-words overflow-hidden",children:u.jsx(Ql,{details:e,linkableFields:[{field:"Title",url:s.projectUrl}]})})]}):p?u.jsx(Bs,{rows:2}):u.jsx("div",{className:"p-3 text-sm text-gray-600 dark:text-gray-400",children:r?u.jsx(u.Fragment,{children:u.jsx("p",{className:"mb-2",children:"Select a client email thread to view case information"})}):"Select a client email thread to view case information"})]})},Rr="src/sidepanel/panels/InsZoomInsights.tsx",ei=r=>{if(!r)return"";try{return new Date(r).toLocaleDateString(void 0,{timeZone:"UTC"})}catch{return r}},v1=r=>{if(console.log("caseData",r),!r||Object.keys(r).length===0)return{};const e=n=>n.replace(/([a-z])([A-Z])/g,"$1 $2");return Object.entries(r).reduce((n,[s,i])=>{if(i!==null&&typeof i=="object"&&!Array.isArray(i)){let c=Object.entries(i);if(s==="report_fields")return Object.fromEntries(c),c.filter(([x,b])=>x!=="i797_valid_from"&&x!=="i797_valid_to"&&b!==null&&b!==void 0).forEach(([x,b])=>{const S=x.replace(/_/g," ").replace(/\b\w/g,E=>E.toUpperCase()).replace(/I797/g,"I-797").replace(/H Or L/g,"H/L");let N=String(b);N.includes(" 00:00:00")&&(N=ei(N.split(" ")[0])),n[S]=N}),console.log("promoted report_fields to top level",Object.keys(n)),n;s==="MilestoneCompletedDate"&&(c=c.sort(([,x],[,b])=>{const S=new Date(String(x)),N=new Date(String(b)),E=!isNaN(S.getTime()),T=!isNaN(N.getTime());return E&&T?N.getTime()-S.getTime():E&&!T?-1:!E&&T?1:0}));const d=[],m=[];c.forEach(([x,b])=>{const S=new Date(String(b));!isNaN(S.getTime())?d.push([x,b]):m.push([x,b])});const p=d.map(([x,b])=>`[[${e(x)}]]:
    ((${b}))
`).join(`
`),v=m.length>0?`
[[Not Completed:]]
${m.map(([x])=>`  - ${e(x)}`).join(`
`)}
`:"";n[s]=p+v}else{const c=i!=null?String(i):"";c.includes(`
`)?n[s]=`
  ${c.replace(/\n/g,`
  `)}`:n[s]=c}return n},{})},cK=({clientEmail:r,setClientEmail:e,tempClientEmail:t,setTempClientEmail:n,emailParticipants:s,emailParticipantClients:i,currentClientIndex:c,setCurrentClientIndex:d,currentCaseIndex:m,casesForCurrentClient:p,setCasesForCurrentClient:v,isManuallySet:x,setIsManuallySet:b,isProjectManuallySelected:S,setIsProjectManuallySelected:N,isValidClient:E,isTempEmailValid:T,nextCase:A,prevCase:R,handleSetCurrentCaseIndex:F,ClientNavigation:j,onClientDataValidated:L,isValidating:G,refreshTrigger:z,integrationSettings:q,isPrefetchEnabled:ae})=>{const oe=Gr(),fe=ua(),[H]=w.useState(!0),[me,ee]=w.useState({}),[se,de]=w.useState({}),[Y,J]=w.useState({}),[$,X]=w.useState(!1),O=w.useRef({}),U=w.useCallback(K=>{if(!K||!K.client_data)return!1;const he=K.client_data;return he&&typeof he=="object"&&Object.keys(he).length>0},[]),re=w.useCallback(async(K,he=!1)=>{if(oe.info("getClientDetailsForEmail called",{sourceFile:Rr,email:K,hasCachedData:!!O.current[K],forceRefresh:he}),he&&O.current[K]&&(oe.info("Force refresh requested - clearing component cache",{sourceFile:Rr,email:K}),delete O.current[K]),O.current[K]&&!he){oe.info("Using cached client data",{sourceFile:Rr,email:K}),oe.debug("Using cached client data",{sourceFile:Rr,email:K});return}try{oe.info("Starting client data fetch from server",{sourceFile:Rr,email:K,forceRefresh:he}),oe.debug("Fetching client data",{sourceFile:Rr,email:K,forceRefresh:he});const be=await fe.getCurrentThreadId(),Ie=await V_("inszoom",K,oe,he,void 0,be),_t=Array.isArray(Ie==null?void 0:Ie.client_data)?Ie.client_data[0]:Ie==null?void 0:Ie.client_data;if(Ie&&_t&&_t.Data){const Be=_t.Data;let Ge="",qe="",Ne="",St="";Be.ArrivalAndDepartureDetails&&typeof Be.ArrivalAndDepartureDetails=="object"&&Be.ArrivalAndDepartureDetails!==null&&"ImmigrantStatusOnI94"in Be.ArrivalAndDepartureDetails&&(Ge=String(Be.ArrivalAndDepartureDetails.ImmigrantStatusOnI94||""),qe=ei(String(Be.ArrivalAndDepartureDetails.I94ValidFrom||"")),Ne=ei(String(Be.ArrivalAndDepartureDetails.DateOfExpiration||"")),St=String(Be.ArrivalAndDepartureDetails.I94Number||""));const ct={...Ie.client_data,FirstName:String(Be.FirstName||""),LastName:String(Be.LastName||""),Email:String(Be.Email||K),FileNumber:String(Be.FileNumber||""),Category:String(Be.Category||""),ImmigrantStatusOnI94:Ge,I94ValidFrom:qe,I94ValidTo:Ne,I94Number:St,...Be.report_fields&&{report_fields:Be.report_fields}};O.current[K]={client_data:ct,case_data:Ie.case_data||[],timestamp:Date.now()}}else O.current[K]={client_data:Ie.client_data,case_data:[],timestamp:Date.now()}}catch(be){throw be instanceof Error&&(be.message.includes("Client not found")||be.message.includes("(cached)"))?oe.debug("Client not found for email (including cached)",{sourceFile:Rr,email:K}):oe.error(`Error fetching client data for ${K}`,be,{sourceFile:Rr}),be}},[oe,fe]),Ee=w.useCallback(K=>{oe.info("selectClientDetails called",{sourceFile:Rr,hasDetails:!!K,detailsKeys:K?Object.keys(K):[]}),oe.debug("Client details received for formatting",{sourceFile:Rr,details:K});const he=K.FirstName&&K.LastName?`${K.FirstName} ${K.LastName}`:K.fullName||"";let be="";if(K.visa_details&&typeof K.visa_details=="object"&&K.visa_details!==null){const Ge=K.visa_details;Ge.Data&&Array.isArray(Ge.Data)&&(be=Ge.Data.map(Ne=>{const St=String(Ne.VisaType||""),ct=ei(String(Ne.IssuanceDate||"")),Ct=ei(String(Ne.ExpirationDate||""));return`[[${St}]]:
${ct} - ${Ct}
`}).join(`
`))}let Ie="";if(K.passport_details&&typeof K.passport_details=="object"&&K.passport_details!==null){const Ge=K.passport_details;Ge.Data&&Array.isArray(Ge.Data)&&(Ie=Ge.Data.map(Ne=>{const St=String(Ne.PassportNo||""),ct=String(Ne.PassportType||""),Ct=String(Ne.PassportIssuingCountry||""),Gt=ei(String(Ne.PassportIssuanceDate||"")),$t=ei(String(Ne.PassportExpirationDate||""));return`[[${Ct} (${ct})]]
${St} :
${Gt} - ${$t}
`}).join(`
`))}let _t="";if(K.report_fields&&typeof K.report_fields=="object"&&K.report_fields!==null){const Ge=K.report_fields,qe=Ge.priority_date_1||"",Ne=Ge.priority_date_1_country||"",St=Ge.priority_date_2||"",ct=Ge.priority_date_2_country||"",Ct=[];if(qe||Ne){const Gt=`${qe}${Ne?` [${Ne}]`:""}`;Ct.push(Gt)}if(St||ct){const Gt=`${St}${ct?` [${ct}]`:""}`;Ct.push(Gt)}Ct.length>0&&(_t=Ct.join(`
`))}const Be={Name:he,"Immigration Status":K.ImmigrantStatusOnI94||"","I-94 Number":K.I94Number||"","I-94 Validity":`${K.I94ValidFrom} - ${K.I94ValidTo}`||""};if(K.report_fields&&typeof K.report_fields=="object"&&K.report_fields!==null){const Ge=K.report_fields,qe=Ge.i797_status||"";Be["I-797 Status"]=qe;const Ne=Ge.i797_valid_from||"",St=Ge.i797_valid_to||"";if(Ne&&Ne.trim()!==""||St&&St.trim()!==""){const ct=Ne?ei(Ne.split(" ")[0]):"",Ct=St?ei(St.split(" ")[0]):"";Be["I-797 Validity"]=`${ct} - ${Ct}`}else Be["I-797 Validity"]=""}else Be["I-797 Status"]="",Be["I-797 Validity"]="";if(Be["Passport Details"]=Ie,Be["Visa Details"]=be,K.report_fields&&typeof K.report_fields=="object"&&K.report_fields!==null){const qe=K.report_fields.h_or_l_max_out_date||"";qe&&qe.includes(" 00:00:00")?Be["H/L Maxout Date"]=ei(qe.split(" ")[0]):Be["H/L Maxout Date"]=qe}else Be["H/L Maxout Date"]="";if(Be["Priority Dates"]=_t,K.report_fields&&typeof K.report_fields=="object"&&K.report_fields!==null){const qe=K.report_fields.maxout_date_applicability_notes||"";Be["Maxout Date Applicability and Notes"]=qe}else Be["Maxout Date Applicability and Notes"]="";oe.info("Client details formatted and set",{sourceFile:Rr,selectedDetails:Be,originalDetails:K}),de(Be)},[oe]),ne=w.useCallback(K=>{oe.info("selectCaseDetails called",{sourceFile:Rr,hasDetails:!!K,details:K||[]});const he={"Case Description":K.CaseDescription||K.projectName||"","Case Manager":K.WorkingCaseManagers_names||"","Case Status":K.CaseStatus||"","Opened Date":ei(K.CaseOpenedDate)||"","Date Filed":ei(K.DateSentToGovt)||""};he["Last Step Completed"]=K["Last Step Completed"]||"",he["Last Step Completed Date"]=ei(K["Last Step Completed Date"])||"",he["Receipt Number"]=K["Receipt Number"]||"",he["Case Main Receipt Status"]=K["Case Main Receipt Status"]||"",oe.info("Case details formatted and set",{sourceFile:Rr,selectedDetails:he,originalDetails:K}),J(he)},[oe]),we=w.useCallback(async(K=!1)=>{if(oe.info("fetchClientData called",{sourceFile:Rr,clientEmail:r,isINSZoomConnected:H,hasClientEmail:!!r,forceRefresh:K}),!r||!H){oe.info("fetchClientData early return",{sourceFile:Rr,reason:r?"INSZoom not connected":"no client email",clientEmail:r,isINSZoomConnected:H});return}try{if(X(!0),oe.info("fetchClientData: fetching from server",{sourceFile:Rr,clientEmail:r,forceRefresh:K}),K||!O.current[r]||O.current[r].timestamp<Date.now()-1e3*60*60*24)try{await re(r,K)}catch(Ge){Ge instanceof Error&&Ge.message.includes("(cached)")?oe.debug("Using cached knowledge that this client doesn't exist",{sourceFile:Rr,clientEmail:r}):oe.error("Error fetching client data",Ge,{sourceFile:Rr}),ee({}),v([]),de({}),J({}),X(!1);return}const he=O.current[r];if(!he){ee({}),v([]),de({}),J({}),X(!1),L(r,!1);return}const be=U(he);if(L(r,be),!be){oe.debug("Client data exists but is not valid",{sourceFile:Rr,clientEmail:r}),ee({}),v([]),de({}),J({}),X(!1);return}const Ie=he.client_data;Ee(Ie);const Be=(he.case_data||[]).sort((Ge,qe)=>{const Ne=Ge.Data||Ge,St=qe.Data||qe,ct=Ne.CaseOpenedDate,Ct=St.CaseOpenedDate;if(!ct&&!Ct)return 0;if(!ct)return 1;if(!Ct)return-1;const Gt=new Date(ct),$t=new Date(Ct),Kt=!isNaN(Gt.getTime()),hr=!isNaN($t.getTime());return!Kt&&!hr?0:Kt?hr?$t.getTime()-Gt.getTime():-1:1});if(v(Be),Be.length>0){const Ge=Be[0].Data||Be[0],qe=v1(Ge);ee(qe),ne(qe)}else ee({}),ne({})}catch(he){oe.error("Error processing client data",he,{sourceFile:Rr}),ee({}),v([]),r&&L(r,!1)}finally{X(!1)}},[r,H,re,oe,Ee,ne,v,L,U]);return w.useEffect(()=>{G&&s.length>0&&(O.current={},oe.debug("Cleared component-level client data cache for refresh",{sourceFile:Rr}))},[G,s.length,oe]),w.useEffect(()=>{const K=async()=>{if(H){oe.info("Validating all email participants",{sourceFile:Rr,participantCount:s.length});for(const he of s)try{await re(he);const be=O.current[he],Ie=U(be);L(he,Ie),oe.debug("Participant validation result",{sourceFile:Rr,email:he,hasValidData:Ie})}catch(be){oe.debug("Participant validation failed",{sourceFile:Rr,email:he,error:be}),L(he,!1)}}};s.length>0&&H&&K()},[s,H,re,U,L,oe,z]),w.useEffect(()=>{oe.info("useEffect: client email or connection changed",{sourceFile:Rr,clientEmail:r,isINSZoomConnected:H,willFetchData:!!(r&&H)}),r&&H&&(oe.info("Fetching client data for email",{sourceFile:Rr,clientEmail:r,isPrefetchEnabled:ae}),we(x),n(r),x&&!s.includes(r.toLowerCase())&&oe.debug("Manually set email not in participants, validating separately",{sourceFile:Rr,clientEmail:r}))},[r,H,we,n,x,s,oe,ae]),w.useEffect(()=>{(!r||s.length===0&&!x)&&(n(null),de({}),J({}))},[r,s.length,x,n,de,J]),w.useEffect(()=>{if(oe.info("useEffect: case index changed",{sourceFile:Rr,currentCaseIndex:m,casesCount:p.length,willUpdateCaseDetails:p.length>0&&m<p.length}),p.length>0&&m<p.length){const K=p[m];oe.info("Updating case details for index",{sourceFile:Rr,currentCaseIndex:m,caseData:K?Object.keys(K):null});const he=K.Data||K,be=v1(he);ee(be),ne(be),oe.info("Case details updated",{sourceFile:Rr,formattedCaseData:Object.keys(be)})}},[m,p,ne,oe]),H?(oe.info("INSZoomInsights rendering components",{sourceFile:Rr,clientEmail:r,selectedClientDetails:Object.keys(se),selectedCaseDetails:Object.keys(Y),isLoading:$}),u.jsxs("div",{className:"space-y-4 overflow-y-auto h-full mt-0",children:[u.jsx(aK,{clientEmail:r,emailParticipants:s,emailParticipantClients:i,currentClientIndex:c,setCurrentClientIndex:d,setClientEmail:e,isManuallySet:x,selectedClientDetails:se,isLoading:$,ClientNavigation:j,handleSectionClick:()=>{},tempClientEmail:t,setTempClientEmail:n,setIsManuallySet:b,isValidClient:E,isTempEmailValid:T,isValidating:G}),u.jsx(lK,{clientEmail:r,selectedCaseDetails:Y,casesForCurrentClient:p,currentCaseIndex:m,caseDetails:me,nextCase:A,prevCase:R,isLoading:$,setCurrentCaseIndex:F,isValidating:G})]})):(oe.info("INSZoomInsights not rendering - INSZoom not connected",{sourceFile:Rr,isINSZoomConnected:H}),null)},uK=/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;function dK(r){return r.filter(e=>e&&e.trim().length>0&&uK.test(e.trim())).map(e=>e.trim().toLowerCase())}function fK(r,e){if(!e)return r;const t=e.toLowerCase(),n=t.split("@")[1];return n?["gmail.com","googlemail.com","outlook.com","hotmail.com","live.com","yahoo.com","ymail.com","aol.com","icloud.com","me.com","mac.com","protonmail.com","proton.me","mail.com","zoho.com","gmx.com","gmx.net","trycandle.ai"].includes(n)?r.filter(c=>c.toLowerCase()!==t):r.filter(c=>c.toLowerCase().split("@")[1]!==n):r}const fF={rawParticipants:[],sanitizedParticipants:[],emailsWithValidData:new Set,validatedEmails:new Set,selectedClient:"",isValidating:!1,isManuallySet:!1,isProjectManuallySelected:!1,refreshTrigger:0,integrationSettings:{},hasTransientError:!1};function hK(r,e){var t,n;switch(e.type){case"SET_RAW_PARTICIPANTS":{const s=dK(e.participants);return console.log(" [Reducer] SET_RAW_PARTICIPANTS:",{rawCount:((t=e.participants)==null?void 0:t.length)??0,sanitizedCount:s.length,raw:e.participants,sanitized:s,filtered:(n=e.participants)==null?void 0:n.filter(i=>!s.includes(i.toLowerCase().trim()))}),JSON.stringify(s)===JSON.stringify(r.sanitizedParticipants)?(console.log(" [Reducer] Participants unchanged, skipping update"),r):{...r,rawParticipants:e.participants,sanitizedParticipants:s,isValidating:s.length>0}}case"MARK_EMAIL_VALIDATED":{const s=new Set(r.validatedEmails);s.add(e.email.toLowerCase());const i=new Set(r.emailsWithValidData),c=e.email.toLowerCase(),d=r.selectedClient&&c===r.selectedClient.toLowerCase();e.isValid?i.add(c):(!r.isValidating||!d)&&i.delete(c);const m=r.sanitizedParticipants.length>0&&s.size>=r.sanitizedParticipants.length;return m&&d&&!e.isValid&&i.delete(c),{...r,validatedEmails:s,emailsWithValidData:i,isValidating:!m}}case"SELECT_CLIENT":return{...r,selectedClient:e.email,isManuallySet:e.isManual};case"SET_MANUALLY_SET":return{...r,isManuallySet:e.value};case"SET_PROJECT_MANUALLY_SELECTED":return{...r,isProjectManuallySelected:e.value};case"START_VALIDATION":return{...r,isValidating:!0};case"COMPLETE_VALIDATION":return{...r,isValidating:!1};case"RESET_STATE":return{...fF,refreshTrigger:r.refreshTrigger,hasTransientError:!1};case"REFRESH_DATA":{const s=new Set;return r.selectedClient&&s.add(r.selectedClient.toLowerCase()),{...r,emailsWithValidData:s,validatedEmails:new Set,isValidating:!0,isManuallySet:!1,isProjectManuallySelected:!1,refreshTrigger:r.refreshTrigger+1,hasTransientError:!1}}case"SET_INTEGRATION_SETTINGS":return{...r,integrationSettings:e.settings};case"SET_TRANSIENT_ERROR":return{...r,hasTransientError:e.hasError};default:return r}}function pK({platform:r,dataProvider:e,isIntegrationConnected:t}){const n=Gr(),[s,i]=w.useReducer(hK,fF),c=w.useRef(!1),d=w.useRef(0),m=Qa();w.useEffect(()=>{(async()=>{try{const ae=await OT(n);Object.keys(ae).length>0&&await m.setLocalItem("integrationSettings",ae),i({type:"SET_INTEGRATION_SETTINGS",settings:ae})}catch(ae){n.error("Failed to fetch integration settings",ae,{sourceFile:"src/shared/hooks/useEmailParticipants.ts"})}})()},[n]);const p=s.sanitizedParticipants.filter(q=>s.emailsWithValidData.has(q.toLowerCase())),v=Math.max(0,p.indexOf(s.selectedClient)),x=w.useCallback((q,ae)=>{n.info("Client data validation result received",{sourceFile:"useEmailParticipants.ts",email:q,isValid:ae}),i({type:"MARK_EMAIL_VALIDATED",email:q,isValid:ae}),ae&&i({type:"SET_TRANSIENT_ERROR",hasError:!1})},[n]),b=w.useCallback((q,ae=!1)=>{i({type:"SELECT_CLIENT",email:q,isManual:ae})},[]),S=w.useCallback(q=>{i({type:"SET_MANUALLY_SET",value:q})},[]),N=w.useCallback(q=>{i({type:"SET_PROJECT_MANUALLY_SELECTED",value:q})},[]),E=w.useCallback((q,ae)=>{n.warn("Transient error during validation - user should try again later",{sourceFile:"useEmailParticipants.ts",email:q,error:ae.message}),i({type:"SET_TRANSIENT_ERROR",hasError:!0})},[n]),T=w.useCallback(()=>{n.debug("Resetting participant state",{sourceFile:"useEmailParticipants.ts"}),i({type:"RESET_STATE"})},[n]),A=w.useCallback(async()=>{const q=Date.now();if(q-d.current<50){n.debug("Debouncing fetchParticipants call",{sourceFile:"useEmailParticipants.ts"});return}d.current=q;try{if(r==="chrome"){const oe=await e.getCurrentThreadId();if(oe){n.info("Getting participants for Chrome",{sourceFile:"useEmailParticipants.ts",threadId:oe}),console.log(` [Participants] Fetching for thread: ${oe}`);try{const fe=await s8(oe,n);console.log(` [Participants] Server returned ${(fe==null?void 0:fe.length)??0} participants:`,fe),n.info("Received participants from server",{sourceFile:"useEmailParticipants.ts",threadId:oe,participantCount:(fe==null?void 0:fe.length)??0,participants:fe==null?void 0:fe.slice(0,5)}),(!fe||fe.length===0)&&(console.warn(` [Participants] No participants returned for thread ${oe}`),n.warn("No participants returned from server",{sourceFile:"useEmailParticipants.ts",threadId:oe})),i({type:"SET_RAW_PARTICIPANTS",participants:fe||[]})}catch(fe){console.error(` [Participants] Error fetching for thread ${oe}:`,fe),n.error("Error fetching participants for Chrome",fe,{sourceFile:"useEmailParticipants.ts",threadId:oe}),T()}}else console.warn(" [Participants] No threadId found for Chrome"),n.debug("No threadId found for Chrome",{sourceFile:"useEmailParticipants.ts"}),T()}else if(r==="outlook"){n.debug("Getting participants for Outlook",{sourceFile:"useEmailParticipants.ts"});try{const oe=await e.getCurrentThread();if(oe){let fe=oe.participants;const H=e.getCurrentUserEmail();if(H){const me=fe.length;fe=fK(fe,H),n.debug("Applied domain filtering for Outlook participants",{sourceFile:"useEmailParticipants.ts",userEmail:H,originalCount:me,filteredCount:fe.length})}else n.warn("Could not get user email, skipping domain filtering",{sourceFile:"useEmailParticipants.ts"});i({type:"SET_RAW_PARTICIPANTS",participants:fe})}else n.debug("No thread found for Outlook",{sourceFile:"useEmailParticipants.ts"}),T()}catch(oe){n.error("Error fetching participants for Outlook",oe,{sourceFile:"useEmailParticipants.ts"}),T()}}}catch(oe){n.error("Error in fetchParticipants",oe,{sourceFile:"useEmailParticipants.ts"}),T()}},[r,e,n,T]),R=w.useCallback(async()=>{if(!(s.isValidating||s.sanitizedParticipants.length===0)){n.info("Starting participant data refresh",{sourceFile:"useEmailParticipants.ts",participantCount:s.sanitizedParticipants.length});try{await Promise.all(s.sanitizedParticipants.map(q=>jw(q,n))),i({type:"REFRESH_DATA"}),n.info("Participant data refresh initiated",{sourceFile:"useEmailParticipants.ts"})}catch(q){n.error("Error refreshing participant data",q,{sourceFile:"useEmailParticipants.ts"})}}},[s.isValidating,s.sanitizedParticipants,n]),F=p.length>0,j=p[0]??"",L=s.selectedClient?p.includes(s.selectedClient):!0,G=F&&!s.selectedClient&&!s.isManuallySet&&!s.isProjectManuallySelected,z=!s.isValidating&&s.selectedClient&&!L&&!s.isManuallySet&&!s.isProjectManuallySelected;return w.useEffect(()=>{G?(n.info("Auto-selecting first validated client",{sourceFile:"useEmailParticipants.ts",selectedClient:j}),i({type:"SELECT_CLIENT",email:j,isManual:!1})):z&&(n.info("Current client no longer valid, clearing",{sourceFile:"useEmailParticipants.ts",clientEmail:s.selectedClient}),i({type:"SELECT_CLIENT",email:"",isManual:!1}))},[G,z,j,s.selectedClient,n]),w.useEffect(()=>{if(e!=null&&e.onThreadChanged){const q=ae=>{ae?(n.debug("Thread changed",{sourceFile:"useEmailParticipants.ts",newThreadId:ae.threadId}),i({type:"RESET_STATE"}),A()):(n.info("Thread cleared",{sourceFile:"useEmailParticipants.ts"}),i({type:"RESET_STATE"}))};return e.onThreadChanged(q),()=>{e.removeThreadListener&&e.removeThreadListener(q)}}},[e,A,n]),w.useEffect(()=>{t&&!c.current&&(c.current=!0,A())},[t,A]),{validClients:p,selectedClient:s.selectedClient,currentClientIndex:v,sanitizedParticipants:s.sanitizedParticipants,isValidating:s.isValidating,isManuallySet:s.isManuallySet,isProjectManuallySelected:s.isProjectManuallySelected,refreshTrigger:s.refreshTrigger,integrationSettings:s.integrationSettings,hasTransientError:s.hasTransientError,selectClient:b,setManuallySet:S,setProjectManuallySelected:N,handleClientDataValidated:x,handleTransientError:E,refresh:R,resetState:T}}function mK({toggleSection:r,clientEmail:e,setClientEmail:t,setProjectId:n,setDocuments:s,setIsDocumentsLoading:i,setDocumentsError:c,onDocumentView:d,onRefreshReady:m,onGenerateRefresh:p,isPrefetchEnabled:v}){const x=Gr(),b=dn().platform,S=ua();Qa();const{isConnected:N}=Di(),[E,T]=w.useState([]),[A,R]=w.useState(null),[F,j]=w.useState(!0),[L,G]=w.useState(0),[z,q]=w.useState([]),[ae,oe]=w.useState(null),[fe,H]=w.useState(null),[me,ee]=w.useState(!1),[se,de]=w.useState(!1),[Y,J]=w.useState(!1),$=me||se||Y,{validClients:X,selectedClient:O,currentClientIndex:U,sanitizedParticipants:re,isValidating:Ee,isManuallySet:ne,isProjectManuallySelected:we,refreshTrigger:K,integrationSettings:he,hasTransientError:be,selectClient:Ie,setManuallySet:_t,setProjectManuallySelected:Be,handleClientDataValidated:Ge,handleTransientError:qe,refresh:Ne}=pK({platform:b,dataProvider:S,isIntegrationConnected:$});w.useEffect(()=>{m==null||m(Ne)},[m,Ne]),w.useEffect(()=>{t(O)},[O,t]),w.useEffect(()=>{(async()=>{await CI(x)})()},[x]);const St=w.useCallback(()=>{if(L<z.length-1){const ge=L+1;G(ge)}},[L,z.length]),ct=w.useCallback(()=>{if(L>0){const ge=L-1;G(ge)}},[L]),Ct=w.useRef(z.length);Ct.current=z.length;const Gt=w.useCallback(ge=>{ge>=0&&ge<Ct.current&&G(ge)},[]);w.useEffect(()=>{G(0)},[O]);const $t=w.useCallback(({className:ge="",clientUrl:Pe})=>u.jsxs("div",{className:`flex items-center px-3 py-1 bg-gray-50 dark:bg-gray-800 border-b dark:border-gray-700 gap-2 ${ge}`,children:[u.jsx("div",{className:"flex-1 min-w-0 flex items-center",children:u.jsxs(jo,{children:[u.jsx(Oo,{asChild:!0,children:u.jsxs(We,{variant:"ghost",size:"sm",className:"h-8 text-sm text-gray-600 dark:text-gray-300 flex items-center gap-1 px-2 max-w-full",children:[u.jsx("span",{className:"truncate",title:O||"",children:O||"No client"}),u.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400 flex-shrink-0",children:["(",U+1,"/",X.length,")"]}),u.jsx(xs,{className:"w-3 h-3 ml-1 flex-shrink-0"})]})}),u.jsx(co,{align:"start",className:"max-h-[200px] overflow-y-auto",children:X.map((pt,wt)=>u.jsx(bs,{className:`text-xs ${pt===O?"bg-gray-100 dark:bg-gray-700 font-medium":""}`,onClick:()=>{Ie(pt,!1)},children:pt},pt))})]})}),Pe&&u.jsxs("a",{href:Pe,target:"_blank",rel:"noopener noreferrer",className:"h-8 text-xs text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 border border-blue-200 dark:border-blue-800 px-3 flex-shrink-0 rounded-md inline-flex items-center gap-1 no-underline hover:no-underline",children:[u.jsx(Va,{className:"w-3 h-3"}),"View"]})]}),[O,U,X,Ie]);w.useEffect(()=>{(async()=>{try{const Pe=await kI(x),pt=Pe.some(He=>He.integration_type==="filevine"),wt=Pe.some(He=>He.integration_type==="clio"),ze=Pe.some(He=>He.integration_type==="inszoom");ee(pt),de(wt),J(ze)}catch(Pe){x.error("Error checking integration connections",Pe,{sourceFile:"src/shared/components/sidepanel/panels/InsightsPanel.tsx"})}})()},[x]),w.useEffect(()=>{(async()=>{try{const Pe=await Jm(x);T(Pe||[]);const pt=(Pe==null?void 0:Pe.some(rt=>rt.integration_type.toLowerCase()==="filevine"))||!1,wt=(Pe==null?void 0:Pe.some(rt=>rt.integration_type.toLowerCase()==="clio"))||!1,ze=(Pe==null?void 0:Pe.some(rt=>rt.integration_type.toLowerCase()==="inszoom"))||!1;let He=null;if(pt?He="filevine":wt?He="clio":ze&&(He="inszoom"),He){const rt=await ES(He);R(rt)}else R(null)}catch(Pe){x.error("Error fetching integrations:",Pe,{sourceFile:"src/shared/components/sidepanel/panels/InsightsPanel.tsx"})}finally{j(!1)}})()},[x]);const Kt=E.some(ge=>ge.integration_type.toLowerCase()==="filevine"),hr=E.some(ge=>ge.integration_type.toLowerCase()==="clio"),Ur=E.some(ge=>ge.integration_type.toLowerCase()==="inszoom");w.useEffect(()=>{H(ae?!0:null)},[ae]);const zr={clientEmail:O,setClientEmail:(ge,Pe)=>{if(!ge)Ie("",!1);else{const pt=X.indexOf(ge),wt=Pe===!0?!0:pt<0;Ie(ge,wt)}},tempClientEmail:ae,setTempClientEmail:oe,emailParticipants:re,emailParticipantClients:X,currentClientIndex:U,setCurrentClientIndex:ge=>{const Pe=X[ge];Pe?Ie(Pe,!1):(x.warn("Invalid client index",{sourceFile:"src/shared/components/sidepanel/panels/InsightsPanel.tsx",index:ge,availableClients:X.length}),Ie("",!1))},currentCaseIndex:L,casesForCurrentClient:z,setCasesForCurrentClient:q,isManuallySet:ne,setIsManuallySet:ge=>{_t(ge)},isProjectManuallySelected:we,setIsProjectManuallySelected:Be,isValidClient:O?!0:null,isTempEmailValid:fe,nextCase:St,prevCase:ct,handleSetCurrentCaseIndex:Gt,ClientNavigation:$t,onClientDataValidated:Ge,onTransientError:qe,isValidating:Ee,refreshTrigger:K,integrationSettings:he,hasTransientError:be,isPrefetchEnabled:v},kr=b==="chrome"&&!N;return u.jsx("div",{className:"h-full",children:kr?u.jsx("div",{className:"p-4",children:u.jsx(r0,{feature:"Insights",description:"Connect your Gmail account to view client insights and case information",benefits:["Automatically identify clients from email participants","View relevant case information and documents","Access client details from your case management system"]})}):F?u.jsxs("div",{className:"flex flex-col items-center justify-center h-full",children:[u.jsx(ia,{className:"h-8 w-8 animate-spin text-blue-600"}),u.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"Loading integrations..."})]}):u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"flex items-center justify-between mb-2",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Data Provider:"}),A&&u.jsxs("a",{href:A.homeUrl,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1.5 hover:opacity-80 transition-opacity",title:`Open ${A.name}`,children:[u.jsx(Ai,{src:A.logo,width:18,height:18,alt:A.name,className:"h-4 w-auto dark:brightness-0 dark:invert"}),u.jsx("span",{className:"text-xs font-medium text-blue-600 dark:text-blue-400",children:A.name})]})]}),u.jsx(We,{size:"icon",variant:"ghost",onClick:()=>{Ne(),p==null||p()},disabled:Ee||re.length===0,className:"h-6 w-6",title:Ee?"Refreshing...":re.length===0?"No participants to refresh":"Refresh participant data",children:u.jsx(si,{className:`h-3 w-3 ${Ee?"animate-spin":""}`})})]}),Kt&&u.jsx(Vq,{toggleSection:r,setDocuments:s,setIsDocumentsLoading:i,setDocumentsError:c,setProjectId:n,onDocumentView:d,...zr}),hr&&u.jsx(iK,{...zr}),Ur&&u.jsx(cK,{...zr})]})})}const gK={showEmailSummary:!1,showInsightsTab:!0,showComposeTab:!0,showTemplatesTab:!0},vK=()=>gK,yK=r=>vK()[r],xK=({className:r=""})=>{const[e,t]=w.useState(!1),{isConnected:n,wasEverConnected:s,isLoading:i,error:c,status:d,reconnectAttempts:m,initiateReconnection:p,clearError:v}=Di(),{platform:x}=dn();if(x!=="chrome"||n&&d!=="error"||e)return null;const b=async()=>{try{await p()}catch(F){console.error("Failed to reconnect Gmail:",F)}},S=()=>{t(!0),c&&v()},N=()=>d==="error"?"bg-red-50 border-red-200":s?"bg-yellow-50 border-yellow-200":"bg-blue-50 border-blue-200",E=()=>d==="error"?u.jsx(sh,{className:"h-4 w-4 text-red-600 flex-shrink-0"}):s?u.jsx(sh,{className:"h-4 w-4 text-yellow-600 flex-shrink-0"}):u.jsx(sh,{className:"h-4 w-4 text-blue-600 flex-shrink-0"}),T=()=>d==="error"?c||"Gmail connection error occurred":s?"Gmail connection lost. Some features may not work properly.":"Gmail connection required to access all features.",A=()=>d==="error"?"text-red-800":s?"text-yellow-800":"text-blue-800",R=()=>d==="error"?"bg-red-100 border-red-300 text-red-800 hover:bg-red-200 hover:border-red-400":s?"bg-yellow-100 border-yellow-300 text-yellow-800 hover:bg-yellow-200 hover:border-yellow-400":"bg-blue-100 border-blue-300 text-blue-800 hover:bg-blue-200 hover:border-blue-400";return u.jsxs("div",{className:`flex items-center justify-between ${N()} px-4 py-3 ${r}`,role:"alert","aria-live":"polite","aria-atomic":"true",children:[u.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[E(),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("p",{className:`text-sm ${A()} font-medium`,children:T()}),m>0&&u.jsxs("p",{className:`text-xs ${A()} opacity-75 mt-1`,children:["Reconnect attempts: ",m]})]})]}),u.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[u.jsx(We,{onClick:b,disabled:i,variant:"outline",size:"sm",className:`${R()} text-xs px-3 py-1 h-auto whitespace-nowrap`,"aria-label":i?"Connecting to Gmail...":s?"Reconnect Gmail account":"Connect Gmail account",children:i?u.jsxs(u.Fragment,{children:[u.jsx(si,{className:"h-3 w-3 mr-1 animate-spin","aria-hidden":"true"}),"Connecting..."]}):s?"Reconnect Gmail":"Connect Gmail"}),u.jsx(We,{onClick:S,variant:"ghost",size:"sm",className:`${d==="error"?"text-red-600 hover:text-red-800 hover:bg-red-100":s?"text-yellow-600 hover:text-yellow-800 hover:bg-yellow-100":"text-blue-600 hover:text-blue-800 hover:bg-blue-100"} p-1 h-auto`,"aria-label":"Dismiss Gmail connection banner",children:u.jsx(aa,{className:"h-4 w-4","aria-hidden":"true"})})]})]})},hF=w.createContext(void 0),pF=()=>{const r=w.useContext(hF);if(r===void 0)throw new Error("useToast must be used within a ToastProvider");return r},wK=({children:r})=>{const[e,t]=w.useState([]),n=w.useCallback(d=>{const m=Math.random().toString(36).substr(2,9),p={...d,id:m};t(x=>[...x,p]);const v=d.duration??5e3;return v>0&&setTimeout(()=>{t(x=>x.filter(b=>b.id!==m))},v),m},[]),s=w.useCallback(d=>{t(m=>m.filter(p=>p.id!==d))},[]),i=w.useCallback(()=>{t([])},[]),c={toasts:e,addToast:n,removeToast:s,clearAll:i};return u.jsxs(hF.Provider,{value:c,children:[r,u.jsx(bK,{})]})},bK=()=>{const{toasts:r,removeToast:e}=pF();return r.length===0?null:u.jsx("div",{className:"fixed top-4 right-4 z-50 flex flex-col gap-2 max-w-sm",children:r.map(t=>u.jsx(_K,{toast:t,onRemove:e},t.id))})},_K=({toast:r,onRemove:e})=>{const t=s=>{switch(s){case"success":return u.jsx(ad,{className:"h-5 w-5 text-green-600"});case"error":return u.jsx(sh,{className:"h-5 w-5 text-red-600"});case"warning":return u.jsx(eR,{className:"h-5 w-5 text-amber-600"});case"info":return u.jsx(Xc,{className:"h-5 w-5 text-blue-600"});default:return null}},n=s=>{switch(s){case"success":return"bg-green-50 border-green-200";case"error":return"bg-red-50 border-red-200";case"warning":return"bg-amber-50 border-amber-200";case"info":return"bg-blue-50 border-blue-200";default:return"bg-gray-50 border-gray-200"}};return u.jsxs("div",{className:`flex items-start gap-3 p-4 rounded-lg border shadow-lg animate-in slide-in-from-right-full ${n(r.type)}`,children:[t(r.type),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("p",{className:"text-sm font-medium text-gray-900",children:r.title}),r.description&&u.jsx("p",{className:"text-sm text-gray-600 mt-1",children:r.description}),r.action&&u.jsx(We,{onClick:r.action.onClick,variant:"outline",size:"sm",className:"mt-2 h-7 text-xs",children:r.action.label})]}),u.jsx(We,{onClick:()=>e(r.id),variant:"ghost",size:"sm",className:"p-1 h-auto",children:u.jsx(aa,{className:"h-4 w-4"})})]})},SK=()=>{const{addToast:r}=pF(),e=w.useCallback(()=>{r({type:"success",title:"Gmail Connected",description:"Successfully connected to Gmail. All features are now available.",duration:4e3})},[r]),t=w.useCallback(c=>{r({type:"warning",title:"Gmail Connection Lost",description:"Some features may not work properly until you reconnect.",duration:0,action:c?{label:"Reconnect",onClick:c}:void 0})},[r]),n=w.useCallback((c,d)=>{r({type:"error",title:"Gmail Connection Error",description:c,duration:0,action:d?{label:"Retry",onClick:d}:void 0})},[r]),s=w.useCallback(()=>{r({type:"success",title:"Gmail Reconnected",description:"Successfully reconnected to Gmail.",duration:3e3})},[r]),i=w.useCallback(c=>{r({type:"error",title:"Reconnection Failed",description:"Failed to reconnect to Gmail. Please try again.",duration:0,action:c?{label:"Try Again",onClick:c}:void 0})},[r]);return{showConnectionSuccess:e,showConnectionLost:t,showConnectionError:n,showReconnectionSuccess:s,showReconnectionFailed:i}},EK=()=>{const{status:r,error:e,isConnected:t,initiateReconnection:n}=Di(),{platform:s}=dn(),{showConnectionSuccess:i,showConnectionLost:c,showConnectionError:d,showReconnectionSuccess:m,showReconnectionFailed:p}=SK(),v=w.useRef("loading"),x=w.useRef(!0),b=w.useRef(!1);return w.useEffect(()=>{if(s!=="chrome")return;const S=v.current,N=x.current,E=b.current;if(!(!E&&r==="loading")){if(!E){b.current=!0,v.current=r,x.current=t;return}if(S!==r||N!==t)switch(r){case"connected":(S==="disconnected"||S==="error"||!N)&&(S==="loading"?m():i());break;case"disconnected":N&&S==="connected"&&c(()=>{n().catch(A=>{console.error("Failed to reconnect from toast:",A)})});break;case"error":d(e||"Unknown connection error occurred",()=>{n().catch(A=>{console.error("Failed to reconnect from toast:",A),p(()=>{n().catch(console.error)})})});break}v.current=r,x.current=t}},[r,e,t,s,n,i,c,d,m,p]),null},CK=({activeSection:r,toggleSection:e})=>{const t=Gr();t.debug(`[MainPanelContent] Rendering with activeSection: "${r}"`,{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx",functionName:"MainPanelContent",data:{activeSection:r}});const n=DT(),s=Qa(),{platform:i}=dn(),{isConnected:c,wasEverConnected:d}=Di(),m=i==="chrome"&&!c&&d,[p,v]=w.useState(""),[x,b]=w.useState(""),[S,N]=w.useState([]),[E,T]=w.useState(!1),[A,R]=w.useState(null),[F,j]=w.useState(null),[L,G]=w.useState("compose"),[z,q]=w.useState(!1),[ae,oe]=w.useState(!1),[fe,H]=w.useState(!1),[me,ee]=w.useState(!1),se=w.useRef(!1),de=w.useRef(!1),Y=w.useRef(null),J=w.useRef(null),$=w.useRef(null),X=w.useCallback(async()=>{try{t.info("Checking authentication status...",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"});const ne=await(n==null?void 0:n.isAuthenticated());return t.info("Authentication status checked",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx",authenticated:ne}),ne||!1}catch(ne){return t.error("Failed to check auth status",ne,{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"}),!1}},[n,t]);w.useEffect(()=>{t.info("MainPanelContent component loaded",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"});const ne=async()=>{const K=await X();oe(!0),H(K),K?(t.info("Valid token found. User is authenticated.",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"}),r==="login"&&e("main")):(t.info("No valid token found. Show login page.",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"}),e("login"))},we=K=>{K.token&&(t.info("Token detected in storage, auth state will be updated automatically",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"}),ne(),By(t))};return s!=null&&s.onChanged&&s.onChanged(we),ne(),()=>{s!=null&&s.removeChangeListener&&s.removeChangeListener(we)}},[n,s,e,t,X,r]),w.useEffect(()=>{if(!ae||!fe||de.current){t.debug("Skipping CMS integration check - auth not ready, not authenticated, or already checked",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx",isAuthChecked:ae,isAuthenticated:fe,hasRunInitialCheck:de.current});return}de.current=!0;const ne=async()=>{try{t.info("Checking Case Management System connection status",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"});const K=await EI(t);t.info("Case Management System connection status result",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx",connected:K}),q(K),se.current||(K?(t.info("CMS connected, setting active tab to insights",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"}),G("insights")):(t.info("CMS not connected, setting active tab to compose",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"}),G("compose")),se.current=!0)}catch(K){t.error("Error checking Case Management System connection",K,{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"}),q(!1),se.current||(G("compose"),se.current=!0)}},we=K=>{if(!K.integrations)return;t.info("Integrations changed via storage, rechecking CMS connection",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx",oldValue:K.integrations.oldValue,newValue:K.integrations.newValue});const he=K.integrations.newValue;if(!Array.isArray(he))return;const be=["inszoom","filevine","clio"];he.some(_t=>be.includes(_t.integration_type))&&(t.info("CMS integration found",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx",newValue:K.integrations.newValue}),q(!0))};return ne(),s!=null&&s.onChanged&&s.onChanged(we),()=>{s!=null&&s.removeChangeListener&&s.removeChangeListener(we)}},[ae,fe,t,s]),w.useEffect(()=>{if(!ae||!fe)return;(async()=>{var we;try{const K=await OT(t);let he=!1;try{if(K&&typeof K=="object"){const be=K==null?void 0:K.email;he=!!((we=be==null?void 0:be.prefetch)!=null&&we.enabled)}}catch{he=!1}ee(he),t.debug("Prefetch setting checked",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx",prefetchEnabled:he})}catch(K){t.error("Error checking prefetch setting",K,{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx"}),ee(!1)}})()},[ae,fe,t]);const O=w.useRef(p);w.useEffect(()=>{p!==O.current&&(O.current=p,z&&G("insights"))},[p,z]);const U=ne=>{G(ne),e(ne==="login"?"login":"main")},re=()=>{t.debug("[MainPanelContent] goBack called. Setting activeSection to null.",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx",functionName:"goBack"}),e("main"),j(null)},Ee=ne=>{t.debug("[MainPanelContent] handleDocumentView called",{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx",functionName:"handleDocumentView",data:{document:ne}}),j(ne),e("Project Documents")};return w.useEffect(()=>{r==="Project Documents"&&Y.current&&(Y.current.scrollTop=0)},[r]),u.jsxs(wK,{children:[u.jsx(EK,{}),u.jsxs("div",{ref:Y,className:`flex flex-col h-full relative ${r==="login"||r==="Project Documents"?"overflow-hidden":"overflow-y-auto"}`,children:[r!=="login"&&u.jsx(xK,{className:"flex-shrink-0"}),u.jsxs("div",{className:"flex flex-col",children:[yK("showEmailSummary")&&u.jsx("div",{className:"flex-shrink-0 border-b-2 border-gray-300",children:u.jsx(A9,{})}),u.jsx("div",{className:"flex-grow flex flex-col",children:m?u.jsx("div",{className:"flex-grow"}):u.jsxs(Y9,{defaultValue:z?"insights":"compose",value:L,onValueChange:U,className:"w-full flex flex-col",children:[u.jsxs(qI,{className:`grid ${z?"grid-cols-3":"grid-cols-2"} w-full bg-white dark:bg-card border-b dark:border-border p-0 h-9 flex-shrink-0`,children:[z&&u.jsx(ey,{value:"insights",className:"mx-1 my-0.5 text-sm text-gray-600 dark:text-gray-200 data-[state=active]:text-blue-600 dark:data-[state=active]:text-blue-400 data-[state=active]:bg-white dark:data-[state=active]:bg-muted data-[state=active]:shadow-sm data-[state=active]:font-medium border-gray-200 dark:border-border data-[state=active]:border-b-2 data-[state=active]:border-b-blue-600 dark:data-[state=active]:border-b-blue-400",children:"Insights"}),u.jsx(ey,{value:"compose",className:"mx-1 my-0.5 text-sm text-gray-600 dark:text-gray-200 data-[state=active]:text-blue-600 dark:data-[state=active]:text-blue-400 data-[state=active]:bg-white dark:data-[state=active]:bg-muted data-[state=active]:shadow-sm data-[state=active]:font-medium border-gray-200 dark:border-border data-[state=active]:border-b-2 data-[state=active]:border-b-blue-600 dark:data-[state=active]:border-b-blue-400",children:"Compose"}),u.jsx(ey,{value:"templates",className:"mx-1 my-0.5 text-sm text-gray-600 dark:text-gray-200 data-[state=active]:text-blue-600 dark:data-[state=active]:text-blue-400 data-[state=active]:bg-white dark:data-[state=active]:bg-muted data-[state=active]:shadow-sm data-[state=active]:font-medium border-gray-200 dark:border-border data-[state=active]:border-b-2 data-[state=active]:border-b-blue-600 dark:data-[state=active]:border-b-blue-400",children:"Templates"})]}),u.jsxs("div",{className:"flex-grow mb-0",children:[z&&u.jsx(ty,{forceMount:!0,value:"insights",className:`p-4 ${L==="insights"?"block":"hidden"}`,children:u.jsx(mK,{toggleSection:e,clientEmail:p,setClientEmail:v,setProjectId:b,setDocuments:N,setIsDocumentsLoading:T,setDocumentsError:R,onDocumentView:Ee,onRefreshReady:ne=>{J.current=ne},onGenerateRefresh:me?()=>{var ne;(ne=$.current)==null||ne.call($)}:void 0,isPrefetchEnabled:me})}),u.jsx(ty,{forceMount:!0,value:"compose",className:`p-4 ${L==="compose"?"block":"hidden"}`,children:me?u.jsx(v9,{clientEmail:p,onCmsRefresh:()=>{var ne;(ne=J.current)==null||ne.call(J)},onGenerateRefreshReady:ne=>{$.current=ne}}):u.jsx(c9,{clientEmail:p})}),u.jsx(ty,{forceMount:!0,value:"templates",className:`p-4 ${L==="templates"?"block":"hidden"}`,children:u.jsx(E7,{clientEmail:p,isAuthenticated:fe})})]})]})})]})," ",r==="login"&&u.jsx("div",{className:"fixed inset-0 bg-white dark:bg-gray-950 z-50",children:u.jsx(y9,{})}),r==="Project Documents"&&(t.debug('[MainPanelContent] activeSection is "Project Documents". Rendering overlay.',{sourceFile:"src/shared/components/sidepanel/mainPanelContent.tsx",functionName:"MainPanelContent.render",data:{activeSection:r,selectedDocumentToView:F}}),u.jsx("div",{className:"absolute inset-0 bg-white dark:bg-gray-950 z-10",children:F?u.jsx(KI,{documentId:F.documentId,documentName:F.name,onBack:re}):u.jsx(Q9,{clientEmail:p,projectId:x,documents:S,isLoading:E,error:A,goBack:re})}))]})]})},kK=()=>{var x;const[r,e]=w.useState(null),t=Gr(),{platform:n}=dn(),s=ua(),{isConnected:i}=Di();if(w.useEffect(()=>{var E,T;if(n!=="chrome")return;const b=async()=>{var A;try{if((A=chrome==null?void 0:chrome.tabs)!=null&&A.query){const[R]=await chrome.tabs.query({active:!0,currentWindow:!0});if(R!=null&&R.id&&(R!=null&&R.windowId)){let F;try{const j=await(s==null?void 0:s.getCurrentThread());F=j==null?void 0:j.subject}catch(j){t.debug("Could not get email thread subject",{sourceFile:"src/shared/components/sidepanel/TabIndicator.tsx",sourceFunction:"getCurrentTabInfo",error:j})}e({tabId:R.id,windowId:R.windowId,title:R.title,url:R.url,emailSubject:F}),t.debug("Updated tab info in indicator",{sourceFile:"src/shared/components/sidepanel/TabIndicator.tsx",sourceFunction:"getCurrentTabInfo",tabId:R.id,windowId:R.windowId,title:R.title,emailSubject:F})}}}catch(R){t.error("Error getting current tab info",R,{sourceFile:"src/shared/components/sidepanel/TabIndicator.tsx",sourceFunction:"getCurrentTabInfo"})}};b();const S=[];if((E=chrome==null?void 0:chrome.tabs)!=null&&E.onActivated){const A=R=>{t.debug("Tab activated in indicator",{sourceFile:"src/shared/components/sidepanel/TabIndicator.tsx",sourceFunction:"handleTabActivated",tabId:R.tabId,windowId:R.windowId}),setTimeout(b,200)};chrome.tabs.onActivated.addListener(A),S.push(()=>{var R,F;(F=(R=chrome==null?void 0:chrome.tabs)==null?void 0:R.onActivated)!=null&&F.removeListener&&chrome.tabs.onActivated.removeListener(A)})}if((T=chrome==null?void 0:chrome.tabs)!=null&&T.onUpdated){const A=(R,F,j)=>{var L;F.url&&j.active&&j.windowId&&(t.debug("Tab URL updated, refreshing tab indicator",{sourceFile:"src/shared/components/sidepanel/TabIndicator.tsx",sourceFunction:"handleTabUpdated",tabId:R,newUrl:F.url}),setTimeout(b,300)),F.status==="complete"&&j.active&&((L=j.url)!=null&&L.includes("mail.google.com"))&&setTimeout(b,500)};chrome.tabs.onUpdated.addListener(A),S.push(()=>{var R,F;(F=(R=chrome==null?void 0:chrome.tabs)==null?void 0:R.onUpdated)!=null&&F.removeListener&&chrome.tabs.onUpdated.removeListener(A)})}if(s!=null&&s.onThreadChanged){const A=()=>{t.debug("Thread data changed, updating tab indicator",{sourceFile:"src/shared/components/sidepanel/TabIndicator.tsx",sourceFunction:"handleThreadChanged"}),setTimeout(b,100)};s.onThreadChanged(A),S.push(()=>{s.removeThreadListener&&s.removeThreadListener(A)})}const N=setInterval(()=>{b()},3e3);return S.push(()=>{clearInterval(N)}),()=>{S.forEach(A=>A())}},[n,t,s]),n!=="chrome"||!r||!i)return null;const c=()=>{var b;return r.emailSubject&&r.emailSubject!=="No Subject"?r.emailSubject.length>50?`${r.emailSubject.substring(0,50)}...`:r.emailSubject:(b=r.url)!=null&&b.includes("mail.google.com")?"Open an email to begin":r.title?r.title.length>30?`${r.title.substring(0,30)}...`:r.title:"No content available"},d=()=>{var b;return r.emailSubject&&r.emailSubject!=="No Subject"?"border-green-400 bg-green-50 dark:border-green-500 dark:bg-green-950":(b=r.url)!=null&&b.includes("mail.google.com")?"border-yellow-400 bg-yellow-50 dark:border-yellow-500 dark:bg-yellow-950":"border-blue-400 bg-blue-50 dark:border-blue-500 dark:bg-blue-950"},m=()=>{var b;return r.emailSubject&&r.emailSubject!=="No Subject"?"bg-green-400 dark:bg-green-500":(b=r.url)!=null&&b.includes("mail.google.com")?"bg-yellow-400 dark:bg-yellow-500":"bg-blue-400 dark:bg-blue-500"},p=()=>{var b;return r.emailSubject&&r.emailSubject!=="No Subject"?"text-green-800 dark:text-green-200":(b=r.url)!=null&&b.includes("mail.google.com")?"text-yellow-800 dark:text-yellow-200":"text-blue-800 dark:text-blue-200"},v=()=>{var b;return r.emailSubject&&r.emailSubject!=="No Subject"?"text-green-600 dark:text-green-300":(b=r.url)!=null&&b.includes("mail.google.com")?"text-yellow-600 dark:text-yellow-300":"text-blue-600 dark:text-blue-300"};return u.jsx("div",{className:`border-l-4 px-3 py-1.5 mb-2 rounded-r-md ${d()}`,children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"flex-shrink-0",children:u.jsx("div",{className:`w-2 h-2 rounded-full animate-pulse ${m()}`})}),u.jsxs("div",{className:"ml-3 flex-1 min-w-0",children:[u.jsx("p",{className:`text-sm font-medium ${p()}`,children:r.emailSubject&&r.emailSubject!=="No Subject"?"Email Opened":(x=r.url)!=null&&x.includes("mail.google.com")?"No Email Selected":"Active Tab"}),u.jsx("p",{className:`text-sm ${v()} truncate`,title:r.emailSubject||r.title,children:c()})]})]})})},NK=()=>{const{activeSection:r,setActiveSection:e}=MT(),t=p8(),n=g8(),s=Gr(),{platform:i}=dn(),c=d=>{if(s.debug(`toggleSection called with section: "${d}"`,{sourceFile:"src/shared/components/sidepanel/SidePanelContent.tsx",section:d,currentActiveSection:r}),r===d){s.debug(`toggleSection called with section: "${d}" but activeSection is already ${r}`,{sourceFile:"src/shared/components/sidepanel/SidePanelContent.tsx",section:d,currentActiveSection:r});return}else s.debug(`toggleSection called with section: "${d}" changing activeSection from ${r}`,{sourceFile:"src/shared/components/sidepanel/SidePanelContent.tsx",section:d,currentActiveSection:r}),e(d)};return w.useEffect(()=>{if(t!=null&&t.onMessage){const d=async m=>{if(m.type==="USER_LOGGED_OUT"&&(s.info("Received logout notification in sidepanel",{sourceFile:"src/shared/components/sidepanel/SidePanelContent.tsx"}),n!=null&&n.closeWindow))try{await n.closeWindow()}catch(p){s.error("Failed to close window",p,{sourceFile:"src/shared/components/sidepanel/SidePanelContent.tsx"})}};return t.onMessage(d),()=>{t.removeMessageListener&&t.removeMessageListener(d)}}},[t,n,s]),w.useEffect(()=>{if(i==="chrome"&&(t!=null&&t.sendMessage))return t.sendMessage({type:"SIDE_PANEL_MOUNTED"}).catch(()=>{}),()=>{t.sendMessage&&t.sendMessage({type:"SIDE_PANEL_UNMOUNTED"}).catch(()=>{})}},[i,t]),u.jsxs("div",{className:"flex flex-col h-full",children:[r!=="login"&&r!=="Project Documents"&&u.jsx(kK,{}),u.jsx("div",{className:"flex-grow min-h-0",children:u.jsx(CK,{activeSection:r,toggleSection:c})})]})},TK=()=>u.jsx(rK,{children:u.jsx(NK,{})}),AK=({variant:r})=>{const e=`logo ${r?`logo--${r}`:""}`;return u.jsx("div",{className:e,children:"candle"})},RK=({className:r="",variant:e="badge",showLastChecked:t=!1,hideInLogin:n=!1})=>{const[s,i]=w.useState(!1),{isConnected:c,isLoading:d,error:m,status:p,lastChecked:v,reconnectAttempts:x,wasEverConnected:b,initiateReconnection:S,clearError:N,forceRefresh:E}=Di(),{platform:T}=dn();if(T!=="chrome"||n)return null;const A=z=>{switch(z){case"connected":return u.jsx(ad,{className:"h-4 w-4 text-green-600"});case"disconnected":return u.jsx(eR,{className:"h-4 w-4 text-amber-600"});case"loading":return u.jsx(ia,{className:"h-4 w-4 animate-spin text-blue-600"});case"error":return u.jsx(sh,{className:"h-4 w-4 text-red-600"});default:return u.jsx(Xc,{className:"h-4 w-4 text-gray-400"})}},R=z=>{switch(z){case"connected":return"bg-green-50 border-green-200 text-green-800";case"disconnected":return"bg-amber-50 border-amber-200 text-amber-800";case"loading":return"bg-blue-50 border-blue-200 text-blue-800";case"error":return"bg-red-50 border-red-200 text-red-800";default:return"bg-gray-50 border-gray-200 text-gray-600"}},F=z=>{switch(z){case"connected":return"Gmail Connected";case"disconnected":return"Gmail Disconnected";case"loading":return"Checking Connection...";case"error":return"Connection Error";default:return"Unknown Status"}},j=async()=>{try{await S(),i(!1)}catch(z){console.error("Failed to reconnect Gmail:",z)}},L=async()=>{try{await E()}catch(z){console.error("Failed to refresh connection status:",z)}},G=z=>{if(!z)return"Never checked";const ae=new Date().getTime()-z.getTime(),oe=Math.floor(ae/6e4),fe=Math.floor(ae%6e4/1e3);return oe<1?`${fe}s ago`:oe<60?`${oe}m ago`:`${Math.floor(oe/60)}h ago`};return e==="minimal"?u.jsxs("div",{className:`flex items-center gap-1 ${r}`,title:F(p),children:[u.jsx("div",{className:"cursor-pointer",title:F(p),"aria-label":F(p),children:A(p)}),!c&&!d&&u.jsx(We,{onClick:j,variant:"ghost",size:"sm",className:"h-6 px-2 text-xs",disabled:d,title:b?"Reconnect to Gmail":"Connect to Gmail",children:b?"Reconnect":"Connect"})]}):e==="full"?u.jsxs("div",{className:`flex items-center justify-between p-3 rounded-lg border ${R(p)} ${r}`,children:[u.jsxs("div",{className:"flex items-center gap-3",children:[A(p),u.jsxs("div",{className:"flex-1",children:[u.jsx("p",{className:"text-sm font-medium",children:F(p)}),m&&u.jsx("p",{className:"text-xs mt-1 opacity-80",children:m}),t&&v&&u.jsxs("p",{className:"text-xs mt-1 opacity-60",children:["Last checked: ",G(v)]})]})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[!c&&!d&&u.jsx(We,{onClick:j,variant:"outline",size:"sm",className:"text-xs",disabled:d,children:d?u.jsxs(u.Fragment,{children:[u.jsx(ia,{className:"h-3 w-3 mr-1 animate-spin"}),"Connecting..."]}):b?"Reconnect Gmail":"Connect Gmail"}),u.jsx(We,{onClick:L,variant:"ghost",size:"sm",className:"p-1",disabled:d,children:u.jsx(si,{className:`h-3 w-3 ${d?"animate-spin":""}`})}),m&&u.jsx(We,{onClick:N,variant:"ghost",size:"sm",className:"p-1",children:u.jsx(aa,{className:"h-3 w-3"})})]})]}):u.jsxs(jo,{open:s,onOpenChange:i,children:[u.jsx(Oo,{asChild:!0,children:u.jsxs(We,{variant:"ghost",size:"sm",className:`h-8 px-2 flex items-center gap-2 ${R(p)} border hover:opacity-80 ${r}`,"aria-label":`Gmail connection status: ${F(p)}`,"aria-expanded":s,"aria-haspopup":"menu",children:[A(p),u.jsx("span",{className:"text-xs font-medium",children:F(p)})]})}),u.jsxs(co,{align:"end",className:"w-80",children:[u.jsxs("div",{className:"p-3",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[A(p),u.jsx("span",{className:"font-medium text-sm",children:F(p)})]}),m&&u.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-2 mb-3",children:u.jsx("p",{className:"text-xs text-red-800",children:m})}),u.jsxs("div",{className:"text-xs text-gray-600 mb-3",children:[u.jsxs("p",{children:["Last checked: ",G(v)]}),x>0&&u.jsxs("p",{children:["Reconnect attempts: ",x]})]}),p==="connected"&&u.jsx("div",{className:"bg-green-50 border border-green-200 rounded-md p-2 mb-3",children:u.jsx("p",{className:"text-xs text-green-800",children:"Gmail is connected and working properly. All features are available."})}),p==="disconnected"&&u.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-md p-2 mb-3",children:u.jsx("p",{className:"text-xs text-amber-800",children:b?'Gmail connection lost. Some features may not work properly. Click "Reconnect Gmail" to restore connection.':'Gmail connection required. Some features may not work properly. Click "Connect Gmail" to enable all features.'})})]}),u.jsx(jy,{}),u.jsxs("div",{className:"p-2",children:[u.jsx(bs,{asChild:!0,children:u.jsxs(We,{onClick:L,variant:"ghost",size:"sm",className:"w-full justify-start",disabled:d,children:[u.jsx(si,{className:`h-4 w-4 mr-2 ${d?"animate-spin":""}`}),"Refresh Status"]})}),!c&&u.jsx(bs,{asChild:!0,children:u.jsx(We,{onClick:j,variant:"ghost",size:"sm",className:"w-full justify-start",disabled:d,children:d?u.jsxs(u.Fragment,{children:[u.jsx(ia,{className:"h-4 w-4 mr-2 animate-spin"}),"Connecting..."]}):u.jsxs(u.Fragment,{children:[u.jsx(Xc,{className:"h-4 w-4 mr-2"}),b?"Reconnect Gmail":"Connect Gmail"]})})}),m&&u.jsx(bs,{asChild:!0,children:u.jsxs(We,{onClick:N,variant:"ghost",size:"sm",className:"w-full justify-start",children:[u.jsx(aa,{className:"h-4 w-4 mr-2"}),"Clear Error"]})})]})]})]})},IK=({className:r="",variant:e="badge",hideInLogin:t=!1})=>{const{platform:n}=dn();if(n!=="outlook"||t)return null;const s="Outlook Connected";return e==="minimal"?u.jsx("div",{className:`flex items-center gap-1 ${r}`,title:s,children:u.jsx("div",{className:"cursor-pointer",title:s,"aria-label":s,children:u.jsx(ad,{className:"h-4 w-4 text-green-600"})})}):e==="full"?u.jsx("div",{className:`flex items-center justify-between p-3 rounded-lg border bg-green-50 border-green-200 text-green-800 ${r}`,children:u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx(ad,{className:"h-4 w-4 text-green-600"}),u.jsx("div",{className:"flex-1",children:u.jsx("p",{className:"text-sm font-medium",children:s})})]})}):u.jsxs("div",{className:`h-8 px-2 flex items-center gap-2 bg-green-50 border-green-200 text-green-800 border rounded ${r}`,children:[u.jsx(ad,{className:"h-4 w-4 text-green-600"}),u.jsx("span",{className:"text-xs font-medium",children:s})]})},Wf="src/shared/components/sidepanel/mainPanelContent/panelHeader.tsx",PK=r=>u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",width:"18",height:"18",...r,children:[u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),FK=({className:r})=>{const{activeSection:e,setActiveSection:t}=MT(),n=m8(),s=Gr(),i=async()=>{if(n!=null&&n.openOptionsPage)try{await n.openOptionsPage()}catch(m){s.error("Failed to open options page",m,{sourceFile:Wf})}else s.warn("Options page opening not available on this platform",{sourceFile:Wf})},c=async()=>{if(n!=null&&n.openURL)try{await n.openURL(KN,"_blank")}catch(m){s.error("Failed to open feedback form",m,{sourceFile:Wf})}else s.warn("openURL not available on this platform",{sourceFile:Wf})},d=async()=>{s.info("Logout initiated",{sourceFile:Wf});try{await zy(s),await PU(s),await pT(s),t("login")}catch(m){s.error("Failed to logout",m,{sourceFile:Wf})}};return u.jsxs("div",{className:`relative flex items-center justify-between px-3 py-1 bg-blue-600 border-b border-gray-200 text-gray-100 ${r}`,children:[u.jsxs("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2",children:[u.jsx(RK,{variant:"minimal",className:"text-white border-white/20 hover:bg-white/10",hideInLogin:e==="login"}),u.jsx(IK,{variant:"minimal",className:"text-white border-white/20 hover:bg-white/10",hideInLogin:e==="login"})]}),u.jsx("div",{className:"flex-1 flex justify-center",children:u.jsx(AK,{variant:"panel"})}),u.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:u.jsxs(jo,{children:[u.jsx(Oo,{asChild:!0,children:u.jsx("button",{className:"p-1 rounded hover:bg-white/10 transition-colors",children:u.jsx(PK,{className:"text-white"})})}),u.jsxs(co,{align:"end",side:"bottom",sideOffset:5,children:[u.jsx(bs,{onClick:i,children:"Configure"}),u.jsx(jy,{}),u.jsx(bs,{onClick:c,children:"Feedback"}),u.jsx(jy,{}),u.jsx(bs,{onClick:d,children:"Logout"})]})]})})]})};function vw(){try{const r=Office.context.officeTheme;if(console.log(" Outlook Theme Detection:",r),r){const e=r.bodyBackgroundColor;if(console.log(" Background Color:",e),e){const t=e.replace("#",""),n=parseInt(t.substring(0,2),16),s=parseInt(t.substring(2,4),16),i=parseInt(t.substring(4,6),16),c=(n+s+i)/3;console.log(` Brightness: ${c} (R:${n}, G:${s}, B:${i})`),c<128?(console.log(" Dark mode detected - applying dark class"),document.documentElement.classList.add("dark")):(console.log(" Light mode detected - removing dark class"),document.documentElement.classList.remove("dark")),console.log(" HTML classes:",document.documentElement.className)}}else console.warn(" Office theme not available")}catch(r){console.error(" Error detecting Outlook theme:",r)}}Office.onReady(()=>{vw(),Office.context.mailbox&&Office.context.mailbox.addHandlerAsync(Office.EventType.OfficeThemeChanged,r=>{console.log(" Office theme changed event triggered"),vw()},r=>{r.status===Office.AsyncResultStatus.Succeeded?console.log(" Office theme change listener added successfully"):console.warn(" Failed to add Office theme change listener:",r.error)}),window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>{console.log(" System color scheme changed:",e.matches?"dark":"light"),vw()}),YO.createRoot(document.getElementById("root")).render(u.jsx(_r.StrictMode,{children:u.jsx(A5,{children:u.jsx(y8,{children:u.jsx(x8,{children:u.jsx($H,{children:u.jsxs("div",{className:"sidepanel-container",children:[u.jsx(FK,{className:"sticky top-0 z-50 border-b-0"}),u.jsx(TK,{})]})})})})})}))});export{cd as f,Ly as t};
